var j0=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var Mz=j0((Bz,Il)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();var cl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function By(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function K0(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function n(){if(this instanceof n){var o=[null];o.push.apply(o,arguments);var i=Function.bind.apply(e,o);return new i}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var o=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return s[n]}})}),t}var ya=function(s){return s&&s.Math===Math&&s},Yt=ya(typeof globalThis=="object"&&globalThis)||ya(typeof window=="object"&&window)||ya(typeof self=="object"&&self)||ya(typeof cl=="object"&&cl)||function(){return this}()||cl||Function("return this")(),gg={},Rn=function(s){try{return!!s()}catch{return!0}},X0=Rn,ns=!X0(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),q0=Rn,ih=!q0(function(){var s=(function(){}).bind();return typeof s!="function"||s.hasOwnProperty("prototype")}),Z0=ih,Sa=Function.prototype.call,rh=Z0?Sa.bind(Sa):function(){return Sa.apply(Sa,arguments)},Uy={},Yy={}.propertyIsEnumerable,zy=Object.getOwnPropertyDescriptor,Q0=zy&&!Yy.call({1:2},1);Uy.f=Q0?function(e){var t=zy(this,e);return!!t&&t.enumerable}:Yy;var mg=function(s,e){return{enumerable:!(s&1),configurable:!(s&2),writable:!(s&4),value:e}},Gy=ih,jy=Function.prototype,df=jy.call,J0=Gy&&jy.bind.bind(df,df),tn=Gy?J0:function(s){return function(){return df.apply(s,arguments)}},Ky=tn,eE=Ky({}.toString),tE=Ky("".slice),Hi=function(s){return tE(eE(s),8,-1)},nE=tn,sE=Rn,oE=Hi,Cc=Object,iE=nE("".split),rE=sE(function(){return!Cc("z").propertyIsEnumerable(0)})?function(s){return oE(s)==="String"?iE(s,""):Cc(s)}:Cc,Xy=function(s){return s==null},aE=Xy,lE=TypeError,qy=function(s){if(aE(s))throw new lE("Can't call method on "+s);return s},hE=rE,uE=qy,ah=function(s){return hE(uE(s))},ff=typeof document=="object"&&document.all,cE=typeof ff>"u"&&ff!==void 0,Zy={all:ff,IS_HTMLDDA:cE},Qy=Zy,dE=Qy.all,Lt=Qy.IS_HTMLDDA?function(s){return typeof s=="function"||s===dE}:function(s){return typeof s=="function"},kp=Lt,Jy=Zy,fE=Jy.all,No=Jy.IS_HTMLDDA?function(s){return typeof s=="object"?s!==null:kp(s)||s===fE}:function(s){return typeof s=="object"?s!==null:kp(s)},yc=Yt,gE=Lt,mE=function(s){return gE(s)?s:void 0},Ur=function(s,e){return arguments.length<2?mE(yc[s]):yc[s]&&yc[s][e]},pE=tn,eS=pE({}.isPrototypeOf),pg=typeof navigator<"u"&&String(navigator.userAgent)||"",tS=Yt,Sc=pg,Lp=tS.process,Fp=tS.Deno,Vp=Lp&&Lp.versions||Fp&&Fp.version,$p=Vp&&Vp.v8,xn,_l;$p&&(xn=$p.split("."),_l=xn[0]>0&&xn[0]<4?1:+(xn[0]+xn[1]));!_l&&Sc&&(xn=Sc.match(/Edge\/(\d+)/),(!xn||xn[1]>=74)&&(xn=Sc.match(/Chrome\/(\d+)/),xn&&(_l=+xn[1])));var wE=_l,Wp=wE,CE=Rn,yE=Yt,SE=yE.String,wg=!!Object.getOwnPropertySymbols&&!CE(function(){var s=Symbol("symbol detection");return!SE(s)||!(Object(s)instanceof Symbol)||!Symbol.sham&&Wp&&Wp<41}),vE=wg,nS=vE&&!Symbol.sham&&typeof Symbol.iterator=="symbol",bE=Ur,RE=Lt,EE=eS,TE=nS,ME=Object,Cg=TE?function(s){return typeof s=="symbol"}:function(s){var e=bE("Symbol");return RE(e)&&EE(e.prototype,ME(s))},OE=String,sS=function(s){try{return OE(s)}catch{return"Object"}},IE=Lt,_E=sS,AE=TypeError,yg=function(s){if(IE(s))return s;throw new AE(_E(s)+" is not a function")},xE=yg,HE=Xy,DE=function(s,e){var t=s[e];return HE(t)?void 0:xE(t)},vc=rh,bc=Lt,Rc=No,PE=TypeError,NE=function(s,e){var t,n;if(e==="string"&&bc(t=s.toString)&&!Rc(n=vc(t,s))||bc(t=s.valueOf)&&!Rc(n=vc(t,s))||e!=="string"&&bc(t=s.toString)&&!Rc(n=vc(t,s)))return n;throw new PE("Can't convert object to primitive value")},oS={exports:{}},Bp=Yt,kE=Object.defineProperty,Sg=function(s,e){try{kE(Bp,s,{value:e,configurable:!0,writable:!0})}catch{Bp[s]=e}return e},LE=Yt,FE=Sg,Up="__core-js_shared__",VE=LE[Up]||FE(Up,{}),vg=VE,Yp=vg;(oS.exports=function(s,e){return Yp[s]||(Yp[s]=e!==void 0?e:{})})("versions",[]).push({version:"3.33.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.2/LICENSE",source:"https://github.com/zloirock/core-js"});var iS=oS.exports,$E=qy,WE=Object,lh=function(s){return WE($E(s))},BE=tn,UE=lh,YE=BE({}.hasOwnProperty),Os=Object.hasOwn||function(e,t){return YE(UE(e),t)},zE=tn,GE=0,jE=Math.random(),KE=zE(1 .toString),rS=function(s){return"Symbol("+(s===void 0?"":s)+")_"+KE(++GE+jE,36)},XE=Yt,qE=iS,zp=Os,ZE=rS,QE=wg,JE=nS,gi=XE.Symbol,Ec=qE("wks"),eT=JE?gi.for||gi:gi&&gi.withoutSetter||ZE,hh=function(s){return zp(Ec,s)||(Ec[s]=QE&&zp(gi,s)?gi[s]:eT("Symbol."+s)),Ec[s]},tT=rh,Gp=No,jp=Cg,nT=DE,sT=NE,oT=hh,iT=TypeError,rT=oT("toPrimitive"),aT=function(s,e){if(!Gp(s)||jp(s))return s;var t=nT(s,rT),n;if(t){if(e===void 0&&(e="default"),n=tT(t,s,e),!Gp(n)||jp(n))return n;throw new iT("Can't convert object to primitive value")}return e===void 0&&(e="number"),sT(s,e)},lT=aT,hT=Cg,aS=function(s){var e=lT(s,"string");return hT(e)?e:e+""},uT=Yt,Kp=No,gf=uT.document,cT=Kp(gf)&&Kp(gf.createElement),bg=function(s){return cT?gf.createElement(s):{}},dT=ns,fT=Rn,gT=bg,lS=!dT&&!fT(function(){return Object.defineProperty(gT("div"),"a",{get:function(){return 7}}).a!==7}),mT=ns,pT=rh,wT=Uy,CT=mg,yT=ah,ST=aS,vT=Os,bT=lS,Xp=Object.getOwnPropertyDescriptor;gg.f=mT?Xp:function(e,t){if(e=yT(e),t=ST(t),bT)try{return Xp(e,t)}catch{}if(vT(e,t))return CT(!pT(wT.f,e,t),e[t])};var ko={},RT=ns,ET=Rn,hS=RT&&ET(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),TT=No,MT=String,OT=TypeError,Yr=function(s){if(TT(s))return s;throw new OT(MT(s)+" is not an object")},IT=ns,_T=lS,AT=hS,va=Yr,qp=aS,xT=TypeError,Tc=Object.defineProperty,HT=Object.getOwnPropertyDescriptor,Mc="enumerable",Oc="configurable",Ic="writable";ko.f=IT?AT?function(e,t,n){if(va(e),t=qp(t),va(n),typeof e=="function"&&t==="prototype"&&"value"in n&&Ic in n&&!n[Ic]){var o=HT(e,t);o&&o[Ic]&&(e[t]=n.value,n={configurable:Oc in n?n[Oc]:o[Oc],enumerable:Mc in n?n[Mc]:o[Mc],writable:!1})}return Tc(e,t,n)}:Tc:function(e,t,n){if(va(e),t=qp(t),va(n),_T)try{return Tc(e,t,n)}catch{}if("get"in n||"set"in n)throw new xT("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var DT=ns,PT=ko,NT=mg,zr=DT?function(s,e,t){return PT.f(s,e,NT(1,t))}:function(s,e,t){return s[e]=t,s},uS={exports:{}},mf=ns,kT=Os,cS=Function.prototype,LT=mf&&Object.getOwnPropertyDescriptor,Rg=kT(cS,"name"),FT=Rg&&(function(){}).name==="something",VT=Rg&&(!mf||mf&&LT(cS,"name").configurable),$T={EXISTS:Rg,PROPER:FT,CONFIGURABLE:VT},WT=tn,BT=Lt,pf=vg,UT=WT(Function.toString);BT(pf.inspectSource)||(pf.inspectSource=function(s){return UT(s)});var YT=pf.inspectSource,zT=Yt,GT=Lt,Zp=zT.WeakMap,jT=GT(Zp)&&/native code/.test(String(Zp)),KT=iS,XT=rS,Qp=KT("keys"),dS=function(s){return Qp[s]||(Qp[s]=XT(s))},Eg={},qT=jT,fS=Yt,ZT=No,QT=zr,_c=Os,Ac=vg,JT=dS,eM=Eg,Jp="Object already initialized",wf=fS.TypeError,tM=fS.WeakMap,Al,Mr,xl,nM=function(s){return xl(s)?Mr(s):Al(s,{})},sM=function(s){return function(e){var t;if(!ZT(e)||(t=Mr(e)).type!==s)throw new wf("Incompatible receiver, "+s+" required");return t}};if(qT||Ac.state){var $n=Ac.state||(Ac.state=new tM);$n.get=$n.get,$n.has=$n.has,$n.set=$n.set,Al=function(s,e){if($n.has(s))throw new wf(Jp);return e.facade=s,$n.set(s,e),e},Mr=function(s){return $n.get(s)||{}},xl=function(s){return $n.has(s)}}else{var zo=JT("state");eM[zo]=!0,Al=function(s,e){if(_c(s,zo))throw new wf(Jp);return e.facade=s,QT(s,zo,e),e},Mr=function(s){return _c(s,zo)?s[zo]:{}},xl=function(s){return _c(s,zo)}}var oM={set:Al,get:Mr,has:xl,enforce:nM,getterFor:sM},Tg=tn,iM=Rn,rM=Lt,ba=Os,Cf=ns,aM=$T.CONFIGURABLE,lM=YT,gS=oM,hM=gS.enforce,uM=gS.get,ew=String,dl=Object.defineProperty,cM=Tg("".slice),dM=Tg("".replace),fM=Tg([].join),gM=Cf&&!iM(function(){return dl(function(){},"length",{value:8}).length!==8}),mM=String(String).split("String"),pM=uS.exports=function(s,e,t){cM(ew(e),0,7)==="Symbol("&&(e="["+dM(ew(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!ba(s,"name")||aM&&s.name!==e)&&(Cf?dl(s,"name",{value:e,configurable:!0}):s.name=e),gM&&t&&ba(t,"arity")&&s.length!==t.arity&&dl(s,"length",{value:t.arity});try{t&&ba(t,"constructor")&&t.constructor?Cf&&dl(s,"prototype",{writable:!1}):s.prototype&&(s.prototype=void 0)}catch{}var n=hM(s);return ba(n,"source")||(n.source=fM(mM,typeof e=="string"?e:"")),s};Function.prototype.toString=pM(function(){return rM(this)&&uM(this).source||lM(this)},"toString");var wM=uS.exports,CM=Lt,yM=ko,SM=wM,vM=Sg,bM=function(s,e,t,n){n||(n={});var o=n.enumerable,i=n.name!==void 0?n.name:e;if(CM(t)&&SM(t,i,n),n.global)o?s[e]=t:vM(e,t);else{try{n.unsafe?s[e]&&(o=!0):delete s[e]}catch{}o?s[e]=t:yM.f(s,e,{value:t,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return s},mS={},RM=Math.ceil,EM=Math.floor,TM=Math.trunc||function(e){var t=+e;return(t>0?EM:RM)(t)},MM=TM,Mg=function(s){var e=+s;return e!==e||e===0?0:MM(e)},OM=Mg,IM=Math.max,_M=Math.min,AM=function(s,e){var t=OM(s);return t<0?IM(t+e,0):_M(t,e)},xM=Mg,HM=Math.min,DM=function(s){return s>0?HM(xM(s),9007199254740991):0},PM=DM,uh=function(s){return PM(s.length)},NM=ah,kM=AM,LM=uh,tw=function(s){return function(e,t,n){var o=NM(e),i=LM(o),r=kM(n,i),a;if(s&&t!==t){for(;i>r;)if(a=o[r++],a!==a)return!0}else for(;i>r;r++)if((s||r in o)&&o[r]===t)return s||r||0;return!s&&-1}},FM={includes:tw(!0),indexOf:tw(!1)},VM=tn,xc=Os,$M=ah,WM=FM.indexOf,BM=Eg,nw=VM([].push),pS=function(s,e){var t=$M(s),n=0,o=[],i;for(i in t)!xc(BM,i)&&xc(t,i)&&nw(o,i);for(;e.length>n;)xc(t,i=e[n++])&&(~WM(o,i)||nw(o,i));return o},Og=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],UM=pS,YM=Og,zM=YM.concat("length","prototype");mS.f=Object.getOwnPropertyNames||function(e){return UM(e,zM)};var wS={};wS.f=Object.getOwnPropertySymbols;var GM=Ur,jM=tn,KM=mS,XM=wS,qM=Yr,ZM=jM([].concat),QM=GM("Reflect","ownKeys")||function(e){var t=KM.f(qM(e)),n=XM.f;return n?ZM(t,n(e)):t},sw=Os,JM=QM,e1=gg,t1=ko,CS=function(s,e,t){for(var n=JM(e),o=t1.f,i=e1.f,r=0;r<n.length;r++){var a=n[r];!sw(s,a)&&!(t&&sw(t,a))&&o(s,a,i(e,a))}},n1=Rn,s1=Lt,o1=/#|\.prototype\./,Gr=function(s,e){var t=r1[i1(s)];return t===l1?!0:t===a1?!1:s1(e)?n1(e):!!e},i1=Gr.normalize=function(s){return String(s).replace(o1,".").toLowerCase()},r1=Gr.data={},a1=Gr.NATIVE="N",l1=Gr.POLYFILL="P",h1=Gr,Hc=Yt,u1=gg.f,c1=zr,d1=bM,f1=Sg,g1=CS,m1=h1,Lo=function(s,e){var t=s.target,n=s.global,o=s.stat,i,r,a,l,h,u;if(n?r=Hc:o?r=Hc[t]||f1(t,{}):r=(Hc[t]||{}).prototype,r)for(a in e){if(h=e[a],s.dontCallGetSet?(u=u1(r,a),l=u&&u.value):l=r[a],i=m1(n?a:t+(o?".":"#")+a,s.forced),!i&&l!==void 0){if(typeof h==typeof l)continue;g1(h,l)}(s.sham||l&&l.sham)&&c1(h,"sham",!0),d1(r,a,h,s)}},p1=Hi,yS=Array.isArray||function(e){return p1(e)==="Array"},w1=ns,C1=yS,y1=TypeError,S1=Object.getOwnPropertyDescriptor,v1=w1&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}}(),SS=v1?function(s,e){if(C1(s)&&!S1(s,"length").writable)throw new y1("Cannot set read only .length");return s.length=e}:function(s,e){return s.length=e},b1=TypeError,R1=9007199254740991,vS=function(s){if(s>R1)throw b1("Maximum allowed index exceeded");return s},E1=Lo,T1=lh,M1=uh,O1=SS,I1=vS,_1=Rn,A1=_1(function(){return[].push.call({length:4294967296},1)!==4294967297}),x1=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(s){return s instanceof TypeError}},H1=A1||!x1();E1({target:"Array",proto:!0,arity:1,forced:H1},{push:function(e){var t=T1(this),n=M1(t),o=arguments.length;I1(n+o);for(var i=0;i<o;i++)t[n]=arguments[i],n++;return O1(t,n),n}});var D1=ih,bS=Function.prototype,ow=bS.apply,iw=bS.call,ch=typeof Reflect=="object"&&Reflect.apply||(D1?iw.bind(ow):function(){return iw.apply(ow,arguments)}),P1=tn,N1=yg,k1=function(s,e,t){try{return P1(N1(Object.getOwnPropertyDescriptor(s,e)[t]))}catch{}},L1=Lt,F1=String,V1=TypeError,$1=function(s){if(typeof s=="object"||L1(s))return s;throw new V1("Can't set "+F1(s)+" as a prototype")},W1=k1,B1=Yr,U1=$1,RS=Object.setPrototypeOf||("__proto__"in{}?function(){var s=!1,e={},t;try{t=W1(Object.prototype,"__proto__","set"),t(e,[]),s=e instanceof Array}catch{}return function(o,i){return B1(o),U1(i),s?t(o,i):o.__proto__=i,o}}():void 0),Y1=ko.f,z1=function(s,e,t){t in s||Y1(s,t,{configurable:!0,get:function(){return e[t]},set:function(n){e[t]=n}})},G1=Lt,j1=No,rw=RS,K1=function(s,e,t){var n,o;return rw&&G1(n=e.constructor)&&n!==t&&j1(o=n.prototype)&&o!==t.prototype&&rw(s,o),s},X1=hh,q1=X1("toStringTag"),ES={};ES[q1]="z";var Z1=String(ES)==="[object z]",Q1=Z1,J1=Lt,fl=Hi,eO=hh,tO=eO("toStringTag"),nO=Object,sO=fl(function(){return arguments}())==="Arguments",oO=function(s,e){try{return s[e]}catch{}},iO=Q1?fl:function(s){var e,t,n;return s===void 0?"Undefined":s===null?"Null":typeof(t=oO(e=nO(s),tO))=="string"?t:sO?fl(e):(n=fl(e))==="Object"&&J1(e.callee)?"Arguments":n},rO=iO,aO=String,TS=function(s){if(rO(s)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return aO(s)},lO=TS,hO=function(s,e){return s===void 0?arguments.length<2?"":e:lO(s)},uO=No,cO=zr,dO=function(s,e){uO(e)&&"cause"in e&&cO(s,"cause",e.cause)},fO=tn,MS=Error,gO=fO("".replace),mO=function(s){return String(new MS(s).stack)}("zxcasd"),OS=/\n\s*at [^:]*:[^\n]*/,pO=OS.test(mO),wO=function(s,e){if(pO&&typeof s=="string"&&!MS.prepareStackTrace)for(;e--;)s=gO(s,OS,"");return s},CO=Rn,yO=mg,SO=!CO(function(){var s=new Error("a");return"stack"in s?(Object.defineProperty(s,"stack",yO(1,7)),s.stack!==7):!0}),vO=zr,bO=wO,RO=SO,aw=Error.captureStackTrace,EO=function(s,e,t,n){RO&&(aw?aw(s,e):vO(s,"stack",bO(t,n)))},lw=Ur,TO=Os,hw=zr,MO=eS,uw=RS,cw=CS,dw=z1,OO=K1,IO=hO,_O=dO,AO=EO,xO=ns,HO=function(s,e,t,n){var o="stackTraceLimit",i=n?2:1,r=s.split("."),a=r[r.length-1],l=lw.apply(null,r);if(l){var h=l.prototype;if(TO(h,"cause")&&delete h.cause,!t)return l;var u=lw("Error"),d=e(function(f,m){var w=IO(n?m:f,void 0),C=n?new l(f):new l;return w!==void 0&&hw(C,"message",w),AO(C,d,C.stack,2),this&&MO(h,this)&&OO(C,this,d),arguments.length>i&&_O(C,arguments[i]),C});d.prototype=h,a!=="Error"?uw?uw(d,u):cw(d,u,{name:!0}):xO&&o in l&&(dw(d,l,o),dw(d,l,"prepareStackTrace")),cw(d,l);try{h.name!==a&&hw(h,"name",a),h.constructor=d}catch{}return d}},IS=Lo,DO=Yt,ss=ch,_S=HO,yf="WebAssembly",fw=DO[yf],Hl=new Error("e",{cause:7}).cause!==7,Fo=function(s,e){var t={};t[s]=_S(s,e,Hl),IS({global:!0,constructor:!0,arity:1,forced:Hl},t)},Ig=function(s,e){if(fw&&fw[s]){var t={};t[s]=_S(yf+"."+s,e,Hl),IS({target:yf,stat:!0,constructor:!0,arity:1,forced:Hl},t)}};Fo("Error",function(s){return function(t){return ss(s,this,arguments)}});Fo("EvalError",function(s){return function(t){return ss(s,this,arguments)}});Fo("RangeError",function(s){return function(t){return ss(s,this,arguments)}});Fo("ReferenceError",function(s){return function(t){return ss(s,this,arguments)}});Fo("SyntaxError",function(s){return function(t){return ss(s,this,arguments)}});Fo("TypeError",function(s){return function(t){return ss(s,this,arguments)}});Fo("URIError",function(s){return function(t){return ss(s,this,arguments)}});Ig("CompileError",function(s){return function(t){return ss(s,this,arguments)}});Ig("LinkError",function(s){return function(t){return ss(s,this,arguments)}});Ig("RuntimeError",function(s){return function(t){return ss(s,this,arguments)}});var PO=Hi,NO=tn,kO=function(s){if(PO(s)==="Function")return NO(s)},gw=kO,LO=yg,FO=ih,VO=gw(gw.bind),$O=function(s,e){return LO(s),e===void 0?s:FO?VO(s,e):function(){return s.apply(e,arguments)}},WO=Ur,AS=WO("document","documentElement"),BO=tn,_g=BO([].slice),UO=TypeError,xS=function(s,e){if(s<e)throw new UO("Not enough arguments");return s},YO=pg,zO=/(?:ipad|iphone|ipod).*applewebkit/i.test(YO),GO=Yt,jO=Hi,KO=jO(GO.process)==="process",fn=Yt,XO=ch,qO=$O,mw=Lt,ZO=Os,HS=Rn,pw=AS,QO=_g,ww=bg,JO=xS,eI=zO,tI=KO,Sf=fn.setImmediate,vf=fn.clearImmediate,nI=fn.process,Dc=fn.Dispatch,sI=fn.Function,Cw=fn.MessageChannel,oI=fn.String,Pc=0,dr={},yw="onreadystatechange",Or,ro,Nc,kc;HS(function(){Or=fn.location});var Ag=function(s){if(ZO(dr,s)){var e=dr[s];delete dr[s],e()}},Lc=function(s){return function(){Ag(s)}},Sw=function(s){Ag(s.data)},vw=function(s){fn.postMessage(oI(s),Or.protocol+"//"+Or.host)};(!Sf||!vf)&&(Sf=function(e){JO(arguments.length,1);var t=mw(e)?e:sI(e),n=QO(arguments,1);return dr[++Pc]=function(){XO(t,void 0,n)},ro(Pc),Pc},vf=function(e){delete dr[e]},tI?ro=function(s){nI.nextTick(Lc(s))}:Dc&&Dc.now?ro=function(s){Dc.now(Lc(s))}:Cw&&!eI?(Nc=new Cw,kc=Nc.port2,Nc.port1.onmessage=Sw,ro=qO(kc.postMessage,kc)):fn.addEventListener&&mw(fn.postMessage)&&!fn.importScripts&&Or&&Or.protocol!=="file:"&&!HS(vw)?(ro=vw,fn.addEventListener("message",Sw,!1)):yw in ww("script")?ro=function(s){pw.appendChild(ww("script"))[yw]=function(){pw.removeChild(this),Ag(s)}}:ro=function(s){setTimeout(Lc(s),0)});var DS={set:Sf,clear:vf},iI=Lo,rI=Yt,bw=DS.clear;iI({global:!0,bind:!0,enumerable:!0,forced:rI.clearImmediate!==bw},{clearImmediate:bw});var aI=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",PS=Yt,lI=ch,hI=Lt,uI=aI,cI=pg,dI=_g,fI=xS,gI=PS.Function,mI=/MSIE .\./.test(cI)||uI&&function(){var s=PS.Bun.version.split(".");return s.length<3||s[0]==="0"&&(s[1]<3||s[1]==="3"&&s[2]==="0")}(),pI=function(s,e){var t=e?2:1;return mI?function(n,o){var i=fI(arguments.length,1)>t,r=hI(n)?n:gI(n),a=i?dI(arguments,t):[],l=i?function(){lI(r,this,a)}:r;return e?s(l,o):s(l)}:s},wI=Lo,NS=Yt,Rw=DS.set,CI=pI,Ew=NS.setImmediate?CI(Rw,!1):Rw;wI({global:!0,bind:!0,enumerable:!0,forced:NS.setImmediate!==Ew},{setImmediate:Ew});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Us(s){"@babel/helpers - typeof";return Us=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Us(s)}function bf(s,e){return bf=Object.setPrototypeOf||function(n,o){return n.__proto__=o,n},bf(s,e)}function yI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function gl(s,e,t){return yI()?gl=Reflect.construct:gl=function(o,i,r){var a=[null];a.push.apply(a,i);var l=Function.bind.apply(o,a),h=new l;return r&&bf(h,r.prototype),h},gl.apply(null,arguments)}function An(s){return SI(s)||vI(s)||bI(s)||RI()}function SI(s){if(Array.isArray(s))return Rf(s)}function vI(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function bI(s,e){if(s){if(typeof s=="string")return Rf(s,e);var t=Object.prototype.toString.call(s).slice(8,-1);if(t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set")return Array.from(s);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Rf(s,e)}}function Rf(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=s[t];return n}function RI(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var EI=Object.hasOwnProperty,Tw=Object.setPrototypeOf,TI=Object.isFrozen,MI=Object.getPrototypeOf,OI=Object.getOwnPropertyDescriptor,en=Object.freeze,Pn=Object.seal,II=Object.create,kS=typeof Reflect<"u"&&Reflect,Dl=kS.apply,Ef=kS.construct;Dl||(Dl=function(e,t,n){return e.apply(t,n)});en||(en=function(e){return e});Pn||(Pn=function(e){return e});Ef||(Ef=function(e,t){return gl(e,An(t))});var _I=bn(Array.prototype.forEach),Mw=bn(Array.prototype.pop),Ui=bn(Array.prototype.push),ml=bn(String.prototype.toLowerCase),Fc=bn(String.prototype.toString),AI=bn(String.prototype.match),On=bn(String.prototype.replace),xI=bn(String.prototype.indexOf),HI=bn(String.prototype.trim),Kt=bn(RegExp.prototype.test),Vc=DI(TypeError);function bn(s){return function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return Dl(s,e,n)}}function DI(s){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ef(s,t)}}function We(s,e,t){var n;t=(n=t)!==null&&n!==void 0?n:ml,Tw&&Tw(s,null);for(var o=e.length;o--;){var i=e[o];if(typeof i=="string"){var r=t(i);r!==i&&(TI(e)||(e[o]=r),i=r)}s[i]=!0}return s}function ao(s){var e=II(null),t;for(t in s)Dl(EI,s,[t])===!0&&(e[t]=s[t]);return e}function Ra(s,e){for(;s!==null;){var t=OI(s,e);if(t){if(t.get)return bn(t.get);if(typeof t.value=="function")return bn(t.value)}s=MI(s)}function n(o){return console.warn("fallback value for",o),null}return n}var Ow=en(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),$c=en(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wc=en(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),PI=en(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Bc=en(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),NI=en(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Iw=en(["#text"]),_w=en(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Uc=en(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Aw=en(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ea=en(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),kI=Pn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),LI=Pn(/<%[\w\W]*|[\w\W]*%>/gm),FI=Pn(/\${[\w\W]*}/gm),VI=Pn(/^data-[\-\w.\u00B7-\uFFFF]/),$I=Pn(/^aria-[\-\w]+$/),WI=Pn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),BI=Pn(/^(?:\w+script|data):/i),UI=Pn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),YI=Pn(/^html$/i),zI=function(){return typeof window>"u"?null:window},GI=function(e,t){if(Us(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(n=t.currentScript.getAttribute(o));var i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function LS(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zI(),e=function(k){return LS(k)};if(e.version="2.4.7",e.removed=[],!s||!s.document||s.document.nodeType!==9)return e.isSupported=!1,e;var t=s.document,n=s.document,o=s.DocumentFragment,i=s.HTMLTemplateElement,r=s.Node,a=s.Element,l=s.NodeFilter,h=s.NamedNodeMap,u=h===void 0?s.NamedNodeMap||s.MozNamedAttrMap:h,d=s.HTMLFormElement,f=s.DOMParser,m=s.trustedTypes,w=a.prototype,C=Ra(w,"cloneNode"),R=Ra(w,"nextSibling"),H=Ra(w,"childNodes"),A=Ra(w,"parentNode");if(typeof i=="function"){var _=n.createElement("template");_.content&&_.content.ownerDocument&&(n=_.content.ownerDocument)}var O=GI(m,t),D=O?O.createHTML(""):"",G=n,z=G.implementation,ee=G.createNodeIterator,X=G.createDocumentFragment,q=G.getElementsByTagName,oe=t.importNode,ie={};try{ie=ao(n).documentMode?n.documentMode:{}}catch{}var re={};e.isSupported=typeof A=="function"&&z&&z.createHTMLDocument!==void 0&&ie!==9;var pe=kI,Me=LI,ze=FI,Ae=VI,b=$I,c=BI,g=UI,p=WI,v=null,E=We({},[].concat(An(Ow),An($c),An(Wc),An(Bc),An(Iw))),M=null,U=We({},[].concat(An(_w),An(Uc),An(Aw),An(Ea))),$=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Q=null,j=!0,ge=!0,xe=!1,Re=!0,Ee=!1,Y=!1,Ye=!1,Ne=!1,Se=!1,Ie=!1,ye=!1,y=!0,S=!1,T="user-content-",V=!0,x=!1,F={},P=null,N=We({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),W=null,L=We({},["audio","video","img","source","image","track"]),B=null,se=We({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ue="http://www.w3.org/1998/Math/MathML",Ce="http://www.w3.org/2000/svg",Te="http://www.w3.org/1999/xhtml",Pe=Te,ot=!1,Be=null,Ze=We({},[ue,Ce,Te],Fc),ut,Yo=["application/xhtml+xml","text/html"],Wi="text/html",St,Nt=null,io=n.createElement("form"),jt=function(k){return k instanceof RegExp||k instanceof Function},_t=function(k){Nt&&Nt===k||((!k||Us(k)!=="object")&&(k={}),k=ao(k),ut=Yo.indexOf(k.PARSER_MEDIA_TYPE)===-1?ut=Wi:ut=k.PARSER_MEDIA_TYPE,St=ut==="application/xhtml+xml"?Fc:ml,v="ALLOWED_TAGS"in k?We({},k.ALLOWED_TAGS,St):E,M="ALLOWED_ATTR"in k?We({},k.ALLOWED_ATTR,St):U,Be="ALLOWED_NAMESPACES"in k?We({},k.ALLOWED_NAMESPACES,Fc):Ze,B="ADD_URI_SAFE_ATTR"in k?We(ao(se),k.ADD_URI_SAFE_ATTR,St):se,W="ADD_DATA_URI_TAGS"in k?We(ao(L),k.ADD_DATA_URI_TAGS,St):L,P="FORBID_CONTENTS"in k?We({},k.FORBID_CONTENTS,St):N,K="FORBID_TAGS"in k?We({},k.FORBID_TAGS,St):{},Q="FORBID_ATTR"in k?We({},k.FORBID_ATTR,St):{},F="USE_PROFILES"in k?k.USE_PROFILES:!1,j=k.ALLOW_ARIA_ATTR!==!1,ge=k.ALLOW_DATA_ATTR!==!1,xe=k.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=k.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ee=k.SAFE_FOR_TEMPLATES||!1,Y=k.WHOLE_DOCUMENT||!1,Se=k.RETURN_DOM||!1,Ie=k.RETURN_DOM_FRAGMENT||!1,ye=k.RETURN_TRUSTED_TYPE||!1,Ne=k.FORCE_BODY||!1,y=k.SANITIZE_DOM!==!1,S=k.SANITIZE_NAMED_PROPS||!1,V=k.KEEP_CONTENT!==!1,x=k.IN_PLACE||!1,p=k.ALLOWED_URI_REGEXP||p,Pe=k.NAMESPACE||Te,$=k.CUSTOM_ELEMENT_HANDLING||{},k.CUSTOM_ELEMENT_HANDLING&&jt(k.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&($.tagNameCheck=k.CUSTOM_ELEMENT_HANDLING.tagNameCheck),k.CUSTOM_ELEMENT_HANDLING&&jt(k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&($.attributeNameCheck=k.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),k.CUSTOM_ELEMENT_HANDLING&&typeof k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&($.allowCustomizedBuiltInElements=k.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ee&&(ge=!1),Ie&&(Se=!0),F&&(v=We({},An(Iw)),M=[],F.html===!0&&(We(v,Ow),We(M,_w)),F.svg===!0&&(We(v,$c),We(M,Uc),We(M,Ea)),F.svgFilters===!0&&(We(v,Wc),We(M,Uc),We(M,Ea)),F.mathMl===!0&&(We(v,Bc),We(M,Aw),We(M,Ea))),k.ADD_TAGS&&(v===E&&(v=ao(v)),We(v,k.ADD_TAGS,St)),k.ADD_ATTR&&(M===U&&(M=ao(M)),We(M,k.ADD_ATTR,St)),k.ADD_URI_SAFE_ATTR&&We(B,k.ADD_URI_SAFE_ATTR,St),k.FORBID_CONTENTS&&(P===N&&(P=ao(P)),We(P,k.FORBID_CONTENTS,St)),V&&(v["#text"]=!0),Y&&We(v,["html","head","body"]),v.table&&(We(v,["tbody"]),delete K.tbody),en&&en(k),Nt=k)},rt=We({},["mi","mo","mn","ms","mtext"]),Ip=We({},["foreignobject","desc","title","annotation-xml"]),U0=We({},["title","style","font","a","script"]),wa=We({},$c);We(wa,Wc),We(wa,PI);var mc=We({},Bc);We(mc,NI);var Y0=function(k){var ne=A(k);(!ne||!ne.tagName)&&(ne={namespaceURI:Pe,tagName:"template"});var ae=ml(k.tagName),qe=ml(ne.tagName);return Be[k.namespaceURI]?k.namespaceURI===Ce?ne.namespaceURI===Te?ae==="svg":ne.namespaceURI===ue?ae==="svg"&&(qe==="annotation-xml"||rt[qe]):!!wa[ae]:k.namespaceURI===ue?ne.namespaceURI===Te?ae==="math":ne.namespaceURI===Ce?ae==="math"&&Ip[qe]:!!mc[ae]:k.namespaceURI===Te?ne.namespaceURI===Ce&&!Ip[qe]||ne.namespaceURI===ue&&!rt[qe]?!1:!mc[ae]&&(U0[ae]||!wa[ae]):!!(ut==="application/xhtml+xml"&&Be[k.namespaceURI]):!1},as=function(k){Ui(e.removed,{element:k});try{k.parentNode.removeChild(k)}catch{try{k.outerHTML=D}catch{k.remove()}}},pc=function(k,ne){try{Ui(e.removed,{attribute:ne.getAttributeNode(k),from:ne})}catch{Ui(e.removed,{attribute:null,from:ne})}if(ne.removeAttribute(k),k==="is"&&!M[k])if(Se||Ie)try{as(ne)}catch{}else try{ne.setAttribute(k,"")}catch{}},_p=function(k){var ne,ae;if(Ne)k="<remove></remove>"+k;else{var qe=AI(k,/^[\r\n\t ]+/);ae=qe&&qe[0]}ut==="application/xhtml+xml"&&Pe===Te&&(k='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+k+"</body></html>");var sn=O?O.createHTML(k):k;if(Pe===Te)try{ne=new f().parseFromString(sn,ut)}catch{}if(!ne||!ne.documentElement){ne=z.createDocument(Pe,"template",null);try{ne.documentElement.innerHTML=ot?D:sn}catch{}}var Ft=ne.body||ne.documentElement;return k&&ae&&Ft.insertBefore(n.createTextNode(ae),Ft.childNodes[0]||null),Pe===Te?q.call(ne,Y?"html":"body")[0]:Y?ne.documentElement:Ft},Ap=function(k){return ee.call(k.ownerDocument||k,k,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},z0=function(k){return k instanceof d&&(typeof k.nodeName!="string"||typeof k.textContent!="string"||typeof k.removeChild!="function"||!(k.attributes instanceof u)||typeof k.removeAttribute!="function"||typeof k.setAttribute!="function"||typeof k.namespaceURI!="string"||typeof k.insertBefore!="function"||typeof k.hasChildNodes!="function")},Bi=function(k){return Us(r)==="object"?k instanceof r:k&&Us(k)==="object"&&typeof k.nodeType=="number"&&typeof k.nodeName=="string"},ls=function(k,ne,ae){re[k]&&_I(re[k],function(qe){qe.call(e,ne,ae,Nt)})},xp=function(k){var ne;if(ls("beforeSanitizeElements",k,null),z0(k)||Kt(/[\u0080-\uFFFF]/,k.nodeName))return as(k),!0;var ae=St(k.nodeName);if(ls("uponSanitizeElement",k,{tagName:ae,allowedTags:v}),k.hasChildNodes()&&!Bi(k.firstElementChild)&&(!Bi(k.content)||!Bi(k.content.firstElementChild))&&Kt(/<[/\w]/g,k.innerHTML)&&Kt(/<[/\w]/g,k.textContent)||ae==="select"&&Kt(/<template/i,k.innerHTML))return as(k),!0;if(!v[ae]||K[ae]){if(!K[ae]&&Dp(ae)&&($.tagNameCheck instanceof RegExp&&Kt($.tagNameCheck,ae)||$.tagNameCheck instanceof Function&&$.tagNameCheck(ae)))return!1;if(V&&!P[ae]){var qe=A(k)||k.parentNode,sn=H(k)||k.childNodes;if(sn&&qe)for(var Ft=sn.length,kt=Ft-1;kt>=0;--kt)qe.insertBefore(C(sn[kt],!0),R(k))}return as(k),!0}return k instanceof a&&!Y0(k)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&Kt(/<\/no(script|embed|frames)/i,k.innerHTML)?(as(k),!0):(Ee&&k.nodeType===3&&(ne=k.textContent,ne=On(ne,pe," "),ne=On(ne,Me," "),ne=On(ne,ze," "),k.textContent!==ne&&(Ui(e.removed,{element:k.cloneNode()}),k.textContent=ne)),ls("afterSanitizeElements",k,null),!1)},Hp=function(k,ne,ae){if(y&&(ne==="id"||ne==="name")&&(ae in n||ae in io))return!1;if(!(ge&&!Q[ne]&&Kt(Ae,ne))){if(!(j&&Kt(b,ne))){if(!M[ne]||Q[ne]){if(!(Dp(k)&&($.tagNameCheck instanceof RegExp&&Kt($.tagNameCheck,k)||$.tagNameCheck instanceof Function&&$.tagNameCheck(k))&&($.attributeNameCheck instanceof RegExp&&Kt($.attributeNameCheck,ne)||$.attributeNameCheck instanceof Function&&$.attributeNameCheck(ne))||ne==="is"&&$.allowCustomizedBuiltInElements&&($.tagNameCheck instanceof RegExp&&Kt($.tagNameCheck,ae)||$.tagNameCheck instanceof Function&&$.tagNameCheck(ae))))return!1}else if(!B[ne]){if(!Kt(p,On(ae,g,""))){if(!((ne==="src"||ne==="xlink:href"||ne==="href")&&k!=="script"&&xI(ae,"data:")===0&&W[k])){if(!(xe&&!Kt(c,On(ae,g,"")))){if(ae)return!1}}}}}}return!0},Dp=function(k){return k.indexOf("-")>0},Pp=function(k){var ne,ae,qe,sn;ls("beforeSanitizeAttributes",k,null);var Ft=k.attributes;if(Ft){var kt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M};for(sn=Ft.length;sn--;){ne=Ft[sn];var Ca=ne,Ht=Ca.name,wc=Ca.namespaceURI;if(ae=Ht==="value"?ne.value:HI(ne.value),qe=St(Ht),kt.attrName=qe,kt.attrValue=ae,kt.keepAttr=!0,kt.forceKeepAttr=void 0,ls("uponSanitizeAttribute",k,kt),ae=kt.attrValue,!kt.forceKeepAttr&&(pc(Ht,k),!!kt.keepAttr)){if(!Re&&Kt(/\/>/i,ae)){pc(Ht,k);continue}Ee&&(ae=On(ae,pe," "),ae=On(ae,Me," "),ae=On(ae,ze," "));var Np=St(k.nodeName);if(Hp(Np,qe,ae)){if(S&&(qe==="id"||qe==="name")&&(pc(Ht,k),ae=T+ae),O&&Us(m)==="object"&&typeof m.getAttributeType=="function"&&!wc)switch(m.getAttributeType(Np,qe)){case"TrustedHTML":{ae=O.createHTML(ae);break}case"TrustedScriptURL":{ae=O.createScriptURL(ae);break}}try{wc?k.setAttributeNS(wc,Ht,ae):k.setAttribute(Ht,ae),Mw(e.removed)}catch{}}}}ls("afterSanitizeAttributes",k,null)}},G0=function ve(k){var ne,ae=Ap(k);for(ls("beforeSanitizeShadowDOM",k,null);ne=ae.nextNode();)ls("uponSanitizeShadowNode",ne,null),!xp(ne)&&(ne.content instanceof o&&ve(ne.content),Pp(ne));ls("afterSanitizeShadowDOM",k,null)};return e.sanitize=function(ve){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ne,ae,qe,sn,Ft;if(ot=!ve,ot&&(ve="<!-->"),typeof ve!="string"&&!Bi(ve))if(typeof ve.toString=="function"){if(ve=ve.toString(),typeof ve!="string")throw Vc("dirty is not a string, aborting")}else throw Vc("toString is not a function");if(!e.isSupported){if(Us(s.toStaticHTML)==="object"||typeof s.toStaticHTML=="function"){if(typeof ve=="string")return s.toStaticHTML(ve);if(Bi(ve))return s.toStaticHTML(ve.outerHTML)}return ve}if(Ye||_t(k),e.removed=[],typeof ve=="string"&&(x=!1),x){if(ve.nodeName){var kt=St(ve.nodeName);if(!v[kt]||K[kt])throw Vc("root node is forbidden and cannot be sanitized in-place")}}else if(ve instanceof r)ne=_p("<!---->"),ae=ne.ownerDocument.importNode(ve,!0),ae.nodeType===1&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?ne=ae:ne.appendChild(ae);else{if(!Se&&!Ee&&!Y&&ve.indexOf("<")===-1)return O&&ye?O.createHTML(ve):ve;if(ne=_p(ve),!ne)return Se?null:ye?D:""}ne&&Ne&&as(ne.firstChild);for(var Ca=Ap(x?ve:ne);qe=Ca.nextNode();)qe.nodeType===3&&qe===sn||xp(qe)||(qe.content instanceof o&&G0(qe.content),Pp(qe),sn=qe);if(sn=null,x)return ve;if(Se){if(Ie)for(Ft=X.call(ne.ownerDocument);ne.firstChild;)Ft.appendChild(ne.firstChild);else Ft=ne;return(M.shadowroot||M.shadowrootmod)&&(Ft=oe.call(t,Ft,!0)),Ft}var Ht=Y?ne.outerHTML:ne.innerHTML;return Y&&v["!doctype"]&&ne.ownerDocument&&ne.ownerDocument.doctype&&ne.ownerDocument.doctype.name&&Kt(YI,ne.ownerDocument.doctype.name)&&(Ht="<!DOCTYPE "+ne.ownerDocument.doctype.name+`>
`+Ht),Ee&&(Ht=On(Ht,pe," "),Ht=On(Ht,Me," "),Ht=On(Ht,ze," ")),O&&ye?O.createHTML(Ht):Ht},e.setConfig=function(ve){_t(ve),Ye=!0},e.clearConfig=function(){Nt=null,Ye=!1},e.isValidAttribute=function(ve,k,ne){Nt||_t({});var ae=St(ve),qe=St(k);return Hp(ae,qe,ne)},e.addHook=function(ve,k){typeof k=="function"&&(re[ve]=re[ve]||[],Ui(re[ve],k))},e.removeHook=function(ve){if(re[ve])return Mw(re[ve])},e.removeHooks=function(ve){re[ve]&&(re[ve]=[])},e.removeAllHooks=function(){re={}},e}var jI=LS();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var FS;function Z(){return FS.apply(null,arguments)}function KI(s){FS=s}function Nn(s){return s instanceof Array||Object.prototype.toString.call(s)==="[object Array]"}function Io(s){return s!=null&&Object.prototype.toString.call(s)==="[object Object]"}function Ke(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function xg(s){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(s).length===0;var e;for(e in s)if(Ke(s,e))return!1;return!0}function on(s){return s===void 0}function Ts(s){return typeof s=="number"||Object.prototype.toString.call(s)==="[object Number]"}function jr(s){return s instanceof Date||Object.prototype.toString.call(s)==="[object Date]"}function VS(s,e){var t=[],n,o=s.length;for(n=0;n<o;++n)t.push(e(s[n],n));return t}function Ys(s,e){for(var t in e)Ke(e,t)&&(s[t]=e[t]);return Ke(e,"toString")&&(s.toString=e.toString),Ke(e,"valueOf")&&(s.valueOf=e.valueOf),s}function os(s,e,t,n){return hv(s,e,t,n,!0).utc()}function XI(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ve(s){return s._pf==null&&(s._pf=XI()),s._pf}var Tf;Array.prototype.some?Tf=Array.prototype.some:Tf=function(s){var e=Object(this),t=e.length>>>0,n;for(n=0;n<t;n++)if(n in e&&s.call(this,e[n],n,e))return!0;return!1};function Hg(s){if(s._isValid==null){var e=Ve(s),t=Tf.call(e.parsedDateParts,function(o){return o!=null}),n=!isNaN(s._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t);if(s._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(s))s._isValid=n;else return n}return s._isValid}function dh(s){var e=os(NaN);return s!=null?Ys(Ve(e),s):Ve(e).userInvalidated=!0,e}var xw=Z.momentProperties=[],Yc=!1;function Dg(s,e){var t,n,o,i=xw.length;if(on(e._isAMomentObject)||(s._isAMomentObject=e._isAMomentObject),on(e._i)||(s._i=e._i),on(e._f)||(s._f=e._f),on(e._l)||(s._l=e._l),on(e._strict)||(s._strict=e._strict),on(e._tzm)||(s._tzm=e._tzm),on(e._isUTC)||(s._isUTC=e._isUTC),on(e._offset)||(s._offset=e._offset),on(e._pf)||(s._pf=Ve(e)),on(e._locale)||(s._locale=e._locale),i>0)for(t=0;t<i;t++)n=xw[t],o=e[n],on(o)||(s[n]=o);return s}function Kr(s){Dg(this,s),this._d=new Date(s._d!=null?s._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Yc===!1&&(Yc=!0,Z.updateOffset(this),Yc=!1)}function kn(s){return s instanceof Kr||s!=null&&s._isAMomentObject!=null}function $S(s){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+s)}function En(s,e){var t=!0;return Ys(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,s),t){var n=[],o,i,r,a=arguments.length;for(i=0;i<a;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(r in arguments[0])Ke(arguments[0],r)&&(o+=r+": "+arguments[0][r]+", ");o=o.slice(0,-2)}else o=arguments[i];n.push(o)}$S(s+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var Hw={};function WS(s,e){Z.deprecationHandler!=null&&Z.deprecationHandler(s,e),Hw[s]||($S(e),Hw[s]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function is(s){return typeof Function<"u"&&s instanceof Function||Object.prototype.toString.call(s)==="[object Function]"}function qI(s){var e,t;for(t in s)Ke(s,t)&&(e=s[t],is(e)?this[t]=e:this["_"+t]=e);this._config=s,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Mf(s,e){var t=Ys({},s),n;for(n in e)Ke(e,n)&&(Io(s[n])&&Io(e[n])?(t[n]={},Ys(t[n],s[n]),Ys(t[n],e[n])):e[n]!=null?t[n]=e[n]:delete t[n]);for(n in s)Ke(s,n)&&!Ke(e,n)&&Io(s[n])&&(t[n]=Ys({},t[n]));return t}function Pg(s){s!=null&&this.set(s)}var Of;Object.keys?Of=Object.keys:Of=function(s){var e,t=[];for(e in s)Ke(s,e)&&t.push(e);return t};var ZI={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function QI(s,e,t){var n=this._calendar[s]||this._calendar.sameElse;return is(n)?n.call(e,t):n}function ts(s,e,t){var n=""+Math.abs(s),o=e-n.length,i=s>=0;return(i?t?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+n}var Ng=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ta=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,zc={},yi={};function be(s,e,t,n){var o=n;typeof n=="string"&&(o=function(){return this[n]()}),s&&(yi[s]=o),e&&(yi[e[0]]=function(){return ts(o.apply(this,arguments),e[1],e[2])}),t&&(yi[t]=function(){return this.localeData().ordinal(o.apply(this,arguments),s)})}function JI(s){return s.match(/\[[\s\S]/)?s.replace(/^\[|\]$/g,""):s.replace(/\\/g,"")}function e_(s){var e=s.match(Ng),t,n;for(t=0,n=e.length;t<n;t++)yi[e[t]]?e[t]=yi[e[t]]:e[t]=JI(e[t]);return function(o){var i="",r;for(r=0;r<n;r++)i+=is(e[r])?e[r].call(o,s):e[r];return i}}function pl(s,e){return s.isValid()?(e=BS(e,s.localeData()),zc[e]=zc[e]||e_(e),zc[e](s)):s.localeData().invalidDate()}function BS(s,e){var t=5;function n(o){return e.longDateFormat(o)||o}for(Ta.lastIndex=0;t>=0&&Ta.test(s);)s=s.replace(Ta,n),Ta.lastIndex=0,t-=1;return s}var t_={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function n_(s){var e=this._longDateFormat[s],t=this._longDateFormat[s.toUpperCase()];return e||!t?e:(this._longDateFormat[s]=t.match(Ng).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[s])}var s_="Invalid date";function o_(){return this._invalidDate}var i_="%d",r_=/\d{1,2}/;function a_(s){return this._ordinal.replace("%d",s)}var l_={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function h_(s,e,t,n){var o=this._relativeTime[t];return is(o)?o(s,e,t,n):o.replace(/%d/i,s)}function u_(s,e){var t=this._relativeTime[s>0?"future":"past"];return is(t)?t(e):t.replace(/%s/i,e)}var fr={};function zt(s,e){var t=s.toLowerCase();fr[t]=fr[t+"s"]=fr[e]=s}function Tn(s){return typeof s=="string"?fr[s]||fr[s.toLowerCase()]:void 0}function kg(s){var e={},t,n;for(n in s)Ke(s,n)&&(t=Tn(n),t&&(e[t]=s[n]));return e}var US={};function Gt(s,e){US[s]=e}function c_(s){var e=[],t;for(t in s)Ke(s,t)&&e.push({unit:t,priority:US[t]});return e.sort(function(n,o){return n.priority-o.priority}),e}function fh(s){return s%4===0&&s%100!==0||s%400===0}function vn(s){return s<0?Math.ceil(s)||0:Math.floor(s)}function Ue(s){var e=+s,t=0;return e!==0&&isFinite(e)&&(t=vn(e)),t}function Di(s,e){return function(t){return t!=null?(YS(this,s,t),Z.updateOffset(this,e),this):Pl(this,s)}}function Pl(s,e){return s.isValid()?s._d["get"+(s._isUTC?"UTC":"")+e]():NaN}function YS(s,e,t){s.isValid()&&!isNaN(t)&&(e==="FullYear"&&fh(s.year())&&s.month()===1&&s.date()===29?(t=Ue(t),s._d["set"+(s._isUTC?"UTC":"")+e](t,s.month(),yh(t,s.month()))):s._d["set"+(s._isUTC?"UTC":"")+e](t))}function d_(s){return s=Tn(s),is(this[s])?this[s]():this}function f_(s,e){if(typeof s=="object"){s=kg(s);var t=c_(s),n,o=t.length;for(n=0;n<o;n++)this[t[n].unit](s[t[n].unit])}else if(s=Tn(s),is(this[s]))return this[s](e);return this}var zS=/\d/,mn=/\d\d/,GS=/\d{3}/,Lg=/\d{4}/,gh=/[+-]?\d{6}/,ht=/\d\d?/,jS=/\d\d\d\d?/,KS=/\d\d\d\d\d\d?/,mh=/\d{1,3}/,Fg=/\d{1,4}/,ph=/[+-]?\d{1,6}/,Pi=/\d+/,wh=/[+-]?\d+/,g_=/Z|[+-]\d\d:?\d\d/gi,Ch=/Z|[+-]\d\d(?::?\d\d)?/gi,m_=/[+-]?\d+(\.\d{1,3})?/,Xr=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Nl;Nl={};function fe(s,e,t){Nl[s]=is(e)?e:function(n,o){return n&&t?t:e}}function p_(s,e){return Ke(Nl,s)?Nl[s](e._strict,e._locale):new RegExp(w_(s))}function w_(s){return dn(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,o,i){return t||n||o||i}))}function dn(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var If={};function et(s,e){var t,n=e,o;for(typeof s=="string"&&(s=[s]),Ts(e)&&(n=function(i,r){r[e]=Ue(i)}),o=s.length,t=0;t<o;t++)If[s[t]]=n}function qr(s,e){et(s,function(t,n,o,i){o._w=o._w||{},e(t,o._w,o,i)})}function C_(s,e,t){e!=null&&Ke(If,s)&&If[s](e,t._a,t,s)}var Wt=0,Ss=1,Qn=2,At=3,Hn=4,vs=5,Eo=6,y_=7,S_=8;function v_(s,e){return(s%e+e)%e}var Et;Array.prototype.indexOf?Et=Array.prototype.indexOf:Et=function(s){var e;for(e=0;e<this.length;++e)if(this[e]===s)return e;return-1};function yh(s,e){if(isNaN(s)||isNaN(e))return NaN;var t=v_(e,12);return s+=(e-t)/12,t===1?fh(s)?29:28:31-t%7%2}be("M",["MM",2],"Mo",function(){return this.month()+1});be("MMM",0,0,function(s){return this.localeData().monthsShort(this,s)});be("MMMM",0,0,function(s){return this.localeData().months(this,s)});zt("month","M");Gt("month",8);fe("M",ht);fe("MM",ht,mn);fe("MMM",function(s,e){return e.monthsShortRegex(s)});fe("MMMM",function(s,e){return e.monthsRegex(s)});et(["M","MM"],function(s,e){e[Ss]=Ue(s)-1});et(["MMM","MMMM"],function(s,e,t,n){var o=t._locale.monthsParse(s,n,t._strict);o!=null?e[Ss]=o:Ve(t).invalidMonth=s});var b_="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),XS="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),qS=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,R_=Xr,E_=Xr;function T_(s,e){return s?Nn(this._months)?this._months[s.month()]:this._months[(this._months.isFormat||qS).test(e)?"format":"standalone"][s.month()]:Nn(this._months)?this._months:this._months.standalone}function M_(s,e){return s?Nn(this._monthsShort)?this._monthsShort[s.month()]:this._monthsShort[qS.test(e)?"format":"standalone"][s.month()]:Nn(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function O_(s,e,t){var n,o,i,r=s.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)i=os([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(i,"").toLocaleLowerCase();return t?e==="MMM"?(o=Et.call(this._shortMonthsParse,r),o!==-1?o:null):(o=Et.call(this._longMonthsParse,r),o!==-1?o:null):e==="MMM"?(o=Et.call(this._shortMonthsParse,r),o!==-1?o:(o=Et.call(this._longMonthsParse,r),o!==-1?o:null)):(o=Et.call(this._longMonthsParse,r),o!==-1?o:(o=Et.call(this._shortMonthsParse,r),o!==-1?o:null))}function I_(s,e,t){var n,o,i;if(this._monthsParseExact)return O_.call(this,s,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(o=os([2e3,n]),t&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!t&&!this._monthsParse[n]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[n]=new RegExp(i.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[n].test(s))return n;if(t&&e==="MMM"&&this._shortMonthsParse[n].test(s))return n;if(!t&&this._monthsParse[n].test(s))return n}}function ZS(s,e){var t;if(!s.isValid())return s;if(typeof e=="string"){if(/^\d+$/.test(e))e=Ue(e);else if(e=s.localeData().monthsParse(e),!Ts(e))return s}return t=Math.min(s.date(),yh(s.year(),e)),s._d["set"+(s._isUTC?"UTC":"")+"Month"](e,t),s}function QS(s){return s!=null?(ZS(this,s),Z.updateOffset(this,!0),this):Pl(this,"Month")}function __(){return yh(this.year(),this.month())}function A_(s){return this._monthsParseExact?(Ke(this,"_monthsRegex")||JS.call(this),s?this._monthsShortStrictRegex:this._monthsShortRegex):(Ke(this,"_monthsShortRegex")||(this._monthsShortRegex=R_),this._monthsShortStrictRegex&&s?this._monthsShortStrictRegex:this._monthsShortRegex)}function x_(s){return this._monthsParseExact?(Ke(this,"_monthsRegex")||JS.call(this),s?this._monthsStrictRegex:this._monthsRegex):(Ke(this,"_monthsRegex")||(this._monthsRegex=E_),this._monthsStrictRegex&&s?this._monthsStrictRegex:this._monthsRegex)}function JS(){function s(r,a){return a.length-r.length}var e=[],t=[],n=[],o,i;for(o=0;o<12;o++)i=os([2e3,o]),e.push(this.monthsShort(i,"")),t.push(this.months(i,"")),n.push(this.months(i,"")),n.push(this.monthsShort(i,""));for(e.sort(s),t.sort(s),n.sort(s),o=0;o<12;o++)e[o]=dn(e[o]),t[o]=dn(t[o]);for(o=0;o<24;o++)n[o]=dn(n[o]);this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}be("Y",0,0,function(){var s=this.year();return s<=9999?ts(s,4):"+"+s});be(0,["YY",2],0,function(){return this.year()%100});be(0,["YYYY",4],0,"year");be(0,["YYYYY",5],0,"year");be(0,["YYYYYY",6,!0],0,"year");zt("year","y");Gt("year",1);fe("Y",wh);fe("YY",ht,mn);fe("YYYY",Fg,Lg);fe("YYYYY",ph,gh);fe("YYYYYY",ph,gh);et(["YYYYY","YYYYYY"],Wt);et("YYYY",function(s,e){e[Wt]=s.length===2?Z.parseTwoDigitYear(s):Ue(s)});et("YY",function(s,e){e[Wt]=Z.parseTwoDigitYear(s)});et("Y",function(s,e){e[Wt]=parseInt(s,10)});function gr(s){return fh(s)?366:365}Z.parseTwoDigitYear=function(s){return Ue(s)+(Ue(s)>68?1900:2e3)};var ev=Di("FullYear",!0);function H_(){return fh(this.year())}function D_(s,e,t,n,o,i,r){var a;return s<100&&s>=0?(a=new Date(s+400,e,t,n,o,i,r),isFinite(a.getFullYear())&&a.setFullYear(s)):a=new Date(s,e,t,n,o,i,r),a}function Ir(s){var e,t;return s<100&&s>=0?(t=Array.prototype.slice.call(arguments),t[0]=s+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(s)):e=new Date(Date.UTC.apply(null,arguments)),e}function kl(s,e,t){var n=7+e-t,o=(7+Ir(s,0,n).getUTCDay()-e)%7;return-o+n-1}function tv(s,e,t,n,o){var i=(7+t-n)%7,r=kl(s,n,o),a=1+7*(e-1)+i+r,l,h;return a<=0?(l=s-1,h=gr(l)+a):a>gr(s)?(l=s+1,h=a-gr(s)):(l=s,h=a),{year:l,dayOfYear:h}}function _r(s,e,t){var n=kl(s.year(),e,t),o=Math.floor((s.dayOfYear()-n-1)/7)+1,i,r;return o<1?(r=s.year()-1,i=o+Es(r,e,t)):o>Es(s.year(),e,t)?(i=o-Es(s.year(),e,t),r=s.year()+1):(r=s.year(),i=o),{week:i,year:r}}function Es(s,e,t){var n=kl(s,e,t),o=kl(s+1,e,t);return(gr(s)-n+o)/7}be("w",["ww",2],"wo","week");be("W",["WW",2],"Wo","isoWeek");zt("week","w");zt("isoWeek","W");Gt("week",5);Gt("isoWeek",5);fe("w",ht);fe("ww",ht,mn);fe("W",ht);fe("WW",ht,mn);qr(["w","ww","W","WW"],function(s,e,t,n){e[n.substr(0,1)]=Ue(s)});function P_(s){return _r(s,this._week.dow,this._week.doy).week}var N_={dow:0,doy:6};function k_(){return this._week.dow}function L_(){return this._week.doy}function F_(s){var e=this.localeData().week(this);return s==null?e:this.add((s-e)*7,"d")}function V_(s){var e=_r(this,1,4).week;return s==null?e:this.add((s-e)*7,"d")}be("d",0,"do","day");be("dd",0,0,function(s){return this.localeData().weekdaysMin(this,s)});be("ddd",0,0,function(s){return this.localeData().weekdaysShort(this,s)});be("dddd",0,0,function(s){return this.localeData().weekdays(this,s)});be("e",0,0,"weekday");be("E",0,0,"isoWeekday");zt("day","d");zt("weekday","e");zt("isoWeekday","E");Gt("day",11);Gt("weekday",11);Gt("isoWeekday",11);fe("d",ht);fe("e",ht);fe("E",ht);fe("dd",function(s,e){return e.weekdaysMinRegex(s)});fe("ddd",function(s,e){return e.weekdaysShortRegex(s)});fe("dddd",function(s,e){return e.weekdaysRegex(s)});qr(["dd","ddd","dddd"],function(s,e,t,n){var o=t._locale.weekdaysParse(s,n,t._strict);o!=null?e.d=o:Ve(t).invalidWeekday=s});qr(["d","e","E"],function(s,e,t,n){e[n]=Ue(s)});function $_(s,e){return typeof s!="string"?s:isNaN(s)?(s=e.weekdaysParse(s),typeof s=="number"?s:null):parseInt(s,10)}function W_(s,e){return typeof s=="string"?e.weekdaysParse(s)%7||7:isNaN(s)?null:s}function Vg(s,e){return s.slice(e,7).concat(s.slice(0,e))}var B_="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),nv="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),U_="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Y_=Xr,z_=Xr,G_=Xr;function j_(s,e){var t=Nn(this._weekdays)?this._weekdays:this._weekdays[s&&s!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return s===!0?Vg(t,this._week.dow):s?t[s.day()]:t}function K_(s){return s===!0?Vg(this._weekdaysShort,this._week.dow):s?this._weekdaysShort[s.day()]:this._weekdaysShort}function X_(s){return s===!0?Vg(this._weekdaysMin,this._week.dow):s?this._weekdaysMin[s.day()]:this._weekdaysMin}function q_(s,e,t){var n,o,i,r=s.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)i=os([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(i,"").toLocaleLowerCase();return t?e==="dddd"?(o=Et.call(this._weekdaysParse,r),o!==-1?o:null):e==="ddd"?(o=Et.call(this._shortWeekdaysParse,r),o!==-1?o:null):(o=Et.call(this._minWeekdaysParse,r),o!==-1?o:null):e==="dddd"?(o=Et.call(this._weekdaysParse,r),o!==-1||(o=Et.call(this._shortWeekdaysParse,r),o!==-1)?o:(o=Et.call(this._minWeekdaysParse,r),o!==-1?o:null)):e==="ddd"?(o=Et.call(this._shortWeekdaysParse,r),o!==-1||(o=Et.call(this._weekdaysParse,r),o!==-1)?o:(o=Et.call(this._minWeekdaysParse,r),o!==-1?o:null)):(o=Et.call(this._minWeekdaysParse,r),o!==-1||(o=Et.call(this._weekdaysParse,r),o!==-1)?o:(o=Et.call(this._shortWeekdaysParse,r),o!==-1?o:null))}function Z_(s,e,t){var n,o,i;if(this._weekdaysParseExact)return q_.call(this,s,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(o=os([2e3,1]).day(n),t&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[n]=new RegExp(i.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[n].test(s))return n;if(t&&e==="ddd"&&this._shortWeekdaysParse[n].test(s))return n;if(t&&e==="dd"&&this._minWeekdaysParse[n].test(s))return n;if(!t&&this._weekdaysParse[n].test(s))return n}}function Q_(s){if(!this.isValid())return s!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return s!=null?(s=$_(s,this.localeData()),this.add(s-e,"d")):e}function J_(s){if(!this.isValid())return s!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return s==null?e:this.add(s-e,"d")}function eA(s){if(!this.isValid())return s!=null?this:NaN;if(s!=null){var e=W_(s,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function tA(s){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||$g.call(this),s?this._weekdaysStrictRegex:this._weekdaysRegex):(Ke(this,"_weekdaysRegex")||(this._weekdaysRegex=Y_),this._weekdaysStrictRegex&&s?this._weekdaysStrictRegex:this._weekdaysRegex)}function nA(s){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||$g.call(this),s?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ke(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=z_),this._weekdaysShortStrictRegex&&s?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function sA(s){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||$g.call(this),s?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ke(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=G_),this._weekdaysMinStrictRegex&&s?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function $g(){function s(u,d){return d.length-u.length}var e=[],t=[],n=[],o=[],i,r,a,l,h;for(i=0;i<7;i++)r=os([2e3,1]).day(i),a=dn(this.weekdaysMin(r,"")),l=dn(this.weekdaysShort(r,"")),h=dn(this.weekdays(r,"")),e.push(a),t.push(l),n.push(h),o.push(a),o.push(l),o.push(h);e.sort(s),t.sort(s),n.sort(s),o.sort(s),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Wg(){return this.hours()%12||12}function oA(){return this.hours()||24}be("H",["HH",2],0,"hour");be("h",["hh",2],0,Wg);be("k",["kk",2],0,oA);be("hmm",0,0,function(){return""+Wg.apply(this)+ts(this.minutes(),2)});be("hmmss",0,0,function(){return""+Wg.apply(this)+ts(this.minutes(),2)+ts(this.seconds(),2)});be("Hmm",0,0,function(){return""+this.hours()+ts(this.minutes(),2)});be("Hmmss",0,0,function(){return""+this.hours()+ts(this.minutes(),2)+ts(this.seconds(),2)});function sv(s,e){be(s,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}sv("a",!0);sv("A",!1);zt("hour","h");Gt("hour",13);function ov(s,e){return e._meridiemParse}fe("a",ov);fe("A",ov);fe("H",ht);fe("h",ht);fe("k",ht);fe("HH",ht,mn);fe("hh",ht,mn);fe("kk",ht,mn);fe("hmm",jS);fe("hmmss",KS);fe("Hmm",jS);fe("Hmmss",KS);et(["H","HH"],At);et(["k","kk"],function(s,e,t){var n=Ue(s);e[At]=n===24?0:n});et(["a","A"],function(s,e,t){t._isPm=t._locale.isPM(s),t._meridiem=s});et(["h","hh"],function(s,e,t){e[At]=Ue(s),Ve(t).bigHour=!0});et("hmm",function(s,e,t){var n=s.length-2;e[At]=Ue(s.substr(0,n)),e[Hn]=Ue(s.substr(n)),Ve(t).bigHour=!0});et("hmmss",function(s,e,t){var n=s.length-4,o=s.length-2;e[At]=Ue(s.substr(0,n)),e[Hn]=Ue(s.substr(n,2)),e[vs]=Ue(s.substr(o)),Ve(t).bigHour=!0});et("Hmm",function(s,e,t){var n=s.length-2;e[At]=Ue(s.substr(0,n)),e[Hn]=Ue(s.substr(n))});et("Hmmss",function(s,e,t){var n=s.length-4,o=s.length-2;e[At]=Ue(s.substr(0,n)),e[Hn]=Ue(s.substr(n,2)),e[vs]=Ue(s.substr(o))});function iA(s){return(s+"").toLowerCase().charAt(0)==="p"}var rA=/[ap]\.?m?\.?/i,aA=Di("Hours",!0);function lA(s,e,t){return s>11?t?"pm":"PM":t?"am":"AM"}var iv={calendar:ZI,longDateFormat:t_,invalidDate:s_,ordinal:i_,dayOfMonthOrdinalParse:r_,relativeTime:l_,months:b_,monthsShort:XS,week:N_,weekdays:B_,weekdaysMin:U_,weekdaysShort:nv,meridiemParse:rA},ct={},Yi={},Ar;function hA(s,e){var t,n=Math.min(s.length,e.length);for(t=0;t<n;t+=1)if(s[t]!==e[t])return t;return n}function Dw(s){return s&&s.toLowerCase().replace("_","-")}function uA(s){for(var e=0,t,n,o,i;e<s.length;){for(i=Dw(s[e]).split("-"),t=i.length,n=Dw(s[e+1]),n=n?n.split("-"):null;t>0;){if(o=Sh(i.slice(0,t).join("-")),o)return o;if(n&&n.length>=t&&hA(i,n)>=t-1)break;t--}e++}return Ar}function cA(s){return s.match("^[^/\\\\]*$")!=null}function Sh(s){var e=null,t;if(ct[s]===void 0&&typeof Il<"u"&&Il&&Il.exports&&cA(s))try{e=Ar._abbr,t=require,t("./locale/"+s),Gs(e)}catch{ct[s]=null}return ct[s]}function Gs(s,e){var t;return s&&(on(e)?t=Is(s):t=Bg(s,e),t?Ar=t:typeof console<"u"&&console.warn&&console.warn("Locale "+s+" not found. Did you forget to load it?")),Ar._abbr}function Bg(s,e){if(e!==null){var t,n=iv;if(e.abbr=s,ct[s]!=null)WS("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=ct[s]._config;else if(e.parentLocale!=null)if(ct[e.parentLocale]!=null)n=ct[e.parentLocale]._config;else if(t=Sh(e.parentLocale),t!=null)n=t._config;else return Yi[e.parentLocale]||(Yi[e.parentLocale]=[]),Yi[e.parentLocale].push({name:s,config:e}),null;return ct[s]=new Pg(Mf(n,e)),Yi[s]&&Yi[s].forEach(function(o){Bg(o.name,o.config)}),Gs(s),ct[s]}else return delete ct[s],null}function dA(s,e){if(e!=null){var t,n,o=iv;ct[s]!=null&&ct[s].parentLocale!=null?ct[s].set(Mf(ct[s]._config,e)):(n=Sh(s),n!=null&&(o=n._config),e=Mf(o,e),n==null&&(e.abbr=s),t=new Pg(e),t.parentLocale=ct[s],ct[s]=t),Gs(s)}else ct[s]!=null&&(ct[s].parentLocale!=null?(ct[s]=ct[s].parentLocale,s===Gs()&&Gs(s)):ct[s]!=null&&delete ct[s]);return ct[s]}function Is(s){var e;if(s&&s._locale&&s._locale._abbr&&(s=s._locale._abbr),!s)return Ar;if(!Nn(s)){if(e=Sh(s),e)return e;s=[s]}return uA(s)}function fA(){return Of(ct)}function Ug(s){var e,t=s._a;return t&&Ve(s).overflow===-2&&(e=t[Ss]<0||t[Ss]>11?Ss:t[Qn]<1||t[Qn]>yh(t[Wt],t[Ss])?Qn:t[At]<0||t[At]>24||t[At]===24&&(t[Hn]!==0||t[vs]!==0||t[Eo]!==0)?At:t[Hn]<0||t[Hn]>59?Hn:t[vs]<0||t[vs]>59?vs:t[Eo]<0||t[Eo]>999?Eo:-1,Ve(s)._overflowDayOfYear&&(e<Wt||e>Qn)&&(e=Qn),Ve(s)._overflowWeeks&&e===-1&&(e=y_),Ve(s)._overflowWeekday&&e===-1&&(e=S_),Ve(s).overflow=e),s}var gA=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mA=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pA=/Z|[+-]\d\d(?::?\d\d)?/,Ma=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Gc=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],wA=/^\/?Date\((-?\d+)/i,CA=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yA={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function rv(s){var e,t,n=s._i,o=gA.exec(n)||mA.exec(n),i,r,a,l,h=Ma.length,u=Gc.length;if(o){for(Ve(s).iso=!0,e=0,t=h;e<t;e++)if(Ma[e][1].exec(o[1])){r=Ma[e][0],i=Ma[e][2]!==!1;break}if(r==null){s._isValid=!1;return}if(o[3]){for(e=0,t=u;e<t;e++)if(Gc[e][1].exec(o[3])){a=(o[2]||" ")+Gc[e][0];break}if(a==null){s._isValid=!1;return}}if(!i&&a!=null){s._isValid=!1;return}if(o[4])if(pA.exec(o[4]))l="Z";else{s._isValid=!1;return}s._f=r+(a||"")+(l||""),zg(s)}else s._isValid=!1}function SA(s,e,t,n,o,i){var r=[vA(s),XS.indexOf(e),parseInt(t,10),parseInt(n,10),parseInt(o,10)];return i&&r.push(parseInt(i,10)),r}function vA(s){var e=parseInt(s,10);return e<=49?2e3+e:e<=999?1900+e:e}function bA(s){return s.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function RA(s,e,t){if(s){var n=nv.indexOf(s),o=new Date(e[0],e[1],e[2]).getDay();if(n!==o)return Ve(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function EA(s,e,t){if(s)return yA[s];if(e)return 0;var n=parseInt(t,10),o=n%100,i=(n-o)/100;return i*60+o}function av(s){var e=CA.exec(bA(s._i)),t;if(e){if(t=SA(e[4],e[3],e[2],e[5],e[6],e[7]),!RA(e[1],t,s))return;s._a=t,s._tzm=EA(e[8],e[9],e[10]),s._d=Ir.apply(null,s._a),s._d.setUTCMinutes(s._d.getUTCMinutes()-s._tzm),Ve(s).rfc2822=!0}else s._isValid=!1}function TA(s){var e=wA.exec(s._i);if(e!==null){s._d=new Date(+e[1]);return}if(rv(s),s._isValid===!1)delete s._isValid;else return;if(av(s),s._isValid===!1)delete s._isValid;else return;s._strict?s._isValid=!1:Z.createFromInputFallback(s)}Z.createFromInputFallback=En("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(s){s._d=new Date(s._i+(s._useUTC?" UTC":""))});function fi(s,e,t){return s??e??t}function MA(s){var e=new Date(Z.now());return s._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Yg(s){var e,t,n=[],o,i,r;if(!s._d){for(o=MA(s),s._w&&s._a[Qn]==null&&s._a[Ss]==null&&OA(s),s._dayOfYear!=null&&(r=fi(s._a[Wt],o[Wt]),(s._dayOfYear>gr(r)||s._dayOfYear===0)&&(Ve(s)._overflowDayOfYear=!0),t=Ir(r,0,s._dayOfYear),s._a[Ss]=t.getUTCMonth(),s._a[Qn]=t.getUTCDate()),e=0;e<3&&s._a[e]==null;++e)s._a[e]=n[e]=o[e];for(;e<7;e++)s._a[e]=n[e]=s._a[e]==null?e===2?1:0:s._a[e];s._a[At]===24&&s._a[Hn]===0&&s._a[vs]===0&&s._a[Eo]===0&&(s._nextDay=!0,s._a[At]=0),s._d=(s._useUTC?Ir:D_).apply(null,n),i=s._useUTC?s._d.getUTCDay():s._d.getDay(),s._tzm!=null&&s._d.setUTCMinutes(s._d.getUTCMinutes()-s._tzm),s._nextDay&&(s._a[At]=24),s._w&&typeof s._w.d<"u"&&s._w.d!==i&&(Ve(s).weekdayMismatch=!0)}}function OA(s){var e,t,n,o,i,r,a,l,h;e=s._w,e.GG!=null||e.W!=null||e.E!=null?(i=1,r=4,t=fi(e.GG,s._a[Wt],_r(lt(),1,4).year),n=fi(e.W,1),o=fi(e.E,1),(o<1||o>7)&&(l=!0)):(i=s._locale._week.dow,r=s._locale._week.doy,h=_r(lt(),i,r),t=fi(e.gg,s._a[Wt],h.year),n=fi(e.w,h.week),e.d!=null?(o=e.d,(o<0||o>6)&&(l=!0)):e.e!=null?(o=e.e+i,(e.e<0||e.e>6)&&(l=!0)):o=i),n<1||n>Es(t,i,r)?Ve(s)._overflowWeeks=!0:l!=null?Ve(s)._overflowWeekday=!0:(a=tv(t,n,o,i,r),s._a[Wt]=a.year,s._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function zg(s){if(s._f===Z.ISO_8601){rv(s);return}if(s._f===Z.RFC_2822){av(s);return}s._a=[],Ve(s).empty=!0;var e=""+s._i,t,n,o,i,r,a=e.length,l=0,h,u;for(o=BS(s._f,s._locale).match(Ng)||[],u=o.length,t=0;t<u;t++)i=o[t],n=(e.match(p_(i,s))||[])[0],n&&(r=e.substr(0,e.indexOf(n)),r.length>0&&Ve(s).unusedInput.push(r),e=e.slice(e.indexOf(n)+n.length),l+=n.length),yi[i]?(n?Ve(s).empty=!1:Ve(s).unusedTokens.push(i),C_(i,n,s)):s._strict&&!n&&Ve(s).unusedTokens.push(i);Ve(s).charsLeftOver=a-l,e.length>0&&Ve(s).unusedInput.push(e),s._a[At]<=12&&Ve(s).bigHour===!0&&s._a[At]>0&&(Ve(s).bigHour=void 0),Ve(s).parsedDateParts=s._a.slice(0),Ve(s).meridiem=s._meridiem,s._a[At]=IA(s._locale,s._a[At],s._meridiem),h=Ve(s).era,h!==null&&(s._a[Wt]=s._locale.erasConvertYear(h,s._a[Wt])),Yg(s),Ug(s)}function IA(s,e,t){var n;return t==null?e:s.meridiemHour!=null?s.meridiemHour(e,t):(s.isPM!=null&&(n=s.isPM(t),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function _A(s){var e,t,n,o,i,r,a=!1,l=s._f.length;if(l===0){Ve(s).invalidFormat=!0,s._d=new Date(NaN);return}for(o=0;o<l;o++)i=0,r=!1,e=Dg({},s),s._useUTC!=null&&(e._useUTC=s._useUTC),e._f=s._f[o],zg(e),Hg(e)&&(r=!0),i+=Ve(e).charsLeftOver,i+=Ve(e).unusedTokens.length*10,Ve(e).score=i,a?i<n&&(n=i,t=e):(n==null||i<n||r)&&(n=i,t=e,r&&(a=!0));Ys(s,t||e)}function AA(s){if(!s._d){var e=kg(s._i),t=e.day===void 0?e.date:e.day;s._a=VS([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),Yg(s)}}function xA(s){var e=new Kr(Ug(lv(s)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function lv(s){var e=s._i,t=s._f;return s._locale=s._locale||Is(s._l),e===null||t===void 0&&e===""?dh({nullInput:!0}):(typeof e=="string"&&(s._i=e=s._locale.preparse(e)),kn(e)?new Kr(Ug(e)):(jr(e)?s._d=e:Nn(t)?_A(s):t?zg(s):HA(s),Hg(s)||(s._d=null),s))}function HA(s){var e=s._i;on(e)?s._d=new Date(Z.now()):jr(e)?s._d=new Date(e.valueOf()):typeof e=="string"?TA(s):Nn(e)?(s._a=VS(e.slice(0),function(t){return parseInt(t,10)}),Yg(s)):Io(e)?AA(s):Ts(e)?s._d=new Date(e):Z.createFromInputFallback(s)}function hv(s,e,t,n,o){var i={};return(e===!0||e===!1)&&(n=e,e=void 0),(t===!0||t===!1)&&(n=t,t=void 0),(Io(s)&&xg(s)||Nn(s)&&s.length===0)&&(s=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=t,i._i=s,i._f=e,i._strict=n,xA(i)}function lt(s,e,t,n){return hv(s,e,t,n,!1)}var DA=En("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var s=lt.apply(null,arguments);return this.isValid()&&s.isValid()?s<this?this:s:dh()}),PA=En("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var s=lt.apply(null,arguments);return this.isValid()&&s.isValid()?s>this?this:s:dh()});function uv(s,e){var t,n;if(e.length===1&&Nn(e[0])&&(e=e[0]),!e.length)return lt();for(t=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][s](t))&&(t=e[n]);return t}function NA(){var s=[].slice.call(arguments,0);return uv("isBefore",s)}function kA(){var s=[].slice.call(arguments,0);return uv("isAfter",s)}var LA=function(){return Date.now?Date.now():+new Date},zi=["year","quarter","month","week","day","hour","minute","second","millisecond"];function FA(s){var e,t=!1,n,o=zi.length;for(e in s)if(Ke(s,e)&&!(Et.call(zi,e)!==-1&&(s[e]==null||!isNaN(s[e]))))return!1;for(n=0;n<o;++n)if(s[zi[n]]){if(t)return!1;parseFloat(s[zi[n]])!==Ue(s[zi[n]])&&(t=!0)}return!0}function VA(){return this._isValid}function $A(){return Vn(NaN)}function vh(s){var e=kg(s),t=e.year||0,n=e.quarter||0,o=e.month||0,i=e.week||e.isoWeek||0,r=e.day||0,a=e.hour||0,l=e.minute||0,h=e.second||0,u=e.millisecond||0;this._isValid=FA(e),this._milliseconds=+u+h*1e3+l*6e4+a*1e3*60*60,this._days=+r+i*7,this._months=+o+n*3+t*12,this._data={},this._locale=Is(),this._bubble()}function wl(s){return s instanceof vh}function _f(s){return s<0?Math.round(-1*s)*-1:Math.round(s)}function WA(s,e,t){var n=Math.min(s.length,e.length),o=Math.abs(s.length-e.length),i=0,r;for(r=0;r<n;r++)(t&&s[r]!==e[r]||!t&&Ue(s[r])!==Ue(e[r]))&&i++;return i+o}function cv(s,e){be(s,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+ts(~~(t/60),2)+e+ts(~~t%60,2)})}cv("Z",":");cv("ZZ","");fe("Z",Ch);fe("ZZ",Ch);et(["Z","ZZ"],function(s,e,t){t._useUTC=!0,t._tzm=Gg(Ch,s)});var BA=/([\+\-]|\d\d)/gi;function Gg(s,e){var t=(e||"").match(s),n,o,i;return t===null?null:(n=t[t.length-1]||[],o=(n+"").match(BA)||["-",0,0],i=+(o[1]*60)+Ue(o[2]),i===0?0:o[0]==="+"?i:-i)}function jg(s,e){var t,n;return e._isUTC?(t=e.clone(),n=(kn(s)||jr(s)?s.valueOf():lt(s).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+n),Z.updateOffset(t,!1),t):lt(s).local()}function Af(s){return-Math.round(s._d.getTimezoneOffset())}Z.updateOffset=function(){};function UA(s,e,t){var n=this._offset||0,o;if(!this.isValid())return s!=null?this:NaN;if(s!=null){if(typeof s=="string"){if(s=Gg(Ch,s),s===null)return this}else Math.abs(s)<16&&!t&&(s=s*60);return!this._isUTC&&e&&(o=Af(this)),this._offset=s,this._isUTC=!0,o!=null&&this.add(o,"m"),n!==s&&(!e||this._changeInProgress?gv(this,Vn(s-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Af(this)}function YA(s,e){return s!=null?(typeof s!="string"&&(s=-s),this.utcOffset(s,e),this):-this.utcOffset()}function zA(s){return this.utcOffset(0,s)}function GA(s){return this._isUTC&&(this.utcOffset(0,s),this._isUTC=!1,s&&this.subtract(Af(this),"m")),this}function jA(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var s=Gg(g_,this._i);s!=null?this.utcOffset(s):this.utcOffset(0,!0)}return this}function KA(s){return this.isValid()?(s=s?lt(s).utcOffset():0,(this.utcOffset()-s)%60===0):!1}function XA(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qA(){if(!on(this._isDSTShifted))return this._isDSTShifted;var s={},e;return Dg(s,this),s=lv(s),s._a?(e=s._isUTC?os(s._a):lt(s._a),this._isDSTShifted=this.isValid()&&WA(s._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function ZA(){return this.isValid()?!this._isUTC:!1}function QA(){return this.isValid()?this._isUTC:!1}function dv(){return this.isValid()?this._isUTC&&this._offset===0:!1}var JA=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,ex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Vn(s,e){var t=s,n=null,o,i,r;return wl(s)?t={ms:s._milliseconds,d:s._days,M:s._months}:Ts(s)||!isNaN(+s)?(t={},e?t[e]=+s:t.milliseconds=+s):(n=JA.exec(s))?(o=n[1]==="-"?-1:1,t={y:0,d:Ue(n[Qn])*o,h:Ue(n[At])*o,m:Ue(n[Hn])*o,s:Ue(n[vs])*o,ms:Ue(_f(n[Eo]*1e3))*o}):(n=ex.exec(s))?(o=n[1]==="-"?-1:1,t={y:lo(n[2],o),M:lo(n[3],o),w:lo(n[4],o),d:lo(n[5],o),h:lo(n[6],o),m:lo(n[7],o),s:lo(n[8],o)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(r=tx(lt(t.from),lt(t.to)),t={},t.ms=r.milliseconds,t.M=r.months),i=new vh(t),wl(s)&&Ke(s,"_locale")&&(i._locale=s._locale),wl(s)&&Ke(s,"_isValid")&&(i._isValid=s._isValid),i}Vn.fn=vh.prototype;Vn.invalid=$A;function lo(s,e){var t=s&&parseFloat(s.replace(",","."));return(isNaN(t)?0:t)*e}function Pw(s,e){var t={};return t.months=e.month()-s.month()+(e.year()-s.year())*12,s.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+s.clone().add(t.months,"M"),t}function tx(s,e){var t;return s.isValid()&&e.isValid()?(e=jg(e,s),s.isBefore(e)?t=Pw(s,e):(t=Pw(e,s),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function fv(s,e){return function(t,n){var o,i;return n!==null&&!isNaN(+n)&&(WS(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=t,t=n,n=i),o=Vn(t,n),gv(this,o,s),this}}function gv(s,e,t,n){var o=e._milliseconds,i=_f(e._days),r=_f(e._months);s.isValid()&&(n=n??!0,r&&ZS(s,Pl(s,"Month")+r*t),i&&YS(s,"Date",Pl(s,"Date")+i*t),o&&s._d.setTime(s._d.valueOf()+o*t),n&&Z.updateOffset(s,i||r))}var nx=fv(1,"add"),sx=fv(-1,"subtract");function mv(s){return typeof s=="string"||s instanceof String}function ox(s){return kn(s)||jr(s)||mv(s)||Ts(s)||rx(s)||ix(s)||s===null||s===void 0}function ix(s){var e=Io(s)&&!xg(s),t=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,r=n.length;for(o=0;o<r;o+=1)i=n[o],t=t||Ke(s,i);return e&&t}function rx(s){var e=Nn(s),t=!1;return e&&(t=s.filter(function(n){return!Ts(n)&&mv(s)}).length===0),e&&t}function ax(s){var e=Io(s)&&!xg(s),t=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<n.length;o+=1)i=n[o],t=t||Ke(s,i);return e&&t}function lx(s,e){var t=s.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function hx(s,e){arguments.length===1&&(arguments[0]?ox(arguments[0])?(s=arguments[0],e=void 0):ax(arguments[0])&&(e=arguments[0],s=void 0):(s=void 0,e=void 0));var t=s||lt(),n=jg(t,this).startOf("day"),o=Z.calendarFormat(this,n)||"sameElse",i=e&&(is(e[o])?e[o].call(this,t):e[o]);return this.format(i||this.localeData().calendar(o,this,lt(t)))}function ux(){return new Kr(this)}function cx(s,e){var t=kn(s)?s:lt(s);return this.isValid()&&t.isValid()?(e=Tn(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function dx(s,e){var t=kn(s)?s:lt(s);return this.isValid()&&t.isValid()?(e=Tn(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function fx(s,e,t,n){var o=kn(s)?s:lt(s),i=kn(e)?e:lt(e);return this.isValid()&&o.isValid()&&i.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(o,t):!this.isBefore(o,t))&&(n[1]===")"?this.isBefore(i,t):!this.isAfter(i,t))):!1}function gx(s,e){var t=kn(s)?s:lt(s),n;return this.isValid()&&t.isValid()?(e=Tn(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(n=t.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function mx(s,e){return this.isSame(s,e)||this.isAfter(s,e)}function px(s,e){return this.isSame(s,e)||this.isBefore(s,e)}function wx(s,e,t){var n,o,i;if(!this.isValid())return NaN;if(n=jg(s,this),!n.isValid())return NaN;switch(o=(n.utcOffset()-this.utcOffset())*6e4,e=Tn(e),e){case"year":i=Cl(this,n)/12;break;case"month":i=Cl(this,n);break;case"quarter":i=Cl(this,n)/3;break;case"second":i=(this-n)/1e3;break;case"minute":i=(this-n)/6e4;break;case"hour":i=(this-n)/36e5;break;case"day":i=(this-n-o)/864e5;break;case"week":i=(this-n-o)/6048e5;break;default:i=this-n}return t?i:vn(i)}function Cl(s,e){if(s.date()<e.date())return-Cl(e,s);var t=(e.year()-s.year())*12+(e.month()-s.month()),n=s.clone().add(t,"months"),o,i;return e-n<0?(o=s.clone().add(t-1,"months"),i=(e-n)/(n-o)):(o=s.clone().add(t+1,"months"),i=(e-n)/(o-n)),-(t+i)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Cx(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function yx(s){if(!this.isValid())return null;var e=s!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?pl(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):is(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",pl(t,"Z")):pl(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Sx(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var s="moment",e="",t,n,o,i;return this.isLocal()||(s=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+s+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=e+'[")]',this.format(t+n+o+i)}function vx(s){s||(s=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=pl(this,s);return this.localeData().postformat(e)}function bx(s,e){return this.isValid()&&(kn(s)&&s.isValid()||lt(s).isValid())?Vn({to:this,from:s}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Rx(s){return this.from(lt(),s)}function Ex(s,e){return this.isValid()&&(kn(s)&&s.isValid()||lt(s).isValid())?Vn({from:this,to:s}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Tx(s){return this.to(lt(),s)}function pv(s){var e;return s===void 0?this._locale._abbr:(e=Is(s),e!=null&&(this._locale=e),this)}var wv=En("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(s){return s===void 0?this.localeData():this.locale(s)});function Cv(){return this._locale}var Ll=1e3,Si=60*Ll,Fl=60*Si,yv=(365*400+97)*24*Fl;function vi(s,e){return(s%e+e)%e}function Sv(s,e,t){return s<100&&s>=0?new Date(s+400,e,t)-yv:new Date(s,e,t).valueOf()}function vv(s,e,t){return s<100&&s>=0?Date.UTC(s+400,e,t)-yv:Date.UTC(s,e,t)}function Mx(s){var e,t;if(s=Tn(s),s===void 0||s==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?vv:Sv,s){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=vi(e+(this._isUTC?0:this.utcOffset()*Si),Fl);break;case"minute":e=this._d.valueOf(),e-=vi(e,Si);break;case"second":e=this._d.valueOf(),e-=vi(e,Ll);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function Ox(s){var e,t;if(s=Tn(s),s===void 0||s==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?vv:Sv,s){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Fl-vi(e+(this._isUTC?0:this.utcOffset()*Si),Fl)-1;break;case"minute":e=this._d.valueOf(),e+=Si-vi(e,Si)-1;break;case"second":e=this._d.valueOf(),e+=Ll-vi(e,Ll)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function Ix(){return this._d.valueOf()-(this._offset||0)*6e4}function _x(){return Math.floor(this.valueOf()/1e3)}function Ax(){return new Date(this.valueOf())}function xx(){var s=this;return[s.year(),s.month(),s.date(),s.hour(),s.minute(),s.second(),s.millisecond()]}function Hx(){var s=this;return{years:s.year(),months:s.month(),date:s.date(),hours:s.hours(),minutes:s.minutes(),seconds:s.seconds(),milliseconds:s.milliseconds()}}function Dx(){return this.isValid()?this.toISOString():null}function Px(){return Hg(this)}function Nx(){return Ys({},Ve(this))}function kx(){return Ve(this).overflow}function Lx(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}be("N",0,0,"eraAbbr");be("NN",0,0,"eraAbbr");be("NNN",0,0,"eraAbbr");be("NNNN",0,0,"eraName");be("NNNNN",0,0,"eraNarrow");be("y",["y",1],"yo","eraYear");be("y",["yy",2],0,"eraYear");be("y",["yyy",3],0,"eraYear");be("y",["yyyy",4],0,"eraYear");fe("N",Kg);fe("NN",Kg);fe("NNN",Kg);fe("NNNN",Kx);fe("NNNNN",Xx);et(["N","NN","NNN","NNNN","NNNNN"],function(s,e,t,n){var o=t._locale.erasParse(s,n,t._strict);o?Ve(t).era=o:Ve(t).invalidEra=s});fe("y",Pi);fe("yy",Pi);fe("yyy",Pi);fe("yyyy",Pi);fe("yo",qx);et(["y","yy","yyy","yyyy"],Wt);et(["yo"],function(s,e,t,n){var o;t._locale._eraYearOrdinalRegex&&(o=s.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[Wt]=t._locale.eraYearOrdinalParse(s,o):e[Wt]=parseInt(s,10)});function Fx(s,e){var t,n,o,i=this._eras||Is("en")._eras;for(t=0,n=i.length;t<n;++t){switch(typeof i[t].since){case"string":o=Z(i[t].since).startOf("day"),i[t].since=o.valueOf();break}switch(typeof i[t].until){case"undefined":i[t].until=1/0;break;case"string":o=Z(i[t].until).startOf("day").valueOf(),i[t].until=o.valueOf();break}}return i}function Vx(s,e,t){var n,o,i=this.eras(),r,a,l;for(s=s.toUpperCase(),n=0,o=i.length;n<o;++n)if(r=i[n].name.toUpperCase(),a=i[n].abbr.toUpperCase(),l=i[n].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===s)return i[n];break;case"NNNN":if(r===s)return i[n];break;case"NNNNN":if(l===s)return i[n];break}else if([r,a,l].indexOf(s)>=0)return i[n]}function $x(s,e){var t=s.since<=s.until?1:-1;return e===void 0?Z(s.since).year():Z(s.since).year()+(e-s.offset)*t}function Wx(){var s,e,t,n=this.localeData().eras();for(s=0,e=n.length;s<e;++s)if(t=this.clone().startOf("day").valueOf(),n[s].since<=t&&t<=n[s].until||n[s].until<=t&&t<=n[s].since)return n[s].name;return""}function Bx(){var s,e,t,n=this.localeData().eras();for(s=0,e=n.length;s<e;++s)if(t=this.clone().startOf("day").valueOf(),n[s].since<=t&&t<=n[s].until||n[s].until<=t&&t<=n[s].since)return n[s].narrow;return""}function Ux(){var s,e,t,n=this.localeData().eras();for(s=0,e=n.length;s<e;++s)if(t=this.clone().startOf("day").valueOf(),n[s].since<=t&&t<=n[s].until||n[s].until<=t&&t<=n[s].since)return n[s].abbr;return""}function Yx(){var s,e,t,n,o=this.localeData().eras();for(s=0,e=o.length;s<e;++s)if(t=o[s].since<=o[s].until?1:-1,n=this.clone().startOf("day").valueOf(),o[s].since<=n&&n<=o[s].until||o[s].until<=n&&n<=o[s].since)return(this.year()-Z(o[s].since).year())*t+o[s].offset;return this.year()}function zx(s){return Ke(this,"_erasNameRegex")||Xg.call(this),s?this._erasNameRegex:this._erasRegex}function Gx(s){return Ke(this,"_erasAbbrRegex")||Xg.call(this),s?this._erasAbbrRegex:this._erasRegex}function jx(s){return Ke(this,"_erasNarrowRegex")||Xg.call(this),s?this._erasNarrowRegex:this._erasRegex}function Kg(s,e){return e.erasAbbrRegex(s)}function Kx(s,e){return e.erasNameRegex(s)}function Xx(s,e){return e.erasNarrowRegex(s)}function qx(s,e){return e._eraYearOrdinalRegex||Pi}function Xg(){var s=[],e=[],t=[],n=[],o,i,r=this.eras();for(o=0,i=r.length;o<i;++o)e.push(dn(r[o].name)),s.push(dn(r[o].abbr)),t.push(dn(r[o].narrow)),n.push(dn(r[o].name)),n.push(dn(r[o].abbr)),n.push(dn(r[o].narrow));this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}be(0,["gg",2],0,function(){return this.weekYear()%100});be(0,["GG",2],0,function(){return this.isoWeekYear()%100});function bh(s,e){be(0,[s,s.length],0,e)}bh("gggg","weekYear");bh("ggggg","weekYear");bh("GGGG","isoWeekYear");bh("GGGGG","isoWeekYear");zt("weekYear","gg");zt("isoWeekYear","GG");Gt("weekYear",1);Gt("isoWeekYear",1);fe("G",wh);fe("g",wh);fe("GG",ht,mn);fe("gg",ht,mn);fe("GGGG",Fg,Lg);fe("gggg",Fg,Lg);fe("GGGGG",ph,gh);fe("ggggg",ph,gh);qr(["gggg","ggggg","GGGG","GGGGG"],function(s,e,t,n){e[n.substr(0,2)]=Ue(s)});qr(["gg","GG"],function(s,e,t,n){e[n]=Z.parseTwoDigitYear(s)});function Zx(s){return bv.call(this,s,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Qx(s){return bv.call(this,s,this.isoWeek(),this.isoWeekday(),1,4)}function Jx(){return Es(this.year(),1,4)}function eH(){return Es(this.isoWeekYear(),1,4)}function tH(){var s=this.localeData()._week;return Es(this.year(),s.dow,s.doy)}function nH(){var s=this.localeData()._week;return Es(this.weekYear(),s.dow,s.doy)}function bv(s,e,t,n,o){var i;return s==null?_r(this,n,o).year:(i=Es(s,n,o),e>i&&(e=i),sH.call(this,s,e,t,n,o))}function sH(s,e,t,n,o){var i=tv(s,e,t,n,o),r=Ir(i.year,0,i.dayOfYear);return this.year(r.getUTCFullYear()),this.month(r.getUTCMonth()),this.date(r.getUTCDate()),this}be("Q",0,"Qo","quarter");zt("quarter","Q");Gt("quarter",7);fe("Q",zS);et("Q",function(s,e){e[Ss]=(Ue(s)-1)*3});function oH(s){return s==null?Math.ceil((this.month()+1)/3):this.month((s-1)*3+this.month()%3)}be("D",["DD",2],"Do","date");zt("date","D");Gt("date",9);fe("D",ht);fe("DD",ht,mn);fe("Do",function(s,e){return s?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});et(["D","DD"],Qn);et("Do",function(s,e){e[Qn]=Ue(s.match(ht)[0])});var Rv=Di("Date",!0);be("DDD",["DDDD",3],"DDDo","dayOfYear");zt("dayOfYear","DDD");Gt("dayOfYear",4);fe("DDD",mh);fe("DDDD",GS);et(["DDD","DDDD"],function(s,e,t){t._dayOfYear=Ue(s)});function iH(s){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return s==null?e:this.add(s-e,"d")}be("m",["mm",2],0,"minute");zt("minute","m");Gt("minute",14);fe("m",ht);fe("mm",ht,mn);et(["m","mm"],Hn);var rH=Di("Minutes",!1);be("s",["ss",2],0,"second");zt("second","s");Gt("second",15);fe("s",ht);fe("ss",ht,mn);et(["s","ss"],vs);var aH=Di("Seconds",!1);be("S",0,0,function(){return~~(this.millisecond()/100)});be(0,["SS",2],0,function(){return~~(this.millisecond()/10)});be(0,["SSS",3],0,"millisecond");be(0,["SSSS",4],0,function(){return this.millisecond()*10});be(0,["SSSSS",5],0,function(){return this.millisecond()*100});be(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});be(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});be(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});be(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});zt("millisecond","ms");Gt("millisecond",16);fe("S",mh,zS);fe("SS",mh,mn);fe("SSS",mh,GS);var zs,Ev;for(zs="SSSS";zs.length<=9;zs+="S")fe(zs,Pi);function lH(s,e){e[Eo]=Ue(("0."+s)*1e3)}for(zs="S";zs.length<=9;zs+="S")et(zs,lH);Ev=Di("Milliseconds",!1);be("z",0,0,"zoneAbbr");be("zz",0,0,"zoneName");function hH(){return this._isUTC?"UTC":""}function uH(){return this._isUTC?"Coordinated Universal Time":""}var te=Kr.prototype;te.add=nx;te.calendar=hx;te.clone=ux;te.diff=wx;te.endOf=Ox;te.format=vx;te.from=bx;te.fromNow=Rx;te.to=Ex;te.toNow=Tx;te.get=d_;te.invalidAt=kx;te.isAfter=cx;te.isBefore=dx;te.isBetween=fx;te.isSame=gx;te.isSameOrAfter=mx;te.isSameOrBefore=px;te.isValid=Px;te.lang=wv;te.locale=pv;te.localeData=Cv;te.max=PA;te.min=DA;te.parsingFlags=Nx;te.set=f_;te.startOf=Mx;te.subtract=sx;te.toArray=xx;te.toObject=Hx;te.toDate=Ax;te.toISOString=yx;te.inspect=Sx;typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});te.toJSON=Dx;te.toString=Cx;te.unix=_x;te.valueOf=Ix;te.creationData=Lx;te.eraName=Wx;te.eraNarrow=Bx;te.eraAbbr=Ux;te.eraYear=Yx;te.year=ev;te.isLeapYear=H_;te.weekYear=Zx;te.isoWeekYear=Qx;te.quarter=te.quarters=oH;te.month=QS;te.daysInMonth=__;te.week=te.weeks=F_;te.isoWeek=te.isoWeeks=V_;te.weeksInYear=tH;te.weeksInWeekYear=nH;te.isoWeeksInYear=Jx;te.isoWeeksInISOWeekYear=eH;te.date=Rv;te.day=te.days=Q_;te.weekday=J_;te.isoWeekday=eA;te.dayOfYear=iH;te.hour=te.hours=aA;te.minute=te.minutes=rH;te.second=te.seconds=aH;te.millisecond=te.milliseconds=Ev;te.utcOffset=UA;te.utc=zA;te.local=GA;te.parseZone=jA;te.hasAlignedHourOffset=KA;te.isDST=XA;te.isLocal=ZA;te.isUtcOffset=QA;te.isUtc=dv;te.isUTC=dv;te.zoneAbbr=hH;te.zoneName=uH;te.dates=En("dates accessor is deprecated. Use date instead.",Rv);te.months=En("months accessor is deprecated. Use month instead",QS);te.years=En("years accessor is deprecated. Use year instead",ev);te.zone=En("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",YA);te.isDSTShifted=En("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qA);function cH(s){return lt(s*1e3)}function dH(){return lt.apply(null,arguments).parseZone()}function Tv(s){return s}var Xe=Pg.prototype;Xe.calendar=QI;Xe.longDateFormat=n_;Xe.invalidDate=o_;Xe.ordinal=a_;Xe.preparse=Tv;Xe.postformat=Tv;Xe.relativeTime=h_;Xe.pastFuture=u_;Xe.set=qI;Xe.eras=Fx;Xe.erasParse=Vx;Xe.erasConvertYear=$x;Xe.erasAbbrRegex=Gx;Xe.erasNameRegex=zx;Xe.erasNarrowRegex=jx;Xe.months=T_;Xe.monthsShort=M_;Xe.monthsParse=I_;Xe.monthsRegex=x_;Xe.monthsShortRegex=A_;Xe.week=P_;Xe.firstDayOfYear=L_;Xe.firstDayOfWeek=k_;Xe.weekdays=j_;Xe.weekdaysMin=X_;Xe.weekdaysShort=K_;Xe.weekdaysParse=Z_;Xe.weekdaysRegex=tA;Xe.weekdaysShortRegex=nA;Xe.weekdaysMinRegex=sA;Xe.isPM=iA;Xe.meridiem=lA;function Vl(s,e,t,n){var o=Is(),i=os().set(n,e);return o[t](i,s)}function Mv(s,e,t){if(Ts(s)&&(e=s,s=void 0),s=s||"",e!=null)return Vl(s,e,t,"month");var n,o=[];for(n=0;n<12;n++)o[n]=Vl(s,n,t,"month");return o}function qg(s,e,t,n){typeof s=="boolean"?(Ts(e)&&(t=e,e=void 0),e=e||""):(e=s,t=e,s=!1,Ts(e)&&(t=e,e=void 0),e=e||"");var o=Is(),i=s?o._week.dow:0,r,a=[];if(t!=null)return Vl(e,(t+i)%7,n,"day");for(r=0;r<7;r++)a[r]=Vl(e,(r+i)%7,n,"day");return a}function fH(s,e){return Mv(s,e,"months")}function gH(s,e){return Mv(s,e,"monthsShort")}function mH(s,e,t){return qg(s,e,t,"weekdays")}function pH(s,e,t){return qg(s,e,t,"weekdaysShort")}function wH(s,e,t){return qg(s,e,t,"weekdaysMin")}Gs("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(s){var e=s%10,t=Ue(s%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return s+t}});Z.lang=En("moment.lang is deprecated. Use moment.locale instead.",Gs);Z.langData=En("moment.langData is deprecated. Use moment.localeData instead.",Is);var hs=Math.abs;function CH(){var s=this._data;return this._milliseconds=hs(this._milliseconds),this._days=hs(this._days),this._months=hs(this._months),s.milliseconds=hs(s.milliseconds),s.seconds=hs(s.seconds),s.minutes=hs(s.minutes),s.hours=hs(s.hours),s.months=hs(s.months),s.years=hs(s.years),this}function Ov(s,e,t,n){var o=Vn(e,t);return s._milliseconds+=n*o._milliseconds,s._days+=n*o._days,s._months+=n*o._months,s._bubble()}function yH(s,e){return Ov(this,s,e,1)}function SH(s,e){return Ov(this,s,e,-1)}function Nw(s){return s<0?Math.floor(s):Math.ceil(s)}function vH(){var s=this._milliseconds,e=this._days,t=this._months,n=this._data,o,i,r,a,l;return s>=0&&e>=0&&t>=0||s<=0&&e<=0&&t<=0||(s+=Nw(xf(t)+e)*864e5,e=0,t=0),n.milliseconds=s%1e3,o=vn(s/1e3),n.seconds=o%60,i=vn(o/60),n.minutes=i%60,r=vn(i/60),n.hours=r%24,e+=vn(r/24),l=vn(Iv(e)),t+=l,e-=Nw(xf(l)),a=vn(t/12),t%=12,n.days=e,n.months=t,n.years=a,this}function Iv(s){return s*4800/146097}function xf(s){return s*146097/4800}function bH(s){if(!this.isValid())return NaN;var e,t,n=this._milliseconds;if(s=Tn(s),s==="month"||s==="quarter"||s==="year")switch(e=this._days+n/864e5,t=this._months+Iv(e),s){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(xf(this._months)),s){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+s)}}function RH(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Ue(this._months/12)*31536e6:NaN}function _s(s){return function(){return this.as(s)}}var EH=_s("ms"),TH=_s("s"),MH=_s("m"),OH=_s("h"),IH=_s("d"),_H=_s("w"),AH=_s("M"),xH=_s("Q"),HH=_s("y");function DH(){return Vn(this)}function PH(s){return s=Tn(s),this.isValid()?this[s+"s"]():NaN}function Vo(s){return function(){return this.isValid()?this._data[s]:NaN}}var NH=Vo("milliseconds"),kH=Vo("seconds"),LH=Vo("minutes"),FH=Vo("hours"),VH=Vo("days"),$H=Vo("months"),WH=Vo("years");function BH(){return vn(this.days()/7)}var ws=Math.round,mi={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function UH(s,e,t,n,o){return o.relativeTime(e||1,!!t,s,n)}function YH(s,e,t,n){var o=Vn(s).abs(),i=ws(o.as("s")),r=ws(o.as("m")),a=ws(o.as("h")),l=ws(o.as("d")),h=ws(o.as("M")),u=ws(o.as("w")),d=ws(o.as("y")),f=i<=t.ss&&["s",i]||i<t.s&&["ss",i]||r<=1&&["m"]||r<t.m&&["mm",r]||a<=1&&["h"]||a<t.h&&["hh",a]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(f=f||u<=1&&["w"]||u<t.w&&["ww",u]),f=f||h<=1&&["M"]||h<t.M&&["MM",h]||d<=1&&["y"]||["yy",d],f[2]=e,f[3]=+s>0,f[4]=n,UH.apply(null,f)}function zH(s){return s===void 0?ws:typeof s=="function"?(ws=s,!0):!1}function GH(s,e){return mi[s]===void 0?!1:e===void 0?mi[s]:(mi[s]=e,s==="s"&&(mi.ss=e-1),!0)}function jH(s,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,n=mi,o,i;return typeof s=="object"&&(e=s,s=!1),typeof s=="boolean"&&(t=s),typeof e=="object"&&(n=Object.assign({},mi,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),o=this.localeData(),i=YH(this,!t,n,o),t&&(i=o.pastFuture(+this,i)),o.postformat(i)}var jc=Math.abs;function Go(s){return(s>0)-(s<0)||+s}function Rh(){if(!this.isValid())return this.localeData().invalidDate();var s=jc(this._milliseconds)/1e3,e=jc(this._days),t=jc(this._months),n,o,i,r,a=this.asSeconds(),l,h,u,d;return a?(n=vn(s/60),o=vn(n/60),s%=60,n%=60,i=vn(t/12),t%=12,r=s?s.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",h=Go(this._months)!==Go(a)?"-":"",u=Go(this._days)!==Go(a)?"-":"",d=Go(this._milliseconds)!==Go(a)?"-":"",l+"P"+(i?h+i+"Y":"")+(t?h+t+"M":"")+(e?u+e+"D":"")+(o||n||s?"T":"")+(o?d+o+"H":"")+(n?d+n+"M":"")+(s?d+r+"S":"")):"P0D"}var Ge=vh.prototype;Ge.isValid=VA;Ge.abs=CH;Ge.add=yH;Ge.subtract=SH;Ge.as=bH;Ge.asMilliseconds=EH;Ge.asSeconds=TH;Ge.asMinutes=MH;Ge.asHours=OH;Ge.asDays=IH;Ge.asWeeks=_H;Ge.asMonths=AH;Ge.asQuarters=xH;Ge.asYears=HH;Ge.valueOf=RH;Ge._bubble=vH;Ge.clone=DH;Ge.get=PH;Ge.milliseconds=NH;Ge.seconds=kH;Ge.minutes=LH;Ge.hours=FH;Ge.days=VH;Ge.weeks=BH;Ge.months=$H;Ge.years=WH;Ge.humanize=jH;Ge.toISOString=Rh;Ge.toString=Rh;Ge.toJSON=Rh;Ge.locale=pv;Ge.localeData=Cv;Ge.toIsoString=En("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Rh);Ge.lang=wv;be("X",0,0,"unix");be("x",0,0,"valueOf");fe("x",wh);fe("X",m_);et("X",function(s,e,t){t._d=new Date(parseFloat(s)*1e3)});et("x",function(s,e,t){t._d=new Date(Ue(s))});//! moment.js
Z.version="2.29.4";KI(lt);Z.fn=te;Z.min=NA;Z.max=kA;Z.now=LA;Z.utc=os;Z.unix=cH;Z.months=fH;Z.isDate=jr;Z.locale=Gs;Z.invalid=dh;Z.duration=Vn;Z.isMoment=kn;Z.weekdays=mH;Z.parseZone=dH;Z.localeData=Is;Z.isDuration=wl;Z.monthsShort=gH;Z.weekdaysMin=wH;Z.defineLocale=Bg;Z.updateLocale=dA;Z.locales=fA;Z.weekdaysShort=pH;Z.normalizeUnits=Tn;Z.relativeTimeRounding=zH;Z.relativeTimeThreshold=GH;Z.calendarFormat=lx;Z.prototype=te;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const KH=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"}));function _v(s){const e=s.length;let t=0;for(;t<e;)s[t]=[s[t]],t+=1}function Hf(s,e){const t=e.length;let n=0;for(;n<t;)s.push(e[n]),n+=1}function mr(s){const e=[];if(!s||s.length===0||!s[0]||s[0].length===0)return e;const t=s.length,n=s[0].length;for(let o=0;o<t;o++)for(let i=0;i<n;i++)e[i]||(e[i]=[]),e[i][o]=s[o][i];return e}function bt(s,e,t,n){let o=-1,i=s,r=t;Array.isArray(s)||(i=Array.from(s));const a=i.length;for(n&&a&&(o+=1,r=i[o]),o+=1;o<a;)r=e(r,i[o],o,i),o+=1;return r}function gn(s,e){let t=0,n=s;Array.isArray(s)||(n=Array.from(s));const o=n.length,i=[];let r=-1;for(;t<o;){const a=n[t];e(a,t,n)&&(r+=1,i[r]=a),t+=1}return i}function ke(s,e){let t=0,n=s;Array.isArray(s)||(n=Array.from(s));const o=n.length,i=[];let r=-1;for(;t<o;){const a=n[t];r+=1,i[r]=e(a,t,n),t+=1}return i}function I(s,e){let t=0,n=s;Array.isArray(s)||(n=Array.from(s));const o=n.length;for(;t<o&&e(n[t],t,n)!==!1;)t+=1;return s}function Av(s){return bt(s,(e,t)=>e+t,0)}function XH(s){return bt(s,(e,t)=>e>t?e:t,Array.isArray(s)?s[0]:void 0)}function qH(s){return bt(s,(e,t)=>e<t?e:t,Array.isArray(s)?s[0]:void 0)}function ZH(s){return s.length?Av(s)/s.length:0}function xv(s){return bt(s,(e,t)=>e.concat(Array.isArray(t)?xv(t):t),[])}function Zg(s){const e=[];return I(s,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function Df(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];const[n,...o]=[...e];let i=n;return I(o,r=>{i=i.filter(a=>!r.includes(a))}),i}function QH(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];const[n,...o]=[...e];let i=n;return I(o,r=>{i=i.filter(a=>r.includes(a))}),i}function JH(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];const[n,...o]=[...e],i=new Set(n);return I(o,r=>{I(r,a=>{i.has(a)||i.add(a)})}),Array.from(i)}function Pf(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return s.split(e)}const eD=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:ZH,arrayEach:I,arrayFilter:gn,arrayFlatten:xv,arrayMap:ke,arrayMax:XH,arrayMin:qH,arrayReduce:bt,arraySum:Av,arrayUnique:Zg,extendArray:Hf,getDifferenceOfArrays:Df,getIntersectionOfArrays:QH,getUnionOfArrays:JH,pivot:mr,stringToArray:Pf,to2dArray:_v},Symbol.toStringTag,{value:"Module"}));function Je(s){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return bt(s,(i,r,a)=>{const l=r.replace(/\r?\n\s*/g,""),h=t[a]?t[a]:"";return i+l+h},"").trim()}function Ct(s){let e;switch(typeof s){case"string":case"number":e=`${s}`;break;case"object":e=s===null?"":s.toString();break;case"undefined":e="";break;default:e=s.toString();break}return e}function le(s){return typeof s<"u"}function st(s){return typeof s>"u"}function It(s){return s===null||s===""||st(s)}function Hv(s){return Object.prototype.toString.call(s)==="[object RegExp]"}const lr="length",pr=s=>parseInt(s,16),kw=s=>parseInt(s,10),$l=(s,e,t)=>s.substr(e,t),wr=s=>s.codePointAt(0)-65,Nf=s=>`${s}`.replace(/\-/g,""),tD=s=>pr($l(Nf(s),pr("12"),wr("F")))/(pr($l(Nf(s),wr("B"),~~![][lr]))||9),nD=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Lw=!1;const Fw={invalid:()=>Je`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:s=>{let{keyValidityDate:e,hotVersion:t}=s;return Je`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Je`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Vw={invalid:()=>Je`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:s=>{let{keyValidityDate:e,hotVersion:t}=s;return Je`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Je`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Dv(s,e){const t=!It(s),n=typeof s=="string"&&s.toLowerCase()==="non-commercial-and-evaluation",o="13.1.0";let i,r="invalid",a="invalid";s=Nf(s||"");const l=sD(s);if(t||n||l)if(l){const h=Z("31/08/2023","DD/MM/YYYY"),u=Math.floor(h.toDate().getTime()/864e5),d=tD(s);i=Z((d+1)*864e5,"x").format("MMMM DD, YYYY"),u>d?(r="expired",a="expired"):(r="valid",a="valid")}else n?(r="non_commercial",a="valid"):(r="invalid",a="invalid");else r="missing",a="missing";if(nD()&&(r="valid",a="valid"),!Lw&&r!=="valid"&&(Fw[r]({keyValidityDate:i,hotVersion:o})&&console[r==="non_commercial"?"info":"warn"](Fw[r]({keyValidityDate:i,hotVersion:o})),Lw=!0),a!=="valid"&&e.parentNode&&Vw[a]({keyValidityDate:i,hotVersion:o})){const u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=Vw[a]({keyValidityDate:i,hotVersion:o}),e.parentNode.insertBefore(u,e.nextSibling)}}function sD(s){let e=[][lr],t=e;if(s[lr]!==wr("Z"))return!1;for(let n="",o="B<H4P+".split(""),i=wr(o.shift());i;i=wr(o.shift()||"A"))--i<""[lr]?t=t|(kw(`${kw(pr(n)+(pr($l(s,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=$l(s,i,i?o[lr]===1?9:8:6);return t===e}const oD=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:Dv,isDefined:le,isEmpty:It,isRegExp:Hv,isUndefined:st,stringify:Ct},Symbol.toStringTag,{value:"Module"}));function Bt(s){return s[0].toUpperCase()+s.substr(1)}function iD(){const s=[];for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let o=t.length;for(;o;){o-=1;const i=Ct(t[o]).toLowerCase();s.indexOf(i)===-1&&s.push(i)}return s.length===1}function Qg(){function s(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return s()+s()+s()+s()}function Jg(s){return/^([0-9][0-9]?%$)|(^100%$)/.test(s)}function em(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${s}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,n)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[n]===void 0?"":e[n])}function kf(s){return Eh(`${s}`,{ALLOWED_TAGS:[]})}function Eh(s,e){return jI.sanitize(s,e)}const rD=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:iD,isPercentValue:Jg,randomString:Qg,sanitize:Eh,stripTags:kf,substitute:em,toUpperCaseFirst:Bt},Symbol.toStringTag,{value:"Module"}));function Pv(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,n=null,o=s;for(;o!==null;){if(t===e){n=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(t+=1,o=o.parentNode)}return n}function Nv(s){return Object.getPrototypeOf(s.parent)&&s.frameElement}function xr(s){return Nv(s)&&s.parent}function aD(s){return!!Object.getPrototypeOf(s.parent)}function js(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:o}=Node;let i=s;for(;i!=null&&i!==t;){const{nodeType:r,nodeName:a}=i;if(r===n&&(e.includes(a)||e.includes(i)))return i;const{host:l}=i;l&&r===o?i=l:i=i.parentNode}return null}function hr(s,e,t){const n=[];let o=s;for(;o&&(o=js(o,e,t),!(!o||t&&!t.contains(o)));)n.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;const i=n.length;return i?n[i-1]:null}function Ks(s,e){let t=s.parentNode,n=[];for(typeof e=="string"?s.defaultView?n=Array.prototype.slice.call(s.querySelectorAll(e),0):n=Array.prototype.slice.call(s.ownerDocument.querySelectorAll(e),0):n.push(e);t!==null;){if(n.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function kv(s){let e=0,t=s;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function Ws(s,e,t){const n=t.parentElement.querySelector(`.ht_clone_${s}`);return n?n.contains(e):null}function Lv(s){return!s||!s.length?[]:s.filter(e=>!!e)}function Oe(s,e){return s.classList===void 0||typeof e!="string"||e===""?!1:s.classList.contains(e)}function J(s,e){typeof e=="string"&&(e=e.split(" ")),e=Lv(e),e.length>0&&s.classList.add(...e)}function _e(s,e){typeof e=="string"&&(e=e.split(" ")),e=Lv(e),e.length>0&&s.classList.remove(...e)}function tm(s){if(s.nodeType===3)s.parentNode.removeChild(s);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(s.nodeName)>-1){const e=s.childNodes;for(let t=e.length-1;t>=0;t--)tm(e[t])}}function Ln(s){let e;for(;e=s.lastChild;)s.removeChild(e)}const Fv=/(<(.*)>|&(.*);)/;function $o(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Fv.test(e)?s.innerHTML=t?Eh(e):e:Js(s,e)}function Js(s,e){const t=s.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(Ln(s),s.appendChild(s.ownerDocument.createTextNode(e)))}function Ei(s){const e=s.ownerDocument.documentElement;let t=s;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return Ei(t.host.impl);if(t.host)return Ei(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(t.style&&t.style.display==="none")return!1;t=t.parentNode}return!0}function Tt(s){const e=s.ownerDocument,t=e.defaultView,n=e.documentElement;let o=s,i,r,a;for(i=o.offsetLeft,r=o.offsetTop,a=o;(o=o.offsetParent)&&o!==e.body;)i+=o.offsetLeft,r+=o.offsetTop,a=o;return a&&a.style.position==="fixed"&&(i+=t.pageXOffset||n.scrollLeft,r+=t.pageYOffset||n.scrollTop),{left:i,top:r}}function Ti(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function _o(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Hr(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return s===e?Ti(e):s.scrollTop}function Wl(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return s===e?_o(e):s.scrollLeft}function Dr(s){let e=s.ownerDocument,t=e?e.defaultView:void 0;e||(e=s.document?s.document:s,t=e.defaultView);const n=["auto","scroll"];let o=s.parentNode;for(;o&&o.style&&e.body!==o;){let{overflow:i,overflowX:r,overflowY:a}=o.style;if([i,r,a].includes("scroll"))return o;if({overflow:i,overflowX:r,overflowY:a}=t.getComputedStyle(o),n.includes(i)||n.includes(r)||n.includes(a)||o.clientHeight<=o.scrollHeight+1&&(n.includes(a)||n.includes(i))||o.clientWidth<=o.scrollWidth+1&&(n.includes(r)||n.includes(i)))return o;o=o.parentNode}return t}function Ao(s){const e=s.ownerDocument,t=e.defaultView;let n=s.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const o=eo(n,t),i=["scroll","hidden","auto"],r=o.getPropertyValue("overflow"),a=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(r)||i.includes(a)||i.includes(l))return n;n=n.parentNode}return t}function Mi(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(s){if(s===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const n=s.style[e];if(n!==""&&n!==void 0)return n;const o=eo(s,t);if(o[e]!==""&&o[e]!==void 0)return o[e]}function lD(s,e){const{selectorText:t}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&t&&(s.msMatchesSelector?n=s.msMatchesSelector(t):s.matches&&(n=s.matches(t))),n}function eo(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return s.currentStyle||e.getComputedStyle(s)}function Qe(s){return s.offsetWidth}function dt(s){return s.offsetHeight}function bs(s){return s.clientHeight||s.innerHeight}function Cr(s){return s.clientWidth||s.innerWidth}function hD(s,e,t){s.addEventListener(e,t,!1)}function uD(s,e,t){s.removeEventListener(e,t,!1)}function nm(s){return s.selectionStart?s.selectionStart:0}function Vv(s){return s.selectionEnd?s.selectionEnd:0}function $v(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=s.document;let t="";return s.getSelection?t=s.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function Lf(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;s.getSelection&&(s.getSelection().empty?s.getSelection().empty():s.getSelection().removeAllRanges&&s.getSelection().removeAllRanges())}function Zr(s,e,t){if(t===void 0&&(t=e),s.setSelectionRange){s.focus();try{s.setSelectionRange(e,t)}catch{const o=s.parentNode,i=o.style.display;o.style.display="block",s.setSelectionRange(e,t),o.style.display=i}}}let Kc;function cD(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=s.createElement("div");e.style.height="200px",e.style.width="100%";const t=s.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(s.body||s.documentElement).appendChild(t);const n=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return n===o&&(o=t.clientWidth),(s.body||s.documentElement).removeChild(t),n-o}function xt(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Kc===void 0&&(Kc=cD(s)),Kc}function Wv(s){return s.offsetWidth!==s.clientWidth}function Bv(s){return s.offsetHeight!==s.clientHeight}function Th(s,e,t){s.style.transform=`translate3d(${e},${t},0)`}function dD(s){let e;return s.style.transform&&(e=s.style.transform)!==""?["transform",e]:-1}function Qr(s){s.style.transform&&s.style.transform!==""&&(s.style.transform="")}function Pr(s){return s&&(["INPUT","SELECT","TEXTAREA"].indexOf(s.nodeName)>-1||s.contentEditable==="true")}function Mh(s){return Pr(s)&&s.hasAttribute("data-hot-input")===!1}function Uv(s){const e=s.ownerDocument.activeElement;Mh(e)||s.select()}function sm(s){return!s.parentNode}function Yv(s,e){new IntersectionObserver((n,o)=>{n.forEach(i=>{i.isIntersecting&&s.offsetParent!==null&&(e(),o.unobserve(s))})},{root:s.ownerDocument.body}).observe(s)}const fD=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Fv,addClass:J,addEvent:hD,clearTextSelection:Lf,closest:js,closestDown:hr,empty:Ln,fastInnerHTML:$o,fastInnerText:Js,getCaretPosition:nm,getComputedStyle:eo,getCssTransform:dD,getFrameElement:Nv,getParent:Pv,getParentWindow:xr,getScrollLeft:Wl,getScrollTop:Hr,getScrollableElement:Dr,getScrollbarWidth:xt,getSelectionEndPosition:Vv,getSelectionText:$v,getStyle:Mi,getTrimmingContainer:Ao,getWindowScrollLeft:_o,getWindowScrollTop:Ti,hasAccessToParentWindow:aD,hasClass:Oe,hasHorizontalScrollbar:Bv,hasVerticalScrollbar:Wv,index:kv,innerHeight:bs,innerWidth:Cr,isChildOf:Ks,isDetached:sm,isInput:Pr,isOutsideInput:Mh,isVisible:Ei,matchesCSSRules:lD,observeVisibilityChangeOnce:Yv,offset:Tt,outerHeight:dt,outerWidth:Qe,overlayContainsElement:Ws,removeClass:_e,removeEvent:uD,removeTextNodes:tm,resetCssTransform:Qr,selectElementIfAllowed:Uv,setCaretPosition:Zr,setOverlayPosition:Th},Symbol.toStringTag,{value:"Module"}));function nt(s){return typeof s=="function"}function zv(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=0;const n={lastCallThrottled:!0};let o=null;function i(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];const h=Date.now();let u=!1;n.lastCallThrottled=!0,t||(t=h,u=!0);const d=e-(h-t);return u?(n.lastCallThrottled=!1,s.apply(this,a)):(o&&clearTimeout(o),o=setTimeout(()=>{n.lastCallThrottled=!1,s.apply(this,a),t=0,o=void 0},d)),n}return i}function gD(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const n=zv(s,e);let o=t;function i(){o=t}function r(){for(var a=arguments.length,l=new Array(a),h=0;h<a;h++)l[h]=arguments[h];return o?(o-=1,s.apply(this,l)):n.apply(this,l)}return r.clearHits=i,r}function om(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,n;function o(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{n=s.apply(this,r)},e),n}return o}function mD(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];const[n,...o]=e;return function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return bt(o,(h,u)=>u(h),n.apply(this,a))}}function im(s){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return s.apply(this,t.concat(r))}}function Gv(s){const e=s.length;function t(n){return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];const l=n.concat(r);let h;return l.length>=e?h=s.apply(this,l):h=t(l),h}}return t([])}function pD(s){const e=s.length;function t(n){return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];const l=n.concat(r.reverse());let h;return l.length>=e?h=s.apply(this,l):h=t(l),h}}return t([])}function Bl(s,e,t,n,o,i,r,a){return le(a)?s.call(e,t,n,o,i,r,a):le(r)?s.call(e,t,n,o,i,r):le(i)?s.call(e,t,n,o,i):le(o)?s.call(e,t,n,o):le(n)?s.call(e,t,n):le(t)?s.call(e,t):s.call(e)}const wD=Object.freeze(Object.defineProperty({__proto__:null,curry:Gv,curryRight:pD,debounce:om,fastCall:Bl,isFunction:nt,partial:im,pipe:mD,throttle:zv,throttleAfterHits:gD},Symbol.toStringTag,{value:"Module"}));var CD=tn,$w=yS,yD=Lt,Ww=Hi,SD=TS,Bw=CD([].push),vD=function(s){if(yD(s))return s;if($w(s)){for(var e=s.length,t=[],n=0;n<e;n++){var o=s[n];typeof o=="string"?Bw(t,o):(typeof o=="number"||Ww(o)==="Number"||Ww(o)==="String")&&Bw(t,SD(o))}var i=t.length,r=!0;return function(a,l){if(r)return r=!1,l;if($w(this))return l;for(var h=0;h<i;h++)if(t[h]===a)return l}}},bD=Lo,jv=Ur,Kv=ch,RD=rh,Jr=tn,Xv=Rn,Uw=Lt,Yw=Cg,qv=_g,ED=vD,TD=wg,MD=String,Xs=jv("JSON","stringify"),Oa=Jr(/./.exec),zw=Jr("".charAt),OD=Jr("".charCodeAt),ID=Jr("".replace),_D=Jr(1 .toString),AD=/[\uD800-\uDFFF]/g,Gw=/^[\uD800-\uDBFF]$/,jw=/^[\uDC00-\uDFFF]$/,Kw=!TD||Xv(function(){var s=jv("Symbol")("stringify detection");return Xs([s])!=="[null]"||Xs({a:s})!=="{}"||Xs(Object(s))!=="{}"}),Xw=Xv(function(){return Xs("\uDF06\uD834")!=='"\\udf06\\ud834"'||Xs("\uDEAD")!=='"\\udead"'}),xD=function(s,e){var t=qv(arguments),n=ED(e);if(!(!Uw(n)&&(s===void 0||Yw(s))))return t[1]=function(o,i){if(Uw(n)&&(i=RD(n,this,MD(o),i)),!Yw(i))return i},Kv(Xs,null,t)},HD=function(s,e,t){var n=zw(t,e-1),o=zw(t,e+1);return Oa(Gw,s)&&!Oa(jw,o)||Oa(jw,s)&&!Oa(Gw,n)?"\\u"+_D(OD(s,0),16):s};Xs&&bD({target:"JSON",stat:!0,arity:3,forced:Kw||Xw},{stringify:function(e,t,n){var o=qv(arguments),i=Kv(Kw?xD:Xs,null,o);return Xw&&typeof i=="string"?ID(i,AD,HD):i}});function Oi(s){let e;return Array.isArray(s)?e=s.length?new Array(s.length).fill(null):[]:(e={},Fe(s,(t,n)=>{n!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[n]=Oi(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[n]=[Oi(t[0])]:e[n]=[]:e[n]=null)})),e}function As(s,e){return e.prototype.constructor=e,s.prototype=new e,s.prototype.constructor=s,s}function Mt(s,e,t){const n=Array.isArray(t);return Fe(e,(o,i)=>{(n===!1||t.includes(i))&&(s[i]=o)}),s}function ea(s,e){Fe(e,(t,n)=>{e[n]&&typeof e[n]=="object"?(s[n]||(Array.isArray(e[n])?s[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?s[n]=e[n]:s[n]={}),ea(s[n],e[n])):s[n]=e[n]})}function Ut(s){return typeof s=="object"?JSON.parse(JSON.stringify(s)):s}function Jt(s){const e={};return Fe(s,(t,n)=>{e[n]=t}),e}function tt(s){s.MIXINS||(s.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return I(t,o=>{s.MIXINS.push(o.MIXIN_NAME),Fe(o,(i,r)=>{if(s.prototype[r]!==void 0)throw new Error(`Mixin conflict. Property '${r}' already exist and cannot be overwritten.`);if(typeof i=="function")s.prototype[r]=i;else{const a=function(u,d){const f=`_${u}`,m=w=>{let C=w;return(Array.isArray(C)||Le(C))&&(C=Ut(C)),C};return function(){return this[f]===void 0&&(this[f]=m(d)),this[f]}},l=function(u){const d=`_${u}`;return function(f){this[d]=f}};Object.defineProperty(s.prototype,r,{get:a(r,i),set:l(r),configurable:!0})}})}),s}function Oh(s,e){return JSON.stringify(s)===JSON.stringify(e)}function Le(s){return Object.prototype.toString.call(s)==="[object Object]"}function rs(s,e,t,n){n.value=t,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(s,e,n)}function Fe(s,e){for(const t in s)if((!s.hasOwnProperty||s.hasOwnProperty&&Object.prototype.hasOwnProperty.call(s,t))&&e(s[t],t,s)===!1)break;return s}function Zv(s,e){const t=e.split(".");let n=s;return Fe(t,o=>{if(n=n[o],n===void 0)return n=void 0,!1}),n}function yl(s,e,t){const n=e.split(".");let o=s;n.forEach((i,r)=>{r!==n.length-1?(wt(o,i)||(o[i]={}),o=o[i]):o[i]=t})}function Ih(s){if(!Le(s))return 0;const e=function(t){let n=0;return Le(t)?Fe(t,(o,i)=>{i!=="__children"&&(n+=e(o))}):n+=1,n};return e(s)}function xo(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,n={_touched:!1,[t]:s,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[t]},set(o){this._touched=!0,this[t]=o},enumerable:!0,configurable:!0}),n}function wt(s,e){return Object.prototype.hasOwnProperty.call(s,e)}const DD=Object.freeze(Object.defineProperty({__proto__:null,clone:Jt,createObjectPropListener:xo,deepClone:Ut,deepExtend:ea,deepObjectSize:Ih,defineGetter:rs,duckSchema:Oi,extend:Mt,getProperty:Zv,hasOwnProperty:wt,inherit:As,isObject:Le,isObjectEqual:Oh,mixin:tt,objectEach:Fe,setProperty:yl},Symbol.toStringTag,{value:"Module"})),yn=s=>{const e={value:!1};return e.test=(t,n)=>{e.value=s(t,n)},e},xs={chrome:yn((s,e)=>/Chrome/.test(s)&&/Google/.test(e)),chromeWebKit:yn(s=>/CriOS/.test(s)),edge:yn(s=>/Edge/.test(s)),edgeWebKit:yn(s=>/EdgiOS/.test(s)),firefox:yn(s=>/Firefox/.test(s)),firefoxWebKit:yn(s=>/FxiOS/.test(s)),mobile:yn(s=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(s)),safari:yn((s,e)=>/Safari/.test(s)&&/Apple Computer/.test(e))},Ni={mac:yn(s=>/^Mac/.test(s)),win:yn(s=>/^Win/.test(s)),linux:yn(s=>/^Linux/.test(s)),ios:yn(s=>/iPhone|iPad|iPod/i.test(s))};function Qv(){let{userAgent:s=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fe(xs,t=>{let{test:n}=t;return void n(s,e)})}function Jv(){let{platform:s=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fe(Ni,e=>{let{test:t}=e;return void t(s)})}Qv();Jv();function rm(){return xs.chrome.value}function eb(){return xs.chromeWebKit.value}function Sl(){return xs.firefox.value}function tb(){return xs.firefoxWebKit.value}function PD(){return xs.safari.value}function nb(){return xs.edge.value}function ND(){return xs.edgeWebKit.value}function Dn(){return xs.mobile.value}function am(){return Ni.ios.value}function lm(){let{maxTouchPoints:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return s>2&&Ni.mac.value}function Ff(){return Ni.win.value}function Ul(){return Ni.mac.value}function kD(){return Ni.linux.value}const LD=Object.freeze(Object.defineProperty({__proto__:null,isChrome:rm,isChromeWebKit:eb,isEdge:nb,isEdgeWebKit:ND,isFirefox:Sl,isFirefoxWebKit:tb,isIOS:am,isIpadOS:lm,isLinuxOS:kD,isMacOS:Ul,isMobileBrowser:Dn,isSafari:PD,isWindowsOS:Ff,setBrowserMeta:Qv,setPlatformMeta:Jv},Symbol.toStringTag,{value:"Module"})),de={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Sl()?182:174,AUDIO_MUTE:Sl()?181:173,AUDIO_UP:Sl()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FD=[de.ALT,de.ARROW_DOWN,de.ARROW_LEFT,de.ARROW_RIGHT,de.ARROW_UP,de.AUDIO_DOWN,de.AUDIO_MUTE,de.AUDIO_UP,de.BACKSPACE,de.CAPS_LOCK,de.DELETE,de.END,de.ENTER,de.ESCAPE,de.F1,de.F2,de.F3,de.F4,de.F5,de.F6,de.F7,de.F8,de.F9,de.F10,de.F11,de.F12,de.F13,de.F14,de.F15,de.F16,de.F17,de.F18,de.F19,de.HOME,de.INSERT,de.MEDIA_NEXT,de.MEDIA_PLAY_PAUSE,de.MEDIA_PREV,de.MEDIA_STOP,de.NULL,de.NUM_LOCK,de.PAGE_DOWN,de.PAGE_UP,de.PAUSE,de.SCROLL_LOCK,de.SHIFT,de.TAB];function sb(s){return s===32||s>=48&&s<=57||s>=96&&s<=111||s>=186&&s<=192||s>=219&&s<=222||s>=226||s>=65&&s<=90}function hm(s){return FD.includes(s)}function VD(s){const e=[];return Ul()?e.push(de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX):e.push(de.CONTROL),e.includes(s)}function ob(s){return[de.CONTROL,de.COMMAND_LEFT,de.COMMAND_RIGHT,de.COMMAND_FIREFOX].includes(s)}function Ii(s,e){const t=e.split("|");let n=!1;return I(t,o=>{if(s===de[o])return n=!0,!1}),n}const $D=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:de,isCtrlKey:VD,isCtrlMetaKey:ob,isFunctionKey:hm,isKey:Ii,isPrintableChar:sb},Symbol.toStringTag,{value:"Module"}));function Fn(s){s.isImmediatePropagationEnabled=!1,s.cancelBubble=!0}function bo(s){return s.isImmediatePropagationEnabled===!1}function to(s){return s.button===2}function _h(s){return s.button===0}const WD=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:bo,isLeftClick:_h,isRightClick:to,stopImmediatePropagation:Fn},Symbol.toStringTag,{value:"Module"}));function it(){le(console)&&console.warn(...arguments)}function um(){le(console)&&console.error(...arguments)}const jo=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],BD=Je`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Xc=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),qc=new Map([]);class ib{static getSingleton(){return YD()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return I(jo,t=>e[t]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(t))I(t,o=>this.add(e,o,n));else{Xc.has(e)&&it(em(BD,{hookName:e,removedInVersion:Xc.get(e)})),qc.has(e)&&it(qc.get(e));const o=this.getBucket(n);if(typeof o[e]>"u"&&(this.register(e),o[e]=[]),t.skip=!1,o[e].indexOf(t)===-1){let i=!1;t.initialHook&&I(o[e],(r,a)=>{if(r.initialHook)return o[e][a]=t,i=!0,!1}),i||o[e].push(t)}}return this}once(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(t)?I(t,o=>this.once(e,o,n)):(t.runOnce=!0,this.add(e,t,n))}remove(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const o=this.getBucket(n);return typeof o[e]<"u"&&o[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const n=this.getBucket(t);return!!(n[e]!==void 0&&n[e].length)}run(e,t,n,o,i,r,a,l){{const h=this.globalBucket[t],u=h?h.length:0;let d=0;if(u)for(;d<u;){if(!h[d]||h[d].skip){d+=1;continue}const f=Bl(h[d],e,n,o,i,r,a,l);f!==void 0&&(n=f),h[d]&&h[d].runOnce&&this.remove(t,h[d]),d+=1}}{const h=this.getBucket(e)[t],u=h?h.length:0;let d=0;if(u)for(;d<u;){if(!h[d]||h[d].skip){d+=1;continue}const f=Bl(h[d],e,n,o,i,r,a,l);f!==void 0&&(n=f),h[d]&&h[d].runOnce&&this.remove(t,h[d],e),d+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Fe(this.getBucket(e),(t,n,o)=>o[n].length=0)}register(e){this.isRegistered(e)||jo.push(e)}deregister(e){this.isRegistered(e)&&jo.splice(jo.indexOf(e),1)}isDeprecated(e){return qc.has(e)||Xc.has(e)}isRegistered(e){return jo.indexOf(e)>=0}getRegistered(){return jo}}const UD=new ib;function YD(){return UD}const ce=ib,Zc=new Map;function Mn(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Zc.has(s)||Zc.set(s,new Map);const e=Zc.get(s);function t(a,l){e.set(a,l)}function n(a){return e.get(a)}function o(a){return e.has(a)}function i(){return[...e.keys()]}function r(){return[...e.values()]}return{register:t,getItem:n,hasItem:o,getNames:i,getValues:r}}const Vf=new WeakMap,{register:zD,getItem:rb,hasItem:ab,getNames:GD,getValues:_z}=Mn("editors");function jD(s){const e={},t=s;this.getConstructor=function(){return s},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new t(n)),e[n.guid]},ce.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function lb(s,e){let t;if(typeof s=="function")Vf.get(s)||rn(null,s),t=Vf.get(s);else if(typeof s=="string")t=rb(s);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${s}"`);return t.getInstance(e)}function Yl(s){if(typeof s=="function")return s;if(!ab(s))throw Error(`No registered editor found under "${s}" name`);return rb(s).getConstructor()}function rn(s,e){s&&typeof s!="string"&&(e=s,s=e.EDITOR_TYPE);const t=new jD(e);typeof s=="string"&&zD(s,t),Vf.set(e,t)}let vl=0;class KD{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,n){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function i(r){n.call(this,XD(r))}return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:i,options:o,eventManager:this}),e.addEventListener(t,i,o),vl+=1,()=>{this.removeEventListener(e,t,n)}}removeEventListener(e,t,n){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=this.context.eventListeners.length,r;for(;i;)if(i-=1,r=this.context.eventListeners[i],r.event===t&&r.element===e){if(n&&n!==r.callback||o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),vl-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const n=this.context.eventListeners[t];e&&n.eventManager!==this||(this.context.eventListeners.splice(t,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),vl-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let n=e.document,o=e;n||(n=e.ownerDocument?e.ownerDocument:e,o=n.defaultView);const i={bubbles:!0,cancelable:t!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;n.createEvent?(r=n.createEvent("MouseEvents"),r.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,n.body.parentNode)):r=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(r):e.fireEvent(`on${t}`,r)}}function XD(s){const e=s.stopImmediatePropagation;return s.stopImmediatePropagation=function(){e.apply(this),Fn(this)},s}const ft=KD;function qD(){return vl}const Ah="editorManager.navigation",yr="editorManager.handlingEditor";class $f{constructor(e,t,n){this.instance=e,this.tableMeta=t,this.selection=n,this.eventManager=new ft(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.getShortcutManager().addContext("editor"),this.registerShortcuts(),this.instance.addHook("afterDocumentKeyDown",i=>this.onAfterDocumentKeyDown(i)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",i)}),this.instance.view._wt.update("onCellDblClick",(i,r,a)=>this.onCellDblClick(i,r,a))}registerShortcuts(){const e=this.instance.getShortcutManager(),t=e.getContext("grid"),n=e.getContext("editor"),o={group:yr};n.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(i,r)=>{this.closeEditorAndSaveChanges(e.isCtrlPressed()),this.moveSelectionAfterEnter(r.includes("shift"))}},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>{this.closeEditorAndRestoreOriginalValue(e.isCtrlPressed()),this.activeEditor.focus()}}],o),t.addShortcuts([{keys:[["F2"]],callback:i=>{this.openEditor(null,i,!0)}},{keys:[["Backspace"],["Delete"]],callback:()=>{this.instance.emptySelectedCells(),this.prepareEditor()}},{keys:[["Enter"],["Enter","Shift"]],callback:(i,r)=>{this.instance.getSettings().enterBeginsEditing?this.cellProperties.readOnly?this.moveSelectionAfterEnter():this.openEditor(null,i,!0):this.moveSelectionAfterEnter(r.includes("shift")),Fn(i)}}],{...o,runOnlyIf:()=>le(this.instance.getSelected())})}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{row:e,col:t}=this.instance.getSelectedRangeLast().highlight,n=this.instance.runHooks("modifyGetCellCoords",e,t);let o=e,i=t;Array.isArray(n)&&([o,i]=n),this.cellProperties=this.instance.getCellMeta(o,i);const{activeElement:r}=this.instance.rootDocument;if(r&&Mh(r)&&r.blur(),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.instance.getCell(e,t,!0);if(a){const l=this.instance.getCellEditor(this.cellProperties),h=this.instance.colToProp(i),u=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(o),i);this.activeEditor=lb(l,this.instance),this.activeEditor.prepare(e,t,h,a,u,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}if(!this.activeEditor){const{row:o,col:i}=this.instance.getSelectedRangeLast().highlight,r=this.instance.rowIndexMapper.getRenderableFromVisualIndex(o),a=this.instance.columnIndexMapper.getRenderableFromVisualIndex(i);this.instance.view.scrollViewport(this.instance._createCellCoords(r,a)),this.instance.view.render(),this.prepareEditor()}this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,n){this.activeEditor?this.activeEditor.finishEditing(e,t,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.instance.getCellEditor(this.cellProperties),{row:t,col:n}=this.instance.getSelectedRangeLast().highlight,{rowIndexMapper:o,columnIndexMapper:i}=this.instance,r=o.isHidden(this.instance.toPhysicalRow(t))||i.isHidden(this.instance.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!e||r)}moveSelectionAfterEnter(e){const t=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}onAfterDocumentKeyDown(e){if(!this.instance.isListening())return;const{keyCode:t}=e;if(!this.selection.isSelected())return;const n=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!hm(t)&&!ob(t)&&!n&&!this.isEditorOpened()){const i=this.instance.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.instance.getSelected()),group:Ah};i.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],r),this.openEditor("",e)}}onCellDblClick(e,t,n){n.nodeName==="TD"&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const qw=new WeakMap;$f.getInstance=function(s,e,t){let n=qw.get(s);return n||(n=new $f(s,e,t),qw.set(s,n)),n};const ZD=$f,hb={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},QD=new RegExp(Object.keys(hb).map(s=>`(${s})`).join("|"),"gi");function JD(s){return(s&&s.nodeName||"")==="TABLE"}function Wf(s){const e=s.hasColHeaders(),t=s.hasRowHeaders(),n=[e?-1:0,t?-1:0,s.countRows()-1,s.countCols()-1],o=s.getData(...n),i=o.length,r=i>0?o[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],h=["<tbody>","</tbody>"],u=t?1:0,d=e?1:0;for(let f=0;f<i;f+=1){const m=e&&f===0,w=[];for(let R=0;R<r;R+=1){const H=!m&&t&&R===0;let A="";if(m)A=`<th>${s.getColHeader(R-u)}</th>`;else if(H)A=`<th>${s.getRowHeader(f-d)}</th>`;else{const _=o[f][R],{hidden:O,rowspan:D,colspan:G}=s.getCellMeta(f-d,R-u);if(!O){const z=[];if(D&&z.push(`rowspan="${D}"`),G&&z.push(`colspan="${G}"`),It(_))A=`<td ${z.join(" ")}></td>`;else{const ee=_.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");A=`<td ${z.join(" ")}>${ee}</td>`}}}w.push(A)}const C=["<tr>",...w,"</tr>"].join("");m?l.splice(1,0,C):h.splice(-1,0,C)}return a.splice(1,0,l.join(""),h.join("")),a.join("")}function Bf(s){const e=s.length,t=["<table>"];for(let n=0;n<e;n+=1){const o=s[n],i=o.length,r=[];n===0&&t.push("<tbody>");for(let a=0;a<i;a+=1){const l=o[a],h=It(l)?"":l.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");r.push(`<td>${h}</td>`)}t.push("<tr>",...r,"</tr>"),n+1===e&&t.push("</tbody>")}return t.push("</table>"),t.join("")}function ub(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},n=e.createDocumentFragment(),o=e.createElement("div");n.appendChild(o);let i=s;if(typeof i=="string"){const _=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,O=>{const D=O.match(/<td\b[^>]*?>/g)[0],G=O.substring(D.length,O.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${D}${G}</td>`});o.insertAdjacentHTML("afterbegin",`${_}`),i=o.querySelector("table")}if(!i||!JD(i))return;const r=o.querySelector('meta[name$="enerator"]'),a=i.querySelector("tbody th")!==null,l=i.querySelector("tr"),h=l?Array.from(l.cells).reduce((_,O)=>_+O.colSpan,0)-(a?1:0):0,u=i.tFoot&&Array.from(i.tFoot.rows)||[],d=[];let f=!1,m=0,w=0;if(i.tHead){const _=Array.from(i.tHead.rows).filter(O=>{const D=O.querySelector("td")!==null;return D&&d.push(O),!D});m=_.length,f=m>0,m>1?t.nestedHeaders=Array.from(_).reduce((O,D)=>{const G=Array.from(D.cells).reduce((z,ee,X)=>{if(a&&X===0)return z;const{colSpan:q,innerHTML:oe}=ee,ie=q>1?{label:oe,colspan:q}:oe;return z.push(ie),z},[]);return O.push(G),O},[]):f&&(t.colHeaders=Array.from(_[0].children).reduce((O,D,G)=>(a&&G===0||O.push(D.innerHTML),O),[]))}d.length&&(t.fixedRowsTop=d.length),u.length&&(t.fixedRowsBottom=u.length);const C=[...d,...Array.from(i.tBodies).reduce((_,O)=>(_.push(...Array.from(O.rows)),_),[]),...u];w=C.length;const R=new Array(w);for(let _=0;_<w;_++)R[_]=new Array(h);const H=[],A=[];for(let _=0;_<w;_++){const O=C[_],D=Array.from(O.cells),G=D.length;for(let z=0;z<G;z++){const ee=D[z],{nodeName:X,innerHTML:q,rowSpan:oe,colSpan:ie}=ee,re=R[_].findIndex(pe=>pe===void 0);if(X==="TD"){if(oe>1||ie>1){for(let Ae=_;Ae<_+oe;Ae++)if(Ae<w)for(let b=re;b<re+ie;b++)R[Ae][b]=null;const Me=ee.getAttribute("style");Me&&Me.includes("mso-ignore:colspan")||H.push({col:re,row:_,rowspan:oe,colspan:ie})}let pe="";r&&/excel/gi.test(r.content)?pe=q.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):pe=q.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),R[_][re]=pe.replace(QD,Me=>hb[Me])}else A.push(q)}}return H.length&&(t.mergeCells=H),A.length&&(t.rowHeaders=A),R.length&&(t.data=R),t}const eP=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Bf,htmlToGridSettings:ub,instanceToHTML:Wf},Symbol.toStringTag,{value:"Module"}));function Qt(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof s;if(t==="number")return!isNaN(s)&&isFinite(s);if(t==="string"){if(s.length===0)return!1;if(s.length===1)return/\d/.test(s);const n=Array.from(new Set([".",...e])).map(o=>`\\${o}`).join("|");return new RegExp(`^[+-]?\\s*(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(s.trim())}else if(t==="object")return!!s&&typeof s.valueOf()=="number"&&!(s instanceof Date);return!1}function cb(s){return Qt(s,[","])}function me(s,e,t){let n=-1;for(typeof e=="function"?(t=e,e=s):n=s-1;++n<=e&&t(n)!==!1;);}function zl(s,e,t){let n=s+1;for(typeof e=="function"&&(t=e,e=0);--n>=e&&t(n)!==!1;);}function cm(s,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(s*e/100,10)}const tP=Object.freeze(Object.defineProperty({__proto__:null,isNumeric:Qt,isNumericLike:cb,rangeEach:me,rangeEachReverse:zl,valueAccordingPercent:cm},Symbol.toStringTag,{value:"Module"})),Uf="asc",nP="desc",Zw=new Map([[Uf,[-1,1]],[nP,[1,-1]]]),sP=s=>`The priority '${s}' is already declared in a map.`,oP=s=>`The priority '${s}' is not a number.`;function iP(){let{errorPriorityExists:s,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;s=nt(s)?s:sP,e=nt(e)?e:oP;function n(i,r){if(!Qt(i))throw new Error(e(i));if(t.has(i))throw new Error(s(i));t.set(i,r)}function o(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Uf;const[r,a]=Zw.get(i)||Zw.get(Uf);return[...t].sort((l,h)=>l[0]<h[0]?r:a).map(l=>l[1])}return{addItem:n,getItems:o}}const rP=s=>`The id '${s}' is already declared in a map.`;function xh(){let{errorIdExists:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;s=nt(s)?s:rP;function t(h,u){if(l(h))throw new Error(s(h));e.set(h,u)}function n(h){return e.delete(h)}function o(){e.clear()}function i(h){const[u]=a().find(d=>{let[f,m]=d;return h===m?f:!1})||[null];return u}function r(h){return e.get(h)}function a(){return[...e]}function l(h){return e.has(h)}return{addItem:t,clear:o,getId:i,getItem:r,getItems:a,hasItem:l,removeItem:n}}const aP=s=>`'${s}' value is already declared in a unique set.`;function lP(){let{errorItemExists:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;s=nt(s)?s:aP;function t(i){if(e.has(i))throw new Error(s(i));e.add(i)}function n(){return[...e]}function o(){e.clear()}return{addItem:t,clear:o,getItems:n}}const dm=s=>`There is already registered "${s}" plugin.`,hP=s=>`There is already registered plugin on priority "${s}".`,uP=s=>`The priority "${s}" is not a number.`,db=iP({errorPriorityExists:hP,errorPriorityNaN:uP}),fb=lP({errorItemExists:dm}),Yf=xh({errorIdExists:dm});function fm(){return[...db.getItems(),...fb.getItems()]}function ta(s){const e=Bt(s);return Yf.getItem(e)}function cP(s){return!!ta(s)}function He(s,e,t){[s,e,t]=fP(s,e,t),ta(s)===void 0&&dP(s,e,t)}function dP(s,e,t){const n=Bt(s);if(Yf.hasItem(n))throw new Error(dm(n));t===void 0?fb.addItem(n):db.addItem(t,n),Yf.addItem(n,e)}function fP(s,e,t){return typeof s=="function"&&(e=s,s=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[s,e,t]}const{register:gP,getItem:mP,hasItem:gb,getNames:pP,getValues:Az}=Mn("renderers");function Gl(s){if(typeof s=="function")return s;if(!gb(s))throw Error(`No registered renderer found under "${s}" name`);return mP(s)}function Xn(s,e){typeof s!="string"&&(e=s,s=e.RENDERER_TYPE),gP(s,e)}const{register:wP,getItem:CP,hasItem:mb,getNames:yP,getValues:xz}=Mn("validators");function gm(s){if(typeof s=="function")return s;if(!mb(s))throw Error(`No registered validator found under "${s}" name`);return CP(s)}function pi(s,e){typeof s!="string"&&(e=s,s=e.VALIDATOR_TYPE),wP(s,e)}var pb={},SP=pS,vP=Og,bP=Object.keys||function(e){return SP(e,vP)},RP=ns,EP=hS,TP=ko,MP=Yr,OP=ah,IP=bP;pb.f=RP&&!EP?Object.defineProperties:function(e,t){MP(e);for(var n=OP(t),o=IP(t),i=o.length,r=0,a;i>r;)TP.f(e,a=o[r++],n[a]);return e};var _P=Yr,AP=pb,Qw=Og,xP=Eg,HP=AS,DP=bg,PP=dS,Jw=">",eC="<",zf="prototype",Gf="script",wb=PP("IE_PROTO"),Qc=function(){},Cb=function(s){return eC+Gf+Jw+s+eC+"/"+Gf+Jw},tC=function(s){s.write(Cb("")),s.close();var e=s.parentWindow.Object;return s=null,e},NP=function(){var s=DP("iframe"),e="java"+Gf+":",t;return s.style.display="none",HP.appendChild(s),s.src=String(e),t=s.contentWindow.document,t.open(),t.write(Cb("document.F=Object")),t.close(),t.F},Ia,bl=function(){try{Ia=new ActiveXObject("htmlfile")}catch{}bl=typeof document<"u"?document.domain&&Ia?tC(Ia):NP():tC(Ia);for(var s=Qw.length;s--;)delete bl[zf][Qw[s]];return bl()};xP[wb]=!0;var kP=Object.create||function(e,t){var n;return e!==null?(Qc[zf]=_P(e),n=new Qc,Qc[zf]=null,n[wb]=e):n=bl(),t===void 0?n:AP.f(n,t)},LP=hh,FP=kP,VP=ko.f,jf=LP("unscopables"),Kf=Array.prototype;Kf[jf]===void 0&&VP(Kf,jf,{configurable:!0,value:FP(null)});var $P=function(s){Kf[jf][s]=!0},WP=Lo,BP=lh,UP=uh,YP=Mg,zP=$P;WP({target:"Array",proto:!0},{at:function(e){var t=BP(this),n=UP(t),o=YP(e),i=o>=0?o:n+o;return i<0||i>=n?void 0:t[i]}});zP("at");const Ro=1,$t=2,Ko=new WeakMap;class mm{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:n,itemSizeFn:o,overrideFn:i,calculationType:r,stretchMode:a,stretchingItemWidthFn:l=u=>u,inlineStartOffset:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ko.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:n,columnWidthFn:o,overrideFn:i,calculationType:r,stretchingColumnWidthFn:l,inlineStartOffset:h}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,t=!0;const n=[];let o,i=0,r=0;const a=Ko.get(this),l=a.calculationType,h=a.overrideFn,u=a.scrollOffset,d=Math.max(a.scrollOffset,0),f=a.totalColumns,m=a.viewportWidth,w=d>0?m+1:m;for(let A=0;A<f;A++)if(o=this._getColumnWidth(A),e<=d&&l!==$t&&(this.startColumn=A,i=o),e>=d&&e+(l===$t?o:0)<=d+w&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=A,i=o),this.endColumn=A),n.push(e),e+=o,r=o,l!==$t&&(this.endColumn=A),e>=d+m){t=!1;break}const C=u+m-w,R=l===$t?0:r,H=l===$t?i:0;if(C<-1*a.inlineStartOffset||u>n.at(-1)+R||-1*a.scrollOffset-a.viewportWidth>-1*H?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===f-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){const A=n[this.endColumn]+o-n[this.startColumn-1];if((A<=m||l!==$t)&&(this.startColumn-=1),A>m)break}l===Ro&&this.startColumn!==null&&h&&h(this),this.startPosition=n[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch==="none")return;let t=e;this.totalTargetWidth=t;const n=Ko.get(this),o=n.totalColumns;let i=0;for(let a=0;a<o;a++){const l=this._getColumnWidth(a),h=n.stretchingColumnWidthFn(void 0,a);typeof h=="number"?t-=h:i+=l}const r=t-i;if(this.stretch==="all"&&r>0)this.stretchAllRatio=t/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&t!==1/0){const a=this._getColumnWidth(o-1),l=r+a;this.stretchLastWidth=l>=0?l:a}}getStretchedColumnWidth(e,t){let n=null;return this.stretch==="all"&&this.stretchAllRatio!==0?n=this._getStretchedAllColumnWidth(e,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(n=this._getStretchedLastColumnWidth(e)),n}_getStretchedAllColumnWidth(e,t){let n=0;const o=Ko.get(this),i=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){const r=Math.round(t*this.stretchAllRatio),a=o.stretchingColumnWidthFn(r,e);a===void 0?this.stretchAllColumnsWidth[e]=r:this.stretchAllColumnsWidth[e]=isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let r=0;r<this.stretchAllColumnsWidth.length;r++)n+=this.stretchAllColumnsWidth[r];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=Ko.get(this).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=Ko.get(this).columnWidthFn(e);return isNaN(t)&&(t=mm.DEFAULT_WIDTH),t}}const pm=mm,nC=new WeakMap;class wm{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:n,itemSizeFn:o,overrideFn:i,calculationType:r,scrollbarHeight:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};nC.set(this,{viewportHeight:e,scrollOffset:t,totalRows:n,rowHeightFn:o,overrideFn:i,calculationType:r,horizontalScrollbarHeight:a}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const e=nC.get(this),t=e.calculationType,n=e.overrideFn,o=e.rowHeightFn,i=e.scrollOffset,r=Math.max(e.scrollOffset,0),a=e.totalRows,l=e.viewportHeight,h=e.horizontalScrollbarHeight||0;let u=0,d=!0;const f=[];let m,w=0,C=0;for(let _=0;_<a;_++)if(m=o(_),isNaN(m)&&(m=wm.DEFAULT_HEIGHT),u<=r&&t!==$t&&(this.startRow=_,w=m),u>=r&&u+(t===$t?m:0)<=r+l-h&&(this.startRow===null&&(this.startRow=_,w=m),this.endRow=_),f.push(u),u+=m,C=m,t!==$t&&(this.endRow=_),u>=r+l-h){d=!1;break}const R=i+l-h,H=t===$t?w:0,A=t===$t?0:C;if(R<H||i>f.at(-1)+A?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===a-1&&d)for(this.startRow=this.endRow;this.startRow>0;){const _=f[this.endRow]+m-f[this.startRow-1];if((_<=l-h||t!==$t)&&(this.startRow-=1),_>=l-h)break}t===Ro&&this.startRow!==null&&n&&n(this),this.startPosition=f[this.startRow],this.startPosition===void 0&&(this.startPosition=null),a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const yb=wm;function GP(s,e,t){jP(s,e),e.set(s,t)}function jP(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sC(s,e,t){return e=KP(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function KP(s){var e=XP(s,"string");return typeof e=="symbol"?e:String(e)}function XP(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Gi(s,e){var t=Sb(s,e,"get");return qP(s,t)}function qP(s,e){return e.get?e.get.call(s):e.value}function ZP(s,e,t){var n=Sb(s,e,"set");return QP(s,n,t),t}function Sb(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function QP(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var ho=new WeakMap;class Cm{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;sC(this,"row",null),sC(this,"col",null),GP(this,ho,{writable:!0,value:!1}),ZP(this,ho,n),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){return!(this.row<0||this.col<0||this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isSouthEastOf(e){return this.row>=e.row&&(Gi(this,ho)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Gi(this,ho)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Gi(this,ho)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Gi(this,ho)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}clone(){return new Cm(this.row,this.col,Gi(this,ho))}toObject(){return{row:this.row,col:this.col}}}const jl=Cm;function JP(s,e,t){eN(s,e),e.set(s,t)}function eN(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jc(s,e,t){return e=tN(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function tN(s){var e=nN(s,"string");return typeof e=="symbol"?e:String(e)}function nN(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Wn(s,e){var t=vb(s,e,"get");return sN(s,t)}function sN(s,e){return e.get?e.get.call(s):e.value}function oN(s,e,t){var n=vb(s,e,"set");return iN(s,n,t),t}function vb(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function iN(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var pn=new WeakMap;class ym{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Jc(this,"highlight",null),Jc(this,"from",null),Jc(this,"to",null),JP(this,pn,{writable:!0,value:!1}),this.highlight=e.clone().normalize(),this.from=t.clone(),this.to=n.clone(),oN(this,pn,o)}setHighlight(e){return this.highlight=e.clone().normalize(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:n}=e,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=t&&i.row>=t&&o.col<=n&&i.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),o=this.getDirection(),i=e.getOuterTopStartCorner(),r=e.getOuterBottomEndCorner(),a=Math.min(t.row,i.row),l=Math.min(t.col,i.col),h=Math.max(n.row,r.row),u=Math.max(n.col,r.col),d=this._createCellCoords(a,l),f=this._createCellCoords(h,u);return this.from=d,this.to=f,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Wn(this,pn)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Wn(this,pn)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Wn(this,pn)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Wn(this,pn)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Wn(this,pn)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Wn(this,pn)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Wn(this,pn)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Wn(this,pn)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,t){return t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,t){if(!(e instanceof jl))return!1;if(t){const{from:n,to:o}=t;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(n.row,n.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(n.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,n.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return t.top===n.top&&o.push("top"),t.right===n.right&&o.push("right"),t.bottom===n.bottom&&o.push("bottom"),t.left===n.left&&o.push("left"),o}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let o=e.row;o<=t.row;o++)for(let i=e.col;i<=t.col;i++)!(this.from.row===o&&this.from.col===i)&&!(this.to.row===o&&this.to.col===i)&&n.push(this._createCellCoords(o,i));return n}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),n=[];for(let o=e.row;o<=t.row;o++)for(let i=e.col;i<=t.col;i++)e.row===o&&e.col===i?n.push(e):t.row===o&&t.col===i?n.push(t):n.push(this._createCellCoords(o,i));return n}forAll(e){const t=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let o=t.row;o<=n.row;o++)for(let i=t.col;i<=n.col;i++)if(e(o,i)===!1)return}clone(){return new ym(this.highlight,this.from,this.to,Wn(this,pn))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new jl(e,t,Wn(this,pn))}}const Sm=ym;function Hh(s){return window.requestAnimationFrame(s)}function Nr(s){window.cancelAnimationFrame(s)}function vm(){return"ontouchstart"in window}let Xo;function bb(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Xo||(typeof Intl=="object"?Xo=new Intl.Collator(s,e).compare:typeof String.prototype.localeCompare=="function"?Xo=(t,n)=>`${t}`.localeCompare(n):Xo=(t,n)=>t===n?0:t>n?-1:1,Xo)}const rN=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Nr,getComparisonFunction:bb,isTouchSupported:vm,requestAnimationFrame:Hh},Symbol.toStringTag,{value:"Module"})),qo=new WeakMap;let aN=class{constructor(e,t,n,o,i,r){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;this.wtSettings=n,this.domBindings=t,this.wtTable=i,this.selections=r,this.parent=a,this.eventManager=o,this.facadeGetter=e,qo.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",n=>this.onContextMenu(n)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",n=>this.onMouseOver(n)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",n=>this.onTouchStart(n)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",n=>this.onMouseUp(n)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",n=>this.onMouseDown(n))};Dn()?e():(vm()&&e(),t())}selectedCellWasTouched(e){const t=qo.get(this),o=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&o){const[i,r]=[o.row,t.selectedCellBeforeTouchEnd.from.row],[a,l]=[o.col,t.selectedCellBeforeTouchEnd.from.col];return i===r&&a===l}return!1}parentCell(e){const t={},n=this.wtTable.TABLE,o=hr(e,["TD","TH"],n);return o?(t.coords=this.wtTable.getCoords(o),t.TD=o):Oe(e,"wtBorder")&&Oe(e,"current")?(t.coords=this.selections.getCell().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Oe(e,"wtBorder")&&Oe(e,"area")&&this.selections.createOrGetArea().cellRange&&(t.coords=this.selections.createOrGetArea().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}onMouseDown(e){const t=qo.get(this),n=this.domBindings.rootDocument.activeElement,o=im(Pv,e.target),i=e.target;if(i===n||o(0)===n||o(1)===n)return;const r=this.parentCell(i);Oe(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,i):r.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,r.coords,r.TD),(e.button===0||this.touchApplied)&&r.TD&&(t.dblClickOrigin[0]=r.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(()=>{t.dblClickOrigin[0]=null},1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;const t=this.wtTable.TABLE,n=hr(e.target,["TD","TH"],t),o=this.parent||this;n&&n!==o.lastMouseOver&&Ks(n,t)&&(o.lastMouseOver=n,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(n),n))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;const t=this.wtTable.TABLE,n=hr(e.target,["TD","TH"],t),o=hr(e.relatedTarget,["TD","TH"],t),i=this.parent||this;n&&n!==o&&Ks(n,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(n),n),o===null&&(i.lastMouseOver=null))}onMouseUp(e){const t=qo.get(this),n=this.parentCell(e.target);n.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===t.dblClickOrigin[0]&&n.TD===t.dblClickOrigin[1]?(Oe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):n.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(()=>{t.dblClickOrigin[1]=null},500)))}onTouchStart(e){const t=qo.get(this);t.selectedCellBeforeTouchEnd=this.selections.getCell().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,o=(t=this.parentCell(n))===null||t===void 0?void 0:t.coords,i=le(o)&&o.row>=0&&o.col>=0;if(e.cancelable&&i&&this.wtSettings.getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];am()&&(eb()||tb())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,o){const i=this.wtSettings.getSettingPure(e);i&&i(t,n,o,this.facadeGetter())}destroy(){const e=qo.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}};const Rb=aN;class lN{constructor(e,t,n){this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const hN=lN;class uN{constructor(e,t,n){this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const cN=uN,dN=0,Kl=1,Xl=2;class oC{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class fN{constructor(){this.size=new oC,this.workingSpace=dN,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof oC}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Kl,e.workingSpace=Xl,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Xl,e.workingSpace=Kl,this.sharedSize=e.getViewSize()}}class Eb{constructor(e,t,n){this.rootNode=e,this.nodesPool=t,this.sizeSet=new fN,this.childNodeType=n.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let n=0;if(this.isSharedViewSet()){let o=e.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(Kl))break;o=o.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,n=this.isSharedViewSet(),{nextSize:o}=t.getViewSize();let i=this.getRenderedChildCount();for(;i<o;){const a=this.nodesPool();!n||n&&t.isPlaceOn(Xl)?e.appendChild(a):e.insertBefore(a,e.firstChild),i+=1}const r=n&&t.isPlaceOn(Kl);for(;i>o;)e.removeChild(r?e.firstChild:e.lastChild),i-=1}render(){const{rootNode:e,sizeSet:t}=this;let n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(Xl)&&(n+=t.sharedSize.nextSize);let o=e.childNodes[n];if(o.tagName!==this.childNodeType){const i=this.nodesPool();e.replaceChild(i,o),o=i}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class Tb extends Eb{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class gN{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class na{constructor(e,t){this.nodesPool=typeof e=="string"?new gN(e):null,this.nodeType=e,this.rootNode=t,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class mN extends na{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Tb(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:o,cells:i}=this.table;for(let r=0;r<e;r++){const a=this.table.renderedRowToSource(r),l=o.getRenderedNode(r);this.sourceRowIndex=a;const h=this.obtainOrderView(l),u=i.obtainOrderView(l);h.appendView(u).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){h.render();const f=h.getCurrentNode();f.className="",f.removeAttribute("style"),t[d](a,f,d)}h.end()}}}class pN extends na{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:o}=this.table,i=o+t;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>e)for(let a=e;a<r;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Ln(n)}render(){const{columnHeadersCount:e}=this.table;for(let t=0;t<e;t+=1){const{columnHeaderFunctions:n,columnsToRender:o,rowHeadersCount:i}=this.table,r=this.rootNode.childNodes[t];for(let a=-1*i;a<o;a+=1){const l=this.table.renderedColumnToSource(a),h=r.childNodes[a+i];h.className="",h.removeAttribute("style"),n[t](l,h,t)}}}}class wN extends na{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;for(let o=0;o<t;o++){const i=this.table.renderedColumnToSource(o),r=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[o].style.width=`${r}px`}for(let o=0;o<e;o++){const i=this.table.renderedColumnToSource(o),r=this.table.columnUtils.getStretchedColumnWidth(i);this.rootNode.childNodes[o+t].style.width=`${r}px`}const n=this.rootNode.firstChild;n&&J(n,"rowHeader")}}let iC=!1;class CN extends na{constructor(e){super("TR",e),this.orderView=new Eb(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!iC&&e>1e3&&(iC=!0,it(Je`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let t=0;t<e;t++)this.orderView.render();this.orderView.end()}}class yN extends na{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Tb(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:o}=this.table;for(let i=0;i<e;i++){const r=this.table.renderedRowToSource(i),a=n.getRenderedNode(i);this.sourceRowIndex=r;const l=this.obtainOrderView(a),h=o.obtainOrderView(a);l.prependView(h).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let u=0;u<t;u++){l.render();const d=l.getCurrentNode(),f=this.table.renderedColumnToSource(u);Oe(d,"hide")||(d.className=""),d.removeAttribute("style"),d.removeAttribute("dir"),this.table.cellRenderer(r,f,d)}l.end()}}}class SN{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:o,cells:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=o,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const o=t.getRenderedNode(n);if(o.firstChild){const i=this.renderedRowToSource(n),r=this.rowUtils.getHeight(i);r?o.firstChild.style.height=`${r-1}px`:o.firstChild.style.height=""}}}}class vN{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:o,rowUtils:i,columnUtils:r,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new SN(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new mN,columnHeaders:new pN(t),colGroup:new wN(n),rows:new CN(o),cells:new yN}),this.renderer.setAxisUtils(i,r)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class bN{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const t=this.dataAccessObject.wtViewport.columnsRenderCalculator;let n=this.getWidth(e);if(t){const o=t.getStretchedColumnWidth(e,n);o&&(n=o)}return n}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:t,wtViewport:n,cloneSource:o}=this.dataAccessObject,i=o?o.wtTable.holder:t.holder,r=i.offsetHeight<i.scrollHeight?xt():0;let a=e.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-r),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,h=e.getSetting("defaultColumnWidth");for(let u=0;u<l;u++){let d=Array.isArray(a)?a[u]:a;d=d??h,this.headerWidths.set(u,d)}}}}class RN{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(t=t===void 0?n:Math.max(t,n)),t}}function Bn(s,e,t){return e=EN(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function EN(s){var e=TN(s,"string");return typeof e=="symbol"?e:String(e)}function TN(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class MN{constructor(e,t,n,o,i){Bn(this,"wtSettings",null),Bn(this,"domBindings",void 0),Bn(this,"TBODY",null),Bn(this,"THEAD",null),Bn(this,"COLGROUP",null),Bn(this,"hasTableHeight",!0),Bn(this,"hasTableWidth",!0),Bn(this,"isTableVisible",!1),Bn(this,"tableOffset",0),Bn(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,tm(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(r)),this.rowUtils=new RN(this.dataAccessObject,this.wtSettings),this.columnUtils=new bN(this.dataAccessObject,this.wtSettings),this.tableRenderer=new vN({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Oe(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",n}createHider(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Oe(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),n}createHolder(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Oe(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr")),n.appendChild(e)),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:n,wtViewport:o}=this.dataAccessObject,i=t.getSetting("totalRows"),r=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,h=t.getSetting("columnHeaders"),u=h.length;let d=!1,f=e;if(this.isMaster&&(this.holderOffset=Tt(this.holder),f=o.createRenderCalculators(f),l&&!t.getSetting("fixedColumnsStart"))){const w=n.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=w!==0,C!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(d=n.updateStateOfRendering()),f)this.isMaster&&o.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=Tt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const w=i>0?this.getFirstRenderedRow():0,C=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new cN(w,i,u),this.columnFilter=new hN(C,r,l);let R=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const H={};this.wtSettings.getSetting("beforeDraw",!0,H),R=H.skipRender!==!0}if(R){this.tableRenderer.setHeaderContentRenderers(a,h),(this.is(Jn)||this.is(qs))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let H;if(this.isMaster&&(H=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Jn))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const A=Qe(this.hider),_=Qe(this.TABLE);A!==0&&_!==A&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),H!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Jn)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let m=!1;return this.isMaster&&(m=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(m=n.bottomOverlay.resetFixedPosition()||m),m=n.inlineStartOverlay.resetFixedPosition()||m,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(n.refreshAll(),n.adjustElementsSize()):this.refreshSelections(f),d&&n.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let i,r,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),r=this.getColumnHeader(t,n),r&&(a=bs(r),(!i&&o<a||i<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=e.getSetting("columnHeaders");for(let i=0,r=o.length;i<r;i++)if(n[i]){if(!t[i]||t[i].childNodes.length===0)return;t[i].childNodes[0].style.height=`${n[i]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Jn))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let o=0;o<n;o++){const i=this.rowFilter.renderedToSource(o);t.oversizedRows&&t.oversizedRows[i]&&(t.oversizedRows[i]=void 0)}}}removeClassFromCells(e){const t=this.TABLE.querySelectorAll(`.${e}`);for(let n=0,o=t.length;n<o;n++)_e(t[n],e)}refreshSelections(e){const{wtSettings:t}=this,{selections:n}=this.dataAccessObject;if(!n)return;const o=Array.from(n),i=o.length;if(e){const r=[];for(let h=0;h<i;h++){const{highlightHeaderClassName:u,highlightRowClassName:d,highlightColumnClassName:f}=o[h].settings,m=o[h].classNames,w=m.length;for(let C=0;C<w;C++)r.includes(m[C])||r.push(m[C]);u&&!r.includes(u)&&r.push(u),d&&!r.includes(d)&&r.push(d),f&&!r.includes(f)&&r.push(f)}const a=t.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(a))for(let h=0;h<a.length;h++)r.push(a[h]);const l=r.length;for(let h=0;h<l;h++)this.removeClassFromCells(r[h])}for(let r=0;r<i;r++)o[r].draw(this.facadeGetter(),e)}getCell(e){let t=e.row,n=e.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",t,n);if(o&&Array.isArray(o)&&([t,n]=o),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const r=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!r&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(e){let t=null,n=null;if(e<0){var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceToRendered(e),n=this.TBODY}return t!==void 0&&n!==void 0?n.childNodes.length<t+1?!1:n.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[t];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(o=>{const i=o.childNodes[n];i&&t.push(i)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return;const n=this.wtSettings.getSetting("rowHeaders").length;if(t>=n)return;const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return o==null?void 0:o.childNodes[t]}getRowHeaders(e){if(this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0)===0)return[];const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<n;o++){const i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],r=i==null?void 0:i.childNodes[o];r&&t.push(r)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=js(t,["TD","TH"])),t===null)return null;const n=t.parentNode,o=n.parentNode;let i=kv(n),r=t.cellIndex;return Ws(Po,t,this.wtRootElement)||Ws(Ho,t,this.wtRootElement)?o.nodeName==="THEAD"&&(i-=o.childNodes.length):Ws(qs,t,this.wtRootElement)||Ws(Jn,t,this.wtRootElement)?i=this.wtSettings.getSetting("totalRows")-o.childNodes.length+i:o===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):i=this.rowFilter.renderedToSource(i),Ws(Po,t,this.wtRootElement)||Ws(Do,t,this.wtRootElement)||Ws(qs,t,this.wtRootElement)?r=this.columnFilter.offsettedTH(r):r=this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),this.wot.createCellCoords(i,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),n=bs(this.TBODY)-1;let o,i,r,a,l;if(!(t===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,r=this.rowFilter.renderedToSource(e),o=this.getRowHeight(r),a=this.getTrForRow(r),l=a.querySelector("th"),l?i=bs(l):i=bs(a)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<i||o<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=i)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return Qe(this.TABLE)}getHeight(){return dt(this.TABLE)}getTotalWidth(){const e=Qe(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=dt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Ei(this.TABLE)}_modifyRowHeaderWidth(e){let t=nt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const ki=MN,ON="stickyRowsBottom",Mb={getFirstRenderedRow(){const s=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=s-e;return s===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const s=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),s)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};rs(Mb,"MIXIN_NAME",ON,{writable:!1,enumerable:!1});const Ob=Mb,IN="stickyColumnsStart",Ib={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const s=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),s)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()}};rs(Ib,"MIXIN_NAME",IN,{writable:!1,enumerable:!1});const bm=Ib;class Rm extends ki{constructor(e,t,n,o){super(e,t,n,o,qs)}}tt(Rm,Ob);tt(Rm,bm);const _N=Rm,Ho="top",Jn="bottom",Do="inline_start",Po="top_inline_start_corner",qs="bottom_inline_start_corner",AN=[Ho,Jn,Do,Po,qs],xN=new Map([[Ho,`ht_clone_${Ho}`],[Jn,`ht_clone_${Jn}`],[Do,`ht_clone_${Do} ht_clone_left`],[Po,`ht_clone_${Po} ht_clone_top_left_corner`],[qs,`ht_clone_${qs} ht_clone_bottom_left_corner`]]);function ed(s,e,t){return e=HN(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function HN(s){var e=DN(s,"string");return typeof e=="symbol"?e:String(e)}function DN(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class PN{constructor(e){ed(this,"dataAccessObject",void 0),ed(this,"lastScrolledColumnPos",-1),ed(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,n,o,i){const r=this.scrollViewportHorizontally(e.col,n,i),a=this.scrollViewportVertically(e.row,t,o);return r||a}scrollViewportHorizontally(e,t,n){const{drawn:o,totalColumns:i}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;const r=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=t===void 0&&n===void 0,{fixedColumnsStart:h,inlineStartOverlay:u}=this.dataAccessObject;if(l&&e<h)return!1;let d=!1;return r===-1?d=u.scrollTo(e,l?e>this.lastScrolledColumnPos:t):(l&&(e<r||e>a)||!l)&&(d=u.scrollTo(e,l?e>a:t)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,t,n){const{drawn:o,totalRows:i}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;const r=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=t===void 0&&n===void 0,{fixedRowsBottom:h,fixedRowsTop:u,topOverlay:d}=this.dataAccessObject;if(l&&(e<u||e>i-h-1))return!1;let f=!1;return r===-1?f=d.scrollTo(e,l?e>this.lastScrolledRowPos:n):(l&&(e<r||e>a)||!l)&&(f=d.scrollTo(e,l?e>a:n)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:o,fixedRowsTop:i,rootWindow:r}=this.dataAccessObject;let a=t.getFirstVisibleRow();if(e.mainTableScrollableElement===r){const l=Tt(t.wtRootElement),h=bs(t.hider),u=bs(r),d=Hr(r,r);if(l.top+h-u<=d){let f=n.getColumnHeaderHeight();f+=e.sumCellSizes(0,i);for(let m=o;m>0;m--)if(f+=e.sumCellSizes(m-1,m),l.top+h-f<=d){a=m;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:o,rootWindow:i}=this.dataAccessObject;let r=t.getLastVisibleRow();if(e.mainTableScrollableElement===i){const a=Tt(t.wtRootElement),l=Hr(i,i);if(a.top>l){const h=bs(i);let u=n.getColumnHeaderHeight();for(let d=1;d<=o;d++)if(u+=e.sumCellSizes(d-1,d),a.top+u-l>=h){r=d-2;break}}}return r}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:t,wtViewport:n,totalColumns:o,rootWindow:i}=this.dataAccessObject;let r=t.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){const a=Tt(t.wtRootElement),l=Cr(t.hider),h=Cr(i),u=Math.abs(Wl(i,i));if(a.left+l-h<=u){let d=n.getRowHeaderWidth();for(let f=o;f>0;f--)if(d+=e.sumCellSizes(f-1,f),a.left+l-d<=u){r=f;break}}}return r}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:t,wtTable:n,wtViewport:o,totalColumns:i,rootWindow:r}=this.dataAccessObject;let a=n.getLastVisibleColumn();if(t.mainTableScrollableElement===r){const l=e.getSetting("rtlMode");let h=null;if(l){const d=n.TABLE.getBoundingClientRect(),m=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(d.right-m)}else h=Tt(n.wtRootElement).left;const u=Math.abs(Wl(r,r));if(h>u){const d=Cr(r);let f=o.getRowHeaderWidth();for(let m=1;m<=i;m++)if(f+=t.sumCellSizes(m-1,m),h+f-u>=d){a=m-2;break}}}return a}}const NN=PN;function In(s,e,t){return e=kN(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function kN(s){var e=LN(s,"string");return typeof e=="symbol"?e:String(e)}function LN(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class Em{get eventManager(){return new ft(this)}constructor(e,t){In(this,"wtTable",void 0),In(this,"wtScroll",void 0),In(this,"wtViewport",void 0),In(this,"wtOverlays",void 0),In(this,"selections",void 0),In(this,"wtEvent",void 0),In(this,"guid",`wt_${Qg()}`),In(this,"drawInterrupted",!1),In(this,"drawn",!1),In(this,"domBindings",void 0),In(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new NN(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){Js(n,e[t])}])}}createCellCoords(e,t){return new jl(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new Sm(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),r=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<o&&e.col<r)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<r&&e.row>=n-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<r)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n,o,i){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,n,o,i)}scrollViewportHorizontally(e,t,n){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selections(){return e.selections},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count}}}}function rC(s,e,t){return e=FN(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function FN(s){var e=VN(s,"string");return typeof e=="symbol"?e:String(e)}function VN(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class $N extends Em{constructor(e,t,n){super(e,t),rC(this,"cloneSource",void 0),rC(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selections=n.selections,this.wtEvent=new Rb(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections,n.event),this.findOriginalHeaders()}}function WN(s,e,t){return e=BN(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function BN(s){var e=UN(s,"string");return typeof e=="symbol"?e:String(e)}function UN(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class sa{constructor(e,t,n,o,i){WN(this,"wtSettings",null),rs(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=o;const{TABLE:r,hider:a,spreader:l,holder:h,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=r,this.hider=a,this.spreader=l,this.holder=h,this.wtRootElement=u,this.trimmingContainer=Ao(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Ao(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Dr(e.TABLE)}getRelativeCellPosition(e,t,n){if(this.clone.wtTable.holder.contains(e)===!1){it(`The provided element is not a child of the ${this.type} overlay`);return}const o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),r=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,h={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return o?d=this.getRelativeCellPositionWithinWindow(r,i,u,h):d=this.getRelativeCellPositionWithinHolder(r,a,i,u,h),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,o){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,a=0;if(!t)r=o.start;else{let l=i.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(i.left+i.width+xt())),r=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:a=o.top,{start:n.start+r,top:n.top+a}}getRelativeCellPositionWithinHolder(e,t,n,o,i){const r={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=r.horizontal-i.start),t){const h=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+h.top}else e||(l=r.vertical-i.top);return{start:o.start-a,top:o.top-l}}makeClone(){if(AN.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,o=t.createElement("DIV"),i=t.createElement("TABLE"),r=e.wtRootElement.parentNode;o.className=`${xN.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,i.className=e.TABLE.className,o.appendChild(i),r.appendChild(o);const a=this.wtSettings.getSetting("preventOverflow");return a===!0||a==="horizontal"&&this.type===Ho||a==="vertical"&&this.type===Do?this.mainTableScrollableElement=n:n.getComputedStyle(r).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Dr(e.TABLE),new $N(i,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selections:this.wot.selections})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,o=t.style,i=e.parentNode.style;I([n,o,i],r=>{r.width="",r.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class YN extends sa{constructor(e,t,n,o,i,r){super(e,t,qs,n,o),this.bottomOverlay=i,this.inlineStartOverlay=r}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new _N(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${i}px`,t.style.bottom=`${r}px`}else Qr(t),this.repositionOverlay();let n=dt(this.clone.wtTable.TABLE);const o=Qe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=xt(n)),o.style.bottom=`${i}px`}}const zN="calculatedColumns",_b={getFirstRenderedColumn(){const s=this.dataAccessObject.startColumnRendered;return s===null?-1:s},getFirstVisibleColumn(){const s=this.dataAccessObject.startColumnVisible;return s===null?-1:s},getLastRenderedColumn(){const s=this.dataAccessObject.endColumnRendered;return s===null?-1:s},getLastVisibleColumn(){const s=this.dataAccessObject.endColumnVisible;return s===null?-1:s},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible}};rs(_b,"MIXIN_NAME",zN,{writable:!1,enumerable:!1});const Tm=_b;class Mm extends ki{constructor(e,t,n,o){super(e,t,n,o,Jn)}}tt(Mm,Ob);tt(Mm,Tm);const GN=Mm;function jN(s,e,t){return e=KN(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function KN(s){var e=XN(s,"string");return typeof e=="symbol"?e:String(e)}function XN(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class qN extends sa{constructor(e,t,n,o){super(e,t,Jn,n,o),jN(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new GN(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!o||o!=="vertical")?(n=this.getOverlayOffset(),t.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=xt(n)),o.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(_o(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,wtSettings:o}=this.wot,i=o.getSetting("defaultRowHeight");let r=e,a=0;for(;r<t;){const l=n.getRowHeight(r);a+=l===void 0?i:l,r+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:o}=this.domBindings,i=xt(n),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||l==="horizontal"){let u=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),a.width=`${u}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=dt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let r=0;t&&i.offsetHeight!==i.clientHeight&&(r=xt(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=r,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Hr(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),r=o-i,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+o,0),n>r&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||t===0)&&o.length>0){const r=this.wot.wtTable.holder.parentNode,a=Oe(r,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(J(r,"innerBorderBottom"),i=!a):(_e(r,"innerBorderBottom"),i=a)}return i}}const ZN="calculatedRows",Ab={getFirstRenderedRow(){const s=this.dataAccessObject.startRowRendered;return s===null?-1:s},getFirstVisibleRow(){const s=this.dataAccessObject.startRowVisible;return s===null?-1:s},getLastRenderedRow(){const s=this.dataAccessObject.endRowRendered;return s===null?-1:s},getLastVisibleRow(){const s=this.dataAccessObject.endRowVisible;return s===null?-1:s},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible}};rs(Ab,"MIXIN_NAME",ZN,{writable:!1,enumerable:!1});const xb=Ab;class Om extends ki{constructor(e,t,n,o){super(e,t,n,o,Do)}}tt(Om,xb);tt(Om,bm);const QN=Om;class JN extends sa{constructor(e,t,n,o){super(e,t,Do,n,o)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new QN(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer===t&&(!o||o!=="horizontal")?(i=this.getOverlayOffset()*(this.isRtl()?-1:1),Th(n,`${i}px`,"0px")):(i=this.getScrollPosition(),Qr(n));const r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Ti(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let o=e,i=0;for(;o<t;)i+=this.wot.wtTable.getStretchedColumnWidth(o)||n,o+=1;return i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,o=xt(t),r=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="vertical"){let h=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(h-=o),h=Math.min(h,e.wtRootElement.scrollHeight),r.height=`${h}px`}else r.height="";this.clone.wtTable.holder.style.height=r.height;const l=Qe(this.clone.wtTable.TABLE);r.width=`${l}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:n}=this.wot,o=this.facadeGetter(),i=Math.abs((e=n==null?void 0:n.getCell().getBorder(o).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let n=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let r=0;if(t){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(t=!1)}return t&&i.offsetWidth!==i.clientWidth&&(r=xt(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=r,this.setScrollPosition(n)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(Wl(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const o=this.wot.wtTable.getTotalWidth(),i=this.clone.wtTable.getTotalWidth(),r=o-i;n>r&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?_e(t,"emptyRows"):J(t,"emptyRows");let r=!1;if(o&&!n.length)J(t,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){const a=Oe(t,"innerBorderInlineStart");e?(J(t,"innerBorderLeft innerBorderInlineStart"),r=!a):(_e(t,"innerBorderLeft innerBorderInlineStart"),r=a)}return r}}const ek="stickyRowsTop",Hb={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const s=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),s)},getVisibleRowsCount(){return this.getRenderedRowsCount()}};rs(Hb,"MIXIN_NAME",ek,{writable:!1,enumerable:!1});const Db=Hb;class Im extends ki{constructor(e,t,n,o){super(e,t,n,o,Po)}}tt(Im,Db);tt(Im,bm);const tk=Im;function aC(s,e,t){return e=nk(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function nk(s){var e=sk(s,"string");return typeof e=="symbol"?e:String(e)}function sk(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class ok extends sa{constructor(e,t,n,o,i,r){super(e,t,Po,n,o),aC(this,"topOverlay",void 0),aC(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=r}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new tk(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();Th(e,`${o}px`,`${i}px`)}else Qr(e);let t=dt(this.clone.wtTable.TABLE);const n=Qe(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class _m extends ki{constructor(e,t,n,o){super(e,t,n,o,Ho)}}tt(_m,Db);tt(_m,Tm);const ik=_m;function rk(s,e,t){return e=ak(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function ak(s){var e=lk(s,"string");return typeof e=="symbol"?e:String(e)}function lk(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class hk extends sa{constructor(e,t,n,o){super(e,t,Ho,n,o),rk(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new ik(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let o=0,i=!1;if(this.trimmingContainer===t&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),h=Math.ceil(l.bottom),u=e.offsetHeight;i=h===u,o=this.getOverlayOffset(),Th(e,"0px",`${o}px`)}else o=this.getScrollPosition(),Qr(e);const r=this.adjustHeaderBordersPosition(o,i);return this.adjustElementsSize(),r}setScrollPosition(e){const t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(_o(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultRowHeight");let o=e,i=0;for(;o<t;){const r=this.wot.wtTable.getRowHeight(o);i+=r===void 0?n:r,o+=1}return i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,o=xt(t),r=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="horizontal"){let h=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(h-=o),h=Math.min(h,e.wtRootElement.scrollWidth),r.width=`${h}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let l=dt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),r.height=`${l}px`}adjustRootChildrenSize(){var e;const{holder:t}=this.clone.wtTable,{selections:n}=this.wot,o=this.facadeGetter(),i=Math.abs((e=n==null?void 0:n.getCell().getBorder(o).cornerCenterPointOffset)!==null&&e!==void 0?e:0);this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:o}=this,r=(n.cloneSource?n.cloneSource:n).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(t){const h=this.wot.wtTable.getRowHeight(e),u=this.wot.wtViewport.getViewportHeight();h>u&&(t=!1)}if(t&&r.offsetHeight!==r.clientHeight&&(l=xt(this.domBindings.rootDocument)),t){const h=o.getSetting("fixedRowsBottom"),u=o.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(u-h,u),a+=1}else a+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Hr(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),r=o-i;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>r&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?_e(n,"emptyColumns"):J(n,"emptyColumns");let i=!1;if(!t){const r=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==r,l=this.wtSettings.getSetting("columnHeaders");if((a||r===0)&&l.length>0){const h=Oe(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(J(n,"innerBorderTop"),i=!h):(_e(n,"innerBorderTop"),i=h)}}return i}}function us(s,e,t){return e=uk(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function uk(s){var e=ck(s,"string");return typeof e=="symbol"?e:String(e)}function ck(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class dk{constructor(e,t,n,o,i,r){us(this,"wot",null),us(this,"topOverlay",null),us(this,"bottomOverlay",null),us(this,"inlineStartOverlay",null),us(this,"topInlineStartCornerOverlay",null),us(this,"bottomInlineStartCornerOverlay",null),us(this,"browserLineHeight",void 0),us(this,"wtSettings",null),us(this,"resizeObserver",new ResizeObserver(u=>{Hh(()=>{!Array.isArray(u)||!u.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=o,this.domBindings=n,this.facadeGetter=t,this.wtTable=r;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=xt(a);const h=l.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=h?r.holder:Dr(r.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),o=parseInt(n.lineHeight,10),i=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=o||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new hk(...e),this.bottomOverlay=new qN(...e),this.inlineStartOverlay=new JN(...e),this.topInlineStartCornerOverlay=new ok(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new YN(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",d=>this.onTableScroll(d),{passive:!0}),n!==o&&this.eventManager.addEventListener(o,"scroll",d=>this.onTableScroll(d),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,r=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:r};(a||i||!rm())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:f}=d.clone.wtTable;this.eventManager.addEventListener(f,"wheel",m=>this.onCloneWheel(m,a),l)}});let u;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(o!==t&&i!==t&&!e.target.contains(o)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=e.target,a=i!==n&&r!==n&&!r.contains(i),l=o!==n&&r!==n&&!r.contains(o);if(this.keyPressed&&(a||l))return;const h=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&h)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Ii(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const o=this.scrollVertically(t),i=this.scrollHorizontally(n);return o||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[o,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;const r=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;r&&(r.scrollLeft=o)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Dr(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,o=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:t}=this.wot,{wtTable:n}=this,o=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),r=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=n.hider.style;if(l.width=`${r+this.inlineStartOverlay.sumCellSizes(0,o)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:h,scrollWidth:u}=n.wtRootElement,{scrollHeight:d,scrollWidth:f}=n.holder;this.hasScrollbarRight=h<d,this.hasScrollbarBottom=u<f,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>u?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>h&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return I(t,o=>{o&&o.clone&&o.clone.wtTable.TABLE.contains(e)&&(n=o.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];I(t,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}const fk=dk;function lC(s,e,t){return e=gk(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function gk(s){var e=mk(s,"string");return typeof e=="symbol"?e:String(e)}function mk(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class pk{constructor(e){lC(this,"settings",{}),lC(this,"defaults",Object.freeze(this.getDefaults())),Fe(this.defaults,(t,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(t===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const o=this.getSetting("data",e,t);Js(n,o??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1}}update(e,t){return t===void 0?Fe(e,(n,o)=>{this.settings[o]=n}):this.settings[e]=t,this}getSetting(e,t,n,o,i){return typeof this.settings[e]=="function"?this.settings[e](t,n,o,i):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Am extends ki{constructor(e,t,n,o){super(e,t,n,o,"master")}alignOverlaysWithTrimmingContainer(){const e=Ao(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,o=Mi(e,"height",t),i=Mi(e,"overflow",t),r=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let{width:h,height:u}=e.getBoundingClientRect();if(n&&["auto","hidden","scroll"].includes(i)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?n.insertBefore(f,e.nextElementSibling):n.appendChild(f);const m=parseInt(eo(f,t).height,10);n.removeChild(f),m===0&&(u=0)}u=Math.min(u,l),r.height=o==="auto"?"auto":`${u}px`,h=Math.min(h,a),r.width=`${h}px`,r.overflow="",this.hasTableHeight=r.height==="auto"?!0:u>0,this.hasTableWidth=h>0}this.isTableVisible=Ei(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",i=e.getSetting("columnHeaders").length;if(i&&!t.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let h=0;h<i;h++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);t.hasOversizedColumnHeadersMarked[n]=!0}}}tt(Am,xb);tt(Am,Tm);const wk=Am;class Ck{constructor(e,t,n,o,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return t===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=dt(t)>0&&t.clientHeight>0?t.clientHeight:1/0,n}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:n}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,r=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),h=this.wtTable.TABLE.getBoundingClientRect(),u=l?h.right-i:h.left,d=i-u;let f,m;if(a)return Qe(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(d,i):f=Math.min(this.getContainerFillWidth(),d,i),o===n&&r>0&&this.sumColumnWidths(0,r-1)>f)return t.documentElement.clientWidth;if(o!==n&&(m=Mi(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(f,o.clientWidth);const w=e.getSetting("stretchH");return w==="none"||!w?Math.max(f,Qe(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let n=0,o=e;for(;o<t;)n+=this.wtTable.getColumnWidth(o),o+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}getWorkspaceOffset(){return Tt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=dt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,o=t.length;n<o;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,i=t.length;o<i;o++)n?(this.rowHeaderWidth+=Qe(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ro;const{wtSettings:t,wtTable:n}=this;let o,i,r;this.rowHeaderWidth=NaN,t.getSetting("renderAllRows")&&e===Ro?o=1/0:o=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),h=t.getSetting("fixedRowsBottom"),u=t.getSetting("totalRows");return l&&a>=0&&(r=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=r,o-=r),h&&this.dataAccessObject.bottomOverlay.clone&&(r=this.dataAccessObject.bottomOverlay.sumCellSizes(u-h,u),o-=r),n.holder.clientHeight===n.holder.offsetHeight?i=0:i=xt(this.domBindings.rootDocument),new yb({viewportSize:o,scrollOffset:a,totalItems:t.getSetting("totalRows"),itemSizeFn:d=>n.getRowHeight(d),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:i})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ro;const{wtSettings:t,wtTable:n}=this;let o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=t.getSetting("fixedColumnsStart");if(r&&i>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);i+=a,o-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(o-=xt(this.domBindings.rootDocument)),new pm({viewportSize:o,scrollOffset:i,totalItems:t.getSetting("totalColumns"),itemSizeFn:a=>n.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:(a,l)=>t.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(t){const n=this.createRowsCalculator($t),o=this.createColumnsCalculator($t);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(Ro),this.columnsRenderCalculator=this.createColumnsCalculator(Ro)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator($t),this.columnsVisibleCalculator=this.createColumnsCalculator($t)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:t,endRow:n,isVisibleInTrimmingContainer:o}=e;if(t===null&&n===null)return!o;const{startRow:i,endRow:r}=this.rowsRenderCalculator;return t<i||t===i&&t>0?!1:!(n>r||n===r&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:t,endColumn:n,isVisibleInTrimmingContainer:o}=e;if(t===null&&n===null)return!o;const{startColumn:i,endColumn:r}=this.columnsRenderCalculator;return t<i||t===i&&t>0?!1:!(n>r||n===r&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Fe(this.hasOversizedColumnHeadersMarked,(e,t,n)=>{n[t]=void 0})}}const yk=Ck;class Sk extends Em{constructor(e,t){super(e,new pk(t));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new wk(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new yk(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selections=this.wtSettings.getSetting("selections"),this.wtEvent=new Rb(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selections),this.wtOverlays=new fk(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],n=[];Fe(e,(o,i)=>{this.wtSettings.getSetting(i).length&&n.push(o),t.push(o)}),_e(this.wtTable.wtRootElement.parentNode,t),J(this.wtTable.wtRootElement.parentNode,n)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class xm{constructor(e){e instanceof Em?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const n=new xm(t);return()=>n},this._wot=new Sk(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selections(){return this._wot.selections}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,n,o,i){return this._wot.scrollViewport(e,t,n,o,i)}scrollViewportHorizontally(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,o,i){return this._wot.wtSettings.getSetting(e,t,n,o,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}class vk{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle={width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"},this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,n=this.main.childNodes.length;t<n;t++){const o=this.main.childNodes[t];this.eventManager.addEventListener(o,"mouseenter",i=>this.onMouseEnter(i,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Fn(e);const n=this,o=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none";function r(l){if(l.clientY<Math.floor(i.top)||l.clientY>Math.ceil(i.top+i.height)||l.clientX<Math.floor(i.left)||l.clientX>Math.ceil(i.left+i.width))return!0}function a(l){r(l)&&(n.eventManager.removeEventListener(o,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(o,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let a=0;a<5;a++){const l=n[a],h=t.createElement("div");h.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(h.className+=" hidden"),o=h.style,o.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,o.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,o.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(h)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Dn()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let r=i.bordersHolder;r||(r=t.createElement("div"),r.className="htBorders",i.bordersHolder=r,i.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};Fe(o,(r,a)=>{this.selectionHandles.styles.bottomHitArea[a]=r,this.selectionHandles.styles.topHitArea[a]=r});const i={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Fe(i,(r,a)=>{this.selectionHandles.styles.bottom[a]=r,this.selectionHandles.styles.top[a]=r}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selections.createOrGetArea();return!!(n.cellRange&&(e!==n.cellRange.to.row||t!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,n,o,i,r){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:h,topHitArea:u,bottom:d,bottomHitArea:f}=this.selectionHandles.styles,m=parseInt(h.borderWidth,10),w=parseInt(h.width,10),C=parseInt(u.width,10),R=this.wot.wtTable.getWidth(),H=this.wot.wtTable.getHeight();h.top=`${parseInt(n-w-1,10)}px`,h[l]=`${parseInt(o-w-1,10)}px`,u.top=`${parseInt(n-C/4*3,10)}px`,u[l]=`${parseInt(o-C/4*3,10)}px`;const A=Math.min(parseInt(o+i,10),R-w-m*2),_=Math.min(parseInt(o+i-C/4,10),R-C-m*2);d[l]=`${A}px`,f[l]=`${_}px`;const O=Math.min(parseInt(n+r,10),H-w-m*2),D=Math.min(parseInt(n+r-C/4,10),H-C-m*2);d.top=`${O}px`,f.top=`${D}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(h.display="block",u.display="block",this.isPartRange(e,t)?(d.display="none",f.display="none"):(d.display="block",f.display="block")):(h.display="none",d.display="none",u.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(h.zIndex="9999",u.zIndex="9999"):(h.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:n,rootWindow:o}=this.wot;let i,r,a,l,h,u;const d=t.getRenderedRowsCount();for(let b=0;b<d;b+=1){const c=t.rowFilter.renderedToSource(b);if(c>=e[0]&&c<=e[2]){i=c,h=e[0];break}}for(let b=d-1;b>=0;b-=1){const c=t.rowFilter.renderedToSource(b);if(c>=e[0]&&c<=e[2]){r=c;break}}const f=t.getRenderedColumnsCount();for(let b=0;b<f;b+=1){const c=t.columnFilter.renderedToSource(b);if(c>=e[1]&&c<=e[3]){a=c,u=e[1];break}}for(let b=f-1;b>=0;b-=1){const c=t.columnFilter.renderedToSource(b);if(c>=e[1]&&c<=e[3]){l=c;break}}if(i===void 0||a===void 0){this.disappear();return}let m=t.getCell(this.wot.createCellCoords(i,a));const w=i!==r||a!==l,C=w?t.getCell(this.wot.createCellCoords(r,l)):m,R=Tt(m),H=w?Tt(C):R,A=Tt(t.TABLE),_=Qe(t.TABLE),O=R.top,D=R.left,G=this.wot.wtSettings.getSetting("rtlMode");let z=0,ee=0;if(G){const b=Qe(m),c=o.innerWidth-A.left-_;ee=D+b-H.left,z=o.innerWidth-D-b-c-1}else ee=H.left+Qe(C)-D,z=D-A.left-1;if(this.isEntireColumnSelected(i,r)){const b=this.getDimensionsFromHeader("columns",a,l,h,A);let c=null;b&&([c,z,ee]=b),c&&(m=c)}let X=O-A.top-1,q=H.top+dt(C)-O;if(this.isEntireRowSelected(a,l)){const b=this.getDimensionsFromHeader("rows",i,r,u,A);let c=null;b&&([c,X,q]=b),c&&(m=c)}const oe=eo(m,o);parseInt(oe.borderTopWidth,10)>0&&(X+=1,q=q>0?q-1:0),parseInt(oe[G?"borderRightWidth":"borderLeftWidth"],10)>0&&(z+=1,ee=ee>0?ee-1:0);const ie=G?"right":"left";this.topStyle.top=`${X}px`,this.topStyle[ie]=`${z}px`,this.topStyle.width=`${ee}px`,this.topStyle.display="block",this.startStyle.top=`${X}px`,this.startStyle[ie]=`${z}px`,this.startStyle.height=`${q}px`,this.startStyle.display="block";const re=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${X+q-re}px`,this.bottomStyle[ie]=`${z}px`,this.bottomStyle.width=`${ee}px`,this.bottomStyle.display="block",this.endStyle.top=`${X}px`,this.endStyle[ie]=`${z+ee-re}px`,this.endStyle.height=`${q+1}px`,this.endStyle.display="block";let pe=this.settings.border.cornerVisible;pe=typeof pe=="function"?pe(this.settings.layerLevel):pe;const Me=this.wot.getSetting("onModifyGetCellCoords",r,l);let[ze,Ae]=[r,l];if(Me&&Array.isArray(Me)&&([,,ze,Ae]=Me),Dn()||!pe||this.isPartRange(ze,Ae))this.cornerStyle.display="none";else{this.cornerStyle.top=`${X+q+this.cornerCenterPointOffset-1}px`,this.cornerStyle[ie]=`${z+ee+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let b=Ao(t.TABLE);const c=b===o;c&&(b=n.documentElement);const g=parseInt(this.cornerDefaultStyle.width,10)/2,p=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const v=c?C.getBoundingClientRect().left:C.offsetLeft;let E=!1,M=0;G?(M=v-parseInt(this.cornerDefaultStyle.width,10)/2,E=M<0):(M=v+Qe(C)+parseInt(this.cornerDefaultStyle.width,10)/2,E=M>=Cr(b)),E&&(this.cornerStyle[ie]=`${Math.floor(z+ee+this.cornerCenterPointOffset-g)}px`,this.cornerStyle[G?"borderLeftWidth":"borderRightWidth"]=0)}r===this.wot.getSetting("totalRows")-1&&(c?C.getBoundingClientRect().top:C.offsetTop)+dt(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=bs(b)&&(this.cornerStyle.top=`${Math.floor(X+q+this.cornerCenterPointOffset-p)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Dn()&&this.updateMultipleSelectionHandlesPosition(r,l,X,z,ee,q)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,o,i){const{wtTable:r}=this.wot,a=r.wtRootElement.parentNode;let l=null,h=null,u=null,d=null,f=null,m=null,w=null,C=null;switch(e){case"rows":l=function(){return r.getRowHeader(...arguments)},h=function(){return dt(...arguments)},u="ht__selection--rows",m="top";break;case"columns":l=function(){return r.getColumnHeader(...arguments)},h=function(){return Qe(...arguments)},u="ht__selection--columns",m="left";break}if(a.classList.contains(u)){const R=this.wot.getSetting("columnHeaders").length;if(w=l(t,R-o),C=l(n,R-o),!w||!C)return!1;const H=Tt(w),A=Tt(C);return w&&C&&(d=H[m]-i[m]-1,f=A[m]+h(C)-H[m]),[w,d,f]}return!1}changeBorderStyle(e,t){const n=this[e].style,o=t[e];!o||o.hide?J(this[e],"hidden"):(Oe(this[e],"hidden")&&_e(this[e],"hidden"),n.backgroundColor=o.color,(e==="top"||e==="bottom")&&(n.height=`${o.width}px`),(e==="start"||e==="end")&&(n.width=`${o.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},n=this[e].style;n.backgroundColor=t.color,n.width=`${t.width}px`,n.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?J(this[e],"hidden"):_e(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Dn()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const bk=vk;let Rk=class{constructor(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={},this.classNames=[this.settings.className],this.classNameGenerator=this.linearClassNameGenerator(this.settings.className,this.settings.layerLevel)}getBorder(e){return this.instanceBorders[e.guid]||(this.instanceBorders[e.guid]=new bk(e,this.settings)),this.instanceBorders[e.guid]}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}addClassAtCoords(e,t,n,o){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const r=e.wtTable.getCell(this.settings.createCellCoords(t,n));if(typeof r=="object"){let a=o;i&&(a=this.classNameGenerator(r),this.classNames.includes(a)||this.classNames.push(a)),J(r,a)}return this}linearClassNameGenerator(e,t){return function n(o){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;if(t===0||i===0)return e;let r=i>=0?i:t,a=e;r-=1;const l=r===0?e:`${e}-${r}`;if(Oe(o,l)){const h=r+1;a=`${e}-${h}`}else a=n(o,r);return a}}draw(e){if(this.isEmpty()){this.settings.border&&this.getBorder(e).disappear();return}const t=e.wtTable.getRenderedRowsCount(),n=e.wtTable.getRenderedColumnsCount(),o=this.getCorners(),[i,r,a,l]=o,{highlightHeaderClassName:h,highlightColumnClassName:u,highlightRowClassName:d,highlightOnlyClosestHeader:f,selectionType:m}=this.settings,w=m===void 0||["active-header","header"].includes(m);if(w&&r!==null&&l!==null){let C=0;for(let R=0;R<n;R+=1){const H=e.wtTable.columnFilter.renderedToSource(R);if(H>=r&&H<=l){let A=e.wtTable.getColumnHeaders(H);const _=A.length-1;f&&A.length>1&&(A=[A[_]]);for(let O=0;O<A.length;O+=1){const D=[];let G=A[O];h&&D.push(h),u&&D.push(u),O=f?_:O;const z=e.getSetting("onBeforeHighlightingColumnHeader",H,O,{selectionType:m,columnCursor:C,selectionWidth:l-r+1,classNames:D});z!==H&&(G=e.wtTable.getColumnHeader(z,O)),J(G,D)}C+=1}}}if(i!==null&&a!==null){let C=0;for(let R=0;R<t;R+=1){const H=e.wtTable.rowFilter.renderedToSource(R);if(w&&H>=i&&H<=a){let A=e.wtTable.getRowHeaders(H);const _=A.length-1;f&&A.length>1&&(A=[A[_]]);for(let O=0;O<A.length;O+=1){const D=[];let G=A[O];h&&D.push(h),d&&D.push(d),O=f?_:O;const z=e.getSetting("onBeforeHighlightingRowHeader",H,O,{selectionType:m,rowCursor:C,selectionHeight:a-i+1,classNames:D});z!==H&&(G=e.wtTable.getRowHeader(z,O)),J(G,D)}C+=1}if(r!==null&&l!==null)for(let A=0;A<n;A+=1){const _=e.wtTable.columnFilter.renderedToSource(A);H>=i&&H<=a&&_>=r&&_<=l?this.settings.className&&this.addClassAtCoords(e,H,_,this.settings.className,this.settings.markIntersections):H>=i&&H<=a?d&&this.addClassAtCoords(e,H,_,d):_>=r&&_<=l&&u&&this.addClassAtCoords(e,H,_,u);const O=e.getSetting("onAfterDrawSelection",H,_,this.settings.layerLevel);typeof O=="string"&&this.addClassAtCoords(e,H,_,O)}}}e.getSetting("onBeforeDrawBorders",o,this.settings.className),this.settings.border&&this.getBorder(e).appear(o)}destroy(){Object.values(this.instanceBorders).forEach(e=>e.destroy())}};const Ek=Rk;function hC(s){let{isShiftKey:e,isLeftClick:t,isRightClick:n,coords:o,selection:i,controller:r,cellCoordsFactory:a}=s;const l=i.isSelected()?i.getSelectedRange().current():null,h=i.isSelectedByCorner(),u=i.isSelectedByRowHeader();if(e&&l)o.row>=0&&o.col>=0&&!r.cell?i.setRangeEnd(o):(h||u)&&o.row>=0&&o.col>=0&&!r.cell?i.setRangeEnd(a(o.row,o.col)):h&&o.row<0&&!r.column?i.setRangeEnd(a(l.to.row,o.col)):u&&o.col<0&&!r.row?i.setRangeEnd(a(o.row,l.to.col)):(!h&&!u&&o.col<0||h&&o.col<0)&&!r.row?i.selectRows(Math.max(l.from.row,0),o.row,o.col):(!h&&!u&&o.row<0||u&&o.row<0)&&!r.column&&i.selectColumns(Math.max(l.from.col,0),o.col,o.row);else{const d=!i.inInSelection(o),f=t||n&&d;o.row<0&&o.col>=0&&!r.column?f&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!r.row?f&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!r.cell?f&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0)}}function Tk(s){let{isLeftClick:e,coords:t,selection:n,controller:o,cellCoordsFactory:i}=s;if(!e)return;const r=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),h=n.tableProps.countRows();a&&!o.column?n.setRangeEnd(i(h-1,t.col)):r&&!o.row?n.setRangeEnd(i(t.row,l-1)):o.cell||n.setRangeEnd(t)}const Mk=new Map([["mousedown",hC],["mouseover",Tk],["touchstart",hC]]);function uC(s,e){let{coords:t,selection:n,controller:o,cellCoordsFactory:i}=e;Mk.get(s.type)({coords:t,selection:n,controller:o,cellCoordsFactory:i,isShiftKey:s.shiftKey,isLeftClick:_h(s)||s.type==="touchstart",isRightClick:to(s)})}const Pb=new WeakMap,Hm=Symbol("rootInstance");function Ok(s){Pb.set(s,!0)}function Ik(s){return s===Hm}function Xf(s){return Pb.has(s)}function cC(s,e,t){_k(s,e),e.set(s,t)}function _k(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hs(s,e,t){return e=Ak(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function Ak(s){var e=xk(s,"string");return typeof e=="symbol"?e:String(e)}function xk(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function dC(s,e){var t=Nb(s,e,"get");return Hk(s,t)}function Hk(s,e){return e.get?e.get.call(s):e.value}function fC(s,e,t){var n=Nb(s,e,"set");return Dk(s,n,t),t}function Nb(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function Dk(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const uo=new WeakMap;var td=new WeakMap,nd=new WeakMap;class Pk{constructor(e){Hs(this,"instance",void 0),Hs(this,"eventManager",void 0),Hs(this,"settings",void 0),Hs(this,"THEAD",void 0),Hs(this,"TBODY",void 0),Hs(this,"_wt",void 0),Hs(this,"activeWt",void 0),cC(this,td,{writable:!0,value:0}),cC(this,nd,{writable:!0,value:0}),Hs(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new ft(this.instance),this.settings=this.instance.getSettings(),uo.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n,o,i){return this._wt.scrollViewport(e,t,n,o,i)}scrollViewportHorizontally(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}createElements(){const e=uo.get(this),{rootElement:t,rootDocument:n}=this.instance,o=t.getAttribute("style");o&&t.setAttribute("data-originalstyle",o),J(t,"handsontable"),e.table=n.createElement("TABLE"),J(e.table,"htCore"),this.instance.getSettings().tableClassName&&J(e.table,this.instance.getSettings().tableClassName),this.THEAD=n.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const e=uo.get(this),{rootElement:t,rootDocument:n,selection:o}=this.instance,i=n.documentElement;this.eventManager.addEventListener(t,"mousedown",r=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(r.target)){const{rootWindow:a}=this.instance;Lf(a),r.preventDefault(),a.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{e.selectionMouseDown=!1}),this.eventManager.addEventListener(t,"mousemove",r=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(r.target)&&(this.settings.fragmentSelection&&Lf(this.instance.rootWindow),r.preventDefault())}),this.eventManager.addEventListener(i,"keyup",r=>{o.isInProgress()&&!r.shiftKey&&o.finish()}),this.eventManager.addEventListener(i,"mouseup",r=>{o.isInProgress()&&_h(r)&&o.finish(),e.mouseDown=!1,(Mh(n.activeElement)||!o.isSelected()&&!o.isSelectedByAnyHeader()&&!t.contains(r.target)&&!to(r))&&this.instance.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",r=>{o.isInProgress()&&to(r)&&(o.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(i,"touchend",()=>{o.isInProgress()&&o.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(i,"mousedown",r=>{const a=r.target,l=r.x||r.clientX,h=r.y||r.clientY;let u=r.target;if(e.mouseDown||!t||!this.instance.view)return;const{holder:d}=this.instance.view._wt.wtTable;if(u===d){const m=xt(n);if(n.elementFromPoint(l+m,h)!==d||n.elementFromPoint(l,h+m)!==d)return}else for(;u!==i;){if(u===null){if(r.isTargetWebComponent)break;return}if(u===t)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(a):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e.table,"selectstart",r=>{this.settings.fragmentSelection||Pr(r.target)||r.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return n===null&&(n=e),o===null&&(o=t),[n,o]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),o=e.getNearestNotHiddenIndex(n-1,-1);return o===null?0:e.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,o){if(isNaN(e)||e<0)return 0;const i=n.getNearestNotHiddenIndex(e,t),r=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(r))return 0;let a=0;return t<0?a=r+1:t>0&&(a=o-r),a}countNotHiddenFixedColumnsStart(){const e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}initializeWalkontable(){const e=uo.get(this),t={rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>Xf(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(r,a)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(r,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const r=[];return this.instance.hasRowHeaders()&&r.push((a,l)=>{const h=a>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(h,l)}),this.instance.runHooks("afterGetRowHeaderRenderers",r),fC(this,nd,r.length),r},columnHeaders:()=>{const r=[];return this.instance.hasColHeaders()&&r.push((a,l)=>{const h=a>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(h,l)}),this.instance.runHooks("afterGetColumnHeaderRenderers",r),fC(this,td,r.length),r},columnWidth:r=>{const a=this.instance.columnIndexMapper.getVisualFromRenderableIndex(r);return this.instance.getColWidth(a===null?r:a)},rowHeight:r=>{const a=this.instance.rowIndexMapper.getVisualFromRenderableIndex(r);return this.instance.getRowHeight(a===null?r:a)},cellRenderer:(r,a,l)=>{const[h,u]=this.translateFromRenderableToVisualIndex(r,a),d=this.instance.runHooks("modifyGetCellCoords",h,u);let f=h,m=u;Array.isArray(d)&&([f,m]=d);const w=this.instance.getCellMeta(f,m),C=this.instance.colToProp(m);let R=this.instance.getDataAtRowProp(f,C);this.instance.hasHook("beforeValueRender")&&(R=this.instance.runHooks("beforeValueRender",R,w)),this.instance.runHooks("beforeRenderer",l,h,u,C,R,w),this.instance.getCellRenderer(w)(this.instance,l,h,u,C,R,w),this.instance.runHooks("afterRenderer",l,h,u,C,R,w)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onCellMouseDown:(r,a,l,h)=>{const u=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=h,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",r,u,l,d),!bo(r)&&(uC(r,{coords:u,selection:this.instance.selection,controller:d,cellCoordsFactory:(f,m)=>this.instance._createCellCoords(f,m)}),this.instance.runHooks("afterOnCellMouseDown",r,u,l),this.activeWt=this._wt)},onCellContextMenu:(r,a,l,h)=>{const u=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",r,u,l),!bo(r)&&(this.instance.runHooks("afterOnCellContextMenu",r,u,l),this.activeWt=this._wt)},onCellMouseOut:(r,a,l,h)=>{const u=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.instance.runHooks("beforeOnCellMouseOut",r,u,l),!bo(r)&&(this.instance.runHooks("afterOnCellMouseOut",r,u,l),this.activeWt=this._wt)},onCellMouseOver:(r,a,l,h)=>{const u=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.activeWt=h,this.instance.runHooks("beforeOnCellMouseOver",r,u,l,d),!bo(r)&&(e.mouseDown&&uC(r,{coords:u,selection:this.instance.selection,controller:d,cellCoordsFactory:(f,m)=>this.instance._createCellCoords(f,m)}),this.instance.runHooks("afterOnCellMouseOver",r,u,l),this.activeWt=this._wt)},onCellMouseUp:(r,a,l,h)=>{const u=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.instance.runHooks("beforeOnCellMouseUp",r,u,l),!(bo(r)||this.instance.isDestroyed)&&(this.instance.runHooks("afterOnCellMouseUp",r,u,l),this.activeWt=this._wt)},onCellCornerMouseDown:r=>{r.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",r)},onCellCornerDblClick:r=>{r.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",r)},beforeDraw:(r,a)=>this.beforeRender(r,a),onDraw:r=>this.afterRender(r),onScrollVertically:()=>this.instance.runHooks("afterScrollVertically"),onScrollHorizontally:()=>this.instance.runHooks("afterScrollHorizontally"),onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(r,a,l)=>{const h=this.instance.rowIndexMapper,u=h.getVisualFromRenderableIndex(r),d=this.instance.runHooks("beforeHighlightingRowHeader",u,a,l);return h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(r,a,l)=>{const h=this.instance.columnIndexMapper,u=h.getVisualFromRenderableIndex(r),d=this.instance.runHooks("beforeHighlightingColumnHeader",u,a,l);return h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(r,a,l)=>{let h;const[u,d]=this.translateFromRenderableToVisualIndex(r,a),f=this.instance.selection.getSelectedRange(),m=f.size();if(m>0){const w=(l??0)+1-m,C=f.peekByIndex(w);h=[C.from.row,C.from.col,C.to.row,C.to.col]}return this.instance.runHooks("afterDrawSelection",u,d,h,l)},onBeforeDrawBorders:(r,a)=>{const[l,h,u,d]=r,f=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(l),this.instance.columnIndexMapper.getVisualFromRenderableIndex(h),this.instance.rowIndexMapper.getVisualFromRenderableIndex(u),this.instance.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.instance.runHooks("beforeDrawBorders",f,a)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(r,a)=>{const l=this.instance.columnIndexMapper.getVisualFromRenderableIndex(a);return this.instance.runHooks("beforeStretchingColumnWidth",r,l)},onModifyRowHeaderWidth:r=>this.instance.runHooks("modifyRowHeaderWidth",r),onModifyGetCellCoords:(r,a,l)=>{const h=this.instance.rowIndexMapper,u=this.instance.columnIndexMapper,d=a>=0?u.getVisualFromRenderableIndex(a):a,f=r>=0?h.getVisualFromRenderableIndex(r):r,m=this.instance.runHooks("modifyGetCellCoords",f,d,l);if(Array.isArray(m)){const[w,C,R,H]=m;return[w>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(w,1)):w,C>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(C,1)):C,R>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(R,-1)):R,H>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(H,-1)):H]}},viewportRowCalculatorOverride:r=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const l=this.countRenderableRows(),h=r.startRow,u=r.endRow;if(typeof a=="number")r.startRow=Math.max(h-a,0),r.endRow=Math.min(u+a,l-1);else if(a==="auto"){const d=Math.ceil(u/l*12);r.startRow=Math.max(h-d,0),r.endRow=Math.min(u+d,l-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",r)},viewportColumnCalculatorOverride:r=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const l=this.countRenderableColumns(),h=r.startColumn,u=r.endColumn;if(typeof a=="number"&&(r.startColumn=Math.max(h-a,0),r.endColumn=Math.min(u+a,l-1)),a==="auto"){const d=Math.ceil(u/l*6);r.startColumn=Math.max(h-d,0),r.endColumn=Math.min(u+d,l-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",r)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const r=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||r}};this.instance.runHooks("beforeInitWalkontable",t),this._wt=new xm(t),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:o,height:i}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(o,i),this.eventManager.addEventListener(n,"mousedown",r=>{r.target===n&&r.which===3&&r.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",r=>{r.target===n&&r.which===3&&r.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Pr(e))return!0;const t=Ks(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return uo.get(this).mouseDown}isSelectedOnlyCell(){var e,t;return(e=(t=this.instance.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingle())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!Oe(n,"relative")){Ln(t),this.appendRowHeader(e,t);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{const{rootDocument:n,getRowHeader:o}=this.instance,i=n.createElement("div"),r=n.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,e,o),i.appendChild(r),t.appendChild(i)}this.instance.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t.firstChild){const i=t.firstChild;Oe(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,n,o):(Ln(t),this.appendColHeader(e,t,n,o))}else{const{rootDocument:i}=this.instance,r=i.createElement("div"),a=i.createElement("span");r.className="relative",a.className="colHeader",this.updateCellHeader(a,e,n,o),r.appendChild(a),t.appendChild(r)}this.instance.runHooks("afterGetColHeader",e,t,o)}updateCellHeader(e,t,n){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=t;const r=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Oe(e,"colHeader")?i=r.wtTable.columnFilter.sourceToRendered(t):Oe(e,"rowHeader")&&(i=r.wtTable.rowFilter.sourceToRendered(t))),i>-1?$o(e,n(t,o)):(Js(e,String.fromCharCode(160)),J(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,t){const n=uo.get(this);[n.lastWidth,n.lastHeight]=[e,t]}getLastSize(){const e=uo.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return dC(this,td)}getRowHeadersCount(){return dC(this,nd)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const Nk=Pk,kb="ABCDEFGHIJKLMNOPQRSTUVWXYZ",qf=kb.length;function Dh(s){let e=s+1,t="",n;for(;e>0;)n=(e-1)%qf,t=String.fromCharCode(65+n)+t,e=parseInt((e-n)/qf,10);return t}function kk(s){let e=0;if(s)for(let t=0,n=s.length-1;t<s.length;t+=1,n-=1)e+=qf**n*(kb.indexOf(s[t])+1);return e-=1,e}function Lk(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let n,o;for(n=0;n<s;n++){const i=[];for(o=0;o<e;o++)i.push(Dh(o)+(n+1));t.push(i)}return t}function Fk(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let n,o;for(n=0;n<s;n++){const i={};for(o=0;o<e;o++)i[`prop${o}`]=Dh(o)+(n+1);t.push(i)}return t}function Vk(s,e){const t=[];let n;for(let o=0;o<s;o++){n=[];for(let i=0;i<e;i++)n.push("");t.push(n)}return t}function Zf(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=s;const n=[];return(!Array.isArray(s)||!Array.isArray(s[0]))&&(t=[s]),t.forEach((o,i)=>{Array.isArray(o)?o.forEach((r,a)=>{n.push([i+e,a,r])}):Object.keys(o).forEach(r=>{n.push([i+e,r,o[r]])})}),n}function Dm(s){let e=0;return Array.isArray(s)&&(s[0]&&Array.isArray(s[0])?e=s[0].length:s[0]&&Le(s[0])&&(e=Ih(s[0]))),e}function Lb(s){return!!(Array.isArray(s)&&s.length&&s.every(e=>Array.isArray(e)))}function Fb(s){return!!(Array.isArray(s)&&s.length&&s.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const $k=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:Dm,createEmptySpreadsheetData:Vk,createSpreadsheetData:Lk,createSpreadsheetObjectData:Fk,dataRowToChangesArray:Zf,isArrayOfArrays:Lb,isArrayOfObjects:Fb,spreadsheetColumnIndex:kk,spreadsheetColumnLabel:Dh},Symbol.toStringTag,{value:"Module"}));class Wk{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return I(this.data,(n,o)=>{const i=this.getAtCell(o,e);t.push(i)}),t}getAtRow(e,t,n){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=t===void 0&&n===void 0;let r=null,a=null;if(r=this.modifyRowData(e),Array.isArray(r))a=[],i?r.forEach((l,h)=>{a[h]=this.getAtPhysicalCell(e,h,r)}):me(t,n,l=>{a[l-t]=this.getAtPhysicalCell(e,l,r)});else if(Le(r)||nt(r))if(o?a=[]:a={},!i||o){const h=this.countFirstRowKeys()-1;me(0,h,u=>{const d=this.colToProp(u);if(u>=(t||0)&&u<=(n||h)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,r);o?a.push(f):yl(a,d,f)}})}else Fe(r,(l,h)=>{yl(a,h,this.getAtPhysicalCell(e,h,r))});return a}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=xo(n);this.hot.runHooks("modifySourceData",e,t,o,"set"),o.isTouched()&&(n=o.value)}Number.isInteger(t)?this.data[e][t]=n:yl(this.data[e],t,n)}}getAtPhysicalCell(e,t,n){let o=null;if(n&&(typeof t=="string"?o=Zv(n,t):typeof t=="function"?o=t(n):o=n[t]),this.hot.hasHook("modifySourceData")){const i=xo(o);this.hot.runHooks("modifySourceData",e,t,i,"get"),i.isTouched()&&(o=i.value)}return o}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,i=null,r=null,a=null,l=null;e===null||t===null?(o=!0,i=0,a=this.countRows()-1):(i=Math.min(e.row,t.row),r=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const h=[];return me(i,a,u=>{h.push(o?this.getAtRow(u,void 0,void 0,n):this.getAtRow(u,r,l,n))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Dm(this.data)}destroy(){this.data=null,this.hot=null}}const Bk=Wk,Uk="localHooks",Vb={_localHooks:Object.create(null),addLocalHook(s,e){return this._localHooks[s]||(this._localHooks[s]=[]),this._localHooks[s].push(e),this},runLocalHooks(s,e,t,n,o,i,r){if(this._localHooks[s]){const a=this._localHooks[s].length;for(let l=0;l<a;l++)Bl(this._localHooks[s][l],this,e,t,n,o,i,r)}},clearLocalHooks(){return this._localHooks={},this}};rs(Vb,"MIXIN_NAME",Uk,{writable:!1,enumerable:!1});const an=Vb;class Wo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,nt(this.initValueOrFn)?me(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}tt(Wo,an);function Pm(s,e,t,n){const o=t.length?t[0]:void 0;return[...s.slice(0,o),...t.map((i,r)=>nt(n)?n(i,r):n),...o===void 0?[]:s.slice(o)]}function Nm(s,e){return gn(s,(t,n)=>e.includes(n)===!1)}class so extends Wo{insert(e,t){this.indexedValues=Pm(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=Nm(this.indexedValues,e),super.remove(e)}}class Ph extends so{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return bt(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}function km(s,e,t){return[...s.slice(0,e),...t,...s.slice(e)]}function kr(s,e){return gn(s,t=>e.includes(t)===!1)}function Lm(s,e){return ke(s,t=>t-e.filter(n=>n<t).length)}function Fm(s,e){const t=e[0],n=e.length;return ke(s,o=>o>=t?o+n:o)}function Yk(s,e,t){return e=zk(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function zk(s){var e=Gk(s,"string");return typeof e=="symbol"?e:String(e)}function Gk(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class Nh extends Wo{constructor(){super(...arguments),Yk(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=kr(this.orderOfIndexes,[e]),nt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=Pm(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=Fm(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=Nm(this.indexedValues,e),this.orderOfIndexes=kr(this.orderOfIndexes,e),this.orderOfIndexes=Lm(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class oa extends so{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return bt(this.getValues(),(e,t,n)=>(t&&e.push(n),e),[])}}const gC=new Map([["indexesSequence",{getListWithInsertedItems:km,getListWithRemovedItems:kr}],["physicallyIndexed",{getListWithInsertedItems:Pm,getListWithRemovedItems:Nm}]]),$b=s=>{if(gC.has(s)===!1)throw new Error(`Alter strategy with ID '${s}' does not exist.`);return gC.get(s)};class Wb extends Wo{constructor(){super(e=>e)}insert(e,t){const n=Fm(this.indexedValues,t);this.indexedValues=km(n,e,t),super.insert(e,t)}remove(e){const t=kr(this.indexedValues,e);this.indexedValues=Lm(t,e),super.remove(e)}}const mC=new Map([["hiding",Ph],["index",Wo],["linkedPhysicalIndexToValue",Nh],["physicalIndexToValue",so],["trimming",oa]]);function jk(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!mC.has(s))throw new Error(`The provided map type ("${s}") does not exist.`);return new(mC.get(s))(e)}let Qf=0;class Vm{constructor(){this.collection=new Map}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),Qf+=1)}unregister(e){const t=this.collection.get(e);le(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Qf-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return st(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(n=>{n.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}tt(Vm,an);function Kk(){return Qf}class pC extends Vm{constructor(e,t){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=ke(this.get(),i=>i.getValues()),n=[],o=le(t[0])&&t[0].length||0;for(let i=0;i<o;i+=1){const r=[];for(let a=0;a<this.getLength();a+=1)r.push(t[a][i]);n.push(r)}return ke(n,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return le(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Xk(s,e,t){qk(s,e),e.set(s,t)}function qk(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zk(s,e,t){var n=Bb(s,e,"set");return Qk(s,n,t),t}function Qk(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Jk(s,e){var t=Bb(s,e,"get");return eL(s,t)}function Bb(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function eL(s,e){return e.get?e.get.call(s):e.value}var sd=new WeakMap;class Ub{constructor(){Xk(this,sd,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(Jk(this,sd)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Zk(this,sd,e)}}tt(Ub,an);function wC(s,e){const t=[];let n=0,o=0;for(;n<s.length&&o<e.length;n++,o++)s[n]!==e[o]&&t.push({op:"replace",index:o,oldValue:s[n],newValue:e[o]});for(;n<e.length;n++)t.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;o<s.length;o++)t.push({op:"remove",index:o,oldValue:s[o],newValue:void 0});return t}function ji(s,e,t){tL(s,e),e.set(s,t)}function tL(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wn(s,e){var t=Yb(s,e,"get");return nL(s,t)}function nL(s,e){return e.get?e.get.call(s):e.value}function _a(s,e,t){var n=Yb(s,e,"set");return sL(s,n,t),t}function Yb(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function sL(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Aa=new WeakMap,Ki=new WeakMap,xa=new WeakMap,Ha=new WeakMap,Da=new WeakMap;class oL{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ji(this,Aa,{writable:!0,value:new Set}),ji(this,Ki,{writable:!0,value:[]}),ji(this,xa,{writable:!0,value:[]}),ji(this,Ha,{writable:!0,value:!1}),ji(this,Da,{writable:!0,value:!1}),_a(this,Da,e??!1)}createObserver(){const e=new Ub;return wn(this,Aa).add(e),e.addLocalHook("unsubscribe",()=>{wn(this,Aa).delete(e)}),e._writeInitialChanges(wC(wn(this,Ki),wn(this,xa))),e}emit(e){let t=wn(this,xa);(!wn(this,Ha)||wn(this,Ki).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(wn(this,Da)):_a(this,Ki,new Array(e.length).fill(wn(this,Da))),wn(this,Ha)||(_a(this,Ha,!0),t=wn(this,Ki)));const n=wC(t,e);wn(this,Aa).forEach(o=>o._write(n)),_a(this,xa,e)}}class Jf{constructor(){this.indexesSequence=new Wb,this.trimmingMapsCollection=new pC(e=>e.some(t=>t===!0),!1),this.hidingMapsCollection=new pC(e=>e.some(t=>t===!0),!1),this.variousMapsCollection=new Vm,this.hidingChangesObservable=new oL({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,jk(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof oa?this.trimmingMapsCollection.register(e,t):t instanceof Ph?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return le(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return le(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return le(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return le(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let r=-1;return t>0?r=i.findIndex(a=>a>e):r=i.reverse().findIndex(a=>a<e),r===-1?n?this.getNearestNotHiddenIndex(e,-t,!1):null:i[r]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(o=>o+e);this.removeIndexes(n)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const n=ke(e,h=>this.getPhysicalFromVisualIndex(h)),o=this.getNotTrimmedIndexesLength(),i=e.length,r=kr(this.getIndexesSequence(),n),a=r.filter(h=>this.isTrimmed(h)===!1);let l=r.indexOf(a[a.length-1])+1;if(t+i<o){const h=a[t];l=r.indexOf(h)}this.indexesChangeSource="move",this.setIndexesSequence(km(r,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],o=le(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),r=ke(new Array(t).fill(o),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,r),this.hidingMapsCollection.insertToEvery(i,r),this.variousMapsCollection.insertToEvery(i,r),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromRenderableIndex(t),o=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(o,t)}}}tt(Jf,an);function iL(s,e){return Fe(e,(t,n)=>{st(s[n])&&(s[n]=t)}),s}function zb(s){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(s);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:s}function Gb(s){le(s)&&um(Je`Language with code "${s}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function rL(s,e){return Array.isArray(s)&&Number.isInteger(e)?s[e]:s}const{register:aL,getValues:lL}=Mn("phraseFormatters");function hL(s,e){aL(s,e)}function uL(){return lL()}hL("pluralize",rL);const jb="ContextMenu:items",De=jb,kh=`${De}.noItems`,Lh=`${De}.insertRowAbove`,Fh=`${De}.insertRowBelow`,Vh=`${De}.insertColumnOnTheLeft`,$h=`${De}.insertColumnOnTheRight`,Wh=`${De}.removeRow`,Bh=`${De}.removeColumn`,Uh=`${De}.undo`,Yh=`${De}.redo`,zh=`${De}.readOnly`,Gh=`${De}.clearColumn`,jh=`${De}.copy`,$m=`${De}.copyWithHeaders`,Wm=`${De}.copyWithGroupHeaders`,Bm=`${De}.copyHeadersOnly`,Kh=`${De}.cut`,Xh=`${De}.freezeColumn`,qh=`${De}.unfreezeColumn`,Zh=`${De}.mergeCells`,Qh=`${De}.unmergeCells`,Jh=`${De}.addComment`,eu=`${De}.editComment`,tu=`${De}.removeComment`,nu=`${De}.readOnlyComment`,su=`${De}.align`,ou=`${De}.align.left`,iu=`${De}.align.center`,ru=`${De}.align.right`,au=`${De}.align.justify`,lu=`${De}.align.top`,hu=`${De}.align.middle`,uu=`${De}.align.bottom`,cu=`${De}.borders`,du=`${De}.borders.top`,fu=`${De}.borders.right`,gu=`${De}.borders.bottom`,mu=`${De}.borders.left`,pu=`${De}.borders.remove`,wu=`${De}.nestedHeaders.insertChildRow`,Cu=`${De}.nestedHeaders.detachFromParent`,yu=`${De}.hideColumn`,Su=`${De}.showColumn`,vu=`${De}.hideRow`,bu=`${De}.showRow`,nn="Filters:",yt=`${nn}conditions`,ia=`${yt}.none`,Ru=`${yt}.isEmpty`,Eu=`${yt}.isNotEmpty`,Tu=`${yt}.isEqualTo`,Mu=`${yt}.isNotEqualTo`,Ou=`${yt}.beginsWith`,Iu=`${yt}.endsWith`,_u=`${yt}.contains`,Au=`${yt}.doesNotContain`,cL=`${yt}.byValue`,xu=`${yt}.greaterThan`,Hu=`${yt}.greaterThanOrEqualTo`,Du=`${yt}.lessThan`,Pu=`${yt}.lessThanOrEqualTo`,Nu=`${yt}.isBetween`,ku=`${yt}.isNotBetween`,Lu=`${yt}.after`,Fu=`${yt}.before`,Vu=`${yt}.today`,$u=`${yt}.tomorrow`,Wu=`${yt}.yesterday`,Bu=`${nn}labels.filterByCondition`,Uu=`${nn}labels.filterByValue`,Yu=`${nn}labels.conjunction`,ra=`${nn}labels.disjunction`,Lr=`${nn}values.blankCells`,zu=`${nn}buttons.selectAll`,Gu=`${nn}buttons.clear`,ju=`${nn}buttons.ok`,Ku=`${nn}buttons.cancel`,Xu=`${nn}buttons.placeholder.search`,qu=`${nn}buttons.placeholder.value`,Zu=`${nn}buttons.placeholder.secondValue`,dL=Object.freeze(Object.defineProperty({__proto__:null,CONTEXTMENU_ITEMS_ADD_COMMENT:Jh,CONTEXTMENU_ITEMS_ALIGNMENT:su,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:uu,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:iu,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:au,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:ou,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:hu,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ru,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:lu,CONTEXTMENU_ITEMS_BORDERS:cu,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:gu,CONTEXTMENU_ITEMS_BORDERS_LEFT:mu,CONTEXTMENU_ITEMS_BORDERS_RIGHT:fu,CONTEXTMENU_ITEMS_BORDERS_TOP:du,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Gh,CONTEXTMENU_ITEMS_COPY:jh,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Bm,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Wm,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:$m,CONTEXTMENU_ITEMS_CUT:Kh,CONTEXTMENU_ITEMS_EDIT_COMMENT:eu,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Xh,CONTEXTMENU_ITEMS_HIDE_COLUMN:yu,CONTEXTMENU_ITEMS_HIDE_ROW:vu,CONTEXTMENU_ITEMS_INSERT_LEFT:Vh,CONTEXTMENU_ITEMS_INSERT_RIGHT:$h,CONTEXTMENU_ITEMS_MERGE_CELLS:Zh,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Cu,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:wu,CONTEXTMENU_ITEMS_NO_ITEMS:kh,CONTEXTMENU_ITEMS_READ_ONLY:zh,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:nu,CONTEXTMENU_ITEMS_REDO:Yh,CONTEXTMENU_ITEMS_REMOVE_BORDERS:pu,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Bh,CONTEXTMENU_ITEMS_REMOVE_COMMENT:tu,CONTEXTMENU_ITEMS_REMOVE_ROW:Wh,CONTEXTMENU_ITEMS_ROW_ABOVE:Lh,CONTEXTMENU_ITEMS_ROW_BELOW:Fh,CONTEXTMENU_ITEMS_SHOW_COLUMN:Su,CONTEXTMENU_ITEMS_SHOW_ROW:bu,CONTEXTMENU_ITEMS_UNDO:Uh,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:qh,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Qh,CONTEXT_MENU_ITEMS_NAMESPACE:jb,FILTERS_BUTTONS_CANCEL:Ku,FILTERS_BUTTONS_CLEAR:Gu,FILTERS_BUTTONS_OK:ju,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Xu,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Zu,FILTERS_BUTTONS_PLACEHOLDER_VALUE:qu,FILTERS_BUTTONS_SELECT_ALL:zu,FILTERS_CONDITIONS_AFTER:Lu,FILTERS_CONDITIONS_BEFORE:Fu,FILTERS_CONDITIONS_BEGINS_WITH:Ou,FILTERS_CONDITIONS_BETWEEN:Nu,FILTERS_CONDITIONS_BY_VALUE:cL,FILTERS_CONDITIONS_CONTAINS:_u,FILTERS_CONDITIONS_EMPTY:Ru,FILTERS_CONDITIONS_ENDS_WITH:Iu,FILTERS_CONDITIONS_EQUAL:Tu,FILTERS_CONDITIONS_GREATER_THAN:xu,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Hu,FILTERS_CONDITIONS_LESS_THAN:Du,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Pu,FILTERS_CONDITIONS_NAMESPACE:yt,FILTERS_CONDITIONS_NONE:ia,FILTERS_CONDITIONS_NOT_BETWEEN:ku,FILTERS_CONDITIONS_NOT_CONTAIN:Au,FILTERS_CONDITIONS_NOT_EMPTY:Eu,FILTERS_CONDITIONS_NOT_EQUAL:Mu,FILTERS_CONDITIONS_TODAY:Vu,FILTERS_CONDITIONS_TOMORROW:$u,FILTERS_CONDITIONS_YESTERDAY:Wu,FILTERS_DIVS_FILTER_BY_CONDITION:Bu,FILTERS_DIVS_FILTER_BY_VALUE:Uu,FILTERS_LABELS_CONJUNCTION:Yu,FILTERS_LABELS_DISJUNCTION:ra,FILTERS_NAMESPACE:nn,FILTERS_VALUES_BLANK_CELLS:Lr},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const fL={languageCode:"en-US",[kh]:"No available options",[Lh]:"Insert row above",[Fh]:"Insert row below",[Vh]:"Insert column left",[$h]:"Insert column right",[Wh]:["Remove row","Remove rows"],[Bh]:["Remove column","Remove columns"],[Uh]:"Undo",[Yh]:"Redo",[zh]:"Read only",[Gh]:"Clear column",[su]:"Alignment",[ou]:"Left",[iu]:"Center",[ru]:"Right",[au]:"Justify",[lu]:"Top",[hu]:"Middle",[uu]:"Bottom",[Xh]:"Freeze column",[qh]:"Unfreeze column",[cu]:"Borders",[du]:"Top",[fu]:"Right",[gu]:"Bottom",[mu]:"Left",[pu]:"Remove border(s)",[Jh]:"Add comment",[eu]:"Edit comment",[tu]:"Delete comment",[nu]:"Read-only comment",[Zh]:"Merge cells",[Qh]:"Unmerge cells",[jh]:"Copy",[$m]:["Copy with header","Copy with headers"],[Wm]:["Copy with group header","Copy with group headers"],[Bm]:["Copy header only","Copy headers only"],[Kh]:"Cut",[wu]:"Insert child row",[Cu]:"Detach from parent",[yu]:["Hide column","Hide columns"],[Su]:["Show column","Show columns"],[vu]:["Hide row","Hide rows"],[bu]:["Show row","Show rows"],[ia]:"None",[Ru]:"Is empty",[Eu]:"Is not empty",[Tu]:"Is equal to",[Mu]:"Is not equal to",[Ou]:"Begins with",[Iu]:"Ends with",[_u]:"Contains",[Au]:"Does not contain",[xu]:"Greater than",[Hu]:"Greater than or equal to",[Du]:"Less than",[Pu]:"Less than or equal to",[Nu]:"Is between",[ku]:"Is not between",[Lu]:"After",[Fu]:"Before",[Vu]:"Today",[$u]:"Tomorrow",[Wu]:"Yesterday",[Lr]:"Blank cells",[Bu]:"Filter by condition",[Uu]:"Filter by value",[Yu]:"And",[ra]:"Or",[zu]:"Select all",[Gu]:"Clear",[ju]:"OK",[Ku]:"Cancel",[Xu]:"Search",[qu]:"Value",[Zu]:"Second value"},Kb=fL,gL=dL,eg=Kb.languageCode,{register:mL,getItem:Xb,hasItem:pL,getValues:wL}=Mn("languagesDictionaries");Um(Kb);function Um(s,e){let t=s,n=e;return Le(s)&&(n=s,t=n.languageCode),CL(t,n),mL(t,Ut(n)),Ut(n)}function CL(s,e){s!==eg&&iL(e,Xb(eg))}function qb(s){return Ym(s)?Ut(Xb(s)):null}function Ym(s){return pL(s)}function yL(){return wL()}function Zb(s,e,t){const n=qb(s);if(n===null)return null;const o=n[e];if(st(o))return null;const i=SL(o,t);return Array.isArray(i)?i[0]:i}function SL(s,e){let t=s;return I(uL(),n=>{t=n(s,e)}),t}function vL(s){let e=zb(s);return Ym(e)||(e=eg,Gb(s)),e}const Qu="active-header",Ju="area",Fr="cell",zm="fill",aa="header",Gm="custom-selection";function bL(s,e,t){return e=RL(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function RL(s){var e=EL(s,"string");return typeof e=="symbol"?e:String(e)}function EL(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class TL extends Ek{constructor(e,t){super(e,null),bL(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:n}=e,o=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(n,-1);if(o===null||i===null)return null;if(o.row>i.row||o.col>i.col){if(!(this.settings.type==="header"||this.settings.type==="active-header"))return null;o=t,i=n}return this.settings.createCellRange(o,o,i)}getNearestNotHiddenCoords(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper(),e.row,t);if(o===null)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper(),e.col,n);return i===null?null:this.settings.createCellCoords(o,i)}getNearestNotHiddenIndex(e,t,n){if(t<0)return t;const o=e.getNearestNotHiddenIndex(t,n);return(this.settings.type==="header"||this.settings.type==="active-header")&&o===null?-1:o}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.getVerticalDirection()==="N-S"?1:-1,n=e.getHorizontalDirection()==="W-E"?1:-1,o=this.getNearestNotHiddenCoords(e.from.clone().normalize(),t,n);if(o!==null&&e.overlaps(o)){if(this.cellRange===null){const i=this.settings.visualToRenderableCoords(o);this.cellRange=this.settings.createCellRange(i)}return e.setHighlight(o),this}return e.setHighlight(e.from),this}getCorners(){const{from:e,to:t}=this.cellRange,n=e.row===null||t.row===null,o=e.col===null||t.col===null,i=this.settings.createCellCoords(n?null:Math.min(e.row,t.row),o?null:Math.min(e.col,t.col)),r=this.settings.createCellCoords(n?null:Math.max(e.row,t.row),o?null:Math.max(e.col,t.col));return[i.row,i.col,r.row,r.col]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const n=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(t);return this.settings.createCellRange(n,n,o)}}const Li=TL;function ML(s){let{activeHeaderClassName:e,...t}=s;return new Li({highlightHeaderClassName:e,...t,selectionType:Qu})}function OL(s){let{layerLevel:e,areaCornerVisible:t,...n}=s;return new Li({className:"area",markIntersections:!0,layerLevel:Math.min(e,7),border:{width:1,color:"#4b89ff",cornerVisible:t},...n,selectionType:Ju})}function IL(s){let{cellCornerVisible:e,...t}=s;return new Li({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:Fr})}function _L(s){let{border:e,visualCellRange:t,...n}=s;return new Li({...e,...n,selectionType:Gm},t)}function AL(s){let{...e}=s;return new Li({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:zm})}function xL(s){let{headerClassName:e,rowClassName:t,columnClassName:n,...o}=s;return new Li({className:"highlight",highlightHeaderClassName:e,highlightRowClassName:t,highlightColumnClassName:n,...o,highlightOnlyClosestHeader:!0,selectionType:aa})}const{register:Fi,getItem:HL}=Mn("highlight/types");Fi(Qu,ML);Fi(Ju,OL);Fi(Fr,IL);Fi(Gm,_L);Fi(zm,AL);Fi(aa,xL);function Zo(s,e){return HL(s)({type:s,...e})}class DL{constructor(e){this.options=e,this.layerLevel=0,this.cell=Zo(Fr,e),this.fill=Zo(zm,e),this.areas=new Map,this.headers=new Map,this.activeHeaders=new Map,this.customSelections=[]}isEnabledFor(e,t){let n=e;e===Fr&&(n="current");let o=this.options.disabledCellSelection(t.row,t.col);return typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getCell(){return this.cell}getFill(){return this.fill}createOrGetArea(){const e=this.layerLevel;let t;return this.areas.has(e)?t=this.areas.get(e):(t=Zo(Ju,{layerLevel:e,...this.options}),this.areas.set(e,t)),t}getAreas(){return[...this.areas.values()]}createOrGetHeader(){const e=this.layerLevel;let t;return this.headers.has(e)?t=this.headers.get(e):(t=Zo(aa,{...this.options}),this.headers.set(e,t)),t}getHeaders(){return[...this.headers.values()]}createOrGetActiveHeader(){const e=this.layerLevel;let t;return this.activeHeaders.has(e)?t=this.activeHeaders.get(e):(t=Zo(Qu,{...this.options}),this.activeHeaders.set(e,t)),t}getActiveHeaders(){return[...this.activeHeaders.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Zo(Gm,{...this.options,...e}))}clear(){this.cell.clear(),this.fill.clear(),I(this.areas.values(),e=>void e.clear()),I(this.headers.values(),e=>void e.clear()),I(this.activeHeaders.values(),e=>void e.clear())}[Symbol.iterator](){return[this.cell,this.fill,...this.areas.values(),...this.headers.values(),...this.activeHeaders.values(),...this.customSelections][Symbol.iterator]()}}const PL=DL;class NL{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(0)}previous(){return this.peekByIndex(-1)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;const t=this.size()+e-1;let n;return t>=0&&(n=this.ranges[t]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const kL=NL;class Qb{constructor(e,t){this.range=e,this.options=t}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.options.createCellCoords(e,t),i=this.range.current().highlight,{row:r,col:a}=this.options.visualToRenderableCoords(i);let l=i,h=0,u=0;if(this.runLocalHooks("beforeTransformStart",o),r!==null&&a!==null){let d=this.options.countRows(),f=this.options.countCols();const m=this.options.fixedRowsBottom(),w=this.options.minSpareRows(),C=this.options.minSpareCols(),R=this.options.autoWrapRow(),H=this.options.autoWrapCol();r+e>d-1?n&&w>0&&!(m&&r>=d-m-1)?(this.runLocalHooks("insertRowRequire",d),d=this.options.countRows()):H&&(o.row=1-d,o.col=a+o.col===f-1?1-f:1):H&&r+o.row<0&&a+o.col>=0&&(o.row=d-1,o.col=a+o.col===0?f-1:-1),a+o.col>f-1?n&&C>0?(this.runLocalHooks("insertColRequire",f),f=this.options.countCols()):R&&(o.row=r+o.row===d-1?1-d:1,o.col=1-f):R&&a+o.col<0&&r+o.row>=0&&(o.row=r+o.row===0?d-1:-1,o.col=f-1);const A=this.options.createCellCoords(r+o.row,a+o.col);h=0,u=0,A.row<0?(h=-1,A.row=0):A.row>0&&A.row>=d&&(h=1,A.row=d-1),A.col<0?(u=-1,A.col=0):A.col>0&&A.col>=f&&(u=1,A.col=f-1),l=this.options.renderableToVisualCoords(A)}return this.runLocalHooks("afterTransformStart",l,h,u),l}transformEnd(e,t){const n=this.options.createCellCoords(e,t),o=this.range.current();let i=o.to,r=0,a=0;this.runLocalHooks("beforeTransformEnd",n);const{row:l,col:h}=this.options.visualToRenderableCoords(o.highlight);if(l!==null&&h!==null){const u=this.options.countRows(),d=this.options.countCols(),{row:f,col:m}=this.options.visualToRenderableCoords(o.to),w=this.options.createCellCoords(f+n.row,m+n.col);r=0,a=0,w.row<0?(r=-1,w.row=0):w.row>0&&w.row>=u&&(r=1,w.row=u-1),w.col<0?(a=-1,w.col=0):w.col>0&&w.col>=d&&(a=1,w.col=d-1),i=this.options.renderableToVisualCoords(w)}return this.runLocalHooks("afterTransformEnd",i,r,a),i}}tt(Qb,an);const LL=Qb,ec=0,tc=1,Jb=2,jm=3,FL=[jm,Jb],VL=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],od=Symbol("root"),CC=Symbol("child");function _i(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:od;if(e!==od&&e!==CC)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(s),n=e===od;let o=ec;if(t){const i=s[0];s.length===0?o=tc:n&&i instanceof Sm?o=jm:n&&Array.isArray(i)?o=_i(i,CC):s.length>=2&&s.length<=4&&!s.some((a,l)=>!VL[l].includes(typeof a))&&(o=Jb)}return o}function Vr(s){let{keepDirection:e=!1,propToCol:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!FL.includes(s))throw new Error("Unsupported selection ranges schema type was provided.");return function(n){const o=s===jm;let i=o?n.from.row:n[0],r=o?n.from.col:n[1],a=o?n.to.row:n[2],l=o?n.to.col:n[3];if(typeof t=="function"&&(typeof r=="string"&&(r=t(r)),typeof l=="string"&&(l=t(l))),st(a)&&(a=i),st(l)&&(l=r),!e){const h=i,u=r,d=a,f=l;i=Math.min(h,d),r=Math.min(u,f),a=Math.max(h,d),l=Math.max(u,f)}return[i,r,a,l]}}function $L(s){const e=_i(s);if(e===ec||e===tc)return[];const t=Vr(e),n=new Set;I(s,r=>{const[,a,,l]=t(r),h=Math.max(a,0),u=l-h+1;I(Array.from(new Array(u),(d,f)=>h+f),d=>{n.has(d)||n.add(d)})});const o=Array.from(n).sort((r,a)=>r-a);return bt(o,(r,a,l,h)=>(l!==0&&a===h[l-1]+1?r[r.length-1][1]+=1:r.push([a,1]),r),[])}function WL(s){const e=_i(s);if(e===ec||e===tc)return[];const t=Vr(e),n=new Set;I(s,r=>{const[a,,l]=t(r),h=Math.max(a,0),u=l-h+1;I(Array.from(new Array(u),(d,f)=>h+f),d=>{n.has(d)||n.add(d)})});const o=Array.from(n).sort((r,a)=>r-a);return bt(o,(r,a,l,h)=>(l!==0&&a===h[l-1]+1?r[r.length-1][1]+=1:r.push([a,1]),r),[])}function Ds(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;return typeof s=="number"&&s>=0&&s<e}class eR{constructor(e,t){var n=this;this.settings=e,this.tableProps=t,this.inProgress=!1,this.selectedByCorner=!1,this.selectedByRowHeader=new Set,this.selectedByColumnHeader=new Set,this.selectedRange=new kL((o,i,r)=>this.tableProps.createCellRange(o,i,r)),this.highlight=new PL({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,disabledCellSelection:(o,i)=>this.tableProps.isDisabledCellSelection(o,i),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,i)=>this.tableProps.createCellCoords(o,i),createCellRange:(o,i,r)=>this.tableProps.createCellRange(o,i,r),rowIndexMapper:()=>this.tableProps.rowIndexMapper(),columnIndexMapper:()=>this.tableProps.columnIndexMapper()}),this.transformation=new LL(this.selectedRange,{countRows:()=>this.tableProps.countRowsTranslated(),countCols:()=>this.tableProps.countColsTranslated(),visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,i)=>this.tableProps.createCellCoords(o,i),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformStart",...i)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return n.runLocalHooks("afterModifyTransformStart",...i)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return n.runLocalHooks("beforeModifyTransformEnd",...i)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return n.runLocalHooks("afterModifyTransformEnd",...i)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return n.runLocalHooks("insertRowRequire",...i)}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return n.runLocalHooks("insertColRequire",...i)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.settings.selectionMode==="multiple",i=st(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,r=e.row<0,a=e.col<0,l=r&&a,h=e.clone();this.selectedByCorner=l,this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,h),(!o||o&&!i&&st(t))&&this.selectedRange.clear(),this.selectedRange.add(h),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),!l&&a&&this.selectedByRowHeader.add(this.getLayerLevel()),!l&&r&&this.selectedByColumnHeader.add(this.getLayerLevel()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){this.setRangeStart(e,t,!0)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone();this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const n=this.selectedRange.current();this.settings.selectionMode!=="single"&&n.setTo(this.tableProps.createCellCoords(t.row,t.col)),this.highlight.getCell().clear(),this.highlight.isEnabledFor(Fr,n.highlight)&&this.highlight.getCell().add(this.selectedRange.current().highlight).commit().syncWith(n);const o=this.getLayerLevel();o<this.highlight.layerLevel&&(I(this.highlight.getAreas(),l=>void l.clear()),I(this.highlight.getHeaders(),l=>void l.clear()),I(this.highlight.getActiveHeaders(),l=>void l.clear())),this.highlight.useLayerLevel(o);const i=this.highlight.createOrGetArea(),r=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();if(i.clear(),r.clear(),a.clear(),this.highlight.isEnabledFor(Ju,n.highlight)&&(this.isMultiple()||o>=1)&&(i.add(n.from).add(n.to).commit(),o===1)){const l=this.selectedRange.previous();this.highlight.useLayerLevel(o-1).createOrGetArea().add(l.from).commit().syncWith(l),this.highlight.useLayerLevel(o)}if(this.highlight.isEnabledFor(aa,n.highlight)){const l=this.tableProps.countRowsTranslated()===0,h=this.tableProps.countColsTranslated()===0;let u=n;(l||h)&&(u=n.clone()),l&&(u.from.row=-1),h&&(u.from.col=-1),this.settings.selectionMode==="single"?(this.isSelectedByAnyHeader()&&u.from.normalize(),r.add(u.from).commit()):r.add(u.from).add(u.to).commit(),this.isEntireRowSelected()&&this.tableProps.countCols()===n.getWidth()&&a.add(this.tableProps.createCellCoords(n.from.row,-1)).add(this.tableProps.createCellCoords(n.to.row,-1)).commit(),this.isEntireColumnSelected()&&this.tableProps.countRows()===n.getHeight()&&a.add(this.tableProps.createCellCoords(-1,n.from.col)).add(this.tableProps.createCellCoords(-1,n.to.col)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=xo(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,t,n))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&this.isEntireRowSelected(e)}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e)}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&this.isEntireColumnSelected(e)}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByCorner}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.tableProps.countRows(),o=this.tableProps.countCols();if(!e&&!t&&(n===0||o===0))return;const i=this.tableProps.createCellCoords(t?-1:0,e?-1:0),r=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(i),this.selectedByRowHeader.add(this.getLayerLevel()),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(r),this.finish()}selectCells(e){const t=_i(e);if(t===tc)return!1;if(t===ec)throw new Error(Je`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=Vr(t,{propToCol:a=>this.tableProps.propToCol(a),keepDirection:!0}),o=this.tableProps.countRows(),i=this.tableProps.countCols(),r=!e.some(a=>{const[l,h,u,d]=n(a);return!(Ds(l,o)&&Ds(h,i)&&Ds(u,o)&&Ds(d,i))});return r&&(this.clear(),I(e,a=>{const[l,h,u,d]=n(a);this.setRangeStartOnly(this.tableProps.createCellCoords(l,h),!1),this.setRangeEnd(this.tableProps.createCellCoords(u,d)),this.finish()})),r}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const o=typeof e=="string"?this.tableProps.propToCol(e):e,i=typeof t=="string"?this.tableProps.propToCol(t):t,r=this.tableProps.countCols(),a=this.tableProps.countRows(),l=Ds(o,r)&&Ds(i,r);return l&&(this.setRangeStartOnly(this.tableProps.createCellCoords(n,o)),this.setRangeEnd(this.tableProps.createCellCoords(a-1,i)),this.finish()),l}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:-1;const o=this.tableProps.countRows(),i=this.tableProps.countCols(),r=Ds(e,o)&&Ds(t,o);return r&&(this.setRangeStartOnly(this.tableProps.createCellCoords(e,n)),this.setRangeEnd(this.tableProps.createCellCoords(t,i-1)),this.finish()),r}refresh(){if(this.highlight.getCustomSelections().forEach(o=>{o.commit()}),!this.isSelected())return;const t=this.highlight.getCell(),n=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);const i=this.highlight.createOrGetArea(),r=this.highlight.createOrGetHeader(),a=this.highlight.createOrGetActiveHeader();i.commit(),r.commit(),a.commit()}this.highlight.useLayerLevel(n)}}tt(eR,an);const BL=eR,yC=/^(\r\n|\n\r|\r|\n)/,UL=/^[^\t\r\n]+/,SC=/^\t/;function YL(s){const e=[[""]];if(s.length===0)return e;let t=0,n=0,o;for(;s.length>0&&o!==s.length;)if(o=s.length,s.match(SC))s=s.replace(SC,""),t+=1,e[n][t]="";else if(s.match(yC))s=s.replace(yC,""),t=0,n+=1,e[n]=[""];else{let i="";if(s.startsWith('"')){let r=0,a=!0;for(;a;){const l=s.slice(0,1);l==='"'&&(r+=1),i+=l,s=s.slice(1),(s.length===0||s.match(/^[\t\r\n]/)&&r%2===0)&&(a=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const r=s.match(UL);i=r?r[0]:"",s=s.slice(i.length)}e[n][t]=i}return e}function Sr(s){let e,t,n,o,i="",r;for(e=0,t=s.length;e<t;e+=1){for(o=s[e].length,n=0;n<o;n+=1)n>0&&(i+="	"),r=s[e][n],typeof r=="string"?r.indexOf(`
`)>-1?i+=`"${r.replace(/"/g,'""')}"`:i+=r:r==null?i+="":i+=r;e!==t-1&&(i+=`
`)}return i}class wi{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){this.instance=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let o=0,i=0,r=!1;if(typeof t=="function"){const a=Ih(e);o=a>0?a:this.countFirstRowKeys(),r=!0}else{const a=this.tableMeta.maxCols;o=Math.min(a,t.length)}for(n=0;n<o;n++){const a=r?t(n):t[n];if(Le(a)){if(typeof a.data<"u"){const l=r?i:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Dm(this.dataSource)}recursiveDuckColumns(e,t,n){let o=t,i=n,r;return typeof o>"u"&&(o=0,i=""),typeof e=="object"&&!Array.isArray(e)&&Fe(e,(a,l)=>{a===null?(r=i+l,this.colToPropCache.push(r),this.propToColCache.set(r,o),o+=1):o=this.recursiveDuckColumns(a,o,`${l}.`)}),o}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.instance.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&le(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(le(t))return this.instance.toVisualColumn(t);const n=this.instance.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Oi(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:o="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.instance.countSourceRows();let r=i,a=0,l=e;if((typeof l!="number"||l>=i)&&(l=i),l<this.instance.countRows()&&(r=this.instance.toPhysicalRow(l)),this.instance.runHooks("beforeCreateRow",l,t,n)===!1||r===null)return{delta:0};const u=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;a<t&&i+a<u;){let w=null;this.instance.dataType==="array"?this.tableMeta.dataSchema?w=Ut(this.getSchema()):(w=[],me(d-1,()=>w.push(null))):this.instance.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},ea(w,this.getSchema())),f.push(w),a+=1}this.instance.rowIndexMapper.insertIndexes(l,a),o==="below"&&(r=Math.min(r+1,i)),this.spliceData(r,0,f);const m=this.instance.toVisualRow(r);return this.instance.countSourceRows()===f.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(r,t)),this.instance.runHooks("afterCreateRow",m,a,n),this.instance.forceFullRender=!0,{delta:a,startPhysicalIndex:r}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:o="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,r=this.tableMeta.maxCols,a=this.instance.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.instance.runHooks("beforeCreateCol",l,t,n)===!1)return{delta:0};let u=a;l<this.instance.countCols()&&(u=this.instance.toPhysicalColumn(l));const d=this.instance.countSourceRows();let f=this.instance.countCols(),m=0,w=u;o==="end"&&(w=Math.min(w+1,a));const C=w;for(;m<t&&f<r;){if(typeof l!="number"||l>=f)if(d>0)for(let H=0;H<d;H+=1)typeof i[H]>"u"&&(i[H]=[]),i[H].push(null);else i.push([null]);else for(let H=0;H<d;H++)i[H].splice(w,0,null);m+=1,w+=1,f+=1}this.instance.columnIndexMapper.insertIndexes(l,m),m>0&&(e==null?this.metaManager.createColumn(null,m):n!=="auto"&&this.metaManager.createColumn(C,t));const R=this.instance.toVisualColumn(C);return this.instance.runHooks("afterCreateCol",R,m,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:C}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(o,t),r=this.instance.countSourceRows();if(o=(r+o)%r,this.instance.runHooks("beforeRemoveRow",o,i.length,i,n)===!1)return!1;const l=i.length;if(this.filterData(o,l,i),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);const u=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort((u,d)=>d-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.instance.runHooks("afterRemoveRow",o,l,i,n),this.instance.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o=typeof e!="number"?-t:e;o=(this.instance.countCols()+o)%this.instance.countCols();const i=this.visualColumnsToPhysical(o,t),r=i.slice(0).sort((d,f)=>f-d);if(this.instance.runHooks("beforeRemoveCol",o,t,i,n)===!1)return!1;let l=!0;const h=r.length,u=this.dataSource;for(let d=0;d<h;d++)l&&i[0]!==i[d]-d&&(l=!1);if(l)for(let d=0,f=this.instance.countSourceRows();d<f;d++)u[d].splice(i[0],t),d===0&&this.metaManager.removeColumn(i[0],t);else for(let d=0,f=this.instance.countSourceRows();d<f;d++)for(let m=0;m<h;m++)u[d].splice(r[m],1),d===0&&this.metaManager.removeColumn(r[m],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(i),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,t,i,n),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){const o=this.instance.getDataAtCol(e),i=o.slice(t,t+n),r=o.slice(t+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),h=3;h<a;h++)l[h-3]=arguments[h];Hf(l,r);let u=0;for(;u<n;)l.push(null),u+=1;return _v(l),this.instance.populateFromArray(t,e,l,null,null,"spliceCol"),i}spliceRow(e,t,n){const o=this.instance.getSourceDataAtRow(e),i=o.slice(t,t+n),r=o.slice(t+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),h=3;h<a;h++)l[h-3]=arguments[h];Hf(l,r);let u=0;for(;u<n;)l.push(null),u+=1;return this.instance.populateFromArray(e,t,[l],null,null,"spliceRow"),i}spliceData(e,t,n){if(this.instance.runHooks("beforeDataSplice",e,t,n)!==!1){const i=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,i.forEach(r=>this.dataSource.push(r))}}filterData(e,t,n){let o=this.instance.runHooks("filterData",e,t,n);Array.isArray(o)===!1&&(o=this.dataSource.filter((i,r)=>n.indexOf(r)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(e,t){const n=this.instance.toPhysicalRow(e);let o=this.dataSource[n];const i=this.instance.runHooks("modifyRowData",n);o=isNaN(i)?i:o;let r=null;if(o&&o.hasOwnProperty&&wt(o,t))r=o[t];else if(typeof t=="string"&&t.indexOf(".")>-1){const a=t.split(".");let l=o;if(!l)return null;for(let h=0,u=a.length;h<u;h++)if(l=l[a[h]],typeof l>"u")return null;r=l}else typeof t=="function"&&(r=t(this.dataSource.slice(n,n+1)[0]));if(this.instance.hasHook("modifyData")){const a=xo(r);this.instance.runHooks("modifyData",n,this.propToCol(t),a,"get"),a.isTouched()&&(r=a.value)}return r}getCopyable(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const o=this.instance.toPhysicalRow(e);let i=n,r=this.dataSource[o];const a=this.instance.runHooks("modifyRowData",o);if(r=isNaN(a)?a:r,this.instance.hasHook("modifyData")){const l=xo(i);this.instance.runHooks("modifyData",o,this.propToCol(t),l,"set"),l.isTouched()&&(i=l.value)}if(r&&r.hasOwnProperty&&wt(r,t))r[t]=i;else if(typeof t=="string"&&t.indexOf(".")>-1){const l=t.split(".");let h=r,u=0,d;for(u=0,d=l.length-1;u<d;u++)typeof h[l[u]]>"u"&&(h[l[u]]={}),h=h[l[u]];h[l[u]]=i}else typeof t=="function"?t(this.dataSource.slice(o,o+1)[0],i):r[t]=i}visualRowsToPhysical(e,t){const n=this.instance.countSourceRows(),o=[];let i=(n+e)%n,r=t,a;for(;i<n&&r;)a=this.instance.toPhysicalRow(i),o.push(a),r-=1,i+=1;return o}visualColumnsToPhysical(e,t){const n=this.instance.countCols(),o=[];let i=(n+e)%n,r=t;for(;i<n&&r;){const a=this.instance.toPhysicalColumn(i);o.push(a),r-=1,i+=1}return o}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const n=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,t,wi.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const o=[];let i,r,a;const l=this.tableMeta.maxRows,h=this.tableMeta.maxCols;if(l===0||h===0)return[];const u=n===wi.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),f=Math.min(Math.max(h-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=d;i++){a=[];const m=i>=0?this.instance.toPhysicalRow(i):i;for(r=Math.min(e.col,t.col);r<=f&&m!==null;r++)a.push(u.call(this,i,this.colToProp(r)));m!==null&&o.push(a)}return o}getText(e,t){return Sr(this.getRange(e,t,wi.DESTINATION_RENDERER))}getCopyableText(e,t){return Sr(this.getRange(e,t,wi.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const zL=wi,{register:GL,getItem:jL,hasItem:tR,getNames:KL,getValues:Pz}=Mn("cellTypes");function Km(s){if(!tR(s))throw Error(`You declared cell type "${s}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return jL(s)}function Zt(s,e){typeof s!="string"&&(e=s,s=e.CELL_TYPE);const{editor:t,renderer:n,validator:o}=e;t&&rn(s,t),n&&Xn(s,n),o&&pi(s,o),GL(s,e)}function XL(s,e){var t;return s==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(s))||!wt(e,s)}function nc(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s;const n=typeof e.type=="string"?Km(e.type):e.type;if(s._automaticallyAssignedMetaProps&&Fe(e,(i,r)=>void s._automaticallyAssignedMetaProps.delete(r)),!Le(n))return;t===s&&!s._automaticallyAssignedMetaProps&&(s._automaticallyAssignedMetaProps=new Set);const o={};Fe(n,(i,r)=>{if(XL(r,t)){var a;o[r]=i,(a=s._automaticallyAssignedMetaProps)===null||a===void 0||a.add(r)}}),Mt(s,o)}function qL(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}As(t,s);for(let n=0;n<e.length;n++)t.prototype[e[n]]=void 0;return t}function Rl(s){return Number.isInteger(s)&&s>=0}function El(s,e){if(!s())throw new Error(`Assertion failed: ${e}`)}function Pa(s){return s==null}const nR=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",isEmptyCol(s){let e,t,n;for(e=0,t=this.countRows();e<t;e++)if(n=this.getDataAtCell(e,s),It(n)===!1)return!1;return!0},isEmptyRow(s){let e,t,n,o;for(e=0,t=this.countCols();e<t;e++)if(n=this.getDataAtCell(s,e),It(n)===!1)return typeof n=="object"?(o=this.getCellMeta(s,e),Oh(this.getSchema()[o.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function ZL(){return class{}}class QL{constructor(e){this.metaCtor=ZL(),this.meta=this.metaCtor.prototype,Mt(this.meta,nR()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Mt(this.meta,e),nc(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}class JL{constructor(e){const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Mt(this.meta,e),nc(this.meta,e,e)}}class tg{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){El(()=>Rl(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],n===void 0&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=n,this.index[e]=o}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;El(()=>Rl(e)||Pa(e),"Expecting an unsigned number or null/undefined argument.");const n=[],o=this.data.length;for(let r=0;r<t;r++)n.push(o+r),this.data.push(void 0);const i=Pa(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;El(()=>Rl(e)||Pa(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Pa(e)?this.index.length-t:e,t);for(let o=0;o<n.length;o++){const i=n[o];typeof i=="number"&&this.holes.add(i)}}size(){return this.data.length-this.holes.size}values(){return gn(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const o=this._getKeyByStorageIndex(n);o!==-1&&e.push([o,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}const eF=["data","width"];class tF{constructor(e){this.globalMeta=e,this.metas=new tg(()=>this._createMeta())}updateMeta(e,t){const n=this.getMeta(e);Mt(n,t),nc(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return qL(this.globalMeta.getMetaConstructor(),eF).prototype}}class nF{constructor(e){this.columnMeta=e,this.metas=new tg(()=>this._createRow())}updateMeta(e,t,n){const o=this.getMeta(e,t);Mt(o,n),nc(o,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const o=this.metas.obtain(e).obtain(t);return n===void 0?o:o[n]}setMeta(e,t,n,o){var i;const r=this.metas.obtain(e).obtain(t);(i=r._automaticallyAssignedMetaProps)===null||i===void 0||i.delete(n),r[n]=o}removeMeta(e,t,n){const o=this.metas.obtain(e).obtain(t);delete o[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)e.push(...t[n].values());return e}getMetasAtRow(e){El(()=>Rl(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new tg(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class sR{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new QL(e),this.tableMeta=new JL(this.globalMeta),this.columnMeta=new tF(this.globalMeta),this.cellMeta=new nF(this.columnMeta),n.forEach(o=>new o(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){let{visualRow:o,visualColumn:i}=n;const r=this.cellMeta.getMeta(e,t);return r.visualRow=o,r.visualCol=i,r.row=e,r.col=t,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,t,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,o){this.cellMeta.setMeta(e,t,n,o)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}tt(sR,an);function vC(s,e,t,n){const{hotInstance:o,dataMap:i,dataSource:r,internalSource:a,source:l,metaManager:h,firstRun:u}=n,d=Bt(a),f=o.getSettings();Array.isArray(f.dataSchema)?o.dataType="array":nt(f.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),s=o.runHooks(`before${d}`,s,u,l);const m=new zL(o,s,h);if(e(m),typeof s=="object"&&s!==null)s.push&&s.splice||(s=[s]);else if(s===null){const w=m.getSchema();s=[];let C,R=0,H=0;for(R=0,H=f.startRows;R<H;R++)if((o.dataType==="object"||o.dataType==="function")&&f.dataSchema)C=Ut(w),s.push(C);else if(o.dataType==="array")C=Ut(w[0]),s.push(C);else{C=[];for(let A=0,_=f.startCols;A<_;A++)C.push(null);s.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof s} given)`);Array.isArray(s[0])&&(o.dataType="array"),f.data=s,m.dataSource=s,r.data=s,r.dataType=o.dataType,r.colToProp=m.colToProp.bind(m),r.propToCol=m.propToCol.bind(m),r.countCachedColumns=m.countCachedColumns.bind(m),t(m),o.runHooks(`after${d}`,s,u,l),u||(o.runHooks("afterChange",null,a),o.render())}class sF{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),ce.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:o}=e;if((t=this.metaSyncMemo.get(n))!==null&&t!==void 0&&t.has(o))return;const{visualRow:i,visualCol:r}=e,a=this.metaManager.hot,l=a.colToProp(r);e.prop=l,a.runHooks("beforeGetCellMeta",i,r,e);const h=wt(e,"type")?e.type:null;let u=nt(e.cells)?e.cells(n,o,l):null;if(h)if(u){var d;u.type=(d=u.type)!==null&&d!==void 0?d:h}else u={type:h};u&&this.metaManager.updateCellMeta(n,o,u),a.runHooks("afterGetCellMeta",i,r,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(o)}}class oF{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,n,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{target:n,onChange:o=()=>{}}=e,i=typeof n=="string",r=i?n:t,a=`_${r}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[r],this.installPropWatcher(t,a,o),i&&this.installPropWatcher(n,a,o)})}installPropWatcher(e,t,n){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const r=!o.usageTracker.has(e);o.usageTracker.add(e),n.call(o,e,i,r),this[t]=i},enumerable:!0,configurable:!0})}}const bC=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Na=s=>s.map(e=>{const t=e.toLowerCase();return bC.has(t)?bC.get(t):t}).sort().join("+"),iF=s=>s.split("+"),RC=s=>s.toLowerCase(),rF=s=>{const e=xh({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${s}" context.`}),t=function(){let{keys:l,callback:h,group:u,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:m=!0,stopPropagation:w=!1,relativeToGroup:C,position:R}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(st(u))throw new Error("You need to define the shortcut's group.");if(nt(h)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Je`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const H={callback:h,group:u,runOnlyIf:d,captureCtrl:f,preventDefault:m,stopPropagation:w};le(C)&&([H.relativeToGroup,H.position]=[C,R]),l.forEach(A=>{const _=Na(A);if(e.hasItem(_)){const D=e.getItem(_);let G=D.findIndex(z=>z.group===C);G!==-1?R==="before"?G-=1:G+=1:G=D.length,D.splice(G,0,H)}else e.addItem(_,[H])})},n=function(l){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(u=>{Fe(h,(d,f)=>{Object.prototype.hasOwnProperty.call(u,f)===!1&&(u[f]=h[f])}),t(u)})},o=l=>{const h=Na(l);e.removeItem(h)};return{addShortcut:t,addShortcuts:n,getShortcuts:l=>{const h=Na(l),u=e.getItem(h);return le(u)?u.slice():[]},hasShortcut:l=>{const h=Na(l);return e.hasItem(h)},removeShortcutsByKeys:o,removeShortcutsByGroup:l=>{e.getItems().forEach(u=>{let[d,f]=u;const m=f.filter(w=>w.group!==l);m.length===0?o(iF(d)):(f.length=0,f.push(...m))})}}};function aF(){const s=new Set;return{press(e){s.add(e)},release(e){s.delete(e)},releaseAll(){s.clear()},isPressed(e){return s.has(e)}}}const lF=["meta","alt","shift","control"],Xi=aF();function hF(s,e,t,n,o){const i=f=>lF.includes(f),r=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=[];return f.altKey&&w.push("alt"),m&&(f.ctrlKey||f.metaKey)?w.push("control/meta"):(f.ctrlKey&&w.push("control"),f.metaKey&&w.push("meta")),f.shiftKey&&w.push("shift"),w},a=f=>{if(e(f)===!1)return;const m=t(f);if(f.keyCode===229||m===!1||bo(f))return;const w=RC(f.key);let C=[];i(w)?Xi.press(w):C=r(f);const R=[w].concat(C);!o(f,R)&&(Ul()&&C.includes("meta")||!Ul()&&C.includes("control"))&&o(f,[w].concat(r(f,!0))),n(f)},l=f=>{if(e(f)===!1)return;const m=RC(f.key);i(m)!==!1&&Xi.release(m)},h=()=>{Xi.releaseAll()};return{mount:()=>{let f=s;for(;f;)f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("keyup",l),f.document.documentElement.addEventListener("blur",h),f=xr(f)},unmount:()=>{let f=s;for(;f;)f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("keyup",l),f.document.documentElement.removeEventListener("blur",h),f=xr(f)},isPressed:f=>Xi.isPressed(f),releasePressedKeys:()=>Xi.releaseAll()}}const uF=s=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:n,afterKeyDown:o}=s;const i=xh({errorIdExists:m=>`The "${m}" context name is already registered.`});let r="grid";const a=m=>{const w=rF(m);return i.addItem(m,w),w},l=()=>r,h=m=>i.getItem(m),u=m=>{r=m};let d=!1;const f=hF(e,t,n,o,(m,w)=>{const C=h(l());let R=!1;if(!C.hasShortcut(w))return R;const H=C.getShortcuts(w);for(let A=0;A<H.length;A++){const{callback:_,runOnlyIf:O,preventDefault:D,stopPropagation:G,captureCtrl:z}=H[A];if(O(m)!==!1&&(d=z,R=_(m,w)===!1,d=!1,D&&m.preventDefault(),G&&m.stopPropagation(),R))break}return R});return f.mount(),{addContext:a,getActiveContextName:l,getContext:h,setActiveContextName:u,isCtrlPressed:()=>!d&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}},cF="gridDefault";let id=null;function Xm(s,e){var t;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,i=this;const r=new ft(i);let a,l,h,u,d=!0;Ik(n)&&Ok(this),this.rootElement=s,this.rootDocument=s.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const f=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",m=["rtl","ltr"].includes(f)?f:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return m==="rtl"},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1},e.language=vL(e.language);const w=new sR(i,e,[sF,oF]),C=w.getTableMeta(),R=w.getGlobalMeta(),H=xh();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,s.insertBefore(this.container,s.firstChild),Xf(this)&&Dv(e.licenseKey,s),this.guid=`ht_${Qg()}`,this.columnIndexMapper=new Jf,this.rowIndexMapper=new Jf,this.columnIndexMapper.addLocalHook("indexesSequenceChange",c=>{i.runHooks("afterColumnSequenceChange",c)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",c=>{i.runHooks("afterRowSequenceChange",c)}),l=new Bk(i),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=c=>{const{row:g,col:p}=c;return i._createCellCoords(g>=0?i.rowIndexMapper.getRenderableFromVisualIndex(g):g,p>=0?i.columnIndexMapper.getRenderableFromVisualIndex(p):p)},_=c=>{const{row:g,col:p}=c;return i._createCellCoords(g>=0?i.rowIndexMapper.getVisualFromRenderableIndex(g):g,p>=0?i.columnIndexMapper.getVisualFromRenderableIndex(p):p)};let O=new BL(C,{rowIndexMapper:()=>i.rowIndexMapper,columnIndexMapper:()=>i.columnIndexMapper,countCols:()=>i.countCols(),countRows:()=>i.countRows(),propToCol:c=>a.propToCol(c),isEditorOpened:()=>i.getActiveEditor()?i.getActiveEditor().isOpened():!1,countColsTranslated:()=>this.view.countRenderableColumns(),countRowsTranslated:()=>this.view.countRenderableRows(),getShortcutManager:()=>i.getShortcutManager(),createCellCoords:(c,g)=>i._createCellCoords(c,g),createCellRange:(c,g,p)=>i._createCellRange(c,g,p),visualToRenderableCoords:A,renderableToVisualCoords:_,isDisabledCellSelection:(c,g)=>i.getCellMeta(c,g).disableVisualSelection});this.selection=O;const D=c=>{let{hiddenIndexesChanged:g}=c;g&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",D),this.rowIndexMapper.addLocalHook("cacheUpdated",D),this.selection.addLocalHook("beforeSetRangeStart",c=>{this.runHooks("beforeSetRangeStart",c)}),this.selection.addLocalHook("beforeSetRangeStartOnly",c=>{this.runHooks("beforeSetRangeStartOnly",c)}),this.selection.addLocalHook("beforeSetRangeEnd",c=>{this.runHooks("beforeSetRangeEnd",c),c.row<0&&(c.row=this.view._wt.wtTable.getFirstVisibleRow()),c.col<0&&(c.col=this.view._wt.wtTable.getFirstVisibleColumn())}),this.selection.addLocalHook("afterSetRangeEnd",c=>{const g=xo(!1),p=this.selection.getSelectedRange(),{from:v,to:E}=p.current(),M=p.size()-1;this.runHooks("afterSelection",v.row,v.col,E.row,E.col,g,M),this.runHooks("afterSelectionByProp",v.row,i.colToProp(v.col),E.row,i.colToProp(E.col),g,M);const U=this.selection.isSelectedByAnyHeader(),$=this.selection.selectedRange.current();let K=!0;o&&(K=!1),g.isTouched()&&(K=!g.value);const Q=this.selection.isSelectedByRowHeader(),j=this.selection.isSelectedByColumnHeader();K!==!1&&(U?Q?this.view.scrollViewportVertically(i.rowIndexMapper.getRenderableFromVisualIndex(c.row)):j&&this.view.scrollViewportHorizontally(i.columnIndexMapper.getRenderableFromVisualIndex(c.col)):$&&!this.selection.isMultiple()?this.view.scrollViewport(A($.from)):this.view.scrollViewport(A(c))),Q&&j?J(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Q?(_e(this.rootElement,"ht__selection--columns"),J(this.rootElement,"ht__selection--rows")):j?(_e(this.rootElement,"ht__selection--rows"),J(this.rootElement,"ht__selection--columns")):_e(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",c=>{const g=c.length-1,{from:p,to:v}=c[g];this.runHooks("afterSelectionEnd",p.row,p.col,v.row,v.col,g),this.runHooks("afterSelectionEndByProp",p.row,i.colToProp(p.col),v.row,i.colToProp(v.col),g)}),this.selection.addLocalHook("afterIsMultipleSelection",c=>{const g=this.runHooks("afterIsMultipleSelection",c.value);c.value&&(c.value=g)}),this.selection.addLocalHook("beforeModifyTransformStart",c=>{this.runHooks("modifyTransformStart",c)}),this.selection.addLocalHook("afterModifyTransformStart",(c,g,p)=>{this.runHooks("afterModifyTransformStart",c,g,p)}),this.selection.addLocalHook("beforeModifyTransformEnd",c=>{this.runHooks("modifyTransformEnd",c)}),this.selection.addLocalHook("afterModifyTransformEnd",(c,g,p)=>{this.runHooks("afterModifyTransformEnd",c,g,p)}),this.selection.addLocalHook("afterDeselect",()=>{u.destroyEditor(),this._refreshBorders(),_e(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("insertRowRequire",c=>{this.alter("insert_row_above",c,1,"auto")}),this.selection.addLocalHook("insertColRequire",c=>{this.alter("insert_col_start",c,1,"auto")}),h={alter(c,g){var p,v;let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,M=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0;const $=K=>{if(K.length===0)return[];const Q=[...K];return Q.sort((ge,xe)=>{let[Re]=ge,[Ee]=xe;return Re===Ee?0:Re>Ee?1:-1}),bt(Q,(ge,xe)=>{let[Re,Ee]=xe;const Y=ge[ge.length-1],[Ye,Ne]=Y,Se=Ye+Ne;if(Re<=Se){const Ie=Math.max(Ee-(Se-Re),0);Y[1]+=Ie}else ge.push([Re,Ee]);return ge},[Q[0]])};switch(c){case"insert_row_below":case"insert_row_above":const K=i.countSourceRows();if(C.maxRows===K)return;const Q=c==="insert_row_below"?"below":"above";g=(p=g)!==null&&p!==void 0?p:Q==="below"?K:0;const{delta:j,startPhysicalIndex:ge}=a.createRow(g,E,{source:M,mode:Q});if(j){const Ne=O.selectedRange.current(),Se=Ne==null?void 0:Ne.from,Ie=Se==null?void 0:Se.row,ye=i.toVisualRow(ge);if(O.isSelectedByCorner())i.selectAll();else if(le(Ie)&&Ie>=ye){const{row:y,col:S}=Ne.to;let T=Se.col;O.isSelectedByRowHeader()&&(T=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(i._createCellCoords(Ie+j,T),!0),O.setRangeEnd(i._createCellCoords(y+j,S))}else i._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const xe=c==="insert_col_end"?"end":"start";g=(v=g)!==null&&v!==void 0?v:xe==="end"?i.countSourceCols():0;const{delta:Re,startPhysicalIndex:Ee}=a.createCol(g,E,{source:M,mode:xe});if(Re){if(Array.isArray(C.colHeaders)){const y=[i.toVisualColumn(Ee),0];y.length+=Re,Array.prototype.splice.apply(C.colHeaders,y)}const Ne=O.selectedRange.current(),Se=Ne==null?void 0:Ne.from,Ie=Se==null?void 0:Se.col,ye=i.toVisualColumn(Ee);if(O.isSelectedByCorner())i.selectAll();else if(le(Ie)&&Ie>=ye){const{row:y,col:S}=Ne.to;let T=Se.row;O.isSelectedByColumnHeader()&&(T=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(i._createCellCoords(T,Ie+Re),!0),O.setRangeEnd(i._createCellCoords(y,S+Re))}else i._refreshBorders()}break;case"remove_row":const Y=Ne=>{let Se=0;I(Ne,Ie=>{let[ye,y]=Ie;const S=It(ye)?i.countRows()-1:Math.max(ye-Se,0);if(Number.isInteger(ye)&&(ye=Math.max(ye-Se,0)),!a.removeRow(ye,y,M))return;const V=i.countRows(),x=C.fixedRowsTop;x>=S+1&&(C.fixedRowsTop-=Math.min(y,x-S));const F=C.fixedRowsBottom;F&&S>=V-F&&(C.fixedRowsBottom-=Math.min(y,F)),Se+=y})};Array.isArray(g)?Y($(g)):Y([[g,E]]),h.adjustRowsAndCols(),i._refreshBorders();break;case"remove_col":const Ye=Ne=>{let Se=0;I(Ne,Ie=>{let[ye,y]=Ie;const S=It(ye)?i.countCols()-1:Math.max(ye-Se,0);let T=i.toPhysicalColumn(S);if(Number.isInteger(ye)&&(ye=Math.max(ye-Se,0)),!a.removeCol(ye,y,M))return;const x=C.fixedColumnsStart;x>=S+1&&(C.fixedColumnsStart-=Math.min(y,x-S)),Array.isArray(C.colHeaders)&&(typeof T>"u"&&(T=-1),C.colHeaders.splice(T,y)),Se+=y})};Array.isArray(g)?Ye($(g)):Ye([[g,E]]),h.adjustRowsAndCols(),i._refreshBorders();break;default:throw new Error(`There is no such action "${c}"`)}U||h.adjustRowsAndCols()},adjustRowsAndCols(){const c=C.minRows,g=C.minSpareRows,p=C.minCols,v=C.minSpareCols;if(i.countRows()===0&&i.countCols()===0&&O.deselect(),c){const E=i.countRows();E<c&&a.createRow(E,c-E,{source:"auto"})}if(g){const E=i.countEmptyRows(!0);if(E<g){const M=g-E,U=Math.min(M,C.maxRows-i.countSourceRows());a.createRow(i.countRows(),U,{source:"auto"})}}{let E;(p||v)&&(E=i.countEmptyCols(!0));let M=i.countCols();if(p&&!C.columns&&M<p){const U=p-M;E+=U,a.createCol(M,U,{source:"auto"})}if(v&&!C.columns&&i.dataType==="array"&&E<v){M=i.countCols();const U=v-E,$=Math.min(U,C.maxCols-M);a.createCol(M,$,{source:"auto"})}}if(O.isSelected()){const E=i.countRows(),M=i.countCols();I(O.selectedRange,U=>{let $=!1,K=U.from.row,Q=U.from.col,j=U.to.row,ge=U.to.col;K>E-1?(K=E-1,$=!0,j>K&&(j=K)):j>E-1&&(j=E-1,$=!0,K>j&&(K=j)),Q>M-1?(Q=M-1,$=!0,ge>Q&&(ge=Q)):ge>M-1&&(ge=M-1,$=!0,Q>ge&&(Q=ge)),$&&i.selectCell(K,Q,j,ge)})}i.view&&i.view.adjustElementsSize()},populateFromArray(c,g,p,v,E){let M,U,$,K;const Q=[],j={},ge=[],xe=c.row,Re=c.col;if(U=g.length,U===0)return!1;let Ee=0,Y=0;switch(Le(p)&&(Ee=p.col-Re+1,Y=p.row-xe+1),E){case"shift_down":const Ye=mr(g),Ne=Ye.length,Se=Math.max(Ne,Ee),Ie=i.getData().slice(xe),ye=mr(Ie).slice(Re,Re+Se);for($=0;$<Se;$+=1)if($<Ne){for(M=0,U=Ye[$].length;M<Y-U;M+=1)Ye[$].push(Ye[$][M%U]);$<ye.length?ge.push(Ye[$].concat(ye[$])):ge.push(Ye[$].concat(new Array(Ie.length).fill(null)))}else ge.push(Ye[$%Ne].concat(ye[$]));i.populateFromArray(xe,Re,mr(ge));break;case"shift_right":const y=g.length,S=Math.max(y,Y),T=i.getData().slice(xe).map(B=>B.slice(Re));for(M=0;M<S;M+=1)if(M<y){for($=0,K=g[M].length;$<Ee-K;$+=1)g[M].push(g[M][$%K]);if(M<T.length)for(let B=0;B<T[M].length;B+=1)g[M].push(T[M][B]);else g[M].push(...new Array(T[0].length).fill(null))}else g.push(g[M%U].slice(0,S).concat(T[M]));i.populateFromArray(xe,Re,g);break;case"overwrite":default:j.row=c.row,j.col=c.col;let V=0,x=0,F=!0,P;const N=function(se){let ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ce=g[se%g.length];return ue!==null?Ce[ue%Ce.length]:Ce},W=g.length,L=p?p.row-c.row+1:0;for(p?U=L:U=Math.max(W,L),M=0;M<U&&!(p&&j.row>p.row&&L>W||!C.allowInsertRow&&j.row>i.countRows()-1||j.row>=C.maxRows);M++){const B=M-V,se=N(B).length,ue=p?p.col-c.col+1:0;if(p?K=ue:K=Math.max(se,ue),j.col=c.col,P=i.getCellMeta(j.row,j.col),(v==="CopyPaste.paste"||v==="Autofill.fill")&&P.skipRowOnPaste){V+=1,j.row+=1,U+=1;continue}for(x=0,$=0;$<K&&!(p&&j.col>p.col&&ue>se||!C.allowInsertColumn&&j.col>i.countCols()-1||j.col>=C.maxCols);$++){if(P=i.getCellMeta(j.row,j.col),(v==="CopyPaste.paste"||v==="Autofill.fill")&&P.skipColumnOnPaste){x+=1,j.col+=1,K+=1;continue}if(P.readOnly&&v!=="UndoRedo.undo"){j.col+=1;continue}const Ce=$-x;let Te=N(B,Ce),Pe=i.getDataAtCell(j.row,j.col);if(Te!==null&&typeof Te=="object")if(Array.isArray(Te)&&Pe===null&&(Pe=[]),Pe===null||typeof Pe!="object")F=!1;else{const ot=Oi(Array.isArray(Pe)?Pe:Pe[0]||Pe),Be=Oi(Array.isArray(Te)?Te:Te[0]||Te);Oh(ot,Be)||Array.isArray(ot)&&Array.isArray(Be)?Te=Ut(Te):F=!1}else Pe!==null&&typeof Pe=="object"&&(F=!1);F&&Q.push([j.row,j.col,Te]),F=!0,j.col+=1}j.row+=1}i.setDataAtCell(Q,null,null,v||"populateFromArray");break}}};function G(c){const g=zb(c);Ym(g)?(i.runHooks("beforeLanguageChange",g),R.language=g,i.runHooks("afterLanguageChange",g)):Gb(c)}function z(c,g){const p=c==="className"?i.rootElement:i.table;if(d)J(p,g);else{let v=[],E=[];R[c]&&(v=Array.isArray(R[c])?R[c]:Pf(R[c])),g&&(E=Array.isArray(g)?g:Pf(g));const M=Df(v,E),U=Df(E,v);M.length&&_e(p,M),U.length&&J(p,U)}R[c]=g}this.init=function(){l.setData(C.data),i.runHooks("beforeInit"),(Dn()||lm())&&J(i.rootElement,"mobile"),this.updateSettings(C,!0),this.view=new Nk(this),u=ZD.getInstance(i,C,O),i.runHooks("init"),this.forceFullRender=!0,this.view.render(),d&&i.rootElement.offsetParent===null&&Yv(i.rootElement,()=>{i.view._wt.wtOverlays.updateLastSpreaderSize(),i.render(),i.view.adjustElementsSize()}),typeof d=="object"&&(i.runHooks("afterChange",d[0],d[1]),d=!1),i.runHooks("afterInit")};function ee(){let c=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,c=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&c===!1&&(c=!0,this.onQueueEmpty(this.valid))}}}function X(c){const g=c.replace(",",".");return isNaN(parseFloat(g))===!1?parseFloat(g):c}function q(c,g,p){if(!c.length)return;const v=i.getActiveEditor(),E=new ee;let M=!0;E.onQueueEmpty=U=>{v&&M&&v.cancelChanges(),p(U)};for(let U=c.length-1;U>=0;U--){const[$,K,,Q]=c[U],j=a.propToCol(K),ge=i.getCellMeta($,j);ge.type==="numeric"&&typeof Q=="string"&&cb(Q)&&(c[U][3]=X(Q)),i.getCellValidator(ge)&&(E.addValidatorToQueue(),i.validateCell(c[U][3],ge,function(xe,Re){return function(Ee){if(typeof Ee!="boolean")throw new Error("Validation error: result is not boolean");if(Ee===!1&&Re.allowInvalid===!1){M=!1,c.splice(xe,1),Re.valid=!0;const Y=i.getCell(Re.visualRow,Re.visualCol);Y!==null&&_e(Y,C.invalidCellClassName)}E.removeValidatorFormQueue()}}(U,ge),g))}E.checkIfQueueIsEmpty()}function oe(c,g){let p=c.length-1;if(p<0)return;for(;p>=0;p--){let E=!1;if(c[p]===null){c.splice(p,1);continue}if(!((c[p][2]===null||c[p][2]===void 0)&&(c[p][3]===null||c[p][3]===void 0))){if(C.allowInsertRow)for(;c[p][0]>i.countRows()-1;){const{delta:M}=a.createRow(void 0,void 0,{source:g});if(M===0){E=!0;break}}if(i.dataType==="array"&&(!C.columns||C.columns.length===0)&&C.allowInsertColumn)for(;a.propToCol(c[p][1])>i.countCols()-1;){const{delta:M}=a.createCol(void 0,void 0,{source:g});if(M===0){E=!0;break}}E||a.set(c[p][0],c[p][1],c[p][3])}}i.forceFullRender=!0,h.adjustRowsAndCols(),i.runHooks("beforeChangeRender",c,g),u.lockEditor(),i._refreshBorders(null),u.unlockEditor(),i.view.adjustElementsSize(),i.runHooks("afterChange",c,g||"edit");const v=i.getActiveEditor();v&&le(v.refreshValue)&&v.refreshValue()}this._createCellCoords=function(c,g){return i.view._wt.createCellCoords(c,g)},this._createCellRange=function(c,g,p){return i.view._wt.createCellRange(c,g,p)},this.validateCell=function(c,g,p,v){let E=i.getCellValidator(g);function M(U){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||g.hidden===!0){p(U);return}const K=g.visualCol,Q=g.visualRow,j=i.getCell(Q,K,!0);if(j&&j.nodeName!=="TH"){const ge=i.rowIndexMapper.getRenderableFromVisualIndex(Q),xe=i.columnIndexMapper.getRenderableFromVisualIndex(K);i.view._wt.getSetting("cellRenderer",ge,xe,j)}p(U)}Hv(E)&&(E=function(U){return function($,K){K(U.test($))}}(E)),nt(E)?(c=i.runHooks("beforeValidate",c,g.visualRow,g.prop,v),i._registerImmediate(()=>{E.call(g,c,U=>{i&&(U=i.runHooks("afterValidate",U,c,g.visualRow,g.prop,v),g.valid=U,M(U),i.runHooks("postAfterValidate",U,c,g.visualRow,g.prop,v))})})):i._registerImmediate(()=>{g.valid=!0,M(g.valid,!1)})};function ie(c,g,p){return Array.isArray(c)?c:[[c,g,p]]}function re(c,g){const p=i.getActiveEditor(),v=i.runHooks("beforeChange",c,g||"edit"),E=c.filter(M=>M!==null);return v===!1||E.length===0?(p&&p.cancelChanges(),[]):E}this.setDataAtCell=function(c,g,p,v){const E=ie(c,g,p),M=[];let U=v,$,K,Q;for($=0,K=E.length;$<K;$++){if(typeof E[$]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof E[$][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");E[$][1]>=this.countCols()?Q=E[$][1]:Q=a.colToProp(E[$][1]),M.push([E[$][0],Q,l.getAtCell(this.toPhysicalRow(E[$][0]),E[$][1]),E[$][2]])}!U&&typeof c=="object"&&(U=g);const j=re(M,v);i.runHooks("afterSetDataAtCell",j,U),q(j,U,()=>{oe(j,U)})},this.setDataAtRowProp=function(c,g,p,v){const E=ie(c,g,p),M=[];let U=v,$,K;for($=0,K=E.length;$<K;$++)M.push([E[$][0],E[$][1],l.getAtCell(this.toPhysicalRow(E[$][0]),E[$][1]),E[$][2]]);!U&&typeof c=="object"&&(U=g);const Q=re(M,v);i.runHooks("afterSetDataAtRowProp",Q,U),q(Q,U,()=>{oe(Q,U)})},this.listen=function(){i&&!i.isListening()&&(id=i.guid,i.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(id=null,i.runHooks("afterUnlisten"))},this.isListening=function(){return id===i.guid},this.destroyEditor=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;i._refreshBorders(c,g)},this.populateFromArray=function(c,g,p,v,E,M,U){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const $=typeof v=="number"?i._createCellCoords(v,E):null;return h.populateFromArray(i._createCellCoords(c,g),p,$,M,U)},this.spliceCol=function(c,g,p){for(var v=arguments.length,E=new Array(v>3?v-3:0),M=3;M<v;M++)E[M-3]=arguments[M];return a.spliceCol(c,g,p,...E)},this.spliceRow=function(c,g,p){for(var v=arguments.length,E=new Array(v>3?v-3:0),M=3;M<v;M++)E[M-3]=arguments[M];return a.spliceRow(c,g,p,...E)},this.getSelected=function(){if(O.isSelected())return ke(O.getSelectedRange(),c=>{let{from:g,to:p}=c;return[g.row,g.col,p.row,p.col]})},this.getSelectedLast=function(){const c=this.getSelected();let g;return c&&c.length>0&&(g=c[c.length-1]),g},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){const c=this.getSelectedRange();let g;return c&&c.length>0&&(g=c[c.length-1]),g},this.emptySelectedCells=function(c){if(!O.isSelected()||this.countRows()===0||this.countCols()===0)return;const g=[];I(O.getSelectedRange(),p=>{const v=p.getTopStartCorner(),E=p.getBottomEndCorner();me(v.row,E.row,M=>{me(v.col,E.col,U=>{this.getCellMeta(M,U).readOnly||g.push([M,U,null])})})}),g.length>0&&this.setDataAtCell(g,c)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const c=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(c,0),!this.isRenderSuspended()&&c===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(u.lockEditor(),this._refreshBorders(null),u.unlockEditor()))},this.batchRender=function(c){this.suspendRender();const g=c();return this.resumeRender(),g},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const g=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(g,0),(!this.isExecutionSuspended()&&g===this.executionSuspendedCounter||c)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(c){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=c();return this.resumeExecution(g),p},this.batch=function(c){this.suspendRender(),this.suspendExecution();const g=c();return this.resumeExecution(),this.resumeRender(),g},this.refreshDimensions=function(){if(!i.view)return;const{width:c,height:g}=i.view.getLastSize(),{width:p,height:v}=i.rootElement.getBoundingClientRect(),E=p!==c||v!==g;i.runHooks("beforeRefreshDimensions",{width:c,height:g},{width:p,height:v},E)!==!1&&((E||i.view._wt.wtOverlays.scrollableElement===i.rootWindow)&&(i.view.setLastSize(p,v),i.render()),i.runHooks("afterRefreshDimensions",{width:c,height:g},{width:p,height:v},E))},this.updateData=function(c,g){vC(c,p=>{a=p},p=>{a=p,i.columnIndexMapper.fitToLength(this.getInitialColumnCount()),i.rowIndexMapper.fitToLength(this.countSourceRows()),h.adjustRowsAndCols()},{hotInstance:i,dataMap:a,dataSource:l,internalSource:"updateData",source:g,metaManager:w,firstRun:d})},this.loadData=function(c,g){vC(c,p=>{a=p},()=>{w.clearCellsCache(),i.initIndexMappers(),h.adjustRowsAndCols(),d&&(d=[null,"loadData"])},{hotInstance:i,dataMap:a,dataSource:l,internalSource:"loadData",source:g,metaManager:w,firstRun:d})},this.getInitialColumnCount=function(){const c=C.columns;let g=0;if(Array.isArray(c))g=c.length;else if(nt(c))if(i.dataType==="array"){const p=this.countSourceCols();for(let v=0;v<p;v+=1)c(v)&&(g+=1)}else(i.dataType==="object"||i.dataType==="function")&&(g=a.colToPropCache.length);else if(le(C.dataSchema)){const p=a.getSchema();g=Array.isArray(p)?p.length:Ih(p)}else g=this.countSourceCols();return g},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(c,g,p,v){return st(c)?a.getAll():a.getRange(i._createCellCoords(c,g),i._createCellCoords(p,v),a.DESTINATION_RENDERER)},this.getCopyableText=function(c,g,p,v){return a.getCopyableText(i._createCellCoords(c,g),i._createCellCoords(p,v))},this.getCopyableData=function(c,g){return a.getCopyable(c,a.colToProp(g))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(c){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(d?i.loadData:i.updateData).bind(this);let v=!1,E,M;if(le(c.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(c.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(c.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(E in c)E==="data"||(E==="language"?G(c.language):E==="className"?z("className",c.className):E==="tableClassName"&&i.table?(z("tableClassName",c.tableClassName),i.view._wt.wtOverlays.syncOverlayTableClassNames()):ce.getSingleton().isRegistered(E)||ce.getSingleton().isDeprecated(E)?(nt(c[E])||Array.isArray(c[E]))&&(c[E].initialHook=!0,i.addHook(E,c[E])):!g&&wt(c,E)&&(R[E]=c[E]));c.data===void 0&&C.data===void 0?p(null,"updateSettings"):c.data!==void 0?p(c.data,"updateSettings"):c.columns!==void 0&&(a.createMap(),i.initIndexMappers());const U=i.countCols(),$=C.columns;if($&&nt($)&&(v=!0),(c.cell!==void 0||c.cells!==void 0||c.columns!==void 0)&&w.clearCache(),U>0)for(E=0,M=0;E<U;E++){if($){const j=v?$(E):$[M];j&&w.updateColumnMeta(M,j)}M+=1}le(c.cell)&&Fe(c.cell,j=>{i.setCellMetaObject(j.row,j.col,j)}),i.runHooks("afterCellMetaReset");let K=i.rootElement.style.height;K!==""&&(K=parseInt(i.rootElement.style.height,10));let Q=c.height;if(nt(Q)&&(Q=Q()),g&&i.rootElement.getAttribute("style")&&i.rootElement.setAttribute("data-initialstyle",i.rootElement.getAttribute("style")),Q===null){const j=i.rootElement.getAttribute("data-initialstyle");j&&(j.indexOf("height")>-1||j.indexOf("overflow")>-1)?i.rootElement.setAttribute("style",j):(i.rootElement.style.height="",i.rootElement.style.overflow="")}else Q!==void 0&&(i.rootElement.style.height=isNaN(Q)?`${Q}`:`${Q}px`,i.rootElement.style.overflow="hidden");if(typeof c.width<"u"){let j=c.width;nt(j)&&(j=j()),i.rootElement.style.width=isNaN(j)?`${j}`:`${j}px`}g||(i.view&&(i.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),i.view._wt.exportSettingsAsClassNames()),i.runHooks("afterUpdateSettings",c)),h.adjustRowsAndCols(),i.view&&!d&&(i.forceFullRender=!0,u.lockEditor(),i._refreshBorders(null),i.view._wt.wtOverlays.adjustElementsSize(),u.unlockEditor()),!g&&i.view&&(K===""||Q===""||Q===void 0)&&K!==Q&&i.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const c=i.getSelectedLast();if(C.getValue){if(nt(C.getValue))return C.getValue.call(i);if(c)return i.getData()[c[0][0]][C.getValue]}else if(c)return i.getDataAtCell(c[0],c[1])},this.getSettings=function(){return C},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(c,g,p,v,E){h.alter(c,g,p,v,E)},this.getCell=function(c,g){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,v=g,E=c;if(g>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(g)))return null;v=this.columnIndexMapper.getRenderableFromVisualIndex(g)}if(c>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(c)))return null;E=this.rowIndexMapper.getRenderableFromVisualIndex(c)}return E===null||v===null?null:i.view.getCellAtCoords(i._createCellCoords(E,v),p)},this.getCoords=function(c){const g=this.view._wt.wtTable.getCoords(c);if(g===null)return null;const{row:p,col:v}=g;let E=p,M=v;return p>=0&&(E=this.rowIndexMapper.getVisualFromRenderableIndex(p)),v>=0&&(M=this.columnIndexMapper.getVisualFromRenderableIndex(v)),i._createCellCoords(E,M)},this.colToProp=function(c){return a.colToProp(c)},this.propToCol=function(c){return a.propToCol(c)},this.toVisualRow=c=>this.rowIndexMapper.getVisualFromPhysicalIndex(c),this.toVisualColumn=c=>this.columnIndexMapper.getVisualFromPhysicalIndex(c),this.toPhysicalRow=c=>this.rowIndexMapper.getPhysicalFromVisualIndex(c),this.toPhysicalColumn=c=>this.columnIndexMapper.getPhysicalFromVisualIndex(c),this.getDataAtCell=function(c,g){return a.get(c,a.colToProp(g))},this.getDataAtRowProp=function(c,g){return a.get(c,g)},this.getDataAtCol=function(c){const g=[],p=a.getRange(i._createCellCoords(0,c),i._createCellCoords(C.data.length-1,c),a.DESTINATION_RENDERER);for(let v=0;v<p.length;v+=1)for(let E=0;E<p[v].length;E+=1)g.push(p[v][E]);return g},this.getDataAtProp=function(c){const g=[],p=a.getRange(i._createCellCoords(0,a.propToCol(c)),i._createCellCoords(C.data.length-1,a.propToCol(c)),a.DESTINATION_RENDERER);for(let v=0;v<p.length;v+=1)for(let E=0;E<p[v].length;E+=1)g.push(p[v][E]);return g},this.getSourceData=function(c,g,p,v){let E;return c===void 0?E=l.getData():E=l.getByRange(i._createCellCoords(c,g),i._createCellCoords(p,v)),E},this.getSourceDataArray=function(c,g,p,v){let E;return c===void 0?E=l.getData(!0):E=l.getByRange(i._createCellCoords(c,g),i._createCellCoords(p,v),!0),E},this.getSourceDataAtCol=function(c){return l.getAtColumn(c)},this.setSourceDataAtCell=function(c,g,p,v){const E=ie(c,g,p),M=this.hasHook("afterSetSourceDataAtCell"),U=[];M&&I(E,K=>{let[Q,j,ge]=K;U.push([Q,j,l.getAtCell(Q,j),ge])}),I(E,K=>{let[Q,j,ge]=K;l.setAtCell(Q,j,ge)}),M&&this.runHooks("afterSetSourceDataAtCell",U,v),this.render();const $=i.getActiveEditor();$&&le($.refreshValue)&&$.refreshValue()},this.getSourceDataAtRow=function(c){return l.getAtRow(c)},this.getSourceDataAtCell=function(c,g){return l.getAtCell(c,g)},this.getDataAtRow=function(c){return a.getRange(i._createCellCoords(c,0),i._createCellCoords(c,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(c,g,p,v){const E=c===void 0?[0,0,this.countRows(),this.countCols()]:[c,g,p,v],[M,U]=E;let[,,$,K]=E,Q=null,j=null;$===void 0&&($=M),K===void 0&&(K=U);let ge="mixed";return me(Math.max(Math.min(M,$),0),Math.max(M,$),xe=>{let Re=!0;return me(Math.max(Math.min(U,K),0),Math.max(U,K),Ee=>(j=this.getCellMeta(xe,Ee).type,Q?Re=Q===j:Q=j,Re)),ge=Re?j:"mixed",Re}),ge},this.removeCellMeta=function(c,g,p){const[v,E]=[this.toPhysicalRow(c),this.toPhysicalColumn(g)];let M=w.getCellMetaKeyValue(v,E,p);i.runHooks("beforeRemoveCellMeta",c,g,p,M)!==!1&&(w.removeCellMeta(v,E,p),i.runHooks("afterRemoveCellMeta",c,g,p,M)),M=null},this.spliceCellsMeta=function(c){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,v=new Array(p>2?p-2:0),E=2;E<p;E++)v[E-2]=arguments[E];if(v.length>0&&!Array.isArray(v[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&w.removeRow(this.toPhysicalRow(c),g),v.length>0&&I(v.reverse(),M=>{w.createRow(this.toPhysicalRow(c)),I(M,(U,$)=>this.setCellMetaObject(c,$,U))}),i.render()},this.setCellMetaObject=function(c,g,p){typeof p=="object"&&Fe(p,(v,E)=>{this.setCellMeta(c,g,E,v)})},this.setCellMeta=function(c,g,p,v){if(i.runHooks("beforeSetCellMeta",c,g,p,v)===!1)return;let M=c,U=g;c<this.countRows()&&(M=this.toPhysicalRow(c)),g<this.countCols()&&(U=this.toPhysicalColumn(g)),w.setCellMeta(M,U,p,v),i.runHooks("afterSetCellMeta",c,g,p,v)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(c,g){let p=this.toPhysicalRow(c),v=this.toPhysicalColumn(g);return p===null&&(p=c),v===null&&(v=g),w.getCellMeta(p,v,{visualRow:c,visualColumn:g})},this.getCellMetaAtRow=function(c){return w.getCellsMetaAtRow(c)},this.isColumnModificationAllowed=function(){return!(i.dataType==="object"||C.columns)},this.getCellRenderer=function(c,g){const p=typeof c=="number"?i.getCellMeta(c,g).renderer:c.renderer;return typeof p=="string"?Gl(p):st(p)?Gl("text"):p},this.getCellEditor=function(c,g){const p=typeof c=="number"?i.getCellMeta(c,g).editor:c.editor;return typeof p=="string"?Yl(p):st(p)?Yl("text"):p},this.getCellValidator=function(c,g){const p=typeof c=="number"?i.getCellMeta(c,g).validator:c.validator;return typeof p=="string"?gm(p):p},this.validateCells=function(c){this._validateCells(c)},this.validateRows=function(c,g){if(!Array.isArray(c))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(g,c)},this.validateColumns=function(c,g){if(!Array.isArray(c))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(g,void 0,c)},this._validateCells=function(c,g,p){const v=new ee;c&&(v.onQueueEmpty=c);let E=i.countRows()-1;for(;E>=0;){if(g!==void 0&&g.indexOf(E)===-1){E-=1;continue}let M=i.countCols()-1;for(;M>=0;){if(p!==void 0&&p.indexOf(M)===-1){M-=1;continue}v.addValidatorToQueue(),i.validateCell(i.getDataAtCell(E,M),i.getCellMeta(E,M),U=>{if(typeof U!="boolean")throw new Error("Validation error: result is not boolean");U===!1&&(v.valid=!1),v.removeValidatorFormQueue()},"validateCells"),M-=1}E-=1}v.checkIfQueueIsEmpty()},this.getRowHeader=function(c){let g=C.rowHeaders,p=c;return p!==void 0&&(p=i.runHooks("modifyRowHeader",p)),p===void 0?(g=[],me(i.countRows()-1,v=>{g.push(i.getRowHeader(v))})):Array.isArray(g)&&g[p]!==void 0?g=g[p]:nt(g)?g=g(p):g&&typeof g!="string"&&typeof g!="number"&&(g=p+1),g},this.hasRowHeaders=function(){return!!C.rowHeaders},this.hasColHeaders=function(){if(C.colHeaders!==void 0&&C.colHeaders!==null)return!!C.colHeaders;for(let c=0,g=i.countCols();c<g;c++)if(i.getColHeader(c))return!0;return!1},this.getColHeader=function(c){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=i.runHooks("modifyColHeader",c);if(p===void 0){const $=[],K=i.countCols();for(let Q=0;Q<K;Q++)$.push(i.getColHeader(Q));return $}let v=C.colHeaders;const E=function($){const K=[],Q=i.countCols();let j=0;for(;j<Q;j++)nt(C.columns)&&C.columns(j)&&K.push(j);return K[$]},M=i.toPhysicalColumn(p),U=E(M);return C.colHeaders===!1?v=null:C.columns&&nt(C.columns)&&C.columns(U)&&C.columns(U).title?v=C.columns(U).title:C.columns&&C.columns[M]&&C.columns[M].title?v=C.columns[M].title:Array.isArray(C.colHeaders)&&C.colHeaders[M]!==void 0?v=C.colHeaders[M]:nt(C.colHeaders)?v=C.colHeaders(M):C.colHeaders&&typeof C.colHeaders!="string"&&typeof C.colHeaders!="number"&&(v=Dh(p)),v=i.runHooks("modifyColumnHeaderValue",v,c,g),v},this._getColWidthFromSettings=function(c){let g;if(c>=0&&(g=i.getCellMeta(0,c).width),(g===void 0||g===C.width)&&(g=C.colWidths),g!=null){switch(typeof g){case"object":g=g[c];break;case"function":g=g(c);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getColWidth=function(c){let g=i._getColWidthFromSettings(c);return g=i.runHooks("modifyColWidth",g,c),g===void 0&&(g=pm.DEFAULT_WIDTH),g},this._getRowHeightFromSettings=function(c){let g=C.rowHeights;if(g!=null){switch(typeof g){case"object":g=g[c];break;case"function":g=g(c);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getRowHeight=function(c){let g=i._getRowHeightFromSettings(c);return g=i.runHooks("modifyRowHeight",g,c),g},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const c=C.maxCols,g=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(c,g)},this.countRenderedRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return i.view._wt.drawn?i.view._wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return zl(i.countRows()-1,p=>{if(i.isEmptyRow(p))g+=1;else if(c===!0)return!1}),g},this.countEmptyCols=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return zl(i.countCols()-1,p=>{if(i.isEmptyCol(p))g+=1;else if(c===!0)return!1}),g},this.isEmptyRow=function(c){return C.isEmptyRow.call(i,c)},this.isEmptyCol=function(c){return C.isEmptyCol.call(i,c)},this.selectCell=function(c,g,p,v){let E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,M=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return st(c)||st(g)?!1:this.selectCells([[c,g,p,v]],E,M)},this.selectCells=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g===!1&&(o=!0);const v=O.selectCells(c);return v&&p&&i.listen(),o=!1,v},this.selectColumns=function(c){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c;return O.selectColumns(c,g)},this.selectRows=function(c){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c;return O.selectRows(c,g)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const g=c&&this.hasRowHeaders(),p=c&&this.hasColHeaders();o=!0,O.selectAll(g,p),o=!1};const pe=(c,g)=>c.getNearestNotHiddenIndex(g,1,!0);this.scrollViewportTo=function(c,g){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;const M=!p,U=!v;let $=c,K=g;if(E){const ge=Number.isInteger(c),xe=Number.isInteger(g),Re=ge?pe(this.rowIndexMapper,c):void 0,Ee=xe?pe(this.columnIndexMapper,g):void 0;if(Re===null||Ee===null)return!1;$=ge?i.rowIndexMapper.getRenderableFromVisualIndex(Re):void 0,K=xe?i.columnIndexMapper.getRenderableFromVisualIndex(Ee):void 0}const Q=Number.isInteger($),j=Number.isInteger(K);return Q&&j?i.view.scrollViewport(i._createCellCoords($,K),M,v,p,U):Q&&j===!1?i.view.scrollViewportVertically($,M,p):j&&Q===!1?i.view.scrollViewportHorizontally(K,v,U):!1},this.destroy=function(){if(i._clearTimeouts(),i._clearImmediates(),i.view&&i.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),w.clearCache(),Xf(i)){const c=this.rootDocument.querySelector(".hot-display-license-info");c&&c.parentNode.removeChild(c)}Ln(i.rootElement),r.destroy(),u&&u.destroy(),i.batchExecution(()=>{i.rowIndexMapper.unregisterAll(),i.columnIndexMapper.unregisterAll(),H.getItems().forEach(c=>{let[,g]=c;g.destroy()}),H.clear(),i.runHooks("afterDestroy")},!0),ce.getSingleton().destroy(i),Fe(i,(c,g,p)=>{nt(c)?p[g]=Me(g):g!=="guid"&&(p[g]=null)}),i.isDestroyed=!0,a&&a.destroy(),a=null,h=null,O=null,u=null,i=null};function Me(c){return()=>{throw new Error(`The "${c}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(c){const g=Bt(c);return g==="UndoRedo"?this.undoRedo:H.getItem(g)},this.getPluginName=function(c){return c===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:H.getId(c)},this.getInstance=function(){return i},this.addHook=function(c,g){ce.getSingleton().add(c,g,i)},this.hasHook=function(c){return ce.getSingleton().has(c,i)||ce.getSingleton().has(c)},this.addHookOnce=function(c,g){ce.getSingleton().once(c,g,i)},this.removeHook=function(c,g){ce.getSingleton().remove(c,g,i)},this.runHooks=function(c,g,p,v,E,M,U){return ce.getSingleton().run(i,c,g,p,v,E,M,U)},this.getTranslatedPhrase=function(c,g){return Zb(C.language,c,g)},this.toHTML=()=>Wf(this),this.toTableElement=()=>{const c=this.rootDocument.createElement("div");return c.insertAdjacentHTML("afterbegin",Wf(this)),c.firstElementChild},this.timeouts=[],this._registerTimeout=function(c){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=c;typeof p=="function"&&(p=setTimeout(p,g)),this.timeouts.push(p)},this._clearTimeouts=function(){I(this.timeouts,c=>{clearTimeout(c)})},this.immediates=[],this._registerImmediate=function(c){this.immediates.push(setImmediate(c))},this._clearImmediates=function(){I(this.immediates,c=>{clearImmediate(c)})},this._refreshBorders=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;u.destroyEditor(c),i.view.render(),g&&O.isSelected()&&u.prepareEditor()},this.isRtl=function(){return i.rootWindow.getComputedStyle(i.rootElement).direction==="rtl"},this.isLtr=function(){return!i.isRtl()},this.getDirectionFactor=function(){return i.isLtr()?1:-1};const ze=uF({handleEvent(c){const g=i.isListening(),p=(c==null?void 0:c.key)!==void 0;return g&&p},beforeKeyDown:c=>this.runHooks("beforeKeyDown",c),afterKeyDown:c=>{this.isDestroyed||i.runHooks("afterDocumentKeyDown",c)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",c=>{c.ctrlKey===!1&&c.metaKey===!1&&ze.releasePressedKeys()}),this.getShortcutManager=function(){return ze};const Ae=ze.addContext("grid"),b={runOnlyIf:()=>le(i.getSelected())&&i.countRenderedRows()>0&&i.countRenderedCols()>0,group:cF};ze.setActiveContextName("grid"),Ae.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>{i.selectAll()}},{keys:[["Control/Meta","Enter"]],callback:()=>{const c=i.getSelectedRange(),{row:g,col:p}=c[c.length-1].highlight,v=i.getDataAtCell(g,p),E=new Map;for(let M=0;M<c.length;M++)c[M].forAll((U,$)=>{if(U>=0&&$>=0&&(U!==g||$!==p)){const{readOnly:K}=i.getCellMeta(U,$);K||E.set(`${U}x${$}`,[U,$,v])}});i.setDataAtCell(Array.from(E.values()))},runOnlyIf:()=>i.getSelectedRangeLast().getCellsCount()>1},{keys:[["ArrowUp"]],callback:()=>{O.transformStart(-1,0)}},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>{O.setRangeStart(i._createCellCoords(i.rowIndexMapper.getNearestNotHiddenIndex(0,1),i.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowUp","Shift"]],callback:()=>{O.transformEnd(-1,0)}},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:c,to:g}=i.getSelectedRangeLast(),p=i.rowIndexMapper.getNearestNotHiddenIndex(0,1);O.setRangeStart(c.clone()),O.setRangeEnd(i._createCellCoords(p,g.col))},runOnlyIf:()=>!(i.selection.isSelectedByCorner()||i.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>{O.transformStart(1,0)}},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>{O.setRangeStart(i._createCellCoords(i.rowIndexMapper.getNearestNotHiddenIndex(i.countRows()-1,-1),i.getSelectedRangeLast().highlight.col))}},{keys:[["ArrowDown","Shift"]],callback:()=>{O.transformEnd(1,0)}},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:c,to:g}=i.getSelectedRangeLast(),p=i.rowIndexMapper.getNearestNotHiddenIndex(i.countRows()-1,-1);O.setRangeStart(c.clone()),O.setRangeEnd(i._createCellCoords(p,g.col))},runOnlyIf:()=>!(i.selection.isSelectedByCorner()||i.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>{O.transformStart(0,-1*i.getDirectionFactor())}},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>{const c=i.getSelectedRangeLast().highlight.row,g=i.columnIndexMapper.getNearestNotHiddenIndex(...i.isRtl()?[i.countCols()-1,-1]:[0,1]);O.setRangeStart(i._createCellCoords(c,g))}},{keys:[["ArrowLeft","Shift"]],callback:()=>{O.transformEnd(0,-1*i.getDirectionFactor())}},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:c,to:g}=i.getSelectedRangeLast(),p=i.columnIndexMapper.getNearestNotHiddenIndex(...i.isRtl()?[i.countCols()-1,-1]:[0,1]);O.setRangeStart(c.clone()),O.setRangeEnd(i._createCellCoords(g.row,p))},runOnlyIf:()=>!(i.selection.isSelectedByCorner()||i.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>{O.transformStart(0,i.getDirectionFactor())}},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>{const c=i.getSelectedRangeLast().highlight.row,g=i.columnIndexMapper.getNearestNotHiddenIndex(...i.isRtl()?[0,1]:[i.countCols()-1,-1]);O.setRangeStart(i._createCellCoords(c,g))}},{keys:[["ArrowRight","Shift"]],callback:()=>{O.transformEnd(0,i.getDirectionFactor())}},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>{const{from:c,to:g}=i.getSelectedRangeLast(),p=i.columnIndexMapper.getNearestNotHiddenIndex(...i.isRtl()?[0,1]:[i.countCols()-1,-1]);O.setRangeStart(c.clone()),O.setRangeEnd(i._createCellCoords(g.row,p))},runOnlyIf:()=>!(i.selection.isSelectedByCorner()||i.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>{const c=parseInt(i.getSettings().fixedColumnsStart,10),g=i.getSelectedRangeLast().highlight.row,p=i.columnIndexMapper.getNearestNotHiddenIndex(c,1);O.setRangeStart(i._createCellCoords(g,p))},runOnlyIf:()=>i.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>{O.setRangeEnd(i._createCellCoords(O.selectedRange.current().from.row,i.columnIndexMapper.getNearestNotHiddenIndex(0,1)))}},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>{const c=parseInt(i.getSettings().fixedRowsTop,10),g=parseInt(i.getSettings().fixedColumnsStart,10),p=i.rowIndexMapper.getNearestNotHiddenIndex(c,1),v=i.columnIndexMapper.getNearestNotHiddenIndex(g,1);O.setRangeStart(i._createCellCoords(p,v))},runOnlyIf:()=>i.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>{O.setRangeStart(i._createCellCoords(i.getSelectedRangeLast().highlight.row,i.columnIndexMapper.getNearestNotHiddenIndex(i.countCols()-1,-1)))},runOnlyIf:()=>i.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>{O.setRangeEnd(i._createCellCoords(O.selectedRange.current().from.row,i.columnIndexMapper.getNearestNotHiddenIndex(i.countCols()-1,-1)))}},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>{const c=parseInt(i.getSettings().fixedRowsBottom,10),g=i.rowIndexMapper.getNearestNotHiddenIndex(i.countRows()-c-1,-1),p=i.columnIndexMapper.getNearestNotHiddenIndex(i.countCols()-1,-1);O.setRangeStart(i._createCellCoords(g,p))},runOnlyIf:()=>i.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>{O.transformStart(-i.countVisibleRows(),0)}},{keys:[["PageUp","Shift"]],callback:()=>{const{to:c}=i.getSelectedRangeLast(),g=Math.max(c.row-i.countVisibleRows(),0),p=i.rowIndexMapper.getNearestNotHiddenIndex(g,1);if(p!==null){const v=i._createCellCoords(p,c.col),E=c.row-i.view.getFirstFullyVisibleRow(),M=Math.max(v.row-E,0);O.setRangeEnd(v),i.scrollViewportTo(M)}}},{keys:[["PageDown"]],callback:()=>{O.transformStart(i.countVisibleRows(),0)}},{keys:[["PageDown","Shift"]],callback:()=>{const{to:c}=i.getSelectedRangeLast(),g=Math.min(c.row+i.countVisibleRows(),i.countRows()-1),p=i.rowIndexMapper.getNearestNotHiddenIndex(g,-1);if(p!==null){const v=i._createCellCoords(p,c.col),E=c.row-i.view.getFirstFullyVisibleRow(),M=Math.min(v.row-E,i.countRows()-1);O.setRangeEnd(v),i.scrollViewportTo(M)}}},{keys:[["Tab"]],callback:c=>{const g=typeof C.tabMoves=="function"?C.tabMoves(c):C.tabMoves;O.transformStart(g.row,g.col,!0)}},{keys:[["Shift","Tab"]],callback:c=>{const g=typeof C.tabMoves=="function"?C.tabMoves(c):C.tabMoves;O.transformStart(-g.row,-g.col)}}],b),fm().forEach(c=>{const g=ta(c);H.addItem(c,new g(this))}),ce.getSingleton().run(i,"construct")}const dF="hooksRefRegisterer",oR={_hooksStorage:Object.create(null),addHook(s,e){return this._hooksStorage[s]||(this._hooksStorage[s]=[]),this.hot.addHook(s,e),this._hooksStorage[s].push(e),this},removeHooksByKey(s){I(this._hooksStorage[s]||[],e=>{this.hot.removeHook(s,e)})},clearHooks(){Fe(this._hooksStorage,(s,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};rs(oR,"MIXIN_NAME",dF,{writable:!1,enumerable:!1});const fF=oR,gF="base",Dt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),ng="baseEditor";class Vi{static get EDITOR_TYPE(){return gF}constructor(e){this.hot=e,this.instance=e,this.state=Dt.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,n,o,i,r){this.TD=o,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=r,this.state=Dt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let n,o,i,r;if(t){const d=this.hot.getSelectedLast();n=Math.max(Math.min(d[0],d[2]),0),o=Math.max(Math.min(d[1],d[3]),0),i=Math.max(d[0],d[2]),r=Math.max(d[1],d[3])}else[n,o,i,r]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,o);Array.isArray(a)&&([n,o]=a);const h=this.hot.getShortcutManager().getContext("editor"),u={runOnlyIf:()=>le(this.hot.getSelected()),group:ng};this.isInFullEditMode()&&h.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],u),this.hot.populateFromArray(n,o,e,i,r,"edit")}beginEditing(e,t){if(this.state!==Dt.VIRGIN)return;const n=this.hot,o=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(o,i)),this.state=Dt.EDITING,this.isInFullEditMode()){const r=typeof e=="string"?e:Ct(this.originalValue);this.setValue(r)}this.open(t),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,n){let o;if(n){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),n(l),this.hot.view.render()}}if(this.isWaiting())return;const r=this.hot.getShortcutManager().getContext("editor");if(r.removeShortcutsByGroup(ng),r.removeShortcutsByGroup(Ah),this.state===Dt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Dt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:o=[[a]],this.state=Dt.WAITING,this.saveValue(o,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Dt.FINISHED,this.discardEditor(l)}):(this.state=Dt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Dt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Dt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Dt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Dt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Dt.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:n,wtViewport:o}=this.hot.view._wt,i=this.hot.rootWindow,r=Tt(t),a=Qe(t),l=Tt(this.hot.rootElement),h=Qe(this.hot.rootElement),u=n.topOverlay.holder,d=n.inlineStartOverlay.holder,f=u!==i?u.scrollTop:0,m=d!==i?d.scrollLeft:0,w=i.innerWidth-l.left-h,{wtTable:C}=(e=n.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,R=C.name,H=["master","inline_start"].includes(R)?f:0,A=["master","top","bottom"].includes(R)?m:0,_=r.top===l.top?0:1;let O=r.top-l.top-_-H,D=0;this.hot.isRtl()?D=i.innerWidth-r.left-a-w-1+A:D=r.left-l.left-1-A,["top","top_inline_start_corner"].includes(R)&&(O+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(R)&&(D+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const G=this.hot.hasColHeaders(),z=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ee=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),q=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(G&&z<=0||z===q)&&(O+=1),ee<=0&&(D+=1);const oe=o.rowsRenderCalculator.startPosition,ie=o.columnsRenderCalculator.startPosition,re=Math.abs(n.inlineStartOverlay.getScrollPosition()),pe=n.topOverlay.getScrollPosition(),Me=xt(this.hot.rootDocument),ze=t.offsetTop+oe-pe;let Ae=0;if(this.hot.isRtl()){const Q=t.offsetLeft;Q>=0?Ae=C.getWidth()-t.offsetLeft:Ae=Math.abs(Q),Ae+=ie-re-a}else Ae=t.offsetLeft+ie-re;const b=eo(this.TD,this.hot.rootWindow),c=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",g=parseInt(b[c],10)>0?0:1,p=parseInt(b.borderTopWidth,10)>0?0:1,v=Qe(t)+g,E=dt(t)+p,M=Wv(u)?Me:0,U=Bv(d)?Me:0,$=this.hot.view.maximumVisibleElementWidth(Ae)-M+g,K=Math.max(this.hot.view.maximumVisibleElementHeight(ze)-U+p,23);return{top:O,start:D,height:E,maxHeight:K,width:v,maxWidth:$}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}tt(Vi,fF);function mF(){var s={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,t=document.body,n=document.createTextNode(""),o=document.createElement("SPAN"),i=function(f,m,w){f.addEventListener(m,w,!1)},r=function(f,m,w){f.removeEventListener(m,w,!1)},a=function(f){var m,w;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",n.textContent!==void 0?n.textContent=e.value+f:n.data=e.value+f,o.style.position="absolute",o.style.fontSize=d(e).fontSize,o.style.fontFamily=d(e).fontFamily,o.style.whiteSpace="pre",t.appendChild(o),m=o.clientWidth+2,t.removeChild(o),e.style.height=s.minHeight+"px",s.minWidth>m?e.style.width=s.minWidth+"px":m>s.maxWidth?e.style.width=s.maxWidth+"px":e.style.width=m+"px",w=e.scrollHeight?e.scrollHeight-1:0,s.minHeight>w?e.style.height=s.minHeight+"px":s.maxHeight<w?(e.style.height=s.maxHeight+"px",e.style.overflowY="visible"):e.style.height=w+"px"},l=function(){window.setTimeout(a,0)},h=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")s.minHeight=e.clientHeight;else{var m=parseInt(f.minHeight);isNaN(m)||(s.minHeight=m)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")s.maxHeight=e.clientHeight;else{var w=parseInt(f.maxHeight);isNaN(w)||(s.maxHeight=w)}if(f&&f.minWidth)if(f.minWidth=="inherit")s.minWidth=e.clientWidth;else{var C=parseInt(f.minWidth);isNaN(C)||(s.minWidth=C)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")s.maxWidth=e.clientWidth;else{var R=parseInt(f.maxWidth);isNaN(R)||(s.maxWidth=R)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))},u=function(f,m,w){e=f,h(m),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=s.minHeight+"px",e.style.minWidth=s.minWidth+"px",e.style.maxWidth=s.maxWidth+"px",e.style.overflowY="hidden"),w&&(i(e,"change",a),i(e,"cut",l),i(e,"paste",l),i(e,"drop",l),i(e,"keydown",l),i(e,"focus",a),i(e,"compositionstart",l),i(e,"compositionupdate",l),i(e,"compositionend",l)),a()};function d(f){return f.currentStyle||document.defaultView.getComputedStyle(f)}return{init:function(f,m,w){u(f,m,w)},unObserve:function(){r(e,"change",a),r(e,"cut",l),r(e,"paste",l),r(e,"drop",l),r(e,"keydown",l),r(e,"focus",a),r(e,"compositionstart",l),r(e,"compositionupdate",l),r(e,"compositionend",l)},resize:a}}function EC(s,e){const t=nm(e),n=e.value.split(`
`);let o=t,i=0;for(let r=0;r<n.length;r++){const a=n[r];r!==0&&(i+=n[r-1].length+1);const l=i+a.length;if(s==="home"?o=i:s==="end"&&(o=l),t<=l)break}Zr(e,o)}const pF="ht_editor_visible",ka="ht_editor_hidden",TC="textEditor",wF="text";class Bo extends Vi{static get EDITOR_TYPE(){return wF}constructor(e){super(e),this.eventManager=new ft(this),this.autoResize=mF(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",t=>this.onAfterDocumentKeyDown(t)),this.registerShortcuts()}close(){this.autoResize.unObserve(),this.hot.rootDocument.activeElement===this.TEXTAREA&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,t,n,o,i,r){const a=this.state;if(super.prepare(e,t,n,o,i,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:l,fragmentSelection:h}=r;l&&(this.TEXTAREA.value=""),a!==Dt.FINISHED&&this.hideEditableElement(),!h&&!Dn()&&this.focus()}}beginEditing(e,t){this.state===Dt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Zr(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.tabIndex=-1,J(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),J(this.TEXTAREA_PARENT,"handsontableInputHolder"),Oe(this.TEXTAREA_PARENT,this.layerClass)&&_e(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,ka),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){nb()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",_e(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,ka)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;me(e.length-1,n=>{const o=e[n];if(Oe(o,"handsontableEditor"))return t=!0,!1}),Oe(this.TEXTAREA_PARENT,ka)&&_e(this.TEXTAREA_PARENT,ka),t?(this.layerClass=pF,J(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),J(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Dt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:n,width:o,maxWidth:i,height:r,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=eo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const h=eo(this.TEXTAREA),u=parseInt(h.paddingLeft,10)+parseInt(h.paddingRight,10),d=parseInt(h.paddingTop,10)+parseInt(h.paddingBottom,10),f=o-u,m=r-d,w=i-u,C=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,w),minHeight:Math.min(m,C),maxWidth:w,maxHeight:C},!0)}bindEvents(){this.eventManager.addEventListener(this.TEXTAREA,"cut",e=>e.stopPropagation()),this.eventManager.addEventListener(this.TEXTAREA,"paste",e=>e.stopPropagation()),am()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>le(this.hot.getSelected()),group:TC},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Tab"]],callback:i=>{const r=this.hot.getSettings(),a=typeof r.tabMoves=="function"?r.tabMoves(i):r.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:i=>{const r=this.hot.getSettings(),a=typeof r.tabMoves=="function"?r.tabMoves(i):r.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:i=>!this.hot.selection.isMultiple()&&!i.altKey,relativeToGroup:yr,position:"before"},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple(),relativeToGroup:yr,position:"before"},{keys:[["Alt","Enter"]],callback:()=>(o(),!1),relativeToGroup:yr,position:"before"},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(i,r)=>{let[a]=r;EC(a,this.TEXTAREA)}},{keys:[["End"]],callback:(i,r)=>{let[a]=r;EC(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],n)}unregisterShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(Ah),t.removeShortcutsByGroup(TC),t.removeShortcutsByGroup(ng)}onAfterDocumentKeyDown(e){[de.ARROW_UP,de.ARROW_RIGHT,de.ARROW_DOWN,de.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const CF="base";function la(s,e,t,n,o,i,r){const a=[],l=[];r.className&&J(e,r.className),r.readOnly&&a.push(r.readOnlyCellClassName),r.valid===!1&&r.invalidCellClassName?a.push(r.invalidCellClassName):l.push(r.invalidCellClassName),r.wordWrap===!1&&r.noWordWrapClassName&&a.push(r.noWordWrapClassName),!i&&r.placeholder&&a.push(r.placeholderCellClassName),_e(e,l),J(e,a)}la.RENDERER_TYPE=CF;const yF="text";function oo(s,e,t,n,o,i,r){la.apply(this,[s,e,t,n,o,i,r]);let a=i;if(!a&&r.placeholder&&(a=r.placeholder),a=Ct(a),r.trimWhitespace&&(a=a.trim()),r.rendererTemplate){Ln(e);const l=s.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=r.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=s.getSourceDataAtRow(t),e.appendChild(l)}else Js(e,a)}oo.RENDERER_TYPE=yF;const SF="text",iR={CELL_TYPE:SF,editor:Bo,renderer:oo};Zt(iR);we.editors={BaseEditor:Vi};function we(s,e){const t=new Xm(s,e||{},Hm);return t.init(),t}we.Core=function(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Xm(s,e,Hm)};we.DefaultSettings=nR();we.hooks=ce.getSingleton();we.CellCoords=jl;we.CellRange=Sm;we.packageName="handsontable";we.buildDate="31/08/2023 08:23:33";we.version="13.1.0";we.languages={dictionaryKeys:gL,getLanguageDictionary:qb,getLanguagesDictionaries:yL,registerLanguageDictionary:Um,getTranslatedPhrase:Zb};const vF=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],MC="selected",OC="odd",rR=()=>["Ø¹ÙØ±","Ø¹ÙÙ","Ø¹Ø¨Ø¯ Ø§ÙÙÙ","ÙØ¹ØªØµÙ"][Math.floor(Math.random()*3)],aR=()=>["ØªØ±ÙÙØ§","ÙØµØ±","ÙØ¨ÙØ§Ù","Ø§ÙØ¹Ø±Ø§Ù"][Math.floor(Math.random()*3)],bF=()=>new Date(Math.floor(Math.random()*Date.now())).toLocaleDateString("en-gb"),IC=()=>Math.random()>.5,vr=(s=0,e=1e3)=>s+Math.floor(Math.random()*e),RF=()=>`${aR()} ${rR()} ${vr()}`,EF=()=>`${vr(1e5,999999).toString().match(/.{1,3}/g).join("-")}`;function TF(){return Array.from({length:50},()=>[IC(),rR(),aR(),RF(),bF(),EF(),IC(),vr(0,200).toString(),vr(1,10),vr(1,5)])}function Tl(){return new URLSearchParams(location.search.replace(/^\?/,"")).get("arabicExample")==="1"}function MF(){return Tl()?TF():vF}const _C="handsontableEditor",OF="handsontable";class qm extends Bo{static get EDITOR_TYPE(){return OF}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Zr(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,n,o,i,r){super.prepare(e,t,n,o,i,r);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,afterOnCellMouseDown(h,u){const d=this.getSourceData(u.row,u.col);d!==void 0&&a.setValue(d),a.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Mt(l,r.handsontable),this.htOptions=l}beginEditing(e,t){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const o=this.htEditor.getInstance().getValue();o!==void 0&&this.setValue(o)}super.finishEditing(e,t,n)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:_C,relativeToGroup:Ah,position:"before"},o=(i,r)=>{const a=this.htEditor.getInstance();if(i!==void 0&&(i<0||a.flipped&&i>a.countRows()-1?a.deselectCell():a.selectCell(i,0),a.getData().length))return r.preventDefault(),Fn(r),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:i=>{const r=this.htEditor.getInstance();let a,l;return!r.getSelectedLast()&&r.flipped?a=r.countRows()-1:r.getSelectedLast()&&(r.flipped?(l=r.getSelectedLast()[0],a=Math.max(0,l-1)):(l=r.getSelectedLast()[0],a=l-1)),o(a,i)},preventDefault:!1},{keys:[["ArrowDown"]],callback:i=>{const r=this.htEditor.getInstance();let a,l;if(!r.getSelectedLast()&&!r.flipped)a=0;else if(r.getSelectedLast()){if(r.flipped)a=r.getSelectedLast()[0]+1;else if(!r.flipped){const h=r.countRows()-1;l=r.getSelectedLast()[0],a=Math.min(h,l+1)}}return o(a,i)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(_C)}}function IF(s,e,t){return e=_F(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function _F(s){var e=AF(s,"string");return typeof e=="symbol"?e:String(e)}function AF(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}const rd=new WeakMap,xF="autocomplete";class Zm extends qm{static get EDITOR_TYPE(){return xF}constructor(e){super(e),IF(this,"sortByRelevance",function(t,n,o){const i=[],r=[],a=t.length;let l=n.length,h,u,d,f;if(a===0){for(d=0;d<l;d++)r.push(d);return r}for(d=0;d<l;d++){if(u=kf(Ct(n[d])),o)f=u.indexOf(t);else{const m=this.cellProperties.locale;f=u.toLocaleLowerCase(m).indexOf(t.toLocaleLowerCase(m))}f!==-1&&(h=u.length-f-a,i.push({baseIndex:d,index:f,charsLeft:h,value:u}))}for(i.sort((m,w)=>{if(w.index===-1)return-1;if(m.index===-1)return 1;if(m.index<w.index)return-1;if(w.index<m.index)return 1;if(m.index===w.index){if(m.charsLeft<w.charsLeft)return-1;if(m.charsLeft>w.charsLeft)return 1}return 0}),d=0,l=i.length;d<l;d++)r.push(i[d].baseIndex);return r}),this.query=null,this.strippedChoices=[],this.rawChoices=[],rd.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1})}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),J(this.htContainer,"autocompleteEditor"),J(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")}open(){const e=rd.get(this);super.open();const t=this.htEditor.getInstance(),n=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown;this.showEditableElement(),this.focus();let o=xt();o===0&&e.isMacOS&&(o+=15),this.addHook("beforeKeyDown",i=>this.onBeforeKeyDown(i)),t.updateSettings({colWidths:n?[Qe(this.TEXTAREA)-2]:void 0,width:n?Qe(this.TEXTAREA)+o:void 0,renderer:(i,r,a,l,h,u,d)=>{oo(i,r,a,l,h,u,d);const{filteringCaseSensitive:f,allowHtml:m,locale:w}=this.cellProperties,C=this.query;let R=Ct(u),H,A;R&&!m&&(H=f===!0?R.indexOf(C):R.toLocaleLowerCase(w).indexOf(C.toLocaleLowerCase(w)),H!==-1&&(A=R.substr(H,C.length),R=R.replace(A,`<strong>${A}</strong>`))),r.innerHTML=R},autoColumnSize:!0}),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close()}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=nm(this.TEXTAREA),n=Vv(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let r=null,a=null,l=e;o&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const h=Array.isArray(r)?r.length:0;if(i===!1)h&&(a=r[0]);else{const u=[];for(let d=0,f=l.length;d<f&&!(o&&h<=d);d++)h?u.push(l[r[d]]):u.push(l[d]);a=0,l=u}this.strippedChoices=l,this.htEditor.loadData(mr([l])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a),this.hot.listen(),Zr(this.TEXTAREA,t,t===n?void 0:n)}flipDropdownIfNeeded(){const e=Ao(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(t||!t&&(n||n==="horizontal"))return!1;const o=Tt(this.TEXTAREA),i=dt(this.TEXTAREA),r=this.getDropdownHeight(),a=e.scrollTop,l=dt(this.hot.view._wt.wtTable.THEAD),h=Tt(e),u=o.top-h.top-l+a,d=e.scrollHeight-u-l-i,f=r>d&&u>d;return f?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(f?u:d,r),f}limitDropdownIfNeeded(e,t){if(t>e){let n=0,o=0,i=0,r=null;do i=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=i,o+=1;while(n<e);r=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-r}px`),this.setDropdownHeight(n-i)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+xt(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,n=ke(e,i=>Ct(i));return ke(n,i=>t?i:kf(i))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),n={row:t?t.from.row:-1};let o=!1;return e===de.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(o=!0),e===de.ARROW_UP&&n.row>-1&&(o=!0),o}onBeforeKeyDown(e){const t=rd.get(this);if(t.skipOne=!1,sb(e.keyCode)||e.keyCode===de.BACKSPACE||e.keyCode===de.DELETE||e.keyCode===de.INSERT){let n=10;if(e.keyCode===de.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),t.skipOne=!0},n)}}}const HF="checkbox";class lR extends Vi{static get EDITOR_TYPE(){return HF}beginEditing(e,t){if(t&&t.type==="mouseup"){const n=this.TD.querySelector('input[type="checkbox"]');Oe(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var hR={exports:{}};const DF=K0(KH);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(s,e){(function(t,n){var o;{try{o=DF}catch{}s.exports=n(o)}})(cl,function(t){var n=typeof t=="function",o=!!window.addEventListener,i=window.document,r=window.setTimeout,a=function(b,c,g,p){o?b.addEventListener(c,g,!!p):b.attachEvent("on"+c,g)},l=function(b,c,g,p){o?b.removeEventListener(c,g,!!p):b.detachEvent("on"+c,g)},h=function(b){return b.trim?b.trim():b.replace(/^\s+|\s+$/g,"")},u=function(b,c){return(" "+b.className+" ").indexOf(" "+c+" ")!==-1},d=function(b,c){u(b,c)||(b.className=b.className===""?c:b.className+" "+c)},f=function(b,c){b.className=h((" "+b.className+" ").replace(" "+c+" "," "))},m=function(b){return/Array/.test(Object.prototype.toString.call(b))},w=function(b){return/Date/.test(Object.prototype.toString.call(b))&&!isNaN(b.getTime())},C=function(b){var c=b.getDay();return c===0||c===6},R=function(b){return b%4===0&&b%100!==0||b%400===0},H=function(b,c){return[31,R(b)?29:28,31,30,31,30,31,31,30,31,30,31][c]},A=function(b){w(b)&&b.setHours(0,0,0,0)},_=function(b,c){return b.getTime()===c.getTime()},O=function(b,c,g){var p,v;for(p in c)v=b[p]!==void 0,v&&typeof c[p]=="object"&&c[p]!==null&&c[p].nodeName===void 0?w(c[p])?g&&(b[p]=new Date(c[p].getTime())):m(c[p])?g&&(b[p]=c[p].slice(0)):b[p]=O({},c[p],g):(g||!v)&&(b[p]=c[p]);return b},D=function(b,c,g){var p;i.createEvent?(p=i.createEvent("HTMLEvents"),p.initEvent(c,!0,!1),p=O(p,g),b.dispatchEvent(p)):i.createEventObject&&(p=i.createEventObject(),p=O(p,g),b.fireEvent("on"+c,p))},G=function(b){return b.month<0&&(b.year-=Math.ceil(Math.abs(b.month)/12),b.month+=12),b.month>11&&(b.year+=Math.floor(Math.abs(b.month)/12),b.month-=12),b},z={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ee=function(b,c,g){for(c+=b.firstDay;c>=7;)c-=7;return g?b.i18n.weekdaysShort[c]:b.i18n.weekdays[c]},X=function(b){var c=[],g="false";if(b.isEmpty)if(b.showDaysInNextAndPreviousMonths)c.push("is-outside-current-month"),b.enableSelectionDaysInNextAndPreviousMonths||c.push("is-selection-disabled");else return'<td class="is-empty"></td>';return b.isDisabled&&c.push("is-disabled"),b.isToday&&c.push("is-today"),b.isSelected&&(c.push("is-selected"),g="true"),b.hasEvent&&c.push("has-event"),b.isInRange&&c.push("is-inrange"),b.isStartRange&&c.push("is-startrange"),b.isEndRange&&c.push("is-endrange"),'<td data-day="'+b.day+'" class="'+c.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+b.year+'" data-pika-month="'+b.month+'" data-pika-day="'+b.day+'">'+b.day+"</button></td>"},q=function(b,c){b.setHours(0,0,0,0);var g=b.getDate(),p=b.getDay(),v=c,E=v-1,M=7,U=function(ge){return(ge+M-1)%M};b.setDate(g+E-U(p));var $=new Date(b.getFullYear(),0,v),K=24*60*60*1e3,Q=(b.getTime()-$.getTime())/K,j=1+Math.round((Q-E+U($.getDay()))/M);return j},oe=function(b,c,g,p){var v=new Date(g,c,b),E=n?t(v).isoWeek():q(v,p);return'<td class="pika-week">'+E+"</td>"},ie=function(b,c,g,p){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(c?b.reverse():b).join("")+"</tr>"},re=function(b){return"<tbody>"+b.join("")+"</tbody>"},pe=function(b){var c,g=[];for(b.showWeekNumber&&g.push("<th></th>"),c=0;c<7;c++)g.push('<th scope="col"><abbr title="'+ee(b,c)+'">'+ee(b,c,!0)+"</abbr></th>");return"<thead><tr>"+(b.isRTL?g.reverse():g).join("")+"</tr></thead>"},Me=function(b,c,g,p,v,E){var M,U,$,K=b._o,Q=g===K.minYear,j=g===K.maxYear,ge='<div id="'+E+'" class="pika-title" role="heading" aria-live="assertive">',xe,Re,Ee=!0,Y=!0;for($=[],M=0;M<12;M++)$.push('<option value="'+(g===v?M-c:12+M-c)+'"'+(M===p?' selected="selected"':"")+(Q&&M<K.minMonth||j&&M>K.maxMonth?' disabled="disabled"':"")+">"+K.i18n.months[M]+"</option>");for(xe='<div class="pika-label">'+K.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+$.join("")+"</select></div>",m(K.yearRange)?(M=K.yearRange[0],U=K.yearRange[1]+1):(M=g-K.yearRange,U=1+g+K.yearRange),$=[];M<U&&M<=K.maxYear;M++)M>=K.minYear&&$.push('<option value="'+M+'"'+(M===g?' selected="selected"':"")+">"+M+"</option>");return Re='<div class="pika-label">'+g+K.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+$.join("")+"</select></div>",K.showMonthAfterYear?ge+=Re+xe:ge+=xe+Re,Q&&(p===0||K.minMonth>=p)&&(Ee=!1),j&&(p===11||K.maxMonth<=p)&&(Y=!1),c===0&&(ge+='<button class="pika-prev'+(Ee?"":" is-disabled")+'" type="button">'+K.i18n.previousMonth+"</button>"),c===b._o.numberOfMonths-1&&(ge+='<button class="pika-next'+(Y?"":" is-disabled")+'" type="button">'+K.i18n.nextMonth+"</button>"),ge+="</div>"},ze=function(b,c,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+pe(b)+re(c)+"</table>"},Ae=function(b){var c=this,g=c.config(b);c._onMouseDown=function(v){if(c._v){v=v||window.event;var E=v.target||v.srcElement;if(E)if(u(E,"is-disabled")||(u(E,"pika-button")&&!u(E,"is-empty")&&!u(E.parentNode,"is-disabled")?(c.setDate(new Date(E.getAttribute("data-pika-year"),E.getAttribute("data-pika-month"),E.getAttribute("data-pika-day"))),g.bound&&r(function(){c.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):u(E,"pika-prev")?c.prevMonth():u(E,"pika-next")&&c.nextMonth()),u(E,"pika-select"))c._c=!0;else if(v.preventDefault)v.preventDefault();else return v.returnValue=!1,!1}},c._onChange=function(v){v=v||window.event;var E=v.target||v.srcElement;E&&(u(E,"pika-select-month")?c.gotoMonth(E.value):u(E,"pika-select-year")&&c.gotoYear(E.value))},c._onKeyChange=function(v){if(v=v||window.event,c.isVisible())switch(v.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:c.adjustDate("subtract",1);break;case 38:c.adjustDate("subtract",7);break;case 39:c.adjustDate("add",1);break;case 40:c.adjustDate("add",7);break;case 8:case 46:c.setDate(null);break}},c._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(n){var v=t(g.field.value,g.format,g.formatStrict);return v&&v.isValid()?v.toDate():null}else return new Date(Date.parse(g.field.value))},c._onInputChange=function(v){var E;v.firedBy!==c&&(E=c._parseFieldValue(),w(E)&&c.setDate(E),c._v||c.show())},c._onInputFocus=function(){c.show()},c._onInputClick=function(){c.show()},c._onInputBlur=function(){var v=i.activeElement;do if(u(v,"pika-single"))return;while(v=v.parentNode);c._c||(c._b=r(function(){c.hide()},50)),c._c=!1},c._onClick=function(v){v=v||window.event;var E=v.target||v.srcElement,M=E;if(E){!o&&u(E,"pika-select")&&(E.onchange||(E.setAttribute("onchange","return;"),a(E,"change",c._onChange)));do if(u(M,"pika-single")||M===g.trigger)return;while(M=M.parentNode);c._v&&E!==g.trigger&&M!==g.trigger&&c.hide()}},c.el=i.createElement("div"),c.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),a(c.el,"mousedown",c._onMouseDown,!0),a(c.el,"touchend",c._onMouseDown,!0),a(c.el,"change",c._onChange),g.keyboardInput&&a(i,"keydown",c._onKeyChange),g.field&&(g.container?g.container.appendChild(c.el):g.bound?i.body.appendChild(c.el):g.field.parentNode.insertBefore(c.el,g.field.nextSibling),a(g.field,"change",c._onInputChange),g.defaultDate||(g.defaultDate=c._parseFieldValue(),g.setDefaultDate=!0));var p=g.defaultDate;w(p)?g.setDefaultDate?c.setDate(p,!0):c.gotoDate(p):c.gotoDate(new Date),g.bound?(this.hide(),c.el.className+=" is-bound",a(g.trigger,"click",c._onInputClick),a(g.trigger,"focus",c._onInputFocus),a(g.trigger,"blur",c._onInputBlur)):this.show()};return Ae.prototype={config:function(b){this._o||(this._o=O({},z,!0));var c=O(this._o,b,!0);c.isRTL=!!c.isRTL,c.field=c.field&&c.field.nodeName?c.field:null,c.theme=typeof c.theme=="string"&&c.theme?c.theme:null,c.bound=!!(c.bound!==void 0?c.field&&c.bound:c.field),c.trigger=c.trigger&&c.trigger.nodeName?c.trigger:c.field,c.disableWeekends=!!c.disableWeekends,c.disableDayFn=typeof c.disableDayFn=="function"?c.disableDayFn:null;var g=parseInt(c.numberOfMonths,10)||1;if(c.numberOfMonths=g>4?4:g,w(c.minDate)||(c.minDate=!1),w(c.maxDate)||(c.maxDate=!1),c.minDate&&c.maxDate&&c.maxDate<c.minDate&&(c.maxDate=c.minDate=!1),c.minDate&&this.setMinDate(c.minDate),c.maxDate&&this.setMaxDate(c.maxDate),m(c.yearRange)){var p=new Date().getFullYear()-10;c.yearRange[0]=parseInt(c.yearRange[0],10)||p,c.yearRange[1]=parseInt(c.yearRange[1],10)||p}else c.yearRange=Math.abs(parseInt(c.yearRange,10))||z.yearRange,c.yearRange>100&&(c.yearRange=100);return c},toString:function(b){return b=b||this._o.format,w(this._d)?this._o.toString?this._o.toString(this._d,b):n?t(this._d).format(b):this._d.toDateString():""},getMoment:function(){return n?t(this._d):null},setMoment:function(b,c){n&&t.isMoment(b)&&this.setDate(b.toDate(),c)},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(b,c){if(!b)return this._d=null,this._o.field&&(this._o.field.value="",D(this._o.field,"change",{firedBy:this})),this.draw();if(typeof b=="string"&&(b=new Date(Date.parse(b))),!!w(b)){var g=this._o.minDate,p=this._o.maxDate;w(g)&&b<g?b=g:w(p)&&b>p&&(b=p),this._d=new Date(b.getTime()),A(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),D(this._o.field,"change",{firedBy:this})),!c&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(b){var c=!0;if(w(b)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),v=b.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),c=v<g.getTime()||p.getTime()<v}c&&(this.calendars=[{month:b.getMonth(),year:b.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(b,c){var g=this.getDate()||new Date,p=parseInt(c)*24*60*60*1e3,v;b==="add"?v=new Date(g.valueOf()+p):b==="subtract"&&(v=new Date(g.valueOf()-p)),this.setDate(v)},adjustCalendars:function(){this.calendars[0]=G(this.calendars[0]);for(var b=1;b<this._o.numberOfMonths;b++)this.calendars[b]=G({month:this.calendars[0].month+b,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(b){isNaN(b)||(this.calendars[0].month=parseInt(b,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(b){isNaN(b)||(this.calendars[0].year=parseInt(b,10),this.adjustCalendars())},setMinDate:function(b){b instanceof Date?(A(b),this._o.minDate=b,this._o.minYear=b.getFullYear(),this._o.minMonth=b.getMonth()):(this._o.minDate=z.minDate,this._o.minYear=z.minYear,this._o.minMonth=z.minMonth,this._o.startRange=z.startRange),this.draw()},setMaxDate:function(b){b instanceof Date?(A(b),this._o.maxDate=b,this._o.maxYear=b.getFullYear(),this._o.maxMonth=b.getMonth()):(this._o.maxDate=z.maxDate,this._o.maxYear=z.maxYear,this._o.maxMonth=z.maxMonth,this._o.endRange=z.endRange),this.draw()},setStartRange:function(b){this._o.startRange=b},setEndRange:function(b){this._o.endRange=b},draw:function(b){if(!(!this._v&&!b)){var c=this._o,g=c.minYear,p=c.maxYear,v=c.minMonth,E=c.maxMonth,M="",U;this._y<=g&&(this._y=g,!isNaN(v)&&this._m<v&&(this._m=v)),this._y>=p&&(this._y=p,!isNaN(E)&&this._m>E&&(this._m=E));for(var $=0;$<c.numberOfMonths;$++)U="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),M+='<div class="pika-lendar">'+Me(this,$,this.calendars[$].year,this.calendars[$].month,this.calendars[0].year,U)+this.render(this.calendars[$].year,this.calendars[$].month,U)+"</div>";this.el.innerHTML=M,c.bound&&c.field.type!=="hidden"&&r(function(){c.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),c.bound&&c.field.setAttribute("aria-label",c.ariaLabel)}},adjustPosition:function(){var b,c,g,p,v,E,M,U,$,K,Q,j;if(!this._o.container){if(this.el.style.position="absolute",b=this._o.trigger,c=b,g=this.el.offsetWidth,p=this.el.offsetHeight,v=window.innerWidth||i.documentElement.clientWidth,E=window.innerHeight||i.documentElement.clientHeight,M=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Q=!0,j=!0,typeof b.getBoundingClientRect=="function")K=b.getBoundingClientRect(),U=K.left+window.pageXOffset,$=K.bottom+window.pageYOffset;else for(U=c.offsetLeft,$=c.offsetTop+c.offsetHeight;c=c.offsetParent;)U+=c.offsetLeft,$+=c.offsetTop;(this._o.reposition&&U+g>v||this._o.position.indexOf("right")>-1&&U-g+b.offsetWidth>0)&&(U=U-g+b.offsetWidth,Q=!1),(this._o.reposition&&$+p>E+M||this._o.position.indexOf("top")>-1&&$-p-b.offsetHeight>0)&&($=$-p-b.offsetHeight,j=!1),this.el.style.left=U+"px",this.el.style.top=$+"px",d(this.el,Q?"left-aligned":"right-aligned"),d(this.el,j?"bottom-aligned":"top-aligned"),f(this.el,Q?"right-aligned":"left-aligned"),f(this.el,j?"top-aligned":"bottom-aligned")}},render:function(b,c,g){var p=this._o,v=new Date,E=H(b,c),M=new Date(b,c,1).getDay(),U=[],$=[];A(v),p.firstDay>0&&(M-=p.firstDay,M<0&&(M+=7));for(var K=c===0?11:c-1,Q=c===11?0:c+1,j=c===0?b-1:b,ge=c===11?b+1:b,xe=H(j,K),Re=E+M,Ee=Re;Ee>7;)Ee-=7;Re+=7-Ee;for(var Y=!1,Ye=0,Ne=0;Ye<Re;Ye++){var Se=new Date(b,c,1+(Ye-M)),Ie=w(this._d)?_(Se,this._d):!1,ye=_(Se,v),y=p.events.indexOf(Se.toDateString())!==-1,S=Ye<M||Ye>=E+M,T=1+(Ye-M),V=c,x=b,F=p.startRange&&_(p.startRange,Se),P=p.endRange&&_(p.endRange,Se),N=p.startRange&&p.endRange&&p.startRange<Se&&Se<p.endRange,W=p.minDate&&Se<p.minDate||p.maxDate&&Se>p.maxDate||p.disableWeekends&&C(Se)||p.disableDayFn&&p.disableDayFn(Se);S&&(Ye<M?(T=xe+T,V=K,x=j):(T=T-E,V=Q,x=ge));var L={day:T,month:V,year:x,hasEvent:y,isSelected:Ie,isToday:ye,isDisabled:W,isEmpty:S,isStartRange:F,isEndRange:P,isInRange:N,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&Ie&&(Y=!0),$.push(X(L)),++Ne===7&&(p.showWeekNumber&&$.unshift(oe(Ye-M,c,b,p.firstWeekOfYearMinDays)),U.push(ie($,p.isRTL,p.pickWholeWeek,Y)),$=[],Ne=0,Y=!1)}return ze(p,U,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var b=this._v;b!==!1&&(this._o.bound&&l(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,b!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var b=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),b.keyboardInput&&l(i,"keydown",this._onKeyChange),b.field&&(l(b.field,"change",this._onInputChange),b.bound&&(l(b.trigger,"click",this._onInputClick),l(b.trigger,"focus",this._onInputFocus),l(b.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ae})})(hR);var PF=hR.exports;const AC=By(PF),uR="date",xC="dateEditor";class cR extends Bo{static get EDITOR_TYPE(){return uR}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof AC!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.instance.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),J(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),new ft(this).addEventListener(this.datePicker,"mousedown",t=>t.stopPropagation())}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,n,o,i,r){super.prepare(e,t,n,o,i,r)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),n.addShortcut({keys:[["Enter"]],callback:o=>{o.stopPropagation()},group:xC})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.instance._registerTimeout(()=>{this.instance._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(xC),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const n=this.originalValue;n!==void 0&&this.setValue(n)}super.finishEditing(e,t)}showDatepicker(e){const t=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.instance.view.isMouseDown(),i=e?hm(e.keyCode):!1;let r;this.datePicker.style.display="block",this.$datePicker=new AC(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+dt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=t.right-Qe(this.datePicker):a=t.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(r=this.originalValue,Z(r,n,!0).isValid()&&this.$datePicker.setMoment(Z(r,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!o&&this.setValue("")):this.cellProperties.defaultDate?(r=this.cellProperties.defaultDate,Z(r,n,!0).isValid()&&this.$datePicker.setMoment(Z(r,n),!0),!i&&!o&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&ea(t,this.cellProperties.datePickerConfig);const n=t.onSelect,o=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=i=>{let r=i;isNaN(r.getTime())||(r=Z(r).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(r),this.hideDatepicker(),n&&n()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},t}}const NF="dropdown";class Qm extends Zm{static get EDITOR_TYPE(){return NF}prepare(e,t,n,o,i,r){super.prepare(e,t,n,o,i,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}ce.getSingleton().add("beforeValidate",function(s,e,t){const n=this.getCellMeta(e,this.propToCol(t));n.editor===Qm&&n.strict===void 0&&(n.filter=!1,n.strict=!0)});const kF="numeric";class dR extends Bo{static get EDITOR_TYPE(){return kF}}const LF="password";class fR extends Bo{static get EDITOR_TYPE(){return LF}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Ln(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ad="ht_editor_visible",HC="selectEditor",FF="select";class VF extends Vi{static get EDITOR_TYPE(){return FF}init(){this.select=this.hot.rootDocument.createElement("SELECT"),J(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Oe(this.select,ad)&&_e(this.select,ad),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,n,o,i,r){super.prepare(e,t,n,o,i,r);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Ln(this.select),Fe(l,(h,u)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=u,$o(d,h),this.select.appendChild(d)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let n=0,o=e.length;n<o;n++)t[e[n]]=e[n];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Dt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:n,height:o}=this.getEditedCellRect(),i=this.select.style;i.height=`${o}px`,i.width=`${n}px`,i.top=`${e}px`,i[this.hot.isRtl()?"right":"left"]=`${t}px`,i.margin="0px",J(this.select,ad)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),n={group:HC};this.isInFullEditMode()!==!1&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(HC)}}const $F="time";class gR extends Bo{static get EDITOR_TYPE(){return $F}prepare(e,t,n,o,i,r){super.prepare(e,t,n,o,i,r),this.TEXTAREA.dir="ltr"}}function WF(){rn(Vi),rn(Zm),rn(lR),rn(cR),rn(Qm),rn(qm),rn(dR),rn(fR),rn(VF),rn(Bo),rn(gR)}const BF="html";function Jm(s,e,t,n,o,i,r){la.apply(this,[s,e,t,n,o,i,r]),$o(e,i??"",!1)}Jm.RENDERER_TYPE=BF;const UF="autocomplete";function $i(s,e,t,n,o,i,r){const{rootDocument:a}=s,l=r.allowHtml?Jm:oo,h=a.createElement("DIV");if(h.className="htAutocompleteArrow",h.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[s,e,t,n,o,i,r]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),J(e,"htAutocomplete"),!s.acArrowListener){const u=new ft(s);s.acArrowListener=function(d){Oe(d.target,"htAutocompleteArrow")&&s.view._wt.getSetting("onCellDblClick",null,s._createCellCoords(t,n),e)},u.addEventListener(s.rootElement,"mousedown",s.acArrowListener),s.addHookOnce("afterDestroy",()=>{u.destroy()})}}$i.RENDERER_TYPE=UF;const DC=new WeakMap,PC=new WeakMap,YF="htBadValue",Ai="data-row",xi="data-col",zF="checkboxRenderer",mR="checkbox";ce.getSingleton().add("modifyAutoColumnSizeSeed",function(s,e,t){const{label:n,type:o,row:i,column:r,prop:a}=e;if(o===mR){if(n){const{value:l,property:h}=n;let u=t;if(l)u=typeof l=="function"?l(i,r,a,t):l;else if(h){const d=this.getDataAtRowProp(i,h);u=d!==null?d:t}s=u}return s}});function ep(s,e,t,n,o,i,r){const{rootDocument:a}=s;la.apply(this,[s,e,t,n,o,i,r]),GF(s);let l=jF(a);const h=r.label;let u=!1;if(typeof r.checkedTemplate>"u"&&(r.checkedTemplate=!0),typeof r.uncheckedTemplate>"u"&&(r.uncheckedTemplate=!1),Ln(e),i===r.checkedTemplate||Ct(i).toLocaleLowerCase(r.locale)===Ct(r.checkedTemplate).toLocaleLowerCase(r.locale)?l.checked=!0:i===r.uncheckedTemplate||Ct(i).toLocaleLowerCase(r.locale)===Ct(r.uncheckedTemplate).toLocaleLowerCase(r.locale)?l.checked=!1:It(i)?J(l,"noValue"):(l.style.display="none",J(l,YF),u=!0),l.setAttribute(Ai,t),l.setAttribute(xi,n),!u&&h){let w="";if(h.value)w=typeof h.value=="function"?h.value.call(this,t,n,o,i):h.value;else if(h.property){const R=s.getDataAtRowProp(t,h.property);w=R!==null?R:""}const C=KF(a,w,h.separated!==!0);h.position==="before"?h.separated?(e.appendChild(C),e.appendChild(l)):(C.appendChild(l),l=C):(!h.position||h.position==="after")&&(h.separated?(e.appendChild(l),e.appendChild(C)):(C.insertBefore(l,C.firstChild),l=C))}(!h||h&&!h.separated)&&e.appendChild(l),u&&e.appendChild(a.createTextNode("#bad-value#")),DC.has(s)||(DC.set(s,!0),d());function d(){const C=s.getShortcutManager().getContext("grid"),R={group:zF};C.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m())},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>s.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),relativeToGroup:yr,position:"before"}],R)}function f(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=s.getSelectedRange();if(C)for(let R=0;R<C.length;R++){const{row:H,col:A}=C[R].getTopStartCorner(),{row:_,col:O}=C[R].getBottomEndCorner(),D=[];for(let G=H;G<=_;G+=1)for(let z=A;z<=O;z+=1){const ee=s.getCellMeta(G,z);if(ee.type!=="checkbox")return;if(ee.readOnly===!0)continue;typeof ee.checkedTemplate>"u"&&(ee.checkedTemplate=!0),typeof ee.uncheckedTemplate>"u"&&(ee.uncheckedTemplate=!1);const X=s.getDataAtCell(G,z);w===!1?[ee.checkedTemplate,ee.checkedTemplate.toString()].includes(X)?D.push([G,z,ee.uncheckedTemplate]):[ee.uncheckedTemplate,ee.uncheckedTemplate.toString(),null,void 0].includes(X)&&D.push([G,z,ee.checkedTemplate]):D.push([G,z,ee.uncheckedTemplate])}D.length>0&&s.setDataAtCell(D)}}function m(){const w=s.getSelectedRange();if(w){for(let C=0;C<w.length;C++){const R=w[C].getTopStartCorner(),H=w[C].getBottomEndCorner();for(let A=R.row;A<=H.row;A++)for(let _=R.col;_<=H.col;_++){const O=s.getCellMeta(A,_);if(O.type!=="checkbox")return!1;const D=s.getCell(A,_);if(D==null)return!0;if(D.querySelectorAll("input[type=checkbox]").length>0&&!O.readOnly)return!0}}return!1}}}ep.RENDERER_TYPE=mR;function GF(s){let e=PC.get(s);if(!e){const{rootElement:t}=s;e=new ft(s),e.addEventListener(t,"click",n=>qF(n,s)),e.addEventListener(t,"mouseup",n=>XF(n,s)),e.addEventListener(t,"change",n=>ZF(n,s)),PC.set(s,e)}return e}function jF(s){const e=s.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function KF(s,e,t){const n=s.createElement("label");return n.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,n.appendChild(s.createTextNode(e)),n.cloneNode(!0)}function XF(s,e){const{target:t}=s;tp(t)&&(!t.hasAttribute(Ai)||!t.hasAttribute(xi)||setTimeout(e.listen,10))}function qF(s,e){const{target:t}=s;if(!tp(t)||!t.hasAttribute(Ai)||!t.hasAttribute(xi))return;const n=parseInt(t.getAttribute(Ai),10),o=parseInt(t.getAttribute(xi),10);e.getCellMeta(n,o).readOnly&&s.preventDefault()}function ZF(s,e){const{target:t}=s;if(!tp(t)||!t.hasAttribute(Ai)||!t.hasAttribute(xi))return;const n=parseInt(t.getAttribute(Ai),10),o=parseInt(t.getAttribute(xi),10),i=e.getCellMeta(n,o);if(!i.readOnly){let r=null;s.target.checked?r=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:r=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,e.setDataAtCell(n,o,r)}}function tp(s){return s.tagName==="INPUT"&&s.getAttribute("type")==="checkbox"}function La(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pR={exports:{}};(function(s,e){(function(t){s.exports=t()})(function(){return function t(n,o,i){function r(h,u){if(!o[h]){if(!n[h]){var d=typeof La=="function"&&La;if(!u&&d)return d(h,!0);if(a)return a(h,!0);var f=new Error("Cannot find module '"+h+"'");throw f.code="MODULE_NOT_FOUND",f}var m=o[h]={exports:{}};n[h][0].call(m.exports,function(w){return r(n[h][1][w]||w)},m,m.exports,t,n,o,i)}return o[h].exports}for(var a=typeof La=="function"&&La,l=0;l<i.length;l++)r(i[l]);return r}({1:[function(t,n,o){(function(i){var r,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,h=Math.floor,u="[BigNumber Error] ",d=u+"Number primitive has more than 15 significant digits: ",f=1e14,m=14,w=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],R=1e7,H=1e9;function A(X){var q=0|X;return 0<X||X===q?q:q-1}function _(X){for(var q,oe,ie=1,re=X.length,pe=X[0]+"";ie<re;){for(q=X[ie++]+"",oe=m-q.length;oe--;q="0"+q);pe+=q}for(re=pe.length;pe.charCodeAt(--re)===48;);return pe.slice(0,re+1||1)}function O(X,q){var oe,ie,re=X.c,pe=q.c,Me=X.s,ze=q.s,Ae=X.e,b=q.e;if(!Me||!ze)return null;if(oe=re&&!re[0],ie=pe&&!pe[0],oe||ie)return oe?ie?0:-ze:Me;if(Me!=ze)return Me;if(oe=Me<0,ie=Ae==b,!re||!pe)return ie?0:!re^oe?1:-1;if(!ie)return b<Ae^oe?1:-1;for(ze=(Ae=re.length)<(b=pe.length)?Ae:b,Me=0;Me<ze;Me++)if(re[Me]!=pe[Me])return re[Me]>pe[Me]^oe?1:-1;return Ae==b?0:b<Ae^oe?1:-1}function D(X,q,oe,ie){if(X<q||oe<X||X!==(X<0?l(X):h(X)))throw Error(u+(ie||"Argument")+(typeof X=="number"?X<q||oe<X?" out of range: ":" not an integer: ":" not a primitive number: ")+String(X))}function G(X){var q=X.c.length-1;return A(X.e/m)==q&&X.c[q]%2!=0}function z(X,q){return(1<X.length?X.charAt(0)+"."+X.slice(1):X)+(q<0?"e":"e+")+q}function ee(X,q,oe){var ie,re;if(q<0){for(re=oe+".";++q;re+=oe);X=re+X}else if(++q>(ie=X.length)){for(re=oe,q-=ie;--q;re+=oe);X+=re}else q<ie&&(X=X.slice(0,q)+"."+X.slice(q));return X}(r=function X(q){var oe,ie,re,pe,Me,ze,Ae,b,c,g,p=Y.prototype={constructor:Y,toString:null,valueOf:null},v=new Y(1),E=20,M=4,U=-7,$=21,K=-1e7,Q=1e7,j=!1,ge=1,xe=0,Re={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Ee="0123456789abcdefghijklmnopqrstuvwxyz";function Y(y,S){var T,V,x,F,P,N,W,L,B=this;if(!(B instanceof Y))return new Y(y,S);if(S==null){if(y instanceof Y)return B.s=y.s,B.e=y.e,void(B.c=(y=y.c)?y.slice():y);if((N=typeof y=="number")&&0*y==0){if(B.s=1/y<0?(y=-y,-1):1,y===~~y){for(F=0,P=y;10<=P;P/=10,F++);return B.e=F,void(B.c=[y])}L=String(y)}else{if(L=String(y),!a.test(L))return re(B,L,N);B.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(F=L.indexOf("."))&&(L=L.replace(".","")),0<(P=L.search(/e/i))?(F<0&&(F=P),F+=+L.slice(P+1),L=L.substring(0,P)):F<0&&(F=L.length)}else{if(D(S,2,Ee.length,"Base"),L=String(y),S==10)return Ie(B=new Y(y instanceof Y?y:L),E+B.e+1,M);if(N=typeof y=="number"){if(0*y!=0)return re(B,L,N,S);if(B.s=1/y<0?(L=L.slice(1),-1):1,Y.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(d+y);N=!1}else B.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(T=Ee.slice(0,S),F=P=0,W=L.length;P<W;P++)if(T.indexOf(V=L.charAt(P))<0){if(V=="."){if(F<P){F=W;continue}}else if(!x&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){x=!0,P=-1,F=0;continue}return re(B,String(y),N,S)}-1<(F=(L=ie(L,S,10,B.s)).indexOf("."))?L=L.replace(".",""):F=L.length}for(P=0;L.charCodeAt(P)===48;P++);for(W=L.length;L.charCodeAt(--W)===48;);if(L=L.slice(P,++W)){if(W-=P,N&&Y.DEBUG&&15<W&&(w<y||y!==h(y)))throw Error(d+B.s*y);if(Q<(F=F-P-1))B.c=B.e=null;else if(F<K)B.c=[B.e=0];else{if(B.e=F,B.c=[],P=(F+1)%m,F<0&&(P+=m),P<W){for(P&&B.c.push(+L.slice(0,P)),W-=m;P<W;)B.c.push(+L.slice(P,P+=m));L=L.slice(P),P=m-L.length}else P-=W;for(;P--;L+="0");B.c.push(+L)}}else B.c=[B.e=0]}function Ye(y,S,T,V){var x,F,P,N,W;if(T==null?T=M:D(T,0,8),!y.c)return y.toString();if(x=y.c[0],P=y.e,S==null)W=_(y.c),W=V==1||V==2&&(P<=U||$<=P)?z(W,P):ee(W,P,"0");else if(F=(y=Ie(new Y(y),S,T)).e,N=(W=_(y.c)).length,V==1||V==2&&(S<=F||F<=U)){for(;N<S;W+="0",N++);W=z(W,F)}else if(S-=P,W=ee(W,F,"0"),N<F+1){if(0<--S)for(W+=".";S--;W+="0");}else if(0<(S+=F-N))for(F+1==N&&(W+=".");S--;W+="0");return y.s<0&&x?"-"+W:W}function Ne(y,S){for(var T,V=1,x=new Y(y[0]);V<y.length;V++){if(!(T=new Y(y[V])).s){x=T;break}S.call(x,T)&&(x=T)}return x}function Se(y,S,T){for(var V=1,x=S.length;!S[--x];S.pop());for(x=S[0];10<=x;x/=10,V++);return(T=V+T*m-1)>Q?y.c=y.e=null:y.c=T<K?[y.e=0]:(y.e=T,S),y}function Ie(y,S,T,V){var x,F,P,N,W,L,B,se=y.c,ue=C;if(se){e:{for(x=1,N=se[0];10<=N;N/=10,x++);if((F=S-x)<0)F+=m,P=S,B=(W=se[L=0])/ue[x-P-1]%10|0;else if((L=l((F+1)/m))>=se.length){if(!V)break e;for(;se.length<=L;se.push(0));W=B=0,P=(F%=m)-m+(x=1)}else{for(W=N=se[L],x=1;10<=N;N/=10,x++);B=(P=(F%=m)-m+x)<0?0:W/ue[x-P-1]%10|0}if(V=V||S<0||se[L+1]!=null||(P<0?W:W%ue[x-P-1]),V=T<4?(B||V)&&(T==0||T==(y.s<0?3:2)):5<B||B==5&&(T==4||V||T==6&&(0<F?0<P?W/ue[x-P]:0:se[L-1])%10&1||T==(y.s<0?8:7)),S<1||!se[0])return se.length=0,V?(S-=y.e+1,se[0]=ue[(m-S%m)%m],y.e=-S||0):se[0]=y.e=0,y;if(F==0?(se.length=L,N=1,L--):(se.length=L+1,N=ue[m-F],se[L]=0<P?h(W/ue[x-P]%ue[P])*N:0),V)for(;;){if(L==0){for(F=1,P=se[0];10<=P;P/=10,F++);for(P=se[0]+=N,N=1;10<=P;P/=10,N++);F!=N&&(y.e++,se[0]==f&&(se[0]=1));break}if(se[L]+=N,se[L]!=f)break;se[L--]=0,N=1}for(F=se.length;se[--F]===0;se.pop());}y.e>Q?y.c=y.e=null:y.e<K&&(y.c=[y.e=0])}return y}function ye(y){var S,T=y.e;return T===null?y.toString():(S=_(y.c),S=T<=U||$<=T?z(S,T):ee(S,T,"0"),y.s<0?"-"+S:S)}return Y.clone=X,Y.ROUND_UP=0,Y.ROUND_DOWN=1,Y.ROUND_CEIL=2,Y.ROUND_FLOOR=3,Y.ROUND_HALF_UP=4,Y.ROUND_HALF_DOWN=5,Y.ROUND_HALF_EVEN=6,Y.ROUND_HALF_CEIL=7,Y.ROUND_HALF_FLOOR=8,Y.EUCLID=9,Y.config=Y.set=function(y){var S,T;if(y!=null){if(typeof y!="object")throw Error(u+"Object expected: "+y);if(y.hasOwnProperty(S="DECIMAL_PLACES")&&(D(T=y[S],0,H,S),E=T),y.hasOwnProperty(S="ROUNDING_MODE")&&(D(T=y[S],0,8,S),M=T),y.hasOwnProperty(S="EXPONENTIAL_AT")&&((T=y[S])&&T.pop?(D(T[0],-H,0,S),D(T[1],0,H,S),U=T[0],$=T[1]):(D(T,-H,H,S),U=-($=T<0?-T:T))),y.hasOwnProperty(S="RANGE"))if((T=y[S])&&T.pop)D(T[0],-H,-1,S),D(T[1],1,H,S),K=T[0],Q=T[1];else{if(D(T,-H,H,S),!T)throw Error(u+S+" cannot be zero: "+T);K=-(Q=T<0?-T:T)}if(y.hasOwnProperty(S="CRYPTO")){if((T=y[S])!==!!T)throw Error(u+S+" not true or false: "+T);if(T){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw j=!T,Error(u+"crypto unavailable");j=T}else j=T}if(y.hasOwnProperty(S="MODULO_MODE")&&(D(T=y[S],0,9,S),ge=T),y.hasOwnProperty(S="POW_PRECISION")&&(D(T=y[S],0,H,S),xe=T),y.hasOwnProperty(S="FORMAT")){if(typeof(T=y[S])!="object")throw Error(u+S+" not an object: "+T);Re=T}if(y.hasOwnProperty(S="ALPHABET")){if(typeof(T=y[S])!="string"||/^.$|[+-.\s]|(.).*\1/.test(T))throw Error(u+S+" invalid: "+T);Ee=T}}return{DECIMAL_PLACES:E,ROUNDING_MODE:M,EXPONENTIAL_AT:[U,$],RANGE:[K,Q],CRYPTO:j,MODULO_MODE:ge,POW_PRECISION:xe,FORMAT:Re,ALPHABET:Ee}},Y.isBigNumber=function(y){return y instanceof Y||y&&y._isBigNumber===!0||!1},Y.maximum=Y.max=function(){return Ne(arguments,p.lt)},Y.minimum=Y.min=function(){return Ne(arguments,p.gt)},Y.random=(pe=9007199254740992,Me=Math.random()*pe&2097151?function(){return h(Math.random()*pe)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(y){var S,T,V,x,F,P=0,N=[],W=new Y(v);if(y==null?y=E:D(y,0,H),x=l(y/m),j)if(crypto.getRandomValues){for(S=crypto.getRandomValues(new Uint32Array(x*=2));P<x;)9e15<=(F=131072*S[P]+(S[P+1]>>>11))?(T=crypto.getRandomValues(new Uint32Array(2)),S[P]=T[0],S[P+1]=T[1]):(N.push(F%1e14),P+=2);P=x/2}else{if(!crypto.randomBytes)throw j=!1,Error(u+"crypto unavailable");for(S=crypto.randomBytes(x*=7);P<x;)9e15<=(F=281474976710656*(31&S[P])+1099511627776*S[P+1]+4294967296*S[P+2]+16777216*S[P+3]+(S[P+4]<<16)+(S[P+5]<<8)+S[P+6])?crypto.randomBytes(7).copy(S,P):(N.push(F%1e14),P+=7);P=x/7}if(!j)for(;P<x;)(F=Me())<9e15&&(N[P++]=F%1e14);for(x=N[--P],y%=m,x&&y&&(F=C[m-y],N[P]=h(x/F)*F);N[P]===0;N.pop(),P--);if(P<0)N=[V=0];else{for(V=-1;N[0]===0;N.splice(0,1),V-=m);for(P=1,F=N[0];10<=F;F/=10,P++);P<m&&(V-=m-P)}return W.e=V,W.c=N,W}),Y.sum=function(){for(var y=1,S=arguments,T=new Y(S[0]);y<S.length;)T=T.plus(S[y++]);return T},ie=function(){var y="0123456789";function S(T,V,x,F){for(var P,N,W=[0],L=0,B=T.length;L<B;){for(N=W.length;N--;W[N]*=V);for(W[0]+=F.indexOf(T.charAt(L++)),P=0;P<W.length;P++)W[P]>x-1&&(W[P+1]==null&&(W[P+1]=0),W[P+1]+=W[P]/x|0,W[P]%=x)}return W.reverse()}return function(T,V,x,F,P){var N,W,L,B,se,ue,Ce,Te,Pe=T.indexOf("."),ot=E,Be=M;for(0<=Pe&&(B=xe,xe=0,T=T.replace(".",""),ue=(Te=new Y(V)).pow(T.length-Pe),xe=B,Te.c=S(ee(_(ue.c),ue.e,"0"),10,x,y),Te.e=Te.c.length),L=B=(Ce=S(T,V,x,P?(N=Ee,y):(N=y,Ee))).length;Ce[--B]==0;Ce.pop());if(!Ce[0])return N.charAt(0);if(Pe<0?--L:(ue.c=Ce,ue.e=L,ue.s=F,Ce=(ue=oe(ue,Te,ot,Be,x)).c,se=ue.r,L=ue.e),Pe=Ce[W=L+ot+1],B=x/2,se=se||W<0||Ce[W+1]!=null,se=Be<4?(Pe!=null||se)&&(Be==0||Be==(ue.s<0?3:2)):B<Pe||Pe==B&&(Be==4||se||Be==6&&1&Ce[W-1]||Be==(ue.s<0?8:7)),W<1||!Ce[0])T=se?ee(N.charAt(1),-ot,N.charAt(0)):N.charAt(0);else{if(Ce.length=W,se)for(--x;++Ce[--W]>x;)Ce[W]=0,W||(++L,Ce=[1].concat(Ce));for(B=Ce.length;!Ce[--B];);for(Pe=0,T="";Pe<=B;T+=N.charAt(Ce[Pe++]));T=ee(T,L,N.charAt(0))}return T}}(),oe=function(){function y(V,x,F){var P,N,W,L,B=0,se=V.length,ue=x%R,Ce=x/R|0;for(V=V.slice();se--;)B=((N=ue*(W=V[se]%R)+(P=Ce*W+(L=V[se]/R|0)*ue)%R*R+B)/F|0)+(P/R|0)+Ce*L,V[se]=N%F;return B&&(V=[B].concat(V)),V}function S(V,x,F,P){var N,W;if(F!=P)W=P<F?1:-1;else for(N=W=0;N<F;N++)if(V[N]!=x[N]){W=V[N]>x[N]?1:-1;break}return W}function T(V,x,F,P){for(var N=0;F--;)V[F]-=N,N=V[F]<x[F]?1:0,V[F]=N*P+V[F]-x[F];for(;!V[0]&&1<V.length;V.splice(0,1));}return function(V,x,F,P,N){var W,L,B,se,ue,Ce,Te,Pe,ot,Be,Ze,ut,Yo,Wi,St,Nt,io,jt=V.s==x.s?1:-1,_t=V.c,rt=x.c;if(!(_t&&_t[0]&&rt&&rt[0]))return new Y(V.s&&x.s&&(_t?!rt||_t[0]!=rt[0]:rt)?_t&&_t[0]==0||!rt?0*jt:jt/0:NaN);for(ot=(Pe=new Y(jt)).c=[],jt=F+(L=V.e-x.e)+1,N||(N=f,L=A(V.e/m)-A(x.e/m),jt=jt/m|0),B=0;rt[B]==(_t[B]||0);B++);if(rt[B]>(_t[B]||0)&&L--,jt<0)ot.push(1),se=!0;else{for(Wi=_t.length,Nt=rt.length,jt+=2,1<(ue=h(N/(rt[B=0]+1)))&&(rt=y(rt,ue,N),_t=y(_t,ue,N),Nt=rt.length,Wi=_t.length),Yo=Nt,Ze=(Be=_t.slice(0,Nt)).length;Ze<Nt;Be[Ze++]=0);io=rt.slice(),io=[0].concat(io),St=rt[0],rt[1]>=N/2&&St++;do{if(ue=0,(W=S(rt,Be,Nt,Ze))<0){if(ut=Be[0],Nt!=Ze&&(ut=ut*N+(Be[1]||0)),1<(ue=h(ut/St)))for(N<=ue&&(ue=N-1),Te=(Ce=y(rt,ue,N)).length,Ze=Be.length;S(Ce,Be,Te,Ze)==1;)ue--,T(Ce,Nt<Te?io:rt,Te,N),Te=Ce.length,W=1;else ue==0&&(W=ue=1),Te=(Ce=rt.slice()).length;if(Te<Ze&&(Ce=[0].concat(Ce)),T(Be,Ce,Ze,N),Ze=Be.length,W==-1)for(;S(rt,Be,Nt,Ze)<1;)ue++,T(Be,Nt<Ze?io:rt,Ze,N),Ze=Be.length}else W===0&&(ue++,Be=[0]);ot[B++]=ue,Be[0]?Be[Ze++]=_t[Yo]||0:(Be=[_t[Yo]],Ze=1)}while((Yo++<Wi||Be[0]!=null)&&jt--);se=Be[0]!=null,ot[0]||ot.splice(0,1)}if(N==f){for(B=1,jt=ot[0];10<=jt;jt/=10,B++);Ie(Pe,F+(Pe.e=B+L*m-1)+1,P,se)}else Pe.e=L,Pe.r=+se;return Pe}}(),ze=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ae=/^([^.]+)\.$/,b=/^\.([^.]+)$/,c=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,re=function(y,S,T,V){var x,F=T?S:S.replace(g,"");if(c.test(F))y.s=isNaN(F)?null:F<0?-1:1,y.c=y.e=null;else{if(!T&&(F=F.replace(ze,function(P,N,W){return x=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,V&&V!=x?P:N}),V&&(x=V,F=F.replace(Ae,"$1").replace(b,"0.$1")),S!=F))return new Y(F,x);if(Y.DEBUG)throw Error(u+"Not a"+(V?" base "+V:"")+" number: "+S);y.c=y.e=y.s=null}},p.absoluteValue=p.abs=function(){var y=new Y(this);return y.s<0&&(y.s=1),y},p.comparedTo=function(y,S){return O(this,new Y(y,S))},p.decimalPlaces=p.dp=function(y,S){var T,V,x;if(y!=null)return D(y,0,H),S==null?S=M:D(S,0,8),Ie(new Y(this),y+this.e+1,S);if(!(T=this.c))return null;if(V=((x=T.length-1)-A(this.e/m))*m,x=T[x])for(;x%10==0;x/=10,V--);return V<0&&(V=0),V},p.dividedBy=p.div=function(y,S){return oe(this,new Y(y,S),E,M)},p.dividedToIntegerBy=p.idiv=function(y,S){return oe(this,new Y(y,S),0,1)},p.exponentiatedBy=p.pow=function(y,S){var T,V,x,F,P,N,W,L,B=this;if((y=new Y(y)).c&&!y.isInteger())throw Error(u+"Exponent not an integer: "+ye(y));if(S!=null&&(S=new Y(S)),P=14<y.e,!B.c||!B.c[0]||B.c[0]==1&&!B.e&&B.c.length==1||!y.c||!y.c[0])return L=new Y(Math.pow(+ye(B),P?2-G(y):+ye(y))),S?L.mod(S):L;if(N=y.s<0,S){if(S.c?!S.c[0]:!S.s)return new Y(NaN);(V=!N&&B.isInteger()&&S.isInteger())&&(B=B.mod(S))}else{if(9<y.e&&(0<B.e||B.e<-1||(B.e==0?1<B.c[0]||P&&24e7<=B.c[1]:B.c[0]<8e13||P&&B.c[0]<=9999975e7)))return F=B.s<0&&G(y)?-0:0,-1<B.e&&(F=1/F),new Y(N?1/F:F);xe&&(F=l(xe/m+2))}for(W=P?(T=new Y(.5),N&&(y.s=1),G(y)):(x=Math.abs(+ye(y)))%2,L=new Y(v);;){if(W){if(!(L=L.times(B)).c)break;F?L.c.length>F&&(L.c.length=F):V&&(L=L.mod(S))}if(x){if((x=h(x/2))===0)break;W=x%2}else if(Ie(y=y.times(T),y.e+1,1),14<y.e)W=G(y);else{if((x=+ye(y))==0)break;W=x%2}B=B.times(B),F?B.c&&B.c.length>F&&(B.c.length=F):V&&(B=B.mod(S))}return V?L:(N&&(L=v.div(L)),S?L.mod(S):F?Ie(L,xe,M,void 0):L)},p.integerValue=function(y){var S=new Y(this);return y==null?y=M:D(y,0,8),Ie(S,S.e+1,y)},p.isEqualTo=p.eq=function(y,S){return O(this,new Y(y,S))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(y,S){return 0<O(this,new Y(y,S))},p.isGreaterThanOrEqualTo=p.gte=function(y,S){return(S=O(this,new Y(y,S)))===1||S===0},p.isInteger=function(){return!!this.c&&A(this.e/m)>this.c.length-2},p.isLessThan=p.lt=function(y,S){return O(this,new Y(y,S))<0},p.isLessThanOrEqualTo=p.lte=function(y,S){return(S=O(this,new Y(y,S)))===-1||S===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(y,S){var T,V,x,F,P=this,N=P.s;if(S=(y=new Y(y,S)).s,!N||!S)return new Y(NaN);if(N!=S)return y.s=-S,P.plus(y);var W=P.e/m,L=y.e/m,B=P.c,se=y.c;if(!W||!L){if(!B||!se)return B?(y.s=-S,y):new Y(se?P:NaN);if(!B[0]||!se[0])return se[0]?(y.s=-S,y):new Y(B[0]?P:M==3?-0:0)}if(W=A(W),L=A(L),B=B.slice(),N=W-L){for((x=(F=N<0)?(N=-N,B):(L=W,se)).reverse(),S=N;S--;x.push(0));x.reverse()}else for(V=(F=(N=B.length)<(S=se.length))?N:S,N=S=0;S<V;S++)if(B[S]!=se[S]){F=B[S]<se[S];break}if(F&&(x=B,B=se,se=x,y.s=-y.s),0<(S=(V=se.length)-(T=B.length)))for(;S--;B[T++]=0);for(S=f-1;N<V;){if(B[--V]<se[V]){for(T=V;T&&!B[--T];B[T]=S);--B[T],B[V]+=f}B[V]-=se[V]}for(;B[0]==0;B.splice(0,1),--L);return B[0]?Se(y,B,L):(y.s=M==3?-1:1,y.c=[y.e=0],y)},p.modulo=p.mod=function(y,S){var T,V,x=this;return y=new Y(y,S),!x.c||!y.s||y.c&&!y.c[0]?new Y(NaN):!y.c||x.c&&!x.c[0]?new Y(x):(ge==9?(V=y.s,y.s=1,T=oe(x,y,0,3),y.s=V,T.s*=V):T=oe(x,y,0,ge),(y=x.minus(T.times(y))).c[0]||ge!=1||(y.s=x.s),y)},p.multipliedBy=p.times=function(y,S){var T,V,x,F,P,N,W,L,B,se,ue,Ce,Te,Pe,ot,Be=this,Ze=Be.c,ut=(y=new Y(y,S)).c;if(!(Ze&&ut&&Ze[0]&&ut[0]))return!Be.s||!y.s||Ze&&!Ze[0]&&!ut||ut&&!ut[0]&&!Ze?y.c=y.e=y.s=null:(y.s*=Be.s,Ze&&ut?(y.c=[0],y.e=0):y.c=y.e=null),y;for(V=A(Be.e/m)+A(y.e/m),y.s*=Be.s,(W=Ze.length)<(se=ut.length)&&(Te=Ze,Ze=ut,ut=Te,x=W,W=se,se=x),x=W+se,Te=[];x--;Te.push(0));for(Pe=f,ot=R,x=se;0<=--x;){for(T=0,ue=ut[x]%ot,Ce=ut[x]/ot|0,F=x+(P=W);x<F;)T=((L=ue*(L=Ze[--P]%ot)+(N=Ce*L+(B=Ze[P]/ot|0)*ue)%ot*ot+Te[F]+T)/Pe|0)+(N/ot|0)+Ce*B,Te[F--]=L%Pe;Te[F]=T}return T?++V:Te.splice(0,1),Se(y,Te,V)},p.negated=function(){var y=new Y(this);return y.s=-y.s||null,y},p.plus=function(y,S){var T,V=this,x=V.s;if(S=(y=new Y(y,S)).s,!x||!S)return new Y(NaN);if(x!=S)return y.s=-S,V.minus(y);var F=V.e/m,P=y.e/m,N=V.c,W=y.c;if(!F||!P){if(!N||!W)return new Y(x/0);if(!N[0]||!W[0])return W[0]?y:new Y(N[0]?V:0*x)}if(F=A(F),P=A(P),N=N.slice(),x=F-P){for((T=0<x?(P=F,W):(x=-x,N)).reverse();x--;T.push(0));T.reverse()}for((x=N.length)-(S=W.length)<0&&(T=W,W=N,N=T,S=x),x=0;S;)x=(N[--S]=N[S]+W[S]+x)/f|0,N[S]=f===N[S]?0:N[S]%f;return x&&(N=[x].concat(N),++P),Se(y,N,P)},p.precision=p.sd=function(y,S){var T,V,x;if(y!=null&&y!==!!y)return D(y,1,H),S==null?S=M:D(S,0,8),Ie(new Y(this),y,S);if(!(T=this.c))return null;if(V=(x=T.length-1)*m+1,x=T[x]){for(;x%10==0;x/=10,V--);for(x=T[0];10<=x;x/=10,V++);}return y&&this.e+1>V&&(V=this.e+1),V},p.shiftedBy=function(y){return D(y,-w,w),this.times("1e"+y)},p.squareRoot=p.sqrt=function(){var y,S,T,V,x,F=this,P=F.c,N=F.s,W=F.e,L=E+4,B=new Y("0.5");if(N!==1||!P||!P[0])return new Y(!N||N<0&&(!P||P[0])?NaN:P?F:1/0);if((T=(N=Math.sqrt(+ye(F)))==0||N==1/0?(((S=_(P)).length+W)%2==0&&(S+="0"),N=Math.sqrt(+S),W=A((W+1)/2)-(W<0||W%2),new Y(S=N==1/0?"1e"+W:(S=N.toExponential()).slice(0,S.indexOf("e")+1)+W)):new Y(N+"")).c[0]){for((N=(W=T.e)+L)<3&&(N=0);;)if(x=T,T=B.times(x.plus(oe(F,x,L,1))),_(x.c).slice(0,N)===(S=_(T.c)).slice(0,N)){if(T.e<W&&--N,(S=S.slice(N-3,N+1))!="9999"&&(V||S!="4999")){+S&&(+S.slice(1)||S.charAt(0)!="5")||(Ie(T,T.e+E+2,1),y=!T.times(T).eq(F));break}if(!V&&(Ie(x,x.e+E+2,0),x.times(x).eq(F))){T=x;break}L+=4,N+=4,V=1}}return Ie(T,T.e+E+1,M,y)},p.toExponential=function(y,S){return y!=null&&(D(y,0,H),y++),Ye(this,y,S,1)},p.toFixed=function(y,S){return y!=null&&(D(y,0,H),y=y+this.e+1),Ye(this,y,S)},p.toFormat=function(y,S,T){var V;if(T==null)y!=null&&S&&typeof S=="object"?(T=S,S=null):y&&typeof y=="object"?(T=y,y=S=null):T=Re;else if(typeof T!="object")throw Error(u+"Argument not an object: "+T);if(V=this.toFixed(y,S),this.c){var x,F=V.split("."),P=+T.groupSize,N=+T.secondaryGroupSize,W=T.groupSeparator||"",L=F[0],B=F[1],se=this.s<0,ue=se?L.slice(1):L,Ce=ue.length;if(N&&(x=P,P=N,Ce-=N=x),0<P&&0<Ce){for(x=Ce%P||P,L=ue.substr(0,x);x<Ce;x+=P)L+=W+ue.substr(x,P);0<N&&(L+=W+ue.slice(x)),se&&(L="-"+L)}V=B?L+(T.decimalSeparator||"")+((N=+T.fractionGroupSize)?B.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(T.fractionGroupSeparator||"")):B):L}return(T.prefix||"")+V+(T.suffix||"")},p.toFraction=function(y){var S,T,V,x,F,P,N,W,L,B,se,ue,Ce=this,Te=Ce.c;if(y!=null&&(!(N=new Y(y)).isInteger()&&(N.c||N.s!==1)||N.lt(v)))throw Error(u+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+ye(N));if(!Te)return new Y(Ce);for(S=new Y(v),L=T=new Y(v),V=W=new Y(v),ue=_(Te),F=S.e=ue.length-Ce.e-1,S.c[0]=C[(P=F%m)<0?m+P:P],y=!y||0<N.comparedTo(S)?0<F?S:L:N,P=Q,Q=1/0,N=new Y(ue),W.c[0]=0;B=oe(N,S,0,1),(x=T.plus(B.times(V))).comparedTo(y)!=1;)T=V,V=x,L=W.plus(B.times(x=L)),W=x,S=N.minus(B.times(x=S)),N=x;return x=oe(y.minus(T),V,0,1),W=W.plus(x.times(L)),T=T.plus(x.times(V)),W.s=L.s=Ce.s,se=oe(L,V,F*=2,M).minus(Ce).abs().comparedTo(oe(W,T,F,M).minus(Ce).abs())<1?[L,V]:[W,T],Q=P,se},p.toNumber=function(){return+ye(this)},p.toPrecision=function(y,S){return y!=null&&D(y,1,H),Ye(this,y,S,2)},p.toString=function(y){var S,T=this,V=T.s,x=T.e;return x===null?V?(S="Infinity",V<0&&(S="-"+S)):S="NaN":(S=y==null?x<=U||$<=x?z(_(T.c),x):ee(_(T.c),x,"0"):y===10?ee(_((T=Ie(new Y(T),E+x+1,M)).c),T.e,"0"):(D(y,2,Ee.length,"Base"),ie(ee(_(T.c),x,"0"),10,y,V,!0)),V<0&&T.c[0]&&(S="-"+S)),S},p.valueOf=p.toJSON=function(){return ye(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),q!=null&&Y.set(q),Y}()).default=r.BigNumber=r,n!==void 0&&n.exports?n.exports=r:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=r)})(this)},{}],2:[function(t,n,o){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var r=i%10;return~~(i%100/10)==1?"th":r===1?"st":r===2?"nd":r===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,n,o){function i(A,_){return function(O){if(Array.isArray(O))return O}(A)||function(O,D){var G=[],z=!0,ee=!1,X=void 0;try{for(var q,oe=O[Symbol.iterator]();!(z=(q=oe.next()).done)&&(G.push(q.value),!D||G.length!==D);z=!0);}catch(ie){ee=!0,X=ie}finally{try{z||oe.return==null||oe.return()}finally{if(ee)throw X}}return G}(A,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var r=t("./globalState"),a=t("./validating"),l=t("./parsing"),h=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],u={general:{scale:1024,suffixes:h,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:h,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(A){var _=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},O=2<arguments.length?arguments[2]:void 0;if(typeof _=="string"&&(_=l.parseFormat(_)),!a.validateFormat(_))return"ERROR: invalid format";var D=_.prefix||"",G=_.postfix||"",z=function(ee,X,q){switch(X.output){case"currency":return X=H(X,r.currentCurrencyDefaultFormat()),function(Ee,Y,Ye){var Ne=Ye.currentCurrency(),Se=Object.assign({},d,Y),Ie=void 0,ye="",y=!!Se.totalLength||!!Se.forceAverage||Se.average,S=Y.currencyPosition||Ne.position,T=Y.currencySymbol||Ne.symbol;Se.spaceSeparated&&(ye=" "),S==="infix"&&(Ie=ye+T+ye);var V=R({instance:Ee,providedFormat:Y,state:Ye,decimalSeparator:Ie});return S==="prefix"&&(V=Ee._value<0&&Se.negative==="sign"?"-".concat(ye).concat(T).concat(V.slice(1)):T+ye+V),S&&S!=="postfix"||(V=V+(ye=y?"":ye)+T),V}(ee,X,r);case"percent":return X=H(X,r.currentPercentageDefaultFormat()),function(Ee,Y,Ye,Ne){var Se=Y.prefixSymbol,Ie=R({instance:Ne(100*Ee._value),providedFormat:Y,state:Ye}),ye=Object.assign({},d,Y);return Se?"%".concat(ye.spaceSeparated?" ":"").concat(Ie):"".concat(Ie).concat(ye.spaceSeparated?" ":"","%")}(ee,X,r,q);case"byte":return X=H(X,r.currentByteDefaultFormat()),v=ee,M=r,U=q,$=(E=X).base||"binary",K=u[$],Q=m(v._value,K.suffixes,K.scale),j=Q.value,ge=Q.suffix,xe=R({instance:U(j),providedFormat:E,state:M,defaults:M.currentByteDefaultFormat()}),Re=M.currentAbbreviations(),"".concat(xe).concat(Re.spaced?" ":"").concat(ge);case"time":return X=H(X,r.currentTimeDefaultFormat()),b=ee,c=Math.floor(b._value/60/60),g=Math.floor((b._value-60*c*60)/60),p=Math.round(b._value-60*c*60-60*g),"".concat(c,":").concat(g<10?"0":"").concat(g,":").concat(p<10?"0":"").concat(p);case"ordinal":return X=H(X,r.currentOrdinalDefaultFormat()),oe=ee,ie=X,pe=(re=r).currentOrdinal(),Me=Object.assign({},d,ie),ze=R({instance:oe,providedFormat:ie,state:re}),Ae=pe(oe._value),"".concat(ze).concat(Me.spaceSeparated?" ":"").concat(Ae);case"number":default:return R({instance:ee,providedFormat:X,numbro:q})}var oe,ie,re,pe,Me,ze,Ae,b,c,g,p,v,E,M,U,$,K,Q,j,ge,xe,Re}(A,_,O);return z=(z=D+z)+G}function m(A,_,O){var D=_[0],G=Math.abs(A);if(O<=G){for(var z=1;z<_.length;++z){var ee=Math.pow(O,z),X=Math.pow(O,z+1);if(ee<=G&&G<X){D=_[z],A/=ee;break}}D===_[0]&&(A/=Math.pow(O,_.length-1),D=_[_.length-1])}return{value:A,suffix:D}}function w(A){for(var _="",O=0;O<A;O++)_+="0";return _}function C(A,_){return A.toString().indexOf("e")!==-1?function(O,D){var G=O.toString(),z=i(G.split("e"),2),ee=z[0],X=z[1],q=i(ee.split("."),2),oe=q[0],ie=q[1],re=ie===void 0?"":ie;if(0<+X)G=oe+re+w(X-re.length);else{var pe=".";pe=+oe<0?"-0".concat(pe):"0".concat(pe);var Me=(w(-X-1)+Math.abs(oe)+re).substr(0,D);Me.length<D&&(Me+=w(D-Me.length)),G=pe+Me}return 0<+X&&0<D&&(G+=".".concat(w(D))),G}(A,_):(Math.round(+"".concat(A,"e+").concat(_))/Math.pow(10,_)).toFixed(_)}function R(A){var _=A.instance,O=A.providedFormat,D=A.state,G=D===void 0?r:D,z=A.decimalSeparator,ee=A.defaults,X=ee===void 0?G.currentDefaults():ee,q=_._value;if(q===0&&G.hasZeroFormat())return G.getZeroFormat();if(!isFinite(q))return q.toString();var oe,ie,re,pe,Me,ze,Ae,b,c=Object.assign({},d,X,O),g=c.totalLength,p=g?0:c.characteristic,v=c.optionalCharacteristic,E=c.forceAverage,M=!!g||!!E||c.average,U=g?-1:M&&O.mantissa===void 0?0:c.mantissa,$=!g&&(O.optionalMantissa===void 0?U===-1:c.optionalMantissa),K=c.trimMantissa,Q=c.thousandSeparated,j=c.spaceSeparated,ge=c.negative,xe=c.forceSign,Re=c.exponential,Ee="";if(M){var Y=function(y){var S=y.value,T=y.forceAverage,V=y.abbreviations,x=y.spaceSeparated,F=x!==void 0&&x,P=y.totalLength,N=P===void 0?0:P,W="",L=Math.abs(S),B=-1;if(L>=Math.pow(10,12)&&!T||T==="trillion"?(W=V.trillion,S/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!T||T==="billion"?(W=V.billion,S/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!T||T==="million"?(W=V.million,S/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!T||T==="thousand")&&(W=V.thousand,S/=Math.pow(10,3)),W&&(W=(F?" ":"")+W),N){var se=S.toString().split(".")[0];B=Math.max(N-se.length,0)}return{value:S,abbreviation:W,mantissaPrecision:B}}({value:q,forceAverage:E,abbreviations:G.currentAbbreviations(),spaceSeparated:j,totalLength:g});q=Y.value,Ee+=Y.abbreviation,g&&(U=Y.mantissaPrecision)}if(Re){var Ye=(ie=(oe={value:q,characteristicPrecision:p}).value,re=oe.characteristicPrecision,pe=re===void 0?0:re,Me=i(ie.toExponential().split("e"),2),ze=Me[0],Ae=Me[1],b=+ze,pe&&1<pe&&(b*=Math.pow(10,pe-1),Ae=0<=(Ae=+Ae-(pe-1))?"+".concat(Ae):Ae),{value:b,abbreviation:"e".concat(Ae)});q=Ye.value,Ee=Ye.abbreviation+Ee}var Ne,Se,Ie,ye=function(y,S,T,V,x){if(V===-1)return y;var F=C(S,V),P=i(F.toString().split("."),2),N=P[0],W=P[1],L=W===void 0?"":W;if(L.match(/^0+$/)&&(T||x))return N;var B=L.match(/0+$/);return x&&B?"".concat(N,".").concat(L.toString().slice(0,B.index)):F.toString()}(q.toString(),q,$,U,K);return ye=function(y,S,T,V,x){var F=V.currentDelimiters(),P=F.thousands;x=x||F.decimal;var N=F.thousandsSize||3,W=y.toString(),L=W.split(".")[0],B=W.split(".")[1];return T&&(S<0&&(L=L.slice(1)),function(se,ue){for(var Ce=[],Te=0,Pe=se;0<Pe;Pe--)Te===ue&&(Ce.unshift(Pe),Te=0),Te++;return Ce}(L.length,N).forEach(function(se,ue){L=L.slice(0,se+ue)+P+L.slice(se+ue)}),S<0&&(L="-".concat(L))),W=B?L+x+B:L}(ye=function(y,S,T,V){var x=y,F=i(x.toString().split("."),2),P=F[0],N=F[1];if(P.match(/^-?0$/)&&T)return N?"".concat(P.replace("0",""),".").concat(N):P.replace("0","");if(P.length<V)for(var W=V-P.length,L=0;L<W;L++)x="0".concat(x);return x.toString()}(ye,0,v,p),q,Q,G,z),(M||Re)&&(ye=ye+Ee),(xe||q<0)&&(Ne=ye,Ie=ge,ye=(Se=q)===0?Ne:+Ne==0?Ne.replace("-",""):0<Se?"+".concat(Ne):Ie==="sign"?Ne:"(".concat(Ne.replace("-",""),")")),ye}function H(A,_){if(!A)return _;var O=Object.keys(A);return O.length===1&&O[0]==="output"?_:A}n.exports=function(A){return{format:function(){for(var _=arguments.length,O=new Array(_),D=0;D<_;D++)O[D]=arguments[D];return f.apply(void 0,O.concat([A]))},getByteUnit:function(){for(var _=arguments.length,O=new Array(_),D=0;D<_;D++)O[D]=arguments[D];return(function(G){var z=u.general;return m(G._value,z.suffixes,z.scale).suffix}).apply(void 0,O.concat([A]))},getBinaryByteUnit:function(){for(var _=arguments.length,O=new Array(_),D=0;D<_;D++)O[D]=arguments[D];return(function(G){var z=u.binary;return m(G._value,z.suffixes,z.scale).suffix}).apply(void 0,O.concat([A]))},getDecimalByteUnit:function(){for(var _=arguments.length,O=new Array(_),D=0;D<_;D++)O[D]=arguments[D];return(function(G){var z=u.decimal;return m(G._value,z.suffixes,z.scale).suffix}).apply(void 0,O.concat([A]))},formatOrDefault:H}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,n,o){var i=t("./en-US"),r=t("./validating"),a=t("./parsing"),l={},h=void 0,u={},d=null,f={};function m(C){h=C}function w(){return u[h]}l.languages=function(){return Object.assign({},u)},l.currentLanguage=function(){return h},l.currentCurrency=function(){return w().currency},l.currentAbbreviations=function(){return w().abbreviations},l.currentDelimiters=function(){return w().delimiters},l.currentOrdinal=function(){return w().ordinal},l.currentDefaults=function(){return Object.assign({},w().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().timeFormat)},l.setDefaults=function(C){C=a.parseFormat(C),r.validateFormat(C)&&(f=C)},l.getZeroFormat=function(){return d},l.setZeroFormat=function(C){return d=typeof C=="string"?C:null},l.hasZeroFormat=function(){return d!==null},l.languageData=function(C){if(C){if(u[C])return u[C];throw new Error('Unknown tag "'.concat(C,'"'))}return w()},l.registerLanguage=function(C){var R=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!r.validateLanguage(C))throw new Error("Invalid language data");u[C.languageTag]=C,R&&m(C.languageTag)},l.setLanguage=function(C){var R=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!u[C]){var H=C.split("-")[0],A=Object.keys(u).find(function(_){return _.split("-")[0]===H});return u[A]?void m(A):void m(R)}m(C)},l.registerLanguage(i),h=i.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,n,o){n.exports=function(i){return{loadLanguagesInNode:function(r){return a=i,void r.forEach(function(l){var h=void 0;try{h=t("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}h&&a.registerLanguage(h)});var a}}}},{}],6:[function(t,n,o){var i=t("bignumber.js");function r(a,l,h){var u=new i(a._value),d=l;return h.isNumbro(l)&&(d=l._value),d=new i(d),a._value=u.minus(d).toNumber(),a}n.exports=function(a){return{add:function(l,h){return d=h,f=a,m=new i((u=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new i(w),u._value=m.plus(w).toNumber(),u;var u,d,f,m,w},subtract:function(l,h){return r(l,h,a)},multiply:function(l,h){return d=h,f=a,m=new i((u=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new i(w),u._value=m.times(w).toNumber(),u;var u,d,f,m,w},divide:function(l,h){return d=h,f=a,m=new i((u=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new i(w),u._value=m.dividedBy(w).toNumber(),u;var u,d,f,m,w},set:function(l,h){return u=l,f=d=h,a.isNumbro(d)&&(f=d._value),u._value=f,u;var u,d,f},difference:function(l,h){return u=h,r(f=(d=a)(l._value),u,d),Math.abs(f._value);var u,d,f}}}},{"bignumber.js":1}],7:[function(t,n,o){function i(R,H){for(var A=0;A<H.length;A++){var _=H[A];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(R,_.key,_)}}var r=t("./globalState"),a=t("./validating"),l=t("./loading")(C),h=t("./unformatting"),u=t("./formatting")(C),d=t("./manipulating")(C),f=t("./parsing"),m=function(){function R(_){(function(O,D){if(!(O instanceof D))throw new TypeError("Cannot call a class as a function")})(this,R),this._value=_}var H,A;return H=R,(A=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return u.format(this,_)}},{key:"formatCurrency",value:function(_){return typeof _=="string"&&(_=f.parseFormat(_)),(_=u.formatOrDefault(_,r.currentCurrencyDefaultFormat())).output="currency",u.format(this,_)}},{key:"formatTime",value:function(){var _=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return _.output="time",u.format(this,_)}},{key:"binaryByteUnits",value:function(){return u.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return u.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return u.getByteUnit(this)}},{key:"difference",value:function(_){return d.difference(this,_)}},{key:"add",value:function(_){return d.add(this,_)}},{key:"subtract",value:function(_){return d.subtract(this,_)}},{key:"multiply",value:function(_){return d.multiply(this,_)}},{key:"divide",value:function(_){return d.divide(this,_)}},{key:"set",value:function(_){return d.set(this,w(_))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(H.prototype,A),R}();function w(R){var H=R;return C.isNumbro(R)?H=R._value:typeof R=="string"?H=C.unformat(R):isNaN(R)&&(H=NaN),H}function C(R){return new m(w(R))}C.version="2.1.2",C.isNumbro=function(R){return R instanceof m},C.language=r.currentLanguage,C.registerLanguage=r.registerLanguage,C.setLanguage=r.setLanguage,C.languages=r.languages,C.languageData=r.languageData,C.zeroFormat=r.setZeroFormat,C.defaultFormat=r.currentDefaults,C.setDefaults=r.setDefaults,C.defaultCurrencyFormat=r.currentCurrencyDefaultFormat,C.validate=a.validate,C.loadLanguagesInNode=l.loadLanguagesInNode,C.unformat=h.unformat,n.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,n,o){n.exports={parseFormat:function(i){var r,a,l,h,u,d,f,m,w,C,R,H,A,_,O,D,G,z,ee,X,q=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(a=q,i=(l=(r=i).match(/^{([^}]*)}/))?(a.prefix=l[1],r.slice(l[0].length)):r,u=q,function(oe,ie){if(oe.indexOf("$")===-1){if(oe.indexOf("%")===-1)return oe.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):oe.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):oe.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):oe.indexOf(":")===-1?oe.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(i=(d=(h=i).match(/{([^}]*)}$/))?(u.postfix=d[1],h.slice(0,-d[0].length)):h,q),f=q,(m=i.match(/[1-9]+[0-9]*/))&&(f.totalLength=+m[0]),w=q,(C=i.split(".")[0].match(/0+/))&&(w.characteristic=C[0].length),function(oe,ie){if(oe.indexOf(".")!==-1){var re=oe.split(".")[0];ie.optionalCharacteristic=re.indexOf("0")===-1}}(i,q),R=q,i.indexOf("a")!==-1&&(R.average=!0),A=q,(H=i).indexOf("K")!==-1?A.forceAverage="thousand":H.indexOf("M")!==-1?A.forceAverage="million":H.indexOf("B")!==-1?A.forceAverage="billion":H.indexOf("T")!==-1&&(A.forceAverage="trillion"),function(oe,ie){var re=oe.split(".")[1];if(re){var pe=re.match(/0+/);pe&&(ie.mantissa=pe[0].length)}}(i,q),O=q,(_=i).match(/\[\.]/)?O.optionalMantissa=!0:_.match(/\./)&&(O.optionalMantissa=!1),D=q,i.indexOf(",")!==-1&&(D.thousandSeparated=!0),G=q,i.indexOf(" ")!==-1&&(G.spaceSeparated=!0),ee=q,(z=i).match(/^\+?\([^)]*\)$/)&&(ee.negative="parenthesis"),z.match(/^\+?-/)&&(ee.negative="sign"),X=q,i.match(/^\+/)&&(X.forceSign=!0),q)}}},{}],9:[function(t,n,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function r(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,h){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,m=5<arguments.length?arguments[5]:void 0,w=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function C(R,H){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=3<arguments.length?arguments[3]:void 0,O=4<arguments.length?arguments[4]:void 0,D=5<arguments.length?arguments[5]:void 0,G=6<arguments.length?arguments[6]:void 0;if(!isNaN(+R))return+R;var z="",ee=R.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ee!==R)return-1*C(ee,H,A,_,O,D,G);for(var X=0;X<i.length;X++){var q=i[X];if((z=R.replace(q.key,""))!==R)return C(z,H,A,_,O,D,G)*q.factor}if((z=R.replace("%",""))!==R)return C(z,H,A,_,O,D,G)/100;var oe=parseFloat(R);if(!isNaN(oe)){var ie=_(oe);if(ie&&ie!=="."&&(z=R.replace(new RegExp("".concat(r(ie),"$")),""))!==R)return C(z,H,A,_,O,D,G);var re={};Object.keys(D).forEach(function(g){re[D[g]]=g});for(var pe=Object.keys(re).sort().reverse(),Me=pe.length,ze=0;ze<Me;ze++){var Ae=pe[ze],b=re[Ae];if((z=R.replace(Ae,""))!==R){var c=void 0;switch(b){case"thousand":c=Math.pow(10,3);break;case"million":c=Math.pow(10,6);break;case"billion":c=Math.pow(10,9);break;case"trillion":c=Math.pow(10,12)}return C(z,H,A,_,O,D,G)*c}}}}(function(C,R){var H=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",A=C.replace(H,"");return A=(A=A.replace(new RegExp("([0-9])".concat(r(R.thousands),"([0-9])"),"g"),"$1$2")).replace(R.decimal,".")}(l,h,u),h,u,d,f,m,w)}n.exports={unformat:function(l,h){var u,d,f,m=t("./globalState"),w=m.currentDelimiters(),C=m.currentCurrency().symbol,R=m.currentOrdinal(),H=m.getZeroFormat(),A=m.currentAbbreviations(),_=void 0;if(typeof l=="string")_=function(O,D){if(!O.indexOf(":")||D.thousands===":")return!1;var G=O.split(":");if(G.length!==3)return!1;var z=+G[0],ee=+G[1],X=+G[2];return!isNaN(z)&&!isNaN(ee)&&!isNaN(X)}(l,w)?(u=l.split(":"),d=+u[0],f=+u[1],+u[2]+60*f+3600*d):a(l,w,C,R,H,A,h);else{if(typeof l!="number")return;_=l}if(_!==void 0)return _}}},{"./globalState":4}],10:[function(t,n,o){function i(w){return function(C){if(Array.isArray(C)){for(var R=0,H=new Array(C.length);R<C.length;R++)H[R]=C[R];return H}}(w)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(w){return(r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(w)}var a=t("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,h={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(w,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(w){return w.output==="byte"}},characteristic:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(w){return 0<=w},message:"value must be positive"},{restriction:function(w,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(w,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:function(w){return w.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(w){return!!a.unformat(w)}function f(w,C,R){var H=3<arguments.length&&arguments[3]!==void 0&&arguments[3],A=Object.keys(w).map(function(_){if(!C[_])return console.error("".concat(R," Invalid key: ").concat(_)),!1;var O=w[_],D=C[_];if(typeof D=="string"&&(D={type:D}),D.type==="format"){if(!f(O,h,"[Validate ".concat(_,"]"),!0))return!1}else if(r(O)!==D.type)return console.error("".concat(R," ").concat(_,' type mismatched: "').concat(D.type,'" expected, "').concat(r(O),'" provided')),!1;if(D.restrictions&&D.restrictions.length)for(var G=D.restrictions.length,z=0;z<G;z++){var ee=D.restrictions[z],X=ee.restriction,q=ee.message;if(!X(O,w))return console.error("".concat(R," ").concat(_," invalid value: ").concat(q)),!1}return D.restriction&&!D.restriction(O,w)?(console.error("".concat(R," ").concat(_," invalid value: ").concat(D.message)),!1):D.validValues&&D.validValues.indexOf(O)===-1?(console.error("".concat(R," ").concat(_," invalid value: must be among ").concat(JSON.stringify(D.validValues),', "').concat(O,'" provided')),!1):!(D.children&&!f(O,D.children,"[Validate ".concat(_,"]")))});return H||A.push.apply(A,i(Object.keys(C).map(function(_){var O=C[_];if(typeof O=="string"&&(O={type:O}),O.mandatory){var D=O.mandatory;if(typeof D=="function"&&(D=D(w)),D&&w[_]===void 0)return console.error("".concat(R,' Missing mandatory key "').concat(_,'"')),!1}return!0}))),A.reduce(function(_,O){return _&&O},!0)}function m(w){return f(w,h,"[Validate format]")}n.exports={validate:function(w,C){var R=d(w),H=m(C);return R&&H},validateFormat:m,validateInput:d,validateLanguage:function(w){return f(w,u,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(pR);var QF=pR.exports;const co=By(QF),JF="numeric";function np(s,e,t,n,o,i,r){let a=i;if(Qt(a)){const l=r.numericFormat,h=l&&l.culture||"-",u=l&&l.pattern,d=r.className||"",f=d.length?d.split(" "):[];if(typeof h<"u"&&!co.languages()[h]){const m=h.replace("-",""),w=co.allLanguages?co.allLanguages[h]:co[m];w&&co.registerLanguage(w)}co.setLanguage(h),a=co(a).format(u||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),r.className=f.join(" "),e.dir="ltr"}oo(s,e,t,n,o,a,r)}np.RENDERER_TYPE=JF;const eV="password";function sp(s,e,t,n,o,i,r){oo.apply(this,[s,e,t,n,o,i,r]);const a=r.hashLength||e.innerHTML.length,l=r.hashSymbol||"*";let h="";me(a-1,()=>{h+=l}),$o(e,h)}sp.RENDERER_TYPE=eV;const tV="time";function op(s,e,t,n,o,i,r){oo.apply(this,[s,e,t,n,o,i,r]),e.dir="ltr"}op.RENDERER_TYPE=tV;function nV(){Xn($i),Xn(la),Xn(ep),Xn(Jm),Xn(np),Xn(sp),Xn(oo),Xn(op)}const sV="autocomplete";function sc(s,e){let t=s;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,NC(t,e)):NC(t,e)(this.source):e(!0)}sc.VALIDATOR_TYPE=sV;function NC(s,e){const t=s;return function(n){let o=!1;for(let i=0,r=n.length;i<r;i++)if(t===n[i]){o=!0;break}e(o)}}function wR(s){const e=new Date(s);return isNaN(new Date(`${s}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const oV=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:wR},Symbol.toStringTag,{value:"Module"})),iV="date";function ip(s,e){const t=lb(uR,this.instance);let n=s,o=!0;n==null&&(n="");let i=Z(n,this.dateFormat||t.defaultDateFormat,!0).isValid(),r=Z(new Date(n)).isValid()||i;if(this.allowEmpty&&n===""&&(r=!0,i=!0),r||(o=!1),!r&&i&&(o=!0),r&&!i)if(this.correctFormat===!0){const a=rV(n,this.dateFormat),l=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,h,a,"dateValidator"),o=!0}else o=!1;e(o)}ip.VALIDATOR_TYPE=iV;function rV(s,e){const t=Z(wR(s)),n=Z(s,e),o=s.search(/[A-z]/g)>-1;let i;return t.isValid()&&t.format("x")===n.format("x")||!n.isValid()||o?i=t:i=n,i.format(e)}const aV="numeric";function rp(s,e){let t=s;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:Qt(s))}rp.VALIDATOR_TYPE=aV;const lV=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],hV="time";function ap(s,e){const t=this.timeFormat||"h:mm:ss a";let n=!0,o=s;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const i=/^\d{1,2}$/.test(o);i&&(o+=":00");const r=Z(o,lV,!0).isValid()?Z(o):Z(o,t);let a=r.isValid(),l=Z(o,t,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(a=!0,l=!0),a||(n=!1),!a&&l&&(n=!0),a&&!l)if(this.correctFormat===!0){const h=r.format(t),u=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(u,d,h,"timeValidator"),n=!0}else n=!1;e(n)}ap.VALIDATOR_TYPE=hV;function uV(){pi(sc),pi(ip),pi(rp),pi(ap)}const cV="autocomplete",dV={CELL_TYPE:cV,editor:Zm,renderer:$i,validator:sc},fV="checkbox",CR={CELL_TYPE:fV,editor:lR,renderer:ep},gV="date",yR={CELL_TYPE:gV,editor:cR,renderer:$i,validator:ip},mV="dropdown",SR={CELL_TYPE:mV,editor:Qm,renderer:$i,validator:sc},pV="handsontable",wV={CELL_TYPE:pV,editor:qm,renderer:$i},CV="numeric",vR={CELL_TYPE:CV,editor:dR,renderer:np,validator:rp,dataType:"number"},yV="password",SV={CELL_TYPE:yV,editor:fR,renderer:sp,copyable:!1},vV="time",bV={CELL_TYPE:vV,editor:gR,renderer:op,validator:ap};function RV(){Zt(dV),Zt(CR),Zt(yR),Zt(SR),Zt(wV),Zt(vR),Zt(SV),Zt(iR),Zt(bV)}function EV(s,e){TV(s,e),e.add(s)}function TV(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MV(s,e,t){if(!e.has(s))throw new TypeError("attempted to get private field on non-instance");return t}const kC=new Map([["plugin",cP],["cell-type",tR],["editor",ab],["renderer",gb],["validator",mb]]),OV="base",fo=new WeakMap,ld=[];let Un=null;var LC=new WeakSet;class je{static get PLUGIN_KEY(){return OV}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){EV(this,LC),rs(this,"hot",e,{writable:!1}),fo.set(this,{hooks:{}}),Un=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const o=[];if(t.forEach(i=>{const[r,a]=i.split(":");if(!kC.has(r))throw new Error(`Unknown plugin dependency type "${r}" was found.`);kC.get(r)(a)||o.push(` - ${a} (${r})`)}),o.length>0){const i=[`The ${this.pluginName} plugin requires the following modules:
`,`${o.join(`
`)}
`].join("");ld.push(i)}}if(Un||(Un=fm()),Un.indexOf("UndoRedo")>=0&&Un.splice(Un.indexOf("UndoRedo"),1),Un.indexOf(this.pluginName)>=0&&Un.splice(Un.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Un.length===0){if(ld.length>0){const o=[`${ld.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(o)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){fo.get(this).hooks[e]=fo.get(this).hooks[e]||[];const n=fo.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),fo.get(this).hooks[e]=n}removeHooks(e){I(fo.get(this).hooks[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=fo.get(this).hooks;Fe(e,(t,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){I(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=MV(this,LC,IV).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),Fe(this,(e,t)=>{t!=="hot"&&(this[t]=null)}),delete this.t,delete this.hot}}function IV(s){if(!s)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(s[e[t]]!==void 0)return!0;return!1}let _V=class{constructor(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),I(this.rows,t=>{e(t.row,dt(t.table)-1)})}getWidths(e){this.injected||this.injectTable(),I(this.columns,t=>{const{width:n}=t.table.getBoundingClientRect();e(t.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(){const e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1)),this.samples.forEach(t=>{I(t.strings,n=>{e.appendChild(this.createColElement(n.col))})}),e}createRow(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),o=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),n.appendChild(o)),this.samples.forEach(i=>{I(i.strings,r=>{const a=r.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const h=this.hot.getCellRenderer(l),u=t.createElement("td");u.setAttribute("ghost-table",1),h(this.hot,u,e,a,this.hot.colToProp(a),r.value,l),n.appendChild(u)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const o=e.createElement("th");n.push([-1,o]),t.appendChild(o)}this.samples.forEach(o=>{I(o.strings,i=>{const r=i.col,a=e.createElement("th");n.push([r,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),I(n,o=>{const[i,r]=o;this.hot.view.appendColHeader(i,r)})}createCol(e){const{rootDocument:t}=this.hot,n=t.createDocumentFragment();return this.samples.forEach(o=>{I(o.strings,i=>{const r=i.row,a=this.hot.getCellMeta(r,e);a.col=e,a.row=r;const l=this.hot.getCellRenderer(a),h=t.createElement("td"),u=t.createElement("tr");h.setAttribute("ghost-table",1),l(this.hot,h,r,e,this.hot.colToProp(e),i.value,a),u.appendChild(h),n.appendChild(u)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e){const t=this.hot.rootDocument.createElement("col");return t.style.width=`${this.hot.view._wt.wtTable.getStretchedColumnWidth(e)}px`,t}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),o=t.createElement("table"),i=t.createElement("thead"),r=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),h=t.createElement("th");return this.isVertical()&&o.appendChild(a),this.isHorizontal()&&(l.appendChild(h),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&r.appendChild(l),o.appendChild(r),J(o,e),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:r,colGroup:a,tr:l,th:h}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,n=t.createDocumentFragment(),o=t.createElement("div"),i=`htGhostTable htAutoSize ${e.trim()}`;return J(o,i),n.appendChild(o),{fragment:n,container:o}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const lp=_V;class hp{static get SAMPLE_COUNT(){return 3}constructor(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1}getSampleCount(){return this.customSampleCount?this.customSampleCount:hp.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,n){const o=new Map,{from:i,to:r}=typeof n=="number"?{from:n,to:n}:n;return me(i,r,a=>{const l=this.generateSample(e,t,a);o.set(a,l)}),o}generateSample(e,t,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const o=new Map,i=e==="row"?"col":"row",r=[];return me(t.from,t.to,a=>{const{value:l,bundleSeed:h}=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n),u=typeof h=="string"&&h.length>0;let d;u?d=h:Le(l)?d=`${Object.keys(l).length}`:Array.isArray(l)?d=`${l.length}`:d=`${Ct(l).length}`,o.has(d)||o.set(d,{needed:this.getSampleCount(),strings:[]});const f=o.get(d);f.needed&&(!(r.indexOf(l)>-1)||this.allowDuplicates||u)&&(f.strings.push({value:l,[i]:a}),r.push(l),f.needed-=1)}),o}}const bR=hp;ce.getSingleton().register("modifyAutoColumnSizeSeed");const qi="autoColumnSize",AV=10,hd=new WeakMap,xV="autoColumnSize";class bi extends je{static get PLUGIN_KEY(){return qi}static get PLUGIN_PRIORITY(){return AV}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),hd.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new lp(this.hot),this.samplesGenerator=new bR((t,n)=>{const o=this.hot.getCellMeta(t,n);let i="";o.spanned||(i=this.hot.getDataAtCell(t,n));let r="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(r=this.hot.runHooks("modifyAutoColumnSizeSeed",r,o,i)),{value:i,bundleSeed:r}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new so,this.hot.columnIndexMapper.registerMap(xV,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,n,o)=>this.onBeforeColumnResize(t,n,o))}isEnabled(){return this.hot.getSettings()[qi]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[qi];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",n=>this.onBeforeChange(n)),this.addHook("afterFormulasValuesUpdate",n=>this.onAfterFormulasValuesUpdate(n)),this.addHook("beforeViewRender",n=>this.onBeforeViewRender(n)),this.addHook("modifyColWidth",(n,o)=>this.getColumnWidth(o,n)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,n)=>this.onBeforeColumnResize(e,t,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.hot.renderCall,n=this.getFirstVisibleColumn(),o=this.getLastVisibleColumn();n===-1||o===-1||this.calculateColumnsWidth({from:n,to:o},void 0,t)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,i=typeof t=="number"?{from:t,to:t}:t;me(o.from,o.to,r=>{let a=this.hot.toPhysicalColumn(r);if(a===null&&(a=r),n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(r,i);I(l,h=>{let[u,d]=h;return this.ghostTable.addColumn(u,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,a)=>{const l=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0;const n=this.hot.countCols()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot){Nr(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:t,to:Math.min(t+bi.CALCULATION_STEP,n)},e),t=t+bi.CALCULATION_STEP+1,t<n?o=Hh(i):(Nr(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateColumnsWidth({from:0,to:r},e),this.firstCalculation=!1,t=r+1),t<n?i():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[qi],t=e&&wt(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&wt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[qi];let t=bi.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return Le(e)&&(t=e.syncLimit,Jg(t)?t=cm(n,t):t>>=0),Math.min(t,n)}getColumnWidth(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=t;return o===void 0&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof o=="number"&&(o=Math.max(o,pm.DEFAULT_WIDTH))),o}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getFirstVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getFirstRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getLastVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getLastRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader(),{cachedColumnHeaders:t}=hd.get(this);return bt(e,(o,i,r)=>{const a=t.length;return(a-1<r||t[r]!==i)&&o.push(r),a-1<r?t.push(i):t[r]=i,o},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{I(e,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!gn(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){const t=ke(e,n=>{let[,o]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(o))});this.clearCache(Array.from(new Set(t)))}onBeforeColumnResize(e,t,n){let o=e;return n&&(this.calculateColumnsWidth(t,void 0,!0),o=this.getColumnWidth(t,void 0,!1)),o}onAfterInit(){hd.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){const t=gn(e,o=>{var i;return le((i=o.address)===null||i===void 0?void 0:i.col)}),n=ke(t,o=>o.address.col);this.clearCache(Array.from(new Set(n)))}destroy(){this.ghostTable.clean(),super.destroy()}}const To={horizontal:"horizontal",vertical:"vertical"};function HV(s,e,t){let n,o,i;return e[0]===s[0]&&e[1]<s[1]?(i="left",n=t(e[0],e[1]),o=t(e[2],s[1]-1)):e[2]===s[2]&&e[0]===s[0]&&e[3]>s[3]?(i="right",n=t(e[0],s[3]+1),o=t(e[2],e[3])):e[0]<s[0]&&e[1]===s[1]?(i="up",n=t(e[0],e[1]),o=t(s[0]-1,e[3])):e[2]>s[2]&&e[1]===s[1]&&(i="down",n=t(s[2]+1,e[1]),o=t(e[2],e[3])),n&&n.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:n,endOfDragCoords:o}}function DV(s){const e={};return s===!0?(e.directions=Object.keys(To),e.autoInsertRow=!0):Le(s)?(le(s.autoInsertRow)?s.direction===To.horizontal?e.autoInsertRow=!1:e.autoInsertRow=s.autoInsertRow:e.autoInsertRow=!1,le(s.direction)?e.directions=[s.direction]:e.directions=Object.keys(To)):typeof s=="string"?(e.directions=[s],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}ce.getSingleton().register("modifyAutofillRange");ce.getSingleton().register("beforeAutofill");ce.getSingleton().register("afterAutofill");const FC="autofill",PV=20,NV=["fillHandle"],kV="insert_row_below",LV=200;class FV extends je{static get PLUGIN_KEY(){return FC}static get PLUGIN_PRIORITY(){return PV}static get SETTING_KEYS(){return[FC,...NV]}constructor(e){super(e),this.eventManager=new ft(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,t)=>this.onBeforeCellMouseOver(t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:n}=e.getTopStartCorner(),{row:o,col:i}=e.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:n,endRow:o,endCol:i}]),a=[],l=[],h=[];return I(r,u=>{for(let d=u.startRow;d<=u.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=u.startCol;d<=u.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),I(a,u=>{const d=[];I(l,f=>{d.push(this.hot.getCopyableData(u,f))}),h.push(d)}),h}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,n,o]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),a=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[r.row,r.col,a.row,a.col],h=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,e),Math.min(r.col,t),Math.max(a.row,n),Math.max(a.col,o)],l),{directionOfDrag:u,startOfDragCoords:d,endOfDragCoords:f}=HV(l,h,(m,w)=>this.hot._createCellCoords(m,w));if(d&&d.row>-1&&d.col>-1){const m=this.getSelectionData(),w=i.clone(),C=this.hot._createCellRange(d,d,f),R=this.hot.runHooks("beforeAutofill",m,w,C,u);if(R===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let H=R;const A=R;if(["up","left"].indexOf(u)>-1&&!(A.length===1&&A[0].length===0))if(H=[],u==="up"){const _=f.row-d.row+1,O=_%A.length;for(let D=0;D<_;D++)H.push(A[(D+(A.length-O))%A.length])}else{const _=f.col-d.col+1,O=_%A[0].length;for(let D=0;D<A.length;D++){H.push([]);for(let G=0;G<_;G++)H[D].push(A[D][(G+(A[D].length-O))%A[D].length])}}this.hot.populateFromArray(d.row,d.col,H,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(h),this.hot.runHooks("afterAutofill",H,w,C,u),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),n=t.getBottomEndCorner();let o=e;if(this.directions.includes(To.vertical)&&this.directions.includes(To.horizontal)){const i=t.getTopStartCorner();(n.col<=e.col||i.col>=e.col)&&(o=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||i.row>e.row)&&(o=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(To.vertical))o=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(To.horizontal))o=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(o)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(kV,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},LV)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&t[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),n=this.hot.countRows();let o;for(let i=e[2]+1;i<n;i++){for(let l=e[1];l<=e[3];l++)if(t[i][l])return-1;const r=t[i][e[1]-1],a=t[i][e[3]+1];(r||a)&&(o=i)}return o}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...ke(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,n=Tt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+dt(this.hot.table),o=Tt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+Qe(this.hot.table);return e.clientY>n&&e.clientX<=o}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){const t=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=DV(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}const Fa="autoRowSize",VV=40,$V="autoRowSize";class br extends je{static get PLUGIN_KEY(){return Fa}static get PLUGIN_PRIORITY(){return VV}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new lp(this.hot),this.samplesGenerator=new bR((t,n)=>{let o;return t>=0?o=this.hot.getDataAtCell(t,n):t===-1&&(o=this.hot.getColHeader(n)),{value:o}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new so,this.hot.rowIndexMapper.registerMap($V,this.rowHeightsMap),this.addHook("beforeRowResize",(t,n,o)=>this.onBeforeRowResize(t,n,o))}isEnabled(){const e=this.hot.getSettings()[Fa];return e===!0||Le(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",t=>this.onBeforeChange(t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>this.onBeforeViewRender(t)),this.addHook("modifyRowHeight",(t,n)=>this.getRowHeight(n,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,n)=>this.onBeforeRowResize(e,t,n))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,i=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const r=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(r.get(-1))}me(o.from,o.to,r=>{if(n||this.rowHeightsMap.getValueAtIndex(r)===null){const a=this.samplesGenerator.generateRowSamples(r,i);I(a,l=>{let[h,u]=l;return this.ghostTable.addRow(h,u)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,a)=>{r<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(r),a)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0;const n=this.hot.countRows()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot){Nr(o),this.inProgress=!1;return}this.calculateRowsHeight({from:t,to:Math.min(t+br.CALCULATION_STEP,n)},e),t=t+br.CALCULATION_STEP+1,t<n?o=Hh(i):(Nr(o),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateRowsHeight({from:0,to:r},e),this.firstCalculation=!1,t=r+1),t<n?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Fa],t=e&&wt(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&wt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllRowsHeight(){Ei(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Fa];let t=br.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return Le(e)&&(t=e.syncLimit,Jg(t)?t=cm(n,t):t>>=0),Math.min(t,n)}getRowHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let o=t;return n!==null&&n>(t||0)&&(o=n),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:t,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(t,n),Math.max(t,n),o=>{this.rowHeightsMap.setValueAtIndex(o,null)})},!0)}isNeedRecalculate(){return!!gn(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}onBeforeViewRender(){const e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(!(n===-1||o===-1)){if(this.calculateRowsHeight({from:n,to:o},void 0,e),t){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-t,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}onBeforeRowResize(e,t,n){let o=e;return n&&(this.calculateRowsHeight(t,void 0,!0),o=this.getRowHeight(t)),o}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():setTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()},0)}onBeforeChange(e){let t=null;e.length===1?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),t!==null&&this.clearCacheByRange(t)}destroy(){this.ghostTable.clean(),super.destroy()}}const{getListWithInsertedItems:WV,getListWithRemovedItems:BV}=$b("physicallyIndexed");class UV extends Wo{constructor(){super(e=>e)}insert(e,t){const n=Fm(this.indexedValues,t);this.indexedValues=WV(n,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=BV(this.indexedValues,e);this.indexedValues=Lm(t,e),super.remove(e)}}const YV=UV,{getListWithInsertedItems:zV,getListWithRemovedItems:GV}=$b("physicallyIndexed");class jV extends Wo{constructor(){super(e=>e)}insert(e,t){this.indexedValues=zV(this.indexedValues,e,t,(n,o)=>this.getNextValue(o)),super.insert(e,t)}remove(e){this.indexedValues=GV(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const KV=jV,ud="bindRowsWithHeaders",XV=210,qV="loose",ZV=new Map([["loose",YV],["strict",KV]]);class QV extends je{static get PLUGIN_KEY(){return ud}static get PLUGIN_PRIORITY(){return XV}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[ud]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[ud];typeof e!="string"&&(e=qV);const t=ZV.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",n=>this.onModifyRowHeader(n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}function JV(s,e,t){e$(s,e),e.set(s,t)}function e$(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cd(s,e,t){return e=t$(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function t$(s){var e=n$(s,"string");return typeof e=="symbol"?e:String(e)}function n$(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function VC(s,e){var t=RR(s,e,"get");return s$(s,t)}function s$(s,e){return e.get?e.get.call(s):e.value}function dd(s,e,t){var n=RR(s,e,"set");return o$(s,n,t),t}function RR(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function o$(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const fd="collapsibleColumns",i$=290,r$=["nestedHeaders"],Qo="collapsibleIndicator",$C=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Jo=new WeakMap;class a$ extends je{constructor(){super(...arguments),cd(this,"nestedHeadersPlugin",null),cd(this,"eventManager",new ft(this)),cd(this,"headerStateManager",null),JV(this,Jo,{writable:!0,value:null})}static get PLUGIN_KEY(){return fd}static get PLUGIN_PRIORITY(){return i$}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[fd,...r$]}isEnabled(){return!!this.hot.getSettings()[fd]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||it("You need to configure the Nested Headers plugin in order to use collapsible headers."),dd(this,Jo,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(n,o,i)=>this.onBeforeOnCellMouseDown(n,o,i)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),dd(this,Jo,null),this.nestedHeadersPlugin=null,this.clearButtons(),super.disablePlugin()}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(r){r&&r.parentNode.removeChild(r)};me(0,e-1,r=>{const a=t.childNodes[r],l=n.childNodes[r],h=o?o.childNodes[r]:null;me(0,a.childNodes.length-1,u=>{let d=a.childNodes[u].querySelector(`.${Qo}`);i(d),l&&l.childNodes[u]&&(d=l.childNodes[u].querySelector(`.${Qo}`),i(d)),o&&h&&h.childNodes[u]&&(d=h.childNodes[u].querySelector(`.${Qo}`),i(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(n=>{const{collapsible:o,origColspan:i,headerLevel:r,columnIndex:a,isCollapsed:l}=n;if(o===!0&&i>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(r),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!$C.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const n=gn(e,f=>{let{row:m}=f;return m<0});let o=n.length>0;I(n,f=>{var m;let{row:w,col:C}=f;const{collapsible:R,isCollapsed:H}=(m=this.headerStateManager.getHeaderSettings(w,C))!==null&&m!==void 0?m:{};if(!R||H&&t==="collapse"||!H&&t==="expand")return o=!1,!1});const i=[],r=[];o&&I(n,f=>{let{row:m,col:w}=f;const{colspanCompensation:C,affectedColumns:R,rollbackModification:H}=this.headerStateManager.triggerNodeModification(t,m,w);C>0&&(r.push(...R),i.push(H))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=Zg([...a,...r]):t==="expand"&&(l=gn(a,f=>!r.includes(f)));const h=$C.get(t);if(this.hot.runHooks(h.beforeHook,a,l,o)===!1){I(i,f=>{f()});return}this.hot.batchExecution(()=>{I(r,f=>{VC(this,Jo).setValueAtIndex(this.hot.toPhysicalColumn(f),h.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(h.afterHook,a,l,o,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return VC(this,Jo).getHiddenIndexes()}onAfterGetColHeader(e,t,n){var o;const{collapsible:i,origColspan:r,isCollapsed:a}=(o=this.headerStateManager.getHeaderSettings(n,e))!==null&&o!==void 0?o:{},l=i&&r>1&&e>=this.hot.getSettings().fixedColumnsStart;let h=t.querySelector(`.${Qo}`);if(l)h||(h=this.hot.rootDocument.createElement("div"),J(h,Qo),t.querySelector("div:first-child").appendChild(h)),_e(h,["collapsed","expanded"]),a?(J(h,"collapsed"),Js(h,"+")):(J(h,"expanded"),Js(h,"-"));else{var u;(u=h)===null||u===void 0||u.remove()}}onBeforeOnCellMouseDown(e,t){Oe(e.target,Qo)&&(Oe(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Oe(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),Fn(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){dd(this,Jo,null),super.destroy()}}const l$=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],h$=!1,u$=!0,c$=!0;class d${constructor(e,t){this.hot=e,this.sortingStates=new Nh,this.sortEmptyCells=h$,this.indicator=u$,this.headerAction=c$,this.compareFunctionFactory=void 0,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){Le(e)&&Fe(e,(t,n)=>{l$.includes(n)&&(this[n]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[n]=t;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Le(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[n,o]=t;return{column:this.hot.toVisualColumn(n),...o}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(le(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const ql="asc",Zl="desc",f$="colHeader";function g$(s){if(Le(s)===!1)return!1;const{column:e,sortOrder:t}=s;return Number.isInteger(e)&&[ql,Zl].includes(t)}function m$(s){if(s.some(t=>g$(t)===!1))return!1;const e=s.map(t=>{let{column:n}=t;return n});return new Set(e).size===e.length}function WC(s){if(s!==Zl)return s===ql?Zl:ql}function BC(s){return s.querySelector(`.${f$}`)}function UC(s,e){if(s<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function sg(s,e,t){return s===-1&&e>=0&&to(t)===!1}const p$="ascending",w$="descending",ER="indicatorDisabled",TR="columnSorting",MR="sortAction",OR=new Map([[ql,p$],[Zl,w$]]);function C$(s,e,t,n){const o=[TR];if(n&&o.push(MR),t===!1)return o.push(ER),o;const i=s.getSortOrderOfColumn(e);return le(i)&&o.push(OR.get(i)),o}function y$(){return Array.from(OR.values()).concat(MR,ER,TR)}function IR(s,e,t){const n=e.locale;return function(o,i){const{sortEmptyCells:r}=t;return typeof o=="string"&&(o=o.toLocaleLowerCase(n)),typeof i=="string"&&(i=i.toLocaleLowerCase(n)),o===i?es:It(o)?It(i)?es:r&&s==="asc"?mt:pt:It(i)?r&&s==="asc"?pt:mt:isNaN(o)&&!isNaN(i)?s==="asc"?pt:mt:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?s==="asc"?mt:pt:o>i?s==="asc"?pt:mt:es}}const _R="default";function S$(s,e,t){return function(n,o){const i=parseFloat(n),r=parseFloat(o),{sortEmptyCells:a}=t;if(i===r||isNaN(i)&&isNaN(r))return es;if(a){if(It(n))return s==="asc"?mt:pt;if(It(o))return s==="asc"?pt:mt}return isNaN(i)?pt:isNaN(r)?mt:i<r?s==="asc"?mt:pt:i>r?s==="asc"?pt:mt:es}}const v$="numeric";function b$(s,e,t){const n=e.checkedTemplate,o=e.uncheckedTemplate,{sortEmptyCells:i}=t;return function(r,a){const l=It(r),h=It(a),u=l?o:r,d=h?o:a,f=u===o||u===n,m=d===o||d===n;if(i===!1){if(l&&h===!1)return pt;if(l===!1&&h)return mt}return f===!1&&m?s==="asc"?mt:pt:f&&m===!1?s==="asc"?pt:mt:f===!1&&m===!1?IR(s,e,t)(r,a):u===o&&d===n?s==="asc"?mt:pt:u===n&&d===o?s==="asc"?pt:mt:es}}const R$="checkbox";function E$(s,e,t){return function(n,o){const{sortEmptyCells:i}=t;if(n===o)return es;if(It(n))return It(o)?es:i&&s==="asc"?mt:pt;if(It(o))return i&&s==="asc"?pt:mt;const r=e.dateFormat,a=Z(n,r),l=Z(o,r);return a.isValid()?l.isValid()?l.isAfter(a)?s==="asc"?mt:pt:l.isBefore(a)?s==="asc"?pt:mt:es:mt:pt}}const T$="date",{register:oc,getItem:YC,hasItem:M$}=Mn("sorting.compareFunctionFactory"),{register:AR,getItem:O$}=Mn("sorting.mainSortComparator");function xR(s){return M$(s)?YC(s):YC(_R)}oc(v$,S$);oc(R$,b$);oc(T$,E$);oc(_R,IR);const es=0,mt=-1,pt=1;function I$(s,e){const t=O$(e);for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];s.sort(t(...o))}function _$(s,e){return function(t,n){const[,...o]=t,[,...i]=n;return function(a){const l=s[a],h=e[a],u=o[a],d=i[a],f=h.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:xR(h.type))(l,h,f)(u,d)}(0)}}const og="columnSorting",A$=50,zC="append",x$="replace";AR(og,_$);ce.getSingleton().register("beforeColumnSort");ce.getSingleton().register("afterColumnSort");class HR extends je{static get PLUGIN_KEY(){return og}static get PLUGIN_PRIORITY(){return A$}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=og,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new d$(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new so(t=>{let n=this.hot.toVisualColumn(t);return n===null&&(n=t),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,n)=>this.onAfterGetColHeader(t,n)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(t,n)=>this.onAfterOnCellMouseDown(t,n)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),super.enablePlugin())}disablePlugin(){const e=(t,n)=>{const o=BC(n);UC(t,n)===!1||o===null||this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,super.disablePlugin()}sort(e){const t=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",t,n,o)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Wb),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",t,o?n:t,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return m$(e)&&e.every(n=>{let{column:o}=n;return o<=t&&o>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),n=o=>{let{column:i,...r}=o;return{column:this.hot.toPhysicalColumn(i),...r}};t.initialConfig=ke(e,n),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,n=o=>{let{column:i,...r}=o;return{column:this.hot.toVisualColumn(i),...r}};return le(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=ke(t.initialConfig,n)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(le(t)){const o=WC(t);return le(o)?{column:e,sortOrder:o}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:WC()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zC;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),o=n!==-1,i=this.getSortConfig(),r=this.getColumnNextConfig(e);if(o){if(st(r))return[...i.slice(0,n),...i.slice(n+1)];if(t===zC)return[...i.slice(0,n),...i.slice(n+1),r];if(t===x$)return[...i.slice(0,n),r,...i.slice(n+1)]}return le(r)?i.concat(r):i}getPluginColumnConfig(e){if(Le(e)){const t=e[this.pluginKey];if(Le(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(o);return Array.isArray(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns[e])):nt(i.columns)?Object.assign(n,t,this.getPluginColumnConfig(i.columns(e))):Object.assign(n,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),n=Object.create(t);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const t=[],n=this.hot.countRows(),o=h=>ke(e,u=>this.hot.getDataAtCell(h,u.column));for(let h=0;h<this.getNumberOfRowsToSort(n);h+=1)t.push([this.hot.toPhysicalRow(h)].concat(o(h)));const i=ke(t,h=>h[0]);I$(t,this.pluginKey,ke(e,h=>h.sortOrder),ke(e,h=>this.getFirstCellSettings(h.column)));for(let h=t.length;h<n;h+=1)t.push([h].concat(o(h)));const r=ke(t,h=>h[0]),a=new Map(ke(i,(h,u)=>[h,r[u]])),l=ke(this.hot.rowIndexMapper.getIndexesSequence(),h=>a.has(h)?a.get(h):h);this.hot.rowIndexMapper.setIndexesSequence(l)}loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if(Le(e))this.sortBySettings(e);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}sortBySettings(e){if(Le(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||Le(t))&&this.sort(t)}else this.hot.render()}onAfterGetColHeader(e,t){const n=BC(t);if(UC(e,t)===!1||n===null)return;const o=this.getFirstCellSettings(e)[this.pluginKey],i=o.indicator,r=o.headerAction;this.updateHeaderClasses(n,this.columnStatesManager,e,i,r)}updateHeaderClasses(e){if(_e(e,y$()),this.enabled!==!1){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];J(e,C$(...n))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){e===!0&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onBeforeOnCellMouseDown(e,t,n,o){sg(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}onAfterOnCellMouseDown(e,t){sg(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}class H${constructor(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),I(n,o=>{const i={};this.assignSetting(o,i,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(o,i,"reversedRowCoords",!1),this.assignSetting(o,i,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,i,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,i,"sourceColumn",o.destinationColumn),this.assignSetting(o,i,"type","sum"),this.assignSetting(o,i,"forceNumeric",!1),this.assignSetting(o,i,"suppressDataTypeErrors",!0),this.assignSetting(o,i,"suppressDataTypeErrors",!0),this.assignSetting(o,i,"customFunction",null),this.assignSetting(o,i,"readOnly",!0),this.assignSetting(o,i,"roundFloat",!1),t.push(i)}),t}assignSetting(e,t,n,o){if(n==="ranges"&&e[n]===void 0){t[n]=o;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(o instanceof Error)throw o;t[n]=o}else n==="destinationRow"&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]}resetSetupBeforeStructureAlteration(e,t,n){if(this.settingsType!=="function")return;const o=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();I(i,r=>{o==="row"&&r.destinationRow>=t&&(e==="insert_row"?r.alterRowOffset=n:e==="remove_row"&&(r.alterRowOffset=-1*n)),o==="col"&&r.destinationColumn>=t&&(e==="insert_col"?r.alterColumnOffset=n:e==="remove_col"&&(r.alterColumnOffset=-1*n))}),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,t,n,o,i){let r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,h=this.getAllEndpoints(),u=e.indexOf("move_row")===0,d=t;I(h,f=>{a==="row"&&f.destinationRow>=d&&(f.alterRowOffset=l*n),a==="col"&&f.destinationColumn>=d&&(f.alterColumnOffset=l*n)}),this.resetAllEndpoints(h,!u),u?I(h,f=>{this.extendEndpointRanges(f,d,o[0],o.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):I(h,f=>{this.shiftEndpointCoordinates(f,d)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,n,o){I(e.ranges,i=>{i[1]&&(t>=i[0]&&t<=i[1]?n>i[1]?i[1]+=o:n<i[0]&&(i[0]-=o):n>=i[0]&&n<=i[1]&&(i[1]-=o,t<=i[0]&&(i[0]+=1,i[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,n=[],o=[];I(t,i=>{const r=[];if(i[1])for(let a=i[0];a<=i[1];a++)r.push(this.hot.toPhysicalRow(a));else r.push(this.hot.toPhysicalRow(i[0]));o.push(r)}),I(o,i=>{let r=[];I(i,(a,l)=>{l===0?r.push(a):i[l]!==i[l-1]+1&&(r.push(i[l-1]),n.push(r),r=[],r.push(a)),l===i.length-1&&(r.push(a),n.push(r))})}),e.ranges=n}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,I(e.ranges,n=>{I(n,(o,i)=>{o>=t&&(n[i]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(o=>{const i=o.alterRowOffset||0,r=o.alterColumnOffset||0;return o.destinationRow+i>=this.hot.countRows()||o.destinationColumn+r>=this.hot.countCols()})||(this.cellsToSetCache=[],I(e,o=>{this.resetEndpointValue(o,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],I(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],I(e,(n,o,i)=>{`${n[2]||""}`!=`${n[3]}`&&I(this.getAllEndpoints(),(r,a)=>{this.hot.propToCol(i[o][1])===r.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),I(t,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,o=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?n:0)),this.hot.toVisualColumn(e.destinationColumn+(t?o:0)),""])}setEndpointValue(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const i=this.hot.toVisualRow(e.destinationRow);if(i!==null){const r=this.hot.getCellMeta(i,e.destinationColumn);(t==="init"||r.readOnly!==e.readOnly)&&(r.readOnly=e.readOnly,r.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){it("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const D$=H$;function gd(s){return s==null||isNaN(s)}const md="columnSummary",P$=220;class N$ extends je{static get PLUGIN_KEY(){return md}static get PLUGIN_PRIORITY(){return P$}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[md]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[md],this.endpoints=new D$(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(t,n,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,o)),this.addHook("beforeCreateCol",(t,n,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,o)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(t,n,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,o)),this.addHook("afterCreateCol",(t,n,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,o)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return Fe(e.ranges,n=>{t+=this.getPartialSum(n,e.sourceColumn)}),t}getPartialSum(e,t){let n=0,o=e[1]||e[0],i=null,r=0;do{if(i=this.getCellValue(o,t),i=gd(i)?null:i,i!==null){const a=(`${i}`.split(".")[1]||[]).length||1;a>r&&(r=a)}n+=i||0,o-=1}while(o>=e[0]);return Math.round(n*10**r)/10**r}calculateMinMax(e,t){let n=null;return Fe(e.ranges,o=>{const i=this.getPartialMinMax(o,e.sourceColumn,t);if(n===null&&i!==null&&(n=i),i!==null)switch(t){case"min":n=Math.min(n,i);break;case"max":n=Math.max(n,i);break}}),n===null?"Not enough data":n}getPartialMinMax(e,t,n){let o=null,i=e[1]||e[0],r;do{if(r=this.getCellValue(i,t),r=gd(r)?null:r,o===null)o=r;else if(r!==null)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r);break}i-=1}while(i>=e[0]);return o}countEmpty(e,t){let n,o=0,i=e[1]||e[0];do n=this.getCellValue(i,t),n=gd(n)?null:n,n===null&&(o+=1),i-=1;while(i>=e[0]);return o}countEntries(e){let t=0;const n=e.ranges;return Fe(n,o=>{const i=o[1]===void 0?1:o[1]-o[0]+1,r=this.countEmpty(o,e.sourceColumn);t+=i,t-=r}),t}calculateAverage(e){const t=this.calculateSum(e),n=this.countEntries(e);return t/n}getCellValue(e,t){const n=this.hot.toVisualRow(e),o=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),r="";if(n!==null&&o!==null&&(r=this.hot.getCellMeta(n,o).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof i=="string"&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Je`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,t){e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}class Ci{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){this.rootDocument=e,this.isRtl=t,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,t){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${t}px`}setSize(e,t){if(e&&t){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${t}px`}}getSize(){return{width:Qe(this.getInputElement()),height:dt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),J(this.container,Ci.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),J(e,Ci.CLASS_EDITOR),J(t,Ci.CLASS_INPUT),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Ci.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const k$=Ci,$e="---------";function L$(){return{name:$e}}function F$(s){return ke(s,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Va(s){return Oe(s,"htSeparator")}function V$(s){return Oe(s,"htSubmenu")}function $a(s){return Oe(s,"htDisabled")}function Wa(s){return Oe(s,"htSelectionDisabled")}function Uo(s){const e=s.getSelected();return!e||e[0]<0?null:e}function $$(s,e){return s.indexOf(e)!==-1?s:`${s.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function W$(s,e){return s.indexOf(e)!==-1?s:`${s.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function go(s,e){const t={};return I(s,n=>{n.forAll((o,i)=>{o>=0&&i>=0&&(t[o]||(t[o]=[]),t[o][i]=e(o,i))})}),t}function Bs(s,e,t,n,o){I(s,i=>{i.forAll((r,a)=>{r>=0&&a>=0&&B$(r,a,e,t,n,o)})})}function B$(s,e,t,n,o,i){const r=o(s,e);let a=n;r.className&&(t==="vertical"?a=$$(r.className,n):a=W$(r.className,n)),i(s,e,"className",a)}function Zn(s,e){let t=!1;return Array.isArray(s)&&I(s,n=>(n.forAll((o,i)=>{if(o>=0&&i>=0&&e(o,i))return t=!0,!1}),t)),t}function Cs(s){return`<span class="selected">${String.fromCharCode(10003)}</span>${s}`}function U$(s,e){return!s.hidden||!(typeof s.hidden=="function"&&s.hidden.call(e))}function DR(s,e){const t=s.slice(0);for(let n=0;n<t.length&&t[n].name===e;)t.shift();return t}function Y$(s,e){let t=s.slice(0);return t.reverse(),t=DR(t,e),t.reverse(),t}function z$(s){const e=[];return I(s,(t,n)=>{n>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function G$(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$e,t=s.slice(0);return t=DR(t,e),t=Y$(t,e),t=z$(t),t}const j$=250,K$=250;class PR{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},K$)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j$;this.showDebounced=om(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}tt(PR,an);const X$=PR,pd="comments",q$=60,Ba=new WeakMap,Yn="comment",ei="value",GC="style",Ua="readOnly";class Z$ extends je{static get PLUGIN_KEY(){return pd}static get PLUGIN_PRIORITY(){return q$}constructor(e){super(e),this.editor=null,this.displaySwitch=null,this.eventManager=null,this.range={},this.preventEditorAutoSwitch=!1,Ba.set(this,{tempEditorDimensions:{},cellBelowCursor:null})}isEnabled(){return!!this.hot.getSettings()[pd]}enablePlugin(){this.enabled||(this.editor||(this.editor=new k$(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new ft(this)),this.displaySwitch||(this.displaySwitch=new X$(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,n,o,i,r)=>this.onAfterRenderer(e,r)),this.addHook("afterScrollHorizontally",()=>this.hide()),this.addHook("afterScrollVertically",()=>this.hide()),this.addHook("afterBeginEditing",()=>this.hide()),this.displaySwitch.addLocalHook("hide",()=>this.hide()),this.displaySwitch.addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerListeners(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin(),this.displaySwitch.updateDelay(this.getDisplayDelaySetting())}disablePlugin(){super.disablePlugin()}registerListeners(){const{rootDocument:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>this.onMouseOver(t)),this.eventManager.addEventListener(e,"mousedown",t=>this.onMouseDown(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",t=>this.onEditorMouseDown(t)),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",t=>this.onEditorMouseUp(t))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=js(e.target,"TD","TBODY");return!!(t&&Oe(t,"htCommentCell")&&js(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.editor.getInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=this.editor.getValue();let n="";e!=null?n=e:t!=null&&(n=t);const o=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(o,i,{[ei]:n}),this.hot.render()}setCommentAtCell(e,t,n){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Yn),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(n)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,ei)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,ei)}show(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:e,col:t}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||t<0||t>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.editor.setValue(n[Yn]?n[Yn][ei]:""),this.editor.show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){this.editor.hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!this.editor.isVisible()))return;const{rowIndexMapper:o,columnIndexMapper:i}=this.hot,{row:r,col:a}=this.range.from;let l=o.getRenderableFromVisualIndex(r),h=i.getRenderableFromVisualIndex(a);const u=l===null;this.editor.setPosition(0,0),l===null&&(l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1))),h===null&&(h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1)));const d=l===null,f=h===null;l=(e=l)!==null&&e!==void 0?e:0,h=(t=h)!==null&&t!==void 0?t:0;const{rootWindow:m,view:{_wt:w}}=this.hot,{wtTable:C}=w,R=w.getCell({row:l,col:h},!0),H=this.getCommentMeta(r,a,GC);H?this.editor.setSize(H.width,H.height):this.editor.resetSize();const A=f?0:C.getStretchedColumnWidth(h),_=u&&!d?dt(R):0,{left:O,top:D,width:G,height:z}=R.getBoundingClientRect(),{width:ee,height:X}=this.editor.getSize(),{innerWidth:q,innerHeight:oe}=this.hot.rootWindow,ie=this.hot.rootDocument.documentElement;let re=O+m.scrollX+A,pe=D+m.scrollY+_;this.hot.isRtl()&&(re-=ee+A),this.hot.isLtr()&&O+G+ee>q?re=O+m.scrollX-ee-1:this.hot.isRtl()&&re<-(ie.scrollWidth-ie.clientWidth)&&(re=O+m.scrollX+A+1),D+X>oe&&(pe-=X-z+1),this.editor.setPosition(re,pe),this.editor.setReadOnlyState(this.getCommentMeta(r,a,Ua))}checkSelectionCommentsConsistency(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=!1;const n=e.getTopStartCorner();return this.getCommentMeta(n.row,n.col,ei)&&(t=!0),t}updateCommentMeta(e,t,n){const o=this.hot.getCellMeta(e,t)[Yn];let i;o?(i=Ut(o),ea(i,n)):i=n,this.hot.setCellMeta(e,t,Yn,i)}getCommentMeta(e,t,n){const o=this.hot.getCellMeta(e,t);if(o[Yn])return o[Yn][n]}onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!this.preventEditorAutoSwitch&&!this.targetIsCommentTextArea(e)){const t=js(e.target,"TD","TBODY");let n=null;t&&(n=this.hot.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}onMouseOver(e){const t=Ba.get(this),{rootDocument:n}=this.hot;if(!(this.preventEditorAutoSwitch||this.editor.isFocused()||Oe(e.target,"wtBorder")||t.cellBelowCursor===e.target||!this.editor))if(t.cellBelowCursor=n.elementFromPoint(e.clientX,e.clientY),this.targetIsCellWithComment(e)){const o=this.hot._createCellRange(this.hot.getCoords(e.target));this.displaySwitch.show(o)}else Ks(e.target,n)&&!this.targetIsCommentTextArea(e)&&this.displaySwitch.hide()}onMouseUp(){this.preventEditorAutoSwitch=!1}onAfterRenderer(e,t){t[Yn]&&t[Yn][ei]&&J(e,t.commentedCellClassName)}onEditorBlur(){this.setComment()}onEditorMouseDown(e){const t=Ba.get(this);t.tempEditorDimensions={width:Qe(e.target),height:dt(e.target)}}onEditorMouseUp(e){const t=Ba.get(this),n=Qe(e.target),o=dt(e.target);(n!==t.tempEditorDimensions.width+1||o!==t.tempEditorDimensions.height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[GC]:{width:n,height:o}})}onContextMenuAddComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,this.displaySwitch.cancelHiding(),this.setRange({from:e.highlight}),this.show(),this.hot.deselectCell(),this.editor.focus()}onContextMenuRemoveComment(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,n)=>{t>=0&&n>=0&&this.removeCommentAtCell(t,n,!1)}),this.hot.render()}onContextMenuMakeReadOnly(){const e=this.hot.getSelectedRangeLast();this.preventEditorAutoSwitch=!0,e.forAll((t,n)=>{if(t>=0&&n>=0){const o=!!this.getCommentMeta(t,n,Ua);this.updateCommentMeta(t,n,{[Ua]:!o})}})}addToContextMenu(e){const t=()=>this.hot.rowIndexMapper.getRenderableIndexesLength()>0&&this.hot.columnIndexMapper.getRenderableIndexesLength()>0;e.items.push({name:"---------"},{key:"commentsAddEdit",name:()=>this.checkSelectionCommentsConsistency()?this.hot.getTranslatedPhrase(eu):this.hot.getTranslatedPhrase(Jh),callback:()=>this.onContextMenuAddComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsRemove",name(){return this.getTranslatedPhrase(tu)},callback:()=>this.onContextMenuRemoveComment(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner()):!0},{key:"commentsReadOnly",name(){let n=this.getTranslatedPhrase(nu);return Zn(this.getSelectedRangeLast(),(i,r)=>{let a=this.getCellMeta(i,r)[Yn];if(a&&(a=a[Ua]),a)return!0})&&(n=Cs(n)),n},callback:()=>this.onContextMenuMakeReadOnly(),disabled:()=>t()?!(this.hot.getSelectedLast()&&!this.hot.selection.isSelectedByCorner())||!this.checkSelectionCommentsConsistency():!0})}getDisplayDelaySetting(){const e=this.hot.getSettings()[pd];if(Le(e))return e.displayDelay}destroy(){this.editor&&this.editor.destroy(),this.displaySwitch&&this.displaySwitch.destroy(),super.destroy()}}var jC=sS,Q$=TypeError,J$=function(s,e){if(!delete s[e])throw new Q$("Cannot delete property "+jC(e)+" of "+jC(s))},eW=Lo,tW=lh,nW=uh,sW=SS,oW=J$,iW=vS,rW=[].unshift(0)!==1,aW=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(s){return s instanceof TypeError}},lW=rW||!aW();eW({target:"Array",proto:!0,arity:1,forced:lW},{unshift:function(e){var t=tW(this),n=nW(t),o=arguments.length;if(o){iW(n+o);for(var i=n;i--;){var r=i+o;i in t?t[r]=t[i]:oW(t,r)}for(var a=0;a<o;a++)t[a]=arguments[a]}return sW(t,n+o)}});class hW{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const i=e.split(":"),r=i[0],a=i.length===2?i[1]:null;let l=this.commands[r];if(!l)throw new Error(`Menu command '${r}' not exists.`);if(a&&l.submenu&&(l=uW(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||wt(l,"submenu"))return;const h=[];typeof l.callback=="function"&&h.push(l.callback),typeof this.commonCallback=="function"&&h.push(this.commonCallback),n.unshift(i.join(":")),I(h,u=>u.apply(this.hot,n))}}function uW(s,e){let t;return I(e,n=>{const o=n.key?n.key.split(":"):null;if(Array.isArray(o)&&o[1]===s)return t=n,!1}),t}const NR=hW,Sn="alignment";function cW(){return{key:Sn,name(){return this.getTranslatedPhrase(su)},disabled(){return this.countRows()===0||this.countCols()===0?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Sn}:left`,name(){let s=this.getTranslatedPhrase(ou);return Zn(this.getSelectedRange(),(t,n)=>{const o=this.getCellMeta(t,n).className;if(o&&o.indexOf("htLeft")!==-1)return!0})&&(s=Cs(s)),s},callback(){const s=this.getSelectedRange(),e=go(s,(o,i)=>this.getCellMeta(o,i).className),t="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,s,t,n),Bs(s,t,n,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Sn}:center`,name(){let s=this.getTranslatedPhrase(iu);return Zn(this.getSelectedRange(),(t,n)=>{const o=this.getCellMeta(t,n).className;if(o&&o.indexOf("htCenter")!==-1)return!0})&&(s=Cs(s)),s},callback(){const s=this.getSelectedRange(),e=go(s,(o,i)=>this.getCellMeta(o,i).className),t="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,s,t,n),Bs(s,t,n,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Sn}:right`,name(){let s=this.getTranslatedPhrase(ru);return Zn(this.getSelectedRange(),(t,n)=>{const o=this.getCellMeta(t,n).className;if(o&&o.indexOf("htRight")!==-1)return!0})&&(s=Cs(s)),s},callback(){const s=this.getSelectedRange(),e=go(s,(o,i)=>this.getCellMeta(o,i).className),t="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,s,t,n),Bs(s,t,n,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Sn}:justify`,name(){let s=this.getTranslatedPhrase(au);return Zn(this.getSelectedRange(),(t,n)=>{const o=this.getCellMeta(t,n).className;if(o&&o.indexOf("htJustify")!==-1)return!0})&&(s=Cs(s)),s},callback(){const s=this.getSelectedRange(),e=go(s,(o,i)=>this.getCellMeta(o,i).className),t="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,s,t,n),Bs(s,t,n,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{name:$e},{key:`${Sn}:top`,name(){let s=this.getTranslatedPhrase(lu);return Zn(this.getSelectedRange(),(t,n)=>{const o=this.getCellMeta(t,n).className;if(o&&o.indexOf("htTop")!==-1)return!0})&&(s=Cs(s)),s},callback(){const s=this.getSelectedRange(),e=go(s,(o,i)=>this.getCellMeta(o,i).className),t="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,s,t,n),Bs(s,t,n,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Sn}:middle`,name(){let s=this.getTranslatedPhrase(hu);return Zn(this.getSelectedRange(),(t,n)=>{const o=this.getCellMeta(t,n).className;if(o&&o.indexOf("htMiddle")!==-1)return!0})&&(s=Cs(s)),s},callback(){const s=this.getSelectedRange(),e=go(s,(o,i)=>this.getCellMeta(o,i).className),t="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,s,t,n),Bs(s,t,n,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Sn}:bottom`,name(){let s=this.getTranslatedPhrase(uu);return Zn(this.getSelectedRange(),(t,n)=>{const o=this.getCellMeta(t,n).className;if(o&&o.indexOf("htBottom")!==-1)return!0})&&(s=Cs(s)),s},callback(){const s=this.getSelectedRange(),e=go(s,(o,i)=>this.getCellMeta(o,i).className),t="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,s,t,n),Bs(s,t,n,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1}]}}}const ic="clear_column";function dW(){return{key:ic,name(){return this.getTranslatedPhrase(Gh)},callback(s,e){const t=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){return Uo(this)?!this.selection.isSelectedByColumnHeader():!0}}}const ha="col_left";function fW(){return{key:ha,name(){return this.getTranslatedPhrase(Vh)},callback(){const s=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,s.col,1,"ContextMenu.columnLeft")},disabled(){return!this.isColumnModificationAllowed()||!Uo(this)?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const ua="col_right";function gW(){return{key:ua,name(){return this.getTranslatedPhrase($h)},callback(){const s=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,s.col,1,"ContextMenu.columnRight")},disabled(){return!this.isColumnModificationAllowed()||!Uo(this)?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const ca="make_read_only";function mW(){return{key:ca,name(){let s=this.getTranslatedPhrase(zh);return Zn(this.getSelectedRange(),(t,n)=>this.getCellMeta(t,n).readOnly)&&(s=Cs(s)),s},callback(){const s=this.getSelectedRange(),e=Zn(s,(t,n)=>this.getCellMeta(t,n).readOnly);I(s,t=>{t.forAll((n,o)=>{n>=0&&o>=0&&this.setCellMeta(n,o,"readOnly",!e)})}),this.render()},disabled(){return!!(this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const rc="redo";function pW(){return{key:rc,name(){return this.getTranslatedPhrase(Yh)},callback(){this.redo()},hidden(){const s=this.getPlugin("undoRedo");return!s||!s.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const da="remove_col";function wW(){return{key:da,name(){const s=this.getSelected();let e=0;if(s)if(s.length>1)e=1;else{const[,t,,n]=s[0];t-n!==0&&(e=1)}return this.getTranslatedPhrase(Bh,e)},callback(){this.alter("remove_col",$L(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed()||!Uo(this))return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const ac="remove_row";function CW(){return{key:ac,name(){const s=this.getSelected();let e=0;if(s)if(s.length>1)e=1;else{const[t,,n]=s[0];t-n!==0&&(e=1)}return this.getTranslatedPhrase(Wh,e)},callback(){this.alter("remove_row",WL(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){if(!Uo(this))return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const lc="row_above";function yW(){return{key:lc,name(){return this.getTranslatedPhrase(Lh)},callback(){const s=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",s.row,1,"ContextMenu.rowAbove")},disabled(){return Uo(this)?this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const hc="row_below";function SW(){return{key:hc,name(){return this.getTranslatedPhrase(Fh)},callback(){const s=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",s.row,1,"ContextMenu.rowBelow")},disabled(){return Uo(this)?this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows:!0},hidden(){return!this.getSettings().allowInsertRow}}}const $r="no_items";function vW(){return{key:$r,name(){return this.getTranslatedPhrase(kh)},disabled:!0,isCommand:!1}}const uc="undo";function bW(){return{key:uc,name(){return this.getTranslatedPhrase(Uh)},callback(){this.undo()},hidden(){const s=this.getPlugin("undoRedo");return!s||!s.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const RW=[lc,hc,ha,ua,ic,ac,da,uc,rc,ca,Sn,$e,$r],EW={[$e]:L$,[$r]:vW,[lc]:yW,[hc]:SW,[ha]:fW,[ua]:gW,[ic]:dW,[ac]:CW,[da]:wW,[uc]:bW,[rc]:pW,[ca]:mW,[Sn]:cW};function kR(){const s={};return Fe(EW,(e,t)=>{s[t]=e()}),s}class TW{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.hot=e,this.predefinedItems=kR(),this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,Fe(e,(n,o)=>{let i="";n.name===$e?(t[$e]=n,i=$e):isNaN(parseInt(o,10))?(n.key=n.key===void 0?o:n.key,t[o]=n,i=n.key):(t[n.key]=n,i=n.key),this.defaultOrderPattern.push(i)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return MW(e,this.defaultOrderPattern,this.predefinedItems)}}function MW(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let o=s;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),Le(o)?Fe(o,(i,r)=>{let a=t[typeof i=="string"?i:r];a||(a=i),Le(i)?Mt(a,i):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=r),n.push(a)}):I(o,(i,r)=>{let a=t[i];!a&&RW.indexOf(i)>=0||(a||(a={name:i,key:`${r}`}),Le(i)&&Mt(a,i),a.key===void 0&&(a.key=r),n.push(a))}),n}const LR=TW;class OW{constructor(e,t){const n=Ti(t),o=_o(t);let i,r,a,l,h,u;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(i=parseInt(e.top,10),a=parseInt(e.left,10),h=e.height||0,u=e.width||0,r=i,l=a,i+=n,a+=o):this.type==="event"&&(i=parseInt(e.pageY,10),a=parseInt(e.pageX,10),h=e.target.clientHeight,u=e.target.clientWidth,r=i-n,l=a-o),this.top=i,this.topRelative=r,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=o,this.cellHeight=h,this.cellWidth=u}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}const IW=OW,KC=215,FR="menu",_W=FR;class cc{constructor(e,t){this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:KC,container:this.hot.rootDocument.documentElement},this.eventManager=new ft(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.keyEvent=!1,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=xr(e)}setMenuItems(e){this.menuItems=e}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.offset[e]=t}isSubMenu(){return this.parentMenu!==null}open(){var e=this;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const t=om(f=>this.openSubMenu(f),300),n=this.options.minWidth||KC;let o=!1,i=gn(this.menuItems,f=>(f.key===$r&&(o=!0),U$(f,this.hot)));if(i.length<1&&!o)i.push(kR()[$r]);else if(i.length===0)return;i=G$(i,$e);let r=!1;const a={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(f){return le(f)&&f<n?n:f},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,maxCols:1,columns:[{data:"name",renderer:(f,m,w,C,R,H)=>this.menuItemRenderer(f,m,w,C,R,H)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",afterOnCellMouseOver:(f,m)=>{this.isAllSubMenusClosed()?t(m.row):this.openSubMenu(m.row)},rowHeights:f=>i[f].name===$e?1:23,afterOnCellContextMenu:f=>{f.preventDefault(),Ff()&&r&&this.hasSelectedItem()&&this.close(!0)},beforeOnCellMouseUp:f=>{this.hasSelectedItem()&&(r=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(f))},afterOnCellMouseUp:f=>{(!Ff()||!to(f))&&r&&this.hasSelectedItem()&&(Dn()||lm()?setTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new Xm(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.addHook("afterSelection",function(){return e.onAfterSelection(...arguments)}),this.hotMenu.init(),this.hotMenu.listen();const l=this.hotMenu.getShortcutManager(),h=l.addContext(_W),d={...{group:FR},runOnlyIf:f=>Pr(f.target)===!1||this.container.contains(f.target)===!1};l.setActiveContextName("menu"),h.addShortcuts([{keys:[["Escape"]],callback:()=>{this.keyEvent=!0,this.close(),this.keyEvent=!1}},{keys:[["ArrowDown"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f?this.selectNextCell(f[0],f[1]):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["ArrowUp"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f?this.selectPrevCell(f[0],f[1]):this.selectLastCell(),this.keyEvent=!1}},{keys:[["ArrowRight"]],callback:()=>{const f=this.hotMenu.getSelectedLast();if(this.keyEvent=!0,f){const m=this.openSubMenu(f[0]);m&&m.selectFirstCell()}this.keyEvent=!1}},{keys:[["ArrowLeft"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen()),this.keyEvent=!1}},{keys:[["Enter"]],callback:f=>{const m=this.hotMenu.getSelectedLast();this.keyEvent=!0,this.hotMenu.getSourceDataAtRow(m[0]).submenu||(this.executeCommand(f),this.close(!0)),this.keyEvent=!1}},{keys:[["PageUp"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f?this.hotMenu.selection.transformStart(-this.hotMenu.countVisibleRows(),0):this.selectFirstCell(),this.keyEvent=!1}},{keys:[["PageDown"]],callback:()=>{const f=this.hotMenu.getSelectedLast();this.keyEvent=!0,f?this.hotMenu.selection.transformStart(this.hotMenu.countVisibleRows(),0):this.selectLastCell(),this.keyEvent=!1}}],d),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!V$(t))return!1;const n=this.hotMenu.getSourceDataAtRow(e),o=new cc(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(n.submenu.items),o.open(),o.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=o,o}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])}closeAllSubMenus(){I(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const n=this.hot.getSelectedRange(),o=n?F$(n):[];this.runLocalHooks("executeCommand",t.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,o,e)}isCommandPassive(e){const{isCommand:t,name:n,disabled:o,submenu:i}=e,r=o===!0||typeof o=="function"&&o.call(this.hot)===!0;return t===!1||n===$e||r===!0||i}setPosition(e){const t=new IW(e,this.container.ownerDocument.defaultView);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),this.hot.isLtr()?this.setHorizontalPositionForLtr(t):this.setHorizontalPositionForRtl(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}setHorizontalPositionForRtl(e){e.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(e):this.setPositionOnRightOfCursor(e)}setHorizontalPositionForLtr(e){e.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(e):this.setPositionOnLeftOfCursor(e)}setPositionAboveCursor(e){let t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=`${t}px`}setPositionBelowCursor(e){let t=this.offset.below+e.top+1;this.isSubMenu()&&(t=e.top-1),this.container.style.top=`${t}px`}setPositionOnRightOfCursor(e){let t=e.left;if(this.isSubMenu()){const{right:n}=this.parentMenu.container.getBoundingClientRect();t+=e.cellWidth+n-(e.left+e.cellWidth)}else t+=this.offset.right;this.container.style.left=`${t}px`}setPositionOnLeftOfCursor(e){let t=this.offset.left+e.left-this.container.offsetWidth;if(this.isSubMenu()){const{left:n}=this.parentMenu.container.getBoundingClientRect();t-=e.left-n}this.container.style.left=`${t}px`}selectFirstCell(){const e=this.hotMenu.getCell(0,0);Va(e)||$a(e)||Wa(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)}selectLastCell(){const e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);Va(t)||$a(t)||Wa(t)?this.selectPrevCell(e,0):(this.hotMenu.selectCell(e,0,void 0,void 0,!1),this.hotMenu.scrollViewportTo(e,0,!0,!1))}selectNextCell(e,t){const n=e+1,o=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,t):null;o&&(Va(o)||$a(o)||Wa(o)?this.selectNextCell(n,t):this.hotMenu.selectCell(n,t))}selectPrevCell(e,t){const n=e-1,o=n>=0?this.hotMenu.getCell(n,t):null;o&&(Va(o)||$a(o)||Wa(o)?this.selectPrevCell(n,t):this.hotMenu.selectCell(n,t))}menuItemRenderer(e,t,n,o,i,r){const a=e.getSourceDataAtRow(n),l=this.hot.rootDocument.createElement("div"),h=w=>wt(w,"submenu"),u=w=>new RegExp($e,"i").test(w.name),d=w=>w.disabled===!0||typeof w.disabled=="function"&&w.disabled.call(this.hot)===!0,f=w=>w.disableSelection;let m=r;typeof m=="function"&&(m=m.call(this.hot)),Ln(t),J(l,"htItemWrapper"),t.appendChild(l),u(a)?J(t,"htSeparator"):typeof a.renderer=="function"?(J(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,n,o,i,m))):$o(l,m),d(a)?(J(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):f(a)?(J(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell())):h(a)?(J(t,"htSubmenu"),f(a)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(n,o,void 0,void 0,!1,!1))):(_e(t,["htSubmenu","htDisabled"]),f(a)?this.eventManager.addEventListener(t,"mouseenter",()=>e.deselectCell()):this.eventManager.addEventListener(t,"mouseenter",()=>e.selectCell(n,o,void 0,void 0,!1,!1)))}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let n=e,o;return n&&(nt(n)&&(n=n.call(this.hot),n===null||st(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,o=t.querySelector(`.${this.options.className}.${n}`)),o||(o=t.createElement("div"),J(o,`htMenu ${this.options.className}`),n&&J(o,n),this.options.container.appendChild(o)),o}blockMainTableCallbacks(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)}releaseMainTableCallbacks(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,n=e.hider.style,o=e.holder.style,i=parseInt(n.width,10),r=bt(t,(a,l)=>a+(l.name===$e?1:26),0);o.width=`${i+3}px`,o.height=`${r+3}px`,n.height=o.height}onAfterSelection(e,t,n,o,i){this.keyEvent===!1&&(i.value=!0)}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Ks(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Ks(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Oe(e.target,"htCore")&&Ks(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}tt(cc,an);const up=cc,Ya="contextMenu",AW=70;ce.getSingleton().register("afterContextMenuDefaultOptions");ce.getSingleton().register("beforeContextMenuShow");ce.getSingleton().register("afterContextMenuShow");ce.getSingleton().register("afterContextMenuHide");ce.getSingleton().register("afterContextMenuExecute");class fa extends je{static get PLUGIN_KEY(){return Ya}static get PLUGIN_PRIORITY(){return AW}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[lc,hc,$e,ha,ua,$e,ac,da,$e,uc,rc,$e,ca,$e,Sn]}constructor(e){super(e),this.eventManager=new ft(this),this.commandExecutor=new NR(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[Ya]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Ya];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new up(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e.executeCommand.call(e,...o)}),this.addHook("afterOnCellContextMenu",n=>this.onAfterOnCellContextMenu(n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),super.disablePlugin()}open(e){if(!this.menu||(this.prepareMenuItems(),this.menu.open(),!this.menu.isOpened()))return;let t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:o}=this.hot.rootWindow,{top:i,left:r}=o.getBoundingClientRect();t=i-Ti(e.view),n=r-_o(e.view)}else t=-1*Ti(this.menu.hotMenu.rootWindow),n=-1*_o(this.menu.hotMenu.rootWindow);this.menu.setPosition({top:parseInt(e.pageY,10)+t,left:parseInt(e.pageX,10)+n})}close(){this.menu&&(this.menu.close(),this.itemsFactory=null)}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new LR(this.hot,fa.DEFAULT_ITEMS);const e=this.hot.getSettings()[Ya],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),I(n,o=>this.commandExecutor.registerCommand(o.key,o))}onAfterOnCellContextMenu(e){const t=this.hot.getSettings(),n=t.rowHeaders,o=t.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const r=e.target;this.close(),!Oe(r,"handsontableInput")&&(e.preventDefault(),e.stopPropagation(),!(!(n||o)&&!i(r)&&!(Oe(r,"current")&&Oe(r,"wtBorder")))&&this.open(e))}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}fa.SEPARATOR={name:$e};function xW(s){return{key:"copy",name(){return this.getTranslatedPhrase(jh)},callback(){s.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function HW(s){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(Bm,t)},callback(){s.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function DW(s){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase(Wm,t)},callback(){s.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function PW(s){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?Math.min(e.getWidth()-1,1):0;return this.getTranslatedPhrase($m,t)},callback(){s.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}function NW(s){return{key:"cut",name(){return this.getTranslatedPhrase(Kh)},callback(){s.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelected();return!e||e.length>1},hidden:!1}}class kW{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class LW{constructor(){this.clipboardData=new kW}}class cp{constructor(e){this.rootDocument=e.defaultView?e:e.ownerDocument,this.mainElement=null,this.eventManager=new ft(this),this.listenersCount=new WeakSet,this.container=e}useSecondaryElement(){const e=$W(this.container);this.listenersCount.has(e)||(this.listenersCount.add(e),XC(this.eventManager,e,this)),this.mainElement=e}setFocusableElement(e){this.listenersCount.has(e)||(this.listenersCount.add(e),XC(this.eventManager,e,this)),this.mainElement=e}getFocusableElement(){return this.mainElement}focus(){this.mainElement.value=" ",Dn()||Uv(this.mainElement)}}tt(cp,an);const Ql=new WeakMap;function FW(s){const e=new cp(s);let t=Ql.get(s);return t=isNaN(t)?0:t,Ql.set(s,t+1),e}function VW(s){s.eventManager.clear()}const wd=(s,e)=>t=>e.runLocalHooks(s,t);function XC(s,e,t){s.addEventListener(e,"copy",wd("copy",t)),s.addEventListener(e,"cut",wd("cut",t)),s.addEventListener(e,"paste",wd("paste",t))}const Jl=new WeakMap;function $W(s){const e=Jl.get(s);if(e)return e.parentElement||s.appendChild(e),e;const n=(s.defaultView?s:s.ownerDocument).createElement("textarea");return Jl.set(s,n),n.setAttribute("data-hot-input",""),n.className="HandsontableCopyPaste",n.tabIndex=-1,n.autocomplete="off",n.wrap="hard",n.value=" ",s.appendChild(n),n}function qC(s){if(!(s instanceof cp))return;let e=Ql.get(s.container);if(e=isNaN(e)?0:e,e>0&&(e-=1),VW(s),e<=0){e=0;const t=Jl.get(s.container);t&&t.parentNode&&(t.parentNode.removeChild(t),Jl.delete(s.container)),s.mainElement=null}Ql.set(s.container,e)}function ZC(s,e){VR(s,e),e.add(s)}function ti(s,e,t){VR(s,e),e.set(s,t)}function VR(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function za(s,e,t){if(!e.has(s))throw new TypeError("attempted to get private field on non-instance");return t}function qt(s,e){var t=$R(s,e,"get");return WW(s,t)}function WW(s,e){return e.get?e.get.call(s):e.value}function ni(s,e,t){var n=$R(s,e,"set");return BW(s,n,t),t}function $R(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function BW(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Ps=new WeakMap,Cd=new WeakMap,Zi=new WeakMap,ig=new WeakMap,rg=new WeakMap,Qi=new WeakMap,Ga=new WeakSet,QC=new WeakSet;class UW{constructor(e){let{countRows:t,countColumns:n,rowsLimit:o,columnsLimit:i,countColumnHeaders:r}=e;ZC(this,QC),ZC(this,Ga),ti(this,Ps,{writable:!0,value:void 0}),ti(this,Cd,{writable:!0,value:void 0}),ti(this,Zi,{writable:!0,value:void 0}),ti(this,ig,{writable:!0,value:void 0}),ti(this,rg,{writable:!0,value:void 0}),ti(this,Qi,{writable:!0,value:void 0}),ni(this,Cd,t),ni(this,Zi,n),ni(this,ig,o),ni(this,rg,i),ni(this,Qi,r)}setSelectedRange(e){ni(this,Ps,e)}getCellsRange(){if(qt(this,Cd).call(this)===0||qt(this,Zi).call(this)===0)return null;const{row:e,col:t}=qt(this,Ps).getTopStartCorner(),{row:n,col:o}=qt(this,Ps).getBottomEndCorner(),i=za(this,QC,YW).call(this,e,n),r=za(this,Ga,yd).call(this,t,o);return{isRangeTrimmed:n!==i||o!==r,startRow:e,startCol:t,endRow:i,endCol:r}}getMostBottomColumnHeadersRange(){if(qt(this,Zi).call(this)===0||qt(this,Qi).call(this)===0)return null;const{col:e}=qt(this,Ps).getTopStartCorner(),{col:t}=qt(this,Ps).getBottomEndCorner(),n=za(this,Ga,yd).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(qt(this,Zi).call(this)===0||qt(this,Qi).call(this)===0)return null;const{col:e}=qt(this,Ps).getTopStartCorner(),{col:t}=qt(this,Ps).getBottomEndCorner(),n=za(this,Ga,yd).call(this,e,t);return{isRangeTrimmed:t!==n,startRow:-qt(this,Qi).call(this),startCol:e,endRow:-1,endCol:n}}}function yd(s,e){return Math.min(e,Math.max(s+qt(this,rg).call(this)-1,s))}function YW(s,e){return Math.min(e,Math.max(s+qt(this,ig).call(this)-1,s))}function WR(s){const e=[],t=[];return I(s,n=>{const o=Math.min(n.startRow,n.endRow),i=Math.max(n.startRow,n.endRow);me(o,i,l=>{e.indexOf(l)===-1&&e.push(l)});const r=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);me(r,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function zW(s,e){BR(s,e),e.add(s)}function mo(s,e,t){BR(s,e),e.set(s,t)}function BR(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function si(s,e,t){return e=GW(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function GW(s){var e=jW(s,"string");return typeof e=="symbol"?e:String(e)}function jW(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function KW(s,e,t){if(!e.has(s))throw new TypeError("attempted to get private field on non-instance");return t}function ln(s,e){var t=UR(s,e,"get");return XW(s,t)}function XW(s,e){return e.get?e.get.call(s):e.value}function cs(s,e,t){var n=UR(s,e,"set");return qW(s,n,t),t}function UR(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function qW(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}ce.getSingleton().register("afterCopyLimit");ce.getSingleton().register("modifyCopyableRange");ce.getSingleton().register("beforeCut");ce.getSingleton().register("afterCut");ce.getSingleton().register("beforePaste");ce.getSingleton().register("afterPaste");ce.getSingleton().register("beforeCopy");ce.getSingleton().register("afterCopy");const ja="copyPaste",ZW=80,QW=["fragmentSelection"],JC=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Sd=new WeakMap,vd=new WeakMap,bd=new WeakMap,oi=new WeakMap,Ka=new WeakMap,Xa=new WeakMap,ii=new WeakMap,ey=new WeakSet;class YR extends je{constructor(){super(...arguments),zW(this,ey),si(this,"columnsLimit",1/0),si(this,"rowsLimit",1/0),si(this,"pasteMode","overwrite"),si(this,"uiContainer",this.hot.rootDocument.body),mo(this,Sd,{writable:!0,value:!1}),mo(this,vd,{writable:!0,value:!1}),mo(this,bd,{writable:!0,value:!1}),mo(this,oi,{writable:!0,value:"cells-only"}),mo(this,Ka,{writable:!0,value:!1}),mo(this,Xa,{writable:!0,value:!1}),mo(this,ii,{writable:!0,value:new UW({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),si(this,"copyableRanges",[]),si(this,"focusableElement",void 0)}static get PLUGIN_KEY(){return ja}static get SETTING_KEYS(){return[ja,...QW]}static get PLUGIN_PRIORITY(){return ZW}isEnabled(){return!!this.hot.getSettings()[ja]}enablePlugin(){if(this.enabled)return;const{[ja]:e}=this.hot.getSettings();if(typeof e=="object"){var t,n;this.pasteMode=(t=e.pasteMode)!==null&&t!==void 0?t:this.pasteMode,this.rowsLimit=isNaN(e.rowsLimit)?this.rowsLimit:e.rowsLimit,this.columnsLimit=isNaN(e.columnsLimit)?this.columnsLimit:e.columnsLimit,cs(this,Sd,!!e.copyColumnHeaders),cs(this,vd,!!e.copyColumnGroupHeaders),cs(this,bd,!!e.copyColumnHeadersOnly),this.uiContainer=(n=e.uiContainer)!==null&&n!==void 0?n:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>this.onAfterContextMenuDefaultOptions(o)),this.addHook("afterOnCellMouseUp",()=>this.onAfterOnCellMouseUp()),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.addHook("beforeKeyDown",()=>this.onBeforeKeyDown()),this.focusableElement=FW(this.uiContainer),this.focusableElement.addLocalHook("copy",o=>this.onCopy(o)).addLocalHook("cut",o=>this.onCut(o)).addLocalHook("paste",o=>this.onPaste(o)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.getOrCreateFocusableElement(),super.updatePlugin()}disablePlugin(){this.focusableElement&&qC(this.focusableElement),super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";cs(this,oi,e),cs(this,Ka,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){cs(this,Xa,!0),this.getOrCreateFocusableElement(),this.focusableElement.focus(),this.hot.rootDocument.execCommand("cut")}getRangedCopyableData(e){return Sr(this.getRangedData(e))}getRangedData(e){const t=[],{rows:n,columns:o}=WR(e);return I(n,i=>{const r=[];I(o,a=>{i<0?r.push(this.hot.getColHeader(a,i)):r.push(this.hot.getCopyableData(i,a))}),t.push(r)}),t}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const n=new LW;e&&n.clipboardData.setData("text/plain",e),t&&n.clipboardData.setData("text/html",t),this.getOrCreateFocusableElement(),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;ln(this,ii).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);ln(this,oi)==="column-headers-only"?t.set("headers",ln(this,ii).getMostBottomColumnHeadersRange()):(ln(this,oi)==="with-column-headers"?t.set("headers",ln(this,ii).getMostBottomColumnHeadersRange()):ln(this,oi)==="with-column-group-headers"&&t.set("headers",ln(this,ii).getAllColumnHeadersRange()),t.set("cells",ln(this,ii).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(o=>o!==null).map(o=>{let{startRow:i,startCol:r,endRow:a,endCol:l}=o;return{startRow:i,startCol:r,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=t.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:o,startCol:i,endRow:r,endCol:a}=n;this.hot.runHooks("afterCopyLimit",r-o+1,a-i+1,this.rowsLimit,this.columnsLimit)}}getOrCreateFocusableElement(){var e;const t=(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA;t?this.focusableElement.setFocusableElement(t):this.focusableElement.useSecondaryElement()}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,o=e[0].length,i=[],{row:r,col:a}=t.getTopStartCorner(),{row:l,col:h}=t.getBottomEndCorner();let u=r,d=a,f=r,m=a;for(;i.length<n||u<=l;){const{skipRowOnPaste:w,visualRow:C}=this.hot.getCellMeta(u,a);if(u=C+1,w===!0)continue;f=C,d=a;const R=[],H=i.length%n;for(;R.length<o||d<=h;){const{skipColumnOnPaste:A,visualCol:_}=this.hot.getCellMeta(r,d);if(d=_+1,A===!0)continue;m=_;const O=R.length%o;R.push(e[H][O])}i.push(R)}return this.hot.populateFromArray(r,a,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,a,f,m]}onCopy(e){if(!this.hot.isListening()&&!ln(this,Ka)||this.isEditorOpened())return;this.setCopyableText(),cs(this,Ka,!1);const t=this.getRangedData(this.copyableRanges),n=KW(this,ey,JW).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,n)){const i=Sr(t);if(e&&e.clipboardData){const r=Bf(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[JC,r].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.runHooks("afterCopy",t,this.copyableRanges,n)}cs(this,oi,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!ln(this,Xa)||this.isEditorOpened())return;this.setCopyableText(),cs(this,Xa,!1);const t=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",t,this.copyableRanges)){const o=Sr(t);if(e&&e.clipboardData){const i=Bf(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[JC,i].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened())return;e&&e.preventDefault&&e.preventDefault();let t;if(e&&typeof e.clipboardData<"u"){const a=Eh(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?t=ub(a,this.hot.rootDocument).data:t=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof t=="string"&&(t=YL(t)),t&&t.length===0||this.hot.runHooks("beforePaste",t,this.copyableRanges)===!1)return;const[n,o,i,r]=this.populateValues(t);this.hot.selectCell(n,o,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,r)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},xW(this)),ln(this,Sd)&&e.items.push(PW(this)),ln(this,vd)&&e.items.push(DW(this)),ln(this,bd)&&e.items.push(HW(this)),e.items.push(NW(this))}onAfterOnCellMouseUp(){!this.hot.isListening()||this.isEditorOpened()||this.hot.getSettings().fragmentSelection||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}onAfterSelectionEnd(){this.isEditorOpened()||(this.getOrCreateFocusableElement(),!(this.hot.getSettings().fragmentSelection&&this.focusableElement.getFocusableElement()!==this.hot.rootDocument.activeElement&&$v())&&(this.setCopyableText(),this.focusableElement.focus()))}onBeforeKeyDown(){if(!this.hot.isListening()||this.isEditorOpened())return;const e=this.hot.rootDocument.activeElement,t=this.hot.getActiveEditor();!t||e!==this.focusableElement.getFocusableElement()&&e!==t.select||(this.getOrCreateFocusableElement(),this.focusableElement.focus())}destroy(){this.focusableElement&&(qC(this.focusableElement),this.focusableElement=null),super.destroy()}}function JW(s){const{rows:e}=WR(s);let t=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)t+=1;return{columnHeadersCount:t}}function zR(s,e){return`border_row${s}col${e}`}function ur(){return{width:1,color:"#000"}}function Rs(){return{hide:!0}}function eB(){return{width:1,color:"#000",cornerVisible:!1}}function Rd(s){if(le(s.start)||le(s.left)){var e;s.start=(e=s.start)!==null&&e!==void 0?e:s.left}if(le(s.end)||le(s.right)){var t;s.end=(t=s.end)!==null&&t!==void 0?t:s.right}return delete s.left,delete s.right,s}function Ji(s){return le(s.start)&&(s.left=s.start),le(s.end)&&(s.right=s.end),s}function Ed(s,e){return{id:zR(s,e),border:eB(),row:s,col:e,top:Rs(),bottom:Rs(),start:Rs(),end:Rs()}}function tB(s,e){return wt(e,"border")&&e.border&&(s.border=e.border),wt(e,"top")&&le(e.top)&&(e.top?(Le(e.top)||(e.top=ur()),s.top=e.top):(e.top=Rs(),s.top=e.top)),wt(e,"bottom")&&le(e.bottom)&&(e.bottom?(Le(e.bottom)||(e.bottom=ur()),s.bottom=e.bottom):(e.bottom=Rs(),s.bottom=e.bottom)),wt(e,"start")&&le(e.start)&&(e.start?(Le(e.start)||(e.start=ur()),s.start=e.start):(e.start=Rs(),s.start=e.start)),wt(e,"end")&&le(e.end)&&(e.end?(Le(e.end)||(e.end=ur()),s.end=e.end):(e.end=Rs(),s.end=e.end)),s}function Ms(s,e){let t=!1;return I(s.getSelectedRange(),n=>{n.forAll((o,i)=>{if(o<0||i<0)return;const r=s.getCellMeta(o,i).borders;if(r)if(e){if(!wt(r[e],"hide")||r[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function dc(s){return`<span class="selected">${String.fromCharCode(10003)}</span>${s}`}function nB(s){return s.some(e=>le(e.left)||le(e.right))}function sB(s){return s.some(e=>le(e.start)||le(e.end))}const oB=new Map([["left","start"],["right","end"]]);function iB(s){var e;return(e=oB.get(s))!==null&&e!==void 0?e:s}function rB(s){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(gu);return Ms(this,"bottom")&&(e=dc(e)),e},callback(e,t){const n=Ms(this,"bottom");s.prepareBorder(t,"bottom",n)}}}function aB(s){const e=s.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(mu);return Ms(this,e)&&(t=dc(t)),t},callback(t,n){const o=Ms(this,e);s.prepareBorder(n,e,o)}}}function lB(s){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(pu)},callback(e,t){s.prepareBorder(t,"noBorders")},disabled(){return!Ms(this)}}}function hB(s){const e=s.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(fu);return Ms(this,e)&&(t=dc(t)),t},callback(t,n){const o=Ms(this,e);s.prepareBorder(n,e,o)}}}function uB(s){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(du);return Ms(this,"top")&&(e=dc(e)),e},callback(e,t){const n=Ms(this,"top");s.prepareBorder(t,"top",n)}}}function cB(s,e,t){return e=dB(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function dB(s){var e=fB(s,"string");return typeof e=="symbol"?e:String(e)}function fB(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}const qa="customBorders",gB=90;class mB extends je{constructor(){super(...arguments),cB(this,"savedBorders",[])}static get PLUGIN_KEY(){return qa}static get PLUGIN_PRIORITY(){return gB}isEnabled(){return!!this.hot.getSettings()[qa]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let n=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),n=Object.keys(t),o=Rd(t));const i=_i(e),r=Vr(i);I(e,a=>{const[l,h,u,d]=r(a);for(let f=l;f<=u;f+=1)for(let m=h;m<=d;m+=1)I(n,w=>{this.prepareBorderFromCustomAdded(f,m,o,iB(w))})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=_i(e),n=Vr(t),o=[];return I(e,i=>{const[r,a,l,h]=n(i);for(let u=r;u<=l;u+=1)for(let d=a;d<=h;d+=1)I(this.savedBorders,f=>{f.row===u&&f.col===d&&o.push(Ji(f))})}),o}clearBorders(e){e?this.setBorders(e):(I(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const o=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,o,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:o})}prepareBorderFromCustomAdded(e,t,n,o){const i=this.hot.countRows(),r=this.hot.countCols();if(e>=i||t>=r)return;let a=Ed(e,t);n&&(a=tB(a,n),I(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,n),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",Ji(a)),this.insertBorderIntoSettings(a,o)}prepareBorderFromCustomAddedRange(e,t){const n=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,n,i=>{me(e.from.col,o,r=>{const a=Ed(i,r);let l=0;i===e.from.row&&wt(t,"top")&&(l+=1,a.top=t.top),i===e.to.row&&wt(t,"bottom")&&(l+=1,a.bottom=t.bottom),r===e.from.col&&wt(t,"start")&&(l+=1,a.start=t.start),r===e.to.col&&wt(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(i,r,"borders",Ji(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const n=zR(e,t);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,n,o){let i=this.hot.getCellMeta(e,t).borders;!i||i.border===void 0?i=Ed(e,t):i=Rd(i),o?(i[n]=Rs(),this.countHide(i)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(i,n,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",Ji(i)))):(i[n]=ur(),this.checkCustomSelectionsFromContextMenu(i,n,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",Ji(i)))}prepareBorder(e,t,n){I(e,o=>{let{start:i,end:r}=o;if(i.row===r.row&&i.col===r.col)t==="noBorders"?this.removeAllBorders(i.row,i.col):this.setBorder(i.row,i.col,t,n);else switch(t){case"noBorders":me(i.col,r.col,a=>{me(i.row,r.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(i.col,r.col,a=>{this.setBorder(i.row,a,t,n)});break;case"bottom":me(i.col,r.col,a=>{this.setBorder(r.row,a,t,n)});break;case"start":me(i.row,r.row,a=>{this.setBorder(a,i.col,t,n)});break;case"end":me(i.row,r.row,a=>{this.setBorder(a,r.col,t,n)});break}})}createCustomBorders(e){I(e,t=>{const n=Rd(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,n):this.prepareBorderFromCustomAdded(t.row,t.col,n)})}countHide(e){const{top:t,bottom:n,start:o,end:i}=e;return bt([t,n,o,i],(a,l)=>{let h=a;return l&&l.hide&&(h+=1),h},0)}clearBordersFromSelectionSettings(e){const t=ke(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){I(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){I(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=ke(this.savedBorders,n=>n.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):I(this.savedBorders,(o,i)=>{if(e.id===o.id)return this.savedBorders[i]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,n){let o=!1;return I(this.hot.selection.highlight.customSelections,i=>{if(e.id===i.settings.id)return Fe(i.instanceBorders,r=>{r.toggleHiddenClass(t,n)}),o=!0,!1}),o}checkCustomSelections(e,t,n){const o=this.countHide(e);let i=!1;return o===4?(this.removeAllBorders(e.row,e.col),i=!0):I(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id)return r.visualCellRange=t,r.commit(),n&&Fe(r.instanceBorders,a=>{a.changeBorderStyle(n,e)}),i=!0,!1}),i}changeBorderSettings(){const e=this.hot.getSettings()[qa];if(Array.isArray(e)){const t=Ut(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=nB(e),n=sB(e);if(t&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){this.hot.getSettings()[qa]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(cu)},disabled(){return this.selection.isSelectedByCorner()},submenu:{items:[uB(this),hB(this),rB(this),aB(this),lB(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const ty="dragToScroll",pB=100;class wB extends je{static get PLUGIN_KEY(){return ty}static get PLUGIN_PRIORITY(){return pB}constructor(e){super(e),this.eventManager=new ft(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[ty]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let n=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",n=>this.onMouseMove(n)),t=xr(t)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(to(e))return;const t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((n,o)=>{n<0?t.scrollLeft-=50:n>0&&(t.scrollLeft+=50),o<0?t.scrollTop-=20:o>0&&(t.scrollTop+=20)}),this.listen())}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}ce.getSingleton().register("afterDropdownMenuDefaultOptions");ce.getSingleton().register("beforeDropdownMenuShow");ce.getSingleton().register("afterDropdownMenuShow");ce.getSingleton().register("afterDropdownMenuHide");ce.getSingleton().register("afterDropdownMenuExecute");const Td="dropdownMenu",CB=230,Md="changeType";class ga extends je{static get PLUGIN_KEY(){return Td}static get PLUGIN_PRIORITY(){return CB}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ha,ua,$e,da,$e,ic,$e,ca,$e,Sn]}constructor(e){super(e),this.eventManager=new ft(this),this.commandExecutor=new NR(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(t,n)=>this.onAfterGetColHeader(t,n))}isEnabled(){return this.hot.getSettings()[Td]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new LR(this.hot,ga.DEFAULT_ITEMS);const t=this.hot.getSettings()[Td],n={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const o=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new up(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e.executeCommand.call(e,...r)}),I(o,i=>this.commandExecutor.registerCommand(i.key,i))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),super.disablePlugin()}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e))}close(){this.menu&&this.menu.close()}executeCommand(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),Oe(e.target,Md)&&!this.menu.isOpened()){let t=0,n=0;if(this.hot.rootDocument!==this.menu.container.ownerDocument){const{frameElement:i}=this.hot.rootWindow,{top:r,left:a}=i.getBoundingClientRect();t=r,n=a}const o=e.target.getBoundingClientRect();this.open({left:o.left+n,top:o.top+e.target.offsetHeight+3+t,width:o.width,height:o.height})}}onAfterGetColHeader(e,t){const n=t.parentNode;if(!n)return;const o=n.parentNode.childNodes,i=Array.prototype.indexOf.call(o,n);if(e<0||i!==o.length-1)return;const r=t.querySelector(`.${Md}`);if(this.enabled&&r)return;if(!this.enabled){r&&r.parentNode.removeChild(r);return}const a=this.hot.rootDocument.createElement("button");a.className=Md,a.type="button",a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}ga.SEPARATOR={name:$e};class yB{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:n,endCol:o}=this._getDataRange(),i=this.options,r=[];return me(e,n,a=>{const l=[];!i.exportHiddenRows&&this._isHiddenRow(a)||(me(t,o,h=>{!i.exportHiddenColumns&&this._isHiddenColumn(h)||l.push(this.hot.getDataAtCell(a,h))}),r.push(l))}),r}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:n}=this._getDataRange(),o=this.hot.getRowHeader();me(t,n,i=>{!this.options.exportHiddenRows&&this._isHiddenRow(i)||e.push(o[i])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:n}=this._getDataRange(),o=this.hot.getColHeader();me(t,n,i=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(i)||e.push(o[i])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[n=0,o=0,i=t,r=e]=this.options.range;return n=Math.max(n,0),o=Math.max(o,0),i=Math.min(i,t),r=Math.min(r,e),{startRow:n,startCol:o,endRow:i,endCol:r}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const SB=yB;class dp{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Jt(this.constructor.DEFAULT_OPTIONS);const n=new Date;return t=Mt(Jt(dp.DEFAULT_OPTIONS),t),t=Mt(t,e),t.filename=em(t.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),t}}const vB=dp,bB=String.fromCharCode(13),RB=String.fromCharCode(34),EB=String.fromCharCode(10);class TB extends vB{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const o=n.length>0,i=this.dataProvider.getRowHeaders(),r=i.length>0;let a=e.bom?String.fromCharCode(65279):"";return o&&(n=ke(n,l=>this._escapeCell(l,!0)),r&&(a+=e.columnDelimiter),a+=n.join(e.columnDelimiter),a+=e.rowDelimiter),I(t,(l,h)=>{h>0&&(a+=e.rowDelimiter),r&&(a+=this._escapeCell(i[h])+e.columnDelimiter),a+=l.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=Ct(e);return n!==""&&(t||n.indexOf(bB)>=0||n.indexOf(RB)>=0||n.indexOf(EB)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}const MB=TB,OB="csv",ag={[OB]:MB};function IB(s,e,t){return typeof ag[s]=="function"?new ag[s](e,t):null}const _B="exportFile",AB=240;class xB extends je{static get PLUGIN_KEY(){return _B}static get PLUGIN_PRIORITY(){return AB}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:o}=this.hot,i=this._createTypeFormatter(e,t),r=this._createBlob(i),a=o.URL||o.webkitURL,l=n.createElement("a"),h=`${i.options.filename}.${i.options.fileExtension}`;if(l.download!==void 0){const u=a.createObjectURL(r);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",h),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,h)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ag[e])throw new Error(`Export format type "${e}" is not supported.`);return IB(e,new SB(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}class GR{constructor(e,t){let{id:n,stateless:o=!0}=t;this.hot=e,this.id=n,this.elements=[],this.hidden=!1,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Nh)}reset(){I(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),I(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}tt(GR,an);const fc=GR,Wr={};function no(s,e){if(!Wr[s])throw Error(`Filter condition "${s}" does not exist.`);const{condition:t,descriptor:n}=Wr[s];let o=e;return n.inputValuesDecorator&&(o=n.inputValuesDecorator(o)),function(i){return t.apply(i.meta.instance,[].concat([i],[o]))}}function Mo(s){if(!Wr[s])throw Error(`Filter condition "${s}" does not exist.`);return Wr[s].descriptor}function Ot(s,e,t){t.key=s,Wr[s]={condition:e,descriptor:t}}const Pt="none";function HB(){return!0}Ot(Pt,HB,{name:ia,inputsCount:0,showOperators:!1});const Rr="empty";function DB(s){return It(s.value)}Ot(Rr,DB,{name:Ru,inputsCount:0,showOperators:!0});const Ml="not_empty";function PB(s,e){return!no(Rr,e)(s)}Ot(Ml,PB,{name:Eu,inputsCount:0,showOperators:!0});const Er="eq";function NB(s,e){let[t]=e;return Ct(s.value).toLocaleLowerCase(s.meta.locale)===Ct(t)}Ot(Er,NB,{name:Tu,inputsCount:1,showOperators:!0});const Ol="neq";function kB(s,e){return!no(Er,e)(s)}Ot(Ol,kB,{name:Mu,inputsCount:1,showOperators:!0});const jR="gt";function LB(s,e){let[t]=e,n=t;return s.meta.type==="numeric"&&(n=parseFloat(n,10)),s.value>n}Ot(jR,LB,{name:xu,inputsCount:1,showOperators:!0});const KR="gte";function FB(s,e){let[t]=e,n=t;return s.meta.type==="numeric"&&(n=parseFloat(n,10)),s.value>=n}Ot(KR,FB,{name:Hu,inputsCount:1,showOperators:!0});const XR="lt";function VB(s,e){let[t]=e,n=t;return s.meta.type==="numeric"&&(n=parseFloat(n,10)),s.value<n}Ot(XR,VB,{name:Du,inputsCount:1,showOperators:!0});const qR="lte";function $B(s,e){let[t]=e,n=t;return s.meta.type==="numeric"&&(n=parseFloat(n,10)),s.value<=n}Ot(qR,$B,{name:Pu,inputsCount:1,showOperators:!0});const fp="date_after";function WB(s,e){let[t]=e;const n=Z(s.value,s.meta.dateFormat),o=Z(t,s.meta.dateFormat);return!n.isValid()||!o.isValid()?!1:n.diff(o)>=0}Ot(fp,WB,{name:Lu,inputsCount:1,showOperators:!0});const gp="date_before";function BB(s,e){let[t]=e;const n=Z(s.value,s.meta.dateFormat),o=Z(t,s.meta.dateFormat);return!n.isValid()||!o.isValid()?!1:n.diff(o)<=0}Ot(gp,BB,{name:Fu,inputsCount:1,showOperators:!0});const eh="between";function UB(s,e){let[t,n]=e,o=t,i=n;if(s.meta.type==="numeric"){const r=parseFloat(o,10),a=parseFloat(i,10);o=Math.min(r,a),i=Math.max(r,a)}else if(s.meta.type==="date"){const r=no(gp,[i]),a=no(fp,[o]);return r(s)&&a(s)}return s.value>=o&&s.value<=i}Ot(eh,UB,{name:Nu,inputsCount:2,showOperators:!0});const ZR="not_between";function YB(s,e){return!no(eh,e)(s)}Ot(ZR,YB,{name:ku,inputsCount:2,showOperators:!0});const QR="begins_with";function zB(s,e){let[t]=e;return Ct(s.value).toLocaleLowerCase(s.meta.locale).startsWith(Ct(t))}Ot(QR,zB,{name:Ou,inputsCount:1,showOperators:!0});const JR="ends_with";function GB(s,e){let[t]=e;return Ct(s.value).toLocaleLowerCase(s.meta.locale).endsWith(Ct(t))}Ot(JR,GB,{name:Iu,inputsCount:1,showOperators:!0});const mp="contains";function jB(s,e){let[t]=e;return Ct(s.value).toLocaleLowerCase(s.meta.locale).indexOf(Ct(t))>=0}Ot(mp,jB,{name:_u,inputsCount:1,showOperators:!0});const e0="not_contains";function KB(s,e){return!no(mp,e)(s)}Ot(e0,KB,{name:Au,inputsCount:1,showOperators:!0});const t0="date_tomorrow";function XB(s){const e=Z(s.value,s.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}Ot(t0,XB,{name:$u,inputsCount:0});const n0="date_today";function qB(s){const e=Z(s.value,s.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}Ot(n0,qB,{name:Vu,inputsCount:0});const s0="date_yesterday";function ZB(s){const e=Z(s.value,s.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}Ot(s0,ZB,{name:Wu,inputsCount:0});bb();function QB(s,e){let t=s;return t===""&&(t=`(${e})`),t}const lg=new Set([1]).has(1),JB=lg&&typeof Array.from=="function";function ma(s){let e=s;return lg&&(e=new Set(e)),function(t){let n;return lg?n=e.has(t):n=!!~e.indexOf(t),n}}function o0(s){return s??""}function hg(s){let e=s;return JB?e=Array.from(new Set(e)):e=Zg(e),e=e.sort((t,n)=>typeof t=="number"&&typeof n=="number"?t-n:t===n?0:t>n?1:-1),e}function ny(s,e,t,n){const o=[],i=s===e;let r;return i||(r=ma(e)),I(s,a=>{let l=!1;(i||r(a))&&(l=!0);const h={checked:l,value:a,visualValue:QB(a,t)};n&&n(h),o.push(h)}),o}const Oo="by_value";function e2(s,e){let[t]=e;return t(s.value)}Ot(Oo,e2,{name:"By value",inputsCount:0,inputValuesDecorator(s){let[e]=s;return[ma(e)]},showOperators:!1});const Br={};function t2(s){if(!Br[s])throw Error(`Operation with id "${s}" does not exist.`);const e=Br[s].func;return function(t,n){return e(t,n)}}function n2(s){return Br[s].name}function pp(s,e,t){Br[s]={name:e,func:t}}const Zs="conjunction",s2=Yu;function o2(s,e){return s.every(t=>t.func(e))}pp(Zs,s2,o2);const th="disjunction",i2=ra;function r2(s,e){return s.some(t=>t.func(e))}pp(th,i2,r2);const wp="disjunctionWithExtraCondition",a2=ra;function l2(s,e){if(s.length<3)throw Error("Operation doesn't work on less then three conditions.");return s.slice(0,s.length-1).some(t=>t.func(e))&&s[s.length-1].func(e)}pp(wp,a2,l2);const h2="numeric",i0="text",u2="date",sy={[h2]:[Pt,$e,Rr,Ml,$e,Er,Ol,$e,jR,KR,XR,qR,eh,ZR],[i0]:[Pt,$e,Rr,Ml,$e,Er,Ol,$e,QR,JR,$e,mp,e0],[u2]:[Pt,$e,Rr,Ml,$e,Er,Ol,$e,gp,fp,eh,$e,t0,n0,s0]};function c2(s){const e=[];let t=s;return sy[t]||(t=i0),I(sy[t],n=>{let o;n===$e?o={name:$e}:o=Jt(Mo(n)),e.push(o)}),e}const Od="built",Id="building",oy=["click","input","keydown","keypress","keyup","focus","blur","change"];let r0=class a0{static get DEFAULTS(){return Jt({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){this.hot=e,this.eventManager=new ft(this),this.options=Mt(a0.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=null}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Id?this._element:this.buildState===Od?(this.update(),this._element):(this.buildState=Id,this.build(),this.buildState=Od,this._element)}isBuilt(){return this.buildState===Od}translateIfPossible(e){return typeof e=="string"&&e.startsWith(nn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,n)=>{this.eventManager.addEventListener(t,n,o=>this.runLocalHooks(n,o,this))};if(this.buildState||(this.buildState=Id),this.options.className&&J(this._element,this.options.className),this.options.children.length)I(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);Fe(this.options,(n,o)=>{t[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(t[o]=this.translateIfPossible(n))}),this._element.appendChild(t),I(oy,n=>e(t,n))}else I(oy,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};tt(r0,an);const Qs=r0,Za=new WeakMap;class Cp extends Qs{static get DEFAULTS(){return Jt({placeholder:"",type:"text",tagName:"input"})}constructor(e,t){super(e,Mt(Cp.DEFAULTS,t)),Za.set(this,{}),this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick()),this.addLocalHook("keyup",e=>this.onKeyup(e))}build(){super.build();const e=Za.get(this),t=this.hot.rootDocument.createElement("div");e.input=this._element.firstChild,J(this._element,"htUIInput"),J(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=Za.get(this).input;e.type=this.options.type,e.placeholder=this.translateIfPossible(this.options.placeholder),e.value=this.translateIfPossible(this.options.value)}focus(){this.isBuilt()&&Za.get(this).input.focus()}onClick(){}onKeyup(e){this.options.value=e.target.value}}const Ri=Cp,Qa=new WeakMap;class yp extends Qs{static get DEFAULTS(){return Jt({className:"htUISelect",wrapIt:!1})}constructor(e,t){super(e,Mt(yp.DEFAULTS,t)),Qa.set(this,{}),this.menu=null,this.items=[],this.registerHooks()}registerHooks(){this.addLocalHook("click",()=>this.onClick())}setItems(e){this.items=this.translateNames(e),this.menu&&this.menu.setMenuItems(this.items)}translateNames(e){return I(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),this.menu=new up(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer}),this.menu.setMenuItems(this.items);const e=new Qs(this.hot,{className:"htUISelectCaption"}),t=new Qs(this.hot,{className:"htUISelectDropdown"}),n=Qa.get(this);n.caption=e,n.captionElement=e.element,n.dropdown=t,I([e,t],o=>this._element.appendChild(o.element)),this.menu.addLocalHook("select",o=>this.onMenuSelect(o)),this.menu.addLocalHook("afterClose",()=>this.onMenuClosed()),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=this.menu.hot.getTranslatedPhrase(ia),Qa.get(this).captionElement.textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}))}closeOptions(){this.menu&&this.menu.close()}onMenuSelect(e){e.name!==$e&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}onMenuClosed(){this.runLocalHooks("afterClose")}onClick(){this.openOptions()}destroy(){this.menu&&(this.menu.destroy(),this.menu=null);const{caption:e,dropdown:t}=Qa.get(this);e&&e.destroy(),t&&t.destroy(),super.destroy()}}const iy=yp;class d2 extends fc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new iy(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Ri(this.hot,{placeholder:qu})),this.elements.push(new Ri(this.hot,{placeholder:Zu})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>this.onConditionSelect(e)),this.getSelectElement().addLocalHook("afterClose",()=>this.onSelectUIClosed()),I(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>this.onInputKeyDown(t))})}setState(e){if(this.reset(),!e)return;const t=Jt(e.command);t.name.startsWith(yt)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),I(e.args,(n,o)=>{if(o>t.inputsCount-1)return!1;const i=this.getInputElement(o);i.setValue(n),i[t.inputsCount>o?"show":"hide"](),o||setTimeout(()=>i.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Mo(Pt),t=[];return I(this.getInputElements(),(n,o)=>{e.inputsCount>o&&t.push(n.getValue())}),{command:e,args:t}}updateState(e,t){const n=Mo(e?e.name:Pt);this.state.setValueAtIndex(t,{command:n,args:e?e.args:[]}),e||I(this.getInputElements(),o=>o.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof iy)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ri)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,o,i,r)=>{J(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&J(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=r,t.appendChild(a),t.parentNode.hasAttribute("ghost-table")||I(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Mo(Pt)];if(e!==null){const{visualIndex:n}=e;t=c2(this.hot.getDataType(0,n,this.hot.countRows(),n))}I(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}onConditionSelect(e){I(this.getInputElements(),(t,n)=>{t[e.inputsCount>n?"show":"hide"](),n===0&&setTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}onSelectUIClosed(){this.runLocalHooks("afterClose")}onInputKeyDown(e){Ii(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),Fn(e)):Ii(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Fn(e))}}const _d=d2,Ja=new WeakMap;class Sp extends Qs{static get DEFAULTS(){return Jt({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,Mt(Sp.DEFAULTS,t)),Ja.set(this,{})}build(){super.build();const e=Ja.get(this);e.input=this._element.firstChild;const t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),e.label=t,this._element.appendChild(t),this.update()}update(){if(!this.isBuilt())return;const e=Ja.get(this);e.input.checked=this.options.checked,e.label.textContent=this.translateIfPossible(this.options.label.textContent)}isChecked(){return this.options.checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.options.checked=e,this.update()}focus(){this.isBuilt()&&Ja.get(this).input.focus()}}const ry=Sp,ay=0;class f2 extends fc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(J(t.parentNode,"htFiltersMenuOperators"),t.parentNode.hasAttribute("ghost-table")||I(this.elements,n=>t.appendChild(n.element)),t)}}buildOperatorsElement(){const e=[Zs,th];I(e,t=>{const n=new ry(this.hot,{name:"operator",label:{htmlFor:t,textContent:n2(t)},value:t,checked:t===e[ay],id:t});n.addLocalHook("change",o=>this.onRadioInputChange(o)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Je`Radio button with index ${e} doesn't exist.`);I(this.elements,(t,n)=>{t.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof ry&&t.isChecked());return e?e.getValue():Zs}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&I(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zs,t=arguments.length>1?arguments[1]:void 0,n=e;n===wp&&(n=th),this.state.setValueAtIndex(t,n)}reset(){this.setChecked(ay)}onRadioInputChange(e){this.setState(e.target.value)}}const g2=f2,Ad=new WeakMap;class vp extends Qs{static get DEFAULTS(){return Jt({href:"#",tagName:"a"})}constructor(e,t){super(e,Mt(vp.DEFAULTS,t)),Ad.set(this,{})}build(){super.build();const e=Ad.get(this);e.link=this._element.firstChild}update(){this.isBuilt()&&(Ad.get(this).link.textContent=this.translateIfPossible(this.options.textContent))}}const ly=vp,m2=new WeakMap,p2="multipleSelect.itemBox";class bp extends Qs{static get DEFAULTS(){return Jt({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,Mt(bp.DEFAULTS,t)),m2.set(this,{}),this.searchInput=new Ri(this.hot,{placeholder:Xu,className:"htUIMultipleSelectSearch"}),this.selectAllUI=new ly(this.hot,{textContent:zu,className:"htUISelectAll"}),this.clearAllUI=new ly(this.hot,{textContent:Gu,className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()}registerHooks(){this.searchInput.addLocalHook("keydown",e=>this.onInputKeyDown(e)),this.searchInput.addLocalHook("input",e=>this.onInput(e)),this.selectAllUI.addLocalHook("click",e=>this.onSelectAllClick(e)),this.clearAllUI.addLocalHook("click",e=>this.onClearAllClick(e))}setItems(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)}setLocale(e){this.locale=e}getLocale(){return this.locale}getItems(){return[...this.items]}getValue(){return C2(this.items)}isSelectedAllValues(){return this.items.length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),n=new Qs(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(n.element),this._element.appendChild(t);const o=i=>{if(!this._element)return;this.itemsBox&&this.itemsBox.destroy(),J(i,"htUIMultipleSelectHot"),this.itemsBox=new this.hot.constructor(i,{data:this.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,h,u,d,f,m)=>{l.title=m.instance.getDataAtRowProp(h,m.label.property)},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>this.itemsBox.container.scrollWidth-xt(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"}),this.itemsBox.init(),this.itemsBox.getShortcutManager().getContext("grid").addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:p2})};o(t),setTimeout(()=>o(t),100)}reset(){this.searchInput.reset(),this.selectAllUI.reset(),this.clearAllUI.reset()}update(){this.isBuilt()&&(this.itemsBox.loadData(w2(this.items,this.options.value)),super.update())}destroy(){this.itemsBox&&this.itemsBox.destroy(),this.searchInput.destroy(),this.clearAllUI.destroy(),this.selectAllUI.destroy(),this.searchInput=null,this.clearAllUI=null,this.selectAllUI=null,this.itemsBox=null,this.items=null,super.destroy()}onInput(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let n;t===""?n=[...this.items]:n=gn(this.items,o=>`${o.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0),this.itemsBox.loadData(n)}onInputKeyDown(e){this.runLocalHooks("keydown",e,this),im(Ii,e.keyCode)("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(Fn(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))}onSelectAllClick(e){const t=[];e.preventDefault(),I(this.itemsBox.getSourceData(),(n,o)=>{n.checked=!0,t.push(Zf(n,o)[0])}),this.itemsBox.setSourceDataAtCell(t)}onClearAllClick(e){const t=[];e.preventDefault(),I(this.itemsBox.getSourceData(),(n,o)=>{n.checked=!1,t.push(Zf(n,o)[0])}),this.itemsBox.setSourceDataAtCell(t)}}const hy=bp;function w2(s,e){const t=ma(e);return ke(s,n=>(n.checked=t(n.value),n))}function C2(s){const e=[];return I(s,t=>{t.checked&&e.push(t.value)}),e}class y2 extends fc{constructor(e,t){super(e,{id:t.id,stateless:!1}),this.name=t.name,this.elements.push(new hy(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>this.onInputKeyDown(e))}setState(e){if(this.reset(),e&&e.command.key===Oo){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Pt:Oo},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(n,o,i,r,a)=>{const[l]=gn(o,d=>d.name===Oo),h={},u=this.hot.getTranslatedPhrase(Lr);if(l){const d=hg(ke(r(n,a),C=>C.value));i&&(l.args[0]=i);const f=[],m=ny(d,l.args[0],u,C=>{C.checked&&f.push(C.value)}),w=e.editedConditionStack.column;h.locale=this.hot.getCellMeta(0,w).locale,h.args=[f],h.command=Mo(Oo),h.itemsSnapshot=m}else h.args=[],h.command=Mo(Pt);this.state.setValueAtIndex(n,h)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof hy)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,n,o,i,r)=>{J(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=r,t.appendChild(a),t.parentNode.hasAttribute("ghost-table")||I(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(Lr),t=hg(this._getColumnVisibleValues()),n=ny(t,t,e);this.getMultipleSelectElement().setItems(n),super.reset(),this.getMultipleSelectElement().setValue(t);const o=this.hot.getPlugin("filters").getSelectedColumn();o!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}onInputKeyDown(e){Ii(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Fn(e))}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:ke(this.hot.getDataAtCol(e.visualIndex),t=>o0(t))}}const S2=y2;class Tr extends fc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),this.name=t.name,this.elements.push(new Ri(this.hot,{type:"button",value:ju,className:"htUIButton htUIButtonOK",identifier:Tr.BUTTON_OK})),this.elements.push(new Ri(this.hot,{type:"button",value:Ku,className:"htUIButton htUIButtonCancel",identifier:Tr.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){I(this.elements,e=>{e.addLocalHook("click",(t,n)=>this.onButtonClick(t,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(J(t.parentNode,"htFiltersMenuActionBar"),t.parentNode.hasAttribute("ghost-table")||I(this.elements,n=>t.appendChild(n.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}onButtonClick(e,t){t.options.identifier===Tr.BUTTON_OK?this.accept():this.cancel()}}const v2=Tr,uy="ConditionCollection.filteringStates";class l0{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.hot=e,this.isMapRegistrable=t,this.filteringStates=new Nh,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(uy,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var n;const o=this.filteringStates.getValueAtIndex(t),i=(n=o==null?void 0:o.conditions)!==null&&n!==void 0?n:[],r=o==null?void 0:o.operation;return this.isMatchInConditions(i,e,r)}isMatchInConditions(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zs;return e.length?t2(n)(e,t):!0}addCondition(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zs,o=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,r=ke(t.args,u=>typeof u=="string"?u.toLocaleLowerCase(i):u),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==n)throw Error(Je`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(st(Br[n]))throw new Error(Je`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const h=this.getConditions(e);h.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:r,func:no(a,r)}]},o):h.push({name:a,args:r,func:no(a,r)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,n;return(t=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return bt(this.filteringStates.getEntries(),(e,t)=>{let[n,{operation:o,conditions:i}]=t;return e.push({column:n,operation:o,conditions:ke(i,r=>{let{name:a,args:l}=r;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),I(e,t=>{I(t.conditions,n=>this.addCondition(t.column,n))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const n=this.getConditions(e);return t?n.some(o=>o.name===t):n.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(uy),this.filteringStates=null,this.clearLocalHooks()}}tt(l0,an);const h0=l0;class b2{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return I(this.conditionCollection.getFilteredColumns(),(t,n)=>{let o=this.columnDataFactory(t);n&&(o=this._getIntersectData(o,e)),e=this.filterByColumn(t,o)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return I(t,o=>{o!==void 0&&this.conditionCollection.isMatch(o,e)&&n.push(o)}),n}_getIntersectData(e,t){const n=[];return I(t,o=>{const i=o.meta.visualRow;e[i]!==void 0&&(n[i]=e[i])}),n}}const u0=b2;class c0{constructor(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];this.hot=e,this.conditionCollection=t,this.columnDataFactory=n,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",o=>this._onConditionBeforeModify(o)),this.conditionCollection.addLocalHook("afterRemove",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("afterAdd",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,I(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,t){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const o=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);i===-1&&(i=this.latestEditedColumnPosition);const r=o.slice(0,i),a=o.slice(i);a.length&&a[0].column===e&&a.shift();const l=Gv(function(u,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const m=new h0(n.hot,!1),w=[].concat(u,f);m.importAllConditions(w);const C=n.columnDataFactory(d);let R;m.isEmpty()?R=C:R=new u0(m,A=>n.columnDataFactory(A)).filter(),R=ke(R,A=>A.meta.visualRow);const H=ma(R);return m.destroy(),gn(C,A=>H(A.meta.visualRow))})(r),h=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:h},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){I(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),Fe(this,(e,t)=>{this[t]=null})}}tt(c0,an);const R2=c0,cy="filters",E2=250;class d0 extends je{static get PLUGIN_KEY(){return cy}static get PLUGIN_PRIORITY(){return E2}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),this.eventManager=new ft(this),this.dropdownMenuPlugin=null,this.conditionCollection=null,this.conditionUpdateObserver=null,this.components=new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]]),this.filtersRowsMap=null,this.hot.addHook("afterGetColHeader",(t,n)=>this.onAfterGetColHeader(t,n))}isEnabled(){return!!this.hot.getSettings()[cy]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new oa),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,n=r=>(r.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),r.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),r.addLocalHook("change",a=>this.onComponentChange(r,a)),r),o=()=>`${this.hot.getTranslatedPhrase(Bu)}:`,i=()=>`${this.hot.getTranslatedPhrase(Uu)}:`;if(!this.components.get("filter_by_condition")){const r=new _d(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:t});r.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",n(r))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new g2(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const r=new _d(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});r.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",n(r))}this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new S2(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new v2(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new h0(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new R2(this.hot,this.conditionCollection,r=>this.getDataMapAtColumn(r)),this.conditionUpdateObserver.addLocalHook("update",r=>this.updateComponents(r))),this.components.forEach(r=>r.show()),this.addHook("beforeDropdownMenuSetItems",r=>this.onBeforeDropdownMenuSetItems(r)),this.addHook("afterDropdownMenuDefaultOptions",r=>this.onAfterDropdownMenuDefaultOptions(r)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",r=>this.onAfterChange(r)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,n)=>{t.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}super.disablePlugin()}addCondition(e,t,n){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Zs;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:t},args:n},o)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const e=this._createDataFilter(),t=!this.conditionCollection.isEmpty();let n=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(t){const r=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),n=ke(e.filter(),l=>l.meta.visualRow);const a=ma(n);me(this.hot.countSourceRows()-1,l=>{a(l)||r.push(l)}),I(r,l=>{this.filtersRowsMap.setValueAtIndex(l,!0)})},!0),n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection()}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}clearColumnSelection(){const e=this.getSelectedColumn();e!==null&&this.hot.selectCell(0,e.visualIndex)}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),n=[];return I(this.hot.getSourceDataAtCol(t),(o,i)=>{var r;const{row:a,col:l,visualCol:h,visualRow:u,type:d,instance:f,dateFormat:m,locale:w}=this.hot.getCellMeta(i,t),C=(r=this.hot.getDataAtCell(this.hot.toVisualRow(i),t))!==null&&r!==void 0?r:o;n.push({meta:{row:a,col:l,visualCol:h,visualRow:u,type:d,instance:f,dateFormat:m,locale:w},value:o0(C)})}),n}onAfterChange(e){e&&I(e,t=>{const[,n]=t,o=this.hot.propToCol(n);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)})}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),n=hg(t);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var t;const n=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(o=>{o.isHidden()||o.restoreState(n)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onBeforeDropdownMenuSetItems(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.menu.addLocalHook("afterOpen",()=>{this.dropdownMenuPlugin.menu.hotMenu.updateSettings({hiddenRows:!0})})}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:$e}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,t,n,o){let i=e;return i===th&&t.command.key!==Pt&&n.command.key!==Pt&&o.command.key!==Pt?i=wp:o.command.key!==Pt&&(t.command.key===Pt||n.command.key===Pt)&&(i=Zs),i}onActionBarSubmit(e){var t;if(e==="accept"){const o=this.getSelectedColumn();if(o===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=o,r=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,a,l);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),r.command.key!==Pt&&(this.conditionCollection.addCondition(i,r,h,u),a.command.key!==Pt&&this.conditionCollection.addCondition(i,a,h,u)),l.command.key!==Pt&&this.conditionCollection.addCondition(i,l,h,u),this.conditionUpdateObserver.flush(),this.components.forEach(d=>d.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(t=this.dropdownMenuPlugin)===null||t===void 0||t.close()}onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor===_d&&!t.inputsCount&&this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...n):this.hideComponents(...n)}onAfterGetColHeader(e,t){const n=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(n)?J(t,"htFiltersActive"):_e(t,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new u0(e,t=>this.getDataMapAtColumn(t))}updateComponents(e){var t;if(!((t=this.dropdownMenuPlugin)!==null&&t!==void 0&&t.enabled))return;const{editedConditionStack:{conditions:n,column:o}}=e,i=n.filter(a=>a.name===Oo),r=n.filter(a=>a.name!==Oo);if(i.length>=2||r.length>=3)it(Je`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(r[0],o),this.components.get("filter_by_condition2").updateState(r[1],o),this.components.get("filter_operators").updateState(a,o),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return I(o,r=>{I(t.menuItems,(a,l)=>{a.key===r.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,o=n.getPlugin("hiddenRows");for(var i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];const l=this.getIndexesOfComponents(...r);e?o.showRows(l):o.hideRows(l),n.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const f0="internal-use-in-handsontable",ug={licenseKey:f0,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function g0(s){var e;return{maxColumns:s.maxColumns,maxRows:s.maxRows,language:(e=s[Vt])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function m0(s){return Object.keys(s).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=s[t]),e),{})}function T2(s){var e;const t=s[Vt],n=m0(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=g0(s);return{...ug,...n,...o}}function M2(s){var e;const t=s[Vt],n=m0(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=g0(s);return{...n,...o}}function O2(s,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==s[t])}function gc(){const s="engine_relationship",e=Mn(Vt);return e.hasItem(s)||e.register(s,new Map),e.getItem(s)}function Rp(){const s="shared_engine_usage",e=Mn(Vt);return e.hasItem(s)||e.register(s,new Map),e.getItem(s)}function I2(s){const e=s.getSettings(),t=e[Vt],n=t==null?void 0:t.engine;if(t===!0||st(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var o;return _2((o=n.hyperformula)!==null&&o!==void 0?o:n,e,s)}else if(typeof n=="object"&&st(n.hyperformula)){const i=gc(),r=Rp().get(n);return i.has(n)||i.set(n,[]),i.get(n).push(s),r&&r.push(s.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:f0}),(n.getConfig().leapYear1900!==ug.leapYear1900||Oh(n.getConfig().nullDate,ug.nullDate)===!1)&&it(Je`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function _2(s,e,t){const n=e[Vt],o=T2(e),i=gc(),r=Rp();A2(s,n.functions),x2(s,n.language);const a=s.buildEmpty(o);return i.set(a,[t]),r.set(a,[t.guid]),H2(a,n.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function dy(s){var e;const t=gc(),n=t.size===0?[]:Array.from((e=t.get(s))!==null&&e!==void 0?e:[]);return new Map(n.map(o=>[o.getPlugin("formulas").sheetId,o]))}function fy(s,e){if(s){const t=gc(),n=t.get(s),o=Rp(),i=o.get(s);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&t.delete(s)),i&&i.includes(e.guid)&&(i.splice(i.indexOf(e.guid),1),i.length===0&&(o.delete(s),s.destroy()))}}function A2(s,e){e&&e.forEach(t=>{const{name:n,plugin:o,translations:i}=t;try{s.registerFunction(n,o,i)}catch(r){it(r.message)}})}function x2(s,e){if(e){const{langCode:t}=e;try{s.registerLanguage(t,e)}catch(n){it(n.message)}}}function H2(s,e){e&&(s.suspendEvaluation(),e.forEach(t=>{const{name:n,expression:o,scope:i,options:r}=t;try{s.addNamedExpression(n,o,i,r)}catch(a){it(a.message)}}),s.resumeEvaluation())}function D2(s,e){return(st(e)||!s.doesSheetExist(e))&&(e=s.addSheet(e)),e}const p0="DD/MM/YYYY";function w0(s){return typeof s=="string"&&s.charAt(0)==="'"&&s.charAt(1)==="="}function P2(s){return w0(s)?s.substr(1):s}function N2(s){return typeof s=="string"&&s.startsWith("=")}function xd(s,e){return typeof s=="string"&&e==="date"}function gy(s,e){return Z(s,e,!0).isValid()}function my(s,e){return Z(s,e,!0).format(p0)}function k2(s,e){return Z(s,p0,!0).format(e)}function py(s,e){const n=new Date(Date.UTC(0,0,s+-1));return Z(n).format(e)}function po(s,e,t){L2(s,e),e.set(s,t)}function L2(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(s,e){var t=C0(s,e,"get");return F2(s,t)}function F2(s,e){return e.get?e.get.call(s):e.value}function Ns(s,e,t){var n=C0(s,e,"set");return V2(s,n,t),t}function C0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function V2(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var er=new WeakMap,ks=new WeakMap,hn=new WeakMap,el=new WeakMap,Hd=new WeakMap,Dd=new WeakMap,tl=new WeakMap;class $2{constructor(e,t,n){po(this,er,{writable:!0,value:void 0}),po(this,ks,{writable:!0,value:void 0}),po(this,hn,{writable:!0,value:void 0}),po(this,el,{writable:!0,value:[]}),po(this,Hd,{writable:!0,value:[]}),po(this,Dd,{writable:!0,value:void 0}),po(this,tl,{writable:!0,value:[]}),Ns(this,er,e),Ns(this,ks,t),Ns(this,hn,n)}setRemovedHfIndexes(e){return Ns(this,tl,e.map(t=>{const n=at(this,ks).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(n)})),at(this,tl)}getRemovedHfIndexes(){return at(this,tl)}getHfIndexFromVisualIndex(e){const t=at(this,ks).getIndexesSequence(),n=at(this,ks).getNotTrimmedIndexes();return t.indexOf(n[e])}syncMoves(e){const n=`move${Bt(at(this,er))}s`;at(this,hn).getEngine().batch(()=>{e.forEach(o=>{const i=o.from!==o.to,r=o.from+1!==o.to;i&&r&&at(this,hn).getEngine()[n](at(this,hn).getSheetId(),o.from,1,o.to)})})}storeMovesInformation(e,t,n){n!==!1&&(Ns(this,Hd,e.map(o=>this.getHfIndexFromVisualIndex(o))),Ns(this,Dd,this.getHfIndexFromVisualIndex(t)))}getMoveLine(e,t){const n=at(this,ks).getNumberOfIndexes(),o=Array.from(Array(n).keys()).filter(r=>e.includes(r)===!1);if(t===0){var i;return(i=o[t])!==null&&i!==void 0?i:0}return o[t-1]+1}getInitiallyCalculatedMoves(e,t){let n=this.getMoveLine(e,t);const o=[];return e.forEach(i=>{const r={from:i,to:n};o.forEach(a=>{const l=a.from>a.to,h=a.to<=r.from;a.from>r.from&&h&&l&&(r.from+=1)}),r.from>=n&&(n+=1),o.push(r)}),o}adjustedCalculatedMoves(e){return e.forEach((t,n)=>{e.slice(n+1).forEach(i=>{const r=i.from<i.to;i.from>t.from&&r&&(i.from-=1)})}),e}calculateAndSyncMoves(e,t){if(at(this,hn).isPerformingUndoRedo()||e===!1||t===!1)return;const n=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(at(this,Hd),at(this,Dd)));at(this,hn).getSheetId()===null?at(this,hn).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${Bt(at(this,er))}Order`;return t=>{if(at(this,hn).isPerformingUndoRedo())return;const n=at(this,ks).getIndexesSequence();if(t==="update"){const o=at(this,el).map(l=>n.indexOf(l)),i=at(this,hn).getEngine().getSheetDimensions(at(this,hn).getSheetId());let r;at(this,er)==="row"?r=i.height:r=i.width;const a=o.length;for(let l=a;l<r;l+=1)o.push(l);at(this,hn).getEngine()[e](at(this,hn).getSheetId(),o)}Ns(this,el,n)}}init(){Ns(this,el,at(this,ks).getIndexesSequence())}}const wy=$2;function wo(s,e,t){W2(s,e),e.set(s,t)}function W2(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ds(s,e){var t=y0(s,e,"get");return B2(s,t)}function B2(s,e){return e.get?e.get.call(s):e.value}function Co(s,e,t){var n=y0(s,e,"set");return U2(s,n,t),t}function y0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function U2(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var nl=new WeakMap,sl=new WeakMap,Pd=new WeakMap,Nd=new WeakMap,kd=new WeakMap,Ld=new WeakMap,Fd=new WeakMap;class Y2{constructor(e,t,n){wo(this,nl,{writable:!0,value:void 0}),wo(this,sl,{writable:!0,value:void 0}),wo(this,Pd,{writable:!0,value:void 0}),wo(this,Nd,{writable:!0,value:!1}),wo(this,kd,{writable:!0,value:!1}),wo(this,Ld,{writable:!0,value:null}),wo(this,Fd,{writable:!0,value:null}),Co(this,nl,new wy("row",e,this)),Co(this,sl,new wy("column",t,this)),Co(this,Pd,n)}getForAxis(e){return e==="row"?ds(this,nl):ds(this,sl)}setPerformUndo(e){Co(this,Nd,e)}setPerformRedo(e){Co(this,kd,e)}isPerformingUndoRedo(){return ds(this,Nd)||ds(this,kd)}getSheetId(){return ds(this,Fd)}getEngine(){return ds(this,Ld)}getPostponeAction(){return ds(this,Pd)}setupSyncEndpoint(e,t){Co(this,Ld,e),Co(this,Fd,t),ds(this,nl).init(),ds(this,sl).init()}}const z2=Y2;function ri(s,e,t){return e=G2(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function G2(s){var e=j2(s,"string");return typeof e=="symbol"?e:String(e)}function j2(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Vd(s,e,t){K2(s,e),e.set(s,t)}function K2(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ls(s,e,t){var n=S0(s,e,"set");return X2(s,n,t),t}function X2(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function ai(s,e){var t=S0(s,e,"get");return q2(s,t)}function S0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function q2(s,e){return e.get?e.get.call(s):e.value}const Vt="formulas",Z2=["maxRows","maxColumns","language"],Q2=260;ce.getSingleton().register("afterNamedExpressionAdded");ce.getSingleton().register("afterNamedExpressionRemoved");ce.getSingleton().register("afterSheetAdded");ce.getSingleton().register("afterSheetRemoved");ce.getSingleton().register("afterSheetRenamed");ce.getSingleton().register("afterFormulasValuesUpdate");const li=s=>s==="UndoRedo.undo"||s==="UndoRedo.redo"||s==="auto";var fs=new WeakMap,$d=new WeakMap,tr=new WeakMap;class J2 extends je{constructor(){var e;super(...arguments),e=this,Vd(this,fs,{writable:!0,value:!1}),Vd(this,$d,{writable:!0,value:!1}),Vd(this,tr,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),ri(this,"staticRegister",Mn("formulas")),ri(this,"engine",null),ri(this,"sheetName",null),ri(this,"indexSyncer",null),ri(this,"rowAxisSyncer",null),ri(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Vt}static get PLUGIN_PRIORITY(){return Q2}static get SETTING_KEYS(){return[Vt,...Z2]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Vt]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=I2(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){it("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&(this.sheetName=n)}this.addHook("beforeLoadData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return t.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return t.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return t.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol(...arguments)}),this.indexSyncer=new z2(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,o,i,r)=>{this.rowAxisSyncer.storeMovesInformation(n,o,r)}),this.hot.addHook("beforeColumnMove",(n,o,i,r)=>{this.columnAxisSyncer.storeMovesInformation(n,o,r)}),this.hot.addHook("afterRowMove",(n,o,i,r,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,a)}),this.hot.addHook("afterColumnMove",(n,o,i,r,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,a)}),this.hot.addHook("beforeColumnFreeze",(n,o)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,o)}),this.hot.addHook("afterColumnFreeze",(n,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.hot.addHook("beforeColumnUnfreeze",(n,o)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,o)}),this.hot.addHook("afterColumnUnfreeze",(n,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.addHook("afterCellMetaReset",function(){return t.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return t.onBeforeAutofill(...arguments)}),ai(this,tr).forEach(n=>{let[o,i]=n;return this.engine.on(o,i)}),super.enablePlugin()}}disablePlugin(){ai(this,tr).forEach(e=>{let[t,n]=e;return this.engine.off(t,n)}),fy(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=M2(this.hot.getSettings());O2(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const n=this.hot.getSettings()[Vt];if(le(n)&&le(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const o=this.hot.getSettings()[Vt].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){ai(this,tr).forEach(e=>{var t;let[n,o]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(n,o)}),Ls(this,tr,null),fy(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(le(t)&&!Lb(t))return it("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return it("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(n),t),n}catch(n){return it(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){um(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${Bt(Vt)}.switchSheet`)}getCellType(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return o!==null&&i!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(o=>{var i;const r=o==null||(i=o.address)===null||i===void 0?void 0:i.sheet;r!==void 0&&(n.has(r)||n.add(r))}),dy(this.engine).forEach((o,i)=>{if((t||i!==this.sheetId)&&n.has(i)){var r;o.render(),(r=o.view)===null||r===void 0||r.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=i=>{var r;const{row:a,col:l,sheet:h}=(r=i==null?void 0:i.address)!==null&&r!==void 0?r:{};return le(h)?`${h}:${a}x${l}`:""},o=new Set(t.map(i=>n(i)));e.forEach(i=>{var r,a;const{row:l,col:h}=(r=i.address)!==null&&r!==void 0?r:{};if(le(l)===!1||le(h)===!1||l>=this.hot.countRows()||h>=this.hot.countCols())return;const u=i==null||(a=i.address)===null||a===void 0?void 0:a.sheet,d=n(i);if(u!==void 0&&!o.has(d)){const f=dy(this.engine).get(u);if(!f)return;f.validateCell(f.getDataAtCell(l,h),f.getCellMeta(l,h),()=>{})}})}syncChangeWithEngine(e,t,n){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o)){it(`Not possible to set cell data at ${JSON.stringify(o)}`);return}const i=this.hot.getCellMeta(e,t);return xd(n,i.type)&&(gy(n,i.dateFormat)?n=my(n,i.dateFormat):N2(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(o,n)}onBeforeValidate(e,t,n){const o=this.hot.propToCol(n);if(this.isFormulaCellType(t,o)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},r=this.hot.getCellMeta(t,o);let a=this.engine.getCellValue(i);return r.type==="date"&&Qt(a)&&(a=py(a,r.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return e}onBeforeAutofill(e,t,n){const{row:o,col:i}=t.getTopStartCorner(),{row:r,col:a}=t.getBottomEndCorner(),{row:l,col:h}=n.getTopStartCorner(),{row:u,col:d}=n.getBottomEndCorner(),f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},m={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(m)===!1)return!1;const w=this.engine.getFillRangeData(f,m),{row:C,col:R}=f.start,{row:H,col:A}=f.end,_=H-C+1,O=A-R+1;for(let D=0;D<w.length;D+=1)for(let G=0;G<w[D].length;G+=1){const z=w[D][G],ee=D%_,X=G%O,q=this.hot.getCellMeta(ee,X);xd(z,q.type)&&(z.startsWith("'")?w[D][G]=z.slice(1):this.isFormulaCellType(ee,X,this.sheetId)===!1&&(w[D][G]=k2(z,q.dateFormat)))}return w}onBeforeLoadData(e,t){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Bt(Vt))||Ls(this,$d,st(this.hot.getSettings().data))}onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach((n,o)=>{n.forEach((i,r)=>{const a=this.hot.getCellMeta(o,r),l=a.dateFormat;xd(i,a.type)&&(t=!0,gy(i,l)?e[o][r]=my(i,l):this.isFormulaCellType(o,r)===!1&&(e[o][r]=`'${i}`))})}),t===!0&&(Ls(this,fs,!0),this.engine.setSheetContent(this.sheetId,e),Ls(this,fs,!1))}onAfterLoadData(e,t){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Bt(Vt)))if(this.sheetName=D2(this.engine,this.hot.getSettings()[Vt].sheetName),ai(this,$d))this.switchSheet(this.sheetName);else{const o=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,o)){Ls(this,fs,!0);const i=this.engine.setSheetContent(this.sheetId,o);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Ls(this,fs,!1)}}}onModifyData(e,t,n,o){if(o!=="get"||ai(this,fs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e);if(i===null||t===null)return;if(!this.isFormulaCellType(i,t)&&this.getCellType(i,t)!=="ARRAY"){w0(n.value)&&(n.value=P2(n.value));return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let l=this.engine.getCellValue(a);const h=this.hot.getCellMeta(i,t);h.type==="date"&&Qt(l)&&(l=py(l,h.dateFormat));const u=typeof l=="object"&&l!==null?l.value:l;n.value=u}onModifySourceData(e,t,n,o){if(o!=="get"||ai(this,fs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),r=this.hot.propToCol(t);if(i===null||r===null||!this.isFormulaCellType(i,r)&&this.getCellType(i,r)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};n.value=this.engine.getCellSerialized(h)}onAfterSetDataAtCell(e,t){if(li(t))return;const n=[],o=[],i=this.engine.batch(()=>{e.forEach(r=>{let[a,l,,h]=r;const u=this.hot.propToCol(l),d=this.hot.toPhysicalRow(a),f=this.hot.toPhysicalColumn(u),m={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};d!==null&&f!==null?this.syncChangeWithEngine(a,u,h):n.push([a,u,h]),o.push({address:m})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const r=this.engine.batch(()=>{n.forEach(a=>{let[l,h,u]=a;this.syncChangeWithEngine(l,h,u)})});this.renderDependentSheets(r,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,o)}onAfterSetSourceDataAtCell(e,t){if(li(t))return;const n=[],o=[];e.forEach(i=>{let[r,a,,l]=i;const h=this.hot.propToCol(a);if(!Qt(h))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){it(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}o.push({address:u}),n.push(...this.engine.setCellContents(u,l))}),this.renderDependentSheets(n),this.validateDependentCells(n,o)}onBeforeCreateRow(e,t){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(n=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,t]))return!1}onBeforeCreateCol(e,t){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(n=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,t]))return!1}onBeforeRemoveRow(e,t,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(r=>this.engine.isItPossibleToRemoveRows(this.sheetId,[r,1]))===!1?!1:void 0}onBeforeRemoveCol(e,t,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(r=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[r,1]))===!1?!1:void 0}onAfterCreateRow(e,t,n){if(li(n))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(o)}onAfterCreateCol(e,t,n){if(li(n))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(o)}onAfterRemoveRow(e,t,n,o){if(li(o))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch(()=>{i.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(r)}onAfterRemoveCol(e,t,n,o){if(li(o))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch(()=>{i.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(r)}onAfterDetachChild(e,t,n){var o;Ls(this,fs,!0);const i=this.hot.getSourceDataArray(n,0,n+(((o=t.__children)===null||o===void 0?void 0:o.length)||0),this.hot.countSourceCols());Ls(this,fs,!1),i.forEach((r,a)=>{r.forEach((l,h)=>{this.engine.setCellContents({col:h,row:n+a,sheet:this.sheetId},[[l]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}function eU(s){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,n,,o]=e;n-o!==0&&(t=1)}return this.getTranslatedPhrase(yu,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,t.col),0),o=Math.max(e.col,t.col),i=[];for(let l=n;l<=o;l+=1)i.push(l);s.hideColumns(i);const r=i[i.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function tU(s){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Su,t)},callback(){var t,n;if(e.length===0)return;let o=e[0],i=e[e.length-1];o=(t=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&n!==void 0?n:this.countCols()-1,s.showColumns(e),this.render(),this.view.adjustElementsSize(!0),i-o+1===this.countCols()||this.selectColumns(o,i)},disabled:!1,hidden(){const t=ke(s.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),o=n.getTopStartCorner().col,i=n.getBottomEndCorner().col,r=this.columnIndexMapper,a=r.getRenderableFromVisualIndex(o),l=r.getRenderableFromVisualIndex(i),h=r.getNotTrimmedIndexes(),u=[];if(o!==i){const d=i-o+1,f=l-a+1;if(d>f){const m=h.slice(o,i+1);u.push(...m.filter(w=>t.includes(w)))}}else if(a===0&&a<o)u.push(...h.slice(0,o));else if(a===null)u.push(...h.slice(0,this.countCols()));else{const d=this.countCols()-1,f=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(d,-1));l===f&&d>i&&u.push(...h.slice(i+1))}return I(u,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function Cy(s,e,t){nU(s,e),e.set(s,t)}function nU(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(s,e){var t=v0(s,e,"get");return sU(s,t)}function sU(s,e){return e.get?e.get.call(s):e.value}function nr(s,e,t){var n=v0(s,e,"set");return oU(s,n,t),t}function v0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function oU(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}ce.getSingleton().register("beforeHideColumns");ce.getSingleton().register("afterHideColumns");ce.getSingleton().register("beforeUnhideColumns");ce.getSingleton().register("afterUnhideColumns");const Wd="hiddenColumns",iU=310;var zn=new WeakMap,Gn=new WeakMap;class b0 extends je{constructor(){super(...arguments),Cy(this,zn,{writable:!0,value:{}}),Cy(this,Gn,{writable:!0,value:null})}static get PLUGIN_KEY(){return Wd}static get PLUGIN_PRIORITY(){return iU}isEnabled(){return!!this.hot.getSettings()[Wd]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Wd];Le(t)&&(nr(this,zn,t),st(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),nr(this,Gn,new Ph),un(this,Gn).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,un(this,Gn)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(n,o,i)=>this.onAfterGetCellMeta(n,o,i)),this.addHook("modifyColWidth",(n,o)=>this.onModifyColWidth(n,o)),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",n=>this.onModifyCopyableRange(n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),nr(this,zn,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let o=t;const i=un(this,Gn).getValues().slice(),r=e.length>0;if(n&&r){const l=e.map(h=>this.hot.toPhysicalColumn(h));I(l,h=>{i[h]=!1}),o=bt(i,(h,u,d)=>(u&&h.push(this.hot.toVisualColumn(d)),h),[])}this.hot.runHooks("beforeUnhideColumns",t,o,n&&r)!==!1&&(n&&r&&un(this,Gn).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,o,n&&r,n&&o.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),n=this.isValidConfig(e);let o=t;n&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,o,n)!==!1&&(n&&this.hot.batchExecution(()=>{I(e,r=>{un(this,Gn).setValueAtIndex(this.hot.toPhysicalColumn(r),!0)})},!0),this.hot.runHooks("afterHideColumns",t,o,n,n&&o.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideColumns(t)}getHiddenColumns(){return ke(un(this,Gn).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return un(this,Gn).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<t):!1}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,t){if(this.isHidden(t))return 0;if(un(this,zn).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}onAfterGetCellMeta(e,t,n){if(un(this,zn).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const o=n.className.split(" ");if(o.length>0){const i=o.indexOf("afterHiddenColumn");i>-1&&o.splice(i,1),n.className=o.join(" ")}}}onModifyCopyableRange(e){if(un(this,zn).copyPasteEnabled)return e;const t=[],n=(o,i,r,a)=>{t.push({startRow:o,endRow:i,startCol:r,endCol:a})};return I(e,o=>{let i=!0,r=0;me(o.startCol,o.endCol,a=>{this.isHidden(a)?(i||n(o.startRow,o.endRow,r,a-1),i=!0):(i&&(r=a),a===o.endCol&&n(o.startRow,o.endRow,r,a),i=!1)})}),t}onAfterGetColHeader(e,t){if(!un(this,zn).indicators||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&n.push("beforeHiddenColumn"),J(t,n)}onAfterContextMenuDefaultOptions(e){e.items.push({name:$e},eU(this),tU(this))}onMapInit(){Array.isArray(un(this,zn).columns)&&this.hideColumns(un(this,zn).columns)}destroy(){nr(this,zn,null),nr(this,Gn,null),super.destroy()}}function rU(s){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[n,,o]=e;n-o!==0&&(t=1)}return this.getTranslatedPhrase(vu,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,t.row),0),o=Math.max(e.row,t.row),i=[];for(let l=n;l<=o;l+=1)i.push(l);s.hideRows(i);const r=i[i.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function aU(s){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(bu,t)},callback(){var t,n;if(e.length===0)return;let o=e[0],i=e[e.length-1];o=(t=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&n!==void 0?n:this.countRows()-1,s.showRows(e),this.render(),this.view.adjustElementsSize(!0),i-o+1===this.countRows()||this.selectRows(o,i)},disabled:!1,hidden(){const t=ke(s.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),o=n.getTopStartCorner().row,i=n.getBottomEndCorner().row,r=this.rowIndexMapper,a=r.getRenderableFromVisualIndex(o),l=r.getRenderableFromVisualIndex(i),h=r.getNotTrimmedIndexes(),u=[];if(o!==i){const d=i-o+1,f=l-a+1;if(d>f){const m=h.slice(o,i+1);u.push(...m.filter(w=>t.includes(w)))}}else if(a===0&&a<o)u.push(...h.slice(0,o));else if(a===null)u.push(...h.slice(0,this.countRows()));else{const d=this.countRows()-1,f=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(d,-1));l===f&&d>i&&u.push(...h.slice(i+1))}return I(u,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function yy(s,e,t){lU(s,e),e.set(s,t)}function lU(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cn(s,e){var t=R0(s,e,"get");return hU(s,t)}function hU(s,e){return e.get?e.get.call(s):e.value}function sr(s,e,t){var n=R0(s,e,"set");return uU(s,n,t),t}function R0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function uU(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}ce.getSingleton().register("beforeHideRows");ce.getSingleton().register("afterHideRows");ce.getSingleton().register("beforeUnhideRows");ce.getSingleton().register("afterUnhideRows");const Bd="hiddenRows",cU=320;var gs=new WeakMap,jn=new WeakMap;class E0 extends je{constructor(){super(...arguments),yy(this,gs,{writable:!0,value:{}}),yy(this,jn,{writable:!0,value:null})}static get PLUGIN_KEY(){return Bd}static get PLUGIN_PRIORITY(){return cU}isEnabled(){return!!this.hot.getSettings()[Bd]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Bd];Le(t)&&(sr(this,gs,t),st(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),sr(this,jn,new Ph),Cn(this,jn).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,Cn(this,jn)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(n,o,i)=>this.onAfterGetCellMeta(n,o,i)),this.addHook("modifyRowHeight",(n,o)=>this.onModifyRowHeight(n,o)),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",n=>this.onModifyCopyableRange(n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),sr(this,gs,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let o=t;const i=Cn(this,jn).getValues().slice(),r=e.length>0;if(n&&r){const l=e.map(h=>this.hot.toPhysicalRow(h));I(l,h=>{i[h]=!1}),o=bt(i,(h,u,d)=>(u&&h.push(this.hot.toVisualRow(d)),h),[])}this.hot.runHooks("beforeUnhideRows",t,o,n&&r)!==!1&&(n&&r&&Cn(this,jn).setValues(i),this.hot.runHooks("afterUnhideRows",t,o,n&&r,n&&o.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),n=this.isValidConfig(e);let o=t;n&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,o,n)!==!1&&(n&&this.hot.batchExecution(()=>{I(e,r=>{Cn(this,jn).setValueAtIndex(this.hot.toPhysicalRow(r),!0)})},!0),this.hot.runHooks("afterHideRows",t,o,n,n&&o.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.hideRows(t)}getHiddenRows(){return ke(Cn(this,jn).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Cn(this,jn).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<t):!1}resetCellsMeta(){I(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,t){return this.isHidden(t)?0:e}onAfterGetCellMeta(e,t,n){if(Cn(this,gs).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipRowOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const o=n.className.split(" ");if(o.length>0){const i=o.indexOf("afterHiddenRow");i>-1&&o.splice(i,1),n.className=o.join(" ")}}}onModifyCopyableRange(e){if(Cn(this,gs).copyPasteEnabled)return e;const t=[],n=(o,i,r,a)=>{t.push({startRow:o,endRow:i,startCol:r,endCol:a})};return I(e,o=>{let i=!0,r=0;me(o.startRow,o.endRow,a=>{this.isHidden(a)?(i||n(r,a-1,o.startCol,o.endCol),i=!0):(i&&(r=a),a===o.endRow&&n(r,a,o.startCol,o.endCol),i=!1)})}),t}onAfterGetRowHeader(e,t){if(!Cn(this,gs).indicators||e<0)return;const n=[];e>=1&&this.isHidden(e-1)&&n.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&n.push("beforeHiddenRow"),J(t,n)}onAfterContextMenuDefaultOptions(e){e.items.push({name:$e},rU(this),aU(this))}onMapInit(){Array.isArray(Cn(this,gs).rows)&&this.hideRows(Cn(this,gs).rows)}destroy(){sr(this,gs,null),sr(this,jn,null),super.destroy()}}function dU(s){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Xh)},callback(e,t){const[{start:{col:n}}]=t;s.freezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function fU(s){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(qh)},callback(e,t){const[{start:{col:n}}]=t;s.unfreezeColumn(n),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}ce.getSingleton().register("beforeColumnFreeze");ce.getSingleton().register("afterColumnFreeze");ce.getSingleton().register("beforeColumnUnfreeze");ce.getSingleton().register("afterColumnUnfreeze");const Sy="manualColumnFreeze",gU=110,or=new WeakMap;class mU extends je{static get PLUGIN_KEY(){return Sy}static get PLUGIN_PRIORITY(){return gU}constructor(e){super(e),or.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[Sy]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,t)=>this.onBeforeColumnMove(e,t)),super.enablePlugin())}disablePlugin(){const e=or.get(this);e.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=or.get(this),n=this.hot.getSettings(),o=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,o)!==!1&&(o&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,o))}unfreezeColumn(e){const t=or.get(this),n=this.hot.getSettings(),o=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,o)!==!1&&(o&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,o))}addContextMenuEntry(e){e.items.push({name:"---------"},dU(this),fU(this))}onBeforeColumnMove(e,t){if(or.get(this).afterFirstUse){const o=this.hot.getSettings().fixedColumnsStart;if(t<o||e.some(i=>i<o))return!1}}}const Ud=0,vy=1,by=2,hi="px";let pU=class{constructor(e){this.hot=e,this._element=null,this.state=Ud,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=by}build(){this.state===Ud&&(this._element=this.hot.rootDocument.createElement("div"),this.state=vy)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Ud}isAppended(){return this.state===by}isBuilt(){return this.state>=vy}setPosition(e,t){Qt(e)&&(this._element.style.top=e+hi),Qt(t)&&(this._element.style[this.inlineProperty]=t+hi)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Qt(e)&&(this._element.style.width=e+hi),Qt(t)&&(this._element.style.height=t+hi)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Qt(e)&&(this._element.style.marginTop=e+hi),Qt(t)&&(this._element.style[`margin${Bt(this.inlineProperty)}`]=t+hi)}getOffset(){const e=this._element.style,t=`margin${Bt(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const T0=pU,wU="ht__manualColumnMove--backlight";let CU=class extends T0{build(){super.build(),J(this._element,wU)}};const yU=CU,SU="ht__manualColumnMove--guideline";let vU=class extends T0{build(){super.build(),J(this._element,SU)}};const bU=vU;ce.getSingleton().register("beforeColumnMove");ce.getSingleton().register("afterColumnMove");const Yd="manualColumnMove",RU=120,Fs=new WeakMap,Ry="ht__manualColumnMove",ol="show-ui",zd="on-moving--columns",Gd="after-selection--columns";class EU extends je{static get PLUGIN_KEY(){return Yd}static get PLUGIN_PRIORITY(){return RU}constructor(e){super(e),Fs.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new ft(this),this.backlight=new yU(e),this.guideline=new bU(e)}isEnabled(){return!!this.hot.getSettings()[Yd]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,Ry),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){_e(this.hot.rootElement,Ry),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const n=Fs.get(this),o=n.cachedDropIndex,i=this.isMovePossible(e,t),r=this.hot.runHooks("beforeColumnMove",e,t,o,i);if(n.cachedDropIndex=void 0,r===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const a=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,o,i,a),a}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const n=this.countFinalIndex(e,t),o=Fs.get(this);return o.cachedDropIndex=t,this.moveColumns(e,n)}isMovePossible(e,t){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>n,i=t<0,r=e.some(l=>l<0),a=e.some(l=>l>=n);return!(o||i||r||a)}isColumnOrderChanged(e,t){return e.some((n,o)=>n-o!==t)}countFinalIndex(e,t){const n=bt(e,(o,i)=>(i<t&&(o+=1),o),0);return t-n}getColumnsWidth(e,t){const n=this.hot.columnIndexMapper;let o=0;for(let i=e;i<=t;i+=1){const r=n.getRenderableFromVisualIndex(i);i<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:r!==null&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(r)||0)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Yd];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const n=[];return me(e,t,o=>{n.push(o)}),n}refreshPositions(){const e=Fs.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo(void 0,this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1));const n=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof o.scrollX=="number"?o.scrollX:o.scrollLeft;let r=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);const a=n.hider.offsetWidth,l=n.TBODY.offsetLeft,h=this.backlight.getOffset().start,u=this.backlight.getSize().width;let d=0,f=0;if(this.hot.isRtl()){const C=this.hot.rootWindow,R=Qe(this.hot.rootElement),H=C.innerWidth-e.rootElementOffset-R;f=C.innerWidth-e.target.eventPageX-H-(o.scrollX===void 0?i:0)}else f=e.target.eventPageX-(e.rootElementOffset-(o.scrollX===void 0?i:0));if(e.hasRowHeaders&&(d=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(r+=i),r+=d,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+r<=f){const C=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=C+1,r+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let m=f,w=r;f+u+h>=a?m=a-u-h:f+h<l+d&&(m=l+d+Math.abs(h)),r>=a-1?w=a-1:w===0?w=1:o.scrollX!==void 0&&e.hoveredColumn<e.fixedColumnsStart&&(w-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,m),this.guideline.setPosition(null,w)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,n,o){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=Fs.get(this),h=Oe(e.target,"sortAction");if(!a||!r||l.pressed||e.button!==0||h){l.pressed=!1,l.columnsToMove.length=0,_e(this.hot.rootElement,[zd,ol]);return}const u=this.guideline.isBuilt()&&!this.guideline.isAppended(),d=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&d&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:f,to:m}=a,w=Math.min(f.col,m.col),C=Math.max(f.col,m.col);if(t.row<0&&t.col>=w&&t.col<=C){o.column=!0,l.pressed=!0,l.target.eventPageX=e.pageX,l.target.eventOffsetX=e.offsetX,l.hoveredColumn=t.col,l.target.TD=n,l.target.col=t.col,l.columnsToMove=this.prepareColumnsToMoving(w,C),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=Tt(this.hot.rootElement).left;const R=l.hasRowHeaders?-1:0,H=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,A=t.col<l.fixedColumnsStart,_=Math.abs(this.hot.view._wt.wtOverlays.inlineStartOverlay.getScrollPosition()),O=Math.abs(e.offsetX-(this.hot.isRtl()?e.target.offsetWidth:0)),D=this.getColumnsWidth(w,t.col-1)+O,G=this.getColumnsWidth(R,w-1)+(A?_:0)+D;this.backlight.setPosition(H,G),this.backlight.setSize(this.getColumnsWidth(w,C),i.hider.offsetHeight-H),this.backlight.setOffset(null,-D),J(this.hot.rootElement,zd)}else _e(this.hot.rootElement,Gd),l.pressed=!1,l.columnsToMove.length=0}onMouseMove(e){const t=Fs.get(this);if(t.pressed){if(e.target===this.backlight.element){const n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}t.target.eventPageX=e.pageX,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,n,o){const i=this.hot.getSelectedRangeLast(),r=Fs.get(this);!i||!r.pressed||(r.columnsToMove.indexOf(t.col)>-1?_e(this.hot.rootElement,ol):J(this.hot.rootElement,ol),o.row=!0,o.column=!0,o.cell=!0,r.hoveredColumn=t.col,r.target.TD=n)}onMouseUp(){const e=Fs.get(this),t=e.target.col,n=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,_e(this.hot.rootElement,[zd,ol,Gd]),this.hot.selection.isSelectedByColumnHeader()&&J(this.hot.rootElement,Gd),n<1||t===void 0)return;const o=e.columnsToMove[0],i=this.hot.toPhysicalColumn(o),r=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const a=this.hot.toVisualColumn(i),l=a+n-1;this.hot.selectColumns(a,l)}}onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,n=e.holder.scrollTop,o=t+n;this.backlight.setPosition(o),this.backlight.setSize(null,e.hider.offsetHeight-o)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const il="manualColumnResize",TU=130,Ey="manualColumnWidths",jd=new WeakMap;class MU extends je{static get PLUGIN_KEY(){return il}static get PLUGIN_PRIORITY(){return TU}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new ft(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,jd.set(this,{config:void 0}),J(this.handle,"manualColumnResizer"),J(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[il]}enablePlugin(){this.enabled||(this.columnWidthsMap=new so,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,t)=>this.onModifyColWidth(e,t)),this.addHook("beforeStretchingColumnWidth",(e,t)=>this.onBeforeStretchingColumnWidth(e,t)),this.addHook("beforeColumnResize",(e,t,n)=>this.onBeforeColumnResize(e,t,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=jd.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",Ey,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",Ey,e),e.value}setManualSize(e,t){const n=Math.max(t,20),o=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(o,n),n}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}onMapInit(){const e=jd.get(this),t=this.hot.getSettings()[il],n=this.loadManualColumnWidths();typeof n<"u"?this.hot.batchExecution(()=>{n.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0),e.config=t):t===!0&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:t}=this.hot.view,n=t.wtTable.getCoords(this.currentTH),o=n.col;if(o<0)return;const i=dt(this.currentTH),r=this.currentTH.getBoundingClientRect(),a=o<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,n.row,n.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){const u=this.hot.getSelectedRange();I(u,d=>{const f=d.getTopStartCorner().col,m=d.getBottomEndCorner().col;me(f,m,w=>{this.selectedCols.includes(w)||this.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(r.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${i}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(dt(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);J(this.handle,"active"),J(this.guide,"active"),this.guide.style.top=`${t}px`,this.refreshGuidePosition(),this.guide.style.height=`${n-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){_e(this.handle,"active"),_e(this.guide,"active")}checkIfColumnHeader(e){return!!js(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!sm(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const n=t.getAttribute("colspan");t&&(n===null||n==="1")&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(n,o)=>{const i=this.hot.runHooks("beforeColumnResize",this.newSize,n,!0);i!==void 0&&(this.newSize=i),this.hot.getSettings().stretchH==="all"?this.clearManualSize(n):this.setManualSize(n,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,n,!0),o&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(I(this.selectedCols,o=>{t(o)}),e()):I(this.selectedCols,o=>{t(o,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Oe(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+t,I(this.selectedCols,n=>{this.newSize=this.setManualSize(n,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(n,o)=>{this.hot.runHooks("beforeColumnResize",this.newSize,n,!1),o&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(I(this.selectedCols,o=>{t(o)}),e()):I(this.selectedCols,o=>{t(o,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",n=>this.onMouseOver(n)),this.eventManager.addEventListener(t,"mousedown",n=>this.onMouseDown(n)),this.eventManager.addEventListener(e,"mousemove",n=>this.onMouseMove(n)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,t){let n=e;if(this.enabled){const o=this.hot.toPhysicalColumn(t),i=this.columnWidthsMap.getValueAtIndex(o);this.hot.getSettings()[il]&&i&&(n=i)}return n}onBeforeStretchingColumnWidth(e,t){let n=this.columnWidthsMap.getValueAtIndex(t);return n===null&&(n=e),n}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const Kd=0,Ty=1,My=2,ui="px";let OU=class{constructor(e){this.hot=e,this._element=null,this.state=Kd}appendTo(e){e.appendChild(this._element),this.state=My}build(){this.state===Kd&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Ty)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Kd}isAppended(){return this.state===My}isBuilt(){return this.state>=Ty}setPosition(e,t){e!==void 0&&(this._element.style.top=e+ui),t!==void 0&&(this._element.style.left=t+ui)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+ui),t&&(this._element.style.height=t+ui)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+ui),t&&(this._element.style.marginLeft=t+ui)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const M0=OU,IU="ht__manualRowMove--backlight";class _U extends M0{build(){super.build(),J(this._element,IU)}}const AU=_U,xU="ht__manualRowMove--guideline";class HU extends M0{build(){super.build(),J(this._element,xU)}}const DU=HU;ce.getSingleton().register("beforeRowMove");ce.getSingleton().register("afterRowMove");const Xd="manualRowMove",PU=140,Vs=new WeakMap,Oy="ht__manualRowMove",rl="show-ui",qd="on-moving--rows",Zd="after-selection--rows";class O0 extends je{static get PLUGIN_KEY(){return Xd}static get PLUGIN_PRIORITY(){return PU}constructor(e){super(e),Vs.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new ft(this),this.backlight=new AU(e),this.guideline=new DU(e)}isEnabled(){return!!this.hot.getSettings()[Xd]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,Oy),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){_e(this.hot.rootElement,Oy),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const n=Vs.get(this),o=n.cachedDropIndex,i=this.isMovePossible(e,t),r=this.hot.runHooks("beforeRowMove",e,t,o,i);if(n.cachedDropIndex=void 0,r===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const a=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,o,i,a),a}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const n=this.countFinalIndex(e,t),o=Vs.get(this);return o.cachedDropIndex=t,this.moveRows(e,n)}isMovePossible(e,t){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>n,i=t<0,r=e.some(l=>l<0),a=e.some(l=>l>=n);return!(o||i||r||a)}isRowOrderChanged(e,t){return e.some((n,o)=>n-o!==t)}countFinalIndex(e,t){const n=bt(e,(o,i)=>(i<t&&(o+=1),o),0);return t-n}getRowsHeight(e,t){const n=this.hot.rowIndexMapper;let o=0;for(let i=e;i<=t;i++){const r=n.getRenderableFromVisualIndex(i);r!==null&&(o+=this.hot.view._wt.wtTable.getRowHeight(r)||23)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Xd];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:n,to:o}=e,i=Math.min(n.row,o.row),r=Math.max(n.row,o.row);return me(i,r,a=>{t.push(a)}),t}refreshPositions(){const e=Vs.get(this),t=e.target.coords,n=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(t.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(t.row)&&o<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const r=this.hot.view._wt.wtTable,a=e.target.TD,l=this.hot.rootElement,h=Tt(l),u=Ao(l),d=r.holder.scrollTop;let f;this.hot.rootWindow===u?f=u.scrollY:f=u.scrollTop;const m=h.top-f,w=e.target.eventPageY-m+d,C=r.hider.offsetHeight,R=r.TBODY.offsetTop,H=this.backlight.getOffset().top,A=this.backlight.getSize().height,_=a.offsetHeight/2,O=a.offsetHeight;let D=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const G=w>=D+_;this.isFixedRowTop(t.row)&&(D+=r.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:G?(e.target.row=t.row+1,D+=t.row===0?O-1:O):e.target.row=t.row;let z=w,ee=D;w+A+H>=C?z=C-A-H:w+H<R&&(z=R+Math.abs(H)),D>=C-1&&(ee=C-1),this.backlight.setPosition(z),this.guideline.setPosition(ee)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,n,o){const{wtTable:i,wtViewport:r}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),h=Vs.get(this);if(!l||!a||h.pressed||e.button!==0){h.pressed=!1,h.rowsToMove.length=0,_e(this.hot.rootElement,[qd,rl]);return}const u=this.guideline.isBuilt()&&!this.guideline.isAppended(),d=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&d&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:f,to:m}=l,w=Math.min(f.row,m.row),C=Math.max(f.row,m.row);if(t.col<0&&t.row>=w&&t.row<=C){o.row=!0,h.pressed=!0,h.target.eventPageY=e.pageY,h.target.coords=t,h.target.TD=n,h.rowsToMove=this.prepareRowsToMoving();const R=i.holder.scrollLeft+r.getRowHeaderWidth();this.backlight.setPosition(null,R),this.backlight.setSize(i.hider.offsetWidth-R,this.getRowsHeight(w,C)),this.backlight.setOffset((this.getRowsHeight(w,t.row-1)+e.offsetY)*-1,null),J(this.hot.rootElement,qd),this.refreshPositions()}else _e(this.hot.rootElement,Zd),h.pressed=!1,h.rowsToMove.length=0}onMouseMove(e){const t=Vs.get(this);if(t.pressed){if(e.target===this.backlight.element){const n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}t.target.eventPageY=e.pageY,this.refreshPositions()}}onBeforeOnCellMouseOver(e,t,n,o){const i=this.hot.getSelectedRangeLast(),r=Vs.get(this);!i||!r.pressed||(r.rowsToMove.indexOf(t.row)>-1?_e(this.hot.rootElement,rl):J(this.hot.rootElement,rl),o.row=!0,o.column=!0,o.cell=!0,r.target.coords=t,r.target.TD=n)}onMouseUp(){const e=Vs.get(this),t=e.target.row,n=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,_e(this.hot.rootElement,[qd,rl,Zd]),this.hot.selection.isSelectedByRowHeader()&&J(this.hot.rootElement,Zd),n<1||t===void 0)return;const o=e.rowsToMove[0],i=this.hot.toPhysicalRow(o),r=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const a=this.hot.toVisualRow(i),l=a+n-1;this.hot.selectRows(a,l)}}onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=e.holder.scrollLeft,o=t+n;this.backlight.setPosition(null,o),this.backlight.setSize(e.hider.offsetWidth-o)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const al="manualRowResize",NU=30,Iy="manualRowHeights",Qd=new WeakMap;class kU extends je{static get PLUGIN_KEY(){return al}static get PLUGIN_PRIORITY(){return NU}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new ft(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,Qd.set(this,{config:void 0}),J(this.handle,"manualRowResizer"),J(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[al]}enablePlugin(){this.enabled||(this.rowHeightsMap=new so,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,t)=>this.onModifyRowHeight(e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=Qd.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",Iy,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",Iy,e),e.value}setManualSize(e,t){const n=this.hot.toPhysicalRow(e),o=Math.max(t,yb.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(n,o),o}setupHandlePosition(e){this.currentTH=e;const{view:t}=this.hot,{_wt:n}=t,o=n.wtTable.getCoords(this.currentTH),i=o.row;if(i<0)return;const r=Qe(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=i<n.getSetting("fixedRowsTop"),h=i>=t.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let u;l?u=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):h&&(u=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),u||(u=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const f=this.hot.getSelectedRange();I(f,m=>{const w=m.getTopStartCorner().row,C=m.getBottomStartCorner().row;me(w,C,R=>{this.selectedRows.includes(R)||this.selectedRows.push(R)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=u.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${u.start}px`,this.handle.style.width=`${r}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(Qe(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);J(this.handle,"active"),J(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${t}px`,this.guide.style.width=`${n-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){_e(this.handle,"active"),_e(this.guide,"active")}checkIfRowHeader(e){var t;return js(e,["TH"],this.hot.rootElement)&&((t=e.parentNode)===null||t===void 0||(t=t.parentNode)===null||t===void 0?void 0:t.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&this.newSize<t?t:this.newSize}onMouseOver(e){if(!sm(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(n,o)=>{const i=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);i!==void 0&&(this.newSize=i),this.setManualSize(n,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),o&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(I(this.selectedRows,o=>{t(o)}),e()):I(this.selectedRows,o=>{t(o,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Oe(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),I(this.selectedRows,t=>{this.newSize=this.setManualSize(t,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(n,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),o&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(I(this.selectedRows,o=>{t(o)}),e()):I(this.selectedRows,o=>{t(o,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>this.onMouseOver(n)),this.eventManager.addEventListener(e,"mousedown",n=>this.onMouseDown(n)),this.eventManager.addEventListener(t,"mousemove",n=>this.onMouseMove(n)),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,t){let n=e;if(this.enabled){const o=this.hot.toPhysicalRow(t),i=this.rowHeightsMap.getValueAtIndex(o);this.hot.getSettings()[al]&&i&&(n=i)}return n}onMapInit(){const e=Qd.get(this),t=this.hot.getSettings()[al],n=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof n<"u"?n.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)}):Array.isArray(t)?(t.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)}),e.config=t):t===!0&&Array.isArray(e.config)&&e.config.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)})},!0)}destroy(){super.destroy()}}class LU{constructor(e,t,n,o,i,r){this.row=e,this.col=t,this.rowspan=n,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(e){return Je`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return Je`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return Je`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return Je`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,t,n){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const t=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const n=e[0]||e[1],o=t+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",r=e[0]?"col":"row",a=Math.min(t,o),l=Math.max(t,o),h=this[r],u=this[r]+this[i]-1;if(h>=t&&(this[r]+=n),n>0)t<=u&&t>h&&(this[i]+=n);else if(n<0){if(a<=h&&l>=u)return this.removed=!0,!1;if(h>=a&&h<=l){const d=l-h+1,f=Math.abs(n)-d;this[r]-=f+n,this[i]-=d}else if(h<=a&&u>=l)this[i]+=n;else if(h<=a&&u>=a&&u<l){const d=u-a+1;this[i]-=d}}return!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const qn=LU;function cg(s,e,t,n){e?e.row===t&&e.col===n?(s.setAttribute("rowspan",e.rowspan.toString()),s.setAttribute("colspan",e.colspan.toString())):(s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="none"):(s.removeAttribute("rowspan"),s.removeAttribute("colspan"),s.style.display="")}class Ep{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return Je`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){const n=this.mergedCells;let o=!1;return I(n,i=>i.row<=e&&i.row+i.rowspan-1>=e&&i.col<=t&&i.col+i.colspan-1>=t?(o=i,!1):!0),o}getByRange(e){const t=this.mergedCells;let n=!1;return I(t,o=>o.row<=e.from.row&&o.row+o.rowspan-1>=e.to.row&&o.col<=e.from.col&&o.col+o.colspan-1>=e.to.col?(n=o,n):!0),n}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCells,o=[];let i=e;if(!i.includesRange){const r=this.hot._createCellCoords(i.from.row,i.from.col),a=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(r,r,a)}return I(n,r=>{const a=this.hot._createCellCoords(r.row,r.col),l=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),h=this.hot._createCellRange(a,a,l);t?i.overlaps(h)&&o.push(r):i.includesRange(h)&&o.push(r)}),o.length?o:!1}add(e){const t=this.mergedCells,n=e.row,o=e.col,i=e.rowspan,r=e.colspan,a=new qn(n,o,i,r,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,o),h=this.isOverlapping(a);return!l&&!h?(this.hot&&a.normalize(this.hot),t.push(a),a):(it(Ep.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const n=this.mergedCells,o=this.get(e,t),i=o?this.mergedCells.indexOf(o):-1;return o&&i!==-1?(n.splice(i,1),o):!1}clear(){const e=this.mergedCells,t=[],n=[];I(e,o=>{const i=this.hot.getCell(o.row,o.col);i&&t.push([i,this.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,I(t,(o,i)=>{me(0,o.rowspan-1,r=>{me(0,o.colspan-1,a=>{if(a!==0||r!==0){const l=this.hot.getCell(o.row+r,o.col+a);l&&n.push([l,null,null,null])}})}),t[i][1]=null}),I(t,o=>{cg(...o)}),I(n,o=>{cg(...o)})}isOverlapping(e){const t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let n=!1;return I(this.mergedCells,o=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(o.row,o.col),this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1)).overlaps(t)?(n=!0,!1):!0),n}isFirstRenderableMergedCell(e,t){const n=this.get(e,t);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===t}getFirstRenderableCoords(e,t){const n=this.get(e,t);if(!n||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(o,i)}shiftCollections(e,t,n){const o=[0,0];switch(e){case"right":o[0]+=n;break;case"left":o[0]-=n;break;case"down":o[1]+=n;break;case"up":o[1]-=n;break}I(this.mergedCells,i=>{i.shift(o,t)}),zl(this.mergedCells.length-1,0,i=>{const r=this.mergedCells[i];r&&r.removed&&this.mergedCells.splice(this.mergedCells.indexOf(r),1)})}}const FU=Ep;class VU{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let n=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?n="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?n="up":t[1]===e[1]&&t[2]===e[2]?n="right":n="left",n}snapDragArea(e,t,n,o){const i=t.slice(0),r=this.getAutofillSize(e,t,n),[a,l,h,u]=e,f=["up","down"].indexOf(n)>-1?h-a+1:u-l+1,m=Math.floor(r/f)*f,w=r-m,C=this.getFarthestCollection(e,t,n,o);if(C){if(n==="down"){const R=C.row+C.rowspan-a-w;i[2]+R>=this.plugin.hot.countRows()?i[2]-=w:i[2]+=w?R:0}else if(n==="right"){const R=C.col+C.colspan-l-w;i[3]+R>=this.plugin.hot.countCols()?i[3]-=w:i[3]+=w?R:0}else if(n==="up"){const R=h-w-C.row+1;i[0]+R<0?i[0]+=w:i[0]-=w?R:0}else if(n==="left"){const R=u-w-C.col+1;i[1]+R<0?i[1]+=w:i[1]-=w?R:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:o,fillSize:r,dragArea:i,cycleLength:f}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Mt(this.currentFillData,e)}getAutofillSize(e,t,n){const[o,i,r,a]=e,[l,h,u,d]=t;switch(n){case"up":return o-l;case"down":return u-r;case"left":return i-h;case"right":return d-a;default:return null}}getDragArea(e,t,n){const[o,i,r,a]=e,[l,h,u,d]=t;switch(n){case"up":return[l,h,o-1,a];case"down":return[r+1,i,u,a];case"left":return[l,h,r,i-1];case"right":return[o,a+1,u,d];default:return null}}getFarthestCollection(e,t,n,o){const[i,r,a,l]=e,h=["up","down"].indexOf(n)>-1,u=h?a:l,d=h?i:r,f=this.getAutofillSize(e,t,n),m=h?a-i+1:l-r+1,w=Math.floor(f/m)*m,C=f-w;let R=null,H=null,A=null;switch(n){case"up":R="includesVertically",A=u-C+1;break;case"left":R="includesHorizontally",A=u-C+1;break;case"down":R="includesVertically",A=d+C-1;break;case"right":R="includesHorizontally",A=d+C-1;break}return I(o,_=>{_[R](A)&&_.isFarther(H,n)&&(H=_)}),H}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=(h,u)=>{switch(o){case"up":return h.row-u>=t.from.row;case"down":return h.row+h.rowspan-1+u<=t.to.row;case"left":return h.col-u>=t.from.column;case"right":return h.col+h.colspan-1+u<=t.to.column;default:return null}};let r=0,a=null,l=1;do for(let h=0;h<n.length;h+=1){if(a=n[h],r=l*this.currentFillData.cycleLength,i(a,r))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:a.row-r,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+r,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-r,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+r,colspan:a.colspan});break}h===n.length-1&&(l+=1)}while(i(a,r));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},n={min:null,max:null};return I(e,o=>{const i=o[0],r=this.plugin.hot.propToCol(o[1]);(t.min===null||i<t.min)&&(t.min=i),(t.max===null||i>t.max)&&(t.max=i),(n.min===null||r<n.min)&&(n.min=r),(n.max===null||r>n.max)&&(n.max=r)}),{from:{row:t.min,column:n.min},to:{row:t.max,column:n.max}}}dragAreaOverlapsCollections(e,t,n){const o=this.getDragArea(e,t,n),[i,r,a,l]=o,h=this.plugin.hot._createCellCoords(i,r),u=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(h,h,u);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}const $U=VU;class WU{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,t,n){const o=t.to,i=o.row+e.row,r=o.col+e.col;e.row?this.jumpOverMergedCell(e,n,i):e.col&&this.jumpOverMergedCell(e,n,r)}jumpOverMergedCell(e,t,n){let o=e.row||e.col,i=null,r=null,a=null;e.row?(i=t.includesVertically(n),r=t.row,a=t.getLastRow()):e.col&&(i=t.includesHorizontally(n),r=t.col,a=t.getLastColumn()),o!==0&&(o>0?i&&n!==r&&(o+=a-n+1):i&&n!==a&&(o-=n-r+1),e.row?e.row=o:e.col&&(e.col=o))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,n,o){const i=Math.min(n[0],n[2]),r=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(o===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const u=this.plugin.mergedCellsCollection.get(e,t);if(!u)return;const d=u.getLastRow(),f=u.getLastColumn();if(i<=u.row&&r<=u.col&&a>=d&&l>=f)return`${this.fullySelectedMergedCellClassName}-${o}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const n=[];if(!t||!e)return!1;for(let o=0;o<e.rowspan;o+=1)for(let i=0;i<e.colspan;i+=1)n.push(this.hot._createCellCoords(e.row+o,e.col+i));for(let o=0;o<n.length;o+=1){const i=[];for(let r=0;r<t.length;r+=1)i[r]=t[r].includes(n[o]);if(!i.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const BU=WU;function UU(s){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=s.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(Qh)}return this.getTranslatedPhrase(Zh)},callback(){s.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?qn.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}ce.getSingleton().register("beforeMergeCells");ce.getSingleton().register("afterMergeCells");ce.getSingleton().register("beforeUnmergeCells");ce.getSingleton().register("afterUnmergeCells");const cr="mergeCells",YU=150,_y=new WeakMap,Ay=cr;class zU extends je{static get PLUGIN_KEY(){return cr}static get PLUGIN_PRIORITY(){return YU}constructor(e){super(e),_y.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[cr]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new FU(this),this.autofillCalculations=new $U(this),this.selectionCalculations=new BU(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return e.onBeforeRemoveCellClassNames(...arguments)}),this.addHook("beforeUndoStackChange",(t,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[cr];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!rm())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:o,rowspan:i}=n;for(let r=o+1;r<o+i;r++)t.push(r)}),t=[...new Set(t)],t.forEach(n=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(i=>(i==null?void 0:i.name)==="master"?i:i.clone.wtTable).forEach(i=>{const r=i.getRow(o);r&&(r.style.background=Mi(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{n.style.background=Mi(n,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let t=!0;return e?(qn.containsNegativeValues(e)?(it(qn.NEGATIVE_VALUES_WARNING(e)),t=!1):qn.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(it(qn.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):qn.isSingleCell(e)?(it(qn.IS_SINGLE_CELL(e)),t=!1):qn.containsZeroSpan(e)&&(it(qn.ZERO_SPAN_WARNING(e)),t=!1),t):!1}generateFromSettings(e){if(Array.isArray(e)){const t=[];if(I(e,n=>{if(!this.validateSetting(n))return;const o=this.hot._createCellCoords(n.row,n.col),i=this.hot._createCellCoords(n.row+n.rowspan-1,n.col+n.colspan-1),r=this.hot._createCellRange(o,o,i);this.mergeRange(r,!0,!0),me(n.row,n.row+n.rowspan-1,a=>{me(n.col,n.col+n.colspan-1,l=>{a===n.row&&l===n.col||t.push([a,l,null])})})}),t.length===0)return;this.hot.setDataAtCell(t)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,n.row,n.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=e.getTopStartCorner(),i=e.getBottomEndCorner(),r={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},a=[];let l=null;return this.canMergeRange(r,t)?(this.hot.runHooks("beforeMergeCells",e,t),me(0,r.rowspan-1,u=>{me(0,r.colspan-1,d=>{let f=null;a[u]||(a[u]=[]),u===0&&d===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+u,r.col+d,"hidden",!0),a[u][d]=f})}),this.hot.setCellMeta(r.row,r.col,"spanned",!0),this.mergedCellsCollection.add(r)?(n?l=[r.row,r.col,a]:this.hot.populateFromArray(r.row,r.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,r,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n&&(this.hot.runHooks("beforeUnmergeCells",e,t),I(n,o=>{this.mergedCellsCollection.remove(o.row,o.col),me(0,o.rowspan-1,i=>{me(0,o.colspan-1,r=>{this.hot.removeCellMeta(o.row+i,o.col+r,"hidden"),this.hot.removeCellMeta(o.row+i,o.col+r,"copyable")})}),this.hot.removeCellMeta(o.row,o.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,n,o){const i=this.hot._createCellCoords(e,t),r=this.hot._createCellCoords(n,o);this.mergeRange(this.hot._createCellRange(i,i,r))}unmerge(e,t,n,o){const i=this.hot._createCellCoords(e,t),r=this.hot._createCellCoords(n,o);this.unmergeRange(this.hot._createCellRange(i,i,r))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[cr]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{this.toggleMerge(this.hot.getSelectedRangeLast()),this.hot.render()},runOnlyIf:n=>!n.altKey,group:Ay})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Ay)}onAfterIsMultipleSelection(e){if(e){const t=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let o=0;o<t.length;o+=1)if(n.from.row===t[o].row&&n.from.col===t[o].col&&n.to.row===t[o].row+t[o].rowspan-1&&n.to.col===t[o].col+t[o].colspan-1)return!1}return e}onModifyTransformStart(e){const t=_y.get(this),n=this.hot.getSelectedRangeLast();let o={row:e.row,col:e.col},i=null;const r=this.hot._createCellCoords(n.highlight.row,n.highlight.col),a=this.mergedCellsCollection.get(r.row,r.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){const h=this.hot._createCellCoords(a.row,a.col),u=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);this.hot._createCellRange(h,h,u).includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),o.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-r.row:o.row,o.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-r.col:o.col,e.row>0?o.row=a.row+a.rowspan-1-r.row+e.row:e.row<0&&(o.row=r.row-a.row+e.row),e.col>0?o.col=a.col+a.colspan-1-r.col+e.col:e.col<0&&(o.col=r.col-a.col+e.col)}i=this.hot._createCellCoords(n.highlight.row+o.row,n.highlight.col+o.col);const l=this.mergedCellsCollection.get(i.row,i.col);if(l){const h=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);t.lastDesiredCoords=i,o={row:h.row-r.row,col:h.col-r.col}}o.row!==0&&(e.row=o.row),o.col!==0&&(e.col=o.col)}onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),n=Jt(e),o=this.selectionCalculations.getUpdatedSelectionRange(t,e);let i=Jt(n);const r=this.mergedCellsCollection.getWithinRange(o,!0);do i=Jt(n),this.selectionCalculations.getUpdatedSelectionRange(t,n),I(r,a=>{this.selectionCalculations.snapDelta(n,t,a)});while(n.row!==i.row||n.col!==i.col);e.row=n.row,e.col=n.col}onModifyGetCellCoords(e,t){if(e<0||t<0)return;const n=this.mergedCellsCollection.get(e,t);if(!n)return;const{row:o,col:i,colspan:r,rowspan:a}=n;return[o,i,o+a-1,i+r-1]}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},UU(this))}onAfterRenderer(e,t,n){const o=this.mergedCellsCollection.get(t,n),i=Le(o)?Jt(o):void 0;if(Le(i)){const{rowIndexMapper:r,columnIndexMapper:a}=this.hot,{row:l,col:h,colspan:u,rowspan:d}=i,[f,m]=this.translateMergedCellToRenderable(l,d,h,u),w=r.getRenderableFromVisualIndex(t),C=a.getRenderableFromVisualIndex(n),R=f-w+1,H=m-C+1;i.row=r.getNearestNotHiddenIndex(i.row,1),i.col=a.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,R),i.colspan=Math.min(i.colspan,H)}cg(e,i,t,n)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){const t=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[t.row,t.col]}}onBeforeSetRangeEnd(e){const t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1){const r=this.mergedCellsCollection.mergedCells[o].getRange();t.expandByRange(r)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}onAfterGetCellMeta(e,t,n){const o=this.mergedCellsCollection.get(e,t);o&&(o.row!==e||o.col!==t?n.copyable=!1:(n.rowspan=o.rowspan,n.colspan=o.colspan))}onAfterViewportRowCalculatorOverride(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}modifyViewportRowStart(e,t){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<t;i+=1){const r=this.mergedCellsCollection.get(o,i);if(Le(r)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const n=this.hot.rowIndexMapper,o=n.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<t;i+=1){const r=this.mergedCellsCollection.get(o,i);if(Le(r)){const a=r.row+r.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}onAfterViewportColumnCalculatorOverride(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}modifyViewportColumnStart(e,t){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<t;i+=1){const r=this.mergedCellsCollection.get(i,o);if(Le(r)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const n=this.hot.columnIndexMapper,o=n.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<t;i+=1){const r=this.mergedCellsCollection.get(i,o);if(Le(r)){const a=r.col+r.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,n,o){const{rowIndexMapper:i,columnIndexMapper:r}=this.hot;let a,l;t===0?a=i.getNearestNotHiddenIndex(e,1):a=i.getNearestNotHiddenIndex(e+t-1,-1),o===0?l=r.getNearestNotHiddenIndex(n,1):l=r.getNearestNotHiddenIndex(n+o-1,-1);const h=e>=0?i.getRenderableFromVisualIndex(a):e,u=n>=0?r.getRenderableFromVisualIndex(l):n;return[h,u]}onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const n=this.autofillCalculations.getDirection(t,e);let o=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,o,n))return o=t,o;const i=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return i&&(o=this.autofillCalculations.snapDragArea(t,o,n,i)),o}onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}onAfterCreateRow(e,t,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,t)}onAfterRemoveRow(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}onAfterChange(e,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,t){if(t&&t==="area"){const n=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(n);I(o,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(e[2]=i.row,e[3]=i.col)})}}onAfterModifyTransformStart(e,t,n){if(!this.enabled)return;const o=this.mergedCellsCollection.get(e.row,e.col);if(!o)return;const i=t>0,r=t<0,a=n<0,l=n>0,h=o.row+o.rowspan-1===this.hot.countRows()-1,u=o.row===0,d=o.col+o.colspan-1===this.hot.countCols()-1,f=o.col===0;(i&&h||r&&u||l&&d||a&&f)&&(e.row=o.row,e.col=o.col)}onAfterDrawSelection(e,t,n,o){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,n,o)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}function GU(s,e){return function(t,n){const[,...o]=t,[,...i]=n;return function r(a){const l=s[a],h=e[a],u=o[a],d=i[a],f=h.multiColumnSorting,w=(f.compareFunctionFactory?f.compareFunctionFactory:xR(h.type))(l,h,f)(u,d);if(w===es){const C=a+1;if(typeof e[C]<"u")return r(C)}return w}(0)}}function xy(){it(Je`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const I0="sort";function jU(s,e,t){const n=[];return t===!1||s.isColumnSorted(e)&&s.getNumberOfSortedColumns()>1&&n.push(`${I0}-${s.getIndexOfColumnInSortQueue(e)+1}`),n}function KU(s){const e=s.className.split(" "),t=new RegExp(`^${I0}-[0-9]{1,2}$`);return e.filter(n=>t.test(n))}const dg="multiColumnSorting",XU=170,qU="append",Hy="columnSorting";AR(dg,GU);class _0 extends HR{static get PLUGIN_KEY(){return dg}static get PLUGIN_PRIORITY(){return XU}constructor(e){super(e),this.pluginKey=dg}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Hy]&&xy(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];super.updateHeaderClasses(e,...n),_e(e,KU(e)),this.enabled!==!1&&J(e,jU(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Hy]&&xy(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){sg(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,qU))):this.sort(this.getColumnNextConfig(t.col)))}}const ZU="multipleSelectionHandles",QU=160;class JU extends je{static get PLUGIN_KEY(){return ZU}static get PLUGIN_PRIORITY(){return QU}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return Dn()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new ft(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function n(o){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const i=e.dragged.indexOf(o);if(i===-1)return!1;i===0?e.dragged=e.dragged.slice(0,1):i===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",o=>{let i;if(Oe(o.target,"topSelectionHandle-HitArea"))return i=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},o.preventDefault(),!1;if(Oe(o.target,"bottomSelectionHandle-HitArea"))return i=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",o=>{if(Oe(o.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,o.preventDefault(),!1;if(Oe(o.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",o=>{const{rootDocument:i}=this.hot;let r,a,l,h,u,d;if(e.dragged.length===0)return;const f=i.elementFromPoint(o.touches[0].clientX,o.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(r=e.hot.getCoords(f),r.col===-1&&(r.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),h=a.getHeight(),u=a.getDirection(),l===1&&h===1&&e.hot.selection.setRangeEnd(r),d=e.getCurrentRangeCoords(a,r,e.touchStartRange.direction,u,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=f),o.preventDefault())})}getCurrentRangeCoords(e,t,n,o,i){const r=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),h=e.getTopEndCorner();let u={start:null,end:null};switch(n){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":i==="top"?u={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,r.col)};break;case"SE-NW":i==="bottom"&&(u={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,r.col)});break}break;case"NW-SE":switch(o){case"NE-SW":i==="top"?u={start:t,end:l}:u.end=t;break;case"NW-SE":i==="top"?u={start:t,end:a}:u.end=t;break;case"SE-NW":i==="top"?u={start:t,end:r}:u.end=t;break;case"SW-NE":i==="top"?u={start:t,end:h}:u.end=t;break}break;case"SW-NE":switch(o){case"NW-SE":i==="bottom"?u={start:this.hot._createCellCoords(t.row,r.col),end:this.hot._createCellCoords(l.row,t.col)}:u={start:this.hot._createCellCoords(r.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":i==="top"?u={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:u={start:this.hot._createCellCoords(t.row,r.col),end:this.hot._createCellCoords(r.row,t.col)};break;case"SE-NW":i==="bottom"?u={start:this.hot._createCellCoords(t.row,h.col),end:this.hot._createCellCoords(r.row,t.col)}:i==="top"&&(u={start:l,end:t});break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":i==="top"&&(u.end=t);break;case"SE-NW":i==="top"?u.end=t:u={start:t,end:r};break}break}return u}isDragged(){return this.dragged.length>0}}function fg(){let{label:s="",colspan:e=1,origColspan:t=1,collapsible:n=!1,crossHiddenColumns:o=[],isCollapsed:i=!1,isHidden:r=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:s,colspan:e,origColspan:t,collapsible:n,isCollapsed:i,crossHiddenColumns:o,isHidden:r,isRoot:a,isPlaceholder:l}}function A0(){return{label:"",isPlaceholder:!0}}function eY(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;I(s,o=>{const i=[];let r=0;t.push(i),I(o,a=>{const l=fg();if(Le(a)){const{label:u,colspan:d}=a;l.label=Ct(u),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=Ct(a);r+=l.origColspan;let h=!1;if(r>=e&&(l.colspan=l.origColspan-(r-e),l.origColspan=l.colspan,h=!0),i.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)i.push(A0());return!h})});const n=Math.max(...ke(t,o=>o.length));return I(t,o=>{if(o.length<n){const i=ke(new Array(n-o.length),()=>fg());o.splice(o.length,0,...i)}}),t}function Jd(s,e,t){tY(s,e),e.set(s,t)}function tY(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _n(s,e){var t=x0(s,e,"get");return nY(s,t)}function nY(s,e){return e.get?e.get.call(s):e.value}function ir(s,e,t){var n=x0(s,e,"set");return sY(s,n,t),t}function x0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function sY(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const Dy=["label","collapsible"];var ms=new WeakMap,yo=new WeakMap,ef=new WeakMap;class oY{constructor(){Jd(this,ms,{writable:!0,value:[]}),Jd(this,yo,{writable:!0,value:0}),Jd(this,ef,{writable:!0,value:1/0})}setColumnsLimit(e){ir(this,ef,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ir(this,ms,eY(e,_n(this,ef))),ir(this,yo,_n(this,ms).length)}getData(){return _n(this,ms)}mergeWith(e){I(e,t=>{let{row:n,col:o,...i}=t;const r=this.getHeaderSettings(n,o);r!==null&&Mt(r,i,Dy)})}map(e){I(_n(this,ms),t=>{I(t,n=>{const o=e({...n});Le(o)&&Mt(n,o,Dy)})})}getHeaderSettings(e,t){var n;if(e>=_n(this,yo)||e<0)return null;const o=_n(this,ms)[e];return t>=o.length?null:(n=o[t])!==null&&n!==void 0?n:null}getHeadersSettings(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const o=[];if(e>=_n(this,yo)||e<0)return o;const i=_n(this,ms)[e];let r=0;for(let a=t;a<i.length;a++){const l=i[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=l.colspan,o.push(l),l.colspan>1&&(a+=l.colspan-1),r===n)break;if(r>n)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return _n(this,yo)}getColumnsCount(){return _n(this,yo)>0?_n(this,ms)[0].length:0}clear(){ir(this,ms,[]),ir(this,yo,0)}}function tf(s,e,t){return e=iY(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function iY(s){var e=rY(s,"string");return typeof e=="symbol"?e:String(e)}function rY(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}const aY="DF-pre-order";function H0(s,e){let t=s.call(e,this);for(let n=0;n<this.childs.length;n++){if(t===!1)return!1;t=H0.call(this.childs[n],s,e)}return t}const lY="DF-post-order";function D0(s,e){for(let t=0;t<this.childs.length;t++)if(D0.call(this.childs[t],s,e)===!1)return!1;return s.call(e,this)}const P0="BF";function hY(s,e){const t=[this];function n(){if(t.length===0)return;const o=t.shift();t.push(...o.childs),s.call(e,o)!==!1&&n()}n()}const uY=P0,Py=new Map([[aY,H0],[lY,D0],[P0,hY]]);class nh{constructor(e){tf(this,"data",{}),tf(this,"parent",null),tf(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new nh({...e.data});for(let n=0;n<e.childs.length;n++)t.addChild(this.cloneTree(e.childs[n]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:uY;if(!Py.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);Py.get(t).call(this,e,this)}walkUp(e){const t=this,n=o=>{e.call(t,o)!==!1&&o.parent!==null&&n(o.parent)};n(this)}}function nf(s,e,t){cY(s,e),e.set(s,t)}function cY(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(s,e){var t=N0(s,e,"get");return dY(s,t)}function dY(s,e){return e.get?e.get.call(s):e.value}function fY(s,e,t){var n=N0(s,e,"set");return gY(s,n,t),t}function N0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function gY(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var ci=new WeakMap,So=new WeakMap,di=new WeakMap;class mY{constructor(e){nf(this,ci,{writable:!0,value:new Map}),nf(this,So,{writable:!0,value:new Map}),nf(this,di,{writable:!0,value:null}),fY(this,di,e)}getRoots(){return Array.from(Xt(this,ci).values())}getRootByColumn(e){let t;return Xt(this,So).has(e)&&(t=Xt(this,ci).get(Xt(this,So).get(e))),t}getNode(e,t){const n=this.getRootByColumn(t);if(!n)return;const o=t-Xt(this,So).get(t);let i=0,r;return n.walkDown(a=>{const{data:{origColspan:l,headerLevel:h}}=a;if(e===h){if(o>=i&&o<=i+l-1)return r=a,r.data.isRoot=t===r.data.columnIndex,!1;i+=l}}),r}rebuildTreeIndex(){let e=0;Xt(this,So).clear(),I(Xt(this,ci),t=>{let[,{data:{colspan:n}}]=t;for(let o=e;o<e+n;o++)Xt(this,So).set(o,e);e+=n})}buildTree(){this.clear();const e=Xt(this,di).getColumnsCount();let t=0;for(;t<e;){const n=Xt(this,di).getHeaderSettings(0,t),o=new nh;Xt(this,ci).set(t,o),this.buildLeaves(o,t,0,n.origColspan),t+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,n){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const i=Xt(this,di).getHeadersSettings(n,t,o);n+=1,I(i,r=>{const a={...r,headerLevel:n-1,columnIndex:t};let l;n===1?(e.data=a,l=e):(l=new nh(a),e.addChild(l)),n<Xt(this,di).getLayersCount()&&this.buildLeaves(l,t,n,r.origColspan),t+=r.origColspan})}clear(){Xt(this,ci).clear(),Xt(this,So).clear()}}function k0(s,e){s.walkDown(t=>{let{data:n,childs:o}=t;if(!n.isHidden&&(e(n.columnIndex),o.length===0))for(let i=1;i<n.colspan;i++)e(n.columnIndex+i)})}function sh(s,e){let{childs:t}=s;if(t.length!==0)return t[0].data[e]}function oh(s){return sh(s,"origColspan")===s.data.origColspan}function Tp(s){const{data:e,childs:t}=s;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(oh(s))return Tp(t[0]);e.isCollapsed=!1;const o=t.slice(1),i=new Set;let r=0;if(o.length>0)I(o,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;r+=l.colspan,k0(a,h=>{i.add(h)})});else{const{colspan:a,origColspan:l,columnIndex:h}=e;r=l-a;for(let u=1;u<l;u++)i.add(h+u)}return s.walkUp(a=>{const{data:l}=a;l.colspan+=r,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):oh(a)&&(l.isCollapsed=sh(a,"isCollapsed"))}),{rollbackModification:()=>Mp(s),affectedColumns:Array.from(i),colspanCompensation:r}}function Mp(s){var e;const{data:t,childs:n}=s;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(oh(s))return Mp(n[0]);t.isCollapsed=!0;const i=n.slice(1),r=new Set;if(i.length>0)I(i,l=>{k0(l,h=>{r.add(h)}),l.data.clonedTree=l.cloneTree(),l.walkDown(h=>{let{data:u}=h;u.isHidden=!0})});else{const{origColspan:l,columnIndex:h}=t;for(let u=1;u<l;u++){const d=h+u;r.add(d)}}const a=t.colspan-((e=sh(s,"colspan"))!==null&&e!==void 0?e:1);return s.walkUp(l=>{const{data:h}=l;h.colspan-=a,h.colspan<=1?(h.colspan=1,h.isCollapsed=!0):oh(l)&&(h.isCollapsed=sh(l,"isCollapsed"))}),{rollbackModification:()=>Tp(s),affectedColumns:Array.from(r),colspanCompensation:a}}function pY(s,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(s.childs.length>0)throw new Error(Je`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=s.data;if(t.includes(e))return;let n=!1;s.walkUp(o=>{const{data:{collapsible:i}}=o;if(i)return n=!0,!1}),!n&&s.walkUp(o=>{const{data:i}=o;i.crossHiddenColumns.push(e),i.colspan>1?i.colspan-=1:i.isHidden=!0})}function wY(s,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(s.childs.length>0)throw new Error(Je`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=s.data;if(!t.includes(e))return;let n=!1;s.walkUp(o=>{const{data:{collapsible:i}}=o;if(i)return n=!0,!1}),!n&&s.walkUp(o=>{const{data:i}=o;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(e),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}const Ny=new Map([["collapse",Mp],["expand",Tp],["hide-column",pY],["show-column",wY]]);function CY(s,e,t){if(!Ny.has(s))throw new Error(`The node modifier action ("${s}") does not exist.`);return Ny.get(s)(e,t)}function ll(s){const e=[];return I(s,t=>{t.walkDown(n=>{const o=n.data,{origColspan:i,columnIndex:r,headerLevel:a,crossHiddenColumns:l}=o,h=SY(e,a);let u=!1;for(let d=r;d<r+i;d++)if(l.includes(d)||u)h.push(A0());else{const m=yY(o);m.isRoot=!0,h.push(m),u=!0}})}),e}function yY(s){const{crossHiddenColumns:e,...t}=fg(s);return t}function SY(s,e){let t;return Array.isArray(s[e])?t=s[e]:(t=[],s[e]=t),t}function sf(s,e,t){vY(s,e),e.set(s,t)}function vY(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(s,e,t){var n=L0(s,e,"set");return bY(s,n,t),t}function bY(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function vt(s,e){var t=L0(s,e,"get");return RY(s,t)}function L0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function RY(s,e){return e.get?e.get.call(s):e.value}var Kn=new WeakMap,cn=new WeakMap,vo=new WeakMap;class EY{constructor(){sf(this,Kn,{writable:!0,value:new oY}),sf(this,cn,{writable:!0,value:new mY(vt(this,Kn))}),sf(this,vo,{writable:!0,value:[[]]})}setState(e){vt(this,Kn).setData(e);let t=!1;try{vt(this,cn).buildTree()}catch{vt(this,cn).clear(),vt(this,Kn).clear(),t=!0}return rr(this,vo,ll(vt(this,cn).getRoots())),t}setColumnsLimit(e){vt(this,Kn).setColumnsLimit(e)}mergeStateWith(e){const t=ke(e,n=>{let{row:o,...i}=n;return{row:o<0?this.rowCoordsToLevel(o):o,...i}});vt(this,Kn).mergeWith(t),vt(this,cn).buildTree(),rr(this,vo,ll(vt(this,cn).getRoots()))}mapState(e){vt(this,Kn).map(e),vt(this,cn).buildTree(),rr(this,vo,ll(vt(this,cn).getRoots()))}mapNodes(e){return bt(vt(this,cn).getRoots(),(t,n)=>(n.walkDown(o=>{const i=e(o.data);i!==void 0&&t.push(i)}),t),[])}triggerNodeModification(e,t,n){t<0&&(t=this.rowCoordsToLevel(t));const o=vt(this,cn).getNode(t,n);let i;return o&&(i=CY(e,o,n),rr(this,vo,ll(vt(this,cn).getRoots()))),i}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var n,o;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(o=vt(this,vo)[e])===null||o===void 0?void 0:o[t])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=vt(this,cn).getNode(e,t);return n?{...n.data}:null}findLeftMostColumnIndex(e,t){var n;const{isRoot:o}=(n=this.getHeaderSettings(e,t))!==null&&n!==void 0?n:{isRoot:!0};if(o)return t;let i=t-1;for(;i>=0;){var r;const{isRoot:a}=(r=this.getHeaderSettings(e,i))!==null&&r!==void 0?r:{isRoot:!0};if(a)break;i-=1}return i}getLayersCount(){return vt(this,Kn).getLayersCount()}getColumnsCount(){return vt(this,Kn).getColumnsCount()}clear(){rr(this,vo,[]),vt(this,Kn).clear(),vt(this,cn).clear()}}function ar(s,e,t){return e=TY(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function TY(s){var e=MY(s,"string");return typeof e=="symbol"?e:String(e)}function MY(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}class OY{constructor(e,t){ar(this,"hot",void 0),ar(this,"nestedHeaderSettingsGetter",void 0),ar(this,"layersCount",0),ar(this,"container",void 0),ar(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let n=0;n<t;n++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),i=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(i,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:n}=this.hot,o=t.createDocumentFragment(),i=t.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const h=t.createElement("tr");for(let u=0;u<a;u++){let d=n.getVisualFromRenderableIndex(u);d===null&&(d=u);const f=t.createElement("th"),m=this.nestedHeaderSettingsGetter(l,d);if(m&&(!m.isPlaceholder||m.isHidden)){let w=m.label;r&&(w+='<button class="changeType"></button>'),$o(f,w),f.colSpan=m.colspan,h.appendChild(f)}}i.appendChild(h)}o.appendChild(i),e.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}}const IY=OY;function ky(s,e,t){return e=_Y(e),e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function _Y(s){var e=AY(s,"string");return typeof e=="symbol"?e:String(e)}function AY(s,e){if(typeof s!="object"||s===null)return s;var t=s[Symbol.toPrimitive];if(t!==void 0){var n=t.call(s,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(s)}function Ly(s,e,t){xY(s,e),e.set(s,t)}function xY(s,e){if(e.has(s))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hl(s,e,t){var n=F0(s,e,"set");return HY(s,n,t),t}function HY(s,e,t){if(e.set)e.set.call(s,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function gt(s,e){var t=F0(s,e,"get");return DY(s,t)}function F0(s,e,t){if(!e.has(s))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(s)}function DY(s,e){return e.get?e.get.call(s):e.value}const Fy="nestedHeaders",PY=280;var Rt=new WeakMap,$s=new WeakMap;class NY extends je{constructor(){super(...arguments),Ly(this,Rt,{writable:!0,value:new EY}),Ly(this,$s,{writable:!0,value:null}),ky(this,"ghostTable",new IY(this.hot,(e,t)=>this.getHeaderSettings(e,t))),ky(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return Fy}static get PLUGIN_PRIORITY(){return PY}isEnabled(){return!!this.hot.getSettings()[Fy]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&it(Je`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return e.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",n=>this.onAfterGetColumnHeaderRenderers(n)),this.addHook("modifyColWidth",function(){return e.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return e.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return e.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return e.onBeforeCopy(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();gt(this,Rt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=gt(this,Rt).setState(e)),this.detectedOverlappedHeaders&&it(Je`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,n)=>{const o=t===!0?"hide-column":"show-column";gt(this,Rt).triggerColumnModification(o,n)}),!gt(this,$s)&&this.enabled&&hl(this,$s,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(n=>{let{op:o,index:i,newValue:r}=n;if(o==="replace"){const a=r===!0?"hide-column":"show-column";gt(this,Rt).triggerColumnModification(a,i)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),gt(this,Rt).clear(),gt(this,$s).unsubscribe(),hl(this,$s,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return gt(this,Rt)}getLayersCount(){return gt(this,Rt).getLayersCount()}getHeaderSettings(e,t){return gt(this,Rt).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,o=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<t;r++){const a=n.childNodes[r];if(!a)break;const l=o.childNodes[r],h=i?i.childNodes[r]:null;for(let u=0,d=a.childNodes.length;u<d;u++)a.childNodes[u].removeAttribute("colspan"),_e(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),_e(l.childNodes[u],"hiddenHeader")),i&&h&&h.childNodes[u]&&(h.childNodes[u].removeAttribute("colspan"),_e(h.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,i)=>{var r;const{columnIndexMapper:a,view:l}=this.hot;let h=a.getVisualFromRenderableIndex(o);h===null&&(h=o),i.removeAttribute("colspan"),_e(i,"hiddenHeader");const{colspan:u,isHidden:d,isPlaceholder:f}=(r=gt(this,Rt).getHeaderSettings(e,h))!==null&&r!==void 0?r:{label:""};if(f||d)J(i,"hiddenHeader");else if(u>1){var m,w;const{wtOverlays:C}=l._wt,R=(m=C.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(i),H=(w=C.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(i),A=R||H?Math.min(u,n-o):u;A>1&&i.setAttribute("colspan",A)}this.hot.view.appendColHeader(h,i,function(){return t.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,t){var n;const{isHidden:o,isPlaceholder:i}=(n=gt(this,Rt).getHeaderSettings(t,e))!==null&&n!==void 0?n:{};return i||o?"":this.hot.getColHeader(e,t)}onBeforeHighlightingColumnHeader(e,t,n){const o=gt(this,Rt).getHeaderTreeNodeData(t,e);if(!o)return e;const{classNames:i,columnCursor:r,selectionType:a,selectionWidth:l}=n,{isRoot:h,colspan:u}=gt(this,Rt).getHeaderSettings(t,e);if(a===aa){if(!h)return o.columnIndex}else a===Qu&&(u>l-r||!h)&&(i.length=0);return e}onBeforeCopy(e,t,n){let{columnHeadersCount:o}=n;if(o!==0)for(let r=0;r<t.length;r++){const{startRow:a,startCol:l,endRow:h,endCol:u}=t[r],d=h-a+1,f=l-u+1;if(a>=0||f===1)break;for(let m=l;m<=u;m++)for(let w=a;w<=h;w++){var i;const C=d+w,R=m-l;if(R===0)continue;((i=gt(this,Rt).getHeaderTreeNodeData(w,m))===null||i===void 0?void 0:i.isRoot)===!1&&(e[C][R]="")}}}onBeforeOnCellMouseDown(e,t,n,o){this._getHeaderTreeNodeDataByCoords(t)&&(o.column=!0)}onAfterOnCellMouseDown(e,t){const n=this._getHeaderTreeNodeDataByCoords(t);if(!n)return;const{selection:o}=this.hot,i=o.isSelected()?o.getSelectedRange().current():null,r=[],{columnIndex:a,origColspan:l}=n,h=!o.inInSelection(t);e.shiftKey&&i?t.col<i.from.col?r.push(i.getTopEndCorner().col,a,t.row):t.col>i.from.col?r.push(i.getTopStartCorner().col,a+l-1,t.row):r.push(a,a+l-1,t.row):(_h(e)||to(e)&&h)&&r.push(a,a+l-1,t.row),o.selectColumns(...r)}onBeforeOnCellMouseOver(e,t,n,o){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;const{columnIndex:r,origColspan:a}=i,l=this.hot.getSelectedRangeLast(),h=l.getTopStartCorner(),u=l.getBottomEndCorner(),{from:d}=l;o.column=!0,o.cell=!0;const f=[];t.col<d.col?f.push(u.col,r):t.col>d.col?f.push(h.col,r+a-1):f.push(r,r+a-1),this.hot.selectColumns(...f)}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<gt(this,Rt).getLayersCount();t++)e.push(this.headerRendererFactory(t))}onAfterViewportColumnCalculatorOverride(e){const t=gt(this,Rt).getLayersCount();let n=e.startColumn,o=!!t;for(let i=0;i<t;i++){const r=gt(this,Rt).findLeftMostColumnIndex(i,e.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(r);if(r>=0&&(o=!1),Qt(a)&&a<e.startColumn){n=a;break}}e.startColumn=o?gt(this,Rt).getHeaderTreeNodeData(0,n).columnIndex:n}onModifyColWidth(e,t){const n=this.ghostTable.getWidth(t);return e>n?e:n}onModifyColumnHeaderValue(e,t,n){var o;const{label:i}=(o=gt(this,Rt).getHeaderTreeNodeData(n,t))!==null&&o!==void 0?o:{label:""};return i}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){hl(this,Rt,null),gt(this,$s)!==null&&(gt(this,$s).unsubscribe(),hl(this,$s,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return gt(this,Rt).getHeaderTreeNodeData(e.row,e.col)}}class kY{constructor(e,t){this.hot=t,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,n){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&I(e.__children,o=>{this.cacheNode(o,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,n,o){let i=!1,r=t;if(isNaN(r)&&r.end)return r;let a=e;return a||(a={__children:this.data},i=!0,r-=1),n!=null&&r===n?{result:a,end:!0}:o!=null&&a===o?{result:r,end:!0}:(r+=1,a.__children&&I(a.__children,l=>{if(this.parentReference.set(l,i?null:a),r=this.readTreeNodes(l,r,n,o),isNaN(r)&&r.end)return!1}),r)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Fe(this.data[0],(t,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(t):n.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(I(n.__children,o=>{t+=1,o.__children&&(t+=this.countChildren(o))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var n;return((n=e.__children)===null||n===void 0?void 0:n[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((t=n.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let n=t;this.hot.runHooks("beforeAddChild",e,n);let o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),n||(n=this.mockNode()),i.__children.push(n),this.rewriteCache();const r=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,t,n){let o=n,i;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),i=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),i=this.getRowIndex(this.data[t]);o=this.getDataObject(i),this.hot.runHooks("afterAddChild",e,o,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),o=this.getRowParent(n),i=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const o=[];Array.isArray(e)?(me(e[0],e[2],f=>{const m=this.translateTrimmedRow(f);o.push(this.getDataObject(m))}),me(0,o.length-2,f=>{this.detachFromParent(o[f],!1)}),n=o[o.length-1]):n=e;const i=this.getRowIndex(n),r=this.countChildren(n),a=this.getRowIndexWithinParent(n),l=this.getRowParent(n),h=this.getRowParent(l),u=this.getRowIndex(h);let d=null;if(this.hot.runHooks("beforeDetachChild",l,n),a!=null){const f=Array.from(new Array(i+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",i,r+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,r+1,f,this.plugin.pluginName),h){d=u+this.countChildren(h);const m=this.getChild(h,this.countChildren(h)-1),w=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",w+1,r+1,this.plugin.pluginName),h.__children.push(n)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,r+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),t&&this.hot.render()}filterData(e,t,n){const o=[];I(n,i=>{o.push(this.getDataObject(i))}),I(o,i=>{const r=this.getRowIndexWithinParent(i),a=this.getRowParent(i);a===null?this.data.splice(r,1):a.__children.splice(r,1)}),this.rewriteCache()}spliceData(e,t,n){const o=this.getDataObject(e-1);let i=null,r=e;o&&o.__children&&o.__children.length===0?(i=o,r=0):e<this.countAllRows()&&(i=this.getRowParent(e),r=this.getRowIndexWithinParent(e)),i?n?i.__children.splice(r,t,...n):i.__children.splice(r,t):n?this.data.splice(r,t,...n):this.data.splice(r,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,n=null;do n=this.getRowParent(n),n!==null&&(t=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,n,o){const i=t===this.hot.countRows(),r=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=r.__children.slice(a,a+1),h=e>t;let u=i?this.getRowParent(t-1):this.getRowParent(t);u==null&&(u=this.getRowParent(t-1)),u==null&&(u=this.getDataObject(t-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(t),u.__children=[]);const d=i||n||o?u.__children.length:this.getRowIndexWithinParent(t),f=r===u;u.__children.splice(d,0,l[0]),r.__children.splice(a+(h&&f?1:0),1),this.syncRowWithRawSource(r),f||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const LY=kY;class FY{constructor(e,t){this.hot=t,this.plugin=e}}const Op=FY;class ys extends Op{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const n=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(n),i=this.dataManager.getDataObject(n),r=t.getElementsByTagName("DIV")[0],a=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]');if(I(l,h=>{h&&r.removeChild(h)}),J(t,ys.CSS_CLASSES.indicatorContainer),o){const{rootDocument:h}=this.hot,u=a.cloneNode(!0);r.innerHTML="",me(0,o-1,()=>{const d=h.createElement("SPAN");J(d,ys.CSS_CLASSES.emptyIndicator),r.appendChild(d)}),r.appendChild(u)}if(this.dataManager.hasChildren(i)){const h=this.hot.rootDocument.createElement("DIV");J(t,ys.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?J(h,`${ys.CSS_CLASSES.button} ${ys.CSS_CLASSES.expandButton}`):J(h,`${ys.CSS_CLASSES.button} ${ys.CSS_CLASSES.collapseButton}`),r.appendChild(h)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}const V0=ys;class VY extends Op{constructor(e,t){var n;super(e,t),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,o)},shiftStash:function(o,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;i==null&&(i=1/0),I(n.lastCollapsedRows,(a,l)=>{a>=o&&a<i&&(n.lastCollapsedRows[l]=a+r)})},applyStash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,o),n.lastCollapsedRows=void 0},trimStash:(o,i)=>{me(o,o+i-1,r=>{const a=this.lastCollapsedRows.indexOf(r);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let i=null,r=null,a=null;return isNaN(e)?(i=e,r=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),r=e),this.dataManager.hasChildren(i)&&I(i.__children,l=>{o.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(o,!0,!1),n&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(r)===-1&&this.collapsedRows.push(r),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];I(e,i=>{o.push(...this.collapseChildren(i,!1,!1))}),n&&this.trimRows(o),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return I(e,i=>{o.push(i),t&&this.collapseChildRows(i,o)}),n&&this.trimRows(o),o}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);I(o.__children,i=>{const r=this.dataManager.getRowIndex(i);t.push(r),this.collapseChildRows(r,t)})}n&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return I(e,i=>{o.push(i),t&&this.expandChildRows(i,o)}),n&&this.untrimRows(o),o}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);I(o.__children,i=>{if(!this.isAnyParentCollapsed(i)){const r=this.dataManager.getRowIndex(i);t.push(r),this.expandChildRows(r,t)}})}n&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let i=null,r=null,a=null;return isNaN(e)?(i=e,r=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),r=e),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(i)&&I(i.__children,l=>{const h=this.dataManager.getRowIndex(l);o.push(h)}),a=this.expandRows(o,!0,!1),n&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];I(e,i=>{o.push(...this.expandChildren(i,!1,!1))}),n&&this.untrimRows(o),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];I(e,n=>{this.dataManager.hasChildren(n)&&t.push(n)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];I(e,n=>{this.dataManager.hasChildren(n)&&t.push(n)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{I(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{I(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&I(t.__children,o=>{const i=this.dataManager.getRowIndex(o);if(!this.plugin.collapsedRowsMap.getValueAtIndex(i))return n=!1,!1}),n}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const n=this.translateTrimmedRow(t.row);Oe(e.target,V0.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Fn(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const $Y=VY,Vy=new WeakMap;class WY extends Op{constructor(e,t){super(e,t),Vy.set(this,{row_above:(n,o)=>{const i=o[o.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(n,o)=>{const i=o[o.length-1];this.dataManager.addSibling(i.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(wu)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),o=this.dataManager.getDataObject(n);this.dataManager.addChild(o)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Cu)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),o=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(o)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,n=>{if(n===0)return I(t,(o,i)=>{e.items.splice(n+i,0,o)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){const t=Vy.get(this);return me(0,e.items.length-1,n=>{const o=t[e.items[n].key];o!=null&&(e.items[n].callback=o)}),e}}const BY=WY;class UY{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,n,o){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:n,movePossible:o}))return!1;this.movedToCollapsed=!1;const r=n===this.hot.countRows(),a=r?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let l=!0;const h=e.map(w=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(C,a),C}),u=h.indexOf(a)===-1;if(!l||!u)return!1;const d=this.getBaseParent(h),f=this.getTargetParent(r,a),m=d===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(h,a,m),this.moveRows(h,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(h,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,n,o,o&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:n,dropIndex:o,movePossible:i}=e;let r=!1;return st(o)&&(it(Je`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,n,o,i,!1),r=!0),r}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let n=this.dataManager.getRowParent(e?t-1:t);return n==null&&(n=this.dataManager.getRowParent(t-1)),n}shiftCollapsibleParentsLocations(e,t,n){n||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,n){const o=t===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(i=>{this.dataManager.moveRow(i,t,this.movedToCollapsed,o)})})}moveCellsMeta(e,t){const n=[],o=Math.max(...e)<t;e.forEach(i=>{n.push(this.hot.getCellMetaAtRow(i))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(o?n.length:0),0,...n)}selectCells(e,t){const n=e.length;let o=0,i=0,r=null,a=null;if(this.movedToCollapsed){let l=null;e[n-1]<t?l=this.dataManager.translateTrimmedRow(t-n):l=this.dataManager.translateTrimmedRow(t);const h=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(h);o=this.dataManager.untranslateTrimmedRow(u),i=o}else e[n-1]<t?(i=t-1,o=i-n+1):(o=t,i=o+n-1);r=this.hot.selection,a=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(o,0)),r.setRangeEnd(this.hot._createCellCoords(i,a),!0)}isRowOrderChanged(e,t){return e.some((n,o)=>n-o!==t)}}const of="nestedRows",YY=300,ps=new WeakMap,zY="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class GY extends je{static get PLUGIN_KEY(){return of}static get PLUGIN_PRIORITY(){return YY}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,ps.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[of]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new oa),this.dataManager=new LY(this,this.hot),this.collapsingUI=new $Y(this,this.hot),this.headersUI=new V0(this,this.hot),this.contextMenuUI=new BY(this,this.hot),this.rowMoveController=new UY(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",t=>this.onBeforeLoadData(t)),this.addHook("beforeUpdateData",t=>this.onBeforeLoadData(t)),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}onBeforeRowMove(e,t,n,o){return this.rowMoveController.onBeforeRowMove(e,t,n,o)}disableCoreAPIModifiers(){const e=ps.get(this);e.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const e=ps.get(this);e.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,t,n){this.collapsingUI.toggleState(e,t,n)}onModifyRowData(e){if(!ps.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!ps.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,n){return ps.get(this).skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,n),!1)}onFilterData(e,t,n){const o=ps.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*t),this.dataManager.filterData(e,t,n),o.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,t,n,o){if(o===this.pluginName)return;const i=ps.get(this);setTimeout(()=>{i.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}onBeforeRemoveRow(e,t,n){const o=Array.from(n.reduce((i,r)=>{if(this.dataManager.isParent(r)){const a=this.dataManager.getDataObject(r).__children;return i.add(r),Array.isArray(a)&&a.forEach(l=>i.add(this.dataManager.getRowIndex(l))),i}return i.add(r)},new Set));n.length=0,n.push(...o)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,t,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){const e=Math.max(...this.dataManager.cache.levels);e>0&&this.headersUI.updateRowHeaderWidth(e)}onBeforeViewRender(e,t){ps.get(this).skipRender&&(t.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!Fb(e)){um(zY),this.hot.getSettings()[of]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}}class jY{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;this.rootWindow=t,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const n=typeof e>"u"?t:e,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return o===null?void 0:JSON.parse(o)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){I(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const KY=jY;ce.getSingleton().register("persistentStateSave");ce.getSingleton().register("persistentStateLoad");ce.getSingleton().register("persistentStateReset");const $y="persistentState",XY=0;class qY extends je{static get PLUGIN_KEY(){return $y}static get PLUGIN_PRIORITY(){return XY}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[$y]}enablePlugin(){this.enabled||(this.storage||(this.storage=new KY(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}const rf="search",ZY=190,QY="htSearchResult",JY=function(s,e,t,n,o){s.getCellMeta(e,t).isSearchResult=o},ez=function(s,e,t){return st(s)||s===null||!s.toLocaleLowerCase||s.length===0||st(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(s.toLocaleLowerCase(t.locale))!==-1};class tz extends je{static get PLUGIN_KEY(){return rf}static get PLUGIN_PRIORITY(){return ZY}constructor(e){super(e),this.callback=JY,this.queryMethod=ez,this.searchResultClass=QY}isEnabled(){return this.hot.getSettings()[rf]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[rf];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){return e.onBeforeRenderer(...arguments)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),i=this.hot.countCols(),r=[],a=this.hot;return me(0,o-1,l=>{me(0,i-1,h=>{const u=this.hot.getDataAtCell(l,h),d=this.hot.getCellMeta(l,h),f=d.search.callback||t,w=(d.search.queryMethod||n)(e,u,d);if(w){const C={row:l,col:h,data:u};r.push(C)}f&&f(a,l,h,u,w)})}),r}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Le(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,t,n,o,i,r){const a=r.className||[];let l=[];typeof a=="string"?l=a.split(" "):l.push(...a),this.isEnabled()&&r.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),r.className=l.join(" ")}destroy(){super.destroy()}}const nz="touchScroll",sz=200;class oz extends je{static get PLUGIN_KEY(){return nz}static get PLUGIN_PRIORITY(){return sz}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return vm()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:n,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(n),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,I(this.clones,e=>{J(e,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,I(this.clones,e=>{_e(e,"hide-tween"),J(e,"show-tween")}),this.hot._registerTimeout(()=>{I(this.clones,e=>{_e(e,"show-tween")})},400),I(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const ul="trimRows",iz=330;class rz extends je{static get PLUGIN_KEY(){return ul}static get PLUGIN_PRIORITY(){return iz}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[ul]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new oa),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[ul];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),I(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let o=t;n&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,o,n)!==!1&&(n&&this.hot.batchExecution(()=>{I(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),this.hot.runHooks("afterTrimRow",t,o,n,n&&o.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),n=this.isValidConfig(e);let o=t;const i=this.trimmedRowsMap.getValues().slice(),r=e.length>0;n&&r&&(I(e,l=>{i[l]=!1}),o=bt(i,(l,h,u)=>(h&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",t,o,n&&r)!==!1&&(n&&r&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,o,n&&r,n&&o.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<t)}onMapInit(){const e=this.hot.getSettings()[ul];Array.isArray(e)&&this.hot.batchExecution(()=>{I(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}destroy(){super.destroy()}}const $0="undoRedo",az="undoRedo";function he(s){const e=this;this.instance=s,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,s.addHook("afterChange",function(t,n){const o=t&&t.length;if(!o||!t.find(a=>{const[,,l,h]=a;return l!==h}))return;const r=()=>{const a=t.reduce((h,u)=>(h.push([...u]),h),[]);I(a,h=>{h[1]=s.propToCol(h[1])});const l=o>1?this.getSelected():[[a[0][0],a[0][1]]];return new he.ChangeAction(a,l)};e.done(r,n)}),s.addHook("afterCreateRow",(t,n,o)=>{e.done(()=>new he.CreateRowAction(t,n),o)}),s.addHook("beforeRemoveRow",(t,n,o,i)=>{const r=()=>{const a=s.toPhysicalRow(t),l=Ut(e.instance.getSourceData(a,0,a+n-1,e.instance.countSourceCols()-1));return new he.RemoveRowAction(a,l,s.getSettings().fixedRowsBottom,s.getSettings().fixedRowsTop,s.rowIndexMapper.getIndexesSequence())};e.done(r,i)}),s.addHook("afterCreateCol",(t,n,o)=>{e.done(()=>new he.CreateColumnAction(t,n),o)}),s.addHook("beforeRemoveCol",(t,n,o,i)=>{const r=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+t)%e.instance.countCols(),h=[],u=[],d=[];me(a.length-1,w=>{const C=[],R=a[w];me(l,l+(n-1),H=>{C.push(R[s.toPhysicalColumn(H)])}),h.push(C)}),me(n-1,w=>{d.push(s.toPhysicalColumn(l+w))}),Array.isArray(s.getSettings().colHeaders)&&me(n-1,w=>{u.push(s.getSettings().colHeaders[s.toPhysicalColumn(l+w)]||null)});const f=s.columnIndexMapper.getIndexesSequence(),m=s.rowIndexMapper.getIndexesSequence();return new he.RemoveColumnAction(l,d,h,u,f,m,s.getSettings().fixedColumnsStart)};e.done(r,i)}),s.addHook("beforeCellAlignment",(t,n,o,i)=>{e.done(()=>new he.CellAlignmentAction(t,n,o,i))}),s.addHook("beforeFilter",t=>{e.done(()=>new he.FiltersAction(t))}),s.addHook("beforeRowMove",(t,n)=>{t!==!1&&e.done(()=>new he.RowMoveAction(t,n))}),s.addHook("beforeMergeCells",(t,n)=>{n||e.done(()=>new he.MergeCellsAction(s,t))}),s.addHook("afterUnmergeCells",(t,n)=>{n||e.done(()=>new he.UnmergeCellsAction(s,t))}),s.addHook("afterInit",()=>{e.init()})}he.prototype.done=function(s,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const n=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",n,e)===!1)return;const i=s(),r=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",r),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice())};he.prototype.undo=function(){if(this.isUndoAvailable()){const s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice());const t=Ut(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,()=>{o.ignoreNewActions=!1,o.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};he.prototype.redo=function(){if(this.isRedoAvailable()){const s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice());const t=Ut(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,()=>{o.ignoreNewActions=!1,o.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};he.prototype.isUndoAvailable=function(){return this.doneActions.length>0};he.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};he.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};he.prototype.isEnabled=function(){return this.enabled};he.prototype.enable=function(){if(this.isEnabled())return;const s=this.instance;this.enabled=!0,uz(s),this.registerShortcuts(),s.addHook("afterChange",W0)};he.prototype.disable=function(){if(!this.isEnabled())return;const s=this.instance;this.enabled=!1,cz(s),this.unregisterShortcuts(),s.removeHook("afterChange",W0)};he.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};he.Action=function(){};he.Action.prototype.undo=function(){};he.Action.prototype.redo=function(){};he.ChangeAction=function(s,e){this.changes=s,this.selected=e,this.actionType="change"};As(he.ChangeAction,he.Action);he.ChangeAction.prototype.undo=function(s,e){const t=Ut(this.changes),n=s.countEmptyRows(!0),o=s.countEmptyCols(!0);for(let i=0,r=t.length;i<r;i++)t[i].splice(3,1);s.addHookOnce("afterChange",e),s.setDataAtCell(t,null,null,"UndoRedo.undo");for(let i=0,r=t.length;i<r;i++){const[a,l]=t[i];s.getSettings().minSpareRows&&a+1+s.getSettings().minSpareRows===s.countRows()&&n===s.getSettings().minSpareRows&&(s.alter("remove_row",parseInt(a+1,10),s.getSettings().minSpareRows),s.undoRedo.doneActions.pop()),s.getSettings().minSpareCols&&l+1+s.getSettings().minSpareCols===s.countCols()&&o===s.getSettings().minSpareCols&&(s.alter("remove_col",parseInt(l+1,10),s.getSettings().minSpareCols),s.undoRedo.doneActions.pop())}s.selectCells(this.selected,!1,!1)};he.ChangeAction.prototype.redo=function(s,e){const t=Ut(this.changes);for(let n=0,o=t.length;n<o;n++)t[n].splice(2,1);s.addHookOnce("afterChange",e),s.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&s.selectCells(this.selected,!1,!1)};he.CreateRowAction=function(s,e){this.index=s,this.amount=e,this.actionType="insert_row"};As(he.CreateRowAction,he.Action);he.CreateRowAction.prototype.undo=function(s,e){const t=s.countRows(),n=s.getSettings().minSpareRows;this.index>=t&&this.index-n<t&&(this.index-=n),s.addHookOnce("afterRemoveRow",e),s.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};he.CreateRowAction.prototype.redo=function(s,e){s.addHookOnce("afterCreateRow",e),s.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};he.RemoveRowAction=function(s,e,t,n,o){this.index=s,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=n,this.rowIndexesSequence=o};As(he.RemoveRowAction,he.Action);he.RemoveRowAction.prototype.undo=function(s,e){const t=s.getSettings(),n=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,i)=>{Object.keys(o).forEach(r=>{const a=parseInt(r,10);n.push([this.index+i,isNaN(a)?r:a,o[r]])})}),s.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),s.addHookOnce("afterViewRender",e),s.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),s.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};he.RemoveRowAction.prototype.redo=function(s,e){s.addHookOnce("afterRemoveRow",e),s.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};he.CreateColumnAction=function(s,e){this.index=s,this.amount=e,this.actionType="insert_col"};As(he.CreateColumnAction,he.Action);he.CreateColumnAction.prototype.undo=function(s,e){s.addHookOnce("afterRemoveCol",e),s.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};he.CreateColumnAction.prototype.redo=function(s,e){s.addHookOnce("afterCreateCol",e),s.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};he.RemoveColumnAction=function(s,e,t,n,o,i,r){this.index=s,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=n,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=r};As(he.RemoveColumnAction,he.Action);he.RemoveColumnAction.prototype.undo=function(s,e){const t=s.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),o=(h,u,d)=>d[this.indexes.indexOf(n[u])],i=this.data.length,r=[];for(let h=0;h<i;h++)r.push(ke(this.data[h],o));const a=ke(this.headers,o),l=[];s.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),I(s.getSourceDataArray(),(h,u)=>{I(n,(d,f)=>{h[d]=r[u][f],l.push([u,d,h[d]])})}),s.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&I(a,(h,u)=>{s.getSettings().colHeaders[n[u]]=h}),s.batchExecution(()=>{s.rowIndexMapper.setIndexesSequence(this.rowPositions),s.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),s.addHookOnce("afterViewRender",e),s.render()};he.RemoveColumnAction.prototype.redo=function(s,e){s.addHookOnce("afterRemoveCol",e),s.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};he.CellAlignmentAction=function(s,e,t,n){this.stateBefore=s,this.range=e,this.type=t,this.alignment=n};he.CellAlignmentAction.prototype.undo=function(s,e){I(this.range,t=>{t.forAll((n,o)=>{n>=0&&o>=0&&s.setCellMeta(n,o,"className",this.stateBefore[n][o]||" htLeft")})}),s.addHookOnce("afterViewRender",e),s.render()};he.CellAlignmentAction.prototype.redo=function(s,e){Bs(this.range,this.type,this.alignment,(t,n)=>s.getCellMeta(t,n),(t,n,o,i)=>s.setCellMeta(t,n,o,i)),s.addHookOnce("afterViewRender",e),s.render()};he.FiltersAction=function(s){this.conditionsStack=s,this.actionType="filter"};As(he.FiltersAction,he.Action);he.FiltersAction.prototype.undo=function(s,e){const t=s.getPlugin("filters");s.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),t.filter()};he.FiltersAction.prototype.redo=function(s,e){const t=s.getPlugin("filters");s.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class lz extends he.Action{constructor(e,t){super(),this.cellRange=t;const n=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(n.row,n.col,o.row,o.col)}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();e.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange)}}he.MergeCellsAction=lz;class hz extends he.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.mergeRange(this.cellRange,!0)}redo(e,t){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),n.unmergeRange(this.cellRange,!0),e.render()}}he.UnmergeCellsAction=hz;he.RowMoveAction=function(s,e){this.rows=s.slice(),this.finalIndex=e,this.actionType="row_move"};As(he.RowMoveAction,he.Action);he.RowMoveAction.prototype.undo=function(s,e){const t=s.getPlugin("manualRowMove"),n=[].concat(this.rows),o=n.filter(a=>a>this.finalIndex),i=n.filter(a=>a<=this.finalIndex),r=o.sort((a,l)=>l-a).concat(i.sort((a,l)=>a-l));s.addHookOnce("afterViewRender",e);for(let a=0;a<r.length;a+=1){const l=s.toVisualRow(r[a]);t.moveRow(l,r[a])}s.render(),s.deselectCell(),s.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};he.RowMoveAction.prototype.redo=function(s,e){const t=s.getPlugin("manualRowMove");s.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalIndex),s.render(),s.deselectCell(),s.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};he.prototype.init=function(){const s=this.instance.getSettings().undo,e=typeof s>"u"||s;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};he.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:o=>!o.altKey,group:$0};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)};he.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup($0)};function W0(s,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function uz(s){s.undo=function(){return s.undoRedo.undo()},s.redo=function(){return s.undoRedo.redo()},s.isUndoAvailable=function(){return s.undoRedo.isUndoAvailable()},s.isRedoAvailable=function(){return s.undoRedo.isRedoAvailable()},s.clearUndo=function(){return s.undoRedo.clear()}}function cz(s){delete s.undo,delete s.redo,delete s.isUndoAvailable,delete s.isRedoAvailable,delete s.clearUndo}const pa=ce.getSingleton();pa.add("afterUpdateSettings",function(){var s;(s=this.getPlugin("undoRedo"))===null||s===void 0||s.init()});pa.register("beforeUndo");pa.register("afterUndo");pa.register("beforeRedo");pa.register("afterRedo");he.PLUGIN_KEY=az;he.SETTING_KEYS=!0;function dz(){He(bi),He(FV),He(br),He(QV),He(a$),He(HR),He(N$),He(Z$),He(fa),He(YR),He(mB),He(wB),He(ga),He(xB),He(d0),He(J2),He(b0),He(E0),He(mU),He(EU),He(MU),He(O0),He(kU),He(zU),He(_0),He(JU),He(NY),He(GY),He(qY),He(tz),He(oz),He(rz),He(he)}function fz(){WF(),nV(),uV(),RV(),dz()}function gz(s){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(t){const n=this.first();let o=n.data("handsontable");if(typeof t!="string"){const h=t||{};return o?o.updateSettings(h):(o=new s.Core(n[0],h),n.data("handsontable",o),o.init()),n}let i;if(o)if(typeof o[t]<"u"){for(var r=arguments.length,a=new Array(r>1?r-1:0),l=1;l<r;l++)a[l-1]=arguments[l];i=o[t].call(o,...a),t==="destroy"&&n.removeData()}else throw new Error(`Handsontable do not provide action: ${t}`);return i})}var af,lf,hf,uf,cf;fz();gz(we);we.__GhostTable=lp;we._getListenersCounter=qD;we._getRegisteredMapsCounter=Kk;we.EventManager=ft;const mz=[eD,LD,$k,oV,rN,wD,oD,tP,DD,rD,$D,eP],pz=[fD,WD];we.helper={};we.dom={};I(mz,s=>{I(Object.getOwnPropertyNames(s),e=>{e.charAt(0)!=="_"&&(we.helper[e]=s[e])})});I(pz,s=>{I(Object.getOwnPropertyNames(s),e=>{e.charAt(0)!=="_"&&(we.dom[e]=s[e])})});we.cellTypes=(af=we.cellTypes)!==null&&af!==void 0?af:{};I(KL(),s=>{we.cellTypes[s]=Km(s)});we.cellTypes.registerCellType=Zt;we.cellTypes.getCellType=Km;we.editors=(lf=we.editors)!==null&&lf!==void 0?lf:{};I(GD(),s=>{we.editors[`${Bt(s)}Editor`]=Yl(s)});we.editors.registerEditor=rn;we.editors.getEditor=Yl;we.renderers=(hf=we.renderers)!==null&&hf!==void 0?hf:{};I(pP(),s=>{const e=Gl(s);s==="base"&&(we.renderers.cellDecorator=e),we.renderers[`${Bt(s)}Renderer`]=e});we.renderers.registerRenderer=Xn;we.renderers.getRenderer=Gl;we.validators=(uf=we.validators)!==null&&uf!==void 0?uf:{};I(yP(),s=>{we.validators[`${Bt(s)}Validator`]=gm(s)});we.validators.registerValidator=pi;we.validators.getValidator=gm;we.plugins=(cf=we.plugins)!==null&&cf!==void 0?cf:{};I(fm(),s=>{we.plugins[s]=ta(s)});we.plugins[`${Bt(je.PLUGIN_KEY)}Plugin`]=je;we.plugins.registerPlugin=He;we.plugins.getPlugin=ta;const wz=(s,e)=>{const t=e.className;t!==void 0&&we.dom.addClass(s,t)};function Cz(s,e,t,n,o,i,r){const a=document.createElement("div");a.style.width=`${i*10}px`,wz(e,r),we.dom.addClass(a,"progressBar"),we.dom.empty(e),e.appendChild(a)}function yz(s,e,t,n,o,i,r){we.renderers.TextRenderer.apply(this,[s,e,t,n,o,"â".repeat(i),r])}/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Feb 9, 2022
 *
 * Description: Definition file for Arabic - Without a specific country.
 */const Sz={languageCode:"ar-AR",languageDirection:"rtl",[kh]:"ÙØ§ ØªÙØ¬Ø¯ Ø®ÙØ§Ø±Ø§Øª ÙØªÙÙØ±Ø©",[Lh]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø¹ÙÙ",[Fh]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø³ÙÙ",[Vh]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙØ³Ø§Ø±",[$h]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙÙÙÙ",[Wh]:["Ø§Ø­Ø¯Ù Ø§ÙØµÙ","Ø§Ø­Ø°Ù Ø§ÙØµÙÙÙ"],[Bh]:["Ø§Ø­Ø¯Ù Ø§ÙØ¹ÙÙØ¯","Ø§Ø­Ø¯Ù Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Uh]:"ØªØ±Ø§Ø¬Ø¹",[Yh]:"Ø¥ÙØºØ§Ø¡ Ø§ÙØªØ±Ø§Ø¬Ø¹",[zh]:"ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[Gh]:"Ø§ÙØ±Øº Ø§ÙØ¹ÙÙØ¯",[su]:"Ø§ÙÙØ­Ø§Ø°Ø§Ø©",[ou]:"ÙØ³Ø§Ø±",[iu]:"ÙØ³Ø·",[ru]:"ÙÙÙÙ",[au]:"Ø¨Ø§ÙØªØ³Ø§ÙÙ",[lu]:"Ø£Ø¹ÙÙ",[hu]:"ÙØªÙØ³Ø·",[uu]:"Ø£Ø³ÙÙ",[Xh]:"ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[qh]:"Ø¥ÙØºØ§Ø¡ ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[cu]:"Ø§ÙØ­Ø¯ÙØ¯",[du]:"Ø£Ø¹ÙÙ",[fu]:"ÙÙÙÙ",[gu]:"Ø£Ø³ÙÙ",[mu]:"ÙØ³Ø§Ø±",[pu]:"Ø£Ø­Ø°Ù Ø§ÙØ­Ø¯(ÙØ¯)",[Jh]:"Ø£Ø¶Ù ØªØ¹ÙÙÙØ§Ù",[eu]:"ØªØ¹Ø¯ÙÙ Ø§ÙØªØ¹ÙÙÙ",[tu]:"Ø§Ø­Ø°Ù Ø§ÙØªØ¹ÙÙÙ",[nu]:"ØªØ¹ÙÙÙ ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[Zh]:"Ø§Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[Qh]:"Ø¥ÙØºØ§Ø¡ Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[jh]:"ÙØ³Ø®",[Kh]:"ÙØµ",[wu]:"Ø£Ø¯Ø®Ù ØµÙØ§Ù ÙØ±Ø¹ÙØ§Ù",[Cu]:"Ø§ÙØµÙ Ø¹Ù Ø§ÙØµÙ Ø§ÙØ£ØµÙÙ",[yu]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ¹ÙÙØ¯","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Su]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ¹ÙÙØ¯","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ£Ø¹ÙØ¯Ø©"],[vu]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·Ø±","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·ÙØ±"],[bu]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·Ø±","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·ÙØ±"],[ia]:"Ø¨ÙØ§",[Ru]:"ÙØ§Ø±Øº",[Eu]:"ØºÙØ± ÙØ§Ø±Øº",[Tu]:"ÙØ³Ø§ÙÙ",[Mu]:"ÙØ§ ÙØ³Ø§ÙÙ",[Ou]:"ÙØ¨Ø¯Ø§Ù Ø¨Ù",[Iu]:"ÙÙØªÙÙ Ø¨Ù",[_u]:"ÙØ­ØªÙÙ",[Au]:"ÙØ§ ÙØ­ØªÙÙ",[xu]:"Ø£ÙØ¨Ø± ÙÙ",[Hu]:"Ø£ÙØ¨Ø± Ø£Ù ÙØ³Ø§ÙÙ",[Du]:"Ø£ØµØºØ±",[Pu]:"Ø£ØµØºØ± Ø£Ù ÙØ³Ø§ÙÙ",[Nu]:"Ø¨ÙÙ",[ku]:"Ø®Ø§Ø±Ø¬ Ø§ÙÙØ¬Ø§Ù",[Lu]:"Ø¨Ø¹Ø¯",[Fu]:"ÙØ¨Ù",[Vu]:"Ø§ÙÙÙÙ",[$u]:"ØºØ¯Ø§Ù",[Wu]:"Ø§ÙØ¨Ø§Ø±Ø­Ø©",[Lr]:"Ø®ÙØ§ÙØ§ ÙØ§Ø±ØºØ©",[Bu]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙØ´Ø±Ø·",[Uu]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙÙÙÙØ©",[Yu]:"Ù",[ra]:"Ø£Ù",[zu]:"Ø§Ø®ØªÙØ§Ø± Ø§ÙÙÙ",[Gu]:"Ø¥ÙØºØ§Ø¡",[ju]:"ÙÙØ§ÙÙ",[Ku]:"Ø¥ÙØºØ§Ø¡",[Xu]:"Ø§ÙØ¨Ø­Ø«",[qu]:"Ø§ÙÙÙÙØ©",[Zu]:"Ø§ÙÙÙÙØ© Ø§ÙØ«Ø§ÙÙØ©"},B0=Sz,Wy=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function vz(s,e,t,n,o,i){if(t!==0)return;const r=s.parentElement;r!==null&&(i.instance.getDataAtRowProp(e,"0")?we.dom.addClass(r,MC):we.dom.removeClass(r,MC),e%2===0?we.dom.addClass(r,OC):we.dom.removeClass(r,OC))}function bz(s,e){const t=document.createElement("input");t.type="checkbox",s>=0&&this.getDataAtRowProp(s,"0")&&(t.checked=!0),we.dom.empty(e),e.appendChild(t)}function Rz(s,e){if(s<0)return;const t=this.isRtl()?"htRight":"htLeft";e.firstChild&&(Wy.has(s.toString())?(we.dom.removeClass(e.firstChild,t),we.dom.addClass(e.firstChild,Wy.get(s.toString()))):we.dom.addClass(e.firstChild,t))}function Ez(s,e){const t=s.target;e.col===-1&&t&&t.nodeName==="INPUT"&&(s.preventDefault(),this.setDataAtRowProp(e.row,"0",!t.checked))}He(bi);He(fa);He(YR);He(ga);He(d0);He(b0);He(E0);He(O0);He(_0);He(he);Zt(yR);Zt(SR);Zt(CR);Zt(vR);Um(B0);const Tz=document.getElementById("example");new we(Tz,{data:MF(),layoutDirection:Tl()?"rtl":"ltr",language:Tl()?B0.languageCode:"en-US",height:450,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1,dateFormat:Tl()?"M/D/YYYY":"DD/MM/YYYY"},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:Cz,readOnly:!0,className:"htMiddle"},{data:9,renderer:yz,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,afterGetColHeader:Rz,afterGetRowHeader:bz,afterOnCellMouseDown:Ez,beforeRenderer:vz,licenseKey:"non-commercial-and-evaluation"});console.log(`Handsontable: v${we.version} (${we.buildDate})`)});export default Mz();
