var aN=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var Tae=aN((Vae,Yd)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _A(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function lN(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){if(this instanceof r){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(e,i);return new o}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Xc=function(t){return t&&t.Math===Math&&t},On=Xc(typeof globalThis=="object"&&globalThis)||Xc(typeof window=="object"&&window)||Xc(typeof self=="object"&&self)||Xc(typeof pd=="object"&&pd)||function(){return this}()||pd||Function("return this")(),nS={},Ar=function(t){try{return!!t()}catch{return!0}},uN=Ar,Oi=!uN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),cN=Ar,Wf=!cN(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),hN=Wf,qc=Function.prototype.call,Vf=hN?qc.bind(qc):function(){return qc.apply(qc,arguments)},MA={},AA={}.propertyIsEnumerable,OA=Object.getOwnPropertyDescriptor,dN=OA&&!AA.call({1:2},1);MA.f=dN?function(e){var n=OA(this,e);return!!n&&n.enumerable}:AA;var rS=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},IA=Wf,PA=Function.prototype,FC=PA.call,fN=IA&&PA.bind.bind(FC,FC),Gn=IA?fN:function(t){return function(){return FC.apply(t,arguments)}},xA=Gn,gN=xA({}.toString),mN=xA("".slice),Tl=function(t){return mN(gN(t),8,-1)},pN=Gn,wN=Ar,CN=Tl,np=Object,vN=pN("".split),SN=wN(function(){return!np("z").propertyIsEnumerable(0)})?function(t){return CN(t)==="String"?vN(t,""):np(t)}:np,HA=function(t){return t==null},yN=HA,bN=TypeError,DA=function(t){if(yN(t))throw new bN("Can't call method on "+t);return t},RN=SN,EN=DA,Bf=function(t){return RN(EN(t))},WC=typeof document=="object"&&document.all,TN=typeof WC>"u"&&WC!==void 0,NA={all:WC,IS_HTMLDDA:TN},LA=NA,_N=LA.all,wn=LA.IS_HTMLDDA?function(t){return typeof t=="function"||t===_N}:function(t){return typeof t=="function"},Nb=wn,$A=NA,MN=$A.all,ia=$A.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:Nb(t)||t===MN}:function(t){return typeof t=="object"?t!==null:Nb(t)},rp=On,AN=wn,ON=function(t){return AN(t)?t:void 0},vc=function(t,e){return arguments.length<2?ON(rp[t]):rp[t]&&rp[t][e]},IN=Gn,kA=IN({}.isPrototypeOf),iS=typeof navigator<"u"&&String(navigator.userAgent)||"",FA=On,ip=iS,Lb=FA.process,$b=FA.Deno,kb=Lb&&Lb.versions||$b&&$b.version,Fb=kb&&kb.v8,jr,Gd;Fb&&(jr=Fb.split("."),Gd=jr[0]>0&&jr[0]<4?1:+(jr[0]+jr[1]));!Gd&&ip&&(jr=ip.match(/Edge\/(\d+)/),(!jr||jr[1]>=74)&&(jr=ip.match(/Chrome\/(\d+)/),jr&&(Gd=+jr[1])));var PN=Gd,Wb=PN,xN=Ar,HN=On,DN=HN.String,oS=!!Object.getOwnPropertySymbols&&!xN(function(){var t=Symbol("symbol detection");return!DN(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Wb&&Wb<41}),NN=oS,WA=NN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",LN=vc,$N=wn,kN=kA,FN=WA,WN=Object,sS=FN?function(t){return typeof t=="symbol"}:function(t){var e=LN("Symbol");return $N(e)&&kN(e.prototype,WN(t))},VN=String,VA=function(t){try{return VN(t)}catch{return"Object"}},BN=wn,UN=VA,YN=TypeError,aS=function(t){if(BN(t))return t;throw new YN(UN(t)+" is not a function")},GN=aS,zN=HA,jN=function(t,e){var n=t[e];return zN(n)?void 0:GN(n)},op=Vf,sp=wn,ap=ia,KN=TypeError,XN=function(t,e){var n,r;if(e==="string"&&sp(n=t.toString)&&!ap(r=op(n,t))||sp(n=t.valueOf)&&!ap(r=op(n,t))||e!=="string"&&sp(n=t.toString)&&!ap(r=op(n,t)))return r;throw new KN("Can't convert object to primitive value")},BA={exports:{}},Vb=On,qN=Object.defineProperty,lS=function(t,e){try{qN(Vb,t,{value:e,configurable:!0,writable:!0})}catch{Vb[t]=e}return e},ZN=On,QN=lS,Bb="__core-js_shared__",JN=ZN[Bb]||QN(Bb,{}),uS=JN,Ub=uS;(BA.exports=function(t,e){return Ub[t]||(Ub[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.33.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.2/LICENSE",source:"https://github.com/zloirock/core-js"});var UA=BA.exports,eL=DA,tL=Object,Uf=function(t){return tL(eL(t))},nL=Gn,rL=Uf,iL=nL({}.hasOwnProperty),Co=Object.hasOwn||function(e,n){return iL(rL(e),n)},oL=Gn,sL=0,aL=Math.random(),lL=oL(1 .toString),YA=function(t){return"Symbol("+(t===void 0?"":t)+")_"+lL(++sL+aL,36)},uL=On,cL=UA,Yb=Co,hL=YA,dL=oS,fL=WA,sl=uL.Symbol,lp=cL("wks"),gL=fL?sl.for||sl:sl&&sl.withoutSetter||hL,Yf=function(t){return Yb(lp,t)||(lp[t]=dL&&Yb(sl,t)?sl[t]:gL("Symbol."+t)),lp[t]},mL=Vf,Gb=ia,zb=sS,pL=jN,wL=XN,CL=Yf,vL=TypeError,SL=CL("toPrimitive"),yL=function(t,e){if(!Gb(t)||zb(t))return t;var n=pL(t,SL),r;if(n){if(e===void 0&&(e="default"),r=mL(n,t,e),!Gb(r)||zb(r))return r;throw new vL("Can't convert object to primitive value")}return e===void 0&&(e="number"),wL(t,e)},bL=yL,RL=sS,GA=function(t){var e=bL(t,"string");return RL(e)?e:e+""},EL=On,jb=ia,VC=EL.document,TL=jb(VC)&&jb(VC.createElement),cS=function(t){return TL?VC.createElement(t):{}},_L=Oi,ML=Ar,AL=cS,zA=!_L&&!ML(function(){return Object.defineProperty(AL("div"),"a",{get:function(){return 7}}).a!==7}),OL=Oi,IL=Vf,PL=MA,xL=rS,HL=Bf,DL=GA,NL=Co,LL=zA,Kb=Object.getOwnPropertyDescriptor;nS.f=OL?Kb:function(e,n){if(e=HL(e),n=DL(n),LL)try{return Kb(e,n)}catch{}if(NL(e,n))return xL(!IL(PL.f,e,n),e[n])};var oa={},$L=Oi,kL=Ar,jA=$L&&kL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),FL=ia,WL=String,VL=TypeError,Sc=function(t){if(FL(t))return t;throw new VL(WL(t)+" is not an object")},BL=Oi,UL=zA,YL=jA,Zc=Sc,Xb=GA,GL=TypeError,up=Object.defineProperty,zL=Object.getOwnPropertyDescriptor,cp="enumerable",hp="configurable",dp="writable";oa.f=BL?YL?function(e,n,r){if(Zc(e),n=Xb(n),Zc(r),typeof e=="function"&&n==="prototype"&&"value"in r&&dp in r&&!r[dp]){var i=zL(e,n);i&&i[dp]&&(e[n]=r.value,r={configurable:hp in r?r[hp]:i[hp],enumerable:cp in r?r[cp]:i[cp],writable:!1})}return up(e,n,r)}:up:function(e,n,r){if(Zc(e),n=Xb(n),Zc(r),UL)try{return up(e,n,r)}catch{}if("get"in r||"set"in r)throw new GL("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var jL=Oi,KL=oa,XL=rS,yc=jL?function(t,e,n){return KL.f(t,e,XL(1,n))}:function(t,e,n){return t[e]=n,t},KA={exports:{}},BC=Oi,qL=Co,XA=Function.prototype,ZL=BC&&Object.getOwnPropertyDescriptor,hS=qL(XA,"name"),QL=hS&&(function(){}).name==="something",JL=hS&&(!BC||BC&&ZL(XA,"name").configurable),e$={EXISTS:hS,PROPER:QL,CONFIGURABLE:JL},t$=Gn,n$=wn,UC=uS,r$=t$(Function.toString);n$(UC.inspectSource)||(UC.inspectSource=function(t){return r$(t)});var i$=UC.inspectSource,o$=On,s$=wn,qb=o$.WeakMap,a$=s$(qb)&&/native code/.test(String(qb)),l$=UA,u$=YA,Zb=l$("keys"),qA=function(t){return Zb[t]||(Zb[t]=u$(t))},dS={},c$=a$,ZA=On,h$=ia,d$=yc,fp=Co,gp=uS,f$=qA,g$=dS,Qb="Object already initialized",YC=ZA.TypeError,m$=ZA.WeakMap,zd,Ju,jd,p$=function(t){return jd(t)?Ju(t):zd(t,{})},w$=function(t){return function(e){var n;if(!h$(e)||(n=Ju(e)).type!==t)throw new YC("Incompatible receiver, "+t+" required");return n}};if(c$||gp.state){var ri=gp.state||(gp.state=new m$);ri.get=ri.get,ri.has=ri.has,ri.set=ri.set,zd=function(t,e){if(ri.has(t))throw new YC(Qb);return e.facade=t,ri.set(t,e),e},Ju=function(t){return ri.get(t)||{}},jd=function(t){return ri.has(t)}}else{var ga=f$("state");g$[ga]=!0,zd=function(t,e){if(fp(t,ga))throw new YC(Qb);return e.facade=t,d$(t,ga,e),e},Ju=function(t){return fp(t,ga)?t[ga]:{}},jd=function(t){return fp(t,ga)}}var C$={set:zd,get:Ju,has:jd,enforce:p$,getterFor:w$},fS=Gn,v$=Ar,S$=wn,Qc=Co,GC=Oi,y$=e$.CONFIGURABLE,b$=i$,QA=C$,R$=QA.enforce,E$=QA.get,Jb=String,wd=Object.defineProperty,T$=fS("".slice),_$=fS("".replace),M$=fS([].join),A$=GC&&!v$(function(){return wd(function(){},"length",{value:8}).length!==8}),O$=String(String).split("String"),I$=KA.exports=function(t,e,n){T$(Jb(e),0,7)==="Symbol("&&(e="["+_$(Jb(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Qc(t,"name")||y$&&t.name!==e)&&(GC?wd(t,"name",{value:e,configurable:!0}):t.name=e),A$&&n&&Qc(n,"arity")&&t.length!==n.arity&&wd(t,"length",{value:n.arity});try{n&&Qc(n,"constructor")&&n.constructor?GC&&wd(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=R$(t);return Qc(r,"source")||(r.source=M$(O$,typeof e=="string"?e:"")),t};Function.prototype.toString=I$(function(){return S$(this)&&E$(this).source||b$(this)},"toString");var P$=KA.exports,x$=wn,H$=oa,D$=P$,N$=lS,L$=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(x$(n)&&D$(n,o,r),r.global)i?t[e]=n:N$(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:H$.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},JA={},$$=Math.ceil,k$=Math.floor,F$=Math.trunc||function(e){var n=+e;return(n>0?k$:$$)(n)},W$=F$,gS=function(t){var e=+t;return e!==e||e===0?0:W$(e)},V$=gS,B$=Math.max,U$=Math.min,Y$=function(t,e){var n=V$(t);return n<0?B$(n+e,0):U$(n,e)},G$=gS,z$=Math.min,j$=function(t){return t>0?z$(G$(t),9007199254740991):0},K$=j$,Gf=function(t){return K$(t.length)},X$=Bf,q$=Y$,Z$=Gf,eR=function(t){return function(e,n,r){var i=X$(e),o=Z$(i),s=q$(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Q$={includes:eR(!0),indexOf:eR(!1)},J$=Gn,mp=Co,ek=Bf,tk=Q$.indexOf,nk=dS,tR=J$([].push),eO=function(t,e){var n=ek(t),r=0,i=[],o;for(o in n)!mp(nk,o)&&mp(n,o)&&tR(i,o);for(;e.length>r;)mp(n,o=e[r++])&&(~tk(i,o)||tR(i,o));return i},mS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],rk=eO,ik=mS,ok=ik.concat("length","prototype");JA.f=Object.getOwnPropertyNames||function(e){return rk(e,ok)};var tO={};tO.f=Object.getOwnPropertySymbols;var sk=vc,ak=Gn,lk=JA,uk=tO,ck=Sc,hk=ak([].concat),dk=sk("Reflect","ownKeys")||function(e){var n=lk.f(ck(e)),r=uk.f;return r?hk(n,r(e)):n},nR=Co,fk=dk,gk=nS,mk=oa,nO=function(t,e,n){for(var r=fk(e),i=mk.f,o=gk.f,s=0;s<r.length;s++){var a=r[s];!nR(t,a)&&!(n&&nR(n,a))&&i(t,a,o(e,a))}},pk=Ar,wk=wn,Ck=/#|\.prototype\./,bc=function(t,e){var n=Sk[vk(t)];return n===bk?!0:n===yk?!1:wk(e)?pk(e):!!e},vk=bc.normalize=function(t){return String(t).replace(Ck,".").toLowerCase()},Sk=bc.data={},yk=bc.NATIVE="N",bk=bc.POLYFILL="P",Rk=bc,pp=On,Ek=nS.f,Tk=yc,_k=L$,Mk=lS,Ak=nO,Ok=Rk,sa=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=pp:i?s=pp[n]||Mk(n,{}):s=(pp[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=Ek(s,a),l=c&&c.value):l=s[a],o=Ok(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;Ak(u,l)}(t.sham||l&&l.sham)&&Tk(u,"sham",!0),_k(s,a,u,t)}},Ik=Tl,rO=Array.isArray||function(e){return Ik(e)==="Array"},Pk=Oi,xk=rO,Hk=TypeError,Dk=Object.getOwnPropertyDescriptor,Nk=Pk&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),iO=Nk?function(t,e){if(xk(t)&&!Dk(t,"length").writable)throw new Hk("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Lk=TypeError,$k=9007199254740991,oO=function(t){if(t>$k)throw Lk("Maximum allowed index exceeded");return t},kk=sa,Fk=Uf,Wk=Gf,Vk=iO,Bk=oO,Uk=Ar,Yk=Uk(function(){return[].push.call({length:4294967296},1)!==4294967297}),Gk=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},zk=Yk||!Gk();kk({target:"Array",proto:!0,arity:1,forced:zk},{push:function(e){var n=Fk(this),r=Wk(n),i=arguments.length;Bk(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return Vk(n,r),r}});var jk=Wf,sO=Function.prototype,rR=sO.apply,iR=sO.call,zf=typeof Reflect=="object"&&Reflect.apply||(jk?iR.bind(rR):function(){return iR.apply(rR,arguments)}),Kk=Gn,Xk=aS,qk=function(t,e,n){try{return Kk(Xk(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},Zk=wn,Qk=String,Jk=TypeError,eF=function(t){if(typeof t=="object"||Zk(t))return t;throw new Jk("Can't set "+Qk(t)+" as a prototype")},tF=qk,nF=Sc,rF=eF,aO=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=tF(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return nF(i),rF(o),t?n(i,o):i.__proto__=o,i}}():void 0),iF=oa.f,oF=function(t,e,n){n in t||iF(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},sF=wn,aF=ia,oR=aO,lF=function(t,e,n){var r,i;return oR&&sF(r=e.constructor)&&r!==n&&aF(i=r.prototype)&&i!==n.prototype&&oR(t,i),t},uF=Yf,cF=uF("toStringTag"),lO={};lO[cF]="z";var hF=String(lO)==="[object z]",dF=hF,fF=wn,Cd=Tl,gF=Yf,mF=gF("toStringTag"),pF=Object,wF=Cd(function(){return arguments}())==="Arguments",CF=function(t,e){try{return t[e]}catch{}},vF=dF?Cd:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=CF(e=pF(t),mF))=="string"?n:wF?Cd(e):(r=Cd(e))==="Object"&&fF(e.callee)?"Arguments":r},SF=vF,yF=String,uO=function(t){if(SF(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return yF(t)},bF=uO,RF=function(t,e){return t===void 0?arguments.length<2?"":e:bF(t)},EF=ia,TF=yc,_F=function(t,e){EF(e)&&"cause"in e&&TF(t,"cause",e.cause)},MF=Gn,cO=Error,AF=MF("".replace),OF=function(t){return String(new cO(t).stack)}("zxcasd"),hO=/\n\s*at [^:]*:[^\n]*/,IF=hO.test(OF),PF=function(t,e){if(IF&&typeof t=="string"&&!cO.prepareStackTrace)for(;e--;)t=AF(t,hO,"");return t},xF=Ar,HF=rS,DF=!xF(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",HF(1,7)),t.stack!==7):!0}),NF=yc,LF=PF,$F=DF,sR=Error.captureStackTrace,kF=function(t,e,n,r){$F&&(sR?sR(t,e):NF(t,"stack",LF(n,r)))},aR=vc,FF=Co,lR=yc,WF=kA,uR=aO,cR=nO,hR=oF,VF=lF,BF=RF,UF=_F,YF=kF,GF=Oi,zF=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=aR.apply(null,s);if(l){var u=l.prototype;if(FF(u,"cause")&&delete u.cause,!n)return l;var c=aR("Error"),d=e(function(f,p){var w=BF(r?p:f,void 0),v=r?new l(f):new l;return w!==void 0&&lR(v,"message",w),YF(v,d,v.stack,2),this&&WF(u,this)&&VF(v,this,d),arguments.length>o&&UF(v,arguments[o]),v});d.prototype=u,a!=="Error"?uR?uR(d,c):cR(d,c,{name:!0}):GF&&i in l&&(hR(d,l,i),hR(d,l,"prepareStackTrace")),cR(d,l);try{u.name!==a&&lR(u,"name",a),u.constructor=d}catch{}return d}},dO=sa,jF=On,Ii=zf,fO=zF,zC="WebAssembly",dR=jF[zC],Kd=new Error("e",{cause:7}).cause!==7,aa=function(t,e){var n={};n[t]=fO(t,e,Kd),dO({global:!0,constructor:!0,arity:1,forced:Kd},n)},pS=function(t,e){if(dR&&dR[t]){var n={};n[t]=fO(zC+"."+t,e,Kd),dO({target:zC,stat:!0,constructor:!0,arity:1,forced:Kd},n)}};aa("Error",function(t){return function(n){return Ii(t,this,arguments)}});aa("EvalError",function(t){return function(n){return Ii(t,this,arguments)}});aa("RangeError",function(t){return function(n){return Ii(t,this,arguments)}});aa("ReferenceError",function(t){return function(n){return Ii(t,this,arguments)}});aa("SyntaxError",function(t){return function(n){return Ii(t,this,arguments)}});aa("TypeError",function(t){return function(n){return Ii(t,this,arguments)}});aa("URIError",function(t){return function(n){return Ii(t,this,arguments)}});pS("CompileError",function(t){return function(n){return Ii(t,this,arguments)}});pS("LinkError",function(t){return function(n){return Ii(t,this,arguments)}});pS("RuntimeError",function(t){return function(n){return Ii(t,this,arguments)}});var KF=Tl,XF=Gn,qF=function(t){if(KF(t)==="Function")return XF(t)},fR=qF,ZF=aS,QF=Wf,JF=fR(fR.bind),eW=function(t,e){return ZF(t),e===void 0?t:QF?JF(t,e):function(){return t.apply(e,arguments)}},tW=vc,gO=tW("document","documentElement"),nW=Gn,wS=nW([].slice),rW=TypeError,mO=function(t,e){if(t<e)throw new rW("Not enough arguments");return t},iW=iS,oW=/(?:ipad|iphone|ipod).*applewebkit/i.test(iW),sW=On,aW=Tl,lW=aW(sW.process)==="process",fr=On,uW=zf,cW=eW,gR=wn,hW=Co,pO=Ar,mR=gO,dW=wS,pR=cS,fW=mO,gW=oW,mW=lW,jC=fr.setImmediate,KC=fr.clearImmediate,pW=fr.process,wp=fr.Dispatch,wW=fr.Function,wR=fr.MessageChannel,CW=fr.String,Cp=0,Pu={},CR="onreadystatechange",ec,ds,vp,Sp;pO(function(){ec=fr.location});var CS=function(t){if(hW(Pu,t)){var e=Pu[t];delete Pu[t],e()}},yp=function(t){return function(){CS(t)}},vR=function(t){CS(t.data)},SR=function(t){fr.postMessage(CW(t),ec.protocol+"//"+ec.host)};(!jC||!KC)&&(jC=function(e){fW(arguments.length,1);var n=gR(e)?e:wW(e),r=dW(arguments,1);return Pu[++Cp]=function(){uW(n,void 0,r)},ds(Cp),Cp},KC=function(e){delete Pu[e]},mW?ds=function(t){pW.nextTick(yp(t))}:wp&&wp.now?ds=function(t){wp.now(yp(t))}:wR&&!gW?(vp=new wR,Sp=vp.port2,vp.port1.onmessage=vR,ds=cW(Sp.postMessage,Sp)):fr.addEventListener&&gR(fr.postMessage)&&!fr.importScripts&&ec&&ec.protocol!=="file:"&&!pO(SR)?(ds=SR,fr.addEventListener("message",vR,!1)):CR in pR("script")?ds=function(t){mR.appendChild(pR("script"))[CR]=function(){mR.removeChild(this),CS(t)}}:ds=function(t){setTimeout(yp(t),0)});var wO={set:jC,clear:KC},vW=sa,SW=On,yR=wO.clear;vW({global:!0,bind:!0,enumerable:!0,forced:SW.clearImmediate!==yR},{clearImmediate:yR});var yW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",CO=On,bW=zf,RW=wn,EW=yW,TW=iS,_W=wS,MW=mO,AW=CO.Function,OW=/MSIE .\./.test(TW)||EW&&function(){var t=CO.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),IW=function(t,e){var n=e?2:1;return OW?function(r,i){var o=MW(arguments.length,1)>n,s=RW(r)?r:AW(r),a=o?_W(arguments,n):[],l=o?function(){bW(s,this,a)}:s;return e?t(l,i):t(l)}:t},PW=sa,vO=On,bR=wO.set,xW=IW,RR=vO.setImmediate?xW(bR,!1):bR;PW({global:!0,bind:!0,enumerable:!0,forced:vO.setImmediate!==RR},{setImmediate:RR});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Vo(t){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vo(t)}function XC(t,e){return XC=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},XC(t,e)}function HW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vd(t,e,n){return HW()?vd=Reflect.construct:vd=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&XC(u,s.prototype),u},vd.apply(null,arguments)}function Br(t){return DW(t)||NW(t)||LW(t)||$W()}function DW(t){if(Array.isArray(t))return qC(t)}function NW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LW(t,e){if(t){if(typeof t=="string")return qC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qC(t,e)}}function qC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $W(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var kW=Object.hasOwnProperty,ER=Object.setPrototypeOf,FW=Object.isFrozen,WW=Object.getPrototypeOf,VW=Object.getOwnPropertyDescriptor,Yn=Object.freeze,Zr=Object.seal,BW=Object.create,SO=typeof Reflect<"u"&&Reflect,Xd=SO.apply,ZC=SO.construct;Xd||(Xd=function(e,n,r){return e.apply(n,r)});Yn||(Yn=function(e){return e});Zr||(Zr=function(e){return e});ZC||(ZC=function(e,n){return vd(e,Br(n))});var UW=Mr(Array.prototype.forEach),TR=Mr(Array.prototype.pop),kl=Mr(Array.prototype.push),Sd=Mr(String.prototype.toLowerCase),bp=Mr(String.prototype.toString),YW=Mr(String.prototype.match),xr=Mr(String.prototype.replace),GW=Mr(String.prototype.indexOf),zW=Mr(String.prototype.trim),Hn=Mr(RegExp.prototype.test),Rp=jW(TypeError);function Mr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Xd(t,e,r)}}function jW(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return ZC(t,n)}}function Xe(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Sd,ER&&ER(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(FW(e)||(e[i]=s),o=s)}t[o]=!0}return t}function fs(t){var e=BW(null),n;for(n in t)Xd(kW,t,[n])===!0&&(e[n]=t[n]);return e}function Jc(t,e){for(;t!==null;){var n=VW(t,e);if(n){if(n.get)return Mr(n.get);if(typeof n.value=="function")return Mr(n.value)}t=WW(t)}function r(i){return console.warn("fallback value for",i),null}return r}var _R=Yn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ep=Yn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Tp=Yn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),KW=Yn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),_p=Yn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),XW=Yn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),MR=Yn(["#text"]),AR=Yn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Mp=Yn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),OR=Yn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),eh=Yn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qW=Zr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ZW=Zr(/<%[\w\W]*|[\w\W]*%>/gm),QW=Zr(/\${[\w\W]*}/gm),JW=Zr(/^data-[\-\w.\u00B7-\uFFFF]/),eV=Zr(/^aria-[\-\w]+$/),tV=Zr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),nV=Zr(/^(?:\w+script|data):/i),rV=Zr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),iV=Zr(/^html$/i),oV=function(){return typeof window>"u"?null:window},sV=function(e,n){if(Vo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function yO(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oV(),e=function(N){return yO(N)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,d=t.HTMLFormElement,f=t.DOMParser,p=t.trustedTypes,w=a.prototype,v=Jc(w,"cloneNode"),y=Jc(w,"nextSibling"),b=Jc(w,"childNodes"),_=Jc(w,"parentNode");if(typeof o=="function"){var I=r.createElement("template");I.content&&I.content.ownerDocument&&(r=I.content.ownerDocument)}var L=sV(p,n),x=L?L.createHTML(""):"",W=r,G=W.implementation,ne=W.createNodeIterator,j=W.createDocumentFragment,X=W.getElementsByTagName,ie=n.importNode,oe={};try{oe=fs(r).documentMode?r.documentMode:{}}catch{}var se={};e.isSupported=typeof _=="function"&&G&&G.createHTMLDocument!==void 0&&oe!==9;var ve=qW,Pe=ZW,nt=QW,Ne=JW,R=eV,h=nV,g=rV,m=tV,E=null,M=Xe({},[].concat(Br(_R),Br(Ep),Br(Tp),Br(_p),Br(MR))),O=null,Y=Xe({},[].concat(Br(AR),Br(Mp),Br(OR),Br(eh))),B=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),q=null,Q=null,K=!0,de=!0,Ae=!1,Ee=!0,Oe=!1,z=!1,Ke=!1,ke=!1,ye=!1,He=!1,Re=!1,C=!0,S=!1,A="user-content-",F=!0,P=!1,k={},H=null,D=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,$=Xe({},["audio","video","img","source","image","track"]),U=null,re=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fe="http://www.w3.org/1998/Math/MathML",be="http://www.w3.org/2000/svg",xe="http://www.w3.org/1999/xhtml",Be=xe,St=!1,Qe=null,ct=Xe({},[fe,be,xe],bp),_t,fa=["application/xhtml+xml","text/html"],Ll="text/html",Vt,dn=null,hs=r.createElement("form"),xn=function(N){return N instanceof RegExp||N instanceof Function},tn=function(N){dn&&dn===N||((!N||Vo(N)!=="object")&&(N={}),N=fs(N),_t=fa.indexOf(N.PARSER_MEDIA_TYPE)===-1?_t=Ll:_t=N.PARSER_MEDIA_TYPE,Vt=_t==="application/xhtml+xml"?bp:Sd,E="ALLOWED_TAGS"in N?Xe({},N.ALLOWED_TAGS,Vt):M,O="ALLOWED_ATTR"in N?Xe({},N.ALLOWED_ATTR,Vt):Y,Qe="ALLOWED_NAMESPACES"in N?Xe({},N.ALLOWED_NAMESPACES,bp):ct,U="ADD_URI_SAFE_ATTR"in N?Xe(fs(re),N.ADD_URI_SAFE_ATTR,Vt):re,V="ADD_DATA_URI_TAGS"in N?Xe(fs($),N.ADD_DATA_URI_TAGS,Vt):$,H="FORBID_CONTENTS"in N?Xe({},N.FORBID_CONTENTS,Vt):D,q="FORBID_TAGS"in N?Xe({},N.FORBID_TAGS,Vt):{},Q="FORBID_ATTR"in N?Xe({},N.FORBID_ATTR,Vt):{},k="USE_PROFILES"in N?N.USE_PROFILES:!1,K=N.ALLOW_ARIA_ATTR!==!1,de=N.ALLOW_DATA_ATTR!==!1,Ae=N.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Oe=N.SAFE_FOR_TEMPLATES||!1,z=N.WHOLE_DOCUMENT||!1,ye=N.RETURN_DOM||!1,He=N.RETURN_DOM_FRAGMENT||!1,Re=N.RETURN_TRUSTED_TYPE||!1,ke=N.FORCE_BODY||!1,C=N.SANITIZE_DOM!==!1,S=N.SANITIZE_NAMED_PROPS||!1,F=N.KEEP_CONTENT!==!1,P=N.IN_PLACE||!1,m=N.ALLOWED_URI_REGEXP||m,Be=N.NAMESPACE||xe,B=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&xn(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(B.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&xn(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(B.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(B.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(de=!1),He&&(ye=!0),k&&(E=Xe({},Br(MR)),O=[],k.html===!0&&(Xe(E,_R),Xe(O,AR)),k.svg===!0&&(Xe(E,Ep),Xe(O,Mp),Xe(O,eh)),k.svgFilters===!0&&(Xe(E,Tp),Xe(O,Mp),Xe(O,eh)),k.mathMl===!0&&(Xe(E,_p),Xe(O,OR),Xe(O,eh))),N.ADD_TAGS&&(E===M&&(E=fs(E)),Xe(E,N.ADD_TAGS,Vt)),N.ADD_ATTR&&(O===Y&&(O=fs(O)),Xe(O,N.ADD_ATTR,Vt)),N.ADD_URI_SAFE_ATTR&&Xe(U,N.ADD_URI_SAFE_ATTR,Vt),N.FORBID_CONTENTS&&(H===D&&(H=fs(H)),Xe(H,N.FORBID_CONTENTS,Vt)),F&&(E["#text"]=!0),z&&Xe(E,["html","head","body"]),E.table&&(Xe(E,["tbody"]),delete q.tbody),Yn&&Yn(N),dn=N)},yt=Xe({},["mi","mo","mn","ms","mtext"]),Mb=Xe({},["foreignobject","desc","title","annotation-xml"]),rN=Xe({},["title","style","font","a","script"]),jc=Xe({},Ep);Xe(jc,Tp),Xe(jc,KW);var Jm=Xe({},_p);Xe(Jm,XW);var iN=function(N){var te=_(N);(!te||!te.tagName)&&(te={namespaceURI:Be,tagName:"template"});var ue=Sd(N.tagName),ut=Sd(te.tagName);return Qe[N.namespaceURI]?N.namespaceURI===be?te.namespaceURI===xe?ue==="svg":te.namespaceURI===fe?ue==="svg"&&(ut==="annotation-xml"||yt[ut]):!!jc[ue]:N.namespaceURI===fe?te.namespaceURI===xe?ue==="math":te.namespaceURI===be?ue==="math"&&Mb[ut]:!!Jm[ue]:N.namespaceURI===xe?te.namespaceURI===be&&!Mb[ut]||te.namespaceURI===fe&&!yt[ut]?!1:!Jm[ue]&&(rN[ue]||!jc[ue]):!!(_t==="application/xhtml+xml"&&Qe[N.namespaceURI]):!1},Di=function(N){kl(e.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=x}catch{N.remove()}}},ep=function(N,te){try{kl(e.removed,{attribute:te.getAttributeNode(N),from:te})}catch{kl(e.removed,{attribute:null,from:te})}if(te.removeAttribute(N),N==="is"&&!O[N])if(ye||He)try{Di(te)}catch{}else try{te.setAttribute(N,"")}catch{}},Ab=function(N){var te,ue;if(ke)N="<remove></remove>"+N;else{var ut=YW(N,/^[\r\n\t ]+/);ue=ut&&ut[0]}_t==="application/xhtml+xml"&&Be===xe&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var jn=L?L.createHTML(N):N;if(Be===xe)try{te=new f().parseFromString(jn,_t)}catch{}if(!te||!te.documentElement){te=G.createDocument(Be,"template",null);try{te.documentElement.innerHTML=St?x:jn}catch{}}var Cn=te.body||te.documentElement;return N&&ue&&Cn.insertBefore(r.createTextNode(ue),Cn.childNodes[0]||null),Be===xe?X.call(te,z?"html":"body")[0]:z?te.documentElement:Cn},Ob=function(N){return ne.call(N.ownerDocument||N,N,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},oN=function(N){return N instanceof d&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},$l=function(N){return Vo(s)==="object"?N instanceof s:N&&Vo(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},Ni=function(N,te,ue){se[N]&&UW(se[N],function(ut){ut.call(e,te,ue,dn)})},Ib=function(N){var te;if(Ni("beforeSanitizeElements",N,null),oN(N)||Hn(/[\u0080-\uFFFF]/,N.nodeName))return Di(N),!0;var ue=Vt(N.nodeName);if(Ni("uponSanitizeElement",N,{tagName:ue,allowedTags:E}),N.hasChildNodes()&&!$l(N.firstElementChild)&&(!$l(N.content)||!$l(N.content.firstElementChild))&&Hn(/<[/\w]/g,N.innerHTML)&&Hn(/<[/\w]/g,N.textContent)||ue==="select"&&Hn(/<template/i,N.innerHTML))return Di(N),!0;if(!E[ue]||q[ue]){if(!q[ue]&&xb(ue)&&(B.tagNameCheck instanceof RegExp&&Hn(B.tagNameCheck,ue)||B.tagNameCheck instanceof Function&&B.tagNameCheck(ue)))return!1;if(F&&!H[ue]){var ut=_(N)||N.parentNode,jn=b(N)||N.childNodes;if(jn&&ut)for(var Cn=jn.length,fn=Cn-1;fn>=0;--fn)ut.insertBefore(v(jn[fn],!0),y(N))}return Di(N),!0}return N instanceof a&&!iN(N)||(ue==="noscript"||ue==="noembed"||ue==="noframes")&&Hn(/<\/no(script|embed|frames)/i,N.innerHTML)?(Di(N),!0):(Oe&&N.nodeType===3&&(te=N.textContent,te=xr(te,ve," "),te=xr(te,Pe," "),te=xr(te,nt," "),N.textContent!==te&&(kl(e.removed,{element:N.cloneNode()}),N.textContent=te)),Ni("afterSanitizeElements",N,null),!1)},Pb=function(N,te,ue){if(C&&(te==="id"||te==="name")&&(ue in r||ue in hs))return!1;if(!(de&&!Q[te]&&Hn(Ne,te))){if(!(K&&Hn(R,te))){if(!O[te]||Q[te]){if(!(xb(N)&&(B.tagNameCheck instanceof RegExp&&Hn(B.tagNameCheck,N)||B.tagNameCheck instanceof Function&&B.tagNameCheck(N))&&(B.attributeNameCheck instanceof RegExp&&Hn(B.attributeNameCheck,te)||B.attributeNameCheck instanceof Function&&B.attributeNameCheck(te))||te==="is"&&B.allowCustomizedBuiltInElements&&(B.tagNameCheck instanceof RegExp&&Hn(B.tagNameCheck,ue)||B.tagNameCheck instanceof Function&&B.tagNameCheck(ue))))return!1}else if(!U[te]){if(!Hn(m,xr(ue,g,""))){if(!((te==="src"||te==="xlink:href"||te==="href")&&N!=="script"&&GW(ue,"data:")===0&&V[N])){if(!(Ae&&!Hn(h,xr(ue,g,"")))){if(ue)return!1}}}}}}return!0},xb=function(N){return N.indexOf("-")>0},Hb=function(N){var te,ue,ut,jn;Ni("beforeSanitizeAttributes",N,null);var Cn=N.attributes;if(Cn){var fn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:O};for(jn=Cn.length;jn--;){te=Cn[jn];var Kc=te,sn=Kc.name,tp=Kc.namespaceURI;if(ue=sn==="value"?te.value:zW(te.value),ut=Vt(sn),fn.attrName=ut,fn.attrValue=ue,fn.keepAttr=!0,fn.forceKeepAttr=void 0,Ni("uponSanitizeAttribute",N,fn),ue=fn.attrValue,!fn.forceKeepAttr&&(ep(sn,N),!!fn.keepAttr)){if(!Ee&&Hn(/\/>/i,ue)){ep(sn,N);continue}Oe&&(ue=xr(ue,ve," "),ue=xr(ue,Pe," "),ue=xr(ue,nt," "));var Db=Vt(N.nodeName);if(Pb(Db,ut,ue)){if(S&&(ut==="id"||ut==="name")&&(ep(sn,N),ue=A+ue),L&&Vo(p)==="object"&&typeof p.getAttributeType=="function"&&!tp)switch(p.getAttributeType(Db,ut)){case"TrustedHTML":{ue=L.createHTML(ue);break}case"TrustedScriptURL":{ue=L.createScriptURL(ue);break}}try{tp?N.setAttributeNS(tp,sn,ue):N.setAttribute(sn,ue),TR(e.removed)}catch{}}}}Ni("afterSanitizeAttributes",N,null)}},sN=function Te(N){var te,ue=Ob(N);for(Ni("beforeSanitizeShadowDOM",N,null);te=ue.nextNode();)Ni("uponSanitizeShadowNode",te,null),!Ib(te)&&(te.content instanceof i&&Te(te.content),Hb(te));Ni("afterSanitizeShadowDOM",N,null)};return e.sanitize=function(Te){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},te,ue,ut,jn,Cn;if(St=!Te,St&&(Te="<!-->"),typeof Te!="string"&&!$l(Te))if(typeof Te.toString=="function"){if(Te=Te.toString(),typeof Te!="string")throw Rp("dirty is not a string, aborting")}else throw Rp("toString is not a function");if(!e.isSupported){if(Vo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Te=="string")return t.toStaticHTML(Te);if($l(Te))return t.toStaticHTML(Te.outerHTML)}return Te}if(Ke||tn(N),e.removed=[],typeof Te=="string"&&(P=!1),P){if(Te.nodeName){var fn=Vt(Te.nodeName);if(!E[fn]||q[fn])throw Rp("root node is forbidden and cannot be sanitized in-place")}}else if(Te instanceof s)te=Ab("<!---->"),ue=te.ownerDocument.importNode(Te,!0),ue.nodeType===1&&ue.nodeName==="BODY"||ue.nodeName==="HTML"?te=ue:te.appendChild(ue);else{if(!ye&&!Oe&&!z&&Te.indexOf("<")===-1)return L&&Re?L.createHTML(Te):Te;if(te=Ab(Te),!te)return ye?null:Re?x:""}te&&ke&&Di(te.firstChild);for(var Kc=Ob(P?Te:te);ut=Kc.nextNode();)ut.nodeType===3&&ut===jn||Ib(ut)||(ut.content instanceof i&&sN(ut.content),Hb(ut),jn=ut);if(jn=null,P)return Te;if(ye){if(He)for(Cn=j.call(te.ownerDocument);te.firstChild;)Cn.appendChild(te.firstChild);else Cn=te;return(O.shadowroot||O.shadowrootmod)&&(Cn=ie.call(n,Cn,!0)),Cn}var sn=z?te.outerHTML:te.innerHTML;return z&&E["!doctype"]&&te.ownerDocument&&te.ownerDocument.doctype&&te.ownerDocument.doctype.name&&Hn(iV,te.ownerDocument.doctype.name)&&(sn="<!DOCTYPE "+te.ownerDocument.doctype.name+`>
`+sn),Oe&&(sn=xr(sn,ve," "),sn=xr(sn,Pe," "),sn=xr(sn,nt," ")),L&&Re?L.createHTML(sn):sn},e.setConfig=function(Te){tn(Te),Ke=!0},e.clearConfig=function(){dn=null,Ke=!1},e.isValidAttribute=function(Te,N,te){dn||tn({});var ue=Vt(Te),ut=Vt(N);return Pb(ue,ut,te)},e.addHook=function(Te,N){typeof N=="function"&&(se[Te]=se[Te]||[],kl(se[Te],N))},e.removeHook=function(Te){if(se[Te])return TR(se[Te])},e.removeHooks=function(Te){se[Te]&&(se[Te]=[])},e.removeAllHooks=function(){se={}},e}var aV=yO();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var bO;function Z(){return bO.apply(null,arguments)}function lV(t){bO=t}function Qr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Zs(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function at(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function vS(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(at(t,e))return!1;return!0}function Jn(t){return t===void 0}function go(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Rc(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function RO(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function zo(t,e){for(var n in e)at(e,n)&&(t[n]=e[n]);return at(e,"toString")&&(t.toString=e.toString),at(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Pi(t,e,n,r){return jO(t,e,n,r,!0).utc()}function uV(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(t){return t._pf==null&&(t._pf=uV()),t._pf}var QC;Array.prototype.some?QC=Array.prototype.some:QC=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function SS(t){if(t._isValid==null){var e=ze(t),n=QC.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function jf(t){var e=Pi(NaN);return t!=null?zo(ze(e),t):ze(e).userInvalidated=!0,e}var IR=Z.momentProperties=[],Ap=!1;function yS(t,e){var n,r,i,o=IR.length;if(Jn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Jn(e._i)||(t._i=e._i),Jn(e._f)||(t._f=e._f),Jn(e._l)||(t._l=e._l),Jn(e._strict)||(t._strict=e._strict),Jn(e._tzm)||(t._tzm=e._tzm),Jn(e._isUTC)||(t._isUTC=e._isUTC),Jn(e._offset)||(t._offset=e._offset),Jn(e._pf)||(t._pf=ze(e)),Jn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=IR[n],i=e[r],Jn(i)||(t[r]=i);return t}function Ec(t){yS(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Ap===!1&&(Ap=!0,Z.updateOffset(this),Ap=!1)}function Jr(t){return t instanceof Ec||t!=null&&t._isAMomentObject!=null}function EO(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Or(t,e){var n=!0;return zo(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])at(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}EO(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var PR={};function TO(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),PR[t]||(EO(e),PR[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function xi(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function cV(t){var e,n;for(n in t)at(t,n)&&(e=t[n],xi(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function JC(t,e){var n=zo({},t),r;for(r in e)at(e,r)&&(Zs(t[r])&&Zs(e[r])?(n[r]={},zo(n[r],t[r]),zo(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)at(t,r)&&!at(e,r)&&Zs(t[r])&&(n[r]=zo({},n[r]));return n}function bS(t){t!=null&&this.set(t)}var ev;Object.keys?ev=Object.keys:ev=function(t){var e,n=[];for(e in t)at(t,e)&&n.push(e);return n};var hV={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function dV(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return xi(r)?r.call(e,n):r}function Ai(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var RS=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,th=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Op={},dl={};function Me(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(dl[t]=i),e&&(dl[e[0]]=function(){return Ai(i.apply(this,arguments),e[1],e[2])}),n&&(dl[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function fV(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function gV(t){var e=t.match(RS),n,r;for(n=0,r=e.length;n<r;n++)dl[e[n]]?e[n]=dl[e[n]]:e[n]=fV(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=xi(e[s])?e[s].call(i,t):e[s];return o}}function yd(t,e){return t.isValid()?(e=_O(e,t.localeData()),Op[e]=Op[e]||gV(e),Op[e](t)):t.localeData().invalidDate()}function _O(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(th.lastIndex=0;n>=0&&th.test(t);)t=t.replace(th,r),th.lastIndex=0,n-=1;return t}var mV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function pV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(RS).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var wV="Invalid date";function CV(){return this._invalidDate}var vV="%d",SV=/\d{1,2}/;function yV(t){return this._ordinal.replace("%d",t)}var bV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function RV(t,e,n,r){var i=this._relativeTime[n];return xi(i)?i(t,e,n,r):i.replace(/%d/i,t)}function EV(t,e){var n=this._relativeTime[t>0?"future":"past"];return xi(n)?n(e):n.replace(/%s/i,e)}var xu={};function In(t,e){var n=t.toLowerCase();xu[n]=xu[n+"s"]=xu[e]=t}function Ir(t){return typeof t=="string"?xu[t]||xu[t.toLowerCase()]:void 0}function ES(t){var e={},n,r;for(r in t)at(t,r)&&(n=Ir(r),n&&(e[n]=t[r]));return e}var MO={};function Pn(t,e){MO[t]=e}function TV(t){var e=[],n;for(n in t)at(t,n)&&e.push({unit:n,priority:MO[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function Kf(t){return t%4===0&&t%100!==0||t%400===0}function Tr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function tt(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Tr(e)),n}function _l(t,e){return function(n){return n!=null?(AO(this,t,n),Z.updateOffset(this,e),this):qd(this,t)}}function qd(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function AO(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&Kf(t.year())&&t.month()===1&&t.date()===29?(n=tt(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),eg(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function _V(t){return t=Ir(t),xi(this[t])?this[t]():this}function MV(t,e){if(typeof t=="object"){t=ES(t);var n=TV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Ir(t),xi(this[t]))return this[t](e);return this}var OO=/\d/,pr=/\d\d/,IO=/\d{3}/,TS=/\d{4}/,Xf=/[+-]?\d{6}/,Tt=/\d\d?/,PO=/\d\d\d\d?/,xO=/\d\d\d\d\d\d?/,qf=/\d{1,3}/,_S=/\d{1,4}/,Zf=/[+-]?\d{1,6}/,Ml=/\d+/,Qf=/[+-]?\d+/,AV=/Z|[+-]\d\d:?\d\d/gi,Jf=/Z|[+-]\d\d(?::?\d\d)?/gi,OV=/[+-]?\d+(\.\d{1,3})?/,Tc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Zd;Zd={};function me(t,e,n){Zd[t]=xi(e)?e:function(r,i){return r&&n?n:e}}function IV(t,e){return at(Zd,t)?Zd[t](e._strict,e._locale):new RegExp(PV(t))}function PV(t){return dr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function dr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tv={};function gt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),go(e)&&(r=function(o,s){s[e]=tt(o)}),i=t.length,n=0;n<i;n++)tv[t[n]]=r}function _c(t,e){gt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function xV(t,e,n){e!=null&&at(tv,t)&&tv[t](e,n._a,n,t)}var _n=0,ro=1,bi=2,rn=3,Kr=4,io=5,Gs=6,HV=7,DV=8;function NV(t,e){return(t%e+e)%e}var zt;Array.prototype.indexOf?zt=Array.prototype.indexOf:zt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function eg(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=NV(e,12);return t+=(e-n)/12,n===1?Kf(t)?29:28:31-n%7%2}Me("M",["MM",2],"Mo",function(){return this.month()+1});Me("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Me("MMMM",0,0,function(t){return this.localeData().months(this,t)});In("month","M");Pn("month",8);me("M",Tt);me("MM",Tt,pr);me("MMM",function(t,e){return e.monthsShortRegex(t)});me("MMMM",function(t,e){return e.monthsRegex(t)});gt(["M","MM"],function(t,e){e[ro]=tt(t)-1});gt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ro]=i:ze(n).invalidMonth=t});var LV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),HO="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),DO=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,$V=Tc,kV=Tc;function FV(t,e){return t?Qr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||DO).test(e)?"format":"standalone"][t.month()]:Qr(this._months)?this._months:this._months.standalone}function WV(t,e){return t?Qr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[DO.test(e)?"format":"standalone"][t.month()]:Qr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function VV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Pi([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=zt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:(i=zt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=zt.call(this._longMonthsParse,s),i!==-1?i:(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null))}function BV(t,e,n){var r,i,o;if(this._monthsParseExact)return VV.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Pi([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function NO(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=tt(e);else if(e=t.localeData().monthsParse(e),!go(e))return t}return n=Math.min(t.date(),eg(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function LO(t){return t!=null?(NO(this,t),Z.updateOffset(this,!0),this):qd(this,"Month")}function UV(){return eg(this.year(),this.month())}function YV(t){return this._monthsParseExact?(at(this,"_monthsRegex")||$O.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=$V),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function GV(t){return this._monthsParseExact?(at(this,"_monthsRegex")||$O.call(this),t?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=kV),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function $O(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=Pi([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=dr(e[i]),n[i]=dr(n[i]);for(i=0;i<24;i++)r[i]=dr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Me("Y",0,0,function(){var t=this.year();return t<=9999?Ai(t,4):"+"+t});Me(0,["YY",2],0,function(){return this.year()%100});Me(0,["YYYY",4],0,"year");Me(0,["YYYYY",5],0,"year");Me(0,["YYYYYY",6,!0],0,"year");In("year","y");Pn("year",1);me("Y",Qf);me("YY",Tt,pr);me("YYYY",_S,TS);me("YYYYY",Zf,Xf);me("YYYYYY",Zf,Xf);gt(["YYYYY","YYYYYY"],_n);gt("YYYY",function(t,e){e[_n]=t.length===2?Z.parseTwoDigitYear(t):tt(t)});gt("YY",function(t,e){e[_n]=Z.parseTwoDigitYear(t)});gt("Y",function(t,e){e[_n]=parseInt(t,10)});function Hu(t){return Kf(t)?366:365}Z.parseTwoDigitYear=function(t){return tt(t)+(tt(t)>68?1900:2e3)};var kO=_l("FullYear",!0);function zV(){return Kf(this.year())}function jV(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function tc(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Qd(t,e,n){var r=7+e-n,i=(7+tc(t,0,r).getUTCDay()-e)%7;return-i+r-1}function FO(t,e,n,r,i){var o=(7+n-r)%7,s=Qd(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Hu(l)+a):a>Hu(t)?(l=t+1,u=a-Hu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function nc(t,e,n){var r=Qd(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+fo(s,e,n)):i>fo(t.year(),e,n)?(o=i-fo(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function fo(t,e,n){var r=Qd(t,e,n),i=Qd(t+1,e,n);return(Hu(t)-r+i)/7}Me("w",["ww",2],"wo","week");Me("W",["WW",2],"Wo","isoWeek");In("week","w");In("isoWeek","W");Pn("week",5);Pn("isoWeek",5);me("w",Tt);me("ww",Tt,pr);me("W",Tt);me("WW",Tt,pr);_c(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=tt(t)});function KV(t){return nc(t,this._week.dow,this._week.doy).week}var XV={dow:0,doy:6};function qV(){return this._week.dow}function ZV(){return this._week.doy}function QV(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function JV(t){var e=nc(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Me("d",0,"do","day");Me("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Me("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Me("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Me("e",0,0,"weekday");Me("E",0,0,"isoWeekday");In("day","d");In("weekday","e");In("isoWeekday","E");Pn("day",11);Pn("weekday",11);Pn("isoWeekday",11);me("d",Tt);me("e",Tt);me("E",Tt);me("dd",function(t,e){return e.weekdaysMinRegex(t)});me("ddd",function(t,e){return e.weekdaysShortRegex(t)});me("dddd",function(t,e){return e.weekdaysRegex(t)});_c(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:ze(n).invalidWeekday=t});_c(["d","e","E"],function(t,e,n,r){e[r]=tt(t)});function eB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function tB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function MS(t,e){return t.slice(e,7).concat(t.slice(0,e))}var nB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),WO="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),rB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),iB=Tc,oB=Tc,sB=Tc;function aB(t,e){var n=Qr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?MS(n,this._week.dow):t?n[t.day()]:n}function lB(t){return t===!0?MS(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function uB(t){return t===!0?MS(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function cB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Pi([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1||(i=zt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=zt.call(this._minWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function hB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return cB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Pi([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function dB(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=eB(t,this.localeData()),this.add(t-e,"d")):e}function fB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function gB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=tB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function mB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||AS.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=iB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function pB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||AS.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=oB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function wB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||AS.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=sB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function AS(){function t(c,d){return d.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Pi([2e3,1]).day(o),a=dr(this.weekdaysMin(s,"")),l=dr(this.weekdaysShort(s,"")),u=dr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function OS(){return this.hours()%12||12}function CB(){return this.hours()||24}Me("H",["HH",2],0,"hour");Me("h",["hh",2],0,OS);Me("k",["kk",2],0,CB);Me("hmm",0,0,function(){return""+OS.apply(this)+Ai(this.minutes(),2)});Me("hmmss",0,0,function(){return""+OS.apply(this)+Ai(this.minutes(),2)+Ai(this.seconds(),2)});Me("Hmm",0,0,function(){return""+this.hours()+Ai(this.minutes(),2)});Me("Hmmss",0,0,function(){return""+this.hours()+Ai(this.minutes(),2)+Ai(this.seconds(),2)});function VO(t,e){Me(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}VO("a",!0);VO("A",!1);In("hour","h");Pn("hour",13);function BO(t,e){return e._meridiemParse}me("a",BO);me("A",BO);me("H",Tt);me("h",Tt);me("k",Tt);me("HH",Tt,pr);me("hh",Tt,pr);me("kk",Tt,pr);me("hmm",PO);me("hmmss",xO);me("Hmm",PO);me("Hmmss",xO);gt(["H","HH"],rn);gt(["k","kk"],function(t,e,n){var r=tt(t);e[rn]=r===24?0:r});gt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});gt(["h","hh"],function(t,e,n){e[rn]=tt(t),ze(n).bigHour=!0});gt("hmm",function(t,e,n){var r=t.length-2;e[rn]=tt(t.substr(0,r)),e[Kr]=tt(t.substr(r)),ze(n).bigHour=!0});gt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[rn]=tt(t.substr(0,r)),e[Kr]=tt(t.substr(r,2)),e[io]=tt(t.substr(i)),ze(n).bigHour=!0});gt("Hmm",function(t,e,n){var r=t.length-2;e[rn]=tt(t.substr(0,r)),e[Kr]=tt(t.substr(r))});gt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[rn]=tt(t.substr(0,r)),e[Kr]=tt(t.substr(r,2)),e[io]=tt(t.substr(i))});function vB(t){return(t+"").toLowerCase().charAt(0)==="p"}var SB=/[ap]\.?m?\.?/i,yB=_l("Hours",!0);function bB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var UO={calendar:hV,longDateFormat:mV,invalidDate:wV,ordinal:vV,dayOfMonthOrdinalParse:SV,relativeTime:bV,months:LV,monthsShort:HO,week:XV,weekdays:nB,weekdaysMin:rB,weekdaysShort:WO,meridiemParse:SB},Ot={},Fl={},rc;function RB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function xR(t){return t&&t.toLowerCase().replace("_","-")}function EB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=xR(t[e]).split("-"),n=o.length,r=xR(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=tg(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&RB(o,r)>=n-1)break;n--}e++}return rc}function TB(t){return t.match("^[^/\\\\]*$")!=null}function tg(t){var e=null,n;if(Ot[t]===void 0&&typeof Yd<"u"&&Yd&&Yd.exports&&TB(t))try{e=rc._abbr,n=require,n("./locale/"+t),Zo(e)}catch{Ot[t]=null}return Ot[t]}function Zo(t,e){var n;return t&&(Jn(e)?n=vo(t):n=IS(t,e),n?rc=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),rc._abbr}function IS(t,e){if(e!==null){var n,r=UO;if(e.abbr=t,Ot[t]!=null)TO("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ot[t]._config;else if(e.parentLocale!=null)if(Ot[e.parentLocale]!=null)r=Ot[e.parentLocale]._config;else if(n=tg(e.parentLocale),n!=null)r=n._config;else return Fl[e.parentLocale]||(Fl[e.parentLocale]=[]),Fl[e.parentLocale].push({name:t,config:e}),null;return Ot[t]=new bS(JC(r,e)),Fl[t]&&Fl[t].forEach(function(i){IS(i.name,i.config)}),Zo(t),Ot[t]}else return delete Ot[t],null}function _B(t,e){if(e!=null){var n,r,i=UO;Ot[t]!=null&&Ot[t].parentLocale!=null?Ot[t].set(JC(Ot[t]._config,e)):(r=tg(t),r!=null&&(i=r._config),e=JC(i,e),r==null&&(e.abbr=t),n=new bS(e),n.parentLocale=Ot[t],Ot[t]=n),Zo(t)}else Ot[t]!=null&&(Ot[t].parentLocale!=null?(Ot[t]=Ot[t].parentLocale,t===Zo()&&Zo(t)):Ot[t]!=null&&delete Ot[t]);return Ot[t]}function vo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return rc;if(!Qr(t)){if(e=tg(t),e)return e;t=[t]}return EB(t)}function MB(){return ev(Ot)}function PS(t){var e,n=t._a;return n&&ze(t).overflow===-2&&(e=n[ro]<0||n[ro]>11?ro:n[bi]<1||n[bi]>eg(n[_n],n[ro])?bi:n[rn]<0||n[rn]>24||n[rn]===24&&(n[Kr]!==0||n[io]!==0||n[Gs]!==0)?rn:n[Kr]<0||n[Kr]>59?Kr:n[io]<0||n[io]>59?io:n[Gs]<0||n[Gs]>999?Gs:-1,ze(t)._overflowDayOfYear&&(e<_n||e>bi)&&(e=bi),ze(t)._overflowWeeks&&e===-1&&(e=HV),ze(t)._overflowWeekday&&e===-1&&(e=DV),ze(t).overflow=e),t}var AB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,OB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,IB=/Z|[+-]\d\d(?::?\d\d)?/,nh=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ip=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],PB=/^\/?Date\((-?\d+)/i,xB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,HB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function YO(t){var e,n,r=t._i,i=AB.exec(r)||OB.exec(r),o,s,a,l,u=nh.length,c=Ip.length;if(i){for(ze(t).iso=!0,e=0,n=u;e<n;e++)if(nh[e][1].exec(i[1])){s=nh[e][0],o=nh[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Ip[e][1].exec(i[3])){a=(i[2]||" ")+Ip[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(IB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),HS(t)}else t._isValid=!1}function DB(t,e,n,r,i,o){var s=[NB(t),HO.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function NB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function LB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function $B(t,e,n){if(t){var r=WO.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return ze(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function kB(t,e,n){if(t)return HB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function GO(t){var e=xB.exec(LB(t._i)),n;if(e){if(n=DB(e[4],e[3],e[2],e[5],e[6],e[7]),!$B(e[1],n,t))return;t._a=n,t._tzm=kB(e[8],e[9],e[10]),t._d=tc.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ze(t).rfc2822=!0}else t._isValid=!1}function FB(t){var e=PB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(YO(t),t._isValid===!1)delete t._isValid;else return;if(GO(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=Or("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function nl(t,e,n){return t??e??n}function WB(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function xS(t){var e,n,r=[],i,o,s;if(!t._d){for(i=WB(t),t._w&&t._a[bi]==null&&t._a[ro]==null&&VB(t),t._dayOfYear!=null&&(s=nl(t._a[_n],i[_n]),(t._dayOfYear>Hu(s)||t._dayOfYear===0)&&(ze(t)._overflowDayOfYear=!0),n=tc(s,0,t._dayOfYear),t._a[ro]=n.getUTCMonth(),t._a[bi]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[rn]===24&&t._a[Kr]===0&&t._a[io]===0&&t._a[Gs]===0&&(t._nextDay=!0,t._a[rn]=0),t._d=(t._useUTC?tc:jV).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[rn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ze(t).weekdayMismatch=!0)}}function VB(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=nl(e.GG,t._a[_n],nc(Et(),1,4).year),r=nl(e.W,1),i=nl(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=nc(Et(),o,s),n=nl(e.gg,t._a[_n],u.year),r=nl(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>fo(n,o,s)?ze(t)._overflowWeeks=!0:l!=null?ze(t)._overflowWeekday=!0:(a=FO(n,r,i,o,s),t._a[_n]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function HS(t){if(t._f===Z.ISO_8601){YO(t);return}if(t._f===Z.RFC_2822){GO(t);return}t._a=[],ze(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=_O(t._f,t._locale).match(RS)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(IV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&ze(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),dl[o]?(r?ze(t).empty=!1:ze(t).unusedTokens.push(o),xV(o,r,t)):t._strict&&!r&&ze(t).unusedTokens.push(o);ze(t).charsLeftOver=a-l,e.length>0&&ze(t).unusedInput.push(e),t._a[rn]<=12&&ze(t).bigHour===!0&&t._a[rn]>0&&(ze(t).bigHour=void 0),ze(t).parsedDateParts=t._a.slice(0),ze(t).meridiem=t._meridiem,t._a[rn]=BB(t._locale,t._a[rn],t._meridiem),u=ze(t).era,u!==null&&(t._a[_n]=t._locale.erasConvertYear(u,t._a[_n])),xS(t),PS(t)}function BB(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function UB(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){ze(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=yS({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],HS(e),SS(e)&&(s=!0),o+=ze(e).charsLeftOver,o+=ze(e).unusedTokens.length*10,ze(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));zo(t,n||e)}function YB(t){if(!t._d){var e=ES(t._i),n=e.day===void 0?e.date:e.day;t._a=RO([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),xS(t)}}function GB(t){var e=new Ec(PS(zO(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function zO(t){var e=t._i,n=t._f;return t._locale=t._locale||vo(t._l),e===null||n===void 0&&e===""?jf({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Jr(e)?new Ec(PS(e)):(Rc(e)?t._d=e:Qr(n)?UB(t):n?HS(t):zB(t),SS(t)||(t._d=null),t))}function zB(t){var e=t._i;Jn(e)?t._d=new Date(Z.now()):Rc(e)?t._d=new Date(e.valueOf()):typeof e=="string"?FB(t):Qr(e)?(t._a=RO(e.slice(0),function(n){return parseInt(n,10)}),xS(t)):Zs(e)?YB(t):go(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function jO(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Zs(t)&&vS(t)||Qr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,GB(o)}function Et(t,e,n,r){return jO(t,e,n,r,!1)}var jB=Or("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:jf()}),KB=Or("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:jf()});function KO(t,e){var n,r;if(e.length===1&&Qr(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function XB(){var t=[].slice.call(arguments,0);return KO("isBefore",t)}function qB(){var t=[].slice.call(arguments,0);return KO("isAfter",t)}var ZB=function(){return Date.now?Date.now():+new Date},Wl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function QB(t){var e,n=!1,r,i=Wl.length;for(e in t)if(at(t,e)&&!(zt.call(Wl,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Wl[r]]){if(n)return!1;parseFloat(t[Wl[r]])!==tt(t[Wl[r]])&&(n=!0)}return!0}function JB(){return this._isValid}function e2(){return ti(NaN)}function ng(t){var e=ES(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=QB(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=vo(),this._bubble()}function bd(t){return t instanceof ng}function nv(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function t2(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&tt(t[s])!==tt(e[s]))&&o++;return o+i}function XO(t,e){Me(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Ai(~~(n/60),2)+e+Ai(~~n%60,2)})}XO("Z",":");XO("ZZ","");me("Z",Jf);me("ZZ",Jf);gt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=DS(Jf,t)});var n2=/([\+\-]|\d\d)/gi;function DS(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(n2)||["-",0,0],o=+(i[1]*60)+tt(i[2]),o===0?0:i[0]==="+"?o:-o)}function NS(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Jr(t)||Rc(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Et(t).local()}function rv(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function r2(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=DS(Jf,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=rv(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?QO(this,ti(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:rv(this)}function i2(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function o2(t){return this.utcOffset(0,t)}function s2(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(rv(this),"m")),this}function a2(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=DS(AV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function l2(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function u2(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function c2(){if(!Jn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return yS(t,this),t=zO(t),t._a?(e=t._isUTC?Pi(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&t2(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function h2(){return this.isValid()?!this._isUTC:!1}function d2(){return this.isValid()?this._isUTC:!1}function qO(){return this.isValid()?this._isUTC&&this._offset===0:!1}var f2=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,g2=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ti(t,e){var n=t,r=null,i,o,s;return bd(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:go(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=f2.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:tt(r[bi])*i,h:tt(r[rn])*i,m:tt(r[Kr])*i,s:tt(r[io])*i,ms:tt(nv(r[Gs]*1e3))*i}):(r=g2.exec(t))?(i=r[1]==="-"?-1:1,n={y:gs(r[2],i),M:gs(r[3],i),w:gs(r[4],i),d:gs(r[5],i),h:gs(r[6],i),m:gs(r[7],i),s:gs(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=m2(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new ng(n),bd(t)&&at(t,"_locale")&&(o._locale=t._locale),bd(t)&&at(t,"_isValid")&&(o._isValid=t._isValid),o}ti.fn=ng.prototype;ti.invalid=e2;function gs(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function HR(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function m2(t,e){var n;return t.isValid()&&e.isValid()?(e=NS(e,t),t.isBefore(e)?n=HR(t,e):(n=HR(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function ZO(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(TO(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ti(n,r),QO(this,i,t),this}}function QO(t,e,n,r){var i=e._milliseconds,o=nv(e._days),s=nv(e._months);t.isValid()&&(r=r??!0,s&&NO(t,qd(t,"Month")+s*n),o&&AO(t,"Date",qd(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var p2=ZO(1,"add"),w2=ZO(-1,"subtract");function JO(t){return typeof t=="string"||t instanceof String}function C2(t){return Jr(t)||Rc(t)||JO(t)||go(t)||S2(t)||v2(t)||t===null||t===void 0}function v2(t){var e=Zs(t)&&!vS(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||at(t,o);return e&&n}function S2(t){var e=Qr(t),n=!1;return e&&(n=t.filter(function(r){return!go(r)&&JO(t)}).length===0),e&&n}function y2(t){var e=Zs(t)&&!vS(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||at(t,o);return e&&n}function b2(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function R2(t,e){arguments.length===1&&(arguments[0]?C2(arguments[0])?(t=arguments[0],e=void 0):y2(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=NS(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(xi(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function E2(){return new Ec(this)}function T2(t,e){var n=Jr(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function _2(t,e){var n=Jr(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function M2(t,e,n,r){var i=Jr(t)?t:Et(t),o=Jr(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function A2(t,e){var n=Jr(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function O2(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function I2(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function P2(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=NS(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Ir(e),e){case"year":o=Rd(this,r)/12;break;case"month":o=Rd(this,r);break;case"quarter":o=Rd(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Tr(o)}function Rd(t,e){if(t.date()<e.date())return-Rd(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function x2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function H2(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?yd(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):xi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",yd(n,"Z")):yd(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function D2(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function N2(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=yd(this,t);return this.localeData().postformat(e)}function L2(t,e){return this.isValid()&&(Jr(t)&&t.isValid()||Et(t).isValid())?ti({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function $2(t){return this.from(Et(),t)}function k2(t,e){return this.isValid()&&(Jr(t)&&t.isValid()||Et(t).isValid())?ti({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function F2(t){return this.to(Et(),t)}function eI(t){var e;return t===void 0?this._locale._abbr:(e=vo(t),e!=null&&(this._locale=e),this)}var tI=Or("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function nI(){return this._locale}var Jd=1e3,fl=60*Jd,ef=60*fl,rI=(365*400+97)*24*ef;function gl(t,e){return(t%e+e)%e}function iI(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-rI:new Date(t,e,n).valueOf()}function oI(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-rI:Date.UTC(t,e,n)}function W2(t){var e,n;if(t=Ir(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?oI:iI,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=gl(e+(this._isUTC?0:this.utcOffset()*fl),ef);break;case"minute":e=this._d.valueOf(),e-=gl(e,fl);break;case"second":e=this._d.valueOf(),e-=gl(e,Jd);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function V2(t){var e,n;if(t=Ir(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?oI:iI,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=ef-gl(e+(this._isUTC?0:this.utcOffset()*fl),ef)-1;break;case"minute":e=this._d.valueOf(),e+=fl-gl(e,fl)-1;break;case"second":e=this._d.valueOf(),e+=Jd-gl(e,Jd)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function B2(){return this._d.valueOf()-(this._offset||0)*6e4}function U2(){return Math.floor(this.valueOf()/1e3)}function Y2(){return new Date(this.valueOf())}function G2(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function z2(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function j2(){return this.isValid()?this.toISOString():null}function K2(){return SS(this)}function X2(){return zo({},ze(this))}function q2(){return ze(this).overflow}function Z2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Me("N",0,0,"eraAbbr");Me("NN",0,0,"eraAbbr");Me("NNN",0,0,"eraAbbr");Me("NNNN",0,0,"eraName");Me("NNNNN",0,0,"eraNarrow");Me("y",["y",1],"yo","eraYear");Me("y",["yy",2],0,"eraYear");Me("y",["yyy",3],0,"eraYear");Me("y",["yyyy",4],0,"eraYear");me("N",LS);me("NN",LS);me("NNN",LS);me("NNNN",lU);me("NNNNN",uU);gt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?ze(n).era=i:ze(n).invalidEra=t});me("y",Ml);me("yy",Ml);me("yyy",Ml);me("yyyy",Ml);me("yo",cU);gt(["y","yy","yyy","yyyy"],_n);gt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[_n]=n._locale.eraYearOrdinalParse(t,i):e[_n]=parseInt(t,10)});function Q2(t,e){var n,r,i,o=this._eras||vo("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function J2(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function eU(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function tU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function nU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function rU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function iU(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function oU(t){return at(this,"_erasNameRegex")||$S.call(this),t?this._erasNameRegex:this._erasRegex}function sU(t){return at(this,"_erasAbbrRegex")||$S.call(this),t?this._erasAbbrRegex:this._erasRegex}function aU(t){return at(this,"_erasNarrowRegex")||$S.call(this),t?this._erasNarrowRegex:this._erasRegex}function LS(t,e){return e.erasAbbrRegex(t)}function lU(t,e){return e.erasNameRegex(t)}function uU(t,e){return e.erasNarrowRegex(t)}function cU(t,e){return e._eraYearOrdinalRegex||Ml}function $S(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(dr(s[i].name)),t.push(dr(s[i].abbr)),n.push(dr(s[i].narrow)),r.push(dr(s[i].name)),r.push(dr(s[i].abbr)),r.push(dr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Me(0,["gg",2],0,function(){return this.weekYear()%100});Me(0,["GG",2],0,function(){return this.isoWeekYear()%100});function rg(t,e){Me(0,[t,t.length],0,e)}rg("gggg","weekYear");rg("ggggg","weekYear");rg("GGGG","isoWeekYear");rg("GGGGG","isoWeekYear");In("weekYear","gg");In("isoWeekYear","GG");Pn("weekYear",1);Pn("isoWeekYear",1);me("G",Qf);me("g",Qf);me("GG",Tt,pr);me("gg",Tt,pr);me("GGGG",_S,TS);me("gggg",_S,TS);me("GGGGG",Zf,Xf);me("ggggg",Zf,Xf);_c(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=tt(t)});_c(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function hU(t){return sI.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function dU(t){return sI.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function fU(){return fo(this.year(),1,4)}function gU(){return fo(this.isoWeekYear(),1,4)}function mU(){var t=this.localeData()._week;return fo(this.year(),t.dow,t.doy)}function pU(){var t=this.localeData()._week;return fo(this.weekYear(),t.dow,t.doy)}function sI(t,e,n,r,i){var o;return t==null?nc(this,r,i).year:(o=fo(t,r,i),e>o&&(e=o),wU.call(this,t,e,n,r,i))}function wU(t,e,n,r,i){var o=FO(t,e,n,r,i),s=tc(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Me("Q",0,"Qo","quarter");In("quarter","Q");Pn("quarter",7);me("Q",OO);gt("Q",function(t,e){e[ro]=(tt(t)-1)*3});function CU(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Me("D",["DD",2],"Do","date");In("date","D");Pn("date",9);me("D",Tt);me("DD",Tt,pr);me("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});gt(["D","DD"],bi);gt("Do",function(t,e){e[bi]=tt(t.match(Tt)[0])});var aI=_l("Date",!0);Me("DDD",["DDDD",3],"DDDo","dayOfYear");In("dayOfYear","DDD");Pn("dayOfYear",4);me("DDD",qf);me("DDDD",IO);gt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=tt(t)});function vU(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Me("m",["mm",2],0,"minute");In("minute","m");Pn("minute",14);me("m",Tt);me("mm",Tt,pr);gt(["m","mm"],Kr);var SU=_l("Minutes",!1);Me("s",["ss",2],0,"second");In("second","s");Pn("second",15);me("s",Tt);me("ss",Tt,pr);gt(["s","ss"],io);var yU=_l("Seconds",!1);Me("S",0,0,function(){return~~(this.millisecond()/100)});Me(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Me(0,["SSS",3],0,"millisecond");Me(0,["SSSS",4],0,function(){return this.millisecond()*10});Me(0,["SSSSS",5],0,function(){return this.millisecond()*100});Me(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Me(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Me(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Me(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});In("millisecond","ms");Pn("millisecond",16);me("S",qf,OO);me("SS",qf,pr);me("SSS",qf,IO);var jo,lI;for(jo="SSSS";jo.length<=9;jo+="S")me(jo,Ml);function bU(t,e){e[Gs]=tt(("0."+t)*1e3)}for(jo="S";jo.length<=9;jo+="S")gt(jo,bU);lI=_l("Milliseconds",!1);Me("z",0,0,"zoneAbbr");Me("zz",0,0,"zoneName");function RU(){return this._isUTC?"UTC":""}function EU(){return this._isUTC?"Coordinated Universal Time":""}var ee=Ec.prototype;ee.add=p2;ee.calendar=R2;ee.clone=E2;ee.diff=P2;ee.endOf=V2;ee.format=N2;ee.from=L2;ee.fromNow=$2;ee.to=k2;ee.toNow=F2;ee.get=_V;ee.invalidAt=q2;ee.isAfter=T2;ee.isBefore=_2;ee.isBetween=M2;ee.isSame=A2;ee.isSameOrAfter=O2;ee.isSameOrBefore=I2;ee.isValid=K2;ee.lang=tI;ee.locale=eI;ee.localeData=nI;ee.max=KB;ee.min=jB;ee.parsingFlags=X2;ee.set=MV;ee.startOf=W2;ee.subtract=w2;ee.toArray=G2;ee.toObject=z2;ee.toDate=Y2;ee.toISOString=H2;ee.inspect=D2;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=j2;ee.toString=x2;ee.unix=U2;ee.valueOf=B2;ee.creationData=Z2;ee.eraName=tU;ee.eraNarrow=nU;ee.eraAbbr=rU;ee.eraYear=iU;ee.year=kO;ee.isLeapYear=zV;ee.weekYear=hU;ee.isoWeekYear=dU;ee.quarter=ee.quarters=CU;ee.month=LO;ee.daysInMonth=UV;ee.week=ee.weeks=QV;ee.isoWeek=ee.isoWeeks=JV;ee.weeksInYear=mU;ee.weeksInWeekYear=pU;ee.isoWeeksInYear=fU;ee.isoWeeksInISOWeekYear=gU;ee.date=aI;ee.day=ee.days=dB;ee.weekday=fB;ee.isoWeekday=gB;ee.dayOfYear=vU;ee.hour=ee.hours=yB;ee.minute=ee.minutes=SU;ee.second=ee.seconds=yU;ee.millisecond=ee.milliseconds=lI;ee.utcOffset=r2;ee.utc=o2;ee.local=s2;ee.parseZone=a2;ee.hasAlignedHourOffset=l2;ee.isDST=u2;ee.isLocal=h2;ee.isUtcOffset=d2;ee.isUtc=qO;ee.isUTC=qO;ee.zoneAbbr=RU;ee.zoneName=EU;ee.dates=Or("dates accessor is deprecated. Use date instead.",aI);ee.months=Or("months accessor is deprecated. Use month instead",LO);ee.years=Or("years accessor is deprecated. Use year instead",kO);ee.zone=Or("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",i2);ee.isDSTShifted=Or("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",c2);function TU(t){return Et(t*1e3)}function _U(){return Et.apply(null,arguments).parseZone()}function uI(t){return t}var lt=bS.prototype;lt.calendar=dV;lt.longDateFormat=pV;lt.invalidDate=CV;lt.ordinal=yV;lt.preparse=uI;lt.postformat=uI;lt.relativeTime=RV;lt.pastFuture=EV;lt.set=cV;lt.eras=Q2;lt.erasParse=J2;lt.erasConvertYear=eU;lt.erasAbbrRegex=sU;lt.erasNameRegex=oU;lt.erasNarrowRegex=aU;lt.months=FV;lt.monthsShort=WV;lt.monthsParse=BV;lt.monthsRegex=GV;lt.monthsShortRegex=YV;lt.week=KV;lt.firstDayOfYear=ZV;lt.firstDayOfWeek=qV;lt.weekdays=aB;lt.weekdaysMin=uB;lt.weekdaysShort=lB;lt.weekdaysParse=hB;lt.weekdaysRegex=mB;lt.weekdaysShortRegex=pB;lt.weekdaysMinRegex=wB;lt.isPM=vB;lt.meridiem=bB;function tf(t,e,n,r){var i=vo(),o=Pi().set(r,e);return i[n](o,t)}function cI(t,e,n){if(go(t)&&(e=t,t=void 0),t=t||"",e!=null)return tf(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=tf(t,r,n,"month");return i}function kS(t,e,n,r){typeof t=="boolean"?(go(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,go(e)&&(n=e,e=void 0),e=e||"");var i=vo(),o=t?i._week.dow:0,s,a=[];if(n!=null)return tf(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=tf(e,(s+o)%7,r,"day");return a}function MU(t,e){return cI(t,e,"months")}function AU(t,e){return cI(t,e,"monthsShort")}function OU(t,e,n){return kS(t,e,n,"weekdays")}function IU(t,e,n){return kS(t,e,n,"weekdaysShort")}function PU(t,e,n){return kS(t,e,n,"weekdaysMin")}Zo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=tt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=Or("moment.lang is deprecated. Use moment.locale instead.",Zo);Z.langData=Or("moment.langData is deprecated. Use moment.localeData instead.",vo);var Li=Math.abs;function xU(){var t=this._data;return this._milliseconds=Li(this._milliseconds),this._days=Li(this._days),this._months=Li(this._months),t.milliseconds=Li(t.milliseconds),t.seconds=Li(t.seconds),t.minutes=Li(t.minutes),t.hours=Li(t.hours),t.months=Li(t.months),t.years=Li(t.years),this}function hI(t,e,n,r){var i=ti(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function HU(t,e){return hI(this,t,e,1)}function DU(t,e){return hI(this,t,e,-1)}function DR(t){return t<0?Math.floor(t):Math.ceil(t)}function NU(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=DR(iv(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Tr(t/1e3),r.seconds=i%60,o=Tr(i/60),r.minutes=o%60,s=Tr(o/60),r.hours=s%24,e+=Tr(s/24),l=Tr(dI(e)),n+=l,e-=DR(iv(l)),a=Tr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function dI(t){return t*4800/146097}function iv(t){return t*146097/4800}function LU(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Ir(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+dI(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(iv(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function $U(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+tt(this._months/12)*31536e6:NaN}function So(t){return function(){return this.as(t)}}var kU=So("ms"),FU=So("s"),WU=So("m"),VU=So("h"),BU=So("d"),UU=So("w"),YU=So("M"),GU=So("Q"),zU=So("y");function jU(){return ti(this)}function KU(t){return t=Ir(t),this.isValid()?this[t+"s"]():NaN}function la(t){return function(){return this.isValid()?this._data[t]:NaN}}var XU=la("milliseconds"),qU=la("seconds"),ZU=la("minutes"),QU=la("hours"),JU=la("days"),eY=la("months"),tY=la("years");function nY(){return Tr(this.days()/7)}var Qi=Math.round,al={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function rY(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function iY(t,e,n,r){var i=ti(t).abs(),o=Qi(i.as("s")),s=Qi(i.as("m")),a=Qi(i.as("h")),l=Qi(i.as("d")),u=Qi(i.as("M")),c=Qi(i.as("w")),d=Qi(i.as("y")),f=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||d<=1&&["y"]||["yy",d],f[2]=e,f[3]=+t>0,f[4]=r,rY.apply(null,f)}function oY(t){return t===void 0?Qi:typeof t=="function"?(Qi=t,!0):!1}function sY(t,e){return al[t]===void 0?!1:e===void 0?al[t]:(al[t]=e,t==="s"&&(al.ss=e-1),!0)}function aY(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=al,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},al,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=iY(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Pp=Math.abs;function ma(t){return(t>0)-(t<0)||+t}function ig(){if(!this.isValid())return this.localeData().invalidDate();var t=Pp(this._milliseconds)/1e3,e=Pp(this._days),n=Pp(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,d;return a?(r=Tr(t/60),i=Tr(r/60),t%=60,r%=60,o=Tr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ma(this._months)!==ma(a)?"-":"",c=ma(this._days)!==ma(a)?"-":"",d=ma(this._milliseconds)!==ma(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?d+i+"H":"")+(r?d+r+"M":"")+(t?d+s+"S":"")):"P0D"}var it=ng.prototype;it.isValid=JB;it.abs=xU;it.add=HU;it.subtract=DU;it.as=LU;it.asMilliseconds=kU;it.asSeconds=FU;it.asMinutes=WU;it.asHours=VU;it.asDays=BU;it.asWeeks=UU;it.asMonths=YU;it.asQuarters=GU;it.asYears=zU;it.valueOf=$U;it._bubble=NU;it.clone=jU;it.get=KU;it.milliseconds=XU;it.seconds=qU;it.minutes=ZU;it.hours=QU;it.days=JU;it.weeks=nY;it.months=eY;it.years=tY;it.humanize=aY;it.toISOString=ig;it.toString=ig;it.toJSON=ig;it.locale=eI;it.localeData=nI;it.toIsoString=Or("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ig);it.lang=tI;Me("X",0,0,"unix");Me("x",0,0,"valueOf");me("x",Qf);me("X",OV);gt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});gt("x",function(t,e,n){n._d=new Date(tt(t))});//! moment.js
Z.version="2.29.4";lV(Et);Z.fn=ee;Z.min=XB;Z.max=qB;Z.now=ZB;Z.utc=Pi;Z.unix=TU;Z.months=MU;Z.isDate=Rc;Z.locale=Zo;Z.invalid=jf;Z.duration=ti;Z.isMoment=Jr;Z.weekdays=OU;Z.parseZone=_U;Z.localeData=vo;Z.isDuration=bd;Z.monthsShort=AU;Z.weekdaysMin=PU;Z.defineLocale=IS;Z.updateLocale=_B;Z.locales=MB;Z.weekdaysShort=IU;Z.normalizeUnits=Ir;Z.relativeTimeRounding=oY;Z.relativeTimeThreshold=sY;Z.calendarFormat=b2;Z.prototype=ee;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const lY=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"}));function fI(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function ov(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Du(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Yt(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function gr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ye(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function T(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function gI(t){return Yt(t,(e,n)=>e+n,0)}function uY(t){return Yt(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function cY(t){return Yt(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function hY(t){return t.length?gI(t)/t.length:0}function mI(t){return Yt(t,(e,n)=>e.concat(Array.isArray(n)?mI(n):n),[])}function FS(t){const e=[];return T(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function sv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function dY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>s.includes(a))}),o}function fY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return T(i,s=>{T(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function av(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const gY=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:hY,arrayEach:T,arrayFilter:gr,arrayFlatten:mI,arrayMap:Ye,arrayMax:uY,arrayMin:cY,arrayReduce:Yt,arraySum:gI,arrayUnique:FS,extendArray:ov,getDifferenceOfArrays:sv,getIntersectionOfArrays:dY,getUnionOfArrays:fY,pivot:Du,stringToArray:av,to2dArray:fI},Symbol.toStringTag,{value:"Module"}));function ft(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yt(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Ft(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function he(t){return typeof t<"u"}function Ct(t){return typeof t>"u"}function en(t){return t===null||t===""||Ct(t)}function pI(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Tu="length",Nu=t=>parseInt(t,16),NR=t=>parseInt(t,10),nf=(t,e,n)=>t.substr(e,n),Lu=t=>t.codePointAt(0)-65,lv=t=>`${t}`.replace(/\-/g,""),mY=t=>Nu(nf(lv(t),Nu("12"),Lu("F")))/(Nu(nf(lv(t),Lu("B"),~~![][Tu]))||9),pY=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let LR=!1;const $R={invalid:()=>ft`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},kR={invalid:()=>ft`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function wI(t,e){const n=!en(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0";let o,s="invalid",a="invalid";t=lv(t||"");const l=wY(t);if(n||r||l)if(l){const u=Z("30/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=mY(t);o=Z((d+1)*864e5,"x").format("MMMM DD, YYYY"),c>d?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(pY()&&(s="valid",a="valid"),!LR&&s!=="valid"&&($R[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"]($R[s]({keyValidityDate:o,hotVersion:i})),LR=!0),a!=="valid"&&e.parentNode&&kR[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=kR[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function wY(t){let e=[][Tu],n=e;if(t[Tu]!==Lu("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Lu(i.shift());o;o=Lu(i.shift()||"A"))--o<""[Tu]?n=n|(NR(`${NR(Nu(r)+(Nu(nf(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=nf(t,o,o?i[Tu]===1?9:8:6);return n===e}const CY=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:wI,isDefined:he,isEmpty:en,isRegExp:pI,isUndefined:Ct,stringify:Ft},Symbol.toStringTag,{value:"Module"}));function Mn(t){return t[0].toUpperCase()+t.substr(1)}function vY(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Ft(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function WS(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function VS(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function BS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function uv(t){return og(`${t}`,{ALLOWED_TAGS:[]})}function og(t,e){return aV.sanitize(t,e)}const SY=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:vY,isPercentValue:VS,randomString:WS,sanitize:og,stripTags:uv,substitute:BS,toUpperCaseFirst:Mn},Symbol.toStringTag,{value:"Module"})),Al=t=>["tabindex",t],yY=()=>["role","treegrid"],Ti=()=>["role","presentation"],bY=()=>["role","gridcell"],RY=()=>["role","rowheader"],CI=()=>["role","rowgroup"],EY=()=>["role","columnheader"],cv=()=>["role","row"],TY=()=>["role","menu"],_Y=()=>["role","menuitem"],MY=()=>["role","combobox"],vI=()=>["role","listbox"],AY=()=>["role","option"],OY=()=>["role","checkbox"],IY=()=>["scope","col"],PY=()=>["scope","row"],xY=()=>["type","text"],US=t=>["aria-label",t],yo=()=>["aria-hidden","true"],HY=()=>["aria-disabled","true"],DY=()=>["aria-multiselectable","true"],SI=t=>["aria-haspopup",t],yI=t=>["aria-rowcount",t],sg=t=>["aria-colcount",t],bI=t=>["aria-rowindex",t],YS=t=>["aria-colindex",t],_r=t=>["aria-expanded",t],NY=t=>["aria-sort",t],FR=()=>["aria-readonly","true"],WR=()=>["aria-invalid","true"],LY=t=>["aria-checked",t],GS=()=>["aria-selected","true"],$Y=()=>["aria-autocomplete","list"],kY=t=>["aria-controls",t],FY=t=>["aria-activedescendant",t],WY=t=>["aria-live",t],VY=t=>["aria-relevant",t],BY=t=>["aria-setsize",t],UY=t=>["aria-posinset",t];function RI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function EI(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function TI(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function ic(t){return TI(t)&&t.parent}function YY(t){return!!Object.getPrototypeOf(t.parent)}function rs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function _u(t,e,n){const r=[];let i=t;for(;i&&(i=rs(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Qo(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function _I(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function ko(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function MI(t){return!t||!t.length?[]:t.filter(e=>!!e)}function AI(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function De(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function J(t,e){typeof e=="string"&&(e=e.split(" ")),e=MI(e),e.length>0&&t.classList.add(...e)}function $e(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=AI(e,!0);n=MI(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function _e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function ua(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=AI(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function zS(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)zS(e[n])}}function ei(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const OI=/(<(.*)>|&(.*);)/;function ca(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;OI.test(e)?t.innerHTML=n?og(e):e:is(t,e)}function is(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ei(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function os(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return os(n.host.impl);if(n.host)return os(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(mo(n).display==="none")return!1;n=n.parentNode}return!0}function jt(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function jS(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function ag(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function oc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?jS(e):t.scrollTop}function rf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?ag(e):t.scrollLeft}function sc(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Qs(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=mo(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Sl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=mo(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function GY(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function mo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function dt(t){return t.offsetWidth}function Pt(t){return t.offsetHeight}function oo(t){return t.clientHeight||t.innerHeight}function $u(t){return t.clientWidth||t.innerWidth}function zY(t,e,n){t.addEventListener(e,n,!1)}function jY(t,e,n){t.removeEventListener(e,n,!1)}function KS(t){return t.selectionStart?t.selectionStart:0}function II(t){return t.selectionEnd?t.selectionEnd:0}function KY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function hv(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Mc(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let xp;function XY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function on(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return xp===void 0&&(xp=XY(t)),xp}function PI(t){return t.offsetWidth!==t.clientWidth}function xI(t){return t.offsetHeight!==t.clientHeight}function lg(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function qY(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Ac(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function of(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function ug(t){return of(t)&&t.hasAttribute("data-hot-input")===!1}function ZY(t){const e=t.ownerDocument.activeElement;ug(e)||t.select()}function XS(t){return!t.parentNode}function HI(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function qS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();_e(t,"contenteditable",!0),n&&_e(t,...yo()),e&&J(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function ZS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&$e(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function DI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;qS(t,n),e(),ZS(t,n)}const QY=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:OI,addClass:J,addEvent:zY,clearTextSelection:hv,closest:rs,closestDown:_u,empty:ei,fastInnerHTML:ca,fastInnerText:is,getCaretPosition:KS,getComputedStyle:mo,getCssTransform:qY,getFrameElement:TI,getParent:RI,getParentWindow:ic,getScrollLeft:rf,getScrollTop:oc,getScrollableElement:sc,getScrollbarWidth:on,getSelectionEndPosition:II,getSelectionText:KY,getStyle:Sl,getTrimmingContainer:Qs,getWindowScrollLeft:ag,getWindowScrollTop:jS,hasAccessToParentWindow:YY,hasClass:De,hasHorizontalScrollbar:xI,hasVerticalScrollbar:PI,index:_I,innerHeight:oo,innerWidth:$u,isChildOf:Qo,isDetached:XS,isInput:of,isOutsideInput:ug,isThisHotChild:EI,isVisible:os,makeElementContentEditableAndSelectItsContent:qS,matchesCSSRules:GY,observeVisibilityChangeOnce:HI,offset:jt,outerHeight:Pt,outerWidth:dt,overlayContainsElement:ko,removeAttribute:ua,removeClass:$e,removeContentEditableFromElementAndDeselect:ZS,removeEvent:jY,removeTextNodes:zS,resetCssTransform:Ac,runWithSelectedContendEditableElement:DI,selectElementIfAllowed:ZY,setAttribute:_e,setCaretPosition:Mc,setOverlayPosition:lg},Symbol.toStringTag,{value:"Module"}));function wt(t){return typeof t=="function"}function NI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const d=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},d)),r}return o}function JY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=NI(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function cg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function eG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Yt(i,(u,c)=>c(u),r.apply(this,a))}}function QS(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function LI(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function tG(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function sf(t,e,n,r,i,o,s,a){return he(a)?t.call(e,n,r,i,o,s,a):he(s)?t.call(e,n,r,i,o,s):he(o)?t.call(e,n,r,i,o):he(i)?t.call(e,n,r,i):he(r)?t.call(e,n,r):he(n)?t.call(e,n):t.call(e)}const nG=Object.freeze(Object.defineProperty({__proto__:null,curry:LI,curryRight:tG,debounce:cg,fastCall:sf,isFunction:wt,partial:QS,pipe:eG,throttle:NI,throttleAfterHits:JY},Symbol.toStringTag,{value:"Module"}));var rG=Gn,VR=rO,iG=wn,BR=Tl,oG=uO,UR=rG([].push),sG=function(t){if(iG(t))return t;if(VR(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?UR(n,i):(typeof i=="number"||BR(i)==="Number"||BR(i)==="String")&&UR(n,oG(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(VR(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},aG=sa,$I=vc,kI=zf,lG=Vf,Oc=Gn,FI=Ar,YR=wn,GR=sS,WI=wS,uG=sG,cG=oS,hG=String,Jo=$I("JSON","stringify"),rh=Oc(/./.exec),zR=Oc("".charAt),dG=Oc("".charCodeAt),fG=Oc("".replace),gG=Oc(1 .toString),mG=/[\uD800-\uDFFF]/g,jR=/^[\uD800-\uDBFF]$/,KR=/^[\uDC00-\uDFFF]$/,XR=!cG||FI(function(){var t=$I("Symbol")("stringify detection");return Jo([t])!=="[null]"||Jo({a:t})!=="{}"||Jo(Object(t))!=="{}"}),qR=FI(function(){return Jo("\uDF06\uD834")!=='"\\udf06\\ud834"'||Jo("\uDEAD")!=='"\\udead"'}),pG=function(t,e){var n=WI(arguments),r=uG(e);if(!(!YR(r)&&(t===void 0||GR(t))))return n[1]=function(i,o){if(YR(r)&&(o=lG(r,this,hG(i),o)),!GR(o))return o},kI(Jo,null,n)},wG=function(t,e,n){var r=zR(n,e-1),i=zR(n,e+1);return rh(jR,t)&&!rh(KR,i)||rh(KR,t)&&!rh(jR,r)?"\\u"+gG(dG(t,0),16):t};Jo&&aG({target:"JSON",stat:!0,arity:3,forced:XR||qR},{stringify:function(e,n,r){var i=WI(arguments),o=kI(XR?pG:Jo,null,i);return qR&&typeof o=="string"?fG(o,mG,wG):o}});function yl(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ge(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=yl(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[yl(n[0])]:e[r]=[]:e[r]=null)})),e}function bo(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Kt(t,e,n){const r=Array.isArray(n);return Ge(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Ic(t,e){Ge(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Ic(t[r],e[r])):t[r]=e[r]})}function An(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Un(t){const e={};return Ge(t,(n,r)=>{e[r]=n}),e}function mt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return T(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ge(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,d){const f=`_${c}`,p=w=>{let v=w;return(Array.isArray(v)||Ue(v))&&(v=An(v)),v};return function(){return this[f]===void 0&&(this[f]=p(d)),this[f]}},l=function(c){const d=`_${c}`;return function(f){this[d]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function hg(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ue(t){return Object.prototype.toString.call(t)==="[object Object]"}function Hi(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ge(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function VI(t,e){const n=e.split(".");let r=t;return Ge(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Ed(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(It(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function dg(t){if(!Ue(t))return 0;const e=function(n){let r=0;return Ue(n)?Ge(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Xr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function It(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const CG=Object.freeze(Object.defineProperty({__proto__:null,clone:Un,createObjectPropListener:Xr,deepClone:An,deepExtend:Ic,deepObjectSize:dg,defineGetter:Hi,duckSchema:yl,extend:Kt,getProperty:VI,hasOwnProperty:It,inherit:bo,isObject:Ue,isObjectEqual:hg,mixin:mt,objectEach:Ge,setProperty:Ed},Symbol.toStringTag,{value:"Module"})),br=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Ro={chrome:br((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:br(t=>/CriOS/.test(t)),edge:br(t=>/Edge/.test(t)),edgeWebKit:br(t=>/EdgiOS/.test(t)),firefox:br(t=>/Firefox/.test(t)),firefoxWebKit:br(t=>/FxiOS/.test(t)),mobile:br(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:br((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Ol={mac:br(t=>/^Mac/.test(t)),win:br(t=>/^Win/.test(t)),linux:br(t=>/^Linux/.test(t)),ios:br(t=>/iPhone|iPad|iPod/i.test(t))};function BI(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(Ro,n=>{let{test:r}=n;return void r(t,e)})}function UI(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(Ol,e=>{let{test:n}=e;return void n(t)})}BI();UI();function JS(){return Ro.chrome.value}function YI(){return Ro.chromeWebKit.value}function Td(){return Ro.firefox.value}function GI(){return Ro.firefoxWebKit.value}function ey(){return Ro.safari.value}function zI(){return Ro.edge.value}function vG(){return Ro.edgeWebKit.value}function so(){return Ro.mobile.value}function ty(){return Ol.ios.value}function ny(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Ol.mac.value}function dv(){return Ol.win.value}function ac(){return Ol.mac.value}function SG(){return Ol.linux.value}const yG=Object.freeze(Object.defineProperty({__proto__:null,isChrome:JS,isChromeWebKit:YI,isEdge:zI,isEdgeWebKit:vG,isFirefox:Td,isFirefoxWebKit:GI,isIOS:ty,isIpadOS:ny,isLinuxOS:SG,isMacOS:ac,isMobileBrowser:so,isSafari:ey,isWindowsOS:dv,setBrowserMeta:BI,setPlatformMeta:UI},Symbol.toStringTag,{value:"Module"})),we={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Td()?182:174,AUDIO_MUTE:Td()?181:173,AUDIO_UP:Td()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},bG=[we.ALT,we.ARROW_DOWN,we.ARROW_LEFT,we.ARROW_RIGHT,we.ARROW_UP,we.AUDIO_DOWN,we.AUDIO_MUTE,we.AUDIO_UP,we.BACKSPACE,we.CAPS_LOCK,we.DELETE,we.END,we.ENTER,we.ESCAPE,we.F1,we.F2,we.F3,we.F4,we.F5,we.F6,we.F7,we.F8,we.F9,we.F10,we.F11,we.F12,we.F13,we.F14,we.F15,we.F16,we.F17,we.F18,we.F19,we.HOME,we.INSERT,we.MEDIA_NEXT,we.MEDIA_PLAY_PAUSE,we.MEDIA_PREV,we.MEDIA_STOP,we.NULL,we.NUM_LOCK,we.PAGE_DOWN,we.PAGE_UP,we.PAUSE,we.SCROLL_LOCK,we.SHIFT,we.TAB];function jI(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function ry(t){return bG.includes(t)}function RG(t){const e=[];return ac()?e.push(we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX):e.push(we.CONTROL),e.includes(t)}function KI(t){return[we.CONTROL,we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX].includes(t)}function Il(t,e){const n=e.split("|");let r=!1;return T(n,i=>{if(t===we[i])return r=!0,!1}),r}const EG=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:we,isCtrlKey:RG,isCtrlMetaKey:KI,isFunctionKey:ry,isKey:Il,isPrintableChar:jI},Symbol.toStringTag,{value:"Module"}));function Pr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Bo(t){return t.isImmediatePropagationEnabled===!1}function ss(t){return t.button===2}function fg(t){return t.button===0}function XI(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const TG=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Bo,isLeftClick:fg,isRightClick:ss,offsetRelativeTo:XI,stopImmediatePropagation:Pr},Symbol.toStringTag,{value:"Module"}));function vt(){he(console)&&console.warn(...arguments)}function iy(){he(console)&&console.error(...arguments)}function _G(t,e,n){return e=MG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MG(t){var e=AG(t,"string");return typeof e=="symbol"?e:String(e)}function AG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pa=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],OG=ft`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Hp=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Dp=new Map([[]]);class qI{static getSingleton(){return PG()}constructor(){_G(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return T(pa,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))T(n,i=>this.add(e,i,r));else{Hp.has(e)&&vt(BS(OG,{hookName:e,removedInVersion:Hp.get(e)})),Dp.has(e)&&vt(Dp.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&T(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?T(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=sf(u[d],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[d]&&u[d].runOnce&&this.remove(n,u[d]),d+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=sf(u[d],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[d]&&u[d].runOnce&&this.remove(n,u[d],e),d+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ge(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||pa.push(e)}deregister(e){this.isRegistered(e)&&pa.splice(pa.indexOf(e),1)}isDeprecated(e){return Dp.has(e)||Hp.has(e)}isRegistered(e){return pa.indexOf(e)>=0}getRegistered(){return pa}}const IG=new qI;function PG(){return IG}const ge=qI,Np=new Map;function ni(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Np.has(t)||Np.set(t,new Map);const e=Np.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const fv=new WeakMap,{register:xG,getItem:ZI,hasItem:QI,getNames:HG,getValues:Aae}=ni("editors");function DG(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ge.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function JI(t,e){let n;if(typeof t=="function")fv.get(t)||er(null,t),n=fv.get(t);else if(typeof t=="string")n=ZI(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function af(t){if(typeof t=="function")return t;if(!QI(t))throw Error(`No registered editor found under "${t}" name`);return ZI(t).getConstructor()}function er(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new DG(e);typeof t=="string"&&xG(t,n),fv.set(e,n)}function NG(t,e,n){return e=LG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LG(t){var e=$G(t,"string");return typeof e=="symbol"?e:String(e)}function $G(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let _d=0;class kG{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;NG(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,FG(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),_d+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),_d-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),_d-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function FG(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Pr(this)},t}const mr=kG;function WG(){return _d}function ZR(t,e){VG(t,e),e.add(t)}function VG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _o(t,e,n){return e=BG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BG(t){var e=UG(t,"string");return typeof e=="symbol"?e:String(e)}function UG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QR(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const gg="editorManager.navigation";var JR=new WeakSet,e0=new WeakSet;class gv{constructor(e,n,r){ZR(this,e0),ZR(this,JR),_o(this,"hot",void 0),_o(this,"tableMeta",void 0),_o(this,"selection",void 0),_o(this,"eventManager",void 0),_o(this,"destroyed",!1),_o(this,"lock",!1),_o(this,"activeEditor",void 0),_o(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new mr(e),this.hot.addHook("afterDocumentKeyDown",i=>QR(this,JR,YG).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>QR(this,e0,GG).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=JI(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function YG(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Bo(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!ry(n)&&!KI(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>he(this.hot.getSelected()),group:gg};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function GG(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const t0=new WeakMap;gv.getInstance=function(t,e,n){let r=t0.get(t);return r||(r=new gv(t,e,n),t0.set(t,r)),r};const zG=gv;function ih(t,e){eP(t,e),e.add(t)}function Vl(t,e,n){eP(t,e),e.set(t,n)}function eP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ll(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Nt(t,e){var n=tP(t,e,"get");return jG(t,n)}function jG(t,e){return e.get?e.get.call(t):e.value}function Bl(t,e,n){var r=tP(t,e,"set");return KG(t,r,n),n}function tP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function KG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Ko=Object.freeze({CELL:"cell",MIXED:"mixed"});var pn=new WeakMap,oh=new WeakMap,sh=new WeakMap,ah=new WeakMap,lh=new WeakMap,lf=new WeakSet,n0=new WeakSet,r0=new WeakSet,i0=new WeakSet;class XG{constructor(e){var n=this;ih(this,i0),ih(this,r0),ih(this,n0),ih(this,lf),Vl(this,pn,{writable:!0,value:void 0}),Vl(this,oh,{writable:!0,value:void 0}),Vl(this,sh,{writable:!0,value:50}),Vl(this,ah,{writable:!0,value:null}),Vl(this,lh,{writable:!0,value:new Map});const r=e.getSettings();Bl(this,pn,e),Bl(this,oh,r.imeFastEdit?Ko.MIXED:Ko.CELL),Nt(this,pn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ll(n,i0,QG).call(n,...o)}),Nt(this,pn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ll(n,n0,qG).call(n,...o)}),Nt(this,pn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ll(n,r0,ZG).call(n,...o)})}getFocusMode(){return Nt(this,oh)}setFocusMode(e){Object.values(Ko).includes(e)?Bl(this,oh,e):vt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Nt(this,sh)}setRefocusDelay(e){Bl(this,sh,e)}setRefocusElementGetter(e){Bl(this,ah,e)}getRefocusElement(){if(typeof Nt(this,ah)=="function")return Nt(this,ah).call(this);var e;return(e=Nt(this,pn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Nt(this,pn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Nt(this,pn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Nt(this,pn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):ll(this,lf,oy).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Nt(this,sh);const r=this.getRefocusElement();Nt(this,pn).getSettings().imeFastEdit&&!((e=Nt(this,pn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Nt(this,lh).has(n)||Nt(this,lh).set(n,cg(()=>{r.select()},n)),Nt(this,lh).get(n)())}}function oy(t){var e;const n=(e=Nt(this,pn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Nt(this,pn).selection.isCellVisible(n)){t(null);return}const r=Nt(this,pn).getCell(n.row,n.col,!0);r===null?Nt(this,pn).addHookOnce("afterScroll",()=>{t(Nt(this,pn).getCell(n.row,n.col,!0))}):t(r)}function qG(){ll(this,lf,oy).call(this,t=>{const{activeElement:e}=Nt(this,pn).rootDocument;e&&ug(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function ZG(){ll(this,lf,oy).call(this,t=>{this.getFocusMode()===Ko.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function QG(t){t.imeFastEdit&&this.getFocusMode()!==Ko.MIXED?this.setFocusMode(Ko.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Ko.CELL&&this.setFocusMode(Ko.CELL)}const nP={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},JG=new RegExp(Object.keys(nP).map(t=>`(${t})`).join("|"),"gi");function ez(t){return(t&&t.nodeName||"")==="TABLE"}function mv(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,d=e?1:0;for(let f=0;f<o;f+=1){const p=e&&f===0,w=[];for(let y=0;y<s;y+=1){const b=!p&&n&&y===0;let _="";if(p)_=`<th>${t.getColHeader(y-c)}</th>`;else if(b)_=`<th>${t.getRowHeader(f-d)}</th>`;else{const I=i[f][y],{hidden:L,rowspan:x,colspan:W}=t.getCellMeta(f-d,y-c);if(!L){const G=[];if(x&&G.push(`rowspan="${x}"`),W&&G.push(`colspan="${W}"`),en(I))_=`<td ${G.join(" ")}></td>`;else{const ne=I.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${G.join(" ")}>${ne}</td>`}}}w.push(_)}const v=["<tr>",...w,"</tr>"].join("");p?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function pv(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=en(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function rP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const I=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,L=>{const x=L.match(/<td\b[^>]*?>/g)[0],W=L.substring(x.length,L.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${x}${W}</td>`});i.insertAdjacentHTML("afterbegin",`${I}`),o=i.querySelector("table")}if(!o||!ez(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((I,L)=>I+L.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let f=!1,p=0,w=0;if(o.tHead){const I=Array.from(o.tHead.rows).filter(L=>{const x=L.querySelector("td")!==null;return x&&d.push(L),!x});p=I.length,f=p>0,p>1?n.nestedHeaders=Array.from(I).reduce((L,x)=>{const W=Array.from(x.cells).reduce((G,ne,j)=>{if(a&&j===0)return G;const{colSpan:X,innerHTML:ie}=ne,oe=X>1?{label:ie,colspan:X}:ie;return G.push(oe),G},[]);return L.push(W),L},[]):f&&(n.colHeaders=Array.from(I[0].children).reduce((L,x,W)=>(a&&W===0||L.push(x.innerHTML),L),[]))}d.length&&(n.fixedRowsTop=d.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...d,...Array.from(o.tBodies).reduce((I,L)=>(I.push(...Array.from(L.rows)),I),[]),...c];w=v.length;const y=new Array(w);for(let I=0;I<w;I++)y[I]=new Array(u);const b=[],_=[];for(let I=0;I<w;I++){const L=v[I],x=Array.from(L.cells),W=x.length;for(let G=0;G<W;G++){const ne=x[G],{nodeName:j,innerHTML:X,rowSpan:ie,colSpan:oe}=ne,se=y[I].findIndex(ve=>ve===void 0);if(j==="TD"){if(ie>1||oe>1){for(let Ne=I;Ne<I+ie;Ne++)if(Ne<w)for(let R=se;R<se+oe;R++)y[Ne][R]=null;const Pe=ne.getAttribute("style");Pe&&Pe.includes("mso-ignore:colspan")||b.push({col:se,row:I,rowspan:ie,colspan:oe})}let ve="";s&&/excel/gi.test(s.content)?ve=X.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ve=X.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[I][se]=ve.replace(JG,Pe=>nP[Pe])}else _.push(X)}}return b.length&&(n.mergeCells=b),_.length&&(n.rowHeaders=_),y.length&&(n.data=y),n}const tz=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:pv,htmlToGridSettings:rP,instanceToHTML:mv},Symbol.toStringTag,{value:"Module"}));function Bn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function iP(t){return Bn(t,[","])}function Ce(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function uf(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function sy(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ir(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const nz=Object.freeze(Object.defineProperty({__proto__:null,clamp:ir,isNumeric:Bn,isNumericLike:iP,rangeEach:Ce,rangeEachReverse:uf,valueAccordingPercent:sy},Symbol.toStringTag,{value:"Module"})),wv="asc",rz="desc",o0=new Map([[wv,[-1,1]],[rz,[1,-1]]]),iz=t=>`The priority '${t}' is already declared in a map.`,oz=t=>`The priority '${t}' is not a number.`;function sz(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=wt(t)?t:iz,e=wt(e)?e:oz;function r(o,s){if(!Bn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wv;const[s,a]=o0.get(o)||o0.get(wv);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const az=t=>`The id '${t}' is already declared in a map.`;function mg(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=wt(t)?t:az;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(d=>{let[f,p]=d;return u===p?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const lz=t=>`'${t}' value is already declared in a unique set.`;function uz(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=wt(t)?t:lz;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const ay=t=>`There is already registered "${t}" plugin.`,cz=t=>`There is already registered plugin on priority "${t}".`,hz=t=>`The priority "${t}" is not a number.`,oP=sz({errorPriorityExists:cz,errorPriorityNaN:hz}),sP=uz({errorItemExists:ay}),Cv=mg({errorIdExists:ay});function ly(){return[...oP.getItems(),...sP.getItems()]}function Pc(t){const e=Mn(t);return Cv.getItem(e)}function dz(t){return!!Pc(t)}function We(t,e,n){[t,e,n]=gz(t,e,n),Pc(t)===void 0&&fz(t,e,n)}function fz(t,e,n){const r=Mn(t);if(Cv.hasItem(r))throw new Error(ay(r));n===void 0?sP.addItem(r):oP.addItem(n,r),Cv.addItem(r,e)}function gz(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:mz,getItem:pz,hasItem:aP,getNames:wz,getValues:Oae}=ni("renderers");function cf(t){if(typeof t=="function")return t;if(!aP(t))throw Error(`No registered renderer found under "${t}" name`);return pz(t)}function Ci(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),mz(t,e)}const{register:Cz,getItem:vz,hasItem:lP,getNames:Sz,getValues:Iae}=ni("validators");function uy(t){if(typeof t=="function")return t;if(!lP(t))throw Error(`No registered validator found under "${t}" name`);return vz(t)}function ul(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Cz(t,e)}var uP={},yz=eO,bz=mS,Rz=Object.keys||function(e){return yz(e,bz)},Ez=Oi,Tz=jA,_z=oa,Mz=Sc,Az=Bf,Oz=Rz;uP.f=Ez&&!Tz?Object.defineProperties:function(e,n){Mz(e);for(var r=Az(n),i=Oz(n),o=i.length,s=0,a;o>s;)_z.f(e,a=i[s++],r[a]);return e};var Iz=Sc,Pz=uP,s0=mS,xz=dS,Hz=gO,Dz=cS,Nz=qA,a0=">",l0="<",vv="prototype",Sv="script",cP=Nz("IE_PROTO"),Lp=function(){},hP=function(t){return l0+Sv+a0+t+l0+"/"+Sv+a0},u0=function(t){t.write(hP("")),t.close();var e=t.parentWindow.Object;return t=null,e},Lz=function(){var t=Dz("iframe"),e="java"+Sv+":",n;return t.style.display="none",Hz.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(hP("document.F=Object")),n.close(),n.F},uh,Md=function(){try{uh=new ActiveXObject("htmlfile")}catch{}Md=typeof document<"u"?document.domain&&uh?u0(uh):Lz():u0(uh);for(var t=s0.length;t--;)delete Md[vv][s0[t]];return Md()};xz[cP]=!0;var $z=Object.create||function(e,n){var r;return e!==null?(Lp[vv]=Iz(e),r=new Lp,Lp[vv]=null,r[cP]=e):r=Md(),n===void 0?r:Pz.f(r,n)},kz=Yf,Fz=$z,Wz=oa.f,yv=kz("unscopables"),bv=Array.prototype;bv[yv]===void 0&&Wz(bv,yv,{configurable:!0,value:Fz(null)});var dP=function(t){bv[yv][t]=!0},Vz=sa,Bz=Uf,Uz=Gf,Yz=gS,Gz=dP;Vz({target:"Array",proto:!0},{at:function(e){var n=Bz(this),r=Uz(n),i=Yz(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});Gz("at");const Ys=1,En=2;function c0(t,e,n){zz(t,e),e.set(t,n)}function zz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $i(t,e,n){return e=jz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jz(t){var e=Kz(t,"string");return typeof e=="symbol"?e:String(e)}function Kz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qt(t,e){var n=fP(t,e,"get");return Xz(t,n)}function Xz(t,e){return e.get?e.get.call(t):e.value}function h0(t,e,n){var r=fP(t,e,"set");return qz(t,r,n),n}function fP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qz(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ch=new WeakMap,Zt=new WeakMap;class cy{static get DEFAULT_WIDTH(){return 50}constructor(e){$i(this,"count",0),$i(this,"startColumn",null),$i(this,"endColumn",null),$i(this,"startPosition",null),$i(this,"isVisibleInTrimmingContainer",!1),$i(this,"stretchAllRatio",0),$i(this,"stretchLastWidth",0),c0(this,ch,{writable:!0,value:0}),$i(this,"needVerifyLastColumnWidth",!0),$i(this,"stretchAllColumnsWidth",[]),c0(this,Zt,{writable:!0,value:void 0}),h0(this,Zt,e),typeof qt(this,Zt).stretchingColumnWidthFn!="function"&&(qt(this,Zt).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=qt(this,Zt),s=Math.max(qt(this,Zt).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let d,f=0,p=0;for(let b=0;b<i;b++)if(d=this._getColumnWidth(b),l<=s&&e!==En&&(this.startColumn=b,f=d),l>=s&&l+(e===En?d:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=b,f=d),this.endColumn=b),c.push(l),l+=d,p=d,e!==En&&(this.endColumn=b),l>=s+o){u=!1;break}const w=r+o-a,v=e===En?0:p,y=e===En?f:0;if(w<-1*qt(this,Zt).inlineStartOffset||r>c.at(-1)+v||-1*qt(this,Zt).scrollOffset-qt(this,Zt).viewportWidth>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=c[this.endColumn]+d-c[this.startColumn-1];if((b<=o||e!==En)&&(this.startColumn-=1),b>o)break}e===Ys&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(qt(this,Zt).stretchMode==="none")return;let n=e;h0(this,ch,n);const r=qt(this,Zt).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=qt(this,Zt).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(qt(this,Zt).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(qt(this,Zt).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return qt(this,Zt).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):qt(this,Zt).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=qt(this,Zt).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=qt(this,Zt).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==qt(this,ch)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=qt(this,ch)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=qt(this,Zt).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=qt(this,Zt).columnWidthFn(e);return isNaN(n)&&(n=cy.DEFAULT_WIDTH),n}}const hy=cy;function Zz(t,e,n){Qz(t,e),e.set(t,n)}function Qz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ul(t,e,n){return e=Jz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jz(t){var e=ej(t,"string");return typeof e=="symbol"?e:String(e)}function ej(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $p(t,e){var n=gP(t,e,"get");return tj(t,n)}function tj(t,e){return e.get?e.get.call(t):e.value}function nj(t,e,n){var r=gP(t,e,"set");return rj(t,r,n),n}function gP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Yl=new WeakMap;class dy{static get DEFAULT_HEIGHT(){return 23}constructor(e){Ul(this,"count",0),Ul(this,"startRow",null),Ul(this,"endRow",null),Ul(this,"startPosition",null),Ul(this,"isVisibleInTrimmingContainer",!1),Zz(this,Yl,{writable:!0,value:void 0}),nj(this,Yl,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=$p(this,Yl),a=Math.max($p(this,Yl).scrollOffset,0),l=$p(this,Yl).horizontalScrollbarHeight||0;let u=0,c=!0;const d=[];let f,p=0,w=0;for(let _=0;_<o;_++)if(f=r(_),isNaN(f)&&(f=dy.DEFAULT_HEIGHT),u<=a&&e!==En&&(this.startRow=_,p=f),u>=a&&u+(e===En?f:0)<=a+s-l&&(this.startRow===null&&(this.startRow=_,p=f),this.endRow=_),d.push(u),u+=f,w=f,e!==En&&(this.endRow=_),u>=a+s-l){c=!1;break}const v=i+s-l,y=e===En?p:0,b=e===En?0:w;if(v<y||i>d.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const _=d[this.endRow]+f-d[this.startRow-1];if((_<=s-l||e!==En)&&(this.startRow-=1),_>=s-l)break}e===Ys&&this.startRow!==null&&n&&n(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const mP=dy;function ij(t,e,n){oj(t,e),e.set(t,n)}function oj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d0(t,e,n){return e=sj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sj(t){var e=aj(t,"string");return typeof e=="symbol"?e:String(e)}function aj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wa(t,e){var n=pP(t,e,"get");return lj(t,n)}function lj(t,e){return e.get?e.get.call(t):e.value}function f0(t,e,n){var r=pP(t,e,"set");return uj(t,r,n),n}function pP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function uj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ki=new WeakMap;class hf{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;d0(this,"row",null),d0(this,"col",null),ij(this,ki,{writable:!0,value:!1}),f0(this,ki,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return wa(this,ki)}isSouthEastOf(e){return this.row>=e.row&&(wa(this,ki)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(wa(this,ki)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(wa(this,ki)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(wa(this,ki)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof hf&&f0(this,ki,e.isRtl()),this}clone(){return new hf(this.row,this.col,wa(this,ki))}toObject(){return{row:this.row,col:this.col}}}const df=hf;function cj(t,e,n){hj(t,e),e.set(t,n)}function hj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kp(t,e,n){return e=dj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dj(t){var e=fj(t,"string");return typeof e=="symbol"?e:String(e)}function fj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ii(t,e){var n=wP(t,e,"get");return gj(t,n)}function gj(t,e){return e.get?e.get.call(t):e.value}function mj(t,e,n){var r=wP(t,e,"set");return pj(t,r,n),n}function wP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var wr=new WeakMap;class fy{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;kp(this,"highlight",null),kp(this,"from",null),kp(this,"to",null),cj(this,wr,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),mj(this,wr,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),d=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=d,this.to=f,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ii(this,wr)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ii(this,wr)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ii(this,wr)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ii(this,wr)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ii(this,wr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ii(this,wr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ii(this,wr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ii(this,wr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof df))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new fy(this.highlight,this.from,this.to,ii(this,wr))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new df(e,n,ii(this,wr))}}const gy=fy;function pg(t){return window.requestAnimationFrame(t)}function lc(t){window.cancelAnimationFrame(t)}function my(){return"ontouchstart"in window}let Ca;function CP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ca||(typeof Intl=="object"?Ca=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Ca=(n,r)=>`${n}`.localeCompare(r):Ca=(n,r)=>n===r?0:n>r?-1:1,Ca)}const wj=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:lc,getComparisonFunction:CP,isTouchSupported:my,requestAnimationFrame:pg},Symbol.toStringTag,{value:"Module"}));function oi(t,e,n){Cj(t,e),e.set(t,n)}function Cj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Se(t,e){var n=vP(t,e,"get");return vj(t,n)}function vj(t,e){return e.get?e.get.call(t):e.value}function Mo(t,e,n){var r=vP(t,e,"set");return Sj(t,r,n),n}function vP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Sj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Cr=new WeakMap,Fp=new WeakMap,an=new WeakMap,va=new WeakMap,hh=new WeakMap,Hr=new WeakMap,Wp=new WeakMap,Gl=new WeakMap,ms=new WeakMap,si=new WeakMap;let yj=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;oi(this,Cr,{writable:!0,value:void 0}),oi(this,Fp,{writable:!0,value:void 0}),oi(this,an,{writable:!0,value:void 0}),oi(this,va,{writable:!0,value:void 0}),oi(this,hh,{writable:!0,value:void 0}),oi(this,Hr,{writable:!0,value:void 0}),oi(this,Wp,{writable:!0,value:void 0}),oi(this,Gl,{writable:!0,value:void 0}),oi(this,ms,{writable:!0,value:[null,null]}),oi(this,si,{writable:!0,value:[null,null]}),Mo(this,Cr,r),Mo(this,Fp,n),Mo(this,an,o),Mo(this,va,s),Mo(this,hh,a),Mo(this,Hr,i),Mo(this,Wp,e),this.registerEvents()}registerEvents(){Se(this,Hr).addEventListener(Se(this,an).holder,"contextmenu",r=>this.onContextMenu(r)),Se(this,Hr).addEventListener(Se(this,an).TABLE,"mouseover",r=>this.onMouseOver(r)),Se(this,Hr).addEventListener(Se(this,an).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Se(this,Hr).addEventListener(Se(this,an).holder,"touchstart",r=>this.onTouchStart(r)),Se(this,Hr).addEventListener(Se(this,an).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Se(this,Hr).addEventListener(Se(this,an).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Se(this,Cr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Se(this,Cr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Se(this,Hr).addEventListener(Se(this,an).holder,"mouseup",r=>this.onMouseUp(r)),Se(this,Hr).addEventListener(Se(this,an).holder,"mousedown",r=>this.onMouseDown(r))};so()?e():(my()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Se(this,Gl)&&r){const[i,o]=[r.row,Se(this,Gl).from.row],[s,a]=[r.col,Se(this,Gl).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=Se(this,an).TABLE,i=_u(e,["TD","TH"],r);return i?(n.coords=Se(this,an).getCoords(i),n.TD=i):De(e,"wtBorder")&&De(e,"current")?(n.coords=Se(this,va).getFocusSelection().cellRange.highlight,n.TD=Se(this,an).getCell(n.coords)):De(e,"wtBorder")&&De(e,"area")&&Se(this,va).getAreaSelection().cellRange&&(n.coords=Se(this,va).getAreaSelection().cellRange.to,n.TD=Se(this,an).getCell(n.coords)),n}onMouseDown(e){const n=Se(this,Fp).rootDocument.activeElement,r=QS(RI,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);De(i,"corner")?Se(this,Cr).getSetting("onCellCornerMouseDown",e,i):o.TD&&Se(this,Cr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Se(this,si)[0]=o.TD,clearTimeout(Se(this,ms)[0]),Se(this,ms)[0]=setTimeout(()=>{Se(this,si)[0]=null},1e3))}onContextMenu(e){if(Se(this,Cr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Se(this,Cr).has("onCellMouseOver"))return;const n=Se(this,an).TABLE,r=_u(e.target,["TD","TH"],n),i=Se(this,hh)||this;r&&r!==i.lastMouseOver&&Qo(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Se(this,an).getCoords(r),r))}onMouseOut(e){if(!Se(this,Cr).has("onCellMouseOut"))return;const n=Se(this,an).TABLE,r=_u(e.target,["TD","TH"],n),i=_u(e.relatedTarget,["TD","TH"],n),o=Se(this,hh)||this;r&&r!==i&&Qo(r,n)&&(this.callListener("onCellMouseOut",e,Se(this,an).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Se(this,Cr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Se(this,si)[0]&&n.TD===Se(this,si)[1]?(De(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Se(this,si)[0]=null,Se(this,si)[1]=null):n.TD===Se(this,si)[0]&&(Se(this,si)[1]=n.TD,clearTimeout(Se(this,ms)[1]),Se(this,ms)[1]=setTimeout(()=>{Se(this,si)[1]=null},500)))}onTouchStart(e){Mo(this,Gl,Se(this,va).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=he(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Se(this,Cr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];ty()&&(YI()||GI())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=Se(this,Cr).getSettingPure(e);o&&o(n,r,i,Se(this,Wp).call(this))}destroy(){clearTimeout(Se(this,ms)[0]),clearTimeout(Se(this,ms)[1]),Se(this,Hr).destroy()}};const SP=yj;function Vp(t,e,n){return e=bj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bj(t){var e=Rj(t,"string");return typeof e=="symbol"?e:String(e)}function Rj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ej{constructor(e,n,r){Vp(this,"offset",void 0),Vp(this,"total",void 0),Vp(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Tj=Ej;function Bp(t,e,n){return e=_j(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _j(t){var e=Mj(t,"string");return typeof e=="symbol"?e:String(e)}function Mj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aj{constructor(e,n,r){Bp(this,"offset",void 0),Bp(this,"total",void 0),Bp(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Oj=Aj,Ij=0,ff=1,gf=2;function dh(t,e,n){return e=Pj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pj(t){var e=xj(t,"string");return typeof e=="symbol"?e:String(e)}function xj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g0{constructor(){dh(this,"currentSize",0),dh(this,"nextSize",0),dh(this,"currentOffset",0),dh(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Up(t,e,n){return e=Hj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hj(t){var e=Dj(t,"string");return typeof e=="symbol"?e:String(e)}function Dj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nj{constructor(){Up(this,"size",new g0),Up(this,"workingSpace",Ij),Up(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof g0}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=ff,e.workingSpace=gf,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=gf,e.workingSpace=ff,this.sharedSize=e.getViewSize()}}function Sa(t,e,n){return e=Lj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lj(t){var e=$j(t,"string");return typeof e=="symbol"?e:String(e)}function $j(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yP{constructor(e,n,r){Sa(this,"rootNode",void 0),Sa(this,"nodesPool",void 0),Sa(this,"sizeSet",new Nj),Sa(this,"childNodeType",void 0),Sa(this,"visualIndex",0),Sa(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(ff))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(gf)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(ff);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(gf)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class bP extends yP{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function kj(t,e,n){return e=Fj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fj(t){var e=Wj(t,"string");return typeof e=="symbol"?e:String(e)}function Wj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vj{constructor(e){kj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function zl(t,e,n){return e=Bj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bj(t){var e=Uj(t,"string");return typeof e=="symbol"?e:String(e)}function Uj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xc{constructor(e,n){zl(this,"nodesPool",null),zl(this,"nodeType",void 0),zl(this,"rootNode",void 0),zl(this,"table",null),zl(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Vj(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function m0(t,e,n){return e=Yj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yj(t){var e=Gj(t,"string");return typeof e=="symbol"?e:String(e)}function Gj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zj extends xc{constructor(){super("TH"),m0(this,"orderViews",new WeakMap),m0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new bP(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),ua(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&_e(f,[RY(),PY(),YS(d+1),Al(-1)]),n[d](a,f,d)}u.end()}}}class jj extends xc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ei(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&_e(this.rootNode,[CI()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&_e(s,[cv(),bI(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),ua(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&_e(u,[YS(a+1+this.table.rowHeadersCount),Al(-1),EY(),...a>=0?[IY()]:[cv()]]),r[n](l,u,n)}}}}class Kj extends xc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&J(r,"rowHeader")}}function Xj(t,e,n){return e=qj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qj(t){var e=Zj(t,"string");return typeof e=="symbol"?e:String(e)}function Zj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let p0=!1;class Qj extends xc{constructor(e){super("TR",e),Xj(this,"orderView",void 0),this.orderView=new yP(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!p0&&e>1e3&&(p0=!0,vt(ft`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&_e(this.rootNode,[CI()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;_e(o,[cv(),bI(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function w0(t,e,n){return e=Jj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jj(t){var e=eK(t,"string");return typeof e=="symbol"?e:String(e)}function eK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tK extends xc{constructor(){super("TD"),w0(this,"orderViews",new WeakMap),w0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new bP(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=i.obtainOrderView(u);c.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const p=c.getCurrentNode(),w=this.table.renderedColumnToSource(f);if(De(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),ua(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,w,p),this.table.isAriaEnabled()){var o,s;_e(p,[...p.hasAttribute("role")?[]:[bY()],Al(-1),YS(w+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function ln(t,e,n){return e=nK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nK(t){var e=rK(t,"string");return typeof e=="symbol"?e:String(e)}function rK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iK{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ln(this,"rootNode",void 0),ln(this,"rootDocument",void 0),ln(this,"rowHeaders",null),ln(this,"columnHeaders",null),ln(this,"colGroup",null),ln(this,"rows",null),ln(this,"cells",null),ln(this,"rowFilter",null),ln(this,"columnFilter",null),ln(this,"rowUtils",null),ln(this,"columnUtils",null),ln(this,"rowsToRender",0),ln(this,"columnsToRender",0),ln(this,"rowHeaderFunctions",[]),ln(this,"rowHeadersCount",0),ln(this,"columnHeaderFunctions",[]),ln(this,"columnHeadersCount",0),ln(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class oK{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new iK(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new zj,columnHeaders:new jj(n),colGroup:new Kj(r),rows:new Qj(i),cells:new tK}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Yp(t,e,n){return e=sK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sK(t){var e=aK(t,"string");return typeof e=="symbol"?e:String(e)}function aK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lK{constructor(e,n){Yp(this,"dataAccessObject",void 0),Yp(this,"wtSettings",void 0),Yp(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?on():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let d=Array.isArray(a)?a[c]:a;d=d??u,this.headerWidths.set(c,d)}}}}function C0(t,e,n){return e=uK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:String(e)}function cK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hK{constructor(e,n){C0(this,"dataAccessObject",void 0),C0(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function ai(t,e,n){return e=dK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dK(t){var e=fK(t,"string");return typeof e=="symbol"?e:String(e)}function fK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gK{constructor(e,n,r,i,o){ai(this,"wtSettings",null),ai(this,"domBindings",void 0),ai(this,"TBODY",null),ai(this,"THEAD",null),ai(this,"COLGROUP",null),ai(this,"hasTableHeight",!0),ai(this,"hasTableWidth",!0),ai(this,"isTableVisible",!1),ai(this,"tableOffset",0),ai(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,zS(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new hK(this.dataAccessObject,this.wtSettings),this.columnUtils=new lK(this.dataAccessObject,this.wtSettings),this.tableRenderer=new oK({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&_e(r,[Ti()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&_e(r,[Ti()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&_e(r.parentNode,[Ti()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&_e(r,[Ti()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let d=!1,f=e;if(this.isMaster&&(this.holderOffset=jt(this.holder),f=i.createRenderCalculators(f),l&&!n.getSetting("fixedColumnsStart"))){const w=r.inlineStartOverlay.getScrollPosition(),v=this.correctHeaderWidth;this.correctHeaderWidth=w!==0,v!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(d=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=jt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const w=o>0?this.getFirstRenderedRow():0,v=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Oj(w,o,c),this.columnFilter=new Tj(v,s,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),y=b.skipRender!==!0}if(y){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Ri)||this.is(es))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let b;if(this.isMaster&&(b=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Ri))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const _=dt(this.hider),I=dt(this.TABLE);_!==0&&I!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Ri)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let p=!1;return this.isMaster&&(p=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(p=r.bottomOverlay.resetFixedPosition()||p),p=r.inlineStartOverlay.resetFixedPosition()||p,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),p?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),d&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=oo(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Ri))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=rs(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=_I(r),s=n.cellIndex;return ko(ta,n,this.wtRootElement)||ko(Js,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):ko(es,n,this.wtRootElement)||ko(Ri,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),ko(ta,n,this.wtRootElement)||ko(ea,n,this.wtRootElement)||ko(es,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=oo(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=oo(l):o=oo(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return dt(this.TABLE)}getHeight(){return Pt(this.TABLE)}getTotalWidth(){const e=dt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Pt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return os(this.TABLE)}_modifyRowHeaderWidth(e){let n=wt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Pl=gK,mK="stickyRowsBottom",RP={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Hi(RP,"MIXIN_NAME",mK,{writable:!1,enumerable:!1});const EP=RP,pK="stickyColumnsStart",TP={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Hi(TP,"MIXIN_NAME",pK,{writable:!1,enumerable:!1});const py=TP;class wy extends Pl{constructor(e,n,r,i){super(e,n,r,i,es)}}mt(wy,EP);mt(wy,py);const wK=wy,Js="top",Ri="bottom",ea="inline_start",ta="top_inline_start_corner",es="bottom_inline_start_corner",CK=[Js,Ri,ea,ta,es],vK=new Map([[Js,`ht_clone_${Js}`],[Ri,`ht_clone_${Ri}`],[ea,`ht_clone_${ea} ht_clone_left`],[ta,`ht_clone_${ta} ht_clone_top_left_corner`],[es,`ht_clone_${es} ht_clone_bottom_left_corner`]]);function Gp(t,e,n){return e=SK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SK(t){var e=yK(t,"string");return typeof e=="symbol"?e:String(e)}function yK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bK{constructor(e){Gp(this,"dataAccessObject",void 0),Gp(this,"lastScrolledColumnPos",-1),Gp(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?d=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(d=c.scrollTo(e,l?e>a:n)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=d.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(f=d.scrollTo(e,l?e>a:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=jt(n.wtRootElement),u=oo(n.hider),c=oo(s),d=oc(s,s);if(l.top+u-c<=d){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let p=i;p>0;p--)if(f+=e.sumCellSizes(p-1,p),l.top+u-f<=d){a=p;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=jt(n.wtRootElement),l=oc(o,o);if(a.top>l){const u=oo(o);let c=r.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(c+=e.sumCellSizes(d-1,d),a.top+c-l>=u){s=d-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=jt(n.wtRootElement),l=$u(n.hider),u=$u(o),c=Math.abs(rf(o,o));if(a.left+l-u<=c){let d=r.getRowHeaderWidth();for(let f=i;f>0;f--)if(d+=e.sumCellSizes(f-1,f),a.left+l-d<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const d=r.TABLE.getBoundingClientRect(),p=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(d.right-p)}else u=jt(r.wtRootElement).left;const c=Math.abs(rf(s,s));if(u>c){const d=$u(s);let f=i.getRowHeaderWidth();for(let p=1;p<=o;p++)if(f+=n.sumCellSizes(p-1,p),u+f-c>=d){a=p-2;break}}}return a}}const RK=bK;function Dr(t,e,n){return e=EK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EK(t){var e=TK(t,"string");return typeof e=="symbol"?e:String(e)}function TK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cy{get eventManager(){return new mr(this)}constructor(e,n){Dr(this,"wtTable",void 0),Dr(this,"wtScroll",void 0),Dr(this,"wtViewport",void 0),Dr(this,"wtOverlays",void 0),Dr(this,"selectionManager",void 0),Dr(this,"wtEvent",void 0),Dr(this,"guid",`wt_${WS()}`),Dr(this,"drawInterrupted",!1),Dr(this,"drawn",!1),Dr(this,"domBindings",void 0),Dr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new RK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){is(r,e[n])}])}}createCellCoords(e,n){return new df(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new gy(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function v0(t,e,n){return e=_K(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _K(t){var e=MK(t,"string");return typeof e=="symbol"?e:String(e)}function MK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AK extends Cy{constructor(e,n,r){super(e,n),v0(this,"cloneSource",void 0),v0(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new SP(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function OK(t,e,n){return e=IK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IK(t){var e=PK(t,"string");return typeof e=="symbol"?e:String(e)}function PK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hc{constructor(e,n,r,i,o){OK(this,"wtSettings",null),Hi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Qs(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Qs(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=sc(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){vt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,o,c,u):d=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+on())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(CK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${vK.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&_e(o,[Ti()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Js||u==="vertical"&&this.type===ea?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=sc(e.TABLE),new AK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;T([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class xK extends Hc{constructor(e,n,r,i,o,s){super(e,n,es,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new wK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Ac(n),this.repositionOverlay();let r=Pt(this.clone.wtTable.TABLE);const i=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=on(r)),i.style.bottom=`${o}px`}}const HK="calculatedColumns",_P={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Hi(_P,"MIXIN_NAME",HK,{writable:!1,enumerable:!1});const vy=_P;class Sy extends Pl{constructor(e,n,r,i){super(e,n,r,i,Ri)}}mt(Sy,EP);mt(Sy,vy);const DK=Sy;function NK(t,e,n){return e=LK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LK(t){var e=$K(t,"string");return typeof e=="symbol"?e:String(e)}function $K(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kK extends Hc{constructor(e,n,r,i){super(e,n,Ri,r,i),NK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new DK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=on(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(ag(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=on(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=on(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return oc(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=De(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(J(s,"innerBorderBottom"),o=!a):($e(s,"innerBorderBottom"),o=a)}return o}}const FK="calculatedRows",MP={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Hi(MP,"MIXIN_NAME",FK,{writable:!1,enumerable:!1});const AP=MP;class yy extends Pl{constructor(e,n,r,i){super(e,n,r,i,ea)}}mt(yy,AP);mt(yy,py);const WK=yy,VK="localHooks",OP={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)sf(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Hi(OP,"MIXIN_NAME",VK,{writable:!1,enumerable:!1});const or=OP;let IP=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};mt(IP,or);const BK=IP,PP="active-header",by="header",Ry="area",Ey="focus",UK="fill",YK="row",GK="column",zK="custom-selection",Ty=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var jK=dP;jK("flat");function KK(t,e){xP(t,e),e.add(t)}function S0(t,e,n){xP(t,e),e.set(t,n)}function xP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Gt(t,e){var n=HP(t,e,"get");return XK(t,n)}function XK(t,e){return e.get?e.get.call(t):e.value}function y0(t,e,n){var r=HP(t,e,"set");return qK(t,r,n),n}function HP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Nr=new WeakMap,qn=new WeakMap,fh=new WeakSet;class ZK{constructor(){KK(this,fh),S0(this,Nr,{writable:!0,value:void 0}),S0(this,qn,{writable:!0,value:void 0})}setActiveOverlay(e){return y0(this,qn,e),this}setActiveSelection(e){return y0(this,Nr,e),this}scan(){const e=Gt(this,Nr).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Gt(this,Nr).getCorners(),{wtTable:s}=Gt(this,qn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const d=s.columnFilter.renderedToSource(c);if(!(d<r||d>o)){for(let f=-l;f<0;f++){if(f<n||f>i)continue;const p=f+l;let w=s.getColumnHeader(d,p);const v=Gt(this,qn).getSetting("onBeforeHighlightingColumnHeader",d,p,{selectionType:Gt(this,Nr).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==d&&(w=s.getColumnHeader(v,p)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Gt(this,Nr).getCorners(),{wtTable:s}=Gt(this,qn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const d=s.rowFilter.renderedToSource(c);if(!(d<n||d>i)){for(let f=-l;f<0;f++){if(f<r||f>o)continue;const p=f+l;let w=s.getRowHeader(d,p);const v=Gt(this,qn).getSetting("onBeforeHighlightingRowHeader",d,p,{selectionType:Gt(this,Nr).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==d&&(w=s.getRowHeader(v,p)),e(w))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=Gt(this,Nr).getCorners(),{wtTable:s}=Gt(this,qn);zp(this,fh,jp).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(Gt(this,qn).createCellCoords(a,l)),c=Gt(this,qn).getSetting("onAfterDrawSelection",a,l,Gt(this,Nr).settings.layerLevel);typeof c=="string"&&J(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=Gt(this,Nr).getCorners(),{wtTable:i}=Gt(this,qn);zp(this,fh,jp).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Gt(this,qn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Gt(this,Nr).getCorners(),{wtTable:i}=Gt(this,qn);zp(this,fh,jp).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Gt(this,qn).createCellCoords(o,s));e(a)}})}}function jp(t){const{wtTable:e}=Gt(this,qn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class QK{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Ty,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Pr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),so()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ge(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ge(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:f}=this.selectionHandles.styles,p=parseInt(u.borderWidth,10),w=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();u.top=`${parseInt(r-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const _=Math.min(parseInt(i+o,10),y-w-p*2),I=Math.min(parseInt(i+o-v/4,10),y-v-p*2);d[l]=`${_}px`,f[l]=`${I}px`;const L=Math.min(parseInt(r+s,10),b-w-p*2),x=Math.min(parseInt(r+s-v/4,10),b-v-p*2);d.top=`${L}px`,f.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(d.display="none",f.display="none"):(d.display="block",f.display="block")):(u.display="none",d.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const d=n.getRenderedRowsCount();for(let R=0;R<d;R+=1){const h=n.rowFilter.renderedToSource(R);if(h>=e[0]&&h<=e[2]){o=h,u=e[0];break}}for(let R=d-1;R>=0;R-=1){const h=n.rowFilter.renderedToSource(R);if(h>=e[0]&&h<=e[2]){s=h;break}}const f=n.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const h=n.columnFilter.renderedToSource(R);if(h>=e[1]&&h<=e[3]){a=h,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const h=n.columnFilter.renderedToSource(R);if(h>=e[1]&&h<=e[3]){l=h;break}}if(o===void 0||a===void 0){this.disappear();return}let p=n.getCell(this.wot.createCellCoords(o,a));const w=o!==s||a!==l,v=w?n.getCell(this.wot.createCellCoords(s,l)):p,y=jt(p),b=w?jt(v):y,_=jt(n.TABLE),I=dt(n.TABLE),L=y.top,x=y.left,W=this.wot.wtSettings.getSetting("rtlMode");let G=0,ne=0;if(W){const R=dt(p),h=i.innerWidth-_.left-I;ne=x+R-b.left,G=i.innerWidth-x-R-h-1}else ne=b.left+dt(v)-x,G=x-_.left-1;if(this.isEntireColumnSelected(o,s)){const R=this.getDimensionsFromHeader("columns",a,l,u,_);let h=null;R&&([h,G,ne]=R),h&&(p=h)}let j=L-_.top-1,X=b.top+Pt(v)-L;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",o,s,c,_);let h=null;R&&([h,j,X]=R),h&&(p=h)}const ie=mo(p,i);parseInt(ie.borderTopWidth,10)>0&&(j+=1,X=X>0?X-1:0),parseInt(ie[W?"borderRightWidth":"borderLeftWidth"],10)>0&&(G+=1,ne=ne>0?ne-1:0);const oe=W?"right":"left";this.topStyle.top=`${j}px`,this.topStyle[oe]=`${G}px`,this.topStyle.width=`${ne}px`,this.topStyle.display="block",this.startStyle.top=`${j}px`,this.startStyle[oe]=`${G}px`,this.startStyle.height=`${X}px`,this.startStyle.display="block";const se=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${j+X-se}px`,this.bottomStyle[oe]=`${G}px`,this.bottomStyle.width=`${ne}px`,this.bottomStyle.display="block",this.endStyle.top=`${j}px`,this.endStyle[oe]=`${G+ne-se}px`,this.endStyle.height=`${X+1}px`,this.endStyle.display="block";let ve=this.settings.border.cornerVisible;ve=typeof ve=="function"?ve(this.settings.layerLevel):ve;const Pe=this.wot.getSetting("onModifyGetCellCoords",s,l);let[nt,Ne]=[s,l];if(Pe&&Array.isArray(Pe)&&([,,nt,Ne]=Pe),so()||!ve||this.isPartRange(nt,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top=`${j+X+this.cornerCenterPointOffset-1}px`,this.cornerStyle[oe]=`${G+ne+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=Qs(n.TABLE);const h=R===i;h&&(R=r.documentElement);const g=parseInt(this.cornerDefaultStyle.width,10)/2,m=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const E=h?v.getBoundingClientRect().left:v.offsetLeft;let M=!1,O=0;W?(O=E-parseInt(this.cornerDefaultStyle.width,10)/2,M=O<0):(O=E+dt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,M=O>=$u(R)),M&&(this.cornerStyle[oe]=`${Math.floor(G+ne+this.cornerCenterPointOffset-g)}px`,this.cornerStyle[W?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(h?v.getBoundingClientRect().top:v.offsetTop)+Pt(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=oo(R)&&(this.cornerStyle.top=`${Math.floor(j+X+this.cornerCenterPointOffset-m)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}so()&&this.updateMultipleSelectionHandlesPosition(s,l,j,G,ne,X)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,d=null,f=null,p=null,w=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Pt(...arguments)},c="ht__selection--rows",p="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return dt(...arguments)},c="ht__selection--columns",p="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(w=l(n,y-i),v=l(r,y-i),!w||!v)return!1;const b=jt(w),_=jt(v);return w&&v&&(d=b[p]-o[p]-1,f=_[p]+u(v)-b[p]),[w,d,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?J(this[e],"hidden"):(De(this[e],"hidden")&&$e(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?J(this[e],"hidden"):$e(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",so()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const b0=QK;function JK(t,e){DP(t,e),e.add(t)}function ya(t,e,n){DP(t,e),e.set(t,n)}function DP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e3(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ze(t,e){var n=NP(t,e,"get");return t3(t,n)}function t3(t,e){return e.get?e.get.call(t):e.value}function R0(t,e,n){var r=NP(t,e,"set");return n3(t,r,n),n}function NP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function n3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var bn=new WeakMap,tr=new WeakMap,Kp=new WeakMap,Mu=new WeakMap,Xp=new WeakMap,ps=new WeakMap,E0=new WeakSet;class r3{constructor(e){JK(this,E0),ya(this,bn,{writable:!0,value:void 0}),ya(this,tr,{writable:!0,value:void 0}),ya(this,Kp,{writable:!0,value:new ZK}),ya(this,Mu,{writable:!0,value:new WeakMap}),ya(this,Xp,{writable:!0,value:new WeakSet}),ya(this,ps,{writable:!0,value:new Map}),R0(this,tr,e)}setActiveOverlay(e){return R0(this,bn,e),Ze(this,Kp).setActiveOverlay(Ze(this,bn)),Ze(this,Mu).has(Ze(this,bn))||Ze(this,Mu).set(Ze(this,bn),new Set),this}getFocusSelection(){return Ze(this,tr)!==null?Ze(this,tr).getFocus():null}getAreaSelection(){return Ze(this,tr)!==null?Ze(this,tr).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ze(this,ps).has(e)){const r=Ze(this,ps).get(e);if(r.has(Ze(this,bn)))return r.get(Ze(this,bn));const i=new b0(Ze(this,bn),e.settings);return r.set(Ze(this,bn),i),i}const n=new b0(Ze(this,bn),e.settings);return Ze(this,ps).set(e,new Map([[Ze(this,bn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Ze(this,ps).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Ze(this,ps).get(e).forEach(n=>n.destroy()),Ze(this,ps).delete(e)}render(e){if(Ze(this,tr)===null)return;e&&e3(this,E0,i3).call(this);const n=Array.from(Ze(this,tr)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Ze(this,Xp).has(s)||(Ze(this,Xp).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const d=this.getBorderInstance(s);if(s.isEmpty()){d==null||d.disappear();continue}a&&Ze(this,Kp).setActiveSelection(s).scan().forEach(w=>{if(r.has(w)){const v=r.get(w);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const f=s.getCorners();Ze(this,bn).getSetting("onBeforeDrawBorders",f,c),d==null||d.appear(f)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,d]=u;return d===1?c:[c,...Array.from({length:d-1},(f,p)=>`${c}-${p+1}`)]}).flat();l.forEach(u=>Ze(this,Mu).get(Ze(this,bn)).add(u)),J(s,l),s.nodeName==="TD"&&Array.isArray((a=Ze(this,tr).options)===null||a===void 0?void 0:a.cellAttributes)&&_e(s,Ze(this,tr).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{_e(o,[...i.get(o)])})}}function i3(){const t=Ze(this,Mu).get(Ze(this,bn)),e=Ze(this,bn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Ze(this,bn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Ze(this,tr).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Ze(this,tr).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Ze(this,tr).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Ze(this,tr).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)$e(o[a],n),ua(o[a],s)}),t.clear()}class o3 extends Hc{constructor(e,n,r,i){super(e,n,ea,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new WK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),lg(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Ac(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,jS(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=on(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=dt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(Ty.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=on(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(rf(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?$e(n,"emptyRows"):J(n,"emptyRows");let s=!1;if(i&&!r.length)J(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=De(n,"innerBorderInlineStart");e?(J(n,"innerBorderLeft innerBorderInlineStart"),s=!a):($e(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const s3="stickyRowsTop",LP={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Hi(LP,"MIXIN_NAME",s3,{writable:!1,enumerable:!1});const $P=LP;class _y extends Pl{constructor(e,n,r,i){super(e,n,r,i,ta)}}mt(_y,$P);mt(_y,py);const a3=_y;function T0(t,e,n){return e=l3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l3(t){var e=u3(t,"string");return typeof e=="symbol"?e:String(e)}function u3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c3 extends Hc{constructor(e,n,r,i,o,s){super(e,n,ta,r,i),T0(this,"topOverlay",void 0),T0(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new a3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();lg(e,`${i}px`,`${o}px`)}else Ac(e);let n=Pt(this.clone.wtTable.TABLE);const r=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class My extends Pl{constructor(e,n,r,i){super(e,n,r,i,Js)}}mt(My,$P);mt(My,vy);const h3=My;function d3(t,e,n){return e=f3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f3(t){var e=g3(t,"string");return typeof e=="symbol"?e:String(e)}function g3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m3 extends Hc{constructor(e,n,r,i){super(e,n,Js,r,i),d3(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new h3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),lg(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Ac(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(ag(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=on(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(Ty.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=on(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return oc(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?$e(r,"emptyColumns"):J(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=De(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(J(r,"innerBorderTop"),o=!u):($e(r,"innerBorderTop"),o=u)}}return o}}function Fi(t,e,n){return e=p3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p3(t){var e=w3(t,"string");return typeof e=="symbol"?e:String(e)}function w3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C3{constructor(e,n,r,i,o,s){Fi(this,"wot",null),Fi(this,"topOverlay",null),Fi(this,"bottomOverlay",null),Fi(this,"inlineStartOverlay",null),Fi(this,"topInlineStartCornerOverlay",null),Fi(this,"bottomInlineStartCornerOverlay",null),Fi(this,"browserLineHeight",void 0),Fi(this,"wtSettings",null),Fi(this,"resizeObserver",new ResizeObserver(c=>{pg(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=on(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:sc(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new m3(...e),this.bottomOverlay=new kK(...e),this.inlineStartOverlay=new o3(...e),this.topInlineStartCornerOverlay=new c3(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new xK(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",d=>this.onTableScroll(d),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!JS())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:f}=d.clone.wtTable;this.eventManager.addEventListener(f,"wheel",p=>this.onCloneWheel(p,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Il(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=sc(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:d,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return T(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const v3=C3;function _0(t,e,n){return e=S3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S3(t){var e=y3(t,"string");return typeof e=="symbol"?e:String(e)}function y3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b3{constructor(e){_0(this,"settings",{}),_0(this,"defaults",Object.freeze(this.getDefaults())),Ge(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);is(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ge(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Ay extends Pl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Qs(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Sl(e,"height",n),o=Sl(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const p=parseInt(mo(f,n).height,10);r.removeChild(f),p===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=os(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}mt(Ay,AP);mt(Ay,vy);const R3=Ay;class E3{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Pt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,d=o-c;let f,p;if(a)return dt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(d,o):f=Math.min(this.getContainerFillWidth(),d,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(i!==r&&(p=Sl(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(f,i.clientWidth);const w=e.getSetting("stretchH");return w==="none"||!w?Math.max(f,dt(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return jt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Pt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=dt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ys;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===Ys?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=on(this.domBindings.rootDocument),new mP({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:d=>r.getRowHeight(d),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ys;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=on(this.domBindings.rootDocument)),new hy({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(En),i=this.createColumnsCalculator(En);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Ys),this.columnsRenderCalculator=this.createColumnsCalculator(Ys)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(En),this.columnsVisibleCalculator=this.createColumnsCalculator(En)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ge(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const T3=E3;class _3 extends Cy{constructor(e,n){super(e,new b3(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new R3(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new T3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new r3(this.wtSettings.getSetting("selections")),this.wtEvent=new SP(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new v3(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ge(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),$e(this.wtTable.wtRootElement.parentNode,n),J(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Oy{constructor(e){e instanceof Cy?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new Oy(n);return()=>r},this._wot=new _3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function M0(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!o.inInSelection(i),f=n||r&&d;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function M3(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const A3=new Map([["mousedown",M0],["mouseover",M3],["touchstart",M0]]);function A0(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;A3.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:fg(t)||t.type==="touchstart",isRightClick:ss(t)})}const kP=new WeakMap,Iy=Symbol("rootInstance");function O3(t){kP.set(t,!0)}function I3(t){return t===Iy}function Ad(t){return kP.has(t)}function O0(t,e){FP(t,e),e.add(t)}function ws(t,e,n){FP(t,e),e.set(t,n)}function FP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ao(t,e,n){return e=P3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P3(t){var e=x3(t,"string");return typeof e=="symbol"?e:String(e)}function x3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rv(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function un(t,e){var n=WP(t,e,"get");return H3(t,n)}function H3(t,e){return e.get?e.get.call(t):e.value}function vr(t,e,n){var r=WP(t,e,"set");return D3(t,r,n),n}function WP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function D3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var qp=new WeakMap,gh=new WeakMap,mh=new WeakMap,Wi=new WeakMap,Lr=new WeakMap,Zp=new WeakMap,Qp=new WeakMap,Ev=new WeakSet,I0=new WeakSet;class N3{constructor(e){O0(this,I0),O0(this,Ev),Ao(this,"hot",void 0),Ao(this,"eventManager",void 0),Ao(this,"settings",void 0),Ao(this,"THEAD",void 0),Ao(this,"TBODY",void 0),Ao(this,"_wt",void 0),Ao(this,"activeWt",void 0),ws(this,qp,{writable:!0,value:0}),ws(this,gh,{writable:!0,value:0}),Ao(this,"postponedAdjustElementsSize",!1),ws(this,mh,{writable:!0,value:!1}),ws(this,Wi,{writable:!0,value:void 0}),ws(this,Lr,{writable:!0,value:void 0}),ws(this,Zp,{writable:!0,value:0}),ws(this,Qp,{writable:!0,value:0}),this.hot=e,this.eventManager=new mr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),J(e,"handsontable"),vr(this,Lr,n.createElement("TABLE")),J(un(this,Lr),"htCore"),this.hot.getSettings().tableClassName&&J(un(this,Lr),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(_e(un(this,Lr),[Ti()]),_e(e,[yY(),yI(-1),sg(this.hot.countCols()),DY()])),this.THEAD=n.createElement("THEAD"),un(this,Lr).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),un(this,Lr).appendChild(this.TBODY),this.hot.table=un(this,Lr),this.hot.container.insertBefore(un(this,Lr),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(vr(this,mh,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;hv(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{vr(this,mh,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{un(this,mh)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&hv(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&fg(o)&&r.finish(),vr(this,Wi,!1);const s=ug(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!ss(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&ss(o)&&(r.finish(),vr(this,Wi,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),vr(this,Wi,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(un(this,Wi)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const f=on(n);if(n.elementFromPoint(a+f,l)!==c||n.elementFromPoint(a,l+f)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(un(this,Lr),"selectstart",o=>{this.settings.fragmentSelection||of(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:un(this,Lr),isDataViewInstance:()=>Ad(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),vr(this,gh,o.length),this.hot.getSettings().ariaTags&&Rv(this,Ev,VP).call(this)===this.hot.countCols()&&Rv(this,I0,L3).call(this,un(this,gh)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),vr(this,qp,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let d=l,f=u;Array.isArray(c)&&([d,f]=c);const p=this.hot.getCellMeta(d,f),w=this.hot.colToProp(f);let v=this.hot.getDataAtRowProp(d,w);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,p)),this.hot.runHooks("beforeRenderer",a,l,u,w,v,p),this.hot.getCellRenderer(p)(this.hot,a,l,u,w,v,p),this.hot.runHooks("afterRenderer",a,l,u,w,v,p)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&os(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,vr(this,Wi,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Bo(o)&&(A0(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,f)=>this.hot._createCellCoords(d,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,vr(this,Wi,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Bo(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Bo(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Bo(o)&&(un(this,Wi)&&A0(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,f)=>this.hot._createCellCoords(d,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Bo(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){const p=d.peekByIndex(a??0);l=[p.from.row,p.from.col,p.to.row,p.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,d=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,c,a);if(Array.isArray(f)){const[p,w,v,y]=f;return[p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,1)):p,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,v>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,-1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Oy(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(of(e))return!0;const n=Qo(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return un(this,Wi)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!De(r,"relative")){ei(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;De(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(ei(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(_e(s,...Ti()),_e(a,...Ti())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(De(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):De(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?ca(e,r(n,i)):(is(e,String.fromCharCode(160)),J(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){vr(this,Zp,e),vr(this,Qp,n)}getLastSize(){return{width:un(this,Zp),height:un(this,Qp)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return un(this,qp)}getRowHeadersCount(){return un(this,gh)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function VP(){return parseInt(this.hot.rootElement.getAttribute(sg()[0]),10)}function L3(t){const e=Rv(this,Ev,VP).call(this)+t;_e(this.hot.rootElement,...sg(e))}const $3=N3,BP="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Tv=BP.length;function wg(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%Tv,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/Tv,10);return n}function k3(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Tv**r*(BP.indexOf(t[n])+1);return e-=1,e}function F3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(wg(i)+(r+1));n.push(o)}return n}function W3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=wg(i)+(r+1);n.push(o)}return n}function V3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function Py(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function xy(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ue(t[0])&&(e=dg(t[0]))),e}function UP(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function YP(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const B3=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:xy,createEmptySpreadsheetData:V3,createSpreadsheetData:F3,createSpreadsheetObjectData:W3,dataRowToChangesArray:Py,isArrayOfArrays:UP,isArrayOfObjects:YP,spreadsheetColumnIndex:k3,spreadsheetColumnLabel:wg},Symbol.toStringTag,{value:"Module"}));function jl(t,e,n){return e=U3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U3(t){var e=Y3(t,"string");return typeof e=="symbol"?e:String(e)}function Y3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];jl(this,"hot",void 0),jl(this,"data",void 0),jl(this,"dataType","array"),jl(this,"colToProp",()=>{}),jl(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return T(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):Ce(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Ue(s)||wt(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;Ce(0,u,c=>{const d=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,s);i?a.push(f):Ed(a,d,f)}})}else Ge(s,(l,u)=>{Ed(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Xr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:Ed(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=VI(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=Xr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return Ce(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return xy(this.data)}destroy(){this.data=null,this.hot=null}}const z3=G3;function P0(t,e,n){return e=j3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j3(t){var e=K3(t,"string");return typeof e=="symbol"?e:String(e)}function K3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ha{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;P0(this,"indexedValues",[]),P0(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,wt(this.initValueOrFn)?Ce(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):Ce(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mt(ha,or);function Hy(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>wt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function Dy(t,e){return gr(t,(n,r)=>e.includes(r)===!1)}class cs extends ha{insert(e,n){this.indexedValues=Hy(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=Dy(this.indexedValues,e),super.remove(e)}}class Cg extends cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Yt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function Ny(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function uc(t,e){return gr(t,n=>e.includes(n)===!1)}function Ly(t,e){return Ye(t,n=>n-e.filter(r=>r<n).length)}function $y(t,e){const n=e[0],r=e.length;return Ye(t,i=>i>=n?i+r:i)}function X3(t,e,n){return e=q3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q3(t){var e=Z3(t,"string");return typeof e=="symbol"?e:String(e)}function Z3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vg extends ha{constructor(){super(...arguments),X3(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=uc(this.orderOfIndexes,[e]),wt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=Hy(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=$y(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=Dy(this.indexedValues,e),this.orderOfIndexes=uc(this.orderOfIndexes,e),this.orderOfIndexes=Ly(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Dc extends cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Yt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const x0=new Map([["indexesSequence",{getListWithInsertedItems:Ny,getListWithRemovedItems:uc}],["physicallyIndexed",{getListWithInsertedItems:Hy,getListWithRemovedItems:Dy}]]),GP=t=>{if(x0.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return x0.get(t)};class zP extends ha{constructor(){super(e=>e)}insert(e,n){const r=$y(this.indexedValues,n);this.indexedValues=Ny(r,e,n),super.insert(e,n)}remove(e){const n=uc(this.indexedValues,e);this.indexedValues=Ly(n,e),super.remove(e)}}const H0=new Map([["hiding",Cg],["index",ha],["linkedPhysicalIndexToValue",vg],["physicalIndexToValue",cs],["trimming",Dc]]);function Q3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!H0.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(H0.get(t))(e)}function J3(t,e,n){return e=e4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e4(t){var e=t4(t,"string");return typeof e=="symbol"?e:String(e)}function t4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let _v=0;class ky{constructor(){J3(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),_v+=1)}unregister(e){const n=this.collection.get(e);he(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),_v-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ct(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}mt(ky,or);function n4(){return _v}function Jp(t,e,n){return e=r4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r4(t){var e=i4(t,"string");return typeof e=="symbol"?e:String(e)}function i4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D0 extends ky{constructor(e,n){super(),Jp(this,"mergedValuesCache",[]),Jp(this,"aggregationFunction",void 0),Jp(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ye(this.get(),o=>o.getValues()),r=[],i=he(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ye(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return he(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function o4(t,e,n){s4(t,e),e.set(t,n)}function s4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a4(t,e,n){var r=jP(t,e,"set");return l4(t,r,n),n}function l4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function u4(t,e){var n=jP(t,e,"get");return c4(t,n)}function jP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function c4(t,e){return e.get?e.get.call(t):e.value}var ew=new WeakMap;class KP{constructor(){o4(this,ew,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(u4(this,ew)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){a4(this,ew,e)}}mt(KP,or);function N0(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function Kl(t,e,n){h4(t,e),e.set(t,n)}function h4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sr(t,e){var n=XP(t,e,"get");return d4(t,n)}function d4(t,e){return e.get?e.get.call(t):e.value}function ph(t,e,n){var r=XP(t,e,"set");return f4(t,r,n),n}function XP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function f4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var wh=new WeakMap,Xl=new WeakMap,Ch=new WeakMap,vh=new WeakMap,Sh=new WeakMap;class g4{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Kl(this,wh,{writable:!0,value:new Set}),Kl(this,Xl,{writable:!0,value:[]}),Kl(this,Ch,{writable:!0,value:[]}),Kl(this,vh,{writable:!0,value:!1}),Kl(this,Sh,{writable:!0,value:!1}),ph(this,Sh,e??!1)}createObserver(){const e=new KP;return Sr(this,wh).add(e),e.addLocalHook("unsubscribe",()=>{Sr(this,wh).delete(e)}),e._writeInitialChanges(N0(Sr(this,Xl),Sr(this,Ch))),e}emit(e){let n=Sr(this,Ch);(!Sr(this,vh)||Sr(this,Xl).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Sr(this,Sh)):ph(this,Xl,new Array(e.length).fill(Sr(this,Sh))),Sr(this,vh)||(ph(this,vh,!0),n=Sr(this,Xl)));const r=N0(n,e);Sr(this,wh).forEach(i=>i._write(r)),ph(this,Ch,e)}}function Dn(t,e,n){return e=m4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m4(t){var e=p4(t,"string");return typeof e=="symbol"?e:String(e)}function p4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mv{constructor(){Dn(this,"indexesSequence",new zP),Dn(this,"trimmingMapsCollection",new D0(e=>e.some(n=>n===!0),!1)),Dn(this,"hidingMapsCollection",new D0(e=>e.some(n=>n===!0),!1)),Dn(this,"variousMapsCollection",new ky),Dn(this,"hidingChangesObservable",new g4({initialIndexValue:!1})),Dn(this,"notTrimmedIndexesCache",[]),Dn(this,"notHiddenIndexesCache",[]),Dn(this,"isBatched",!1),Dn(this,"indexesSequenceChanged",!1),Dn(this,"indexesChangeSource",void 0),Dn(this,"trimmedIndexesChanged",!1),Dn(this,"hiddenIndexesChanged",!1),Dn(this,"renderablePhysicalIndexesCache",[]),Dn(this,"fromPhysicalToVisualIndexesCache",new Map),Dn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,Q3(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Dc?this.trimmingMapsCollection.register(e,n):n instanceof Cg?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return he(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return he(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return he(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return he(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ye(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=uc(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(Ny(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=he(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ye(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}mt(Mv,or);function w4(t,e){return Ge(e,(n,r)=>{Ct(t[r])&&(t[r]=n)}),t}function qP(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function ZP(t){he(t)&&iy(ft`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function C4(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:v4,getValues:S4}=ni("phraseFormatters");function y4(t,e){v4(t,e)}function b4(){return S4()}y4("pluralize",C4);const QP="ContextMenu:items",Ve=QP,Sg=`${Ve}.noItems`,yg=`${Ve}.insertRowAbove`,bg=`${Ve}.insertRowBelow`,Rg=`${Ve}.insertColumnOnTheLeft`,Eg=`${Ve}.insertColumnOnTheRight`,Tg=`${Ve}.removeRow`,_g=`${Ve}.removeColumn`,Mg=`${Ve}.undo`,Ag=`${Ve}.redo`,Og=`${Ve}.readOnly`,Ig=`${Ve}.clearColumn`,Pg=`${Ve}.copy`,Fy=`${Ve}.copyWithHeaders`,Wy=`${Ve}.copyWithGroupHeaders`,Vy=`${Ve}.copyHeadersOnly`,xg=`${Ve}.cut`,Hg=`${Ve}.freezeColumn`,Dg=`${Ve}.unfreezeColumn`,Ng=`${Ve}.mergeCells`,Lg=`${Ve}.unmergeCells`,$g=`${Ve}.addComment`,kg=`${Ve}.editComment`,Fg=`${Ve}.removeComment`,Wg=`${Ve}.readOnlyComment`,Vg=`${Ve}.align`,Bg=`${Ve}.align.left`,Ug=`${Ve}.align.center`,Yg=`${Ve}.align.right`,Gg=`${Ve}.align.justify`,zg=`${Ve}.align.top`,jg=`${Ve}.align.middle`,Kg=`${Ve}.align.bottom`,Xg=`${Ve}.borders`,qg=`${Ve}.borders.top`,Zg=`${Ve}.borders.right`,Qg=`${Ve}.borders.bottom`,Jg=`${Ve}.borders.left`,em=`${Ve}.borders.remove`,tm=`${Ve}.nestedHeaders.insertChildRow`,nm=`${Ve}.nestedHeaders.detachFromParent`,rm=`${Ve}.hideColumn`,im=`${Ve}.showColumn`,om=`${Ve}.hideRow`,sm=`${Ve}.showRow`,zn="Filters:",Wt=`${zn}conditions`,Nc=`${Wt}.none`,am=`${Wt}.isEmpty`,lm=`${Wt}.isNotEmpty`,um=`${Wt}.isEqualTo`,cm=`${Wt}.isNotEqualTo`,hm=`${Wt}.beginsWith`,dm=`${Wt}.endsWith`,fm=`${Wt}.contains`,gm=`${Wt}.doesNotContain`,R4=`${Wt}.byValue`,mm=`${Wt}.greaterThan`,pm=`${Wt}.greaterThanOrEqualTo`,wm=`${Wt}.lessThan`,Cm=`${Wt}.lessThanOrEqualTo`,vm=`${Wt}.isBetween`,Sm=`${Wt}.isNotBetween`,ym=`${Wt}.after`,bm=`${Wt}.before`,Rm=`${Wt}.today`,Em=`${Wt}.tomorrow`,Tm=`${Wt}.yesterday`,_m=`${zn}labels.filterByCondition`,Mm=`${zn}labels.filterByValue`,Am=`${zn}labels.conjunction`,Lc=`${zn}labels.disjunction`,cc=`${zn}values.blankCells`,Om=`${zn}buttons.selectAll`,Im=`${zn}buttons.clear`,Pm=`${zn}buttons.ok`,xm=`${zn}buttons.cancel`,Hm=`${zn}buttons.placeholder.search`,Dm=`${zn}buttons.placeholder.value`,Nm=`${zn}buttons.placeholder.secondValue`,By="CheckboxRenderer:",Uy=`${By}checked`,Yy=`${By}unchecked`,E4=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Uy,CHECKBOX_RENDERER_NAMESPACE:By,CHECKBOX_UNCHECKED:Yy,CONTEXTMENU_ITEMS_ADD_COMMENT:$g,CONTEXTMENU_ITEMS_ALIGNMENT:Vg,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Kg,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:Ug,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Gg,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Bg,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:jg,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Yg,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:zg,CONTEXTMENU_ITEMS_BORDERS:Xg,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Qg,CONTEXTMENU_ITEMS_BORDERS_LEFT:Jg,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Zg,CONTEXTMENU_ITEMS_BORDERS_TOP:qg,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Ig,CONTEXTMENU_ITEMS_COPY:Pg,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Vy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Wy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Fy,CONTEXTMENU_ITEMS_CUT:xg,CONTEXTMENU_ITEMS_EDIT_COMMENT:kg,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Hg,CONTEXTMENU_ITEMS_HIDE_COLUMN:rm,CONTEXTMENU_ITEMS_HIDE_ROW:om,CONTEXTMENU_ITEMS_INSERT_LEFT:Rg,CONTEXTMENU_ITEMS_INSERT_RIGHT:Eg,CONTEXTMENU_ITEMS_MERGE_CELLS:Ng,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:nm,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:tm,CONTEXTMENU_ITEMS_NO_ITEMS:Sg,CONTEXTMENU_ITEMS_READ_ONLY:Og,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Wg,CONTEXTMENU_ITEMS_REDO:Ag,CONTEXTMENU_ITEMS_REMOVE_BORDERS:em,CONTEXTMENU_ITEMS_REMOVE_COLUMN:_g,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Fg,CONTEXTMENU_ITEMS_REMOVE_ROW:Tg,CONTEXTMENU_ITEMS_ROW_ABOVE:yg,CONTEXTMENU_ITEMS_ROW_BELOW:bg,CONTEXTMENU_ITEMS_SHOW_COLUMN:im,CONTEXTMENU_ITEMS_SHOW_ROW:sm,CONTEXTMENU_ITEMS_UNDO:Mg,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Dg,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Lg,CONTEXT_MENU_ITEMS_NAMESPACE:QP,FILTERS_BUTTONS_CANCEL:xm,FILTERS_BUTTONS_CLEAR:Im,FILTERS_BUTTONS_OK:Pm,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Hm,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Nm,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Dm,FILTERS_BUTTONS_SELECT_ALL:Om,FILTERS_CONDITIONS_AFTER:ym,FILTERS_CONDITIONS_BEFORE:bm,FILTERS_CONDITIONS_BEGINS_WITH:hm,FILTERS_CONDITIONS_BETWEEN:vm,FILTERS_CONDITIONS_BY_VALUE:R4,FILTERS_CONDITIONS_CONTAINS:fm,FILTERS_CONDITIONS_EMPTY:am,FILTERS_CONDITIONS_ENDS_WITH:dm,FILTERS_CONDITIONS_EQUAL:um,FILTERS_CONDITIONS_GREATER_THAN:mm,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:pm,FILTERS_CONDITIONS_LESS_THAN:wm,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Cm,FILTERS_CONDITIONS_NAMESPACE:Wt,FILTERS_CONDITIONS_NONE:Nc,FILTERS_CONDITIONS_NOT_BETWEEN:Sm,FILTERS_CONDITIONS_NOT_CONTAIN:gm,FILTERS_CONDITIONS_NOT_EMPTY:lm,FILTERS_CONDITIONS_NOT_EQUAL:cm,FILTERS_CONDITIONS_TODAY:Rm,FILTERS_CONDITIONS_TOMORROW:Em,FILTERS_CONDITIONS_YESTERDAY:Tm,FILTERS_DIVS_FILTER_BY_CONDITION:_m,FILTERS_DIVS_FILTER_BY_VALUE:Mm,FILTERS_LABELS_CONJUNCTION:Am,FILTERS_LABELS_DISJUNCTION:Lc,FILTERS_NAMESPACE:zn,FILTERS_VALUES_BLANK_CELLS:cc},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const T4={languageCode:"en-US",[Sg]:"No available options",[yg]:"Insert row above",[bg]:"Insert row below",[Rg]:"Insert column left",[Eg]:"Insert column right",[Tg]:["Remove row","Remove rows"],[_g]:["Remove column","Remove columns"],[Mg]:"Undo",[Ag]:"Redo",[Og]:"Read only",[Ig]:"Clear column",[Vg]:"Alignment",[Bg]:"Left",[Ug]:"Center",[Yg]:"Right",[Gg]:"Justify",[zg]:"Top",[jg]:"Middle",[Kg]:"Bottom",[Hg]:"Freeze column",[Dg]:"Unfreeze column",[Xg]:"Borders",[qg]:"Top",[Zg]:"Right",[Qg]:"Bottom",[Jg]:"Left",[em]:"Remove border(s)",[$g]:"Add comment",[kg]:"Edit comment",[Fg]:"Delete comment",[Wg]:"Read-only comment",[Ng]:"Merge cells",[Lg]:"Unmerge cells",[Pg]:"Copy",[Fy]:["Copy with header","Copy with headers"],[Wy]:["Copy with group header","Copy with group headers"],[Vy]:["Copy header only","Copy headers only"],[xg]:"Cut",[tm]:"Insert child row",[nm]:"Detach from parent",[rm]:["Hide column","Hide columns"],[im]:["Show column","Show columns"],[om]:["Hide row","Hide rows"],[sm]:["Show row","Show rows"],[Nc]:"None",[am]:"Is empty",[lm]:"Is not empty",[um]:"Is equal to",[cm]:"Is not equal to",[hm]:"Begins with",[dm]:"Ends with",[fm]:"Contains",[gm]:"Does not contain",[mm]:"Greater than",[pm]:"Greater than or equal to",[wm]:"Less than",[Cm]:"Less than or equal to",[vm]:"Is between",[Sm]:"Is not between",[ym]:"After",[bm]:"Before",[Rm]:"Today",[Em]:"Tomorrow",[Tm]:"Yesterday",[cc]:"Blank cells",[_m]:"Filter by condition",[Mm]:"Filter by value",[Am]:"And",[Lc]:"Or",[Om]:"Select all",[Im]:"Clear",[Pm]:"OK",[xm]:"Cancel",[Hm]:"Search",[Dm]:"Value",[Nm]:"Second value",[Uy]:"Checked",[Yy]:"Unchecked"},JP=T4,_4=E4,Av=JP.languageCode,{register:M4,getItem:ex,hasItem:A4,getValues:O4}=ni("languagesDictionaries");Gy(JP);function Gy(t,e){let n=t,r=e;return Ue(t)&&(r=t,n=r.languageCode),I4(n,r),M4(n,An(r)),An(r)}function I4(t,e){t!==Av&&w4(e,ex(Av))}function tx(t){return zy(t)?An(ex(t)):null}function zy(t){return A4(t)}function P4(){return O4()}function nx(t,e,n){const r=tx(t);if(r===null)return null;const i=r[e];if(Ct(i))return null;const o=x4(i,n);return Array.isArray(o)?o[0]:o}function x4(t,e){let n=t;return T(b4(),r=>{n=r(t,e)}),n}function H4(t){let e=qP(t);return zy(e)||(e=Av,ZP(t)),e}function D4(t,e,n){return e=N4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N4(t){var e=L4(t,"string");return typeof e=="symbol"?e:String(e)}function L4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $4 extends BK{constructor(e,n){super(e,null),D4(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Eo=$4;function tw(t){let{activeHeaderClassName:e,...n}=t;return new Eo({className:e,...n,selectionType:PP})}function k4(t){let{areaCornerVisible:e,...n}=t;return new Eo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:Ry})}function F4(t){let{...e}=t;return new Eo({className:"highlight",...e,selectionType:Ry})}function W4(t){let{columnClassName:e,...n}=t;return new Eo({className:e,...n,selectionType:GK})}function V4(t){let{cellCornerVisible:e,...n}=t;return new Eo({className:"current",headerAttributes:[GS()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:Ey})}function B4(t){let{border:e,visualCellRange:n,...r}=t;return new Eo({...e,...r,selectionType:zK},n)}function U4(t){let{...e}=t;return new Eo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:UK})}function L0(t){let{headerClassName:e,...n}=t;return new Eo({className:e,...n,selectionType:by})}function Y4(t){let{rowClassName:e,...n}=t;return new Eo({className:e,...n,selectionType:YK})}let rx;function G4(t,e){z4(t,e),e.add(t)}function z4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kn(t,e,n){return e=j4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j4(t){var e=K4(t,"string");return typeof e=="symbol"?e:String(e)}function K4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var li=new WeakSet;rx=Symbol.iterator;class X4{constructor(e){G4(this,li),Kn(this,"options",void 0),Kn(this,"layerLevel",0),Kn(this,"focus",void 0),Kn(this,"fill",void 0),Kn(this,"layeredAreas",new Map),Kn(this,"areas",new Map),Kn(this,"rowHeaders",new Map),Kn(this,"columnHeaders",new Map),Kn(this,"activeRowHeaders",new Map),Kn(this,"activeColumnHeaders",new Map),Kn(this,"activeCornerHeaders",new Map),Kn(this,"rowHighlights",new Map),Kn(this,"columnHighlights",new Map),Kn(this,"customSelections",[]),this.options=e,this.focus=V4(e),this.fill=U4(e)}isEnabledFor(e,n){let r=e;e===Ey&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Vi(this,li,Bi).call(this,this.layeredAreas,k4)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Vi(this,li,Bi).call(this,this.areas,F4)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Vi(this,li,Bi).call(this,this.rowHeaders,L0)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Vi(this,li,Bi).call(this,this.columnHeaders,L0)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Vi(this,li,Bi).call(this,this.activeRowHeaders,tw)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Vi(this,li,Bi).call(this,this.activeColumnHeaders,tw)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Vi(this,li,Bi).call(this,this.activeCornerHeaders,tw)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Vi(this,li,Bi).call(this,this.rowHighlights,Y4)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Vi(this,li,Bi).call(this,this.columnHighlights,W4)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(B4({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),T(this.areas.values(),e=>void e.clear()),T(this.layeredAreas.values(),e=>void e.clear()),T(this.rowHeaders.values(),e=>void e.clear()),T(this.columnHeaders.values(),e=>void e.clear()),T(this.activeRowHeaders.values(),e=>void e.clear()),T(this.activeColumnHeaders.values(),e=>void e.clear()),T(this.activeCornerHeaders.values(),e=>void e.clear()),T(this.rowHighlights.values(),e=>void e.clear()),T(this.columnHighlights.values(),e=>void e.clear())}[rx](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Bi(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const q4=X4;let ix;function $0(t,e,n){return e=Z4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z4(t){var e=Q4(t,"string");return typeof e=="symbol"?e:String(e)}function Q4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ix=Symbol.iterator;class J4{constructor(e){$0(this,"ranges",[]),$0(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[ix](){return this.ranges[Symbol.iterator]()}}const e6=J4;function ql(t,e){ox(t,e),e.add(t)}function nw(t,e,n){ox(t,e),e.set(t,n)}function ox(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function et(t,e){var n=sx(t,e,"get");return t6(t,n)}function t6(t,e){return e.get?e.get.call(t):e.value}function Zn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ov(t,e,n){var r=sx(t,e,"set");return n6(t,r,n),n}function sx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function n6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var yh=new WeakMap,st=new WeakMap,as=new WeakMap,rw=new WeakSet,iw=new WeakSet,Iv=new WeakSet,ow=new WeakSet,Cs=new WeakSet;class ax{constructor(e,n){ql(this,Cs),ql(this,ow),ql(this,Iv),ql(this,iw),ql(this,rw),nw(this,yh,{writable:!0,value:void 0}),nw(this,st,{writable:!0,value:void 0}),nw(this,as,{writable:!0,value:{x:0,y:0}}),Ov(this,yh,e),Ov(this,st,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Zn(this,rw,k0).call(this,{x:et(this,st).navigableHeaders()?et(this,st).countRowHeaders():0,y:et(this,st).navigableHeaders()?et(this,st).countColHeaders():0});const i=et(this,st).createCellCoords(e,n);let o=et(this,yh).current().highlight;const s=et(this,st).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Zn(this,Iv,lx).call(this),{row:d,col:f}=Zn(this,ow,W0).call(this,o),p=et(this,st).fixedRowsBottom(),w=et(this,st).minSpareRows(),v=et(this,st).minSpareCols(),y=et(this,st).autoWrapRow(),b=et(this,st).autoWrapCol(),_=et(this,st).createCellCoords(d+i.row,f+i.col);if(_.row>=c){const x=Xr(r&&w>0&&p===0),W=_.col+1,G=et(this,st).createCellCoords(_.row-c,W>=u?W-u:W);this.runLocalHooks("beforeColumnWrap",x,Zn(this,Cs,ba).call(this,G),W>=u),x.value?this.runLocalHooks("insertRowRequire",et(this,st).countRenderableRows()):b&&_.assign(G)}else if(_.row<0){const x=Xr(b),W=_.col-1,G=et(this,st).createCellCoords(c+_.row,W<0?u+W:W);this.runLocalHooks("beforeColumnWrap",x,Zn(this,Cs,ba).call(this,G),W<0),b&&_.assign(G)}if(_.col>=u){const x=Xr(r&&v>0),W=_.row+1,G=et(this,st).createCellCoords(W>=c?W-c:W,_.col-u);this.runLocalHooks("beforeRowWrap",x,Zn(this,Cs,ba).call(this,G),W>=c),x.value?this.runLocalHooks("insertColRequire",et(this,st).countRenderableColumns()):y&&_.assign(G)}else if(_.col<0){const x=Xr(y),W=_.row-1,G=et(this,st).createCellCoords(W<0?c+W:W,u+_.col);this.runLocalHooks("beforeRowWrap",x,Zn(this,Cs,ba).call(this,G),W<0),y&&_.assign(G)}const{rowDir:I,colDir:L}=Zn(this,iw,F0).call(this,_);a=I,l=L,o=Zn(this,Cs,ba).call(this,_)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Zn(this,rw,k0).call(this,{x:et(this,st).navigableHeaders()?et(this,st).countRowHeaders():0,y:et(this,st).navigableHeaders()?et(this,st).countColHeaders():0});const r=et(this,st).createCellCoords(e,n),i=et(this,yh).current(),o=et(this,st).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Zn(this,ow,W0).call(this,i.to),d=et(this,st).createCellCoords(u+r.row,c+r.col),{rowDir:f,colDir:p}=Zn(this,iw,F0).call(this,d);a=f,l=p;const w=Zn(this,Cs,ba).call(this,d);r.row===0&&r.col!==0?s.col=w.col:r.row!==0&&r.col===0?s.row=w.row:(s.row=w.row,s.col=w.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function k0(t){let{x:e,y:n}=t;Ov(this,as,{x:e,y:n})}function F0(t){const{width:e,height:n}=Zn(this,Iv,lx).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function lx(){return{width:et(this,as).x+et(this,st).countRenderableColumns(),height:et(this,as).y+et(this,st).countRenderableRows()}}function W0(t){const{row:e,col:n}=et(this,st).visualToRenderableCoords(t);return et(this,st).createCellCoords(et(this,as).y+e,et(this,as).x+n)}function ba(t){const e=t.clone();return e.col=t.col-et(this,as).x,e.row=t.row-et(this,as).y,et(this,st).renderableToVisualCoords(e)}mt(ax,or);const r6=ax,Lm=0,$m=1,ux=2,jy=3,i6=[jy,ux],o6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],sw=Symbol("root"),V0=Symbol("child");function bl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:sw;if(e!==sw&&e!==V0)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===sw;let i=Lm;if(n){const o=t[0];t.length===0?i=$m:r&&o instanceof gy?i=jy:r&&Array.isArray(o)?i=bl(o,V0):t.length>=2&&t.length<=4&&!t.some((a,l)=>!o6[l].includes(typeof a))&&(i=ux)}return i}function hc(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!i6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===jy;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ct(u)&&(u=a),Ct(c)&&(c=l),!r){const p=a,w=l,v=u,y=c;a=Math.min(p,v),l=Math.min(w,y),u=Math.max(p,v),c=Math.max(w,y)}const d=e(a,l),f=e(u,c);return n(d,d,f)}}function s6(t){const e=bl(t.getSelected());if(e===Lm||e===$m)return[];const n=hc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;T(Array.from(new Array(c),(d,f)=>u+f),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return Yt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function a6(t){const e=bl(t.getSelected());if(e===Lm||e===$m)return[];const n=hc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;T(Array.from(new Array(c),(d,f)=>u+f),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return Yt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function l6(t,e,n){u6(t,e),e.set(t,n)}function u6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oo(t,e,n){return e=c6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c6(t){var e=h6(t,"string");return typeof e=="symbol"?e:String(e)}function h6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B0(t,e,n){var r=cx(t,e,"set");return d6(t,r,n),n}function d6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function U0(t,e){var n=cx(t,e,"get");return f6(t,n)}function cx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function f6(t,e){return e.get?e.get.call(t):e.value}var Zl=new WeakMap;class hx{constructor(e,n){var r=this;Oo(this,"settings",void 0),Oo(this,"tableProps",void 0),Oo(this,"inProgress",!1),Oo(this,"selectedRange",new e6((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Oo(this,"highlight",void 0),Oo(this,"transformation",void 0),Oo(this,"selectedByRowHeader",new Set),Oo(this,"selectedByColumnHeader",new Set),l6(this,Zl,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new q4({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[GS()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new r6(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ct(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ct(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(Ey,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(T(this.highlight.getAreas(),_=>void _.clear()),T(this.highlight.getLayeredAreas(),_=>void _.clear()),T(this.highlight.getRowHeaders(),_=>void _.clear()),T(this.highlight.getColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveRowHeaders(),_=>void _.clear()),T(this.highlight.getActiveColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveCornerHeaders(),_=>void _.clear()),T(this.highlight.getRowHighlights(),_=>void _.clear()),T(this.highlight.getColumnHighlights(),_=>void _.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),p=this.highlight.createActiveRowHeader(),w=this.highlight.createActiveColumnHeader(),v=this.highlight.createActiveCornerHeader(),y=this.highlight.createRowHighlight(),b=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),d.clear(),f.clear(),p.clear(),w.clear(),v.clear(),y.clear(),b.clear(),this.highlight.isEnabledFor(Ry,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const _=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(_.from).commit().syncWith(_),this.highlight.createLayeredArea().add(_.from).commit().syncWith(_),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(by,s.highlight)){if(!s.isSingleHeader()){const L=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),x=this.tableProps.createCellCoords(s.to.row,-1),W=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),G=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(d.add(L).commit(),f.add(W).commit(),y.add(L).commit(),b.add(W).commit()):(d.add(L).add(x).commit(),f.add(W).add(G).commit(),y.add(L).add(x).commit(),b.add(W).add(G).commit())}const _=!U0(this,Zl)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),I=!U0(this,Zl)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());_&&p.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),I&&w.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),_&&I&&v.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Xr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:p}=i;B0(this,Zl,p),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(d=this.tableProps.createCellCoords(ir(f.row,u,o-1),ir(f.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,d),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),B0(this,Zl,!1)}selectCells(e){var n=this;const r=bl(e);if(r===$m)return!1;if(r===Lm)throw new Error(ft`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=hc(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),T(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const p=l===0?0:ir(r,u,-1),w=s-1,v=this.tableProps.createCellCoords(p,i),y=this.tableProps.createCellCoords(w,o),b=this.tableProps.createCellCoords(ir(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",v,y,b),v.row=p,y.row=w,this.setRangeStartOnly(v,void 0,b),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectColumns",v,y,b),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const d=s===0?0:ir(r,a,-1),f=o-1,p=this.tableProps.createCellCoords(e,d),w=this.tableProps.createCellCoords(n,f),v=this.tableProps.createCellCoords(e,ir(r,a,o-1));this.runLocalHooks("beforeSelectRows",p,w,v),p.col=d,w.col=f,this.setRangeStartOnly(p,void 0,v),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",p,w,v),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),f.commit(),p.commit()}this.highlight.useLayerLevel(r)}}mt(hx,or);const g6=hx,Y0=/^(\r\n|\n\r|\r|\n)/,m6=/^[^\t\r\n]+/,G0=/^\t/;function p6(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(G0))t=t.replace(G0,""),n+=1,e[r][n]="";else if(t.match(Y0))t=t.replace(Y0,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(m6);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function ku(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function vs(t,e,n){return e=w6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w6(t){var e=C6(t,"string");return typeof e=="symbol"?e:String(e)}function C6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cl{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){vs(this,"hot",void 0),vs(this,"metaManager",void 0),vs(this,"tableMeta",void 0),vs(this,"dataSource",void 0),vs(this,"duckSchema",void 0),vs(this,"colToPropCache",void 0),vs(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=dg(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Ue(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return xy(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ge(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&he(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(he(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?yl(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;a<n&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=An(this.getSchema()):(w=[],Ce(d-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},Ic(w,this.getSchema())),f.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const p=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",p,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let f=this.hot.countCols(),p=0,w=c;i==="end"&&(w=Math.min(w+1,a));const v=w;for(;p<n&&f<s;){if(typeof l!="number"||l>=f)if(d>0)for(let b=0;b<d;b+=1)typeof o[b]>"u"&&(o[b]=[]),o[b].push(null);else o.push([null]);else for(let b=0;b<d;b++)o[b].splice(w,0,null);p+=1,w+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,p),p>0&&(e==null?this.metaManager.createColumn(null,p):r!=="auto"&&this.metaManager.createColumn(v,n));const y=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",y,p,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=he(this.tableMeta.columns)||he(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((d,f)=>f-d);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let d=0;d<u;d++)l&&o[0]!==o[d]-d&&(l=!1);if(l)for(let d=0,f=this.hot.countSourceRows();d<f;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(let d=0,f=this.hot.countSourceRows();d<f;d++)for(let p=0;p<u;p++)c[d].splice(s[p],1),d===0&&this.metaManager.removeColumn(s[p],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];ov(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return fI(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];ov(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&It(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=Xr(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=Xr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&It(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,d;for(c=0,d=l.length-1;c<d;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,cl.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===cl.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=d;o++){a=[];const p=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=f&&p!==null;s++)a.push(c.call(this,o,this.colToProp(s)));p!==null&&i.push(a)}return i}getText(e,n){return ku(this.getRange(e,n,cl.DESTINATION_RENDERER))}getCopyableText(e,n){return ku(this.getRange(e,n,cl.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const v6=cl,{register:S6,getItem:y6,hasItem:dx,getNames:b6,getValues:Hae}=ni("cellTypes");function Ky(t){if(!dx(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return y6(t)}function Rn(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&er(t,n),r&&Ci(t,r),i&&ul(t,i),S6(t,e)}function R6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!It(e,t)}function km(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Ky(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ge(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ue(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ge(r,(o,s)=>{if(R6(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Kt(t,i)}function E6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}bo(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Od(t){return Number.isInteger(t)&&t>=0}function Id(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function bh(t){return t==null}const fx=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),en(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),en(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),hg(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function z0(t,e,n){return e=T6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T6(t){var e=_6(t,"string");return typeof e=="symbol"?e:String(e)}function _6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function M6(){return class{}}class A6{constructor(e){z0(this,"metaCtor",M6()),z0(this,"meta",void 0),this.meta=this.metaCtor.prototype,Kt(this.meta,fx()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Kt(this.meta,e),km(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function O6(t,e,n){return e=I6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I6(t){var e=P6(t,"string");return typeof e=="symbol"?e:String(e)}function P6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x6{constructor(e){O6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Kt(this.meta,e),km(this.meta,e,e)}}let gx;function Rh(t,e,n){return e=H6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H6(t){var e=D6(t,"string");return typeof e=="symbol"?e:String(e)}function D6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}gx=Symbol.iterator;class mf{constructor(e){Rh(this,"valueFactory",void 0),Rh(this,"data",[]),Rh(this,"index",[]),Rh(this,"holes",new Set),this.valueFactory=e}obtain(e){Id(()=>Od(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Id(()=>Od(e)||bh(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=bh(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Id(()=>Od(e)||bh(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(bh(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return gr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[gx](){return this.entries()}}function j0(t,e,n){return e=N6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N6(t){var e=L6(t,"string");return typeof e=="symbol"?e:String(e)}function L6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $6=["data","width"];class k6{constructor(e){j0(this,"globalMeta",void 0),j0(this,"metas",new mf(()=>this._createMeta())),this.globalMeta=e,this.metas=new mf(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Kt(r,n),km(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return E6(this.globalMeta.getMetaConstructor(),$6).prototype}}function K0(t,e,n){return e=F6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F6(t){var e=W6(t,"string");return typeof e=="symbol"?e:String(e)}function W6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V6{constructor(e){K0(this,"columnMeta",void 0),K0(this,"metas",new mf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Kt(i,r),km(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){Id(()=>Od(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new mf(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class mx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new A6(e),this.tableMeta=new x6(this.globalMeta),this.columnMeta=new k6(this.globalMeta),this.cellMeta=new V6(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mt(mx,or);function X0(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,d=Mn(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":wt(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${d}`,t,c,l);const p=new v6(i,t,u);if(e(p),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=p.getSchema();t=[];let v,y=0,b=0;for(y=0,b=f.startRows;y<b;y++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)v=An(w),t.push(v);else if(i.dataType==="array")v=An(w[0]),t.push(v);else{v=[];for(let _=0,I=f.startCols;_<I;_++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,p.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),n(p),i.runHooks(`after${d}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&_e(i.rootElement,[yI(-1),sg(i.countCols()+(i.view?i.countRowHeaders():0))])}function q0(t,e,n){return e=B6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B6(t){var e=U6(t,"string");return typeof e=="symbol"?e:String(e)}function U6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y6{constructor(e){q0(this,"metaManager",void 0),q0(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),ge.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=It(e,"type")?e.type:null;let c=wt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var d;c.type=(d=c.type)!==null&&d!==void 0?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function aw(t,e,n){return e=G6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G6(t){var e=z6(t,"string");return typeof e=="symbol"?e:String(e)}function z6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j6{constructor(e){aw(this,"metaManager",void 0),aw(this,"usageTracker",new Set),aw(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const px="gridDefault",Xy="editorManager.handlingEditor",K6={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},X6={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},q6={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Z6={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Pr(e))}};function Q6(){return[K6,X6,q6,Z6]}const J6={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},e9={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},t9={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},n9={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},r9={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},i9={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},o9={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},s9={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},a9={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},l9={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},u9={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},c9={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},h9={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},d9={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function f9(){return[J6,e9,t9,n9,r9,i9,o9,s9,a9,l9,u9,c9,h9,d9]}const g9={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},m9={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},p9={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},w9={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},C9={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},v9={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},S9={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},y9={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},b9={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},R9={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},E9={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},T9={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},_9={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},M9={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},A9={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},O9={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function I9(){return[g9,m9,p9,w9,C9,v9,S9,y9,b9,R9,E9,T9,_9,M9,A9,O9]}const P9={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},x9={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},H9={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},D9={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},N9={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},L9=[...Q6(),...f9(),...I9(),P9,x9,H9,D9,N9];function wx(t){const e={};return L9.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function $9(t){const e=t.getShortcutManager().addContext("editor"),n=wx(t),r={group:Xy};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function k9(t){const e=t.getShortcutManager().addContext("grid"),n=wx(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return he(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:px};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Xy,runOnlyIf:()=>he(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function F9(t){[$9,k9].forEach(e=>e(t))}function W9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=Z0(t),i=Z0(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function Z0(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&_e(n,[Ti(),yo()]),n}function V9(t){let e;const{activate:n,deactivate:r}=W9(t,{onFocusFromTop(){var u;const c=(u=e)!==null&&u!==void 0?u:Q0(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_above",c),t.selectCell(c.row,c.col)),t.listen()},onFocusFromBottom(){var u;const c=(u=e)!==null&&u!==void 0?u:J0(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_below",c),t.selectCell(c.row,c.col)),t.listen()}}),i={wrapped:!1,flipped:!1};let o=!0,s=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(u,c,d,f,p)=>{if(s&&i.wrapped&&i.flipped&&(p.value=!0),o){var w;e=(w=t.getSelectedRangeLast())===null||w===void 0?void 0:w.highlight}}),t.addHook("beforeRowWrap",(u,c,d)=>{i.wrapped=!0,i.flipped=d});function a(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}const l={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:px,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...l,callback:()=>{s=!0,t.getSelectedRangeLast()&&!t.getSettings().tabNavigation&&(o=!1)},position:"before"},{...l,callback:u=>{const{tabNavigation:c,autoWrapRow:d}=t.getSettings();if(s=!1,o=!0,!c||!t.selection.isSelected()||d&&i.wrapped&&i.flipped||!d&&i.wrapped)return d&&i.wrapped&&i.flipped&&(e=u.shiftKey?Q0(t):J0(t)),a(),!1;u.preventDefault()},position:"after"}])}function Q0(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function J0(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const eE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Eh=t=>t.map(e=>{const n=e.toLowerCase();return eE.has(n)?eE.get(n):n}).sort().join("+"),B9=t=>t.split("+"),tE=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),U9=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),lw=t=>{let{key:e,code:n}=t,r=e;return tE.test(n)?r=n.replace(tE,"$1"):U9.has(n)&&(r=n),r.toLowerCase()},Cx=Symbol("shortcut-context");function vx(t){return Ue(t)&&t.__kindOf===Cx}const Y9=t=>{const e=mg({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:p=!0,stopPropagation:w=!1,relativeToGroup:v,position:y,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ct(c))throw new Error("You need to define the shortcut's group.");if(wt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ft`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:u,group:c,runOnlyIf:d,captureCtrl:f,preventDefault:p,stopPropagation:w};he(v)&&([_.relativeToGroup,_.position]=[v,y]),vx(b)&&(_.forwardToContext=b),l.forEach(I=>{const L=Eh(I);if(e.hasItem(L)){const W=e.getItem(L);let G=W.findIndex(ne=>ne.group===v);G!==-1?y==="before"?G-=1:G+=1:G=W.length,W.splice(G,0,_)}else e.addItem(L,[_])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ge(u,(d,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},i=l=>{const u=Eh(l);e.removeItem(u)};return{__kindOf:Cx,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Eh(l),c=e.getItem(u);return he(c)?c.slice():[]},hasShortcut:l=>{const u=Eh(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[d,f]=c;const p=f.filter(w=>w.group!==l);p.length===0?i(B9(d)):(f.length=0,f.push(...p))})}}};function G9(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const z9=["meta","alt","shift","control"],Ql=G9();let Th=0;function j9(t,e,n,r,i){const o=p=>z9.includes(p),s=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return p.altKey&&v.push("alt"),w&&(p.ctrlKey||p.metaKey)?v.push("control/meta"):(p.ctrlKey&&v.push("control"),p.metaKey&&v.push("meta")),p.shiftKey&&v.push("shift"),v},a=p=>{if(e(p)===!1)return;const w=n(p);if(p.keyCode===229||w===!1||Bo(p))return;const v=lw(p);let y=[];o(v)||(y=s(p));const b=[v].concat(y);!i(p,b)&&(ac()&&y.includes("meta")||!ac()&&y.includes("control"))&&i(p,[v].concat(s(p,!0))),r(p)},l=p=>{const w=lw(p);o(w)&&Ql.press(w)},u=p=>{const w=lw(p);o(w)&&Ql.release(w)},c=()=>{Ql.releaseAll()};return{mount:()=>{let p=t;for(Th+=1;p;)Th===1&&(p.document.documentElement.addEventListener("keydown",l),p.document.documentElement.addEventListener("keyup",u)),p.document.documentElement.addEventListener("keydown",a),p.document.documentElement.addEventListener("blur",c),p=ic(p)},unmount:()=>{let p=t;for(Th-=1;p;)Th===0&&(p.document.documentElement.removeEventListener("keydown",l),p.document.documentElement.removeEventListener("keyup",u)),p.document.documentElement.removeEventListener("keydown",a),p.document.documentElement.removeEventListener("blur",c),p=ic(p)},isPressed:p=>Ql.isPressed(p),releasePressedKeys:()=>Ql.releaseAll()}}const K9=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=mg({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const v=Y9(w);return o.addItem(w,v),v},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(ft`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let d=!1;const f=function(w,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=vx(y)?y:u(y);let _=!1;if(!b.hasShortcut(v))return _;const I=b.getShortcuts(v);for(let L=0;L<I.length;L++){const{callback:x,runOnlyIf:W,preventDefault:G,stopPropagation:ne,captureCtrl:j,forwardToContext:X}=I[L];if(W(w)===!0){if(d=j,_=x(w,v)===!1,d=!1,G&&w.preventDefault(),ne&&(Pr(w),w.stopPropagation()),_)break;X&&f(w,v,X)}}return _},p=j9(e,n,r,i,f);return p.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!d&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}};let uw=null;const cw=new Map;function Sx(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new mr(s);let l,u,c,d,f,p=!0;I3(i)&&O3(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=H4(e.language);const y=new mx(s,e,[Y6,j6]),b=y.getTableMeta(),_=y.getGlobalMeta(),I=mg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Ad(this)&&wI(e.licenseKey,t),this.guid=`ht_${WS()}`,cw.set(this.guid,this),this.columnIndexMapper=new Mv,this.rowIndexMapper=new Mv,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterRowSequenceChange",h)}),u=new z3(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const L=h=>{const{row:g,col:m}=h;return s._createCellCoords(g>=0?s.rowIndexMapper.getRenderableFromVisualIndex(g):g,m>=0?s.columnIndexMapper.getRenderableFromVisualIndex(m):m)},x=h=>{const{row:g,col:m}=h;return s._createCellCoords(g>=0?s.rowIndexMapper.getVisualFromRenderableIndex(g):g,m>=0?s.columnIndexMapper.getVisualFromRenderableIndex(m):m)};let W=new g6(b,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:h=>l.propToCol(h),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(h,g)=>s._createCellCoords(h,g),createCellRange:(h,g,m)=>s._createCellRange(h,g,m),visualToRenderableCoords:L,renderableToVisualCoords:x,isDisabledCellSelection:(h,g)=>h<0||g<0?s.getSettings().disableVisualSelection:s.getCellMeta(h,g).disableVisualSelection});this.selection=W;const G=h=>{let{hiddenIndexesChanged:g}=h;g&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",h=>{const g=Xr(!1),m=this.selection.getSelectedRange(),{from:E,to:M}=m.current(),O=m.size()-1;this.runHooks("afterSelection",E.row,E.col,M.row,M.col,g,O),this.runHooks("afterSelectionByProp",E.row,s.colToProp(E.col),M.row,s.colToProp(M.col),g,O);let Y=!0;o&&(Y=!1),g.isTouched()&&(Y=!g.value);const B=this.selection.selectedRange.current(),q=this.selection.isSelectedByAnyHeader(),Q=this.selection.isSelectedByRowHeader(),K=this.selection.isSelectedByColumnHeader();if(Y!==!1)if(q)Q?this.scrollViewportTo({row:h.row}):K&&this.scrollViewportTo({col:h.col});else if(B&&!this.selection.isMultiple()){const{row:de,col:Ae}=B.from;de<0&&Ae>=0?this.scrollViewportTo({col:Ae}):Ae<0&&de>=0?this.scrollViewportTo({row:de}):this.scrollViewportTo({row:de,col:Ae})}else this.scrollViewportTo(h.toObject());Q&&K?J(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Q?($e(this.rootElement,"ht__selection--columns"),J(this.rootElement,"ht__selection--rows")):K?($e(this.rootElement,"ht__selection--rows"),J(this.rootElement,"ht__selection--columns")):$e(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",h=>{const g=h.length-1,{from:m,to:E}=h[g];this.runHooks("afterSelectionEnd",m.row,m.col,E.row,E.col,g),this.runHooks("afterSelectionEndByProp",m.row,s.colToProp(m.col),E.row,s.colToProp(E.col),g)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const g=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=g)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),$e(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSetRangeStart",...g)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSetRangeStartOnly",...g)}).addLocalHook("beforeSetRangeEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSetRangeEnd",...g)}).addLocalHook("beforeSelectColumns",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSelectColumns",...g)}).addLocalHook("afterSelectColumns",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("afterSelectColumns",...g)}).addLocalHook("beforeSelectRows",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSelectRows",...g)}).addLocalHook("afterSelectRows",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("afterSelectRows",...g)}).addLocalHook("beforeModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("modifyTransformStart",...g)}).addLocalHook("afterModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("afterModifyTransformStart",...g)}).addLocalHook("beforeModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("modifyTransformEnd",...g)}).addLocalHook("afterModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("afterModifyTransformEnd",...g)}).addLocalHook("beforeRowWrap",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeRowWrap",...g)}).addLocalHook("beforeColumnWrap",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeColumnWrap",...g)}).addLocalHook("insertRowRequire",h=>this.alter("insert_row_above",h,1,"auto")).addLocalHook("insertColRequire",h=>this.alter("insert_col_start",h,1,"auto")),c={alter(h,g){var m,E;let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=arguments.length>3?arguments[3]:void 0,Y=arguments.length>4?arguments[4]:void 0;const B=q=>{if(q.length===0)return[];const Q=[...q];return Q.sort((de,Ae)=>{let[Ee]=de,[Oe]=Ae;return Ee===Oe?0:Ee>Oe?1:-1}),Yt(Q,(de,Ae)=>{let[Ee,Oe]=Ae;const z=de[de.length-1],[Ke,ke]=z,ye=Ke+ke;if(Ee<=ye){const He=Math.max(Oe-(ye-Ee),0);z[1]+=He}else de.push([Ee,Oe]);return de},[Q[0]])};switch(h){case"insert_row_below":case"insert_row_above":const q=s.countSourceRows();if(b.maxRows===q)return;const Q=h==="insert_row_below"?"below":"above";g=(m=g)!==null&&m!==void 0?m:Q==="below"?q:0;const{delta:K,startPhysicalIndex:de}=l.createRow(g,M,{source:O,mode:Q});if(K){const ke=W.selectedRange.current(),ye=ke==null?void 0:ke.from,He=ye==null?void 0:ye.row,Re=s.toVisualRow(de);if(W.isSelectedByCorner())W.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(he(He)&&He>=Re){const{row:C,col:S}=ke.to;let A=ye.col;W.isSelectedByRowHeader()&&(A=-1),W.getSelectedRange().pop(),W.setRangeStartOnly(s._createCellCoords(He+K,A),!0),W.setRangeEnd(s._createCellCoords(C+K,S))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Ae=h==="insert_col_end"?"end":"start";g=(E=g)!==null&&E!==void 0?E:Ae==="end"?s.countSourceCols():0;const{delta:Ee,startPhysicalIndex:Oe}=l.createCol(g,M,{source:O,mode:Ae});if(Ee){if(Array.isArray(b.colHeaders)){const C=[s.toVisualColumn(Oe),0];C.length+=Ee,Array.prototype.splice.apply(b.colHeaders,C)}const ke=W.selectedRange.current(),ye=ke==null?void 0:ke.from,He=ye==null?void 0:ye.col,Re=s.toVisualColumn(Oe);if(W.isSelectedByCorner())W.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(he(He)&&He>=Re){const{row:C,col:S}=ke.to;let A=ye.row;W.isSelectedByColumnHeader()&&(A=-1),W.getSelectedRange().pop(),W.setRangeStartOnly(s._createCellCoords(A,He+Ee),!0),W.setRangeEnd(s._createCellCoords(C,S+Ee))}else s._refreshBorders()}break;case"remove_row":const z=ke=>{let ye=0;T(ke,He=>{let[Re,C]=He;const S=en(Re)?s.countRows()-1:Math.max(Re-ye,0);if(Number.isInteger(Re)&&(Re=Math.max(Re-ye,0)),!l.removeRow(Re,C,O))return;const F=s.countRows(),P=b.fixedRowsTop;P>=S+1&&(b.fixedRowsTop-=Math.min(C,P-S));const k=b.fixedRowsBottom;k&&S>=F-k&&(b.fixedRowsBottom-=Math.min(C,k)),ye+=C})};Array.isArray(g)?z(B(g)):z([[g,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Ke=ke=>{let ye=0;T(ke,He=>{let[Re,C]=He;const S=en(Re)?s.countCols()-1:Math.max(Re-ye,0);let A=s.toPhysicalColumn(S);if(Number.isInteger(Re)&&(Re=Math.max(Re-ye,0)),!l.removeCol(Re,C,O))return;const P=b.fixedColumnsStart;P>=S+1&&(b.fixedColumnsStart-=Math.min(C,P-S)),Array.isArray(b.colHeaders)&&(typeof A>"u"&&(A=-1),b.colHeaders.splice(A,C)),ye+=C})};Array.isArray(g)?Ke(B(g)):Ke([[g,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${h}"`)}Y||c.adjustRowsAndCols()},adjustRowsAndCols(){const h=b.minRows,g=b.minSpareRows,m=b.minCols,E=b.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&W.deselect(),h){const M=s.countRows();M<h&&l.createRow(M,h-M,{source:"auto"})}if(g){const M=s.countEmptyRows(!0);if(M<g){const O=g-M,Y=Math.min(O,b.maxRows-s.countSourceRows());l.createRow(s.countRows(),Y,{source:"auto"})}}{let M;(m||E)&&(M=s.countEmptyCols(!0));let O=s.countCols();if(m&&!b.columns&&O<m){const Y=m-O;M+=Y,l.createCol(O,Y,{source:"auto"})}if(E&&!b.columns&&s.dataType==="array"&&M<E){O=s.countCols();const Y=E-M,B=Math.min(Y,b.maxCols-O);l.createCol(O,B,{source:"auto"})}}if(W.isSelected()){const M=s.countRows(),O=s.countCols();T(W.selectedRange,Y=>{let B=!1,q=Y.from.row,Q=Y.from.col,K=Y.to.row,de=Y.to.col;q>M-1?(q=M-1,B=!0,K>q&&(K=q)):K>M-1&&(K=M-1,B=!0,q>K&&(q=K)),Q>O-1?(Q=O-1,B=!0,de>Q&&(de=Q)):de>O-1&&(de=O-1,B=!0,Q>de&&(Q=de)),B&&s.selectCell(q,Q,K,de)})}s.view&&s.view.adjustElementsSize()},populateFromArray(h,g,m,E,M){let O,Y,B,q;const Q=[],K={},de=[],Ae=h.row,Ee=h.col;if(Y=g.length,Y===0)return!1;let Oe=0,z=0;switch(Ue(m)&&(Oe=m.col-Ee+1,z=m.row-Ae+1),M){case"shift_down":const Ke=Du(g),ke=Ke.length,ye=Math.max(ke,Oe),He=s.getData().slice(Ae),Re=Du(He).slice(Ee,Ee+ye);for(B=0;B<ye;B+=1)if(B<ke){for(O=0,Y=Ke[B].length;O<z-Y;O+=1)Ke[B].push(Ke[B][O%Y]);B<Re.length?de.push(Ke[B].concat(Re[B])):de.push(Ke[B].concat(new Array(He.length).fill(null)))}else de.push(Ke[B%ke].concat(Re[B]));s.populateFromArray(Ae,Ee,Du(de));break;case"shift_right":const C=g.length,S=Math.max(C,z),A=s.getData().slice(Ae).map(U=>U.slice(Ee));for(O=0;O<S;O+=1)if(O<C){for(B=0,q=g[O].length;B<Oe-q;B+=1)g[O].push(g[O][B%q]);if(O<A.length)for(let U=0;U<A[O].length;U+=1)g[O].push(A[O][U]);else g[O].push(...new Array(A[0].length).fill(null))}else g.push(g[O%Y].slice(0,S).concat(A[O]));s.populateFromArray(Ae,Ee,g);break;case"overwrite":default:K.row=h.row,K.col=h.col;let F=0,P=0,k=!0,H;const D=function(re){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const be=g[re%g.length];return fe!==null?be[fe%be.length]:be},V=g.length,$=m?m.row-h.row+1:0;for(m?Y=$:Y=Math.max(V,$),O=0;O<Y&&!(m&&K.row>m.row&&$>V||!b.allowInsertRow&&K.row>s.countRows()-1||K.row>=b.maxRows);O++){const U=O-F,re=D(U).length,fe=m?m.col-h.col+1:0;if(m?q=fe:q=Math.max(re,fe),K.col=h.col,H=s.getCellMeta(K.row,K.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&H.skipRowOnPaste){F+=1,K.row+=1,Y+=1;continue}for(P=0,B=0;B<q&&!(m&&K.col>m.col&&fe>re||!b.allowInsertColumn&&K.col>s.countCols()-1||K.col>=b.maxCols);B++){if(H=s.getCellMeta(K.row,K.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&H.skipColumnOnPaste){P+=1,K.col+=1,q+=1;continue}if(H.readOnly&&E!=="UndoRedo.undo"){K.col+=1;continue}const be=B-P;let xe=D(U,be),Be=s.getDataAtCell(K.row,K.col);if(xe!==null&&typeof xe=="object")if(Array.isArray(xe)&&Be===null&&(Be=[]),Be===null||typeof Be!="object")k=!1;else{const St=yl(Array.isArray(Be)?Be:Be[0]||Be),Qe=yl(Array.isArray(xe)?xe:xe[0]||xe);hg(St,Qe)||Array.isArray(St)&&Array.isArray(Qe)?xe=An(xe):k=!1}else Be!==null&&typeof Be=="object"&&(k=!1);k&&Q.push([K.row,K.col,xe]),k=!0,K.col+=1}K.row+=1}s.setDataAtCell(Q,null,null,E||"populateFromArray");break}}};function ne(h){const g=qP(h);zy(g)?(s.runHooks("beforeLanguageChange",g),_.language=g,s.runHooks("afterLanguageChange",g)):ZP(h)}function j(h,g){const m=h==="className"?s.rootElement:s.table;if(p)J(m,g);else{let E=[],M=[];_[h]&&(E=Array.isArray(_[h])?_[h]:av(_[h])),g&&(M=Array.isArray(g)?g:av(g));const O=sv(E,M),Y=sv(M,E);O.length&&$e(m,O),Y.length&&J(m,Y)}_[h]=g}this.init=function(){u.setData(b.data),s.runHooks("beforeInit"),(so()||ny())&&J(s.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new $3(this),d=zG.getInstance(s,b,W),f=new XG(s),Ad(this)&&V9(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&s.rootElement.offsetParent===null&&HI(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof p=="object"&&(s.runHooks("afterChange",p[0],p[1]),p=!1),s.runHooks("afterInit")};function X(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function ie(h){const g=h.replace(",",".");return isNaN(parseFloat(g))===!1?parseFloat(g):h}function oe(h,g,m){if(!h.length)return;const E=s.getActiveEditor(),M=new X;let O=!0;M.onQueueEmpty=Y=>{E&&O&&E.cancelChanges(),m(Y)};for(let Y=h.length-1;Y>=0;Y--){const[B,q,,Q]=h[Y],K=l.propToCol(q),de=s.getCellMeta(B,K);de.type==="numeric"&&typeof Q=="string"&&iP(Q)&&(h[Y][3]=ie(Q)),s.getCellValidator(de)&&(M.addValidatorToQueue(),s.validateCell(h[Y][3],de,function(Ae,Ee){return function(Oe){if(typeof Oe!="boolean")throw new Error("Validation error: result is not boolean");if(Oe===!1&&Ee.allowInvalid===!1){O=!1,h.splice(Ae,1),Ee.valid=!0;const z=s.getCell(Ee.visualRow,Ee.visualCol);z!==null&&$e(z,b.invalidCellClassName)}M.removeValidatorFormQueue()}}(Y,de),g))}M.checkIfQueueIsEmpty()}function se(h,g){let m=h.length-1;if(m<0)return;for(;m>=0;m--){let M=!1;if(h[m]===null){h.splice(m,1);continue}if(!((h[m][2]===null||h[m][2]===void 0)&&(h[m][3]===null||h[m][3]===void 0))){if(b.allowInsertRow)for(;h[m][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:g});if(O===0){M=!0;break}}if(s.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;l.propToCol(h[m][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:g});if(O===0){M=!0;break}}M||l.set(h[m][0],h[m][1],h[m][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",h,g),d.lockEditor(),s._refreshBorders(null),d.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",h,g||"edit");const E=s.getActiveEditor();E&&he(E.refreshValue)&&E.refreshValue()}this._createCellCoords=function(h,g){return s.view._wt.createCellCoords(h,g)},this._createCellRange=function(h,g,m){return s.view._wt.createCellRange(h,g,m)},this.validateCell=function(h,g,m,E){let M=s.getCellValidator(g);function O(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||g.hidden===!0){m(Y);return}const q=g.visualCol,Q=g.visualRow,K=s.getCell(Q,q,!0);if(K&&K.nodeName!=="TH"){const de=s.rowIndexMapper.getRenderableFromVisualIndex(Q),Ae=s.columnIndexMapper.getRenderableFromVisualIndex(q);s.view._wt.getSetting("cellRenderer",de,Ae,K)}m(Y)}pI(M)&&(M=function(Y){return function(B,q){q(Y.test(B))}}(M)),wt(M)?(h=s.runHooks("beforeValidate",h,g.visualRow,g.prop,E),s._registerImmediate(()=>{M.call(g,h,Y=>{s&&(Y=s.runHooks("afterValidate",Y,h,g.visualRow,g.prop,E),g.valid=Y,O(Y),s.runHooks("postAfterValidate",Y,h,g.visualRow,g.prop,E))})})):s._registerImmediate(()=>{g.valid=!0,O(g.valid,!1)})};function ve(h,g,m){return Array.isArray(h)?h:[[h,g,m]]}function Pe(h,g){const m=s.getActiveEditor(),E=s.runHooks("beforeChange",h,g||"edit"),M=h.filter(O=>O!==null);return E===!1||M.length===0?(m&&m.cancelChanges(),[]):M}this.setDataAtCell=function(h,g,m,E){const M=ve(h,g,m),O=[];let Y=E,B,q,Q;for(B=0,q=M.length;B<q;B++){if(typeof M[B]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M[B][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M[B][1]>=this.countCols()?Q=M[B][1]:Q=l.colToProp(M[B][1]),O.push([M[B][0],Q,u.getAtCell(this.toPhysicalRow(M[B][0]),M[B][1]),M[B][2]])}!Y&&typeof h=="object"&&(Y=g);const K=Pe(O,E);s.runHooks("afterSetDataAtCell",K,Y),oe(K,Y,()=>{se(K,Y)})},this.setDataAtRowProp=function(h,g,m,E){const M=ve(h,g,m),O=[];let Y=E,B,q;for(B=0,q=M.length;B<q;B++)O.push([M[B][0],M[B][1],u.getAtCell(this.toPhysicalRow(M[B][0]),M[B][1]),M[B][2]]);!Y&&typeof h=="object"&&(Y=g);const Q=Pe(O,E);s.runHooks("afterSetDataAtRowProp",Q,Y),oe(Q,Y,()=>{se(Q,Y)})},this.listen=function(){s&&!s.isListening()&&(cw.forEach(h=>{s!==h&&h.unlisten()}),uw=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(uw=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return uw===s.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(h,g)},this.populateFromArray=function(h,g,m,E,M,O,Y){if(!(typeof m=="object"&&typeof m[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const B=typeof E=="number"?s._createCellCoords(E,M):null;return c.populateFromArray(s._createCellCoords(h,g),m,B,O,Y)},this.spliceCol=function(h,g,m){for(var E=arguments.length,M=new Array(E>3?E-3:0),O=3;O<E;O++)M[O-3]=arguments[O];return l.spliceCol(h,g,m,...M)},this.spliceRow=function(h,g,m){for(var E=arguments.length,M=new Array(E>3?E-3:0),O=3;O<E;O++)M[O-3]=arguments[O];return l.spliceRow(h,g,m,...M)},this.getSelected=function(){if(W.isSelected())return Ye(W.getSelectedRange(),h=>{let{from:g,to:m}=h;return[g.row,g.col,m.row,m.col]})},this.getSelectedLast=function(){const h=this.getSelected();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.getSelectedRange=function(){if(W.isSelected())return Array.from(W.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.emptySelectedCells=function(h){if(!W.isSelected()||this.countRows()===0||this.countCols()===0)return;const g=[];T(W.getSelectedRange(),m=>{if(m.isSingleHeader())return;const E=m.getTopStartCorner(),M=m.getBottomEndCorner();Ce(E.row,M.row,O=>{Ce(E.col,M.col,Y=>{this.getCellMeta(O,Y).readOnly||g.push([O,Y,null])})})}),g.length>0&&this.setDataAtCell(g,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(h){this.suspendRender();const g=h();return this.resumeRender(),g},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const g=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(g,0),(!this.isExecutionSuspended()&&g===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const m=h();return this.resumeExecution(g),m},this.batch=function(h){this.suspendRender(),this.suspendExecution();const g=h();return this.resumeExecution(),this.resumeRender(),g},this.refreshDimensions=function(){if(!s.view)return;const{width:h,height:g}=s.view.getLastSize(),{width:m,height:E}=s.rootElement.getBoundingClientRect(),M=m!==h||E!==g;s.runHooks("beforeRefreshDimensions",{width:h,height:g},{width:m,height:E},M)!==!1&&((M||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(m,E),s.render()),s.runHooks("afterRefreshDimensions",{width:h,height:g},{width:m,height:E},M))},this.updateData=function(h,g){X0(h,m=>{l=m},m=>{l=m,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:g,metaManager:y,firstRun:p})},this.loadData=function(h,g){X0(h,m=>{l=m},()=>{y.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),p&&(p=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:g,metaManager:y,firstRun:p})},this.getInitialColumnCount=function(){const h=b.columns;let g=0;if(Array.isArray(h))g=h.length;else if(wt(h))if(s.dataType==="array"){const m=this.countSourceCols();for(let E=0;E<m;E+=1)h(E)&&(g+=1)}else(s.dataType==="object"||s.dataType==="function")&&(g=l.colToPropCache.length);else if(he(b.dataSchema)){const m=l.getSchema();g=Array.isArray(m)?m.length:dg(m)}else g=this.countSourceCols();return g},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,g,m,E){return Ct(h)?l.getAll():l.getRange(s._createCellCoords(h,g),s._createCellCoords(m,E),l.DESTINATION_RENDERER)},this.getCopyableText=function(h,g,m,E){return l.getCopyableText(s._createCellCoords(h,g),s._createCellCoords(m,E))},this.getCopyableData=function(h,g){return l.getCopyable(h,l.colToProp(g))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=(p?s.loadData:s.updateData).bind(this);let E=!1,M,O;if(he(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(he(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(he(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(M in h)M==="data"||(M==="language"?ne(h.language):M==="className"?j("className",h.className):M==="tableClassName"&&s.table?(j("tableClassName",h.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(M)||ge.getSingleton().isDeprecated(M)?(wt(h[M])||Array.isArray(h[M]))&&(h[M].initialHook=!0,s.addHook(M,h[M])):!g&&It(h,M)&&(_[M]=h[M]));h.data===void 0&&b.data===void 0?m(null,"updateSettings"):h.data!==void 0?m(h.data,"updateSettings"):h.columns!==void 0&&(l.createMap(),s.initIndexMappers());const Y=s.countCols(),B=b.columns;if(B&&wt(B)&&(E=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&y.clearCache(),Y>0)for(M=0,O=0;M<Y;M++){if(B){const K=E?B(M):B[O];K&&y.updateColumnMeta(O,K)}O+=1}he(h.cell)&&Ge(h.cell,K=>{s.setCellMetaObject(K.row,K.col,K)}),s.runHooks("afterCellMetaReset");let q=s.rootElement.style.height;q!==""&&(q=parseInt(s.rootElement.style.height,10));let Q=h.height;if(wt(Q)&&(Q=Q()),g&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),Q===null){const K=s.rootElement.getAttribute("data-initialstyle");K&&(K.indexOf("height")>-1||K.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",K):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else Q!==void 0&&(s.rootElement.style.height=isNaN(Q)?`${Q}`:`${Q}px`,s.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let K=h.width;wt(K)&&(K=K()),s.rootElement.style.width=isNaN(K)?`${K}`:`${K}px`}g||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",h)),c.adjustRowsAndCols(),s.view&&!p&&(s.forceFullRender=!0,d.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!g&&s.view&&(q===""||Q===""||Q===void 0)&&q!==Q&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=s.getSelectedLast();if(b.getValue){if(wt(b.getValue))return b.getValue.call(s);if(h)return s.getData()[h[0][0]][b.getValue]}else if(h)return s.getDataAtCell(h[0],h[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,g,m,E,M){c.alter(h,g,m,E,M)},this.getCell=function(h,g){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=g,M=h;if(g>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(g)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(g)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;M=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return M===null||E===null?null:s.view.getCellAtCoords(s._createCellCoords(M,E),m)},this.getCoords=function(h){const g=this.view._wt.wtTable.getCoords(h);if(g===null)return null;const{row:m,col:E}=g;let M=m,O=E;return m>=0&&(M=this.rowIndexMapper.getVisualFromRenderableIndex(m)),E>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(E)),s._createCellCoords(M,O)},this.colToProp=function(h){return l.colToProp(h)},this.propToCol=function(h){return l.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,g){return l.get(h,l.colToProp(g))},this.getDataAtRowProp=function(h,g){return l.get(h,g)},this.getDataAtCol=function(h){const g=[],m=l.getRange(s._createCellCoords(0,h),s._createCellCoords(b.data.length-1,h),l.DESTINATION_RENDERER);for(let E=0;E<m.length;E+=1)for(let M=0;M<m[E].length;M+=1)g.push(m[E][M]);return g},this.getDataAtProp=function(h){const g=[],m=l.getRange(s._createCellCoords(0,l.propToCol(h)),s._createCellCoords(b.data.length-1,l.propToCol(h)),l.DESTINATION_RENDERER);for(let E=0;E<m.length;E+=1)for(let M=0;M<m[E].length;M+=1)g.push(m[E][M]);return g},this.getSourceData=function(h,g,m,E){let M;return h===void 0?M=u.getData():M=u.getByRange(s._createCellCoords(h,g),s._createCellCoords(m,E)),M},this.getSourceDataArray=function(h,g,m,E){let M;return h===void 0?M=u.getData(!0):M=u.getByRange(s._createCellCoords(h,g),s._createCellCoords(m,E),!0),M},this.getSourceDataAtCol=function(h){return u.getAtColumn(h)},this.setSourceDataAtCell=function(h,g,m,E){const M=ve(h,g,m),O=this.hasHook("afterSetSourceDataAtCell"),Y=[];O&&T(M,q=>{let[Q,K,de]=q;Y.push([Q,K,u.getAtCell(Q,K),de])}),T(M,q=>{let[Q,K,de]=q;u.setAtCell(Q,K,de)}),O&&this.runHooks("afterSetSourceDataAtCell",Y,E),this.render();const B=s.getActiveEditor();B&&he(B.refreshValue)&&B.refreshValue()},this.getSourceDataAtRow=function(h){return u.getAtRow(h)},this.getSourceDataAtCell=function(h,g){return u.getAtCell(h,g)},this.getDataAtRow=function(h){return l.getRange(s._createCellCoords(h,0),s._createCellCoords(h,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,g,m,E){const M=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,g,m,E],[O,Y]=M;let[,,B,q]=M,Q=null,K=null;B===void 0&&(B=O),q===void 0&&(q=Y);let de="mixed";return Ce(Math.max(Math.min(O,B),0),Math.max(O,B),Ae=>{let Ee=!0;return Ce(Math.max(Math.min(Y,q),0),Math.max(Y,q),Oe=>(K=this.getCellMeta(Ae,Oe).type,Q?Ee=Q===K:Q=K,Ee)),de=Ee?K:"mixed",Ee}),de},this.removeCellMeta=function(h,g,m){const[E,M]=[this.toPhysicalRow(h),this.toPhysicalColumn(g)];let O=y.getCellMetaKeyValue(E,M,m);s.runHooks("beforeRemoveCellMeta",h,g,m,O)!==!1&&(y.removeCellMeta(E,M,m),s.runHooks("afterRemoveCellMeta",h,g,m,O)),O=null},this.spliceCellsMeta=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var m=arguments.length,E=new Array(m>2?m-2:0),M=2;M<m;M++)E[M-2]=arguments[M];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&y.removeRow(this.toPhysicalRow(h),g),E.length>0&&T(E.reverse(),O=>{y.createRow(this.toPhysicalRow(h)),T(O,(Y,B)=>this.setCellMetaObject(h,B,Y))}),s.render()},this.setCellMetaObject=function(h,g,m){typeof m=="object"&&Ge(m,(E,M)=>{this.setCellMeta(h,g,M,E)})},this.setCellMeta=function(h,g,m,E){if(s.runHooks("beforeSetCellMeta",h,g,m,E)===!1)return;let O=h,Y=g;h<this.countRows()&&(O=this.toPhysicalRow(h)),g<this.countCols()&&(Y=this.toPhysicalColumn(g)),y.setCellMeta(O,Y,m,E),s.runHooks("afterSetCellMeta",h,g,m,E)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(h,g){let m=this.toPhysicalRow(h),E=this.toPhysicalColumn(g);return m===null&&(m=h),E===null&&(E=g),y.getCellMeta(m,E,{visualRow:h,visualColumn:g})},this.getCellMetaAtRow=function(h){return y.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||b.columns)},this.getCellRenderer=function(h,g){const m=typeof h=="number"?s.getCellMeta(h,g).renderer:h.renderer;return typeof m=="string"?cf(m):Ct(m)?cf("text"):m},this.getCellEditor=function(h,g){const m=typeof h=="number"?s.getCellMeta(h,g).editor:h.editor;return typeof m=="string"?af(m):Ct(m)?af("text"):m},this.getCellValidator=function(h,g){const m=typeof h=="number"?s.getCellMeta(h,g).validator:h.validator;return typeof m=="string"?uy(m):m},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,g){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(g,h)},this.validateColumns=function(h,g){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(g,void 0,h)},this._validateCells=function(h,g,m){const E=new X;h&&(E.onQueueEmpty=h);let M=s.countRows()-1;for(;M>=0;){if(g!==void 0&&g.indexOf(M)===-1){M-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(m!==void 0&&m.indexOf(O)===-1){O-=1;continue}E.addValidatorToQueue(),s.validateCell(s.getDataAtCell(M,O),s.getCellMeta(M,O),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),O-=1}M-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let g=b.rowHeaders,m=h;return m!==void 0&&(m=s.runHooks("modifyRowHeader",m)),m===void 0?(g=[],Ce(s.countRows()-1,E=>{g.push(s.getRowHeader(E))})):Array.isArray(g)&&g[m]!==void 0?g=g[m]:wt(g)?g=g(m):g&&typeof g!="string"&&typeof g!="number"&&(g=m+1),g},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let h=0,g=s.countCols();h<g;h++)if(s.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const m=s.runHooks("modifyColHeader",h);if(m===void 0){const B=[],q=s.countCols();for(let Q=0;Q<q;Q++)B.push(s.getColHeader(Q));return B}let E=b.colHeaders;const M=function(B){const q=[],Q=s.countCols();let K=0;for(;K<Q;K++)wt(b.columns)&&b.columns(K)&&q.push(K);return q[B]},O=s.toPhysicalColumn(m),Y=M(O);return b.colHeaders===!1?E=null:b.columns&&wt(b.columns)&&b.columns(Y)&&b.columns(Y).title?E=b.columns(Y).title:b.columns&&b.columns[O]&&b.columns[O].title?E=b.columns[O].title:Array.isArray(b.colHeaders)&&b.colHeaders[O]!==void 0?E=b.colHeaders[O]:wt(b.colHeaders)?E=b.colHeaders(O):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(E=wg(m)),E=s.runHooks("modifyColumnHeaderValue",E,h,g),E},this._getColWidthFromSettings=function(h){let g;if(h>=0&&(g=s.getCellMeta(0,h).width),(g===void 0||g===b.width)&&(g=b.colWidths),g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getColWidth=function(h){let g=s._getColWidthFromSettings(h);return g=s.runHooks("modifyColWidth",g,h),g===void 0&&(g=hy.DEFAULT_WIDTH),g},this._getRowHeightFromSettings=function(h){let g=b.rowHeights;if(g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getRowHeight=function(h){let g=s._getRowHeightFromSettings(h);return g=s.runHooks("modifyRowHeight",g,h),g},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const h=b.maxCols,g=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,g)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return uf(s.countRows()-1,m=>{if(s.isEmptyRow(m))g+=1;else if(h===!0)return!1}),g},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return uf(s.countCols()-1,m=>{if(s.isEmptyCol(m))g+=1;else if(h===!0)return!1}),g},this.isEmptyRow=function(h){return b.isEmptyRow.call(s,h)},this.isEmptyCol=function(h){return b.isEmptyCol.call(s,h)},this.selectCell=function(h,g,m,E){let M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ct(h)||Ct(g)?!1:this.selectCells([[h,g,m,E]],M,O)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g===!1&&(o=!0);const E=W.selectCells(h);return E&&m&&s.listen(),o=!1,E},this.selectColumns=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return W.selectColumns(h,g,m)},this.selectRows=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return W.selectRows(h,g,m)},this.deselectCell=function(){W.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;o=!0,W.selectAll(h,g,m),o=!1};const nt=(h,g)=>h.getNearestNotHiddenIndex(g,1,!0);this.scrollViewportTo=function(h){var g;if(typeof h=="number"){var m;h={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(m=arguments[4])!==null&&m!==void 0?m:!0}}const{row:E,col:M,verticalSnap:O,horizontalSnap:Y,considerHiddenIndexes:B}=(g=h)!==null&&g!==void 0?g:{};let q,Q,K,de;O!==void 0&&(q=O==="top",Q=!q),Y!==void 0&&(K=Y==="start",de=!K);let Ae=E,Ee=M;if(B===void 0||B){const Ke=Number.isInteger(E)&&E>=0,ke=Number.isInteger(M)&&M>=0,ye=Ke?nt(this.rowIndexMapper,E):void 0,He=ke?nt(this.columnIndexMapper,M):void 0;if(ye===null||He===null)return!1;Ae=Ke?s.rowIndexMapper.getRenderableFromVisualIndex(ye):E,Ee=ke?s.columnIndexMapper.getRenderableFromVisualIndex(He):M}const Oe=Number.isInteger(Ae),z=Number.isInteger(Ee);return Oe&&Ae>=0&&z&&Ee>=0?s.view.scrollViewport(s._createCellCoords(Ae,Ee),q,de,Q,K):Oe&&Ae>=0&&(z&&Ee<0||!z)?s.view.scrollViewportVertically(Ae,q,Q):z&&Ee>=0&&(Oe&&Ae<0||!Oe)?s.view.scrollViewportHorizontally(Ee,de,K):!1},this.scrollToFocusedCell=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",h);const{highlight:g}=this.getSelectedRangeLast();this.scrollViewportTo(g.toObject())?this.view.render():(this.removeHook("afterScroll",h),this._registerImmediate(()=>h()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),cw.delete(this.guid),Ad(s)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}ei(s.rootElement),a.destroy(),d&&d.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),I.getItems().forEach(h=>{let[,g]=h;g.destroy()}),I.clear(),s.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(s),Ge(s,(h,g,m)=>{wt(h)?m[g]=Ne(g):g!=="guid"&&(m[g]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,W=null,d=null,s=null};function Ne(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(h){const g=Mn(h);return g==="UndoRedo"?this.undoRedo:I.getItem(g)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(h)},this.getInstance=function(){return s},this.addHook=function(h,g){ge.getSingleton().add(h,g,s)},this.hasHook=function(h){return ge.getSingleton().has(h,s)||ge.getSingleton().has(h)},this.addHookOnce=function(h,g){ge.getSingleton().once(h,g,s)},this.removeHook=function(h,g){ge.getSingleton().remove(h,g,s)},this.runHooks=function(h,g,m,E,M,O,Y){return ge.getSingleton().run(s,h,g,m,E,M,O,Y)},this.getTranslatedPhrase=function(h,g){return nx(b.language,h,g)},this.toHTML=()=>mv(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",mv(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,m=h;typeof m=="function"&&(m=setTimeout(m,g)),this.timeouts.push(m)},this._clearTimeouts=function(){T(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){T(this.immediates,h=>{clearImmediate(h)})},this._refreshBorders=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(h),s.view.render(),g&&W.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const R=K9({handleEvent(){return s.isListening()},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},ly().forEach(h=>{const g=Pc(h);I.addItem(h,new g(this))}),F9(s),R.setActiveContextName("grid"),ge.getSingleton().run(s,"construct")}const X9="hooksRefRegisterer",yx={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){T(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ge(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Hi(yx,"MIXIN_NAME",X9,{writable:!1,enumerable:!1});const q9=yx;function $r(t,e,n){return e=Z9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z9(t){var e=Q9(t,"string");return typeof e=="symbol"?e:String(e)}function Q9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const J9="base",Jt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Pv="baseEditor";class xl{static get EDITOR_TYPE(){return J9}constructor(e){$r(this,"hot",void 0),$r(this,"state",Jt.VIRGIN),$r(this,"_opened",!1),$r(this,"_fullEditMode",!1),$r(this,"_closeCallback",null),$r(this,"TD",null),$r(this,"row",null),$r(this,"col",null),$r(this,"prop",null),$r(this,"originalValue",null),$r(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=Jt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const d=this.hot.getSelectedLast();r=Math.max(Math.min(d[0],d[2]),0),i=Math.max(Math.min(d[1],d[3]),0),o=Math.max(d[0],d[2]),s=Math.max(d[1],d[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>he(this.hot.getSelected()),group:Pv};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Jt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=Jt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Ft(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(Pv),s.removeShortcutsByGroup(gg),this.state===Jt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Jt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=Jt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Jt.FINISHED,this.discardEditor(l)}):(this.state=Jt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Jt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Jt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Jt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Jt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Jt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=jt(n),a=dt(n),l=jt(this.hot.rootElement),u=dt(this.hot.rootElement),c=r.topOverlay.holder,d=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,p=d!==o?d.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,b=["master","inline_start"].includes(y)?f:0,_=["master","top","bottom"].includes(y)?p:0,I=s.top===l.top?0:1;let L=s.top-l.top-I-b,x=0;this.hot.isRtl()?x=o.innerWidth-s.left-a-w-1+_:x=s.left-l.left-1-_,["top","top_inline_start_corner"].includes(y)&&(L+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const W=this.hot.hasColHeaders(),G=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ne=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),X=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(W&&G<=0||G===X)&&(L+=1),ne<=0&&(x+=1);const ie=i.rowsRenderCalculator.startPosition,oe=i.columnsRenderCalculator.startPosition,se=Math.abs(r.inlineStartOverlay.getScrollPosition()),ve=r.topOverlay.getScrollPosition(),Pe=on(this.hot.rootDocument);let nt=n.offsetTop;if(["inline_start","master"].includes(y)&&(nt+=ie-ve),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:Q,wtTable:K}=r.bottomOverlay.clone;nt+=Q.getWorkspaceHeight()-K.getHeight()-Pe}let Ne=n.offsetLeft;this.hot.isRtl()?(Ne>=0?Ne=v.getWidth()-n.offsetLeft:Ne=Math.abs(Ne),Ne+=oe-se-a):["top","master","bottom"].includes(y)&&(Ne+=oe-se);const R=mo(this.TD,this.hot.rootWindow),h=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",g=parseInt(R[h],10)>0?0:1,m=parseInt(R.borderTopWidth,10)>0?0:1,E=dt(n)+g,M=Pt(n)+m,O=PI(c)?Pe:0,Y=xI(d)?Pe:0,B=this.hot.view.maximumVisibleElementWidth(Ne)-O+g,q=Math.max(this.hot.view.maximumVisibleElementHeight(nt)-Y+m,23);return{top:L,start:x,height:M,maxHeight:q,width:E,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}mt(xl,q9);function nE(t,e,n){t.addEventListener(e,n,!1)}function rE(t,e,n){t.removeEventListener(e,n,!1)}function iE(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function e5(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=iE(o).fontSize,i.style.fontFamily=iE(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const d=o.style;d.height=`${e.minHeight}px`,e.minWidth>c?d.width=`${e.minWidth}px`:c>e.maxWidth?d.width=`${e.maxWidth}px`:d.width=`${c}px`;const f=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>f?d.height=`${e.minHeight}px`:e.maxHeight<f?(d.height=`${e.maxHeight}px`,d.overflowY="visible"):d.height=`${f}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const d=parseInt(c.minHeight,10);isNaN(d)||(e.minHeight=d)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const d=parseInt(c.maxHeight,10);isNaN(d)||(e.maxHeight=d)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const d=parseInt(c.minWidth,10);isNaN(d)||(e.minWidth=d)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const d=parseInt(c.maxWidth,10);isNaN(d)||(e.maxWidth=d)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.overflowY="",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),f&&(nE(o,"input",s),nE(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){rE(o,"input",s),rE(o,"keydown",a)}}}function oE(t,e){const n=KS(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Mc(e,i)}function Ss(t,e,n){return e=t5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t5(t){var e=n5(t,"string");return typeof e=="symbol"?e:String(e)}function n5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const r5="ht_editor_visible",_h="ht_editor_hidden",sE="textEditor",i5="text";class da extends xl{static get EDITOR_TYPE(){return i5}constructor(e){super(e),Ss(this,"eventManager",new mr(this)),Ss(this,"autoResize",e5(this.hot.rootDocument)),Ss(this,"TEXTAREA",void 0),Ss(this,"textareaStyle",void 0),Ss(this,"TEXTAREA_PARENT",void 0),Ss(this,"textareaParentStyle",void 0),Ss(this,"layerClass",void 0),this.eventManager=new mr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),EI(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==Jt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===Jt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Mc(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),_e(this.TEXTAREA,[["data-hot-input",""],Al(-1)]),this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[yo()]),J(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),J(this.TEXTAREA_PARENT,"handsontableInputHolder"),De(this.TEXTAREA_PARENT,this.layerClass)&&$e(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,_h),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){zI()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",$e(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,_h)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;Ce(e.length-1,r=>{const i=e[r];if(De(i,"handsontableEditor"))return n=!0,!1}),De(this.TEXTAREA_PARENT,_h)&&$e(this.TEXTAREA_PARENT,_h),n?(this.layerClass=r5,J(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),J(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Jt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=mo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=mo(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,p=s-d,w=o-c,v=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,w),minHeight:Math.min(p,v),maxWidth:w,maxHeight:v},!0)}bindEvents(){ty()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>he(this.hot.getSelected()),group:sE},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;oE(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;oE(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(gg),n.removeShortcutsByGroup(sE),n.removeShortcutsByGroup(Pv)}}const o5="base";function $c(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],d=[];s.className&&J(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(FR())):a&&c.push(FR()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(WR())):(u.push(s.invalidCellClassName),a&&c.push(WR()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),$e(e,u),J(e,l),ua(e,c),_e(e,d)}$c.RENDERER_TYPE=o5;const s5="text";function To(t,e,n,r,i,o,s){$c.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Ft(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){ei(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else is(e,a)}To.RENDERER_TYPE=s5;const a5="text",bx={CELL_TYPE:a5,editor:da,renderer:To};Rn(bx);Ie.editors={BaseEditor:xl};function Ie(t,e){const n=new Sx(t,e||{},Iy);return n.init(),n}Ie.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Sx(t,e,Iy)};Ie.DefaultSettings=fx();Ie.hooks=ge.getSingleton();Ie.CellCoords=df;Ie.CellRange=gy;Ie.packageName="handsontable";Ie.buildDate="30/11/2023 10:10:40";Ie.version="14.0.0";Ie.languages={dictionaryKeys:_4,getLanguageDictionary:tx,getLanguagesDictionaries:P4,registerLanguageDictionary:Gy,getTranslatedPhrase:nx};const l5=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],aE="odd",Rx=()=>["Ø¹ÙØ±","Ø¹ÙÙ","Ø¹Ø¨Ø¯ Ø§ÙÙÙ","ÙØ¹ØªØµÙ"][Math.floor(Math.random()*3)],Ex=()=>["ØªØ±ÙÙØ§","ÙØµØ±","ÙØ¨ÙØ§Ù","Ø§ÙØ¹Ø±Ø§Ù"][Math.floor(Math.random()*3)],u5=()=>new Date(Math.floor(Math.random()*Date.now())).toLocaleDateString("en-gb"),lE=()=>Math.random()>.5,Fu=(t=0,e=1e3)=>t+Math.floor(Math.random()*e),c5=()=>`${Ex()} ${Rx()} ${Fu()}`,h5=()=>`${Fu(1e5,999999).toString().match(/.{1,3}/g).join("-")}`;function d5(){return Array.from({length:50},()=>[lE(),Rx(),Ex(),c5(),u5(),h5(),lE(),Fu(0,200).toString(),Fu(1,10),Fu(1,5)])}function Pd(){return new URLSearchParams(location.search.replace(/^\?/,"")).get("arabicExample")==="1"}function f5(){return Pd()?d5():l5}/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Feb 9, 2022
 *
 * Description: Definition file for Arabic - Without a specific country.
 */const g5={languageCode:"ar-AR",languageDirection:"rtl",[Sg]:"ÙØ§ ØªÙØ¬Ø¯ Ø®ÙØ§Ø±Ø§Øª ÙØªÙÙØ±Ø©",[yg]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø¹ÙÙ",[bg]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø³ÙÙ",[Rg]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙØ³Ø§Ø±",[Eg]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙÙÙÙ",[Tg]:["Ø§Ø­Ø¯Ù Ø§ÙØµÙ","Ø§Ø­Ø°Ù Ø§ÙØµÙÙÙ"],[_g]:["Ø§Ø­Ø¯Ù Ø§ÙØ¹ÙÙØ¯","Ø§Ø­Ø¯Ù Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Mg]:"ØªØ±Ø§Ø¬Ø¹",[Ag]:"Ø¥ÙØºØ§Ø¡ Ø§ÙØªØ±Ø§Ø¬Ø¹",[Og]:"ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[Ig]:"Ø§ÙØ±Øº Ø§ÙØ¹ÙÙØ¯",[Vg]:"Ø§ÙÙØ­Ø§Ø°Ø§Ø©",[Bg]:"ÙØ³Ø§Ø±",[Ug]:"ÙØ³Ø·",[Yg]:"ÙÙÙÙ",[Gg]:"Ø¨Ø§ÙØªØ³Ø§ÙÙ",[zg]:"Ø£Ø¹ÙÙ",[jg]:"ÙØªÙØ³Ø·",[Kg]:"Ø£Ø³ÙÙ",[Hg]:"ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[Dg]:"Ø¥ÙØºØ§Ø¡ ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[Xg]:"Ø§ÙØ­Ø¯ÙØ¯",[qg]:"Ø£Ø¹ÙÙ",[Zg]:"ÙÙÙÙ",[Qg]:"Ø£Ø³ÙÙ",[Jg]:"ÙØ³Ø§Ø±",[em]:"Ø£Ø­Ø°Ù Ø§ÙØ­Ø¯(ÙØ¯)",[$g]:"Ø£Ø¶Ù ØªØ¹ÙÙÙØ§Ù",[kg]:"ØªØ¹Ø¯ÙÙ Ø§ÙØªØ¹ÙÙÙ",[Fg]:"Ø§Ø­Ø°Ù Ø§ÙØªØ¹ÙÙÙ",[Wg]:"ØªØ¹ÙÙÙ ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[Ng]:"Ø§Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[Lg]:"Ø¥ÙØºØ§Ø¡ Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[Pg]:"ÙØ³Ø®",[xg]:"ÙØµ",[tm]:"Ø£Ø¯Ø®Ù ØµÙØ§Ù ÙØ±Ø¹ÙØ§Ù",[nm]:"Ø§ÙØµÙ Ø¹Ù Ø§ÙØµÙ Ø§ÙØ£ØµÙÙ",[rm]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ¹ÙÙØ¯","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ£Ø¹ÙØ¯Ø©"],[im]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ¹ÙÙØ¯","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ£Ø¹ÙØ¯Ø©"],[om]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·Ø±","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·ÙØ±"],[sm]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·Ø±","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·ÙØ±"],[Nc]:"Ø¨ÙØ§",[am]:"ÙØ§Ø±Øº",[lm]:"ØºÙØ± ÙØ§Ø±Øº",[um]:"ÙØ³Ø§ÙÙ",[cm]:"ÙØ§ ÙØ³Ø§ÙÙ",[hm]:"ÙØ¨Ø¯Ø§Ù Ø¨Ù",[dm]:"ÙÙØªÙÙ Ø¨Ù",[fm]:"ÙØ­ØªÙÙ",[gm]:"ÙØ§ ÙØ­ØªÙÙ",[mm]:"Ø£ÙØ¨Ø± ÙÙ",[pm]:"Ø£ÙØ¨Ø± Ø£Ù ÙØ³Ø§ÙÙ",[wm]:"Ø£ØµØºØ±",[Cm]:"Ø£ØµØºØ± Ø£Ù ÙØ³Ø§ÙÙ",[vm]:"Ø¨ÙÙ",[Sm]:"Ø®Ø§Ø±Ø¬ Ø§ÙÙØ¬Ø§Ù",[ym]:"Ø¨Ø¹Ø¯",[bm]:"ÙØ¨Ù",[Rm]:"Ø§ÙÙÙÙ",[Em]:"ØºØ¯Ø§Ù",[Tm]:"Ø§ÙØ¨Ø§Ø±Ø­Ø©",[cc]:"Ø®ÙØ§ÙØ§ ÙØ§Ø±ØºØ©",[_m]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙØ´Ø±Ø·",[Mm]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙÙÙÙØ©",[Am]:"Ù",[Lc]:"Ø£Ù",[Om]:"Ø§Ø®ØªÙØ§Ø± Ø§ÙÙÙ",[Im]:"Ø¥ÙØºØ§Ø¡",[Pm]:"ÙÙØ§ÙÙ",[xm]:"Ø¥ÙØºØ§Ø¡",[Hm]:"Ø§ÙØ¨Ø­Ø«",[Dm]:"Ø§ÙÙÙÙØ©",[Nm]:"Ø§ÙÙÙÙØ© Ø§ÙØ«Ø§ÙÙØ©"},Tx=g5,uE="handsontableEditor",m5="handsontable";class qy extends da{static get EDITOR_TYPE(){return m5}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Mc(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const d=this.getSourceData(c.row,c.col);d!==void 0&&a.setValue(d),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Kt(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:uE,relativeToGroup:gg,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Pr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(uE)}}function p5(t,e,n){w5(t,e),e.set(t,n)}function w5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mh(t,e,n){return e=C5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C5(t){var e=v5(t,"string");return typeof e=="symbol"?e:String(e)}function v5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cE(t,e){var n=S5(t,e,"get");return y5(t,n)}function S5(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function y5(t,e){return e.get?e.get.call(t):e.value}const b5="autocomplete";var hw=new WeakMap;class Zy extends qy{constructor(){super(...arguments),Mh(this,"query",null),Mh(this,"strippedChoices",[]),Mh(this,"rawChoices",[]),p5(this,hw,{writable:!0,value:this.hot.guid.slice(0,9)}),Mh(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,d;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=uv(Ft(n[c])),r)d=u.indexOf(e);else{const f=this.cellProperties.locale;d=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}d!==-1&&(l=u.length-d-s,i.push({baseIndex:c,index:d,charsLeft:l,value:u}))}for(i.sort((f,p)=>{if(p.index===-1)return-1;if(f.index===-1)return 1;if(f.index<p.index)return-1;if(p.index<f.index)return 1;if(f.index===p.index){if(f.charsLeft<p.charsLeft)return-1;if(f.charsLeft>p.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return b5}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return he(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),J(this.htContainer,"autocompleteEditor"),J(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[xY(),MY(),SI("listbox"),$Y()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[_r("false"),kY(`${cE(this,hw)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=on();a===0&&ac()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[dt(this.TEXTAREA)-2]:void 0,width:e?dt(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,d,f,p,w)=>{To(l,u,c,d,f,p,w);const{filteringCaseSensitive:v,allowHtml:y,locale:b}=this.cellProperties,_=this.query;let I=Ft(p),L,x;I&&!y&&(L=v===!0?I.indexOf(_):I.toLocaleLowerCase(b).indexOf(_.toLocaleLowerCase(b)),L!==-1&&(x=I.substr(L,_.length),I=I.replace(x,`<strong>${x}</strong>`))),n&&_e(u,[AY(),...r?[BY(i)]:[],...r?[UY(r.indexOf(p)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${d}`]]),u.innerHTML=I},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);_e(c,[GS()]),_e(this.TEXTAREA,...FY(c.id))}}}),n&&(_e(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ti()),_e(this.htEditor.rootElement,[vI(),WY("polite"),VY("text"),["id",`${cE(this,hw)}-listbox-${o}-${s}`]]),_e(this.TEXTAREA,..._r("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[_r("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=KS(this.TEXTAREA),r=II(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let d=0,f=l.length;d<f&&!(i&&u<=d);d++)u?c.push(l[s[d]]):c.push(l[d]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Du([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Mc(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=Qs(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=jt(this.TEXTAREA),o=Pt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Pt(this.hot.view._wt.wtTable.THEAD),u=jt(e),c=i.top-u.top-l+a,d=e.scrollHeight-c-l-o,f=s>d&&c>d;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:d,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+on(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ye(e,o=>Ft(o));return Ye(r,o=>n?o:uv(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===we.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===we.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(jI(e.keyCode)||e.keyCode===we.BACKSPACE||e.keyCode===we.DELETE||e.keyCode===we.INSERT){let n=10;if(e.keyCode===we.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const R5="html";function Qy(t,e,n,r,i,o,s){$c.apply(this,[t,e,n,r,i,o,s]),ca(e,o??"",!1)}Qy.RENDERER_TYPE=R5;const E5="autocomplete";function Hl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?Qy:To,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...yo()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),J(e,"htAutocomplete"),!t.acArrowListener){const d=new mr(t);t.acArrowListener=function(f){De(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{d.destroy()})}}Hl.RENDERER_TYPE=E5;const T5="autocomplete";function Fm(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,hE(n,e)):hE(n,e)(this.source):e(!0)}Fm.VALIDATOR_TYPE=T5;function hE(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}const _5="autocomplete",M5={CELL_TYPE:_5,editor:Zy,renderer:Hl,validator:Fm},A5="checkbox";class _x extends xl{static get EDITOR_TYPE(){return A5}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');De(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const dE=new WeakMap,fE=new WeakMap,O5="htBadValue",Rl="data-row",El="data-col",I5="checkboxRenderer",Mx="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===Mx){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const d=this.getDataAtRowProp(o,u);c=d!==null?d:n}t=c}return t}});function Jy(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;$c.apply(this,[t,e,n,r,i,o,s]),P5(t);let u=x5(a);const c=s.label;let d=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ei(e),o===s.checkedTemplate||Ft(o).toLocaleLowerCase(s.locale)===Ft(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Ft(o).toLocaleLowerCase(s.locale)===Ft(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:en(o)?J(u,"noValue"):(u.style.display="none",J(u,O5),d=!0),_e(u,[[Rl,n],[El,r]]),l&&_e(u,[US(u.checked?t.getTranslatedPhrase(Uy):t.getTranslatedPhrase(Yy)),LY(u.checked),OY()]),!d&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const b=t.getDataAtRowProp(n,c.property);v=b!==null?b:""}const y=H5(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),d&&e.appendChild(a.createTextNode("#bad-value#")),dE.has(t)||(dE.set(t,!0),f());function f(){const y=t.getShortcutManager().getContext("grid"),b={group:I5};y.addShortcuts([{keys:[["space"]],callback:()=>(p(),!w())},{keys:[["enter"]],callback:()=>(p(),!w()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(p(!0),!w()),relativeToGroup:Xy,position:"before"}],b)}function p(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange();if(y)for(let b=0;b<y.length;b++){const{row:_,col:I}=y[b].getTopStartCorner(),{row:L,col:x}=y[b].getBottomEndCorner(),W=[];for(let G=_;G<=L;G+=1)for(let ne=I;ne<=x;ne+=1){const j=t.getCellMeta(G,ne);if(j.type!=="checkbox")return;if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const X=t.getDataAtCell(G,ne);v===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(X)?W.push([G,ne,j.uncheckedTemplate]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(X)&&W.push([G,ne,j.checkedTemplate]):W.push([G,ne,j.uncheckedTemplate])}W.length>0&&t.setDataAtCell(W)}}function w(){const v=t.getSelectedRange();if(v){for(let y=0;y<v.length;y++){const b=v[y].getTopStartCorner(),_=v[y].getBottomEndCorner();for(let I=b.row;I<=_.row;I++)for(let L=b.col;L<=_.col;L++){const x=t.getCellMeta(I,L);if(x.type!=="checkbox")return!1;const W=t.getCell(I,L);if(W==null)return!0;if(W.querySelectorAll("input[type=checkbox]").length>0&&!x.readOnly)return!0}}return!1}}}Jy.RENDERER_TYPE=Mx;function P5(t){let e=fE.get(t);if(!e){const{rootElement:n}=t;e=new mr(t),e.addEventListener(n,"click",r=>N5(r,t)),e.addEventListener(n,"mouseup",r=>D5(r,t)),e.addEventListener(n,"change",r=>L5(r,t)),fE.set(t,e)}return e}function x5(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function H5(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function D5(t,e){const{target:n}=t;eb(n)&&(!n.hasAttribute(Rl)||!n.hasAttribute(El)||setTimeout(e.listen,10))}function N5(t,e){const{target:n}=t;if(!eb(n)||!n.hasAttribute(Rl)||!n.hasAttribute(El))return;const r=parseInt(n.getAttribute(Rl),10),i=parseInt(n.getAttribute(El),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function L5(t,e){const{target:n}=t;if(!eb(n)||!n.hasAttribute(Rl)||!n.hasAttribute(El))return;const r=parseInt(n.getAttribute(Rl),10),i=parseInt(n.getAttribute(El),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function eb(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const $5="checkbox",Ax={CELL_TYPE:$5,editor:_x,renderer:Jy};var Ox={exports:{}};const k5=lN(lY);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=k5}catch{}t.exports=r(i)}})(pd,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(R,h,g,m){i?R.addEventListener(h,g,!!m):R.attachEvent("on"+h,g)},l=function(R,h,g,m){i?R.removeEventListener(h,g,!!m):R.detachEvent("on"+h,g)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,h){return(" "+R.className+" ").indexOf(" "+h+" ")!==-1},d=function(R,h){c(R,h)||(R.className=R.className===""?h:R.className+" "+h)},f=function(R,h){R.className=u((" "+R.className+" ").replace(" "+h+" "," "))},p=function(R){return/Array/.test(Object.prototype.toString.call(R))},w=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},v=function(R){var h=R.getDay();return h===0||h===6},y=function(R){return R%4===0&&R%100!==0||R%400===0},b=function(R,h){return[31,y(R)?29:28,31,30,31,30,31,31,30,31,30,31][h]},_=function(R){w(R)&&R.setHours(0,0,0,0)},I=function(R,h){return R.getTime()===h.getTime()},L=function(R,h,g){var m,E;for(m in h)E=R[m]!==void 0,E&&typeof h[m]=="object"&&h[m]!==null&&h[m].nodeName===void 0?w(h[m])?g&&(R[m]=new Date(h[m].getTime())):p(h[m])?g&&(R[m]=h[m].slice(0)):R[m]=L({},h[m],g):(g||!E)&&(R[m]=h[m]);return R},x=function(R,h,g){var m;o.createEvent?(m=o.createEvent("HTMLEvents"),m.initEvent(h,!0,!1),m=L(m,g),R.dispatchEvent(m)):o.createEventObject&&(m=o.createEventObject(),m=L(m,g),R.fireEvent("on"+h,m))},W=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},G={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ne=function(R,h,g){for(h+=R.firstDay;h>=7;)h-=7;return g?R.i18n.weekdaysShort[h]:R.i18n.weekdays[h]},j=function(R){var h=[],g="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)h.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||h.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&h.push("is-disabled"),R.isToday&&h.push("is-today"),R.isSelected&&(h.push("is-selected"),g="true"),R.hasEvent&&h.push("has-event"),R.isInRange&&h.push("is-inrange"),R.isStartRange&&h.push("is-startrange"),R.isEndRange&&h.push("is-endrange"),'<td data-day="'+R.day+'" class="'+h.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},X=function(R,h){R.setHours(0,0,0,0);var g=R.getDate(),m=R.getDay(),E=h,M=E-1,O=7,Y=function(de){return(de+O-1)%O};R.setDate(g+M-Y(m));var B=new Date(R.getFullYear(),0,E),q=24*60*60*1e3,Q=(R.getTime()-B.getTime())/q,K=1+Math.round((Q-M+Y(B.getDay()))/O);return K},ie=function(R,h,g,m){var E=new Date(g,h,R),M=r?n(E).isoWeek():X(E,m);return'<td class="pika-week">'+M+"</td>"},oe=function(R,h,g,m){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(m?" is-selected":"")+'">'+(h?R.reverse():R).join("")+"</tr>"},se=function(R){return"<tbody>"+R.join("")+"</tbody>"},ve=function(R){var h,g=[];for(R.showWeekNumber&&g.push("<th></th>"),h=0;h<7;h++)g.push('<th scope="col"><abbr title="'+ne(R,h)+'">'+ne(R,h,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?g.reverse():g).join("")+"</tr></thead>"},Pe=function(R,h,g,m,E,M){var O,Y,B,q=R._o,Q=g===q.minYear,K=g===q.maxYear,de='<div id="'+M+'" class="pika-title" role="heading" aria-live="assertive">',Ae,Ee,Oe=!0,z=!0;for(B=[],O=0;O<12;O++)B.push('<option value="'+(g===E?O-h:12+O-h)+'"'+(O===m?' selected="selected"':"")+(Q&&O<q.minMonth||K&&O>q.maxMonth?' disabled="disabled"':"")+">"+q.i18n.months[O]+"</option>");for(Ae='<div class="pika-label">'+q.i18n.months[m]+'<select class="pika-select pika-select-month" tabindex="-1">'+B.join("")+"</select></div>",p(q.yearRange)?(O=q.yearRange[0],Y=q.yearRange[1]+1):(O=g-q.yearRange,Y=1+g+q.yearRange),B=[];O<Y&&O<=q.maxYear;O++)O>=q.minYear&&B.push('<option value="'+O+'"'+(O===g?' selected="selected"':"")+">"+O+"</option>");return Ee='<div class="pika-label">'+g+q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+B.join("")+"</select></div>",q.showMonthAfterYear?de+=Ee+Ae:de+=Ae+Ee,Q&&(m===0||q.minMonth>=m)&&(Oe=!1),K&&(m===11||q.maxMonth<=m)&&(z=!1),h===0&&(de+='<button class="pika-prev'+(Oe?"":" is-disabled")+'" type="button">'+q.i18n.previousMonth+"</button>"),h===R._o.numberOfMonths-1&&(de+='<button class="pika-next'+(z?"":" is-disabled")+'" type="button">'+q.i18n.nextMonth+"</button>"),de+="</div>"},nt=function(R,h,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+ve(R)+se(h)+"</table>"},Ne=function(R){var h=this,g=h.config(R);h._onMouseDown=function(E){if(h._v){E=E||window.event;var M=E.target||E.srcElement;if(M)if(c(M,"is-disabled")||(c(M,"pika-button")&&!c(M,"is-empty")&&!c(M.parentNode,"is-disabled")?(h.setDate(new Date(M.getAttribute("data-pika-year"),M.getAttribute("data-pika-month"),M.getAttribute("data-pika-day"))),g.bound&&s(function(){h.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):c(M,"pika-prev")?h.prevMonth():c(M,"pika-next")&&h.nextMonth()),c(M,"pika-select"))h._c=!0;else if(E.preventDefault)E.preventDefault();else return E.returnValue=!1,!1}},h._onChange=function(E){E=E||window.event;var M=E.target||E.srcElement;M&&(c(M,"pika-select-month")?h.gotoMonth(M.value):c(M,"pika-select-year")&&h.gotoYear(M.value))},h._onKeyChange=function(E){if(E=E||window.event,h.isVisible())switch(E.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7);break;case 8:case 46:h.setDate(null);break}},h._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(r){var E=n(g.field.value,g.format,g.formatStrict);return E&&E.isValid()?E.toDate():null}else return new Date(Date.parse(g.field.value))},h._onInputChange=function(E){var M;E.firedBy!==h&&(M=h._parseFieldValue(),w(M)&&h.setDate(M),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var E=o.activeElement;do if(c(E,"pika-single"))return;while(E=E.parentNode);h._c||(h._b=s(function(){h.hide()},50)),h._c=!1},h._onClick=function(E){E=E||window.event;var M=E.target||E.srcElement,O=M;if(M){!i&&c(M,"pika-select")&&(M.onchange||(M.setAttribute("onchange","return;"),a(M,"change",h._onChange)));do if(c(O,"pika-single")||O===g.trigger)return;while(O=O.parentNode);h._v&&M!==g.trigger&&O!==g.trigger&&h.hide()}},h.el=o.createElement("div"),h.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),a(h.el,"mousedown",h._onMouseDown,!0),a(h.el,"touchend",h._onMouseDown,!0),a(h.el,"change",h._onChange),g.keyboardInput&&a(o,"keydown",h._onKeyChange),g.field&&(g.container?g.container.appendChild(h.el):g.bound?o.body.appendChild(h.el):g.field.parentNode.insertBefore(h.el,g.field.nextSibling),a(g.field,"change",h._onInputChange),g.defaultDate||(g.defaultDate=h._parseFieldValue(),g.setDefaultDate=!0));var m=g.defaultDate;w(m)?g.setDefaultDate?h.setDate(m,!0):h.gotoDate(m):h.gotoDate(new Date),g.bound?(this.hide(),h.el.className+=" is-bound",a(g.trigger,"click",h._onInputClick),a(g.trigger,"focus",h._onInputFocus),a(g.trigger,"blur",h._onInputBlur)):this.show()};return Ne.prototype={config:function(R){this._o||(this._o=L({},G,!0));var h=L(this._o,R,!0);h.isRTL=!!h.isRTL,h.field=h.field&&h.field.nodeName?h.field:null,h.theme=typeof h.theme=="string"&&h.theme?h.theme:null,h.bound=!!(h.bound!==void 0?h.field&&h.bound:h.field),h.trigger=h.trigger&&h.trigger.nodeName?h.trigger:h.field,h.disableWeekends=!!h.disableWeekends,h.disableDayFn=typeof h.disableDayFn=="function"?h.disableDayFn:null;var g=parseInt(h.numberOfMonths,10)||1;if(h.numberOfMonths=g>4?4:g,w(h.minDate)||(h.minDate=!1),w(h.maxDate)||(h.maxDate=!1),h.minDate&&h.maxDate&&h.maxDate<h.minDate&&(h.maxDate=h.minDate=!1),h.minDate&&this.setMinDate(h.minDate),h.maxDate&&this.setMaxDate(h.maxDate),p(h.yearRange)){var m=new Date().getFullYear()-10;h.yearRange[0]=parseInt(h.yearRange[0],10)||m,h.yearRange[1]=parseInt(h.yearRange[1],10)||m}else h.yearRange=Math.abs(parseInt(h.yearRange,10))||G.yearRange,h.yearRange>100&&(h.yearRange=100);return h},toString:function(R){return R=R||this._o.format,w(this._d)?this._o.toString?this._o.toString(this._d,R):r?n(this._d).format(R):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(R,h){r&&n.isMoment(R)&&this.setDate(R.toDate(),h)},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(R,h){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",x(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!w(R)){var g=this._o.minDate,m=this._o.maxDate;w(g)&&R<g?R=g:w(m)&&R>m&&(R=m),this._d=new Date(R.getTime()),_(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),x(this._o.field,"change",{firedBy:this})),!h&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var h=!0;if(w(R)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),m=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),E=R.getTime();m.setMonth(m.getMonth()+1),m.setDate(m.getDate()-1),h=E<g.getTime()||m.getTime()<E}h&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,h){var g=this.getDate()||new Date,m=parseInt(h)*24*60*60*1e3,E;R==="add"?E=new Date(g.valueOf()+m):R==="subtract"&&(E=new Date(g.valueOf()-m)),this.setDate(E)},adjustCalendars:function(){this.calendars[0]=W(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=W({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(_(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=G.minDate,this._o.minYear=G.minYear,this._o.minMonth=G.minMonth,this._o.startRange=G.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(_(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=G.maxDate,this._o.maxYear=G.maxYear,this._o.maxMonth=G.maxMonth,this._o.endRange=G.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var h=this._o,g=h.minYear,m=h.maxYear,E=h.minMonth,M=h.maxMonth,O="",Y;this._y<=g&&(this._y=g,!isNaN(E)&&this._m<E&&(this._m=E)),this._y>=m&&(this._y=m,!isNaN(M)&&this._m>M&&(this._m=M));for(var B=0;B<h.numberOfMonths;B++)Y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),O+='<div class="pika-lendar">'+Pe(this,B,this.calendars[B].year,this.calendars[B].month,this.calendars[0].year,Y)+this.render(this.calendars[B].year,this.calendars[B].month,Y)+"</div>";this.el.innerHTML=O,h.bound&&h.field.type!=="hidden"&&s(function(){h.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),h.bound&&h.field.setAttribute("aria-label",h.ariaLabel)}},adjustPosition:function(){var R,h,g,m,E,M,O,Y,B,q,Q,K;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,h=R,g=this.el.offsetWidth,m=this.el.offsetHeight,E=window.innerWidth||o.documentElement.clientWidth,M=window.innerHeight||o.documentElement.clientHeight,O=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,Q=!0,K=!0,typeof R.getBoundingClientRect=="function")q=R.getBoundingClientRect(),Y=q.left+window.pageXOffset,B=q.bottom+window.pageYOffset;else for(Y=h.offsetLeft,B=h.offsetTop+h.offsetHeight;h=h.offsetParent;)Y+=h.offsetLeft,B+=h.offsetTop;(this._o.reposition&&Y+g>E||this._o.position.indexOf("right")>-1&&Y-g+R.offsetWidth>0)&&(Y=Y-g+R.offsetWidth,Q=!1),(this._o.reposition&&B+m>M+O||this._o.position.indexOf("top")>-1&&B-m-R.offsetHeight>0)&&(B=B-m-R.offsetHeight,K=!1),this.el.style.left=Y+"px",this.el.style.top=B+"px",d(this.el,Q?"left-aligned":"right-aligned"),d(this.el,K?"bottom-aligned":"top-aligned"),f(this.el,Q?"right-aligned":"left-aligned"),f(this.el,K?"top-aligned":"bottom-aligned")}},render:function(R,h,g){var m=this._o,E=new Date,M=b(R,h),O=new Date(R,h,1).getDay(),Y=[],B=[];_(E),m.firstDay>0&&(O-=m.firstDay,O<0&&(O+=7));for(var q=h===0?11:h-1,Q=h===11?0:h+1,K=h===0?R-1:R,de=h===11?R+1:R,Ae=b(K,q),Ee=M+O,Oe=Ee;Oe>7;)Oe-=7;Ee+=7-Oe;for(var z=!1,Ke=0,ke=0;Ke<Ee;Ke++){var ye=new Date(R,h,1+(Ke-O)),He=w(this._d)?I(ye,this._d):!1,Re=I(ye,E),C=m.events.indexOf(ye.toDateString())!==-1,S=Ke<O||Ke>=M+O,A=1+(Ke-O),F=h,P=R,k=m.startRange&&I(m.startRange,ye),H=m.endRange&&I(m.endRange,ye),D=m.startRange&&m.endRange&&m.startRange<ye&&ye<m.endRange,V=m.minDate&&ye<m.minDate||m.maxDate&&ye>m.maxDate||m.disableWeekends&&v(ye)||m.disableDayFn&&m.disableDayFn(ye);S&&(Ke<O?(A=Ae+A,F=q,P=K):(A=A-M,F=Q,P=de));var $={day:A,month:F,year:P,hasEvent:C,isSelected:He,isToday:Re,isDisabled:V,isEmpty:S,isStartRange:k,isEndRange:H,isInRange:D,showDaysInNextAndPreviousMonths:m.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:m.enableSelectionDaysInNextAndPreviousMonths};m.pickWholeWeek&&He&&(z=!0),B.push(j($)),++ke===7&&(m.showWeekNumber&&B.unshift(ie(Ke-O,h,R,m.firstWeekOfYearMinDays)),Y.push(oe(B,m.isRTL,m.pickWholeWeek,z)),B=[],ke=0,z=!1)}return nt(m,Y,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(o,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ne})})(Ox);var F5=Ox.exports;const gE=_A(F5);function Ah(t,e,n){return e=W5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W5(t){var e=V5(t,"string");return typeof e=="symbol"?e:String(e)}function V5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ix="date",mE="dateEditor";class Px extends da{constructor(){super(...arguments),Ah(this,"defaultDateFormat","DD/MM/YYYY"),Ah(this,"isCellEdited",!1),Ah(this,"parentDestroyed",!1),Ah(this,"$datePicker",null)}static get EDITOR_TYPE(){return Ix}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof gE!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),J(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new mr(this);e.addEventListener(this.datePicker,"mousedown",n=>{De(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:mE})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(mE),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?ry(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new gE(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Pt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-dt(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,Z(s,r,!0).isValid()&&this.$datePicker.setMoment(Z(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Z(s,r,!0).isValid()&&this.$datePicker.setMoment(Z(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ic(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=Z(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const B5="date";function xx(t,e,n,r,i,o,s){Hl.apply(this,[t,e,n,r,i,o,s])}xx.RENDERER_TYPE=B5;function Hx(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const U5=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:Hx},Symbol.toStringTag,{value:"Module"})),Y5="date";function tb(t,e){const n=JI(Ix,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=G5(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}tb.VALIDATOR_TYPE=Y5;function G5(t,e){const n=Z(Hx(t)),r=Z(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const z5="date",Dx={CELL_TYPE:z5,editor:Px,renderer:xx,validator:tb},j5="dropdown";class nb extends Zy{static get EDITOR_TYPE(){return j5}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}ge.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===nb&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const K5="dropdown",Nx={CELL_TYPE:K5,editor:nb,renderer:Hl,validator:Fm},X5="handsontable";function Lx(t,e,n,r,i,o,s){Hl.apply(this,[t,e,n,r,i,o,s])}Lx.RENDERER_TYPE=X5;const q5="handsontable",Z5={CELL_TYPE:q5,editor:qy,renderer:Lx},Q5="numeric";class $x extends da{static get EDITOR_TYPE(){return Q5}}function Oh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kx={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var d=typeof Oh=="function"&&Oh;if(!c&&d)return d(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var p=i[u]={exports:{}};r[u][0].call(p.exports,function(w){return s(r[u][1][w]||w)},p,p.exports,n,r,i,o)}return i[u].exports}for(var a=typeof Oh=="function"&&Oh,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",d=c+"Number primitive has more than 15 significant digits: ",f=1e14,p=14,w=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,b=1e9;function _(j){var X=0|j;return 0<j||j===X?X:X-1}function I(j){for(var X,ie,oe=1,se=j.length,ve=j[0]+"";oe<se;){for(X=j[oe++]+"",ie=p-X.length;ie--;X="0"+X);ve+=X}for(se=ve.length;ve.charCodeAt(--se)===48;);return ve.slice(0,se+1||1)}function L(j,X){var ie,oe,se=j.c,ve=X.c,Pe=j.s,nt=X.s,Ne=j.e,R=X.e;if(!Pe||!nt)return null;if(ie=se&&!se[0],oe=ve&&!ve[0],ie||oe)return ie?oe?0:-nt:Pe;if(Pe!=nt)return Pe;if(ie=Pe<0,oe=Ne==R,!se||!ve)return oe?0:!se^ie?1:-1;if(!oe)return R<Ne^ie?1:-1;for(nt=(Ne=se.length)<(R=ve.length)?Ne:R,Pe=0;Pe<nt;Pe++)if(se[Pe]!=ve[Pe])return se[Pe]>ve[Pe]^ie?1:-1;return Ne==R?0:R<Ne^ie?1:-1}function x(j,X,ie,oe){if(j<X||ie<j||j!==(j<0?l(j):u(j)))throw Error(c+(oe||"Argument")+(typeof j=="number"?j<X||ie<j?" out of range: ":" not an integer: ":" not a primitive number: ")+String(j))}function W(j){var X=j.c.length-1;return _(j.e/p)==X&&j.c[X]%2!=0}function G(j,X){return(1<j.length?j.charAt(0)+"."+j.slice(1):j)+(X<0?"e":"e+")+X}function ne(j,X,ie){var oe,se;if(X<0){for(se=ie+".";++X;se+=ie);j=se+j}else if(++X>(oe=j.length)){for(se=ie,X-=oe;--X;se+=ie);j+=se}else X<oe&&(j=j.slice(0,X)+"."+j.slice(X));return j}(s=function j(X){var ie,oe,se,ve,Pe,nt,Ne,R,h,g,m=z.prototype={constructor:z,toString:null,valueOf:null},E=new z(1),M=20,O=4,Y=-7,B=21,q=-1e7,Q=1e7,K=!1,de=1,Ae=0,Ee={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Oe="0123456789abcdefghijklmnopqrstuvwxyz";function z(C,S){var A,F,P,k,H,D,V,$,U=this;if(!(U instanceof z))return new z(C,S);if(S==null){if(C instanceof z)return U.s=C.s,U.e=C.e,void(U.c=(C=C.c)?C.slice():C);if((D=typeof C=="number")&&0*C==0){if(U.s=1/C<0?(C=-C,-1):1,C===~~C){for(k=0,H=C;10<=H;H/=10,k++);return U.e=k,void(U.c=[C])}$=String(C)}else{if($=String(C),!a.test($))return se(U,$,D);U.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(k=$.indexOf("."))&&($=$.replace(".","")),0<(H=$.search(/e/i))?(k<0&&(k=H),k+=+$.slice(H+1),$=$.substring(0,H)):k<0&&(k=$.length)}else{if(x(S,2,Oe.length,"Base"),$=String(C),S==10)return He(U=new z(C instanceof z?C:$),M+U.e+1,O);if(D=typeof C=="number"){if(0*C!=0)return se(U,$,D,S);if(U.s=1/C<0?($=$.slice(1),-1):1,z.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(d+C);D=!1}else U.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(A=Oe.slice(0,S),k=H=0,V=$.length;H<V;H++)if(A.indexOf(F=$.charAt(H))<0){if(F=="."){if(k<H){k=V;continue}}else if(!P&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){P=!0,H=-1,k=0;continue}return se(U,String(C),D,S)}-1<(k=($=oe($,S,10,U.s)).indexOf("."))?$=$.replace(".",""):k=$.length}for(H=0;$.charCodeAt(H)===48;H++);for(V=$.length;$.charCodeAt(--V)===48;);if($=$.slice(H,++V)){if(V-=H,D&&z.DEBUG&&15<V&&(w<C||C!==u(C)))throw Error(d+U.s*C);if(Q<(k=k-H-1))U.c=U.e=null;else if(k<q)U.c=[U.e=0];else{if(U.e=k,U.c=[],H=(k+1)%p,k<0&&(H+=p),H<V){for(H&&U.c.push(+$.slice(0,H)),V-=p;H<V;)U.c.push(+$.slice(H,H+=p));$=$.slice(H),H=p-$.length}else H-=V;for(;H--;$+="0");U.c.push(+$)}}else U.c=[U.e=0]}function Ke(C,S,A,F){var P,k,H,D,V;if(A==null?A=O:x(A,0,8),!C.c)return C.toString();if(P=C.c[0],H=C.e,S==null)V=I(C.c),V=F==1||F==2&&(H<=Y||B<=H)?G(V,H):ne(V,H,"0");else if(k=(C=He(new z(C),S,A)).e,D=(V=I(C.c)).length,F==1||F==2&&(S<=k||k<=Y)){for(;D<S;V+="0",D++);V=G(V,k)}else if(S-=H,V=ne(V,k,"0"),D<k+1){if(0<--S)for(V+=".";S--;V+="0");}else if(0<(S+=k-D))for(k+1==D&&(V+=".");S--;V+="0");return C.s<0&&P?"-"+V:V}function ke(C,S){for(var A,F=1,P=new z(C[0]);F<C.length;F++){if(!(A=new z(C[F])).s){P=A;break}S.call(P,A)&&(P=A)}return P}function ye(C,S,A){for(var F=1,P=S.length;!S[--P];S.pop());for(P=S[0];10<=P;P/=10,F++);return(A=F+A*p-1)>Q?C.c=C.e=null:C.c=A<q?[C.e=0]:(C.e=A,S),C}function He(C,S,A,F){var P,k,H,D,V,$,U,re=C.c,fe=v;if(re){e:{for(P=1,D=re[0];10<=D;D/=10,P++);if((k=S-P)<0)k+=p,H=S,U=(V=re[$=0])/fe[P-H-1]%10|0;else if(($=l((k+1)/p))>=re.length){if(!F)break e;for(;re.length<=$;re.push(0));V=U=0,H=(k%=p)-p+(P=1)}else{for(V=D=re[$],P=1;10<=D;D/=10,P++);U=(H=(k%=p)-p+P)<0?0:V/fe[P-H-1]%10|0}if(F=F||S<0||re[$+1]!=null||(H<0?V:V%fe[P-H-1]),F=A<4?(U||F)&&(A==0||A==(C.s<0?3:2)):5<U||U==5&&(A==4||F||A==6&&(0<k?0<H?V/fe[P-H]:0:re[$-1])%10&1||A==(C.s<0?8:7)),S<1||!re[0])return re.length=0,F?(S-=C.e+1,re[0]=fe[(p-S%p)%p],C.e=-S||0):re[0]=C.e=0,C;if(k==0?(re.length=$,D=1,$--):(re.length=$+1,D=fe[p-k],re[$]=0<H?u(V/fe[P-H]%fe[H])*D:0),F)for(;;){if($==0){for(k=1,H=re[0];10<=H;H/=10,k++);for(H=re[0]+=D,D=1;10<=H;H/=10,D++);k!=D&&(C.e++,re[0]==f&&(re[0]=1));break}if(re[$]+=D,re[$]!=f)break;re[$--]=0,D=1}for(k=re.length;re[--k]===0;re.pop());}C.e>Q?C.c=C.e=null:C.e<q&&(C.c=[C.e=0])}return C}function Re(C){var S,A=C.e;return A===null?C.toString():(S=I(C.c),S=A<=Y||B<=A?G(S,A):ne(S,A,"0"),C.s<0?"-"+S:S)}return z.clone=j,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(C){var S,A;if(C!=null){if(typeof C!="object")throw Error(c+"Object expected: "+C);if(C.hasOwnProperty(S="DECIMAL_PLACES")&&(x(A=C[S],0,b,S),M=A),C.hasOwnProperty(S="ROUNDING_MODE")&&(x(A=C[S],0,8,S),O=A),C.hasOwnProperty(S="EXPONENTIAL_AT")&&((A=C[S])&&A.pop?(x(A[0],-b,0,S),x(A[1],0,b,S),Y=A[0],B=A[1]):(x(A,-b,b,S),Y=-(B=A<0?-A:A))),C.hasOwnProperty(S="RANGE"))if((A=C[S])&&A.pop)x(A[0],-b,-1,S),x(A[1],1,b,S),q=A[0],Q=A[1];else{if(x(A,-b,b,S),!A)throw Error(c+S+" cannot be zero: "+A);q=-(Q=A<0?-A:A)}if(C.hasOwnProperty(S="CRYPTO")){if((A=C[S])!==!!A)throw Error(c+S+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw K=!A,Error(c+"crypto unavailable");K=A}else K=A}if(C.hasOwnProperty(S="MODULO_MODE")&&(x(A=C[S],0,9,S),de=A),C.hasOwnProperty(S="POW_PRECISION")&&(x(A=C[S],0,b,S),Ae=A),C.hasOwnProperty(S="FORMAT")){if(typeof(A=C[S])!="object")throw Error(c+S+" not an object: "+A);Ee=A}if(C.hasOwnProperty(S="ALPHABET")){if(typeof(A=C[S])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(c+S+" invalid: "+A);Oe=A}}return{DECIMAL_PLACES:M,ROUNDING_MODE:O,EXPONENTIAL_AT:[Y,B],RANGE:[q,Q],CRYPTO:K,MODULO_MODE:de,POW_PRECISION:Ae,FORMAT:Ee,ALPHABET:Oe}},z.isBigNumber=function(C){return C instanceof z||C&&C._isBigNumber===!0||!1},z.maximum=z.max=function(){return ke(arguments,m.lt)},z.minimum=z.min=function(){return ke(arguments,m.gt)},z.random=(ve=9007199254740992,Pe=Math.random()*ve&2097151?function(){return u(Math.random()*ve)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(C){var S,A,F,P,k,H=0,D=[],V=new z(E);if(C==null?C=M:x(C,0,b),P=l(C/p),K)if(crypto.getRandomValues){for(S=crypto.getRandomValues(new Uint32Array(P*=2));H<P;)9e15<=(k=131072*S[H]+(S[H+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),S[H]=A[0],S[H+1]=A[1]):(D.push(k%1e14),H+=2);H=P/2}else{if(!crypto.randomBytes)throw K=!1,Error(c+"crypto unavailable");for(S=crypto.randomBytes(P*=7);H<P;)9e15<=(k=281474976710656*(31&S[H])+1099511627776*S[H+1]+4294967296*S[H+2]+16777216*S[H+3]+(S[H+4]<<16)+(S[H+5]<<8)+S[H+6])?crypto.randomBytes(7).copy(S,H):(D.push(k%1e14),H+=7);H=P/7}if(!K)for(;H<P;)(k=Pe())<9e15&&(D[H++]=k%1e14);for(P=D[--H],C%=p,P&&C&&(k=v[p-C],D[H]=u(P/k)*k);D[H]===0;D.pop(),H--);if(H<0)D=[F=0];else{for(F=-1;D[0]===0;D.splice(0,1),F-=p);for(H=1,k=D[0];10<=k;k/=10,H++);H<p&&(F-=p-H)}return V.e=F,V.c=D,V}),z.sum=function(){for(var C=1,S=arguments,A=new z(S[0]);C<S.length;)A=A.plus(S[C++]);return A},oe=function(){var C="0123456789";function S(A,F,P,k){for(var H,D,V=[0],$=0,U=A.length;$<U;){for(D=V.length;D--;V[D]*=F);for(V[0]+=k.indexOf(A.charAt($++)),H=0;H<V.length;H++)V[H]>P-1&&(V[H+1]==null&&(V[H+1]=0),V[H+1]+=V[H]/P|0,V[H]%=P)}return V.reverse()}return function(A,F,P,k,H){var D,V,$,U,re,fe,be,xe,Be=A.indexOf("."),St=M,Qe=O;for(0<=Be&&(U=Ae,Ae=0,A=A.replace(".",""),fe=(xe=new z(F)).pow(A.length-Be),Ae=U,xe.c=S(ne(I(fe.c),fe.e,"0"),10,P,C),xe.e=xe.c.length),$=U=(be=S(A,F,P,H?(D=Oe,C):(D=C,Oe))).length;be[--U]==0;be.pop());if(!be[0])return D.charAt(0);if(Be<0?--$:(fe.c=be,fe.e=$,fe.s=k,be=(fe=ie(fe,xe,St,Qe,P)).c,re=fe.r,$=fe.e),Be=be[V=$+St+1],U=P/2,re=re||V<0||be[V+1]!=null,re=Qe<4?(Be!=null||re)&&(Qe==0||Qe==(fe.s<0?3:2)):U<Be||Be==U&&(Qe==4||re||Qe==6&&1&be[V-1]||Qe==(fe.s<0?8:7)),V<1||!be[0])A=re?ne(D.charAt(1),-St,D.charAt(0)):D.charAt(0);else{if(be.length=V,re)for(--P;++be[--V]>P;)be[V]=0,V||(++$,be=[1].concat(be));for(U=be.length;!be[--U];);for(Be=0,A="";Be<=U;A+=D.charAt(be[Be++]));A=ne(A,$,D.charAt(0))}return A}}(),ie=function(){function C(F,P,k){var H,D,V,$,U=0,re=F.length,fe=P%y,be=P/y|0;for(F=F.slice();re--;)U=((D=fe*(V=F[re]%y)+(H=be*V+($=F[re]/y|0)*fe)%y*y+U)/k|0)+(H/y|0)+be*$,F[re]=D%k;return U&&(F=[U].concat(F)),F}function S(F,P,k,H){var D,V;if(k!=H)V=H<k?1:-1;else for(D=V=0;D<k;D++)if(F[D]!=P[D]){V=F[D]>P[D]?1:-1;break}return V}function A(F,P,k,H){for(var D=0;k--;)F[k]-=D,D=F[k]<P[k]?1:0,F[k]=D*H+F[k]-P[k];for(;!F[0]&&1<F.length;F.splice(0,1));}return function(F,P,k,H,D){var V,$,U,re,fe,be,xe,Be,St,Qe,ct,_t,fa,Ll,Vt,dn,hs,xn=F.s==P.s?1:-1,tn=F.c,yt=P.c;if(!(tn&&tn[0]&&yt&&yt[0]))return new z(F.s&&P.s&&(tn?!yt||tn[0]!=yt[0]:yt)?tn&&tn[0]==0||!yt?0*xn:xn/0:NaN);for(St=(Be=new z(xn)).c=[],xn=k+($=F.e-P.e)+1,D||(D=f,$=_(F.e/p)-_(P.e/p),xn=xn/p|0),U=0;yt[U]==(tn[U]||0);U++);if(yt[U]>(tn[U]||0)&&$--,xn<0)St.push(1),re=!0;else{for(Ll=tn.length,dn=yt.length,xn+=2,1<(fe=u(D/(yt[U=0]+1)))&&(yt=C(yt,fe,D),tn=C(tn,fe,D),dn=yt.length,Ll=tn.length),fa=dn,ct=(Qe=tn.slice(0,dn)).length;ct<dn;Qe[ct++]=0);hs=yt.slice(),hs=[0].concat(hs),Vt=yt[0],yt[1]>=D/2&&Vt++;do{if(fe=0,(V=S(yt,Qe,dn,ct))<0){if(_t=Qe[0],dn!=ct&&(_t=_t*D+(Qe[1]||0)),1<(fe=u(_t/Vt)))for(D<=fe&&(fe=D-1),xe=(be=C(yt,fe,D)).length,ct=Qe.length;S(be,Qe,xe,ct)==1;)fe--,A(be,dn<xe?hs:yt,xe,D),xe=be.length,V=1;else fe==0&&(V=fe=1),xe=(be=yt.slice()).length;if(xe<ct&&(be=[0].concat(be)),A(Qe,be,ct,D),ct=Qe.length,V==-1)for(;S(yt,Qe,dn,ct)<1;)fe++,A(Qe,dn<ct?hs:yt,ct,D),ct=Qe.length}else V===0&&(fe++,Qe=[0]);St[U++]=fe,Qe[0]?Qe[ct++]=tn[fa]||0:(Qe=[tn[fa]],ct=1)}while((fa++<Ll||Qe[0]!=null)&&xn--);re=Qe[0]!=null,St[0]||St.splice(0,1)}if(D==f){for(U=1,xn=St[0];10<=xn;xn/=10,U++);He(Be,k+(Be.e=U+$*p-1)+1,H,re)}else Be.e=$,Be.r=+re;return Be}}(),nt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ne=/^([^.]+)\.$/,R=/^\.([^.]+)$/,h=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,se=function(C,S,A,F){var P,k=A?S:S.replace(g,"");if(h.test(k))C.s=isNaN(k)?null:k<0?-1:1,C.c=C.e=null;else{if(!A&&(k=k.replace(nt,function(H,D,V){return P=(V=V.toLowerCase())=="x"?16:V=="b"?2:8,F&&F!=P?H:D}),F&&(P=F,k=k.replace(Ne,"$1").replace(R,"0.$1")),S!=k))return new z(k,P);if(z.DEBUG)throw Error(c+"Not a"+(F?" base "+F:"")+" number: "+S);C.c=C.e=C.s=null}},m.absoluteValue=m.abs=function(){var C=new z(this);return C.s<0&&(C.s=1),C},m.comparedTo=function(C,S){return L(this,new z(C,S))},m.decimalPlaces=m.dp=function(C,S){var A,F,P;if(C!=null)return x(C,0,b),S==null?S=O:x(S,0,8),He(new z(this),C+this.e+1,S);if(!(A=this.c))return null;if(F=((P=A.length-1)-_(this.e/p))*p,P=A[P])for(;P%10==0;P/=10,F--);return F<0&&(F=0),F},m.dividedBy=m.div=function(C,S){return ie(this,new z(C,S),M,O)},m.dividedToIntegerBy=m.idiv=function(C,S){return ie(this,new z(C,S),0,1)},m.exponentiatedBy=m.pow=function(C,S){var A,F,P,k,H,D,V,$,U=this;if((C=new z(C)).c&&!C.isInteger())throw Error(c+"Exponent not an integer: "+Re(C));if(S!=null&&(S=new z(S)),H=14<C.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!C.c||!C.c[0])return $=new z(Math.pow(+Re(U),H?2-W(C):+Re(C))),S?$.mod(S):$;if(D=C.s<0,S){if(S.c?!S.c[0]:!S.s)return new z(NaN);(F=!D&&U.isInteger()&&S.isInteger())&&(U=U.mod(S))}else{if(9<C.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||H&&24e7<=U.c[1]:U.c[0]<8e13||H&&U.c[0]<=9999975e7)))return k=U.s<0&&W(C)?-0:0,-1<U.e&&(k=1/k),new z(D?1/k:k);Ae&&(k=l(Ae/p+2))}for(V=H?(A=new z(.5),D&&(C.s=1),W(C)):(P=Math.abs(+Re(C)))%2,$=new z(E);;){if(V){if(!($=$.times(U)).c)break;k?$.c.length>k&&($.c.length=k):F&&($=$.mod(S))}if(P){if((P=u(P/2))===0)break;V=P%2}else if(He(C=C.times(A),C.e+1,1),14<C.e)V=W(C);else{if((P=+Re(C))==0)break;V=P%2}U=U.times(U),k?U.c&&U.c.length>k&&(U.c.length=k):F&&(U=U.mod(S))}return F?$:(D&&($=E.div($)),S?$.mod(S):k?He($,Ae,O,void 0):$)},m.integerValue=function(C){var S=new z(this);return C==null?C=O:x(C,0,8),He(S,S.e+1,C)},m.isEqualTo=m.eq=function(C,S){return L(this,new z(C,S))===0},m.isFinite=function(){return!!this.c},m.isGreaterThan=m.gt=function(C,S){return 0<L(this,new z(C,S))},m.isGreaterThanOrEqualTo=m.gte=function(C,S){return(S=L(this,new z(C,S)))===1||S===0},m.isInteger=function(){return!!this.c&&_(this.e/p)>this.c.length-2},m.isLessThan=m.lt=function(C,S){return L(this,new z(C,S))<0},m.isLessThanOrEqualTo=m.lte=function(C,S){return(S=L(this,new z(C,S)))===-1||S===0},m.isNaN=function(){return!this.s},m.isNegative=function(){return this.s<0},m.isPositive=function(){return 0<this.s},m.isZero=function(){return!!this.c&&this.c[0]==0},m.minus=function(C,S){var A,F,P,k,H=this,D=H.s;if(S=(C=new z(C,S)).s,!D||!S)return new z(NaN);if(D!=S)return C.s=-S,H.plus(C);var V=H.e/p,$=C.e/p,U=H.c,re=C.c;if(!V||!$){if(!U||!re)return U?(C.s=-S,C):new z(re?H:NaN);if(!U[0]||!re[0])return re[0]?(C.s=-S,C):new z(U[0]?H:O==3?-0:0)}if(V=_(V),$=_($),U=U.slice(),D=V-$){for((P=(k=D<0)?(D=-D,U):($=V,re)).reverse(),S=D;S--;P.push(0));P.reverse()}else for(F=(k=(D=U.length)<(S=re.length))?D:S,D=S=0;S<F;S++)if(U[S]!=re[S]){k=U[S]<re[S];break}if(k&&(P=U,U=re,re=P,C.s=-C.s),0<(S=(F=re.length)-(A=U.length)))for(;S--;U[A++]=0);for(S=f-1;D<F;){if(U[--F]<re[F]){for(A=F;A&&!U[--A];U[A]=S);--U[A],U[F]+=f}U[F]-=re[F]}for(;U[0]==0;U.splice(0,1),--$);return U[0]?ye(C,U,$):(C.s=O==3?-1:1,C.c=[C.e=0],C)},m.modulo=m.mod=function(C,S){var A,F,P=this;return C=new z(C,S),!P.c||!C.s||C.c&&!C.c[0]?new z(NaN):!C.c||P.c&&!P.c[0]?new z(P):(de==9?(F=C.s,C.s=1,A=ie(P,C,0,3),C.s=F,A.s*=F):A=ie(P,C,0,de),(C=P.minus(A.times(C))).c[0]||de!=1||(C.s=P.s),C)},m.multipliedBy=m.times=function(C,S){var A,F,P,k,H,D,V,$,U,re,fe,be,xe,Be,St,Qe=this,ct=Qe.c,_t=(C=new z(C,S)).c;if(!(ct&&_t&&ct[0]&&_t[0]))return!Qe.s||!C.s||ct&&!ct[0]&&!_t||_t&&!_t[0]&&!ct?C.c=C.e=C.s=null:(C.s*=Qe.s,ct&&_t?(C.c=[0],C.e=0):C.c=C.e=null),C;for(F=_(Qe.e/p)+_(C.e/p),C.s*=Qe.s,(V=ct.length)<(re=_t.length)&&(xe=ct,ct=_t,_t=xe,P=V,V=re,re=P),P=V+re,xe=[];P--;xe.push(0));for(Be=f,St=y,P=re;0<=--P;){for(A=0,fe=_t[P]%St,be=_t[P]/St|0,k=P+(H=V);P<k;)A=(($=fe*($=ct[--H]%St)+(D=be*$+(U=ct[H]/St|0)*fe)%St*St+xe[k]+A)/Be|0)+(D/St|0)+be*U,xe[k--]=$%Be;xe[k]=A}return A?++F:xe.splice(0,1),ye(C,xe,F)},m.negated=function(){var C=new z(this);return C.s=-C.s||null,C},m.plus=function(C,S){var A,F=this,P=F.s;if(S=(C=new z(C,S)).s,!P||!S)return new z(NaN);if(P!=S)return C.s=-S,F.minus(C);var k=F.e/p,H=C.e/p,D=F.c,V=C.c;if(!k||!H){if(!D||!V)return new z(P/0);if(!D[0]||!V[0])return V[0]?C:new z(D[0]?F:0*P)}if(k=_(k),H=_(H),D=D.slice(),P=k-H){for((A=0<P?(H=k,V):(P=-P,D)).reverse();P--;A.push(0));A.reverse()}for((P=D.length)-(S=V.length)<0&&(A=V,V=D,D=A,S=P),P=0;S;)P=(D[--S]=D[S]+V[S]+P)/f|0,D[S]=f===D[S]?0:D[S]%f;return P&&(D=[P].concat(D),++H),ye(C,D,H)},m.precision=m.sd=function(C,S){var A,F,P;if(C!=null&&C!==!!C)return x(C,1,b),S==null?S=O:x(S,0,8),He(new z(this),C,S);if(!(A=this.c))return null;if(F=(P=A.length-1)*p+1,P=A[P]){for(;P%10==0;P/=10,F--);for(P=A[0];10<=P;P/=10,F++);}return C&&this.e+1>F&&(F=this.e+1),F},m.shiftedBy=function(C){return x(C,-w,w),this.times("1e"+C)},m.squareRoot=m.sqrt=function(){var C,S,A,F,P,k=this,H=k.c,D=k.s,V=k.e,$=M+4,U=new z("0.5");if(D!==1||!H||!H[0])return new z(!D||D<0&&(!H||H[0])?NaN:H?k:1/0);if((A=(D=Math.sqrt(+Re(k)))==0||D==1/0?(((S=I(H)).length+V)%2==0&&(S+="0"),D=Math.sqrt(+S),V=_((V+1)/2)-(V<0||V%2),new z(S=D==1/0?"1e"+V:(S=D.toExponential()).slice(0,S.indexOf("e")+1)+V)):new z(D+"")).c[0]){for((D=(V=A.e)+$)<3&&(D=0);;)if(P=A,A=U.times(P.plus(ie(k,P,$,1))),I(P.c).slice(0,D)===(S=I(A.c)).slice(0,D)){if(A.e<V&&--D,(S=S.slice(D-3,D+1))!="9999"&&(F||S!="4999")){+S&&(+S.slice(1)||S.charAt(0)!="5")||(He(A,A.e+M+2,1),C=!A.times(A).eq(k));break}if(!F&&(He(P,P.e+M+2,0),P.times(P).eq(k))){A=P;break}$+=4,D+=4,F=1}}return He(A,A.e+M+1,O,C)},m.toExponential=function(C,S){return C!=null&&(x(C,0,b),C++),Ke(this,C,S,1)},m.toFixed=function(C,S){return C!=null&&(x(C,0,b),C=C+this.e+1),Ke(this,C,S)},m.toFormat=function(C,S,A){var F;if(A==null)C!=null&&S&&typeof S=="object"?(A=S,S=null):C&&typeof C=="object"?(A=C,C=S=null):A=Ee;else if(typeof A!="object")throw Error(c+"Argument not an object: "+A);if(F=this.toFixed(C,S),this.c){var P,k=F.split("."),H=+A.groupSize,D=+A.secondaryGroupSize,V=A.groupSeparator||"",$=k[0],U=k[1],re=this.s<0,fe=re?$.slice(1):$,be=fe.length;if(D&&(P=H,H=D,be-=D=P),0<H&&0<be){for(P=be%H||H,$=fe.substr(0,P);P<be;P+=H)$+=V+fe.substr(P,H);0<D&&($+=V+fe.slice(P)),re&&($="-"+$)}F=U?$+(A.decimalSeparator||"")+((D=+A.fractionGroupSize)?U.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):U):$}return(A.prefix||"")+F+(A.suffix||"")},m.toFraction=function(C){var S,A,F,P,k,H,D,V,$,U,re,fe,be=this,xe=be.c;if(C!=null&&(!(D=new z(C)).isInteger()&&(D.c||D.s!==1)||D.lt(E)))throw Error(c+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Re(D));if(!xe)return new z(be);for(S=new z(E),$=A=new z(E),F=V=new z(E),fe=I(xe),k=S.e=fe.length-be.e-1,S.c[0]=v[(H=k%p)<0?p+H:H],C=!C||0<D.comparedTo(S)?0<k?S:$:D,H=Q,Q=1/0,D=new z(fe),V.c[0]=0;U=ie(D,S,0,1),(P=A.plus(U.times(F))).comparedTo(C)!=1;)A=F,F=P,$=V.plus(U.times(P=$)),V=P,S=D.minus(U.times(P=S)),D=P;return P=ie(C.minus(A),F,0,1),V=V.plus(P.times($)),A=A.plus(P.times(F)),V.s=$.s=be.s,re=ie($,F,k*=2,O).minus(be).abs().comparedTo(ie(V,A,k,O).minus(be).abs())<1?[$,F]:[V,A],Q=H,re},m.toNumber=function(){return+Re(this)},m.toPrecision=function(C,S){return C!=null&&x(C,1,b),Ke(this,C,S,2)},m.toString=function(C){var S,A=this,F=A.s,P=A.e;return P===null?F?(S="Infinity",F<0&&(S="-"+S)):S="NaN":(S=C==null?P<=Y||B<=P?G(I(A.c),P):ne(I(A.c),P,"0"):C===10?ne(I((A=He(new z(A),M+P+1,O)).c),A.e,"0"):(x(C,2,Oe.length,"Base"),oe(ne(I(A.c),P,"0"),10,C,F,!0)),F<0&&A.c[0]&&(S="-"+S)),S},m.valueOf=m.toJSON=function(){return Re(this)},m._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(m[Symbol.toStringTag]="BigNumber",m[Symbol.for("nodejs.util.inspect.custom")]=m.valueOf),X!=null&&z.set(X),z}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(_,I){return function(L){if(Array.isArray(L))return L}(_)||function(L,x){var W=[],G=!0,ne=!1,j=void 0;try{for(var X,ie=L[Symbol.iterator]();!(G=(X=ie.next()).done)&&(W.push(X.value),!x||W.length!==x);G=!0);}catch(oe){ne=!0,j=oe}finally{try{G||ie.return==null||ie.return()}finally{if(ne)throw j}}return W}(_,I)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(_){var I=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},L=2<arguments.length?arguments[2]:void 0;if(typeof I=="string"&&(I=l.parseFormat(I)),!a.validateFormat(I))return"ERROR: invalid format";var x=I.prefix||"",W=I.postfix||"",G=function(ne,j,X){switch(j.output){case"currency":return j=b(j,s.currentCurrencyDefaultFormat()),function(Oe,z,Ke){var ke=Ke.currentCurrency(),ye=Object.assign({},d,z),He=void 0,Re="",C=!!ye.totalLength||!!ye.forceAverage||ye.average,S=z.currencyPosition||ke.position,A=z.currencySymbol||ke.symbol;ye.spaceSeparated&&(Re=" "),S==="infix"&&(He=Re+A+Re);var F=y({instance:Oe,providedFormat:z,state:Ke,decimalSeparator:He});return S==="prefix"&&(F=Oe._value<0&&ye.negative==="sign"?"-".concat(Re).concat(A).concat(F.slice(1)):A+Re+F),S&&S!=="postfix"||(F=F+(Re=C?"":Re)+A),F}(ne,j,s);case"percent":return j=b(j,s.currentPercentageDefaultFormat()),function(Oe,z,Ke,ke){var ye=z.prefixSymbol,He=y({instance:ke(100*Oe._value),providedFormat:z,state:Ke}),Re=Object.assign({},d,z);return ye?"%".concat(Re.spaceSeparated?" ":"").concat(He):"".concat(He).concat(Re.spaceSeparated?" ":"","%")}(ne,j,s,X);case"byte":return j=b(j,s.currentByteDefaultFormat()),E=ne,O=s,Y=X,B=(M=j).base||"binary",q=c[B],Q=p(E._value,q.suffixes,q.scale),K=Q.value,de=Q.suffix,Ae=y({instance:Y(K),providedFormat:M,state:O,defaults:O.currentByteDefaultFormat()}),Ee=O.currentAbbreviations(),"".concat(Ae).concat(Ee.spaced?" ":"").concat(de);case"time":return j=b(j,s.currentTimeDefaultFormat()),R=ne,h=Math.floor(R._value/60/60),g=Math.floor((R._value-60*h*60)/60),m=Math.round(R._value-60*h*60-60*g),"".concat(h,":").concat(g<10?"0":"").concat(g,":").concat(m<10?"0":"").concat(m);case"ordinal":return j=b(j,s.currentOrdinalDefaultFormat()),ie=ne,oe=j,ve=(se=s).currentOrdinal(),Pe=Object.assign({},d,oe),nt=y({instance:ie,providedFormat:oe,state:se}),Ne=ve(ie._value),"".concat(nt).concat(Pe.spaceSeparated?" ":"").concat(Ne);case"number":default:return y({instance:ne,providedFormat:j,numbro:X})}var ie,oe,se,ve,Pe,nt,Ne,R,h,g,m,E,M,O,Y,B,q,Q,K,de,Ae,Ee}(_,I,L);return G=(G=x+G)+W}function p(_,I,L){var x=I[0],W=Math.abs(_);if(L<=W){for(var G=1;G<I.length;++G){var ne=Math.pow(L,G),j=Math.pow(L,G+1);if(ne<=W&&W<j){x=I[G],_/=ne;break}}x===I[0]&&(_/=Math.pow(L,I.length-1),x=I[I.length-1])}return{value:_,suffix:x}}function w(_){for(var I="",L=0;L<_;L++)I+="0";return I}function v(_,I){return _.toString().indexOf("e")!==-1?function(L,x){var W=L.toString(),G=o(W.split("e"),2),ne=G[0],j=G[1],X=o(ne.split("."),2),ie=X[0],oe=X[1],se=oe===void 0?"":oe;if(0<+j)W=ie+se+w(j-se.length);else{var ve=".";ve=+ie<0?"-0".concat(ve):"0".concat(ve);var Pe=(w(-j-1)+Math.abs(ie)+se).substr(0,x);Pe.length<x&&(Pe+=w(x-Pe.length)),W=ve+Pe}return 0<+j&&0<x&&(W+=".".concat(w(x))),W}(_,I):(Math.round(+"".concat(_,"e+").concat(I))/Math.pow(10,I)).toFixed(I)}function y(_){var I=_.instance,L=_.providedFormat,x=_.state,W=x===void 0?s:x,G=_.decimalSeparator,ne=_.defaults,j=ne===void 0?W.currentDefaults():ne,X=I._value;if(X===0&&W.hasZeroFormat())return W.getZeroFormat();if(!isFinite(X))return X.toString();var ie,oe,se,ve,Pe,nt,Ne,R,h=Object.assign({},d,j,L),g=h.totalLength,m=g?0:h.characteristic,E=h.optionalCharacteristic,M=h.forceAverage,O=!!g||!!M||h.average,Y=g?-1:O&&L.mantissa===void 0?0:h.mantissa,B=!g&&(L.optionalMantissa===void 0?Y===-1:h.optionalMantissa),q=h.trimMantissa,Q=h.thousandSeparated,K=h.spaceSeparated,de=h.negative,Ae=h.forceSign,Ee=h.exponential,Oe="";if(O){var z=function(C){var S=C.value,A=C.forceAverage,F=C.abbreviations,P=C.spaceSeparated,k=P!==void 0&&P,H=C.totalLength,D=H===void 0?0:H,V="",$=Math.abs(S),U=-1;if($>=Math.pow(10,12)&&!A||A==="trillion"?(V=F.trillion,S/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!A||A==="billion"?(V=F.billion,S/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!A||A==="million"?(V=F.million,S/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!A||A==="thousand")&&(V=F.thousand,S/=Math.pow(10,3)),V&&(V=(k?" ":"")+V),D){var re=S.toString().split(".")[0];U=Math.max(D-re.length,0)}return{value:S,abbreviation:V,mantissaPrecision:U}}({value:X,forceAverage:M,abbreviations:W.currentAbbreviations(),spaceSeparated:K,totalLength:g});X=z.value,Oe+=z.abbreviation,g&&(Y=z.mantissaPrecision)}if(Ee){var Ke=(oe=(ie={value:X,characteristicPrecision:m}).value,se=ie.characteristicPrecision,ve=se===void 0?0:se,Pe=o(oe.toExponential().split("e"),2),nt=Pe[0],Ne=Pe[1],R=+nt,ve&&1<ve&&(R*=Math.pow(10,ve-1),Ne=0<=(Ne=+Ne-(ve-1))?"+".concat(Ne):Ne),{value:R,abbreviation:"e".concat(Ne)});X=Ke.value,Oe=Ke.abbreviation+Oe}var ke,ye,He,Re=function(C,S,A,F,P){if(F===-1)return C;var k=v(S,F),H=o(k.toString().split("."),2),D=H[0],V=H[1],$=V===void 0?"":V;if($.match(/^0+$/)&&(A||P))return D;var U=$.match(/0+$/);return P&&U?"".concat(D,".").concat($.toString().slice(0,U.index)):k.toString()}(X.toString(),X,B,Y,q);return Re=function(C,S,A,F,P){var k=F.currentDelimiters(),H=k.thousands;P=P||k.decimal;var D=k.thousandsSize||3,V=C.toString(),$=V.split(".")[0],U=V.split(".")[1];return A&&(S<0&&($=$.slice(1)),function(re,fe){for(var be=[],xe=0,Be=re;0<Be;Be--)xe===fe&&(be.unshift(Be),xe=0),xe++;return be}($.length,D).forEach(function(re,fe){$=$.slice(0,re+fe)+H+$.slice(re+fe)}),S<0&&($="-".concat($))),V=U?$+P+U:$}(Re=function(C,S,A,F){var P=C,k=o(P.toString().split("."),2),H=k[0],D=k[1];if(H.match(/^-?0$/)&&A)return D?"".concat(H.replace("0",""),".").concat(D):H.replace("0","");if(H.length<F)for(var V=F-H.length,$=0;$<V;$++)P="0".concat(P);return P.toString()}(Re,0,E,m),X,Q,W,G),(O||Ee)&&(Re=Re+Oe),(Ae||X<0)&&(ke=Re,He=de,Re=(ye=X)===0?ke:+ke==0?ke.replace("-",""):0<ye?"+".concat(ke):He==="sign"?ke:"(".concat(ke.replace("-",""),")")),Re}function b(_,I){if(!_)return I;var L=Object.keys(_);return L.length===1&&L[0]==="output"?I:_}r.exports=function(_){return{format:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return f.apply(void 0,L.concat([_]))},getByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(W){var G=c.general;return p(W._value,G.suffixes,G.scale).suffix}).apply(void 0,L.concat([_]))},getBinaryByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(W){var G=c.binary;return p(W._value,G.suffixes,G.scale).suffix}).apply(void 0,L.concat([_]))},getDecimalByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(W){var G=c.decimal;return p(W._value,G.suffixes,G.scale).suffix}).apply(void 0,L.concat([_]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},d=null,f={};function p(v){u=v}function w(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return w().currency},l.currentAbbreviations=function(){return w().abbreviations},l.currentDelimiters=function(){return w().delimiters},l.currentOrdinal=function(){return w().ordinal},l.currentDefaults=function(){return Object.assign({},w().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().timeFormat)},l.setDefaults=function(v){v=a.parseFormat(v),s.validateFormat(v)&&(f=v)},l.getZeroFormat=function(){return d},l.setZeroFormat=function(v){return d=typeof v=="string"?v:null},l.hasZeroFormat=function(){return d!==null},l.languageData=function(v){if(v){if(c[v])return c[v];throw new Error('Unknown tag "'.concat(v,'"'))}return w()},l.registerLanguage=function(v){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(v))throw new Error("Invalid language data");c[v.languageTag]=v,y&&p(v.languageTag)},l.setLanguage=function(v){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[v]){var b=v.split("-")[0],_=Object.keys(c).find(function(I){return I.split("-")[0]===b});return c[_]?void p(_):void p(y)}p(v)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),d=l;return u.isNumbro(l)&&(d=l._value),d=new o(d),a._value=c.minus(d).toNumber(),a}r.exports=function(a){return{add:function(l,u){return d=u,f=a,p=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=p.plus(w).toNumber(),c;var c,d,f,p,w},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return d=u,f=a,p=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=p.times(w).toNumber(),c;var c,d,f,p,w},divide:function(l,u){return d=u,f=a,p=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=p.dividedBy(w).toNumber(),c;var c,d,f,p,w},set:function(l,u){return c=l,f=d=u,a.isNumbro(d)&&(f=d._value),c._value=f,c;var c,d,f},difference:function(l,u){return c=u,s(f=(d=a)(l._value),c,d),Math.abs(f._value);var c,d,f}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(y,b){for(var _=0;_<b.length;_++){var I=b[_];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(y,I.key,I)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(v),u=n("./unformatting"),c=n("./formatting")(v),d=n("./manipulating")(v),f=n("./parsing"),p=function(){function y(I){(function(L,x){if(!(L instanceof x))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=I}var b,_;return b=y,(_=[{key:"clone",value:function(){return v(this._value)}},{key:"format",value:function(){var I=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,I)}},{key:"formatCurrency",value:function(I){return typeof I=="string"&&(I=f.parseFormat(I)),(I=c.formatOrDefault(I,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,I)}},{key:"formatTime",value:function(){var I=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return I.output="time",c.format(this,I)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(I){return d.difference(this,I)}},{key:"add",value:function(I){return d.add(this,I)}},{key:"subtract",value:function(I){return d.subtract(this,I)}},{key:"multiply",value:function(I){return d.multiply(this,I)}},{key:"divide",value:function(I){return d.divide(this,I)}},{key:"set",value:function(I){return d.set(this,w(I))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(b.prototype,_),y}();function w(y){var b=y;return v.isNumbro(y)?b=y._value:typeof y=="string"?b=v.unformat(y):isNaN(y)&&(b=NaN),b}function v(y){return new p(w(y))}v.version="2.1.2",v.isNumbro=function(y){return y instanceof p},v.language=s.currentLanguage,v.registerLanguage=s.registerLanguage,v.setLanguage=s.setLanguage,v.languages=s.languages,v.languageData=s.languageData,v.zeroFormat=s.setZeroFormat,v.defaultFormat=s.currentDefaults,v.setDefaults=s.setDefaults,v.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,v.validate=a.validate,v.loadLanguagesInNode=l.loadLanguagesInNode,v.unformat=u.unformat,r.exports=v},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,d,f,p,w,v,y,b,_,I,L,x,W,G,ne,j,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=X,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=X,function(ie,oe){if(ie.indexOf("$")===-1){if(ie.indexOf("%")===-1)return ie.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):ie.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):ie.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):ie.indexOf(":")===-1?ie.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(o=(d=(u=o).match(/{([^}]*)}$/))?(c.postfix=d[1],u.slice(0,-d[0].length)):u,X),f=X,(p=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+p[0]),w=X,(v=o.split(".")[0].match(/0+/))&&(w.characteristic=v[0].length),function(ie,oe){if(ie.indexOf(".")!==-1){var se=ie.split(".")[0];oe.optionalCharacteristic=se.indexOf("0")===-1}}(o,X),y=X,o.indexOf("a")!==-1&&(y.average=!0),_=X,(b=o).indexOf("K")!==-1?_.forceAverage="thousand":b.indexOf("M")!==-1?_.forceAverage="million":b.indexOf("B")!==-1?_.forceAverage="billion":b.indexOf("T")!==-1&&(_.forceAverage="trillion"),function(ie,oe){var se=ie.split(".")[1];if(se){var ve=se.match(/0+/);ve&&(oe.mantissa=ve[0].length)}}(o,X),L=X,(I=o).match(/\[\.]/)?L.optionalMantissa=!0:I.match(/\./)&&(L.optionalMantissa=!1),x=X,o.indexOf(",")!==-1&&(x.thousandSeparated=!0),W=X,o.indexOf(" ")!==-1&&(W.spaceSeparated=!0),ne=X,(G=o).match(/^\+?\([^)]*\)$/)&&(ne.negative="parenthesis"),G.match(/^\+?-/)&&(ne.negative="sign"),j=X,o.match(/^\+/)&&(j.forceSign=!0),X)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,p=5<arguments.length?arguments[5]:void 0,w=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function v(y,b){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",I=3<arguments.length?arguments[3]:void 0,L=4<arguments.length?arguments[4]:void 0,x=5<arguments.length?arguments[5]:void 0,W=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var G="",ne=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ne!==y)return-1*v(ne,b,_,I,L,x,W);for(var j=0;j<o.length;j++){var X=o[j];if((G=y.replace(X.key,""))!==y)return v(G,b,_,I,L,x,W)*X.factor}if((G=y.replace("%",""))!==y)return v(G,b,_,I,L,x,W)/100;var ie=parseFloat(y);if(!isNaN(ie)){var oe=I(ie);if(oe&&oe!=="."&&(G=y.replace(new RegExp("".concat(s(oe),"$")),""))!==y)return v(G,b,_,I,L,x,W);var se={};Object.keys(x).forEach(function(g){se[x[g]]=g});for(var ve=Object.keys(se).sort().reverse(),Pe=ve.length,nt=0;nt<Pe;nt++){var Ne=ve[nt],R=se[Ne];if((G=y.replace(Ne,""))!==y){var h=void 0;switch(R){case"thousand":h=Math.pow(10,3);break;case"million":h=Math.pow(10,6);break;case"billion":h=Math.pow(10,9);break;case"trillion":h=Math.pow(10,12)}return v(G,b,_,I,L,x,W)*h}}}}(function(v,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=v.replace(b,"");return _=(_=_.replace(new RegExp("([0-9])".concat(s(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(l,u,c),u,c,d,f,p,w)}r.exports={unformat:function(l,u){var c,d,f,p=n("./globalState"),w=p.currentDelimiters(),v=p.currentCurrency().symbol,y=p.currentOrdinal(),b=p.getZeroFormat(),_=p.currentAbbreviations(),I=void 0;if(typeof l=="string")I=function(L,x){if(!L.indexOf(":")||x.thousands===":")return!1;var W=L.split(":");if(W.length!==3)return!1;var G=+W[0],ne=+W[1],j=+W[2];return!isNaN(G)&&!isNaN(ne)&&!isNaN(j)}(l,w)?(c=l.split(":"),d=+c[0],f=+c[1],+c[2]+60*f+3600*d):a(l,w,v,y,b,_,u);else{if(typeof l!="number")return;I=l}if(I!==void 0)return I}}},{"./globalState":4}],10:[function(n,r,i){function o(w){return function(v){if(Array.isArray(v)){for(var y=0,b=new Array(v.length);y<v.length;y++)b[y]=v[y];return b}}(w)||function(v){if(Symbol.iterator in Object(v)||Object.prototype.toString.call(v)==="[object Arguments]")return Array.from(v)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(w){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(w)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(w,v){return v.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(w){return w.output==="byte"}},characteristic:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(w){return 0<=w},message:"value must be positive"},{restriction:function(w,v){return!v.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(w,v){return v.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(w){return w.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(w){return!!a.unformat(w)}function f(w,v,y){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],_=Object.keys(w).map(function(I){if(!v[I])return console.error("".concat(y," Invalid key: ").concat(I)),!1;var L=w[I],x=v[I];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!f(L,u,"[Validate ".concat(I,"]"),!0))return!1}else if(s(L)!==x.type)return console.error("".concat(y," ").concat(I,' type mismatched: "').concat(x.type,'" expected, "').concat(s(L),'" provided')),!1;if(x.restrictions&&x.restrictions.length)for(var W=x.restrictions.length,G=0;G<W;G++){var ne=x.restrictions[G],j=ne.restriction,X=ne.message;if(!j(L,w))return console.error("".concat(y," ").concat(I," invalid value: ").concat(X)),!1}return x.restriction&&!x.restriction(L,w)?(console.error("".concat(y," ").concat(I," invalid value: ").concat(x.message)),!1):x.validValues&&x.validValues.indexOf(L)===-1?(console.error("".concat(y," ").concat(I," invalid value: must be among ").concat(JSON.stringify(x.validValues),', "').concat(L,'" provided')),!1):!(x.children&&!f(L,x.children,"[Validate ".concat(I,"]")))});return b||_.push.apply(_,o(Object.keys(v).map(function(I){var L=v[I];if(typeof L=="string"&&(L={type:L}),L.mandatory){var x=L.mandatory;if(typeof x=="function"&&(x=x(w)),x&&w[I]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(I,'"')),!1}return!0}))),_.reduce(function(I,L){return I&&L},!0)}function p(w){return f(w,u,"[Validate format]")}r.exports={validate:function(w,v){var y=d(w),b=p(v);return y&&b},validateFormat:p,validateInput:d,validateLanguage:function(w){return f(w,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(kx);var J5=kx.exports;const ys=_A(J5),e8="numeric";function rb(t,e,n,r,i,o,s){let a=o;if(Bn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,d=s.className||"",f=d.length?d.split(" "):[];if(typeof u<"u"&&!ys.languages()[u]){const p=u.replace("-",""),w=ys.allLanguages?ys.allLanguages[u]:ys[p];w&&ys.registerLanguage(w)}ys.setLanguage(u),a=ys(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}To(t,e,n,r,i,a,s)}rb.RENDERER_TYPE=e8;const t8="numeric";function ib(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Bn(t))}ib.VALIDATOR_TYPE=t8;const n8="numeric",Fx={CELL_TYPE:n8,editor:$x,renderer:rb,validator:ib,dataType:"number"},r8="password";class Wx extends da{static get EDITOR_TYPE(){return r8}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[yo()]),ei(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const i8="password";function ob(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";Ce(a-1,()=>{u+=l}),ca(e,u)}ob.RENDERER_TYPE=i8;const o8="password",s8={CELL_TYPE:o8,editor:Wx,renderer:ob,copyable:!1},dw="ht_editor_visible",pE="selectEditor",a8="select";class Vx extends xl{static get EDITOR_TYPE(){return a8}init(){this.select=this.hot.rootDocument.createElement("SELECT"),J(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",De(this.select,dw)&&$e(this.select,dw),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ei(this.select),Ge(l,(u,c)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=c,ca(d,u),this.select.appendChild(d)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",J(this.select,dw)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:pE};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(pE)}}const l8="select";function Bx(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s])}Bx.RENDERER_TYPE=l8;const u8="select",c8={CELL_TYPE:u8,editor:Vx,renderer:Bx},h8="time";class Ux extends da{static get EDITOR_TYPE(){return h8}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}const d8="time";function sb(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}sb.RENDERER_TYPE=d8;const f8=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],g8="time";function ab(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,f8,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,d,u,"timeValidator"),r=!0}else r=!1;e(r)}ab.VALIDATOR_TYPE=g8;const m8="time",p8={CELL_TYPE:m8,editor:Ux,renderer:sb,validator:ab};function w8(){Rn(M5),Rn(Ax),Rn(Dx),Rn(Nx),Rn(Z5),Rn(Fx),Rn(s8),Rn(c8),Rn(bx),Rn(p8)}function C8(t,e){Yx(t,e),e.add(t)}function v8(t,e,n){Yx(t,e),e.set(t,n)}function Yx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ra(t,e,n){return e=S8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S8(t){var e=y8(t,"string");return typeof e=="symbol"?e:String(e)}function y8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ea(t,e){var n=R8(t,e,"get");return E8(t,n)}function R8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function E8(t,e){return e.get?e.get.call(t):e.value}const wE=new Map([["plugin",dz],["cell-type",dx],["editor",QI],["renderer",aP],["validator",lP]]),T8="base",fw=[];let ui=null;var bs=new WeakMap,CE=new WeakSet;class ot{static get PLUGIN_KEY(){return T8}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){C8(this,CE),Ra(this,"eventManager",new mr(this)),Ra(this,"pluginName",null),Ra(this,"pluginsInitializedCallbacks",[]),Ra(this,"isPluginsReady",!1),Ra(this,"enabled",!1),Ra(this,"initialized",!1),v8(this,bs,{writable:!0,value:{}}),Hi(this,"hot",e,{writable:!1}),ui=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!wE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);wE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");fw.push(o)}}if(ui||(ui=ly()),ui.indexOf("UndoRedo")>=0&&ui.splice(ui.indexOf("UndoRedo"),1),ui.indexOf(this.pluginName)>=0&&ui.splice(ui.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ui.length===0){if(fw.length>0){const i=[`${fw.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){Ea(this,bs)[e]=Ea(this,bs)[e]||[];const r=Ea(this,bs)[e];this.hot.addHook(e,n),r.push(n),Ea(this,bs)[e]=r}removeHooks(e){T(Ea(this,bs)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Ea(this,bs);Ge(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){T(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=b8(this,CE,_8).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ge(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function _8(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Rs(t,e,n){return e=M8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M8(t){var e=A8(t,"string");return typeof e=="symbol"?e:String(e)}function A8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let O8=class{constructor(e){Rs(this,"hot",null),Rs(this,"container",null),Rs(this,"injected",!1),Rs(this,"rows",[]),Rs(this,"columns",[]),Rs(this,"samples",null),Rs(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),T(this.rows,n=>{e(n.row,Pt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),T(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{T(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{T(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{T(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),T(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{T(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),J(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return J(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const lb=O8;function Ih(t,e,n){return e=I8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I8(t){var e=P8(t,"string");return typeof e=="symbol"?e:String(e)}function P8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ub{static get SAMPLE_COUNT(){return 3}constructor(e){Ih(this,"samples",null),Ih(this,"dataFactory",null),Ih(this,"customSampleCount",null),Ih(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:ub.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return Ce(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Ce(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,d=typeof c=="string"&&c.length>0;let f;d?f=c:Ue(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Ft(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const p=i.get(f);p.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||d)&&(p.strings.push({value:u,[o]:a}),s.push(u),p.needed-=1)}),i}}const Gx=ub;function Ta(t,e){zx(t,e),e.add(t)}function x8(t,e,n){zx(t,e),e.set(t,n)}function zx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _a(t,e,n){return e=H8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H8(t){var e=D8(t,"string");return typeof e=="symbol"?e:String(e)}function D8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function N8(t,e,n){var r=jx(t,e,"set");return L8(t,r,n),n}function L8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ph(t,e){var n=jx(t,e,"get");return $8(t,n)}function jx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $8(t,e){return e.get?e.get.call(t):e.value}function Es(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("modifyAutoColumnSizeSeed");const Jl="autoColumnSize",k8=10,F8="autoColumnSize";var rl=new WeakMap,vE=new WeakSet,SE=new WeakSet,yE=new WeakSet,gw=new WeakSet,bE=new WeakSet,RE=new WeakSet;class ml extends ot{static get PLUGIN_KEY(){return Jl}static get PLUGIN_PRIORITY(){return k8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Ta(this,RE),Ta(this,bE),Ta(this,gw),Ta(this,yE),Ta(this,SE),Ta(this,vE),_a(this,"ghostTable",new lb(this.hot)),_a(this,"samplesGenerator",new Gx((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),_a(this,"firstCalculation",!0),_a(this,"inProgress",!1),_a(this,"measuredColumns",0),_a(this,"columnWidthsMap",new cs),x8(this,rl,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(F8,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Es(this,gw,EE).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Jl]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Jl];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Es(e,SE,V8).call(e,...i)}),this.addHook("beforeChangeRender",r=>Es(this,yE,B8).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>Es(this,RE,Y8).call(this,r)),this.addHook("beforeViewRender",r=>Es(this,vE,W8).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>Es(this,bE,U8).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Es(this,gw,EE).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;Ce(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);T(l,u=>{let[c,d]=u;return this.ghostTable.addColumn(c,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){lc(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+ml.CALCULATION_STEP,r)},e),n=n+ml.CALCULATION_STEP+1,n<r?i=pg(o):(lc(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Jl],n=e&&It(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&It(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Jl];let n=ml.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Ue(e)&&(n=e.syncLimit,VS(n)?n=sy(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,hy.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Yt(e,(r,i,o)=>{const s=Ph(this,rl).length;return(s-1<o||Ph(this,rl)[o]!==i)&&r.push(o),s-1<o?Ph(this,rl).push(i):Ph(this,rl)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{T(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!gr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function W8(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function V8(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function B8(t){const e=Ye(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function EE(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function U8(){N8(this,rl,this.hot.getColHeader())}function Y8(t){const e=gr(t,r=>{var i;return he((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ye(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const zs={horizontal:"horizontal",vertical:"vertical"};function G8(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function z8(t){const e={};return t===!0?(e.directions=Object.keys(zs),e.autoInsertRow=!0):Ue(t)?(he(t.autoInsertRow)?t.direction===zs.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,he(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(zs)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function eu(t,e){j8(t,e),e.add(t)}function j8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ma(t,e,n){return e=K8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K8(t){var e=X8(t,"string");return typeof e=="symbol"?e:String(e)}function X8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");const TE="autofill",q8=20,Z8=["fillHandle"],Q8="insert_row_below",J8=200;var _E=new WeakSet,ME=new WeakSet,AE=new WeakSet,OE=new WeakSet,IE=new WeakSet;class e7 extends ot{constructor(){super(...arguments),eu(this,IE),eu(this,OE),eu(this,AE),eu(this,ME),eu(this,_E),Ma(this,"addingStarted",!1),Ma(this,"mouseDownOnCellCorner",!1),Ma(this,"mouseDragOutside",!1),Ma(this,"handleDraggedCells",0),Ma(this,"directions",[]),Ma(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return TE}static get PLUGIN_PRIORITY(){return q8}static get SETTING_KEYS(){return[TE,...Z8]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>tu(this,ME,n7).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>tu(this,_E,t7).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>tu(this,AE,r7).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return T(s,c=>{for(let d=c.startRow;d<=c.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=c.startCol;d<=c.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),T(a,c=>{const d=[];T(l,f=>{d.push(this.hot.getCopyableData(c,f))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:d,endOfDragCoords:f}=G8(l,u,(p,w)=>this.hot._createCellCoords(p,w));if(d&&d.row>-1&&d.col>-1){const p=this.getSelectionData(),w=o.clone(),v=this.hot._createCellRange(d,d,f),y=this.hot.runHooks("beforeAutofill",p,w,v,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=y;const _=y;if(["up","left"].indexOf(c)>-1&&!(_.length===1&&_[0].length===0))if(b=[],c==="up"){const I=f.row-d.row+1,L=I%_.length;for(let x=0;x<I;x++)b.push(_[(x+(_.length-L))%_.length])}else{const I=f.col-d.col+1,L=I%_[0].length;for(let x=0;x<_.length;x++){b.push([]);for(let W=0;W<I;W++)b[x].push(_[x][(W+(_[x].length-L))%_[x].length])}}this.hot.populateFromArray(d.row,d.col,b,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",b,w,v,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(zs.vertical)&&this.directions.includes(zs.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(zs.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(zs.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(Q8,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},J8)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ye(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=jt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Pt(this.hot.table),i=jt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+dt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>tu(this,OE,i7).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>tu(this,IE,o7).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=z8(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function t7(){this.selectAdjacent()&&this.fillIn()}function n7(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function r7(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function i7(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function o7(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function xh(t,e){s7(t,e),e.add(t)}function s7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ts(t,e,n){return e=a7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a7(t){var e=l7(t,"string");return typeof e=="symbol"?e:String(e)}function l7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Hh="autoRowSize",u7=40,c7="autoRowSize";var PE=new WeakSet,mw=new WeakSet,xE=new WeakSet,HE=new WeakSet;class Wu extends ot{static get PLUGIN_KEY(){return Hh}static get PLUGIN_PRIORITY(){return u7}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),xh(this,HE),xh(this,xE),xh(this,mw),xh(this,PE),Ts(this,"headerHeight",null),Ts(this,"ghostTable",new lb(this.hot)),Ts(this,"samplesGenerator",new Gx((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),Ts(this,"firstCalculation",!0),Ts(this,"inProgress",!1),Ts(this,"measuredRows",0),Ts(this,"rowHeightsMap",new cs),this.hot.rowIndexMapper.registerMap(c7,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>nu(this,mw,DE).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Hh];return e===!0||Ue(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return nu(e,xE,d7).call(e,...r)}),this.addHook("beforeChangeRender",n=>nu(this,HE,f7).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>nu(this,PE,h7).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>nu(this,mw,DE).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}Ce(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);T(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){lc(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+Wu.CALCULATION_STEP,r)},e),n=n+Wu.CALCULATION_STEP+1,n<r?i=pg(o):(lc(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Hh],n=e&&It(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&It(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){os(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Hh];let n=Wu.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Ue(e)&&(n=e.syncLimit,VS(n)?n=sy(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ce(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!gr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function h7(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function DE(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function d7(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function f7(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:g7,getListWithRemovedItems:m7}=GP("physicallyIndexed");class p7 extends ha{constructor(){super(e=>e)}insert(e,n){const r=$y(this.indexedValues,n);this.indexedValues=g7(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=m7(this.indexedValues,e);this.indexedValues=Ly(n,e),super.remove(e)}}const w7=p7,{getListWithInsertedItems:C7,getListWithRemovedItems:v7}=GP("physicallyIndexed");class S7 extends ha{constructor(){super(e=>e)}insert(e,n){this.indexedValues=C7(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=v7(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const y7=S7;function b7(t,e){R7(t,e),e.add(t)}function R7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function E7(t,e,n){return e=T7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T7(t){var e=_7(t,"string");return typeof e=="symbol"?e:String(e)}function _7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function M7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const pw="bindRowsWithHeaders",A7=210,O7="loose",I7=new Map([["loose",w7],["strict",y7]]);var NE=new WeakSet;class P7 extends ot{constructor(){super(...arguments),b7(this,NE),E7(this,"headerIndexes",null)}static get PLUGIN_KEY(){return pw}static get PLUGIN_PRIORITY(){return A7}isEnabled(){return!!this.hot.getSettings()[pw]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[pw];typeof e!="string"&&(e=O7);const n=I7.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>M7(this,NE,x7).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function x7(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Dh(t,e){Kx(t,e),e.add(t)}function H7(t,e,n){Kx(t,e),e.set(t,n)}function Kx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LE(t,e,n){return e=D7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D7(t){var e=N7(t,"string");return typeof e=="symbol"?e:String(e)}function N7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $E(t,e){var n=Xx(t,e,"get");return L7(t,n)}function L7(t,e){return e.get?e.get.call(t):e.value}function Nh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ww(t,e,n){var r=Xx(t,e,"set");return $7(t,r,n),n}function Xx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const xd="collapsibleColumns",k7=290,F7=["nestedHeaders"],pl="collapsibleIndicator",kE=xd,FE=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Aa=new WeakMap,WE=new WeakSet,VE=new WeakSet,BE=new WeakSet,UE=new WeakSet;class W7 extends ot{constructor(){super(...arguments),Dh(this,UE),Dh(this,BE),Dh(this,VE),Dh(this,WE),LE(this,"nestedHeadersPlugin",null),LE(this,"headerStateManager",null),H7(this,Aa,{writable:!0,value:null})}static get PLUGIN_KEY(){return xd}static get PLUGIN_PRIORITY(){return k7}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[xd,...F7]}isEnabled(){return!!this.hot.getSettings()[xd]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||vt("You need to configure the Nested Headers plugin in order to use collapsible headers."),ww(this,Aa,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Nh(this,BE,U7).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Nh(e,UE,Y7).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Nh(e,WE,V7).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Nh(this,VE,B7).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ww(this,Aa,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:kE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kE)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};Ce(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;Ce(0,a.childNodes.length-1,c=>{let d=a.childNodes[c].querySelector(`.${pl}`);o(d),l&&l.childNodes[c]&&(d=l.childNodes[c].querySelector(`.${pl}`),o(d)),i&&u&&u.childNodes[c]&&(d=u.childNodes[c].querySelector(`.${pl}`),o(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!FE.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=gr(e,f=>{let{row:p}=f;return p<0});let i=r.length>0;T(r,f=>{var p;let{row:w,col:v}=f;const{collapsible:y,isCollapsed:b}=(p=this.headerStateManager.getHeaderSettings(w,v))!==null&&p!==void 0?p:{};if(!y||b&&n==="collapse"||!b&&n==="expand")return i=!1,!1});const o=[],s=[];i&&T(r,f=>{let{row:p,col:w}=f;const{colspanCompensation:v,affectedColumns:y,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,p,w);v>0&&(s.push(...y),o.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=FS([...a,...s]):n==="expand"&&(l=gr(a,f=>!s.includes(f)));const u=FE.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){T(o,f=>{f()});return}this.hot.batchExecution(()=>{T(s,f=>{$E(this,Aa).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return $E(this,Aa).getHiddenIndexes()}destroy(){ww(this,Aa,null),super.destroy()}}function V7(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${pl}`);if(ua(e,[_r("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),J(u,pl),e.querySelector("div:first-child").appendChild(u)),$e(u,["collapsed","expanded"]),s?(J(u,"collapsed"),is(u,"+"),l&&_e(e,..._r(!1))):(J(u,"expanded"),is(u,"-"),l&&_e(e,..._r(!0))),l&&_e(u,...yo());else{var c;(c=u)===null||c===void 0||c.remove()}}function B7(t,e){De(t.target,pl)&&(De(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):De(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Pr(t))}function U7(){this.updatePlugin()}function Y7(t,e){e||this.updatePlugin()}function _s(t,e,n){return e=G7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G7(t){var e=z7(t,"string");return typeof e=="symbol"?e:String(e)}function z7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const j7=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],K7=!1,X7=!0,q7=!0;class Z7{constructor(e,n){_s(this,"hot",void 0),_s(this,"sortingStates",new vg),_s(this,"sortEmptyCells",K7),_s(this,"indicator",X7),_s(this,"headerAction",q7),_s(this,"compareFunctionFactory",void 0),_s(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ue(e)&&Ge(e,(n,r)=>{j7.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ue(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(he(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const pf="asc",wf="desc",qx="colHeader";function Q7(t){if(Ue(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[pf,wf].includes(n)}function J7(t){if(t.some(n=>Q7(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function YE(t){if(t!==wf)return t===pf?wf:pf}function Zx(t){return t.querySelector(`.${qx}`)}function Qx(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function cb(t,e,n){return t===-1&&e>=0&&ss(n)===!1}const eX="ascending",tX="descending",Jx="indicatorDisabled",eH="columnSorting",tH="sortAction",nH=new Map([[pf,eX],[wf,tX]]);function nX(t,e,n,r){const i=[eH];if(r&&i.push(tH),n===!1)return i.push(Jx),i;const o=t.getSortOrderOfColumn(e);return he(o)&&i.push(nH.get(o)),i}function rX(){return Array.from(nH.values()).concat(tH,Jx,eH)}function rH(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Mi:en(i)?en(o)?Mi:s&&t==="asc"?$t:kt:en(o)?s&&t==="asc"?kt:$t:isNaN(i)&&!isNaN(o)?t==="asc"?kt:$t:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?$t:kt:i>o?t==="asc"?kt:$t:Mi}}const iH="default";function iX(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Mi;if(a){if(en(r))return t==="asc"?$t:kt;if(en(i))return t==="asc"?kt:$t}return isNaN(o)?kt:isNaN(s)?$t:o<s?t==="asc"?$t:kt:o>s?t==="asc"?kt:$t:Mi}}const oX="numeric";function sX(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=en(s),u=en(a),c=l?i:s,d=u?i:a,f=c===i||c===r,p=d===i||d===r;if(o===!1){if(l&&u===!1)return kt;if(l===!1&&u)return $t}return f===!1&&p?t==="asc"?$t:kt:f&&p===!1?t==="asc"?kt:$t:f===!1&&p===!1?rH(t,e,n)(s,a):c===i&&d===r?t==="asc"?$t:kt:c===r&&d===i?t==="asc"?kt:$t:Mi}}const aX="checkbox";function lX(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Mi;if(en(r))return en(i)?Mi:o&&t==="asc"?$t:kt;if(en(i))return o&&t==="asc"?kt:$t;const s=e.dateFormat,a=Z(r,s),l=Z(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?$t:kt:l.isBefore(a)?t==="asc"?kt:$t:Mi:$t:kt}}const uX="date",{register:Wm,getItem:GE,hasItem:cX}=ni("sorting.compareFunctionFactory"),{register:oH,getItem:hX}=ni("sorting.mainSortComparator");function sH(t){return cX(t)?GE(t):GE(iH)}Wm(oX,iX);Wm(aX,sX);Wm(uX,lX);Wm(iH,rH);const Mi=0,$t=-1,kt=1;function dX(t,e){const n=hX(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function fX(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],d=o[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:sH(u.type))(l,u,f)(c,d)}(0)}}function Lh(t,e){gX(t,e),e.add(t)}function gX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $h(t,e,n){return e=mX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mX(t){var e=pX(t,"string");return typeof e=="symbol"?e:String(e)}function pX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function il(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Cf="columnSorting",wX=50,vf="append",CX="replace",zE=Cf;oH(Cf,fX);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var Hd=new WeakSet,jE=new WeakSet,KE=new WeakSet,XE=new WeakSet;class aH extends ot{constructor(){super(...arguments),Lh(this,XE),Lh(this,KE),Lh(this,jE),Lh(this,Hd),$h(this,"columnStatesManager",null),$h(this,"columnMetaCache",null),$h(this,"pluginKey",Cf),$h(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Cf}static get PLUGIN_PRIORITY(){return wX}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new Z7(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new cs(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>il(this,jE,vX).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return il(e,XE,yX).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>il(this,Hd,xv).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return il(e,KE,SX).call(e,...r)}),this.hot.view&&il(this,Hd,xv).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=Zx(r);Qx(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:zE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(zE)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new zP),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return he(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return J7(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ye(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return he(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ye(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(he(n)){const i=YE(n);return he(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:YE()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vf;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ct(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===vf)return[...o.slice(0,r),...o.slice(r+1),s];if(n===CX)return[...o.slice(0,r),s,...o.slice(r+1)]}return he(s)?o.concat(s):o}getPluginColumnConfig(e){if(Ue(e)){const n=e[this.pluginKey];if(Ue(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):wt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ye(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ye(n,u=>u[0]);dX(n,this.pluginKey,Ye(e,u=>u.sortOrder),Ye(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ye(n,u=>u[0]),a=new Map(Ye(o,(u,c)=>[u,s[c]])),l=Ye(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ue(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ue(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if($e(e,rX()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];J(e,nX(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),he(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&De(e.target,qx)}onAfterOnCellMouseDown(e,n){cb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function xv(){const t=this.getAllSavedSortSettings();if(Ue(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function vX(t,e){const n=Zx(e);if(Qx(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);_e(e,...NY(s?`${s}ending`:"none"))}}function SX(t){t===!0&&this.hot.view&&il(this,Hd,xv).call(this)}function yX(t,e,n,r){cb(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Ms(t,e,n){return e=bX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bX(t){var e=RX(t,"string");return typeof e=="symbol"?e:String(e)}function RX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EX{constructor(e,n){Ms(this,"plugin",void 0),Ms(this,"hot",void 0),Ms(this,"endpoints",[]),Ms(this,"settings",void 0),Ms(this,"settingsType","array"),Ms(this,"currentEndpoint",null),Ms(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),T(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();T(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,d=n;T(u,f=>{a==="row"&&f.destinationRow>=d&&(f.alterRowOffset=l*r),a==="col"&&f.destinationColumn>=d&&(f.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?T(u,f=>{this.extendEndpointRanges(f,d,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):T(u,f=>{this.shiftEndpointCoordinates(f,d)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){T(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];T(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),T(i,o=>{let s=[];T(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,T(e.ranges,r=>{T(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],T(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],T(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],T(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&T(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),T(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){vt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const TX=EX;function Cw(t){return t==null||isNaN(t)}function vw(t,e){_X(t,e),e.add(t)}function _X(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MX(t,e,n){return e=AX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AX(t){var e=OX(t,"string");return typeof e=="symbol"?e:String(e)}function OX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const yw="columnSummary",IX=220;var qE=new WeakSet,ZE=new WeakSet,QE=new WeakSet;class PX extends ot{constructor(){super(...arguments),vw(this,QE),vw(this,ZE),vw(this,qE),MX(this,"endpoints",null)}static get PLUGIN_KEY(){return yw}static get PLUGIN_PRIORITY(){return IX}isEnabled(){return!!this.hot.getSettings()[yw]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[yw],this.endpoints=new TX(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sw(e,qE,xX).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sw(e,ZE,HX).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Sw(e,QE,DX).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ge(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Cw(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ge(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Cw(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Cw(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ge(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ft`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function xX(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function HX(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function DX(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Oa(t,e,n){return e=NX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NX(t){var e=LX(t,"string");return typeof e=="symbol"?e:String(e)}function LX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Oa(this,"rootDocument",void 0),Oa(this,"isRtl",!1),Oa(this,"container",null),Oa(this,"editor",void 0),Oa(this,"editorStyle",void 0),Oa(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:dt(this.getInputElement()),height:Pt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),J(this.container,hl.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),J(e,hl.CLASS_EDITOR),J(n,hl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${hl.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const $X=hl;function bw(t,e,n){return e=kX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kX(t){var e=FX(t,"string");return typeof e=="symbol"?e:String(e)}function FX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const WX=250,VX=250;class lH{constructor(e){bw(this,"wasLastActionShow",!0),bw(this,"showDebounced",null),bw(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},VX)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:WX;this.showDebounced=cg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}mt(lH,or);const BX=lH;function UX(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function YX(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function As(t,e){const n={};return T(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Fo(t,e,n,r,i){T(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&GX(s,a,e,n,r,i)})})}function GX(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=UX(s.className,r):a=YX(s.className,r)),o(t,e,"className",a)}function Ji(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function yi(t,e){let n=!1;return Array.isArray(t)&&T(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function Vm(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const je="---------";function zX(){return{name:je}}const Rr="alignment";function jX(){return{key:Rr,name(){return this.getTranslatedPhrase(Vg)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Rr}:left`,name(){let t=this.getTranslatedPhrase(Bg);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:center`,name(){let t=this.getTranslatedPhrase(Ug);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:right`,name(){let t=this.getTranslatedPhrase(Yg);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:justify`,name(){let t=this.getTranslatedPhrase(Gg);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:je},{key:`${Rr}:top`,name(){let t=this.getTranslatedPhrase(zg);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:middle`,name(){let t=this.getTranslatedPhrase(jg);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:bottom`,name(){let t=this.getTranslatedPhrase(Kg);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Bm="clear_column";function KX(){return{key:Bm,name(){return this.getTranslatedPhrase(Ig)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const kc="col_left";function XX(){return{key:kc,name(){return this.getTranslatedPhrase(Rg)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Fc="col_right";function qX(){return{key:Fc,name(){return this.getTranslatedPhrase(Eg)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Wc="make_read_only";function ZX(){return{key:Wc,name(){let t=this.getTranslatedPhrase(Og);return yi(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=yi(t,(n,r)=>this.getCellMeta(n,r).readOnly);T(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Um="redo";function QX(){return{key:Um,name(){return this.getTranslatedPhrase(Ag)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Vc="remove_col";function JX(){return{key:Vc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(_g,e)},callback(){this.alter("remove_col",s6(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Ym="remove_row";function eq(){return{key:Ym,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Tg,e)},callback(){this.alter("remove_row",a6(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Gm="row_above";function tq(){return{key:Gm,name(){return this.getTranslatedPhrase(yg)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const zm="row_below";function nq(){return{key:zm,name(){return this.getTranslatedPhrase(bg)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const dc="no_items";function rq(){return{key:dc,name(){return this.getTranslatedPhrase(Sg)},disabled:!0,isCommand:!1}}const jm="undo";function iq(){return{key:jm,name(){return this.getTranslatedPhrase(Mg)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const oq=[Gm,zm,kc,Fc,Bm,Ym,Vc,jm,Um,Wc,Rr,je,dc],sq={[je]:zX,[dc]:rq,[Gm]:tq,[zm]:nq,[kc]:XX,[Fc]:qX,[Bm]:KX,[Ym]:eq,[Vc]:JX,[jm]:iq,[Um]:QX,[Wc]:ZX,[Rr]:jX};function uH(){const t={};return Ge(sq,(e,n)=>{t[n]=e()}),t}function aq(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(kg):this.getTranslatedPhrase($g)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function lq(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Fg)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function uq(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(Wg);return yi(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Dd))?Ji(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Dd);t.updateCommentMeta(n,r,{[Dd]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ci(t,e){cH(t,e),e.add(t)}function Os(t,e,n){cH(t,e),e.set(t,n)}function cH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cq(t,e,n){return e=hq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hq(t){var e=dq(t,"string");return typeof e=="symbol"?e:String(e)}function dq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ao(t,e,n){var r=hH(t,e,"set");return fq(t,r,n),n}function fq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Je(t,e){var n=hH(t,e,"get");return gq(t,n)}function hH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gq(t,e){return e.get?e.get.call(t):e.value}const Vu="comments",mq=60,eo="comment",Au="value",dH="style",Dd="readOnly",kh=Vu,Hv=`plugin:${Vu}`;var Rt=new WeakMap,Ur=new WeakMap,Km=new WeakMap,Nd=new WeakMap,Sf=new WeakMap,Dv=new WeakMap,yf=new WeakMap,JE=new WeakSet,eT=new WeakSet,tT=new WeakSet,nT=new WeakSet,rT=new WeakSet,iT=new WeakSet,oT=new WeakSet,sT=new WeakSet,aT=new WeakSet,lT=new WeakSet;class pq extends ot{constructor(){super(...arguments),ci(this,lT),ci(this,aT),ci(this,sT),ci(this,oT),ci(this,iT),ci(this,rT),ci(this,nT),ci(this,tT),ci(this,eT),ci(this,JE),cq(this,"range",{}),Os(this,Rt,{writable:!0,value:null}),Os(this,Ur,{writable:!0,value:null}),Os(this,Km,{writable:!0,value:!1}),Os(this,Nd,{writable:!0,value:!1}),Os(this,Sf,{writable:!0,value:{}}),Os(this,Dv,{writable:!0,value:null}),Os(this,yf,{writable:!0,value:""})}static get PLUGIN_KEY(){return Vu}static get PLUGIN_PRIORITY(){return mq}isEnabled(){return!!this.hot.getSettings()[Vu]}enablePlugin(){this.enabled||(Je(this,Rt)||ao(this,Rt,new $X(this.hot.rootDocument,this.hot.isRtl())),Je(this,Ur)||ao(this,Ur,new BX(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>hi(this,nT,Sq).call(this,e,s)),this.addHook("afterScroll",()=>hi(this,lT,_q).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>hi(this,aT,Tq).call(this,e)),Je(this,Ur).addLocalHook("hide",()=>this.hide()),Je(this,Ur).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Je(this,Ur).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(Hv);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ao(this,Nd,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(Hv),this.hot._registerTimeout(()=>{ao(this,Nd,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!Je(this,Rt).isVisible()},group:kh}),r.addShortcut({keys:[["Escape"]],callback:()=>{Je(this,Rt).setValue(Je(this,yf)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Je(this,Rt).isVisible()},group:kh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Je(this,Rt).isVisible()},group:kh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>hi(this,eT,Cq).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>hi(this,JE,wq).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>hi(this,tT,vq).call(this)),this.eventManager.addEventListener(n,"focus",()=>hi(this,iT,bq).call(this)),this.eventManager.addEventListener(n,"blur",()=>hi(this,rT,yq).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>hi(this,oT,Rq).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>hi(this,sT,Eq).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=rs(e.target,"TD","TBODY");return!!(n&&De(n,"htCommentCell")&&rs(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Je(this,Rt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Au]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,eo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Au)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Au)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Je(this,Ur).cancelHiding(),Je(this,Rt).setValue((e=i[eo]?i[eo][Au]:null)!==null&&e!==void 0?e:""),Je(this,Rt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Je(this,Rt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Je(this,Rt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;Je(this,Rt).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const d=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:p,view:{_wt:w}}=this.hot,{wtTable:v}=w,y=w.getCell({row:l,col:u},!0),b=this.getCommentMeta(s,a,dH);b?Je(this,Rt).setSize(b.width,b.height):Je(this,Rt).resetSize();const _=f?0:v.getStretchedColumnWidth(u),I=c&&!d?Pt(y):0,{left:L,top:x,width:W,height:G}=y.getBoundingClientRect(),{width:ne,height:j}=Je(this,Rt).getSize(),{innerWidth:X,innerHeight:ie}=this.hot.rootWindow,oe=this.hot.rootDocument.documentElement;let se=L+p.scrollX+_,ve=x+p.scrollY+I;this.hot.isRtl()&&(se-=ne+_),this.hot.isLtr()&&L+W+ne>X?se=L+p.scrollX-ne-1:this.hot.isRtl()&&se<-(oe.scrollWidth-oe.clientWidth)&&(se=L+p.scrollX+_+1),x+j>ie&&(ve-=j-G+1),Je(this,Rt).setPosition(se,ve),Je(this,Rt).setReadOnlyState(this.getCommentMeta(s,a,Dd))}focusEditor(){Je(this,Rt).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[eo];let o;i?(o=An(i),Ic(o,r)):o=r,this.hot.setCellMeta(e,n,eo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[eo])return i[eo][r]}addToContextMenu(e){e.items.push({name:je},aq(this),lq(this),uq(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Vu];if(Ue(e))return e.displayDelay}getEditorInputElement(){return Je(this,Rt).getInputElement()}destroy(){Je(this,Rt)&&Je(this,Rt).destroy(),Je(this,Ur)&&Je(this,Ur).destroy(),super.destroy()}}function wq(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Je(this,Km)&&!this.targetIsCommentTextArea(t)){const e=rs(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function Cq(t){const{rootDocument:e}=this.hot;if(!(Je(this,Km)||Je(this,Rt).isFocused()||De(t.target,"wtBorder")||Je(this,Dv)===t.target||!Je(this,Rt)))if(ao(this,Dv,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Je(this,Ur).show(n)}else Qo(t.target,e)&&!this.targetIsCommentTextArea(t)&&Je(this,Ur).hide()}function vq(){ao(this,Km,!1)}function Sq(t,e){e[eo]&&e[eo][Au]&&J(t,e.commentedCellClassName)}function yq(){ao(this,yf,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function bq(){ao(this,yf,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Hv)}function Rq(t){ao(this,Sf,{width:dt(t.target),height:Pt(t.target)})}function Eq(t){const e=dt(t.target),n=Pt(t.target);(e!==Je(this,Sf).width+1||n!==Je(this,Sf).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[dH]:{width:e,height:n}})}function Tq(t){Je(this,Rt).isVisible()&&Pr(t)}function _q(){Je(this,Nd)||this.hide()}var uT=VA,Mq=TypeError,Aq=function(t,e){if(!delete t[e])throw new Mq("Cannot delete property "+uT(e)+" of "+uT(t))},Oq=sa,Iq=Uf,Pq=Gf,xq=iO,Hq=Aq,Dq=oO,Nq=[].unshift(0)!==1,Lq=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},$q=Nq||!Lq();Oq({target:"Array",proto:!0,arity:1,forced:$q},{unshift:function(e){var n=Iq(this),r=Pq(n),i=arguments.length;if(i){Dq(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Hq(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return xq(n,r+i)}});function Rw(t,e,n){return e=kq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kq(t){var e=Fq(t,"string");return typeof e=="symbol"?e:String(e)}function Fq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fH{constructor(e){Rw(this,"hot",void 0),Rw(this,"commands",{}),Rw(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Wq(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||It(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),T(u,c=>c.apply(this.hot,r))}}function Wq(t,e){let n;return T(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Ew(t,e,n){return e=Vq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vq(t){var e=Bq(t,"string");return typeof e=="symbol"?e:String(e)}function Bq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Ew(this,"hot",void 0),Ew(this,"predefinedItems",uH()),Ew(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ge(e,(r,i)=>{let o="";r.name===je?(n[je]=r,o=je):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Uq(e,this.defaultOrderPattern,this.predefinedItems)}}function Uq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ue(i)?Ge(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Ue(o)?Kt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):T(i,(o,s)=>{let a=n[o];!a&&oq.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ue(o)&&Kt(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Io(t,e,n){return e=Yq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yq(t){var e=Gq(t,"string");return typeof e=="symbol"?e:String(e)}function Gq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zq{constructor(e,n){Io(this,"top",void 0),Io(this,"topRelative",void 0),Io(this,"left",void 0),Io(this,"leftRelative",void 0),Io(this,"scrollTop",void 0),Io(this,"scrollLeft",void 0),Io(this,"cellHeight",void 0),Io(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ru(t,e,n){jq(t,e),e.set(t,n)}function jq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){var n=mH(t,e,"get");return Kq(t,n)}function Kq(t,e){return e.get?e.get.call(t):e.value}function Fh(t,e,n){var r=mH(t,e,"set");return Xq(t,r,n),n}function mH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Xq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Nn=new WeakMap,Po=new WeakMap,gn=new WeakMap,Tw=new WeakMap,Ia=new WeakMap;class qq{constructor(e){ru(this,Nn,{writable:!0,value:void 0}),ru(this,Po,{writable:!0,value:void 0}),ru(this,gn,{writable:!0,value:void 0}),ru(this,Tw,{writable:!0,value:!1}),ru(this,Ia,{writable:!0,value:{above:0,below:0,left:0,right:0}}),Fh(this,Tw,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return qe(this,Ia)[e]=n,this}setElement(e){return Fh(this,Nn,e),this}setParentElement(e){return Fh(this,Po,e),this}updatePosition(e){Fh(this,gn,new zq(e,qe(this,Nn).ownerDocument.defaultView)),qe(this,Tw)?(qe(this,gn).fitsBelow(qe(this,Nn))?this.setPositionBelowCursor():qe(this,gn).fitsAbove(qe(this,Nn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){qe(this,Nn).dir==="rtl"?qe(this,gn).fitsOnLeft(qe(this,Nn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():qe(this,gn).fitsOnRight(qe(this,Nn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=qe(this,Ia).above+qe(this,gn).top-qe(this,Nn).offsetHeight;qe(this,Po)&&(e=qe(this,gn).top+qe(this,gn).cellHeight-qe(this,Nn).offsetHeight+3),qe(this,Nn).style.top=`${e}px`}setPositionBelowCursor(){let e=qe(this,Ia).below+qe(this,gn).top+1;qe(this,Po)&&(e=qe(this,gn).top-1),qe(this,Nn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=qe(this,gn).left;if(qe(this,Po)){const{right:n}=qe(this,Po).getBoundingClientRect();e+=qe(this,gn).cellWidth+n-(qe(this,gn).left+qe(this,gn).cellWidth)}else e+=qe(this,Ia).right;qe(this,Nn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=qe(this,Ia).left+qe(this,gn).left-qe(this,Nn).offsetWidth;if(qe(this,Po)){const{left:n}=qe(this,Po).getBoundingClientRect();e-=qe(this,gn).left-n}qe(this,Nn).style.left=`${e}px`}}function pH(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=ir(e,-1,w()-1);function a(y,b){const _=w()-1;return y<0&&(y=_),y>_&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(b===1?++y:--y,b)),y)}function l(y){y>-1&&y<w()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){w()>0&&(o.clear(),s=a(0,1))}function d(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function p(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:d,toNextItem:f,toPreviousItem:p,getSize:w,clear:v}}function Zq(t){return Ye(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function Nv(t){return It(t,"submenu")}function Lv(t){return new RegExp(je,"i").test(t.name)}function Ld(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function cT(t){return It(t,"disableSelection")}function Qq(t){return De(t,"htSeparator")}function Jq(t){return De(t,"htSubmenu")}function eZ(t){return De(t,"htDisabled")}function tZ(t){return De(t,"htSelectionDisabled")}function nZ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function wH(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function rZ(t,e){let n=t.slice(0);return n.reverse(),n=wH(n,e),n.reverse(),n}function iZ(t){const e=[];return T(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function oZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,n=t.slice(0);return n=wH(n,e),n=rZ(n,e),n=iZ(n),n}function sZ(t){return pH({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Qq(r)||eZ(r)||tZ(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function aZ(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const CH="menu",hT=CH;function lZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(aZ(t)),e.forEach(u=>{let{shortcuts:c,contextName:d}=u;i(c,d)});function r(u,c){a(c).addShortcuts(u,{group:CH})}function i(u,c){const d=a(c);u.forEach(f=>{let{keys:p}=f;p.forEach(w=>d.removeShortcutsByKeys(w))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${hT}:${u}`:hT}function a(u){var c;const d=t.hotMenu.getShortcutManager(),f=s(u);return(c=d.getContext(f))!==null&&c!==void 0?c:d.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function uZ(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(ei(n),J(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!Ld(a,t)&&!cT(a)&&!Lv(a);_e(n,[_Y(),US(u),...c?[Al(-1)]:[],...Ld(a,t)?[HY()]:[],...Nv(a)?[_r(!1)]:[]])}n.className="",n.appendChild(l),Lv(a)?J(n,"htSeparator"):typeof a.renderer=="function"?(J(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):ca(l,u),Ld(a,t)?J(n,"htDisabled"):cT(a)?J(n,"htSelectionDisabled"):Nv(a)&&J(n,"htSubmenu")}}function dT(t,e,n){cZ(t,e),e.set(t,n)}function cZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function di(t,e,n){return e=hZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hZ(t){var e=dZ(t,"string");return typeof e=="symbol"?e:String(e)}function dZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fT(t,e,n){var r=vH(t,e,"set");return fZ(t,r,n),n}function fZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function iu(t,e){var n=vH(t,e,"get");return gZ(t,n)}function vH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gZ(t,e){return e.get?e.get.call(t):e.value}const gT=215;var ou=new WeakMap,Wh=new WeakMap;class Dl{constructor(e,n){var r=this;di(this,"hot",void 0),di(this,"options",void 0),di(this,"eventManager",new mr(this)),di(this,"container",void 0),di(this,"positioner",void 0),di(this,"hotMenu",null),di(this,"hotSubMenus",{}),di(this,"parentMenu",void 0),di(this,"menuItems",null),di(this,"origOutsideClickDeselects",null),dT(this,ou,{writable:!0,value:void 0}),dT(this,Wh,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:gT,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new qq(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=ic(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return iu(this,ou)}getKeyboardShortcutsCtrl(){return iu(this,Wh)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=cg(a=>this.openSubMenu(a),300),n=this.options.minWidth||gT;let r=!1,i=gr(this.menuItems,a=>(a.key===dc&&(r=!0),nZ(a,this.hot)));if(i.length<1&&!r)i.push(uH()[dc]);else if(i.length===0)return;i=oZ(i,je);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return he(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:uZ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{iu(this,ou).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===je?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),dv()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!dv()||!ss(a))&&o&&this.hasSelectedItem()&&(so()||ny()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),fT(this,ou,sZ(this.hotMenu)),fT(this,Wh,lZ(this)),iu(this,Wh).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(iu(this,ou).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);_e(r,[_r(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Jq(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Dl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&_e(n,[_r(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&_e(i,[_r(!1)])}}closeAllSubMenus(){T(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Zq(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Lv(e)||Ld(e,this.hot)||Nv(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(wt(r)&&(r=r.call(this.hot),r===null||Ct(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),J(i,`htMenu ${this.options.className}`),r&&J(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Yt(n,(a,l)=>a+(l.name===je?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&_e(this.hotMenu.rootElement,[TY(),Al(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Qo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Qo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&De(e.target,"htCore")&&Qo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mt(Dl,or);function Vh(t,e){mZ(t,e),e.add(t)}function mZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _w(t,e,n){return e=pZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pZ(t){var e=wZ(t,"string");return typeof e=="symbol"?e:String(e)}function wZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ou="contextMenu",CZ=70,mT=Ou;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var pT=new WeakSet,wT=new WeakSet,CT=new WeakSet,vT=new WeakSet;class Bc extends ot{constructor(){super(...arguments),Vh(this,vT),Vh(this,CT),Vh(this,wT),Vh(this,pT),_w(this,"commandExecutor",new fH(this.hot)),_w(this,"itemsFactory",null),_w(this,"menu",null)}static get PLUGIN_KEY(){return Ou}static get PLUGIN_PRIORITY(){return CZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Gm,zm,je,kc,Fc,je,Ym,Vc,je,jm,Um,je,Wc,je,Rr]}isEnabled(){return!!this.hot.getSettings()[Ou]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Ou];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Dl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Bh(this,wT,SZ).call(this)),this.menu.addLocalHook("afterOpen",()=>Bh(this,CT,yZ).call(this)),this.menu.addLocalHook("afterClose",()=>Bh(this,vT,bZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Bh(this,pT,vZ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Vm(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:mT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(mT)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ge(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new gH(this.hot,Bc.DEFAULT_ITEMS);const e=this.hot.getSettings()[Ou],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),T(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function vZ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),De(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(De(o,"current")&&De(o,"wtBorder"))))return;const s=Vm(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function SZ(){this.hot.runHooks("beforeContextMenuShow",this)}function yZ(){this.hot.runHooks("afterContextMenuShow",this)}function bZ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Bc.SEPARATOR={name:je};function RZ(t){return{key:"copy",name(){return this.getTranslatedPhrase(Pg)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function EZ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Vy,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function TZ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Wy,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function _Z(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Fy,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function MZ(t){return{key:"cut",name(){return this.getTranslatedPhrase(xg)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class AZ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class OZ{constructor(){this.clipboardData=new AZ}}function ST(t,e){SH(t,e),e.add(t)}function Pa(t,e,n){SH(t,e),e.set(t,n)}function SH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function kn(t,e){var n=yH(t,e,"get");return IZ(t,n)}function IZ(t,e){return e.get?e.get.call(t):e.value}function xa(t,e,n){var r=yH(t,e,"set");return PZ(t,r,n),n}function yH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function PZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xo=new WeakMap,Mw=new WeakMap,su=new WeakMap,$v=new WeakMap,kv=new WeakMap,au=new WeakMap,Yh=new WeakSet,yT=new WeakSet;class xZ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;ST(this,yT),ST(this,Yh),Pa(this,xo,{writable:!0,value:void 0}),Pa(this,Mw,{writable:!0,value:void 0}),Pa(this,su,{writable:!0,value:void 0}),Pa(this,$v,{writable:!0,value:void 0}),Pa(this,kv,{writable:!0,value:void 0}),Pa(this,au,{writable:!0,value:void 0}),xa(this,Mw,n),xa(this,su,r),xa(this,$v,i),xa(this,kv,o),xa(this,au,s)}setSelectedRange(e){xa(this,xo,e)}getCellsRange(){if(kn(this,Mw).call(this)===0||kn(this,su).call(this)===0)return null;const{row:e,col:n}=kn(this,xo).getTopStartCorner(),{row:r,col:i}=kn(this,xo).getBottomEndCorner(),o=Uh(this,yT,HZ).call(this,e,r),s=Uh(this,Yh,Aw).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(kn(this,su).call(this)===0||kn(this,au).call(this)===0)return null;const{col:e}=kn(this,xo).getTopStartCorner(),{col:n}=kn(this,xo).getBottomEndCorner(),r=Uh(this,Yh,Aw).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(kn(this,su).call(this)===0||kn(this,au).call(this)===0)return null;const{col:e}=kn(this,xo).getTopStartCorner(),{col:n}=kn(this,xo).getBottomEndCorner(),r=Uh(this,Yh,Aw).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-kn(this,au).call(this),startCol:e,endRow:-1,endCol:r}}}function Aw(t,e){return Math.min(e,Math.max(t+kn(this,kv).call(this)-1,t))}function HZ(t,e){return Math.min(e,Math.max(t+kn(this,$v).call(this)-1,t))}function bH(t){const e=[],n=[];return T(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);Ce(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);Ce(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Ui(t,e){RH(t,e),e.add(t)}function Is(t,e,n){RH(t,e),e.set(t,n)}function RH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lu(t,e,n){return e=DZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DZ(t){var e=NZ(t,"string");return typeof e=="symbol"?e:String(e)}function NZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ar(t,e){var n=EH(t,e,"get");return LZ(t,n)}function LZ(t,e){return e.get?e.get.call(t):e.value}function Gr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Yi(t,e,n){var r=EH(t,e,"set");return $Z(t,r,n),n}function EH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $Z(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");const Gh="copyPaste",kZ=80,FZ=["fragmentSelection"],bT=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Fv=new WeakMap,Wv=new WeakMap,Vv=new WeakMap,Ha=new WeakMap,zh=new WeakMap,jh=new WeakMap,Da=new WeakMap,Ow=new WeakSet,RT=new WeakSet,TH=new WeakSet,hb=new WeakSet,ET=new WeakSet,TT=new WeakSet,_T=new WeakSet,MT=new WeakSet,AT=new WeakSet;class _H extends ot{constructor(){super(...arguments),Ui(this,AT),Ui(this,MT),Ui(this,_T),Ui(this,TT),Ui(this,ET),Ui(this,hb),Ui(this,TH),Ui(this,RT),Ui(this,Ow),lu(this,"columnsLimit",1/0),lu(this,"rowsLimit",1/0),lu(this,"pasteMode","overwrite"),lu(this,"uiContainer",this.hot.rootDocument.body),Is(this,Fv,{writable:!0,value:!1}),Is(this,Wv,{writable:!0,value:!1}),Is(this,Vv,{writable:!0,value:!1}),Is(this,Ha,{writable:!0,value:"cells-only"}),Is(this,zh,{writable:!0,value:!1}),Is(this,jh,{writable:!0,value:!1}),Is(this,Da,{writable:!0,value:new xZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),lu(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Gh}static get SETTING_KEYS(){return[Gh,...FZ]}static get PLUGIN_PRIORITY(){return kZ}isEnabled(){return!!this.hot.getSettings()[Gh]}enablePlugin(){var e=this;if(this.enabled)return;const{[Gh]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Yi(this,Fv,!!n.copyColumnHeaders),Yi(this,Wv,!!n.copyColumnGroupHeaders),Yi(this,Vv,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Gr(this,ET,BZ).call(this,o)),this.addHook("afterSelectionEnd",()=>Gr(this,TT,UZ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),ey()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Gr(e,_T,YZ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Gr(e,MT,GZ).call(e,...s)}),this.addHook("afterSelection",()=>Gr(this,AT,zZ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Yi(this,Ha,e),Yi(this,zh,!0),Gr(this,Ow,OT).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Yi(this,jh,!0),Gr(this,Ow,OT).call(this,"cut")}getRangedCopyableData(e){return ku(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=bH(e);return T(r,o=>{const s=[];T(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new OZ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ar(this,Da).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);ar(this,Ha)==="column-headers-only"?n.set("headers",ar(this,Da).getMostBottomColumnHeadersRange()):(ar(this,Ha)==="with-column-headers"?n.set("headers",ar(this,Da).getMostBottomColumnHeadersRange()):ar(this,Ha)==="with-column-group-headers"&&n.set("headers",ar(this,Da).getAllColumnHeadersRange()),n.set("cells",ar(this,Da).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,d=a,f=s,p=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:w,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,w===!0)continue;f=v,d=a;const y=[],b=o.length%r;for(;y.length<i||d<=u;){const{skipColumnOnPaste:_,visualCol:I}=this.hot.getCellMeta(s,d);if(d=I+1,_===!0)continue;p=I;const L=y.length%i;y.push(e[b][L])}o.push(y)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,p]}onCopy(e){if(!this.hot.isListening()&&!ar(this,zh)||this.isEditorOpened())return;this.setCopyableText(),Yi(this,zh,!1);const n=this.getRangedData(this.copyableRanges),r=Gr(this,RT,WZ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=ku(n);if(e&&e.clipboardData){const s=pv(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[bT,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Yi(this,Ha,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!ar(this,jh)||this.isEditorOpened())return;this.setCopyableText(),Yi(this,jh,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=ku(n);if(e&&e.clipboardData){const o=pv(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[bT,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=og(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=rP(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=p6(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function OT(t){if(ey()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&DI(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function WZ(t){const{rows:e}=bH(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function VZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&qS(r)}}}function MH(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&ZS(r)}}}function BZ(t){t.items.push({name:"---------"},RZ(this)),ar(this,Fv)&&t.items.push(_Z(this)),ar(this,Wv)&&t.items.push(TZ(this)),ar(this,Vv)&&t.items.push(EZ(this)),t.items.push(MZ(this))}function UZ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function YZ(){Gr(this,hb,MH).call(this)}function GZ(){Gr(this,TH,VZ).call(this)}function zZ(){Gr(this,hb,MH).call(this)}function AH(t,e){return`border_row${t}col${e}`}function Iu(){return{width:1,color:"#000"}}function lo(){return{hide:!0}}function jZ(){return{width:1,color:"#000",cornerVisible:!1}}function Iw(t){if(he(t.start)||he(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(he(t.end)||he(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function uu(t){return he(t.start)&&(t.left=t.start),he(t.end)&&(t.right=t.end),t}function Pw(t,e){return{id:AH(t,e),border:jZ(),row:t,col:e,top:lo(),bottom:lo(),start:lo(),end:lo()}}function KZ(t,e){return It(e,"border")&&e.border&&(t.border=e.border),It(e,"top")&&he(e.top)&&(e.top?(Ue(e.top)||(e.top=Iu()),t.top=e.top):(e.top=lo(),t.top=e.top)),It(e,"bottom")&&he(e.bottom)&&(e.bottom?(Ue(e.bottom)||(e.bottom=Iu()),t.bottom=e.bottom):(e.bottom=lo(),t.bottom=e.bottom)),It(e,"start")&&he(e.start)&&(e.start?(Ue(e.start)||(e.start=Iu()),t.start=e.start):(e.start=lo(),t.start=e.start)),It(e,"end")&&he(e.end)&&(e.end?(Ue(e.end)||(e.end=Iu()),t.end=e.end):(e.end=lo(),t.end=e.end)),t}function po(t,e){let n=!1;return T(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!It(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Xm(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function XZ(t){return t.some(e=>he(e.left)||he(e.right))}function qZ(t){return t.some(e=>he(e.start)||he(e.end))}const ZZ=new Map([["left","start"],["right","end"]]);function QZ(t){var e;return(e=ZZ.get(t))!==null&&e!==void 0?e:t}function JZ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Qg);return po(this,"bottom")&&(e=Xm(e)),e},callback(e,n){const r=po(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function eQ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(Jg);return po(this,e)&&(n=Xm(n)),n},callback(n,r){const i=po(this,e);t.prepareBorder(r,e,i)}}}function tQ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(em)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!po(this)}}}function nQ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(Zg);return po(this,e)&&(n=Xm(n)),n},callback(n,r){const i=po(this,e);t.prepareBorder(r,e,i)}}}function rQ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(qg);return po(this,"top")&&(e=Xm(e)),e},callback(e,n){const r=po(this,"top");t.prepareBorder(n,"top",r)}}}function IT(t,e){iQ(t,e),e.add(t)}function iQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oQ(t,e,n){return e=sQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sQ(t){var e=aQ(t,"string");return typeof e=="symbol"?e:String(e)}function aQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const $d="customBorders",lQ=90;var xT=new WeakSet,HT=new WeakSet;class uQ extends ot{constructor(){super(...arguments),IT(this,HT),IT(this,xT),oQ(this,"savedBorders",[])}static get PLUGIN_KEY(){return $d}static get PLUGIN_PRIORITY(){return lQ}isEnabled(){return!!this.hot.getSettings()[$d]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>PT(this,xT,cQ).call(this,e)),this.addHook("init",()=>PT(this,HT,hQ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Iw(n));const o=bl(e),s=hc(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});T(e,a=>{s(a).forAll((l,u)=>{T(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,QZ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=bl(e),r=hc(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return T(e,o=>{r(o).forAll((s,a)=>{T(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(uu(l))})})}),i}clearBorders(e){e?this.setBorders(e):(T(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Pw(e,n);r&&(a=KZ(a,r),T(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",uu(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Ce(e.from.row,r,o=>{Ce(e.from.col,i,s=>{const a=Pw(o,s);let l=0;o===e.from.row&&It(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&It(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&It(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&It(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",uu(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=AH(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Pw(e,n):o=Iw(o),i?(o[r]=lo(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",uu(o)))):(o[r]=Iu(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",uu(o)))}prepareBorder(e,n,r){T(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":Ce(o.col,s.col,a=>{Ce(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Ce(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":Ce(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":Ce(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":Ce(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){T(e,n=>{const r=Iw(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Yt([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ye(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){T(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){T(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ye(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):T(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return T(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return T(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):T(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);T(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[$d];if(Array.isArray(e)){const n=An(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=XZ(e),r=qZ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function cQ(t){this.hot.getSettings()[$d]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Xg)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[rQ(this),nQ(this),JZ(this),eQ(this),tQ(this)]}})}function hQ(){this.changeBorderSettings()}function dQ(t,e){fQ(t,e),e.add(t)}function fQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xw(t,e,n){return e=gQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gQ(t){var e=mQ(t,"string");return typeof e=="symbol"?e:String(e)}function mQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const NT="dragToScroll",pQ=100;var Hw=new WeakSet;class wQ extends ot{constructor(){super(...arguments),dQ(this,Hw),xw(this,"boundaries",null),xw(this,"callback",null),xw(this,"listening",!1)}static get PLUGIN_KEY(){return NT}static get PLUGIN_PRIORITY(){return pQ}isEnabled(){return!!this.hot.getSettings()[NT]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>DT(this,Hw,LT).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>DT(this,Hw,LT).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=ic(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function LT(t){if(ss(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function Ps(t,e){CQ(t,e),e.add(t)}function CQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dw(t,e,n){return e=vQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vQ(t){var e=SQ(t,"string");return typeof e=="symbol"?e:String(e)}function SQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");const kd="dropdownMenu",yQ=230,Bv="changeType",Nw=kd;var db=new WeakSet,$T=new WeakSet,kT=new WeakSet,FT=new WeakSet,WT=new WeakSet,VT=new WeakSet,BT=new WeakSet;class Uc extends ot{static get PLUGIN_KEY(){return kd}static get PLUGIN_PRIORITY(){return yQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[kc,Fc,je,Vc,je,Bm,je,Wc,je,Rr]}constructor(e){super(e),Ps(this,BT),Ps(this,VT),Ps(this,WT),Ps(this,FT),Ps(this,kT),Ps(this,$T),Ps(this,db),Dw(this,"commandExecutor",new fH(this.hot)),Dw(this,"itemsFactory",null),Dw(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>Wo(this,kT,RQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[kd]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new gH(this.hot,Uc.DEFAULT_ITEMS);const n=this.hot.getSettings()[kd],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Dl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Wo(this,FT,EQ).call(this)),this.menu.addLocalHook("afterOpen",()=>Wo(this,WT,TQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Wo(this,VT,_Q).call(this,o)),this.menu.addLocalHook("afterClose",()=>Wo(this,BT,MQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),T(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=Vm(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Nw},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Nw}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Nw)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Wo(this,$T,bQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ge(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function OH(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function bQ(t){if(t.stopPropagation(),De(t.target,Bv)){const e=Vm(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function RQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Bv}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Bv,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(_e(s,[yo(),US(" ")]),_e(e,[SI("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function EQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function TQ(){this.hot.runHooks("afterDropdownMenuShow",this),Wo(this,db,OH).call(this,this.menu)}function _Q(t){Wo(this,db,OH).call(this,t)}function MQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}Uc.SEPARATOR={name:je};function UT(t,e,n){return e=AQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AQ(t){var e=OQ(t,"string");return typeof e=="symbol"?e:String(e)}function OQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IQ{constructor(e){UT(this,"hot",void 0),UT(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return Ce(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(Ce(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();Ce(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();Ce(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const PQ=IQ;function YT(t,e,n){return e=xQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xQ(t){var e=HQ(t,"string");return typeof e=="symbol"?e:String(e)}function HQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fb{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){YT(this,"dataProvider",void 0),YT(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Un(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Kt(Un(fb.DEFAULT_OPTIONS),n),n=Kt(n,e),n.filename=BS(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const DQ=fb,NQ=String.fromCharCode(13),LQ=String.fromCharCode(34),$Q=String.fromCharCode(10);class kQ extends DQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ye(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),T(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Ft(e);return r!==""&&(n||r.indexOf(NQ)>=0||r.indexOf(LQ)>=0||r.indexOf($Q)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const FQ=kQ,WQ="csv",Uv={[WQ]:FQ};function VQ(t,e,n){return typeof Uv[t]=="function"?new Uv[t](e,n):null}const BQ="exportFile",UQ=240;class YQ extends ot{static get PLUGIN_KEY(){return BQ}static get PLUGIN_PRIORITY(){return UQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Uv[e])throw new Error(`Export format type "${e}" is not supported.`);return VQ(e,new PQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Na(t,e,n){return e=GQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GQ(t){var e=zQ(t,"string");return typeof e=="symbol"?e:String(e)}function zQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yc{constructor(e,n){let{id:r,stateless:i=!0}=n;Na(this,"hot",void 0),Na(this,"id",void 0),Na(this,"elements",[]),Na(this,"hidden",!1),Na(this,"stateId",""),Na(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new vg)}getElements(){return this.elements}reset(){T(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mt(Yc,or);const fc={};function ls(t,e){if(!fc[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=fc[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function js(t){if(!fc[t])throw Error(`Filter condition "${t}" does not exist.`);return fc[t].descriptor}function Xt(t,e,n){n.key=t,fc[t]={condition:e,descriptor:n}}const hn="none";function jQ(){return!0}Xt(hn,jQ,{name:Nc,inputsCount:0,showOperators:!1});const Bu="empty";function KQ(t){return en(t.value)}Xt(Bu,KQ,{name:am,inputsCount:0,showOperators:!0});const Fd="not_empty";function XQ(t,e){return!ls(Bu,e)(t)}Xt(Fd,XQ,{name:lm,inputsCount:0,showOperators:!0});const Uu="eq";function qQ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale)===Ft(n)}Xt(Uu,qQ,{name:um,inputsCount:1,showOperators:!0});const Wd="neq";function ZQ(t,e){return!ls(Uu,e)(t)}Xt(Wd,ZQ,{name:cm,inputsCount:1,showOperators:!0});const IH="gt";function QQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Xt(IH,QQ,{name:mm,inputsCount:1,showOperators:!0});const PH="gte";function JQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Xt(PH,JQ,{name:pm,inputsCount:1,showOperators:!0});const xH="lt";function eJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Xt(xH,eJ,{name:wm,inputsCount:1,showOperators:!0});const HH="lte";function tJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Xt(HH,tJ,{name:Cm,inputsCount:1,showOperators:!0});const gb="date_after";function nJ(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Xt(gb,nJ,{name:ym,inputsCount:1,showOperators:!0});const mb="date_before";function rJ(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Xt(mb,rJ,{name:bm,inputsCount:1,showOperators:!0});const bf="between";function iJ(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ls(mb,[o]),a=ls(gb,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Xt(bf,iJ,{name:vm,inputsCount:2,showOperators:!0});const DH="not_between";function oJ(t,e){return!ls(bf,e)(t)}Xt(DH,oJ,{name:Sm,inputsCount:2,showOperators:!0});const NH="begins_with";function sJ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Ft(n))}Xt(NH,sJ,{name:hm,inputsCount:1,showOperators:!0});const LH="ends_with";function aJ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Ft(n))}Xt(LH,aJ,{name:dm,inputsCount:1,showOperators:!0});const pb="contains";function lJ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Ft(n))>=0}Xt(pb,lJ,{name:fm,inputsCount:1,showOperators:!0});const $H="not_contains";function uJ(t,e){return!ls(pb,e)(t)}Xt($H,uJ,{name:gm,inputsCount:1,showOperators:!0});const kH="date_tomorrow";function cJ(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}Xt(kH,cJ,{name:Em,inputsCount:0});const FH="date_today";function hJ(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}Xt(FH,hJ,{name:Rm,inputsCount:0});const WH="date_yesterday";function dJ(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}Xt(WH,dJ,{name:Tm,inputsCount:0});CP();function fJ(t,e){let n=t;return n===""&&(n=`(${e})`),n}const Yv=new Set([1]).has(1),gJ=Yv&&typeof Array.from=="function";function Gc(t){let e=t;return Yv&&(e=new Set(e)),function(n){let r;return Yv?r=e.has(n):r=!!~e.indexOf(n),r}}function VH(t){return t??""}function Gv(t){let e=t;return gJ?e=Array.from(new Set(e)):e=FS(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function GT(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Gc(e)),T(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:fJ(a,n)};r&&r(u),i.push(u)}),i}const Ks="by_value";function mJ(t,e){let[n]=e;return n(t.value)}Xt(Ks,mJ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Gc(e)]},showOperators:!1});const gc={};function pJ(t){if(!gc[t])throw Error(`Operation with id "${t}" does not exist.`);const e=gc[t].func;return function(n,r){return e(n,r)}}function wJ(t){return gc[t].name}function wb(t,e,n){gc[t]={name:e,func:n}}const ts="conjunction",CJ=Am;function vJ(t,e){return t.every(n=>n.func(e))}wb(ts,CJ,vJ);const Rf="disjunction",SJ=Lc;function yJ(t,e){return t.some(n=>n.func(e))}wb(Rf,SJ,yJ);const Cb="disjunctionWithExtraCondition",bJ=Lc;function RJ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}wb(Cb,bJ,RJ);const EJ="numeric",BH="text",TJ="date",zT={[EJ]:[hn,je,Bu,Fd,je,Uu,Wd,je,IH,PH,xH,HH,bf,DH],[BH]:[hn,je,Bu,Fd,je,Uu,Wd,je,NH,LH,je,pb,$H],[TJ]:[hn,je,Bu,Fd,je,Uu,Wd,je,mb,gb,bf,je,kH,FH,WH]};function _J(t){const e=[];let n=t;return zT[n]||(n=BH),T(zT[n],r=>{let i;r===je?i={name:je}:i=Un(js(r)),e.push(i)}),e}function cu(t,e,n){return e=MJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MJ(t){var e=AJ(t,"string");return typeof e=="symbol"?e:String(e)}function AJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Lw="built",$w="building",jT=["click","input","keydown","keypress","keyup","focus","blur","change"];let qr=class UH{static get DEFAULTS(){return Un({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){cu(this,"hot",void 0),cu(this,"eventManager",new mr(this)),cu(this,"options",void 0),cu(this,"_element",void 0),cu(this,"buildState",void 0),this.hot=e,this.options=Kt(UH.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===$w?this._element:this.buildState===Lw?(this.update(),this._element):(this.buildState=$w,this.build(),this.buildState=Lw,this._element)}isBuilt(){return this.buildState===Lw}translateIfPossible(e){return typeof e=="string"&&e.startsWith(zn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=$w),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&J(this._element,this.options.className),this.options.children.length)T(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ge(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),T(jT,r=>e(n,r))}else T(jT,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mt(qr,or);function OJ(t,e){YH(t,e),e.add(t)}function IJ(t,e,n){YH(t,e),e.set(t,n)}function YH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kh(t,e){var n=GH(t,e,"get");return PJ(t,n)}function PJ(t,e){return e.get?e.get.call(t):e.value}function xJ(t,e,n){var r=GH(t,e,"set");return HJ(t,r,n),n}function GH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function HJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function DJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var La=new WeakMap,KT=new WeakSet;class ns extends qr{static get DEFAULTS(){return Un({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Kt(ns.DEFAULTS,n)),OJ(this,KT),IJ(this,La,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>DJ(this,KT,NJ).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");xJ(this,La,this._element.firstChild),J(this._element,"htUIInput"),J(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Kh(this,La).type=this.options.type,Kh(this,La).placeholder=this.translateIfPossible(this.options.placeholder),Kh(this,La).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Kh(this,La).focus()}}function NJ(t){this.options.value=t.target.value}function kw(t,e){zH(t,e),e.add(t)}function hu(t,e,n){zH(t,e),e.set(t,n)}function zH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $a(t,e,n){var r=jH(t,e,"set");return LJ(t,r,n),n}function LJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function xt(t,e){var n=jH(t,e,"get");return $J(t,n)}function jH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $J(t,e){return e.get?e.get.call(t):e.value}var nn=new WeakMap,Xh=new WeakMap,qh=new WeakMap,Ww=new WeakMap,Zh=new WeakMap,XT=new WeakSet,qT=new WeakSet,ZT=new WeakSet;class mc extends qr{static get DEFAULTS(){return Un({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Kt(mc.DEFAULTS,n)),kw(this,ZT),kw(this,qT),kw(this,XT),hu(this,nn,{writable:!0,value:null}),hu(this,Xh,{writable:!0,value:[]}),hu(this,qh,{writable:!0,value:void 0}),hu(this,Ww,{writable:!0,value:void 0}),hu(this,Zh,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return xt(this,nn)}registerHooks(){this.addLocalHook("click",()=>Fw(this,ZT,WJ).call(this))}setItems(e){$a(this,Xh,this.translateNames(e)),xt(this,nn)&&xt(this,nn).setMenuItems(xt(this,Xh))}translateNames(e){return T(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),$a(this,nn,new Dl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),xt(this,nn).setMenuItems(xt(this,Xh));const e=new qr(this.hot,{className:"htUISelectCaption"}),n=new qr(this.hot,{className:"htUISelectDropdown"});$a(this,qh,e),$a(this,Ww,e.element),$a(this,Zh,n),this.hot.getSettings().ariaTags&&(_e(n.element,[yo()]),_e(this._element,[vI()])),T([e,n],r=>this._element.appendChild(r.element)),xt(this,nn).addLocalHook("select",r=>Fw(this,XT,kJ).call(this,r)),xt(this,nn).addLocalHook("afterClose",()=>Fw(this,qT,FJ).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=xt(this,nn).hot.getTranslatedPhrase(Nc),xt(this,Ww).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();xt(this,nn)&&(xt(this,nn).open(),xt(this,nn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),xt(this,nn).getNavigator().toFirstItem(),xt(this,nn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){xt(this,nn)&&xt(this,nn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){xt(this,nn)&&(xt(this,nn).destroy(),$a(this,nn,null)),xt(this,qh)&&xt(this,qh).destroy(),xt(this,Zh)&&xt(this,Zh).destroy(),super.destroy()}}function kJ(t){t.name!==je&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function FJ(){this.runLocalHooks("afterClose")}function WJ(){this.openOptions()}function QT(t,e){VJ(t,e),e.add(t)}function VJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function JT(t,e,n){return e=BJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BJ(t){var e=UJ(t,"string");return typeof e=="symbol"?e:String(e)}function UJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function e_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var t_=new WeakSet,n_=new WeakSet;class zv extends Yc{constructor(e,n){super(e,{id:n.id,stateless:!1}),QT(this,n_),QT(this,t_),JT(this,"name",""),JT(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new mc(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ns(this.hot,{placeholder:Dm})),this.elements.push(new ns(this.hot,{placeholder:Nm})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>e_(this,t_,YJ).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),T(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>e_(this,n_,GJ).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Un(e.command);n.name.startsWith(Wt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),T(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||js(hn),n=[];return T(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=js(e?e.name:hn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||T(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof mc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ns)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{J(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&J(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[js(hn)];if(e!==null){const{visualIndex:r}=e;n=_J(this.hot.getDataType(0,r,this.hot.countRows(),r))}T(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function YJ(t){T(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function GJ(t){Il(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Pr(t))}function r_(t,e,n){zJ(t,e),e.set(t,n)}function zJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function du(t,e){var n=KH(t,e,"get");return jJ(t,n)}function jJ(t,e){return e.get?e.get.call(t):e.value}function i_(t,e,n){var r=KH(t,e,"set");return KJ(t,r,n),n}function KH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function KJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ka=new WeakMap,Vw=new WeakMap;class Ef extends qr{static get DEFAULTS(){return Un({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Kt(Ef.DEFAULTS,n)),r_(this,ka,{writable:!0,value:void 0}),r_(this,Vw,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),i_(this,Vw,e),i_(this,ka,this._element.firstChild),du(this,ka).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(du(this,Vw).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return du(this,ka).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(du(this,ka).checked=e)}focus(){this.isBuilt()&&du(this,ka).focus()}}function XJ(t,e){qJ(t,e),e.add(t)}function qJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZJ(t,e,n){return e=QJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QJ(t){var e=JJ(t,"string");return typeof e=="symbol"?e:String(e)}function JJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const o_=0;var s_=new WeakSet;class tee extends Yc{constructor(e,n){super(e,{id:n.id,stateless:!1}),XJ(this,s_),ZJ(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(J(n.parentNode,"htFiltersMenuOperators"),T(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ts,Rf];T(e,n=>{const r=new Ef(this.hot,{name:"operator",label:{htmlFor:n,textContent:wJ(n)},value:n,checked:n===e[o_],id:n});r.addLocalHook("change",i=>eee(this,s_,nee).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ft`Radio button with index ${e} doesn't exist.`);T(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Ef&&n.isChecked());return e?e.getValue():ts}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&T(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ts,n=arguments.length>1?arguments[1]:void 0,r=e;r===Cb&&(r=Rf),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(o_)}}function nee(t){this.setState(t.target.value)}function ree(t,e,n){iee(t,e),e.set(t,n)}function iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bw(t,e){var n=XH(t,e,"get");return oee(t,n)}function oee(t,e){return e.get?e.get.call(t):e.value}function see(t,e,n){var r=XH(t,e,"set");return aee(t,r,n),n}function XH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var fu=new WeakMap;class pc extends qr{static get DEFAULTS(){return Un({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Kt(pc.DEFAULTS,n)),ree(this,fu,{writable:!0,value:void 0})}build(){super.build(),see(this,fu,this._element.firstChild)}update(){this.isBuilt()&&(Bw(this,fu).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Bw(this,fu).focus()}activate(){Bw(this,fu).click()}}function Qh(t,e){qH(t,e),e.add(t)}function Fa(t,e,n){qH(t,e),e.set(t,n)}function qH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Le(t,e){var n=ZH(t,e,"get");return lee(t,n)}function lee(t,e){return e.get?e.get.call(t):e.value}function kr(t,e,n){var r=ZH(t,e,"set");return uee(t,r,n),n}function ZH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function uee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const a_="multipleSelect.itemBox";var Yr=new WeakMap,At=new WeakMap,Uw=new WeakMap,Gi=new WeakMap,Ho=new WeakMap,Do=new WeakMap,l_=new WeakSet,u_=new WeakSet,c_=new WeakSet,h_=new WeakSet;class wc extends qr{static get DEFAULTS(){return Un({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Kt(wc.DEFAULTS,n)),Qh(this,h_),Qh(this,c_),Qh(this,u_),Qh(this,l_),Fa(this,Yr,{writable:!0,value:[]}),Fa(this,At,{writable:!0,value:void 0}),Fa(this,Uw,{writable:!0,value:void 0}),Fa(this,Gi,{writable:!0,value:void 0}),Fa(this,Ho,{writable:!0,value:void 0}),Fa(this,Do,{writable:!0,value:void 0}),kr(this,Gi,new ns(this.hot,{placeholder:Hm,className:"htUIMultipleSelectSearch"})),kr(this,Ho,new pc(this.hot,{textContent:Om,className:"htUISelectAll"})),kr(this,Do,new pc(this.hot,{textContent:Im,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Le(this,At)}registerHooks(){Le(this,Gi).addLocalHook("keydown",e=>Jh(this,u_,hee).call(this,e)),Le(this,Gi).addLocalHook("input",e=>Jh(this,l_,cee).call(this,e)),Le(this,Ho).addLocalHook("click",e=>Jh(this,c_,dee).call(this,e)),Le(this,Do).addLocalHook("click",e=>Jh(this,h_,fee).call(this,e))}setItems(e){kr(this,Yr,e),Le(this,At)&&Le(this,At).loadData(Le(this,Yr))}setLocale(e){kr(this,Uw,e)}getLocale(){return Le(this,Uw)}getItems(){return[...Le(this,Yr)]}getValue(){return mee(Le(this,Yr))}getSearchInputElement(){return Le(this,Gi)}getSelectAllElement(){return Le(this,Ho)}getClearAllElement(){return Le(this,Do)}isSelectedAllValues(){return Le(this,Yr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new qr(this.hot,{className:"htUISelectionControls",children:[Le(this,Ho),Le(this,Do)]});this._element.appendChild(Le(this,Gi).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Le(this,At)&&Le(this,At).destroy(),J(o,"htUIMultipleSelectHot"),kr(this,At,new this.hot.constructor(o,{data:Le(this,Yr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,d,f,p)=>{l.title=p.instance.getDataAtRowProp(u,p.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Le(this,At).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Le(this,At).container.scrollWidth-on(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Le(this,At).init();const a=Le(this,At).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:a_}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Le(this,At).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:a_})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Le(this,At).listen()}reset(){Le(this,Gi).reset(),Le(this,Ho).reset(),Le(this,Do).reset()}update(){this.isBuilt()&&(Le(this,At).loadData(gee(Le(this,Yr),this.options.value)),super.update())}destroy(){Le(this,At)&&Le(this,At).destroy(),Le(this,Gi).destroy(),Le(this,Do).destroy(),Le(this,Ho).destroy(),kr(this,Gi,null),kr(this,Do,null),kr(this,Ho,null),kr(this,At,null),kr(this,Yr,null),super.destroy()}}function cee(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Le(this,Yr)]:n=gr(Le(this,Yr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Le(this,At).loadData(n)}function hee(t){this.runLocalHooks("keydown",t,this),QS(Il,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Pr(t),Le(this,At).listen(),Le(this,At).selectCell(0,0))}function dee(t){const e=[];t.preventDefault(),T(Le(this,At).getSourceData(),(n,r)=>{n.checked=!0,e.push(Py(n,r)[0])}),Le(this,At).setSourceDataAtCell(e)}function fee(t){const e=[];t.preventDefault(),T(Le(this,At).getSourceData(),(n,r)=>{n.checked=!1,e.push(Py(n,r)[0])}),Le(this,At).setSourceDataAtCell(e)}function gee(t,e){const n=Gc(e);return Ye(t,r=>(r.checked=n(r.value),r))}function mee(t){const e=[];return T(t,n=>{n.checked&&e.push(n.value)}),e}function pee(t,e){wee(t,e),e.add(t)}function wee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cee(t,e,n){return e=vee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vee(t){var e=See(t,"string");return typeof e=="symbol"?e:String(e)}function See(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var d_=new WeakSet;class bee extends Yc{constructor(e,n){super(e,{id:n.id,stateless:!1}),pee(this,d_),Cee(this,"name",""),this.name=n.name,this.elements.push(new wc(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>yee(this,d_,Ree).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ks){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?hn:Ks},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=gr(i,d=>d.name===Ks),u={},c=this.hot.getTranslatedPhrase(cc);if(l){const d=Gv(Ye(s(r,a),v=>v.value));o&&(l.args[0]=o);const f=[],p=GT(d,l.args[0],c,v=>{v.checked&&f.push(v.value)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[f],u.command=js(Ks),u.itemsSnapshot=p}else u.args=[],u.command=js(hn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof wc)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{J(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(cc),n=Gv(this._getColumnVisibleValues()),r=GT(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ye(this.hot.getDataAtCol(e.visualIndex),n=>VH(n))}}function Ree(t){Il(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Pr(t))}var QH;function Eee(t,e){Tee(t,e),e.add(t)}function Tee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _ee(t,e,n){return e=Mee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mee(t){var e=Aee(t,"string");return typeof e=="symbol"?e:String(e)}function Aee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var f_=new WeakSet;class Cc extends Yc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Eee(this,f_),_ee(this,"name",""),this.name=n.name,this.elements.push(new ns(this.hot,{type:"button",value:Pm,className:"htUIButton htUIButtonOK",identifier:Cc.BUTTON_OK})),this.elements.push(new ns(this.hot,{type:"button",value:xm,className:"htUIButton htUIButtonCancel",identifier:Cc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){T(this.elements,e=>{e.addLocalHook("click",(n,r)=>Oee(this,f_,Iee).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(J(n.parentNode,"htFiltersMenuActionBar"),T(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}QH=Cc;function Iee(t,e){e.options.identifier===QH.BUTTON_OK?this.accept():this.cancel()}function Yw(t,e,n){return e=Pee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pee(t){var e=xee(t,"string");return typeof e=="symbol"?e:String(e)}function xee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const g_="ConditionCollection.filteringStates";class JH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Yw(this,"hot",void 0),Yw(this,"isMapRegistrable",void 0),Yw(this,"filteringStates",new vg),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(g_,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ts;return e.length?pJ(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ts,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ye(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ft`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ct(gc[r]))throw new Error(ft`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ls(a,s)}]},i):u.push({name:a,args:s,func:ls(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Yt(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ye(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),T(e,n=>{T(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(g_),this.filteringStates=null,this.clearLocalHooks()}}mt(JH,or);const eD=JH;function m_(t,e,n){return e=Hee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hee(t){var e=Dee(t,"string");return typeof e=="symbol"?e:String(e)}function Dee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];m_(this,"conditionCollection",void 0),m_(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return T(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return T(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return T(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const tD=Nee;function Gw(t,e){Lee(t,e),e.add(t)}function Lee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xs(t,e,n){return e=$ee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ee(t){var e=kee(t,"string");return typeof e=="symbol"?e:String(e)}function kee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var p_=new WeakSet,w_=new WeakSet,C_=new WeakSet;class nD{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Gw(this,C_),Gw(this,w_),Gw(this,p_),xs(this,"hot",void 0),xs(this,"conditionCollection",void 0),xs(this,"columnDataFactory",void 0),xs(this,"changes",[]),xs(this,"grouping",!1),xs(this,"latestEditedColumnPosition",-1),xs(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>zw(this,p_,Fee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>zw(this,w_,Wee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>zw(this,C_,Vee).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,T(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=LI(function(c,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const p=new eD(r.hot,!1),w=[].concat(c,f);p.importAllConditions(w);const v=r.columnDataFactory(d);let y;p.isEmpty()?y=v:y=new tD(p,_=>r.columnDataFactory(_)).filter(),y=Ye(y,_=>_.meta.visualRow);const b=Gc(y);return p.destroy(),gr(v,_=>b(_.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ge(this,(e,n)=>{this[n]=null})}}function Fee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Wee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Vee(){T(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}mt(nD,or);const Bee=nD;function Uee(t){return pH({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof wc)return r;if(i.element&&!os(i.element))return!1;i.focus()}})}const gu="filters";function Yee(t,e){let n=-1;const r=Uee(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(gu),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof qr&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(gu),callback:()=>{l.isSubMenu()&&l.close(),u.listen(gu)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:d=>{const f=t.getNavigator();f.getCurrentPage()>-1&&(n=f.getCurrentPage()),f.clear(),d.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:d=>{const f=e[r.getCurrentPage()];f instanceof mc&&(f.openOptions(),d.preventDefault()),f instanceof pc&&(f.activate(),d.preventDefault()),f instanceof qr||d.preventDefault()}}],gu)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(gu)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function zi(t,e){rD(t,e),e.add(t)}function Gee(t,e,n){rD(t,e),e.set(t,n)}function rD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mu(t,e,n){return e=zee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zee(t){var e=jee(t,"string");return typeof e=="symbol"?e:String(e)}function jee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kee(t,e,n){var r=iD(t,e,"set");return Xee(t,r,n),n}function Xee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function pu(t,e){var n=iD(t,e,"get");return qee(t,n)}function iD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qee(t,e){return e.get?e.get.call(t):e.value}function Fr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const jv="filters",Zee=250,v_=jv;var Hs=new WeakMap,S_=new WeakSet,y_=new WeakSet,b_=new WeakSet,R_=new WeakSet,jw=new WeakSet,E_=new WeakSet,Kw=new WeakSet,T_=new WeakSet,__=new WeakSet;class oD extends ot{static get PLUGIN_KEY(){return jv}static get PLUGIN_PRIORITY(){return Zee}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),zi(this,__),zi(this,T_),zi(this,Kw),zi(this,E_),zi(this,jw),zi(this,R_),zi(this,b_),zi(this,y_),zi(this,S_),mu(this,"dropdownMenuPlugin",null),mu(this,"conditionCollection",null),mu(this,"conditionUpdateObserver",null),mu(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),mu(this,"filtersRowsMap",null),Gee(this,Hs,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Fr(this,T_,rte).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[jv]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Dc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Fr(this,jw,M_).call(this,"accept")),s.addLocalHook("cancel",()=>Fr(this,jw,M_).call(this,"cancel")),s.addLocalHook("change",a=>Fr(this,E_,nte).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(_m)}:`,o=()=>`${this.hot.getTranslatedPhrase(Mm)}:`;if(!this.components.get("filter_by_condition")){const s=new zv(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Fr(this,Kw,A_).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new tee(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new zv(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Fr(this,Kw,A_).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new bee(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Cc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new eD(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Bee(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Fr(this,__,ite).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Fr(this,R_,tte).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Fr(this,y_,Jee).call(this)),this.addHook("afterDropdownMenuHide",()=>Fr(this,b_,ete).call(this)),this.addHook("afterChange",s=>Fr(this,S_,Qee).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!pu(this,Hs)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=pu(this,Hs).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Kee(this,Hs,Yee(s,a));const l=u=>{pu(this,Hs).listen(),u.preventDefault(),Il(u.keyCode,"TAB")&&(u.shiftKey?pu(this,Hs).toPreviousItem():pu(this,Hs).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:v_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(v_)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ts;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ye(n.filter(),u=>u.meta.visualRow);const l=Gc(i);Ce(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),T(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return T(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:p,locale:w}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:p,locale:w},value:VH(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=Gv(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Rf&&n.command.key!==hn&&r.command.key!==hn&&i.command.key!==hn?o=Cb:i.command.key!==hn&&(n.command.key===hn||r.command.key===hn)&&(o=ts),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new tD(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return T(i,s=>{T(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Qee(t){t&&T(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Jee(){this.restoreComponents(Array.from(this.components.values()))}function ete(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function tte(t){t.items.push({name:je}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function M_(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==hn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==hn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==hn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function nte(t,e){this.updateDependentComponentsVisibility(),t.constructor===zv&&!e.inputsCount&&this.setListeningDropdownMenu()}function A_(){this.setListeningDropdownMenu()}function rte(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?J(e,"htFiltersActive"):$e(e,"htFiltersActive")}function ite(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===Ks),o=n.filter(s=>s.name!==Ks);if(i.length>=2||o.length>=3)vt(ft`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const sD="internal-use-in-handsontable",Kv={licenseKey:sD,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function aD(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Tn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function lD(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function ote(t){var e;const n=t[Tn],r=lD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=aD(t);return{...Kv,...r,...i}}function ste(t){var e;const n=t[Tn],r=lD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=aD(t);return{...r,...i}}function ate(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function qm(){const t="engine_relationship",e=ni(Tn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function vb(){const t="shared_engine_usage",e=ni(Tn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function lte(t){const e=t.getSettings(),n=e[Tn],r=n==null?void 0:n.engine;if(n===!0||Ct(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return ute((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ct(r.hyperformula)){const o=qm(),s=vb().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:sD}),(r.getConfig().leapYear1900!==Kv.leapYear1900||hg(r.getConfig().nullDate,Kv.nullDate)===!1)&&vt(ft`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function ute(t,e,n){const r=e[Tn],i=ote(e),o=qm(),s=vb();cte(t,r.functions),hte(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),dte(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function O_(t){var e;const n=qm(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function I_(t,e){if(t){const n=qm(),r=n.get(t),i=vb(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function cte(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){vt(s.message)}})}function hte(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){vt(r.message)}}}function dte(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){vt(a.message)}}),t.resumeEvaluation())}function fte(t,e){return(Ct(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const uD="DD/MM/YYYY";function cD(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function gte(t){return cD(t)?t.substr(1):t}function mte(t){return typeof t=="string"&&t.startsWith("=")}function Sb(t,e){return typeof t=="string"&&e==="date"}function hD(t,e){return Z(t,e,!0).isValid()}function dD(t,e){return Z(t,e,!0).format(uD)}function pte(t,e){return Z(t,uD,!0).format(e)}function fD(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function Ds(t,e,n){wte(t,e),e.set(t,n)}function wte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){var n=gD(t,e,"get");return Cte(t,n)}function Cte(t,e){return e.get?e.get.call(t):e.value}function No(t,e,n){var r=gD(t,e,"set");return vte(t,r,n),n}function gD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var wu=new WeakMap,Lo=new WeakMap,sr=new WeakMap,ed=new WeakMap,Xw=new WeakMap,qw=new WeakMap,td=new WeakMap;class Ste{constructor(e,n,r){Ds(this,wu,{writable:!0,value:void 0}),Ds(this,Lo,{writable:!0,value:void 0}),Ds(this,sr,{writable:!0,value:void 0}),Ds(this,ed,{writable:!0,value:[]}),Ds(this,Xw,{writable:!0,value:[]}),Ds(this,qw,{writable:!0,value:void 0}),Ds(this,td,{writable:!0,value:[]}),No(this,wu,e),No(this,Lo,n),No(this,sr,r)}setRemovedHfIndexes(e){return No(this,td,e.map(n=>{const r=bt(this,Lo).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),bt(this,td)}getRemovedHfIndexes(){return bt(this,td)}getHfIndexFromVisualIndex(e){const n=bt(this,Lo).getIndexesSequence(),r=bt(this,Lo).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${Mn(bt(this,wu))}s`;bt(this,sr).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&bt(this,sr).getEngine()[r](bt(this,sr).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(No(this,Xw,e.map(i=>this.getHfIndexFromVisualIndex(i))),No(this,qw,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=bt(this,Lo).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(bt(this,sr).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(bt(this,Xw),bt(this,qw)));bt(this,sr).getSheetId()===null?bt(this,sr).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Mn(bt(this,wu))}Order`;return n=>{if(bt(this,sr).isPerformingUndoRedo())return;const r=bt(this,Lo).getIndexesSequence();if(n==="update"){const i=bt(this,ed).map(l=>r.indexOf(l)),o=bt(this,sr).getEngine().getSheetDimensions(bt(this,sr).getSheetId());let s;bt(this,wu)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);bt(this,sr).getEngine()[e](bt(this,sr).getSheetId(),i)}No(this,ed,r)}}init(){No(this,ed,bt(this,Lo).getIndexesSequence())}}const P_=Ste;function Ns(t,e,n){yte(t,e),e.set(t,n)}function yte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ji(t,e){var n=mD(t,e,"get");return bte(t,n)}function bte(t,e){return e.get?e.get.call(t):e.value}function Ls(t,e,n){var r=mD(t,e,"set");return Rte(t,r,n),n}function mD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var nd=new WeakMap,rd=new WeakMap,Zw=new WeakMap,Qw=new WeakMap,Jw=new WeakMap,eC=new WeakMap,tC=new WeakMap;class Ete{constructor(e,n,r){Ns(this,nd,{writable:!0,value:void 0}),Ns(this,rd,{writable:!0,value:void 0}),Ns(this,Zw,{writable:!0,value:void 0}),Ns(this,Qw,{writable:!0,value:!1}),Ns(this,Jw,{writable:!0,value:!1}),Ns(this,eC,{writable:!0,value:null}),Ns(this,tC,{writable:!0,value:null}),Ls(this,nd,new P_("row",e,this)),Ls(this,rd,new P_("column",n,this)),Ls(this,Zw,r)}getForAxis(e){return e==="row"?ji(this,nd):ji(this,rd)}setPerformUndo(e){Ls(this,Qw,e)}setPerformRedo(e){Ls(this,Jw,e)}isPerformingUndoRedo(){return ji(this,Qw)||ji(this,Jw)}getSheetId(){return ji(this,tC)}getEngine(){return ji(this,eC)}getPostponeAction(){return ji(this,Zw)}setupSyncEndpoint(e,n){Ls(this,eC,e),Ls(this,tC,n),ji(this,nd).init(),ji(this,rd).init()}}const Tte=Ete;function Mt(t,e){pD(t,e),e.add(t)}function Wa(t,e,n){return e=_te(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _te(t){var e=Mte(t,"string");return typeof e=="symbol"?e:String(e)}function Mte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nC(t,e,n){pD(t,e),e.set(t,n)}function pD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e,n){var r=wD(t,e,"set");return Ate(t,r,n),n}function Ate(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function wl(t,e){var n=wD(t,e,"get");return Ote(t,n)}function wD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ote(t,e){return e.get?e.get.call(t):e.value}function pt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Tn="formulas",Ite=["maxRows","maxColumns","language"],Pte=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");const Nl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var wo=new WeakMap,yb=new WeakMap,Cu=new WeakMap,x_=new WeakSet,H_=new WeakSet,rC=new WeakSet,D_=new WeakSet,iC=new WeakSet,N_=new WeakSet,L_=new WeakSet,oC=new WeakSet,$_=new WeakSet,k_=new WeakSet,F_=new WeakSet,W_=new WeakSet,V_=new WeakSet,B_=new WeakSet,U_=new WeakSet,Y_=new WeakSet,G_=new WeakSet,z_=new WeakSet,j_=new WeakSet,K_=new WeakSet,X_=new WeakSet,q_=new WeakSet,Z_=new WeakSet,Q_=new WeakSet;class xte extends ot{constructor(){var e;super(...arguments),e=this,Mt(this,Q_),Mt(this,Z_),Mt(this,q_),Mt(this,X_),Mt(this,K_),Mt(this,j_),Mt(this,z_),Mt(this,G_),Mt(this,Y_),Mt(this,U_),Mt(this,B_),Mt(this,V_),Mt(this,W_),Mt(this,F_),Mt(this,k_),Mt(this,$_),Mt(this,oC),Mt(this,L_),Mt(this,N_),Mt(this,iC),Mt(this,D_),Mt(this,rC),Mt(this,H_),Mt(this,x_),nC(this,wo,{writable:!0,value:!1}),nC(this,yb,{writable:!0,value:!1}),nC(this,Cu,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,j_,Kte).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,K_,Xte).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,X_,qte).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,q_,Zte).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,Z_,Qte).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,Q_,Jte).call(e,...r)}]]}),Wa(this,"staticRegister",ni("formulas")),Wa(this,"engine",null),Wa(this,"sheetName",null),Wa(this,"indexSyncer",null),Wa(this,"rowAxisSyncer",null),Wa(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Tn}static get PLUGIN_PRIORITY(){return Pte}static get SETTING_KEYS(){return[Tn,...Ite]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Tn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=lte(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){vt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,rC,J_).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,iC,eM).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,rC,J_).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,iC,eM).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,N_,Lte).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,L_,$te).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,x_,Hte).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,$_,kte).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,oC,tM).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,oC,tM).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,k_,Fte).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,F_,Wte).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,B_,Ute).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,U_,Yte).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,W_,Vte).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,V_,Bte).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Y_,Gte).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,G_,zte).call(n,...i)}),this.indexSyncer=new Tte(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,D_,Nte).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,z_,jte).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,H_,Dte).call(n,...i)}),wl(this,Cu).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){wl(this,Cu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),I_(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=ste(this.hot.getSettings());ate(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Tn];if(he(r)&&he(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Tn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){wl(this,Cu).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),us(this,Cu,null),I_(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(he(n)&&!UP(n))return vt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return vt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return vt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){iy(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Mn(Tn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),O_(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return he(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(he(l)===!1||he(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,d=r(o);if(c!==void 0&&!i.has(d)){const f=O_(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){vt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return Sb(r,o.type)&&(hD(r,o.dateFormat)?r=dD(r,o.dateFormat):mte(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Hte(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Bn(s)&&(s=fD(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Dte(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const p=this.engine.getFillRangeData(d,f),{row:w,col:v}=d.start,{row:y,col:b}=d.end,_=y-w+1,I=b-v+1;for(let L=0;L<p.length;L+=1)for(let x=0;x<p[L].length;x+=1){const W=p[L][x],G=L%_,ne=x%I,j=this.hot.getCellMeta(G,ne);Sb(W,j.type)&&(W.startsWith("'")?p[L][x]=W.slice(1):this.isFormulaCellType(G,ne,this.sheetId)===!1&&(p[L][x]=pte(W,j.dateFormat)))}return p}function J_(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Mn(Tn))||us(this,yb,Ct(this.hot.getSettings().data))}function Nte(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;Sb(i,s.type)&&(e=!0,hD(i,a)?t[r][o]=dD(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(us(this,wo,!0),this.engine.setSheetContent(this.sheetId,t),us(this,wo,!1))}function eM(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Mn(Tn)))if(this.sheetName=fte(this.engine,this.hot.getSettings()[Tn].sheetName),wl(this,yb))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){us(this,wo,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),us(this,wo,!1)}}}function Lte(t,e,n,r){if(r!=="get"||wl(this,wo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){cD(n.value)&&(n.value=gte(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&Bn(a)&&(a=fD(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function $te(t,e,n,r){if(r!=="get"||wl(this,wo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function tM(t,e){if(Nl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),d=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&d!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function kte(t,e){if(Nl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Bn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){vt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Fte(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Wte(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Vte(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Bte(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Ute(t,e,n){if(Nl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Yte(t,e,n){if(Nl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Gte(t,e,n,r){if(Nl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function zte(t,e,n,r){if(Nl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function jte(t,e,n){var r;us(this,wo,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());us(this,wo,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Kte(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Xte(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function qte(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Zte(t){this.hot.runHooks("afterSheetAdded",t)}function Qte(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function Jte(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function ene(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(rm,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function tne(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(im,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ye(t.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,f=l-a+1;if(d>f){const p=u.slice(i,o+1);c.push(...p.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const d=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===f&&d>o&&c.push(...u.slice(o+1))}return T(c,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function Va(t,e){CD(t,e),e.add(t)}function nM(t,e,n){CD(t,e),e.set(t,n)}function CD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function hr(t,e){var n=vD(t,e,"get");return nne(t,n)}function nne(t,e){return e.get?e.get.call(t):e.value}function vu(t,e,n){var r=vD(t,e,"set");return rne(t,r,n),n}function vD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");const sC="hiddenColumns",ine=310;var _i=new WeakMap,fi=new WeakMap,rM=new WeakSet,iM=new WeakSet,oM=new WeakSet,sM=new WeakSet,aM=new WeakSet,lM=new WeakSet;class SD extends ot{constructor(){super(...arguments),Va(this,lM),Va(this,aM),Va(this,sM),Va(this,oM),Va(this,iM),Va(this,rM),nM(this,_i,{writable:!0,value:{}}),nM(this,fi,{writable:!0,value:null})}static get PLUGIN_KEY(){return sC}static get PLUGIN_PRIORITY(){return ine}isEnabled(){return!!this.hot.getSettings()[sC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[sC];Ue(n)&&(vu(this,_i,n),Ct(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),vu(this,fi,new Cg),hr(this,fi).addLocalHook("init",()=>Ba(this,lM,cne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,hr(this,fi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ba(e,aM,une).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Ba(this,iM,sne).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>Ba(this,rM,one).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ba(e,sM,lne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Ba(this,oM,ane).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),vu(this,_i,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=hr(this,fi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));T(l,u=>{o[u]=!1}),i=Yt(o,(u,c,d)=>(c&&u.push(this.hot.toVisualColumn(d)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&hr(this,fi).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{hr(this,fi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ye(hr(this,fi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return hr(this,fi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){vu(this,_i,null),vu(this,fi,null),super.destroy()}}function one(t,e){if(this.isHidden(e))return 0;if(hr(this,_i).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function sne(t,e,n){if(hr(this,_i).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function ane(t){if(hr(this,_i).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;Ce(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function lne(t,e){if(!hr(this,_i).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),J(e,n)}function une(t){t.items.push({name:je},ene(this),tne(this))}function cne(){Array.isArray(hr(this,_i).columns)&&this.hideColumns(hr(this,_i).columns)}function hne(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(om,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function dne(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(sm,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ye(t.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,f=l-a+1;if(d>f){const p=u.slice(i,o+1);c.push(...p.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const d=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===f&&d>o&&c.push(...u.slice(o+1))}return T(c,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function Ua(t,e){yD(t,e),e.add(t)}function uM(t,e,n){yD(t,e),e.set(t,n)}function yD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ya(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Er(t,e){var n=bD(t,e,"get");return fne(t,n)}function fne(t,e){return e.get?e.get.call(t):e.value}function Su(t,e,n){var r=bD(t,e,"set");return gne(t,r,n),n}function bD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");const aC="hiddenRows",mne=320;var uo=new WeakMap,gi=new WeakMap,cM=new WeakSet,hM=new WeakSet,dM=new WeakSet,fM=new WeakSet,gM=new WeakSet,mM=new WeakSet;class RD extends ot{constructor(){super(...arguments),Ua(this,mM),Ua(this,gM),Ua(this,fM),Ua(this,dM),Ua(this,hM),Ua(this,cM),uM(this,uo,{writable:!0,value:{}}),uM(this,gi,{writable:!0,value:null})}static get PLUGIN_KEY(){return aC}static get PLUGIN_PRIORITY(){return mne}isEnabled(){return!!this.hot.getSettings()[aC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[aC];Ue(n)&&(Su(this,uo,n),Ct(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Su(this,gi,new Cg),Er(this,gi).addLocalHook("init",()=>Ya(this,mM,yne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Er(this,gi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ya(e,gM,Sne).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Ya(this,hM,wne).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>Ya(this,cM,pne).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ya(e,fM,vne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Ya(this,dM,Cne).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Su(this,uo,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Er(this,gi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));T(l,u=>{o[u]=!1}),i=Yt(o,(u,c,d)=>(c&&u.push(this.hot.toVisualRow(d)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Er(this,gi).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{Er(this,gi).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ye(Er(this,gi).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Er(this,gi).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Su(this,uo,null),Su(this,gi,null),super.destroy()}}function pne(t,e){return this.isHidden(e)?0:t}function wne(t,e,n){if(Er(this,uo).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Cne(t){if(Er(this,uo).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;Ce(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function vne(t,e){if(!Er(this,uo).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),J(e,n)}function Sne(t){t.items.push({name:je},hne(this),dne(this))}function yne(){Array.isArray(Er(this,uo).rows)&&this.hideRows(Er(this,uo).rows)}function bne(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Hg)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Rne(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Dg)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function pM(t,e){ED(t,e),e.add(t)}function Ene(t,e,n){ED(t,e),e.set(t,n)}function ED(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xv(t,e){var n=TD(t,e,"get");return Tne(t,n)}function Tne(t,e){return e.get?e.get.call(t):e.value}function lC(t,e,n){var r=TD(t,e,"set");return _ne(t,r,n),n}function TD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _ne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function wM(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");const CM="manualColumnFreeze",Mne=110;var Us=new WeakMap,vM=new WeakSet,SM=new WeakSet;class Ane extends ot{constructor(){super(...arguments),pM(this,SM),pM(this,vM),Ene(this,Us,{writable:!0,value:!1})}static get PLUGIN_KEY(){return CM}static get PLUGIN_PRIORITY(){return Mne}isEnabled(){return!!this.hot.getSettings()[CM]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>wM(this,vM,One).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>wM(this,SM,Ine).call(this,e,n)),super.enablePlugin())}disablePlugin(){lC(this,Us,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;Xv(this,Us)||lC(this,Us,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;Xv(this,Us)||lC(this,Us,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function One(t){t.items.push({name:"---------"},bne(this),Rne(this))}function Ine(t,e){if(Xv(this,Us)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function id(t,e,n){return e=Pne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pne(t){var e=xne(t,"string");return typeof e=="symbol"?e:String(e)}function xne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uC=0,yM=1,bM=2,Ga="px";let Hne=class{constructor(e){id(this,"hot",void 0),id(this,"_element",null),id(this,"state",uC),id(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=bM}build(){this.state===uC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=yM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=uC}isAppended(){return this.state===bM}isBuilt(){return this.state>=yM}setPosition(e,n){Bn(e)&&(this._element.style.top=e+Ga),Bn(n)&&(this._element.style[this.inlineProperty]=n+Ga)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Bn(e)&&(this._element.style.width=e+Ga),Bn(n)&&(this._element.style.height=n+Ga)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Bn(e)&&(this._element.style.marginTop=e+Ga),Bn(n)&&(this._element.style[`margin${Mn(this.inlineProperty)}`]=n+Ga)}getOffset(){const e=this._element.style,n=`margin${Mn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const _D=Hne,Dne="ht__manualColumnMove--backlight";let Nne=class extends _D{build(){super.build(),J(this._element,Dne)}};const Lne=Nne,$ne="ht__manualColumnMove--guideline";let kne=class extends _D{build(){super.build(),J(this._element,$ne)}};const Fne=kne;function za(t,e){MD(t,e),e.add(t)}function Wr(t,e,n){MD(t,e),e.set(t,n)}function MD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nr(t,e,n){var r=AD(t,e,"set");return Wne(t,r,n),n}function Wne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function pe(t,e){var n=AD(t,e,"get");return Vne(t,n)}function AD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Vne(t,e){return e.get?e.get.call(t):e.value}function ja(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");const cC="manualColumnMove",Bne=120,RM="ht__manualColumnMove",Tf="show-ui",qv="on-moving--columns",Zv="after-selection--columns";var Wn=new WeakMap,Uo=new WeakMap,co=new WeakMap,Vd=new WeakMap,Xo=new WeakMap,Fn=new WeakMap,od=new WeakMap,yr=new WeakMap,ol=new WeakMap,_f=new WeakMap,Yu=new WeakMap,EM=new WeakSet,TM=new WeakSet,_M=new WeakSet,MM=new WeakSet,AM=new WeakSet,OM=new WeakSet;class Une extends ot{constructor(){super(...arguments),za(this,OM),za(this,AM),za(this,MM),za(this,_M),za(this,TM),za(this,EM),Wr(this,Wn,{writable:!0,value:new Lne(this.hot)}),Wr(this,Uo,{writable:!0,value:new Fne(this.hot)}),Wr(this,co,{writable:!0,value:[]}),Wr(this,Vd,{writable:!0,value:0}),Wr(this,Xo,{writable:!0,value:!1}),Wr(this,Fn,{writable:!0,value:{}}),Wr(this,od,{writable:!0,value:void 0}),Wr(this,yr,{writable:!0,value:void 0}),Wr(this,ol,{writable:!0,value:void 0}),Wr(this,_f,{writable:!0,value:void 0}),Wr(this,Yu,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return cC}static get PLUGIN_PRIORITY(){return Bne}isEnabled(){return!!this.hot.getSettings()[cC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ja(e,EM,Yne).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ja(e,_M,zne).call(e,...r)}),this.addHook("afterScrollVertically",()=>ja(this,AM,Kne).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ja(e,OM,Xne).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,RM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){$e(this.hot.rootElement,RM),this.unregisterEvents(),pe(this,Wn).destroy(),pe(this,Uo).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=pe(this,od),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(nr(this,od,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return nr(this,od,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Yt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[cC];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return Ce(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(pe(this,yr))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,pe(this,yr)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=pe(this,Wn).getOffset().start,u=pe(this,Wn).getSize().width;let c=0,d=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,v=dt(this.hot.rootElement),y=w.innerWidth-pe(this,ol)-v;d=w.innerWidth-pe(this,Fn).eventPageX-y-(r.scrollX===void 0?i:0)}else d=pe(this,Fn).eventPageX-(pe(this,ol)-(r.scrollX===void 0?i:0));if(pe(this,_f)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(pe(this,yr))&&(o+=i),o+=c,pe(this,yr)<0)pe(this,Yu)>0?pe(this,Fn).col=0:pe(this,Fn).col=e>0?e-1:e;else if(pe(this,Fn).TD.offsetWidth/2+o<=d){const w=pe(this,yr)>=pe(this,Vd)?pe(this,Vd)-1:pe(this,yr);pe(this,Fn).col=w+1,o+=pe(this,Fn).TD.offsetWidth}else pe(this,Fn).col=pe(this,yr);let f=d,p=o;d+u+l>=s?f=s-u-l:d+l<a+c&&(f=a+c+Math.abs(l)),o>=s-1?p=s-1:p===0?p=1:r.scrollX!==void 0&&pe(this,yr)<pe(this,Yu)&&(p-=pe(this,ol)<=r.scrollX?pe(this,ol):0),pe(this,Wn).setPosition(null,f),pe(this,Uo).setPosition(null,p)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ja(this,TM,Gne).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ja(this,MM,jne).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){pe(this,Wn).build(),pe(this,Uo).build()}destroy(){pe(this,Wn).destroy(),pe(this,Uo).destroy(),super.destroy()}}function Yne(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=De(t.target,"sortAction");if(!s||!o||pe(this,Xo)||t.button!==0||a){nr(this,Xo,!1),pe(this,co).length=0,$e(this.hot.rootElement,[qv,Tf]);return}const l=pe(this,Uo).isBuilt()&&!pe(this,Uo).isAppended(),u=pe(this,Wn).isBuilt()&&!pe(this,Wn).isAppended();l&&u&&(pe(this,Uo).appendTo(i.hider),pe(this,Wn).appendTo(i.hider));const{from:c,to:d}=s,f=Math.min(c.col,d.col),p=Math.max(c.col,d.col);if(e.row<0&&e.col>=f&&e.col<=p){r.column=!0,nr(this,Xo,!0);const w=n.firstChild?XI(t,n.firstChild).x:t.offsetX;pe(this,Fn).eventPageX=t.pageX,nr(this,yr,e.col),pe(this,Fn).TD=n,pe(this,Fn).col=e.col,nr(this,co,this.prepareColumnsToMoving(f,p)),nr(this,_f,!!this.hot.getSettings().rowHeaders),nr(this,Vd,this.hot.countCols()),nr(this,Yu,this.hot.getSettings().fixedColumnsStart),nr(this,ol,jt(this.hot.rootElement).left);const v=pe(this,_f)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,b=e.col<pe(this,Yu),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),I=Math.abs(w-(this.hot.isRtl()?n.offsetWidth:0)),L=this.getColumnsWidth(f,e.col-1)+I,x=this.getColumnsWidth(v,f-1)+(b?_:0)+L;pe(this,Wn).setPosition(y,x),pe(this,Wn).setSize(this.getColumnsWidth(f,p),i.hider.offsetHeight-y),pe(this,Wn).setOffset(null,-L),J(this.hot.rootElement,qv)}else $e(this.hot.rootElement,Zv),nr(this,Xo,!1),pe(this,co).length=0}function Gne(t){pe(this,Xo)&&(pe(this,Fn).eventPageX=t.pageX,this.refreshPositions())}function zne(t,e,n,r){!this.hot.getSelectedRangeLast()||!pe(this,Xo)||(pe(this,co).indexOf(e.col)>-1?$e(this.hot.rootElement,Tf):J(this.hot.rootElement,Tf),r.row=!0,r.column=!0,r.cell=!0,nr(this,yr,e.col),pe(this,Fn).TD=n)}function jne(){const t=pe(this,Fn).col,e=pe(this,co).length;if(nr(this,yr,void 0),nr(this,Xo,!1),$e(this.hot.rootElement,[qv,Tf,Zv]),this.hot.selection.isSelectedByColumnHeader()&&J(this.hot.rootElement,Zv),e<1||t===void 0)return;const n=pe(this,co)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(pe(this,co),t);if(pe(this,co).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Kne(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;pe(this,Wn).setPosition(r),pe(this,Wn).setSize(null,t.hider.offsetHeight-r)}function Xne(){this.moveBySettingsOrLoad()}function Ki(t,e){OD(t,e),e.add(t)}function vn(t,e,n){OD(t,e),e.set(t,n)}function OD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ut(t,e,n){var r=ID(t,e,"set");return qne(t,r,n),n}function qne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function le(t,e){var n=ID(t,e,"get");return Zne(t,n)}function ID(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zne(t,e){return e.get?e.get.call(t):e.value}const Mf="manualColumnResize",Qne=130,IM="manualColumnWidths";var to=new WeakMap,sd=new WeakMap,lr=new WeakMap,Af=new WeakMap,Ei=new WeakMap,Jne=new WeakMap,Cl=new WeakMap,ad=new WeakMap,Qn=new WeakMap,Zi=new WeakMap,na=new WeakMap,Of=new WeakMap,Gu=new WeakMap,zu=new WeakMap,cr=new WeakMap,ju=new WeakMap,PM=new WeakSet,xM=new WeakSet,HM=new WeakSet,DM=new WeakSet,NM=new WeakSet,LM=new WeakSet,$M=new WeakSet,kM=new WeakSet,FM=new WeakSet;class ere extends ot{static get PLUGIN_KEY(){return Mf}static get PLUGIN_PRIORITY(){return Qne}constructor(e){super(e),Ki(this,FM),Ki(this,kM),Ki(this,$M),Ki(this,LM),Ki(this,NM),Ki(this,DM),Ki(this,HM),Ki(this,xM),Ki(this,PM),vn(this,to,{writable:!0,value:null}),vn(this,sd,{writable:!0,value:null}),vn(this,lr,{writable:!0,value:[]}),vn(this,Af,{writable:!0,value:null}),vn(this,Ei,{writable:!0,value:null}),vn(this,Jne,{writable:!0,value:null}),vn(this,Cl,{writable:!0,value:null}),vn(this,ad,{writable:!0,value:null}),vn(this,Qn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),vn(this,Zi,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),vn(this,na,{writable:!0,value:null}),vn(this,Of,{writable:!0,value:!1}),vn(this,Gu,{writable:!0,value:0}),vn(this,zu,{writable:!0,value:null}),vn(this,cr,{writable:!0,value:void 0}),vn(this,ju,{writable:!0,value:void 0}),J(le(this,Qn),"manualColumnResizer"),J(le(this,Zi),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Mf]}enablePlugin(){this.enabled||(Ut(this,cr,new cs),le(this,cr).addLocalHook("init",()=>Xi(this,PM,tre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,le(this,cr)),this.addHook("modifyColWidth",(e,n)=>Xi(this,$M,are).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Xi(this,kM,lre).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Xi(this,FM,ure).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ut(this,ju,le(this,cr).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",IM,le(this,cr).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",IM,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return le(this,cr).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);le(this,cr).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Ut(this,to,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(le(this,to)),i=r.col;if(i<0)return;const o=Pt(le(this,to)),s=le(this,to).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(le(this,to),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(le(this,to),r.row,r.col)),Ut(this,sd,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Ut(this,lr,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();T(c,d=>{const f=d.getTopStartCorner().col,p=d.getBottomEndCorner().col;Ce(f,p,w=>{le(this,lr).includes(w)||le(this,lr).push(w)})})}le(this,lr).includes(le(this,sd))||Ut(this,lr,[le(this,sd)]),Ut(this,ad,l.start-6),Ut(this,Cl,parseInt(s.width,10)),le(this,Qn).style.top=`${l.top}px`,le(this,Qn).style[this.inlineDir]=`${le(this,ad)+le(this,Cl)}px`,le(this,Qn).style.height=`${o}px`,this.hot.rootElement.appendChild(le(this,Qn))}refreshHandlePosition(){le(this,Qn).style[this.inlineDir]=`${le(this,ad)+le(this,Af)}px`}setupGuidePosition(){const e=parseInt(Pt(le(this,Qn)),10),n=parseInt(le(this,Qn).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);J(le(this,Qn),"active"),J(le(this,Zi),"active"),le(this,Zi).style.top=`${n}px`,this.refreshGuidePosition(),le(this,Zi).style.height=`${r-e}px`,this.hot.rootElement.appendChild(le(this,Zi))}refreshGuidePosition(){le(this,Zi).style[this.inlineDir]=le(this,Qn).style[this.inlineDir]}hideHandleAndGuide(){$e(le(this,Qn),"active"),$e(le(this,Zi),"active")}checkIfColumnHeader(e){return!!rs(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",le(this,Ei),r,!0);o!==void 0&&Ut(this,Ei,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,le(this,Ei)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",le(this,Ei),r,!0),i&&e()};le(this,Gu)>=2&&(le(this,lr).length>1?(T(le(this,lr),i=>{n(i)}),e()):T(le(this,lr),i=>{n(i,!0)})),Ut(this,Gu,0),Ut(this,zu,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Xi(this,xM,nre).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Xi(this,HM,rre).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Xi(this,DM,ire).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Xi(this,NM,ore).call(this)),this.eventManager.addEventListener(le(this,Qn),"contextmenu",()=>Xi(this,LM,sre).call(this))}destroy(){super.destroy()}}function tre(){const t=this.hot.getSettings()[Mf],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{le(this,cr).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{le(this,cr).setValueAtIndex(r,n)})},!0),Ut(this,ju,t)):t===!0&&Array.isArray(le(this,ju))&&this.hot.batchExecution(()=>{le(this,ju).forEach((n,r)=>{le(this,cr).setValueAtIndex(r,n)})},!0)}function nre(t){if(!XS(t.target)&&le(this,Of)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(le(this,na)||this.setupHandlePosition(e))}}function rre(t){De(t.target,"manualColumnResizer")&&(this.setupHandlePosition(le(this,to)),this.setupGuidePosition(),Ut(this,na,!0),le(this,zu)===null&&(Ut(this,zu,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(le(this,zu))),Ut(this,Gu,le(this,Gu)+1),this.startX=t.pageX,Ut(this,Ei,le(this,Cl)))}function ire(t){if(le(this,na)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Ut(this,Af,le(this,Cl)+e),T(le(this,lr),n=>{Ut(this,Ei,this.setManualSize(n,le(this,Af)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function ore(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",le(this,Ei),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",le(this,Ei),n,!1)};le(this,na)&&(this.hideHandleAndGuide(),Ut(this,na,!1),le(this,Ei)!==le(this,Cl)&&(le(this,lr).length>1?(T(le(this,lr),r=>{e(r)}),t()):T(le(this,lr),r=>{e(r,!0)})),this.setupHandlePosition(le(this,to)))}function sre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(le(this,Qn)),this.hot.rootElement.removeChild(le(this,Zi)),Ut(this,na,!1),Ut(this,Of,!0),this.hot._registerImmediate(()=>{Ut(this,Of,!1)})}function are(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=le(this,cr).getValueAtIndex(r);this.hot.getSettings()[Mf]&&i&&(n=i)}return n}function lre(t,e){let n=le(this,cr).getValueAtIndex(e);return n===null&&(n=t),n}function ure(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function hC(t,e,n){return e=cre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cre(t){var e=hre(t,"string");return typeof e=="symbol"?e:String(e)}function hre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dC=0,WM=1,VM=2,Ka="px";let dre=class{constructor(e){hC(this,"hot",void 0),hC(this,"_element",null),hC(this,"state",dC),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=VM}build(){this.state===dC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=WM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=dC}isAppended(){return this.state===VM}isBuilt(){return this.state>=WM}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Ka),n!==void 0&&(this._element.style.left=n+Ka)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Ka),n&&(this._element.style.height=n+Ka)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Ka),n&&(this._element.style.marginLeft=n+Ka)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const PD=dre,fre="ht__manualRowMove--backlight";class gre extends PD{build(){super.build(),J(this._element,fre)}}const mre=gre,pre="ht__manualRowMove--guideline";class wre extends PD{build(){super.build(),J(this._element,pre)}}const Cre=wre;function Xa(t,e){xD(t,e),e.add(t)}function qa(t,e,n){xD(t,e),e.set(t,n)}function xD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xs(t,e,n){var r=HD(t,e,"set");return vre(t,r,n),n}function vre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fe(t,e){var n=HD(t,e,"get");return Sre(t,n)}function HD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Sre(t,e){return e.get?e.get.call(t):e.value}function Za(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");const fC="manualRowMove",yre=140,BM="ht__manualRowMove",If="show-ui",Qv="on-moving--rows",Jv="after-selection--rows";var Vn=new WeakMap,Yo=new WeakMap,ho=new WeakMap,qo=new WeakMap,rr=new WeakMap,ld=new WeakMap,UM=new WeakSet,YM=new WeakSet,GM=new WeakSet,zM=new WeakSet,jM=new WeakSet,KM=new WeakSet;class DD extends ot{constructor(){super(...arguments),Xa(this,KM),Xa(this,jM),Xa(this,zM),Xa(this,GM),Xa(this,YM),Xa(this,UM),qa(this,Vn,{writable:!0,value:new mre(this.hot)}),qa(this,Yo,{writable:!0,value:new Cre(this.hot)}),qa(this,ho,{writable:!0,value:[]}),qa(this,qo,{writable:!0,value:void 0}),qa(this,rr,{writable:!0,value:{}}),qa(this,ld,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return fC}static get PLUGIN_PRIORITY(){return yre}isEnabled(){return!!this.hot.getSettings()[fC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Za(e,UM,bre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Za(e,GM,Ere).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Za(this,jM,_re).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Za(e,KM,Mre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,BM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){$e(this.hot.rootElement,BM),this.unregisterEvents(),Fe(this,Vn).destroy(),Fe(this,Yo).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Fe(this,ld),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Xs(this,ld,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Xs(this,ld,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Yt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[fC];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return Ce(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Fe(this,rr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Fe(this,rr).TD,a=this.hot.rootElement,l=jt(a),u=Qs(a),c=o.holder.scrollTop,d=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-d,p=Fe(this,rr).eventPageY-f+c,w=o.hider.offsetHeight,v=o.TBODY.offsetTop,y=Fe(this,Vn).getOffset().top,b=Fe(this,Vn).getSize().height,_=s.offsetHeight/2,I=s.offsetHeight;let L=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const x=p>=L+_;this.isFixedRowTop(e.row)&&(L+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Fe(this,rr).row=n>0?n-1:n:x?(Fe(this,rr).row=e.row+1,L+=e.row===0?I-1:I):Fe(this,rr).row=e.row;let W=p,G=L;p+b+y>=w?W=w-b-y:p+y<v&&(W=v+Math.abs(y)),L>=w-1&&(G=w-1),Fe(this,Vn).setPosition(W),Fe(this,Yo).setPosition(G)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Za(this,YM,Rre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Za(this,zM,Tre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Fe(this,Vn).build(),Fe(this,Yo).build()}destroy(){Fe(this,Vn).destroy(),Fe(this,Yo).destroy(),super.destroy()}}function bre(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Fe(this,qo)||t.button!==0){Xs(this,qo,!1),Fe(this,ho).length=0,$e(this.hot.rootElement,[Qv,If]);return}const l=Fe(this,Yo).isBuilt()&&!Fe(this,Yo).isAppended(),u=Fe(this,Vn).isBuilt()&&!Fe(this,Vn).isAppended();l&&u&&(Fe(this,Yo).appendTo(i.hider),Fe(this,Vn).appendTo(i.hider));const{from:c,to:d}=a,f=Math.min(c.row,d.row),p=Math.max(c.row,d.row);if(e.col<0&&e.row>=f&&e.row<=p){r.row=!0,Xs(this,qo,!0),Fe(this,rr).eventPageY=t.pageY,Fe(this,rr).coords=e,Fe(this,rr).TD=n,Xs(this,ho,this.prepareRowsToMoving());const w=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(f,e.row-1)+t.offsetY;Fe(this,Vn).setPosition(null,w),Fe(this,Vn).setSize(i.hider.offsetWidth-w,this.getRowsHeight(f,p)),Fe(this,Vn).setOffset(-v,null),J(this.hot.rootElement,Qv),this.refreshPositions()}else $e(this.hot.rootElement,Jv),Xs(this,qo,!1),Fe(this,ho).length=0}function Rre(t){Fe(this,qo)&&(Fe(this,rr).eventPageY=t.pageY,this.refreshPositions())}function Ere(t,e,n,r){!this.hot.getSelectedRangeLast()||!Fe(this,qo)||(Fe(this,ho).indexOf(e.row)>-1?$e(this.hot.rootElement,If):J(this.hot.rootElement,If),r.row=!0,r.column=!0,r.cell=!0,Fe(this,rr).coords=e,Fe(this,rr).TD=n)}function Tre(){const t=Fe(this,rr).row,e=Fe(this,ho).length;if(Xs(this,qo,!1),$e(this.hot.rootElement,[Qv,If,Jv]),this.hot.selection.isSelectedByRowHeader()&&J(this.hot.rootElement,Jv),e<1||t===void 0)return;const n=Fe(this,ho)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Fe(this,ho),t);if(Fe(this,ho).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function _re(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Fe(this,Vn).setPosition(null,r),Fe(this,Vn).setSize(t.hider.offsetWidth-r)}function Mre(){this.moveBySettingsOrLoad()}function $s(t,e){ND(t,e),e.add(t)}function Sn(t,e,n){ND(t,e),e.set(t,n)}function ND(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ks(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Lt(t,e,n){var r=LD(t,e,"set");return Are(t,r,n),n}function Are(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ae(t,e){var n=LD(t,e,"get");return Ore(t,n)}function LD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ore(t,e){return e.get?e.get.call(t):e.value}const Pf="manualRowResize",Ire=30,XM="manualRowHeights";var vi=new WeakMap,ud=new WeakMap,ur=new WeakMap,xf=new WeakMap,Go=new WeakMap,bb=new WeakMap,vl=new WeakMap,cd=new WeakMap,$n=new WeakMap,pi=new WeakMap,ra=new WeakMap,Hf=new WeakMap,Ku=new WeakMap,Xu=new WeakMap,zr=new WeakMap,qu=new WeakMap,qM=new WeakSet,ZM=new WeakSet,QM=new WeakSet,JM=new WeakSet,e1=new WeakSet,t1=new WeakSet,n1=new WeakSet;class Pre extends ot{static get PLUGIN_KEY(){return Pf}static get PLUGIN_PRIORITY(){return Ire}constructor(e){super(e),$s(this,n1),$s(this,t1),$s(this,e1),$s(this,JM),$s(this,QM),$s(this,ZM),$s(this,qM),Sn(this,vi,{writable:!0,value:null}),Sn(this,ud,{writable:!0,value:null}),Sn(this,ur,{writable:!0,value:[]}),Sn(this,xf,{writable:!0,value:null}),Sn(this,Go,{writable:!0,value:null}),Sn(this,bb,{writable:!0,value:null}),Sn(this,vl,{writable:!0,value:null}),Sn(this,cd,{writable:!0,value:null}),Sn(this,$n,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Sn(this,pi,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Sn(this,ra,{writable:!0,value:!1}),Sn(this,Hf,{writable:!0,value:!1}),Sn(this,Ku,{writable:!0,value:0}),Sn(this,Xu,{writable:!0,value:null}),Sn(this,zr,{writable:!0,value:void 0}),Sn(this,qu,{writable:!0,value:void 0}),J(ae(this,$n),"manualRowResizer"),J(ae(this,pi),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Pf]}enablePlugin(){this.enabled||(Lt(this,zr,new cs),ae(this,zr).addLocalHook("init",()=>ks(this,n1,kre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ae(this,zr)),this.addHook("modifyRowHeight",(e,n)=>ks(this,t1,$re).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Lt(this,qu,ae(this,zr).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",XM,ae(this,zr).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",XM,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,mP.DEFAULT_HEIGHT);return ae(this,zr).setValueAtIndex(r,i),i}setupHandlePosition(e){Lt(this,vi,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ae(this,vi)),o=i.row;if(o<0)return;const s=dt(ae(this,vi)),a=ae(this,vi).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(this,vi),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ae(this,vi),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ae(this,vi),i.row,i.col)),Lt(this,ud,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Lt(this,ur,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const f=this.hot.getSelectedRange();T(f,p=>{const w=p.getTopStartCorner().row,v=p.getBottomStartCorner().row;Ce(w,v,y=>{ae(this,ur).includes(y)||ae(this,ur).push(y)})})}ae(this,ur).includes(ae(this,ud))||Lt(this,ur,[ae(this,ud)]),Lt(this,cd,c.top-6),Lt(this,vl,parseInt(a.height,10)),ae(this,$n).style.top=`${ae(this,cd)+ae(this,vl)}px`,ae(this,$n).style[this.inlineDir]=`${c.start}px`,ae(this,$n).style.width=`${s}px`,this.hot.rootElement.appendChild(ae(this,$n))}refreshHandlePosition(){ae(this,$n).style.top=`${ae(this,cd)+ae(this,xf)}px`}setupGuidePosition(){const e=parseInt(dt(ae(this,$n)),10),n=parseInt(ae(this,$n).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);J(ae(this,$n),"active"),J(ae(this,pi),"active"),ae(this,pi).style.top=ae(this,$n).style.top,ae(this,pi).style[this.inlineDir]=`${n}px`,ae(this,pi).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ae(this,pi))}refreshGuidePosition(){ae(this,pi).style.top=ae(this,$n).style.top}hideHandleAndGuide(){$e(ae(this,$n),"active"),$e(ae(this,pi),"active")}checkIfRowHeader(e){var n;return rs(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ae(this,Go)<n?n:ae(this,Go)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Lt(this,Go,o),this.setManualSize(r,ae(this,Go)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ae(this,Ku)>=2&&(ae(this,ur).length>1?(T(ae(this,ur),i=>{n(i)}),e()):T(ae(this,ur),i=>{n(i,!0)})),Lt(this,Ku,0),Lt(this,Xu,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>ks(this,qM,xre).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>ks(this,ZM,Hre).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>ks(this,QM,Dre).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>ks(this,JM,Nre).call(this)),this.eventManager.addEventListener(ae(this,$n),"contextmenu",()=>ks(this,e1,Lre).call(this))}destroy(){super.destroy()}}function xre(t){if(!XS(t.target)&&ae(this,Hf)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ae(this,ra)||this.setupHandlePosition(e))}}function Hre(t){De(t.target,"manualRowResizer")&&(this.setupHandlePosition(ae(this,vi)),this.setupGuidePosition(),Lt(this,ra,!0),ae(this,Xu)===null&&(Lt(this,Xu,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(this,Xu))),Lt(this,Ku,ae(this,Ku)+1),Lt(this,bb,t.pageY),Lt(this,Go,ae(this,vl)))}function Dre(t){ae(this,ra)&&(Lt(this,xf,ae(this,vl)+(t.pageY-ae(this,bb))),T(ae(this,ur),e=>{Lt(this,Go,this.setManualSize(e,ae(this,xf)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Nre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ae(this,ra)&&(this.hideHandleAndGuide(),Lt(this,ra,!1),ae(this,Go)!==ae(this,vl)&&(ae(this,ur).length>1?(T(ae(this,ur),r=>{e(r)}),t()):T(ae(this,ur),r=>{e(r,!0)})),this.setupHandlePosition(ae(this,vi)))}function Lre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(this,$n)),this.hot.rootElement.removeChild(ae(this,pi)),Lt(this,ra,!1),Lt(this,Hf,!0),this.hot._registerImmediate(()=>{Lt(this,Hf,!1)})}function $re(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ae(this,zr).getValueAtIndex(r);this.hot.getSettings()[Pf]&&i&&(n=i)}return n}function kre(){const t=this.hot.getSettings()[Pf],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ae(this,zr).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ae(this,zr).setValueAtIndex(r,n)}),Lt(this,qu,t)):t===!0&&Array.isArray(ae(this,qu))&&ae(this,qu).forEach((n,r)=>{ae(this,zr).setValueAtIndex(r,n)})},!0)}function Fs(t,e,n){return e=Fre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fre(t){var e=Wre(t,"string");return typeof e=="symbol"?e:String(e)}function Wre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vre{constructor(e,n,r,i,o,s){Fs(this,"row",void 0),Fs(this,"col",void 0),Fs(this,"rowspan",void 0),Fs(this,"colspan",void 0),Fs(this,"removed",!1),Fs(this,"cellCoordsFactory",void 0),Fs(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ft`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ft`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const d=l-u+1,f=Math.abs(r)-d;this[s]-=f+r,this[o]-=d}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const d=c-a+1;this[o]-=d}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Si=Vre;function eS(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function gC(t,e,n){return e=Bre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bre(t){var e=Ure(t,"string");return typeof e=="symbol"?e:String(e)}function Ure(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rb{constructor(e){gC(this,"plugin",void 0),gC(this,"mergedCells",[]),gC(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return T(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return T(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return T(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Si(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(vt(Rb.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];T(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,T(n,(i,o)=>{Ce(0,i.rowspan-1,s=>{Ce(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),T(n,i=>{eS(...i)}),T(r,i=>{eS(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return T(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}T(this.mergedCells,o=>{o.shift(i,n)}),uf(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Yre=Rb;function mC(t,e,n){return e=Gre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gre(t){var e=zre(t,"string");return typeof e=="symbol"?e:String(e)}function zre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jre{constructor(e){mC(this,"plugin",void 0),mC(this,"mergedCellsCollection",void 0),mC(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,f=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,p=Math.floor(s/f)*f,w=s-p,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const y=v.row+v.rowspan-a-w;o[2]+y>=this.plugin.hot.countRows()?o[2]-=w:o[2]+=w?y:0}else if(r==="right"){const y=v.col+v.colspan-l-w;o[3]+y>=this.plugin.hot.countCols()?o[3]-=w:o[3]+=w?y:0}else if(r==="up"){const y=u-w-v.row+1;o[0]+y<0?o[0]+=w:o[0]-=w?y:0}else if(r==="left"){const y=c-w-v.col+1;o[1]+y<0?o[1]+=w:o[1]-=w?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Kt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return d-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,d];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,d=u?o:s,f=this.getAutofillSize(e,n,r),p=u?a-o+1:l-s+1,w=Math.floor(f/p)*p,v=f-w;let y=null,b=null,_=null;switch(r){case"up":y="includesVertically",_=c-v+1;break;case"left":y="includesHorizontally",_=c-v+1;break;case"down":y="includesVertically",_=d+v-1;break;case"right":y="includesHorizontally",_=d+v-1;break}return T(i,I=>{I[y](_)&&I.isFarther(b,r)&&(b=I)}),b}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return T(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}const Kre=jre;function pC(t,e,n){return e=Xre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xre(t){var e=qre(t,"string");return typeof e=="symbol"?e:String(e)}function qre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zre{constructor(e){pC(this,"plugin",void 0),pC(this,"hot",void 0),pC(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const d=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=d&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const Qre=Zre;function Jre(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Lg)}return this.getTranslatedPhrase(Ng)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Si.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Bt(t,e){$D(t,e),e.add(t)}function eie(t,e,n){$D(t,e),e.set(t,n)}function $D(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wC(t,e,n){return e=tie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tie(t){var e=nie(t,"string");return typeof e=="symbol"?e:String(e)}function nie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CC(t,e,n){var r=kD(t,e,"set");return rie(t,r,n),n}function rie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Qa(t,e){var n=kD(t,e,"get");return iie(t,n)}function kD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function iie(t,e){return e.get?e.get.call(t):e.value}function Ht(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");const Zu="mergeCells",oie=150,r1=Zu;var wi=new WeakMap,i1=new WeakSet,o1=new WeakSet,s1=new WeakSet,a1=new WeakSet,l1=new WeakSet,u1=new WeakSet,c1=new WeakSet,vC=new WeakSet,h1=new WeakSet,d1=new WeakSet,f1=new WeakSet,g1=new WeakSet,m1=new WeakSet,p1=new WeakSet,w1=new WeakSet,C1=new WeakSet,v1=new WeakSet,S1=new WeakSet,y1=new WeakSet,b1=new WeakSet,R1=new WeakSet,E1=new WeakSet;class sie extends ot{constructor(){super(...arguments),Bt(this,E1),Bt(this,R1),Bt(this,b1),Bt(this,y1),Bt(this,S1),Bt(this,v1),Bt(this,C1),Bt(this,w1),Bt(this,p1),Bt(this,m1),Bt(this,g1),Bt(this,f1),Bt(this,d1),Bt(this,h1),Bt(this,vC),Bt(this,c1),Bt(this,u1),Bt(this,l1),Bt(this,a1),Bt(this,s1),Bt(this,o1),Bt(this,i1),wC(this,"mergedCellsCollection",null),wC(this,"autofillCalculations",null),wC(this,"selectionCalculations",null),eie(this,wi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Zu}static get PLUGIN_PRIORITY(){return oie}isEnabled(){return!!this.hot.getSettings()[Zu]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Yre(this),this.autofillCalculations=new Kre(this),this.selectionCalculations=new Qre(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,i1,aie).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,s1,uie).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,b1,Tie).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,a1,cie).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,l1,hie).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,vC,T1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,vC,T1).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,h1,gie).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,o1,lie).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,c1,fie).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,u1,die).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,d1,mie).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,f1,pie).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,g1,wie).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,m1,Cie).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,p1,vie).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,w1,Sie).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,C1,yie).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,v1,bie).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,S1,Rie).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,y1,Eie).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,R1,_ie).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,E1,Mie).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Zu];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!JS())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Sl(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Sl(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(Si.containsNegativeValues(e)?(vt(Si.NEGATIVE_VALUES_WARNING(e)),n=!1):Si.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(vt(Si.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):Si.isSingleCell(e)?(vt(Si.IS_SINGLE_CELL(e)),n=!1):Si.containsZeroSpan(e)&&(vt(Si.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(T(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),Ce(r.row,r.row+r.rowspan-1,a=>{Ce(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),Ce(0,s.rowspan-1,c=>{Ce(0,s.colspan-1,d=>{let f=null;a[c]||(a[c]=[]),c===0&&d===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+d,"hidden",!0),a[c][d]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),T(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),Ce(0,i.rowspan-1,o=>{Ce(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:r1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(r1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ue(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ue(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ue(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ue(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function aie(){this.generateFromSettings(this.hot.getSettings()[Zu]),this.hot.render()}function lie(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function uie(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(Qa(this,wi)||CC(this,wi,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(Qa(this,wi))||CC(this,wi,this.hot._createCellCoords(null,null)),n.row=Qa(this,wi).row?Qa(this,wi).row-i.row:n.row,n.col=Qa(this,wi).col?Qa(this,wi).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);CC(this,wi,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function cie(t){const e=this.hot.getSelectedRangeLast(),n=Un(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Un(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Un(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),T(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function hie(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function die(t){t.items.push({name:"---------"},Jre(this))}function fie(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Ue(r)?Un(r):void 0;if(Ue(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[d,f]=this.translateMergedCellToRenderable(a,c,l,u),p=o.getRenderableFromVisualIndex(e),w=s.getRenderableFromVisualIndex(n),v=d-p+1,y=f-w+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,v),i.colspan=Math.min(i.colspan,y)}eS(t,i,e,n)}function T1(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function gie(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function mie(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function pie(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function wie(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Cie(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function vie(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Sie(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function yie(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function bie(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Rie(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Eie(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);T(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Tie(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,d=r.col===0;(i&&l||o&&u||a&&c||s&&d)&&(t.row=r.row,t.col=r.col)}function _ie(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Mie(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Aie(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],d=o[a],f=u.multiColumnSorting,w=(f.compareFunctionFactory?f.compareFunctionFactory:sH(u.type))(l,u,f)(c,d);if(w===Mi){const v=a+1;if(typeof e[v]<"u")return s(v)}return w}(0)}}function _1(){vt(ft`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const FD="sort";function Oie(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${FD}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Iie(t){const e=t.className.split(" "),n=new RegExp(`^${FD}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Pie(t,e,n){return e=xie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xie(t){var e=Hie(t,"string");return typeof e=="symbol"?e:String(e)}function Hie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Df="multiColumnSorting",Die=170,M1="columnSorting",A1=Df;oH(Df,Aie);class WD extends aH{constructor(){super(...arguments),Pie(this,"pluginKey",Df)}static get PLUGIN_KEY(){return Df}static get PLUGIN_PRIORITY(){return Die}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[M1]&&_1(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,vf))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:A1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(A1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),$e(e,Iie(e)),this.enabled!==!1&&J(e,Oie(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[M1]&&_1(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){cb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,vf))):this.sort(this.getColumnNextConfig(n.col)))}}function O1(t,e,n){return e=Nie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:String(e)}function Lie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $ie="multipleSelectionHandles",kie=160;class Fie extends ot{constructor(){super(...arguments),O1(this,"dragged",[]),O1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return $ie}static get PLUGIN_PRIORITY(){return kie}isEnabled(){return so()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(De(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(De(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(De(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(De(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,d;if(e.dragged.length===0)return;const f=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),d=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function tS(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function VD(){return{label:"",isPlaceholder:!0}}function Wie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;T(t,i=>{const o=[];let s=0;n.push(o),T(i,a=>{const l=tS();if(Ue(a)){const{label:c,colspan:d}=a;l.label=Ft(c),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=Ft(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(VD());return!u})});const r=Math.max(...Ye(n,i=>i.length));return T(n,i=>{if(i.length<r){const o=Ye(new Array(r-i.length),()=>tS());i.splice(i.length,0,...o)}}),n}function SC(t,e,n){Vie(t,e),e.set(t,n)}function Vie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vr(t,e){var n=BD(t,e,"get");return Bie(t,n)}function Bie(t,e){return e.get?e.get.call(t):e.value}function yu(t,e,n){var r=BD(t,e,"set");return Uie(t,r,n),n}function BD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Uie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const I1=["label","collapsible"];var qi=new WeakMap,Ws=new WeakMap,yC=new WeakMap;class Yie{constructor(){SC(this,qi,{writable:!0,value:[]}),SC(this,Ws,{writable:!0,value:0}),SC(this,yC,{writable:!0,value:1/0})}setColumnsLimit(e){yu(this,yC,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];yu(this,qi,Wie(e,Vr(this,yC))),yu(this,Ws,Vr(this,qi).length)}getData(){return Vr(this,qi)}mergeWith(e){T(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&Kt(s,o,I1)})}map(e){T(Vr(this,qi),n=>{T(n,r=>{const i=e({...r});Ue(i)&&Kt(r,i,I1)})})}getHeaderSettings(e,n){var r;if(e>=Vr(this,Ws)||e<0)return null;const i=Vr(this,qi)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Vr(this,Ws)||e<0)return i;const o=Vr(this,qi)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Vr(this,Ws)}getColumnsCount(){return Vr(this,Ws)>0?Vr(this,qi)[0].length:0}clear(){yu(this,qi,[]),yu(this,Ws,0)}}function bC(t,e,n){return e=Gie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=zie(t,"string");return typeof e=="symbol"?e:String(e)}function zie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const UD="DF-pre-order";function YD(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=YD.call(this.childs[r],t,e)}return n}const jie="DF-post-order";function GD(t,e){for(let n=0;n<this.childs.length;n++)if(GD.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const zD="BF";function Kie(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Xie=zD,P1=new Map([[UD,YD],[jie,GD],[zD,Kie]]);class Nf{constructor(e){bC(this,"data",{}),bC(this,"parent",null),bC(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Nf({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xie;if(!P1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);P1.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function RC(t,e,n){qie(t,e),e.set(t,n)}function qie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ln(t,e){var n=jD(t,e,"get");return Zie(t,n)}function Zie(t,e){return e.get?e.get.call(t):e.value}function Qie(t,e,n){var r=jD(t,e,"set");return Jie(t,r,n),n}function jD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Jie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ja=new WeakMap,Vs=new WeakMap,el=new WeakMap;class eoe{constructor(e){RC(this,Ja,{writable:!0,value:new Map}),RC(this,Vs,{writable:!0,value:new Map}),RC(this,el,{writable:!0,value:null}),Qie(this,el,e)}getRoots(){return Array.from(Ln(this,Ja).values())}getRootByColumn(e){let n;return Ln(this,Vs).has(e)&&(n=Ln(this,Ja).get(Ln(this,Vs).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Ln(this,Vs).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Ln(this,Vs).clear(),T(Ln(this,Ja),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Ln(this,Vs).set(i,e);e+=r})}buildTree(){this.clear();const e=Ln(this,el).getColumnsCount();let n=0;for(;n<e;){const r=Ln(this,el).getHeaderSettings(0,n),i=new Nf;Ln(this,Ja).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Ln(this,el).getHeadersSettings(r,n,i);r+=1,T(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Nf(a),e.addChild(l)),r<Ln(this,el).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Ln(this,Ja).clear(),Ln(this,Vs).clear()}}function KD(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Lf(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function $f(t){return Lf(t,"origColspan")===t.data.origColspan}function Eb(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if($f(t))return Eb(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)T(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,KD(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):$f(a)&&(l.isCollapsed=Lf(a,"isCollapsed"))}),{rollbackModification:()=>Tb(t),affectedColumns:Array.from(o),colspanCompensation:s}}function Tb(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if($f(t))return Tb(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)T(o,l=>{KD(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const d=u+c;s.add(d)}}const a=n.colspan-((e=Lf(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):$f(l)&&(u.isCollapsed=Lf(l,"isCollapsed"))}),{rollbackModification:()=>Eb(t),affectedColumns:Array.from(s),colspanCompensation:a}}function toe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ft`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function noe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ft`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const x1=new Map([["collapse",Tb],["expand",Eb],["hide-column",toe],["show-column",noe]]);function roe(t,e,n){if(!x1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return x1.get(t)(e,n)}function hd(t){const e=[];return T(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=ooe(e,a);let c=!1;for(let d=s;d<s+o;d++)if(l.includes(d)||c)u.push(VD());else{const p=ioe(i);p.isRoot=!0,u.push(p),c=!0}})}),e}function ioe(t){const{crossHiddenColumns:e,...n}=tS(t);return n}function ooe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function EC(t,e,n){soe(t,e),e.set(t,n)}function soe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bu(t,e,n){var r=XD(t,e,"set");return aoe(t,r,n),n}function aoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Dt(t,e){var n=XD(t,e,"get");return loe(t,n)}function XD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function loe(t,e){return e.get?e.get.call(t):e.value}var mi=new WeakMap,Xn=new WeakMap,Bs=new WeakMap;class uoe{constructor(){EC(this,mi,{writable:!0,value:new Yie}),EC(this,Xn,{writable:!0,value:new eoe(Dt(this,mi))}),EC(this,Bs,{writable:!0,value:[[]]})}setState(e){Dt(this,mi).setData(e);let n=!1;try{Dt(this,Xn).buildTree()}catch{Dt(this,Xn).clear(),Dt(this,mi).clear(),n=!0}return bu(this,Bs,hd(Dt(this,Xn).getRoots())),n}setColumnsLimit(e){Dt(this,mi).setColumnsLimit(e)}mergeStateWith(e){const n=Ye(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Dt(this,mi).mergeWith(n),Dt(this,Xn).buildTree(),bu(this,Bs,hd(Dt(this,Xn).getRoots()))}mapState(e){Dt(this,mi).map(e),Dt(this,Xn).buildTree(),bu(this,Bs,hd(Dt(this,Xn).getRoots()))}mapNodes(e){return Yt(Dt(this,Xn).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Dt(this,Xn).getNode(n,r);let o;return i&&(o=roe(e,i,r),bu(this,Bs,hd(Dt(this,Xn).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Dt(this,Bs)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Dt(this,Xn).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Dt(this,Xn).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:d,origColspan:f,isHidden:p}=u.data;p||f<=i&&c>=e&&c+f-1<=r&&(s===null||d<s)&&(s=d)},UD)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Dt(this,mi).getLayersCount()}getColumnsCount(){return Dt(this,mi).getColumnsCount()}clear(){bu(this,Bs,[]),Dt(this,mi).clear(),Dt(this,Xn).clear()}}function Ru(t,e,n){return e=coe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function coe(t){var e=hoe(t,"string");return typeof e=="symbol"?e:String(e)}function hoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class doe{constructor(e,n){Ru(this,"hot",void 0),Ru(this,"nestedHeaderSettingsGetter",void 0),Ru(this,"layersCount",0),Ru(this,"container",void 0),Ru(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let d=r.getVisualFromRenderableIndex(c);d===null&&(d=c);const f=n.createElement("th"),p=this.nestedHeaderSettingsGetter(l,d);if(p&&(!p.isPlaceholder||p.isHidden)){let w=p.label;s&&(w+='<button class="changeType"></button>'),ca(f,w),f.colSpan=p.colspan,u.appendChild(f)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const foe=doe;function cn(t,e){qD(t,e),e.add(t)}function H1(t,e,n){return e=goe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function goe(t){var e=moe(t,"string");return typeof e=="symbol"?e:String(e)}function moe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dd(t,e,n){qD(t,e),e.set(t,n)}function qD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qs(t,e,n){var r=ZD(t,e,"set");return poe(t,r,n),n}function poe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function rt(t,e){var n=ZD(t,e,"get");return woe(t,n)}function ZD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function woe(t,e){return e.get?e.get.call(t):e.value}function Qt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const D1="nestedHeaders",Coe=280;var ht=new WeakMap,$o=new WeakMap,Qu=new WeakMap,Zm=new WeakMap,fd=new WeakSet,N1=new WeakSet,L1=new WeakSet,$1=new WeakSet,k1=new WeakSet,F1=new WeakSet,W1=new WeakSet,V1=new WeakSet,B1=new WeakSet,U1=new WeakSet,Y1=new WeakSet,G1=new WeakSet,z1=new WeakSet,j1=new WeakSet,K1=new WeakSet,X1=new WeakSet,q1=new WeakSet,Z1=new WeakSet;class voe extends ot{constructor(){super(...arguments),cn(this,Z1),cn(this,q1),cn(this,X1),cn(this,K1),cn(this,j1),cn(this,z1),cn(this,G1),cn(this,Y1),cn(this,U1),cn(this,B1),cn(this,V1),cn(this,W1),cn(this,F1),cn(this,k1),cn(this,$1),cn(this,L1),cn(this,N1),cn(this,fd),dd(this,ht,{writable:!0,value:new uoe}),dd(this,$o,{writable:!0,value:null}),dd(this,Qu,{writable:!0,value:null}),dd(this,Zm,{writable:!0,value:!1}),H1(this,"ghostTable",new foe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),H1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return D1}static get PLUGIN_PRIORITY(){return Coe}isEnabled(){return!!this.hot.getSettings()[D1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&vt(ft`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Qt(this,q1,Noe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,Z1,Loe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,k1,Roe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,F1,Eoe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,W1,Toe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,V1,_oe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,B1,Moe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,U1,Aoe).call(e,...i)}),this.addHook("afterSelection",()=>Qt(this,fd,TC).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,N1,Soe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Qt(this,G1,Ioe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,j1,xoe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,K1,Hoe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,L1,yoe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,$1,boe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,Y1,Ooe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,z1,Poe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,X1,Doe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Qt(this,fd,TC).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Qt(this,fd,TC).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();rt(this,ht).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=rt(this,ht).setState(e)),this.detectedOverlappedHeaders&&vt(ft`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";rt(this,ht).triggerColumnModification(i,r)}),!rt(this,$o)&&this.enabled&&qs(this,$o,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";rt(this,ht).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),rt(this,ht).clear(),rt(this,$o).unsubscribe(),qs(this,$o,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return rt(this,ht)}getLayersCount(){return rt(this,ht).getLayersCount()}getHeaderSettings(e,n){return rt(this,ht).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,d=a.childNodes.length;c<d;c++)a.childNodes[c].removeAttribute("colspan"),$e(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),$e(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),$e(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),$e(o,"hiddenHeader");const{colspan:c,isHidden:d,isPlaceholder:f}=(s=rt(this,ht).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||d)J(o,"hiddenHeader");else if(c>1){var p,w;const{wtOverlays:v}=l._wt,y=(p=v.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),b=(w=v.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o),_=y||b?Math.min(c,r-i):c;_>1&&o.setAttribute("colspan",_)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=rt(this,ht).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){qs(this,ht,null),rt(this,$o)!==null&&(rt(this,$o).unsubscribe(),qs(this,$o,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return rt(this,ht).getHeaderTreeNodeData(e.row,e.col)}}function TC(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=rt(this,ht).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Soe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=rt(this,ht).findLeftMostColumnIndex(n.row,n.col),a=rt(this,ht).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function yoe(t,e,n){const r=rt(this,ht).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=rt(this,ht).getHeaderSettings(e,t);if(o===by){if(!a)return r.columnIndex}else if(o===PP&&(l>s-i||!a))return null;return t}function boe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,d=a-u+1;if(s>=0||d===1)break;for(let f=a;f<=u;f++)for(let p=s;p<=l;p++){var i;const w=c+p,v=f-a;if(v===0)continue;((i=rt(this,ht).getHeaderTreeNodeData(p,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[w][v]="")}}}function Roe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Eoe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;qs(this,Qu,e.clone()),qs(this,Zm,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(fg(t)||ss(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Toe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const d=[],f=ir(e.row,-1/0,-1);e.col<c.col?d.push(u.col,o,f):e.col>c.col?d.push(l.col,o+s-1,f):d.push(o,o+s-1,f),this.hot.selection.selectColumns(...d)}function _oe(){qs(this,Zm,!1)}function Moe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!rt(this,Zm)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=rt(this,ht).getHeaderTreeNodeData(rt(this,Qu).row,rt(this,Qu).col);if(e.setHighlight(rt(this,Qu)),o>e.getWidth()||i<n||i+o-1>r){const s=rt(this,ht).findTopMostEntireHeaderLevel(ir(n,i,i+o-1),ir(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Aoe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=rt(this,ht).findLeftMostColumnIndex(n.row,n.col),o=rt(this,ht).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Ooe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Ioe(t){t.length=0;for(let e=0;e<rt(this,ht).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Poe(t){const e=rt(this,ht).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=rt(this,ht).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Bn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?rt(this,ht).getHeaderTreeNodeData(0,n).columnIndex:n}function xoe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Hoe(t,e,n){var r;const{label:i}=(r=rt(this,ht).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Doe(t,e){if(t<0)return this.hot.getCell(t,rt(this,ht).findLeftMostColumnIndex(t,e),!0)}function Noe(){this.updatePlugin()}function Loe(t,e){e||this.updatePlugin()}function Eu(t,e,n){return e=$oe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $oe(t){var e=koe(t,"string");return typeof e=="symbol"?e:String(e)}function koe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Foe{constructor(e,n){Eu(this,"hot",void 0),Eu(this,"data",null),Eu(this,"plugin",void 0),Eu(this,"parentReference",new WeakMap),Eu(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&T(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&T(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ge(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(T(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(Ce(e[0],e[2],f=>{const p=this.translateTrimmedRow(f);i.push(this.getDataObject(p))}),Ce(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let d=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const f=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,f,this.plugin.pluginName),u){d=c+this.countChildren(u);const p=this.getChild(u,this.countChildren(u)-1),w=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",w+1,s+1,this.plugin.pluginName),u.__children.push(r)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];T(r,o=>{i.push(this.getDataObject(o))}),T(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const d=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(d,0,l[0]),s.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const Woe=Foe;function Q1(t,e,n){return e=Voe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Voe(t){var e=Boe(t,"string");return typeof e=="symbol"?e:String(e)}function Boe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uoe{constructor(e,n){Q1(this,"hot",void 0),Q1(this,"plugin",void 0),this.hot=n,this.plugin=e}}const _b=Uoe;class no extends _b{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(T(l,c=>{c&&s.removeChild(c)}),J(n,no.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,d=a.cloneNode(!0);s.innerHTML="",Ce(0,i-1,()=>{const f=c.createElement("SPAN");J(f,no.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(d)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&_e(c,[yo()]),J(n,no.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(J(c,`${no.CSS_CLASSES.button} ${no.CSS_CLASSES.expandButton}`),u&&_e(n,[_r(!1)])):(J(c,`${no.CSS_CLASSES.button} ${no.CSS_CLASSES.collapseButton}`),u&&_e(n,[_r(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const QD=no;class Yoe extends _b{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),T(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{Ce(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&T(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&T(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&T(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);De(e.target,QD.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Pr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Goe=Yoe;function zoe(t,e,n){joe(t,e),e.set(t,n)}function joe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Koe(t,e,n){return e=Xoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xoe(t){var e=qoe(t,"string");return typeof e=="symbol"?e:String(e)}function qoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zoe(t,e){var n=Qoe(t,e,"get");return Joe(t,n)}function Qoe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Joe(t,e){return e.get?e.get.call(t):e.value}var J1=new WeakMap;class ese extends _b{constructor(){super(...arguments),Koe(this,"dataManager",this.plugin.dataManager),zoe(this,J1,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(tm)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(nm)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,e.items.length-1,r=>{if(r===0)return T(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Ce(0,e.items.length-1,n=>{const r=Zoe(this,J1)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const tse=ese;function gd(t,e,n){return e=nse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nse(t){var e=rse(t,"string");return typeof e=="symbol"?e:String(e)}function rse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ise{constructor(e){gd(this,"plugin",void 0),gd(this,"hot",void 0),gd(this,"dataManager",void 0),gd(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(w=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const d=this.getBaseParent(u),f=this.getTargetParent(s,a),p=d===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,p),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Ct(i)&&(vt(ft`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function yn(t,e){JD(t,e),e.add(t)}function eA(t,e,n){JD(t,e),e.set(t,n)}function JD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _C(t,e,n){return e=ose(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ose(t){var e=sse(t,"string");return typeof e=="symbol"?e:String(e)}function sse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bd(t,e){var n=eN(t,e,"get");return ase(t,n)}function ase(t,e){return e.get?e.get.call(t):e.value}function kf(t,e,n){var r=eN(t,e,"set");return lse(t,r,n),n}function eN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function mn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ff="nestedRows",use=300,tA=Ff,cse="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Qm=new WeakMap,tl=new WeakMap,nA=new WeakSet,rA=new WeakSet,iA=new WeakSet,oA=new WeakSet,sA=new WeakSet,aA=new WeakSet,lA=new WeakSet,uA=new WeakSet,cA=new WeakSet,hA=new WeakSet,dA=new WeakSet,fA=new WeakSet,gA=new WeakSet,mA=new WeakSet,pA=new WeakSet,MC=new WeakSet;class hse extends ot{constructor(){super(...arguments),yn(this,MC),yn(this,pA),yn(this,mA),yn(this,gA),yn(this,fA),yn(this,dA),yn(this,hA),yn(this,cA),yn(this,uA),yn(this,lA),yn(this,aA),yn(this,sA),yn(this,oA),yn(this,iA),yn(this,rA),yn(this,nA),_C(this,"dataManager",null),_C(this,"headersUI",null),_C(this,"collapsedRowsMap",null),eA(this,Qm,{writable:!0,value:!1}),eA(this,tl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Ff}static get PLUGIN_PRIORITY(){return use}isEnabled(){return!!this.hot.getSettings()[Ff]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Dc),this.dataManager=new Woe(this,this.hot),this.collapsingUI=new Goe(this,this.hot),this.headersUI=new QD(this,this.hot),this.contextMenuUI=new tse(this,this.hot),this.rowMoveController=new ise(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,mA,Tse).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,pA,_se).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,iA,gse).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,oA,mse).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,sA,pse).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,rA,fse).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,uA,vse).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,lA,Cse).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,cA,Sse).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,hA,yse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,dA,bse).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,fA,Rse).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,aA,wse).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,gA,Ese).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,nA,dse).call(e,...r)}),this.addHook("beforeLoadData",n=>mn(this,MC,wA).call(this,n)),this.addHook("beforeUpdateData",n=>mn(this,MC,wA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:tA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tA)}disableCoreAPIModifiers(){kf(this,tl,!0)}enableCoreAPIModifiers(){kf(this,tl,!1)}onModifyRowData(e){if(!Bd(this,tl))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Bd(this,tl))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Bd(this,tl)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function dse(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function fse(t,e,n){this.collapsingUI.toggleState(t,e,n)}function gse(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),kf(this,Qm,!0),this.dataManager.getData().slice()}function mse(t){return this.contextMenuUI.appendOptions(t)}function pse(t,e){this.headersUI.appendLevelIndicators(t,e)}function wse(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Cse(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{kf(this,Qm,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function vse(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Sse(){this.collapsingUI.collapsedRowsStash.stash()}function yse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function bse(){this.collapsingUI.collapsedRowsStash.stash()}function Rse(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Ese(){this.dataManager.rewriteCache()}function Tse(){this.headersUI.updateRowHeaderWidth()}function _se(t,e){Bd(this,Qm)&&(e.skipRender=!0)}function wA(t){if(!YP(t)){iy(cse),this.hot.getSettings()[Ff]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function AC(t,e,n){return e=Mse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mse(t){var e=Ase(t,"string");return typeof e=="symbol"?e:String(e)}function Ase(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ose{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;AC(this,"rootWindow",void 0),AC(this,"prefix",void 0),AC(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){T(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Ise=Ose;function Pse(t,e,n){return e=xse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xse(t){var e=Hse(t,"string");return typeof e=="symbol"?e:String(e)}function Hse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");const CA="persistentState",Dse=0;class Nse extends ot{constructor(){super(...arguments),Pse(this,"storage",void 0)}static get PLUGIN_KEY(){return CA}static get PLUGIN_PRIORITY(){return Dse}isEnabled(){return!!this.hot.getSettings()[CA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Ise(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Lse(t,e){$se(t,e),e.add(t)}function $se(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OC(t,e,n){return e=kse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kse(t){var e=Fse(t,"string");return typeof e=="symbol"?e:String(e)}function Fse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vA(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const IC="search",Wse=190,Vse="htSearchResult",Bse=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Use=function(t,e,n){return Ct(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ct(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var PC=new WeakSet;class Yse extends ot{constructor(){super(...arguments),Lse(this,PC),OC(this,"callback",Bse),OC(this,"queryMethod",Use),OC(this,"searchResultClass",Vse)}static get PLUGIN_KEY(){return IC}static get PLUGIN_PRIORITY(){return Wse}isEnabled(){return this.hot.getSettings()[IC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[IC];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vA(e,PC,SA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vA(e,PC,SA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return Ce(0,i-1,l=>{Ce(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),d=this.hot.getCellMeta(l,u),f=d.search.callback||n,w=(d.search.queryMethod||r)(e,c,d);if(w){const v={row:l,col:u,data:c};s.push(v)}f&&f(a,l,u,c,w)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ue(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function SA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function xC(t,e){Gse(t,e),e.add(t)}function Gse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function md(t,e,n){return e=zse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zse(t){var e=jse(t,"string");return typeof e=="symbol"?e:String(e)}function jse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Kse="touchScroll",Xse=200;var yA=new WeakSet,bA=new WeakSet,RA=new WeakSet;class qse extends ot{constructor(){super(...arguments),xC(this,RA),xC(this,bA),xC(this,yA),md(this,"scrollbars",[]),md(this,"clones",[]),md(this,"lockedCollection",!1),md(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Kse}static get PLUGIN_PRIORITY(){return Xse}static get SETTING_KEYS(){return!0}isEnabled(){return my()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>HC(this,yA,Zse).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>HC(this,bA,Qse).call(this)),this.addHook("afterMomentumScroll",()=>HC(this,RA,Jse).call(this))}}function Zse(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Qse(){this.freezeOverlays=!0,T(this.clones,t=>{J(t,"hide-tween")})}function Jse(){this.freezeOverlays=!1,T(this.clones,t=>{$e(t,"hide-tween"),J(t,"show-tween")}),this.hot._registerTimeout(()=>{T(this.clones,t=>{$e(t,"show-tween")})},400),T(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function eae(t,e){tae(t,e),e.add(t)}function tae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nae(t,e,n){return e=rae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rae(t){var e=iae(t,"string");return typeof e=="symbol"?e:String(e)}function iae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oae(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ud="trimRows",sae=330;var EA=new WeakSet;class aae extends ot{constructor(){super(...arguments),eae(this,EA),nae(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Ud}static get PLUGIN_PRIORITY(){return sae}isEnabled(){return!!this.hot.getSettings()[Ud]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Dc),this.trimmedRowsMap.addLocalHook("init",()=>oae(this,EA,lae).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Ud];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),T(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(T(e,l=>{o[l]=!1}),i=Yt(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function lae(){const t=this.hot.getSettings()[Ud];Array.isArray(t)&&this.hot.batchExecution(()=>{T(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const tN="undoRedo",uae="undoRedo";function ce(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);T(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new ce.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new ce.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=An(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new ce.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new ce.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],d=[];Ce(a.length-1,w=>{const v=[],y=a[w];Ce(l,l+(r-1),b=>{v.push(y[t.toPhysicalColumn(b)])}),u.push(v)}),Ce(r-1,w=>{d.push(t.toPhysicalColumn(l+w))}),Array.isArray(t.getSettings().colHeaders)&&Ce(r-1,w=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+w)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new ce.RemoveColumnAction(l,d,u,c,f,p,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new ce.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new ce.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new ce.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new ce.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new ce.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}ce.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};ce.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=An(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};ce.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=An(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};ce.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ce.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ce.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ce.prototype.isEnabled=function(){return this.enabled};ce.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,dae(t),this.registerShortcuts(),t.addHook("afterChange",nN)};ce.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,fae(t),this.unregisterShortcuts(),t.removeHook("afterChange",nN)};ce.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ce.Action=function(){};ce.Action.prototype.undo=function(){};ce.Action.prototype.redo=function(){};ce.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};bo(ce.ChangeAction,ce.Action);ce.ChangeAction.prototype.undo=function(t,e){const n=An(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};ce.ChangeAction.prototype.redo=function(t,e){const n=An(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};ce.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};bo(ce.CreateRowAction,ce.Action);ce.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ce.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ce.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};bo(ce.RemoveRowAction,ce.Action);ce.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ce.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ce.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};bo(ce.CreateColumnAction,ce.Action);ce.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ce.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ce.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};bo(ce.RemoveColumnAction,ce.Action);ce.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,d)=>d[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ye(this.data[u],i));const a=Ye(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),T(t.getSourceDataArray(),(u,c)=>{T(r,(d,f)=>{u[d]=s[c][f],l.push([c,d,u[d]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&T(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};ce.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ce.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};ce.CellAlignmentAction.prototype.undo=function(t,e){T(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};ce.CellAlignmentAction.prototype.redo=function(t,e){Fo(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};ce.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};bo(ce.FiltersAction,ce.Action);ce.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};ce.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class cae extends ce.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}ce.MergeCellsAction=cae;class hae extends ce.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}ce.UnmergeCellsAction=hae;ce.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};bo(ce.RowMoveAction,ce.Action);ce.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ce.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ce.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ce.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:tN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ce.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(tN)};function nN(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function dae(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function fae(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const zc=ge.getSingleton();zc.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});zc.register("beforeUndo");zc.register("afterUndo");zc.register("beforeRedo");zc.register("afterRedo");ce.PLUGIN_KEY=uae;ce.SETTING_KEYS=!0;function gae(){We(ml),We(e7),We(Wu),We(P7),We(W7),We(aH),We(PX),We(pq),We(Bc),We(_H),We(uQ),We(wQ),We(Uc),We(YQ),We(oD),We(xte),We(SD),We(RD),We(Ane),We(Une),We(ere),We(DD),We(Pre),We(sie),We(WD),We(Fie),We(voe),We(hse),We(Nse),We(Yse),We(qse),We(aae),We(ce)}function mae(){er(xl),er(Zy),er(_x),er(Px),er(nb),er(qy),er($x),er(Wx),er(Vx),er(da),er(Ux)}function pae(){Ci(Hl),Ci($c),Ci(Jy),Ci(Qy),Ci(rb),Ci(ob),Ci(To),Ci(sb)}function wae(){ul(Fm),ul(tb),ul(ib),ul(ab)}function Cae(){mae(),pae(),wae(),w8(),gae()}function vae(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var DC,NC,LC,$C,kC;Cae();vae(Ie);Ie.__GhostTable=lb;Ie._getListenersCounter=WG;Ie._getRegisteredMapsCounter=n4;Ie.EventManager=mr;const Sae=[gY,yG,B3,U5,wj,nG,CY,nz,CG,SY,EG,tz],yae=[QY,TG];Ie.helper={};Ie.dom={};T(Sae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ie.helper[e]=t[e])})});T(yae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ie.dom[e]=t[e])})});Ie.cellTypes=(DC=Ie.cellTypes)!==null&&DC!==void 0?DC:{};T(b6(),t=>{Ie.cellTypes[t]=Ky(t)});Ie.cellTypes.registerCellType=Rn;Ie.cellTypes.getCellType=Ky;Ie.editors=(NC=Ie.editors)!==null&&NC!==void 0?NC:{};T(HG(),t=>{Ie.editors[`${Mn(t)}Editor`]=af(t)});Ie.editors.registerEditor=er;Ie.editors.getEditor=af;Ie.renderers=(LC=Ie.renderers)!==null&&LC!==void 0?LC:{};T(wz(),t=>{const e=cf(t);t==="base"&&(Ie.renderers.cellDecorator=e),Ie.renderers[`${Mn(t)}Renderer`]=e});Ie.renderers.registerRenderer=Ci;Ie.renderers.getRenderer=cf;Ie.validators=($C=Ie.validators)!==null&&$C!==void 0?$C:{};T(Sz(),t=>{Ie.validators[`${Mn(t)}Validator`]=uy(t)});Ie.validators.registerValidator=ul;Ie.validators.getValidator=uy;Ie.plugins=(kC=Ie.plugins)!==null&&kC!==void 0?kC:{};T(ly(),t=>{Ie.plugins[t]=Pc(t)});Ie.plugins[`${Mn(ot.PLUGIN_KEY)}Plugin`]=ot;Ie.plugins.registerPlugin=We;Ie.plugins.getPlugin=Pc;const TA=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function bae(t,e,n,r,i,o){if(n!==0)return;const s=t.parentElement;s!==null&&(e%2===0?Ie.dom.addClass(s,aE):Ie.dom.removeClass(s,aE))}function Rae(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(TA.has(t.toString())?(Ie.dom.removeClass(e.firstChild,n),Ie.dom.addClass(e.firstChild,TA.get(t.toString()))):Ie.dom.addClass(e.firstChild,n))}We(ml);We(Bc);We(_H);We(Uc);We(oD);We(SD);We(RD);We(DD);We(WD);We(ce);Rn(Dx);Rn(Nx);Rn(Ax);Rn(Fx);Gy(Tx);const Eae=document.getElementById("example");new Ie(Eae,{data:f5(),layoutDirection:Pd()?"rtl":"ltr",language:Pd()?Tx.languageCode:"en-US",height:450,colWidths:[170,222,130,120,120,130,156],colHeaders:["Company name","Name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1,dateFormat:Pd()?"M/D/YYYY":"DD/MM/YYYY"},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:5,type:"text"},{data:2,type:"text"}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,navigableHeaders:!0,autoWrapCol:!0,afterGetColHeader:Rae,beforeRenderer:bae,licenseKey:"non-commercial-and-evaluation"});console.log(`Handsontable: v${Ie.version} (${Ie.buildDate})`)});export default Tae();
