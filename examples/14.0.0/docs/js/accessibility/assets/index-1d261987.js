var gN=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ole=gN((yle,Ud)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Qr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function GC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function FO(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var qc=function(t){return t&&t.Math===Math&&t},An=qc(typeof globalThis=="object"&&globalThis)||qc(typeof window=="object"&&window)||qc(typeof self=="object"&&self)||qc(typeof Qr=="object"&&Qr)||function(){return this}()||Qr||Function("return this")(),zC={},Pr=function(t){try{return!!t()}catch{return!0}},mN=Pr,Ii=!mN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),pN=Pr,Wf=!pN(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),wN=Wf,Zc=Function.prototype.call,Vf=wN?Zc.bind(Zc):function(){return Zc.apply(Zc,arguments)},WO={},VO={}.propertyIsEnumerable,BO=Object.getOwnPropertyDescriptor,CN=BO&&!VO.call({1:2},1);WO.f=CN?function(e){var n=BO(this,e);return!!n&&n.enumerable}:VO;var YC=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},UO=Wf,GO=Function.prototype,Mw=GO.call,vN=UO&&GO.bind.bind(Mw,Mw),zn=UO?vN:function(t){return function(){return Mw.apply(t,arguments)}},zO=zn,SN=zO({}.toString),yN=zO("".slice),xl=function(t){return yN(SN(t),8,-1)},bN=zn,RN=Pr,EN=xl,Gg=Object,TN=bN("".split),_N=RN(function(){return!Gg("z").propertyIsEnumerable(0)})?function(t){return EN(t)==="String"?TN(t,""):Gg(t)}:Gg,YO=function(t){return t==null},MN=YO,AN=TypeError,jO=function(t){if(MN(t))throw new AN("Can't call method on "+t);return t},ON=_N,PN=jO,Bf=function(t){return ON(PN(t))},Aw=typeof document=="object"&&document.all,xN=typeof Aw>"u"&&Aw!==void 0,KO={all:Aw,IS_HTMLDDA:xN},XO=KO,IN=XO.all,wn=XO.IS_HTMLDDA?function(t){return typeof t=="function"||t===IN}:function(t){return typeof t=="function"},zb=wn,qO=KO,HN=qO.all,la=qO.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:zb(t)||t===HN}:function(t){return typeof t=="object"?t!==null:zb(t)},zg=An,DN=wn,NN=function(t){return DN(t)?t:void 0},Ec=function(t,e){return arguments.length<2?NN(zg[t]):zg[t]&&zg[t][e]},LN=zn,ZO=LN({}.isPrototypeOf),jC=typeof navigator<"u"&&String(navigator.userAgent)||"",QO=An,Yg=jC,Yb=QO.process,jb=QO.Deno,Kb=Yb&&Yb.versions||jb&&jb.version,Xb=Kb&&Kb.v8,Xr,Gd;Xb&&(Xr=Xb.split("."),Gd=Xr[0]>0&&Xr[0]<4?1:+(Xr[0]+Xr[1]));!Gd&&Yg&&(Xr=Yg.match(/Edge\/(\d+)/),(!Xr||Xr[1]>=74)&&(Xr=Yg.match(/Chrome\/(\d+)/),Xr&&(Gd=+Xr[1])));var kN=Gd,qb=kN,$N=Pr,FN=An,WN=FN.String,KC=!!Object.getOwnPropertySymbols&&!$N(function(){var t=Symbol("symbol detection");return!WN(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&qb&&qb<41}),VN=KC,JO=VN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",BN=Ec,UN=wn,GN=ZO,zN=JO,YN=Object,XC=zN?function(t){return typeof t=="symbol"}:function(t){var e=BN("Symbol");return UN(e)&&GN(e.prototype,YN(t))},jN=String,eP=function(t){try{return jN(t)}catch{return"Object"}},KN=wn,XN=eP,qN=TypeError,qC=function(t){if(KN(t))return t;throw new qN(XN(t)+" is not a function")},ZN=qC,QN=YO,JN=function(t,e){var n=t[e];return QN(n)?void 0:ZN(n)},jg=Vf,Kg=wn,Xg=la,eL=TypeError,tL=function(t,e){var n,r;if(e==="string"&&Kg(n=t.toString)&&!Xg(r=jg(n,t))||Kg(n=t.valueOf)&&!Xg(r=jg(n,t))||e!=="string"&&Kg(n=t.toString)&&!Xg(r=jg(n,t)))return r;throw new eL("Can't convert object to primitive value")},tP={exports:{}},Zb=An,nL=Object.defineProperty,ZC=function(t,e){try{nL(Zb,t,{value:e,configurable:!0,writable:!0})}catch{Zb[t]=e}return e},rL=An,iL=ZC,Qb="__core-js_shared__",oL=rL[Qb]||iL(Qb,{}),QC=oL,Jb=QC;(tP.exports=function(t,e){return Jb[t]||(Jb[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.33.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.2/LICENSE",source:"https://github.com/zloirock/core-js"});var nP=tP.exports,sL=jO,aL=Object,Uf=function(t){return aL(sL(t))},lL=zn,uL=Uf,cL=lL({}.hasOwnProperty),bo=Object.hasOwn||function(e,n){return cL(uL(e),n)},hL=zn,dL=0,fL=Math.random(),gL=hL(1 .toString),rP=function(t){return"Symbol("+(t===void 0?"":t)+")_"+gL(++dL+fL,36)},mL=An,pL=nP,eR=bo,wL=rP,CL=KC,vL=JO,fl=mL.Symbol,qg=pL("wks"),SL=vL?fl.for||fl:fl&&fl.withoutSetter||wL,Gf=function(t){return eR(qg,t)||(qg[t]=CL&&eR(fl,t)?fl[t]:SL("Symbol."+t)),qg[t]},yL=Vf,tR=la,nR=XC,bL=JN,RL=tL,EL=Gf,TL=TypeError,_L=EL("toPrimitive"),ML=function(t,e){if(!tR(t)||nR(t))return t;var n=bL(t,_L),r;if(n){if(e===void 0&&(e="default"),r=yL(n,t,e),!tR(r)||nR(r))return r;throw new TL("Can't convert object to primitive value")}return e===void 0&&(e="number"),RL(t,e)},AL=ML,OL=XC,iP=function(t){var e=AL(t,"string");return OL(e)?e:e+""},PL=An,rR=la,Ow=PL.document,xL=rR(Ow)&&rR(Ow.createElement),JC=function(t){return xL?Ow.createElement(t):{}},IL=Ii,HL=Pr,DL=JC,oP=!IL&&!HL(function(){return Object.defineProperty(DL("div"),"a",{get:function(){return 7}}).a!==7}),NL=Ii,LL=Vf,kL=WO,$L=YC,FL=Bf,WL=iP,VL=bo,BL=oP,iR=Object.getOwnPropertyDescriptor;zC.f=NL?iR:function(e,n){if(e=FL(e),n=WL(n),BL)try{return iR(e,n)}catch{}if(VL(e,n))return $L(!LL(kL.f,e,n),e[n])};var ua={},UL=Ii,GL=Pr,sP=UL&&GL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),zL=la,YL=String,jL=TypeError,Tc=function(t){if(zL(t))return t;throw new jL(YL(t)+" is not an object")},KL=Ii,XL=oP,qL=sP,Qc=Tc,oR=iP,ZL=TypeError,Zg=Object.defineProperty,QL=Object.getOwnPropertyDescriptor,Qg="enumerable",Jg="configurable",em="writable";ua.f=KL?qL?function(e,n,r){if(Qc(e),n=oR(n),Qc(r),typeof e=="function"&&n==="prototype"&&"value"in r&&em in r&&!r[em]){var i=QL(e,n);i&&i[em]&&(e[n]=r.value,r={configurable:Jg in r?r[Jg]:i[Jg],enumerable:Qg in r?r[Qg]:i[Qg],writable:!1})}return Zg(e,n,r)}:Zg:function(e,n,r){if(Qc(e),n=oR(n),Qc(r),XL)try{return Zg(e,n,r)}catch{}if("get"in r||"set"in r)throw new ZL("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var JL=Ii,ek=ua,tk=YC,_c=JL?function(t,e,n){return ek.f(t,e,tk(1,n))}:function(t,e,n){return t[e]=n,t},aP={exports:{}},Pw=Ii,nk=bo,lP=Function.prototype,rk=Pw&&Object.getOwnPropertyDescriptor,ev=nk(lP,"name"),ik=ev&&(function(){}).name==="something",ok=ev&&(!Pw||Pw&&rk(lP,"name").configurable),sk={EXISTS:ev,PROPER:ik,CONFIGURABLE:ok},ak=zn,lk=wn,xw=QC,uk=ak(Function.toString);lk(xw.inspectSource)||(xw.inspectSource=function(t){return uk(t)});var ck=xw.inspectSource,hk=An,dk=wn,sR=hk.WeakMap,fk=dk(sR)&&/native code/.test(String(sR)),gk=nP,mk=rP,aR=gk("keys"),uP=function(t){return aR[t]||(aR[t]=mk(t))},tv={},pk=fk,cP=An,wk=la,Ck=_c,tm=bo,nm=QC,vk=uP,Sk=tv,lR="Object already initialized",Iw=cP.TypeError,yk=cP.WeakMap,zd,oc,Yd,bk=function(t){return Yd(t)?oc(t):zd(t,{})},Rk=function(t){return function(e){var n;if(!wk(e)||(n=oc(e)).type!==t)throw new Iw("Incompatible receiver, "+t+" required");return n}};if(pk||nm.state){var si=nm.state||(nm.state=new yk);si.get=si.get,si.has=si.has,si.set=si.set,zd=function(t,e){if(si.has(t))throw new Iw(lR);return e.facade=t,si.set(t,e),e},oc=function(t){return si.get(t)||{}},Yd=function(t){return si.has(t)}}else{var ya=vk("state");Sk[ya]=!0,zd=function(t,e){if(tm(t,ya))throw new Iw(lR);return e.facade=t,Ck(t,ya,e),e},oc=function(t){return tm(t,ya)?t[ya]:{}},Yd=function(t){return tm(t,ya)}}var Ek={set:zd,get:oc,has:Yd,enforce:bk,getterFor:Rk},nv=zn,Tk=Pr,_k=wn,Jc=bo,Hw=Ii,Mk=sk.CONFIGURABLE,Ak=ck,hP=Ek,Ok=hP.enforce,Pk=hP.get,uR=String,wd=Object.defineProperty,xk=nv("".slice),Ik=nv("".replace),Hk=nv([].join),Dk=Hw&&!Tk(function(){return wd(function(){},"length",{value:8}).length!==8}),Nk=String(String).split("String"),Lk=aP.exports=function(t,e,n){xk(uR(e),0,7)==="Symbol("&&(e="["+Ik(uR(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Jc(t,"name")||Mk&&t.name!==e)&&(Hw?wd(t,"name",{value:e,configurable:!0}):t.name=e),Dk&&n&&Jc(n,"arity")&&t.length!==n.arity&&wd(t,"length",{value:n.arity});try{n&&Jc(n,"constructor")&&n.constructor?Hw&&wd(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=Ok(t);return Jc(r,"source")||(r.source=Hk(Nk,typeof e=="string"?e:"")),t};Function.prototype.toString=Lk(function(){return _k(this)&&Pk(this).source||Ak(this)},"toString");var kk=aP.exports,$k=wn,Fk=ua,Wk=kk,Vk=ZC,Bk=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if($k(n)&&Wk(n,o,r),r.global)i?t[e]=n:Vk(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:Fk.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},dP={},Uk=Math.ceil,Gk=Math.floor,zk=Math.trunc||function(e){var n=+e;return(n>0?Gk:Uk)(n)},Yk=zk,rv=function(t){var e=+t;return e!==e||e===0?0:Yk(e)},jk=rv,Kk=Math.max,Xk=Math.min,qk=function(t,e){var n=jk(t);return n<0?Kk(n+e,0):Xk(n,e)},Zk=rv,Qk=Math.min,Jk=function(t){return t>0?Qk(Zk(t),9007199254740991):0},e$=Jk,zf=function(t){return e$(t.length)},t$=Bf,n$=qk,r$=zf,cR=function(t){return function(e,n,r){var i=t$(e),o=r$(i),s=n$(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},i$={includes:cR(!0),indexOf:cR(!1)},o$=zn,rm=bo,s$=Bf,a$=i$.indexOf,l$=tv,hR=o$([].push),fP=function(t,e){var n=s$(t),r=0,i=[],o;for(o in n)!rm(l$,o)&&rm(n,o)&&hR(i,o);for(;e.length>r;)rm(n,o=e[r++])&&(~a$(i,o)||hR(i,o));return i},iv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],u$=fP,c$=iv,h$=c$.concat("length","prototype");dP.f=Object.getOwnPropertyNames||function(e){return u$(e,h$)};var gP={};gP.f=Object.getOwnPropertySymbols;var d$=Ec,f$=zn,g$=dP,m$=gP,p$=Tc,w$=f$([].concat),C$=d$("Reflect","ownKeys")||function(e){var n=g$.f(p$(e)),r=m$.f;return r?w$(n,r(e)):n},dR=bo,v$=C$,S$=zC,y$=ua,mP=function(t,e,n){for(var r=v$(e),i=y$.f,o=S$.f,s=0;s<r.length;s++){var a=r[s];!dR(t,a)&&!(n&&dR(n,a))&&i(t,a,o(e,a))}},b$=Pr,R$=wn,E$=/#|\.prototype\./,Mc=function(t,e){var n=_$[T$(t)];return n===A$?!0:n===M$?!1:R$(e)?b$(e):!!e},T$=Mc.normalize=function(t){return String(t).replace(E$,".").toLowerCase()},_$=Mc.data={},M$=Mc.NATIVE="N",A$=Mc.POLYFILL="P",O$=Mc,im=An,P$=zC.f,x$=_c,I$=Bk,H$=ZC,D$=mP,N$=O$,ca=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=im:i?s=im[n]||H$(n,{}):s=(im[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=P$(s,a),l=c&&c.value):l=s[a],o=N$(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;D$(u,l)}(t.sham||l&&l.sham)&&x$(u,"sham",!0),I$(s,a,u,t)}},L$=xl,pP=Array.isArray||function(e){return L$(e)==="Array"},k$=Ii,$$=pP,F$=TypeError,W$=Object.getOwnPropertyDescriptor,V$=k$&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),wP=V$?function(t,e){if($$(t)&&!W$(t,"length").writable)throw new F$("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},B$=TypeError,U$=9007199254740991,CP=function(t){if(t>U$)throw B$("Maximum allowed index exceeded");return t},G$=ca,z$=Uf,Y$=zf,j$=wP,K$=CP,X$=Pr,q$=X$(function(){return[].push.call({length:4294967296},1)!==4294967297}),Z$=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Q$=q$||!Z$();G$({target:"Array",proto:!0,arity:1,forced:Q$},{push:function(e){var n=z$(this),r=Y$(n),i=arguments.length;K$(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return j$(n,r),r}});var J$=Wf,vP=Function.prototype,fR=vP.apply,gR=vP.call,Yf=typeof Reflect=="object"&&Reflect.apply||(J$?gR.bind(fR):function(){return gR.apply(fR,arguments)}),eF=zn,tF=qC,nF=function(t,e,n){try{return eF(tF(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},rF=wn,iF=String,oF=TypeError,sF=function(t){if(typeof t=="object"||rF(t))return t;throw new oF("Can't set "+iF(t)+" as a prototype")},aF=nF,lF=Tc,uF=sF,SP=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=aF(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return lF(i),uF(o),t?n(i,o):i.__proto__=o,i}}():void 0),cF=ua.f,hF=function(t,e,n){n in t||cF(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},dF=wn,fF=la,mR=SP,gF=function(t,e,n){var r,i;return mR&&dF(r=e.constructor)&&r!==n&&fF(i=r.prototype)&&i!==n.prototype&&mR(t,i),t},mF=Gf,pF=mF("toStringTag"),yP={};yP[pF]="z";var wF=String(yP)==="[object z]",CF=wF,vF=wn,Cd=xl,SF=Gf,yF=SF("toStringTag"),bF=Object,RF=Cd(function(){return arguments}())==="Arguments",EF=function(t,e){try{return t[e]}catch{}},TF=CF?Cd:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=EF(e=bF(t),yF))=="string"?n:RF?Cd(e):(r=Cd(e))==="Object"&&vF(e.callee)?"Arguments":r},_F=TF,MF=String,bP=function(t){if(_F(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return MF(t)},AF=bP,OF=function(t,e){return t===void 0?arguments.length<2?"":e:AF(t)},PF=la,xF=_c,IF=function(t,e){PF(e)&&"cause"in e&&xF(t,"cause",e.cause)},HF=zn,RP=Error,DF=HF("".replace),NF=function(t){return String(new RP(t).stack)}("zxcasd"),EP=/\n\s*at [^:]*:[^\n]*/,LF=EP.test(NF),kF=function(t,e){if(LF&&typeof t=="string"&&!RP.prepareStackTrace)for(;e--;)t=DF(t,EP,"");return t},$F=Pr,FF=YC,WF=!$F(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",FF(1,7)),t.stack!==7):!0}),VF=_c,BF=kF,UF=WF,pR=Error.captureStackTrace,GF=function(t,e,n,r){UF&&(pR?pR(t,e):VF(t,"stack",BF(n,r)))},wR=Ec,zF=bo,CR=_c,YF=ZO,vR=SP,SR=mP,yR=hF,jF=gF,KF=OF,XF=IF,qF=GF,ZF=Ii,QF=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=wR.apply(null,s);if(l){var u=l.prototype;if(zF(u,"cause")&&delete u.cause,!n)return l;var c=wR("Error"),h=e(function(f,g){var w=KF(r?g:f,void 0),C=r?new l(f):new l;return w!==void 0&&CR(C,"message",w),qF(C,h,C.stack,2),this&&YF(u,this)&&jF(C,this,h),arguments.length>o&&XF(C,arguments[o]),C});h.prototype=u,a!=="Error"?vR?vR(h,c):SR(h,c,{name:!0}):ZF&&i in l&&(yR(h,l,i),yR(h,l,"prepareStackTrace")),SR(h,l);try{u.name!==a&&CR(u,"name",a),u.constructor=h}catch{}return h}},TP=ca,JF=An,Hi=Yf,_P=QF,Dw="WebAssembly",bR=JF[Dw],jd=new Error("e",{cause:7}).cause!==7,ha=function(t,e){var n={};n[t]=_P(t,e,jd),TP({global:!0,constructor:!0,arity:1,forced:jd},n)},ov=function(t,e){if(bR&&bR[t]){var n={};n[t]=_P(Dw+"."+t,e,jd),TP({target:Dw,stat:!0,constructor:!0,arity:1,forced:jd},n)}};ha("Error",function(t){return function(n){return Hi(t,this,arguments)}});ha("EvalError",function(t){return function(n){return Hi(t,this,arguments)}});ha("RangeError",function(t){return function(n){return Hi(t,this,arguments)}});ha("ReferenceError",function(t){return function(n){return Hi(t,this,arguments)}});ha("SyntaxError",function(t){return function(n){return Hi(t,this,arguments)}});ha("TypeError",function(t){return function(n){return Hi(t,this,arguments)}});ha("URIError",function(t){return function(n){return Hi(t,this,arguments)}});ov("CompileError",function(t){return function(n){return Hi(t,this,arguments)}});ov("LinkError",function(t){return function(n){return Hi(t,this,arguments)}});ov("RuntimeError",function(t){return function(n){return Hi(t,this,arguments)}});var eW=xl,tW=zn,nW=function(t){if(eW(t)==="Function")return tW(t)},RR=nW,rW=qC,iW=Wf,oW=RR(RR.bind),sW=function(t,e){return rW(t),e===void 0?t:iW?oW(t,e):function(){return t.apply(e,arguments)}},aW=Ec,MP=aW("document","documentElement"),lW=zn,sv=lW([].slice),uW=TypeError,AP=function(t,e){if(t<e)throw new uW("Not enough arguments");return t},cW=jC,hW=/(?:ipad|iphone|ipod).*applewebkit/i.test(cW),dW=An,fW=xl,gW=fW(dW.process)==="process",gr=An,mW=Yf,pW=sW,ER=wn,wW=bo,OP=Pr,TR=MP,CW=sv,_R=JC,vW=AP,SW=hW,yW=gW,Nw=gr.setImmediate,Lw=gr.clearImmediate,bW=gr.process,om=gr.Dispatch,RW=gr.Function,MR=gr.MessageChannel,EW=gr.String,sm=0,ku={},AR="onreadystatechange",sc,ps,am,lm;OP(function(){sc=gr.location});var av=function(t){if(wW(ku,t)){var e=ku[t];delete ku[t],e()}},um=function(t){return function(){av(t)}},OR=function(t){av(t.data)},PR=function(t){gr.postMessage(EW(t),sc.protocol+"//"+sc.host)};(!Nw||!Lw)&&(Nw=function(e){vW(arguments.length,1);var n=ER(e)?e:RW(e),r=CW(arguments,1);return ku[++sm]=function(){mW(n,void 0,r)},ps(sm),sm},Lw=function(e){delete ku[e]},yW?ps=function(t){bW.nextTick(um(t))}:om&&om.now?ps=function(t){om.now(um(t))}:MR&&!SW?(am=new MR,lm=am.port2,am.port1.onmessage=OR,ps=pW(lm.postMessage,lm)):gr.addEventListener&&ER(gr.postMessage)&&!gr.importScripts&&sc&&sc.protocol!=="file:"&&!OP(PR)?(ps=PR,gr.addEventListener("message",OR,!1)):AR in _R("script")?ps=function(t){TR.appendChild(_R("script"))[AR]=function(){TR.removeChild(this),av(t)}}:ps=function(t){setTimeout(um(t),0)});var PP={set:Nw,clear:Lw},TW=ca,_W=An,xR=PP.clear;TW({global:!0,bind:!0,enumerable:!0,forced:_W.clearImmediate!==xR},{clearImmediate:xR});var MW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",xP=An,AW=Yf,OW=wn,PW=MW,xW=jC,IW=sv,HW=AP,DW=xP.Function,NW=/MSIE .\./.test(xW)||PW&&function(){var t=xP.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),LW=function(t,e){var n=e?2:1;return NW?function(r,i){var o=HW(arguments.length,1)>n,s=OW(r)?r:DW(r),a=o?IW(arguments,n):[],l=o?function(){AW(s,this,a)}:s;return e?t(l,i):t(l)}:t},kW=ca,IP=An,IR=PP.set,$W=LW,HR=IP.setImmediate?$W(IR,!1):IR;kW({global:!0,bind:!0,enumerable:!0,forced:IP.setImmediate!==HR},{setImmediate:HR});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function zo(t){"@babel/helpers - typeof";return zo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zo(t)}function kw(t,e){return kw=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},kw(t,e)}function FW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function vd(t,e,n){return FW()?vd=Reflect.construct:vd=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&kw(u,s.prototype),u},vd.apply(null,arguments)}function Gr(t){return WW(t)||VW(t)||BW(t)||UW()}function WW(t){if(Array.isArray(t))return $w(t)}function VW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function BW(t,e){if(t){if(typeof t=="string")return $w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $w(t,e)}}function $w(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function UW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var GW=Object.hasOwnProperty,DR=Object.setPrototypeOf,zW=Object.isFrozen,YW=Object.getPrototypeOf,jW=Object.getOwnPropertyDescriptor,Gn=Object.freeze,ei=Object.seal,KW=Object.create,HP=typeof Reflect<"u"&&Reflect,Kd=HP.apply,Fw=HP.construct;Kd||(Kd=function(e,n,r){return e.apply(n,r)});Gn||(Gn=function(e){return e});ei||(ei=function(e){return e});Fw||(Fw=function(e,n){return vd(e,Gr(n))});var XW=Or(Array.prototype.forEach),NR=Or(Array.prototype.pop),Gl=Or(Array.prototype.push),Sd=Or(String.prototype.toLowerCase),cm=Or(String.prototype.toString),qW=Or(String.prototype.match),Dr=Or(String.prototype.replace),ZW=Or(String.prototype.indexOf),QW=Or(String.prototype.trim),In=Or(RegExp.prototype.test),hm=JW(TypeError);function Or(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Kd(t,e,r)}}function JW(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Fw(t,n)}}function Xe(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Sd,DR&&DR(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(zW(e)||(e[i]=s),o=s)}t[o]=!0}return t}function ws(t){var e=KW(null),n;for(n in t)Kd(GW,t,[n])===!0&&(e[n]=t[n]);return e}function eh(t,e){for(;t!==null;){var n=jW(t,e);if(n){if(n.get)return Or(n.get);if(typeof n.value=="function")return Or(n.value)}t=YW(t)}function r(i){return console.warn("fallback value for",i),null}return r}var LR=Gn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dm=Gn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),fm=Gn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),eV=Gn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),gm=Gn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),tV=Gn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),kR=Gn(["#text"]),$R=Gn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),mm=Gn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),FR=Gn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),th=Gn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),nV=ei(/\{\{[\w\W]*|[\w\W]*\}\}/gm),rV=ei(/<%[\w\W]*|[\w\W]*%>/gm),iV=ei(/\${[\w\W]*}/gm),oV=ei(/^data-[\-\w.\u00B7-\uFFFF]/),sV=ei(/^aria-[\-\w]+$/),aV=ei(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),lV=ei(/^(?:\w+script|data):/i),uV=ei(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),cV=ei(/^html$/i),hV=function(){return typeof window>"u"?null:window},dV=function(e,n){if(zo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function DP(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hV(),e=function(L){return DP(L)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,f=t.DOMParser,g=t.trustedTypes,w=a.prototype,C=eh(w,"cloneNode"),b=eh(w,"nextSibling"),y=eh(w,"childNodes"),_=eh(w,"parentNode");if(typeof o=="function"){var O=r.createElement("template");O.content&&O.content.ownerDocument&&(r=O.content.ownerDocument)}var I=dV(g,n),x=I?I.createHTML(""):"",k=r,U=k.implementation,Z=k.createNodeIterator,z=k.createDocumentFragment,K=k.getElementsByTagName,te=n.importNode,oe={};try{oe=ws(r).documentMode?r.documentMode:{}}catch{}var ie={};e.isSupported=typeof _=="function"&&U&&U.createHTMLDocument!==void 0&&oe!==9;var he=nV,Te=rV,ze=iV,Ne=oV,R=sV,d=lV,m=uV,p=aV,E=null,M=Xe({},[].concat(Gr(LR),Gr(dm),Gr(fm),Gr(gm),Gr(kR))),P=null,Y=Xe({},[].concat(Gr($R),Gr(mm),Gr(FR),Gr(th))),B=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),q=null,J=null,X=!0,fe=!0,Oe=!1,Ee=!0,Pe=!1,j=!1,Ke=!1,$e=!1,ye=!1,He=!1,Re=!1,v=!0,S=!1,A="user-content-",W=!0,H=!1,F={},D=null,N=Xe({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,$=Xe({},["audio","video","img","source","image","track"]),G=null,se=Xe({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ge="http://www.w3.org/1998/Math/MathML",be="http://www.w3.org/2000/svg",xe="http://www.w3.org/1999/xhtml",Ve=xe,St=!1,Qe=null,ct=Xe({},[ge,be,xe],cm),_t,Sa=["application/xhtml+xml","text/html"],Bl="text/html",Vt,dn=null,ms=r.createElement("form"),xn=function(L){return L instanceof RegExp||L instanceof Function},tn=function(L){dn&&dn===L||((!L||zo(L)!=="object")&&(L={}),L=ws(L),_t=Sa.indexOf(L.PARSER_MEDIA_TYPE)===-1?_t=Bl:_t=L.PARSER_MEDIA_TYPE,Vt=_t==="application/xhtml+xml"?cm:Sd,E="ALLOWED_TAGS"in L?Xe({},L.ALLOWED_TAGS,Vt):M,P="ALLOWED_ATTR"in L?Xe({},L.ALLOWED_ATTR,Vt):Y,Qe="ALLOWED_NAMESPACES"in L?Xe({},L.ALLOWED_NAMESPACES,cm):ct,G="ADD_URI_SAFE_ATTR"in L?Xe(ws(se),L.ADD_URI_SAFE_ATTR,Vt):se,V="ADD_DATA_URI_TAGS"in L?Xe(ws($),L.ADD_DATA_URI_TAGS,Vt):$,D="FORBID_CONTENTS"in L?Xe({},L.FORBID_CONTENTS,Vt):N,q="FORBID_TAGS"in L?Xe({},L.FORBID_TAGS,Vt):{},J="FORBID_ATTR"in L?Xe({},L.FORBID_ATTR,Vt):{},F="USE_PROFILES"in L?L.USE_PROFILES:!1,X=L.ALLOW_ARIA_ATTR!==!1,fe=L.ALLOW_DATA_ATTR!==!1,Oe=L.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=L.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Pe=L.SAFE_FOR_TEMPLATES||!1,j=L.WHOLE_DOCUMENT||!1,ye=L.RETURN_DOM||!1,He=L.RETURN_DOM_FRAGMENT||!1,Re=L.RETURN_TRUSTED_TYPE||!1,$e=L.FORCE_BODY||!1,v=L.SANITIZE_DOM!==!1,S=L.SANITIZE_NAMED_PROPS||!1,W=L.KEEP_CONTENT!==!1,H=L.IN_PLACE||!1,p=L.ALLOWED_URI_REGEXP||p,Ve=L.NAMESPACE||xe,B=L.CUSTOM_ELEMENT_HANDLING||{},L.CUSTOM_ELEMENT_HANDLING&&xn(L.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(B.tagNameCheck=L.CUSTOM_ELEMENT_HANDLING.tagNameCheck),L.CUSTOM_ELEMENT_HANDLING&&xn(L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(B.attributeNameCheck=L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),L.CUSTOM_ELEMENT_HANDLING&&typeof L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(B.allowCustomizedBuiltInElements=L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pe&&(fe=!1),He&&(ye=!0),F&&(E=Xe({},Gr(kR)),P=[],F.html===!0&&(Xe(E,LR),Xe(P,$R)),F.svg===!0&&(Xe(E,dm),Xe(P,mm),Xe(P,th)),F.svgFilters===!0&&(Xe(E,fm),Xe(P,mm),Xe(P,th)),F.mathMl===!0&&(Xe(E,gm),Xe(P,FR),Xe(P,th))),L.ADD_TAGS&&(E===M&&(E=ws(E)),Xe(E,L.ADD_TAGS,Vt)),L.ADD_ATTR&&(P===Y&&(P=ws(P)),Xe(P,L.ADD_ATTR,Vt)),L.ADD_URI_SAFE_ATTR&&Xe(G,L.ADD_URI_SAFE_ATTR,Vt),L.FORBID_CONTENTS&&(D===N&&(D=ws(D)),Xe(D,L.FORBID_CONTENTS,Vt)),W&&(E["#text"]=!0),j&&Xe(E,["html","head","body"]),E.table&&(Xe(E,["tbody"]),delete q.tbody),Gn&&Gn(L),dn=L)},yt=Xe({},["mi","mo","mn","ms","mtext"]),kb=Xe({},["foreignobject","desc","title","annotation-xml"]),cN=Xe({},["title","style","font","a","script"]),Kc=Xe({},dm);Xe(Kc,fm),Xe(Kc,eV);var Vg=Xe({},gm);Xe(Vg,tV);var hN=function(L){var re=_(L);(!re||!re.tagName)&&(re={namespaceURI:Ve,tagName:"template"});var ue=Sd(L.tagName),ut=Sd(re.tagName);return Qe[L.namespaceURI]?L.namespaceURI===be?re.namespaceURI===xe?ue==="svg":re.namespaceURI===ge?ue==="svg"&&(ut==="annotation-xml"||yt[ut]):!!Kc[ue]:L.namespaceURI===ge?re.namespaceURI===xe?ue==="math":re.namespaceURI===be?ue==="math"&&kb[ut]:!!Vg[ue]:L.namespaceURI===xe?re.namespaceURI===be&&!kb[ut]||re.namespaceURI===ge&&!yt[ut]?!1:!Vg[ue]&&(cN[ue]||!Kc[ue]):!!(_t==="application/xhtml+xml"&&Qe[L.namespaceURI]):!1},ki=function(L){Gl(e.removed,{element:L});try{L.parentNode.removeChild(L)}catch{try{L.outerHTML=x}catch{L.remove()}}},Bg=function(L,re){try{Gl(e.removed,{attribute:re.getAttributeNode(L),from:re})}catch{Gl(e.removed,{attribute:null,from:re})}if(re.removeAttribute(L),L==="is"&&!P[L])if(ye||He)try{ki(re)}catch{}else try{re.setAttribute(L,"")}catch{}},$b=function(L){var re,ue;if($e)L="<remove></remove>"+L;else{var ut=qW(L,/^[\r\n\t ]+/);ue=ut&&ut[0]}_t==="application/xhtml+xml"&&Ve===xe&&(L='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+L+"</body></html>");var jn=I?I.createHTML(L):L;if(Ve===xe)try{re=new f().parseFromString(jn,_t)}catch{}if(!re||!re.documentElement){re=U.createDocument(Ve,"template",null);try{re.documentElement.innerHTML=St?x:jn}catch{}}var Cn=re.body||re.documentElement;return L&&ue&&Cn.insertBefore(r.createTextNode(ue),Cn.childNodes[0]||null),Ve===xe?K.call(re,j?"html":"body")[0]:j?re.documentElement:Cn},Fb=function(L){return Z.call(L.ownerDocument||L,L,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},dN=function(L){return L instanceof h&&(typeof L.nodeName!="string"||typeof L.textContent!="string"||typeof L.removeChild!="function"||!(L.attributes instanceof c)||typeof L.removeAttribute!="function"||typeof L.setAttribute!="function"||typeof L.namespaceURI!="string"||typeof L.insertBefore!="function"||typeof L.hasChildNodes!="function")},Ul=function(L){return zo(s)==="object"?L instanceof s:L&&zo(L)==="object"&&typeof L.nodeType=="number"&&typeof L.nodeName=="string"},$i=function(L,re,ue){ie[L]&&XW(ie[L],function(ut){ut.call(e,re,ue,dn)})},Wb=function(L){var re;if($i("beforeSanitizeElements",L,null),dN(L)||In(/[\u0080-\uFFFF]/,L.nodeName))return ki(L),!0;var ue=Vt(L.nodeName);if($i("uponSanitizeElement",L,{tagName:ue,allowedTags:E}),L.hasChildNodes()&&!Ul(L.firstElementChild)&&(!Ul(L.content)||!Ul(L.content.firstElementChild))&&In(/<[/\w]/g,L.innerHTML)&&In(/<[/\w]/g,L.textContent)||ue==="select"&&In(/<template/i,L.innerHTML))return ki(L),!0;if(!E[ue]||q[ue]){if(!q[ue]&&Bb(ue)&&(B.tagNameCheck instanceof RegExp&&In(B.tagNameCheck,ue)||B.tagNameCheck instanceof Function&&B.tagNameCheck(ue)))return!1;if(W&&!D[ue]){var ut=_(L)||L.parentNode,jn=y(L)||L.childNodes;if(jn&&ut)for(var Cn=jn.length,fn=Cn-1;fn>=0;--fn)ut.insertBefore(C(jn[fn],!0),b(L))}return ki(L),!0}return L instanceof a&&!hN(L)||(ue==="noscript"||ue==="noembed"||ue==="noframes")&&In(/<\/no(script|embed|frames)/i,L.innerHTML)?(ki(L),!0):(Pe&&L.nodeType===3&&(re=L.textContent,re=Dr(re,he," "),re=Dr(re,Te," "),re=Dr(re,ze," "),L.textContent!==re&&(Gl(e.removed,{element:L.cloneNode()}),L.textContent=re)),$i("afterSanitizeElements",L,null),!1)},Vb=function(L,re,ue){if(v&&(re==="id"||re==="name")&&(ue in r||ue in ms))return!1;if(!(fe&&!J[re]&&In(Ne,re))){if(!(X&&In(R,re))){if(!P[re]||J[re]){if(!(Bb(L)&&(B.tagNameCheck instanceof RegExp&&In(B.tagNameCheck,L)||B.tagNameCheck instanceof Function&&B.tagNameCheck(L))&&(B.attributeNameCheck instanceof RegExp&&In(B.attributeNameCheck,re)||B.attributeNameCheck instanceof Function&&B.attributeNameCheck(re))||re==="is"&&B.allowCustomizedBuiltInElements&&(B.tagNameCheck instanceof RegExp&&In(B.tagNameCheck,ue)||B.tagNameCheck instanceof Function&&B.tagNameCheck(ue))))return!1}else if(!G[re]){if(!In(p,Dr(ue,m,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&L!=="script"&&ZW(ue,"data:")===0&&V[L])){if(!(Oe&&!In(d,Dr(ue,m,"")))){if(ue)return!1}}}}}}return!0},Bb=function(L){return L.indexOf("-")>0},Ub=function(L){var re,ue,ut,jn;$i("beforeSanitizeAttributes",L,null);var Cn=L.attributes;if(Cn){var fn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P};for(jn=Cn.length;jn--;){re=Cn[jn];var Xc=re,sn=Xc.name,Ug=Xc.namespaceURI;if(ue=sn==="value"?re.value:QW(re.value),ut=Vt(sn),fn.attrName=ut,fn.attrValue=ue,fn.keepAttr=!0,fn.forceKeepAttr=void 0,$i("uponSanitizeAttribute",L,fn),ue=fn.attrValue,!fn.forceKeepAttr&&(Bg(sn,L),!!fn.keepAttr)){if(!Ee&&In(/\/>/i,ue)){Bg(sn,L);continue}Pe&&(ue=Dr(ue,he," "),ue=Dr(ue,Te," "),ue=Dr(ue,ze," "));var Gb=Vt(L.nodeName);if(Vb(Gb,ut,ue)){if(S&&(ut==="id"||ut==="name")&&(Bg(sn,L),ue=A+ue),I&&zo(g)==="object"&&typeof g.getAttributeType=="function"&&!Ug)switch(g.getAttributeType(Gb,ut)){case"TrustedHTML":{ue=I.createHTML(ue);break}case"TrustedScriptURL":{ue=I.createScriptURL(ue);break}}try{Ug?L.setAttributeNS(Ug,sn,ue):L.setAttribute(sn,ue),NR(e.removed)}catch{}}}}$i("afterSanitizeAttributes",L,null)}},fN=function _e(L){var re,ue=Fb(L);for($i("beforeSanitizeShadowDOM",L,null);re=ue.nextNode();)$i("uponSanitizeShadowNode",re,null),!Wb(re)&&(re.content instanceof i&&_e(re.content),Ub(re));$i("afterSanitizeShadowDOM",L,null)};return e.sanitize=function(_e){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re,ue,ut,jn,Cn;if(St=!_e,St&&(_e="<!-->"),typeof _e!="string"&&!Ul(_e))if(typeof _e.toString=="function"){if(_e=_e.toString(),typeof _e!="string")throw hm("dirty is not a string, aborting")}else throw hm("toString is not a function");if(!e.isSupported){if(zo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof _e=="string")return t.toStaticHTML(_e);if(Ul(_e))return t.toStaticHTML(_e.outerHTML)}return _e}if(Ke||tn(L),e.removed=[],typeof _e=="string"&&(H=!1),H){if(_e.nodeName){var fn=Vt(_e.nodeName);if(!E[fn]||q[fn])throw hm("root node is forbidden and cannot be sanitized in-place")}}else if(_e instanceof s)re=$b("<!---->"),ue=re.ownerDocument.importNode(_e,!0),ue.nodeType===1&&ue.nodeName==="BODY"||ue.nodeName==="HTML"?re=ue:re.appendChild(ue);else{if(!ye&&!Pe&&!j&&_e.indexOf("<")===-1)return I&&Re?I.createHTML(_e):_e;if(re=$b(_e),!re)return ye?null:Re?x:""}re&&$e&&ki(re.firstChild);for(var Xc=Fb(H?_e:re);ut=Xc.nextNode();)ut.nodeType===3&&ut===jn||Wb(ut)||(ut.content instanceof i&&fN(ut.content),Ub(ut),jn=ut);if(jn=null,H)return _e;if(ye){if(He)for(Cn=z.call(re.ownerDocument);re.firstChild;)Cn.appendChild(re.firstChild);else Cn=re;return(P.shadowroot||P.shadowrootmod)&&(Cn=te.call(n,Cn,!0)),Cn}var sn=j?re.outerHTML:re.innerHTML;return j&&E["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&In(cV,re.ownerDocument.doctype.name)&&(sn="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+sn),Pe&&(sn=Dr(sn,he," "),sn=Dr(sn,Te," "),sn=Dr(sn,ze," ")),I&&Re?I.createHTML(sn):sn},e.setConfig=function(_e){tn(_e),Ke=!0},e.clearConfig=function(){dn=null,Ke=!1},e.isValidAttribute=function(_e,L,re){dn||tn({});var ue=Vt(_e),ut=Vt(L);return Vb(ue,ut,re)},e.addHook=function(_e,L){typeof L=="function"&&(ie[_e]=ie[_e]||[],Gl(ie[_e],L))},e.removeHook=function(_e){if(ie[_e])return NR(ie[_e])},e.removeHooks=function(_e){ie[_e]&&(ie[_e]=[])},e.removeAllHooks=function(){ie={}},e}var fV=DP();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var NP;function Q(){return NP.apply(null,arguments)}function gV(t){NP=t}function ti(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ta(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function at(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function lv(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(at(t,e))return!1;return!0}function Jn(t){return t===void 0}function Co(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Ac(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function LP(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function qo(t,e){for(var n in e)at(e,n)&&(t[n]=e[n]);return at(e,"toString")&&(t.toString=e.toString),at(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Di(t,e,n,r){return sx(t,e,n,r,!0).utc()}function mV(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ye(t){return t._pf==null&&(t._pf=mV()),t._pf}var Ww;Array.prototype.some?Ww=Array.prototype.some:Ww=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function uv(t){if(t._isValid==null){var e=Ye(t),n=Ww.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function jf(t){var e=Di(NaN);return t!=null?qo(Ye(e),t):Ye(e).userInvalidated=!0,e}var WR=Q.momentProperties=[],pm=!1;function cv(t,e){var n,r,i,o=WR.length;if(Jn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Jn(e._i)||(t._i=e._i),Jn(e._f)||(t._f=e._f),Jn(e._l)||(t._l=e._l),Jn(e._strict)||(t._strict=e._strict),Jn(e._tzm)||(t._tzm=e._tzm),Jn(e._isUTC)||(t._isUTC=e._isUTC),Jn(e._offset)||(t._offset=e._offset),Jn(e._pf)||(t._pf=Ye(e)),Jn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=WR[n],i=e[r],Jn(i)||(t[r]=i);return t}function Oc(t){cv(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),pm===!1&&(pm=!0,Q.updateOffset(this),pm=!1)}function ni(t){return t instanceof Oc||t!=null&&t._isAMomentObject!=null}function kP(t){Q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function xr(t,e){var n=!0;return qo(function(){if(Q.deprecationHandler!=null&&Q.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])at(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}kP(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var VR={};function $P(t,e){Q.deprecationHandler!=null&&Q.deprecationHandler(t,e),VR[t]||(kP(e),VR[t]=!0)}Q.suppressDeprecationWarnings=!1;Q.deprecationHandler=null;function Ni(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function pV(t){var e,n;for(n in t)at(t,n)&&(e=t[n],Ni(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Vw(t,e){var n=qo({},t),r;for(r in e)at(e,r)&&(ta(t[r])&&ta(e[r])?(n[r]={},qo(n[r],t[r]),qo(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)at(t,r)&&!at(e,r)&&ta(t[r])&&(n[r]=qo({},n[r]));return n}function hv(t){t!=null&&this.set(t)}var Bw;Object.keys?Bw=Object.keys:Bw=function(t){var e,n=[];for(e in t)at(t,e)&&n.push(e);return n};var wV={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function CV(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Ni(r)?r.call(e,n):r}function xi(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var dv=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,nh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,wm={},vl={};function Ae(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(vl[t]=i),e&&(vl[e[0]]=function(){return xi(i.apply(this,arguments),e[1],e[2])}),n&&(vl[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function vV(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function SV(t){var e=t.match(dv),n,r;for(n=0,r=e.length;n<r;n++)vl[e[n]]?e[n]=vl[e[n]]:e[n]=vV(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Ni(e[s])?e[s].call(i,t):e[s];return o}}function yd(t,e){return t.isValid()?(e=FP(e,t.localeData()),wm[e]=wm[e]||SV(e),wm[e](t)):t.localeData().invalidDate()}function FP(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(nh.lastIndex=0;n>=0&&nh.test(t);)t=t.replace(nh,r),nh.lastIndex=0,n-=1;return t}var yV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function bV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(dv).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var RV="Invalid date";function EV(){return this._invalidDate}var TV="%d",_V=/\d{1,2}/;function MV(t){return this._ordinal.replace("%d",t)}var AV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function OV(t,e,n,r){var i=this._relativeTime[n];return Ni(i)?i(t,e,n,r):i.replace(/%d/i,t)}function PV(t,e){var n=this._relativeTime[t>0?"future":"past"];return Ni(n)?n(e):n.replace(/%s/i,e)}var $u={};function On(t,e){var n=t.toLowerCase();$u[n]=$u[n+"s"]=$u[e]=t}function Ir(t){return typeof t=="string"?$u[t]||$u[t.toLowerCase()]:void 0}function fv(t){var e={},n,r;for(r in t)at(t,r)&&(n=Ir(r),n&&(e[n]=t[r]));return e}var WP={};function Pn(t,e){WP[t]=e}function xV(t){var e=[],n;for(n in t)at(t,n)&&e.push({unit:n,priority:WP[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function Kf(t){return t%4===0&&t%100!==0||t%400===0}function Mr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function tt(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Mr(e)),n}function Il(t,e){return function(n){return n!=null?(VP(this,t,n),Q.updateOffset(this,e),this):Xd(this,t)}}function Xd(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function VP(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&Kf(t.year())&&t.month()===1&&t.date()===29?(n=tt(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),eg(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function IV(t){return t=Ir(t),Ni(this[t])?this[t]():this}function HV(t,e){if(typeof t=="object"){t=fv(t);var n=xV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Ir(t),Ni(this[t]))return this[t](e);return this}var BP=/\d/,wr=/\d\d/,UP=/\d{3}/,gv=/\d{4}/,Xf=/[+-]?\d{6}/,Tt=/\d\d?/,GP=/\d\d\d\d?/,zP=/\d\d\d\d\d\d?/,qf=/\d{1,3}/,mv=/\d{1,4}/,Zf=/[+-]?\d{1,6}/,Hl=/\d+/,Qf=/[+-]?\d+/,DV=/Z|[+-]\d\d:?\d\d/gi,Jf=/Z|[+-]\d\d(?::?\d\d)?/gi,NV=/[+-]?\d+(\.\d{1,3})?/,Pc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,qd;qd={};function pe(t,e,n){qd[t]=Ni(e)?e:function(r,i){return r&&n?n:e}}function LV(t,e){return at(qd,t)?qd[t](e._strict,e._locale):new RegExp(kV(t))}function kV(t){return fr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function fr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Uw={};function gt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Co(e)&&(r=function(o,s){s[e]=tt(o)}),i=t.length,n=0;n<i;n++)Uw[t[n]]=r}function xc(t,e){gt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function $V(t,e,n){e!=null&&at(Uw,t)&&Uw[t](e,n._a,n,t)}var Tn=0,ao=1,Ti=2,rn=3,qr=4,lo=5,Xs=6,FV=7,WV=8;function VV(t,e){return(t%e+e)%e}var Yt;Array.prototype.indexOf?Yt=Array.prototype.indexOf:Yt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function eg(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=VV(e,12);return t+=(e-n)/12,n===1?Kf(t)?29:28:31-n%7%2}Ae("M",["MM",2],"Mo",function(){return this.month()+1});Ae("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ae("MMMM",0,0,function(t){return this.localeData().months(this,t)});On("month","M");Pn("month",8);pe("M",Tt);pe("MM",Tt,wr);pe("MMM",function(t,e){return e.monthsShortRegex(t)});pe("MMMM",function(t,e){return e.monthsRegex(t)});gt(["M","MM"],function(t,e){e[ao]=tt(t)-1});gt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ao]=i:Ye(n).invalidMonth=t});var BV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),YP="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),jP=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,UV=Pc,GV=Pc;function zV(t,e){return t?ti(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||jP).test(e)?"format":"standalone"][t.month()]:ti(this._months)?this._months:this._months.standalone}function YV(t,e){return t?ti(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[jP.test(e)?"format":"standalone"][t.month()]:ti(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function jV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Di([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Yt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:(i=Yt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Yt.call(this._longMonthsParse,s),i!==-1?i:(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:null))}function KV(t,e,n){var r,i,o;if(this._monthsParseExact)return jV.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Di([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function KP(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=tt(e);else if(e=t.localeData().monthsParse(e),!Co(e))return t}return n=Math.min(t.date(),eg(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function XP(t){return t!=null?(KP(this,t),Q.updateOffset(this,!0),this):Xd(this,"Month")}function XV(){return eg(this.year(),this.month())}function qV(t){return this._monthsParseExact?(at(this,"_monthsRegex")||qP.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=UV),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function ZV(t){return this._monthsParseExact?(at(this,"_monthsRegex")||qP.call(this),t?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=GV),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function qP(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=Di([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=fr(e[i]),n[i]=fr(n[i]);for(i=0;i<24;i++)r[i]=fr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Ae("Y",0,0,function(){var t=this.year();return t<=9999?xi(t,4):"+"+t});Ae(0,["YY",2],0,function(){return this.year()%100});Ae(0,["YYYY",4],0,"year");Ae(0,["YYYYY",5],0,"year");Ae(0,["YYYYYY",6,!0],0,"year");On("year","y");Pn("year",1);pe("Y",Qf);pe("YY",Tt,wr);pe("YYYY",mv,gv);pe("YYYYY",Zf,Xf);pe("YYYYYY",Zf,Xf);gt(["YYYYY","YYYYYY"],Tn);gt("YYYY",function(t,e){e[Tn]=t.length===2?Q.parseTwoDigitYear(t):tt(t)});gt("YY",function(t,e){e[Tn]=Q.parseTwoDigitYear(t)});gt("Y",function(t,e){e[Tn]=parseInt(t,10)});function Fu(t){return Kf(t)?366:365}Q.parseTwoDigitYear=function(t){return tt(t)+(tt(t)>68?1900:2e3)};var ZP=Il("FullYear",!0);function QV(){return Kf(this.year())}function JV(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function ac(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Zd(t,e,n){var r=7+e-n,i=(7+ac(t,0,r).getUTCDay()-e)%7;return-i+r-1}function QP(t,e,n,r,i){var o=(7+n-r)%7,s=Zd(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Fu(l)+a):a>Fu(t)?(l=t+1,u=a-Fu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function lc(t,e,n){var r=Zd(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+wo(s,e,n)):i>wo(t.year(),e,n)?(o=i-wo(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function wo(t,e,n){var r=Zd(t,e,n),i=Zd(t+1,e,n);return(Fu(t)-r+i)/7}Ae("w",["ww",2],"wo","week");Ae("W",["WW",2],"Wo","isoWeek");On("week","w");On("isoWeek","W");Pn("week",5);Pn("isoWeek",5);pe("w",Tt);pe("ww",Tt,wr);pe("W",Tt);pe("WW",Tt,wr);xc(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=tt(t)});function eB(t){return lc(t,this._week.dow,this._week.doy).week}var tB={dow:0,doy:6};function nB(){return this._week.dow}function rB(){return this._week.doy}function iB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function oB(t){var e=lc(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ae("d",0,"do","day");Ae("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ae("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ae("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ae("e",0,0,"weekday");Ae("E",0,0,"isoWeekday");On("day","d");On("weekday","e");On("isoWeekday","E");Pn("day",11);Pn("weekday",11);Pn("isoWeekday",11);pe("d",Tt);pe("e",Tt);pe("E",Tt);pe("dd",function(t,e){return e.weekdaysMinRegex(t)});pe("ddd",function(t,e){return e.weekdaysShortRegex(t)});pe("dddd",function(t,e){return e.weekdaysRegex(t)});xc(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ye(n).invalidWeekday=t});xc(["d","e","E"],function(t,e,n,r){e[r]=tt(t)});function sB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function aB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function pv(t,e){return t.slice(e,7).concat(t.slice(0,e))}var lB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),JP="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),uB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),cB=Pc,hB=Pc,dB=Pc;function fB(t,e){var n=ti(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?pv(n,this._week.dow):t?n[t.day()]:n}function gB(t){return t===!0?pv(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function mB(t){return t===!0?pv(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function pB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Di([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Yt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Yt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Yt.call(this._weekdaysParse,s),i!==-1||(i=Yt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Yt.call(this._shortWeekdaysParse,s),i!==-1||(i=Yt.call(this._weekdaysParse,s),i!==-1)?i:(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Yt.call(this._minWeekdaysParse,s),i!==-1||(i=Yt.call(this._weekdaysParse,s),i!==-1)?i:(i=Yt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function wB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return pB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Di([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function CB(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=sB(t,this.localeData()),this.add(t-e,"d")):e}function vB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function SB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=aB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function yB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||wv.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=cB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function bB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||wv.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=hB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function RB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||wv.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=dB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function wv(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Di([2e3,1]).day(o),a=fr(this.weekdaysMin(s,"")),l=fr(this.weekdaysShort(s,"")),u=fr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Cv(){return this.hours()%12||12}function EB(){return this.hours()||24}Ae("H",["HH",2],0,"hour");Ae("h",["hh",2],0,Cv);Ae("k",["kk",2],0,EB);Ae("hmm",0,0,function(){return""+Cv.apply(this)+xi(this.minutes(),2)});Ae("hmmss",0,0,function(){return""+Cv.apply(this)+xi(this.minutes(),2)+xi(this.seconds(),2)});Ae("Hmm",0,0,function(){return""+this.hours()+xi(this.minutes(),2)});Ae("Hmmss",0,0,function(){return""+this.hours()+xi(this.minutes(),2)+xi(this.seconds(),2)});function ex(t,e){Ae(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}ex("a",!0);ex("A",!1);On("hour","h");Pn("hour",13);function tx(t,e){return e._meridiemParse}pe("a",tx);pe("A",tx);pe("H",Tt);pe("h",Tt);pe("k",Tt);pe("HH",Tt,wr);pe("hh",Tt,wr);pe("kk",Tt,wr);pe("hmm",GP);pe("hmmss",zP);pe("Hmm",GP);pe("Hmmss",zP);gt(["H","HH"],rn);gt(["k","kk"],function(t,e,n){var r=tt(t);e[rn]=r===24?0:r});gt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});gt(["h","hh"],function(t,e,n){e[rn]=tt(t),Ye(n).bigHour=!0});gt("hmm",function(t,e,n){var r=t.length-2;e[rn]=tt(t.substr(0,r)),e[qr]=tt(t.substr(r)),Ye(n).bigHour=!0});gt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[rn]=tt(t.substr(0,r)),e[qr]=tt(t.substr(r,2)),e[lo]=tt(t.substr(i)),Ye(n).bigHour=!0});gt("Hmm",function(t,e,n){var r=t.length-2;e[rn]=tt(t.substr(0,r)),e[qr]=tt(t.substr(r))});gt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[rn]=tt(t.substr(0,r)),e[qr]=tt(t.substr(r,2)),e[lo]=tt(t.substr(i))});function TB(t){return(t+"").toLowerCase().charAt(0)==="p"}var _B=/[ap]\.?m?\.?/i,MB=Il("Hours",!0);function AB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var nx={calendar:wV,longDateFormat:yV,invalidDate:RV,ordinal:TV,dayOfMonthOrdinalParse:_V,relativeTime:AV,months:BV,monthsShort:YP,week:tB,weekdays:lB,weekdaysMin:uB,weekdaysShort:JP,meridiemParse:_B},Ot={},zl={},uc;function OB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function BR(t){return t&&t.toLowerCase().replace("_","-")}function PB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=BR(t[e]).split("-"),n=o.length,r=BR(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=tg(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&OB(o,r)>=n-1)break;n--}e++}return uc}function xB(t){return t.match("^[^/\\\\]*$")!=null}function tg(t){var e=null,n;if(Ot[t]===void 0&&typeof Ud<"u"&&Ud&&Ud.exports&&xB(t))try{e=uc._abbr,n=require,n("./locale/"+t),ts(e)}catch{Ot[t]=null}return Ot[t]}function ts(t,e){var n;return t&&(Jn(e)?n=Ro(t):n=vv(t,e),n?uc=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),uc._abbr}function vv(t,e){if(e!==null){var n,r=nx;if(e.abbr=t,Ot[t]!=null)$P("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ot[t]._config;else if(e.parentLocale!=null)if(Ot[e.parentLocale]!=null)r=Ot[e.parentLocale]._config;else if(n=tg(e.parentLocale),n!=null)r=n._config;else return zl[e.parentLocale]||(zl[e.parentLocale]=[]),zl[e.parentLocale].push({name:t,config:e}),null;return Ot[t]=new hv(Vw(r,e)),zl[t]&&zl[t].forEach(function(i){vv(i.name,i.config)}),ts(t),Ot[t]}else return delete Ot[t],null}function IB(t,e){if(e!=null){var n,r,i=nx;Ot[t]!=null&&Ot[t].parentLocale!=null?Ot[t].set(Vw(Ot[t]._config,e)):(r=tg(t),r!=null&&(i=r._config),e=Vw(i,e),r==null&&(e.abbr=t),n=new hv(e),n.parentLocale=Ot[t],Ot[t]=n),ts(t)}else Ot[t]!=null&&(Ot[t].parentLocale!=null?(Ot[t]=Ot[t].parentLocale,t===ts()&&ts(t)):Ot[t]!=null&&delete Ot[t]);return Ot[t]}function Ro(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return uc;if(!ti(t)){if(e=tg(t),e)return e;t=[t]}return PB(t)}function HB(){return Bw(Ot)}function Sv(t){var e,n=t._a;return n&&Ye(t).overflow===-2&&(e=n[ao]<0||n[ao]>11?ao:n[Ti]<1||n[Ti]>eg(n[Tn],n[ao])?Ti:n[rn]<0||n[rn]>24||n[rn]===24&&(n[qr]!==0||n[lo]!==0||n[Xs]!==0)?rn:n[qr]<0||n[qr]>59?qr:n[lo]<0||n[lo]>59?lo:n[Xs]<0||n[Xs]>999?Xs:-1,Ye(t)._overflowDayOfYear&&(e<Tn||e>Ti)&&(e=Ti),Ye(t)._overflowWeeks&&e===-1&&(e=FV),Ye(t)._overflowWeekday&&e===-1&&(e=WV),Ye(t).overflow=e),t}var DB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,NB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,LB=/Z|[+-]\d\d(?::?\d\d)?/,rh=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Cm=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],kB=/^\/?Date\((-?\d+)/i,$B=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,FB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function rx(t){var e,n,r=t._i,i=DB.exec(r)||NB.exec(r),o,s,a,l,u=rh.length,c=Cm.length;if(i){for(Ye(t).iso=!0,e=0,n=u;e<n;e++)if(rh[e][1].exec(i[1])){s=rh[e][0],o=rh[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Cm[e][1].exec(i[3])){a=(i[2]||" ")+Cm[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(LB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),bv(t)}else t._isValid=!1}function WB(t,e,n,r,i,o){var s=[VB(t),YP.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function VB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function BB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function UB(t,e,n){if(t){var r=JP.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ye(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function GB(t,e,n){if(t)return FB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function ix(t){var e=$B.exec(BB(t._i)),n;if(e){if(n=WB(e[4],e[3],e[2],e[5],e[6],e[7]),!UB(e[1],n,t))return;t._a=n,t._tzm=GB(e[8],e[9],e[10]),t._d=ac.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ye(t).rfc2822=!0}else t._isValid=!1}function zB(t){var e=kB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(rx(t),t._isValid===!1)delete t._isValid;else return;if(ix(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Q.createFromInputFallback(t)}Q.createFromInputFallback=xr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function ul(t,e,n){return t??e??n}function YB(t){var e=new Date(Q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function yv(t){var e,n,r=[],i,o,s;if(!t._d){for(i=YB(t),t._w&&t._a[Ti]==null&&t._a[ao]==null&&jB(t),t._dayOfYear!=null&&(s=ul(t._a[Tn],i[Tn]),(t._dayOfYear>Fu(s)||t._dayOfYear===0)&&(Ye(t)._overflowDayOfYear=!0),n=ac(s,0,t._dayOfYear),t._a[ao]=n.getUTCMonth(),t._a[Ti]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[rn]===24&&t._a[qr]===0&&t._a[lo]===0&&t._a[Xs]===0&&(t._nextDay=!0,t._a[rn]=0),t._d=(t._useUTC?ac:JV).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[rn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ye(t).weekdayMismatch=!0)}}function jB(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=ul(e.GG,t._a[Tn],lc(Et(),1,4).year),r=ul(e.W,1),i=ul(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=lc(Et(),o,s),n=ul(e.gg,t._a[Tn],u.year),r=ul(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>wo(n,o,s)?Ye(t)._overflowWeeks=!0:l!=null?Ye(t)._overflowWeekday=!0:(a=QP(n,r,i,o,s),t._a[Tn]=a.year,t._dayOfYear=a.dayOfYear)}Q.ISO_8601=function(){};Q.RFC_2822=function(){};function bv(t){if(t._f===Q.ISO_8601){rx(t);return}if(t._f===Q.RFC_2822){ix(t);return}t._a=[],Ye(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=FP(t._f,t._locale).match(dv)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(LV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ye(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),vl[o]?(r?Ye(t).empty=!1:Ye(t).unusedTokens.push(o),$V(o,r,t)):t._strict&&!r&&Ye(t).unusedTokens.push(o);Ye(t).charsLeftOver=a-l,e.length>0&&Ye(t).unusedInput.push(e),t._a[rn]<=12&&Ye(t).bigHour===!0&&t._a[rn]>0&&(Ye(t).bigHour=void 0),Ye(t).parsedDateParts=t._a.slice(0),Ye(t).meridiem=t._meridiem,t._a[rn]=KB(t._locale,t._a[rn],t._meridiem),u=Ye(t).era,u!==null&&(t._a[Tn]=t._locale.erasConvertYear(u,t._a[Tn])),yv(t),Sv(t)}function KB(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function XB(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ye(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=cv({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],bv(e),uv(e)&&(s=!0),o+=Ye(e).charsLeftOver,o+=Ye(e).unusedTokens.length*10,Ye(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));qo(t,n||e)}function qB(t){if(!t._d){var e=fv(t._i),n=e.day===void 0?e.date:e.day;t._a=LP([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),yv(t)}}function ZB(t){var e=new Oc(Sv(ox(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function ox(t){var e=t._i,n=t._f;return t._locale=t._locale||Ro(t._l),e===null||n===void 0&&e===""?jf({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ni(e)?new Oc(Sv(e)):(Ac(e)?t._d=e:ti(n)?XB(t):n?bv(t):QB(t),uv(t)||(t._d=null),t))}function QB(t){var e=t._i;Jn(e)?t._d=new Date(Q.now()):Ac(e)?t._d=new Date(e.valueOf()):typeof e=="string"?zB(t):ti(e)?(t._a=LP(e.slice(0),function(n){return parseInt(n,10)}),yv(t)):ta(e)?qB(t):Co(e)?t._d=new Date(e):Q.createFromInputFallback(t)}function sx(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ta(t)&&lv(t)||ti(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,ZB(o)}function Et(t,e,n,r){return sx(t,e,n,r,!1)}var JB=xr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:jf()}),eU=xr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:jf()});function ax(t,e){var n,r;if(e.length===1&&ti(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function tU(){var t=[].slice.call(arguments,0);return ax("isBefore",t)}function nU(){var t=[].slice.call(arguments,0);return ax("isAfter",t)}var rU=function(){return Date.now?Date.now():+new Date},Yl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function iU(t){var e,n=!1,r,i=Yl.length;for(e in t)if(at(t,e)&&!(Yt.call(Yl,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Yl[r]]){if(n)return!1;parseFloat(t[Yl[r]])!==tt(t[Yl[r]])&&(n=!0)}return!0}function oU(){return this._isValid}function sU(){return ii(NaN)}function ng(t){var e=fv(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=iU(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=Ro(),this._bubble()}function bd(t){return t instanceof ng}function Gw(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function aU(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&tt(t[s])!==tt(e[s]))&&o++;return o+i}function lx(t,e){Ae(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+xi(~~(n/60),2)+e+xi(~~n%60,2)})}lx("Z",":");lx("ZZ","");pe("Z",Jf);pe("ZZ",Jf);gt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Rv(Jf,t)});var lU=/([\+\-]|\d\d)/gi;function Rv(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(lU)||["-",0,0],o=+(i[1]*60)+tt(i[2]),o===0?0:i[0]==="+"?o:-o)}function Ev(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ni(t)||Ac(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Q.updateOffset(n,!1),n):Et(t).local()}function zw(t){return-Math.round(t._d.getTimezoneOffset())}Q.updateOffset=function(){};function uU(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Rv(Jf,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=zw(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?hx(this,ii(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:zw(this)}function cU(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function hU(t){return this.utcOffset(0,t)}function dU(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(zw(this),"m")),this}function fU(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Rv(DV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function gU(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function mU(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function pU(){if(!Jn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return cv(t,this),t=ox(t),t._a?(e=t._isUTC?Di(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&aU(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function wU(){return this.isValid()?!this._isUTC:!1}function CU(){return this.isValid()?this._isUTC:!1}function ux(){return this.isValid()?this._isUTC&&this._offset===0:!1}var vU=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,SU=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ii(t,e){var n=t,r=null,i,o,s;return bd(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Co(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=vU.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:tt(r[Ti])*i,h:tt(r[rn])*i,m:tt(r[qr])*i,s:tt(r[lo])*i,ms:tt(Gw(r[Xs]*1e3))*i}):(r=SU.exec(t))?(i=r[1]==="-"?-1:1,n={y:Cs(r[2],i),M:Cs(r[3],i),w:Cs(r[4],i),d:Cs(r[5],i),h:Cs(r[6],i),m:Cs(r[7],i),s:Cs(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=yU(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new ng(n),bd(t)&&at(t,"_locale")&&(o._locale=t._locale),bd(t)&&at(t,"_isValid")&&(o._isValid=t._isValid),o}ii.fn=ng.prototype;ii.invalid=sU;function Cs(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function UR(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function yU(t,e){var n;return t.isValid()&&e.isValid()?(e=Ev(e,t),t.isBefore(e)?n=UR(t,e):(n=UR(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function cx(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&($P(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ii(n,r),hx(this,i,t),this}}function hx(t,e,n,r){var i=e._milliseconds,o=Gw(e._days),s=Gw(e._months);t.isValid()&&(r=r??!0,s&&KP(t,Xd(t,"Month")+s*n),o&&VP(t,"Date",Xd(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Q.updateOffset(t,o||s))}var bU=cx(1,"add"),RU=cx(-1,"subtract");function dx(t){return typeof t=="string"||t instanceof String}function EU(t){return ni(t)||Ac(t)||dx(t)||Co(t)||_U(t)||TU(t)||t===null||t===void 0}function TU(t){var e=ta(t)&&!lv(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||at(t,o);return e&&n}function _U(t){var e=ti(t),n=!1;return e&&(n=t.filter(function(r){return!Co(r)&&dx(t)}).length===0),e&&n}function MU(t){var e=ta(t)&&!lv(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||at(t,o);return e&&n}function AU(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function OU(t,e){arguments.length===1&&(arguments[0]?EU(arguments[0])?(t=arguments[0],e=void 0):MU(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=Ev(n,this).startOf("day"),i=Q.calendarFormat(this,r)||"sameElse",o=e&&(Ni(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function PU(){return new Oc(this)}function xU(t,e){var n=ni(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function IU(t,e){var n=ni(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function HU(t,e,n,r){var i=ni(t)?t:Et(t),o=ni(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function DU(t,e){var n=ni(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function NU(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function LU(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function kU(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=Ev(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Ir(e),e){case"year":o=Rd(this,r)/12;break;case"month":o=Rd(this,r);break;case"quarter":o=Rd(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Mr(o)}function Rd(t,e){if(t.date()<e.date())return-Rd(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function $U(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function FU(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?yd(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ni(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",yd(n,"Z")):yd(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function WU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function VU(t){t||(t=this.isUtc()?Q.defaultFormatUtc:Q.defaultFormat);var e=yd(this,t);return this.localeData().postformat(e)}function BU(t,e){return this.isValid()&&(ni(t)&&t.isValid()||Et(t).isValid())?ii({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function UU(t){return this.from(Et(),t)}function GU(t,e){return this.isValid()&&(ni(t)&&t.isValid()||Et(t).isValid())?ii({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function zU(t){return this.to(Et(),t)}function fx(t){var e;return t===void 0?this._locale._abbr:(e=Ro(t),e!=null&&(this._locale=e),this)}var gx=xr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function mx(){return this._locale}var Qd=1e3,Sl=60*Qd,Jd=60*Sl,px=(365*400+97)*24*Jd;function yl(t,e){return(t%e+e)%e}function wx(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-px:new Date(t,e,n).valueOf()}function Cx(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-px:Date.UTC(t,e,n)}function YU(t){var e,n;if(t=Ir(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Cx:wx,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=yl(e+(this._isUTC?0:this.utcOffset()*Sl),Jd);break;case"minute":e=this._d.valueOf(),e-=yl(e,Sl);break;case"second":e=this._d.valueOf(),e-=yl(e,Qd);break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function jU(t){var e,n;if(t=Ir(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Cx:wx,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Jd-yl(e+(this._isUTC?0:this.utcOffset()*Sl),Jd)-1;break;case"minute":e=this._d.valueOf(),e+=Sl-yl(e,Sl)-1;break;case"second":e=this._d.valueOf(),e+=Qd-yl(e,Qd)-1;break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function KU(){return this._d.valueOf()-(this._offset||0)*6e4}function XU(){return Math.floor(this.valueOf()/1e3)}function qU(){return new Date(this.valueOf())}function ZU(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function QU(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function JU(){return this.isValid()?this.toISOString():null}function e2(){return uv(this)}function t2(){return qo({},Ye(this))}function n2(){return Ye(this).overflow}function r2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ae("N",0,0,"eraAbbr");Ae("NN",0,0,"eraAbbr");Ae("NNN",0,0,"eraAbbr");Ae("NNNN",0,0,"eraName");Ae("NNNNN",0,0,"eraNarrow");Ae("y",["y",1],"yo","eraYear");Ae("y",["yy",2],0,"eraYear");Ae("y",["yyy",3],0,"eraYear");Ae("y",["yyyy",4],0,"eraYear");pe("N",Tv);pe("NN",Tv);pe("NNN",Tv);pe("NNNN",g2);pe("NNNNN",m2);gt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ye(n).era=i:Ye(n).invalidEra=t});pe("y",Hl);pe("yy",Hl);pe("yyy",Hl);pe("yyyy",Hl);pe("yo",p2);gt(["y","yy","yyy","yyyy"],Tn);gt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Tn]=n._locale.eraYearOrdinalParse(t,i):e[Tn]=parseInt(t,10)});function i2(t,e){var n,r,i,o=this._eras||Ro("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Q(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Q(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function o2(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function s2(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Q(t.since).year():Q(t.since).year()+(e-t.offset)*n}function a2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function l2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function u2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function c2(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Q(i[t].since).year())*n+i[t].offset;return this.year()}function h2(t){return at(this,"_erasNameRegex")||_v.call(this),t?this._erasNameRegex:this._erasRegex}function d2(t){return at(this,"_erasAbbrRegex")||_v.call(this),t?this._erasAbbrRegex:this._erasRegex}function f2(t){return at(this,"_erasNarrowRegex")||_v.call(this),t?this._erasNarrowRegex:this._erasRegex}function Tv(t,e){return e.erasAbbrRegex(t)}function g2(t,e){return e.erasNameRegex(t)}function m2(t,e){return e.erasNarrowRegex(t)}function p2(t,e){return e._eraYearOrdinalRegex||Hl}function _v(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(fr(s[i].name)),t.push(fr(s[i].abbr)),n.push(fr(s[i].narrow)),r.push(fr(s[i].name)),r.push(fr(s[i].abbr)),r.push(fr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ae(0,["gg",2],0,function(){return this.weekYear()%100});Ae(0,["GG",2],0,function(){return this.isoWeekYear()%100});function rg(t,e){Ae(0,[t,t.length],0,e)}rg("gggg","weekYear");rg("ggggg","weekYear");rg("GGGG","isoWeekYear");rg("GGGGG","isoWeekYear");On("weekYear","gg");On("isoWeekYear","GG");Pn("weekYear",1);Pn("isoWeekYear",1);pe("G",Qf);pe("g",Qf);pe("GG",Tt,wr);pe("gg",Tt,wr);pe("GGGG",mv,gv);pe("gggg",mv,gv);pe("GGGGG",Zf,Xf);pe("ggggg",Zf,Xf);xc(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=tt(t)});xc(["gg","GG"],function(t,e,n,r){e[r]=Q.parseTwoDigitYear(t)});function w2(t){return vx.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function C2(t){return vx.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function v2(){return wo(this.year(),1,4)}function S2(){return wo(this.isoWeekYear(),1,4)}function y2(){var t=this.localeData()._week;return wo(this.year(),t.dow,t.doy)}function b2(){var t=this.localeData()._week;return wo(this.weekYear(),t.dow,t.doy)}function vx(t,e,n,r,i){var o;return t==null?lc(this,r,i).year:(o=wo(t,r,i),e>o&&(e=o),R2.call(this,t,e,n,r,i))}function R2(t,e,n,r,i){var o=QP(t,e,n,r,i),s=ac(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Ae("Q",0,"Qo","quarter");On("quarter","Q");Pn("quarter",7);pe("Q",BP);gt("Q",function(t,e){e[ao]=(tt(t)-1)*3});function E2(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ae("D",["DD",2],"Do","date");On("date","D");Pn("date",9);pe("D",Tt);pe("DD",Tt,wr);pe("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});gt(["D","DD"],Ti);gt("Do",function(t,e){e[Ti]=tt(t.match(Tt)[0])});var Sx=Il("Date",!0);Ae("DDD",["DDDD",3],"DDDo","dayOfYear");On("dayOfYear","DDD");Pn("dayOfYear",4);pe("DDD",qf);pe("DDDD",UP);gt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=tt(t)});function T2(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ae("m",["mm",2],0,"minute");On("minute","m");Pn("minute",14);pe("m",Tt);pe("mm",Tt,wr);gt(["m","mm"],qr);var _2=Il("Minutes",!1);Ae("s",["ss",2],0,"second");On("second","s");Pn("second",15);pe("s",Tt);pe("ss",Tt,wr);gt(["s","ss"],lo);var M2=Il("Seconds",!1);Ae("S",0,0,function(){return~~(this.millisecond()/100)});Ae(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ae(0,["SSS",3],0,"millisecond");Ae(0,["SSSS",4],0,function(){return this.millisecond()*10});Ae(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ae(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ae(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ae(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ae(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});On("millisecond","ms");Pn("millisecond",16);pe("S",qf,BP);pe("SS",qf,wr);pe("SSS",qf,UP);var Zo,yx;for(Zo="SSSS";Zo.length<=9;Zo+="S")pe(Zo,Hl);function A2(t,e){e[Xs]=tt(("0."+t)*1e3)}for(Zo="S";Zo.length<=9;Zo+="S")gt(Zo,A2);yx=Il("Milliseconds",!1);Ae("z",0,0,"zoneAbbr");Ae("zz",0,0,"zoneName");function O2(){return this._isUTC?"UTC":""}function P2(){return this._isUTC?"Coordinated Universal Time":""}var ne=Oc.prototype;ne.add=bU;ne.calendar=OU;ne.clone=PU;ne.diff=kU;ne.endOf=jU;ne.format=VU;ne.from=BU;ne.fromNow=UU;ne.to=GU;ne.toNow=zU;ne.get=IV;ne.invalidAt=n2;ne.isAfter=xU;ne.isBefore=IU;ne.isBetween=HU;ne.isSame=DU;ne.isSameOrAfter=NU;ne.isSameOrBefore=LU;ne.isValid=e2;ne.lang=gx;ne.locale=fx;ne.localeData=mx;ne.max=eU;ne.min=JB;ne.parsingFlags=t2;ne.set=HV;ne.startOf=YU;ne.subtract=RU;ne.toArray=ZU;ne.toObject=QU;ne.toDate=qU;ne.toISOString=FU;ne.inspect=WU;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=JU;ne.toString=$U;ne.unix=XU;ne.valueOf=KU;ne.creationData=r2;ne.eraName=a2;ne.eraNarrow=l2;ne.eraAbbr=u2;ne.eraYear=c2;ne.year=ZP;ne.isLeapYear=QV;ne.weekYear=w2;ne.isoWeekYear=C2;ne.quarter=ne.quarters=E2;ne.month=XP;ne.daysInMonth=XV;ne.week=ne.weeks=iB;ne.isoWeek=ne.isoWeeks=oB;ne.weeksInYear=y2;ne.weeksInWeekYear=b2;ne.isoWeeksInYear=v2;ne.isoWeeksInISOWeekYear=S2;ne.date=Sx;ne.day=ne.days=CB;ne.weekday=vB;ne.isoWeekday=SB;ne.dayOfYear=T2;ne.hour=ne.hours=MB;ne.minute=ne.minutes=_2;ne.second=ne.seconds=M2;ne.millisecond=ne.milliseconds=yx;ne.utcOffset=uU;ne.utc=hU;ne.local=dU;ne.parseZone=fU;ne.hasAlignedHourOffset=gU;ne.isDST=mU;ne.isLocal=wU;ne.isUtcOffset=CU;ne.isUtc=ux;ne.isUTC=ux;ne.zoneAbbr=O2;ne.zoneName=P2;ne.dates=xr("dates accessor is deprecated. Use date instead.",Sx);ne.months=xr("months accessor is deprecated. Use month instead",XP);ne.years=xr("years accessor is deprecated. Use year instead",ZP);ne.zone=xr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",cU);ne.isDSTShifted=xr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",pU);function x2(t){return Et(t*1e3)}function I2(){return Et.apply(null,arguments).parseZone()}function bx(t){return t}var lt=hv.prototype;lt.calendar=CV;lt.longDateFormat=bV;lt.invalidDate=EV;lt.ordinal=MV;lt.preparse=bx;lt.postformat=bx;lt.relativeTime=OV;lt.pastFuture=PV;lt.set=pV;lt.eras=i2;lt.erasParse=o2;lt.erasConvertYear=s2;lt.erasAbbrRegex=d2;lt.erasNameRegex=h2;lt.erasNarrowRegex=f2;lt.months=zV;lt.monthsShort=YV;lt.monthsParse=KV;lt.monthsRegex=ZV;lt.monthsShortRegex=qV;lt.week=eB;lt.firstDayOfYear=rB;lt.firstDayOfWeek=nB;lt.weekdays=fB;lt.weekdaysMin=mB;lt.weekdaysShort=gB;lt.weekdaysParse=wB;lt.weekdaysRegex=yB;lt.weekdaysShortRegex=bB;lt.weekdaysMinRegex=RB;lt.isPM=TB;lt.meridiem=AB;function ef(t,e,n,r){var i=Ro(),o=Di().set(r,e);return i[n](o,t)}function Rx(t,e,n){if(Co(t)&&(e=t,t=void 0),t=t||"",e!=null)return ef(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=ef(t,r,n,"month");return i}function Mv(t,e,n,r){typeof t=="boolean"?(Co(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Co(e)&&(n=e,e=void 0),e=e||"");var i=Ro(),o=t?i._week.dow:0,s,a=[];if(n!=null)return ef(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=ef(e,(s+o)%7,r,"day");return a}function H2(t,e){return Rx(t,e,"months")}function D2(t,e){return Rx(t,e,"monthsShort")}function N2(t,e,n){return Mv(t,e,n,"weekdays")}function L2(t,e,n){return Mv(t,e,n,"weekdaysShort")}function k2(t,e,n){return Mv(t,e,n,"weekdaysMin")}ts("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=tt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Q.lang=xr("moment.lang is deprecated. Use moment.locale instead.",ts);Q.langData=xr("moment.langData is deprecated. Use moment.localeData instead.",Ro);var Fi=Math.abs;function $2(){var t=this._data;return this._milliseconds=Fi(this._milliseconds),this._days=Fi(this._days),this._months=Fi(this._months),t.milliseconds=Fi(t.milliseconds),t.seconds=Fi(t.seconds),t.minutes=Fi(t.minutes),t.hours=Fi(t.hours),t.months=Fi(t.months),t.years=Fi(t.years),this}function Ex(t,e,n,r){var i=ii(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function F2(t,e){return Ex(this,t,e,1)}function W2(t,e){return Ex(this,t,e,-1)}function GR(t){return t<0?Math.floor(t):Math.ceil(t)}function V2(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=GR(Yw(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Mr(t/1e3),r.seconds=i%60,o=Mr(i/60),r.minutes=o%60,s=Mr(o/60),r.hours=s%24,e+=Mr(s/24),l=Mr(Tx(e)),n+=l,e-=GR(Yw(l)),a=Mr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function Tx(t){return t*4800/146097}function Yw(t){return t*146097/4800}function B2(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Ir(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+Tx(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Yw(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function U2(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+tt(this._months/12)*31536e6:NaN}function Eo(t){return function(){return this.as(t)}}var G2=Eo("ms"),z2=Eo("s"),Y2=Eo("m"),j2=Eo("h"),K2=Eo("d"),X2=Eo("w"),q2=Eo("M"),Z2=Eo("Q"),Q2=Eo("y");function J2(){return ii(this)}function eG(t){return t=Ir(t),this.isValid()?this[t+"s"]():NaN}function da(t){return function(){return this.isValid()?this._data[t]:NaN}}var tG=da("milliseconds"),nG=da("seconds"),rG=da("minutes"),iG=da("hours"),oG=da("days"),sG=da("months"),aG=da("years");function lG(){return Mr(this.days()/7)}var no=Math.round,gl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function uG(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function cG(t,e,n,r){var i=ii(t).abs(),o=no(i.as("s")),s=no(i.as("m")),a=no(i.as("h")),l=no(i.as("d")),u=no(i.as("M")),c=no(i.as("w")),h=no(i.as("y")),f=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=r,uG.apply(null,f)}function hG(t){return t===void 0?no:typeof t=="function"?(no=t,!0):!1}function dG(t,e){return gl[t]===void 0?!1:e===void 0?gl[t]:(gl[t]=e,t==="s"&&(gl.ss=e-1),!0)}function fG(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=gl,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},gl,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=cG(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var vm=Math.abs;function ba(t){return(t>0)-(t<0)||+t}function ig(){if(!this.isValid())return this.localeData().invalidDate();var t=vm(this._milliseconds)/1e3,e=vm(this._days),n=vm(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Mr(t/60),i=Mr(r/60),t%=60,r%=60,o=Mr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ba(this._months)!==ba(a)?"-":"",c=ba(this._days)!==ba(a)?"-":"",h=ba(this._milliseconds)!==ba(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var it=ng.prototype;it.isValid=oU;it.abs=$2;it.add=F2;it.subtract=W2;it.as=B2;it.asMilliseconds=G2;it.asSeconds=z2;it.asMinutes=Y2;it.asHours=j2;it.asDays=K2;it.asWeeks=X2;it.asMonths=q2;it.asQuarters=Z2;it.asYears=Q2;it.valueOf=U2;it._bubble=V2;it.clone=J2;it.get=eG;it.milliseconds=tG;it.seconds=nG;it.minutes=rG;it.hours=iG;it.days=oG;it.weeks=lG;it.months=sG;it.years=aG;it.humanize=fG;it.toISOString=ig;it.toString=ig;it.toJSON=ig;it.locale=fx;it.localeData=mx;it.toIsoString=xr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ig);it.lang=gx;Ae("X",0,0,"unix");Ae("x",0,0,"valueOf");pe("x",Qf);pe("X",NV);gt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});gt("x",function(t,e,n){n._d=new Date(tt(t))});//! moment.js
Q.version="2.29.4";gV(Et);Q.fn=ne;Q.min=tU;Q.max=nU;Q.now=rU;Q.utc=Di;Q.unix=x2;Q.months=H2;Q.isDate=Ac;Q.locale=ts;Q.invalid=jf;Q.duration=ii;Q.isMoment=ni;Q.weekdays=N2;Q.parseZone=I2;Q.localeData=Ro;Q.isDuration=bd;Q.monthsShort=D2;Q.weekdaysMin=k2;Q.defineLocale=vv;Q.updateLocale=IB;Q.locales=HB;Q.weekdaysShort=L2;Q.normalizeUnits=Ir;Q.relativeTimeRounding=hG;Q.relativeTimeThreshold=dG;Q.calendarFormat=AU;Q.prototype=ne;Q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const gG=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));function _x(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function jw(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Wu(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Gt(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function mr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function T(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function Mx(t){return Gt(t,(e,n)=>e+n,0)}function mG(t){return Gt(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function pG(t){return Gt(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function wG(t){return t.length?Mx(t)/t.length:0}function Ax(t){return Gt(t,(e,n)=>e.concat(Array.isArray(n)?Ax(n):n),[])}function Av(t){const e=[];return T(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function Kw(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function CG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>s.includes(a))}),o}function vG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return T(i,s=>{T(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function Xw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const SG=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:wG,arrayEach:T,arrayFilter:mr,arrayFlatten:Ax,arrayMap:Ue,arrayMax:mG,arrayMin:pG,arrayReduce:Gt,arraySum:Mx,arrayUnique:Av,extendArray:jw,getDifferenceOfArrays:Kw,getIntersectionOfArrays:CG,getUnionOfArrays:vG,pivot:Wu,stringToArray:Xw,to2dArray:_x},Symbol.toStringTag,{value:"Module"}));function ft(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Gt(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Ft(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ce(t){return typeof t<"u"}function Ct(t){return typeof t>"u"}function en(t){return t===null||t===""||Ct(t)}function Ox(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const xu="length",Vu=t=>parseInt(t,16),zR=t=>parseInt(t,10),tf=(t,e,n)=>t.substr(e,n),Bu=t=>t.codePointAt(0)-65,qw=t=>`${t}`.replace(/\-/g,""),yG=t=>Vu(tf(qw(t),Vu("12"),Bu("F")))/(Vu(tf(qw(t),Bu("B"),~~![][xu]))||9),bG=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let YR=!1;const jR={invalid:()=>ft`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},KR={invalid:()=>ft`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Px(t,e){const n=!en(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0";let o,s="invalid",a="invalid";t=qw(t||"");const l=RG(t);if(n||r||l)if(l){const u=Q("30/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=yG(t);o=Q((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(bG()&&(s="valid",a="valid"),!YR&&s!=="valid"&&(jR[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](jR[s]({keyValidityDate:o,hotVersion:i})),YR=!0),a!=="valid"&&e.parentNode&&KR[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=KR[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function RG(t){let e=[][xu],n=e;if(t[xu]!==Bu("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Bu(i.shift());o;o=Bu(i.shift()||"A"))--o<""[xu]?n=n|(zR(`${zR(Vu(r)+(Vu(tf(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=tf(t,o,o?i[xu]===1?9:8:6);return n===e}const EG=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:Px,isDefined:ce,isEmpty:en,isRegExp:Ox,isUndefined:Ct,stringify:Ft},Symbol.toStringTag,{value:"Module"}));function _n(t){return t[0].toUpperCase()+t.substr(1)}function TG(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Ft(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function Ov(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function Pv(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function xv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Zw(t){return og(`${t}`,{ALLOWED_TAGS:[]})}function og(t,e){return fV.sanitize(t,e)}const _G=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:TG,isPercentValue:Pv,randomString:Ov,sanitize:og,stripTags:Zw,substitute:xv,toUpperCaseFirst:_n},Symbol.toStringTag,{value:"Module"})),Dl=t=>["tabindex",t],MG=()=>["role","treegrid"],Ai=()=>["role","presentation"],AG=()=>["role","gridcell"],OG=()=>["role","rowheader"],xx=()=>["role","rowgroup"],PG=()=>["role","columnheader"],Qw=()=>["role","row"],xG=()=>["role","menu"],IG=()=>["role","menuitem"],HG=()=>["role","combobox"],Ix=()=>["role","listbox"],DG=()=>["role","option"],NG=()=>["role","checkbox"],LG=()=>["scope","col"],kG=()=>["scope","row"],$G=()=>["type","text"],Iv=t=>["aria-label",t],To=()=>["aria-hidden","true"],FG=()=>["aria-disabled","true"],WG=()=>["aria-multiselectable","true"],Hx=t=>["aria-haspopup",t],Dx=t=>["aria-rowcount",t],sg=t=>["aria-colcount",t],Nx=t=>["aria-rowindex",t],Hv=t=>["aria-colindex",t],Ar=t=>["aria-expanded",t],VG=t=>["aria-sort",t],XR=()=>["aria-readonly","true"],qR=()=>["aria-invalid","true"],BG=t=>["aria-checked",t],Dv=()=>["aria-selected","true"],UG=()=>["aria-autocomplete","list"],GG=t=>["aria-controls",t],zG=t=>["aria-activedescendant",t],YG=t=>["aria-live",t],jG=t=>["aria-relevant",t],KG=t=>["aria-setsize",t],XG=t=>["aria-posinset",t];function Lx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function kx(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function $x(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function cc(t){return $x(t)&&t.parent}function qG(t){return!!Object.getPrototypeOf(t.parent)}function as(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Iu(t,e,n){const r=[];let i=t;for(;i&&(i=as(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function ns(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Fx(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Bo(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Wx(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Vx(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function De(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ee(t,e){typeof e=="string"&&(e=e.split(" ")),e=Wx(e),e.length>0&&t.classList.add(...e)}function ke(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Vx(e,!0);n=Wx(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Me(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function fa(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Vx(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function Nv(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)Nv(e[n])}}function ri(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const Bx=/(<(.*)>|&(.*);)/;function ga(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Bx.test(e)?t.innerHTML=n?og(e):e:ls(t,e)}function ls(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ri(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function us(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return us(n.host.impl);if(n.host)return us(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(vo(n).display==="none")return!1;n=n.parentNode}return!0}function jt(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function Lv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function ag(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function hc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Lv(e):t.scrollTop}function nf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?ag(e):t.scrollLeft}function dc(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function na(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=vo(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function _l(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=vo(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function ZG(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function vo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function dt(t){return t.offsetWidth}function xt(t){return t.offsetHeight}function uo(t){return t.clientHeight||t.innerHeight}function Uu(t){return t.clientWidth||t.innerWidth}function QG(t,e,n){t.addEventListener(e,n,!1)}function JG(t,e,n){t.removeEventListener(e,n,!1)}function kv(t){return t.selectionStart?t.selectionStart:0}function Ux(t){return t.selectionEnd?t.selectionEnd:0}function ez(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function Jw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Ic(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let Sm;function tz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function on(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Sm===void 0&&(Sm=tz(t)),Sm}function Gx(t){return t.offsetWidth!==t.clientWidth}function zx(t){return t.offsetHeight!==t.clientHeight}function lg(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function nz(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Hc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function rf(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function ug(t){return rf(t)&&t.hasAttribute("data-hot-input")===!1}function rz(t){const e=t.ownerDocument.activeElement;ug(e)||t.select()}function $v(t){return!t.parentNode}function Yx(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Fv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Me(t,"contenteditable",!0),n&&Me(t,...To()),e&&ee(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function Wv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ke(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function jx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Fv(t,n),e(),Wv(t,n)}const iz=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:Bx,addClass:ee,addEvent:QG,clearTextSelection:Jw,closest:as,closestDown:Iu,empty:ri,fastInnerHTML:ga,fastInnerText:ls,getCaretPosition:kv,getComputedStyle:vo,getCssTransform:nz,getFrameElement:$x,getParent:Lx,getParentWindow:cc,getScrollLeft:nf,getScrollTop:hc,getScrollableElement:dc,getScrollbarWidth:on,getSelectionEndPosition:Ux,getSelectionText:ez,getStyle:_l,getTrimmingContainer:na,getWindowScrollLeft:ag,getWindowScrollTop:Lv,hasAccessToParentWindow:qG,hasClass:De,hasHorizontalScrollbar:zx,hasVerticalScrollbar:Gx,index:Fx,innerHeight:uo,innerWidth:Uu,isChildOf:ns,isDetached:$v,isInput:rf,isOutsideInput:ug,isThisHotChild:kx,isVisible:us,makeElementContentEditableAndSelectItsContent:Fv,matchesCSSRules:ZG,observeVisibilityChangeOnce:Yx,offset:jt,outerHeight:xt,outerWidth:dt,overlayContainsElement:Bo,removeAttribute:fa,removeClass:ke,removeContentEditableFromElementAndDeselect:Wv,removeEvent:JG,removeTextNodes:Nv,resetCssTransform:Hc,runWithSelectedContendEditableElement:jx,selectElementIfAllowed:rz,setAttribute:Me,setCaretPosition:Ic,setOverlayPosition:lg},Symbol.toStringTag,{value:"Module"}));function wt(t){return typeof t=="function"}function Kx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function oz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=Kx(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function cg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function sz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Gt(i,(u,c)=>c(u),r.apply(this,a))}}function Vv(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function Xx(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function az(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function of(t,e,n,r,i,o,s,a){return ce(a)?t.call(e,n,r,i,o,s,a):ce(s)?t.call(e,n,r,i,o,s):ce(o)?t.call(e,n,r,i,o):ce(i)?t.call(e,n,r,i):ce(r)?t.call(e,n,r):ce(n)?t.call(e,n):t.call(e)}const lz=Object.freeze(Object.defineProperty({__proto__:null,curry:Xx,curryRight:az,debounce:cg,fastCall:of,isFunction:wt,partial:Vv,pipe:sz,throttle:Kx,throttleAfterHits:oz},Symbol.toStringTag,{value:"Module"}));var uz=zn,ZR=pP,cz=wn,QR=xl,hz=bP,JR=uz([].push),dz=function(t){if(cz(t))return t;if(ZR(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?JR(n,i):(typeof i=="number"||QR(i)==="Number"||QR(i)==="String")&&JR(n,hz(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(ZR(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},fz=ca,qx=Ec,Zx=Yf,gz=Vf,Dc=zn,Qx=Pr,eE=wn,tE=XC,Jx=sv,mz=dz,pz=KC,wz=String,rs=qx("JSON","stringify"),ih=Dc(/./.exec),nE=Dc("".charAt),Cz=Dc("".charCodeAt),vz=Dc("".replace),Sz=Dc(1 .toString),yz=/[\uD800-\uDFFF]/g,rE=/^[\uD800-\uDBFF]$/,iE=/^[\uDC00-\uDFFF]$/,oE=!pz||Qx(function(){var t=qx("Symbol")("stringify detection");return rs([t])!=="[null]"||rs({a:t})!=="{}"||rs(Object(t))!=="{}"}),sE=Qx(function(){return rs("\uDF06\uD834")!=='"\\udf06\\ud834"'||rs("\uDEAD")!=='"\\udead"'}),bz=function(t,e){var n=Jx(arguments),r=mz(e);if(!(!eE(r)&&(t===void 0||tE(t))))return n[1]=function(i,o){if(eE(r)&&(o=gz(r,this,wz(i),o)),!tE(o))return o},Zx(rs,null,n)},Rz=function(t,e,n){var r=nE(n,e-1),i=nE(n,e+1);return ih(rE,t)&&!ih(iE,i)||ih(iE,t)&&!ih(rE,r)?"\\u"+Sz(Cz(t,0),16):t};rs&&fz({target:"JSON",stat:!0,arity:3,forced:oE||sE},{stringify:function(e,n,r){var i=Jx(arguments),o=Zx(oE?bz:rs,null,i);return sE&&typeof o=="string"?vz(o,yz,Rz):o}});function Ml(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ge(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Ml(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Ml(n[0])]:e[r]=[]:e[r]=null)})),e}function _o(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Kt(t,e,n){const r=Array.isArray(n);return Ge(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Nc(t,e){Ge(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Nc(t[r],e[r])):t[r]=e[r]})}function Mn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Bn(t){const e={};return Ge(t,(n,r)=>{e[r]=n}),e}function mt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return T(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ge(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const f=`_${c}`,g=w=>{let C=w;return(Array.isArray(C)||Be(C))&&(C=Mn(C)),C};return function(){return this[f]===void 0&&(this[f]=g(h)),this[f]}},l=function(c){const h=`_${c}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function hg(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Be(t){return Object.prototype.toString.call(t)==="[object Object]"}function Li(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ge(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function eI(t,e){const n=e.split(".");let r=t;return Ge(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Ed(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Pt(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function dg(t){if(!Be(t))return 0;const e=function(n){let r=0;return Be(n)?Ge(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Zr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Pt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Ez=Object.freeze(Object.defineProperty({__proto__:null,clone:Bn,createObjectPropListener:Zr,deepClone:Mn,deepExtend:Nc,deepObjectSize:dg,defineGetter:Li,duckSchema:Ml,extend:Kt,getProperty:eI,hasOwnProperty:Pt,inherit:_o,isObject:Be,isObjectEqual:hg,mixin:mt,objectEach:Ge,setProperty:Ed},Symbol.toStringTag,{value:"Module"})),Er=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Mo={chrome:Er((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Er(t=>/CriOS/.test(t)),edge:Er(t=>/Edge/.test(t)),edgeWebKit:Er(t=>/EdgiOS/.test(t)),firefox:Er(t=>/Firefox/.test(t)),firefoxWebKit:Er(t=>/FxiOS/.test(t)),mobile:Er(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Er((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Nl={mac:Er(t=>/^Mac/.test(t)),win:Er(t=>/^Win/.test(t)),linux:Er(t=>/^Linux/.test(t)),ios:Er(t=>/iPhone|iPad|iPod/i.test(t))};function tI(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(Mo,n=>{let{test:r}=n;return void r(t,e)})}function nI(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(Nl,e=>{let{test:n}=e;return void n(t)})}tI();nI();function Bv(){return Mo.chrome.value}function rI(){return Mo.chromeWebKit.value}function Td(){return Mo.firefox.value}function iI(){return Mo.firefoxWebKit.value}function Uv(){return Mo.safari.value}function oI(){return Mo.edge.value}function Tz(){return Mo.edgeWebKit.value}function co(){return Mo.mobile.value}function Gv(){return Nl.ios.value}function zv(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Nl.mac.value}function eC(){return Nl.win.value}function fc(){return Nl.mac.value}function _z(){return Nl.linux.value}const Mz=Object.freeze(Object.defineProperty({__proto__:null,isChrome:Bv,isChromeWebKit:rI,isEdge:oI,isEdgeWebKit:Tz,isFirefox:Td,isFirefoxWebKit:iI,isIOS:Gv,isIpadOS:zv,isLinuxOS:_z,isMacOS:fc,isMobileBrowser:co,isSafari:Uv,isWindowsOS:eC,setBrowserMeta:tI,setPlatformMeta:nI},Symbol.toStringTag,{value:"Module"})),Ce={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Td()?182:174,AUDIO_MUTE:Td()?181:173,AUDIO_UP:Td()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Az=[Ce.ALT,Ce.ARROW_DOWN,Ce.ARROW_LEFT,Ce.ARROW_RIGHT,Ce.ARROW_UP,Ce.AUDIO_DOWN,Ce.AUDIO_MUTE,Ce.AUDIO_UP,Ce.BACKSPACE,Ce.CAPS_LOCK,Ce.DELETE,Ce.END,Ce.ENTER,Ce.ESCAPE,Ce.F1,Ce.F2,Ce.F3,Ce.F4,Ce.F5,Ce.F6,Ce.F7,Ce.F8,Ce.F9,Ce.F10,Ce.F11,Ce.F12,Ce.F13,Ce.F14,Ce.F15,Ce.F16,Ce.F17,Ce.F18,Ce.F19,Ce.HOME,Ce.INSERT,Ce.MEDIA_NEXT,Ce.MEDIA_PLAY_PAUSE,Ce.MEDIA_PREV,Ce.MEDIA_STOP,Ce.NULL,Ce.NUM_LOCK,Ce.PAGE_DOWN,Ce.PAGE_UP,Ce.PAUSE,Ce.SCROLL_LOCK,Ce.SHIFT,Ce.TAB];function sI(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Yv(t){return Az.includes(t)}function Oz(t){const e=[];return fc()?e.push(Ce.COMMAND_LEFT,Ce.COMMAND_RIGHT,Ce.COMMAND_FIREFOX):e.push(Ce.CONTROL),e.includes(t)}function aI(t){return[Ce.CONTROL,Ce.COMMAND_LEFT,Ce.COMMAND_RIGHT,Ce.COMMAND_FIREFOX].includes(t)}function Ll(t,e){const n=e.split("|");let r=!1;return T(n,i=>{if(t===Ce[i])return r=!0,!1}),r}const Pz=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:Ce,isCtrlKey:Oz,isCtrlMetaKey:aI,isFunctionKey:Yv,isKey:Ll,isPrintableChar:sI},Symbol.toStringTag,{value:"Module"}));function Hr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Yo(t){return t.isImmediatePropagationEnabled===!1}function cs(t){return t.button===2}function fg(t){return t.button===0}function lI(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const xz=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Yo,isLeftClick:fg,isRightClick:cs,offsetRelativeTo:lI,stopImmediatePropagation:Hr},Symbol.toStringTag,{value:"Module"}));function vt(){ce(console)&&console.warn(...arguments)}function jv(){ce(console)&&console.error(...arguments)}function Iz(t,e,n){return e=Hz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hz(t){var e=Dz(t,"string");return typeof e=="symbol"?e:String(e)}function Dz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ra=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Nz=ft`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,ym=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),bm=new Map([[]]);class uI{static getSingleton(){return kz()}constructor(){Iz(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return T(Ra,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))T(n,i=>this.add(e,i,r));else{ym.has(e)&&vt(xv(Nz,{hookName:e,removedInVersion:ym.get(e)})),bm.has(e)&&vt(bm.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&T(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?T(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=of(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=of(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ge(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||Ra.push(e)}deregister(e){this.isRegistered(e)&&Ra.splice(Ra.indexOf(e),1)}isDeprecated(e){return bm.has(e)||ym.has(e)}isRegistered(e){return Ra.indexOf(e)>=0}getRegistered(){return Ra}}const Lz=new uI;function kz(){return Lz}const me=uI,Rm=new Map;function oi(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Rm.has(t)||Rm.set(t,new Map);const e=Rm.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const tC=new WeakMap,{register:$z,getItem:cI,hasItem:hI,getNames:Fz,getValues:lle}=oi("editors");function Wz(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},me.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function dI(t,e){let n;if(typeof t=="function")tC.get(t)||er(null,t),n=tC.get(t);else if(typeof t=="string")n=cI(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function sf(t){if(typeof t=="function")return t;if(!hI(t))throw Error(`No registered editor found under "${t}" name`);return cI(t).getConstructor()}function er(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new Wz(e);typeof t=="string"&&$z(t,n),tC.set(e,n)}function Vz(t,e,n){return e=Bz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bz(t){var e=Uz(t,"string");return typeof e=="symbol"?e:String(e)}function Uz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let _d=0;class Gz{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Vz(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,zz(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),_d+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),_d-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),_d-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function zz(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Hr(this)},t}const pr=Gz;function Yz(){return _d}function aE(t,e){jz(t,e),e.add(t)}function jz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Po(t,e,n){return e=Kz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kz(t){var e=Xz(t,"string");return typeof e=="symbol"?e:String(e)}function Xz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lE(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const gg="editorManager.navigation";var uE=new WeakSet,cE=new WeakSet;class nC{constructor(e,n,r){aE(this,cE),aE(this,uE),Po(this,"hot",void 0),Po(this,"tableMeta",void 0),Po(this,"selection",void 0),Po(this,"eventManager",void 0),Po(this,"destroyed",!1),Po(this,"lock",!1),Po(this,"activeEditor",void 0),Po(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new pr(e),this.hot.addHook("afterDocumentKeyDown",i=>lE(this,uE,qz).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>lE(this,cE,Zz).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=dI(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function qz(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Yo(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Yv(n)&&!aI(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>ce(this.hot.getSelected()),group:gg};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function Zz(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const hE=new WeakMap;nC.getInstance=function(t,e,n){let r=hE.get(t);return r||(r=new nC(t,e,n),hE.set(t,r)),r};const Qz=nC;function oh(t,e){fI(t,e),e.add(t)}function jl(t,e,n){fI(t,e),e.set(t,n)}function fI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ml(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Nt(t,e){var n=gI(t,e,"get");return Jz(t,n)}function Jz(t,e){return e.get?e.get.call(t):e.value}function Kl(t,e,n){var r=gI(t,e,"set");return eY(t,r,n),n}function gI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function eY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Qo=Object.freeze({CELL:"cell",MIXED:"mixed"});var pn=new WeakMap,sh=new WeakMap,ah=new WeakMap,lh=new WeakMap,uh=new WeakMap,af=new WeakSet,dE=new WeakSet,fE=new WeakSet,gE=new WeakSet;class tY{constructor(e){var n=this;oh(this,gE),oh(this,fE),oh(this,dE),oh(this,af),jl(this,pn,{writable:!0,value:void 0}),jl(this,sh,{writable:!0,value:void 0}),jl(this,ah,{writable:!0,value:50}),jl(this,lh,{writable:!0,value:null}),jl(this,uh,{writable:!0,value:new Map});const r=e.getSettings();Kl(this,pn,e),Kl(this,sh,r.imeFastEdit?Qo.MIXED:Qo.CELL),Nt(this,pn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ml(n,gE,iY).call(n,...o)}),Nt(this,pn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ml(n,dE,nY).call(n,...o)}),Nt(this,pn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ml(n,fE,rY).call(n,...o)})}getFocusMode(){return Nt(this,sh)}setFocusMode(e){Object.values(Qo).includes(e)?Kl(this,sh,e):vt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Nt(this,ah)}setRefocusDelay(e){Kl(this,ah,e)}setRefocusElementGetter(e){Kl(this,lh,e)}getRefocusElement(){if(typeof Nt(this,lh)=="function")return Nt(this,lh).call(this);var e;return(e=Nt(this,pn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Nt(this,pn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Nt(this,pn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Nt(this,pn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):ml(this,af,Kv).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Nt(this,ah);const r=this.getRefocusElement();Nt(this,pn).getSettings().imeFastEdit&&!((e=Nt(this,pn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Nt(this,uh).has(n)||Nt(this,uh).set(n,cg(()=>{r.select()},n)),Nt(this,uh).get(n)())}}function Kv(t){var e;const n=(e=Nt(this,pn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Nt(this,pn).selection.isCellVisible(n)){t(null);return}const r=Nt(this,pn).getCell(n.row,n.col,!0);r===null?Nt(this,pn).addHookOnce("afterScroll",()=>{t(Nt(this,pn).getCell(n.row,n.col,!0))}):t(r)}function nY(){ml(this,af,Kv).call(this,t=>{const{activeElement:e}=Nt(this,pn).rootDocument;e&&ug(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function rY(){ml(this,af,Kv).call(this,t=>{this.getFocusMode()===Qo.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function iY(t){t.imeFastEdit&&this.getFocusMode()!==Qo.MIXED?this.setFocusMode(Qo.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Qo.CELL&&this.setFocusMode(Qo.CELL)}const mI={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},oY=new RegExp(Object.keys(mI).map(t=>`(${t})`).join("|"),"gi");function sY(t){return(t&&t.nodeName||"")==="TABLE"}function rC(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let f=0;f<o;f+=1){const g=e&&f===0,w=[];for(let b=0;b<s;b+=1){const y=!g&&n&&b===0;let _="";if(g)_=`<th>${t.getColHeader(b-c)}</th>`;else if(y)_=`<th>${t.getRowHeader(f-h)}</th>`;else{const O=i[f][b],{hidden:I,rowspan:x,colspan:k}=t.getCellMeta(f-h,b-c);if(!I){const U=[];if(x&&U.push(`rowspan="${x}"`),k&&U.push(`colspan="${k}"`),en(O))_=`<td ${U.join(" ")}></td>`;else{const Z=O.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${U.join(" ")}>${Z}</td>`}}}w.push(_)}const C=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,C):u.splice(-1,0,C)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function iC(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=en(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function pI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const O=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,I=>{const x=I.match(/<td\b[^>]*?>/g)[0],k=I.substring(x.length,I.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${x}${k}</td>`});i.insertAdjacentHTML("afterbegin",`${O}`),o=i.querySelector("table")}if(!o||!sY(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((O,I)=>O+I.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let f=!1,g=0,w=0;if(o.tHead){const O=Array.from(o.tHead.rows).filter(I=>{const x=I.querySelector("td")!==null;return x&&h.push(I),!x});g=O.length,f=g>0,g>1?n.nestedHeaders=Array.from(O).reduce((I,x)=>{const k=Array.from(x.cells).reduce((U,Z,z)=>{if(a&&z===0)return U;const{colSpan:K,innerHTML:te}=Z,oe=K>1?{label:te,colspan:K}:te;return U.push(oe),U},[]);return I.push(k),I},[]):f&&(n.colHeaders=Array.from(O[0].children).reduce((I,x,k)=>(a&&k===0||I.push(x.innerHTML),I),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const C=[...h,...Array.from(o.tBodies).reduce((O,I)=>(O.push(...Array.from(I.rows)),O),[]),...c];w=C.length;const b=new Array(w);for(let O=0;O<w;O++)b[O]=new Array(u);const y=[],_=[];for(let O=0;O<w;O++){const I=C[O],x=Array.from(I.cells),k=x.length;for(let U=0;U<k;U++){const Z=x[U],{nodeName:z,innerHTML:K,rowSpan:te,colSpan:oe}=Z,ie=b[O].findIndex(he=>he===void 0);if(z==="TD"){if(te>1||oe>1){for(let Ne=O;Ne<O+te;Ne++)if(Ne<w)for(let R=ie;R<ie+oe;R++)b[Ne][R]=null;const Te=Z.getAttribute("style");Te&&Te.includes("mso-ignore:colspan")||y.push({col:ie,row:O,rowspan:te,colspan:oe})}let he="";s&&/excel/gi.test(s.content)?he=K.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):he=K.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[O][ie]=he.replace(oY,Te=>mI[Te])}else _.push(K)}}return y.length&&(n.mergeCells=y),_.length&&(n.rowHeaders=_),b.length&&(n.data=b),n}const aY=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:iC,htmlToGridSettings:pI,instanceToHTML:rC},Symbol.toStringTag,{value:"Module"}));function Vn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function wI(t){return Vn(t,[","])}function ve(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function lf(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function Xv(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ir(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const lY=Object.freeze(Object.defineProperty({__proto__:null,clamp:ir,isNumeric:Vn,isNumericLike:wI,rangeEach:ve,rangeEachReverse:lf,valueAccordingPercent:Xv},Symbol.toStringTag,{value:"Module"})),oC="asc",uY="desc",mE=new Map([[oC,[-1,1]],[uY,[1,-1]]]),cY=t=>`The priority '${t}' is already declared in a map.`,hY=t=>`The priority '${t}' is not a number.`;function dY(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=wt(t)?t:cY,e=wt(e)?e:hY;function r(o,s){if(!Vn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oC;const[s,a]=mE.get(o)||mE.get(oC);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const fY=t=>`The id '${t}' is already declared in a map.`;function mg(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=wt(t)?t:fY;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[f,g]=h;return u===g?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const gY=t=>`'${t}' value is already declared in a unique set.`;function mY(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=wt(t)?t:gY;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const qv=t=>`There is already registered "${t}" plugin.`,pY=t=>`There is already registered plugin on priority "${t}".`,wY=t=>`The priority "${t}" is not a number.`,CI=dY({errorPriorityExists:pY,errorPriorityNaN:wY}),vI=mY({errorItemExists:qv}),sC=mg({errorIdExists:qv});function Zv(){return[...CI.getItems(),...vI.getItems()]}function Lc(t){const e=_n(t);return sC.getItem(e)}function CY(t){return!!Lc(t)}function rt(t,e,n){[t,e,n]=SY(t,e,n),Lc(t)===void 0&&vY(t,e,n)}function vY(t,e,n){const r=_n(t);if(sC.hasItem(r))throw new Error(qv(r));n===void 0?vI.addItem(r):CI.addItem(n,r),sC.addItem(r,e)}function SY(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:yY,getItem:bY,hasItem:SI,getNames:RY,getValues:ule}=oi("renderers");function uf(t){if(typeof t=="function")return t;if(!SI(t))throw Error(`No registered renderer found under "${t}" name`);return bY(t)}function yi(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),yY(t,e)}const{register:EY,getItem:TY,hasItem:yI,getNames:_Y,getValues:cle}=oi("validators");function Qv(t){if(typeof t=="function")return t;if(!yI(t))throw Error(`No registered validator found under "${t}" name`);return TY(t)}function pl(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),EY(t,e)}var bI={},MY=fP,AY=iv,OY=Object.keys||function(e){return MY(e,AY)},PY=Ii,xY=sP,IY=ua,HY=Tc,DY=Bf,NY=OY;bI.f=PY&&!xY?Object.defineProperties:function(e,n){HY(e);for(var r=DY(n),i=NY(n),o=i.length,s=0,a;o>s;)IY.f(e,a=i[s++],r[a]);return e};var LY=Tc,kY=bI,pE=iv,$Y=tv,FY=MP,WY=JC,VY=uP,wE=">",CE="<",aC="prototype",lC="script",RI=VY("IE_PROTO"),Em=function(){},EI=function(t){return CE+lC+wE+t+CE+"/"+lC+wE},vE=function(t){t.write(EI("")),t.close();var e=t.parentWindow.Object;return t=null,e},BY=function(){var t=WY("iframe"),e="java"+lC+":",n;return t.style.display="none",FY.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(EI("document.F=Object")),n.close(),n.F},ch,Md=function(){try{ch=new ActiveXObject("htmlfile")}catch{}Md=typeof document<"u"?document.domain&&ch?vE(ch):BY():vE(ch);for(var t=pE.length;t--;)delete Md[aC][pE[t]];return Md()};$Y[RI]=!0;var UY=Object.create||function(e,n){var r;return e!==null?(Em[aC]=LY(e),r=new Em,Em[aC]=null,r[RI]=e):r=Md(),n===void 0?r:kY.f(r,n)},GY=Gf,zY=UY,YY=ua.f,uC=GY("unscopables"),cC=Array.prototype;cC[uC]===void 0&&YY(cC,uC,{configurable:!0,value:zY(null)});var TI=function(t){cC[uC][t]=!0},jY=ca,KY=Uf,XY=zf,qY=rv,ZY=TI;jY({target:"Array",proto:!0},{at:function(e){var n=KY(this),r=XY(n),i=qY(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});ZY("at");const Ks=1,Rn=2;function SE(t,e,n){QY(t,e),e.set(t,n)}function QY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wi(t,e,n){return e=JY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JY(t){var e=ej(t,"string");return typeof e=="symbol"?e:String(e)}function ej(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qt(t,e){var n=_I(t,e,"get");return tj(t,n)}function tj(t,e){return e.get?e.get.call(t):e.value}function yE(t,e,n){var r=_I(t,e,"set");return nj(t,r,n),n}function _I(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var hh=new WeakMap,Zt=new WeakMap;class Jv{static get DEFAULT_WIDTH(){return 50}constructor(e){Wi(this,"count",0),Wi(this,"startColumn",null),Wi(this,"endColumn",null),Wi(this,"startPosition",null),Wi(this,"isVisibleInTrimmingContainer",!1),Wi(this,"stretchAllRatio",0),Wi(this,"stretchLastWidth",0),SE(this,hh,{writable:!0,value:0}),Wi(this,"needVerifyLastColumnWidth",!0),Wi(this,"stretchAllColumnsWidth",[]),SE(this,Zt,{writable:!0,value:void 0}),yE(this,Zt,e),typeof qt(this,Zt).stretchingColumnWidthFn!="function"&&(qt(this,Zt).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=qt(this,Zt),s=Math.max(qt(this,Zt).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,f=0,g=0;for(let y=0;y<i;y++)if(h=this._getColumnWidth(y),l<=s&&e!==Rn&&(this.startColumn=y,f=h),l>=s&&l+(e===Rn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y,f=h),this.endColumn=y),c.push(l),l+=h,g=h,e!==Rn&&(this.endColumn=y),l>=s+o){u=!1;break}const w=r+o-a,C=e===Rn?0:g,b=e===Rn?f:0;if(w<-1*qt(this,Zt).inlineStartOffset||r>c.at(-1)+C||-1*qt(this,Zt).scrollOffset-qt(this,Zt).viewportWidth>-1*b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=c[this.endColumn]+h-c[this.startColumn-1];if((y<=o||e!==Rn)&&(this.startColumn-=1),y>o)break}e===Ks&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(qt(this,Zt).stretchMode==="none")return;let n=e;yE(this,hh,n);const r=qt(this,Zt).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=qt(this,Zt).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(qt(this,Zt).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(qt(this,Zt).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return qt(this,Zt).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):qt(this,Zt).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=qt(this,Zt).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=qt(this,Zt).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==qt(this,hh)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=qt(this,hh)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=qt(this,Zt).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=qt(this,Zt).columnWidthFn(e);return isNaN(n)&&(n=Jv.DEFAULT_WIDTH),n}}const eS=Jv;function rj(t,e,n){ij(t,e),e.set(t,n)}function ij(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xl(t,e,n){return e=oj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oj(t){var e=sj(t,"string");return typeof e=="symbol"?e:String(e)}function sj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tm(t,e){var n=MI(t,e,"get");return aj(t,n)}function aj(t,e){return e.get?e.get.call(t):e.value}function lj(t,e,n){var r=MI(t,e,"set");return uj(t,r,n),n}function MI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function uj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ql=new WeakMap;class tS{static get DEFAULT_HEIGHT(){return 23}constructor(e){Xl(this,"count",0),Xl(this,"startRow",null),Xl(this,"endRow",null),Xl(this,"startPosition",null),Xl(this,"isVisibleInTrimmingContainer",!1),rj(this,ql,{writable:!0,value:void 0}),lj(this,ql,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=Tm(this,ql),a=Math.max(Tm(this,ql).scrollOffset,0),l=Tm(this,ql).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let f,g=0,w=0;for(let _=0;_<o;_++)if(f=r(_),isNaN(f)&&(f=tS.DEFAULT_HEIGHT),u<=a&&e!==Rn&&(this.startRow=_,g=f),u>=a&&u+(e===Rn?f:0)<=a+s-l&&(this.startRow===null&&(this.startRow=_,g=f),this.endRow=_),h.push(u),u+=f,w=f,e!==Rn&&(this.endRow=_),u>=a+s-l){c=!1;break}const C=i+s-l,b=e===Rn?g:0,y=e===Rn?0:w;if(C<b||i>h.at(-1)+y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const _=h[this.endRow]+f-h[this.startRow-1];if((_<=s-l||e!==Rn)&&(this.startRow-=1),_>=s-l)break}e===Ks&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const AI=tS;function cj(t,e,n){hj(t,e),e.set(t,n)}function hj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bE(t,e,n){return e=dj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dj(t){var e=fj(t,"string");return typeof e=="symbol"?e:String(e)}function fj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ea(t,e){var n=OI(t,e,"get");return gj(t,n)}function gj(t,e){return e.get?e.get.call(t):e.value}function RE(t,e,n){var r=OI(t,e,"set");return mj(t,r,n),n}function OI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Vi=new WeakMap;class cf{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;bE(this,"row",null),bE(this,"col",null),cj(this,Vi,{writable:!0,value:!1}),RE(this,Vi,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Ea(this,Vi)}isSouthEastOf(e){return this.row>=e.row&&(Ea(this,Vi)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Ea(this,Vi)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Ea(this,Vi)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Ea(this,Vi)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof cf&&RE(this,Vi,e.isRtl()),this}clone(){return new cf(this.row,this.col,Ea(this,Vi))}toObject(){return{row:this.row,col:this.col}}}const hf=cf;function pj(t,e,n){wj(t,e),e.set(t,n)}function wj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _m(t,e,n){return e=Cj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cj(t){var e=vj(t,"string");return typeof e=="symbol"?e:String(e)}function vj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ai(t,e){var n=PI(t,e,"get");return Sj(t,n)}function Sj(t,e){return e.get?e.get.call(t):e.value}function yj(t,e,n){var r=PI(t,e,"set");return bj(t,r,n),n}function PI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Cr=new WeakMap;class nS{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_m(this,"highlight",null),_m(this,"from",null),_m(this,"to",null),pj(this,Cr,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),yj(this,Cr,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=h,this.to=f,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ai(this,Cr)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ai(this,Cr)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ai(this,Cr)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ai(this,Cr)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ai(this,Cr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ai(this,Cr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ai(this,Cr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ai(this,Cr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof hf))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new nS(this.highlight,this.from,this.to,ai(this,Cr))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new hf(e,n,ai(this,Cr))}}const rS=nS;function pg(t){return window.requestAnimationFrame(t)}function gc(t){window.cancelAnimationFrame(t)}function iS(){return"ontouchstart"in window}let Ta;function xI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ta||(typeof Intl=="object"?Ta=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Ta=(n,r)=>`${n}`.localeCompare(r):Ta=(n,r)=>n===r?0:n>r?-1:1,Ta)}const Rj=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:gc,getComparisonFunction:xI,isTouchSupported:iS,requestAnimationFrame:pg},Symbol.toStringTag,{value:"Module"}));function li(t,e,n){Ej(t,e),e.set(t,n)}function Ej(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Se(t,e){var n=II(t,e,"get");return Tj(t,n)}function Tj(t,e){return e.get?e.get.call(t):e.value}function xo(t,e,n){var r=II(t,e,"set");return _j(t,r,n),n}function II(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _j(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var vr=new WeakMap,Mm=new WeakMap,an=new WeakMap,_a=new WeakMap,dh=new WeakMap,Nr=new WeakMap,Am=new WeakMap,Zl=new WeakMap,vs=new WeakMap,ui=new WeakMap;let Mj=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;li(this,vr,{writable:!0,value:void 0}),li(this,Mm,{writable:!0,value:void 0}),li(this,an,{writable:!0,value:void 0}),li(this,_a,{writable:!0,value:void 0}),li(this,dh,{writable:!0,value:void 0}),li(this,Nr,{writable:!0,value:void 0}),li(this,Am,{writable:!0,value:void 0}),li(this,Zl,{writable:!0,value:void 0}),li(this,vs,{writable:!0,value:[null,null]}),li(this,ui,{writable:!0,value:[null,null]}),xo(this,vr,r),xo(this,Mm,n),xo(this,an,o),xo(this,_a,s),xo(this,dh,a),xo(this,Nr,i),xo(this,Am,e),this.registerEvents()}registerEvents(){Se(this,Nr).addEventListener(Se(this,an).holder,"contextmenu",r=>this.onContextMenu(r)),Se(this,Nr).addEventListener(Se(this,an).TABLE,"mouseover",r=>this.onMouseOver(r)),Se(this,Nr).addEventListener(Se(this,an).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Se(this,Nr).addEventListener(Se(this,an).holder,"touchstart",r=>this.onTouchStart(r)),Se(this,Nr).addEventListener(Se(this,an).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Se(this,Nr).addEventListener(Se(this,an).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Se(this,vr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Se(this,vr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Se(this,Nr).addEventListener(Se(this,an).holder,"mouseup",r=>this.onMouseUp(r)),Se(this,Nr).addEventListener(Se(this,an).holder,"mousedown",r=>this.onMouseDown(r))};co()?e():(iS()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Se(this,Zl)&&r){const[i,o]=[r.row,Se(this,Zl).from.row],[s,a]=[r.col,Se(this,Zl).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=Se(this,an).TABLE,i=Iu(e,["TD","TH"],r);return i?(n.coords=Se(this,an).getCoords(i),n.TD=i):De(e,"wtBorder")&&De(e,"current")?(n.coords=Se(this,_a).getFocusSelection().cellRange.highlight,n.TD=Se(this,an).getCell(n.coords)):De(e,"wtBorder")&&De(e,"area")&&Se(this,_a).getAreaSelection().cellRange&&(n.coords=Se(this,_a).getAreaSelection().cellRange.to,n.TD=Se(this,an).getCell(n.coords)),n}onMouseDown(e){const n=Se(this,Mm).rootDocument.activeElement,r=Vv(Lx,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);De(i,"corner")?Se(this,vr).getSetting("onCellCornerMouseDown",e,i):o.TD&&Se(this,vr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Se(this,ui)[0]=o.TD,clearTimeout(Se(this,vs)[0]),Se(this,vs)[0]=setTimeout(()=>{Se(this,ui)[0]=null},1e3))}onContextMenu(e){if(Se(this,vr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Se(this,vr).has("onCellMouseOver"))return;const n=Se(this,an).TABLE,r=Iu(e.target,["TD","TH"],n),i=Se(this,dh)||this;r&&r!==i.lastMouseOver&&ns(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Se(this,an).getCoords(r),r))}onMouseOut(e){if(!Se(this,vr).has("onCellMouseOut"))return;const n=Se(this,an).TABLE,r=Iu(e.target,["TD","TH"],n),i=Iu(e.relatedTarget,["TD","TH"],n),o=Se(this,dh)||this;r&&r!==i&&ns(r,n)&&(this.callListener("onCellMouseOut",e,Se(this,an).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Se(this,vr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Se(this,ui)[0]&&n.TD===Se(this,ui)[1]?(De(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Se(this,ui)[0]=null,Se(this,ui)[1]=null):n.TD===Se(this,ui)[0]&&(Se(this,ui)[1]=n.TD,clearTimeout(Se(this,vs)[1]),Se(this,vs)[1]=setTimeout(()=>{Se(this,ui)[1]=null},500)))}onTouchStart(e){xo(this,Zl,Se(this,_a).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ce(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Se(this,vr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];Gv()&&(rI()||iI())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=Se(this,vr).getSettingPure(e);o&&o(n,r,i,Se(this,Am).call(this))}destroy(){clearTimeout(Se(this,vs)[0]),clearTimeout(Se(this,vs)[1]),Se(this,Nr).destroy()}};const HI=Mj;function Om(t,e,n){return e=Aj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aj(t){var e=Oj(t,"string");return typeof e=="symbol"?e:String(e)}function Oj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pj{constructor(e,n,r){Om(this,"offset",void 0),Om(this,"total",void 0),Om(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const xj=Pj;function Pm(t,e,n){return e=Ij(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ij(t){var e=Hj(t,"string");return typeof e=="symbol"?e:String(e)}function Hj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dj{constructor(e,n,r){Pm(this,"offset",void 0),Pm(this,"total",void 0),Pm(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Nj=Dj,Lj=0,df=1,ff=2;function fh(t,e,n){return e=kj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kj(t){var e=$j(t,"string");return typeof e=="symbol"?e:String(e)}function $j(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EE{constructor(){fh(this,"currentSize",0),fh(this,"nextSize",0),fh(this,"currentOffset",0),fh(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function xm(t,e,n){return e=Fj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fj(t){var e=Wj(t,"string");return typeof e=="symbol"?e:String(e)}function Wj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vj{constructor(){xm(this,"size",new EE),xm(this,"workingSpace",Lj),xm(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof EE}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=df,e.workingSpace=ff,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=ff,e.workingSpace=df,this.sharedSize=e.getViewSize()}}function Ma(t,e,n){return e=Bj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bj(t){var e=Uj(t,"string");return typeof e=="symbol"?e:String(e)}function Uj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DI{constructor(e,n,r){Ma(this,"rootNode",void 0),Ma(this,"nodesPool",void 0),Ma(this,"sizeSet",new Vj),Ma(this,"childNodeType",void 0),Ma(this,"visualIndex",0),Ma(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(df))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(ff)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(df);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(ff)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class NI extends DI{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Gj(t,e,n){return e=zj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zj(t){var e=Yj(t,"string");return typeof e=="symbol"?e:String(e)}function Yj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jj{constructor(e){Gj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Ql(t,e,n){return e=Kj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kj(t){var e=Xj(t,"string");return typeof e=="symbol"?e:String(e)}function Xj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kc{constructor(e,n){Ql(this,"nodesPool",null),Ql(this,"nodeType",void 0),Ql(this,"rootNode",void 0),Ql(this,"table",null),Ql(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new jj(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function TE(t,e,n){return e=qj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qj(t){var e=Zj(t,"string");return typeof e=="symbol"?e:String(e)}function Zj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qj extends kc{constructor(){super("TH"),TE(this,"orderViews",new WeakMap),TE(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new NI(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),fa(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Me(f,[OG(),kG(),Hv(h+1),Dl(-1)]),n[h](a,f,h)}u.end()}}}class Jj extends kc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ri(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Me(this.rootNode,[xx()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Me(s,[Qw(),Nx(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),fa(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Me(u,[Hv(a+1+this.table.rowHeadersCount),Dl(-1),PG(),...a>=0?[LG()]:[Qw()]]),r[n](l,u,n)}}}}class eK extends kc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&ee(r,"rowHeader")}}function tK(t,e,n){return e=nK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nK(t){var e=rK(t,"string");return typeof e=="symbol"?e:String(e)}function rK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let _E=!1;class iK extends kc{constructor(e){super("TR",e),tK(this,"orderView",void 0),this.orderView=new DI(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!_E&&e>1e3&&(_E=!0,vt(ft`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Me(this.rootNode,[xx()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Me(o,[Qw(),Nx(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function ME(t,e,n){return e=oK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oK(t){var e=sK(t,"string");return typeof e=="symbol"?e:String(e)}function sK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aK extends kc{constructor(){super("TD"),ME(this,"orderViews",new WeakMap),ME(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new NI(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const g=c.getCurrentNode(),w=this.table.renderedColumnToSource(f);if(De(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),fa(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,w,g),this.table.isAriaEnabled()){var o,s;Me(g,[...g.hasAttribute("role")?[]:[AG()],Dl(-1),Hv(w+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function ln(t,e,n){return e=lK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lK(t){var e=uK(t,"string");return typeof e=="symbol"?e:String(e)}function uK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cK{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ln(this,"rootNode",void 0),ln(this,"rootDocument",void 0),ln(this,"rowHeaders",null),ln(this,"columnHeaders",null),ln(this,"colGroup",null),ln(this,"rows",null),ln(this,"cells",null),ln(this,"rowFilter",null),ln(this,"columnFilter",null),ln(this,"rowUtils",null),ln(this,"columnUtils",null),ln(this,"rowsToRender",0),ln(this,"columnsToRender",0),ln(this,"rowHeaderFunctions",[]),ln(this,"rowHeadersCount",0),ln(this,"columnHeaderFunctions",[]),ln(this,"columnHeadersCount",0),ln(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class hK{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new cK(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new Qj,columnHeaders:new Jj(n),colGroup:new eK(r),rows:new iK(i),cells:new aK}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Im(t,e,n){return e=dK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dK(t){var e=fK(t,"string");return typeof e=="symbol"?e:String(e)}function fK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gK{constructor(e,n){Im(this,"dataAccessObject",void 0),Im(this,"wtSettings",void 0),Im(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?on():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let h=Array.isArray(a)?a[c]:a;h=h??u,this.headerWidths.set(c,h)}}}}function AE(t,e,n){return e=mK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mK(t){var e=pK(t,"string");return typeof e=="symbol"?e:String(e)}function pK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wK{constructor(e,n){AE(this,"dataAccessObject",void 0),AE(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function ci(t,e,n){return e=CK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CK(t){var e=vK(t,"string");return typeof e=="symbol"?e:String(e)}function vK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SK{constructor(e,n,r,i,o){ci(this,"wtSettings",null),ci(this,"domBindings",void 0),ci(this,"TBODY",null),ci(this,"THEAD",null),ci(this,"COLGROUP",null),ci(this,"hasTableHeight",!0),ci(this,"hasTableWidth",!0),ci(this,"isTableVisible",!1),ci(this,"tableOffset",0),ci(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Nv(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new wK(this.dataAccessObject,this.wtSettings),this.columnUtils=new gK(this.dataAccessObject,this.wtSettings),this.tableRenderer=new hK({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Me(r,[Ai()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Me(r,[Ai()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Me(r.parentNode,[Ai()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Me(r,[Ai()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,f=e;if(this.isMaster&&(this.holderOffset=jt(this.holder),f=i.createRenderCalculators(f),l&&!n.getSetting("fixedColumnsStart"))){const w=r.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=w!==0,C!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=jt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const w=o>0?this.getFirstRenderedRow():0,C=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Nj(w,o,c),this.columnFilter=new xj(C,s,l);let b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),b=y.skipRender!==!0}if(b){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(_i)||this.is(is))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let y;if(this.isMaster&&(y=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(_i))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const _=dt(this.hider),O=dt(this.TABLE);_!==0&&O!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(_i)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=uo(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(_i))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=as(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=Fx(r),s=n.cellIndex;return Bo(oa,n,this.wtRootElement)||Bo(ra,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Bo(is,n,this.wtRootElement)||Bo(_i,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),Bo(oa,n,this.wtRootElement)||Bo(ia,n,this.wtRootElement)||Bo(is,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=uo(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=uo(l):o=uo(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return dt(this.TABLE)}getHeight(){return xt(this.TABLE)}getTotalWidth(){const e=dt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=xt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return us(this.TABLE)}_modifyRowHeaderWidth(e){let n=wt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const kl=SK,yK="stickyRowsBottom",LI={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Li(LI,"MIXIN_NAME",yK,{writable:!1,enumerable:!1});const kI=LI,bK="stickyColumnsStart",$I={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Li($I,"MIXIN_NAME",bK,{writable:!1,enumerable:!1});const oS=$I;class sS extends kl{constructor(e,n,r,i){super(e,n,r,i,is)}}mt(sS,kI);mt(sS,oS);const RK=sS,ra="top",_i="bottom",ia="inline_start",oa="top_inline_start_corner",is="bottom_inline_start_corner",EK=[ra,_i,ia,oa,is],TK=new Map([[ra,`ht_clone_${ra}`],[_i,`ht_clone_${_i}`],[ia,`ht_clone_${ia} ht_clone_left`],[oa,`ht_clone_${oa} ht_clone_top_left_corner`],[is,`ht_clone_${is} ht_clone_bottom_left_corner`]]);function Hm(t,e,n){return e=_K(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _K(t){var e=MK(t,"string");return typeof e=="symbol"?e:String(e)}function MK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AK{constructor(e){Hm(this,"dataAccessObject",void 0),Hm(this,"lastScrolledColumnPos",-1),Hm(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(f=h.scrollTo(e,l?e>a:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=jt(n.wtRootElement),u=uo(n.hider),c=uo(s),h=hc(s,s);if(l.top+u-c<=h){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let g=i;g>0;g--)if(f+=e.sumCellSizes(g-1,g),l.top+u-f<=h){a=g;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=jt(n.wtRootElement),l=hc(o,o);if(a.top>l){const u=uo(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=jt(n.wtRootElement),l=Uu(n.hider),u=Uu(o),c=Math.abs(nf(o,o));if(a.left+l-u<=c){let h=r.getRowHeaderWidth();for(let f=i;f>0;f--)if(h+=e.sumCellSizes(f-1,f),a.left+l-h<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-g)}else u=jt(r.wtRootElement).left;const c=Math.abs(nf(s,s));if(u>c){const h=Uu(s);let f=i.getRowHeaderWidth();for(let g=1;g<=o;g++)if(f+=n.sumCellSizes(g-1,g),u+f-c>=h){a=g-2;break}}}return a}}const OK=AK;function Lr(t,e,n){return e=PK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PK(t){var e=xK(t,"string");return typeof e=="symbol"?e:String(e)}function xK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aS{get eventManager(){return new pr(this)}constructor(e,n){Lr(this,"wtTable",void 0),Lr(this,"wtScroll",void 0),Lr(this,"wtViewport",void 0),Lr(this,"wtOverlays",void 0),Lr(this,"selectionManager",void 0),Lr(this,"wtEvent",void 0),Lr(this,"guid",`wt_${Ov()}`),Lr(this,"drawInterrupted",!1),Lr(this,"drawn",!1),Lr(this,"domBindings",void 0),Lr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new OK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){ls(r,e[n])}])}}createCellCoords(e,n){return new hf(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new rS(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function OE(t,e,n){return e=IK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IK(t){var e=HK(t,"string");return typeof e=="symbol"?e:String(e)}function HK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DK extends aS{constructor(e,n,r){super(e,n),OE(this,"cloneSource",void 0),OE(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new HI(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function NK(t,e,n){return e=LK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LK(t){var e=kK(t,"string");return typeof e=="symbol"?e:String(e)}function kK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $c{constructor(e,n,r,i,o){NK(this,"wtSettings",null),Li(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=na(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=na(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=dc(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){vt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+on())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(EK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${TK.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Me(o,[Ai()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===ra||u==="vertical"&&this.type===ia?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=dc(e.TABLE),new DK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;T([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class $K extends $c{constructor(e,n,r,i,o,s){super(e,n,is,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new RK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Hc(n),this.repositionOverlay();let r=xt(this.clone.wtTable.TABLE);const i=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=on(r)),i.style.bottom=`${o}px`}}const FK="calculatedColumns",FI={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Li(FI,"MIXIN_NAME",FK,{writable:!1,enumerable:!1});const lS=FI;class uS extends kl{constructor(e,n,r,i){super(e,n,r,i,_i)}}mt(uS,kI);mt(uS,lS);const WK=uS;function VK(t,e,n){return e=BK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BK(t){var e=UK(t,"string");return typeof e=="symbol"?e:String(e)}function UK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GK extends $c{constructor(e,n,r,i){super(e,n,_i,r,i),VK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new WK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=on(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(ag(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=on(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=xt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=on(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return hc(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=De(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ee(s,"innerBorderBottom"),o=!a):(ke(s,"innerBorderBottom"),o=a)}return o}}const zK="calculatedRows",WI={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Li(WI,"MIXIN_NAME",zK,{writable:!1,enumerable:!1});const VI=WI;class cS extends kl{constructor(e,n,r,i){super(e,n,r,i,ia)}}mt(cS,VI);mt(cS,oS);const YK=cS,jK="localHooks",BI={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)of(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Li(BI,"MIXIN_NAME",jK,{writable:!1,enumerable:!1});const sr=BI;let UI=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};mt(UI,sr);const KK=UI,GI="active-header",hS="header",dS="area",fS="focus",XK="fill",qK="row",ZK="column",QK="custom-selection",gS=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var JK=TI;JK("flat");function e3(t,e){zI(t,e),e.add(t)}function PE(t,e,n){zI(t,e),e.set(t,n)}function zI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function zt(t,e){var n=YI(t,e,"get");return t3(t,n)}function t3(t,e){return e.get?e.get.call(t):e.value}function xE(t,e,n){var r=YI(t,e,"set");return n3(t,r,n),n}function YI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function n3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var kr=new WeakMap,qn=new WeakMap,gh=new WeakSet;class r3{constructor(){e3(this,gh),PE(this,kr,{writable:!0,value:void 0}),PE(this,qn,{writable:!0,value:void 0})}setActiveOverlay(e){return xE(this,qn,e),this}setActiveSelection(e){return xE(this,kr,e),this}scan(){const e=zt(this,kr).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=zt(this,kr).getCorners(),{wtTable:s}=zt(this,qn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let f=-l;f<0;f++){if(f<n||f>i)continue;const g=f+l;let w=s.getColumnHeader(h,g);const C=zt(this,qn).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:zt(this,kr).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});C!==null&&(C!==h&&(w=s.getColumnHeader(C,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=zt(this,kr).getCorners(),{wtTable:s}=zt(this,qn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let f=-l;f<0;f++){if(f<r||f>o)continue;const g=f+l;let w=s.getRowHeader(h,g);const C=zt(this,qn).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:zt(this,kr).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});C!==null&&(C!==h&&(w=s.getRowHeader(C,g)),e(w))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=zt(this,kr).getCorners(),{wtTable:s}=zt(this,qn);Dm(this,gh,Nm).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(zt(this,qn).createCellCoords(a,l)),c=zt(this,qn).getSetting("onAfterDrawSelection",a,l,zt(this,kr).settings.layerLevel);typeof c=="string"&&ee(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=zt(this,kr).getCorners(),{wtTable:i}=zt(this,qn);Dm(this,gh,Nm).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(zt(this,qn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=zt(this,kr).getCorners(),{wtTable:i}=zt(this,qn);Dm(this,gh,Nm).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(zt(this,qn).createCellCoords(o,s));e(a)}})}}function Nm(t){const{wtTable:e}=zt(this,qn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class i3{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=gS,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Hr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),co()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ge(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ge(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),C=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(r-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(r-C/4*3,10)}px`,c[l]=`${parseInt(i-C/4*3,10)}px`;const _=Math.min(parseInt(i+o,10),b-w-g*2),O=Math.min(parseInt(i+o-C/4,10),b-C-g*2);h[l]=`${_}px`,f[l]=`${O}px`;const I=Math.min(parseInt(r+s,10),y-w-g*2),x=Math.min(parseInt(r+s-C/4,10),y-C-g*2);h.top=`${I}px`,f.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(u.display="none",h.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let R=0;R<h;R+=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){o=d,u=e[0];break}}for(let R=h-1;R>=0;R-=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){s=d;break}}const f=n.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){a=d,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){l=d;break}}if(o===void 0||a===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(o,a));const w=o!==s||a!==l,C=w?n.getCell(this.wot.createCellCoords(s,l)):g,b=jt(g),y=w?jt(C):b,_=jt(n.TABLE),O=dt(n.TABLE),I=b.top,x=b.left,k=this.wot.wtSettings.getSetting("rtlMode");let U=0,Z=0;if(k){const R=dt(g),d=i.innerWidth-_.left-O;Z=x+R-y.left,U=i.innerWidth-x-R-d-1}else Z=y.left+dt(C)-x,U=x-_.left-1;if(this.isEntireColumnSelected(o,s)){const R=this.getDimensionsFromHeader("columns",a,l,u,_);let d=null;R&&([d,U,Z]=R),d&&(g=d)}let z=I-_.top-1,K=y.top+xt(C)-I;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",o,s,c,_);let d=null;R&&([d,z,K]=R),d&&(g=d)}const te=vo(g,i);parseInt(te.borderTopWidth,10)>0&&(z+=1,K=K>0?K-1:0),parseInt(te[k?"borderRightWidth":"borderLeftWidth"],10)>0&&(U+=1,Z=Z>0?Z-1:0);const oe=k?"right":"left";this.topStyle.top=`${z}px`,this.topStyle[oe]=`${U}px`,this.topStyle.width=`${Z}px`,this.topStyle.display="block",this.startStyle.top=`${z}px`,this.startStyle[oe]=`${U}px`,this.startStyle.height=`${K}px`,this.startStyle.display="block";const ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${z+K-ie}px`,this.bottomStyle[oe]=`${U}px`,this.bottomStyle.width=`${Z}px`,this.bottomStyle.display="block",this.endStyle.top=`${z}px`,this.endStyle[oe]=`${U+Z-ie}px`,this.endStyle.height=`${K+1}px`,this.endStyle.display="block";let he=this.settings.border.cornerVisible;he=typeof he=="function"?he(this.settings.layerLevel):he;const Te=this.wot.getSetting("onModifyGetCellCoords",s,l);let[ze,Ne]=[s,l];if(Te&&Array.isArray(Te)&&([,,ze,Ne]=Te),co()||!he||this.isPartRange(ze,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top=`${z+K+this.cornerCenterPointOffset-1}px`,this.cornerStyle[oe]=`${U+Z+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=na(n.TABLE);const d=R===i;d&&(R=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,p=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const E=d?C.getBoundingClientRect().left:C.offsetLeft;let M=!1,P=0;k?(P=E-parseInt(this.cornerDefaultStyle.width,10)/2,M=P<0):(P=E+dt(C)+parseInt(this.cornerDefaultStyle.width,10)/2,M=P>=Uu(R)),M&&(this.cornerStyle[oe]=`${Math.floor(U+Z+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[k?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(d?C.getBoundingClientRect().top:C.offsetTop)+xt(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=uo(R)&&(this.cornerStyle.top=`${Math.floor(z+K+this.cornerCenterPointOffset-p)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}co()&&this.updateMultipleSelectionHandlesPosition(s,l,z,U,Z,K)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,f=null,g=null,w=null,C=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return xt(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return dt(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(w=l(n,b-i),C=l(r,b-i),!w||!C)return!1;const y=jt(w),_=jt(C);return w&&C&&(h=y[g]-o[g]-1,f=_[g]+u(C)-y[g]),[w,h,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?ee(this[e],"hidden"):(De(this[e],"hidden")&&ke(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?ee(this[e],"hidden"):ke(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",co()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const IE=i3;function o3(t,e){jI(t,e),e.add(t)}function Aa(t,e,n){jI(t,e),e.set(t,n)}function jI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s3(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ze(t,e){var n=KI(t,e,"get");return a3(t,n)}function a3(t,e){return e.get?e.get.call(t):e.value}function HE(t,e,n){var r=KI(t,e,"set");return l3(t,r,n),n}function KI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function l3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var bn=new WeakMap,tr=new WeakMap,Lm=new WeakMap,Hu=new WeakMap,km=new WeakMap,Ss=new WeakMap,DE=new WeakSet;class u3{constructor(e){o3(this,DE),Aa(this,bn,{writable:!0,value:void 0}),Aa(this,tr,{writable:!0,value:void 0}),Aa(this,Lm,{writable:!0,value:new r3}),Aa(this,Hu,{writable:!0,value:new WeakMap}),Aa(this,km,{writable:!0,value:new WeakSet}),Aa(this,Ss,{writable:!0,value:new Map}),HE(this,tr,e)}setActiveOverlay(e){return HE(this,bn,e),Ze(this,Lm).setActiveOverlay(Ze(this,bn)),Ze(this,Hu).has(Ze(this,bn))||Ze(this,Hu).set(Ze(this,bn),new Set),this}getFocusSelection(){return Ze(this,tr)!==null?Ze(this,tr).getFocus():null}getAreaSelection(){return Ze(this,tr)!==null?Ze(this,tr).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ze(this,Ss).has(e)){const r=Ze(this,Ss).get(e);if(r.has(Ze(this,bn)))return r.get(Ze(this,bn));const i=new IE(Ze(this,bn),e.settings);return r.set(Ze(this,bn),i),i}const n=new IE(Ze(this,bn),e.settings);return Ze(this,Ss).set(e,new Map([[Ze(this,bn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Ze(this,Ss).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Ze(this,Ss).get(e).forEach(n=>n.destroy()),Ze(this,Ss).delete(e)}render(e){if(Ze(this,tr)===null)return;e&&s3(this,DE,c3).call(this);const n=Array.from(Ze(this,tr)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Ze(this,km).has(s)||(Ze(this,km).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Ze(this,Lm).setActiveSelection(s).scan().forEach(w=>{if(r.has(w)){const C=r.get(w);C.has(a)&&u===!0?C.set(a,C.get(a)+1):C.set(a,1)}else r.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const f=s.getCorners();Ze(this,bn).getSetting("onBeforeDrawBorders",f,c),h==null||h.appear(f)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(f,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>Ze(this,Hu).get(Ze(this,bn)).add(u)),ee(s,l),s.nodeName==="TD"&&Array.isArray((a=Ze(this,tr).options)===null||a===void 0?void 0:a.cellAttributes)&&Me(s,Ze(this,tr).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Me(o,[...i.get(o)])})}}function c3(){const t=Ze(this,Hu).get(Ze(this,bn)),e=Ze(this,bn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Ze(this,bn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Ze(this,tr).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Ze(this,tr).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Ze(this,tr).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Ze(this,tr).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)ke(o[a],n),fa(o[a],s)}),t.clear()}class h3 extends $c{constructor(e,n,r,i){super(e,n,ia,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new YK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),lg(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Hc(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,Lv(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=on(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=dt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(gS.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=on(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(nf(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?ke(n,"emptyRows"):ee(n,"emptyRows");let s=!1;if(i&&!r.length)ee(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=De(n,"innerBorderInlineStart");e?(ee(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(ke(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const d3="stickyRowsTop",XI={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Li(XI,"MIXIN_NAME",d3,{writable:!1,enumerable:!1});const qI=XI;class mS extends kl{constructor(e,n,r,i){super(e,n,r,i,oa)}}mt(mS,qI);mt(mS,oS);const f3=mS;function NE(t,e,n){return e=g3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g3(t){var e=m3(t,"string");return typeof e=="symbol"?e:String(e)}function m3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p3 extends $c{constructor(e,n,r,i,o,s){super(e,n,oa,r,i),NE(this,"topOverlay",void 0),NE(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new f3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();lg(e,`${i}px`,`${o}px`)}else Hc(e);let n=xt(this.clone.wtTable.TABLE);const r=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class pS extends kl{constructor(e,n,r,i){super(e,n,r,i,ra)}}mt(pS,qI);mt(pS,lS);const w3=pS;function C3(t,e,n){return e=v3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v3(t){var e=S3(t,"string");return typeof e=="symbol"?e:String(e)}function S3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y3 extends $c{constructor(e,n,r,i){super(e,n,ra,r,i),C3(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new w3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),lg(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Hc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(ag(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=on(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=xt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(gS.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=on(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return hc(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?ke(r,"emptyColumns"):ee(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=De(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(ee(r,"innerBorderTop"),o=!u):(ke(r,"innerBorderTop"),o=u)}}return o}}function Bi(t,e,n){return e=b3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b3(t){var e=R3(t,"string");return typeof e=="symbol"?e:String(e)}function R3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E3{constructor(e,n,r,i,o,s){Bi(this,"wot",null),Bi(this,"topOverlay",null),Bi(this,"bottomOverlay",null),Bi(this,"inlineStartOverlay",null),Bi(this,"topInlineStartCornerOverlay",null),Bi(this,"bottomInlineStartCornerOverlay",null),Bi(this,"browserLineHeight",void 0),Bi(this,"wtSettings",null),Bi(this,"resizeObserver",new ResizeObserver(c=>{pg(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=on(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:dc(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new y3(...e),this.bottomOverlay=new GK(...e),this.inlineStartOverlay=new h3(...e),this.topInlineStartCornerOverlay=new p3(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new $K(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!Bv())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:f}=h.clone.wtTable;this.eventManager.addEventListener(f,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Ll(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=dc(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return T(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const T3=E3;function LE(t,e,n){return e=_3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _3(t){var e=M3(t,"string");return typeof e=="symbol"?e:String(e)}function M3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A3{constructor(e){LE(this,"settings",{}),LE(this,"defaults",Object.freeze(this.getDefaults())),Ge(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);ls(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ge(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class wS extends kl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=na(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=_l(e,"height",n),o=_l(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const g=parseInt(vo(f,n).height,10);r.removeChild(f),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=us(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}mt(wS,VI);mt(wS,lS);const O3=wS;class P3{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=xt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let f,g;if(a)return dt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(h,o):f=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(i!==r&&(g=_l(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(f,i.clientWidth);const w=e.getSetting("stretchH");return w==="none"||!w?Math.max(f,dt(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return jt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=xt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=dt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ks;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===Ks?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=on(this.domBindings.rootDocument),new AI({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ks;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=on(this.domBindings.rootDocument)),new eS({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(Rn),i=this.createColumnsCalculator(Rn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Ks),this.columnsRenderCalculator=this.createColumnsCalculator(Ks)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Rn),this.columnsVisibleCalculator=this.createColumnsCalculator(Rn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ge(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const x3=P3;class I3 extends aS{constructor(e,n){super(e,new A3(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new O3(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new x3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new u3(this.wtSettings.getSetting("selections")),this.wtEvent=new HI(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new T3(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ge(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),ke(this.wtTable.wtRootElement.parentNode,n),ee(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class CS{constructor(e){e instanceof aS?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new CS(n);return()=>r},this._wot=new I3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function kE(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),f=n||r&&h;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function H3(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const D3=new Map([["mousedown",kE],["mouseover",H3],["touchstart",kE]]);function $E(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;D3.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:fg(t)||t.type==="touchstart",isRightClick:cs(t)})}const ZI=new WeakMap,vS=Symbol("rootInstance");function N3(t){ZI.set(t,!0)}function L3(t){return t===vS}function Ad(t){return ZI.has(t)}function FE(t,e){QI(t,e),e.add(t)}function ys(t,e,n){QI(t,e),e.set(t,n)}function QI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Io(t,e,n){return e=k3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k3(t){var e=$3(t,"string");return typeof e=="symbol"?e:String(e)}function $3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function un(t,e){var n=JI(t,e,"get");return F3(t,n)}function F3(t,e){return e.get?e.get.call(t):e.value}function Sr(t,e,n){var r=JI(t,e,"set");return W3(t,r,n),n}function JI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function W3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var $m=new WeakMap,mh=new WeakMap,ph=new WeakMap,Ui=new WeakMap,$r=new WeakMap,Fm=new WeakMap,Wm=new WeakMap,dC=new WeakSet,WE=new WeakSet;class V3{constructor(e){FE(this,WE),FE(this,dC),Io(this,"hot",void 0),Io(this,"eventManager",void 0),Io(this,"settings",void 0),Io(this,"THEAD",void 0),Io(this,"TBODY",void 0),Io(this,"_wt",void 0),Io(this,"activeWt",void 0),ys(this,$m,{writable:!0,value:0}),ys(this,mh,{writable:!0,value:0}),Io(this,"postponedAdjustElementsSize",!1),ys(this,ph,{writable:!0,value:!1}),ys(this,Ui,{writable:!0,value:void 0}),ys(this,$r,{writable:!0,value:void 0}),ys(this,Fm,{writable:!0,value:0}),ys(this,Wm,{writable:!0,value:0}),this.hot=e,this.eventManager=new pr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),ee(e,"handsontable"),Sr(this,$r,n.createElement("TABLE")),ee(un(this,$r),"htCore"),this.hot.getSettings().tableClassName&&ee(un(this,$r),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Me(un(this,$r),[Ai()]),Me(e,[MG(),Dx(-1),sg(this.hot.countCols()),WG()])),this.THEAD=n.createElement("THEAD"),un(this,$r).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),un(this,$r).appendChild(this.TBODY),this.hot.table=un(this,$r),this.hot.container.insertBefore(un(this,$r),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(Sr(this,ph,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;Jw(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{Sr(this,ph,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{un(this,ph)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&Jw(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&fg(o)&&r.finish(),Sr(this,Ui,!1);const s=ug(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!cs(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&cs(o)&&(r.finish(),Sr(this,Ui,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),Sr(this,Ui,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(un(this,Ui)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const f=on(n);if(n.elementFromPoint(a+f,l)!==c||n.elementFromPoint(a,l+f)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(un(this,$r),"selectstart",o=>{this.settings.fragmentSelection||rf(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:un(this,$r),isDataViewInstance:()=>Ad(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Sr(this,mh,o.length),this.hot.getSettings().ariaTags&&hC(this,dC,e1).call(this)===this.hot.countCols()&&hC(this,WE,B3).call(this,un(this,mh)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Sr(this,$m,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,f=u;Array.isArray(c)&&([h,f]=c);const g=this.hot.getCellMeta(h,f),w=this.hot.colToProp(f);let C=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(C=this.hot.runHooks("beforeValueRender",C,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,C,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,C,g),this.hot.runHooks("afterRenderer",a,l,u,w,C,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&us(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Sr(this,Ui,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Yo(o)&&($E(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Sr(this,Ui,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Yo(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Yo(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Yo(o)&&(un(this,Ui)&&$E(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Yo(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(f)){const[g,w,C,b]=f;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,-1)):C,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new CS(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(rf(e))return!0;const n=ns(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return un(this,Ui)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!De(r,"relative")){ri(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;De(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(ri(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Me(s,...Ai()),Me(a,...Ai())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(De(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):De(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?ga(e,r(n,i)):(ls(e,String.fromCharCode(160)),ee(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Sr(this,Fm,e),Sr(this,Wm,n)}getLastSize(){return{width:un(this,Fm),height:un(this,Wm)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return un(this,$m)}getRowHeadersCount(){return un(this,mh)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function e1(){return parseInt(this.hot.rootElement.getAttribute(sg()[0]),10)}function B3(t){const e=hC(this,dC,e1).call(this)+t;Me(this.hot.rootElement,...sg(e))}const U3=V3,t1="ABCDEFGHIJKLMNOPQRSTUVWXYZ",fC=t1.length;function wg(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%fC,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/fC,10);return n}function G3(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=fC**r*(t1.indexOf(t[n])+1);return e-=1,e}function z3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(wg(i)+(r+1));n.push(o)}return n}function Y3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=wg(i)+(r+1);n.push(o)}return n}function j3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function SS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function yS(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Be(t[0])&&(e=dg(t[0]))),e}function n1(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function r1(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const K3=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:yS,createEmptySpreadsheetData:j3,createSpreadsheetData:z3,createSpreadsheetObjectData:Y3,dataRowToChangesArray:SS,isArrayOfArrays:n1,isArrayOfObjects:r1,spreadsheetColumnIndex:G3,spreadsheetColumnLabel:wg},Symbol.toStringTag,{value:"Module"}));function Jl(t,e,n){return e=X3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X3(t){var e=q3(t,"string");return typeof e=="symbol"?e:String(e)}function q3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Jl(this,"hot",void 0),Jl(this,"data",void 0),Jl(this,"dataType","array"),Jl(this,"colToProp",()=>{}),Jl(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return T(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):ve(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Be(s)||wt(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;ve(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const f=this.getAtPhysicalCell(e,h,s);i?a.push(f):Ed(a,h,f)}})}else Ge(s,(l,u)=>{Ed(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Zr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:Ed(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=eI(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=Zr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return ve(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return yS(this.data)}destroy(){this.data=null,this.hot=null}}const Q3=Z3;function VE(t,e,n){return e=J3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J3(t){var e=eX(t,"string");return typeof e=="symbol"?e:String(e)}function eX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ma{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;VE(this,"indexedValues",[]),VE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,wt(this.initValueOrFn)?ve(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):ve(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mt(ma,sr);function bS(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>wt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function RS(t,e){return mr(t,(n,r)=>e.includes(r)===!1)}class gs extends ma{insert(e,n){this.indexedValues=bS(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=RS(this.indexedValues,e),super.remove(e)}}class Cg extends gs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Gt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function ES(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function mc(t,e){return mr(t,n=>e.includes(n)===!1)}function TS(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function _S(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function tX(t,e,n){return e=nX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nX(t){var e=rX(t,"string");return typeof e=="symbol"?e:String(e)}function rX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vg extends ma{constructor(){super(...arguments),tX(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=mc(this.orderOfIndexes,[e]),wt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=bS(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=_S(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=RS(this.indexedValues,e),this.orderOfIndexes=mc(this.orderOfIndexes,e),this.orderOfIndexes=TS(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Fc extends gs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Gt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const BE=new Map([["indexesSequence",{getListWithInsertedItems:ES,getListWithRemovedItems:mc}],["physicallyIndexed",{getListWithInsertedItems:bS,getListWithRemovedItems:RS}]]),i1=t=>{if(BE.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return BE.get(t)};class o1 extends ma{constructor(){super(e=>e)}insert(e,n){const r=_S(this.indexedValues,n);this.indexedValues=ES(r,e,n),super.insert(e,n)}remove(e){const n=mc(this.indexedValues,e);this.indexedValues=TS(n,e),super.remove(e)}}const UE=new Map([["hiding",Cg],["index",ma],["linkedPhysicalIndexToValue",vg],["physicalIndexToValue",gs],["trimming",Fc]]);function iX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!UE.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(UE.get(t))(e)}function oX(t,e,n){return e=sX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=aX(t,"string");return typeof e=="symbol"?e:String(e)}function aX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let gC=0;class MS{constructor(){oX(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),gC+=1)}unregister(e){const n=this.collection.get(e);ce(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),gC-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ct(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}mt(MS,sr);function lX(){return gC}function Vm(t,e,n){return e=uX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uX(t){var e=cX(t,"string");return typeof e=="symbol"?e:String(e)}function cX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GE extends MS{constructor(e,n){super(),Vm(this,"mergedValuesCache",[]),Vm(this,"aggregationFunction",void 0),Vm(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=ce(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ce(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function hX(t,e,n){dX(t,e),e.set(t,n)}function dX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fX(t,e,n){var r=s1(t,e,"set");return gX(t,r,n),n}function gX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function mX(t,e){var n=s1(t,e,"get");return pX(t,n)}function s1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pX(t,e){return e.get?e.get.call(t):e.value}var Bm=new WeakMap;class a1{constructor(){hX(this,Bm,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(mX(this,Bm)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){fX(this,Bm,e)}}mt(a1,sr);function zE(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function eu(t,e,n){wX(t,e),e.set(t,n)}function wX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yr(t,e){var n=l1(t,e,"get");return CX(t,n)}function CX(t,e){return e.get?e.get.call(t):e.value}function wh(t,e,n){var r=l1(t,e,"set");return vX(t,r,n),n}function l1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ch=new WeakMap,tu=new WeakMap,vh=new WeakMap,Sh=new WeakMap,yh=new WeakMap;class SX{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};eu(this,Ch,{writable:!0,value:new Set}),eu(this,tu,{writable:!0,value:[]}),eu(this,vh,{writable:!0,value:[]}),eu(this,Sh,{writable:!0,value:!1}),eu(this,yh,{writable:!0,value:!1}),wh(this,yh,e??!1)}createObserver(){const e=new a1;return yr(this,Ch).add(e),e.addLocalHook("unsubscribe",()=>{yr(this,Ch).delete(e)}),e._writeInitialChanges(zE(yr(this,tu),yr(this,vh))),e}emit(e){let n=yr(this,vh);(!yr(this,Sh)||yr(this,tu).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(yr(this,yh)):wh(this,tu,new Array(e.length).fill(yr(this,yh))),yr(this,Sh)||(wh(this,Sh,!0),n=yr(this,tu)));const r=zE(n,e);yr(this,Ch).forEach(i=>i._write(r)),wh(this,vh,e)}}function Hn(t,e,n){return e=yX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yX(t){var e=bX(t,"string");return typeof e=="symbol"?e:String(e)}function bX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mC{constructor(){Hn(this,"indexesSequence",new o1),Hn(this,"trimmingMapsCollection",new GE(e=>e.some(n=>n===!0),!1)),Hn(this,"hidingMapsCollection",new GE(e=>e.some(n=>n===!0),!1)),Hn(this,"variousMapsCollection",new MS),Hn(this,"hidingChangesObservable",new SX({initialIndexValue:!1})),Hn(this,"notTrimmedIndexesCache",[]),Hn(this,"notHiddenIndexesCache",[]),Hn(this,"isBatched",!1),Hn(this,"indexesSequenceChanged",!1),Hn(this,"indexesChangeSource",void 0),Hn(this,"trimmedIndexesChanged",!1),Hn(this,"hiddenIndexesChanged",!1),Hn(this,"renderablePhysicalIndexesCache",[]),Hn(this,"fromPhysicalToVisualIndexesCache",new Map),Hn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,iX(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Fc?this.trimmingMapsCollection.register(e,n):n instanceof Cg?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ce(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ce(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ce(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ce(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=mc(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(ES(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ce(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}mt(mC,sr);function RX(t,e){return Ge(e,(n,r)=>{Ct(t[r])&&(t[r]=n)}),t}function u1(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function c1(t){ce(t)&&jv(ft`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function EX(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:TX,getValues:_X}=oi("phraseFormatters");function MX(t,e){TX(t,e)}function AX(){return _X()}MX("pluralize",EX);const h1="ContextMenu:items",We=h1,AS=`${We}.noItems`,OS=`${We}.insertRowAbove`,PS=`${We}.insertRowBelow`,xS=`${We}.insertColumnOnTheLeft`,IS=`${We}.insertColumnOnTheRight`,HS=`${We}.removeRow`,DS=`${We}.removeColumn`,NS=`${We}.undo`,LS=`${We}.redo`,kS=`${We}.readOnly`,$S=`${We}.clearColumn`,FS=`${We}.copy`,WS=`${We}.copyWithHeaders`,VS=`${We}.copyWithGroupHeaders`,BS=`${We}.copyHeadersOnly`,US=`${We}.cut`,GS=`${We}.freezeColumn`,zS=`${We}.unfreezeColumn`,YS=`${We}.mergeCells`,jS=`${We}.unmergeCells`,KS=`${We}.addComment`,XS=`${We}.editComment`,qS=`${We}.removeComment`,ZS=`${We}.readOnlyComment`,QS=`${We}.align`,JS=`${We}.align.left`,ey=`${We}.align.center`,ty=`${We}.align.right`,ny=`${We}.align.justify`,ry=`${We}.align.top`,iy=`${We}.align.middle`,oy=`${We}.align.bottom`,sy=`${We}.borders`,ay=`${We}.borders.top`,ly=`${We}.borders.right`,uy=`${We}.borders.bottom`,cy=`${We}.borders.left`,hy=`${We}.borders.remove`,dy=`${We}.nestedHeaders.insertChildRow`,fy=`${We}.nestedHeaders.detachFromParent`,gy=`${We}.hideColumn`,my=`${We}.showColumn`,py=`${We}.hideRow`,wy=`${We}.showRow`,Yn="Filters:",Wt=`${Yn}conditions`,Sg=`${Wt}.none`,Cy=`${Wt}.isEmpty`,vy=`${Wt}.isNotEmpty`,Sy=`${Wt}.isEqualTo`,yy=`${Wt}.isNotEqualTo`,by=`${Wt}.beginsWith`,Ry=`${Wt}.endsWith`,Ey=`${Wt}.contains`,Ty=`${Wt}.doesNotContain`,OX=`${Wt}.byValue`,_y=`${Wt}.greaterThan`,My=`${Wt}.greaterThanOrEqualTo`,Ay=`${Wt}.lessThan`,Oy=`${Wt}.lessThanOrEqualTo`,Py=`${Wt}.isBetween`,xy=`${Wt}.isNotBetween`,Iy=`${Wt}.after`,Hy=`${Wt}.before`,Dy=`${Wt}.today`,Ny=`${Wt}.tomorrow`,Ly=`${Wt}.yesterday`,ky=`${Yn}labels.filterByCondition`,$y=`${Yn}labels.filterByValue`,Fy=`${Yn}labels.conjunction`,yg=`${Yn}labels.disjunction`,gf=`${Yn}values.blankCells`,Wy=`${Yn}buttons.selectAll`,Vy=`${Yn}buttons.clear`,By=`${Yn}buttons.ok`,Uy=`${Yn}buttons.cancel`,Gy=`${Yn}buttons.placeholder.search`,zy=`${Yn}buttons.placeholder.value`,Yy=`${Yn}buttons.placeholder.secondValue`,jy="CheckboxRenderer:",Ky=`${jy}checked`,Xy=`${jy}unchecked`,PX=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Ky,CHECKBOX_RENDERER_NAMESPACE:jy,CHECKBOX_UNCHECKED:Xy,CONTEXTMENU_ITEMS_ADD_COMMENT:KS,CONTEXTMENU_ITEMS_ALIGNMENT:QS,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:oy,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:ey,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ny,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:JS,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:iy,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ty,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:ry,CONTEXTMENU_ITEMS_BORDERS:sy,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:uy,CONTEXTMENU_ITEMS_BORDERS_LEFT:cy,CONTEXTMENU_ITEMS_BORDERS_RIGHT:ly,CONTEXTMENU_ITEMS_BORDERS_TOP:ay,CONTEXTMENU_ITEMS_CLEAR_COLUMN:$S,CONTEXTMENU_ITEMS_COPY:FS,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:BS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:VS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:WS,CONTEXTMENU_ITEMS_CUT:US,CONTEXTMENU_ITEMS_EDIT_COMMENT:XS,CONTEXTMENU_ITEMS_FREEZE_COLUMN:GS,CONTEXTMENU_ITEMS_HIDE_COLUMN:gy,CONTEXTMENU_ITEMS_HIDE_ROW:py,CONTEXTMENU_ITEMS_INSERT_LEFT:xS,CONTEXTMENU_ITEMS_INSERT_RIGHT:IS,CONTEXTMENU_ITEMS_MERGE_CELLS:YS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:fy,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:dy,CONTEXTMENU_ITEMS_NO_ITEMS:AS,CONTEXTMENU_ITEMS_READ_ONLY:kS,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:ZS,CONTEXTMENU_ITEMS_REDO:LS,CONTEXTMENU_ITEMS_REMOVE_BORDERS:hy,CONTEXTMENU_ITEMS_REMOVE_COLUMN:DS,CONTEXTMENU_ITEMS_REMOVE_COMMENT:qS,CONTEXTMENU_ITEMS_REMOVE_ROW:HS,CONTEXTMENU_ITEMS_ROW_ABOVE:OS,CONTEXTMENU_ITEMS_ROW_BELOW:PS,CONTEXTMENU_ITEMS_SHOW_COLUMN:my,CONTEXTMENU_ITEMS_SHOW_ROW:wy,CONTEXTMENU_ITEMS_UNDO:NS,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:zS,CONTEXTMENU_ITEMS_UNMERGE_CELLS:jS,CONTEXT_MENU_ITEMS_NAMESPACE:h1,FILTERS_BUTTONS_CANCEL:Uy,FILTERS_BUTTONS_CLEAR:Vy,FILTERS_BUTTONS_OK:By,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Gy,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Yy,FILTERS_BUTTONS_PLACEHOLDER_VALUE:zy,FILTERS_BUTTONS_SELECT_ALL:Wy,FILTERS_CONDITIONS_AFTER:Iy,FILTERS_CONDITIONS_BEFORE:Hy,FILTERS_CONDITIONS_BEGINS_WITH:by,FILTERS_CONDITIONS_BETWEEN:Py,FILTERS_CONDITIONS_BY_VALUE:OX,FILTERS_CONDITIONS_CONTAINS:Ey,FILTERS_CONDITIONS_EMPTY:Cy,FILTERS_CONDITIONS_ENDS_WITH:Ry,FILTERS_CONDITIONS_EQUAL:Sy,FILTERS_CONDITIONS_GREATER_THAN:_y,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:My,FILTERS_CONDITIONS_LESS_THAN:Ay,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Oy,FILTERS_CONDITIONS_NAMESPACE:Wt,FILTERS_CONDITIONS_NONE:Sg,FILTERS_CONDITIONS_NOT_BETWEEN:xy,FILTERS_CONDITIONS_NOT_CONTAIN:Ty,FILTERS_CONDITIONS_NOT_EMPTY:vy,FILTERS_CONDITIONS_NOT_EQUAL:yy,FILTERS_CONDITIONS_TODAY:Dy,FILTERS_CONDITIONS_TOMORROW:Ny,FILTERS_CONDITIONS_YESTERDAY:Ly,FILTERS_DIVS_FILTER_BY_CONDITION:ky,FILTERS_DIVS_FILTER_BY_VALUE:$y,FILTERS_LABELS_CONJUNCTION:Fy,FILTERS_LABELS_DISJUNCTION:yg,FILTERS_NAMESPACE:Yn,FILTERS_VALUES_BLANK_CELLS:gf},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const xX={languageCode:"en-US",[AS]:"No available options",[OS]:"Insert row above",[PS]:"Insert row below",[xS]:"Insert column left",[IS]:"Insert column right",[HS]:["Remove row","Remove rows"],[DS]:["Remove column","Remove columns"],[NS]:"Undo",[LS]:"Redo",[kS]:"Read only",[$S]:"Clear column",[QS]:"Alignment",[JS]:"Left",[ey]:"Center",[ty]:"Right",[ny]:"Justify",[ry]:"Top",[iy]:"Middle",[oy]:"Bottom",[GS]:"Freeze column",[zS]:"Unfreeze column",[sy]:"Borders",[ay]:"Top",[ly]:"Right",[uy]:"Bottom",[cy]:"Left",[hy]:"Remove border(s)",[KS]:"Add comment",[XS]:"Edit comment",[qS]:"Delete comment",[ZS]:"Read-only comment",[YS]:"Merge cells",[jS]:"Unmerge cells",[FS]:"Copy",[WS]:["Copy with header","Copy with headers"],[VS]:["Copy with group header","Copy with group headers"],[BS]:["Copy header only","Copy headers only"],[US]:"Cut",[dy]:"Insert child row",[fy]:"Detach from parent",[gy]:["Hide column","Hide columns"],[my]:["Show column","Show columns"],[py]:["Hide row","Hide rows"],[wy]:["Show row","Show rows"],[Sg]:"None",[Cy]:"Is empty",[vy]:"Is not empty",[Sy]:"Is equal to",[yy]:"Is not equal to",[by]:"Begins with",[Ry]:"Ends with",[Ey]:"Contains",[Ty]:"Does not contain",[_y]:"Greater than",[My]:"Greater than or equal to",[Ay]:"Less than",[Oy]:"Less than or equal to",[Py]:"Is between",[xy]:"Is not between",[Iy]:"After",[Hy]:"Before",[Dy]:"Today",[Ny]:"Tomorrow",[Ly]:"Yesterday",[gf]:"Blank cells",[ky]:"Filter by condition",[$y]:"Filter by value",[Fy]:"And",[yg]:"Or",[Wy]:"Select all",[Vy]:"Clear",[By]:"OK",[Uy]:"Cancel",[Gy]:"Search",[zy]:"Value",[Yy]:"Second value",[Ky]:"Checked",[Xy]:"Unchecked"},d1=xX,IX=PX,pC=d1.languageCode,{register:HX,getItem:f1,hasItem:DX,getValues:NX}=oi("languagesDictionaries");g1(d1);function g1(t,e){let n=t,r=e;return Be(t)&&(r=t,n=r.languageCode),LX(n,r),HX(n,Mn(r)),Mn(r)}function LX(t,e){t!==pC&&RX(e,f1(pC))}function m1(t){return qy(t)?Mn(f1(t)):null}function qy(t){return DX(t)}function kX(){return NX()}function p1(t,e,n){const r=m1(t);if(r===null)return null;const i=r[e];if(Ct(i))return null;const o=$X(i,n);return Array.isArray(o)?o[0]:o}function $X(t,e){let n=t;return T(AX(),r=>{n=r(t,e)}),n}function FX(t){let e=u1(t);return qy(e)||(e=pC,c1(t)),e}function WX(t,e,n){return e=VX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VX(t){var e=BX(t,"string");return typeof e=="symbol"?e:String(e)}function BX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UX extends KK{constructor(e,n){super(e,null),WX(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Ao=UX;function Um(t){let{activeHeaderClassName:e,...n}=t;return new Ao({className:e,...n,selectionType:GI})}function GX(t){let{areaCornerVisible:e,...n}=t;return new Ao({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:dS})}function zX(t){let{...e}=t;return new Ao({className:"highlight",...e,selectionType:dS})}function YX(t){let{columnClassName:e,...n}=t;return new Ao({className:e,...n,selectionType:ZK})}function jX(t){let{cellCornerVisible:e,...n}=t;return new Ao({className:"current",headerAttributes:[Dv()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:fS})}function KX(t){let{border:e,visualCellRange:n,...r}=t;return new Ao({...e,...r,selectionType:QK},n)}function XX(t){let{...e}=t;return new Ao({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:XK})}function YE(t){let{headerClassName:e,...n}=t;return new Ao({className:e,...n,selectionType:hS})}function qX(t){let{rowClassName:e,...n}=t;return new Ao({className:e,...n,selectionType:qK})}let w1;function ZX(t,e){QX(t,e),e.add(t)}function QX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kn(t,e,n){return e=JX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JX(t){var e=eq(t,"string");return typeof e=="symbol"?e:String(e)}function eq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var hi=new WeakSet;w1=Symbol.iterator;class tq{constructor(e){ZX(this,hi),Kn(this,"options",void 0),Kn(this,"layerLevel",0),Kn(this,"focus",void 0),Kn(this,"fill",void 0),Kn(this,"layeredAreas",new Map),Kn(this,"areas",new Map),Kn(this,"rowHeaders",new Map),Kn(this,"columnHeaders",new Map),Kn(this,"activeRowHeaders",new Map),Kn(this,"activeColumnHeaders",new Map),Kn(this,"activeCornerHeaders",new Map),Kn(this,"rowHighlights",new Map),Kn(this,"columnHighlights",new Map),Kn(this,"customSelections",[]),this.options=e,this.focus=jX(e),this.fill=XX(e)}isEnabledFor(e,n){let r=e;e===fS&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Gi(this,hi,zi).call(this,this.layeredAreas,GX)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Gi(this,hi,zi).call(this,this.areas,zX)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Gi(this,hi,zi).call(this,this.rowHeaders,YE)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Gi(this,hi,zi).call(this,this.columnHeaders,YE)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Gi(this,hi,zi).call(this,this.activeRowHeaders,Um)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Gi(this,hi,zi).call(this,this.activeColumnHeaders,Um)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Gi(this,hi,zi).call(this,this.activeCornerHeaders,Um)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Gi(this,hi,zi).call(this,this.rowHighlights,qX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Gi(this,hi,zi).call(this,this.columnHighlights,YX)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(KX({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),T(this.areas.values(),e=>void e.clear()),T(this.layeredAreas.values(),e=>void e.clear()),T(this.rowHeaders.values(),e=>void e.clear()),T(this.columnHeaders.values(),e=>void e.clear()),T(this.activeRowHeaders.values(),e=>void e.clear()),T(this.activeColumnHeaders.values(),e=>void e.clear()),T(this.activeCornerHeaders.values(),e=>void e.clear()),T(this.rowHighlights.values(),e=>void e.clear()),T(this.columnHighlights.values(),e=>void e.clear())}[w1](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function zi(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const nq=tq;let C1;function jE(t,e,n){return e=rq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rq(t){var e=iq(t,"string");return typeof e=="symbol"?e:String(e)}function iq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}C1=Symbol.iterator;class oq{constructor(e){jE(this,"ranges",[]),jE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[C1](){return this.ranges[Symbol.iterator]()}}const sq=oq;function nu(t,e){v1(t,e),e.add(t)}function Gm(t,e,n){v1(t,e),e.set(t,n)}function v1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function et(t,e){var n=S1(t,e,"get");return aq(t,n)}function aq(t,e){return e.get?e.get.call(t):e.value}function Zn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function wC(t,e,n){var r=S1(t,e,"set");return lq(t,r,n),n}function S1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var bh=new WeakMap,st=new WeakMap,hs=new WeakMap,zm=new WeakSet,Ym=new WeakSet,CC=new WeakSet,jm=new WeakSet,bs=new WeakSet;class y1{constructor(e,n){nu(this,bs),nu(this,jm),nu(this,CC),nu(this,Ym),nu(this,zm),Gm(this,bh,{writable:!0,value:void 0}),Gm(this,st,{writable:!0,value:void 0}),Gm(this,hs,{writable:!0,value:{x:0,y:0}}),wC(this,bh,e),wC(this,st,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Zn(this,zm,KE).call(this,{x:et(this,st).navigableHeaders()?et(this,st).countRowHeaders():0,y:et(this,st).navigableHeaders()?et(this,st).countColHeaders():0});const i=et(this,st).createCellCoords(e,n);let o=et(this,bh).current().highlight;const s=et(this,st).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Zn(this,CC,b1).call(this),{row:h,col:f}=Zn(this,jm,qE).call(this,o),g=et(this,st).fixedRowsBottom(),w=et(this,st).minSpareRows(),C=et(this,st).minSpareCols(),b=et(this,st).autoWrapRow(),y=et(this,st).autoWrapCol(),_=et(this,st).createCellCoords(h+i.row,f+i.col);if(_.row>=c){const x=Zr(r&&w>0&&g===0),k=_.col+1,U=et(this,st).createCellCoords(_.row-c,k>=u?k-u:k);this.runLocalHooks("beforeColumnWrap",x,Zn(this,bs,Oa).call(this,U),k>=u),x.value?this.runLocalHooks("insertRowRequire",et(this,st).countRenderableRows()):y&&_.assign(U)}else if(_.row<0){const x=Zr(y),k=_.col-1,U=et(this,st).createCellCoords(c+_.row,k<0?u+k:k);this.runLocalHooks("beforeColumnWrap",x,Zn(this,bs,Oa).call(this,U),k<0),y&&_.assign(U)}if(_.col>=u){const x=Zr(r&&C>0),k=_.row+1,U=et(this,st).createCellCoords(k>=c?k-c:k,_.col-u);this.runLocalHooks("beforeRowWrap",x,Zn(this,bs,Oa).call(this,U),k>=c),x.value?this.runLocalHooks("insertColRequire",et(this,st).countRenderableColumns()):b&&_.assign(U)}else if(_.col<0){const x=Zr(b),k=_.row-1,U=et(this,st).createCellCoords(k<0?c+k:k,u+_.col);this.runLocalHooks("beforeRowWrap",x,Zn(this,bs,Oa).call(this,U),k<0),b&&_.assign(U)}const{rowDir:O,colDir:I}=Zn(this,Ym,XE).call(this,_);a=O,l=I,o=Zn(this,bs,Oa).call(this,_)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Zn(this,zm,KE).call(this,{x:et(this,st).navigableHeaders()?et(this,st).countRowHeaders():0,y:et(this,st).navigableHeaders()?et(this,st).countColHeaders():0});const r=et(this,st).createCellCoords(e,n),i=et(this,bh).current(),o=et(this,st).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Zn(this,jm,qE).call(this,i.to),h=et(this,st).createCellCoords(u+r.row,c+r.col),{rowDir:f,colDir:g}=Zn(this,Ym,XE).call(this,h);a=f,l=g;const w=Zn(this,bs,Oa).call(this,h);r.row===0&&r.col!==0?s.col=w.col:r.row!==0&&r.col===0?s.row=w.row:(s.row=w.row,s.col=w.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function KE(t){let{x:e,y:n}=t;wC(this,hs,{x:e,y:n})}function XE(t){const{width:e,height:n}=Zn(this,CC,b1).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function b1(){return{width:et(this,hs).x+et(this,st).countRenderableColumns(),height:et(this,hs).y+et(this,st).countRenderableRows()}}function qE(t){const{row:e,col:n}=et(this,st).visualToRenderableCoords(t);return et(this,st).createCellCoords(et(this,hs).y+e,et(this,hs).x+n)}function Oa(t){const e=t.clone();return e.col=t.col-et(this,hs).x,e.row=t.row-et(this,hs).y,et(this,st).renderableToVisualCoords(e)}mt(y1,sr);const uq=y1,bg=0,Rg=1,R1=2,Zy=3,cq=[Zy,R1],hq=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Km=Symbol("root"),ZE=Symbol("child");function Al(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Km;if(e!==Km&&e!==ZE)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Km;let i=bg;if(n){const o=t[0];t.length===0?i=Rg:r&&o instanceof rS?i=Zy:r&&Array.isArray(o)?i=Al(o,ZE):t.length>=2&&t.length<=4&&!t.some((a,l)=>!hq[l].includes(typeof a))&&(i=R1)}return i}function pc(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!cq.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Zy;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ct(u)&&(u=a),Ct(c)&&(c=l),!r){const g=a,w=l,C=u,b=c;a=Math.min(g,C),l=Math.min(w,b),u=Math.max(g,C),c=Math.max(w,b)}const h=e(a,l),f=e(u,c);return n(h,h,f)}}function dq(t){const e=Al(t.getSelected());if(e===bg||e===Rg)return[];const n=pc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;T(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Gt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function fq(t){const e=Al(t.getSelected());if(e===bg||e===Rg)return[];const n=pc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;T(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Gt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function gq(t,e,n){mq(t,e),e.set(t,n)}function mq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(t,e,n){return e=pq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pq(t){var e=wq(t,"string");return typeof e=="symbol"?e:String(e)}function wq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QE(t,e,n){var r=E1(t,e,"set");return Cq(t,r,n),n}function Cq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function JE(t,e){var n=E1(t,e,"get");return vq(t,n)}function E1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vq(t,e){return e.get?e.get.call(t):e.value}var ru=new WeakMap;class T1{constructor(e,n){var r=this;Ho(this,"settings",void 0),Ho(this,"tableProps",void 0),Ho(this,"inProgress",!1),Ho(this,"selectedRange",new sq((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Ho(this,"highlight",void 0),Ho(this,"transformation",void 0),Ho(this,"selectedByRowHeader",new Set),Ho(this,"selectedByColumnHeader",new Set),gq(this,ru,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new nq({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Dv()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new uq(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ct(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ct(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(fS,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(T(this.highlight.getAreas(),_=>void _.clear()),T(this.highlight.getLayeredAreas(),_=>void _.clear()),T(this.highlight.getRowHeaders(),_=>void _.clear()),T(this.highlight.getColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveRowHeaders(),_=>void _.clear()),T(this.highlight.getActiveColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveCornerHeaders(),_=>void _.clear()),T(this.highlight.getRowHighlights(),_=>void _.clear()),T(this.highlight.getColumnHighlights(),_=>void _.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),w=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),b=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),f.clear(),g.clear(),w.clear(),C.clear(),b.clear(),y.clear(),this.highlight.isEnabledFor(dS,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const _=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(_.from).commit().syncWith(_),this.highlight.createLayeredArea().add(_.from).commit().syncWith(_),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(hS,s.highlight)){if(!s.isSingleHeader()){const I=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),x=this.tableProps.createCellCoords(s.to.row,-1),k=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),U=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(I).commit(),f.add(k).commit(),b.add(I).commit(),y.add(k).commit()):(h.add(I).add(x).commit(),f.add(k).add(U).commit(),b.add(I).add(x).commit(),y.add(k).add(U).commit())}const _=!JE(this,ru)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),O=!JE(this,ru)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());_&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),O&&w.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),_&&O&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Zr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:g}=i;QE(this,ru,g),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords(ir(f.row,u,o-1),ir(f.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),C=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.finish(),QE(this,ru,!1)}selectCells(e){var n=this;const r=Al(e);if(r===Rg)return!1;if(r===bg)throw new Error(ft`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=pc(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),T(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const g=l===0?0:ir(r,u,-1),w=s-1,C=this.tableProps.createCellCoords(g,i),b=this.tableProps.createCellCoords(w,o),y=this.tableProps.createCellCoords(ir(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",C,b,y),C.row=g,b.row=w,this.setRangeStartOnly(C,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(b),this.runLocalHooks("afterSelectColumns",C,b,y),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:ir(r,a,-1),f=o-1,g=this.tableProps.createCellCoords(e,h),w=this.tableProps.createCellCoords(n,f),C=this.tableProps.createCellCoords(e,ir(r,a,o-1));this.runLocalHooks("beforeSelectRows",g,w,C),g.col=h,w.col=f,this.setRangeStartOnly(g,void 0,C),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",g,w,C),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),f.commit(),g.commit()}this.highlight.useLayerLevel(r)}}mt(T1,sr);const Sq=T1,e0=/^(\r\n|\n\r|\r|\n)/,yq=/^[^\t\r\n]+/,t0=/^\t/;function bq(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(t0))t=t.replace(t0,""),n+=1,e[r][n]="";else if(t.match(e0))t=t.replace(e0,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(yq);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function Gu(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Rs(t,e,n){return e=Rq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rq(t){var e=Eq(t,"string");return typeof e=="symbol"?e:String(e)}function Eq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wl{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Rs(this,"hot",void 0),Rs(this,"metaManager",void 0),Rs(this,"tableMeta",void 0),Rs(this,"dataSource",void 0),Rs(this,"duckSchema",void 0),Rs(this,"colToPropCache",void 0),Rs(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=dg(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Be(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return yS(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ge(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ce(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ce(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ml(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<n&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=Mn(this.getSchema()):(w=[],ve(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},Nc(w,this.getSchema())),f.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",g,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let f=this.hot.countCols(),g=0,w=c;i==="end"&&(w=Math.min(w+1,a));const C=w;for(;g<n&&f<s;){if(typeof l!="number"||l>=f)if(h>0)for(let y=0;y<h;y+=1)typeof o[y]>"u"&&(o[y]=[]),o[y].push(null);else o.push([null]);else for(let y=0;y<h;y++)o[y].splice(w,0,null);g+=1,w+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):r!=="auto"&&this.metaManager.createColumn(C,n));const b=this.hot.toVisualColumn(C);return this.hot.runHooks("afterCreateCol",b,g,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:C}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ce(this.tableMeta.columns)||ce(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];jw(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return _x(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];jw(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Pt(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=Zr(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=Zr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Pt(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,wl.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===wl.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=f&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,n){return Gu(this.getRange(e,n,wl.DESTINATION_RENDERER))}getCopyableText(e,n){return Gu(this.getRange(e,n,wl.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const Tq=wl,{register:_q,getItem:Mq,hasItem:_1,getNames:Aq,getValues:fle}=oi("cellTypes");function Qy(t){if(!_1(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Mq(t)}function br(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&er(t,n),r&&yi(t,r),i&&pl(t,i),_q(t,e)}function Oq(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Pt(e,t)}function Eg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Qy(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ge(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Be(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ge(r,(o,s)=>{if(Oq(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Kt(t,i)}function Pq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}_o(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Od(t){return Number.isInteger(t)&&t>=0}function Pd(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Rh(t){return t==null}const M1=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),en(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),en(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),hg(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function n0(t,e,n){return e=xq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xq(t){var e=Iq(t,"string");return typeof e=="symbol"?e:String(e)}function Iq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hq(){return class{}}class Dq{constructor(e){n0(this,"metaCtor",Hq()),n0(this,"meta",void 0),this.meta=this.metaCtor.prototype,Kt(this.meta,M1()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Kt(this.meta,e),Eg(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Nq(t,e,n){return e=Lq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lq(t){var e=kq(t,"string");return typeof e=="symbol"?e:String(e)}function kq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $q{constructor(e){Nq(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Kt(this.meta,e),Eg(this.meta,e,e)}}let A1;function Eh(t,e,n){return e=Fq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fq(t){var e=Wq(t,"string");return typeof e=="symbol"?e:String(e)}function Wq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}A1=Symbol.iterator;class mf{constructor(e){Eh(this,"valueFactory",void 0),Eh(this,"data",[]),Eh(this,"index",[]),Eh(this,"holes",new Set),this.valueFactory=e}obtain(e){Pd(()=>Od(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Pd(()=>Od(e)||Rh(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Rh(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Pd(()=>Od(e)||Rh(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Rh(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return mr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[A1](){return this.entries()}}function r0(t,e,n){return e=Vq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vq(t){var e=Bq(t,"string");return typeof e=="symbol"?e:String(e)}function Bq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Uq=["data","width"];class Gq{constructor(e){r0(this,"globalMeta",void 0),r0(this,"metas",new mf(()=>this._createMeta())),this.globalMeta=e,this.metas=new mf(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Kt(r,n),Eg(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Pq(this.globalMeta.getMetaConstructor(),Uq).prototype}}function i0(t,e,n){return e=zq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zq(t){var e=Yq(t,"string");return typeof e=="symbol"?e:String(e)}function Yq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jq{constructor(e){i0(this,"columnMeta",void 0),i0(this,"metas",new mf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Kt(i,r),Eg(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){Pd(()=>Od(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new mf(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class O1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Dq(e),this.tableMeta=new $q(this.globalMeta),this.columnMeta=new Gq(this.globalMeta),this.cellMeta=new jq(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mt(O1,sr);function o0(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=_n(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":wt(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Tq(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let C,b=0,y=0;for(b=0,y=f.startRows;b<y;b++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)C=Mn(w),t.push(C);else if(i.dataType==="array")C=Mn(w[0]),t.push(C);else{C=[];for(let _=0,O=f.startCols;_<O;_++)C.push(null);t.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Me(i.rootElement,[Dx(-1),sg(i.countCols()+(i.view?i.countRowHeaders():0))])}function s0(t,e,n){return e=Kq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kq(t){var e=Xq(t,"string");return typeof e=="symbol"?e:String(e)}function Xq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qq{constructor(e){s0(this,"metaManager",void 0),s0(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),me.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Pt(e,"type")?e.type:null;let c=wt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Xm(t,e,n){return e=Zq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zq(t){var e=Qq(t,"string");return typeof e=="symbol"?e:String(e)}function Qq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jq{constructor(e){Xm(this,"metaManager",void 0),Xm(this,"usageTracker",new Set),Xm(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const P1="gridDefault",Jy="editorManager.handlingEditor",e4={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},t4={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},n4={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},r4={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Hr(e))}};function i4(){return[e4,t4,n4,r4]}const o4={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},s4={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},a4={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},l4={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},u4={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},c4={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},h4={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},d4={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},f4={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},g4={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},m4={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},p4={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},w4={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},C4={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function v4(){return[o4,s4,a4,l4,u4,c4,h4,d4,f4,g4,m4,p4,w4,C4]}const S4={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},y4={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},b4={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},R4={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},E4={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},T4={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},_4={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},M4={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},A4={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},O4={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},P4={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},x4={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},I4={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},H4={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},D4={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},N4={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function L4(){return[S4,y4,b4,R4,E4,T4,_4,M4,A4,O4,P4,x4,I4,H4,D4,N4]}const k4={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},$4={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},F4={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},W4={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},V4={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},B4=[...i4(),...v4(),...L4(),k4,$4,F4,W4,V4];function x1(t){const e={};return B4.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function U4(t){const e=t.getShortcutManager().addContext("editor"),n=x1(t),r={group:Jy};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function G4(t){const e=t.getShortcutManager().addContext("grid"),n=x1(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ce(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:P1};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Jy,runOnlyIf:()=>ce(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function z4(t){[U4,G4].forEach(e=>e(t))}function Y4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=a0(t),i=a0(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function a0(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Me(n,[Ai(),To()]),n}function j4(t){let e;const{activate:n,deactivate:r}=Y4(t,{onFocusFromTop(){var u;const c=(u=e)!==null&&u!==void 0?u:l0(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_above",c),t.selectCell(c.row,c.col)),t.listen()},onFocusFromBottom(){var u;const c=(u=e)!==null&&u!==void 0?u:u0(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_below",c),t.selectCell(c.row,c.col)),t.listen()}}),i={wrapped:!1,flipped:!1};let o=!0,s=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(u,c,h,f,g)=>{if(s&&i.wrapped&&i.flipped&&(g.value=!0),o){var w;e=(w=t.getSelectedRangeLast())===null||w===void 0?void 0:w.highlight}}),t.addHook("beforeRowWrap",(u,c,h)=>{i.wrapped=!0,i.flipped=h});function a(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}const l={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:P1,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...l,callback:()=>{s=!0,t.getSelectedRangeLast()&&!t.getSettings().tabNavigation&&(o=!1)},position:"before"},{...l,callback:u=>{const{tabNavigation:c,autoWrapRow:h}=t.getSettings();if(s=!1,o=!0,!c||!t.selection.isSelected()||h&&i.wrapped&&i.flipped||!h&&i.wrapped)return h&&i.wrapped&&i.flipped&&(e=u.shiftKey?l0(t):u0(t)),a(),!1;u.preventDefault()},position:"after"}])}function l0(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function u0(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const c0=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Th=t=>t.map(e=>{const n=e.toLowerCase();return c0.has(n)?c0.get(n):n}).sort().join("+"),K4=t=>t.split("+"),h0=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),X4=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),qm=t=>{let{key:e,code:n}=t,r=e;return h0.test(n)?r=n.replace(h0,"$1"):X4.has(n)&&(r=n),r.toLowerCase()},I1=Symbol("shortcut-context");function H1(t){return Be(t)&&t.__kindOf===I1}const q4=t=>{const e=mg({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:g=!0,stopPropagation:w=!1,relativeToGroup:C,position:b,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ct(c))throw new Error("You need to define the shortcut's group.");if(wt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ft`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:u,group:c,runOnlyIf:h,captureCtrl:f,preventDefault:g,stopPropagation:w};ce(C)&&([_.relativeToGroup,_.position]=[C,b]),H1(y)&&(_.forwardToContext=y),l.forEach(O=>{const I=Th(O);if(e.hasItem(I)){const k=e.getItem(I);let U=k.findIndex(Z=>Z.group===C);U!==-1?b==="before"?U-=1:U+=1:U=k.length,k.splice(U,0,_)}else e.addItem(I,[_])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ge(u,(h,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},i=l=>{const u=Th(l);e.removeItem(u)};return{__kindOf:I1,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Th(l),c=e.getItem(u);return ce(c)?c.slice():[]},hasShortcut:l=>{const u=Th(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,f]=c;const g=f.filter(w=>w.group!==l);g.length===0?i(K4(h)):(f.length=0,f.push(...g))})}}};function Z4(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Q4=["meta","alt","shift","control"],iu=Z4();let _h=0;function J4(t,e,n,r,i){const o=g=>Q4.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return g.altKey&&C.push("alt"),w&&(g.ctrlKey||g.metaKey)?C.push("control/meta"):(g.ctrlKey&&C.push("control"),g.metaKey&&C.push("meta")),g.shiftKey&&C.push("shift"),C},a=g=>{if(e(g)===!1)return;const w=n(g);if(g.keyCode===229||w===!1||Yo(g))return;const C=qm(g);let b=[];o(C)||(b=s(g));const y=[C].concat(b);!i(g,y)&&(fc()&&b.includes("meta")||!fc()&&b.includes("control"))&&i(g,[C].concat(s(g,!0))),r(g)},l=g=>{const w=qm(g);o(w)&&iu.press(w)},u=g=>{const w=qm(g);o(w)&&iu.release(w)},c=()=>{iu.releaseAll()};return{mount:()=>{let g=t;for(_h+=1;g;)_h===1&&(g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("keyup",u)),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=cc(g)},unmount:()=>{let g=t;for(_h-=1;g;)_h===0&&(g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("keyup",u)),g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=cc(g)},isPressed:g=>iu.isPressed(g),releasePressedKeys:()=>iu.releaseAll()}}const e6=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=mg({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const C=q4(w);return o.addItem(w,C),C},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(ft`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let h=!1;const f=function(w,C){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=H1(b)?b:u(b);let _=!1;if(!y.hasShortcut(C))return _;const O=y.getShortcuts(C);for(let I=0;I<O.length;I++){const{callback:x,runOnlyIf:k,preventDefault:U,stopPropagation:Z,captureCtrl:z,forwardToContext:K}=O[I];if(k(w)===!0){if(h=z,_=x(w,C)===!1,h=!1,U&&w.preventDefault(),Z&&(Hr(w),w.stopPropagation()),_)break;K&&f(w,C,K)}}return _},g=J4(e,n,r,i,f);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let Zm=null;const Qm=new Map;function D1(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new pr(s);let l,u,c,h,f,g=!0;L3(i)&&N3(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",C=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=FX(e.language);const b=new O1(s,e,[qq,Jq]),y=b.getTableMeta(),_=b.getGlobalMeta(),O=mg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Ad(this)&&Px(e.licenseKey,t),this.guid=`ht_${Ov()}`,Qm.set(this.guid,this),this.columnIndexMapper=new mC,this.rowIndexMapper=new mC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterRowSequenceChange",d)}),u=new Q3(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const I=d=>{const{row:m,col:p}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p)},x=d=>{const{row:m,col:p}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?s.columnIndexMapper.getVisualFromRenderableIndex(p):p)};let k=new Sq(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:d=>l.propToCol(d),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(d,m)=>s._createCellCoords(d,m),createCellRange:(d,m,p)=>s._createCellRange(d,m,p),visualToRenderableCoords:I,renderableToVisualCoords:x,isDisabledCellSelection:(d,m)=>d<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(d,m).disableVisualSelection});this.selection=k;const U=d=>{let{hiddenIndexesChanged:m}=d;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",U),this.rowIndexMapper.addLocalHook("cacheUpdated",U),this.selection.addLocalHook("afterSetRangeEnd",d=>{const m=Zr(!1),p=this.selection.getSelectedRange(),{from:E,to:M}=p.current(),P=p.size()-1;this.runHooks("afterSelection",E.row,E.col,M.row,M.col,m,P),this.runHooks("afterSelectionByProp",E.row,s.colToProp(E.col),M.row,s.colToProp(M.col),m,P);let Y=!0;o&&(Y=!1),m.isTouched()&&(Y=!m.value);const B=this.selection.selectedRange.current(),q=this.selection.isSelectedByAnyHeader(),J=this.selection.isSelectedByRowHeader(),X=this.selection.isSelectedByColumnHeader();if(Y!==!1)if(q)J?this.scrollViewportTo({row:d.row}):X&&this.scrollViewportTo({col:d.col});else if(B&&!this.selection.isMultiple()){const{row:fe,col:Oe}=B.from;fe<0&&Oe>=0?this.scrollViewportTo({col:Oe}):Oe<0&&fe>=0?this.scrollViewportTo({row:fe}):this.scrollViewportTo({row:fe,col:Oe})}else this.scrollViewportTo(d.toObject());J&&X?ee(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(ke(this.rootElement,"ht__selection--columns"),ee(this.rootElement,"ht__selection--rows")):X?(ke(this.rootElement,"ht__selection--rows"),ee(this.rootElement,"ht__selection--columns")):ke(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",d=>{const m=d.length-1,{from:p,to:E}=d[m];this.runHooks("afterSelectionEnd",p.row,p.col,E.row,E.col,m),this.runHooks("afterSelectionEndByProp",p.row,s.colToProp(p.col),E.row,s.colToProp(E.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",d=>{const m=this.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),ke(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",d=>this.alter("insert_row_above",d,1,"auto")).addLocalHook("insertColRequire",d=>this.alter("insert_col_start",d,1,"auto")),c={alter(d,m){var p,E;let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,P=arguments.length>3?arguments[3]:void 0,Y=arguments.length>4?arguments[4]:void 0;const B=q=>{if(q.length===0)return[];const J=[...q];return J.sort((fe,Oe)=>{let[Ee]=fe,[Pe]=Oe;return Ee===Pe?0:Ee>Pe?1:-1}),Gt(J,(fe,Oe)=>{let[Ee,Pe]=Oe;const j=fe[fe.length-1],[Ke,$e]=j,ye=Ke+$e;if(Ee<=ye){const He=Math.max(Pe-(ye-Ee),0);j[1]+=He}else fe.push([Ee,Pe]);return fe},[J[0]])};switch(d){case"insert_row_below":case"insert_row_above":const q=s.countSourceRows();if(y.maxRows===q)return;const J=d==="insert_row_below"?"below":"above";m=(p=m)!==null&&p!==void 0?p:J==="below"?q:0;const{delta:X,startPhysicalIndex:fe}=l.createRow(m,M,{source:P,mode:J});if(X){const $e=k.selectedRange.current(),ye=$e==null?void 0:$e.from,He=ye==null?void 0:ye.row,Re=s.toVisualRow(fe);if(k.isSelectedByCorner())k.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ce(He)&&He>=Re){const{row:v,col:S}=$e.to;let A=ye.col;k.isSelectedByRowHeader()&&(A=-1),k.getSelectedRange().pop(),k.setRangeStartOnly(s._createCellCoords(He+X,A),!0),k.setRangeEnd(s._createCellCoords(v+X,S))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Oe=d==="insert_col_end"?"end":"start";m=(E=m)!==null&&E!==void 0?E:Oe==="end"?s.countSourceCols():0;const{delta:Ee,startPhysicalIndex:Pe}=l.createCol(m,M,{source:P,mode:Oe});if(Ee){if(Array.isArray(y.colHeaders)){const v=[s.toVisualColumn(Pe),0];v.length+=Ee,Array.prototype.splice.apply(y.colHeaders,v)}const $e=k.selectedRange.current(),ye=$e==null?void 0:$e.from,He=ye==null?void 0:ye.col,Re=s.toVisualColumn(Pe);if(k.isSelectedByCorner())k.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ce(He)&&He>=Re){const{row:v,col:S}=$e.to;let A=ye.row;k.isSelectedByColumnHeader()&&(A=-1),k.getSelectedRange().pop(),k.setRangeStartOnly(s._createCellCoords(A,He+Ee),!0),k.setRangeEnd(s._createCellCoords(v,S+Ee))}else s._refreshBorders()}break;case"remove_row":const j=$e=>{let ye=0;T($e,He=>{let[Re,v]=He;const S=en(Re)?s.countRows()-1:Math.max(Re-ye,0);if(Number.isInteger(Re)&&(Re=Math.max(Re-ye,0)),!l.removeRow(Re,v,P))return;const W=s.countRows(),H=y.fixedRowsTop;H>=S+1&&(y.fixedRowsTop-=Math.min(v,H-S));const F=y.fixedRowsBottom;F&&S>=W-F&&(y.fixedRowsBottom-=Math.min(v,F)),ye+=v})};Array.isArray(m)?j(B(m)):j([[m,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Ke=$e=>{let ye=0;T($e,He=>{let[Re,v]=He;const S=en(Re)?s.countCols()-1:Math.max(Re-ye,0);let A=s.toPhysicalColumn(S);if(Number.isInteger(Re)&&(Re=Math.max(Re-ye,0)),!l.removeCol(Re,v,P))return;const H=y.fixedColumnsStart;H>=S+1&&(y.fixedColumnsStart-=Math.min(v,H-S)),Array.isArray(y.colHeaders)&&(typeof A>"u"&&(A=-1),y.colHeaders.splice(A,v)),ye+=v})};Array.isArray(m)?Ke(B(m)):Ke([[m,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${d}"`)}Y||c.adjustRowsAndCols()},adjustRowsAndCols(){const d=y.minRows,m=y.minSpareRows,p=y.minCols,E=y.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&k.deselect(),d){const M=s.countRows();M<d&&l.createRow(M,d-M,{source:"auto"})}if(m){const M=s.countEmptyRows(!0);if(M<m){const P=m-M,Y=Math.min(P,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),Y,{source:"auto"})}}{let M;(p||E)&&(M=s.countEmptyCols(!0));let P=s.countCols();if(p&&!y.columns&&P<p){const Y=p-P;M+=Y,l.createCol(P,Y,{source:"auto"})}if(E&&!y.columns&&s.dataType==="array"&&M<E){P=s.countCols();const Y=E-M,B=Math.min(Y,y.maxCols-P);l.createCol(P,B,{source:"auto"})}}if(k.isSelected()){const M=s.countRows(),P=s.countCols();T(k.selectedRange,Y=>{let B=!1,q=Y.from.row,J=Y.from.col,X=Y.to.row,fe=Y.to.col;q>M-1?(q=M-1,B=!0,X>q&&(X=q)):X>M-1&&(X=M-1,B=!0,q>X&&(q=X)),J>P-1?(J=P-1,B=!0,fe>J&&(fe=J)):fe>P-1&&(fe=P-1,B=!0,J>fe&&(J=fe)),B&&s.selectCell(q,J,X,fe)})}s.view&&s.view.adjustElementsSize()},populateFromArray(d,m,p,E,M){let P,Y,B,q;const J=[],X={},fe=[],Oe=d.row,Ee=d.col;if(Y=m.length,Y===0)return!1;let Pe=0,j=0;switch(Be(p)&&(Pe=p.col-Ee+1,j=p.row-Oe+1),M){case"shift_down":const Ke=Wu(m),$e=Ke.length,ye=Math.max($e,Pe),He=s.getData().slice(Oe),Re=Wu(He).slice(Ee,Ee+ye);for(B=0;B<ye;B+=1)if(B<$e){for(P=0,Y=Ke[B].length;P<j-Y;P+=1)Ke[B].push(Ke[B][P%Y]);B<Re.length?fe.push(Ke[B].concat(Re[B])):fe.push(Ke[B].concat(new Array(He.length).fill(null)))}else fe.push(Ke[B%$e].concat(Re[B]));s.populateFromArray(Oe,Ee,Wu(fe));break;case"shift_right":const v=m.length,S=Math.max(v,j),A=s.getData().slice(Oe).map(G=>G.slice(Ee));for(P=0;P<S;P+=1)if(P<v){for(B=0,q=m[P].length;B<Pe-q;B+=1)m[P].push(m[P][B%q]);if(P<A.length)for(let G=0;G<A[P].length;G+=1)m[P].push(A[P][G]);else m[P].push(...new Array(A[0].length).fill(null))}else m.push(m[P%Y].slice(0,S).concat(A[P]));s.populateFromArray(Oe,Ee,m);break;case"overwrite":default:X.row=d.row,X.col=d.col;let W=0,H=0,F=!0,D;const N=function(se){let ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const be=m[se%m.length];return ge!==null?be[ge%be.length]:be},V=m.length,$=p?p.row-d.row+1:0;for(p?Y=$:Y=Math.max(V,$),P=0;P<Y&&!(p&&X.row>p.row&&$>V||!y.allowInsertRow&&X.row>s.countRows()-1||X.row>=y.maxRows);P++){const G=P-W,se=N(G).length,ge=p?p.col-d.col+1:0;if(p?q=ge:q=Math.max(se,ge),X.col=d.col,D=s.getCellMeta(X.row,X.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&D.skipRowOnPaste){W+=1,X.row+=1,Y+=1;continue}for(H=0,B=0;B<q&&!(p&&X.col>p.col&&ge>se||!y.allowInsertColumn&&X.col>s.countCols()-1||X.col>=y.maxCols);B++){if(D=s.getCellMeta(X.row,X.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&D.skipColumnOnPaste){H+=1,X.col+=1,q+=1;continue}if(D.readOnly&&E!=="UndoRedo.undo"){X.col+=1;continue}const be=B-H;let xe=N(G,be),Ve=s.getDataAtCell(X.row,X.col);if(xe!==null&&typeof xe=="object")if(Array.isArray(xe)&&Ve===null&&(Ve=[]),Ve===null||typeof Ve!="object")F=!1;else{const St=Ml(Array.isArray(Ve)?Ve:Ve[0]||Ve),Qe=Ml(Array.isArray(xe)?xe:xe[0]||xe);hg(St,Qe)||Array.isArray(St)&&Array.isArray(Qe)?xe=Mn(xe):F=!1}else Ve!==null&&typeof Ve=="object"&&(F=!1);F&&J.push([X.row,X.col,xe]),F=!0,X.col+=1}X.row+=1}s.setDataAtCell(J,null,null,E||"populateFromArray");break}}};function Z(d){const m=u1(d);qy(m)?(s.runHooks("beforeLanguageChange",m),_.language=m,s.runHooks("afterLanguageChange",m)):c1(d)}function z(d,m){const p=d==="className"?s.rootElement:s.table;if(g)ee(p,m);else{let E=[],M=[];_[d]&&(E=Array.isArray(_[d])?_[d]:Xw(_[d])),m&&(M=Array.isArray(m)?m:Xw(m));const P=Kw(E,M),Y=Kw(M,E);P.length&&ke(p,P),Y.length&&ee(p,Y)}_[d]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(co()||zv())&&ee(s.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new U3(this),h=Qz.getInstance(s,y,k),f=new tY(s),Ad(this)&&j4(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&Yx(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function K(){let d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function te(d){const m=d.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):d}function oe(d,m,p){if(!d.length)return;const E=s.getActiveEditor(),M=new K;let P=!0;M.onQueueEmpty=Y=>{E&&P&&E.cancelChanges(),p(Y)};for(let Y=d.length-1;Y>=0;Y--){const[B,q,,J]=d[Y],X=l.propToCol(q),fe=s.getCellMeta(B,X);fe.type==="numeric"&&typeof J=="string"&&wI(J)&&(d[Y][3]=te(J)),s.getCellValidator(fe)&&(M.addValidatorToQueue(),s.validateCell(d[Y][3],fe,function(Oe,Ee){return function(Pe){if(typeof Pe!="boolean")throw new Error("Validation error: result is not boolean");if(Pe===!1&&Ee.allowInvalid===!1){P=!1,d.splice(Oe,1),Ee.valid=!0;const j=s.getCell(Ee.visualRow,Ee.visualCol);j!==null&&ke(j,y.invalidCellClassName)}M.removeValidatorFormQueue()}}(Y,fe),m))}M.checkIfQueueIsEmpty()}function ie(d,m){let p=d.length-1;if(p<0)return;for(;p>=0;p--){let M=!1;if(d[p]===null){d.splice(p,1);continue}if(!((d[p][2]===null||d[p][2]===void 0)&&(d[p][3]===null||d[p][3]===void 0))){if(y.allowInsertRow)for(;d[p][0]>s.countRows()-1;){const{delta:P}=l.createRow(void 0,void 0,{source:m});if(P===0){M=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(d[p][1])>s.countCols()-1;){const{delta:P}=l.createCol(void 0,void 0,{source:m});if(P===0){M=!0;break}}M||l.set(d[p][0],d[p][1],d[p][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",d,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",d,m||"edit");const E=s.getActiveEditor();E&&ce(E.refreshValue)&&E.refreshValue()}this._createCellCoords=function(d,m){return s.view._wt.createCellCoords(d,m)},this._createCellRange=function(d,m,p){return s.view._wt.createCellRange(d,m,p)},this.validateCell=function(d,m,p,E){let M=s.getCellValidator(m);function P(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(Y);return}const q=m.visualCol,J=m.visualRow,X=s.getCell(J,q,!0);if(X&&X.nodeName!=="TH"){const fe=s.rowIndexMapper.getRenderableFromVisualIndex(J),Oe=s.columnIndexMapper.getRenderableFromVisualIndex(q);s.view._wt.getSetting("cellRenderer",fe,Oe,X)}p(Y)}Ox(M)&&(M=function(Y){return function(B,q){q(Y.test(B))}}(M)),wt(M)?(d=s.runHooks("beforeValidate",d,m.visualRow,m.prop,E),s._registerImmediate(()=>{M.call(m,d,Y=>{s&&(Y=s.runHooks("afterValidate",Y,d,m.visualRow,m.prop,E),m.valid=Y,P(Y),s.runHooks("postAfterValidate",Y,d,m.visualRow,m.prop,E))})})):s._registerImmediate(()=>{m.valid=!0,P(m.valid,!1)})};function he(d,m,p){return Array.isArray(d)?d:[[d,m,p]]}function Te(d,m){const p=s.getActiveEditor(),E=s.runHooks("beforeChange",d,m||"edit"),M=d.filter(P=>P!==null);return E===!1||M.length===0?(p&&p.cancelChanges(),[]):M}this.setDataAtCell=function(d,m,p,E){const M=he(d,m,p),P=[];let Y=E,B,q,J;for(B=0,q=M.length;B<q;B++){if(typeof M[B]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M[B][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M[B][1]>=this.countCols()?J=M[B][1]:J=l.colToProp(M[B][1]),P.push([M[B][0],J,u.getAtCell(this.toPhysicalRow(M[B][0]),M[B][1]),M[B][2]])}!Y&&typeof d=="object"&&(Y=m);const X=Te(P,E);s.runHooks("afterSetDataAtCell",X,Y),oe(X,Y,()=>{ie(X,Y)})},this.setDataAtRowProp=function(d,m,p,E){const M=he(d,m,p),P=[];let Y=E,B,q;for(B=0,q=M.length;B<q;B++)P.push([M[B][0],M[B][1],u.getAtCell(this.toPhysicalRow(M[B][0]),M[B][1]),M[B][2]]);!Y&&typeof d=="object"&&(Y=m);const J=Te(P,E);s.runHooks("afterSetDataAtRowProp",J,Y),oe(J,Y,()=>{ie(J,Y)})},this.listen=function(){s&&!s.isListening()&&(Qm.forEach(d=>{s!==d&&d.unlisten()}),Zm=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Zm=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Zm===s.guid},this.destroyEditor=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(d,m)},this.populateFromArray=function(d,m,p,E,M,P,Y){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const B=typeof E=="number"?s._createCellCoords(E,M):null;return c.populateFromArray(s._createCellCoords(d,m),p,B,P,Y)},this.spliceCol=function(d,m,p){for(var E=arguments.length,M=new Array(E>3?E-3:0),P=3;P<E;P++)M[P-3]=arguments[P];return l.spliceCol(d,m,p,...M)},this.spliceRow=function(d,m,p){for(var E=arguments.length,M=new Array(E>3?E-3:0),P=3;P<E;P++)M[P-3]=arguments[P];return l.spliceRow(d,m,p,...M)},this.getSelected=function(){if(k.isSelected())return Ue(k.getSelectedRange(),d=>{let{from:m,to:p}=d;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const d=this.getSelected();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedRange=function(){if(k.isSelected())return Array.from(k.getSelectedRange())},this.getSelectedRangeLast=function(){const d=this.getSelectedRange();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.emptySelectedCells=function(d){if(!k.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];T(k.getSelectedRange(),p=>{if(p.isSingleHeader())return;const E=p.getTopStartCorner(),M=p.getBottomEndCorner();ve(E.row,M.row,P=>{ve(E.col,M.col,Y=>{this.getCellMeta(P,Y).readOnly||m.push([P,Y,null])})})}),m.length>0&&this.setDataAtCell(m,d)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(d){this.suspendRender();const m=d();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=d();return this.resumeExecution(m),p},this.batch=function(d){this.suspendRender(),this.suspendExecution();const m=d();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:d,height:m}=s.view.getLastSize(),{width:p,height:E}=s.rootElement.getBoundingClientRect(),M=p!==d||E!==m;s.runHooks("beforeRefreshDimensions",{width:d,height:m},{width:p,height:E},M)!==!1&&((M||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(p,E),s.render()),s.runHooks("afterRefreshDimensions",{width:d,height:m},{width:p,height:E},M))},this.updateData=function(d,m){o0(d,p=>{l=p},p=>{l=p,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:b,firstRun:g})},this.loadData=function(d,m){o0(d,p=>{l=p},()=>{b.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:b,firstRun:g})},this.getInitialColumnCount=function(){const d=y.columns;let m=0;if(Array.isArray(d))m=d.length;else if(wt(d))if(s.dataType==="array"){const p=this.countSourceCols();for(let E=0;E<p;E+=1)d(E)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(ce(y.dataSchema)){const p=l.getSchema();m=Array.isArray(p)?p.length:dg(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,m,p,E){return Ct(d)?l.getAll():l.getRange(s._createCellCoords(d,m),s._createCellCoords(p,E),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,m,p,E){return l.getCopyableText(s._createCellCoords(d,m),s._createCellCoords(p,E))},this.getCopyableData=function(d,m){return l.getCopyable(d,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(g?s.loadData:s.updateData).bind(this);let E=!1,M,P;if(ce(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ce(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ce(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(M in d)M==="data"||(M==="language"?Z(d.language):M==="className"?z("className",d.className):M==="tableClassName"&&s.table?(z("tableClassName",d.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):me.getSingleton().isRegistered(M)||me.getSingleton().isDeprecated(M)?(wt(d[M])||Array.isArray(d[M]))&&(d[M].initialHook=!0,s.addHook(M,d[M])):!m&&Pt(d,M)&&(_[M]=d[M]));d.data===void 0&&y.data===void 0?p(null,"updateSettings"):d.data!==void 0?p(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),s.initIndexMappers());const Y=s.countCols(),B=y.columns;if(B&&wt(B)&&(E=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&b.clearCache(),Y>0)for(M=0,P=0;M<Y;M++){if(B){const X=E?B(M):B[P];X&&b.updateColumnMeta(P,X)}P+=1}ce(d.cell)&&Ge(d.cell,X=>{s.setCellMetaObject(X.row,X.col,X)}),s.runHooks("afterCellMetaReset");let q=s.rootElement.style.height;q!==""&&(q=parseInt(s.rootElement.style.height,10));let J=d.height;if(wt(J)&&(J=J()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),J===null){const X=s.rootElement.getAttribute("data-initialstyle");X&&(X.indexOf("height")>-1||X.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",X):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else J!==void 0&&(s.rootElement.style.height=isNaN(J)?`${J}`:`${J}px`,s.rootElement.style.overflow="hidden");if(typeof d.width<"u"){let X=d.width;wt(X)&&(X=X()),s.rootElement.style.width=isNaN(X)?`${X}`:`${X}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(q===""||J===""||J===void 0)&&q!==J&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const d=s.getSelectedLast();if(y.getValue){if(wt(y.getValue))return y.getValue.call(s);if(d)return s.getData()[d[0][0]][y.getValue]}else if(d)return s.getDataAtCell(d[0],d[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,m,p,E,M){c.alter(d,m,p,E,M)},this.getCell=function(d,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=m,M=d;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;M=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return M===null||E===null?null:s.view.getCellAtCoords(s._createCellCoords(M,E),p)},this.getCoords=function(d){const m=this.view._wt.wtTable.getCoords(d);if(m===null)return null;const{row:p,col:E}=m;let M=p,P=E;return p>=0&&(M=this.rowIndexMapper.getVisualFromRenderableIndex(p)),E>=0&&(P=this.columnIndexMapper.getVisualFromRenderableIndex(E)),s._createCellCoords(M,P)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=d=>this.rowIndexMapper.getVisualFromPhysicalIndex(d),this.toVisualColumn=d=>this.columnIndexMapper.getVisualFromPhysicalIndex(d),this.toPhysicalRow=d=>this.rowIndexMapper.getPhysicalFromVisualIndex(d),this.toPhysicalColumn=d=>this.columnIndexMapper.getPhysicalFromVisualIndex(d),this.getDataAtCell=function(d,m){return l.get(d,l.colToProp(m))},this.getDataAtRowProp=function(d,m){return l.get(d,m)},this.getDataAtCol=function(d){const m=[],p=l.getRange(s._createCellCoords(0,d),s._createCellCoords(y.data.length-1,d),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let M=0;M<p[E].length;M+=1)m.push(p[E][M]);return m},this.getDataAtProp=function(d){const m=[],p=l.getRange(s._createCellCoords(0,l.propToCol(d)),s._createCellCoords(y.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let M=0;M<p[E].length;M+=1)m.push(p[E][M]);return m},this.getSourceData=function(d,m,p,E){let M;return d===void 0?M=u.getData():M=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(p,E)),M},this.getSourceDataArray=function(d,m,p,E){let M;return d===void 0?M=u.getData(!0):M=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(p,E),!0),M},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,m,p,E){const M=he(d,m,p),P=this.hasHook("afterSetSourceDataAtCell"),Y=[];P&&T(M,q=>{let[J,X,fe]=q;Y.push([J,X,u.getAtCell(J,X),fe])}),T(M,q=>{let[J,X,fe]=q;u.setAtCell(J,X,fe)}),P&&this.runHooks("afterSetSourceDataAtCell",Y,E),this.render();const B=s.getActiveEditor();B&&ce(B.refreshValue)&&B.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,m){return u.getAtCell(d,m)},this.getDataAtRow=function(d){return l.getRange(s._createCellCoords(d,0),s._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(d,m,p,E){const M=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,m,p,E],[P,Y]=M;let[,,B,q]=M,J=null,X=null;B===void 0&&(B=P),q===void 0&&(q=Y);let fe="mixed";return ve(Math.max(Math.min(P,B),0),Math.max(P,B),Oe=>{let Ee=!0;return ve(Math.max(Math.min(Y,q),0),Math.max(Y,q),Pe=>(X=this.getCellMeta(Oe,Pe).type,J?Ee=J===X:J=X,Ee)),fe=Ee?X:"mixed",Ee}),fe},this.removeCellMeta=function(d,m,p){const[E,M]=[this.toPhysicalRow(d),this.toPhysicalColumn(m)];let P=b.getCellMetaKeyValue(E,M,p);s.runHooks("beforeRemoveCellMeta",d,m,p,P)!==!1&&(b.removeCellMeta(E,M,p),s.runHooks("afterRemoveCellMeta",d,m,p,P)),P=null},this.spliceCellsMeta=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,E=new Array(p>2?p-2:0),M=2;M<p;M++)E[M-2]=arguments[M];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&b.removeRow(this.toPhysicalRow(d),m),E.length>0&&T(E.reverse(),P=>{b.createRow(this.toPhysicalRow(d)),T(P,(Y,B)=>this.setCellMetaObject(d,B,Y))}),s.render()},this.setCellMetaObject=function(d,m,p){typeof p=="object"&&Ge(p,(E,M)=>{this.setCellMeta(d,m,M,E)})},this.setCellMeta=function(d,m,p,E){if(s.runHooks("beforeSetCellMeta",d,m,p,E)===!1)return;let P=d,Y=m;d<this.countRows()&&(P=this.toPhysicalRow(d)),m<this.countCols()&&(Y=this.toPhysicalColumn(m)),b.setCellMeta(P,Y,p,E),s.runHooks("afterSetCellMeta",d,m,p,E)},this.getCellsMeta=function(){return b.getCellsMeta()},this.getCellMeta=function(d,m){let p=this.toPhysicalRow(d),E=this.toPhysicalColumn(m);return p===null&&(p=d),E===null&&(E=m),b.getCellMeta(p,E,{visualRow:d,visualColumn:m})},this.getCellMetaAtRow=function(d){return b.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).renderer:d.renderer;return typeof p=="string"?uf(p):Ct(p)?uf("text"):p},this.getCellEditor=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).editor:d.editor;return typeof p=="string"?sf(p):Ct(p)?sf("text"):p},this.getCellValidator=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).validator:d.validator;return typeof p=="string"?Qv(p):p},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,m){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,d)},this.validateColumns=function(d,m){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,d)},this._validateCells=function(d,m,p){const E=new K;d&&(E.onQueueEmpty=d);let M=s.countRows()-1;for(;M>=0;){if(m!==void 0&&m.indexOf(M)===-1){M-=1;continue}let P=s.countCols()-1;for(;P>=0;){if(p!==void 0&&p.indexOf(P)===-1){P-=1;continue}E.addValidatorToQueue(),s.validateCell(s.getDataAtCell(M,P),s.getCellMeta(M,P),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),P-=1}M-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(d){let m=y.rowHeaders,p=d;return p!==void 0&&(p=s.runHooks("modifyRowHeader",p)),p===void 0?(m=[],ve(s.countRows()-1,E=>{m.push(s.getRowHeader(E))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:wt(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let d=0,m=s.countCols();d<m;d++)if(s.getColHeader(d))return!0;return!1},this.getColHeader=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=s.runHooks("modifyColHeader",d);if(p===void 0){const B=[],q=s.countCols();for(let J=0;J<q;J++)B.push(s.getColHeader(J));return B}let E=y.colHeaders;const M=function(B){const q=[],J=s.countCols();let X=0;for(;X<J;X++)wt(y.columns)&&y.columns(X)&&q.push(X);return q[B]},P=s.toPhysicalColumn(p),Y=M(P);return y.colHeaders===!1?E=null:y.columns&&wt(y.columns)&&y.columns(Y)&&y.columns(Y).title?E=y.columns(Y).title:y.columns&&y.columns[P]&&y.columns[P].title?E=y.columns[P].title:Array.isArray(y.colHeaders)&&y.colHeaders[P]!==void 0?E=y.colHeaders[P]:wt(y.colHeaders)?E=y.colHeaders(P):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(E=wg(p)),E=s.runHooks("modifyColumnHeaderValue",E,d,m),E},this._getColWidthFromSettings=function(d){let m;if(d>=0&&(m=s.getCellMeta(0,d).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(d){let m=s._getColWidthFromSettings(d);return m=s.runHooks("modifyColWidth",m,d),m===void 0&&(m=eS.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(d){let m=y.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(d){let m=s._getRowHeightFromSettings(d);return m=s.runHooks("modifyRowHeight",m,d),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const d=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return lf(s.countRows()-1,p=>{if(s.isEmptyRow(p))m+=1;else if(d===!0)return!1}),m},this.countEmptyCols=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return lf(s.countCols()-1,p=>{if(s.isEmptyCol(p))m+=1;else if(d===!0)return!1}),m},this.isEmptyRow=function(d){return y.isEmptyRow.call(s,d)},this.isEmptyCol=function(d){return y.isEmptyCol.call(s,d)},this.selectCell=function(d,m,p,E){let M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,P=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ct(d)||Ct(m)?!1:this.selectCells([[d,m,p,E]],M,P)},this.selectCells=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(o=!0);const E=k.selectCells(d);return E&&p&&s.listen(),o=!1,E},this.selectColumns=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;return k.selectColumns(d,m,p)},this.selectRows=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;return k.selectRows(d,m,p)},this.deselectCell=function(){k.deselect()},this.selectAll=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;o=!0,k.selectAll(d,m,p),o=!1};const ze=(d,m)=>d.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(d){var m;if(typeof d=="number"){var p;d={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(p=arguments[4])!==null&&p!==void 0?p:!0}}const{row:E,col:M,verticalSnap:P,horizontalSnap:Y,considerHiddenIndexes:B}=(m=d)!==null&&m!==void 0?m:{};let q,J,X,fe;P!==void 0&&(q=P==="top",J=!q),Y!==void 0&&(X=Y==="start",fe=!X);let Oe=E,Ee=M;if(B===void 0||B){const Ke=Number.isInteger(E)&&E>=0,$e=Number.isInteger(M)&&M>=0,ye=Ke?ze(this.rowIndexMapper,E):void 0,He=$e?ze(this.columnIndexMapper,M):void 0;if(ye===null||He===null)return!1;Oe=Ke?s.rowIndexMapper.getRenderableFromVisualIndex(ye):E,Ee=$e?s.columnIndexMapper.getRenderableFromVisualIndex(He):M}const Pe=Number.isInteger(Oe),j=Number.isInteger(Ee);return Pe&&Oe>=0&&j&&Ee>=0?s.view.scrollViewport(s._createCellCoords(Oe,Ee),q,fe,J,X):Pe&&Oe>=0&&(j&&Ee<0||!j)?s.view.scrollViewportVertically(Oe,q,J):j&&Ee>=0&&(Pe&&Oe<0||!Pe)?s.view.scrollViewportHorizontally(Ee,fe,X):!1},this.scrollToFocusedCell=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",d);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",d),this._registerImmediate(()=>d()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),b.clearCache(),Qm.delete(this.guid),Ad(s)){const d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}ri(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),O.getItems().forEach(d=>{let[,m]=d;m.destroy()}),O.clear(),s.runHooks("afterDestroy")},!0),me.getSingleton().destroy(s),Ge(s,(d,m,p)=>{wt(d)?p[m]=Ne(m):m!=="guid"&&(p[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,k=null,h=null,s=null};function Ne(d){return()=>{throw new Error(`The "${d}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(d){const m=_n(d);return m==="UndoRedo"?this.undoRedo:O.getItem(m)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:O.getId(d)},this.getInstance=function(){return s},this.addHook=function(d,m){me.getSingleton().add(d,m,s)},this.hasHook=function(d){return me.getSingleton().has(d,s)||me.getSingleton().has(d)},this.addHookOnce=function(d,m){me.getSingleton().once(d,m,s)},this.removeHook=function(d,m){me.getSingleton().remove(d,m,s)},this.runHooks=function(d,m,p,E,M,P,Y){return me.getSingleton().run(s,d,m,p,E,M,P,Y)},this.getTranslatedPhrase=function(d,m){return p1(y.language,d,m)},this.toHTML=()=>rC(this),this.toTableElement=()=>{const d=this.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",rC(this)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=d;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){T(this.timeouts,d=>{clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){T(this.immediates,d=>{clearImmediate(d)})},this._refreshBorders=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(d),s.view.render(),m&&k.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const R=e6({handleEvent(){return s.isListening()},beforeKeyDown:d=>this.runHooks("beforeKeyDown",d),afterKeyDown:d=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",d=>{d.ctrlKey===!1&&d.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},Zv().forEach(d=>{const m=Lc(d);O.addItem(d,new m(this))}),z4(s),R.setActiveContextName("grid"),me.getSingleton().run(s,"construct")}const t6="hooksRefRegisterer",N1={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){T(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ge(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Li(N1,"MIXIN_NAME",t6,{writable:!1,enumerable:!1});const n6=N1;function Fr(t,e,n){return e=r6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r6(t){var e=i6(t,"string");return typeof e=="symbol"?e:String(e)}function i6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const o6="base",Jt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),vC="baseEditor";class $l{static get EDITOR_TYPE(){return o6}constructor(e){Fr(this,"hot",void 0),Fr(this,"state",Jt.VIRGIN),Fr(this,"_opened",!1),Fr(this,"_fullEditMode",!1),Fr(this,"_closeCallback",null),Fr(this,"TD",null),Fr(this,"row",null),Fr(this,"col",null),Fr(this,"prop",null),Fr(this,"originalValue",null),Fr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=Jt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>ce(this.hot.getSelected()),group:vC};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Jt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=Jt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Ft(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(vC),s.removeShortcutsByGroup(gg),this.state===Jt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Jt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=Jt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Jt.FINISHED,this.discardEditor(l)}):(this.state=Jt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Jt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Jt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Jt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Jt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Jt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=jt(n),a=dt(n),l=jt(this.hot.rootElement),u=dt(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:C}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,b=C.name,y=["master","inline_start"].includes(b)?f:0,_=["master","top","bottom"].includes(b)?g:0,O=s.top===l.top?0:1;let I=s.top-l.top-O-y,x=0;this.hot.isRtl()?x=o.innerWidth-s.left-a-w-1+_:x=s.left-l.left-1-_,["top","top_inline_start_corner"].includes(b)&&(I+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const k=this.hot.hasColHeaders(),U=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Z=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),K=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(k&&U<=0||U===K)&&(I+=1),Z<=0&&(x+=1);const te=i.rowsRenderCalculator.startPosition,oe=i.columnsRenderCalculator.startPosition,ie=Math.abs(r.inlineStartOverlay.getScrollPosition()),he=r.topOverlay.getScrollPosition(),Te=on(this.hot.rootDocument);let ze=n.offsetTop;if(["inline_start","master"].includes(b)&&(ze+=te-he),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:J,wtTable:X}=r.bottomOverlay.clone;ze+=J.getWorkspaceHeight()-X.getHeight()-Te}let Ne=n.offsetLeft;this.hot.isRtl()?(Ne>=0?Ne=C.getWidth()-n.offsetLeft:Ne=Math.abs(Ne),Ne+=oe-ie-a):["top","master","bottom"].includes(b)&&(Ne+=oe-ie);const R=vo(this.TD,this.hot.rootWindow),d=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(R[d],10)>0?0:1,p=parseInt(R.borderTopWidth,10)>0?0:1,E=dt(n)+m,M=xt(n)+p,P=Gx(c)?Te:0,Y=zx(h)?Te:0,B=this.hot.view.maximumVisibleElementWidth(Ne)-P+m,q=Math.max(this.hot.view.maximumVisibleElementHeight(ze)-Y+p,23);return{top:I,start:x,height:M,maxHeight:q,width:E,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}mt($l,n6);function d0(t,e,n){t.addEventListener(e,n,!1)}function f0(t,e,n){t.removeEventListener(e,n,!1)}function g0(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function s6(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=g0(o).fontSize,i.style.fontFamily=g0(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const h=o.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const f=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>f?h.height=`${e.minHeight}px`:e.maxHeight<f?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${f}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.overflowY="",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),f&&(d0(o,"input",s),d0(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){f0(o,"input",s),f0(o,"keydown",a)}}}function m0(t,e){const n=kv(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Ic(e,i)}function Es(t,e,n){return e=a6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a6(t){var e=l6(t,"string");return typeof e=="symbol"?e:String(e)}function l6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const u6="ht_editor_visible",Mh="ht_editor_hidden",p0="textEditor",c6="text";class pa extends $l{static get EDITOR_TYPE(){return c6}constructor(e){super(e),Es(this,"eventManager",new pr(this)),Es(this,"autoResize",s6(this.hot.rootDocument)),Es(this,"TEXTAREA",void 0),Es(this,"textareaStyle",void 0),Es(this,"TEXTAREA_PARENT",void 0),Es(this,"textareaParentStyle",void 0),Es(this,"layerClass",void 0),this.eventManager=new pr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),kx(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==Jt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===Jt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Ic(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Me(this.TEXTAREA,[["data-hot-input",""],Dl(-1)]),this.hot.getSettings().ariaTags&&Me(this.TEXTAREA,[To()]),ee(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ee(this.TEXTAREA_PARENT,"handsontableInputHolder"),De(this.TEXTAREA_PARENT,this.layerClass)&&ke(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,Mh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){oI()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ke(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,Mh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;ve(e.length-1,r=>{const i=e[r];if(De(i,"handsontableEditor"))return n=!0,!1}),De(this.TEXTAREA_PARENT,Mh)&&ke(this.TEXTAREA_PARENT,Mh),n?(this.layerClass=u6,ee(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ee(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Jt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=vo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=vo(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,g=s-h,w=o-c,C=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,w),minHeight:Math.min(g,C),maxWidth:w,maxHeight:C},!0)}bindEvents(){Gv()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>ce(this.hot.getSelected()),group:p0},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;m0(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;m0(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(gg),n.removeShortcutsByGroup(p0),n.removeShortcutsByGroup(vC)}}const h6="base";function Wc(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&ee(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(XR())):a&&c.push(XR()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(qR())):(u.push(s.invalidCellClassName),a&&c.push(qR()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),ke(e,u),ee(e,l),fa(e,c),Me(e,h)}Wc.RENDERER_TYPE=h6;const d6="text";function Oo(t,e,n,r,i,o,s){Wc.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Ft(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){ri(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else ls(e,a)}Oo.RENDERER_TYPE=d6;const f6="text",L1={CELL_TYPE:f6,editor:pa,renderer:Oo};br(L1);Ie.editors={BaseEditor:$l};function Ie(t,e){const n=new D1(t,e||{},vS);return n.init(),n}Ie.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new D1(t,e,vS)};Ie.DefaultSettings=M1();Ie.hooks=me.getSingleton();Ie.CellCoords=hf;Ie.CellRange=rS;Ie.packageName="handsontable";Ie.buildDate="30/11/2023 10:10:40";Ie.version="14.0.0";Ie.languages={dictionaryKeys:IX,getLanguageDictionary:m1,getLanguagesDictionaries:kX,registerLanguageDictionary:g1,getTranslatedPhrase:p1};const w0="handsontableEditor",g6="handsontable";class eb extends pa{static get EDITOR_TYPE(){return g6}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Ic(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Kt(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:w0,relativeToGroup:gg,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Hr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(w0)}}function m6(t,e,n){p6(t,e),e.set(t,n)}function p6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ah(t,e,n){return e=w6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w6(t){var e=C6(t,"string");return typeof e=="symbol"?e:String(e)}function C6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function C0(t,e){var n=v6(t,e,"get");return S6(t,n)}function v6(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function S6(t,e){return e.get?e.get.call(t):e.value}const y6="autocomplete";var Jm=new WeakMap;class tb extends eb{constructor(){super(...arguments),Ah(this,"query",null),Ah(this,"strippedChoices",[]),Ah(this,"rawChoices",[]),m6(this,Jm,{writable:!0,value:this.hot.guid.slice(0,9)}),Ah(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=Zw(Ft(n[c])),r)h=u.indexOf(e);else{const f=this.cellProperties.locale;h=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((f,g)=>{if(g.index===-1)return-1;if(f.index===-1)return 1;if(f.index<g.index)return-1;if(g.index<f.index)return 1;if(f.index===g.index){if(f.charsLeft<g.charsLeft)return-1;if(f.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return y6}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ce(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ee(this.htContainer,"autocompleteEditor"),ee(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Me(this.TEXTAREA,[$G(),HG(),Hx("listbox"),UG()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Me(this.TEXTAREA,[Ar("false"),GG(`${C0(this,Jm)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=on();a===0&&fc()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[dt(this.TEXTAREA)-2]:void 0,width:e?dt(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,f,g,w)=>{Oo(l,u,c,h,f,g,w);const{filteringCaseSensitive:C,allowHtml:b,locale:y}=this.cellProperties,_=this.query;let O=Ft(g),I,x;O&&!b&&(I=C===!0?O.indexOf(_):O.toLocaleLowerCase(y).indexOf(_.toLocaleLowerCase(y)),I!==-1&&(x=O.substr(I,_.length),O=O.replace(x,`<strong>${x}</strong>`))),n&&Me(u,[DG(),...r?[KG(i)]:[],...r?[XG(r.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=O},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Me(c,[Dv()]),Me(this.TEXTAREA,...zG(c.id))}}}),n&&(Me(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ai()),Me(this.htEditor.rootElement,[Ix(),YG("polite"),jG("text"),["id",`${C0(this,Jm)}-listbox-${o}-${s}`]]),Me(this.TEXTAREA,...Ar("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Me(this.TEXTAREA,[Ar("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=kv(this.TEXTAREA),r=Ux(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,f=l.length;h<f&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Wu([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Ic(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=na(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=jt(this.TEXTAREA),o=xt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=xt(this.hot.view._wt.wtTable.THEAD),u=jt(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,f=s>h&&c>h;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:h,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+on(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Ft(o));return Ue(r,o=>n?o:Zw(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===Ce.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===Ce.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(sI(e.keyCode)||e.keyCode===Ce.BACKSPACE||e.keyCode===Ce.DELETE||e.keyCode===Ce.INSERT){let n=10;if(e.keyCode===Ce.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const b6="checkbox";class k1 extends $l{static get EDITOR_TYPE(){return b6}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');De(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var $1={exports:{}};const R6=FO(gG);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=R6}catch{}t.exports=r(i)}})(Qr,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(R,d,m,p){i?R.addEventListener(d,m,!!p):R.attachEvent("on"+d,m)},l=function(R,d,m,p){i?R.removeEventListener(d,m,!!p):R.detachEvent("on"+d,m)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,d){return(" "+R.className+" ").indexOf(" "+d+" ")!==-1},h=function(R,d){c(R,d)||(R.className=R.className===""?d:R.className+" "+d)},f=function(R,d){R.className=u((" "+R.className+" ").replace(" "+d+" "," "))},g=function(R){return/Array/.test(Object.prototype.toString.call(R))},w=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},C=function(R){var d=R.getDay();return d===0||d===6},b=function(R){return R%4===0&&R%100!==0||R%400===0},y=function(R,d){return[31,b(R)?29:28,31,30,31,30,31,31,30,31,30,31][d]},_=function(R){w(R)&&R.setHours(0,0,0,0)},O=function(R,d){return R.getTime()===d.getTime()},I=function(R,d,m){var p,E;for(p in d)E=R[p]!==void 0,E&&typeof d[p]=="object"&&d[p]!==null&&d[p].nodeName===void 0?w(d[p])?m&&(R[p]=new Date(d[p].getTime())):g(d[p])?m&&(R[p]=d[p].slice(0)):R[p]=I({},d[p],m):(m||!E)&&(R[p]=d[p]);return R},x=function(R,d,m){var p;o.createEvent?(p=o.createEvent("HTMLEvents"),p.initEvent(d,!0,!1),p=I(p,m),R.dispatchEvent(p)):o.createEventObject&&(p=o.createEventObject(),p=I(p,m),R.fireEvent("on"+d,p))},k=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},U={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},Z=function(R,d,m){for(d+=R.firstDay;d>=7;)d-=7;return m?R.i18n.weekdaysShort[d]:R.i18n.weekdays[d]},z=function(R){var d=[],m="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&d.push("is-disabled"),R.isToday&&d.push("is-today"),R.isSelected&&(d.push("is-selected"),m="true"),R.hasEvent&&d.push("has-event"),R.isInRange&&d.push("is-inrange"),R.isStartRange&&d.push("is-startrange"),R.isEndRange&&d.push("is-endrange"),'<td data-day="'+R.day+'" class="'+d.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},K=function(R,d){R.setHours(0,0,0,0);var m=R.getDate(),p=R.getDay(),E=d,M=E-1,P=7,Y=function(fe){return(fe+P-1)%P};R.setDate(m+M-Y(p));var B=new Date(R.getFullYear(),0,E),q=24*60*60*1e3,J=(R.getTime()-B.getTime())/q,X=1+Math.round((J-M+Y(B.getDay()))/P);return X},te=function(R,d,m,p){var E=new Date(m,d,R),M=r?n(E).isoWeek():K(E,p);return'<td class="pika-week">'+M+"</td>"},oe=function(R,d,m,p){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(d?R.reverse():R).join("")+"</tr>"},ie=function(R){return"<tbody>"+R.join("")+"</tbody>"},he=function(R){var d,m=[];for(R.showWeekNumber&&m.push("<th></th>"),d=0;d<7;d++)m.push('<th scope="col"><abbr title="'+Z(R,d)+'">'+Z(R,d,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?m.reverse():m).join("")+"</tr></thead>"},Te=function(R,d,m,p,E,M){var P,Y,B,q=R._o,J=m===q.minYear,X=m===q.maxYear,fe='<div id="'+M+'" class="pika-title" role="heading" aria-live="assertive">',Oe,Ee,Pe=!0,j=!0;for(B=[],P=0;P<12;P++)B.push('<option value="'+(m===E?P-d:12+P-d)+'"'+(P===p?' selected="selected"':"")+(J&&P<q.minMonth||X&&P>q.maxMonth?' disabled="disabled"':"")+">"+q.i18n.months[P]+"</option>");for(Oe='<div class="pika-label">'+q.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+B.join("")+"</select></div>",g(q.yearRange)?(P=q.yearRange[0],Y=q.yearRange[1]+1):(P=m-q.yearRange,Y=1+m+q.yearRange),B=[];P<Y&&P<=q.maxYear;P++)P>=q.minYear&&B.push('<option value="'+P+'"'+(P===m?' selected="selected"':"")+">"+P+"</option>");return Ee='<div class="pika-label">'+m+q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+B.join("")+"</select></div>",q.showMonthAfterYear?fe+=Ee+Oe:fe+=Oe+Ee,J&&(p===0||q.minMonth>=p)&&(Pe=!1),X&&(p===11||q.maxMonth<=p)&&(j=!1),d===0&&(fe+='<button class="pika-prev'+(Pe?"":" is-disabled")+'" type="button">'+q.i18n.previousMonth+"</button>"),d===R._o.numberOfMonths-1&&(fe+='<button class="pika-next'+(j?"":" is-disabled")+'" type="button">'+q.i18n.nextMonth+"</button>"),fe+="</div>"},ze=function(R,d,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+he(R)+ie(d)+"</table>"},Ne=function(R){var d=this,m=d.config(R);d._onMouseDown=function(E){if(d._v){E=E||window.event;var M=E.target||E.srcElement;if(M)if(c(M,"is-disabled")||(c(M,"pika-button")&&!c(M,"is-empty")&&!c(M.parentNode,"is-disabled")?(d.setDate(new Date(M.getAttribute("data-pika-year"),M.getAttribute("data-pika-month"),M.getAttribute("data-pika-day"))),m.bound&&s(function(){d.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):c(M,"pika-prev")?d.prevMonth():c(M,"pika-next")&&d.nextMonth()),c(M,"pika-select"))d._c=!0;else if(E.preventDefault)E.preventDefault();else return E.returnValue=!1,!1}},d._onChange=function(E){E=E||window.event;var M=E.target||E.srcElement;M&&(c(M,"pika-select-month")?d.gotoMonth(M.value):c(M,"pika-select-year")&&d.gotoYear(M.value))},d._onKeyChange=function(E){if(E=E||window.event,d.isVisible())switch(E.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(r){var E=n(m.field.value,m.format,m.formatStrict);return E&&E.isValid()?E.toDate():null}else return new Date(Date.parse(m.field.value))},d._onInputChange=function(E){var M;E.firedBy!==d&&(M=d._parseFieldValue(),w(M)&&d.setDate(M),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var E=o.activeElement;do if(c(E,"pika-single"))return;while(E=E.parentNode);d._c||(d._b=s(function(){d.hide()},50)),d._c=!1},d._onClick=function(E){E=E||window.event;var M=E.target||E.srcElement,P=M;if(M){!i&&c(M,"pika-select")&&(M.onchange||(M.setAttribute("onchange","return;"),a(M,"change",d._onChange)));do if(c(P,"pika-single")||P===m.trigger)return;while(P=P.parentNode);d._v&&M!==m.trigger&&P!==m.trigger&&d.hide()}},d.el=o.createElement("div"),d.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),a(d.el,"mousedown",d._onMouseDown,!0),a(d.el,"touchend",d._onMouseDown,!0),a(d.el,"change",d._onChange),m.keyboardInput&&a(o,"keydown",d._onKeyChange),m.field&&(m.container?m.container.appendChild(d.el):m.bound?o.body.appendChild(d.el):m.field.parentNode.insertBefore(d.el,m.field.nextSibling),a(m.field,"change",d._onInputChange),m.defaultDate||(m.defaultDate=d._parseFieldValue(),m.setDefaultDate=!0));var p=m.defaultDate;w(p)?m.setDefaultDate?d.setDate(p,!0):d.gotoDate(p):d.gotoDate(new Date),m.bound?(this.hide(),d.el.className+=" is-bound",a(m.trigger,"click",d._onInputClick),a(m.trigger,"focus",d._onInputFocus),a(m.trigger,"blur",d._onInputBlur)):this.show()};return Ne.prototype={config:function(R){this._o||(this._o=I({},U,!0));var d=I(this._o,R,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var m=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=m>4?4:m,w(d.minDate)||(d.minDate=!1),w(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),g(d.yearRange)){var p=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||p,d.yearRange[1]=parseInt(d.yearRange[1],10)||p}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||U.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(R){return R=R||this._o.format,w(this._d)?this._o.toString?this._o.toString(this._d,R):r?n(this._d).format(R):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(R,d){r&&n.isMoment(R)&&this.setDate(R.toDate(),d)},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(R,d){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",x(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!w(R)){var m=this._o.minDate,p=this._o.maxDate;w(m)&&R<m?R=m:w(p)&&R>p&&(R=p),this._d=new Date(R.getTime()),_(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),x(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var d=!0;if(w(R)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),E=R.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),d=E<m.getTime()||p.getTime()<E}d&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,d){var m=this.getDate()||new Date,p=parseInt(d)*24*60*60*1e3,E;R==="add"?E=new Date(m.valueOf()+p):R==="subtract"&&(E=new Date(m.valueOf()-p)),this.setDate(E)},adjustCalendars:function(){this.calendars[0]=k(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=k({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(_(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=U.minDate,this._o.minYear=U.minYear,this._o.minMonth=U.minMonth,this._o.startRange=U.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(_(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=U.maxDate,this._o.maxYear=U.maxYear,this._o.maxMonth=U.maxMonth,this._o.endRange=U.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var d=this._o,m=d.minYear,p=d.maxYear,E=d.minMonth,M=d.maxMonth,P="",Y;this._y<=m&&(this._y=m,!isNaN(E)&&this._m<E&&(this._m=E)),this._y>=p&&(this._y=p,!isNaN(M)&&this._m>M&&(this._m=M));for(var B=0;B<d.numberOfMonths;B++)Y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),P+='<div class="pika-lendar">'+Te(this,B,this.calendars[B].year,this.calendars[B].month,this.calendars[0].year,Y)+this.render(this.calendars[B].year,this.calendars[B].month,Y)+"</div>";this.el.innerHTML=P,d.bound&&d.field.type!=="hidden"&&s(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var R,d,m,p,E,M,P,Y,B,q,J,X;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,d=R,m=this.el.offsetWidth,p=this.el.offsetHeight,E=window.innerWidth||o.documentElement.clientWidth,M=window.innerHeight||o.documentElement.clientHeight,P=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,J=!0,X=!0,typeof R.getBoundingClientRect=="function")q=R.getBoundingClientRect(),Y=q.left+window.pageXOffset,B=q.bottom+window.pageYOffset;else for(Y=d.offsetLeft,B=d.offsetTop+d.offsetHeight;d=d.offsetParent;)Y+=d.offsetLeft,B+=d.offsetTop;(this._o.reposition&&Y+m>E||this._o.position.indexOf("right")>-1&&Y-m+R.offsetWidth>0)&&(Y=Y-m+R.offsetWidth,J=!1),(this._o.reposition&&B+p>M+P||this._o.position.indexOf("top")>-1&&B-p-R.offsetHeight>0)&&(B=B-p-R.offsetHeight,X=!1),this.el.style.left=Y+"px",this.el.style.top=B+"px",h(this.el,J?"left-aligned":"right-aligned"),h(this.el,X?"bottom-aligned":"top-aligned"),f(this.el,J?"right-aligned":"left-aligned"),f(this.el,X?"top-aligned":"bottom-aligned")}},render:function(R,d,m){var p=this._o,E=new Date,M=y(R,d),P=new Date(R,d,1).getDay(),Y=[],B=[];_(E),p.firstDay>0&&(P-=p.firstDay,P<0&&(P+=7));for(var q=d===0?11:d-1,J=d===11?0:d+1,X=d===0?R-1:R,fe=d===11?R+1:R,Oe=y(X,q),Ee=M+P,Pe=Ee;Pe>7;)Pe-=7;Ee+=7-Pe;for(var j=!1,Ke=0,$e=0;Ke<Ee;Ke++){var ye=new Date(R,d,1+(Ke-P)),He=w(this._d)?O(ye,this._d):!1,Re=O(ye,E),v=p.events.indexOf(ye.toDateString())!==-1,S=Ke<P||Ke>=M+P,A=1+(Ke-P),W=d,H=R,F=p.startRange&&O(p.startRange,ye),D=p.endRange&&O(p.endRange,ye),N=p.startRange&&p.endRange&&p.startRange<ye&&ye<p.endRange,V=p.minDate&&ye<p.minDate||p.maxDate&&ye>p.maxDate||p.disableWeekends&&C(ye)||p.disableDayFn&&p.disableDayFn(ye);S&&(Ke<P?(A=Oe+A,W=q,H=X):(A=A-M,W=J,H=fe));var $={day:A,month:W,year:H,hasEvent:v,isSelected:He,isToday:Re,isDisabled:V,isEmpty:S,isStartRange:F,isEndRange:D,isInRange:N,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&He&&(j=!0),B.push(z($)),++$e===7&&(p.showWeekNumber&&B.unshift(te(Ke-P,d,R,p.firstWeekOfYearMinDays)),Y.push(oe(B,p.isRTL,p.pickWholeWeek,j)),B=[],$e=0,j=!1)}return ze(p,Y,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(o,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ne})})($1);var E6=$1.exports;const v0=GC(E6);function Oh(t,e,n){return e=T6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T6(t){var e=_6(t,"string");return typeof e=="symbol"?e:String(e)}function _6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const F1="date",S0="dateEditor";class W1 extends pa{constructor(){super(...arguments),Oh(this,"defaultDateFormat","DD/MM/YYYY"),Oh(this,"isCellEdited",!1),Oh(this,"parentDestroyed",!1),Oh(this,"$datePicker",null)}static get EDITOR_TYPE(){return F1}init(){if(typeof Q!="function")throw new Error("You need to include moment.js to your project.");if(typeof v0!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ee(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new pr(this);e.addEventListener(this.datePicker,"mousedown",n=>{De(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:S0})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(S0),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?Yv(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new v0(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+xt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-dt(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,Q(s,r,!0).isValid()&&this.$datePicker.setMoment(Q(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Q(s,r,!0).isValid()&&this.$datePicker.setMoment(Q(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Nc(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=Q(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const M6="dropdown";class nb extends tb{static get EDITOR_TYPE(){return M6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}me.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===nb&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const A6="numeric";class V1 extends pa{static get EDITOR_TYPE(){return A6}}const O6="password";class B1 extends pa{static get EDITOR_TYPE(){return O6}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Me(this.TEXTAREA,[To()]),ri(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const ep="ht_editor_visible",y0="selectEditor",P6="select";class U1 extends $l{static get EDITOR_TYPE(){return P6}init(){this.select=this.hot.rootDocument.createElement("SELECT"),ee(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",De(this.select,ep)&&ke(this.select,ep),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ri(this.select),Ge(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,ga(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",ee(this.select,ep)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:y0};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(y0)}}const x6="time";class G1 extends pa{static get EDITOR_TYPE(){return x6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function I6(){er($l),er(tb),er(k1),er(W1),er(nb),er(eb),er(V1),er(B1),er(U1),er(pa),er(G1)}const H6="html";function rb(t,e,n,r,i,o,s){Wc.apply(this,[t,e,n,r,i,o,s]),ga(e,o??"",!1)}rb.RENDERER_TYPE=H6;const D6="autocomplete";function Fl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?rb:Oo,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...To()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),ee(e,"htAutocomplete"),!t.acArrowListener){const h=new pr(t);t.acArrowListener=function(f){De(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Fl.RENDERER_TYPE=D6;const b0=new WeakMap,R0=new WeakMap,N6="htBadValue",Ol="data-row",Pl="data-col",L6="checkboxRenderer",z1="checkbox";me.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===z1){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function ib(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Wc.apply(this,[t,e,n,r,i,o,s]),k6(t);let u=$6(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ri(e),o===s.checkedTemplate||Ft(o).toLocaleLowerCase(s.locale)===Ft(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Ft(o).toLocaleLowerCase(s.locale)===Ft(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:en(o)?ee(u,"noValue"):(u.style.display="none",ee(u,N6),h=!0),Me(u,[[Ol,n],[Pl,r]]),l&&Me(u,[Iv(u.checked?t.getTranslatedPhrase(Ky):t.getTranslatedPhrase(Xy)),BG(u.checked),NG()]),!h&&c){let C="";if(c.value)C=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const y=t.getDataAtRowProp(n,c.property);C=y!==null?y:""}const b=F6(a,C,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(b),e.appendChild(u)):(b.appendChild(u),u=b):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(b)):(b.insertBefore(u,b.firstChild),u=b))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),b0.has(t)||(b0.set(t,!0),f());function f(){const b=t.getShortcutManager().getContext("grid"),y={group:L6};b.addShortcuts([{keys:[["space"]],callback:()=>(g(),!w())},{keys:[["enter"]],callback:()=>(g(),!w()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!w()),relativeToGroup:Jy,position:"before"}],y)}function g(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const b=t.getSelectedRange();if(b)for(let y=0;y<b.length;y++){const{row:_,col:O}=b[y].getTopStartCorner(),{row:I,col:x}=b[y].getBottomEndCorner(),k=[];for(let U=_;U<=I;U+=1)for(let Z=O;Z<=x;Z+=1){const z=t.getCellMeta(U,Z);if(z.type!=="checkbox")return;if(z.readOnly===!0)continue;typeof z.checkedTemplate>"u"&&(z.checkedTemplate=!0),typeof z.uncheckedTemplate>"u"&&(z.uncheckedTemplate=!1);const K=t.getDataAtCell(U,Z);C===!1?[z.checkedTemplate,z.checkedTemplate.toString()].includes(K)?k.push([U,Z,z.uncheckedTemplate]):[z.uncheckedTemplate,z.uncheckedTemplate.toString(),null,void 0].includes(K)&&k.push([U,Z,z.checkedTemplate]):k.push([U,Z,z.uncheckedTemplate])}k.length>0&&t.setDataAtCell(k)}}function w(){const C=t.getSelectedRange();if(C){for(let b=0;b<C.length;b++){const y=C[b].getTopStartCorner(),_=C[b].getBottomEndCorner();for(let O=y.row;O<=_.row;O++)for(let I=y.col;I<=_.col;I++){const x=t.getCellMeta(O,I);if(x.type!=="checkbox")return!1;const k=t.getCell(O,I);if(k==null)return!0;if(k.querySelectorAll("input[type=checkbox]").length>0&&!x.readOnly)return!0}}return!1}}}ib.RENDERER_TYPE=z1;function k6(t){let e=R0.get(t);if(!e){const{rootElement:n}=t;e=new pr(t),e.addEventListener(n,"click",r=>V6(r,t)),e.addEventListener(n,"mouseup",r=>W6(r,t)),e.addEventListener(n,"change",r=>B6(r,t)),R0.set(t,e)}return e}function $6(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function F6(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function W6(t,e){const{target:n}=t;ob(n)&&(!n.hasAttribute(Ol)||!n.hasAttribute(Pl)||setTimeout(e.listen,10))}function V6(t,e){const{target:n}=t;if(!ob(n)||!n.hasAttribute(Ol)||!n.hasAttribute(Pl))return;const r=parseInt(n.getAttribute(Ol),10),i=parseInt(n.getAttribute(Pl),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function B6(t,e){const{target:n}=t;if(!ob(n)||!n.hasAttribute(Ol)||!n.hasAttribute(Pl))return;const r=parseInt(n.getAttribute(Ol),10),i=parseInt(n.getAttribute(Pl),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function ob(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function Ph(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Y1={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof Ph=="function"&&Ph;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var g=i[u]={exports:{}};r[u][0].call(g.exports,function(w){return s(r[u][1][w]||w)},g,g.exports,n,r,i,o)}return i[u].exports}for(var a=typeof Ph=="function"&&Ph,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",f=1e14,g=14,w=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],b=1e7,y=1e9;function _(z){var K=0|z;return 0<z||z===K?K:K-1}function O(z){for(var K,te,oe=1,ie=z.length,he=z[0]+"";oe<ie;){for(K=z[oe++]+"",te=g-K.length;te--;K="0"+K);he+=K}for(ie=he.length;he.charCodeAt(--ie)===48;);return he.slice(0,ie+1||1)}function I(z,K){var te,oe,ie=z.c,he=K.c,Te=z.s,ze=K.s,Ne=z.e,R=K.e;if(!Te||!ze)return null;if(te=ie&&!ie[0],oe=he&&!he[0],te||oe)return te?oe?0:-ze:Te;if(Te!=ze)return Te;if(te=Te<0,oe=Ne==R,!ie||!he)return oe?0:!ie^te?1:-1;if(!oe)return R<Ne^te?1:-1;for(ze=(Ne=ie.length)<(R=he.length)?Ne:R,Te=0;Te<ze;Te++)if(ie[Te]!=he[Te])return ie[Te]>he[Te]^te?1:-1;return Ne==R?0:R<Ne^te?1:-1}function x(z,K,te,oe){if(z<K||te<z||z!==(z<0?l(z):u(z)))throw Error(c+(oe||"Argument")+(typeof z=="number"?z<K||te<z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(z))}function k(z){var K=z.c.length-1;return _(z.e/g)==K&&z.c[K]%2!=0}function U(z,K){return(1<z.length?z.charAt(0)+"."+z.slice(1):z)+(K<0?"e":"e+")+K}function Z(z,K,te){var oe,ie;if(K<0){for(ie=te+".";++K;ie+=te);z=ie+z}else if(++K>(oe=z.length)){for(ie=te,K-=oe;--K;ie+=te);z+=ie}else K<oe&&(z=z.slice(0,K)+"."+z.slice(K));return z}(s=function z(K){var te,oe,ie,he,Te,ze,Ne,R,d,m,p=j.prototype={constructor:j,toString:null,valueOf:null},E=new j(1),M=20,P=4,Y=-7,B=21,q=-1e7,J=1e7,X=!1,fe=1,Oe=0,Ee={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Pe="0123456789abcdefghijklmnopqrstuvwxyz";function j(v,S){var A,W,H,F,D,N,V,$,G=this;if(!(G instanceof j))return new j(v,S);if(S==null){if(v instanceof j)return G.s=v.s,G.e=v.e,void(G.c=(v=v.c)?v.slice():v);if((N=typeof v=="number")&&0*v==0){if(G.s=1/v<0?(v=-v,-1):1,v===~~v){for(F=0,D=v;10<=D;D/=10,F++);return G.e=F,void(G.c=[v])}$=String(v)}else{if($=String(v),!a.test($))return ie(G,$,N);G.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(F=$.indexOf("."))&&($=$.replace(".","")),0<(D=$.search(/e/i))?(F<0&&(F=D),F+=+$.slice(D+1),$=$.substring(0,D)):F<0&&(F=$.length)}else{if(x(S,2,Pe.length,"Base"),$=String(v),S==10)return He(G=new j(v instanceof j?v:$),M+G.e+1,P);if(N=typeof v=="number"){if(0*v!=0)return ie(G,$,N,S);if(G.s=1/v<0?($=$.slice(1),-1):1,j.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(h+v);N=!1}else G.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(A=Pe.slice(0,S),F=D=0,V=$.length;D<V;D++)if(A.indexOf(W=$.charAt(D))<0){if(W=="."){if(F<D){F=V;continue}}else if(!H&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){H=!0,D=-1,F=0;continue}return ie(G,String(v),N,S)}-1<(F=($=oe($,S,10,G.s)).indexOf("."))?$=$.replace(".",""):F=$.length}for(D=0;$.charCodeAt(D)===48;D++);for(V=$.length;$.charCodeAt(--V)===48;);if($=$.slice(D,++V)){if(V-=D,N&&j.DEBUG&&15<V&&(w<v||v!==u(v)))throw Error(h+G.s*v);if(J<(F=F-D-1))G.c=G.e=null;else if(F<q)G.c=[G.e=0];else{if(G.e=F,G.c=[],D=(F+1)%g,F<0&&(D+=g),D<V){for(D&&G.c.push(+$.slice(0,D)),V-=g;D<V;)G.c.push(+$.slice(D,D+=g));$=$.slice(D),D=g-$.length}else D-=V;for(;D--;$+="0");G.c.push(+$)}}else G.c=[G.e=0]}function Ke(v,S,A,W){var H,F,D,N,V;if(A==null?A=P:x(A,0,8),!v.c)return v.toString();if(H=v.c[0],D=v.e,S==null)V=O(v.c),V=W==1||W==2&&(D<=Y||B<=D)?U(V,D):Z(V,D,"0");else if(F=(v=He(new j(v),S,A)).e,N=(V=O(v.c)).length,W==1||W==2&&(S<=F||F<=Y)){for(;N<S;V+="0",N++);V=U(V,F)}else if(S-=D,V=Z(V,F,"0"),N<F+1){if(0<--S)for(V+=".";S--;V+="0");}else if(0<(S+=F-N))for(F+1==N&&(V+=".");S--;V+="0");return v.s<0&&H?"-"+V:V}function $e(v,S){for(var A,W=1,H=new j(v[0]);W<v.length;W++){if(!(A=new j(v[W])).s){H=A;break}S.call(H,A)&&(H=A)}return H}function ye(v,S,A){for(var W=1,H=S.length;!S[--H];S.pop());for(H=S[0];10<=H;H/=10,W++);return(A=W+A*g-1)>J?v.c=v.e=null:v.c=A<q?[v.e=0]:(v.e=A,S),v}function He(v,S,A,W){var H,F,D,N,V,$,G,se=v.c,ge=C;if(se){e:{for(H=1,N=se[0];10<=N;N/=10,H++);if((F=S-H)<0)F+=g,D=S,G=(V=se[$=0])/ge[H-D-1]%10|0;else if(($=l((F+1)/g))>=se.length){if(!W)break e;for(;se.length<=$;se.push(0));V=G=0,D=(F%=g)-g+(H=1)}else{for(V=N=se[$],H=1;10<=N;N/=10,H++);G=(D=(F%=g)-g+H)<0?0:V/ge[H-D-1]%10|0}if(W=W||S<0||se[$+1]!=null||(D<0?V:V%ge[H-D-1]),W=A<4?(G||W)&&(A==0||A==(v.s<0?3:2)):5<G||G==5&&(A==4||W||A==6&&(0<F?0<D?V/ge[H-D]:0:se[$-1])%10&1||A==(v.s<0?8:7)),S<1||!se[0])return se.length=0,W?(S-=v.e+1,se[0]=ge[(g-S%g)%g],v.e=-S||0):se[0]=v.e=0,v;if(F==0?(se.length=$,N=1,$--):(se.length=$+1,N=ge[g-F],se[$]=0<D?u(V/ge[H-D]%ge[D])*N:0),W)for(;;){if($==0){for(F=1,D=se[0];10<=D;D/=10,F++);for(D=se[0]+=N,N=1;10<=D;D/=10,N++);F!=N&&(v.e++,se[0]==f&&(se[0]=1));break}if(se[$]+=N,se[$]!=f)break;se[$--]=0,N=1}for(F=se.length;se[--F]===0;se.pop());}v.e>J?v.c=v.e=null:v.e<q&&(v.c=[v.e=0])}return v}function Re(v){var S,A=v.e;return A===null?v.toString():(S=O(v.c),S=A<=Y||B<=A?U(S,A):Z(S,A,"0"),v.s<0?"-"+S:S)}return j.clone=z,j.ROUND_UP=0,j.ROUND_DOWN=1,j.ROUND_CEIL=2,j.ROUND_FLOOR=3,j.ROUND_HALF_UP=4,j.ROUND_HALF_DOWN=5,j.ROUND_HALF_EVEN=6,j.ROUND_HALF_CEIL=7,j.ROUND_HALF_FLOOR=8,j.EUCLID=9,j.config=j.set=function(v){var S,A;if(v!=null){if(typeof v!="object")throw Error(c+"Object expected: "+v);if(v.hasOwnProperty(S="DECIMAL_PLACES")&&(x(A=v[S],0,y,S),M=A),v.hasOwnProperty(S="ROUNDING_MODE")&&(x(A=v[S],0,8,S),P=A),v.hasOwnProperty(S="EXPONENTIAL_AT")&&((A=v[S])&&A.pop?(x(A[0],-y,0,S),x(A[1],0,y,S),Y=A[0],B=A[1]):(x(A,-y,y,S),Y=-(B=A<0?-A:A))),v.hasOwnProperty(S="RANGE"))if((A=v[S])&&A.pop)x(A[0],-y,-1,S),x(A[1],1,y,S),q=A[0],J=A[1];else{if(x(A,-y,y,S),!A)throw Error(c+S+" cannot be zero: "+A);q=-(J=A<0?-A:A)}if(v.hasOwnProperty(S="CRYPTO")){if((A=v[S])!==!!A)throw Error(c+S+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw X=!A,Error(c+"crypto unavailable");X=A}else X=A}if(v.hasOwnProperty(S="MODULO_MODE")&&(x(A=v[S],0,9,S),fe=A),v.hasOwnProperty(S="POW_PRECISION")&&(x(A=v[S],0,y,S),Oe=A),v.hasOwnProperty(S="FORMAT")){if(typeof(A=v[S])!="object")throw Error(c+S+" not an object: "+A);Ee=A}if(v.hasOwnProperty(S="ALPHABET")){if(typeof(A=v[S])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(c+S+" invalid: "+A);Pe=A}}return{DECIMAL_PLACES:M,ROUNDING_MODE:P,EXPONENTIAL_AT:[Y,B],RANGE:[q,J],CRYPTO:X,MODULO_MODE:fe,POW_PRECISION:Oe,FORMAT:Ee,ALPHABET:Pe}},j.isBigNumber=function(v){return v instanceof j||v&&v._isBigNumber===!0||!1},j.maximum=j.max=function(){return $e(arguments,p.lt)},j.minimum=j.min=function(){return $e(arguments,p.gt)},j.random=(he=9007199254740992,Te=Math.random()*he&2097151?function(){return u(Math.random()*he)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(v){var S,A,W,H,F,D=0,N=[],V=new j(E);if(v==null?v=M:x(v,0,y),H=l(v/g),X)if(crypto.getRandomValues){for(S=crypto.getRandomValues(new Uint32Array(H*=2));D<H;)9e15<=(F=131072*S[D]+(S[D+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),S[D]=A[0],S[D+1]=A[1]):(N.push(F%1e14),D+=2);D=H/2}else{if(!crypto.randomBytes)throw X=!1,Error(c+"crypto unavailable");for(S=crypto.randomBytes(H*=7);D<H;)9e15<=(F=281474976710656*(31&S[D])+1099511627776*S[D+1]+4294967296*S[D+2]+16777216*S[D+3]+(S[D+4]<<16)+(S[D+5]<<8)+S[D+6])?crypto.randomBytes(7).copy(S,D):(N.push(F%1e14),D+=7);D=H/7}if(!X)for(;D<H;)(F=Te())<9e15&&(N[D++]=F%1e14);for(H=N[--D],v%=g,H&&v&&(F=C[g-v],N[D]=u(H/F)*F);N[D]===0;N.pop(),D--);if(D<0)N=[W=0];else{for(W=-1;N[0]===0;N.splice(0,1),W-=g);for(D=1,F=N[0];10<=F;F/=10,D++);D<g&&(W-=g-D)}return V.e=W,V.c=N,V}),j.sum=function(){for(var v=1,S=arguments,A=new j(S[0]);v<S.length;)A=A.plus(S[v++]);return A},oe=function(){var v="0123456789";function S(A,W,H,F){for(var D,N,V=[0],$=0,G=A.length;$<G;){for(N=V.length;N--;V[N]*=W);for(V[0]+=F.indexOf(A.charAt($++)),D=0;D<V.length;D++)V[D]>H-1&&(V[D+1]==null&&(V[D+1]=0),V[D+1]+=V[D]/H|0,V[D]%=H)}return V.reverse()}return function(A,W,H,F,D){var N,V,$,G,se,ge,be,xe,Ve=A.indexOf("."),St=M,Qe=P;for(0<=Ve&&(G=Oe,Oe=0,A=A.replace(".",""),ge=(xe=new j(W)).pow(A.length-Ve),Oe=G,xe.c=S(Z(O(ge.c),ge.e,"0"),10,H,v),xe.e=xe.c.length),$=G=(be=S(A,W,H,D?(N=Pe,v):(N=v,Pe))).length;be[--G]==0;be.pop());if(!be[0])return N.charAt(0);if(Ve<0?--$:(ge.c=be,ge.e=$,ge.s=F,be=(ge=te(ge,xe,St,Qe,H)).c,se=ge.r,$=ge.e),Ve=be[V=$+St+1],G=H/2,se=se||V<0||be[V+1]!=null,se=Qe<4?(Ve!=null||se)&&(Qe==0||Qe==(ge.s<0?3:2)):G<Ve||Ve==G&&(Qe==4||se||Qe==6&&1&be[V-1]||Qe==(ge.s<0?8:7)),V<1||!be[0])A=se?Z(N.charAt(1),-St,N.charAt(0)):N.charAt(0);else{if(be.length=V,se)for(--H;++be[--V]>H;)be[V]=0,V||(++$,be=[1].concat(be));for(G=be.length;!be[--G];);for(Ve=0,A="";Ve<=G;A+=N.charAt(be[Ve++]));A=Z(A,$,N.charAt(0))}return A}}(),te=function(){function v(W,H,F){var D,N,V,$,G=0,se=W.length,ge=H%b,be=H/b|0;for(W=W.slice();se--;)G=((N=ge*(V=W[se]%b)+(D=be*V+($=W[se]/b|0)*ge)%b*b+G)/F|0)+(D/b|0)+be*$,W[se]=N%F;return G&&(W=[G].concat(W)),W}function S(W,H,F,D){var N,V;if(F!=D)V=D<F?1:-1;else for(N=V=0;N<F;N++)if(W[N]!=H[N]){V=W[N]>H[N]?1:-1;break}return V}function A(W,H,F,D){for(var N=0;F--;)W[F]-=N,N=W[F]<H[F]?1:0,W[F]=N*D+W[F]-H[F];for(;!W[0]&&1<W.length;W.splice(0,1));}return function(W,H,F,D,N){var V,$,G,se,ge,be,xe,Ve,St,Qe,ct,_t,Sa,Bl,Vt,dn,ms,xn=W.s==H.s?1:-1,tn=W.c,yt=H.c;if(!(tn&&tn[0]&&yt&&yt[0]))return new j(W.s&&H.s&&(tn?!yt||tn[0]!=yt[0]:yt)?tn&&tn[0]==0||!yt?0*xn:xn/0:NaN);for(St=(Ve=new j(xn)).c=[],xn=F+($=W.e-H.e)+1,N||(N=f,$=_(W.e/g)-_(H.e/g),xn=xn/g|0),G=0;yt[G]==(tn[G]||0);G++);if(yt[G]>(tn[G]||0)&&$--,xn<0)St.push(1),se=!0;else{for(Bl=tn.length,dn=yt.length,xn+=2,1<(ge=u(N/(yt[G=0]+1)))&&(yt=v(yt,ge,N),tn=v(tn,ge,N),dn=yt.length,Bl=tn.length),Sa=dn,ct=(Qe=tn.slice(0,dn)).length;ct<dn;Qe[ct++]=0);ms=yt.slice(),ms=[0].concat(ms),Vt=yt[0],yt[1]>=N/2&&Vt++;do{if(ge=0,(V=S(yt,Qe,dn,ct))<0){if(_t=Qe[0],dn!=ct&&(_t=_t*N+(Qe[1]||0)),1<(ge=u(_t/Vt)))for(N<=ge&&(ge=N-1),xe=(be=v(yt,ge,N)).length,ct=Qe.length;S(be,Qe,xe,ct)==1;)ge--,A(be,dn<xe?ms:yt,xe,N),xe=be.length,V=1;else ge==0&&(V=ge=1),xe=(be=yt.slice()).length;if(xe<ct&&(be=[0].concat(be)),A(Qe,be,ct,N),ct=Qe.length,V==-1)for(;S(yt,Qe,dn,ct)<1;)ge++,A(Qe,dn<ct?ms:yt,ct,N),ct=Qe.length}else V===0&&(ge++,Qe=[0]);St[G++]=ge,Qe[0]?Qe[ct++]=tn[Sa]||0:(Qe=[tn[Sa]],ct=1)}while((Sa++<Bl||Qe[0]!=null)&&xn--);se=Qe[0]!=null,St[0]||St.splice(0,1)}if(N==f){for(G=1,xn=St[0];10<=xn;xn/=10,G++);He(Ve,F+(Ve.e=G+$*g-1)+1,D,se)}else Ve.e=$,Ve.r=+se;return Ve}}(),ze=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ne=/^([^.]+)\.$/,R=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ie=function(v,S,A,W){var H,F=A?S:S.replace(m,"");if(d.test(F))v.s=isNaN(F)?null:F<0?-1:1,v.c=v.e=null;else{if(!A&&(F=F.replace(ze,function(D,N,V){return H=(V=V.toLowerCase())=="x"?16:V=="b"?2:8,W&&W!=H?D:N}),W&&(H=W,F=F.replace(Ne,"$1").replace(R,"0.$1")),S!=F))return new j(F,H);if(j.DEBUG)throw Error(c+"Not a"+(W?" base "+W:"")+" number: "+S);v.c=v.e=v.s=null}},p.absoluteValue=p.abs=function(){var v=new j(this);return v.s<0&&(v.s=1),v},p.comparedTo=function(v,S){return I(this,new j(v,S))},p.decimalPlaces=p.dp=function(v,S){var A,W,H;if(v!=null)return x(v,0,y),S==null?S=P:x(S,0,8),He(new j(this),v+this.e+1,S);if(!(A=this.c))return null;if(W=((H=A.length-1)-_(this.e/g))*g,H=A[H])for(;H%10==0;H/=10,W--);return W<0&&(W=0),W},p.dividedBy=p.div=function(v,S){return te(this,new j(v,S),M,P)},p.dividedToIntegerBy=p.idiv=function(v,S){return te(this,new j(v,S),0,1)},p.exponentiatedBy=p.pow=function(v,S){var A,W,H,F,D,N,V,$,G=this;if((v=new j(v)).c&&!v.isInteger())throw Error(c+"Exponent not an integer: "+Re(v));if(S!=null&&(S=new j(S)),D=14<v.e,!G.c||!G.c[0]||G.c[0]==1&&!G.e&&G.c.length==1||!v.c||!v.c[0])return $=new j(Math.pow(+Re(G),D?2-k(v):+Re(v))),S?$.mod(S):$;if(N=v.s<0,S){if(S.c?!S.c[0]:!S.s)return new j(NaN);(W=!N&&G.isInteger()&&S.isInteger())&&(G=G.mod(S))}else{if(9<v.e&&(0<G.e||G.e<-1||(G.e==0?1<G.c[0]||D&&24e7<=G.c[1]:G.c[0]<8e13||D&&G.c[0]<=9999975e7)))return F=G.s<0&&k(v)?-0:0,-1<G.e&&(F=1/F),new j(N?1/F:F);Oe&&(F=l(Oe/g+2))}for(V=D?(A=new j(.5),N&&(v.s=1),k(v)):(H=Math.abs(+Re(v)))%2,$=new j(E);;){if(V){if(!($=$.times(G)).c)break;F?$.c.length>F&&($.c.length=F):W&&($=$.mod(S))}if(H){if((H=u(H/2))===0)break;V=H%2}else if(He(v=v.times(A),v.e+1,1),14<v.e)V=k(v);else{if((H=+Re(v))==0)break;V=H%2}G=G.times(G),F?G.c&&G.c.length>F&&(G.c.length=F):W&&(G=G.mod(S))}return W?$:(N&&($=E.div($)),S?$.mod(S):F?He($,Oe,P,void 0):$)},p.integerValue=function(v){var S=new j(this);return v==null?v=P:x(v,0,8),He(S,S.e+1,v)},p.isEqualTo=p.eq=function(v,S){return I(this,new j(v,S))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(v,S){return 0<I(this,new j(v,S))},p.isGreaterThanOrEqualTo=p.gte=function(v,S){return(S=I(this,new j(v,S)))===1||S===0},p.isInteger=function(){return!!this.c&&_(this.e/g)>this.c.length-2},p.isLessThan=p.lt=function(v,S){return I(this,new j(v,S))<0},p.isLessThanOrEqualTo=p.lte=function(v,S){return(S=I(this,new j(v,S)))===-1||S===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(v,S){var A,W,H,F,D=this,N=D.s;if(S=(v=new j(v,S)).s,!N||!S)return new j(NaN);if(N!=S)return v.s=-S,D.plus(v);var V=D.e/g,$=v.e/g,G=D.c,se=v.c;if(!V||!$){if(!G||!se)return G?(v.s=-S,v):new j(se?D:NaN);if(!G[0]||!se[0])return se[0]?(v.s=-S,v):new j(G[0]?D:P==3?-0:0)}if(V=_(V),$=_($),G=G.slice(),N=V-$){for((H=(F=N<0)?(N=-N,G):($=V,se)).reverse(),S=N;S--;H.push(0));H.reverse()}else for(W=(F=(N=G.length)<(S=se.length))?N:S,N=S=0;S<W;S++)if(G[S]!=se[S]){F=G[S]<se[S];break}if(F&&(H=G,G=se,se=H,v.s=-v.s),0<(S=(W=se.length)-(A=G.length)))for(;S--;G[A++]=0);for(S=f-1;N<W;){if(G[--W]<se[W]){for(A=W;A&&!G[--A];G[A]=S);--G[A],G[W]+=f}G[W]-=se[W]}for(;G[0]==0;G.splice(0,1),--$);return G[0]?ye(v,G,$):(v.s=P==3?-1:1,v.c=[v.e=0],v)},p.modulo=p.mod=function(v,S){var A,W,H=this;return v=new j(v,S),!H.c||!v.s||v.c&&!v.c[0]?new j(NaN):!v.c||H.c&&!H.c[0]?new j(H):(fe==9?(W=v.s,v.s=1,A=te(H,v,0,3),v.s=W,A.s*=W):A=te(H,v,0,fe),(v=H.minus(A.times(v))).c[0]||fe!=1||(v.s=H.s),v)},p.multipliedBy=p.times=function(v,S){var A,W,H,F,D,N,V,$,G,se,ge,be,xe,Ve,St,Qe=this,ct=Qe.c,_t=(v=new j(v,S)).c;if(!(ct&&_t&&ct[0]&&_t[0]))return!Qe.s||!v.s||ct&&!ct[0]&&!_t||_t&&!_t[0]&&!ct?v.c=v.e=v.s=null:(v.s*=Qe.s,ct&&_t?(v.c=[0],v.e=0):v.c=v.e=null),v;for(W=_(Qe.e/g)+_(v.e/g),v.s*=Qe.s,(V=ct.length)<(se=_t.length)&&(xe=ct,ct=_t,_t=xe,H=V,V=se,se=H),H=V+se,xe=[];H--;xe.push(0));for(Ve=f,St=b,H=se;0<=--H;){for(A=0,ge=_t[H]%St,be=_t[H]/St|0,F=H+(D=V);H<F;)A=(($=ge*($=ct[--D]%St)+(N=be*$+(G=ct[D]/St|0)*ge)%St*St+xe[F]+A)/Ve|0)+(N/St|0)+be*G,xe[F--]=$%Ve;xe[F]=A}return A?++W:xe.splice(0,1),ye(v,xe,W)},p.negated=function(){var v=new j(this);return v.s=-v.s||null,v},p.plus=function(v,S){var A,W=this,H=W.s;if(S=(v=new j(v,S)).s,!H||!S)return new j(NaN);if(H!=S)return v.s=-S,W.minus(v);var F=W.e/g,D=v.e/g,N=W.c,V=v.c;if(!F||!D){if(!N||!V)return new j(H/0);if(!N[0]||!V[0])return V[0]?v:new j(N[0]?W:0*H)}if(F=_(F),D=_(D),N=N.slice(),H=F-D){for((A=0<H?(D=F,V):(H=-H,N)).reverse();H--;A.push(0));A.reverse()}for((H=N.length)-(S=V.length)<0&&(A=V,V=N,N=A,S=H),H=0;S;)H=(N[--S]=N[S]+V[S]+H)/f|0,N[S]=f===N[S]?0:N[S]%f;return H&&(N=[H].concat(N),++D),ye(v,N,D)},p.precision=p.sd=function(v,S){var A,W,H;if(v!=null&&v!==!!v)return x(v,1,y),S==null?S=P:x(S,0,8),He(new j(this),v,S);if(!(A=this.c))return null;if(W=(H=A.length-1)*g+1,H=A[H]){for(;H%10==0;H/=10,W--);for(H=A[0];10<=H;H/=10,W++);}return v&&this.e+1>W&&(W=this.e+1),W},p.shiftedBy=function(v){return x(v,-w,w),this.times("1e"+v)},p.squareRoot=p.sqrt=function(){var v,S,A,W,H,F=this,D=F.c,N=F.s,V=F.e,$=M+4,G=new j("0.5");if(N!==1||!D||!D[0])return new j(!N||N<0&&(!D||D[0])?NaN:D?F:1/0);if((A=(N=Math.sqrt(+Re(F)))==0||N==1/0?(((S=O(D)).length+V)%2==0&&(S+="0"),N=Math.sqrt(+S),V=_((V+1)/2)-(V<0||V%2),new j(S=N==1/0?"1e"+V:(S=N.toExponential()).slice(0,S.indexOf("e")+1)+V)):new j(N+"")).c[0]){for((N=(V=A.e)+$)<3&&(N=0);;)if(H=A,A=G.times(H.plus(te(F,H,$,1))),O(H.c).slice(0,N)===(S=O(A.c)).slice(0,N)){if(A.e<V&&--N,(S=S.slice(N-3,N+1))!="9999"&&(W||S!="4999")){+S&&(+S.slice(1)||S.charAt(0)!="5")||(He(A,A.e+M+2,1),v=!A.times(A).eq(F));break}if(!W&&(He(H,H.e+M+2,0),H.times(H).eq(F))){A=H;break}$+=4,N+=4,W=1}}return He(A,A.e+M+1,P,v)},p.toExponential=function(v,S){return v!=null&&(x(v,0,y),v++),Ke(this,v,S,1)},p.toFixed=function(v,S){return v!=null&&(x(v,0,y),v=v+this.e+1),Ke(this,v,S)},p.toFormat=function(v,S,A){var W;if(A==null)v!=null&&S&&typeof S=="object"?(A=S,S=null):v&&typeof v=="object"?(A=v,v=S=null):A=Ee;else if(typeof A!="object")throw Error(c+"Argument not an object: "+A);if(W=this.toFixed(v,S),this.c){var H,F=W.split("."),D=+A.groupSize,N=+A.secondaryGroupSize,V=A.groupSeparator||"",$=F[0],G=F[1],se=this.s<0,ge=se?$.slice(1):$,be=ge.length;if(N&&(H=D,D=N,be-=N=H),0<D&&0<be){for(H=be%D||D,$=ge.substr(0,H);H<be;H+=D)$+=V+ge.substr(H,D);0<N&&($+=V+ge.slice(H)),se&&($="-"+$)}W=G?$+(A.decimalSeparator||"")+((N=+A.fractionGroupSize)?G.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):G):$}return(A.prefix||"")+W+(A.suffix||"")},p.toFraction=function(v){var S,A,W,H,F,D,N,V,$,G,se,ge,be=this,xe=be.c;if(v!=null&&(!(N=new j(v)).isInteger()&&(N.c||N.s!==1)||N.lt(E)))throw Error(c+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+Re(N));if(!xe)return new j(be);for(S=new j(E),$=A=new j(E),W=V=new j(E),ge=O(xe),F=S.e=ge.length-be.e-1,S.c[0]=C[(D=F%g)<0?g+D:D],v=!v||0<N.comparedTo(S)?0<F?S:$:N,D=J,J=1/0,N=new j(ge),V.c[0]=0;G=te(N,S,0,1),(H=A.plus(G.times(W))).comparedTo(v)!=1;)A=W,W=H,$=V.plus(G.times(H=$)),V=H,S=N.minus(G.times(H=S)),N=H;return H=te(v.minus(A),W,0,1),V=V.plus(H.times($)),A=A.plus(H.times(W)),V.s=$.s=be.s,se=te($,W,F*=2,P).minus(be).abs().comparedTo(te(V,A,F,P).minus(be).abs())<1?[$,W]:[V,A],J=D,se},p.toNumber=function(){return+Re(this)},p.toPrecision=function(v,S){return v!=null&&x(v,1,y),Ke(this,v,S,2)},p.toString=function(v){var S,A=this,W=A.s,H=A.e;return H===null?W?(S="Infinity",W<0&&(S="-"+S)):S="NaN":(S=v==null?H<=Y||B<=H?U(O(A.c),H):Z(O(A.c),H,"0"):v===10?Z(O((A=He(new j(A),M+H+1,P)).c),A.e,"0"):(x(v,2,Pe.length,"Base"),oe(Z(O(A.c),H,"0"),10,v,W,!0)),W<0&&A.c[0]&&(S="-"+S)),S},p.valueOf=p.toJSON=function(){return Re(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),K!=null&&j.set(K),j}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(_,O){return function(I){if(Array.isArray(I))return I}(_)||function(I,x){var k=[],U=!0,Z=!1,z=void 0;try{for(var K,te=I[Symbol.iterator]();!(U=(K=te.next()).done)&&(k.push(K.value),!x||k.length!==x);U=!0);}catch(oe){Z=!0,z=oe}finally{try{U||te.return==null||te.return()}finally{if(Z)throw z}}return k}(_,O)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(_){var O=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},I=2<arguments.length?arguments[2]:void 0;if(typeof O=="string"&&(O=l.parseFormat(O)),!a.validateFormat(O))return"ERROR: invalid format";var x=O.prefix||"",k=O.postfix||"",U=function(Z,z,K){switch(z.output){case"currency":return z=y(z,s.currentCurrencyDefaultFormat()),function(Pe,j,Ke){var $e=Ke.currentCurrency(),ye=Object.assign({},h,j),He=void 0,Re="",v=!!ye.totalLength||!!ye.forceAverage||ye.average,S=j.currencyPosition||$e.position,A=j.currencySymbol||$e.symbol;ye.spaceSeparated&&(Re=" "),S==="infix"&&(He=Re+A+Re);var W=b({instance:Pe,providedFormat:j,state:Ke,decimalSeparator:He});return S==="prefix"&&(W=Pe._value<0&&ye.negative==="sign"?"-".concat(Re).concat(A).concat(W.slice(1)):A+Re+W),S&&S!=="postfix"||(W=W+(Re=v?"":Re)+A),W}(Z,z,s);case"percent":return z=y(z,s.currentPercentageDefaultFormat()),function(Pe,j,Ke,$e){var ye=j.prefixSymbol,He=b({instance:$e(100*Pe._value),providedFormat:j,state:Ke}),Re=Object.assign({},h,j);return ye?"%".concat(Re.spaceSeparated?" ":"").concat(He):"".concat(He).concat(Re.spaceSeparated?" ":"","%")}(Z,z,s,K);case"byte":return z=y(z,s.currentByteDefaultFormat()),E=Z,P=s,Y=K,B=(M=z).base||"binary",q=c[B],J=g(E._value,q.suffixes,q.scale),X=J.value,fe=J.suffix,Oe=b({instance:Y(X),providedFormat:M,state:P,defaults:P.currentByteDefaultFormat()}),Ee=P.currentAbbreviations(),"".concat(Oe).concat(Ee.spaced?" ":"").concat(fe);case"time":return z=y(z,s.currentTimeDefaultFormat()),R=Z,d=Math.floor(R._value/60/60),m=Math.floor((R._value-60*d*60)/60),p=Math.round(R._value-60*d*60-60*m),"".concat(d,":").concat(m<10?"0":"").concat(m,":").concat(p<10?"0":"").concat(p);case"ordinal":return z=y(z,s.currentOrdinalDefaultFormat()),te=Z,oe=z,he=(ie=s).currentOrdinal(),Te=Object.assign({},h,oe),ze=b({instance:te,providedFormat:oe,state:ie}),Ne=he(te._value),"".concat(ze).concat(Te.spaceSeparated?" ":"").concat(Ne);case"number":default:return b({instance:Z,providedFormat:z,numbro:K})}var te,oe,ie,he,Te,ze,Ne,R,d,m,p,E,M,P,Y,B,q,J,X,fe,Oe,Ee}(_,O,I);return U=(U=x+U)+k}function g(_,O,I){var x=O[0],k=Math.abs(_);if(I<=k){for(var U=1;U<O.length;++U){var Z=Math.pow(I,U),z=Math.pow(I,U+1);if(Z<=k&&k<z){x=O[U],_/=Z;break}}x===O[0]&&(_/=Math.pow(I,O.length-1),x=O[O.length-1])}return{value:_,suffix:x}}function w(_){for(var O="",I=0;I<_;I++)O+="0";return O}function C(_,O){return _.toString().indexOf("e")!==-1?function(I,x){var k=I.toString(),U=o(k.split("e"),2),Z=U[0],z=U[1],K=o(Z.split("."),2),te=K[0],oe=K[1],ie=oe===void 0?"":oe;if(0<+z)k=te+ie+w(z-ie.length);else{var he=".";he=+te<0?"-0".concat(he):"0".concat(he);var Te=(w(-z-1)+Math.abs(te)+ie).substr(0,x);Te.length<x&&(Te+=w(x-Te.length)),k=he+Te}return 0<+z&&0<x&&(k+=".".concat(w(x))),k}(_,O):(Math.round(+"".concat(_,"e+").concat(O))/Math.pow(10,O)).toFixed(O)}function b(_){var O=_.instance,I=_.providedFormat,x=_.state,k=x===void 0?s:x,U=_.decimalSeparator,Z=_.defaults,z=Z===void 0?k.currentDefaults():Z,K=O._value;if(K===0&&k.hasZeroFormat())return k.getZeroFormat();if(!isFinite(K))return K.toString();var te,oe,ie,he,Te,ze,Ne,R,d=Object.assign({},h,z,I),m=d.totalLength,p=m?0:d.characteristic,E=d.optionalCharacteristic,M=d.forceAverage,P=!!m||!!M||d.average,Y=m?-1:P&&I.mantissa===void 0?0:d.mantissa,B=!m&&(I.optionalMantissa===void 0?Y===-1:d.optionalMantissa),q=d.trimMantissa,J=d.thousandSeparated,X=d.spaceSeparated,fe=d.negative,Oe=d.forceSign,Ee=d.exponential,Pe="";if(P){var j=function(v){var S=v.value,A=v.forceAverage,W=v.abbreviations,H=v.spaceSeparated,F=H!==void 0&&H,D=v.totalLength,N=D===void 0?0:D,V="",$=Math.abs(S),G=-1;if($>=Math.pow(10,12)&&!A||A==="trillion"?(V=W.trillion,S/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!A||A==="billion"?(V=W.billion,S/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!A||A==="million"?(V=W.million,S/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!A||A==="thousand")&&(V=W.thousand,S/=Math.pow(10,3)),V&&(V=(F?" ":"")+V),N){var se=S.toString().split(".")[0];G=Math.max(N-se.length,0)}return{value:S,abbreviation:V,mantissaPrecision:G}}({value:K,forceAverage:M,abbreviations:k.currentAbbreviations(),spaceSeparated:X,totalLength:m});K=j.value,Pe+=j.abbreviation,m&&(Y=j.mantissaPrecision)}if(Ee){var Ke=(oe=(te={value:K,characteristicPrecision:p}).value,ie=te.characteristicPrecision,he=ie===void 0?0:ie,Te=o(oe.toExponential().split("e"),2),ze=Te[0],Ne=Te[1],R=+ze,he&&1<he&&(R*=Math.pow(10,he-1),Ne=0<=(Ne=+Ne-(he-1))?"+".concat(Ne):Ne),{value:R,abbreviation:"e".concat(Ne)});K=Ke.value,Pe=Ke.abbreviation+Pe}var $e,ye,He,Re=function(v,S,A,W,H){if(W===-1)return v;var F=C(S,W),D=o(F.toString().split("."),2),N=D[0],V=D[1],$=V===void 0?"":V;if($.match(/^0+$/)&&(A||H))return N;var G=$.match(/0+$/);return H&&G?"".concat(N,".").concat($.toString().slice(0,G.index)):F.toString()}(K.toString(),K,B,Y,q);return Re=function(v,S,A,W,H){var F=W.currentDelimiters(),D=F.thousands;H=H||F.decimal;var N=F.thousandsSize||3,V=v.toString(),$=V.split(".")[0],G=V.split(".")[1];return A&&(S<0&&($=$.slice(1)),function(se,ge){for(var be=[],xe=0,Ve=se;0<Ve;Ve--)xe===ge&&(be.unshift(Ve),xe=0),xe++;return be}($.length,N).forEach(function(se,ge){$=$.slice(0,se+ge)+D+$.slice(se+ge)}),S<0&&($="-".concat($))),V=G?$+H+G:$}(Re=function(v,S,A,W){var H=v,F=o(H.toString().split("."),2),D=F[0],N=F[1];if(D.match(/^-?0$/)&&A)return N?"".concat(D.replace("0",""),".").concat(N):D.replace("0","");if(D.length<W)for(var V=W-D.length,$=0;$<V;$++)H="0".concat(H);return H.toString()}(Re,0,E,p),K,J,k,U),(P||Ee)&&(Re=Re+Pe),(Oe||K<0)&&($e=Re,He=fe,Re=(ye=K)===0?$e:+$e==0?$e.replace("-",""):0<ye?"+".concat($e):He==="sign"?$e:"(".concat($e.replace("-",""),")")),Re}function y(_,O){if(!_)return O;var I=Object.keys(_);return I.length===1&&I[0]==="output"?O:_}r.exports=function(_){return{format:function(){for(var O=arguments.length,I=new Array(O),x=0;x<O;x++)I[x]=arguments[x];return f.apply(void 0,I.concat([_]))},getByteUnit:function(){for(var O=arguments.length,I=new Array(O),x=0;x<O;x++)I[x]=arguments[x];return(function(k){var U=c.general;return g(k._value,U.suffixes,U.scale).suffix}).apply(void 0,I.concat([_]))},getBinaryByteUnit:function(){for(var O=arguments.length,I=new Array(O),x=0;x<O;x++)I[x]=arguments[x];return(function(k){var U=c.binary;return g(k._value,U.suffixes,U.scale).suffix}).apply(void 0,I.concat([_]))},getDecimalByteUnit:function(){for(var O=arguments.length,I=new Array(O),x=0;x<O;x++)I[x]=arguments[x];return(function(k){var U=c.decimal;return g(k._value,U.suffixes,U.scale).suffix}).apply(void 0,I.concat([_]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,f={};function g(C){u=C}function w(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return w().currency},l.currentAbbreviations=function(){return w().abbreviations},l.currentDelimiters=function(){return w().delimiters},l.currentOrdinal=function(){return w().ordinal},l.currentDefaults=function(){return Object.assign({},w().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().timeFormat)},l.setDefaults=function(C){C=a.parseFormat(C),s.validateFormat(C)&&(f=C)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(C){return h=typeof C=="string"?C:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(C){if(C){if(c[C])return c[C];throw new Error('Unknown tag "'.concat(C,'"'))}return w()},l.registerLanguage=function(C){var b=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(C))throw new Error("Invalid language data");c[C.languageTag]=C,b&&g(C.languageTag)},l.setLanguage=function(C){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[C]){var y=C.split("-")[0],_=Object.keys(c).find(function(O){return O.split("-")[0]===y});return c[_]?void g(_):void g(b)}g(C)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.plus(w).toNumber(),c;var c,h,f,g,w},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.times(w).toNumber(),c;var c,h,f,g,w},divide:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.dividedBy(w).toNumber(),c;var c,h,f,g,w},set:function(l,u){return c=l,f=h=u,a.isNumbro(h)&&(f=h._value),c._value=f,c;var c,h,f},difference:function(l,u){return c=u,s(f=(h=a)(l._value),c,h),Math.abs(f._value);var c,h,f}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(b,y){for(var _=0;_<y.length;_++){var O=y[_];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(b,O.key,O)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(C),u=n("./unformatting"),c=n("./formatting")(C),h=n("./manipulating")(C),f=n("./parsing"),g=function(){function b(O){(function(I,x){if(!(I instanceof x))throw new TypeError("Cannot call a class as a function")})(this,b),this._value=O}var y,_;return y=b,(_=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var O=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,O)}},{key:"formatCurrency",value:function(O){return typeof O=="string"&&(O=f.parseFormat(O)),(O=c.formatOrDefault(O,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,O)}},{key:"formatTime",value:function(){var O=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return O.output="time",c.format(this,O)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(O){return h.difference(this,O)}},{key:"add",value:function(O){return h.add(this,O)}},{key:"subtract",value:function(O){return h.subtract(this,O)}},{key:"multiply",value:function(O){return h.multiply(this,O)}},{key:"divide",value:function(O){return h.divide(this,O)}},{key:"set",value:function(O){return h.set(this,w(O))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(y.prototype,_),b}();function w(b){var y=b;return C.isNumbro(b)?y=b._value:typeof b=="string"?y=C.unformat(b):isNaN(b)&&(y=NaN),y}function C(b){return new g(w(b))}C.version="2.1.2",C.isNumbro=function(b){return b instanceof g},C.language=s.currentLanguage,C.registerLanguage=s.registerLanguage,C.setLanguage=s.setLanguage,C.languages=s.languages,C.languageData=s.languageData,C.zeroFormat=s.setZeroFormat,C.defaultFormat=s.currentDefaults,C.setDefaults=s.setDefaults,C.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,C.validate=a.validate,C.loadLanguagesInNode=l.loadLanguagesInNode,C.unformat=u.unformat,r.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,f,g,w,C,b,y,_,O,I,x,k,U,Z,z,K=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=K,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=K,function(te,oe){if(te.indexOf("$")===-1){if(te.indexOf("%")===-1)return te.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):te.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):te.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):te.indexOf(":")===-1?te.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,K),f=K,(g=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+g[0]),w=K,(C=o.split(".")[0].match(/0+/))&&(w.characteristic=C[0].length),function(te,oe){if(te.indexOf(".")!==-1){var ie=te.split(".")[0];oe.optionalCharacteristic=ie.indexOf("0")===-1}}(o,K),b=K,o.indexOf("a")!==-1&&(b.average=!0),_=K,(y=o).indexOf("K")!==-1?_.forceAverage="thousand":y.indexOf("M")!==-1?_.forceAverage="million":y.indexOf("B")!==-1?_.forceAverage="billion":y.indexOf("T")!==-1&&(_.forceAverage="trillion"),function(te,oe){var ie=te.split(".")[1];if(ie){var he=ie.match(/0+/);he&&(oe.mantissa=he[0].length)}}(o,K),I=K,(O=o).match(/\[\.]/)?I.optionalMantissa=!0:O.match(/\./)&&(I.optionalMantissa=!1),x=K,o.indexOf(",")!==-1&&(x.thousandSeparated=!0),k=K,o.indexOf(" ")!==-1&&(k.spaceSeparated=!0),Z=K,(U=o).match(/^\+?\([^)]*\)$/)&&(Z.negative="parenthesis"),U.match(/^\+?-/)&&(Z.negative="sign"),z=K,o.match(/^\+/)&&(z.forceSign=!0),K)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,w=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function C(b,y){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",O=3<arguments.length?arguments[3]:void 0,I=4<arguments.length?arguments[4]:void 0,x=5<arguments.length?arguments[5]:void 0,k=6<arguments.length?arguments[6]:void 0;if(!isNaN(+b))return+b;var U="",Z=b.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(Z!==b)return-1*C(Z,y,_,O,I,x,k);for(var z=0;z<o.length;z++){var K=o[z];if((U=b.replace(K.key,""))!==b)return C(U,y,_,O,I,x,k)*K.factor}if((U=b.replace("%",""))!==b)return C(U,y,_,O,I,x,k)/100;var te=parseFloat(b);if(!isNaN(te)){var oe=O(te);if(oe&&oe!=="."&&(U=b.replace(new RegExp("".concat(s(oe),"$")),""))!==b)return C(U,y,_,O,I,x,k);var ie={};Object.keys(x).forEach(function(m){ie[x[m]]=m});for(var he=Object.keys(ie).sort().reverse(),Te=he.length,ze=0;ze<Te;ze++){var Ne=he[ze],R=ie[Ne];if((U=b.replace(Ne,""))!==b){var d=void 0;switch(R){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return C(U,y,_,O,I,x,k)*d}}}}(function(C,b){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=C.replace(y,"");return _=(_=_.replace(new RegExp("([0-9])".concat(s(b.thousands),"([0-9])"),"g"),"$1$2")).replace(b.decimal,".")}(l,u,c),u,c,h,f,g,w)}r.exports={unformat:function(l,u){var c,h,f,g=n("./globalState"),w=g.currentDelimiters(),C=g.currentCurrency().symbol,b=g.currentOrdinal(),y=g.getZeroFormat(),_=g.currentAbbreviations(),O=void 0;if(typeof l=="string")O=function(I,x){if(!I.indexOf(":")||x.thousands===":")return!1;var k=I.split(":");if(k.length!==3)return!1;var U=+k[0],Z=+k[1],z=+k[2];return!isNaN(U)&&!isNaN(Z)&&!isNaN(z)}(l,w)?(c=l.split(":"),h=+c[0],f=+c[1],+c[2]+60*f+3600*h):a(l,w,C,b,y,_,u);else{if(typeof l!="number")return;O=l}if(O!==void 0)return O}}},{"./globalState":4}],10:[function(n,r,i){function o(w){return function(C){if(Array.isArray(C)){for(var b=0,y=new Array(C.length);b<C.length;b++)y[b]=C[b];return y}}(w)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(w){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(w)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(w,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(w){return w.output==="byte"}},characteristic:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(w){return 0<=w},message:"value must be positive"},{restriction:function(w,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(w,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(w){return w.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(w){return!!a.unformat(w)}function f(w,C,b){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],_=Object.keys(w).map(function(O){if(!C[O])return console.error("".concat(b," Invalid key: ").concat(O)),!1;var I=w[O],x=C[O];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!f(I,u,"[Validate ".concat(O,"]"),!0))return!1}else if(s(I)!==x.type)return console.error("".concat(b," ").concat(O,' type mismatched: "').concat(x.type,'" expected, "').concat(s(I),'" provided')),!1;if(x.restrictions&&x.restrictions.length)for(var k=x.restrictions.length,U=0;U<k;U++){var Z=x.restrictions[U],z=Z.restriction,K=Z.message;if(!z(I,w))return console.error("".concat(b," ").concat(O," invalid value: ").concat(K)),!1}return x.restriction&&!x.restriction(I,w)?(console.error("".concat(b," ").concat(O," invalid value: ").concat(x.message)),!1):x.validValues&&x.validValues.indexOf(I)===-1?(console.error("".concat(b," ").concat(O," invalid value: must be among ").concat(JSON.stringify(x.validValues),', "').concat(I,'" provided')),!1):!(x.children&&!f(I,x.children,"[Validate ".concat(O,"]")))});return y||_.push.apply(_,o(Object.keys(C).map(function(O){var I=C[O];if(typeof I=="string"&&(I={type:I}),I.mandatory){var x=I.mandatory;if(typeof x=="function"&&(x=x(w)),x&&w[O]===void 0)return console.error("".concat(b,' Missing mandatory key "').concat(O,'"')),!1}return!0}))),_.reduce(function(O,I){return O&&I},!0)}function g(w){return f(w,u,"[Validate format]")}r.exports={validate:function(w,C){var b=h(w),y=g(C);return b&&y},validateFormat:g,validateInput:h,validateLanguage:function(w){return f(w,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(Y1);var U6=Y1.exports;const Ts=GC(U6),G6="numeric";function sb(t,e,n,r,i,o,s){let a=o;if(Vn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",f=h.length?h.split(" "):[];if(typeof u<"u"&&!Ts.languages()[u]){const g=u.replace("-",""),w=Ts.allLanguages?Ts.allLanguages[u]:Ts[g];w&&Ts.registerLanguage(w)}Ts.setLanguage(u),a=Ts(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}Oo(t,e,n,r,i,a,s)}sb.RENDERER_TYPE=G6;const z6="password";function ab(t,e,n,r,i,o,s){Oo.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";ve(a-1,()=>{u+=l}),ga(e,u)}ab.RENDERER_TYPE=z6;const Y6="time";function lb(t,e,n,r,i,o,s){Oo.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}lb.RENDERER_TYPE=Y6;function j6(){yi(Fl),yi(Wc),yi(ib),yi(rb),yi(sb),yi(ab),yi(Oo),yi(lb)}const K6="autocomplete";function Tg(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,E0(n,e)):E0(n,e)(this.source):e(!0)}Tg.VALIDATOR_TYPE=K6;function E0(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function j1(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const X6=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:j1},Symbol.toStringTag,{value:"Module"})),q6="date";function ub(t,e){const n=dI(F1,this.instance);let r=t,i=!0;r==null&&(r="");let o=Q(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Q(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=Z6(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}ub.VALIDATOR_TYPE=q6;function Z6(t,e){const n=Q(j1(t)),r=Q(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const Q6="numeric";function cb(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Vn(t))}cb.VALIDATOR_TYPE=Q6;const J6=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],e9="time";function hb(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Q(i,J6,!0).isValid()?Q(i):Q(i,n);let a=s.isValid(),l=Q(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}hb.VALIDATOR_TYPE=e9;function t9(){pl(Tg),pl(ub),pl(cb),pl(hb)}const n9="autocomplete",r9={CELL_TYPE:n9,editor:tb,renderer:Fl,validator:Tg},i9="checkbox",o9={CELL_TYPE:i9,editor:k1,renderer:ib},s9="date";function K1(t,e,n,r,i,o,s){Fl.apply(this,[t,e,n,r,i,o,s])}K1.RENDERER_TYPE=s9;const a9="date",l9={CELL_TYPE:a9,editor:W1,renderer:K1,validator:ub},u9="dropdown",c9={CELL_TYPE:u9,editor:nb,renderer:Fl,validator:Tg},h9="handsontable";function X1(t,e,n,r,i,o,s){Fl.apply(this,[t,e,n,r,i,o,s])}X1.RENDERER_TYPE=h9;const d9="handsontable",f9={CELL_TYPE:d9,editor:eb,renderer:X1},g9="numeric",m9={CELL_TYPE:g9,editor:V1,renderer:sb,validator:cb,dataType:"number"},p9="password",w9={CELL_TYPE:p9,editor:B1,renderer:ab,copyable:!1},C9="select";function q1(t,e,n,r,i,o,s){Oo.apply(this,[t,e,n,r,i,o,s])}q1.RENDERER_TYPE=C9;const v9="select",S9={CELL_TYPE:v9,editor:U1,renderer:q1},y9="time",b9={CELL_TYPE:y9,editor:G1,renderer:lb,validator:hb};function R9(){br(r9),br(o9),br(l9),br(c9),br(f9),br(m9),br(w9),br(S9),br(L1),br(b9)}function E9(t,e){Z1(t,e),e.add(t)}function T9(t,e,n){Z1(t,e),e.set(t,n)}function Z1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pa(t,e,n){return e=_9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _9(t){var e=M9(t,"string");return typeof e=="symbol"?e:String(e)}function M9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function A9(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function xa(t,e){var n=O9(t,e,"get");return P9(t,n)}function O9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function P9(t,e){return e.get?e.get.call(t):e.value}const T0=new Map([["plugin",CY],["cell-type",_1],["editor",hI],["renderer",SI],["validator",yI]]),x9="base",tp=[];let di=null;var _s=new WeakMap,_0=new WeakSet;class ot{static get PLUGIN_KEY(){return x9}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){E9(this,_0),Pa(this,"eventManager",new pr(this)),Pa(this,"pluginName",null),Pa(this,"pluginsInitializedCallbacks",[]),Pa(this,"isPluginsReady",!1),Pa(this,"enabled",!1),Pa(this,"initialized",!1),T9(this,_s,{writable:!0,value:{}}),Li(this,"hot",e,{writable:!1}),di=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!T0.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);T0.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");tp.push(o)}}if(di||(di=Zv()),di.indexOf("UndoRedo")>=0&&di.splice(di.indexOf("UndoRedo"),1),di.indexOf(this.pluginName)>=0&&di.splice(di.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),di.length===0){if(tp.length>0){const i=[`${tp.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){xa(this,_s)[e]=xa(this,_s)[e]||[];const r=xa(this,_s)[e];this.hot.addHook(e,n),r.push(n),xa(this,_s)[e]=r}removeHooks(e){T(xa(this,_s)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=xa(this,_s);Ge(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){T(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=A9(this,_0,I9).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ge(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function I9(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ms(t,e,n){return e=H9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H9(t){var e=D9(t,"string");return typeof e=="symbol"?e:String(e)}function D9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let N9=class{constructor(e){Ms(this,"hot",null),Ms(this,"container",null),Ms(this,"injected",!1),Ms(this,"rows",[]),Ms(this,"columns",[]),Ms(this,"samples",null),Ms(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),T(this.rows,n=>{e(n.row,xt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),T(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{T(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{T(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{T(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),T(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{T(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),ee(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return ee(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const db=N9;function xh(t,e,n){return e=L9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L9(t){var e=k9(t,"string");return typeof e=="symbol"?e:String(e)}function k9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fb{static get SAMPLE_COUNT(){return 3}constructor(e){xh(this,"samples",null),xh(this,"dataFactory",null),xh(this,"customSampleCount",null),xh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:fb.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return ve(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return ve(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let f;h?f=c:Be(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Ft(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const g=i.get(f);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}const Q1=fb;function Ia(t,e){J1(t,e),e.add(t)}function $9(t,e,n){J1(t,e),e.set(t,n)}function J1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ha(t,e,n){return e=F9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F9(t){var e=W9(t,"string");return typeof e=="symbol"?e:String(e)}function W9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V9(t,e,n){var r=eH(t,e,"set");return B9(t,r,n),n}function B9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ih(t,e){var n=eH(t,e,"get");return U9(t,n)}function eH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function U9(t,e){return e.get?e.get.call(t):e.value}function As(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("modifyAutoColumnSizeSeed");const ou="autoColumnSize",G9=10,z9="autoColumnSize";var cl=new WeakMap,M0=new WeakSet,A0=new WeakSet,O0=new WeakSet,np=new WeakSet,P0=new WeakSet,x0=new WeakSet;class zu extends ot{static get PLUGIN_KEY(){return ou}static get PLUGIN_PRIORITY(){return G9}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Ia(this,x0),Ia(this,P0),Ia(this,np),Ia(this,O0),Ia(this,A0),Ia(this,M0),Ha(this,"ghostTable",new db(this.hot)),Ha(this,"samplesGenerator",new Q1((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),Ha(this,"firstCalculation",!0),Ha(this,"inProgress",!1),Ha(this,"measuredColumns",0),Ha(this,"columnWidthsMap",new gs),$9(this,cl,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(z9,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>As(this,np,I0).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[ou]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[ou];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return As(e,A0,j9).call(e,...i)}),this.addHook("beforeChangeRender",r=>As(this,O0,K9).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>As(this,x0,q9).call(this,r)),this.addHook("beforeViewRender",r=>As(this,M0,Y9).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>As(this,P0,X9).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>As(this,np,I0).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;ve(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);T(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){gc(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+zu.CALCULATION_STEP,r)},e),n=n+zu.CALCULATION_STEP+1,n<r?i=pg(o):(gc(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[ou],n=e&&Pt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[ou];let n=zu.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Be(e)&&(n=e.syncLimit,Pv(n)?n=Xv(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,eS.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Gt(e,(r,i,o)=>{const s=Ih(this,cl).length;return(s-1<o||Ih(this,cl)[o]!==i)&&r.push(o),s-1<o?Ih(this,cl).push(i):Ih(this,cl)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{T(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!mr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Y9(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function j9(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function K9(t){const e=Ue(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function I0(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function X9(){V9(this,cl,this.hot.getColHeader())}function q9(t){const e=mr(t,r=>{var i;return ce((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ue(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const qs={horizontal:"horizontal",vertical:"vertical"};function Z9(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function Q9(t){const e={};return t===!0?(e.directions=Object.keys(qs),e.autoInsertRow=!0):Be(t)?(ce(t.autoInsertRow)?t.direction===qs.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ce(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(qs)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function su(t,e){J9(t,e),e.add(t)}function J9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Da(t,e,n){return e=e7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e7(t){var e=t7(t,"string");return typeof e=="symbol"?e:String(e)}function t7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function au(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("modifyAutofillRange");me.getSingleton().register("beforeAutofill");me.getSingleton().register("afterAutofill");const H0="autofill",n7=20,r7=["fillHandle"],i7="insert_row_below",o7=200;var D0=new WeakSet,N0=new WeakSet,L0=new WeakSet,k0=new WeakSet,$0=new WeakSet;class s7 extends ot{constructor(){super(...arguments),su(this,$0),su(this,k0),su(this,L0),su(this,N0),su(this,D0),Da(this,"addingStarted",!1),Da(this,"mouseDownOnCellCorner",!1),Da(this,"mouseDragOutside",!1),Da(this,"handleDraggedCells",0),Da(this,"directions",[]),Da(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return H0}static get PLUGIN_PRIORITY(){return n7}static get SETTING_KEYS(){return[H0,...r7]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>au(this,N0,l7).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>au(this,D0,a7).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>au(this,L0,u7).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return T(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),T(a,c=>{const h=[];T(l,f=>{h.push(this.hot.getCopyableData(c,f))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:f}=Z9(l,u,(g,w)=>this.hot._createCellCoords(g,w));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),w=o.clone(),C=this.hot._createCellRange(h,h,f),b=this.hot.runHooks("beforeAutofill",g,w,C,c);if(b===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=b;const _=b;if(["up","left"].indexOf(c)>-1&&!(_.length===1&&_[0].length===0))if(y=[],c==="up"){const O=f.row-h.row+1,I=O%_.length;for(let x=0;x<O;x++)y.push(_[(x+(_.length-I))%_.length])}else{const O=f.col-h.col+1,I=O%_[0].length;for(let x=0;x<_.length;x++){y.push([]);for(let k=0;k<O;k++)y[x].push(_[x][(k+(_[x].length-I))%_[x].length])}}this.hot.populateFromArray(h.row,h.col,y,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,w,C,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(qs.vertical)&&this.directions.includes(qs.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(qs.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(qs.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(i7,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},o7)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=jt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+xt(this.hot.table),i=jt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+dt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>au(this,k0,c7).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>au(this,$0,h7).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Q9(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function a7(){this.selectAdjacent()&&this.fillIn()}function l7(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function u7(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function c7(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function h7(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Hh(t,e){d7(t,e),e.add(t)}function d7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Os(t,e,n){return e=f7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f7(t){var e=g7(t,"string");return typeof e=="symbol"?e:String(e)}function g7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Dh="autoRowSize",m7=40,p7="autoRowSize";var F0=new WeakSet,rp=new WeakSet,W0=new WeakSet,V0=new WeakSet;class Yu extends ot{static get PLUGIN_KEY(){return Dh}static get PLUGIN_PRIORITY(){return m7}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Hh(this,V0),Hh(this,W0),Hh(this,rp),Hh(this,F0),Os(this,"headerHeight",null),Os(this,"ghostTable",new db(this.hot)),Os(this,"samplesGenerator",new Q1((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),Os(this,"firstCalculation",!0),Os(this,"inProgress",!1),Os(this,"measuredRows",0),Os(this,"rowHeightsMap",new gs),this.hot.rowIndexMapper.registerMap(p7,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>lu(this,rp,B0).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Dh];return e===!0||Be(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return lu(e,W0,C7).call(e,...r)}),this.addHook("beforeChangeRender",n=>lu(this,V0,v7).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>lu(this,F0,w7).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>lu(this,rp,B0).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}ve(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);T(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){gc(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+Yu.CALCULATION_STEP,r)},e),n=n+Yu.CALCULATION_STEP+1,n<r?i=pg(o):(gc(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Dh],n=e&&Pt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){us(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Dh];let n=Yu.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Be(e)&&(n=e.syncLimit,Pv(n)?n=Xv(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ve(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!mr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function w7(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function B0(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function C7(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function v7(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:S7,getListWithRemovedItems:y7}=i1("physicallyIndexed");class b7 extends ma{constructor(){super(e=>e)}insert(e,n){const r=_S(this.indexedValues,n);this.indexedValues=S7(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=y7(this.indexedValues,e);this.indexedValues=TS(n,e),super.remove(e)}}const R7=b7,{getListWithInsertedItems:E7,getListWithRemovedItems:T7}=i1("physicallyIndexed");class _7 extends ma{constructor(){super(e=>e)}insert(e,n){this.indexedValues=E7(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=T7(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const M7=_7;function A7(t,e){O7(t,e),e.add(t)}function O7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function P7(t,e,n){return e=x7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x7(t){var e=I7(t,"string");return typeof e=="symbol"?e:String(e)}function I7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ip="bindRowsWithHeaders",D7=210,N7="loose",L7=new Map([["loose",R7],["strict",M7]]);var U0=new WeakSet;class k7 extends ot{constructor(){super(...arguments),A7(this,U0),P7(this,"headerIndexes",null)}static get PLUGIN_KEY(){return ip}static get PLUGIN_PRIORITY(){return D7}isEnabled(){return!!this.hot.getSettings()[ip]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[ip];typeof e!="string"&&(e=N7);const n=L7.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>H7(this,U0,$7).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function $7(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Nh(t,e){tH(t,e),e.add(t)}function F7(t,e,n){tH(t,e),e.set(t,n)}function tH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function G0(t,e,n){return e=W7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W7(t){var e=V7(t,"string");return typeof e=="symbol"?e:String(e)}function V7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function z0(t,e){var n=nH(t,e,"get");return B7(t,n)}function B7(t,e){return e.get?e.get.call(t):e.value}function Lh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function op(t,e,n){var r=nH(t,e,"set");return U7(t,r,n),n}function nH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function U7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const xd="collapsibleColumns",G7=290,z7=["nestedHeaders"],bl="collapsibleIndicator",Y0=xd,j0=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Na=new WeakMap,K0=new WeakSet,X0=new WeakSet,q0=new WeakSet,Z0=new WeakSet;class Y7 extends ot{constructor(){super(...arguments),Nh(this,Z0),Nh(this,q0),Nh(this,X0),Nh(this,K0),G0(this,"nestedHeadersPlugin",null),G0(this,"headerStateManager",null),F7(this,Na,{writable:!0,value:null})}static get PLUGIN_KEY(){return xd}static get PLUGIN_PRIORITY(){return G7}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[xd,...z7]}isEnabled(){return!!this.hot.getSettings()[xd]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||vt("You need to configure the Nested Headers plugin in order to use collapsible headers."),op(this,Na,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Lh(this,q0,X7).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lh(e,Z0,q7).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Lh(e,K0,j7).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Lh(this,X0,K7).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),op(this,Na,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:Y0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Y0)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};ve(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;ve(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${bl}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${bl}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${bl}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!j0.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=mr(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;T(r,f=>{var g;let{row:w,col:C}=f;const{collapsible:b,isCollapsed:y}=(g=this.headerStateManager.getHeaderSettings(w,C))!==null&&g!==void 0?g:{};if(!b||y&&n==="collapse"||!y&&n==="expand")return i=!1,!1});const o=[],s=[];i&&T(r,f=>{let{row:g,col:w}=f;const{colspanCompensation:C,affectedColumns:b,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,g,w);C>0&&(s.push(...b),o.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=Av([...a,...s]):n==="expand"&&(l=mr(a,f=>!s.includes(f)));const u=j0.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){T(o,f=>{f()});return}this.hot.batchExecution(()=>{T(s,f=>{z0(this,Na).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return z0(this,Na).getHiddenIndexes()}destroy(){op(this,Na,null),super.destroy()}}function j7(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${bl}`);if(fa(e,[Ar("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ee(u,bl),e.querySelector("div:first-child").appendChild(u)),ke(u,["collapsed","expanded"]),s?(ee(u,"collapsed"),ls(u,"+"),l&&Me(e,...Ar(!1))):(ee(u,"expanded"),ls(u,"-"),l&&Me(e,...Ar(!0))),l&&Me(u,...To());else{var c;(c=u)===null||c===void 0||c.remove()}}function K7(t,e){De(t.target,bl)&&(De(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):De(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Hr(t))}function X7(){this.updatePlugin()}function q7(t,e){e||this.updatePlugin()}function Ps(t,e,n){return e=Z7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z7(t){var e=Q7(t,"string");return typeof e=="symbol"?e:String(e)}function Q7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const J7=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],e8=!1,t8=!0,n8=!0;class r8{constructor(e,n){Ps(this,"hot",void 0),Ps(this,"sortingStates",new vg),Ps(this,"sortEmptyCells",e8),Ps(this,"indicator",t8),Ps(this,"headerAction",n8),Ps(this,"compareFunctionFactory",void 0),Ps(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Be(e)&&Ge(e,(n,r)=>{J7.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Be(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ce(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const pf="asc",wf="desc",rH="colHeader";function i8(t){if(Be(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[pf,wf].includes(n)}function o8(t){if(t.some(n=>i8(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function Q0(t){if(t!==wf)return t===pf?wf:pf}function iH(t){return t.querySelector(`.${rH}`)}function oH(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function gb(t,e,n){return t===-1&&e>=0&&cs(n)===!1}const s8="ascending",a8="descending",sH="indicatorDisabled",aH="columnSorting",lH="sortAction",uH=new Map([[pf,s8],[wf,a8]]);function l8(t,e,n,r){const i=[aH];if(r&&i.push(lH),n===!1)return i.push(sH),i;const o=t.getSortOrderOfColumn(e);return ce(o)&&i.push(uH.get(o)),i}function u8(){return Array.from(uH.values()).concat(lH,sH,aH)}function cH(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Pi:en(i)?en(o)?Pi:s&&t==="asc"?kt:$t:en(o)?s&&t==="asc"?$t:kt:isNaN(i)&&!isNaN(o)?t==="asc"?$t:kt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?kt:$t:i>o?t==="asc"?$t:kt:Pi}}const hH="default";function c8(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Pi;if(a){if(en(r))return t==="asc"?kt:$t;if(en(i))return t==="asc"?$t:kt}return isNaN(o)?$t:isNaN(s)?kt:o<s?t==="asc"?kt:$t:o>s?t==="asc"?$t:kt:Pi}}const h8="numeric";function d8(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=en(s),u=en(a),c=l?i:s,h=u?i:a,f=c===i||c===r,g=h===i||h===r;if(o===!1){if(l&&u===!1)return $t;if(l===!1&&u)return kt}return f===!1&&g?t==="asc"?kt:$t:f&&g===!1?t==="asc"?$t:kt:f===!1&&g===!1?cH(t,e,n)(s,a):c===i&&h===r?t==="asc"?kt:$t:c===r&&h===i?t==="asc"?$t:kt:Pi}}const f8="checkbox";function g8(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Pi;if(en(r))return en(i)?Pi:o&&t==="asc"?kt:$t;if(en(i))return o&&t==="asc"?$t:kt;const s=e.dateFormat,a=Q(r,s),l=Q(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?kt:$t:l.isBefore(a)?t==="asc"?$t:kt:Pi:kt:$t}}const m8="date",{register:_g,getItem:J0,hasItem:p8}=oi("sorting.compareFunctionFactory"),{register:dH,getItem:w8}=oi("sorting.mainSortComparator");function fH(t){return p8(t)?J0(t):J0(hH)}_g(h8,c8);_g(f8,d8);_g(m8,g8);_g(hH,cH);const Pi=0,kt=-1,$t=1;function C8(t,e){const n=w8(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function v8(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:fH(u.type))(l,u,f)(c,h)}(0)}}function kh(t,e){S8(t,e),e.add(t)}function S8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $h(t,e,n){return e=y8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y8(t){var e=b8(t,"string");return typeof e=="symbol"?e:String(e)}function b8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Cf="columnSorting",R8=50,vf="append",E8="replace",eT=Cf;dH(Cf,v8);me.getSingleton().register("beforeColumnSort");me.getSingleton().register("afterColumnSort");var Id=new WeakSet,tT=new WeakSet,nT=new WeakSet,rT=new WeakSet;class gH extends ot{constructor(){super(...arguments),kh(this,rT),kh(this,nT),kh(this,tT),kh(this,Id),$h(this,"columnStatesManager",null),$h(this,"columnMetaCache",null),$h(this,"pluginKey",Cf),$h(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Cf}static get PLUGIN_PRIORITY(){return R8}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new r8(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new gs(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>hl(this,tT,T8).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hl(e,rT,M8).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>hl(this,Id,SC).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hl(e,nT,_8).call(e,...r)}),this.hot.view&&hl(this,Id,SC).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=iH(r);oH(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:eT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eT)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new o1),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ce(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return o8(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ce(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ce(n)){const i=Q0(n);return ce(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:Q0()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vf;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ct(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===vf)return[...o.slice(0,r),...o.slice(r+1),s];if(n===E8)return[...o.slice(0,r),s,...o.slice(r+1)]}return ce(s)?o.concat(s):o}getPluginColumnConfig(e){if(Be(e)){const n=e[this.pluginKey];if(Be(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):wt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);C8(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Be(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Be(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ke(e,u8()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];ee(e,l8(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ce(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&De(e.target,rH)}onAfterOnCellMouseDown(e,n){gb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function SC(){const t=this.getAllSavedSortSettings();if(Be(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function T8(t,e){const n=iH(e);if(oH(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Me(e,...VG(s?`${s}ending`:"none"))}}function _8(t){t===!0&&this.hot.view&&hl(this,Id,SC).call(this)}function M8(t,e,n,r){gb(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function xs(t,e,n){return e=A8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A8(t){var e=O8(t,"string");return typeof e=="symbol"?e:String(e)}function O8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P8{constructor(e,n){xs(this,"plugin",void 0),xs(this,"hot",void 0),xs(this,"endpoints",[]),xs(this,"settings",void 0),xs(this,"settingsType","array"),xs(this,"currentEndpoint",null),xs(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),T(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();T(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;T(u,f=>{a==="row"&&f.destinationRow>=h&&(f.alterRowOffset=l*r),a==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?T(u,f=>{this.extendEndpointRanges(f,h,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):T(u,f=>{this.shiftEndpointCoordinates(f,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){T(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];T(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),T(i,o=>{let s=[];T(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,T(e.ranges,r=>{T(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],T(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],T(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],T(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&T(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),T(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){vt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const x8=P8;function sp(t){return t==null||isNaN(t)}function ap(t,e){I8(t,e),e.add(t)}function I8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H8(t,e,n){return e=D8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D8(t){var e=N8(t,"string");return typeof e=="symbol"?e:String(e)}function N8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const up="columnSummary",L8=220;var iT=new WeakSet,oT=new WeakSet,sT=new WeakSet;class k8 extends ot{constructor(){super(...arguments),ap(this,sT),ap(this,oT),ap(this,iT),H8(this,"endpoints",null)}static get PLUGIN_KEY(){return up}static get PLUGIN_PRIORITY(){return L8}isEnabled(){return!!this.hot.getSettings()[up]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[up],this.endpoints=new x8(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return lp(e,iT,$8).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return lp(e,oT,F8).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return lp(e,sT,W8).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ge(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=sp(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ge(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=sp(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=sp(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ge(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ft`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function $8(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function F8(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function W8(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function La(t,e,n){return e=V8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V8(t){var e=B8(t,"string");return typeof e=="symbol"?e:String(e)}function B8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){La(this,"rootDocument",void 0),La(this,"isRtl",!1),La(this,"container",null),La(this,"editor",void 0),La(this,"editorStyle",void 0),La(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:dt(this.getInputElement()),height:xt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ee(this.container,Cl.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ee(e,Cl.CLASS_EDITOR),ee(n,Cl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Cl.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const U8=Cl;function cp(t,e,n){return e=G8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G8(t){var e=z8(t,"string");return typeof e=="symbol"?e:String(e)}function z8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Y8=250,j8=250;class mH{constructor(e){cp(this,"wasLastActionShow",!0),cp(this,"showDebounced",null),cp(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},j8)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Y8;this.showDebounced=cg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}mt(mH,sr);const K8=mH;function X8(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function q8(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Is(t,e){const n={};return T(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Uo(t,e,n,r,i){T(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Z8(s,a,e,n,r,i)})})}function Z8(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=X8(s.className,r):a=q8(s.className,r)),o(t,e,"className",a)}function ro(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Ei(t,e){let n=!1;return Array.isArray(t)&&T(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function Mg(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const je="---------";function Q8(){return{name:je}}const Tr="alignment";function J8(){return{key:Tr,name(){return this.getTranslatedPhrase(QS)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Tr}:left`,name(){let t=this.getTranslatedPhrase(JS);return Ei(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Is(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Uo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Tr}:center`,name(){let t=this.getTranslatedPhrase(ey);return Ei(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Is(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Uo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Tr}:right`,name(){let t=this.getTranslatedPhrase(ty);return Ei(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Is(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Uo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Tr}:justify`,name(){let t=this.getTranslatedPhrase(ny);return Ei(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Is(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Uo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:je},{key:`${Tr}:top`,name(){let t=this.getTranslatedPhrase(ry);return Ei(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Is(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Uo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Tr}:middle`,name(){let t=this.getTranslatedPhrase(iy);return Ei(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Is(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Uo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Tr}:bottom`,name(){let t=this.getTranslatedPhrase(oy);return Ei(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Is(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Uo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Ag="clear_column";function e5(){return{key:Ag,name(){return this.getTranslatedPhrase($S)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Vc="col_left";function t5(){return{key:Vc,name(){return this.getTranslatedPhrase(xS)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Bc="col_right";function n5(){return{key:Bc,name(){return this.getTranslatedPhrase(IS)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Uc="make_read_only";function r5(){return{key:Uc,name(){let t=this.getTranslatedPhrase(kS);return Ei(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ei(t,(n,r)=>this.getCellMeta(n,r).readOnly);T(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Og="redo";function i5(){return{key:Og,name(){return this.getTranslatedPhrase(LS)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Gc="remove_col";function o5(){return{key:Gc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(DS,e)},callback(){this.alter("remove_col",dq(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Pg="remove_row";function s5(){return{key:Pg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(HS,e)},callback(){this.alter("remove_row",fq(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const xg="row_above";function a5(){return{key:xg,name(){return this.getTranslatedPhrase(OS)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Ig="row_below";function l5(){return{key:Ig,name(){return this.getTranslatedPhrase(PS)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const wc="no_items";function u5(){return{key:wc,name(){return this.getTranslatedPhrase(AS)},disabled:!0,isCommand:!1}}const Hg="undo";function c5(){return{key:Hg,name(){return this.getTranslatedPhrase(NS)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const h5=[xg,Ig,Vc,Bc,Ag,Pg,Gc,Hg,Og,Uc,Tr,je,wc],d5={[je]:Q8,[wc]:u5,[xg]:a5,[Ig]:l5,[Vc]:t5,[Bc]:n5,[Ag]:e5,[Pg]:s5,[Gc]:o5,[Hg]:c5,[Og]:i5,[Uc]:r5,[Tr]:J8};function pH(){const t={};return Ge(d5,(e,n)=>{t[n]=e()}),t}function f5(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(XS):this.getTranslatedPhrase(KS)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function g5(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(qS)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function m5(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(ZS);return Ei(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Hd))?ro(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Hd);t.updateCommentMeta(n,r,{[Hd]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function fi(t,e){wH(t,e),e.add(t)}function Hs(t,e,n){wH(t,e),e.set(t,n)}function wH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function p5(t,e,n){return e=w5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w5(t){var e=C5(t,"string");return typeof e=="symbol"?e:String(e)}function C5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ho(t,e,n){var r=CH(t,e,"set");return v5(t,r,n),n}function v5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Je(t,e){var n=CH(t,e,"get");return S5(t,n)}function CH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function S5(t,e){return e.get?e.get.call(t):e.value}const ju="comments",y5=60,io="comment",Du="value",vH="style",Hd="readOnly",Fh=ju,yC=`plugin:${ju}`;var Rt=new WeakMap,zr=new WeakMap,Dg=new WeakMap,Dd=new WeakMap,Sf=new WeakMap,bC=new WeakMap,yf=new WeakMap,aT=new WeakSet,lT=new WeakSet,uT=new WeakSet,cT=new WeakSet,hT=new WeakSet,dT=new WeakSet,fT=new WeakSet,gT=new WeakSet,mT=new WeakSet,pT=new WeakSet;class b5 extends ot{constructor(){super(...arguments),fi(this,pT),fi(this,mT),fi(this,gT),fi(this,fT),fi(this,dT),fi(this,hT),fi(this,cT),fi(this,uT),fi(this,lT),fi(this,aT),p5(this,"range",{}),Hs(this,Rt,{writable:!0,value:null}),Hs(this,zr,{writable:!0,value:null}),Hs(this,Dg,{writable:!0,value:!1}),Hs(this,Dd,{writable:!0,value:!1}),Hs(this,Sf,{writable:!0,value:{}}),Hs(this,bC,{writable:!0,value:null}),Hs(this,yf,{writable:!0,value:""})}static get PLUGIN_KEY(){return ju}static get PLUGIN_PRIORITY(){return y5}isEnabled(){return!!this.hot.getSettings()[ju]}enablePlugin(){this.enabled||(Je(this,Rt)||ho(this,Rt,new U8(this.hot.rootDocument,this.hot.isRtl())),Je(this,zr)||ho(this,zr,new K8(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>gi(this,cT,_5).call(this,e,s)),this.addHook("afterScroll",()=>gi(this,pT,I5).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>gi(this,mT,x5).call(this,e)),Je(this,zr).addLocalHook("hide",()=>this.hide()),Je(this,zr).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Je(this,zr).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(yC);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ho(this,Dd,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(yC),this.hot._registerTimeout(()=>{ho(this,Dd,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!Je(this,Rt).isVisible()},group:Fh}),r.addShortcut({keys:[["Escape"]],callback:()=>{Je(this,Rt).setValue(Je(this,yf)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Je(this,Rt).isVisible()},group:Fh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Je(this,Rt).isVisible()},group:Fh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Fh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>gi(this,lT,E5).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>gi(this,aT,R5).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>gi(this,uT,T5).call(this)),this.eventManager.addEventListener(n,"focus",()=>gi(this,dT,A5).call(this)),this.eventManager.addEventListener(n,"blur",()=>gi(this,hT,M5).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>gi(this,fT,O5).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>gi(this,gT,P5).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=as(e.target,"TD","TBODY");return!!(n&&De(n,"htCommentCell")&&as(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Je(this,Rt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Du]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,io),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Du)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Du)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Je(this,zr).cancelHiding(),Je(this,Rt).setValue((e=i[io]?i[io][Du]:null)!==null&&e!==void 0?e:""),Je(this,Rt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Je(this,Rt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Je(this,Rt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;Je(this,Rt).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:w}}=this.hot,{wtTable:C}=w,b=w.getCell({row:l,col:u},!0),y=this.getCommentMeta(s,a,vH);y?Je(this,Rt).setSize(y.width,y.height):Je(this,Rt).resetSize();const _=f?0:C.getStretchedColumnWidth(u),O=c&&!h?xt(b):0,{left:I,top:x,width:k,height:U}=b.getBoundingClientRect(),{width:Z,height:z}=Je(this,Rt).getSize(),{innerWidth:K,innerHeight:te}=this.hot.rootWindow,oe=this.hot.rootDocument.documentElement;let ie=I+g.scrollX+_,he=x+g.scrollY+O;this.hot.isRtl()&&(ie-=Z+_),this.hot.isLtr()&&I+k+Z>K?ie=I+g.scrollX-Z-1:this.hot.isRtl()&&ie<-(oe.scrollWidth-oe.clientWidth)&&(ie=I+g.scrollX+_+1),x+z>te&&(he-=z-U+1),Je(this,Rt).setPosition(ie,he),Je(this,Rt).setReadOnlyState(this.getCommentMeta(s,a,Hd))}focusEditor(){Je(this,Rt).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[io];let o;i?(o=Mn(i),Nc(o,r)):o=r,this.hot.setCellMeta(e,n,io,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[io])return i[io][r]}addToContextMenu(e){e.items.push({name:je},f5(this),g5(this),m5(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[ju];if(Be(e))return e.displayDelay}getEditorInputElement(){return Je(this,Rt).getInputElement()}destroy(){Je(this,Rt)&&Je(this,Rt).destroy(),Je(this,zr)&&Je(this,zr).destroy(),super.destroy()}}function R5(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Je(this,Dg)&&!this.targetIsCommentTextArea(t)){const e=as(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function E5(t){const{rootDocument:e}=this.hot;if(!(Je(this,Dg)||Je(this,Rt).isFocused()||De(t.target,"wtBorder")||Je(this,bC)===t.target||!Je(this,Rt)))if(ho(this,bC,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Je(this,zr).show(n)}else ns(t.target,e)&&!this.targetIsCommentTextArea(t)&&Je(this,zr).hide()}function T5(){ho(this,Dg,!1)}function _5(t,e){e[io]&&e[io][Du]&&ee(t,e.commentedCellClassName)}function M5(){ho(this,yf,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function A5(){ho(this,yf,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(yC)}function O5(t){ho(this,Sf,{width:dt(t.target),height:xt(t.target)})}function P5(t){const e=dt(t.target),n=xt(t.target);(e!==Je(this,Sf).width+1||n!==Je(this,Sf).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[vH]:{width:e,height:n}})}function x5(t){Je(this,Rt).isVisible()&&Hr(t)}function I5(){Je(this,Dd)||this.hide()}var wT=eP,H5=TypeError,D5=function(t,e){if(!delete t[e])throw new H5("Cannot delete property "+wT(e)+" of "+wT(t))},N5=ca,L5=Uf,k5=zf,$5=wP,F5=D5,W5=CP,V5=[].unshift(0)!==1,B5=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},U5=V5||!B5();N5({target:"Array",proto:!0,arity:1,forced:U5},{unshift:function(e){var n=L5(this),r=k5(n),i=arguments.length;if(i){W5(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:F5(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return $5(n,r+i)}});function hp(t,e,n){return e=G5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G5(t){var e=z5(t,"string");return typeof e=="symbol"?e:String(e)}function z5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class SH{constructor(e){hp(this,"hot",void 0),hp(this,"commands",{}),hp(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Y5(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Pt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),T(u,c=>c.apply(this.hot,r))}}function Y5(t,e){let n;return T(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function dp(t,e,n){return e=j5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j5(t){var e=K5(t,"string");return typeof e=="symbol"?e:String(e)}function K5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;dp(this,"hot",void 0),dp(this,"predefinedItems",pH()),dp(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ge(e,(r,i)=>{let o="";r.name===je?(n[je]=r,o=je):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return X5(e,this.defaultOrderPattern,this.predefinedItems)}}function X5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Be(i)?Ge(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Be(o)?Kt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):T(i,(o,s)=>{let a=n[o];!a&&h5.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Be(o)&&Kt(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Do(t,e,n){return e=q5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q5(t){var e=Z5(t,"string");return typeof e=="symbol"?e:String(e)}function Z5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q5{constructor(e,n){Do(this,"top",void 0),Do(this,"topRelative",void 0),Do(this,"left",void 0),Do(this,"leftRelative",void 0),Do(this,"scrollTop",void 0),Do(this,"scrollLeft",void 0),Do(this,"cellHeight",void 0),Do(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function uu(t,e,n){J5(t,e),e.set(t,n)}function J5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){var n=bH(t,e,"get");return eZ(t,n)}function eZ(t,e){return e.get?e.get.call(t):e.value}function Wh(t,e,n){var r=bH(t,e,"set");return tZ(t,r,n),n}function bH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Dn=new WeakMap,No=new WeakMap,gn=new WeakMap,fp=new WeakMap,ka=new WeakMap;class nZ{constructor(e){uu(this,Dn,{writable:!0,value:void 0}),uu(this,No,{writable:!0,value:void 0}),uu(this,gn,{writable:!0,value:void 0}),uu(this,fp,{writable:!0,value:!1}),uu(this,ka,{writable:!0,value:{above:0,below:0,left:0,right:0}}),Wh(this,fp,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return qe(this,ka)[e]=n,this}setElement(e){return Wh(this,Dn,e),this}setParentElement(e){return Wh(this,No,e),this}updatePosition(e){Wh(this,gn,new Q5(e,qe(this,Dn).ownerDocument.defaultView)),qe(this,fp)?(qe(this,gn).fitsBelow(qe(this,Dn))?this.setPositionBelowCursor():qe(this,gn).fitsAbove(qe(this,Dn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){qe(this,Dn).dir==="rtl"?qe(this,gn).fitsOnLeft(qe(this,Dn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():qe(this,gn).fitsOnRight(qe(this,Dn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=qe(this,ka).above+qe(this,gn).top-qe(this,Dn).offsetHeight;qe(this,No)&&(e=qe(this,gn).top+qe(this,gn).cellHeight-qe(this,Dn).offsetHeight+3),qe(this,Dn).style.top=`${e}px`}setPositionBelowCursor(){let e=qe(this,ka).below+qe(this,gn).top+1;qe(this,No)&&(e=qe(this,gn).top-1),qe(this,Dn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=qe(this,gn).left;if(qe(this,No)){const{right:n}=qe(this,No).getBoundingClientRect();e+=qe(this,gn).cellWidth+n-(qe(this,gn).left+qe(this,gn).cellWidth)}else e+=qe(this,ka).right;qe(this,Dn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=qe(this,ka).left+qe(this,gn).left-qe(this,Dn).offsetWidth;if(qe(this,No)){const{left:n}=qe(this,No).getBoundingClientRect();e-=qe(this,gn).left-n}qe(this,Dn).style.left=`${e}px`}}function RH(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=ir(e,-1,w()-1);function a(b,y){const _=w()-1;return b<0&&(b=_),b>_&&(b=0),o.has(b)?-1:(o.add(b),r(b,!1)===!1&&(b=a(y===1?++b:--b,y)),b)}function l(b){b>-1&&b<w()&&r(b,!0)!==!1&&(s=b)}function u(){return s}function c(){w()>0&&(o.clear(),s=a(0,1))}function h(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function g(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:f,toPreviousItem:g,getSize:w,clear:C}}function rZ(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function RC(t){return Pt(t,"submenu")}function EC(t){return new RegExp(je,"i").test(t.name)}function Nd(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function CT(t){return Pt(t,"disableSelection")}function iZ(t){return De(t,"htSeparator")}function oZ(t){return De(t,"htSubmenu")}function sZ(t){return De(t,"htDisabled")}function aZ(t){return De(t,"htSelectionDisabled")}function lZ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function EH(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function uZ(t,e){let n=t.slice(0);return n.reverse(),n=EH(n,e),n.reverse(),n}function cZ(t){const e=[];return T(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function hZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,n=t.slice(0);return n=EH(n,e),n=uZ(n,e),n=cZ(n),n}function dZ(t){return RH({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||iZ(r)||sZ(r)||aZ(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function fZ(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const TH="menu",vT=TH;function gZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(fZ(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:TH})}function i(u,c){const h=a(c);u.forEach(f=>{let{keys:g}=f;g.forEach(w=>h.removeShortcutsByKeys(w))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${vT}:${u}`:vT}function a(u){var c;const h=t.hotMenu.getShortcutManager(),f=s(u);return(c=h.getContext(f))!==null&&c!==void 0?c:h.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function mZ(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(ri(n),ee(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!Nd(a,t)&&!CT(a)&&!EC(a);Me(n,[IG(),Iv(u),...c?[Dl(-1)]:[],...Nd(a,t)?[FG()]:[],...RC(a)?[Ar(!1)]:[]])}n.className="",n.appendChild(l),EC(a)?ee(n,"htSeparator"):typeof a.renderer=="function"?(ee(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):ga(l,u),Nd(a,t)?ee(n,"htDisabled"):CT(a)?ee(n,"htSelectionDisabled"):RC(a)&&ee(n,"htSubmenu")}}function ST(t,e,n){pZ(t,e),e.set(t,n)}function pZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mi(t,e,n){return e=wZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wZ(t){var e=CZ(t,"string");return typeof e=="symbol"?e:String(e)}function CZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yT(t,e,n){var r=_H(t,e,"set");return vZ(t,r,n),n}function vZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function cu(t,e){var n=_H(t,e,"get");return SZ(t,n)}function _H(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function SZ(t,e){return e.get?e.get.call(t):e.value}const bT=215;var hu=new WeakMap,Vh=new WeakMap;class Wl{constructor(e,n){var r=this;mi(this,"hot",void 0),mi(this,"options",void 0),mi(this,"eventManager",new pr(this)),mi(this,"container",void 0),mi(this,"positioner",void 0),mi(this,"hotMenu",null),mi(this,"hotSubMenus",{}),mi(this,"parentMenu",void 0),mi(this,"menuItems",null),mi(this,"origOutsideClickDeselects",null),ST(this,hu,{writable:!0,value:void 0}),ST(this,Vh,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:bT,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new nZ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=cc(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return cu(this,hu)}getKeyboardShortcutsCtrl(){return cu(this,Vh)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=cg(a=>this.openSubMenu(a),300),n=this.options.minWidth||bT;let r=!1,i=mr(this.menuItems,a=>(a.key===wc&&(r=!0),lZ(a,this.hot)));if(i.length<1&&!r)i.push(pH()[wc]);else if(i.length===0)return;i=hZ(i,je);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ce(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:mZ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{cu(this,hu).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===je?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),eC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!eC()||!cs(a))&&o&&this.hasSelectedItem()&&(co()||zv()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),yT(this,hu,dZ(this.hotMenu)),yT(this,Vh,gZ(this)),cu(this,Vh).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(cu(this,hu).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Me(r,[Ar(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!oZ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Wl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Me(n,[Ar(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Me(i,[Ar(!1)])}}closeAllSubMenus(){T(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?rZ(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||EC(e)||Nd(e,this.hot)||RC(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(wt(r)&&(r=r.call(this.hot),r===null||Ct(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),ee(i,`htMenu ${this.options.className}`),r&&ee(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Gt(n,(a,l)=>a+(l.name===je?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Me(this.hotMenu.rootElement,[xG(),Dl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ns(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ns(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&De(e.target,"htCore")&&ns(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mt(Wl,sr);function Bh(t,e){yZ(t,e),e.add(t)}function yZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gp(t,e,n){return e=bZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bZ(t){var e=RZ(t,"string");return typeof e=="symbol"?e:String(e)}function RZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Nu="contextMenu",EZ=70,RT=Nu;me.getSingleton().register("afterContextMenuDefaultOptions");me.getSingleton().register("beforeContextMenuShow");me.getSingleton().register("afterContextMenuShow");me.getSingleton().register("afterContextMenuHide");me.getSingleton().register("afterContextMenuExecute");var ET=new WeakSet,TT=new WeakSet,_T=new WeakSet,MT=new WeakSet;class Ng extends ot{constructor(){super(...arguments),Bh(this,MT),Bh(this,_T),Bh(this,TT),Bh(this,ET),gp(this,"commandExecutor",new SH(this.hot)),gp(this,"itemsFactory",null),gp(this,"menu",null)}static get PLUGIN_KEY(){return Nu}static get PLUGIN_PRIORITY(){return EZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[xg,Ig,je,Vc,Bc,je,Pg,Gc,je,Hg,Og,je,Uc,je,Tr]}isEnabled(){return!!this.hot.getSettings()[Nu]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Nu];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Wl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Uh(this,TT,_Z).call(this)),this.menu.addLocalHook("afterOpen",()=>Uh(this,_T,MZ).call(this)),this.menu.addLocalHook("afterClose",()=>Uh(this,MT,AZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Uh(this,ET,TZ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Mg(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:RT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(RT)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ge(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new yH(this.hot,Ng.DEFAULT_ITEMS);const e=this.hot.getSettings()[Nu],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),T(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function TZ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),De(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(De(o,"current")&&De(o,"wtBorder"))))return;const s=Mg(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function _Z(){this.hot.runHooks("beforeContextMenuShow",this)}function MZ(){this.hot.runHooks("afterContextMenuShow",this)}function AZ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Ng.SEPARATOR={name:je};function OZ(t){return{key:"copy",name(){return this.getTranslatedPhrase(FS)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function PZ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(BS,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function xZ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(VS,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function IZ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(WS,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function HZ(t){return{key:"cut",name(){return this.getTranslatedPhrase(US)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class DZ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class NZ{constructor(){this.clipboardData=new DZ}}function AT(t,e){MH(t,e),e.add(t)}function $a(t,e,n){MH(t,e),e.set(t,n)}function MH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function kn(t,e){var n=AH(t,e,"get");return LZ(t,n)}function LZ(t,e){return e.get?e.get.call(t):e.value}function Fa(t,e,n){var r=AH(t,e,"set");return kZ(t,r,n),n}function AH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function kZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Lo=new WeakMap,mp=new WeakMap,du=new WeakMap,TC=new WeakMap,_C=new WeakMap,fu=new WeakMap,zh=new WeakSet,OT=new WeakSet;class $Z{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;AT(this,OT),AT(this,zh),$a(this,Lo,{writable:!0,value:void 0}),$a(this,mp,{writable:!0,value:void 0}),$a(this,du,{writable:!0,value:void 0}),$a(this,TC,{writable:!0,value:void 0}),$a(this,_C,{writable:!0,value:void 0}),$a(this,fu,{writable:!0,value:void 0}),Fa(this,mp,n),Fa(this,du,r),Fa(this,TC,i),Fa(this,_C,o),Fa(this,fu,s)}setSelectedRange(e){Fa(this,Lo,e)}getCellsRange(){if(kn(this,mp).call(this)===0||kn(this,du).call(this)===0)return null;const{row:e,col:n}=kn(this,Lo).getTopStartCorner(),{row:r,col:i}=kn(this,Lo).getBottomEndCorner(),o=Gh(this,OT,FZ).call(this,e,r),s=Gh(this,zh,pp).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(kn(this,du).call(this)===0||kn(this,fu).call(this)===0)return null;const{col:e}=kn(this,Lo).getTopStartCorner(),{col:n}=kn(this,Lo).getBottomEndCorner(),r=Gh(this,zh,pp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(kn(this,du).call(this)===0||kn(this,fu).call(this)===0)return null;const{col:e}=kn(this,Lo).getTopStartCorner(),{col:n}=kn(this,Lo).getBottomEndCorner(),r=Gh(this,zh,pp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-kn(this,fu).call(this),startCol:e,endRow:-1,endCol:r}}}function pp(t,e){return Math.min(e,Math.max(t+kn(this,_C).call(this)-1,t))}function FZ(t,e){return Math.min(e,Math.max(t+kn(this,TC).call(this)-1,t))}function OH(t){const e=[],n=[];return T(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);ve(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);ve(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Yi(t,e){PH(t,e),e.add(t)}function Ds(t,e,n){PH(t,e),e.set(t,n)}function PH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gu(t,e,n){return e=WZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WZ(t){var e=VZ(t,"string");return typeof e=="symbol"?e:String(e)}function VZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lr(t,e){var n=xH(t,e,"get");return BZ(t,n)}function BZ(t,e){return e.get?e.get.call(t):e.value}function jr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ji(t,e,n){var r=xH(t,e,"set");return UZ(t,r,n),n}function xH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function UZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("afterCopyLimit");me.getSingleton().register("modifyCopyableRange");me.getSingleton().register("beforeCut");me.getSingleton().register("afterCut");me.getSingleton().register("beforePaste");me.getSingleton().register("afterPaste");me.getSingleton().register("beforeCopy");me.getSingleton().register("afterCopy");const Yh="copyPaste",GZ=80,zZ=["fragmentSelection"],PT=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var MC=new WeakMap,AC=new WeakMap,OC=new WeakMap,Wa=new WeakMap,jh=new WeakMap,Kh=new WeakMap,Va=new WeakMap,wp=new WeakSet,xT=new WeakSet,IH=new WeakSet,mb=new WeakSet,IT=new WeakSet,HT=new WeakSet,DT=new WeakSet,NT=new WeakSet,LT=new WeakSet;class YZ extends ot{constructor(){super(...arguments),Yi(this,LT),Yi(this,NT),Yi(this,DT),Yi(this,HT),Yi(this,IT),Yi(this,mb),Yi(this,IH),Yi(this,xT),Yi(this,wp),gu(this,"columnsLimit",1/0),gu(this,"rowsLimit",1/0),gu(this,"pasteMode","overwrite"),gu(this,"uiContainer",this.hot.rootDocument.body),Ds(this,MC,{writable:!0,value:!1}),Ds(this,AC,{writable:!0,value:!1}),Ds(this,OC,{writable:!0,value:!1}),Ds(this,Wa,{writable:!0,value:"cells-only"}),Ds(this,jh,{writable:!0,value:!1}),Ds(this,Kh,{writable:!0,value:!1}),Ds(this,Va,{writable:!0,value:new $Z({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),gu(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Yh}static get SETTING_KEYS(){return[Yh,...zZ]}static get PLUGIN_PRIORITY(){return GZ}isEnabled(){return!!this.hot.getSettings()[Yh]}enablePlugin(){var e=this;if(this.enabled)return;const{[Yh]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,ji(this,MC,!!n.copyColumnHeaders),ji(this,AC,!!n.copyColumnGroupHeaders),ji(this,OC,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>jr(this,IT,XZ).call(this,o)),this.addHook("afterSelectionEnd",()=>jr(this,HT,qZ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),Uv()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return jr(e,DT,ZZ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return jr(e,NT,QZ).call(e,...s)}),this.addHook("afterSelection",()=>jr(this,LT,JZ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";ji(this,Wa,e),ji(this,jh,!0),jr(this,wp,kT).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){ji(this,Kh,!0),jr(this,wp,kT).call(this,"cut")}getRangedCopyableData(e){return Gu(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=OH(e);return T(r,o=>{const s=[];T(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new NZ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}lr(this,Va).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);lr(this,Wa)==="column-headers-only"?n.set("headers",lr(this,Va).getMostBottomColumnHeadersRange()):(lr(this,Wa)==="with-column-headers"?n.set("headers",lr(this,Va).getMostBottomColumnHeadersRange()):lr(this,Wa)==="with-column-group-headers"&&n.set("headers",lr(this,Va).getAllColumnHeadersRange()),n.set("cells",lr(this,Va).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,f=s,g=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:w,visualRow:C}=this.hot.getCellMeta(c,a);if(c=C+1,w===!0)continue;f=C,h=a;const b=[],y=o.length%r;for(;b.length<i||h<=u;){const{skipColumnOnPaste:_,visualCol:O}=this.hot.getCellMeta(s,h);if(h=O+1,_===!0)continue;g=O;const I=b.length%i;b.push(e[y][I])}o.push(b)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,g]}onCopy(e){if(!this.hot.isListening()&&!lr(this,jh)||this.isEditorOpened())return;this.setCopyableText(),ji(this,jh,!1);const n=this.getRangedData(this.copyableRanges),r=jr(this,xT,jZ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=Gu(n);if(e&&e.clipboardData){const s=iC(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[PT,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}ji(this,Wa,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!lr(this,Kh)||this.isEditorOpened())return;this.setCopyableText(),ji(this,Kh,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=Gu(n);if(e&&e.clipboardData){const o=iC(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[PT,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=og(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=pI(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=bq(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function kT(t){if(Uv()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&jx(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function jZ(t){const{rows:e}=OH(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function KZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&Fv(r)}}}function HH(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&Wv(r)}}}function XZ(t){t.items.push({name:"---------"},OZ(this)),lr(this,MC)&&t.items.push(IZ(this)),lr(this,AC)&&t.items.push(xZ(this)),lr(this,OC)&&t.items.push(PZ(this)),t.items.push(HZ(this))}function qZ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function ZZ(){jr(this,mb,HH).call(this)}function QZ(){jr(this,IH,KZ).call(this)}function JZ(){jr(this,mb,HH).call(this)}function DH(t,e){return`border_row${t}col${e}`}function Lu(){return{width:1,color:"#000"}}function fo(){return{hide:!0}}function eQ(){return{width:1,color:"#000",cornerVisible:!1}}function Cp(t){if(ce(t.start)||ce(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ce(t.end)||ce(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function mu(t){return ce(t.start)&&(t.left=t.start),ce(t.end)&&(t.right=t.end),t}function vp(t,e){return{id:DH(t,e),border:eQ(),row:t,col:e,top:fo(),bottom:fo(),start:fo(),end:fo()}}function tQ(t,e){return Pt(e,"border")&&e.border&&(t.border=e.border),Pt(e,"top")&&ce(e.top)&&(e.top?(Be(e.top)||(e.top=Lu()),t.top=e.top):(e.top=fo(),t.top=e.top)),Pt(e,"bottom")&&ce(e.bottom)&&(e.bottom?(Be(e.bottom)||(e.bottom=Lu()),t.bottom=e.bottom):(e.bottom=fo(),t.bottom=e.bottom)),Pt(e,"start")&&ce(e.start)&&(e.start?(Be(e.start)||(e.start=Lu()),t.start=e.start):(e.start=fo(),t.start=e.start)),Pt(e,"end")&&ce(e.end)&&(e.end?(Be(e.end)||(e.end=Lu()),t.end=e.end):(e.end=fo(),t.end=e.end)),t}function So(t,e){let n=!1;return T(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Pt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Lg(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function nQ(t){return t.some(e=>ce(e.left)||ce(e.right))}function rQ(t){return t.some(e=>ce(e.start)||ce(e.end))}const iQ=new Map([["left","start"],["right","end"]]);function oQ(t){var e;return(e=iQ.get(t))!==null&&e!==void 0?e:t}function sQ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(uy);return So(this,"bottom")&&(e=Lg(e)),e},callback(e,n){const r=So(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function aQ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(cy);return So(this,e)&&(n=Lg(n)),n},callback(n,r){const i=So(this,e);t.prepareBorder(r,e,i)}}}function lQ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(hy)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!So(this)}}}function uQ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(ly);return So(this,e)&&(n=Lg(n)),n},callback(n,r){const i=So(this,e);t.prepareBorder(r,e,i)}}}function cQ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(ay);return So(this,"top")&&(e=Lg(e)),e},callback(e,n){const r=So(this,"top");t.prepareBorder(n,"top",r)}}}function $T(t,e){hQ(t,e),e.add(t)}function hQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dQ(t,e,n){return e=fQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fQ(t){var e=gQ(t,"string");return typeof e=="symbol"?e:String(e)}function gQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ld="customBorders",mQ=90;var WT=new WeakSet,VT=new WeakSet;class pQ extends ot{constructor(){super(...arguments),$T(this,VT),$T(this,WT),dQ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Ld}static get PLUGIN_PRIORITY(){return mQ}isEnabled(){return!!this.hot.getSettings()[Ld]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>FT(this,WT,wQ).call(this,e)),this.addHook("init",()=>FT(this,VT,CQ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Cp(n));const o=Al(e),s=pc(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});T(e,a=>{s(a).forAll((l,u)=>{T(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,oQ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Al(e),r=pc(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return T(e,o=>{r(o).forAll((s,a)=>{T(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(mu(l))})})}),i}clearBorders(e){e?this.setBorders(e):(T(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=vp(e,n);r&&(a=tQ(a,r),T(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",mu(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);ve(e.from.row,r,o=>{ve(e.from.col,i,s=>{const a=vp(o,s);let l=0;o===e.from.row&&Pt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Pt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Pt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Pt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",mu(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=DH(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=vp(e,n):o=Cp(o),i?(o[r]=fo(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",mu(o)))):(o[r]=Lu(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",mu(o)))}prepareBorder(e,n,r){T(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":ve(o.col,s.col,a=>{ve(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":ve(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":ve(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":ve(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":ve(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){T(e,n=>{const r=Cp(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Gt([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){T(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){T(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):T(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return T(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return T(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):T(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);T(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Ld];if(Array.isArray(e)){const n=Mn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=nQ(e),r=rQ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function wQ(t){this.hot.getSettings()[Ld]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(sy)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[cQ(this),uQ(this),sQ(this),aQ(this),lQ(this)]}})}function CQ(){this.changeBorderSettings()}function vQ(t,e){SQ(t,e),e.add(t)}function SQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sp(t,e,n){return e=yQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yQ(t){var e=bQ(t,"string");return typeof e=="symbol"?e:String(e)}function bQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const UT="dragToScroll",RQ=100;var yp=new WeakSet;class EQ extends ot{constructor(){super(...arguments),vQ(this,yp),Sp(this,"boundaries",null),Sp(this,"callback",null),Sp(this,"listening",!1)}static get PLUGIN_KEY(){return UT}static get PLUGIN_PRIORITY(){return RQ}isEnabled(){return!!this.hot.getSettings()[UT]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>BT(this,yp,GT).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>BT(this,yp,GT).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=cc(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function GT(t){if(cs(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function Ns(t,e){TQ(t,e),e.add(t)}function TQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bp(t,e,n){return e=_Q(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Q(t){var e=MQ(t,"string");return typeof e=="symbol"?e:String(e)}function MQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Go(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("afterDropdownMenuDefaultOptions");me.getSingleton().register("beforeDropdownMenuShow");me.getSingleton().register("afterDropdownMenuShow");me.getSingleton().register("afterDropdownMenuHide");me.getSingleton().register("afterDropdownMenuExecute");const kd="dropdownMenu",AQ=230,PC="changeType",Rp=kd;var pb=new WeakSet,zT=new WeakSet,YT=new WeakSet,jT=new WeakSet,KT=new WeakSet,XT=new WeakSet,qT=new WeakSet;class kg extends ot{static get PLUGIN_KEY(){return kd}static get PLUGIN_PRIORITY(){return AQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Vc,Bc,je,Gc,je,Ag,je,Uc,je,Tr]}constructor(e){super(e),Ns(this,qT),Ns(this,XT),Ns(this,KT),Ns(this,jT),Ns(this,YT),Ns(this,zT),Ns(this,pb),bp(this,"commandExecutor",new SH(this.hot)),bp(this,"itemsFactory",null),bp(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>Go(this,YT,PQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[kd]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new yH(this.hot,kg.DEFAULT_ITEMS);const n=this.hot.getSettings()[kd],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Wl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Go(this,jT,xQ).call(this)),this.menu.addLocalHook("afterOpen",()=>Go(this,KT,IQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Go(this,XT,HQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>Go(this,qT,DQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),T(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=Mg(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Rp},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Rp}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Rp)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Go(this,zT,OQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ge(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function NH(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function OQ(t){if(t.stopPropagation(),De(t.target,PC)){const e=Mg(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function PQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${PC}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=PC,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Me(s,[To(),Iv(" ")]),Me(e,[Hx("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function xQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function IQ(){this.hot.runHooks("afterDropdownMenuShow",this),Go(this,pb,NH).call(this,this.menu)}function HQ(t){Go(this,pb,NH).call(this,t)}function DQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}kg.SEPARATOR={name:je};function ZT(t,e,n){return e=NQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NQ(t){var e=LQ(t,"string");return typeof e=="symbol"?e:String(e)}function LQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kQ{constructor(e){ZT(this,"hot",void 0),ZT(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return ve(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(ve(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();ve(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();ve(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const $Q=kQ;function QT(t,e,n){return e=FQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FQ(t){var e=WQ(t,"string");return typeof e=="symbol"?e:String(e)}function WQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wb{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){QT(this,"dataProvider",void 0),QT(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Bn(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Kt(Bn(wb.DEFAULT_OPTIONS),n),n=Kt(n,e),n.filename=xv(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const VQ=wb,BQ=String.fromCharCode(13),UQ=String.fromCharCode(34),GQ=String.fromCharCode(10);class zQ extends VQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ue(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),T(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Ft(e);return r!==""&&(n||r.indexOf(BQ)>=0||r.indexOf(UQ)>=0||r.indexOf(GQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const YQ=zQ,jQ="csv",xC={[jQ]:YQ};function KQ(t,e,n){return typeof xC[t]=="function"?new xC[t](e,n):null}const XQ="exportFile",qQ=240;class ZQ extends ot{static get PLUGIN_KEY(){return XQ}static get PLUGIN_PRIORITY(){return qQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!xC[e])throw new Error(`Export format type "${e}" is not supported.`);return KQ(e,new $Q(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Ba(t,e,n){return e=QQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QQ(t){var e=JQ(t,"string");return typeof e=="symbol"?e:String(e)}function JQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zc{constructor(e,n){let{id:r,stateless:i=!0}=n;Ba(this,"hot",void 0),Ba(this,"id",void 0),Ba(this,"elements",[]),Ba(this,"hidden",!1),Ba(this,"stateId",""),Ba(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new vg)}getElements(){return this.elements}reset(){T(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mt(zc,sr);const Cc={};function ds(t,e){if(!Cc[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Cc[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Zs(t){if(!Cc[t])throw Error(`Filter condition "${t}" does not exist.`);return Cc[t].descriptor}function Xt(t,e,n){n.key=t,Cc[t]={condition:e,descriptor:n}}const hn="none";function eJ(){return!0}Xt(hn,eJ,{name:Sg,inputsCount:0,showOperators:!1});const Ku="empty";function tJ(t){return en(t.value)}Xt(Ku,tJ,{name:Cy,inputsCount:0,showOperators:!0});const $d="not_empty";function nJ(t,e){return!ds(Ku,e)(t)}Xt($d,nJ,{name:vy,inputsCount:0,showOperators:!0});const Xu="eq";function rJ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale)===Ft(n)}Xt(Xu,rJ,{name:Sy,inputsCount:1,showOperators:!0});const Fd="neq";function iJ(t,e){return!ds(Xu,e)(t)}Xt(Fd,iJ,{name:yy,inputsCount:1,showOperators:!0});const LH="gt";function oJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Xt(LH,oJ,{name:_y,inputsCount:1,showOperators:!0});const kH="gte";function sJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Xt(kH,sJ,{name:My,inputsCount:1,showOperators:!0});const $H="lt";function aJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Xt($H,aJ,{name:Ay,inputsCount:1,showOperators:!0});const FH="lte";function lJ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Xt(FH,lJ,{name:Oy,inputsCount:1,showOperators:!0});const Cb="date_after";function uJ(t,e){let[n]=e;const r=Q(t.value,t.meta.dateFormat),i=Q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Xt(Cb,uJ,{name:Iy,inputsCount:1,showOperators:!0});const vb="date_before";function cJ(t,e){let[n]=e;const r=Q(t.value,t.meta.dateFormat),i=Q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Xt(vb,cJ,{name:Hy,inputsCount:1,showOperators:!0});const bf="between";function hJ(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ds(vb,[o]),a=ds(Cb,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Xt(bf,hJ,{name:Py,inputsCount:2,showOperators:!0});const WH="not_between";function dJ(t,e){return!ds(bf,e)(t)}Xt(WH,dJ,{name:xy,inputsCount:2,showOperators:!0});const VH="begins_with";function fJ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Ft(n))}Xt(VH,fJ,{name:by,inputsCount:1,showOperators:!0});const BH="ends_with";function gJ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Ft(n))}Xt(BH,gJ,{name:Ry,inputsCount:1,showOperators:!0});const Sb="contains";function mJ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Ft(n))>=0}Xt(Sb,mJ,{name:Ey,inputsCount:1,showOperators:!0});const UH="not_contains";function pJ(t,e){return!ds(Sb,e)(t)}Xt(UH,pJ,{name:Ty,inputsCount:1,showOperators:!0});const GH="date_tomorrow";function wJ(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(-1,"days").startOf("day"),"d"):!1}Xt(GH,wJ,{name:Ny,inputsCount:0});const zH="date_today";function CJ(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().startOf("day"),"d"):!1}Xt(zH,CJ,{name:Dy,inputsCount:0});const YH="date_yesterday";function vJ(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(1,"days").startOf("day"),"d"):!1}Xt(YH,vJ,{name:Ly,inputsCount:0});xI();function SJ(t,e){let n=t;return n===""&&(n=`(${e})`),n}const IC=new Set([1]).has(1),yJ=IC&&typeof Array.from=="function";function Yc(t){let e=t;return IC&&(e=new Set(e)),function(n){let r;return IC?r=e.has(n):r=!!~e.indexOf(n),r}}function jH(t){return t??""}function HC(t){let e=t;return yJ?e=Array.from(new Set(e)):e=Av(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function JT(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Yc(e)),T(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:SJ(a,n)};r&&r(u),i.push(u)}),i}const Qs="by_value";function bJ(t,e){let[n]=e;return n(t.value)}Xt(Qs,bJ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Yc(e)]},showOperators:!1});const vc={};function RJ(t){if(!vc[t])throw Error(`Operation with id "${t}" does not exist.`);const e=vc[t].func;return function(n,r){return e(n,r)}}function EJ(t){return vc[t].name}function yb(t,e,n){vc[t]={name:e,func:n}}const os="conjunction",TJ=Fy;function _J(t,e){return t.every(n=>n.func(e))}yb(os,TJ,_J);const Rf="disjunction",MJ=yg;function AJ(t,e){return t.some(n=>n.func(e))}yb(Rf,MJ,AJ);const bb="disjunctionWithExtraCondition",OJ=yg;function PJ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}yb(bb,OJ,PJ);const xJ="numeric",KH="text",IJ="date",e_={[xJ]:[hn,je,Ku,$d,je,Xu,Fd,je,LH,kH,$H,FH,bf,WH],[KH]:[hn,je,Ku,$d,je,Xu,Fd,je,VH,BH,je,Sb,UH],[IJ]:[hn,je,Ku,$d,je,Xu,Fd,je,vb,Cb,bf,je,GH,zH,YH]};function HJ(t){const e=[];let n=t;return e_[n]||(n=KH),T(e_[n],r=>{let i;r===je?i={name:je}:i=Bn(Zs(r)),e.push(i)}),e}function pu(t,e,n){return e=DJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DJ(t){var e=NJ(t,"string");return typeof e=="symbol"?e:String(e)}function NJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ep="built",Tp="building",t_=["click","input","keydown","keypress","keyup","focus","blur","change"];let Jr=class XH{static get DEFAULTS(){return Bn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){pu(this,"hot",void 0),pu(this,"eventManager",new pr(this)),pu(this,"options",void 0),pu(this,"_element",void 0),pu(this,"buildState",void 0),this.hot=e,this.options=Kt(XH.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Tp?this._element:this.buildState===Ep?(this.update(),this._element):(this.buildState=Tp,this.build(),this.buildState=Ep,this._element)}isBuilt(){return this.buildState===Ep}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Yn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Tp),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ee(this._element,this.options.className),this.options.children.length)T(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ge(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),T(t_,r=>e(n,r))}else T(t_,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mt(Jr,sr);function LJ(t,e){qH(t,e),e.add(t)}function kJ(t,e,n){qH(t,e),e.set(t,n)}function qH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xh(t,e){var n=ZH(t,e,"get");return $J(t,n)}function $J(t,e){return e.get?e.get.call(t):e.value}function FJ(t,e,n){var r=ZH(t,e,"set");return WJ(t,r,n),n}function ZH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function WJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function VJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Ua=new WeakMap,n_=new WeakSet;class ss extends Jr{static get DEFAULTS(){return Bn({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Kt(ss.DEFAULTS,n)),LJ(this,n_),kJ(this,Ua,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>VJ(this,n_,BJ).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");FJ(this,Ua,this._element.firstChild),ee(this._element,"htUIInput"),ee(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Xh(this,Ua).type=this.options.type,Xh(this,Ua).placeholder=this.translateIfPossible(this.options.placeholder),Xh(this,Ua).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Xh(this,Ua).focus()}}function BJ(t){this.options.value=t.target.value}function _p(t,e){QH(t,e),e.add(t)}function wu(t,e,n){QH(t,e),e.set(t,n)}function QH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ga(t,e,n){var r=JH(t,e,"set");return UJ(t,r,n),n}function UJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Mp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function It(t,e){var n=JH(t,e,"get");return GJ(t,n)}function JH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function GJ(t,e){return e.get?e.get.call(t):e.value}var nn=new WeakMap,qh=new WeakMap,Zh=new WeakMap,Ap=new WeakMap,Qh=new WeakMap,r_=new WeakSet,i_=new WeakSet,o_=new WeakSet;class Sc extends Jr{static get DEFAULTS(){return Bn({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Kt(Sc.DEFAULTS,n)),_p(this,o_),_p(this,i_),_p(this,r_),wu(this,nn,{writable:!0,value:null}),wu(this,qh,{writable:!0,value:[]}),wu(this,Zh,{writable:!0,value:void 0}),wu(this,Ap,{writable:!0,value:void 0}),wu(this,Qh,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return It(this,nn)}registerHooks(){this.addLocalHook("click",()=>Mp(this,o_,jJ).call(this))}setItems(e){Ga(this,qh,this.translateNames(e)),It(this,nn)&&It(this,nn).setMenuItems(It(this,qh))}translateNames(e){return T(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Ga(this,nn,new Wl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),It(this,nn).setMenuItems(It(this,qh));const e=new Jr(this.hot,{className:"htUISelectCaption"}),n=new Jr(this.hot,{className:"htUISelectDropdown"});Ga(this,Zh,e),Ga(this,Ap,e.element),Ga(this,Qh,n),this.hot.getSettings().ariaTags&&(Me(n.element,[To()]),Me(this._element,[Ix()])),T([e,n],r=>this._element.appendChild(r.element)),It(this,nn).addLocalHook("select",r=>Mp(this,r_,zJ).call(this,r)),It(this,nn).addLocalHook("afterClose",()=>Mp(this,i_,YJ).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=It(this,nn).hot.getTranslatedPhrase(Sg),It(this,Ap).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();It(this,nn)&&(It(this,nn).open(),It(this,nn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),It(this,nn).getNavigator().toFirstItem(),It(this,nn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){It(this,nn)&&It(this,nn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){It(this,nn)&&(It(this,nn).destroy(),Ga(this,nn,null)),It(this,Zh)&&It(this,Zh).destroy(),It(this,Qh)&&It(this,Qh).destroy(),super.destroy()}}function zJ(t){t.name!==je&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function YJ(){this.runLocalHooks("afterClose")}function jJ(){this.openOptions()}function s_(t,e){KJ(t,e),e.add(t)}function KJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a_(t,e,n){return e=XJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XJ(t){var e=qJ(t,"string");return typeof e=="symbol"?e:String(e)}function qJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var u_=new WeakSet,c_=new WeakSet;class DC extends zc{constructor(e,n){super(e,{id:n.id,stateless:!1}),s_(this,c_),s_(this,u_),a_(this,"name",""),a_(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Sc(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ss(this.hot,{placeholder:zy})),this.elements.push(new ss(this.hot,{placeholder:Yy})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>l_(this,u_,ZJ).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),T(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>l_(this,c_,QJ).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Bn(e.command);n.name.startsWith(Wt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),T(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Zs(hn),n=[];return T(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Zs(e?e.name:hn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||T(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Sc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ss)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ee(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ee(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Zs(hn)];if(e!==null){const{visualIndex:r}=e;n=HJ(this.hot.getDataType(0,r,this.hot.countRows(),r))}T(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function ZJ(t){T(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function QJ(t){Ll(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Hr(t))}function h_(t,e,n){JJ(t,e),e.set(t,n)}function JJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cu(t,e){var n=eD(t,e,"get");return eee(t,n)}function eee(t,e){return e.get?e.get.call(t):e.value}function d_(t,e,n){var r=eD(t,e,"set");return tee(t,r,n),n}function eD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var za=new WeakMap,Op=new WeakMap;class Ef extends Jr{static get DEFAULTS(){return Bn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Kt(Ef.DEFAULTS,n)),h_(this,za,{writable:!0,value:void 0}),h_(this,Op,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),d_(this,Op,e),d_(this,za,this._element.firstChild),Cu(this,za).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Cu(this,Op).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return Cu(this,za).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Cu(this,za).checked=e)}focus(){this.isBuilt()&&Cu(this,za).focus()}}function nee(t,e){ree(t,e),e.add(t)}function ree(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iee(t,e,n){return e=oee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=see(t,"string");return typeof e=="symbol"?e:String(e)}function see(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const f_=0;var g_=new WeakSet;class lee extends zc{constructor(e,n){super(e,{id:n.id,stateless:!1}),nee(this,g_),iee(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ee(n.parentNode,"htFiltersMenuOperators"),T(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[os,Rf];T(e,n=>{const r=new Ef(this.hot,{name:"operator",label:{htmlFor:n,textContent:EJ(n)},value:n,checked:n===e[f_],id:n});r.addLocalHook("change",i=>aee(this,g_,uee).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ft`Radio button with index ${e} doesn't exist.`);T(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Ef&&n.isChecked());return e?e.getValue():os}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&T(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:os,n=arguments.length>1?arguments[1]:void 0,r=e;r===bb&&(r=Rf),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(f_)}}function uee(t){this.setState(t.target.value)}function cee(t,e,n){hee(t,e),e.set(t,n)}function hee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pp(t,e){var n=tD(t,e,"get");return dee(t,n)}function dee(t,e){return e.get?e.get.call(t):e.value}function fee(t,e,n){var r=tD(t,e,"set");return gee(t,r,n),n}function tD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var vu=new WeakMap;class yc extends Jr{static get DEFAULTS(){return Bn({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Kt(yc.DEFAULTS,n)),cee(this,vu,{writable:!0,value:void 0})}build(){super.build(),fee(this,vu,this._element.firstChild)}update(){this.isBuilt()&&(Pp(this,vu).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Pp(this,vu).focus()}activate(){Pp(this,vu).click()}}function Jh(t,e){nD(t,e),e.add(t)}function Ya(t,e,n){nD(t,e),e.set(t,n)}function nD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ed(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Le(t,e){var n=rD(t,e,"get");return mee(t,n)}function mee(t,e){return e.get?e.get.call(t):e.value}function Wr(t,e,n){var r=rD(t,e,"set");return pee(t,r,n),n}function rD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const m_="multipleSelect.itemBox";var Yr=new WeakMap,At=new WeakMap,xp=new WeakMap,Ki=new WeakMap,ko=new WeakMap,$o=new WeakMap,p_=new WeakSet,w_=new WeakSet,C_=new WeakSet,v_=new WeakSet;class bc extends Jr{static get DEFAULTS(){return Bn({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Kt(bc.DEFAULTS,n)),Jh(this,v_),Jh(this,C_),Jh(this,w_),Jh(this,p_),Ya(this,Yr,{writable:!0,value:[]}),Ya(this,At,{writable:!0,value:void 0}),Ya(this,xp,{writable:!0,value:void 0}),Ya(this,Ki,{writable:!0,value:void 0}),Ya(this,ko,{writable:!0,value:void 0}),Ya(this,$o,{writable:!0,value:void 0}),Wr(this,Ki,new ss(this.hot,{placeholder:Gy,className:"htUIMultipleSelectSearch"})),Wr(this,ko,new yc(this.hot,{textContent:Wy,className:"htUISelectAll"})),Wr(this,$o,new yc(this.hot,{textContent:Vy,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Le(this,At)}registerHooks(){Le(this,Ki).addLocalHook("keydown",e=>ed(this,w_,Cee).call(this,e)),Le(this,Ki).addLocalHook("input",e=>ed(this,p_,wee).call(this,e)),Le(this,ko).addLocalHook("click",e=>ed(this,C_,vee).call(this,e)),Le(this,$o).addLocalHook("click",e=>ed(this,v_,See).call(this,e))}setItems(e){Wr(this,Yr,e),Le(this,At)&&Le(this,At).loadData(Le(this,Yr))}setLocale(e){Wr(this,xp,e)}getLocale(){return Le(this,xp)}getItems(){return[...Le(this,Yr)]}getValue(){return bee(Le(this,Yr))}getSearchInputElement(){return Le(this,Ki)}getSelectAllElement(){return Le(this,ko)}getClearAllElement(){return Le(this,$o)}isSelectedAllValues(){return Le(this,Yr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Jr(this.hot,{className:"htUISelectionControls",children:[Le(this,ko),Le(this,$o)]});this._element.appendChild(Le(this,Ki).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Le(this,At)&&Le(this,At).destroy(),ee(o,"htUIMultipleSelectHot"),Wr(this,At,new this.hot.constructor(o,{data:Le(this,Yr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,f,g)=>{l.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Le(this,At).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Le(this,At).container.scrollWidth-on(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Le(this,At).init();const a=Le(this,At).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:m_}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Le(this,At).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:m_})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Le(this,At).listen()}reset(){Le(this,Ki).reset(),Le(this,ko).reset(),Le(this,$o).reset()}update(){this.isBuilt()&&(Le(this,At).loadData(yee(Le(this,Yr),this.options.value)),super.update())}destroy(){Le(this,At)&&Le(this,At).destroy(),Le(this,Ki).destroy(),Le(this,$o).destroy(),Le(this,ko).destroy(),Wr(this,Ki,null),Wr(this,$o,null),Wr(this,ko,null),Wr(this,At,null),Wr(this,Yr,null),super.destroy()}}function wee(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Le(this,Yr)]:n=mr(Le(this,Yr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Le(this,At).loadData(n)}function Cee(t){this.runLocalHooks("keydown",t,this),Vv(Ll,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Hr(t),Le(this,At).listen(),Le(this,At).selectCell(0,0))}function vee(t){const e=[];t.preventDefault(),T(Le(this,At).getSourceData(),(n,r)=>{n.checked=!0,e.push(SS(n,r)[0])}),Le(this,At).setSourceDataAtCell(e)}function See(t){const e=[];t.preventDefault(),T(Le(this,At).getSourceData(),(n,r)=>{n.checked=!1,e.push(SS(n,r)[0])}),Le(this,At).setSourceDataAtCell(e)}function yee(t,e){const n=Yc(e);return Ue(t,r=>(r.checked=n(r.value),r))}function bee(t){const e=[];return T(t,n=>{n.checked&&e.push(n.value)}),e}function Ree(t,e){Eee(t,e),e.add(t)}function Eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tee(t,e,n){return e=_ee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ee(t){var e=Mee(t,"string");return typeof e=="symbol"?e:String(e)}function Mee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var S_=new WeakSet;class Oee extends zc{constructor(e,n){super(e,{id:n.id,stateless:!1}),Ree(this,S_),Tee(this,"name",""),this.name=n.name,this.elements.push(new bc(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Aee(this,S_,Pee).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Qs){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?hn:Qs},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=mr(i,h=>h.name===Qs),u={},c=this.hot.getTranslatedPhrase(gf);if(l){const h=HC(Ue(s(r,a),C=>C.value));o&&(l.args[0]=o);const f=[],g=JT(h,l.args[0],c,C=>{C.checked&&f.push(C.value)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[f],u.command=Zs(Qs),u.itemsSnapshot=g}else u.args=[],u.command=Zs(hn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof bc)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ee(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(gf),n=HC(this._getColumnVisibleValues()),r=JT(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),n=>jH(n))}}function Pee(t){Ll(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Hr(t))}var iD;function xee(t,e){Iee(t,e),e.add(t)}function Iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hee(t,e,n){return e=Dee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=Nee(t,"string");return typeof e=="symbol"?e:String(e)}function Nee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var y_=new WeakSet;class Rc extends zc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),xee(this,y_),Hee(this,"name",""),this.name=n.name,this.elements.push(new ss(this.hot,{type:"button",value:By,className:"htUIButton htUIButtonOK",identifier:Rc.BUTTON_OK})),this.elements.push(new ss(this.hot,{type:"button",value:Uy,className:"htUIButton htUIButtonCancel",identifier:Rc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){T(this.elements,e=>{e.addLocalHook("click",(n,r)=>Lee(this,y_,kee).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ee(n.parentNode,"htFiltersMenuActionBar"),T(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}iD=Rc;function kee(t,e){e.options.identifier===iD.BUTTON_OK?this.accept():this.cancel()}function Ip(t,e,n){return e=$ee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ee(t){var e=Fee(t,"string");return typeof e=="symbol"?e:String(e)}function Fee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const b_="ConditionCollection.filteringStates";class oD{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Ip(this,"hot",void 0),Ip(this,"isMapRegistrable",void 0),Ip(this,"filteringStates",new vg),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(b_,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:os;return e.length?RJ(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:os,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ue(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ft`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ct(vc[r]))throw new Error(ft`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ds(a,s)}]},i):u.push({name:a,args:s,func:ds(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Gt(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ue(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),T(e,n=>{T(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(b_),this.filteringStates=null,this.clearLocalHooks()}}mt(oD,sr);const sD=oD;function R_(t,e,n){return e=Wee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wee(t){var e=Vee(t,"string");return typeof e=="symbol"?e:String(e)}function Vee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];R_(this,"conditionCollection",void 0),R_(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return T(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return T(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return T(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const aD=Bee;function Hp(t,e){Uee(t,e),e.add(t)}function Uee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ls(t,e,n){return e=Gee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gee(t){var e=zee(t,"string");return typeof e=="symbol"?e:String(e)}function zee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var E_=new WeakSet,T_=new WeakSet,__=new WeakSet;class lD{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Hp(this,__),Hp(this,T_),Hp(this,E_),Ls(this,"hot",void 0),Ls(this,"conditionCollection",void 0),Ls(this,"columnDataFactory",void 0),Ls(this,"changes",[]),Ls(this,"grouping",!1),Ls(this,"latestEditedColumnPosition",-1),Ls(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Dp(this,E_,Yee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Dp(this,T_,jee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Dp(this,__,Kee).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,T(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=Xx(function(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new sD(r.hot,!1),w=[].concat(c,f);g.importAllConditions(w);const C=r.columnDataFactory(h);let b;g.isEmpty()?b=C:b=new aD(g,_=>r.columnDataFactory(_)).filter(),b=Ue(b,_=>_.meta.visualRow);const y=Yc(b);return g.destroy(),mr(C,_=>y(_.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ge(this,(e,n)=>{this[n]=null})}}function Yee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function jee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Kee(){T(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}mt(lD,sr);const Xee=lD;function qee(t){return RH({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof bc)return r;if(i.element&&!us(i.element))return!1;i.focus()}})}const Su="filters";function Zee(t,e){let n=-1;const r=qee(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Su),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof Jr&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Su),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Su)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const f=t.getNavigator();f.getCurrentPage()>-1&&(n=f.getCurrentPage()),f.clear(),h.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const f=e[r.getCurrentPage()];f instanceof Sc&&(f.openOptions(),h.preventDefault()),f instanceof yc&&(f.activate(),h.preventDefault()),f instanceof Jr||h.preventDefault()}}],Su)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Su)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function Xi(t,e){uD(t,e),e.add(t)}function Qee(t,e,n){uD(t,e),e.set(t,n)}function uD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e,n){return e=Jee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jee(t){var e=ete(t,"string");return typeof e=="symbol"?e:String(e)}function ete(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tte(t,e,n){var r=cD(t,e,"set");return nte(t,r,n),n}function nte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function bu(t,e){var n=cD(t,e,"get");return rte(t,n)}function cD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rte(t,e){return e.get?e.get.call(t):e.value}function Vr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const NC="filters",ite=250,M_=NC;var ks=new WeakMap,A_=new WeakSet,O_=new WeakSet,P_=new WeakSet,x_=new WeakSet,Np=new WeakSet,I_=new WeakSet,Lp=new WeakSet,H_=new WeakSet,D_=new WeakSet;class ote extends ot{static get PLUGIN_KEY(){return NC}static get PLUGIN_PRIORITY(){return ite}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Xi(this,D_),Xi(this,H_),Xi(this,Lp),Xi(this,I_),Xi(this,Np),Xi(this,x_),Xi(this,P_),Xi(this,O_),Xi(this,A_),yu(this,"dropdownMenuPlugin",null),yu(this,"conditionCollection",null),yu(this,"conditionUpdateObserver",null),yu(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),yu(this,"filtersRowsMap",null),Qee(this,ks,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Vr(this,H_,hte).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[NC]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Fc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Vr(this,Np,N_).call(this,"accept")),s.addLocalHook("cancel",()=>Vr(this,Np,N_).call(this,"cancel")),s.addLocalHook("change",a=>Vr(this,I_,cte).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(ky)}:`,o=()=>`${this.hot.getTranslatedPhrase($y)}:`;if(!this.components.get("filter_by_condition")){const s=new DC(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Vr(this,Lp,L_).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new lee(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new DC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Vr(this,Lp,L_).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Oee(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Rc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new sD(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Xee(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Vr(this,D_,dte).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Vr(this,x_,ute).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Vr(this,O_,ate).call(this)),this.addHook("afterDropdownMenuHide",()=>Vr(this,P_,lte).call(this)),this.addHook("afterChange",s=>Vr(this,A_,ste).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!bu(this,ks)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=bu(this,ks).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];tte(this,ks,Zee(s,a));const l=u=>{bu(this,ks).listen(),u.preventDefault(),Ll(u.keyCode,"TAB")&&(u.shiftKey?bu(this,ks).toPreviousItem():bu(this,ks).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:M_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(M_)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:os;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=Yc(i);ve(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),T(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return T(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:w}=this.hot.getCellMeta(o,n),C=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:w},value:jH(C)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=HC(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Rf&&n.command.key!==hn&&r.command.key!==hn&&i.command.key!==hn?o=bb:i.command.key!==hn&&(n.command.key===hn||r.command.key===hn)&&(o=os),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new aD(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return T(i,s=>{T(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function ste(t){t&&T(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function ate(){this.restoreComponents(Array.from(this.components.values()))}function lte(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ute(t){t.items.push({name:je}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function N_(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==hn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==hn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==hn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function cte(t,e){this.updateDependentComponentsVisibility(),t.constructor===DC&&!e.inputsCount&&this.setListeningDropdownMenu()}function L_(){this.setListeningDropdownMenu()}function hte(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?ee(e,"htFiltersActive"):ke(e,"htFiltersActive")}function dte(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===Qs),o=n.filter(s=>s.name!==Qs);if(i.length>=2||o.length>=3)vt(ft`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const hD="internal-use-in-handsontable",LC={licenseKey:hD,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function dD(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[En])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function fD(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function fte(t){var e;const n=t[En],r=fD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=dD(t);return{...LC,...r,...i}}function gte(t){var e;const n=t[En],r=fD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=dD(t);return{...r,...i}}function mte(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function $g(){const t="engine_relationship",e=oi(En);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Rb(){const t="shared_engine_usage",e=oi(En);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function pte(t){const e=t.getSettings(),n=e[En],r=n==null?void 0:n.engine;if(n===!0||Ct(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return wte((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ct(r.hyperformula)){const o=$g(),s=Rb().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:hD}),(r.getConfig().leapYear1900!==LC.leapYear1900||hg(r.getConfig().nullDate,LC.nullDate)===!1)&&vt(ft`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function wte(t,e,n){const r=e[En],i=fte(e),o=$g(),s=Rb();Cte(t,r.functions),vte(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Ste(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function k_(t){var e;const n=$g(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function $_(t,e){if(t){const n=$g(),r=n.get(t),i=Rb(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Cte(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){vt(s.message)}})}function vte(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){vt(r.message)}}}function Ste(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){vt(a.message)}}),t.resumeEvaluation())}function yte(t,e){return(Ct(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const gD="DD/MM/YYYY";function mD(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function bte(t){return mD(t)?t.substr(1):t}function Rte(t){return typeof t=="string"&&t.startsWith("=")}function Eb(t,e){return typeof t=="string"&&e==="date"}function pD(t,e){return Q(t,e,!0).isValid()}function wD(t,e){return Q(t,e,!0).format(gD)}function Ete(t,e){return Q(t,gD,!0).format(e)}function CD(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Q(r).format(e)}function $s(t,e,n){Tte(t,e),e.set(t,n)}function Tte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){var n=vD(t,e,"get");return _te(t,n)}function _te(t,e){return e.get?e.get.call(t):e.value}function Fo(t,e,n){var r=vD(t,e,"set");return Mte(t,r,n),n}function vD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ru=new WeakMap,Wo=new WeakMap,ar=new WeakMap,td=new WeakMap,kp=new WeakMap,$p=new WeakMap,nd=new WeakMap;class Ate{constructor(e,n,r){$s(this,Ru,{writable:!0,value:void 0}),$s(this,Wo,{writable:!0,value:void 0}),$s(this,ar,{writable:!0,value:void 0}),$s(this,td,{writable:!0,value:[]}),$s(this,kp,{writable:!0,value:[]}),$s(this,$p,{writable:!0,value:void 0}),$s(this,nd,{writable:!0,value:[]}),Fo(this,Ru,e),Fo(this,Wo,n),Fo(this,ar,r)}setRemovedHfIndexes(e){return Fo(this,nd,e.map(n=>{const r=bt(this,Wo).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),bt(this,nd)}getRemovedHfIndexes(){return bt(this,nd)}getHfIndexFromVisualIndex(e){const n=bt(this,Wo).getIndexesSequence(),r=bt(this,Wo).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${_n(bt(this,Ru))}s`;bt(this,ar).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&bt(this,ar).getEngine()[r](bt(this,ar).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Fo(this,kp,e.map(i=>this.getHfIndexFromVisualIndex(i))),Fo(this,$p,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=bt(this,Wo).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(bt(this,ar).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(bt(this,kp),bt(this,$p)));bt(this,ar).getSheetId()===null?bt(this,ar).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${_n(bt(this,Ru))}Order`;return n=>{if(bt(this,ar).isPerformingUndoRedo())return;const r=bt(this,Wo).getIndexesSequence();if(n==="update"){const i=bt(this,td).map(l=>r.indexOf(l)),o=bt(this,ar).getEngine().getSheetDimensions(bt(this,ar).getSheetId());let s;bt(this,Ru)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);bt(this,ar).getEngine()[e](bt(this,ar).getSheetId(),i)}Fo(this,td,r)}}init(){Fo(this,td,bt(this,Wo).getIndexesSequence())}}const F_=Ate;function Fs(t,e,n){Ote(t,e),e.set(t,n)}function Ote(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qi(t,e){var n=SD(t,e,"get");return Pte(t,n)}function Pte(t,e){return e.get?e.get.call(t):e.value}function Ws(t,e,n){var r=SD(t,e,"set");return xte(t,r,n),n}function SD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var rd=new WeakMap,id=new WeakMap,Fp=new WeakMap,Wp=new WeakMap,Vp=new WeakMap,Bp=new WeakMap,Up=new WeakMap;class Ite{constructor(e,n,r){Fs(this,rd,{writable:!0,value:void 0}),Fs(this,id,{writable:!0,value:void 0}),Fs(this,Fp,{writable:!0,value:void 0}),Fs(this,Wp,{writable:!0,value:!1}),Fs(this,Vp,{writable:!0,value:!1}),Fs(this,Bp,{writable:!0,value:null}),Fs(this,Up,{writable:!0,value:null}),Ws(this,rd,new F_("row",e,this)),Ws(this,id,new F_("column",n,this)),Ws(this,Fp,r)}getForAxis(e){return e==="row"?qi(this,rd):qi(this,id)}setPerformUndo(e){Ws(this,Wp,e)}setPerformRedo(e){Ws(this,Vp,e)}isPerformingUndoRedo(){return qi(this,Wp)||qi(this,Vp)}getSheetId(){return qi(this,Up)}getEngine(){return qi(this,Bp)}getPostponeAction(){return qi(this,Fp)}setupSyncEndpoint(e,n){Ws(this,Bp,e),Ws(this,Up,n),qi(this,rd).init(),qi(this,id).init()}}const Hte=Ite;function Mt(t,e){yD(t,e),e.add(t)}function ja(t,e,n){return e=Dte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dte(t){var e=Nte(t,"string");return typeof e=="symbol"?e:String(e)}function Nte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gp(t,e,n){yD(t,e),e.set(t,n)}function yD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fs(t,e,n){var r=bD(t,e,"set");return Lte(t,r,n),n}function Lte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Rl(t,e){var n=bD(t,e,"get");return kte(t,n)}function bD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function kte(t,e){return e.get?e.get.call(t):e.value}function pt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const En="formulas",$te=["maxRows","maxColumns","language"],Fte=260;me.getSingleton().register("afterNamedExpressionAdded");me.getSingleton().register("afterNamedExpressionRemoved");me.getSingleton().register("afterSheetAdded");me.getSingleton().register("afterSheetRemoved");me.getSingleton().register("afterSheetRenamed");me.getSingleton().register("afterFormulasValuesUpdate");const Vl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var yo=new WeakMap,Tb=new WeakMap,Eu=new WeakMap,W_=new WeakSet,V_=new WeakSet,zp=new WeakSet,B_=new WeakSet,Yp=new WeakSet,U_=new WeakSet,G_=new WeakSet,jp=new WeakSet,z_=new WeakSet,Y_=new WeakSet,j_=new WeakSet,K_=new WeakSet,X_=new WeakSet,q_=new WeakSet,Z_=new WeakSet,Q_=new WeakSet,J_=new WeakSet,eM=new WeakSet,tM=new WeakSet,nM=new WeakSet,rM=new WeakSet,iM=new WeakSet,oM=new WeakSet,sM=new WeakSet;class Wte extends ot{constructor(){var e;super(...arguments),e=this,Mt(this,sM),Mt(this,oM),Mt(this,iM),Mt(this,rM),Mt(this,nM),Mt(this,tM),Mt(this,eM),Mt(this,J_),Mt(this,Q_),Mt(this,Z_),Mt(this,q_),Mt(this,X_),Mt(this,K_),Mt(this,j_),Mt(this,Y_),Mt(this,z_),Mt(this,jp),Mt(this,G_),Mt(this,U_),Mt(this,Yp),Mt(this,B_),Mt(this,zp),Mt(this,V_),Mt(this,W_),Gp(this,yo,{writable:!0,value:!1}),Gp(this,Tb,{writable:!0,value:!1}),Gp(this,Eu,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,tM,nne).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,nM,rne).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,rM,ine).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,iM,one).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,oM,sne).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,sM,ane).call(e,...r)}]]}),ja(this,"staticRegister",oi("formulas")),ja(this,"engine",null),ja(this,"sheetName",null),ja(this,"indexSyncer",null),ja(this,"rowAxisSyncer",null),ja(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return En}static get PLUGIN_PRIORITY(){return Fte}static get SETTING_KEYS(){return[En,...$te]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[En]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=pte(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){vt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,zp,aM).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Yp,lM).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,zp,aM).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Yp,lM).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,U_,Gte).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,G_,zte).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,W_,Vte).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,z_,Yte).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,jp,uM).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,jp,uM).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Y_,jte).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,j_,Kte).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,q_,Zte).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Z_,Qte).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,K_,Xte).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,X_,qte).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Q_,Jte).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,J_,ene).call(n,...i)}),this.indexSyncer=new Hte(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,B_,Ute).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,eM,tne).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,V_,Bte).call(n,...i)}),Rl(this,Eu).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Rl(this,Eu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),$_(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=gte(this.hot.getSettings());mte(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[En];if(ce(r)&&ce(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[En].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Rl(this,Eu).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),fs(this,Eu,null),$_(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ce(n)&&!n1(n))return vt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return vt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return vt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){jv(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${_n(En)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),k_(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ce(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ce(l)===!1||ce(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const f=k_(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){vt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return Eb(r,o.type)&&(pD(r,o.dateFormat)?r=wD(r,o.dateFormat):Rte(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Vte(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Vn(s)&&(s=CD(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Bte(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const g=this.engine.getFillRangeData(h,f),{row:w,col:C}=h.start,{row:b,col:y}=h.end,_=b-w+1,O=y-C+1;for(let I=0;I<g.length;I+=1)for(let x=0;x<g[I].length;x+=1){const k=g[I][x],U=I%_,Z=x%O,z=this.hot.getCellMeta(U,Z);Eb(k,z.type)&&(k.startsWith("'")?g[I][x]=k.slice(1):this.isFormulaCellType(U,Z,this.sheetId)===!1&&(g[I][x]=Ete(k,z.dateFormat)))}return g}function aM(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(_n(En))||fs(this,Tb,Ct(this.hot.getSettings().data))}function Ute(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;Eb(i,s.type)&&(e=!0,pD(i,a)?t[r][o]=wD(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(fs(this,yo,!0),this.engine.setSheetContent(this.sheetId,t),fs(this,yo,!1))}function lM(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(_n(En)))if(this.sheetName=yte(this.engine,this.hot.getSettings()[En].sheetName),Rl(this,Tb))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){fs(this,yo,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),fs(this,yo,!1)}}}function Gte(t,e,n,r){if(r!=="get"||Rl(this,yo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){mD(n.value)&&(n.value=bte(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&Vn(a)&&(a=CD(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function zte(t,e,n,r){if(r!=="get"||Rl(this,yo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function uM(t,e){if(Vl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Yte(t,e){if(Vl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Vn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){vt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function jte(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Kte(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Xte(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function qte(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Zte(t,e,n){if(Vl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Qte(t,e,n){if(Vl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Jte(t,e,n,r){if(Vl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function ene(t,e,n,r){if(Vl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function tne(t,e,n){var r;fs(this,yo,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());fs(this,yo,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function nne(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function rne(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function ine(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function one(t){this.hot.runHooks("afterSheetAdded",t)}function sne(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function ane(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function lne(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(gy,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function une(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(my,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return T(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Ka(t,e){RD(t,e),e.add(t)}function cM(t,e,n){RD(t,e),e.set(t,n)}function RD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function dr(t,e){var n=ED(t,e,"get");return cne(t,n)}function cne(t,e){return e.get?e.get.call(t):e.value}function Tu(t,e,n){var r=ED(t,e,"set");return hne(t,r,n),n}function ED(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function hne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("beforeHideColumns");me.getSingleton().register("afterHideColumns");me.getSingleton().register("beforeUnhideColumns");me.getSingleton().register("afterUnhideColumns");const Kp="hiddenColumns",dne=310;var Oi=new WeakMap,pi=new WeakMap,hM=new WeakSet,dM=new WeakSet,fM=new WeakSet,gM=new WeakSet,mM=new WeakSet,pM=new WeakSet;class fne extends ot{constructor(){super(...arguments),Ka(this,pM),Ka(this,mM),Ka(this,gM),Ka(this,fM),Ka(this,dM),Ka(this,hM),cM(this,Oi,{writable:!0,value:{}}),cM(this,pi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Kp}static get PLUGIN_PRIORITY(){return dne}isEnabled(){return!!this.hot.getSettings()[Kp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Kp];Be(n)&&(Tu(this,Oi,n),Ct(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Tu(this,pi,new Cg),dr(this,pi).addLocalHook("init",()=>Xa(this,pM,vne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,dr(this,pi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xa(e,mM,Cne).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Xa(this,dM,mne).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>Xa(this,hM,gne).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xa(e,gM,wne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Xa(this,fM,pne).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Tu(this,Oi,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=dr(this,pi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));T(l,u=>{o[u]=!1}),i=Gt(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&dr(this,pi).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{dr(this,pi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(dr(this,pi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return dr(this,pi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Tu(this,Oi,null),Tu(this,pi,null),super.destroy()}}function gne(t,e){if(this.isHidden(e))return 0;if(dr(this,Oi).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function mne(t,e,n){if(dr(this,Oi).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function pne(t){if(dr(this,Oi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;ve(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function wne(t,e){if(!dr(this,Oi).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),ee(e,n)}function Cne(t){t.items.push({name:je},lne(this),une(this))}function vne(){Array.isArray(dr(this,Oi).columns)&&this.hideColumns(dr(this,Oi).columns)}function Sne(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(py,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function yne(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(wy,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return T(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function qa(t,e){TD(t,e),e.add(t)}function wM(t,e,n){TD(t,e),e.set(t,n)}function TD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Za(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function _r(t,e){var n=_D(t,e,"get");return bne(t,n)}function bne(t,e){return e.get?e.get.call(t):e.value}function _u(t,e,n){var r=_D(t,e,"set");return Rne(t,r,n),n}function _D(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}me.getSingleton().register("beforeHideRows");me.getSingleton().register("afterHideRows");me.getSingleton().register("beforeUnhideRows");me.getSingleton().register("afterUnhideRows");const Xp="hiddenRows",Ene=320;var go=new WeakMap,wi=new WeakMap,CM=new WeakSet,vM=new WeakSet,SM=new WeakSet,yM=new WeakSet,bM=new WeakSet,RM=new WeakSet;class Tne extends ot{constructor(){super(...arguments),qa(this,RM),qa(this,bM),qa(this,yM),qa(this,SM),qa(this,vM),qa(this,CM),wM(this,go,{writable:!0,value:{}}),wM(this,wi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Xp}static get PLUGIN_PRIORITY(){return Ene}isEnabled(){return!!this.hot.getSettings()[Xp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Xp];Be(n)&&(_u(this,go,n),Ct(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),_u(this,wi,new Cg),_r(this,wi).addLocalHook("init",()=>Za(this,RM,xne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_r(this,wi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Za(e,bM,Pne).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Za(this,vM,Mne).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>Za(this,CM,_ne).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Za(e,yM,One).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Za(this,SM,Ane).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),_u(this,go,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=_r(this,wi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));T(l,u=>{o[u]=!1}),i=Gt(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&_r(this,wi).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{_r(this,wi).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(_r(this,wi).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return _r(this,wi).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){_u(this,go,null),_u(this,wi,null),super.destroy()}}function _ne(t,e){return this.isHidden(e)?0:t}function Mne(t,e,n){if(_r(this,go).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Ane(t){if(_r(this,go).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;ve(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function One(t,e){if(!_r(this,go).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),ee(e,n)}function Pne(t){t.items.push({name:je},Sne(this),yne(this))}function xne(){Array.isArray(_r(this,go).rows)&&this.hideRows(_r(this,go).rows)}function Ine(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(GS)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Hne(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(zS)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function EM(t,e){MD(t,e),e.add(t)}function Dne(t,e,n){MD(t,e),e.set(t,n)}function MD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kC(t,e){var n=AD(t,e,"get");return Nne(t,n)}function Nne(t,e){return e.get?e.get.call(t):e.value}function qp(t,e,n){var r=AD(t,e,"set");return Lne(t,r,n),n}function AD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function TM(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("beforeColumnFreeze");me.getSingleton().register("afterColumnFreeze");me.getSingleton().register("beforeColumnUnfreeze");me.getSingleton().register("afterColumnUnfreeze");const _M="manualColumnFreeze",kne=110;var js=new WeakMap,MM=new WeakSet,AM=new WeakSet;class $ne extends ot{constructor(){super(...arguments),EM(this,AM),EM(this,MM),Dne(this,js,{writable:!0,value:!1})}static get PLUGIN_KEY(){return _M}static get PLUGIN_PRIORITY(){return kne}isEnabled(){return!!this.hot.getSettings()[_M]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>TM(this,MM,Fne).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>TM(this,AM,Wne).call(this,e,n)),super.enablePlugin())}disablePlugin(){qp(this,js,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;kC(this,js)||qp(this,js,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;kC(this,js)||qp(this,js,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Fne(t){t.items.push({name:"---------"},Ine(this),Hne(this))}function Wne(t,e){if(kC(this,js)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function od(t,e,n){return e=Vne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vne(t){var e=Bne(t,"string");return typeof e=="symbol"?e:String(e)}function Bne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zp=0,OM=1,PM=2,Qa="px";let Une=class{constructor(e){od(this,"hot",void 0),od(this,"_element",null),od(this,"state",Zp),od(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=PM}build(){this.state===Zp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=OM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Zp}isAppended(){return this.state===PM}isBuilt(){return this.state>=OM}setPosition(e,n){Vn(e)&&(this._element.style.top=e+Qa),Vn(n)&&(this._element.style[this.inlineProperty]=n+Qa)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Vn(e)&&(this._element.style.width=e+Qa),Vn(n)&&(this._element.style.height=n+Qa)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Vn(e)&&(this._element.style.marginTop=e+Qa),Vn(n)&&(this._element.style[`margin${_n(this.inlineProperty)}`]=n+Qa)}getOffset(){const e=this._element.style,n=`margin${_n(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const OD=Une,Gne="ht__manualColumnMove--backlight";let zne=class extends OD{build(){super.build(),ee(this._element,Gne)}};const Yne=zne,jne="ht__manualColumnMove--guideline";let Kne=class extends OD{build(){super.build(),ee(this._element,jne)}};const Xne=Kne;function Ja(t,e){PD(t,e),e.add(t)}function Br(t,e,n){PD(t,e),e.set(t,n)}function PD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nr(t,e,n){var r=xD(t,e,"set");return qne(t,r,n),n}function qne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function we(t,e){var n=xD(t,e,"get");return Zne(t,n)}function xD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zne(t,e){return e.get?e.get.call(t):e.value}function el(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("beforeColumnMove");me.getSingleton().register("afterColumnMove");const Qp="manualColumnMove",Qne=120,xM="ht__manualColumnMove",Tf="show-ui",$C="on-moving--columns",FC="after-selection--columns";var Fn=new WeakMap,jo=new WeakMap,mo=new WeakMap,Wd=new WeakMap,Jo=new WeakMap,$n=new WeakMap,sd=new WeakMap,Rr=new WeakMap,dl=new WeakMap,_f=new WeakMap,qu=new WeakMap,IM=new WeakSet,HM=new WeakSet,DM=new WeakSet,NM=new WeakSet,LM=new WeakSet,kM=new WeakSet;class Jne extends ot{constructor(){super(...arguments),Ja(this,kM),Ja(this,LM),Ja(this,NM),Ja(this,DM),Ja(this,HM),Ja(this,IM),Br(this,Fn,{writable:!0,value:new Yne(this.hot)}),Br(this,jo,{writable:!0,value:new Xne(this.hot)}),Br(this,mo,{writable:!0,value:[]}),Br(this,Wd,{writable:!0,value:0}),Br(this,Jo,{writable:!0,value:!1}),Br(this,$n,{writable:!0,value:{}}),Br(this,sd,{writable:!0,value:void 0}),Br(this,Rr,{writable:!0,value:void 0}),Br(this,dl,{writable:!0,value:void 0}),Br(this,_f,{writable:!0,value:void 0}),Br(this,qu,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Qp}static get PLUGIN_PRIORITY(){return Qne}isEnabled(){return!!this.hot.getSettings()[Qp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return el(e,IM,ere).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return el(e,DM,nre).call(e,...r)}),this.addHook("afterScrollVertically",()=>el(this,LM,ire).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return el(e,kM,ore).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,xM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ke(this.hot.rootElement,xM),this.unregisterEvents(),we(this,Fn).destroy(),we(this,jo).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=we(this,sd),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(nr(this,sd,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return nr(this,sd,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Gt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Qp];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return ve(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(we(this,Rr))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,we(this,Rr)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=we(this,Fn).getOffset().start,u=we(this,Fn).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,C=dt(this.hot.rootElement),b=w.innerWidth-we(this,dl)-C;h=w.innerWidth-we(this,$n).eventPageX-b-(r.scrollX===void 0?i:0)}else h=we(this,$n).eventPageX-(we(this,dl)-(r.scrollX===void 0?i:0));if(we(this,_f)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(we(this,Rr))&&(o+=i),o+=c,we(this,Rr)<0)we(this,qu)>0?we(this,$n).col=0:we(this,$n).col=e>0?e-1:e;else if(we(this,$n).TD.offsetWidth/2+o<=h){const w=we(this,Rr)>=we(this,Wd)?we(this,Wd)-1:we(this,Rr);we(this,$n).col=w+1,o+=we(this,$n).TD.offsetWidth}else we(this,$n).col=we(this,Rr);let f=h,g=o;h+u+l>=s?f=s-u-l:h+l<a+c&&(f=a+c+Math.abs(l)),o>=s-1?g=s-1:g===0?g=1:r.scrollX!==void 0&&we(this,Rr)<we(this,qu)&&(g-=we(this,dl)<=r.scrollX?we(this,dl):0),we(this,Fn).setPosition(null,f),we(this,jo).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>el(this,HM,tre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>el(this,NM,rre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){we(this,Fn).build(),we(this,jo).build()}destroy(){we(this,Fn).destroy(),we(this,jo).destroy(),super.destroy()}}function ere(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=De(t.target,"sortAction");if(!s||!o||we(this,Jo)||t.button!==0||a){nr(this,Jo,!1),we(this,mo).length=0,ke(this.hot.rootElement,[$C,Tf]);return}const l=we(this,jo).isBuilt()&&!we(this,jo).isAppended(),u=we(this,Fn).isBuilt()&&!we(this,Fn).isAppended();l&&u&&(we(this,jo).appendTo(i.hider),we(this,Fn).appendTo(i.hider));const{from:c,to:h}=s,f=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=f&&e.col<=g){r.column=!0,nr(this,Jo,!0);const w=n.firstChild?lI(t,n.firstChild).x:t.offsetX;we(this,$n).eventPageX=t.pageX,nr(this,Rr,e.col),we(this,$n).TD=n,we(this,$n).col=e.col,nr(this,mo,this.prepareColumnsToMoving(f,g)),nr(this,_f,!!this.hot.getSettings().rowHeaders),nr(this,Wd,this.hot.countCols()),nr(this,qu,this.hot.getSettings().fixedColumnsStart),nr(this,dl,jt(this.hot.rootElement).left);const C=we(this,_f)?-1:0,b=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<we(this,qu),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),O=Math.abs(w-(this.hot.isRtl()?n.offsetWidth:0)),I=this.getColumnsWidth(f,e.col-1)+O,x=this.getColumnsWidth(C,f-1)+(y?_:0)+I;we(this,Fn).setPosition(b,x),we(this,Fn).setSize(this.getColumnsWidth(f,g),i.hider.offsetHeight-b),we(this,Fn).setOffset(null,-I),ee(this.hot.rootElement,$C)}else ke(this.hot.rootElement,FC),nr(this,Jo,!1),we(this,mo).length=0}function tre(t){we(this,Jo)&&(we(this,$n).eventPageX=t.pageX,this.refreshPositions())}function nre(t,e,n,r){!this.hot.getSelectedRangeLast()||!we(this,Jo)||(we(this,mo).indexOf(e.col)>-1?ke(this.hot.rootElement,Tf):ee(this.hot.rootElement,Tf),r.row=!0,r.column=!0,r.cell=!0,nr(this,Rr,e.col),we(this,$n).TD=n)}function rre(){const t=we(this,$n).col,e=we(this,mo).length;if(nr(this,Rr,void 0),nr(this,Jo,!1),ke(this.hot.rootElement,[$C,Tf,FC]),this.hot.selection.isSelectedByColumnHeader()&&ee(this.hot.rootElement,FC),e<1||t===void 0)return;const n=we(this,mo)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(we(this,mo),t);if(we(this,mo).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function ire(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;we(this,Fn).setPosition(r),we(this,Fn).setSize(null,t.hider.offsetHeight-r)}function ore(){this.moveBySettingsOrLoad()}function Zi(t,e){ID(t,e),e.add(t)}function vn(t,e,n){ID(t,e),e.set(t,n)}function ID(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ut(t,e,n){var r=HD(t,e,"set");return sre(t,r,n),n}function sre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function le(t,e){var n=HD(t,e,"get");return are(t,n)}function HD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function are(t,e){return e.get?e.get.call(t):e.value}const Mf="manualColumnResize",lre=130,$M="manualColumnWidths";var oo=new WeakMap,ad=new WeakMap,ur=new WeakMap,Af=new WeakMap,Mi=new WeakMap,ure=new WeakMap,El=new WeakMap,ld=new WeakMap,Qn=new WeakMap,eo=new WeakMap,sa=new WeakMap,Of=new WeakMap,Zu=new WeakMap,Qu=new WeakMap,hr=new WeakMap,Ju=new WeakMap,FM=new WeakSet,WM=new WeakSet,VM=new WeakSet,BM=new WeakSet,UM=new WeakSet,GM=new WeakSet,zM=new WeakSet,YM=new WeakSet,jM=new WeakSet;class cre extends ot{static get PLUGIN_KEY(){return Mf}static get PLUGIN_PRIORITY(){return lre}constructor(e){super(e),Zi(this,jM),Zi(this,YM),Zi(this,zM),Zi(this,GM),Zi(this,UM),Zi(this,BM),Zi(this,VM),Zi(this,WM),Zi(this,FM),vn(this,oo,{writable:!0,value:null}),vn(this,ad,{writable:!0,value:null}),vn(this,ur,{writable:!0,value:[]}),vn(this,Af,{writable:!0,value:null}),vn(this,Mi,{writable:!0,value:null}),vn(this,ure,{writable:!0,value:null}),vn(this,El,{writable:!0,value:null}),vn(this,ld,{writable:!0,value:null}),vn(this,Qn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),vn(this,eo,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),vn(this,sa,{writable:!0,value:null}),vn(this,Of,{writable:!0,value:!1}),vn(this,Zu,{writable:!0,value:0}),vn(this,Qu,{writable:!0,value:null}),vn(this,hr,{writable:!0,value:void 0}),vn(this,Ju,{writable:!0,value:void 0}),ee(le(this,Qn),"manualColumnResizer"),ee(le(this,eo),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Mf]}enablePlugin(){this.enabled||(Ut(this,hr,new gs),le(this,hr).addLocalHook("init",()=>Qi(this,FM,hre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,le(this,hr)),this.addHook("modifyColWidth",(e,n)=>Qi(this,zM,wre).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Qi(this,YM,Cre).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Qi(this,jM,vre).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ut(this,Ju,le(this,hr).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",$M,le(this,hr).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",$M,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return le(this,hr).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);le(this,hr).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Ut(this,oo,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(le(this,oo)),i=r.col;if(i<0)return;const o=xt(le(this,oo)),s=le(this,oo).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(le(this,oo),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(le(this,oo),r.row,r.col)),Ut(this,ad,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Ut(this,ur,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();T(c,h=>{const f=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;ve(f,g,w=>{le(this,ur).includes(w)||le(this,ur).push(w)})})}le(this,ur).includes(le(this,ad))||Ut(this,ur,[le(this,ad)]),Ut(this,ld,l.start-6),Ut(this,El,parseInt(s.width,10)),le(this,Qn).style.top=`${l.top}px`,le(this,Qn).style[this.inlineDir]=`${le(this,ld)+le(this,El)}px`,le(this,Qn).style.height=`${o}px`,this.hot.rootElement.appendChild(le(this,Qn))}refreshHandlePosition(){le(this,Qn).style[this.inlineDir]=`${le(this,ld)+le(this,Af)}px`}setupGuidePosition(){const e=parseInt(xt(le(this,Qn)),10),n=parseInt(le(this,Qn).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ee(le(this,Qn),"active"),ee(le(this,eo),"active"),le(this,eo).style.top=`${n}px`,this.refreshGuidePosition(),le(this,eo).style.height=`${r-e}px`,this.hot.rootElement.appendChild(le(this,eo))}refreshGuidePosition(){le(this,eo).style[this.inlineDir]=le(this,Qn).style[this.inlineDir]}hideHandleAndGuide(){ke(le(this,Qn),"active"),ke(le(this,eo),"active")}checkIfColumnHeader(e){return!!as(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",le(this,Mi),r,!0);o!==void 0&&Ut(this,Mi,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,le(this,Mi)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",le(this,Mi),r,!0),i&&e()};le(this,Zu)>=2&&(le(this,ur).length>1?(T(le(this,ur),i=>{n(i)}),e()):T(le(this,ur),i=>{n(i,!0)})),Ut(this,Zu,0),Ut(this,Qu,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Qi(this,WM,dre).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Qi(this,VM,fre).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Qi(this,BM,gre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Qi(this,UM,mre).call(this)),this.eventManager.addEventListener(le(this,Qn),"contextmenu",()=>Qi(this,GM,pre).call(this))}destroy(){super.destroy()}}function hre(){const t=this.hot.getSettings()[Mf],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{le(this,hr).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{le(this,hr).setValueAtIndex(r,n)})},!0),Ut(this,Ju,t)):t===!0&&Array.isArray(le(this,Ju))&&this.hot.batchExecution(()=>{le(this,Ju).forEach((n,r)=>{le(this,hr).setValueAtIndex(r,n)})},!0)}function dre(t){if(!$v(t.target)&&le(this,Of)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(le(this,sa)||this.setupHandlePosition(e))}}function fre(t){De(t.target,"manualColumnResizer")&&(this.setupHandlePosition(le(this,oo)),this.setupGuidePosition(),Ut(this,sa,!0),le(this,Qu)===null&&(Ut(this,Qu,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(le(this,Qu))),Ut(this,Zu,le(this,Zu)+1),this.startX=t.pageX,Ut(this,Mi,le(this,El)))}function gre(t){if(le(this,sa)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Ut(this,Af,le(this,El)+e),T(le(this,ur),n=>{Ut(this,Mi,this.setManualSize(n,le(this,Af)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function mre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",le(this,Mi),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",le(this,Mi),n,!1)};le(this,sa)&&(this.hideHandleAndGuide(),Ut(this,sa,!1),le(this,Mi)!==le(this,El)&&(le(this,ur).length>1?(T(le(this,ur),r=>{e(r)}),t()):T(le(this,ur),r=>{e(r,!0)})),this.setupHandlePosition(le(this,oo)))}function pre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(le(this,Qn)),this.hot.rootElement.removeChild(le(this,eo)),Ut(this,sa,!1),Ut(this,Of,!0),this.hot._registerImmediate(()=>{Ut(this,Of,!1)})}function wre(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=le(this,hr).getValueAtIndex(r);this.hot.getSettings()[Mf]&&i&&(n=i)}return n}function Cre(t,e){let n=le(this,hr).getValueAtIndex(e);return n===null&&(n=t),n}function vre(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Jp(t,e,n){return e=Sre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sre(t){var e=yre(t,"string");return typeof e=="symbol"?e:String(e)}function yre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ew=0,KM=1,XM=2,tl="px";let bre=class{constructor(e){Jp(this,"hot",void 0),Jp(this,"_element",null),Jp(this,"state",ew),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=XM}build(){this.state===ew&&(this._element=this.hot.rootDocument.createElement("div"),this.state=KM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ew}isAppended(){return this.state===XM}isBuilt(){return this.state>=KM}setPosition(e,n){e!==void 0&&(this._element.style.top=e+tl),n!==void 0&&(this._element.style.left=n+tl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+tl),n&&(this._element.style.height=n+tl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+tl),n&&(this._element.style.marginLeft=n+tl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const DD=bre,Rre="ht__manualRowMove--backlight";class Ere extends DD{build(){super.build(),ee(this._element,Rre)}}const Tre=Ere,_re="ht__manualRowMove--guideline";class Mre extends DD{build(){super.build(),ee(this._element,_re)}}const Are=Mre;function nl(t,e){ND(t,e),e.add(t)}function rl(t,e,n){ND(t,e),e.set(t,n)}function ND(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Js(t,e,n){var r=LD(t,e,"set");return Ore(t,r,n),n}function Ore(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fe(t,e){var n=LD(t,e,"get");return Pre(t,n)}function LD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pre(t,e){return e.get?e.get.call(t):e.value}function il(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("beforeRowMove");me.getSingleton().register("afterRowMove");const tw="manualRowMove",xre=140,qM="ht__manualRowMove",Pf="show-ui",WC="on-moving--rows",VC="after-selection--rows";var Wn=new WeakMap,Ko=new WeakMap,po=new WeakMap,es=new WeakMap,rr=new WeakMap,ud=new WeakMap,ZM=new WeakSet,QM=new WeakSet,JM=new WeakSet,eA=new WeakSet,tA=new WeakSet,nA=new WeakSet;class Ire extends ot{constructor(){super(...arguments),nl(this,nA),nl(this,tA),nl(this,eA),nl(this,JM),nl(this,QM),nl(this,ZM),rl(this,Wn,{writable:!0,value:new Tre(this.hot)}),rl(this,Ko,{writable:!0,value:new Are(this.hot)}),rl(this,po,{writable:!0,value:[]}),rl(this,es,{writable:!0,value:void 0}),rl(this,rr,{writable:!0,value:{}}),rl(this,ud,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return tw}static get PLUGIN_PRIORITY(){return xre}isEnabled(){return!!this.hot.getSettings()[tw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return il(e,ZM,Hre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return il(e,JM,Nre).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>il(this,tA,kre).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return il(e,nA,$re).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,qM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ke(this.hot.rootElement,qM),this.unregisterEvents(),Fe(this,Wn).destroy(),Fe(this,Ko).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Fe(this,ud),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Js(this,ud,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Js(this,ud,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Gt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[tw];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return ve(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Fe(this,rr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Fe(this,rr).TD,a=this.hot.rootElement,l=jt(a),u=na(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-h,g=Fe(this,rr).eventPageY-f+c,w=o.hider.offsetHeight,C=o.TBODY.offsetTop,b=Fe(this,Wn).getOffset().top,y=Fe(this,Wn).getSize().height,_=s.offsetHeight/2,O=s.offsetHeight;let I=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const x=g>=I+_;this.isFixedRowTop(e.row)&&(I+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Fe(this,rr).row=n>0?n-1:n:x?(Fe(this,rr).row=e.row+1,I+=e.row===0?O-1:O):Fe(this,rr).row=e.row;let k=g,U=I;g+y+b>=w?k=w-y-b:g+b<C&&(k=C+Math.abs(b)),I>=w-1&&(U=w-1),Fe(this,Wn).setPosition(k),Fe(this,Ko).setPosition(U)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>il(this,QM,Dre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>il(this,eA,Lre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Fe(this,Wn).build(),Fe(this,Ko).build()}destroy(){Fe(this,Wn).destroy(),Fe(this,Ko).destroy(),super.destroy()}}function Hre(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Fe(this,es)||t.button!==0){Js(this,es,!1),Fe(this,po).length=0,ke(this.hot.rootElement,[WC,Pf]);return}const l=Fe(this,Ko).isBuilt()&&!Fe(this,Ko).isAppended(),u=Fe(this,Wn).isBuilt()&&!Fe(this,Wn).isAppended();l&&u&&(Fe(this,Ko).appendTo(i.hider),Fe(this,Wn).appendTo(i.hider));const{from:c,to:h}=a,f=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=f&&e.row<=g){r.row=!0,Js(this,es,!0),Fe(this,rr).eventPageY=t.pageY,Fe(this,rr).coords=e,Fe(this,rr).TD=n,Js(this,po,this.prepareRowsToMoving());const w=i.holder.scrollLeft+o.getRowHeaderWidth(),C=this.getRowsHeight(f,e.row-1)+t.offsetY;Fe(this,Wn).setPosition(null,w),Fe(this,Wn).setSize(i.hider.offsetWidth-w,this.getRowsHeight(f,g)),Fe(this,Wn).setOffset(-C,null),ee(this.hot.rootElement,WC),this.refreshPositions()}else ke(this.hot.rootElement,VC),Js(this,es,!1),Fe(this,po).length=0}function Dre(t){Fe(this,es)&&(Fe(this,rr).eventPageY=t.pageY,this.refreshPositions())}function Nre(t,e,n,r){!this.hot.getSelectedRangeLast()||!Fe(this,es)||(Fe(this,po).indexOf(e.row)>-1?ke(this.hot.rootElement,Pf):ee(this.hot.rootElement,Pf),r.row=!0,r.column=!0,r.cell=!0,Fe(this,rr).coords=e,Fe(this,rr).TD=n)}function Lre(){const t=Fe(this,rr).row,e=Fe(this,po).length;if(Js(this,es,!1),ke(this.hot.rootElement,[WC,Pf,VC]),this.hot.selection.isSelectedByRowHeader()&&ee(this.hot.rootElement,VC),e<1||t===void 0)return;const n=Fe(this,po)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Fe(this,po),t);if(Fe(this,po).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function kre(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Fe(this,Wn).setPosition(null,r),Fe(this,Wn).setSize(t.hider.offsetWidth-r)}function $re(){this.moveBySettingsOrLoad()}function Vs(t,e){kD(t,e),e.add(t)}function Sn(t,e,n){kD(t,e),e.set(t,n)}function kD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Lt(t,e,n){var r=$D(t,e,"set");return Fre(t,r,n),n}function Fre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ae(t,e){var n=$D(t,e,"get");return Wre(t,n)}function $D(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Wre(t,e){return e.get?e.get.call(t):e.value}const xf="manualRowResize",Vre=30,rA="manualRowHeights";var bi=new WeakMap,cd=new WeakMap,cr=new WeakMap,If=new WeakMap,Xo=new WeakMap,_b=new WeakMap,Tl=new WeakMap,hd=new WeakMap,Ln=new WeakMap,vi=new WeakMap,aa=new WeakMap,Hf=new WeakMap,ec=new WeakMap,tc=new WeakMap,Kr=new WeakMap,nc=new WeakMap,iA=new WeakSet,oA=new WeakSet,sA=new WeakSet,aA=new WeakSet,lA=new WeakSet,uA=new WeakSet,cA=new WeakSet;class Bre extends ot{static get PLUGIN_KEY(){return xf}static get PLUGIN_PRIORITY(){return Vre}constructor(e){super(e),Vs(this,cA),Vs(this,uA),Vs(this,lA),Vs(this,aA),Vs(this,sA),Vs(this,oA),Vs(this,iA),Sn(this,bi,{writable:!0,value:null}),Sn(this,cd,{writable:!0,value:null}),Sn(this,cr,{writable:!0,value:[]}),Sn(this,If,{writable:!0,value:null}),Sn(this,Xo,{writable:!0,value:null}),Sn(this,_b,{writable:!0,value:null}),Sn(this,Tl,{writable:!0,value:null}),Sn(this,hd,{writable:!0,value:null}),Sn(this,Ln,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Sn(this,vi,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Sn(this,aa,{writable:!0,value:!1}),Sn(this,Hf,{writable:!0,value:!1}),Sn(this,ec,{writable:!0,value:0}),Sn(this,tc,{writable:!0,value:null}),Sn(this,Kr,{writable:!0,value:void 0}),Sn(this,nc,{writable:!0,value:void 0}),ee(ae(this,Ln),"manualRowResizer"),ee(ae(this,vi),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[xf]}enablePlugin(){this.enabled||(Lt(this,Kr,new gs),ae(this,Kr).addLocalHook("init",()=>Bs(this,cA,Xre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ae(this,Kr)),this.addHook("modifyRowHeight",(e,n)=>Bs(this,uA,Kre).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Lt(this,nc,ae(this,Kr).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",rA,ae(this,Kr).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",rA,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,AI.DEFAULT_HEIGHT);return ae(this,Kr).setValueAtIndex(r,i),i}setupHandlePosition(e){Lt(this,bi,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ae(this,bi)),o=i.row;if(o<0)return;const s=dt(ae(this,bi)),a=ae(this,bi).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(this,bi),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ae(this,bi),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ae(this,bi),i.row,i.col)),Lt(this,cd,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Lt(this,cr,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();T(f,g=>{const w=g.getTopStartCorner().row,C=g.getBottomStartCorner().row;ve(w,C,b=>{ae(this,cr).includes(b)||ae(this,cr).push(b)})})}ae(this,cr).includes(ae(this,cd))||Lt(this,cr,[ae(this,cd)]),Lt(this,hd,c.top-6),Lt(this,Tl,parseInt(a.height,10)),ae(this,Ln).style.top=`${ae(this,hd)+ae(this,Tl)}px`,ae(this,Ln).style[this.inlineDir]=`${c.start}px`,ae(this,Ln).style.width=`${s}px`,this.hot.rootElement.appendChild(ae(this,Ln))}refreshHandlePosition(){ae(this,Ln).style.top=`${ae(this,hd)+ae(this,If)}px`}setupGuidePosition(){const e=parseInt(dt(ae(this,Ln)),10),n=parseInt(ae(this,Ln).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ee(ae(this,Ln),"active"),ee(ae(this,vi),"active"),ae(this,vi).style.top=ae(this,Ln).style.top,ae(this,vi).style[this.inlineDir]=`${n}px`,ae(this,vi).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ae(this,vi))}refreshGuidePosition(){ae(this,vi).style.top=ae(this,Ln).style.top}hideHandleAndGuide(){ke(ae(this,Ln),"active"),ke(ae(this,vi),"active")}checkIfRowHeader(e){var n;return as(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ae(this,Xo)<n?n:ae(this,Xo)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Lt(this,Xo,o),this.setManualSize(r,ae(this,Xo)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ae(this,ec)>=2&&(ae(this,cr).length>1?(T(ae(this,cr),i=>{n(i)}),e()):T(ae(this,cr),i=>{n(i,!0)})),Lt(this,ec,0),Lt(this,tc,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Bs(this,iA,Ure).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Bs(this,oA,Gre).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Bs(this,sA,zre).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Bs(this,aA,Yre).call(this)),this.eventManager.addEventListener(ae(this,Ln),"contextmenu",()=>Bs(this,lA,jre).call(this))}destroy(){super.destroy()}}function Ure(t){if(!$v(t.target)&&ae(this,Hf)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ae(this,aa)||this.setupHandlePosition(e))}}function Gre(t){De(t.target,"manualRowResizer")&&(this.setupHandlePosition(ae(this,bi)),this.setupGuidePosition(),Lt(this,aa,!0),ae(this,tc)===null&&(Lt(this,tc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(this,tc))),Lt(this,ec,ae(this,ec)+1),Lt(this,_b,t.pageY),Lt(this,Xo,ae(this,Tl)))}function zre(t){ae(this,aa)&&(Lt(this,If,ae(this,Tl)+(t.pageY-ae(this,_b))),T(ae(this,cr),e=>{Lt(this,Xo,this.setManualSize(e,ae(this,If)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Yre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ae(this,aa)&&(this.hideHandleAndGuide(),Lt(this,aa,!1),ae(this,Xo)!==ae(this,Tl)&&(ae(this,cr).length>1?(T(ae(this,cr),r=>{e(r)}),t()):T(ae(this,cr),r=>{e(r,!0)})),this.setupHandlePosition(ae(this,bi)))}function jre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(this,Ln)),this.hot.rootElement.removeChild(ae(this,vi)),Lt(this,aa,!1),Lt(this,Hf,!0),this.hot._registerImmediate(()=>{Lt(this,Hf,!1)})}function Kre(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ae(this,Kr).getValueAtIndex(r);this.hot.getSettings()[xf]&&i&&(n=i)}return n}function Xre(){const t=this.hot.getSettings()[xf],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ae(this,Kr).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ae(this,Kr).setValueAtIndex(r,n)}),Lt(this,nc,t)):t===!0&&Array.isArray(ae(this,nc))&&ae(this,nc).forEach((n,r)=>{ae(this,Kr).setValueAtIndex(r,n)})},!0)}function Us(t,e,n){return e=qre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qre(t){var e=Zre(t,"string");return typeof e=="symbol"?e:String(e)}function Zre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qre{constructor(e,n,r,i,o,s){Us(this,"row",void 0),Us(this,"col",void 0),Us(this,"rowspan",void 0),Us(this,"colspan",void 0),Us(this,"removed",!1),Us(this,"cellCoordsFactory",void 0),Us(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ft`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ft`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,f=Math.abs(r)-h;this[s]-=f+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Ri=Qre;function BC(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function nw(t,e,n){return e=Jre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jre(t){var e=eie(t,"string");return typeof e=="symbol"?e:String(e)}function eie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mb{constructor(e){nw(this,"plugin",void 0),nw(this,"mergedCells",[]),nw(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return T(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return T(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return T(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Ri(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(vt(Mb.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];T(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,T(n,(i,o)=>{ve(0,i.rowspan-1,s=>{ve(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),T(n,i=>{BC(...i)}),T(r,i=>{BC(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return T(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}T(this.mergedCells,o=>{o.shift(i,n)}),lf(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const tie=Mb;function rw(t,e,n){return e=nie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nie(t){var e=rie(t,"string");return typeof e=="symbol"?e:String(e)}function rie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iie{constructor(e){rw(this,"plugin",void 0),rw(this,"mergedCellsCollection",void 0),rw(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,f=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,g=Math.floor(s/f)*f,w=s-g,C=this.getFarthestCollection(e,n,r,i);if(C){if(r==="down"){const b=C.row+C.rowspan-a-w;o[2]+b>=this.plugin.hot.countRows()?o[2]-=w:o[2]+=w?b:0}else if(r==="right"){const b=C.col+C.colspan-l-w;o[3]+b>=this.plugin.hot.countCols()?o[3]-=w:o[3]+=w?b:0}else if(r==="up"){const b=u-w-C.row+1;o[0]+b<0?o[0]+=w:o[0]-=w?b:0}else if(r==="left"){const b=c-w-C.col+1;o[1]+b<0?o[1]+=w:o[1]-=w?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Kt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,f=this.getAutofillSize(e,n,r),g=u?a-o+1:l-s+1,w=Math.floor(f/g)*g,C=f-w;let b=null,y=null,_=null;switch(r){case"up":b="includesVertically",_=c-C+1;break;case"left":b="includesHorizontally",_=c-C+1;break;case"down":b="includesVertically",_=h+C-1;break;case"right":b="includesHorizontally",_=h+C-1;break}return T(i,O=>{O[b](_)&&O.isFarther(y,r)&&(y=O)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return T(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const oie=iie;function iw(t,e,n){return e=sie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sie(t){var e=aie(t,"string");return typeof e=="symbol"?e:String(e)}function aie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lie{constructor(e){iw(this,"plugin",void 0),iw(this,"hot",void 0),iw(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const uie=lie;function cie(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(jS)}return this.getTranslatedPhrase(YS)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Ri.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Bt(t,e){FD(t,e),e.add(t)}function hie(t,e,n){FD(t,e),e.set(t,n)}function FD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ow(t,e,n){return e=die(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function die(t){var e=fie(t,"string");return typeof e=="symbol"?e:String(e)}function fie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sw(t,e,n){var r=WD(t,e,"set");return gie(t,r,n),n}function gie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ol(t,e){var n=WD(t,e,"get");return mie(t,n)}function WD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mie(t,e){return e.get?e.get.call(t):e.value}function Ht(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}me.getSingleton().register("beforeMergeCells");me.getSingleton().register("afterMergeCells");me.getSingleton().register("beforeUnmergeCells");me.getSingleton().register("afterUnmergeCells");const rc="mergeCells",pie=150,hA=rc;var Si=new WeakMap,dA=new WeakSet,fA=new WeakSet,gA=new WeakSet,mA=new WeakSet,pA=new WeakSet,wA=new WeakSet,CA=new WeakSet,aw=new WeakSet,vA=new WeakSet,SA=new WeakSet,yA=new WeakSet,bA=new WeakSet,RA=new WeakSet,EA=new WeakSet,TA=new WeakSet,_A=new WeakSet,MA=new WeakSet,AA=new WeakSet,OA=new WeakSet,PA=new WeakSet,xA=new WeakSet,IA=new WeakSet;class wie extends ot{constructor(){super(...arguments),Bt(this,IA),Bt(this,xA),Bt(this,PA),Bt(this,OA),Bt(this,AA),Bt(this,MA),Bt(this,_A),Bt(this,TA),Bt(this,EA),Bt(this,RA),Bt(this,bA),Bt(this,yA),Bt(this,SA),Bt(this,vA),Bt(this,aw),Bt(this,CA),Bt(this,wA),Bt(this,pA),Bt(this,mA),Bt(this,gA),Bt(this,fA),Bt(this,dA),ow(this,"mergedCellsCollection",null),ow(this,"autofillCalculations",null),ow(this,"selectionCalculations",null),hie(this,Si,{writable:!0,value:null})}static get PLUGIN_KEY(){return rc}static get PLUGIN_PRIORITY(){return pie}isEnabled(){return!!this.hot.getSettings()[rc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new tie(this),this.autofillCalculations=new oie(this),this.selectionCalculations=new uie(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,dA,Cie).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,gA,Sie).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,PA,Lie).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,mA,yie).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,pA,bie).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,aw,HA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,aw,HA).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,vA,Tie).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,fA,vie).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,CA,Eie).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,wA,Rie).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,SA,_ie).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,yA,Mie).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,bA,Aie).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,RA,Oie).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,EA,Pie).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,TA,xie).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,_A,Iie).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,MA,Hie).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,AA,Die).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,OA,Nie).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,xA,kie).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,IA,$ie).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[rc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!Bv())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=_l(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=_l(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(Ri.containsNegativeValues(e)?(vt(Ri.NEGATIVE_VALUES_WARNING(e)),n=!1):Ri.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(vt(Ri.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):Ri.isSingleCell(e)?(vt(Ri.IS_SINGLE_CELL(e)),n=!1):Ri.containsZeroSpan(e)&&(vt(Ri.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(T(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),ve(r.row,r.row+r.rowspan-1,a=>{ve(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),ve(0,s.rowspan-1,c=>{ve(0,s.colspan-1,h=>{let f=null;a[c]||(a[c]=[]),c===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),T(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),ve(0,i.rowspan-1,o=>{ve(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:hA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Be(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Be(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Be(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Be(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Cie(){this.generateFromSettings(this.hot.getSettings()[rc]),this.hot.render()}function vie(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function Sie(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(ol(this,Si)||sw(this,Si,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(ol(this,Si))||sw(this,Si,this.hot._createCellCoords(null,null)),n.row=ol(this,Si).row?ol(this,Si).row-i.row:n.row,n.col=ol(this,Si).col?ol(this,Si).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);sw(this,Si,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function yie(t){const e=this.hot.getSelectedRangeLast(),n=Bn(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Bn(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Bn(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),T(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function bie(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function Rie(t){t.items.push({name:"---------"},cie(this))}function Eie(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Be(r)?Bn(r):void 0;if(Be(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,f]=this.translateMergedCellToRenderable(a,c,l,u),g=o.getRenderableFromVisualIndex(e),w=s.getRenderableFromVisualIndex(n),C=h-g+1,b=f-w+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,C),i.colspan=Math.min(i.colspan,b)}BC(t,i,e,n)}function HA(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function Tie(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function _ie(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Mie(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Aie(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Oie(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function Pie(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function xie(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Iie(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Hie(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Die(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Nie(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);T(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Lie(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function kie(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function $ie(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Fie(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.multiColumnSorting,w=(f.compareFunctionFactory?f.compareFunctionFactory:fH(u.type))(l,u,f)(c,h);if(w===Pi){const C=a+1;if(typeof e[C]<"u")return s(C)}return w}(0)}}function DA(){vt(ft`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const VD="sort";function Wie(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${VD}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Vie(t){const e=t.className.split(" "),n=new RegExp(`^${VD}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Bie(t,e,n){return e=Uie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uie(t){var e=Gie(t,"string");return typeof e=="symbol"?e:String(e)}function Gie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Df="multiColumnSorting",zie=170,NA="columnSorting",LA=Df;dH(Df,Fie);class Yie extends gH{constructor(){super(...arguments),Bie(this,"pluginKey",Df)}static get PLUGIN_KEY(){return Df}static get PLUGIN_PRIORITY(){return zie}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[NA]&&DA(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,vf))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:LA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(LA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),ke(e,Vie(e)),this.enabled!==!1&&ee(e,Wie(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[NA]&&DA(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){gb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,vf))):this.sort(this.getColumnNextConfig(n.col)))}}function kA(t,e,n){return e=jie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jie(t){var e=Kie(t,"string");return typeof e=="symbol"?e:String(e)}function Kie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Xie="multipleSelectionHandles",qie=160;class Zie extends ot{constructor(){super(...arguments),kA(this,"dragged",[]),kA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Xie}static get PLUGIN_PRIORITY(){return qie}isEnabled(){return co()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(De(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(De(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(De(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(De(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const f=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function UC(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function BD(){return{label:"",isPlaceholder:!0}}function Qie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;T(t,i=>{const o=[];let s=0;n.push(o),T(i,a=>{const l=UC();if(Be(a)){const{label:c,colspan:h}=a;l.label=Ft(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Ft(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(BD());return!u})});const r=Math.max(...Ue(n,i=>i.length));return T(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>UC());i.splice(i.length,0,...o)}}),n}function lw(t,e,n){Jie(t,e),e.set(t,n)}function Jie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ur(t,e){var n=UD(t,e,"get");return eoe(t,n)}function eoe(t,e){return e.get?e.get.call(t):e.value}function Mu(t,e,n){var r=UD(t,e,"set");return toe(t,r,n),n}function UD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function toe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const $A=["label","collapsible"];var Ji=new WeakMap,Gs=new WeakMap,uw=new WeakMap;class noe{constructor(){lw(this,Ji,{writable:!0,value:[]}),lw(this,Gs,{writable:!0,value:0}),lw(this,uw,{writable:!0,value:1/0})}setColumnsLimit(e){Mu(this,uw,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Mu(this,Ji,Qie(e,Ur(this,uw))),Mu(this,Gs,Ur(this,Ji).length)}getData(){return Ur(this,Ji)}mergeWith(e){T(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&Kt(s,o,$A)})}map(e){T(Ur(this,Ji),n=>{T(n,r=>{const i=e({...r});Be(i)&&Kt(r,i,$A)})})}getHeaderSettings(e,n){var r;if(e>=Ur(this,Gs)||e<0)return null;const i=Ur(this,Ji)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Ur(this,Gs)||e<0)return i;const o=Ur(this,Ji)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Ur(this,Gs)}getColumnsCount(){return Ur(this,Gs)>0?Ur(this,Ji)[0].length:0}clear(){Mu(this,Ji,[]),Mu(this,Gs,0)}}function cw(t,e,n){return e=roe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function roe(t){var e=ioe(t,"string");return typeof e=="symbol"?e:String(e)}function ioe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const GD="DF-pre-order";function zD(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=zD.call(this.childs[r],t,e)}return n}const ooe="DF-post-order";function YD(t,e){for(let n=0;n<this.childs.length;n++)if(YD.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const jD="BF";function soe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const aoe=jD,FA=new Map([[GD,zD],[ooe,YD],[jD,soe]]);class Nf{constructor(e){cw(this,"data",{}),cw(this,"parent",null),cw(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Nf({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:aoe;if(!FA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);FA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function hw(t,e,n){loe(t,e),e.set(t,n)}function loe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e){var n=KD(t,e,"get");return uoe(t,n)}function uoe(t,e){return e.get?e.get.call(t):e.value}function coe(t,e,n){var r=KD(t,e,"set");return hoe(t,r,n),n}function KD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function hoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var sl=new WeakMap,zs=new WeakMap,al=new WeakMap;class doe{constructor(e){hw(this,sl,{writable:!0,value:new Map}),hw(this,zs,{writable:!0,value:new Map}),hw(this,al,{writable:!0,value:null}),coe(this,al,e)}getRoots(){return Array.from(Nn(this,sl).values())}getRootByColumn(e){let n;return Nn(this,zs).has(e)&&(n=Nn(this,sl).get(Nn(this,zs).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Nn(this,zs).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Nn(this,zs).clear(),T(Nn(this,sl),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Nn(this,zs).set(i,e);e+=r})}buildTree(){this.clear();const e=Nn(this,al).getColumnsCount();let n=0;for(;n<e;){const r=Nn(this,al).getHeaderSettings(0,n),i=new Nf;Nn(this,sl).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Nn(this,al).getHeadersSettings(r,n,i);r+=1,T(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Nf(a),e.addChild(l)),r<Nn(this,al).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Nn(this,sl).clear(),Nn(this,zs).clear()}}function XD(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Lf(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function kf(t){return Lf(t,"origColspan")===t.data.origColspan}function Ab(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(kf(t))return Ab(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)T(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,XD(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):kf(a)&&(l.isCollapsed=Lf(a,"isCollapsed"))}),{rollbackModification:()=>Ob(t),affectedColumns:Array.from(o),colspanCompensation:s}}function Ob(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(kf(t))return Ob(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)T(o,l=>{XD(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Lf(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):kf(l)&&(u.isCollapsed=Lf(l,"isCollapsed"))}),{rollbackModification:()=>Ab(t),affectedColumns:Array.from(s),colspanCompensation:a}}function foe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ft`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function goe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ft`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const WA=new Map([["collapse",Ob],["expand",Ab],["hide-column",foe],["show-column",goe]]);function moe(t,e,n){if(!WA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return WA.get(t)(e,n)}function dd(t){const e=[];return T(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=woe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(BD());else{const g=poe(i);g.isRoot=!0,u.push(g),c=!0}})}),e}function poe(t){const{crossHiddenColumns:e,...n}=UC(t);return n}function woe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function dw(t,e,n){Coe(t,e),e.set(t,n)}function Coe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Au(t,e,n){var r=qD(t,e,"set");return voe(t,r,n),n}function voe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Dt(t,e){var n=qD(t,e,"get");return Soe(t,n)}function qD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Soe(t,e){return e.get?e.get.call(t):e.value}var Ci=new WeakMap,Xn=new WeakMap,Ys=new WeakMap;class yoe{constructor(){dw(this,Ci,{writable:!0,value:new noe}),dw(this,Xn,{writable:!0,value:new doe(Dt(this,Ci))}),dw(this,Ys,{writable:!0,value:[[]]})}setState(e){Dt(this,Ci).setData(e);let n=!1;try{Dt(this,Xn).buildTree()}catch{Dt(this,Xn).clear(),Dt(this,Ci).clear(),n=!0}return Au(this,Ys,dd(Dt(this,Xn).getRoots())),n}setColumnsLimit(e){Dt(this,Ci).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Dt(this,Ci).mergeWith(n),Dt(this,Xn).buildTree(),Au(this,Ys,dd(Dt(this,Xn).getRoots()))}mapState(e){Dt(this,Ci).map(e),Dt(this,Xn).buildTree(),Au(this,Ys,dd(Dt(this,Xn).getRoots()))}mapNodes(e){return Gt(Dt(this,Xn).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Dt(this,Xn).getNode(n,r);let o;return i&&(o=moe(e,i,r),Au(this,Ys,dd(Dt(this,Xn).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Dt(this,Ys)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Dt(this,Xn).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Dt(this,Xn).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:f,isHidden:g}=u.data;g||f<=i&&c>=e&&c+f-1<=r&&(s===null||h<s)&&(s=h)},GD)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Dt(this,Ci).getLayersCount()}getColumnsCount(){return Dt(this,Ci).getColumnsCount()}clear(){Au(this,Ys,[]),Dt(this,Ci).clear(),Dt(this,Xn).clear()}}function Ou(t,e,n){return e=boe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function boe(t){var e=Roe(t,"string");return typeof e=="symbol"?e:String(e)}function Roe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eoe{constructor(e,n){Ou(this,"hot",void 0),Ou(this,"nestedHeaderSettingsGetter",void 0),Ou(this,"layersCount",0),Ou(this,"container",void 0),Ou(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const f=n.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let w=g.label;s&&(w+='<button class="changeType"></button>'),ga(f,w),f.colSpan=g.colspan,u.appendChild(f)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const Toe=Eoe;function cn(t,e){ZD(t,e),e.add(t)}function VA(t,e,n){return e=_oe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _oe(t){var e=Moe(t,"string");return typeof e=="symbol"?e:String(e)}function Moe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fd(t,e,n){ZD(t,e),e.set(t,n)}function ZD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ea(t,e,n){var r=QD(t,e,"set");return Aoe(t,r,n),n}function Aoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function nt(t,e){var n=QD(t,e,"get");return Ooe(t,n)}function QD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ooe(t,e){return e.get?e.get.call(t):e.value}function Qt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const BA="nestedHeaders",Poe=280;var ht=new WeakMap,Vo=new WeakMap,ic=new WeakMap,Fg=new WeakMap,gd=new WeakSet,UA=new WeakSet,GA=new WeakSet,zA=new WeakSet,YA=new WeakSet,jA=new WeakSet,KA=new WeakSet,XA=new WeakSet,qA=new WeakSet,ZA=new WeakSet,QA=new WeakSet,JA=new WeakSet,eO=new WeakSet,tO=new WeakSet,nO=new WeakSet,rO=new WeakSet,iO=new WeakSet,oO=new WeakSet;class xoe extends ot{constructor(){super(...arguments),cn(this,oO),cn(this,iO),cn(this,rO),cn(this,nO),cn(this,tO),cn(this,eO),cn(this,JA),cn(this,QA),cn(this,ZA),cn(this,qA),cn(this,XA),cn(this,KA),cn(this,jA),cn(this,YA),cn(this,zA),cn(this,GA),cn(this,UA),cn(this,gd),fd(this,ht,{writable:!0,value:new yoe}),fd(this,Vo,{writable:!0,value:null}),fd(this,ic,{writable:!0,value:null}),fd(this,Fg,{writable:!0,value:!1}),VA(this,"ghostTable",new Toe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),VA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return BA}static get PLUGIN_PRIORITY(){return Poe}isEnabled(){return!!this.hot.getSettings()[BA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&vt(ft`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Qt(this,iO,joe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,oO,Koe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,YA,Noe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,jA,Loe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,KA,koe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,XA,$oe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,qA,Foe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,ZA,Woe).call(e,...i)}),this.addHook("afterSelection",()=>Qt(this,gd,fw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,UA,Ioe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Qt(this,JA,Boe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,tO,Goe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,nO,zoe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,GA,Hoe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,zA,Doe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,QA,Voe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,eO,Uoe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,rO,Yoe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Qt(this,gd,fw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Qt(this,gd,fw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();nt(this,ht).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=nt(this,ht).setState(e)),this.detectedOverlappedHeaders&&vt(ft`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";nt(this,ht).triggerColumnModification(i,r)}),!nt(this,Vo)&&this.enabled&&ea(this,Vo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";nt(this,ht).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),nt(this,ht).clear(),nt(this,Vo).unsubscribe(),ea(this,Vo,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return nt(this,ht)}getLayersCount(){return nt(this,ht).getLayersCount()}getHeaderSettings(e,n){return nt(this,ht).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),ke(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),ke(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),ke(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),ke(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:f}=(s=nt(this,ht).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||h)ee(o,"hiddenHeader");else if(c>1){var g,w;const{wtOverlays:C}=l._wt,b=(g=C.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),y=(w=C.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o),_=b||y?Math.min(c,r-i):c;_>1&&o.setAttribute("colspan",_)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=nt(this,ht).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){ea(this,ht,null),nt(this,Vo)!==null&&(nt(this,Vo).unsubscribe(),ea(this,Vo,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return nt(this,ht).getHeaderTreeNodeData(e.row,e.col)}}function fw(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=nt(this,ht).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Ioe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=nt(this,ht).findLeftMostColumnIndex(n.row,n.col),a=nt(this,ht).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function Hoe(t,e,n){const r=nt(this,ht).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=nt(this,ht).getHeaderSettings(e,t);if(o===hS){if(!a)return r.columnIndex}else if(o===GI&&(l>s-i||!a))return null;return t}function Doe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let f=a;f<=u;f++)for(let g=s;g<=l;g++){var i;const w=c+g,C=f-a;if(C===0)continue;((i=nt(this,ht).getHeaderTreeNodeData(g,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[w][C]="")}}}function Noe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Loe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;ea(this,ic,e.clone()),ea(this,Fg,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(fg(t)||cs(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function koe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],f=ir(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,f):e.col>c.col?h.push(l.col,o+s-1,f):h.push(o,o+s-1,f),this.hot.selection.selectColumns(...h)}function $oe(){ea(this,Fg,!1)}function Foe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!nt(this,Fg)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=nt(this,ht).getHeaderTreeNodeData(nt(this,ic).row,nt(this,ic).col);if(e.setHighlight(nt(this,ic)),o>e.getWidth()||i<n||i+o-1>r){const s=nt(this,ht).findTopMostEntireHeaderLevel(ir(n,i,i+o-1),ir(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Woe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=nt(this,ht).findLeftMostColumnIndex(n.row,n.col),o=nt(this,ht).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Voe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Boe(t){t.length=0;for(let e=0;e<nt(this,ht).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Uoe(t){const e=nt(this,ht).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=nt(this,ht).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Vn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?nt(this,ht).getHeaderTreeNodeData(0,n).columnIndex:n}function Goe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function zoe(t,e,n){var r;const{label:i}=(r=nt(this,ht).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Yoe(t,e){if(t<0)return this.hot.getCell(t,nt(this,ht).findLeftMostColumnIndex(t,e),!0)}function joe(){this.updatePlugin()}function Koe(t,e){e||this.updatePlugin()}function Pu(t,e,n){return e=Xoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xoe(t){var e=qoe(t,"string");return typeof e=="symbol"?e:String(e)}function qoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zoe{constructor(e,n){Pu(this,"hot",void 0),Pu(this,"data",null),Pu(this,"plugin",void 0),Pu(this,"parentReference",new WeakMap),Pu(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ve(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&T(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&T(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ge(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(T(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(ve(e[0],e[2],f=>{const g=this.translateTrimmedRow(f);i.push(this.getDataObject(g))}),ve(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const f=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,f,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),w=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",w+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];T(r,o=>{i.push(this.getDataObject(o))}),T(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const Qoe=Zoe;function sO(t,e,n){return e=Joe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Joe(t){var e=ese(t,"string");return typeof e=="symbol"?e:String(e)}function ese(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tse{constructor(e,n){sO(this,"hot",void 0),sO(this,"plugin",void 0),this.hot=n,this.plugin=e}}const Pb=tse;class so extends Pb{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(T(l,c=>{c&&s.removeChild(c)}),ee(n,so.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",ve(0,i-1,()=>{const f=c.createElement("SPAN");ee(f,so.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Me(c,[To()]),ee(n,so.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(ee(c,`${so.CSS_CLASSES.button} ${so.CSS_CLASSES.expandButton}`),u&&Me(n,[Ar(!1)])):(ee(c,`${so.CSS_CLASSES.button} ${so.CSS_CLASSES.collapseButton}`),u&&Me(n,[Ar(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const JD=so;class nse extends Pb{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),T(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{ve(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&T(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&T(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&T(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);De(e.target,JD.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Hr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const rse=nse;function ise(t,e,n){ose(t,e),e.set(t,n)}function ose(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sse(t,e,n){return e=ase(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ase(t){var e=lse(t,"string");return typeof e=="symbol"?e:String(e)}function lse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function use(t,e){var n=cse(t,e,"get");return hse(t,n)}function cse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function hse(t,e){return e.get?e.get.call(t):e.value}var aO=new WeakMap;class dse extends Pb{constructor(){super(...arguments),sse(this,"dataManager",this.plugin.dataManager),ise(this,aO,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(dy)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(fy)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ve(0,e.items.length-1,r=>{if(r===0)return T(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ve(0,e.items.length-1,n=>{const r=use(this,aO)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const fse=dse;function md(t,e,n){return e=gse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gse(t){var e=mse(t,"string");return typeof e=="symbol"?e:String(e)}function mse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pse{constructor(e){md(this,"plugin",void 0),md(this,"hot",void 0),md(this,"dataManager",void 0),md(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(w=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(C,a),C}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),f=this.getTargetParent(s,a),g=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Ct(i)&&(vt(ft`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function yn(t,e){eN(t,e),e.add(t)}function lO(t,e,n){eN(t,e),e.set(t,n)}function eN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gw(t,e,n){return e=wse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wse(t){var e=Cse(t,"string");return typeof e=="symbol"?e:String(e)}function Cse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vd(t,e){var n=tN(t,e,"get");return vse(t,n)}function vse(t,e){return e.get?e.get.call(t):e.value}function $f(t,e,n){var r=tN(t,e,"set");return Sse(t,r,n),n}function tN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Sse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function mn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ff="nestedRows",yse=300,uO=Ff,bse="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Wg=new WeakMap,ll=new WeakMap,cO=new WeakSet,hO=new WeakSet,dO=new WeakSet,fO=new WeakSet,gO=new WeakSet,mO=new WeakSet,pO=new WeakSet,wO=new WeakSet,CO=new WeakSet,vO=new WeakSet,SO=new WeakSet,yO=new WeakSet,bO=new WeakSet,RO=new WeakSet,EO=new WeakSet,mw=new WeakSet;class Rse extends ot{constructor(){super(...arguments),yn(this,mw),yn(this,EO),yn(this,RO),yn(this,bO),yn(this,yO),yn(this,SO),yn(this,vO),yn(this,CO),yn(this,wO),yn(this,pO),yn(this,mO),yn(this,gO),yn(this,fO),yn(this,dO),yn(this,hO),yn(this,cO),gw(this,"dataManager",null),gw(this,"headersUI",null),gw(this,"collapsedRowsMap",null),lO(this,Wg,{writable:!0,value:!1}),lO(this,ll,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Ff}static get PLUGIN_PRIORITY(){return yse}isEnabled(){return!!this.hot.getSettings()[Ff]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Fc),this.dataManager=new Qoe(this,this.hot),this.collapsingUI=new rse(this,this.hot),this.headersUI=new JD(this,this.hot),this.contextMenuUI=new fse(this,this.hot),this.rowMoveController=new pse(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,RO,kse).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,EO,$se).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,dO,_se).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,fO,Mse).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,gO,Ase).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,hO,Tse).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,wO,xse).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,pO,Pse).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,CO,Ise).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,vO,Hse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,SO,Dse).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,yO,Nse).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,mO,Ose).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,bO,Lse).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,cO,Ese).call(e,...r)}),this.addHook("beforeLoadData",n=>mn(this,mw,TO).call(this,n)),this.addHook("beforeUpdateData",n=>mn(this,mw,TO).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:uO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uO)}disableCoreAPIModifiers(){$f(this,ll,!0)}enableCoreAPIModifiers(){$f(this,ll,!1)}onModifyRowData(e){if(!Vd(this,ll))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Vd(this,ll))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Vd(this,ll)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function Ese(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Tse(t,e,n){this.collapsingUI.toggleState(t,e,n)}function _se(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),$f(this,Wg,!0),this.dataManager.getData().slice()}function Mse(t){return this.contextMenuUI.appendOptions(t)}function Ase(t,e){this.headersUI.appendLevelIndicators(t,e)}function Ose(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Pse(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{$f(this,Wg,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function xse(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Ise(){this.collapsingUI.collapsedRowsStash.stash()}function Hse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Dse(){this.collapsingUI.collapsedRowsStash.stash()}function Nse(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Lse(){this.dataManager.rewriteCache()}function kse(){this.headersUI.updateRowHeaderWidth()}function $se(t,e){Vd(this,Wg)&&(e.skipRender=!0)}function TO(t){if(!r1(t)){jv(bse),this.hot.getSettings()[Ff]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function pw(t,e,n){return e=Fse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fse(t){var e=Wse(t,"string");return typeof e=="symbol"?e:String(e)}function Wse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vse{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;pw(this,"rootWindow",void 0),pw(this,"prefix",void 0),pw(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){T(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Bse=Vse;function Use(t,e,n){return e=Gse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gse(t){var e=zse(t,"string");return typeof e=="symbol"?e:String(e)}function zse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}me.getSingleton().register("persistentStateSave");me.getSingleton().register("persistentStateLoad");me.getSingleton().register("persistentStateReset");const _O="persistentState",Yse=0;class jse extends ot{constructor(){super(...arguments),Use(this,"storage",void 0)}static get PLUGIN_KEY(){return _O}static get PLUGIN_PRIORITY(){return Yse}isEnabled(){return!!this.hot.getSettings()[_O]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Bse(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Kse(t,e){Xse(t,e),e.add(t)}function Xse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ww(t,e,n){return e=qse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qse(t){var e=Zse(t,"string");return typeof e=="symbol"?e:String(e)}function Zse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MO(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Cw="search",Qse=190,Jse="htSearchResult",eae=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},tae=function(t,e,n){return Ct(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ct(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var vw=new WeakSet;class nae extends ot{constructor(){super(...arguments),Kse(this,vw),ww(this,"callback",eae),ww(this,"queryMethod",tae),ww(this,"searchResultClass",Jse)}static get PLUGIN_KEY(){return Cw}static get PLUGIN_PRIORITY(){return Qse}isEnabled(){return this.hot.getSettings()[Cw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Cw];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return MO(e,vw,AO).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return MO(e,vw,AO).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return ve(0,i-1,l=>{ve(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),f=h.search.callback||n,w=(h.search.queryMethod||r)(e,c,h);if(w){const C={row:l,col:u,data:c};s.push(C)}f&&f(a,l,u,c,w)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Be(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function AO(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Sw(t,e){rae(t,e),e.add(t)}function rae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pd(t,e,n){return e=iae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iae(t){var e=oae(t,"string");return typeof e=="symbol"?e:String(e)}function oae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const sae="touchScroll",aae=200;var OO=new WeakSet,PO=new WeakSet,xO=new WeakSet;class lae extends ot{constructor(){super(...arguments),Sw(this,xO),Sw(this,PO),Sw(this,OO),pd(this,"scrollbars",[]),pd(this,"clones",[]),pd(this,"lockedCollection",!1),pd(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return sae}static get PLUGIN_PRIORITY(){return aae}static get SETTING_KEYS(){return!0}isEnabled(){return iS()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>yw(this,OO,uae).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>yw(this,PO,cae).call(this)),this.addHook("afterMomentumScroll",()=>yw(this,xO,hae).call(this))}}function uae(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function cae(){this.freezeOverlays=!0,T(this.clones,t=>{ee(t,"hide-tween")})}function hae(){this.freezeOverlays=!1,T(this.clones,t=>{ke(t,"hide-tween"),ee(t,"show-tween")}),this.hot._registerTimeout(()=>{T(this.clones,t=>{ke(t,"show-tween")})},400),T(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function dae(t,e){fae(t,e),e.add(t)}function fae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gae(t,e,n){return e=mae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mae(t){var e=pae(t,"string");return typeof e=="symbol"?e:String(e)}function pae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wae(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Bd="trimRows",Cae=330;var IO=new WeakSet;class vae extends ot{constructor(){super(...arguments),dae(this,IO),gae(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Bd}static get PLUGIN_PRIORITY(){return Cae}isEnabled(){return!!this.hot.getSettings()[Bd]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Fc),this.trimmedRowsMap.addLocalHook("init",()=>wae(this,IO,Sae).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Bd];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),T(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(T(e,l=>{o[l]=!1}),i=Gt(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Sae(){const t=this.hot.getSettings()[Bd];Array.isArray(t)&&this.hot.batchExecution(()=>{T(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const nN="undoRedo",yae="undoRedo";function de(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);T(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new de.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new de.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=Mn(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new de.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new de.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],h=[];ve(a.length-1,w=>{const C=[],b=a[w];ve(l,l+(r-1),y=>{C.push(b[t.toPhysicalColumn(y)])}),u.push(C)}),ve(r-1,w=>{h.push(t.toPhysicalColumn(l+w))}),Array.isArray(t.getSettings().colHeaders)&&ve(r-1,w=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+w)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),g=t.rowIndexMapper.getIndexesSequence();return new de.RemoveColumnAction(l,h,u,c,f,g,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new de.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new de.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new de.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new de.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new de.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}de.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};de.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Mn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};de.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Mn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};de.prototype.isUndoAvailable=function(){return this.doneActions.length>0};de.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};de.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};de.prototype.isEnabled=function(){return this.enabled};de.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Eae(t),this.registerShortcuts(),t.addHook("afterChange",rN)};de.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,Tae(t),this.unregisterShortcuts(),t.removeHook("afterChange",rN)};de.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};de.Action=function(){};de.Action.prototype.undo=function(){};de.Action.prototype.redo=function(){};de.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};_o(de.ChangeAction,de.Action);de.ChangeAction.prototype.undo=function(t,e){const n=Mn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};de.ChangeAction.prototype.redo=function(t,e){const n=Mn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};de.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};_o(de.CreateRowAction,de.Action);de.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};de.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};de.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};_o(de.RemoveRowAction,de.Action);de.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};de.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};de.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};_o(de.CreateColumnAction,de.Action);de.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};de.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};de.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};_o(de.RemoveColumnAction,de.Action);de.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ue(this.data[u],i));const a=Ue(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),T(t.getSourceDataArray(),(u,c)=>{T(r,(h,f)=>{u[h]=s[c][f],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&T(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};de.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};de.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};de.CellAlignmentAction.prototype.undo=function(t,e){T(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};de.CellAlignmentAction.prototype.redo=function(t,e){Uo(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};de.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};_o(de.FiltersAction,de.Action);de.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};de.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class bae extends de.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}de.MergeCellsAction=bae;class Rae extends de.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}de.UnmergeCellsAction=Rae;de.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};_o(de.RowMoveAction,de.Action);de.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};de.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};de.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};de.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:nN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};de.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(nN)};function rN(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function Eae(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Tae(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const jc=me.getSingleton();jc.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});jc.register("beforeUndo");jc.register("afterUndo");jc.register("beforeRedo");jc.register("afterRedo");de.PLUGIN_KEY=yae;de.SETTING_KEYS=!0;function _ae(){rt(zu),rt(s7),rt(Yu),rt(k7),rt(Y7),rt(gH),rt(k8),rt(b5),rt(Ng),rt(YZ),rt(pQ),rt(EQ),rt(kg),rt(ZQ),rt(ote),rt(Wte),rt(fne),rt(Tne),rt($ne),rt(Jne),rt(cre),rt(Ire),rt(Bre),rt(wie),rt(Yie),rt(Zie),rt(xoe),rt(Rse),rt(jse),rt(nae),rt(lae),rt(vae),rt(de)}function Mae(){I6(),j6(),t9(),R9(),_ae()}function Aae(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var bw,Rw,Ew,Tw,_w;Mae();Aae(Ie);Ie.__GhostTable=db;Ie._getListenersCounter=Yz;Ie._getRegisteredMapsCounter=lX;Ie.EventManager=pr;const Oae=[SG,Mz,K3,X6,Rj,lz,EG,lY,Ez,_G,Pz,aY],Pae=[iz,xz];Ie.helper={};Ie.dom={};T(Oae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ie.helper[e]=t[e])})});T(Pae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ie.dom[e]=t[e])})});Ie.cellTypes=(bw=Ie.cellTypes)!==null&&bw!==void 0?bw:{};T(Aq(),t=>{Ie.cellTypes[t]=Qy(t)});Ie.cellTypes.registerCellType=br;Ie.cellTypes.getCellType=Qy;Ie.editors=(Rw=Ie.editors)!==null&&Rw!==void 0?Rw:{};T(Fz(),t=>{Ie.editors[`${_n(t)}Editor`]=sf(t)});Ie.editors.registerEditor=er;Ie.editors.getEditor=sf;Ie.renderers=(Ew=Ie.renderers)!==null&&Ew!==void 0?Ew:{};T(RY(),t=>{const e=uf(t);t==="base"&&(Ie.renderers.cellDecorator=e),Ie.renderers[`${_n(t)}Renderer`]=e});Ie.renderers.registerRenderer=yi;Ie.renderers.getRenderer=uf;Ie.validators=(Tw=Ie.validators)!==null&&Tw!==void 0?Tw:{};T(_Y(),t=>{Ie.validators[`${_n(t)}Validator`]=Qv(t)});Ie.validators.registerValidator=pl;Ie.validators.getValidator=Qv;Ie.plugins=(_w=Ie.plugins)!==null&&_w!==void 0?_w:{};T(Zv(),t=>{Ie.plugins[t]=Lc(t)});Ie.plugins[`${_n(ot.PLUGIN_KEY)}Plugin`]=ot;Ie.plugins.registerPlugin=rt;Ie.plugins.getPlugin=Lc;var xb={exports:{}};xb.exports;(function(t){(function(e,n,r){function i(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),h=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,h&&(typeof h=="object"&&o(h,c),f.state=function(){return o(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(Qr,t,!1)})(xb);var xae=xb.exports,Ib={exports:{}};Ib.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(Qr,t,!1)})(Ib);var Iae=Ib.exports,Hb={exports:{}};Hb.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(Qr,t,!1)})(Hb);var Hae=Hb.exports,Db={exports:{}};Db.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.x,h=l.i,f,g;return f=c[h],f^=f>>>7,g=f^f<<24,f=c[h+1&7],g^=f^f>>>10,f=c[h+3&7],g^=f^f>>>3,f=c[h+4&7],g^=f^f<<7,f=c[h+7&7],f=f^f<<13,g^=f^f<<9,c[h]=g,l.i=h+1&7,g};function u(c,h){var f,g=[];if(h===(h|0))g[0]=h;else for(h=""+h,f=0;f<h.length;++f)g[f&7]=g[f&7]<<15^h.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],c.x=g,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(c.x&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(Qr,t,!1)})(Db);var Dae=Db.exports,Nb={exports:{}};Nb.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.w,h=l.X,f=l.i,g,w;return l.w=c=c+1640531527|0,w=h[f+34&127],g=h[f=f+1&127],w^=w<<13,g^=g<<17,w^=w>>>15,g^=g>>>12,w=h[f]=w^g,l.i=f,w+(c^c>>>16)|0};function u(c,h){var f,g,w,C,b,y=[],_=128;for(h===(h|0)?(g=h,h=null):(h=h+"\0",g=0,_=Math.max(_,h.length)),w=0,C=-32;C<_;++C)h&&(g^=h.charCodeAt((C+32)%h.length)),C===0&&(b=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,C>=0&&(b=b+1640531527|0,f=y[C&127]^=g+b,w=f==0?w+1:0);for(w>=128&&(y[(h&&h.length||0)&127]=-1),w=127,C=4*128;C>0;--C)g=y[w+34&127],f=y[w=w+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,y[w]=g^f;c.w=b,c.X=y,c.i=w}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(c.X&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(Qr,t,!1)})(Nb);var Nae=Nb.exports,Lb={exports:{}};Lb.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.b,f=l.c,g=l.d,w=l.a;return h=h<<25^h>>>7^f,f=f-g|0,g=g<<24^g>>>8^w,w=w-h|0,l.b=h=h<<20^h>>>12^f,l.c=f=f-g|0,l.d=g<<16^f>>>16^w,l.a=w-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(Qr,t,!1)})(Lb);var Lae=Lb.exports,iN={exports:{}};const kae={},$ae=Object.freeze(Object.defineProperty({__proto__:null,default:kae},Symbol.toStringTag,{value:"Module"})),Fae=FO($ae);(function(t){(function(e,n,r){var i=256,o=6,s=52,a="random",l=r.pow(i,o),u=r.pow(2,s),c=u*2,h=i-1,f;function g(I,x,k){var U=[];x=x==!0?{entropy:!0}:x||{};var Z=y(b(x.entropy?[I,O(n)]:I??_(),3),U),z=new w(U),K=function(){for(var te=z.g(o),oe=l,ie=0;te<u;)te=(te+ie)*i,oe*=i,ie=z.g(1);for(;te>=c;)te/=2,oe/=2,ie>>>=1;return(te+ie)/oe};return K.int32=function(){return z.g(4)|0},K.quick=function(){return z.g(4)/4294967296},K.double=K,y(O(z.S),n),(x.pass||k||function(te,oe,ie,he){return he&&(he.S&&C(he,z),te.state=function(){return C(z,{})}),ie?(r[a]=te,oe):te})(K,Z,"global"in x?x.global:this==r,x.state)}function w(I){var x,k=I.length,U=this,Z=0,z=U.i=U.j=0,K=U.S=[];for(k||(I=[k++]);Z<i;)K[Z]=Z++;for(Z=0;Z<i;Z++)K[Z]=K[z=h&z+I[Z%k]+(x=K[Z])],K[z]=x;(U.g=function(te){for(var oe,ie=0,he=U.i,Te=U.j,ze=U.S;te--;)oe=ze[he=h&he+1],ie=ie*i+ze[h&(ze[he]=ze[Te=h&Te+oe])+(ze[Te]=oe)];return U.i=he,U.j=Te,ie})(i)}function C(I,x){return x.i=I.i,x.j=I.j,x.S=I.S.slice(),x}function b(I,x){var k=[],U=typeof I,Z;if(x&&U=="object")for(Z in I)try{k.push(b(I[Z],x-1))}catch{}return k.length?k:U=="string"?I:I+"\0"}function y(I,x){for(var k=I+"",U,Z=0;Z<k.length;)x[h&Z]=h&(U^=x[h&Z]*19)+k.charCodeAt(Z++);return O(x)}function _(){try{var I;return f&&(I=f.randomBytes)?I=I(i):(I=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(I)),O(I)}catch{var x=e.navigator,k=x&&x.plugins;return[+new Date,e,k,e.screen,O(n)]}}function O(I){return String.fromCharCode.apply(0,I)}if(y(r.random(),n),t.exports){t.exports=g;try{f=Fae}catch{}}else r["seed"+a]=g})(typeof self<"u"?self:Qr,[],Math)})(iN);var Wae=iN.exports,Vae=xae,Bae=Iae,Uae=Hae,Gae=Dae,zae=Nae,Yae=Lae,wa=Wae;wa.alea=Vae;wa.xor128=Bae;wa.xorwow=Uae;wa.xorshift7=Gae;wa.xor4096=zae;wa.tychei=Yae;var jae=wa;const oN=GC(jae);let sN=oN();function aN(){return sN()}function Kae(t){sN=oN(t)}function Ca(t,e){let n=t;if(Array.isArray(t)){let r=t;e!=null&&e.maxCharCount&&typeof t[0]=="string"&&(r=t.filter(i=>i.length<=e.maxCharCount)),n=()=>lN(r)}return(e==null?void 0:e.length)===void 0?n(0):Array.from({length:e.length},(r,i)=>n(i))}function lN(t){return t[Math.floor(aN()*t.length)]}function Xae({min:t=1,max:e=9999.99,fraction:n=0}={}){if(e<t)throw new Error("Max must be bigger than min");return Number((aN()*(e-t)+t).toFixed(n))}function HO(t){return Ca(()=>lN([!0,!1]),t)}function to(t){const e={min:(t==null?void 0:t.min)??0,max:(t==null?void 0:t.max)??999999,precision:t==null?void 0:t.precision,fraction:t==null?void 0:t.fraction};return Ca(()=>{if(e.min===e.max)return e.min;const n=Xae(e);return e.precision!==void 0?Math.floor(n/e.precision)*e.precision:n},t)}function qae(t){const e=new Date(t.from).getTime(),n=new Date(t.to).getTime();if(e>=n)throw new Error("From must be before to");return Ca(()=>new Date(to({min:e,max:n})),t)}var Zae=["Kautzer, Macejkovic and Fisher","Greenholt - Mosciski","Marquardt - Runolfsdottir","Abernathy Inc","Dickens - Lang","Hand, Bernhard and Kessler","Abbott LLC","Kub Inc","Johnston - Wisozk","Reichert LLC","Kohler LLC","Shanahan - Boyle","Batz - Rice","Cronin, Oberbrunner and Beier","Kuhlman, Schowalter and West","Luettgen Inc","Ward Group","Hills and Sons","Prohaska, Balistreri and Walker","Rempel - Durgan","Bernier LLC","Stehr - Lockman","Roberts, Rogahn and Dooley","Lesch - Jakubowski","Jenkins - Turcotte","Gerhold - Rowe","Block - Rau","Dickinson, Tremblay and Moore","Nader - Fritsch","Kreiger and Sons","Bartell, Wehner and Schowalter","Hegmann Inc","Orn, Spencer and Kiehn","Graham, Sipes and Towne","Hodkiewicz Inc","Mills Group","Legros, Tillman and Hodkiewicz","Lesch - Carter","Lesch Group","Kreiger - Sauer","Cartwright - Schuster","Labadie LLC","Pfannerstill, White and Mosciski","Jenkins LLC","Boehm, Hettinger and Huels","Maggio, Wisoky and Blick","Kozey Inc","Stracke - Wisozk","Olson, Olson and Carter","Orn, Gerlach and Runolfsdottir","Stracke - Kertzmann","Walker - Zieme","Hodkiewicz - Hintz","Lind Group","Fahey, Leannon and Gleichner","Mertz, Gusikowski and Lemke","Heidenreich - Aufderhar","Zboncak and Sons","Carroll Group","Brown LLC","Weber Inc","Rath LLC","Walker Inc","Heller, Hyatt and Jaskolski","Jacobi - Kutch","Skiles and Sons","Durgan - Stamm","Renner - Prosacco","Hahn - Welch","Lesch, Dooley and Bartell","Crona and Sons","Rogahn, Armstrong and Goyette","Lubowitz, Kuhlman and Bailey","Doyle Group","Dooley and Sons","Kerluke LLC","Bogan - Daniel","Hintz - Boehm","Swaniawski and Sons","Kris, Legros and Cartwright","Reichel Group","Russel - Hintz","Welch, Lockman and Hand","Pouros - Brakus","Mohr, Fritsch and Wisozk","Upton - Reichert","Koepp and Sons","Weber and Sons","Quigley, Bins and Becker","Strosin, Oberbrunner and Wunsch","Rodriguez - Spencer","Wilkinson - Dare","Gutkowski Inc","OReilly LLC","Collins, Mante and Pacocha","Steuber, Luettgen and Corkery","Kub and Sons","Lesch and Sons"];function DO(t){return Ca(Zae,t)}var Qae=["Argentina","Peru","Colombia","Chile","Uruguay","Gabon","Congo","Norfolk Island","Qatar","Syrian Arab Republic","Wallis and Futuna","Somalia","Saint Barthelemy","Comoros","Sri Lanka","Czech Republic","Christmas Island","Macao","Montenegro","Anguilla","Canada","Mayotte","Tajikistan","Afghanistan","Liechtenstein","Cocos (Keeling) Islands","Angola","Bahrain","Dominican Republic","Croatia","Latvia","Virgin Islands, U.S.","United Kingdom","Brazil","Spain","Mongolia","Montserrat","Estonia","Benin","Guinea","Guinea-Bissau","Greece","Lao Peoples Democratic Republic","Puerto Rico","Slovakia (Slovak Republic)","United States of America","Switzerland","Costa Rica","Mauritius","Nigeria","Russian Federation","Germany","Antigua and Barbuda","Albania","Romania","Moldova","Senegal","Tanzania","British Indian Ocean Territory (Chagos Archipelago)","Central African Republic","New Caledonia","Burundi","Panama","Azerbaijan","Namibia","French Southern Territories","Vanuatu","Ethiopia","Burkina Faso","Tunisia","Mozambique","Belarus","Saint Kitts and Nevis","Hungary","Indonesia","Cyprus","Ecuador","Saint Martin","Nauru","Faroe Islands","Iran","Bolivia","Pitcairn Islands","France","Paraguay","Isle of Man","Sierra Leone","Monaco","Belize","Trinidad and Tobago"];function Jae(t){return Ca(Qae,t)}var ele={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","TiramisÃ¹"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","PipiÃ¡n","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","HuÃ®tres","Cassoulet","Poulet basquaise","Escargots au beurre persillÃ©","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","SoufflÃ© au fromage","Cuisses de grenouilles","Soupe Ã  lâoignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","CrÃ¨me brÃ»lÃ©e","Ãle flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["ÅiÅ kebap","DÃ¶ner","KÃ¶fte","Pide","Kumpir","Meze","MantÄ±","Lahmacun","Menemen","ÅiÅ kebap","Ä°skender kebab","Corba","Kuzu tandir","ÃiÄ KÃ¶fte","Pilav","Yaprak sarma","Dolma","Ä°mam bayÄ±ldÄ±","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","GÃ¼llaÃ§","Mercimek KÃ¶ftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","CalÃ§ots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileÃ±o","Cachopo","Caracoles"],venezuela:["PabellÃ³n criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","TequeÃ±os","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de JamÃ³n"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifÃ¡sico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","AlmojÃ¡bana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","CiorbÄ de fasole cu ciolan","CiorbÄ de burtÄ","CiorbÄ rÄdÄuÈeanÄ","PlÄcintÄ cu brÃ¢nzÄ","CiorbÄ de potroace","MÄmÄligÄ cu brÃ¢nzÄ Èi smÃ¢ntÃ¢nÄ","TochiturÄ","Piftie","Iahnie de fasole","SlÄninÄ afumatÄ","CÃ¢rnaÈi afumaÈi","VarzÄ a la Cluj","GulaÈ de cartofi cu afumÄturÄ","Cozonac de casÄ","CiorbÄ ardeleneascÄ de porc","Mucenici moldoveneÈti","SalatÄ de boeuf","Dovleac copt","PapanaÈi cu brÃ¢nzÄ de vacÄ Èi afine","Drob de miel","PÃ¢rjoale moldoveneÈti","ZacuscÄ de vinete","ZacuscÄ de fasole","TurtÄ dulce","ClÄtitele cu gem","ClÄtitele cu brÃ¢nza de vacÄ","BalmoÈ","Cozonac","Chiftele"]},$O;($O=Object.keys(ele))==null||$O.length;function NO(t){const e=(t==null?void 0:t.years)??1;if(e<=0)throw new Error("Years must be positive, use future() instead");const n=365*e*24*60*60*1e3,r=new Date,i=new Date(r.getTime()-n);return Ca(()=>qae({from:i,to:r}),t)}var tle=["Small Rubber Shoes","Fantastic Wooden Sausages","Handmade Frozen Salad","Intelligent Soft Car","Intelligent Concrete Chips","Handcrafted Concrete Bacon","Small Fresh Fish","Rustic Metal Towels","Unbranded Cotton Hat","Fantastic Frozen Bike","Generic Rubber Shirt","Unbranded Wooden Keyboard","Awesome Metal Computer","Gorgeous Fresh Shoes","Unbranded Concrete Sausages","Practical Wooden Ball","Ergonomic Soft Towels","Small Plastic Table","Awesome Metal Pants","Licensed Steel Sausages","Handcrafted Rubber Bike","Ergonomic Cotton Computer","Generic Wooden Ball","Fantastic Frozen Soap","Generic Plastic Keyboard","Awesome Cotton Pizza","Licensed Metal Chips","Handcrafted Cotton Towels","Handmade Plastic Tuna","Practical Granite Keyboard","Intelligent Concrete Soap","Rustic Concrete Chips","Fantastic Steel Hat","Rustic Cotton Chair","Gorgeous Metal Pants","Intelligent Metal Bacon","Handmade Rubber Car","Tasty Concrete Keyboard","Incredible Granite Hat","Practical Rubber Fish","Rustic Cotton Gloves","Rustic Cotton Ball","Refined Fresh Shirt","Generic Granite Sausages","Rustic Granite Fish","Practical Wooden Bacon","Sleek Plastic Chair","Handcrafted Fresh Mouse","Small Concrete Shoes","Awesome Fresh Chair","Incredible Soft Computer","Tasty Concrete Chips","Generic Rubber Sausages","Intelligent Concrete Chicken","Rustic Soft Ball","Awesome Steel Towels","Incredible Fresh Bike","Unbranded Granite Chicken","Rustic Concrete Bike","Small Frozen Sausages","Intelligent Plastic Gloves","Ergonomic Frozen Towels","Refined Frozen Ball","Refined Cotton Ball","Licensed Steel Salad","Intelligent Wooden Bacon","Unbranded Metal Shoes","Fantastic Granite Car","Ergonomic Granite Bacon","Awesome Wooden Shirt","Rustic Wooden Pizza","Tasty Frozen Table","Awesome Wooden Hat","Awesome Rubber Salad","Licensed Concrete Fish","Fantastic Soft Cheese","Rustic Frozen Pizza","Refined Concrete Tuna","Small Frozen Tuna","Licensed Granite Cheese","Practical Rubber Car","Rustic Steel Sausages","Awesome Concrete Hat","Awesome Granite Sausages","Sleek Plastic Chips","Handcrafted Wooden Gloves","Intelligent Metal Computer","Fantastic Fresh Sausages","Fantastic Plastic Salad","Unbranded Steel Sausages","Handcrafted Wooden Fish","Sleek Wooden Bacon","Unbranded Plastic Towels","Tasty Soft Sausages","Generic Metal Shirt","Handmade Granite Cheese","Small Fresh Bacon","Tasty Granite Towels","Licensed Steel Chips"];function LO(t){return Ca(tle,t)}Kae("42219");const uN=[{companyName:DO({maxCharCount:18}),productName:LO({maxCharCount:18}),sellDate:NO().toLocaleDateString("en-gb"),inStock:HO(),qty:to({max:500}),orderId:`${to({max:9,min:0})}${to({max:9,min:0})}-${to({max:9999999,min:1111111})}`,country:"United Kingdom"},...Array.from({length:150},()=>({companyName:DO({maxCharCount:18}),productName:LO({maxCharCount:18}),sellDate:NO().toLocaleDateString("en-gb"),inStock:HO(),qty:to({max:500}),orderId:`${to({max:9,min:0})}${to({max:9,min:0})}-${to({max:9999999,min:1111111})}`,country:Jae({maxCharCount:28})}))],nle=uN.reduce((t,e)=>t.includes(e.country)?t:[...t,e.country],[]),kO=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function rle(t,e){if(!(t<0)&&e.firstChild){const n=this.isRtl()?"htRight":"htLeft";kO.has(t.toString())?(Ie.dom.removeClass(e.firstChild,n),Ie.dom.addClass(e.firstChild,kO.get(t.toString()))):Ie.dom.addClass(e.firstChild,n)}}const ile=document.getElementById("handsontable"),or={data:uN,height:464,colWidths:[140,165,100,100,100,110,178],colHeaders:["Company name","Product name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:"companyName",type:"text"},{data:"productName",type:"text"},{data:"sellDate",type:"date",dateFormat:"DD/MM/YYYY",allowInvalid:!1},{data:"inStock",type:"checkbox",className:"htCenter"},{data:"qty",type:"numeric"},{data:"orderId",type:"text"},{data:"country",type:"dropdown",source:nle}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,navigableHeaders:!0,tabNavigation:!0,autoWrapRow:!0,autoWrapCol:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,afterGetColHeader:rle,licenseKey:"non-commercial-and-evaluation"};let Un=new Ie(ile,or);const va=(t,e)=>t.addEventListener("click",n=>e(t.checked));va(document.querySelector("#enable-tab-navigation"),t=>{or.tabNavigation=t,Un.updateSettings({tabNavigation:or.tabNavigation}),console.log("Updated setting: tabNavigation to",Un.getSettings().tabNavigation)});va(document.querySelector("#enable-header-navigation"),t=>{or.navigableHeaders=t,Un.updateSettings({navigableHeaders:or.navigableHeaders}),console.log("Updated setting: navigableHeaders to",Un.getSettings().navigableHeaders)});va(document.querySelector("#enable-cell-virtualization"),t=>{Un.destroy(),Un=new Ie(document.getElementById("handsontable"),{...or,renderAllRows:!t,viewportColumnRenderingOffset:t?"auto":9}),console.log("Updated setting: renderAllRows to",Un.getSettings().renderAllRows)});va(document.querySelector("#enable-cell-enter-editing"),t=>{or.enterBeginsEditing=t,Un.updateSettings({enterBeginsEditing:or.enterBeginsEditing}),console.log("Updated setting: enable-cell-enter-editing to",Un.getSettings().enterBeginsEditing)});va(document.querySelector("#enable-arrow-rl-first-last-column"),t=>{or.autoWrapRow=t,Un.updateSettings({autoWrapRow:or.autoWrapRow}),console.log("Updated setting: autoWrapRow to",Un.getSettings().autoWrapRow)});va(document.querySelector("#enable-arrow-td-first-last-column"),t=>{or.autoWrapCol=t,Un.updateSettings({autoWrapCol:or.autoWrapCol}),console.log("Updated setting: autoWrapCol to",Un.getSettings().autoWrapCol)});va(document.querySelector("#enable-enter-focus-editing"),t=>{or.enterMoves=t?{col:0,row:1}:{col:0,row:0},Un.updateSettings({enterMoves:or.enterMoves}),console.log("Updated setting: enterMoves to",Un.getSettings().enterMoves)})});export default ole();
