var zD=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var fae=zD((Oae,$d)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var cd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function RA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function jD(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){if(this instanceof r){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(e,i);return new o}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Uc=function(t){return t&&t.Math===Math&&t},An=Uc(typeof globalThis=="object"&&globalThis)||Uc(typeof window=="object"&&window)||Uc(typeof self=="object"&&self)||Uc(typeof cd=="object"&&cd)||function(){return this}()||cd||Function("return this")(),kC={},Ar=function(t){try{return!!t()}catch{return!0}},KD=Ar,Oi=!KD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),XD=Ar,Df=!XD(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),qD=Df,Yc=Function.prototype.call,Nf=qD?Yc.bind(Yc):function(){return Yc.apply(Yc,arguments)},EA={},TA={}.propertyIsEnumerable,_A=Object.getOwnPropertyDescriptor,ZD=_A&&!TA.call({1:2},1);EA.f=ZD?function(e){var n=_A(this,e);return!!n&&n.enumerable}:TA;var FC=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},MA=Df,AA=Function.prototype,yw=AA.call,QD=MA&&AA.bind.bind(yw,yw),Yn=MA?QD:function(t){return function(){return yw.apply(t,arguments)}},OA=Yn,JD=OA({}.toString),eN=OA("".slice),El=function(t){return eN(JD(t),8,-1)},tN=Yn,nN=Ar,rN=El,kg=Object,iN=tN("".split),oN=nN(function(){return!kg("z").propertyIsEnumerable(0)})?function(t){return rN(t)==="String"?iN(t,""):kg(t)}:kg,IA=function(t){return t==null},sN=IA,aN=TypeError,PA=function(t){if(sN(t))throw new aN("Can't call method on "+t);return t},lN=oN,uN=PA,Lf=function(t){return lN(uN(t))},bw=typeof document=="object"&&document.all,cN=typeof bw>"u"&&bw!==void 0,xA={all:bw,IS_HTMLDDA:cN},HA=xA,hN=HA.all,wn=HA.IS_HTMLDDA?function(t){return typeof t=="function"||t===hN}:function(t){return typeof t=="function"},xb=wn,DA=xA,dN=DA.all,ia=DA.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:xb(t)||t===dN}:function(t){return typeof t=="object"?t!==null:xb(t)},Fg=An,fN=wn,gN=function(t){return fN(t)?t:void 0},wc=function(t,e){return arguments.length<2?gN(Fg[t]):Fg[t]&&Fg[t][e]},mN=Yn,NA=mN({}.isPrototypeOf),WC=typeof navigator<"u"&&String(navigator.userAgent)||"",LA=An,Wg=WC,Hb=LA.process,Db=LA.Deno,Nb=Hb&&Hb.versions||Db&&Db.version,Lb=Nb&&Nb.v8,jr,kd;Lb&&(jr=Lb.split("."),kd=jr[0]>0&&jr[0]<4?1:+(jr[0]+jr[1]));!kd&&Wg&&(jr=Wg.match(/Edge\/(\d+)/),(!jr||jr[1]>=74)&&(jr=Wg.match(/Chrome\/(\d+)/),jr&&(kd=+jr[1])));var pN=kd,$b=pN,wN=Ar,CN=An,vN=CN.String,VC=!!Object.getOwnPropertySymbols&&!wN(function(){var t=Symbol("symbol detection");return!vN(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&$b&&$b<41}),SN=VC,$A=SN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",yN=wc,bN=wn,RN=NA,EN=$A,TN=Object,BC=EN?function(t){return typeof t=="symbol"}:function(t){var e=yN("Symbol");return bN(e)&&RN(e.prototype,TN(t))},_N=String,kA=function(t){try{return _N(t)}catch{return"Object"}},MN=wn,AN=kA,ON=TypeError,UC=function(t){if(MN(t))return t;throw new ON(AN(t)+" is not a function")},IN=UC,PN=IA,xN=function(t,e){var n=t[e];return PN(n)?void 0:IN(n)},Vg=Nf,Bg=wn,Ug=ia,HN=TypeError,DN=function(t,e){var n,r;if(e==="string"&&Bg(n=t.toString)&&!Ug(r=Vg(n,t))||Bg(n=t.valueOf)&&!Ug(r=Vg(n,t))||e!=="string"&&Bg(n=t.toString)&&!Ug(r=Vg(n,t)))return r;throw new HN("Can't convert object to primitive value")},FA={exports:{}},kb=An,NN=Object.defineProperty,YC=function(t,e){try{NN(kb,t,{value:e,configurable:!0,writable:!0})}catch{kb[t]=e}return e},LN=An,$N=YC,Fb="__core-js_shared__",kN=LN[Fb]||$N(Fb,{}),GC=kN,Wb=GC;(FA.exports=function(t,e){return Wb[t]||(Wb[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.33.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.2/LICENSE",source:"https://github.com/zloirock/core-js"});var WA=FA.exports,FN=PA,WN=Object,$f=function(t){return WN(FN(t))},VN=Yn,BN=$f,UN=VN({}.hasOwnProperty),Co=Object.hasOwn||function(e,n){return UN(BN(e),n)},YN=Yn,GN=0,zN=Math.random(),jN=YN(1 .toString),VA=function(t){return"Symbol("+(t===void 0?"":t)+")_"+jN(++GN+zN,36)},KN=An,XN=WA,Vb=Co,qN=VA,ZN=VC,QN=$A,sl=KN.Symbol,Yg=XN("wks"),JN=QN?sl.for||sl:sl&&sl.withoutSetter||qN,kf=function(t){return Vb(Yg,t)||(Yg[t]=ZN&&Vb(sl,t)?sl[t]:JN("Symbol."+t)),Yg[t]},eL=Nf,Bb=ia,Ub=BC,tL=xN,nL=DN,rL=kf,iL=TypeError,oL=rL("toPrimitive"),sL=function(t,e){if(!Bb(t)||Ub(t))return t;var n=tL(t,oL),r;if(n){if(e===void 0&&(e="default"),r=eL(n,t,e),!Bb(r)||Ub(r))return r;throw new iL("Can't convert object to primitive value")}return e===void 0&&(e="number"),nL(t,e)},aL=sL,lL=BC,BA=function(t){var e=aL(t,"string");return lL(e)?e:e+""},uL=An,Yb=ia,Rw=uL.document,cL=Yb(Rw)&&Yb(Rw.createElement),zC=function(t){return cL?Rw.createElement(t):{}},hL=Oi,dL=Ar,fL=zC,UA=!hL&&!dL(function(){return Object.defineProperty(fL("div"),"a",{get:function(){return 7}}).a!==7}),gL=Oi,mL=Nf,pL=EA,wL=FC,CL=Lf,vL=BA,SL=Co,yL=UA,Gb=Object.getOwnPropertyDescriptor;kC.f=gL?Gb:function(e,n){if(e=CL(e),n=vL(n),yL)try{return Gb(e,n)}catch{}if(SL(e,n))return wL(!mL(pL.f,e,n),e[n])};var oa={},bL=Oi,RL=Ar,YA=bL&&RL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),EL=ia,TL=String,_L=TypeError,Cc=function(t){if(EL(t))return t;throw new _L(TL(t)+" is not an object")},ML=Oi,AL=UA,OL=YA,Gc=Cc,zb=BA,IL=TypeError,Gg=Object.defineProperty,PL=Object.getOwnPropertyDescriptor,zg="enumerable",jg="configurable",Kg="writable";oa.f=ML?OL?function(e,n,r){if(Gc(e),n=zb(n),Gc(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Kg in r&&!r[Kg]){var i=PL(e,n);i&&i[Kg]&&(e[n]=r.value,r={configurable:jg in r?r[jg]:i[jg],enumerable:zg in r?r[zg]:i[zg],writable:!1})}return Gg(e,n,r)}:Gg:function(e,n,r){if(Gc(e),n=zb(n),Gc(r),AL)try{return Gg(e,n,r)}catch{}if("get"in r||"set"in r)throw new IL("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var xL=Oi,HL=oa,DL=FC,vc=xL?function(t,e,n){return HL.f(t,e,DL(1,n))}:function(t,e,n){return t[e]=n,t},GA={exports:{}},Ew=Oi,NL=Co,zA=Function.prototype,LL=Ew&&Object.getOwnPropertyDescriptor,jC=NL(zA,"name"),$L=jC&&(function(){}).name==="something",kL=jC&&(!Ew||Ew&&LL(zA,"name").configurable),FL={EXISTS:jC,PROPER:$L,CONFIGURABLE:kL},WL=Yn,VL=wn,Tw=GC,BL=WL(Function.toString);VL(Tw.inspectSource)||(Tw.inspectSource=function(t){return BL(t)});var UL=Tw.inspectSource,YL=An,GL=wn,jb=YL.WeakMap,zL=GL(jb)&&/native code/.test(String(jb)),jL=WA,KL=VA,Kb=jL("keys"),jA=function(t){return Kb[t]||(Kb[t]=KL(t))},KC={},XL=zL,KA=An,qL=ia,ZL=vc,Xg=Co,qg=GC,QL=jA,JL=KC,Xb="Object already initialized",_w=KA.TypeError,e$=KA.WeakMap,Fd,Qu,Wd,t$=function(t){return Wd(t)?Qu(t):Fd(t,{})},n$=function(t){return function(e){var n;if(!qL(e)||(n=Qu(e)).type!==t)throw new _w("Incompatible receiver, "+t+" required");return n}};if(XL||qg.state){var ri=qg.state||(qg.state=new e$);ri.get=ri.get,ri.has=ri.has,ri.set=ri.set,Fd=function(t,e){if(ri.has(t))throw new _w(Xb);return e.facade=t,ri.set(t,e),e},Qu=function(t){return ri.get(t)||{}},Wd=function(t){return ri.has(t)}}else{var ga=QL("state");JL[ga]=!0,Fd=function(t,e){if(Xg(t,ga))throw new _w(Xb);return e.facade=t,ZL(t,ga,e),e},Qu=function(t){return Xg(t,ga)?t[ga]:{}},Wd=function(t){return Xg(t,ga)}}var r$={set:Fd,get:Qu,has:Wd,enforce:t$,getterFor:n$},XC=Yn,i$=Ar,o$=wn,zc=Co,Mw=Oi,s$=FL.CONFIGURABLE,a$=UL,XA=r$,l$=XA.enforce,u$=XA.get,qb=String,hd=Object.defineProperty,c$=XC("".slice),h$=XC("".replace),d$=XC([].join),f$=Mw&&!i$(function(){return hd(function(){},"length",{value:8}).length!==8}),g$=String(String).split("String"),m$=GA.exports=function(t,e,n){c$(qb(e),0,7)==="Symbol("&&(e="["+h$(qb(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!zc(t,"name")||s$&&t.name!==e)&&(Mw?hd(t,"name",{value:e,configurable:!0}):t.name=e),f$&&n&&zc(n,"arity")&&t.length!==n.arity&&hd(t,"length",{value:n.arity});try{n&&zc(n,"constructor")&&n.constructor?Mw&&hd(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=l$(t);return zc(r,"source")||(r.source=d$(g$,typeof e=="string"?e:"")),t};Function.prototype.toString=m$(function(){return o$(this)&&u$(this).source||a$(this)},"toString");var p$=GA.exports,w$=wn,C$=oa,v$=p$,S$=YC,y$=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(w$(n)&&v$(n,o,r),r.global)i?t[e]=n:S$(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:C$.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},qA={},b$=Math.ceil,R$=Math.floor,E$=Math.trunc||function(e){var n=+e;return(n>0?R$:b$)(n)},T$=E$,qC=function(t){var e=+t;return e!==e||e===0?0:T$(e)},_$=qC,M$=Math.max,A$=Math.min,O$=function(t,e){var n=_$(t);return n<0?M$(n+e,0):A$(n,e)},I$=qC,P$=Math.min,x$=function(t){return t>0?P$(I$(t),9007199254740991):0},H$=x$,Ff=function(t){return H$(t.length)},D$=Lf,N$=O$,L$=Ff,Zb=function(t){return function(e,n,r){var i=D$(e),o=L$(i),s=N$(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},$$={includes:Zb(!0),indexOf:Zb(!1)},k$=Yn,Zg=Co,F$=Lf,W$=$$.indexOf,V$=KC,Qb=k$([].push),ZA=function(t,e){var n=F$(t),r=0,i=[],o;for(o in n)!Zg(V$,o)&&Zg(n,o)&&Qb(i,o);for(;e.length>r;)Zg(n,o=e[r++])&&(~W$(i,o)||Qb(i,o));return i},ZC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],B$=ZA,U$=ZC,Y$=U$.concat("length","prototype");qA.f=Object.getOwnPropertyNames||function(e){return B$(e,Y$)};var QA={};QA.f=Object.getOwnPropertySymbols;var G$=wc,z$=Yn,j$=qA,K$=QA,X$=Cc,q$=z$([].concat),Z$=G$("Reflect","ownKeys")||function(e){var n=j$.f(X$(e)),r=K$.f;return r?q$(n,r(e)):n},Jb=Co,Q$=Z$,J$=kC,ek=oa,JA=function(t,e,n){for(var r=Q$(e),i=ek.f,o=J$.f,s=0;s<r.length;s++){var a=r[s];!Jb(t,a)&&!(n&&Jb(n,a))&&i(t,a,o(e,a))}},tk=Ar,nk=wn,rk=/#|\.prototype\./,Sc=function(t,e){var n=ok[ik(t)];return n===ak?!0:n===sk?!1:nk(e)?tk(e):!!e},ik=Sc.normalize=function(t){return String(t).replace(rk,".").toLowerCase()},ok=Sc.data={},sk=Sc.NATIVE="N",ak=Sc.POLYFILL="P",lk=Sc,Qg=An,uk=kC.f,ck=vc,hk=y$,dk=YC,fk=JA,gk=lk,sa=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Qg:i?s=Qg[n]||dk(n,{}):s=(Qg[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=uk(s,a),l=c&&c.value):l=s[a],o=gk(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;fk(u,l)}(t.sham||l&&l.sham)&&ck(u,"sham",!0),hk(s,a,u,t)}},mk=El,eO=Array.isArray||function(e){return mk(e)==="Array"},pk=Oi,wk=eO,Ck=TypeError,vk=Object.getOwnPropertyDescriptor,Sk=pk&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),tO=Sk?function(t,e){if(wk(t)&&!vk(t,"length").writable)throw new Ck("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},yk=TypeError,bk=9007199254740991,nO=function(t){if(t>bk)throw yk("Maximum allowed index exceeded");return t},Rk=sa,Ek=$f,Tk=Ff,_k=tO,Mk=nO,Ak=Ar,Ok=Ak(function(){return[].push.call({length:4294967296},1)!==4294967297}),Ik=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Pk=Ok||!Ik();Rk({target:"Array",proto:!0,arity:1,forced:Pk},{push:function(e){var n=Ek(this),r=Tk(n),i=arguments.length;Mk(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return _k(n,r),r}});var xk=Df,rO=Function.prototype,eR=rO.apply,tR=rO.call,Wf=typeof Reflect=="object"&&Reflect.apply||(xk?tR.bind(eR):function(){return tR.apply(eR,arguments)}),Hk=Yn,Dk=UC,Nk=function(t,e,n){try{return Hk(Dk(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},Lk=wn,$k=String,kk=TypeError,Fk=function(t){if(typeof t=="object"||Lk(t))return t;throw new kk("Can't set "+$k(t)+" as a prototype")},Wk=Nk,Vk=Cc,Bk=Fk,iO=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=Wk(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return Vk(i),Bk(o),t?n(i,o):i.__proto__=o,i}}():void 0),Uk=oa.f,Yk=function(t,e,n){n in t||Uk(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},Gk=wn,zk=ia,nR=iO,jk=function(t,e,n){var r,i;return nR&&Gk(r=e.constructor)&&r!==n&&zk(i=r.prototype)&&i!==n.prototype&&nR(t,i),t},Kk=kf,Xk=Kk("toStringTag"),oO={};oO[Xk]="z";var qk=String(oO)==="[object z]",Zk=qk,Qk=wn,dd=El,Jk=kf,eF=Jk("toStringTag"),tF=Object,nF=dd(function(){return arguments}())==="Arguments",rF=function(t,e){try{return t[e]}catch{}},iF=Zk?dd:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=rF(e=tF(t),eF))=="string"?n:nF?dd(e):(r=dd(e))==="Object"&&Qk(e.callee)?"Arguments":r},oF=iF,sF=String,sO=function(t){if(oF(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return sF(t)},aF=sO,lF=function(t,e){return t===void 0?arguments.length<2?"":e:aF(t)},uF=ia,cF=vc,hF=function(t,e){uF(e)&&"cause"in e&&cF(t,"cause",e.cause)},dF=Yn,aO=Error,fF=dF("".replace),gF=function(t){return String(new aO(t).stack)}("zxcasd"),lO=/\n\s*at [^:]*:[^\n]*/,mF=lO.test(gF),pF=function(t,e){if(mF&&typeof t=="string"&&!aO.prepareStackTrace)for(;e--;)t=fF(t,lO,"");return t},wF=Ar,CF=FC,vF=!wF(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",CF(1,7)),t.stack!==7):!0}),SF=vc,yF=pF,bF=vF,rR=Error.captureStackTrace,RF=function(t,e,n,r){bF&&(rR?rR(t,e):SF(t,"stack",yF(n,r)))},iR=wc,EF=Co,oR=vc,TF=NA,sR=iO,aR=JA,lR=Yk,_F=jk,MF=lF,AF=hF,OF=RF,IF=Oi,PF=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=iR.apply(null,s);if(l){var u=l.prototype;if(EF(u,"cause")&&delete u.cause,!n)return l;var c=iR("Error"),d=e(function(f,p){var w=MF(r?p:f,void 0),v=r?new l(f):new l;return w!==void 0&&oR(v,"message",w),OF(v,d,v.stack,2),this&&TF(u,this)&&_F(v,this,d),arguments.length>o&&AF(v,arguments[o]),v});d.prototype=u,a!=="Error"?sR?sR(d,c):aR(d,c,{name:!0}):IF&&i in l&&(lR(d,l,i),lR(d,l,"prepareStackTrace")),aR(d,l);try{u.name!==a&&oR(u,"name",a),u.constructor=d}catch{}return d}},uO=sa,xF=An,Ii=Wf,cO=PF,Aw="WebAssembly",uR=xF[Aw],Vd=new Error("e",{cause:7}).cause!==7,aa=function(t,e){var n={};n[t]=cO(t,e,Vd),uO({global:!0,constructor:!0,arity:1,forced:Vd},n)},QC=function(t,e){if(uR&&uR[t]){var n={};n[t]=cO(Aw+"."+t,e,Vd),uO({target:Aw,stat:!0,constructor:!0,arity:1,forced:Vd},n)}};aa("Error",function(t){return function(n){return Ii(t,this,arguments)}});aa("EvalError",function(t){return function(n){return Ii(t,this,arguments)}});aa("RangeError",function(t){return function(n){return Ii(t,this,arguments)}});aa("ReferenceError",function(t){return function(n){return Ii(t,this,arguments)}});aa("SyntaxError",function(t){return function(n){return Ii(t,this,arguments)}});aa("TypeError",function(t){return function(n){return Ii(t,this,arguments)}});aa("URIError",function(t){return function(n){return Ii(t,this,arguments)}});QC("CompileError",function(t){return function(n){return Ii(t,this,arguments)}});QC("LinkError",function(t){return function(n){return Ii(t,this,arguments)}});QC("RuntimeError",function(t){return function(n){return Ii(t,this,arguments)}});var HF=El,DF=Yn,NF=function(t){if(HF(t)==="Function")return DF(t)},cR=NF,LF=UC,$F=Df,kF=cR(cR.bind),FF=function(t,e){return LF(t),e===void 0?t:$F?kF(t,e):function(){return t.apply(e,arguments)}},WF=wc,hO=WF("document","documentElement"),VF=Yn,JC=VF([].slice),BF=TypeError,dO=function(t,e){if(t<e)throw new BF("Not enough arguments");return t},UF=WC,YF=/(?:ipad|iphone|ipod).*applewebkit/i.test(UF),GF=An,zF=El,jF=zF(GF.process)==="process",dr=An,KF=Wf,XF=FF,hR=wn,qF=Co,fO=Ar,dR=hO,ZF=JC,fR=zC,QF=dO,JF=YF,eW=jF,Ow=dr.setImmediate,Iw=dr.clearImmediate,tW=dr.process,Jg=dr.Dispatch,nW=dr.Function,gR=dr.MessageChannel,rW=dr.String,em=0,Iu={},mR="onreadystatechange",Ju,ds,tm,nm;fO(function(){Ju=dr.location});var ev=function(t){if(qF(Iu,t)){var e=Iu[t];delete Iu[t],e()}},rm=function(t){return function(){ev(t)}},pR=function(t){ev(t.data)},wR=function(t){dr.postMessage(rW(t),Ju.protocol+"//"+Ju.host)};(!Ow||!Iw)&&(Ow=function(e){QF(arguments.length,1);var n=hR(e)?e:nW(e),r=ZF(arguments,1);return Iu[++em]=function(){KF(n,void 0,r)},ds(em),em},Iw=function(e){delete Iu[e]},eW?ds=function(t){tW.nextTick(rm(t))}:Jg&&Jg.now?ds=function(t){Jg.now(rm(t))}:gR&&!JF?(tm=new gR,nm=tm.port2,tm.port1.onmessage=pR,ds=XF(nm.postMessage,nm)):dr.addEventListener&&hR(dr.postMessage)&&!dr.importScripts&&Ju&&Ju.protocol!=="file:"&&!fO(wR)?(ds=wR,dr.addEventListener("message",pR,!1)):mR in fR("script")?ds=function(t){dR.appendChild(fR("script"))[mR]=function(){dR.removeChild(this),ev(t)}}:ds=function(t){setTimeout(rm(t),0)});var gO={set:Ow,clear:Iw},iW=sa,oW=An,CR=gO.clear;iW({global:!0,bind:!0,enumerable:!0,forced:oW.clearImmediate!==CR},{clearImmediate:CR});var sW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",mO=An,aW=Wf,lW=wn,uW=sW,cW=WC,hW=JC,dW=dO,fW=mO.Function,gW=/MSIE .\./.test(cW)||uW&&function(){var t=mO.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),mW=function(t,e){var n=e?2:1;return gW?function(r,i){var o=dW(arguments.length,1)>n,s=lW(r)?r:fW(r),a=o?hW(arguments,n):[],l=o?function(){aW(s,this,a)}:s;return e?t(l,i):t(l)}:t},pW=sa,pO=An,vR=gO.set,wW=mW,SR=pO.setImmediate?wW(vR,!1):vR;pW({global:!0,bind:!0,enumerable:!0,forced:pO.setImmediate!==SR},{setImmediate:SR});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Vo(t){"@babel/helpers - typeof";return Vo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vo(t)}function Pw(t,e){return Pw=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Pw(t,e)}function CW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function fd(t,e,n){return CW()?fd=Reflect.construct:fd=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&Pw(u,s.prototype),u},fd.apply(null,arguments)}function Br(t){return vW(t)||SW(t)||yW(t)||bW()}function vW(t){if(Array.isArray(t))return xw(t)}function SW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function yW(t,e){if(t){if(typeof t=="string")return xw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xw(t,e)}}function xw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function bW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var RW=Object.hasOwnProperty,yR=Object.setPrototypeOf,EW=Object.isFrozen,TW=Object.getPrototypeOf,_W=Object.getOwnPropertyDescriptor,Un=Object.freeze,Zr=Object.seal,MW=Object.create,wO=typeof Reflect<"u"&&Reflect,Bd=wO.apply,Hw=wO.construct;Bd||(Bd=function(e,n,r){return e.apply(n,r)});Un||(Un=function(e){return e});Zr||(Zr=function(e){return e});Hw||(Hw=function(e,n){return fd(e,Br(n))});var AW=Mr(Array.prototype.forEach),bR=Mr(Array.prototype.pop),$l=Mr(Array.prototype.push),gd=Mr(String.prototype.toLowerCase),im=Mr(String.prototype.toString),OW=Mr(String.prototype.match),xr=Mr(String.prototype.replace),IW=Mr(String.prototype.indexOf),PW=Mr(String.prototype.trim),xn=Mr(RegExp.prototype.test),om=xW(TypeError);function Mr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Bd(t,e,r)}}function xW(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Hw(t,n)}}function Ke(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:gd,yR&&yR(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(EW(e)||(e[i]=s),o=s)}t[o]=!0}return t}function fs(t){var e=MW(null),n;for(n in t)Bd(RW,t,[n])===!0&&(e[n]=t[n]);return e}function jc(t,e){for(;t!==null;){var n=_W(t,e);if(n){if(n.get)return Mr(n.get);if(typeof n.value=="function")return Mr(n.value)}t=TW(t)}function r(i){return console.warn("fallback value for",i),null}return r}var RR=Un(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),sm=Un(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),am=Un(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),HW=Un(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),lm=Un(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),DW=Un(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ER=Un(["#text"]),TR=Un(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),um=Un(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),_R=Un(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Kc=Un(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),NW=Zr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),LW=Zr(/<%[\w\W]*|[\w\W]*%>/gm),$W=Zr(/\${[\w\W]*}/gm),kW=Zr(/^data-[\-\w.\u00B7-\uFFFF]/),FW=Zr(/^aria-[\-\w]+$/),WW=Zr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),VW=Zr(/^(?:\w+script|data):/i),BW=Zr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),UW=Zr(/^html$/i),YW=function(){return typeof window>"u"?null:window},GW=function(e,n){if(Vo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function CO(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:YW(),e=function(N){return CO(N)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,d=t.HTMLFormElement,f=t.DOMParser,p=t.trustedTypes,w=a.prototype,v=jc(w,"cloneNode"),y=jc(w,"nextSibling"),b=jc(w,"childNodes"),_=jc(w,"parentNode");if(typeof o=="function"){var I=r.createElement("template");I.content&&I.content.ownerDocument&&(r=I.content.ownerDocument)}var L=GW(p,n),x=L?L.createHTML(""):"",W=r,G=W.implementation,ne=W.createNodeIterator,j=W.createDocumentFragment,X=W.getElementsByTagName,ie=n.importNode,oe={};try{oe=fs(r).documentMode?r.documentMode:{}}catch{}var se={};e.isSupported=typeof _=="function"&&G&&G.createHTMLDocument!==void 0&&oe!==9;var ve=NW,Pe=LW,tt=$W,Ne=kW,R=FW,h=VW,g=BW,m=WW,E=null,M=Ke({},[].concat(Br(RR),Br(sm),Br(am),Br(lm),Br(ER))),O=null,Y=Ke({},[].concat(Br(TR),Br(um),Br(_R),Br(Kc))),B=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),q=null,Q=null,K=!0,de=!0,Ae=!1,Ee=!0,Oe=!1,z=!1,je=!1,ke=!1,ye=!1,He=!1,Re=!1,C=!0,S=!1,A="user-content-",F=!0,P=!1,k={},H=null,D=Ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,$=Ke({},["audio","video","img","source","image","track"]),U=null,re=Ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fe="http://www.w3.org/1998/Math/MathML",be="http://www.w3.org/2000/svg",xe="http://www.w3.org/1999/xhtml",Ve=xe,St=!1,Ze=null,ct=Ke({},[fe,be,xe],im),_t,fa=["application/xhtml+xml","text/html"],Nl="text/html",Vt,dn=null,hs=r.createElement("form"),Pn=function(N){return N instanceof RegExp||N instanceof Function},tn=function(N){dn&&dn===N||((!N||Vo(N)!=="object")&&(N={}),N=fs(N),_t=fa.indexOf(N.PARSER_MEDIA_TYPE)===-1?_t=Nl:_t=N.PARSER_MEDIA_TYPE,Vt=_t==="application/xhtml+xml"?im:gd,E="ALLOWED_TAGS"in N?Ke({},N.ALLOWED_TAGS,Vt):M,O="ALLOWED_ATTR"in N?Ke({},N.ALLOWED_ATTR,Vt):Y,Ze="ALLOWED_NAMESPACES"in N?Ke({},N.ALLOWED_NAMESPACES,im):ct,U="ADD_URI_SAFE_ATTR"in N?Ke(fs(re),N.ADD_URI_SAFE_ATTR,Vt):re,V="ADD_DATA_URI_TAGS"in N?Ke(fs($),N.ADD_DATA_URI_TAGS,Vt):$,H="FORBID_CONTENTS"in N?Ke({},N.FORBID_CONTENTS,Vt):D,q="FORBID_TAGS"in N?Ke({},N.FORBID_TAGS,Vt):{},Q="FORBID_ATTR"in N?Ke({},N.FORBID_ATTR,Vt):{},k="USE_PROFILES"in N?N.USE_PROFILES:!1,K=N.ALLOW_ARIA_ATTR!==!1,de=N.ALLOW_DATA_ATTR!==!1,Ae=N.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Oe=N.SAFE_FOR_TEMPLATES||!1,z=N.WHOLE_DOCUMENT||!1,ye=N.RETURN_DOM||!1,He=N.RETURN_DOM_FRAGMENT||!1,Re=N.RETURN_TRUSTED_TYPE||!1,ke=N.FORCE_BODY||!1,C=N.SANITIZE_DOM!==!1,S=N.SANITIZE_NAMED_PROPS||!1,F=N.KEEP_CONTENT!==!1,P=N.IN_PLACE||!1,m=N.ALLOWED_URI_REGEXP||m,Ve=N.NAMESPACE||xe,B=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&Pn(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(B.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&Pn(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(B.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(B.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(de=!1),He&&(ye=!0),k&&(E=Ke({},Br(ER)),O=[],k.html===!0&&(Ke(E,RR),Ke(O,TR)),k.svg===!0&&(Ke(E,sm),Ke(O,um),Ke(O,Kc)),k.svgFilters===!0&&(Ke(E,am),Ke(O,um),Ke(O,Kc)),k.mathMl===!0&&(Ke(E,lm),Ke(O,_R),Ke(O,Kc))),N.ADD_TAGS&&(E===M&&(E=fs(E)),Ke(E,N.ADD_TAGS,Vt)),N.ADD_ATTR&&(O===Y&&(O=fs(O)),Ke(O,N.ADD_ATTR,Vt)),N.ADD_URI_SAFE_ATTR&&Ke(U,N.ADD_URI_SAFE_ATTR,Vt),N.FORBID_CONTENTS&&(H===D&&(H=fs(H)),Ke(H,N.FORBID_CONTENTS,Vt)),F&&(E["#text"]=!0),z&&Ke(E,["html","head","body"]),E.table&&(Ke(E,["tbody"]),delete q.tbody),Un&&Un(N),dn=N)},yt=Ke({},["mi","mo","mn","ms","mtext"]),Eb=Ke({},["foreignobject","desc","title","annotation-xml"]),BD=Ke({},["title","style","font","a","script"]),Vc=Ke({},sm);Ke(Vc,am),Ke(Vc,HW);var Ng=Ke({},lm);Ke(Ng,DW);var UD=function(N){var te=_(N);(!te||!te.tagName)&&(te={namespaceURI:Ve,tagName:"template"});var ue=gd(N.tagName),ut=gd(te.tagName);return Ze[N.namespaceURI]?N.namespaceURI===be?te.namespaceURI===xe?ue==="svg":te.namespaceURI===fe?ue==="svg"&&(ut==="annotation-xml"||yt[ut]):!!Vc[ue]:N.namespaceURI===fe?te.namespaceURI===xe?ue==="math":te.namespaceURI===be?ue==="math"&&Eb[ut]:!!Ng[ue]:N.namespaceURI===xe?te.namespaceURI===be&&!Eb[ut]||te.namespaceURI===fe&&!yt[ut]?!1:!Ng[ue]&&(BD[ue]||!Vc[ue]):!!(_t==="application/xhtml+xml"&&Ze[N.namespaceURI]):!1},Di=function(N){$l(e.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=x}catch{N.remove()}}},Lg=function(N,te){try{$l(e.removed,{attribute:te.getAttributeNode(N),from:te})}catch{$l(e.removed,{attribute:null,from:te})}if(te.removeAttribute(N),N==="is"&&!O[N])if(ye||He)try{Di(te)}catch{}else try{te.setAttribute(N,"")}catch{}},Tb=function(N){var te,ue;if(ke)N="<remove></remove>"+N;else{var ut=OW(N,/^[\r\n\t ]+/);ue=ut&&ut[0]}_t==="application/xhtml+xml"&&Ve===xe&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var zn=L?L.createHTML(N):N;if(Ve===xe)try{te=new f().parseFromString(zn,_t)}catch{}if(!te||!te.documentElement){te=G.createDocument(Ve,"template",null);try{te.documentElement.innerHTML=St?x:zn}catch{}}var Cn=te.body||te.documentElement;return N&&ue&&Cn.insertBefore(r.createTextNode(ue),Cn.childNodes[0]||null),Ve===xe?X.call(te,z?"html":"body")[0]:z?te.documentElement:Cn},_b=function(N){return ne.call(N.ownerDocument||N,N,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},YD=function(N){return N instanceof d&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},Ll=function(N){return Vo(s)==="object"?N instanceof s:N&&Vo(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},Ni=function(N,te,ue){se[N]&&AW(se[N],function(ut){ut.call(e,te,ue,dn)})},Mb=function(N){var te;if(Ni("beforeSanitizeElements",N,null),YD(N)||xn(/[\u0080-\uFFFF]/,N.nodeName))return Di(N),!0;var ue=Vt(N.nodeName);if(Ni("uponSanitizeElement",N,{tagName:ue,allowedTags:E}),N.hasChildNodes()&&!Ll(N.firstElementChild)&&(!Ll(N.content)||!Ll(N.content.firstElementChild))&&xn(/<[/\w]/g,N.innerHTML)&&xn(/<[/\w]/g,N.textContent)||ue==="select"&&xn(/<template/i,N.innerHTML))return Di(N),!0;if(!E[ue]||q[ue]){if(!q[ue]&&Ob(ue)&&(B.tagNameCheck instanceof RegExp&&xn(B.tagNameCheck,ue)||B.tagNameCheck instanceof Function&&B.tagNameCheck(ue)))return!1;if(F&&!H[ue]){var ut=_(N)||N.parentNode,zn=b(N)||N.childNodes;if(zn&&ut)for(var Cn=zn.length,fn=Cn-1;fn>=0;--fn)ut.insertBefore(v(zn[fn],!0),y(N))}return Di(N),!0}return N instanceof a&&!UD(N)||(ue==="noscript"||ue==="noembed"||ue==="noframes")&&xn(/<\/no(script|embed|frames)/i,N.innerHTML)?(Di(N),!0):(Oe&&N.nodeType===3&&(te=N.textContent,te=xr(te,ve," "),te=xr(te,Pe," "),te=xr(te,tt," "),N.textContent!==te&&($l(e.removed,{element:N.cloneNode()}),N.textContent=te)),Ni("afterSanitizeElements",N,null),!1)},Ab=function(N,te,ue){if(C&&(te==="id"||te==="name")&&(ue in r||ue in hs))return!1;if(!(de&&!Q[te]&&xn(Ne,te))){if(!(K&&xn(R,te))){if(!O[te]||Q[te]){if(!(Ob(N)&&(B.tagNameCheck instanceof RegExp&&xn(B.tagNameCheck,N)||B.tagNameCheck instanceof Function&&B.tagNameCheck(N))&&(B.attributeNameCheck instanceof RegExp&&xn(B.attributeNameCheck,te)||B.attributeNameCheck instanceof Function&&B.attributeNameCheck(te))||te==="is"&&B.allowCustomizedBuiltInElements&&(B.tagNameCheck instanceof RegExp&&xn(B.tagNameCheck,ue)||B.tagNameCheck instanceof Function&&B.tagNameCheck(ue))))return!1}else if(!U[te]){if(!xn(m,xr(ue,g,""))){if(!((te==="src"||te==="xlink:href"||te==="href")&&N!=="script"&&IW(ue,"data:")===0&&V[N])){if(!(Ae&&!xn(h,xr(ue,g,"")))){if(ue)return!1}}}}}}return!0},Ob=function(N){return N.indexOf("-")>0},Ib=function(N){var te,ue,ut,zn;Ni("beforeSanitizeAttributes",N,null);var Cn=N.attributes;if(Cn){var fn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:O};for(zn=Cn.length;zn--;){te=Cn[zn];var Bc=te,sn=Bc.name,$g=Bc.namespaceURI;if(ue=sn==="value"?te.value:PW(te.value),ut=Vt(sn),fn.attrName=ut,fn.attrValue=ue,fn.keepAttr=!0,fn.forceKeepAttr=void 0,Ni("uponSanitizeAttribute",N,fn),ue=fn.attrValue,!fn.forceKeepAttr&&(Lg(sn,N),!!fn.keepAttr)){if(!Ee&&xn(/\/>/i,ue)){Lg(sn,N);continue}Oe&&(ue=xr(ue,ve," "),ue=xr(ue,Pe," "),ue=xr(ue,tt," "));var Pb=Vt(N.nodeName);if(Ab(Pb,ut,ue)){if(S&&(ut==="id"||ut==="name")&&(Lg(sn,N),ue=A+ue),L&&Vo(p)==="object"&&typeof p.getAttributeType=="function"&&!$g)switch(p.getAttributeType(Pb,ut)){case"TrustedHTML":{ue=L.createHTML(ue);break}case"TrustedScriptURL":{ue=L.createScriptURL(ue);break}}try{$g?N.setAttributeNS($g,sn,ue):N.setAttribute(sn,ue),bR(e.removed)}catch{}}}}Ni("afterSanitizeAttributes",N,null)}},GD=function Te(N){var te,ue=_b(N);for(Ni("beforeSanitizeShadowDOM",N,null);te=ue.nextNode();)Ni("uponSanitizeShadowNode",te,null),!Mb(te)&&(te.content instanceof i&&Te(te.content),Ib(te));Ni("afterSanitizeShadowDOM",N,null)};return e.sanitize=function(Te){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},te,ue,ut,zn,Cn;if(St=!Te,St&&(Te="<!-->"),typeof Te!="string"&&!Ll(Te))if(typeof Te.toString=="function"){if(Te=Te.toString(),typeof Te!="string")throw om("dirty is not a string, aborting")}else throw om("toString is not a function");if(!e.isSupported){if(Vo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Te=="string")return t.toStaticHTML(Te);if(Ll(Te))return t.toStaticHTML(Te.outerHTML)}return Te}if(je||tn(N),e.removed=[],typeof Te=="string"&&(P=!1),P){if(Te.nodeName){var fn=Vt(Te.nodeName);if(!E[fn]||q[fn])throw om("root node is forbidden and cannot be sanitized in-place")}}else if(Te instanceof s)te=Tb("<!---->"),ue=te.ownerDocument.importNode(Te,!0),ue.nodeType===1&&ue.nodeName==="BODY"||ue.nodeName==="HTML"?te=ue:te.appendChild(ue);else{if(!ye&&!Oe&&!z&&Te.indexOf("<")===-1)return L&&Re?L.createHTML(Te):Te;if(te=Tb(Te),!te)return ye?null:Re?x:""}te&&ke&&Di(te.firstChild);for(var Bc=_b(P?Te:te);ut=Bc.nextNode();)ut.nodeType===3&&ut===zn||Mb(ut)||(ut.content instanceof i&&GD(ut.content),Ib(ut),zn=ut);if(zn=null,P)return Te;if(ye){if(He)for(Cn=j.call(te.ownerDocument);te.firstChild;)Cn.appendChild(te.firstChild);else Cn=te;return(O.shadowroot||O.shadowrootmod)&&(Cn=ie.call(n,Cn,!0)),Cn}var sn=z?te.outerHTML:te.innerHTML;return z&&E["!doctype"]&&te.ownerDocument&&te.ownerDocument.doctype&&te.ownerDocument.doctype.name&&xn(UW,te.ownerDocument.doctype.name)&&(sn="<!DOCTYPE "+te.ownerDocument.doctype.name+`>
`+sn),Oe&&(sn=xr(sn,ve," "),sn=xr(sn,Pe," "),sn=xr(sn,tt," ")),L&&Re?L.createHTML(sn):sn},e.setConfig=function(Te){tn(Te),je=!0},e.clearConfig=function(){dn=null,je=!1},e.isValidAttribute=function(Te,N,te){dn||tn({});var ue=Vt(Te),ut=Vt(N);return Ab(ue,ut,te)},e.addHook=function(Te,N){typeof N=="function"&&(se[Te]=se[Te]||[],$l(se[Te],N))},e.removeHook=function(Te){if(se[Te])return bR(se[Te])},e.removeHooks=function(Te){se[Te]&&(se[Te]=[])},e.removeAllHooks=function(){se={}},e}var zW=CO();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var vO;function Z(){return vO.apply(null,arguments)}function jW(t){vO=t}function Qr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Zs(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function at(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function tv(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(at(t,e))return!1;return!0}function Qn(t){return t===void 0}function go(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function yc(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function SO(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function zo(t,e){for(var n in e)at(e,n)&&(t[n]=e[n]);return at(e,"toString")&&(t.toString=e.toString),at(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Pi(t,e,n,r){return YO(t,e,n,r,!0).utc()}function KW(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ge(t){return t._pf==null&&(t._pf=KW()),t._pf}var Dw;Array.prototype.some?Dw=Array.prototype.some:Dw=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function nv(t){if(t._isValid==null){var e=Ge(t),n=Dw.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function Vf(t){var e=Pi(NaN);return t!=null?zo(Ge(e),t):Ge(e).userInvalidated=!0,e}var MR=Z.momentProperties=[],cm=!1;function rv(t,e){var n,r,i,o=MR.length;if(Qn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Qn(e._i)||(t._i=e._i),Qn(e._f)||(t._f=e._f),Qn(e._l)||(t._l=e._l),Qn(e._strict)||(t._strict=e._strict),Qn(e._tzm)||(t._tzm=e._tzm),Qn(e._isUTC)||(t._isUTC=e._isUTC),Qn(e._offset)||(t._offset=e._offset),Qn(e._pf)||(t._pf=Ge(e)),Qn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=MR[n],i=e[r],Qn(i)||(t[r]=i);return t}function bc(t){rv(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),cm===!1&&(cm=!0,Z.updateOffset(this),cm=!1)}function Jr(t){return t instanceof bc||t!=null&&t._isAMomentObject!=null}function yO(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Or(t,e){var n=!0;return zo(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])at(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}yO(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var AR={};function bO(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),AR[t]||(yO(e),AR[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function xi(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function XW(t){var e,n;for(n in t)at(t,n)&&(e=t[n],xi(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Nw(t,e){var n=zo({},t),r;for(r in e)at(e,r)&&(Zs(t[r])&&Zs(e[r])?(n[r]={},zo(n[r],t[r]),zo(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)at(t,r)&&!at(e,r)&&Zs(t[r])&&(n[r]=zo({},n[r]));return n}function iv(t){t!=null&&this.set(t)}var Lw;Object.keys?Lw=Object.keys:Lw=function(t){var e,n=[];for(e in t)at(t,e)&&n.push(e);return n};var qW={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function ZW(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return xi(r)?r.call(e,n):r}function Ai(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var ov=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Xc=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,hm={},dl={};function Me(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(dl[t]=i),e&&(dl[e[0]]=function(){return Ai(i.apply(this,arguments),e[1],e[2])}),n&&(dl[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function QW(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function JW(t){var e=t.match(ov),n,r;for(n=0,r=e.length;n<r;n++)dl[e[n]]?e[n]=dl[e[n]]:e[n]=QW(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=xi(e[s])?e[s].call(i,t):e[s];return o}}function md(t,e){return t.isValid()?(e=RO(e,t.localeData()),hm[e]=hm[e]||JW(e),hm[e](t)):t.localeData().invalidDate()}function RO(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Xc.lastIndex=0;n>=0&&Xc.test(t);)t=t.replace(Xc,r),Xc.lastIndex=0,n-=1;return t}var eV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function tV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(ov).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var nV="Invalid date";function rV(){return this._invalidDate}var iV="%d",oV=/\d{1,2}/;function sV(t){return this._ordinal.replace("%d",t)}var aV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function lV(t,e,n,r){var i=this._relativeTime[n];return xi(i)?i(t,e,n,r):i.replace(/%d/i,t)}function uV(t,e){var n=this._relativeTime[t>0?"future":"past"];return xi(n)?n(e):n.replace(/%s/i,e)}var Pu={};function On(t,e){var n=t.toLowerCase();Pu[n]=Pu[n+"s"]=Pu[e]=t}function Ir(t){return typeof t=="string"?Pu[t]||Pu[t.toLowerCase()]:void 0}function sv(t){var e={},n,r;for(r in t)at(t,r)&&(n=Ir(r),n&&(e[n]=t[r]));return e}var EO={};function In(t,e){EO[t]=e}function cV(t){var e=[],n;for(n in t)at(t,n)&&e.push({unit:n,priority:EO[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function Bf(t){return t%4===0&&t%100!==0||t%400===0}function Tr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function et(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Tr(e)),n}function Tl(t,e){return function(n){return n!=null?(TO(this,t,n),Z.updateOffset(this,e),this):Ud(this,t)}}function Ud(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function TO(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&Bf(t.year())&&t.month()===1&&t.date()===29?(n=et(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Kf(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function hV(t){return t=Ir(t),xi(this[t])?this[t]():this}function dV(t,e){if(typeof t=="object"){t=sv(t);var n=cV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Ir(t),xi(this[t]))return this[t](e);return this}var _O=/\d/,mr=/\d\d/,MO=/\d{3}/,av=/\d{4}/,Uf=/[+-]?\d{6}/,Tt=/\d\d?/,AO=/\d\d\d\d?/,OO=/\d\d\d\d\d\d?/,Yf=/\d{1,3}/,lv=/\d{1,4}/,Gf=/[+-]?\d{1,6}/,_l=/\d+/,zf=/[+-]?\d+/,fV=/Z|[+-]\d\d:?\d\d/gi,jf=/Z|[+-]\d\d(?::?\d\d)?/gi,gV=/[+-]?\d+(\.\d{1,3})?/,Rc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Yd;Yd={};function me(t,e,n){Yd[t]=xi(e)?e:function(r,i){return r&&n?n:e}}function mV(t,e){return at(Yd,t)?Yd[t](e._strict,e._locale):new RegExp(pV(t))}function pV(t){return hr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function hr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var $w={};function gt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),go(e)&&(r=function(o,s){s[e]=et(o)}),i=t.length,n=0;n<i;n++)$w[t[n]]=r}function Ec(t,e){gt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function wV(t,e,n){e!=null&&at($w,t)&&$w[t](e,n._a,n,t)}var Tn=0,ro=1,bi=2,rn=3,Kr=4,io=5,Gs=6,CV=7,vV=8;function SV(t,e){return(t%e+e)%e}var zt;Array.prototype.indexOf?zt=Array.prototype.indexOf:zt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Kf(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=SV(e,12);return t+=(e-n)/12,n===1?Bf(t)?29:28:31-n%7%2}Me("M",["MM",2],"Mo",function(){return this.month()+1});Me("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Me("MMMM",0,0,function(t){return this.localeData().months(this,t)});On("month","M");In("month",8);me("M",Tt);me("MM",Tt,mr);me("MMM",function(t,e){return e.monthsShortRegex(t)});me("MMMM",function(t,e){return e.monthsRegex(t)});gt(["M","MM"],function(t,e){e[ro]=et(t)-1});gt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ro]=i:Ge(n).invalidMonth=t});var yV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),IO="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),PO=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,bV=Rc,RV=Rc;function EV(t,e){return t?Qr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||PO).test(e)?"format":"standalone"][t.month()]:Qr(this._months)?this._months:this._months.standalone}function TV(t,e){return t?Qr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[PO.test(e)?"format":"standalone"][t.month()]:Qr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function _V(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Pi([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=zt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:(i=zt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=zt.call(this._longMonthsParse,s),i!==-1?i:(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null))}function MV(t,e,n){var r,i,o;if(this._monthsParseExact)return _V.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Pi([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function xO(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=et(e);else if(e=t.localeData().monthsParse(e),!go(e))return t}return n=Math.min(t.date(),Kf(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function HO(t){return t!=null?(xO(this,t),Z.updateOffset(this,!0),this):Ud(this,"Month")}function AV(){return Kf(this.year(),this.month())}function OV(t){return this._monthsParseExact?(at(this,"_monthsRegex")||DO.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(at(this,"_monthsShortRegex")||(this._monthsShortRegex=bV),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function IV(t){return this._monthsParseExact?(at(this,"_monthsRegex")||DO.call(this),t?this._monthsStrictRegex:this._monthsRegex):(at(this,"_monthsRegex")||(this._monthsRegex=RV),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function DO(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=Pi([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=hr(e[i]),n[i]=hr(n[i]);for(i=0;i<24;i++)r[i]=hr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Me("Y",0,0,function(){var t=this.year();return t<=9999?Ai(t,4):"+"+t});Me(0,["YY",2],0,function(){return this.year()%100});Me(0,["YYYY",4],0,"year");Me(0,["YYYYY",5],0,"year");Me(0,["YYYYYY",6,!0],0,"year");On("year","y");In("year",1);me("Y",zf);me("YY",Tt,mr);me("YYYY",lv,av);me("YYYYY",Gf,Uf);me("YYYYYY",Gf,Uf);gt(["YYYYY","YYYYYY"],Tn);gt("YYYY",function(t,e){e[Tn]=t.length===2?Z.parseTwoDigitYear(t):et(t)});gt("YY",function(t,e){e[Tn]=Z.parseTwoDigitYear(t)});gt("Y",function(t,e){e[Tn]=parseInt(t,10)});function xu(t){return Bf(t)?366:365}Z.parseTwoDigitYear=function(t){return et(t)+(et(t)>68?1900:2e3)};var NO=Tl("FullYear",!0);function PV(){return Bf(this.year())}function xV(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function ec(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Gd(t,e,n){var r=7+e-n,i=(7+ec(t,0,r).getUTCDay()-e)%7;return-i+r-1}function LO(t,e,n,r,i){var o=(7+n-r)%7,s=Gd(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=xu(l)+a):a>xu(t)?(l=t+1,u=a-xu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function tc(t,e,n){var r=Gd(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+fo(s,e,n)):i>fo(t.year(),e,n)?(o=i-fo(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function fo(t,e,n){var r=Gd(t,e,n),i=Gd(t+1,e,n);return(xu(t)-r+i)/7}Me("w",["ww",2],"wo","week");Me("W",["WW",2],"Wo","isoWeek");On("week","w");On("isoWeek","W");In("week",5);In("isoWeek",5);me("w",Tt);me("ww",Tt,mr);me("W",Tt);me("WW",Tt,mr);Ec(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=et(t)});function HV(t){return tc(t,this._week.dow,this._week.doy).week}var DV={dow:0,doy:6};function NV(){return this._week.dow}function LV(){return this._week.doy}function $V(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function kV(t){var e=tc(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Me("d",0,"do","day");Me("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Me("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Me("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Me("e",0,0,"weekday");Me("E",0,0,"isoWeekday");On("day","d");On("weekday","e");On("isoWeekday","E");In("day",11);In("weekday",11);In("isoWeekday",11);me("d",Tt);me("e",Tt);me("E",Tt);me("dd",function(t,e){return e.weekdaysMinRegex(t)});me("ddd",function(t,e){return e.weekdaysShortRegex(t)});me("dddd",function(t,e){return e.weekdaysRegex(t)});Ec(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ge(n).invalidWeekday=t});Ec(["d","e","E"],function(t,e,n,r){e[r]=et(t)});function FV(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function WV(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function uv(t,e){return t.slice(e,7).concat(t.slice(0,e))}var VV="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),$O="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),BV="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),UV=Rc,YV=Rc,GV=Rc;function zV(t,e){var n=Qr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?uv(n,this._week.dow):t?n[t.day()]:n}function jV(t){return t===!0?uv(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function KV(t){return t===!0?uv(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function XV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Pi([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1||(i=zt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=zt.call(this._minWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function qV(t,e,n){var r,i,o;if(this._weekdaysParseExact)return XV.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Pi([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function ZV(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=FV(t,this.localeData()),this.add(t-e,"d")):e}function QV(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function JV(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=WV(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function eB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||cv.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(at(this,"_weekdaysRegex")||(this._weekdaysRegex=UV),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function tB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||cv.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(at(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=YV),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function nB(t){return this._weekdaysParseExact?(at(this,"_weekdaysRegex")||cv.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(at(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=GV),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function cv(){function t(c,d){return d.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Pi([2e3,1]).day(o),a=hr(this.weekdaysMin(s,"")),l=hr(this.weekdaysShort(s,"")),u=hr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function hv(){return this.hours()%12||12}function rB(){return this.hours()||24}Me("H",["HH",2],0,"hour");Me("h",["hh",2],0,hv);Me("k",["kk",2],0,rB);Me("hmm",0,0,function(){return""+hv.apply(this)+Ai(this.minutes(),2)});Me("hmmss",0,0,function(){return""+hv.apply(this)+Ai(this.minutes(),2)+Ai(this.seconds(),2)});Me("Hmm",0,0,function(){return""+this.hours()+Ai(this.minutes(),2)});Me("Hmmss",0,0,function(){return""+this.hours()+Ai(this.minutes(),2)+Ai(this.seconds(),2)});function kO(t,e){Me(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}kO("a",!0);kO("A",!1);On("hour","h");In("hour",13);function FO(t,e){return e._meridiemParse}me("a",FO);me("A",FO);me("H",Tt);me("h",Tt);me("k",Tt);me("HH",Tt,mr);me("hh",Tt,mr);me("kk",Tt,mr);me("hmm",AO);me("hmmss",OO);me("Hmm",AO);me("Hmmss",OO);gt(["H","HH"],rn);gt(["k","kk"],function(t,e,n){var r=et(t);e[rn]=r===24?0:r});gt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});gt(["h","hh"],function(t,e,n){e[rn]=et(t),Ge(n).bigHour=!0});gt("hmm",function(t,e,n){var r=t.length-2;e[rn]=et(t.substr(0,r)),e[Kr]=et(t.substr(r)),Ge(n).bigHour=!0});gt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[rn]=et(t.substr(0,r)),e[Kr]=et(t.substr(r,2)),e[io]=et(t.substr(i)),Ge(n).bigHour=!0});gt("Hmm",function(t,e,n){var r=t.length-2;e[rn]=et(t.substr(0,r)),e[Kr]=et(t.substr(r))});gt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[rn]=et(t.substr(0,r)),e[Kr]=et(t.substr(r,2)),e[io]=et(t.substr(i))});function iB(t){return(t+"").toLowerCase().charAt(0)==="p"}var oB=/[ap]\.?m?\.?/i,sB=Tl("Hours",!0);function aB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var WO={calendar:qW,longDateFormat:eV,invalidDate:nV,ordinal:iV,dayOfMonthOrdinalParse:oV,relativeTime:aV,months:yV,monthsShort:IO,week:DV,weekdays:VV,weekdaysMin:BV,weekdaysShort:$O,meridiemParse:oB},Ot={},kl={},nc;function lB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function OR(t){return t&&t.toLowerCase().replace("_","-")}function uB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=OR(t[e]).split("-"),n=o.length,r=OR(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Xf(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&lB(o,r)>=n-1)break;n--}e++}return nc}function cB(t){return t.match("^[^/\\\\]*$")!=null}function Xf(t){var e=null,n;if(Ot[t]===void 0&&typeof $d<"u"&&$d&&$d.exports&&cB(t))try{e=nc._abbr,n=require,n("./locale/"+t),Zo(e)}catch{Ot[t]=null}return Ot[t]}function Zo(t,e){var n;return t&&(Qn(e)?n=vo(t):n=dv(t,e),n?nc=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),nc._abbr}function dv(t,e){if(e!==null){var n,r=WO;if(e.abbr=t,Ot[t]!=null)bO("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Ot[t]._config;else if(e.parentLocale!=null)if(Ot[e.parentLocale]!=null)r=Ot[e.parentLocale]._config;else if(n=Xf(e.parentLocale),n!=null)r=n._config;else return kl[e.parentLocale]||(kl[e.parentLocale]=[]),kl[e.parentLocale].push({name:t,config:e}),null;return Ot[t]=new iv(Nw(r,e)),kl[t]&&kl[t].forEach(function(i){dv(i.name,i.config)}),Zo(t),Ot[t]}else return delete Ot[t],null}function hB(t,e){if(e!=null){var n,r,i=WO;Ot[t]!=null&&Ot[t].parentLocale!=null?Ot[t].set(Nw(Ot[t]._config,e)):(r=Xf(t),r!=null&&(i=r._config),e=Nw(i,e),r==null&&(e.abbr=t),n=new iv(e),n.parentLocale=Ot[t],Ot[t]=n),Zo(t)}else Ot[t]!=null&&(Ot[t].parentLocale!=null?(Ot[t]=Ot[t].parentLocale,t===Zo()&&Zo(t)):Ot[t]!=null&&delete Ot[t]);return Ot[t]}function vo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return nc;if(!Qr(t)){if(e=Xf(t),e)return e;t=[t]}return uB(t)}function dB(){return Lw(Ot)}function fv(t){var e,n=t._a;return n&&Ge(t).overflow===-2&&(e=n[ro]<0||n[ro]>11?ro:n[bi]<1||n[bi]>Kf(n[Tn],n[ro])?bi:n[rn]<0||n[rn]>24||n[rn]===24&&(n[Kr]!==0||n[io]!==0||n[Gs]!==0)?rn:n[Kr]<0||n[Kr]>59?Kr:n[io]<0||n[io]>59?io:n[Gs]<0||n[Gs]>999?Gs:-1,Ge(t)._overflowDayOfYear&&(e<Tn||e>bi)&&(e=bi),Ge(t)._overflowWeeks&&e===-1&&(e=CV),Ge(t)._overflowWeekday&&e===-1&&(e=vV),Ge(t).overflow=e),t}var fB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mB=/Z|[+-]\d\d(?::?\d\d)?/,qc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],dm=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pB=/^\/?Date\((-?\d+)/i,wB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,CB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function VO(t){var e,n,r=t._i,i=fB.exec(r)||gB.exec(r),o,s,a,l,u=qc.length,c=dm.length;if(i){for(Ge(t).iso=!0,e=0,n=u;e<n;e++)if(qc[e][1].exec(i[1])){s=qc[e][0],o=qc[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(dm[e][1].exec(i[3])){a=(i[2]||" ")+dm[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(mB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),mv(t)}else t._isValid=!1}function vB(t,e,n,r,i,o){var s=[SB(t),IO.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function SB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function yB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function bB(t,e,n){if(t){var r=$O.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ge(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function RB(t,e,n){if(t)return CB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function BO(t){var e=wB.exec(yB(t._i)),n;if(e){if(n=vB(e[4],e[3],e[2],e[5],e[6],e[7]),!bB(e[1],n,t))return;t._a=n,t._tzm=RB(e[8],e[9],e[10]),t._d=ec.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ge(t).rfc2822=!0}else t._isValid=!1}function EB(t){var e=pB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(VO(t),t._isValid===!1)delete t._isValid;else return;if(BO(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=Or("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function nl(t,e,n){return t??e??n}function TB(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function gv(t){var e,n,r=[],i,o,s;if(!t._d){for(i=TB(t),t._w&&t._a[bi]==null&&t._a[ro]==null&&_B(t),t._dayOfYear!=null&&(s=nl(t._a[Tn],i[Tn]),(t._dayOfYear>xu(s)||t._dayOfYear===0)&&(Ge(t)._overflowDayOfYear=!0),n=ec(s,0,t._dayOfYear),t._a[ro]=n.getUTCMonth(),t._a[bi]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[rn]===24&&t._a[Kr]===0&&t._a[io]===0&&t._a[Gs]===0&&(t._nextDay=!0,t._a[rn]=0),t._d=(t._useUTC?ec:xV).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[rn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ge(t).weekdayMismatch=!0)}}function _B(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=nl(e.GG,t._a[Tn],tc(Et(),1,4).year),r=nl(e.W,1),i=nl(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=tc(Et(),o,s),n=nl(e.gg,t._a[Tn],u.year),r=nl(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>fo(n,o,s)?Ge(t)._overflowWeeks=!0:l!=null?Ge(t)._overflowWeekday=!0:(a=LO(n,r,i,o,s),t._a[Tn]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function mv(t){if(t._f===Z.ISO_8601){VO(t);return}if(t._f===Z.RFC_2822){BO(t);return}t._a=[],Ge(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=RO(t._f,t._locale).match(ov)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(mV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ge(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),dl[o]?(r?Ge(t).empty=!1:Ge(t).unusedTokens.push(o),wV(o,r,t)):t._strict&&!r&&Ge(t).unusedTokens.push(o);Ge(t).charsLeftOver=a-l,e.length>0&&Ge(t).unusedInput.push(e),t._a[rn]<=12&&Ge(t).bigHour===!0&&t._a[rn]>0&&(Ge(t).bigHour=void 0),Ge(t).parsedDateParts=t._a.slice(0),Ge(t).meridiem=t._meridiem,t._a[rn]=MB(t._locale,t._a[rn],t._meridiem),u=Ge(t).era,u!==null&&(t._a[Tn]=t._locale.erasConvertYear(u,t._a[Tn])),gv(t),fv(t)}function MB(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function AB(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ge(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=rv({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],mv(e),nv(e)&&(s=!0),o+=Ge(e).charsLeftOver,o+=Ge(e).unusedTokens.length*10,Ge(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));zo(t,n||e)}function OB(t){if(!t._d){var e=sv(t._i),n=e.day===void 0?e.date:e.day;t._a=SO([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),gv(t)}}function IB(t){var e=new bc(fv(UO(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function UO(t){var e=t._i,n=t._f;return t._locale=t._locale||vo(t._l),e===null||n===void 0&&e===""?Vf({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Jr(e)?new bc(fv(e)):(yc(e)?t._d=e:Qr(n)?AB(t):n?mv(t):PB(t),nv(t)||(t._d=null),t))}function PB(t){var e=t._i;Qn(e)?t._d=new Date(Z.now()):yc(e)?t._d=new Date(e.valueOf()):typeof e=="string"?EB(t):Qr(e)?(t._a=SO(e.slice(0),function(n){return parseInt(n,10)}),gv(t)):Zs(e)?OB(t):go(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function YO(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Zs(t)&&tv(t)||Qr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,IB(o)}function Et(t,e,n,r){return YO(t,e,n,r,!1)}var xB=Or("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Vf()}),HB=Or("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Vf()});function GO(t,e){var n,r;if(e.length===1&&Qr(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function DB(){var t=[].slice.call(arguments,0);return GO("isBefore",t)}function NB(){var t=[].slice.call(arguments,0);return GO("isAfter",t)}var LB=function(){return Date.now?Date.now():+new Date},Fl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function $B(t){var e,n=!1,r,i=Fl.length;for(e in t)if(at(t,e)&&!(zt.call(Fl,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Fl[r]]){if(n)return!1;parseFloat(t[Fl[r]])!==et(t[Fl[r]])&&(n=!0)}return!0}function kB(){return this._isValid}function FB(){return ti(NaN)}function qf(t){var e=sv(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=$B(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=vo(),this._bubble()}function pd(t){return t instanceof qf}function kw(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function WB(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&et(t[s])!==et(e[s]))&&o++;return o+i}function zO(t,e){Me(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Ai(~~(n/60),2)+e+Ai(~~n%60,2)})}zO("Z",":");zO("ZZ","");me("Z",jf);me("ZZ",jf);gt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=pv(jf,t)});var VB=/([\+\-]|\d\d)/gi;function pv(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(VB)||["-",0,0],o=+(i[1]*60)+et(i[2]),o===0?0:i[0]==="+"?o:-o)}function wv(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Jr(t)||yc(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Z.updateOffset(n,!1),n):Et(t).local()}function Fw(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function BB(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=pv(jf,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=Fw(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?XO(this,ti(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:Fw(this)}function UB(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function YB(t){return this.utcOffset(0,t)}function GB(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Fw(this),"m")),this}function zB(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=pv(fV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function jB(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function KB(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function XB(){if(!Qn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return rv(t,this),t=UO(t),t._a?(e=t._isUTC?Pi(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&WB(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function qB(){return this.isValid()?!this._isUTC:!1}function ZB(){return this.isValid()?this._isUTC:!1}function jO(){return this.isValid()?this._isUTC&&this._offset===0:!1}var QB=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,JB=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ti(t,e){var n=t,r=null,i,o,s;return pd(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:go(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=QB.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:et(r[bi])*i,h:et(r[rn])*i,m:et(r[Kr])*i,s:et(r[io])*i,ms:et(kw(r[Gs]*1e3))*i}):(r=JB.exec(t))?(i=r[1]==="-"?-1:1,n={y:gs(r[2],i),M:gs(r[3],i),w:gs(r[4],i),d:gs(r[5],i),h:gs(r[6],i),m:gs(r[7],i),s:gs(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=e2(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new qf(n),pd(t)&&at(t,"_locale")&&(o._locale=t._locale),pd(t)&&at(t,"_isValid")&&(o._isValid=t._isValid),o}ti.fn=qf.prototype;ti.invalid=FB;function gs(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function IR(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function e2(t,e){var n;return t.isValid()&&e.isValid()?(e=wv(e,t),t.isBefore(e)?n=IR(t,e):(n=IR(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function KO(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(bO(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ti(n,r),XO(this,i,t),this}}function XO(t,e,n,r){var i=e._milliseconds,o=kw(e._days),s=kw(e._months);t.isValid()&&(r=r??!0,s&&xO(t,Ud(t,"Month")+s*n),o&&TO(t,"Date",Ud(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Z.updateOffset(t,o||s))}var t2=KO(1,"add"),n2=KO(-1,"subtract");function qO(t){return typeof t=="string"||t instanceof String}function r2(t){return Jr(t)||yc(t)||qO(t)||go(t)||o2(t)||i2(t)||t===null||t===void 0}function i2(t){var e=Zs(t)&&!tv(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||at(t,o);return e&&n}function o2(t){var e=Qr(t),n=!1;return e&&(n=t.filter(function(r){return!go(r)&&qO(t)}).length===0),e&&n}function s2(t){var e=Zs(t)&&!tv(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||at(t,o);return e&&n}function a2(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function l2(t,e){arguments.length===1&&(arguments[0]?r2(arguments[0])?(t=arguments[0],e=void 0):s2(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=wv(n,this).startOf("day"),i=Z.calendarFormat(this,r)||"sameElse",o=e&&(xi(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function u2(){return new bc(this)}function c2(t,e){var n=Jr(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function h2(t,e){var n=Jr(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function d2(t,e,n,r){var i=Jr(t)?t:Et(t),o=Jr(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function f2(t,e){var n=Jr(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=Ir(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function g2(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function m2(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function p2(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=wv(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Ir(e),e){case"year":o=wd(this,r)/12;break;case"month":o=wd(this,r);break;case"quarter":o=wd(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Tr(o)}function wd(t,e){if(t.date()<e.date())return-wd(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function w2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function C2(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?md(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):xi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",md(n,"Z")):md(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function v2(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function S2(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=md(this,t);return this.localeData().postformat(e)}function y2(t,e){return this.isValid()&&(Jr(t)&&t.isValid()||Et(t).isValid())?ti({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function b2(t){return this.from(Et(),t)}function R2(t,e){return this.isValid()&&(Jr(t)&&t.isValid()||Et(t).isValid())?ti({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function E2(t){return this.to(Et(),t)}function ZO(t){var e;return t===void 0?this._locale._abbr:(e=vo(t),e!=null&&(this._locale=e),this)}var QO=Or("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function JO(){return this._locale}var zd=1e3,fl=60*zd,jd=60*fl,eI=(365*400+97)*24*jd;function gl(t,e){return(t%e+e)%e}function tI(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-eI:new Date(t,e,n).valueOf()}function nI(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-eI:Date.UTC(t,e,n)}function T2(t){var e,n;if(t=Ir(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?nI:tI,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=gl(e+(this._isUTC?0:this.utcOffset()*fl),jd);break;case"minute":e=this._d.valueOf(),e-=gl(e,fl);break;case"second":e=this._d.valueOf(),e-=gl(e,zd);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function _2(t){var e,n;if(t=Ir(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?nI:tI,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=jd-gl(e+(this._isUTC?0:this.utcOffset()*fl),jd)-1;break;case"minute":e=this._d.valueOf(),e+=fl-gl(e,fl)-1;break;case"second":e=this._d.valueOf(),e+=zd-gl(e,zd)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function M2(){return this._d.valueOf()-(this._offset||0)*6e4}function A2(){return Math.floor(this.valueOf()/1e3)}function O2(){return new Date(this.valueOf())}function I2(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function P2(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function x2(){return this.isValid()?this.toISOString():null}function H2(){return nv(this)}function D2(){return zo({},Ge(this))}function N2(){return Ge(this).overflow}function L2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Me("N",0,0,"eraAbbr");Me("NN",0,0,"eraAbbr");Me("NNN",0,0,"eraAbbr");Me("NNNN",0,0,"eraName");Me("NNNNN",0,0,"eraNarrow");Me("y",["y",1],"yo","eraYear");Me("y",["yy",2],0,"eraYear");Me("y",["yyy",3],0,"eraYear");Me("y",["yyyy",4],0,"eraYear");me("N",Cv);me("NN",Cv);me("NNN",Cv);me("NNNN",j2);me("NNNNN",K2);gt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ge(n).era=i:Ge(n).invalidEra=t});me("y",_l);me("yy",_l);me("yyy",_l);me("yyyy",_l);me("yo",X2);gt(["y","yy","yyy","yyyy"],Tn);gt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Tn]=n._locale.eraYearOrdinalParse(t,i):e[Tn]=parseInt(t,10)});function $2(t,e){var n,r,i,o=this._eras||vo("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Z(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Z(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function k2(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function F2(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function W2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function V2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function B2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function U2(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Z(i[t].since).year())*n+i[t].offset;return this.year()}function Y2(t){return at(this,"_erasNameRegex")||vv.call(this),t?this._erasNameRegex:this._erasRegex}function G2(t){return at(this,"_erasAbbrRegex")||vv.call(this),t?this._erasAbbrRegex:this._erasRegex}function z2(t){return at(this,"_erasNarrowRegex")||vv.call(this),t?this._erasNarrowRegex:this._erasRegex}function Cv(t,e){return e.erasAbbrRegex(t)}function j2(t,e){return e.erasNameRegex(t)}function K2(t,e){return e.erasNarrowRegex(t)}function X2(t,e){return e._eraYearOrdinalRegex||_l}function vv(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(hr(s[i].name)),t.push(hr(s[i].abbr)),n.push(hr(s[i].narrow)),r.push(hr(s[i].name)),r.push(hr(s[i].abbr)),r.push(hr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Me(0,["gg",2],0,function(){return this.weekYear()%100});Me(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Zf(t,e){Me(0,[t,t.length],0,e)}Zf("gggg","weekYear");Zf("ggggg","weekYear");Zf("GGGG","isoWeekYear");Zf("GGGGG","isoWeekYear");On("weekYear","gg");On("isoWeekYear","GG");In("weekYear",1);In("isoWeekYear",1);me("G",zf);me("g",zf);me("GG",Tt,mr);me("gg",Tt,mr);me("GGGG",lv,av);me("gggg",lv,av);me("GGGGG",Gf,Uf);me("ggggg",Gf,Uf);Ec(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=et(t)});Ec(["gg","GG"],function(t,e,n,r){e[r]=Z.parseTwoDigitYear(t)});function q2(t){return rI.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Z2(t){return rI.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Q2(){return fo(this.year(),1,4)}function J2(){return fo(this.isoWeekYear(),1,4)}function eU(){var t=this.localeData()._week;return fo(this.year(),t.dow,t.doy)}function tU(){var t=this.localeData()._week;return fo(this.weekYear(),t.dow,t.doy)}function rI(t,e,n,r,i){var o;return t==null?tc(this,r,i).year:(o=fo(t,r,i),e>o&&(e=o),nU.call(this,t,e,n,r,i))}function nU(t,e,n,r,i){var o=LO(t,e,n,r,i),s=ec(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Me("Q",0,"Qo","quarter");On("quarter","Q");In("quarter",7);me("Q",_O);gt("Q",function(t,e){e[ro]=(et(t)-1)*3});function rU(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Me("D",["DD",2],"Do","date");On("date","D");In("date",9);me("D",Tt);me("DD",Tt,mr);me("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});gt(["D","DD"],bi);gt("Do",function(t,e){e[bi]=et(t.match(Tt)[0])});var iI=Tl("Date",!0);Me("DDD",["DDDD",3],"DDDo","dayOfYear");On("dayOfYear","DDD");In("dayOfYear",4);me("DDD",Yf);me("DDDD",MO);gt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=et(t)});function iU(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Me("m",["mm",2],0,"minute");On("minute","m");In("minute",14);me("m",Tt);me("mm",Tt,mr);gt(["m","mm"],Kr);var oU=Tl("Minutes",!1);Me("s",["ss",2],0,"second");On("second","s");In("second",15);me("s",Tt);me("ss",Tt,mr);gt(["s","ss"],io);var sU=Tl("Seconds",!1);Me("S",0,0,function(){return~~(this.millisecond()/100)});Me(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Me(0,["SSS",3],0,"millisecond");Me(0,["SSSS",4],0,function(){return this.millisecond()*10});Me(0,["SSSSS",5],0,function(){return this.millisecond()*100});Me(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Me(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Me(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Me(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});On("millisecond","ms");In("millisecond",16);me("S",Yf,_O);me("SS",Yf,mr);me("SSS",Yf,MO);var jo,oI;for(jo="SSSS";jo.length<=9;jo+="S")me(jo,_l);function aU(t,e){e[Gs]=et(("0."+t)*1e3)}for(jo="S";jo.length<=9;jo+="S")gt(jo,aU);oI=Tl("Milliseconds",!1);Me("z",0,0,"zoneAbbr");Me("zz",0,0,"zoneName");function lU(){return this._isUTC?"UTC":""}function uU(){return this._isUTC?"Coordinated Universal Time":""}var ee=bc.prototype;ee.add=t2;ee.calendar=l2;ee.clone=u2;ee.diff=p2;ee.endOf=_2;ee.format=S2;ee.from=y2;ee.fromNow=b2;ee.to=R2;ee.toNow=E2;ee.get=hV;ee.invalidAt=N2;ee.isAfter=c2;ee.isBefore=h2;ee.isBetween=d2;ee.isSame=f2;ee.isSameOrAfter=g2;ee.isSameOrBefore=m2;ee.isValid=H2;ee.lang=QO;ee.locale=ZO;ee.localeData=JO;ee.max=HB;ee.min=xB;ee.parsingFlags=D2;ee.set=dV;ee.startOf=T2;ee.subtract=n2;ee.toArray=I2;ee.toObject=P2;ee.toDate=O2;ee.toISOString=C2;ee.inspect=v2;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=x2;ee.toString=w2;ee.unix=A2;ee.valueOf=M2;ee.creationData=L2;ee.eraName=W2;ee.eraNarrow=V2;ee.eraAbbr=B2;ee.eraYear=U2;ee.year=NO;ee.isLeapYear=PV;ee.weekYear=q2;ee.isoWeekYear=Z2;ee.quarter=ee.quarters=rU;ee.month=HO;ee.daysInMonth=AV;ee.week=ee.weeks=$V;ee.isoWeek=ee.isoWeeks=kV;ee.weeksInYear=eU;ee.weeksInWeekYear=tU;ee.isoWeeksInYear=Q2;ee.isoWeeksInISOWeekYear=J2;ee.date=iI;ee.day=ee.days=ZV;ee.weekday=QV;ee.isoWeekday=JV;ee.dayOfYear=iU;ee.hour=ee.hours=sB;ee.minute=ee.minutes=oU;ee.second=ee.seconds=sU;ee.millisecond=ee.milliseconds=oI;ee.utcOffset=BB;ee.utc=YB;ee.local=GB;ee.parseZone=zB;ee.hasAlignedHourOffset=jB;ee.isDST=KB;ee.isLocal=qB;ee.isUtcOffset=ZB;ee.isUtc=jO;ee.isUTC=jO;ee.zoneAbbr=lU;ee.zoneName=uU;ee.dates=Or("dates accessor is deprecated. Use date instead.",iI);ee.months=Or("months accessor is deprecated. Use month instead",HO);ee.years=Or("years accessor is deprecated. Use year instead",NO);ee.zone=Or("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",UB);ee.isDSTShifted=Or("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",XB);function cU(t){return Et(t*1e3)}function hU(){return Et.apply(null,arguments).parseZone()}function sI(t){return t}var lt=iv.prototype;lt.calendar=ZW;lt.longDateFormat=tV;lt.invalidDate=rV;lt.ordinal=sV;lt.preparse=sI;lt.postformat=sI;lt.relativeTime=lV;lt.pastFuture=uV;lt.set=XW;lt.eras=$2;lt.erasParse=k2;lt.erasConvertYear=F2;lt.erasAbbrRegex=G2;lt.erasNameRegex=Y2;lt.erasNarrowRegex=z2;lt.months=EV;lt.monthsShort=TV;lt.monthsParse=MV;lt.monthsRegex=IV;lt.monthsShortRegex=OV;lt.week=HV;lt.firstDayOfYear=LV;lt.firstDayOfWeek=NV;lt.weekdays=zV;lt.weekdaysMin=KV;lt.weekdaysShort=jV;lt.weekdaysParse=qV;lt.weekdaysRegex=eB;lt.weekdaysShortRegex=tB;lt.weekdaysMinRegex=nB;lt.isPM=iB;lt.meridiem=aB;function Kd(t,e,n,r){var i=vo(),o=Pi().set(r,e);return i[n](o,t)}function aI(t,e,n){if(go(t)&&(e=t,t=void 0),t=t||"",e!=null)return Kd(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Kd(t,r,n,"month");return i}function Sv(t,e,n,r){typeof t=="boolean"?(go(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,go(e)&&(n=e,e=void 0),e=e||"");var i=vo(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Kd(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Kd(e,(s+o)%7,r,"day");return a}function dU(t,e){return aI(t,e,"months")}function fU(t,e){return aI(t,e,"monthsShort")}function gU(t,e,n){return Sv(t,e,n,"weekdays")}function mU(t,e,n){return Sv(t,e,n,"weekdaysShort")}function pU(t,e,n){return Sv(t,e,n,"weekdaysMin")}Zo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=et(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=Or("moment.lang is deprecated. Use moment.locale instead.",Zo);Z.langData=Or("moment.langData is deprecated. Use moment.localeData instead.",vo);var Li=Math.abs;function wU(){var t=this._data;return this._milliseconds=Li(this._milliseconds),this._days=Li(this._days),this._months=Li(this._months),t.milliseconds=Li(t.milliseconds),t.seconds=Li(t.seconds),t.minutes=Li(t.minutes),t.hours=Li(t.hours),t.months=Li(t.months),t.years=Li(t.years),this}function lI(t,e,n,r){var i=ti(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function CU(t,e){return lI(this,t,e,1)}function vU(t,e){return lI(this,t,e,-1)}function PR(t){return t<0?Math.floor(t):Math.ceil(t)}function SU(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=PR(Ww(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Tr(t/1e3),r.seconds=i%60,o=Tr(i/60),r.minutes=o%60,s=Tr(o/60),r.hours=s%24,e+=Tr(s/24),l=Tr(uI(e)),n+=l,e-=PR(Ww(l)),a=Tr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function uI(t){return t*4800/146097}function Ww(t){return t*146097/4800}function yU(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Ir(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+uI(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Ww(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function bU(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+et(this._months/12)*31536e6:NaN}function So(t){return function(){return this.as(t)}}var RU=So("ms"),EU=So("s"),TU=So("m"),_U=So("h"),MU=So("d"),AU=So("w"),OU=So("M"),IU=So("Q"),PU=So("y");function xU(){return ti(this)}function HU(t){return t=Ir(t),this.isValid()?this[t+"s"]():NaN}function la(t){return function(){return this.isValid()?this._data[t]:NaN}}var DU=la("milliseconds"),NU=la("seconds"),LU=la("minutes"),$U=la("hours"),kU=la("days"),FU=la("months"),WU=la("years");function VU(){return Tr(this.days()/7)}var Qi=Math.round,al={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function BU(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function UU(t,e,n,r){var i=ti(t).abs(),o=Qi(i.as("s")),s=Qi(i.as("m")),a=Qi(i.as("h")),l=Qi(i.as("d")),u=Qi(i.as("M")),c=Qi(i.as("w")),d=Qi(i.as("y")),f=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||d<=1&&["y"]||["yy",d],f[2]=e,f[3]=+t>0,f[4]=r,BU.apply(null,f)}function YU(t){return t===void 0?Qi:typeof t=="function"?(Qi=t,!0):!1}function GU(t,e){return al[t]===void 0?!1:e===void 0?al[t]:(al[t]=e,t==="s"&&(al.ss=e-1),!0)}function zU(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=al,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},al,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=UU(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var fm=Math.abs;function ma(t){return(t>0)-(t<0)||+t}function Qf(){if(!this.isValid())return this.localeData().invalidDate();var t=fm(this._milliseconds)/1e3,e=fm(this._days),n=fm(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,d;return a?(r=Tr(t/60),i=Tr(r/60),t%=60,r%=60,o=Tr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ma(this._months)!==ma(a)?"-":"",c=ma(this._days)!==ma(a)?"-":"",d=ma(this._milliseconds)!==ma(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?d+i+"H":"")+(r?d+r+"M":"")+(t?d+s+"S":"")):"P0D"}var it=qf.prototype;it.isValid=kB;it.abs=wU;it.add=CU;it.subtract=vU;it.as=yU;it.asMilliseconds=RU;it.asSeconds=EU;it.asMinutes=TU;it.asHours=_U;it.asDays=MU;it.asWeeks=AU;it.asMonths=OU;it.asQuarters=IU;it.asYears=PU;it.valueOf=bU;it._bubble=SU;it.clone=xU;it.get=HU;it.milliseconds=DU;it.seconds=NU;it.minutes=LU;it.hours=$U;it.days=kU;it.weeks=VU;it.months=FU;it.years=WU;it.humanize=zU;it.toISOString=Qf;it.toString=Qf;it.toJSON=Qf;it.locale=ZO;it.localeData=JO;it.toIsoString=Or("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Qf);it.lang=QO;Me("X",0,0,"unix");Me("x",0,0,"valueOf");me("x",zf);me("X",gV);gt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});gt("x",function(t,e,n){n._d=new Date(et(t))});//! moment.js
Z.version="2.29.4";jW(Et);Z.fn=ee;Z.min=DB;Z.max=NB;Z.now=LB;Z.utc=Pi;Z.unix=cU;Z.months=dU;Z.isDate=yc;Z.locale=Zo;Z.invalid=Vf;Z.duration=ti;Z.isMoment=Jr;Z.weekdays=gU;Z.parseZone=hU;Z.localeData=vo;Z.isDuration=pd;Z.monthsShort=fU;Z.weekdaysMin=pU;Z.defineLocale=dv;Z.updateLocale=hB;Z.locales=dB;Z.weekdaysShort=mU;Z.normalizeUnits=Ir;Z.relativeTimeRounding=YU;Z.relativeTimeThreshold=GU;Z.calendarFormat=a2;Z.prototype=ee;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const jU=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"}));function cI(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function Vw(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Hu(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Yt(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function fr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function T(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function hI(t){return Yt(t,(e,n)=>e+n,0)}function KU(t){return Yt(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function XU(t){return Yt(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function qU(t){return t.length?hI(t)/t.length:0}function dI(t){return Yt(t,(e,n)=>e.concat(Array.isArray(n)?dI(n):n),[])}function yv(t){const e=[];return T(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function Bw(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function ZU(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>s.includes(a))}),o}function QU(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return T(i,s=>{T(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function Uw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const JU=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:qU,arrayEach:T,arrayFilter:fr,arrayFlatten:dI,arrayMap:Ue,arrayMax:KU,arrayMin:XU,arrayReduce:Yt,arraySum:hI,arrayUnique:yv,extendArray:Vw,getDifferenceOfArrays:Bw,getIntersectionOfArrays:ZU,getUnionOfArrays:QU,pivot:Hu,stringToArray:Uw,to2dArray:cI},Symbol.toStringTag,{value:"Module"}));function ft(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yt(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Ft(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ce(t){return typeof t<"u"}function Ct(t){return typeof t>"u"}function en(t){return t===null||t===""||Ct(t)}function fI(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Eu="length",Du=t=>parseInt(t,16),xR=t=>parseInt(t,10),Xd=(t,e,n)=>t.substr(e,n),Nu=t=>t.codePointAt(0)-65,Yw=t=>`${t}`.replace(/\-/g,""),eY=t=>Du(Xd(Yw(t),Du("12"),Nu("F")))/(Du(Xd(Yw(t),Nu("B"),~~![][Eu]))||9),tY=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let HR=!1;const DR={invalid:()=>ft`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},NR={invalid:()=>ft`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function gI(t,e){const n=!en(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0";let o,s="invalid",a="invalid";t=Yw(t||"");const l=nY(t);if(n||r||l)if(l){const u=Z("30/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=eY(t);o=Z((d+1)*864e5,"x").format("MMMM DD, YYYY"),c>d?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(tY()&&(s="valid",a="valid"),!HR&&s!=="valid"&&(DR[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](DR[s]({keyValidityDate:o,hotVersion:i})),HR=!0),a!=="valid"&&e.parentNode&&NR[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=NR[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function nY(t){let e=[][Eu],n=e;if(t[Eu]!==Nu("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Nu(i.shift());o;o=Nu(i.shift()||"A"))--o<""[Eu]?n=n|(xR(`${xR(Du(r)+(Du(Xd(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Xd(t,o,o?i[Eu]===1?9:8:6);return n===e}const rY=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:gI,isDefined:ce,isEmpty:en,isRegExp:fI,isUndefined:Ct,stringify:Ft},Symbol.toStringTag,{value:"Module"}));function _n(t){return t[0].toUpperCase()+t.substr(1)}function iY(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Ft(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function bv(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function Rv(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function Ev(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Gw(t){return Jf(`${t}`,{ALLOWED_TAGS:[]})}function Jf(t,e){return zW.sanitize(t,e)}const oY=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:iY,isPercentValue:Rv,randomString:bv,sanitize:Jf,stripTags:Gw,substitute:Ev,toUpperCaseFirst:_n},Symbol.toStringTag,{value:"Module"})),Ml=t=>["tabindex",t],sY=()=>["role","treegrid"],Ti=()=>["role","presentation"],aY=()=>["role","gridcell"],lY=()=>["role","rowheader"],mI=()=>["role","rowgroup"],uY=()=>["role","columnheader"],zw=()=>["role","row"],cY=()=>["role","menu"],hY=()=>["role","menuitem"],dY=()=>["role","combobox"],pI=()=>["role","listbox"],fY=()=>["role","option"],gY=()=>["role","checkbox"],mY=()=>["scope","col"],pY=()=>["scope","row"],wY=()=>["type","text"],Tv=t=>["aria-label",t],yo=()=>["aria-hidden","true"],CY=()=>["aria-disabled","true"],vY=()=>["aria-multiselectable","true"],wI=t=>["aria-haspopup",t],CI=t=>["aria-rowcount",t],eg=t=>["aria-colcount",t],vI=t=>["aria-rowindex",t],_v=t=>["aria-colindex",t],_r=t=>["aria-expanded",t],SY=t=>["aria-sort",t],LR=()=>["aria-readonly","true"],$R=()=>["aria-invalid","true"],yY=t=>["aria-checked",t],Mv=()=>["aria-selected","true"],bY=()=>["aria-autocomplete","list"],RY=t=>["aria-controls",t],EY=t=>["aria-activedescendant",t],TY=t=>["aria-live",t],_Y=t=>["aria-relevant",t],MY=t=>["aria-setsize",t],AY=t=>["aria-posinset",t];function SI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function yI(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function bI(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function rc(t){return bI(t)&&t.parent}function OY(t){return!!Object.getPrototypeOf(t.parent)}function rs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Tu(t,e,n){const r=[];let i=t;for(;i&&(i=rs(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Qo(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function RI(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function ko(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function EI(t){return!t||!t.length?[]:t.filter(e=>!!e)}function TI(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function De(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function J(t,e){typeof e=="string"&&(e=e.split(" ")),e=EI(e),e.length>0&&t.classList.add(...e)}function $e(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=TI(e,!0);n=EI(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function _e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function ua(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=TI(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function Av(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)Av(e[n])}}function ei(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const _I=/(<(.*)>|&(.*);)/;function ca(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_I.test(e)?t.innerHTML=n?Jf(e):e:is(t,e)}function is(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ei(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function os(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return os(n.host.impl);if(n.host)return os(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(mo(n).display==="none")return!1;n=n.parentNode}return!0}function jt(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function Ov(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function tg(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function ic(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Ov(e):t.scrollTop}function qd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?tg(e):t.scrollLeft}function oc(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Qs(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=mo(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function vl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=mo(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function IY(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function mo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function dt(t){return t.offsetWidth}function Pt(t){return t.offsetHeight}function oo(t){return t.clientHeight||t.innerHeight}function Lu(t){return t.clientWidth||t.innerWidth}function PY(t,e,n){t.addEventListener(e,n,!1)}function xY(t,e,n){t.removeEventListener(e,n,!1)}function Iv(t){return t.selectionStart?t.selectionStart:0}function MI(t){return t.selectionEnd?t.selectionEnd:0}function HY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function jw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Tc(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let gm;function DY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function on(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return gm===void 0&&(gm=DY(t)),gm}function AI(t){return t.offsetWidth!==t.clientWidth}function OI(t){return t.offsetHeight!==t.clientHeight}function ng(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function NY(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function _c(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Zd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function rg(t){return Zd(t)&&t.hasAttribute("data-hot-input")===!1}function LY(t){const e=t.ownerDocument.activeElement;rg(e)||t.select()}function Pv(t){return!t.parentNode}function II(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function xv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();_e(t,"contenteditable",!0),n&&_e(t,...yo()),e&&J(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function Hv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&$e(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function PI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;xv(t,n),e(),Hv(t,n)}const $Y=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:_I,addClass:J,addEvent:PY,clearTextSelection:jw,closest:rs,closestDown:Tu,empty:ei,fastInnerHTML:ca,fastInnerText:is,getCaretPosition:Iv,getComputedStyle:mo,getCssTransform:NY,getFrameElement:bI,getParent:SI,getParentWindow:rc,getScrollLeft:qd,getScrollTop:ic,getScrollableElement:oc,getScrollbarWidth:on,getSelectionEndPosition:MI,getSelectionText:HY,getStyle:vl,getTrimmingContainer:Qs,getWindowScrollLeft:tg,getWindowScrollTop:Ov,hasAccessToParentWindow:OY,hasClass:De,hasHorizontalScrollbar:OI,hasVerticalScrollbar:AI,index:RI,innerHeight:oo,innerWidth:Lu,isChildOf:Qo,isDetached:Pv,isInput:Zd,isOutsideInput:rg,isThisHotChild:yI,isVisible:os,makeElementContentEditableAndSelectItsContent:xv,matchesCSSRules:IY,observeVisibilityChangeOnce:II,offset:jt,outerHeight:Pt,outerWidth:dt,overlayContainsElement:ko,removeAttribute:ua,removeClass:$e,removeContentEditableFromElementAndDeselect:Hv,removeEvent:xY,removeTextNodes:Av,resetCssTransform:_c,runWithSelectedContendEditableElement:PI,selectElementIfAllowed:LY,setAttribute:_e,setCaretPosition:Tc,setOverlayPosition:ng},Symbol.toStringTag,{value:"Module"}));function wt(t){return typeof t=="function"}function xI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const d=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},d)),r}return o}function kY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=xI(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function ig(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function FY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Yt(i,(u,c)=>c(u),r.apply(this,a))}}function Dv(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function HI(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function WY(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Qd(t,e,n,r,i,o,s,a){return ce(a)?t.call(e,n,r,i,o,s,a):ce(s)?t.call(e,n,r,i,o,s):ce(o)?t.call(e,n,r,i,o):ce(i)?t.call(e,n,r,i):ce(r)?t.call(e,n,r):ce(n)?t.call(e,n):t.call(e)}const VY=Object.freeze(Object.defineProperty({__proto__:null,curry:HI,curryRight:WY,debounce:ig,fastCall:Qd,isFunction:wt,partial:Dv,pipe:FY,throttle:xI,throttleAfterHits:kY},Symbol.toStringTag,{value:"Module"}));var BY=Yn,kR=eO,UY=wn,FR=El,YY=sO,WR=BY([].push),GY=function(t){if(UY(t))return t;if(kR(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?WR(n,i):(typeof i=="number"||FR(i)==="Number"||FR(i)==="String")&&WR(n,YY(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(kR(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},zY=sa,DI=wc,NI=Wf,jY=Nf,Mc=Yn,LI=Ar,VR=wn,BR=BC,$I=JC,KY=GY,XY=VC,qY=String,Jo=DI("JSON","stringify"),Zc=Mc(/./.exec),UR=Mc("".charAt),ZY=Mc("".charCodeAt),QY=Mc("".replace),JY=Mc(1 .toString),eG=/[\uD800-\uDFFF]/g,YR=/^[\uD800-\uDBFF]$/,GR=/^[\uDC00-\uDFFF]$/,zR=!XY||LI(function(){var t=DI("Symbol")("stringify detection");return Jo([t])!=="[null]"||Jo({a:t})!=="{}"||Jo(Object(t))!=="{}"}),jR=LI(function(){return Jo("\uDF06\uD834")!=='"\\udf06\\ud834"'||Jo("\uDEAD")!=='"\\udead"'}),tG=function(t,e){var n=$I(arguments),r=KY(e);if(!(!VR(r)&&(t===void 0||BR(t))))return n[1]=function(i,o){if(VR(r)&&(o=jY(r,this,qY(i),o)),!BR(o))return o},NI(Jo,null,n)},nG=function(t,e,n){var r=UR(n,e-1),i=UR(n,e+1);return Zc(YR,t)&&!Zc(GR,i)||Zc(GR,t)&&!Zc(YR,r)?"\\u"+JY(ZY(t,0),16):t};Jo&&zY({target:"JSON",stat:!0,arity:3,forced:zR||jR},{stringify:function(e,n,r){var i=$I(arguments),o=NI(zR?tG:Jo,null,i);return jR&&typeof o=="string"?QY(o,eG,nG):o}});function Sl(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ye(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Sl(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Sl(n[0])]:e[r]=[]:e[r]=null)})),e}function bo(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Kt(t,e,n){const r=Array.isArray(n);return Ye(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Ac(t,e){Ye(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Ac(t[r],e[r])):t[r]=e[r]})}function Mn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Bn(t){const e={};return Ye(t,(n,r)=>{e[r]=n}),e}function mt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return T(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ye(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,d){const f=`_${c}`,p=w=>{let v=w;return(Array.isArray(v)||Be(v))&&(v=Mn(v)),v};return function(){return this[f]===void 0&&(this[f]=p(d)),this[f]}},l=function(c){const d=`_${c}`;return function(f){this[d]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function og(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Be(t){return Object.prototype.toString.call(t)==="[object Object]"}function Hi(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ye(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function kI(t,e){const n=e.split(".");let r=t;return Ye(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Cd(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(It(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function sg(t){if(!Be(t))return 0;const e=function(n){let r=0;return Be(n)?Ye(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Xr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function It(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const rG=Object.freeze(Object.defineProperty({__proto__:null,clone:Bn,createObjectPropListener:Xr,deepClone:Mn,deepExtend:Ac,deepObjectSize:sg,defineGetter:Hi,duckSchema:Sl,extend:Kt,getProperty:kI,hasOwnProperty:It,inherit:bo,isObject:Be,isObjectEqual:og,mixin:mt,objectEach:Ye,setProperty:Cd},Symbol.toStringTag,{value:"Module"})),br=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Ro={chrome:br((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:br(t=>/CriOS/.test(t)),edge:br(t=>/Edge/.test(t)),edgeWebKit:br(t=>/EdgiOS/.test(t)),firefox:br(t=>/Firefox/.test(t)),firefoxWebKit:br(t=>/FxiOS/.test(t)),mobile:br(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:br((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Al={mac:br(t=>/^Mac/.test(t)),win:br(t=>/^Win/.test(t)),linux:br(t=>/^Linux/.test(t)),ios:br(t=>/iPhone|iPad|iPod/i.test(t))};function FI(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(Ro,n=>{let{test:r}=n;return void r(t,e)})}function WI(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(Al,e=>{let{test:n}=e;return void n(t)})}FI();WI();function Nv(){return Ro.chrome.value}function VI(){return Ro.chromeWebKit.value}function vd(){return Ro.firefox.value}function BI(){return Ro.firefoxWebKit.value}function Lv(){return Ro.safari.value}function UI(){return Ro.edge.value}function iG(){return Ro.edgeWebKit.value}function so(){return Ro.mobile.value}function $v(){return Al.ios.value}function kv(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Al.mac.value}function Kw(){return Al.win.value}function sc(){return Al.mac.value}function oG(){return Al.linux.value}const sG=Object.freeze(Object.defineProperty({__proto__:null,isChrome:Nv,isChromeWebKit:VI,isEdge:UI,isEdgeWebKit:iG,isFirefox:vd,isFirefoxWebKit:BI,isIOS:$v,isIpadOS:kv,isLinuxOS:oG,isMacOS:sc,isMobileBrowser:so,isSafari:Lv,isWindowsOS:Kw,setBrowserMeta:FI,setPlatformMeta:WI},Symbol.toStringTag,{value:"Module"})),we={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:vd()?182:174,AUDIO_MUTE:vd()?181:173,AUDIO_UP:vd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},aG=[we.ALT,we.ARROW_DOWN,we.ARROW_LEFT,we.ARROW_RIGHT,we.ARROW_UP,we.AUDIO_DOWN,we.AUDIO_MUTE,we.AUDIO_UP,we.BACKSPACE,we.CAPS_LOCK,we.DELETE,we.END,we.ENTER,we.ESCAPE,we.F1,we.F2,we.F3,we.F4,we.F5,we.F6,we.F7,we.F8,we.F9,we.F10,we.F11,we.F12,we.F13,we.F14,we.F15,we.F16,we.F17,we.F18,we.F19,we.HOME,we.INSERT,we.MEDIA_NEXT,we.MEDIA_PLAY_PAUSE,we.MEDIA_PREV,we.MEDIA_STOP,we.NULL,we.NUM_LOCK,we.PAGE_DOWN,we.PAGE_UP,we.PAUSE,we.SCROLL_LOCK,we.SHIFT,we.TAB];function YI(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Fv(t){return aG.includes(t)}function lG(t){const e=[];return sc()?e.push(we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX):e.push(we.CONTROL),e.includes(t)}function GI(t){return[we.CONTROL,we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX].includes(t)}function Ol(t,e){const n=e.split("|");let r=!1;return T(n,i=>{if(t===we[i])return r=!0,!1}),r}const uG=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:we,isCtrlKey:lG,isCtrlMetaKey:GI,isFunctionKey:Fv,isKey:Ol,isPrintableChar:YI},Symbol.toStringTag,{value:"Module"}));function Pr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Bo(t){return t.isImmediatePropagationEnabled===!1}function ss(t){return t.button===2}function ag(t){return t.button===0}function zI(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const cG=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Bo,isLeftClick:ag,isRightClick:ss,offsetRelativeTo:zI,stopImmediatePropagation:Pr},Symbol.toStringTag,{value:"Module"}));function vt(){ce(console)&&console.warn(...arguments)}function Wv(){ce(console)&&console.error(...arguments)}function hG(t,e,n){return e=dG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dG(t){var e=fG(t,"string");return typeof e=="symbol"?e:String(e)}function fG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pa=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],gG=ft`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,mm=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),pm=new Map([[]]);class jI{static getSingleton(){return pG()}constructor(){hG(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return T(pa,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))T(n,i=>this.add(e,i,r));else{mm.has(e)&&vt(Ev(gG,{hookName:e,removedInVersion:mm.get(e)})),pm.has(e)&&vt(pm.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&T(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?T(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=Qd(u[d],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[d]&&u[d].runOnce&&this.remove(n,u[d]),d+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=Qd(u[d],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[d]&&u[d].runOnce&&this.remove(n,u[d],e),d+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ye(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||pa.push(e)}deregister(e){this.isRegistered(e)&&pa.splice(pa.indexOf(e),1)}isDeprecated(e){return pm.has(e)||mm.has(e)}isRegistered(e){return pa.indexOf(e)>=0}getRegistered(){return pa}}const mG=new jI;function pG(){return mG}const ge=jI,wm=new Map;function ni(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";wm.has(t)||wm.set(t,new Map);const e=wm.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const Xw=new WeakMap,{register:wG,getItem:KI,hasItem:XI,getNames:CG,getValues:pae}=ni("editors");function vG(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ge.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function qI(t,e){let n;if(typeof t=="function")Xw.get(t)||Jn(null,t),n=Xw.get(t);else if(typeof t=="string")n=KI(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Jd(t){if(typeof t=="function")return t;if(!XI(t))throw Error(`No registered editor found under "${t}" name`);return KI(t).getConstructor()}function Jn(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new vG(e);typeof t=="string"&&wG(t,n),Xw.set(e,n)}function SG(t,e,n){return e=yG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yG(t){var e=bG(t,"string");return typeof e=="symbol"?e:String(e)}function bG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Sd=0;class RG{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;SG(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,EG(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Sd+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Sd-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Sd-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function EG(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Pr(this)},t}const gr=RG;function TG(){return Sd}function KR(t,e){_G(t,e),e.add(t)}function _G(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _o(t,e,n){return e=MG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MG(t){var e=AG(t,"string");return typeof e=="symbol"?e:String(e)}function AG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XR(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lg="editorManager.navigation";var qR=new WeakSet,ZR=new WeakSet;class qw{constructor(e,n,r){KR(this,ZR),KR(this,qR),_o(this,"hot",void 0),_o(this,"tableMeta",void 0),_o(this,"selection",void 0),_o(this,"eventManager",void 0),_o(this,"destroyed",!1),_o(this,"lock",!1),_o(this,"activeEditor",void 0),_o(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new gr(e),this.hot.addHook("afterDocumentKeyDown",i=>XR(this,qR,OG).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>XR(this,ZR,IG).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=qI(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function OG(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Bo(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Fv(n)&&!GI(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>ce(this.hot.getSelected()),group:lg};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function IG(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const QR=new WeakMap;qw.getInstance=function(t,e,n){let r=QR.get(t);return r||(r=new qw(t,e,n),QR.set(t,r)),r};const PG=qw;function Qc(t,e){ZI(t,e),e.add(t)}function Wl(t,e,n){ZI(t,e),e.set(t,n)}function ZI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ll(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Nt(t,e){var n=QI(t,e,"get");return xG(t,n)}function xG(t,e){return e.get?e.get.call(t):e.value}function Vl(t,e,n){var r=QI(t,e,"set");return HG(t,r,n),n}function QI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function HG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Ko=Object.freeze({CELL:"cell",MIXED:"mixed"});var pn=new WeakMap,Jc=new WeakMap,eh=new WeakMap,th=new WeakMap,nh=new WeakMap,ef=new WeakSet,JR=new WeakSet,e0=new WeakSet,t0=new WeakSet;class DG{constructor(e){var n=this;Qc(this,t0),Qc(this,e0),Qc(this,JR),Qc(this,ef),Wl(this,pn,{writable:!0,value:void 0}),Wl(this,Jc,{writable:!0,value:void 0}),Wl(this,eh,{writable:!0,value:50}),Wl(this,th,{writable:!0,value:null}),Wl(this,nh,{writable:!0,value:new Map});const r=e.getSettings();Vl(this,pn,e),Vl(this,Jc,r.imeFastEdit?Ko.MIXED:Ko.CELL),Nt(this,pn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ll(n,t0,$G).call(n,...o)}),Nt(this,pn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ll(n,JR,NG).call(n,...o)}),Nt(this,pn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return ll(n,e0,LG).call(n,...o)})}getFocusMode(){return Nt(this,Jc)}setFocusMode(e){Object.values(Ko).includes(e)?Vl(this,Jc,e):vt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Nt(this,eh)}setRefocusDelay(e){Vl(this,eh,e)}setRefocusElementGetter(e){Vl(this,th,e)}getRefocusElement(){if(typeof Nt(this,th)=="function")return Nt(this,th).call(this);var e;return(e=Nt(this,pn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Nt(this,pn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Nt(this,pn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Nt(this,pn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):ll(this,ef,Vv).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Nt(this,eh);const r=this.getRefocusElement();Nt(this,pn).getSettings().imeFastEdit&&!((e=Nt(this,pn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Nt(this,nh).has(n)||Nt(this,nh).set(n,ig(()=>{r.select()},n)),Nt(this,nh).get(n)())}}function Vv(t){var e;const n=(e=Nt(this,pn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Nt(this,pn).selection.isCellVisible(n)){t(null);return}const r=Nt(this,pn).getCell(n.row,n.col,!0);r===null?Nt(this,pn).addHookOnce("afterScroll",()=>{t(Nt(this,pn).getCell(n.row,n.col,!0))}):t(r)}function NG(){ll(this,ef,Vv).call(this,t=>{const{activeElement:e}=Nt(this,pn).rootDocument;e&&rg(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function LG(){ll(this,ef,Vv).call(this,t=>{this.getFocusMode()===Ko.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function $G(t){t.imeFastEdit&&this.getFocusMode()!==Ko.MIXED?this.setFocusMode(Ko.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Ko.CELL&&this.setFocusMode(Ko.CELL)}const JI={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},kG=new RegExp(Object.keys(JI).map(t=>`(${t})`).join("|"),"gi");function FG(t){return(t&&t.nodeName||"")==="TABLE"}function Zw(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,d=e?1:0;for(let f=0;f<o;f+=1){const p=e&&f===0,w=[];for(let y=0;y<s;y+=1){const b=!p&&n&&y===0;let _="";if(p)_=`<th>${t.getColHeader(y-c)}</th>`;else if(b)_=`<th>${t.getRowHeader(f-d)}</th>`;else{const I=i[f][y],{hidden:L,rowspan:x,colspan:W}=t.getCellMeta(f-d,y-c);if(!L){const G=[];if(x&&G.push(`rowspan="${x}"`),W&&G.push(`colspan="${W}"`),en(I))_=`<td ${G.join(" ")}></td>`;else{const ne=I.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${G.join(" ")}>${ne}</td>`}}}w.push(_)}const v=["<tr>",...w,"</tr>"].join("");p?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Qw(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=en(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function eP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const I=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,L=>{const x=L.match(/<td\b[^>]*?>/g)[0],W=L.substring(x.length,L.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${x}${W}</td>`});i.insertAdjacentHTML("afterbegin",`${I}`),o=i.querySelector("table")}if(!o||!FG(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((I,L)=>I+L.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let f=!1,p=0,w=0;if(o.tHead){const I=Array.from(o.tHead.rows).filter(L=>{const x=L.querySelector("td")!==null;return x&&d.push(L),!x});p=I.length,f=p>0,p>1?n.nestedHeaders=Array.from(I).reduce((L,x)=>{const W=Array.from(x.cells).reduce((G,ne,j)=>{if(a&&j===0)return G;const{colSpan:X,innerHTML:ie}=ne,oe=X>1?{label:ie,colspan:X}:ie;return G.push(oe),G},[]);return L.push(W),L},[]):f&&(n.colHeaders=Array.from(I[0].children).reduce((L,x,W)=>(a&&W===0||L.push(x.innerHTML),L),[]))}d.length&&(n.fixedRowsTop=d.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...d,...Array.from(o.tBodies).reduce((I,L)=>(I.push(...Array.from(L.rows)),I),[]),...c];w=v.length;const y=new Array(w);for(let I=0;I<w;I++)y[I]=new Array(u);const b=[],_=[];for(let I=0;I<w;I++){const L=v[I],x=Array.from(L.cells),W=x.length;for(let G=0;G<W;G++){const ne=x[G],{nodeName:j,innerHTML:X,rowSpan:ie,colSpan:oe}=ne,se=y[I].findIndex(ve=>ve===void 0);if(j==="TD"){if(ie>1||oe>1){for(let Ne=I;Ne<I+ie;Ne++)if(Ne<w)for(let R=se;R<se+oe;R++)y[Ne][R]=null;const Pe=ne.getAttribute("style");Pe&&Pe.includes("mso-ignore:colspan")||b.push({col:se,row:I,rowspan:ie,colspan:oe})}let ve="";s&&/excel/gi.test(s.content)?ve=X.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ve=X.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[I][se]=ve.replace(kG,Pe=>JI[Pe])}else _.push(X)}}return b.length&&(n.mergeCells=b),_.length&&(n.rowHeaders=_),y.length&&(n.data=y),n}const WG=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Qw,htmlToGridSettings:eP,instanceToHTML:Zw},Symbol.toStringTag,{value:"Module"}));function Vn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function tP(t){return Vn(t,[","])}function Ce(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function tf(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function Bv(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function rr(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const VG=Object.freeze(Object.defineProperty({__proto__:null,clamp:rr,isNumeric:Vn,isNumericLike:tP,rangeEach:Ce,rangeEachReverse:tf,valueAccordingPercent:Bv},Symbol.toStringTag,{value:"Module"})),Jw="asc",BG="desc",n0=new Map([[Jw,[-1,1]],[BG,[1,-1]]]),UG=t=>`The priority '${t}' is already declared in a map.`,YG=t=>`The priority '${t}' is not a number.`;function GG(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=wt(t)?t:UG,e=wt(e)?e:YG;function r(o,s){if(!Vn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jw;const[s,a]=n0.get(o)||n0.get(Jw);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const zG=t=>`The id '${t}' is already declared in a map.`;function ug(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=wt(t)?t:zG;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(d=>{let[f,p]=d;return u===p?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const jG=t=>`'${t}' value is already declared in a unique set.`;function KG(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=wt(t)?t:jG;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const Uv=t=>`There is already registered "${t}" plugin.`,XG=t=>`There is already registered plugin on priority "${t}".`,qG=t=>`The priority "${t}" is not a number.`,nP=GG({errorPriorityExists:XG,errorPriorityNaN:qG}),rP=KG({errorItemExists:Uv}),eC=ug({errorIdExists:Uv});function Yv(){return[...nP.getItems(),...rP.getItems()]}function Oc(t){const e=_n(t);return eC.getItem(e)}function ZG(t){return!!Oc(t)}function rt(t,e,n){[t,e,n]=JG(t,e,n),Oc(t)===void 0&&QG(t,e,n)}function QG(t,e,n){const r=_n(t);if(eC.hasItem(r))throw new Error(Uv(r));n===void 0?rP.addItem(r):nP.addItem(n,r),eC.addItem(r,e)}function JG(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:ez,getItem:tz,hasItem:iP,getNames:nz,getValues:wae}=ni("renderers");function nf(t){if(typeof t=="function")return t;if(!iP(t))throw Error(`No registered renderer found under "${t}" name`);return tz(t)}function Ci(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),ez(t,e)}const{register:rz,getItem:iz,hasItem:oP,getNames:oz,getValues:Cae}=ni("validators");function Gv(t){if(typeof t=="function")return t;if(!oP(t))throw Error(`No registered validator found under "${t}" name`);return iz(t)}function ul(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),rz(t,e)}var sP={},sz=ZA,az=ZC,lz=Object.keys||function(e){return sz(e,az)},uz=Oi,cz=YA,hz=oa,dz=Cc,fz=Lf,gz=lz;sP.f=uz&&!cz?Object.defineProperties:function(e,n){dz(e);for(var r=fz(n),i=gz(n),o=i.length,s=0,a;o>s;)hz.f(e,a=i[s++],r[a]);return e};var mz=Cc,pz=sP,r0=ZC,wz=KC,Cz=hO,vz=zC,Sz=jA,i0=">",o0="<",tC="prototype",nC="script",aP=Sz("IE_PROTO"),Cm=function(){},lP=function(t){return o0+nC+i0+t+o0+"/"+nC+i0},s0=function(t){t.write(lP("")),t.close();var e=t.parentWindow.Object;return t=null,e},yz=function(){var t=vz("iframe"),e="java"+nC+":",n;return t.style.display="none",Cz.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(lP("document.F=Object")),n.close(),n.F},rh,yd=function(){try{rh=new ActiveXObject("htmlfile")}catch{}yd=typeof document<"u"?document.domain&&rh?s0(rh):yz():s0(rh);for(var t=r0.length;t--;)delete yd[tC][r0[t]];return yd()};wz[aP]=!0;var bz=Object.create||function(e,n){var r;return e!==null?(Cm[tC]=mz(e),r=new Cm,Cm[tC]=null,r[aP]=e):r=yd(),n===void 0?r:pz.f(r,n)},Rz=kf,Ez=bz,Tz=oa.f,rC=Rz("unscopables"),iC=Array.prototype;iC[rC]===void 0&&Tz(iC,rC,{configurable:!0,value:Ez(null)});var uP=function(t){iC[rC][t]=!0},_z=sa,Mz=$f,Az=Ff,Oz=qC,Iz=uP;_z({target:"Array",proto:!0},{at:function(e){var n=Mz(this),r=Az(n),i=Oz(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});Iz("at");const Ys=1,Rn=2;function a0(t,e,n){Pz(t,e),e.set(t,n)}function Pz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $i(t,e,n){return e=xz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xz(t){var e=Hz(t,"string");return typeof e=="symbol"?e:String(e)}function Hz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qt(t,e){var n=cP(t,e,"get");return Dz(t,n)}function Dz(t,e){return e.get?e.get.call(t):e.value}function l0(t,e,n){var r=cP(t,e,"set");return Nz(t,r,n),n}function cP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Nz(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ih=new WeakMap,Zt=new WeakMap;class zv{static get DEFAULT_WIDTH(){return 50}constructor(e){$i(this,"count",0),$i(this,"startColumn",null),$i(this,"endColumn",null),$i(this,"startPosition",null),$i(this,"isVisibleInTrimmingContainer",!1),$i(this,"stretchAllRatio",0),$i(this,"stretchLastWidth",0),a0(this,ih,{writable:!0,value:0}),$i(this,"needVerifyLastColumnWidth",!0),$i(this,"stretchAllColumnsWidth",[]),a0(this,Zt,{writable:!0,value:void 0}),l0(this,Zt,e),typeof qt(this,Zt).stretchingColumnWidthFn!="function"&&(qt(this,Zt).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=qt(this,Zt),s=Math.max(qt(this,Zt).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let d,f=0,p=0;for(let b=0;b<i;b++)if(d=this._getColumnWidth(b),l<=s&&e!==Rn&&(this.startColumn=b,f=d),l>=s&&l+(e===Rn?d:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=b,f=d),this.endColumn=b),c.push(l),l+=d,p=d,e!==Rn&&(this.endColumn=b),l>=s+o){u=!1;break}const w=r+o-a,v=e===Rn?0:p,y=e===Rn?f:0;if(w<-1*qt(this,Zt).inlineStartOffset||r>c.at(-1)+v||-1*qt(this,Zt).scrollOffset-qt(this,Zt).viewportWidth>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=c[this.endColumn]+d-c[this.startColumn-1];if((b<=o||e!==Rn)&&(this.startColumn-=1),b>o)break}e===Ys&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(qt(this,Zt).stretchMode==="none")return;let n=e;l0(this,ih,n);const r=qt(this,Zt).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=qt(this,Zt).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(qt(this,Zt).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(qt(this,Zt).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return qt(this,Zt).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):qt(this,Zt).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=qt(this,Zt).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=qt(this,Zt).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==qt(this,ih)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=qt(this,ih)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=qt(this,Zt).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=qt(this,Zt).columnWidthFn(e);return isNaN(n)&&(n=zv.DEFAULT_WIDTH),n}}const jv=zv;function Lz(t,e,n){$z(t,e),e.set(t,n)}function $z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bl(t,e,n){return e=kz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kz(t){var e=Fz(t,"string");return typeof e=="symbol"?e:String(e)}function Fz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vm(t,e){var n=hP(t,e,"get");return Wz(t,n)}function Wz(t,e){return e.get?e.get.call(t):e.value}function Vz(t,e,n){var r=hP(t,e,"set");return Bz(t,r,n),n}function hP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Bz(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ul=new WeakMap;class Kv{static get DEFAULT_HEIGHT(){return 23}constructor(e){Bl(this,"count",0),Bl(this,"startRow",null),Bl(this,"endRow",null),Bl(this,"startPosition",null),Bl(this,"isVisibleInTrimmingContainer",!1),Lz(this,Ul,{writable:!0,value:void 0}),Vz(this,Ul,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=vm(this,Ul),a=Math.max(vm(this,Ul).scrollOffset,0),l=vm(this,Ul).horizontalScrollbarHeight||0;let u=0,c=!0;const d=[];let f,p=0,w=0;for(let _=0;_<o;_++)if(f=r(_),isNaN(f)&&(f=Kv.DEFAULT_HEIGHT),u<=a&&e!==Rn&&(this.startRow=_,p=f),u>=a&&u+(e===Rn?f:0)<=a+s-l&&(this.startRow===null&&(this.startRow=_,p=f),this.endRow=_),d.push(u),u+=f,w=f,e!==Rn&&(this.endRow=_),u>=a+s-l){c=!1;break}const v=i+s-l,y=e===Rn?p:0,b=e===Rn?0:w;if(v<y||i>d.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const _=d[this.endRow]+f-d[this.startRow-1];if((_<=s-l||e!==Rn)&&(this.startRow-=1),_>=s-l)break}e===Ys&&this.startRow!==null&&n&&n(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const dP=Kv;function Uz(t,e,n){Yz(t,e),e.set(t,n)}function Yz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u0(t,e,n){return e=Gz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gz(t){var e=zz(t,"string");return typeof e=="symbol"?e:String(e)}function zz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wa(t,e){var n=fP(t,e,"get");return jz(t,n)}function jz(t,e){return e.get?e.get.call(t):e.value}function c0(t,e,n){var r=fP(t,e,"set");return Kz(t,r,n),n}function fP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Kz(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ki=new WeakMap;class rf{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;u0(this,"row",null),u0(this,"col",null),Uz(this,ki,{writable:!0,value:!1}),c0(this,ki,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return wa(this,ki)}isSouthEastOf(e){return this.row>=e.row&&(wa(this,ki)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(wa(this,ki)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(wa(this,ki)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(wa(this,ki)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof rf&&c0(this,ki,e.isRtl()),this}clone(){return new rf(this.row,this.col,wa(this,ki))}toObject(){return{row:this.row,col:this.col}}}const of=rf;function Xz(t,e,n){qz(t,e),e.set(t,n)}function qz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sm(t,e,n){return e=Zz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zz(t){var e=Qz(t,"string");return typeof e=="symbol"?e:String(e)}function Qz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ii(t,e){var n=gP(t,e,"get");return Jz(t,n)}function Jz(t,e){return e.get?e.get.call(t):e.value}function ej(t,e,n){var r=gP(t,e,"set");return tj(t,r,n),n}function gP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var pr=new WeakMap;class Xv{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Sm(this,"highlight",null),Sm(this,"from",null),Sm(this,"to",null),Xz(this,pr,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),ej(this,pr,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),d=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=d,this.to=f,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ii(this,pr)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ii(this,pr)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ii(this,pr)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ii(this,pr)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ii(this,pr)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ii(this,pr)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ii(this,pr)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ii(this,pr)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof of))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new Xv(this.highlight,this.from,this.to,ii(this,pr))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new of(e,n,ii(this,pr))}}const qv=Xv;function cg(t){return window.requestAnimationFrame(t)}function ac(t){window.cancelAnimationFrame(t)}function Zv(){return"ontouchstart"in window}let Ca;function mP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ca||(typeof Intl=="object"?Ca=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Ca=(n,r)=>`${n}`.localeCompare(r):Ca=(n,r)=>n===r?0:n>r?-1:1,Ca)}const nj=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:ac,getComparisonFunction:mP,isTouchSupported:Zv,requestAnimationFrame:cg},Symbol.toStringTag,{value:"Module"}));function oi(t,e,n){rj(t,e),e.set(t,n)}function rj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Se(t,e){var n=pP(t,e,"get");return ij(t,n)}function ij(t,e){return e.get?e.get.call(t):e.value}function Mo(t,e,n){var r=pP(t,e,"set");return oj(t,r,n),n}function pP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function oj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var wr=new WeakMap,ym=new WeakMap,an=new WeakMap,va=new WeakMap,oh=new WeakMap,Hr=new WeakMap,bm=new WeakMap,Yl=new WeakMap,ms=new WeakMap,si=new WeakMap;let sj=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;oi(this,wr,{writable:!0,value:void 0}),oi(this,ym,{writable:!0,value:void 0}),oi(this,an,{writable:!0,value:void 0}),oi(this,va,{writable:!0,value:void 0}),oi(this,oh,{writable:!0,value:void 0}),oi(this,Hr,{writable:!0,value:void 0}),oi(this,bm,{writable:!0,value:void 0}),oi(this,Yl,{writable:!0,value:void 0}),oi(this,ms,{writable:!0,value:[null,null]}),oi(this,si,{writable:!0,value:[null,null]}),Mo(this,wr,r),Mo(this,ym,n),Mo(this,an,o),Mo(this,va,s),Mo(this,oh,a),Mo(this,Hr,i),Mo(this,bm,e),this.registerEvents()}registerEvents(){Se(this,Hr).addEventListener(Se(this,an).holder,"contextmenu",r=>this.onContextMenu(r)),Se(this,Hr).addEventListener(Se(this,an).TABLE,"mouseover",r=>this.onMouseOver(r)),Se(this,Hr).addEventListener(Se(this,an).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Se(this,Hr).addEventListener(Se(this,an).holder,"touchstart",r=>this.onTouchStart(r)),Se(this,Hr).addEventListener(Se(this,an).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Se(this,Hr).addEventListener(Se(this,an).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Se(this,wr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Se(this,wr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Se(this,Hr).addEventListener(Se(this,an).holder,"mouseup",r=>this.onMouseUp(r)),Se(this,Hr).addEventListener(Se(this,an).holder,"mousedown",r=>this.onMouseDown(r))};so()?e():(Zv()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Se(this,Yl)&&r){const[i,o]=[r.row,Se(this,Yl).from.row],[s,a]=[r.col,Se(this,Yl).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=Se(this,an).TABLE,i=Tu(e,["TD","TH"],r);return i?(n.coords=Se(this,an).getCoords(i),n.TD=i):De(e,"wtBorder")&&De(e,"current")?(n.coords=Se(this,va).getFocusSelection().cellRange.highlight,n.TD=Se(this,an).getCell(n.coords)):De(e,"wtBorder")&&De(e,"area")&&Se(this,va).getAreaSelection().cellRange&&(n.coords=Se(this,va).getAreaSelection().cellRange.to,n.TD=Se(this,an).getCell(n.coords)),n}onMouseDown(e){const n=Se(this,ym).rootDocument.activeElement,r=Dv(SI,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);De(i,"corner")?Se(this,wr).getSetting("onCellCornerMouseDown",e,i):o.TD&&Se(this,wr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Se(this,si)[0]=o.TD,clearTimeout(Se(this,ms)[0]),Se(this,ms)[0]=setTimeout(()=>{Se(this,si)[0]=null},1e3))}onContextMenu(e){if(Se(this,wr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Se(this,wr).has("onCellMouseOver"))return;const n=Se(this,an).TABLE,r=Tu(e.target,["TD","TH"],n),i=Se(this,oh)||this;r&&r!==i.lastMouseOver&&Qo(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Se(this,an).getCoords(r),r))}onMouseOut(e){if(!Se(this,wr).has("onCellMouseOut"))return;const n=Se(this,an).TABLE,r=Tu(e.target,["TD","TH"],n),i=Tu(e.relatedTarget,["TD","TH"],n),o=Se(this,oh)||this;r&&r!==i&&Qo(r,n)&&(this.callListener("onCellMouseOut",e,Se(this,an).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Se(this,wr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Se(this,si)[0]&&n.TD===Se(this,si)[1]?(De(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Se(this,si)[0]=null,Se(this,si)[1]=null):n.TD===Se(this,si)[0]&&(Se(this,si)[1]=n.TD,clearTimeout(Se(this,ms)[1]),Se(this,ms)[1]=setTimeout(()=>{Se(this,si)[1]=null},500)))}onTouchStart(e){Mo(this,Yl,Se(this,va).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ce(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Se(this,wr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];$v()&&(VI()||BI())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=Se(this,wr).getSettingPure(e);o&&o(n,r,i,Se(this,bm).call(this))}destroy(){clearTimeout(Se(this,ms)[0]),clearTimeout(Se(this,ms)[1]),Se(this,Hr).destroy()}};const wP=sj;function Rm(t,e,n){return e=aj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aj(t){var e=lj(t,"string");return typeof e=="symbol"?e:String(e)}function lj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uj{constructor(e,n,r){Rm(this,"offset",void 0),Rm(this,"total",void 0),Rm(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const cj=uj;function Em(t,e,n){return e=hj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hj(t){var e=dj(t,"string");return typeof e=="symbol"?e:String(e)}function dj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fj{constructor(e,n,r){Em(this,"offset",void 0),Em(this,"total",void 0),Em(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const gj=fj,mj=0,sf=1,af=2;function sh(t,e,n){return e=pj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pj(t){var e=wj(t,"string");return typeof e=="symbol"?e:String(e)}function wj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h0{constructor(){sh(this,"currentSize",0),sh(this,"nextSize",0),sh(this,"currentOffset",0),sh(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Tm(t,e,n){return e=Cj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cj(t){var e=vj(t,"string");return typeof e=="symbol"?e:String(e)}function vj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sj{constructor(){Tm(this,"size",new h0),Tm(this,"workingSpace",mj),Tm(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof h0}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=sf,e.workingSpace=af,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=af,e.workingSpace=sf,this.sharedSize=e.getViewSize()}}function Sa(t,e,n){return e=yj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yj(t){var e=bj(t,"string");return typeof e=="symbol"?e:String(e)}function bj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CP{constructor(e,n,r){Sa(this,"rootNode",void 0),Sa(this,"nodesPool",void 0),Sa(this,"sizeSet",new Sj),Sa(this,"childNodeType",void 0),Sa(this,"visualIndex",0),Sa(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(sf))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(af)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(sf);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(af)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class vP extends CP{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Rj(t,e,n){return e=Ej(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ej(t){var e=Tj(t,"string");return typeof e=="symbol"?e:String(e)}function Tj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _j{constructor(e){Rj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Gl(t,e,n){return e=Mj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mj(t){var e=Aj(t,"string");return typeof e=="symbol"?e:String(e)}function Aj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ic{constructor(e,n){Gl(this,"nodesPool",null),Gl(this,"nodeType",void 0),Gl(this,"rootNode",void 0),Gl(this,"table",null),Gl(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new _j(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function d0(t,e,n){return e=Oj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oj(t){var e=Ij(t,"string");return typeof e=="symbol"?e:String(e)}function Ij(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pj extends Ic{constructor(){super("TH"),d0(this,"orderViews",new WeakMap),d0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new vP(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),ua(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&_e(f,[lY(),pY(),_v(d+1),Ml(-1)]),n[d](a,f,d)}u.end()}}}class xj extends Ic{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&ei(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&_e(this.rootNode,[mI()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&_e(s,[zw(),vI(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),ua(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&_e(u,[_v(a+1+this.table.rowHeadersCount),Ml(-1),uY(),...a>=0?[mY()]:[zw()]]),r[n](l,u,n)}}}}class Hj extends Ic{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&J(r,"rowHeader")}}function Dj(t,e,n){return e=Nj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nj(t){var e=Lj(t,"string");return typeof e=="symbol"?e:String(e)}function Lj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let f0=!1;class $j extends Ic{constructor(e){super("TR",e),Dj(this,"orderView",void 0),this.orderView=new CP(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!f0&&e>1e3&&(f0=!0,vt(ft`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&_e(this.rootNode,[mI()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;_e(o,[zw(),vI(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function g0(t,e,n){return e=kj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kj(t){var e=Fj(t,"string");return typeof e=="symbol"?e:String(e)}function Fj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wj extends Ic{constructor(){super("TD"),g0(this,"orderViews",new WeakMap),g0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new vP(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=i.obtainOrderView(u);c.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const p=c.getCurrentNode(),w=this.table.renderedColumnToSource(f);if(De(p,"hide")||(p.className=""),p.removeAttribute("style"),p.removeAttribute("dir"),ua(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,w,p),this.table.isAriaEnabled()){var o,s;_e(p,[...p.hasAttribute("role")?[]:[aY()],Ml(-1),_v(w+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function ln(t,e,n){return e=Vj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vj(t){var e=Bj(t,"string");return typeof e=="symbol"?e:String(e)}function Bj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uj{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ln(this,"rootNode",void 0),ln(this,"rootDocument",void 0),ln(this,"rowHeaders",null),ln(this,"columnHeaders",null),ln(this,"colGroup",null),ln(this,"rows",null),ln(this,"cells",null),ln(this,"rowFilter",null),ln(this,"columnFilter",null),ln(this,"rowUtils",null),ln(this,"columnUtils",null),ln(this,"rowsToRender",0),ln(this,"columnsToRender",0),ln(this,"rowHeaderFunctions",[]),ln(this,"rowHeadersCount",0),ln(this,"columnHeaderFunctions",[]),ln(this,"columnHeadersCount",0),ln(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class Yj{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Uj(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new Pj,columnHeaders:new xj(n),colGroup:new Hj(r),rows:new $j(i),cells:new Wj}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function _m(t,e,n){return e=Gj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gj(t){var e=zj(t,"string");return typeof e=="symbol"?e:String(e)}function zj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jj{constructor(e,n){_m(this,"dataAccessObject",void 0),_m(this,"wtSettings",void 0),_m(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?on():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let d=Array.isArray(a)?a[c]:a;d=d??u,this.headerWidths.set(c,d)}}}}function m0(t,e,n){return e=Kj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kj(t){var e=Xj(t,"string");return typeof e=="symbol"?e:String(e)}function Xj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qj{constructor(e,n){m0(this,"dataAccessObject",void 0),m0(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function ai(t,e,n){return e=Zj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zj(t){var e=Qj(t,"string");return typeof e=="symbol"?e:String(e)}function Qj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jj{constructor(e,n,r,i,o){ai(this,"wtSettings",null),ai(this,"domBindings",void 0),ai(this,"TBODY",null),ai(this,"THEAD",null),ai(this,"COLGROUP",null),ai(this,"hasTableHeight",!0),ai(this,"hasTableWidth",!0),ai(this,"isTableVisible",!1),ai(this,"tableOffset",0),ai(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Av(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new qj(this.dataAccessObject,this.wtSettings),this.columnUtils=new jj(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Yj({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&_e(r,[Ti()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&_e(r,[Ti()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!De(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&_e(r.parentNode,[Ti()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&_e(r,[Ti()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let d=!1,f=e;if(this.isMaster&&(this.holderOffset=jt(this.holder),f=i.createRenderCalculators(f),l&&!n.getSetting("fixedColumnsStart"))){const w=r.inlineStartOverlay.getScrollPosition(),v=this.correctHeaderWidth;this.correctHeaderWidth=w!==0,v!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(d=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=jt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const w=o>0?this.getFirstRenderedRow():0,v=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new gj(w,o,c),this.columnFilter=new cj(v,s,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),y=b.skipRender!==!0}if(y){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Ri)||this.is(es))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let b;if(this.isMaster&&(b=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Ri))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const _=dt(this.hider),I=dt(this.TABLE);_!==0&&I!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Ri)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let p=!1;return this.isMaster&&(p=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(p=r.bottomOverlay.resetFixedPosition()||p),p=r.inlineStartOverlay.resetFixedPosition()||p,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),p?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),d&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=oo(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Ri))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=rs(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=RI(r),s=n.cellIndex;return ko(ta,n,this.wtRootElement)||ko(Js,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):ko(es,n,this.wtRootElement)||ko(Ri,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),ko(ta,n,this.wtRootElement)||ko(ea,n,this.wtRootElement)||ko(es,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=oo(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=oo(l):o=oo(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return dt(this.TABLE)}getHeight(){return Pt(this.TABLE)}getTotalWidth(){const e=dt(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Pt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return os(this.TABLE)}_modifyRowHeaderWidth(e){let n=wt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Il=Jj,eK="stickyRowsBottom",SP={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Hi(SP,"MIXIN_NAME",eK,{writable:!1,enumerable:!1});const yP=SP,tK="stickyColumnsStart",bP={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Hi(bP,"MIXIN_NAME",tK,{writable:!1,enumerable:!1});const Qv=bP;class Jv extends Il{constructor(e,n,r,i){super(e,n,r,i,es)}}mt(Jv,yP);mt(Jv,Qv);const nK=Jv,Js="top",Ri="bottom",ea="inline_start",ta="top_inline_start_corner",es="bottom_inline_start_corner",rK=[Js,Ri,ea,ta,es],iK=new Map([[Js,`ht_clone_${Js}`],[Ri,`ht_clone_${Ri}`],[ea,`ht_clone_${ea} ht_clone_left`],[ta,`ht_clone_${ta} ht_clone_top_left_corner`],[es,`ht_clone_${es} ht_clone_bottom_left_corner`]]);function Mm(t,e,n){return e=oK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oK(t){var e=sK(t,"string");return typeof e=="symbol"?e:String(e)}function sK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aK{constructor(e){Mm(this,"dataAccessObject",void 0),Mm(this,"lastScrolledColumnPos",-1),Mm(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?d=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(d=c.scrollTo(e,l?e>a:n)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=d.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(f=d.scrollTo(e,l?e>a:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=jt(n.wtRootElement),u=oo(n.hider),c=oo(s),d=ic(s,s);if(l.top+u-c<=d){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let p=i;p>0;p--)if(f+=e.sumCellSizes(p-1,p),l.top+u-f<=d){a=p;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=jt(n.wtRootElement),l=ic(o,o);if(a.top>l){const u=oo(o);let c=r.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(c+=e.sumCellSizes(d-1,d),a.top+c-l>=u){s=d-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=jt(n.wtRootElement),l=Lu(n.hider),u=Lu(o),c=Math.abs(qd(o,o));if(a.left+l-u<=c){let d=r.getRowHeaderWidth();for(let f=i;f>0;f--)if(d+=e.sumCellSizes(f-1,f),a.left+l-d<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const d=r.TABLE.getBoundingClientRect(),p=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(d.right-p)}else u=jt(r.wtRootElement).left;const c=Math.abs(qd(s,s));if(u>c){const d=Lu(s);let f=i.getRowHeaderWidth();for(let p=1;p<=o;p++)if(f+=n.sumCellSizes(p-1,p),u+f-c>=d){a=p-2;break}}}return a}}const lK=aK;function Dr(t,e,n){return e=uK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:String(e)}function cK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eS{get eventManager(){return new gr(this)}constructor(e,n){Dr(this,"wtTable",void 0),Dr(this,"wtScroll",void 0),Dr(this,"wtViewport",void 0),Dr(this,"wtOverlays",void 0),Dr(this,"selectionManager",void 0),Dr(this,"wtEvent",void 0),Dr(this,"guid",`wt_${bv()}`),Dr(this,"drawInterrupted",!1),Dr(this,"drawn",!1),Dr(this,"domBindings",void 0),Dr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new lK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){is(r,e[n])}])}}createCellCoords(e,n){return new of(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new qv(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function p0(t,e,n){return e=hK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hK(t){var e=dK(t,"string");return typeof e=="symbol"?e:String(e)}function dK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fK extends eS{constructor(e,n,r){super(e,n),p0(this,"cloneSource",void 0),p0(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new wP(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function gK(t,e,n){return e=mK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mK(t){var e=pK(t,"string");return typeof e=="symbol"?e:String(e)}function pK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pc{constructor(e,n,r,i,o){gK(this,"wtSettings",null),Hi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Qs(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Qs(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=oc(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){vt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,o,c,u):d=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+on())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(rK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${iK.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&_e(o,[Ti()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Js||u==="vertical"&&this.type===ea?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=oc(e.TABLE),new fK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;T([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class wK extends Pc{constructor(e,n,r,i,o,s){super(e,n,es,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new nK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else _c(n),this.repositionOverlay();let r=Pt(this.clone.wtTable.TABLE);const i=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=on(r)),i.style.bottom=`${o}px`}}const CK="calculatedColumns",RP={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Hi(RP,"MIXIN_NAME",CK,{writable:!1,enumerable:!1});const tS=RP;class nS extends Il{constructor(e,n,r,i){super(e,n,r,i,Ri)}}mt(nS,yP);mt(nS,tS);const vK=nS;function SK(t,e,n){return e=yK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yK(t){var e=bK(t,"string");return typeof e=="symbol"?e:String(e)}function bK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RK extends Pc{constructor(e,n,r,i){super(e,n,Ri,r,i),SK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new vK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=on(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(tg(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=on(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=on(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ic(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=De(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(J(s,"innerBorderBottom"),o=!a):($e(s,"innerBorderBottom"),o=a)}return o}}const EK="calculatedRows",EP={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Hi(EP,"MIXIN_NAME",EK,{writable:!1,enumerable:!1});const TP=EP;class rS extends Il{constructor(e,n,r,i){super(e,n,r,i,ea)}}mt(rS,TP);mt(rS,Qv);const TK=rS,_K="localHooks",_P={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Qd(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Hi(_P,"MIXIN_NAME",_K,{writable:!1,enumerable:!1});const ir=_P;let MP=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};mt(MP,ir);const MK=MP,AP="active-header",iS="header",oS="area",sS="focus",AK="fill",OK="row",IK="column",PK="custom-selection",aS=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var xK=uP;xK("flat");function HK(t,e){OP(t,e),e.add(t)}function w0(t,e,n){OP(t,e),e.set(t,n)}function OP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Am(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Gt(t,e){var n=IP(t,e,"get");return DK(t,n)}function DK(t,e){return e.get?e.get.call(t):e.value}function C0(t,e,n){var r=IP(t,e,"set");return NK(t,r,n),n}function IP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function NK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Nr=new WeakMap,Xn=new WeakMap,ah=new WeakSet;class LK{constructor(){HK(this,ah),w0(this,Nr,{writable:!0,value:void 0}),w0(this,Xn,{writable:!0,value:void 0})}setActiveOverlay(e){return C0(this,Xn,e),this}setActiveSelection(e){return C0(this,Nr,e),this}scan(){const e=Gt(this,Nr).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Gt(this,Nr).getCorners(),{wtTable:s}=Gt(this,Xn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const d=s.columnFilter.renderedToSource(c);if(!(d<r||d>o)){for(let f=-l;f<0;f++){if(f<n||f>i)continue;const p=f+l;let w=s.getColumnHeader(d,p);const v=Gt(this,Xn).getSetting("onBeforeHighlightingColumnHeader",d,p,{selectionType:Gt(this,Nr).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==d&&(w=s.getColumnHeader(v,p)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Gt(this,Nr).getCorners(),{wtTable:s}=Gt(this,Xn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const d=s.rowFilter.renderedToSource(c);if(!(d<n||d>i)){for(let f=-l;f<0;f++){if(f<r||f>o)continue;const p=f+l;let w=s.getRowHeader(d,p);const v=Gt(this,Xn).getSetting("onBeforeHighlightingRowHeader",d,p,{selectionType:Gt(this,Nr).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==d&&(w=s.getRowHeader(v,p)),e(w))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=Gt(this,Nr).getCorners(),{wtTable:s}=Gt(this,Xn);Am(this,ah,Om).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(Gt(this,Xn).createCellCoords(a,l)),c=Gt(this,Xn).getSetting("onAfterDrawSelection",a,l,Gt(this,Nr).settings.layerLevel);typeof c=="string"&&J(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=Gt(this,Nr).getCorners(),{wtTable:i}=Gt(this,Xn);Am(this,ah,Om).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Gt(this,Xn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Gt(this,Nr).getCorners(),{wtTable:i}=Gt(this,Xn);Am(this,ah,Om).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Gt(this,Xn).createCellCoords(o,s));e(a)}})}}function Om(t){const{wtTable:e}=Gt(this,Xn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class $K{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=aS,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Pr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),so()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ye(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ye(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:f}=this.selectionHandles.styles,p=parseInt(u.borderWidth,10),w=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();u.top=`${parseInt(r-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const _=Math.min(parseInt(i+o,10),y-w-p*2),I=Math.min(parseInt(i+o-v/4,10),y-v-p*2);d[l]=`${_}px`,f[l]=`${I}px`;const L=Math.min(parseInt(r+s,10),b-w-p*2),x=Math.min(parseInt(r+s-v/4,10),b-v-p*2);d.top=`${L}px`,f.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(d.display="none",f.display="none"):(d.display="block",f.display="block")):(u.display="none",d.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const d=n.getRenderedRowsCount();for(let R=0;R<d;R+=1){const h=n.rowFilter.renderedToSource(R);if(h>=e[0]&&h<=e[2]){o=h,u=e[0];break}}for(let R=d-1;R>=0;R-=1){const h=n.rowFilter.renderedToSource(R);if(h>=e[0]&&h<=e[2]){s=h;break}}const f=n.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const h=n.columnFilter.renderedToSource(R);if(h>=e[1]&&h<=e[3]){a=h,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const h=n.columnFilter.renderedToSource(R);if(h>=e[1]&&h<=e[3]){l=h;break}}if(o===void 0||a===void 0){this.disappear();return}let p=n.getCell(this.wot.createCellCoords(o,a));const w=o!==s||a!==l,v=w?n.getCell(this.wot.createCellCoords(s,l)):p,y=jt(p),b=w?jt(v):y,_=jt(n.TABLE),I=dt(n.TABLE),L=y.top,x=y.left,W=this.wot.wtSettings.getSetting("rtlMode");let G=0,ne=0;if(W){const R=dt(p),h=i.innerWidth-_.left-I;ne=x+R-b.left,G=i.innerWidth-x-R-h-1}else ne=b.left+dt(v)-x,G=x-_.left-1;if(this.isEntireColumnSelected(o,s)){const R=this.getDimensionsFromHeader("columns",a,l,u,_);let h=null;R&&([h,G,ne]=R),h&&(p=h)}let j=L-_.top-1,X=b.top+Pt(v)-L;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",o,s,c,_);let h=null;R&&([h,j,X]=R),h&&(p=h)}const ie=mo(p,i);parseInt(ie.borderTopWidth,10)>0&&(j+=1,X=X>0?X-1:0),parseInt(ie[W?"borderRightWidth":"borderLeftWidth"],10)>0&&(G+=1,ne=ne>0?ne-1:0);const oe=W?"right":"left";this.topStyle.top=`${j}px`,this.topStyle[oe]=`${G}px`,this.topStyle.width=`${ne}px`,this.topStyle.display="block",this.startStyle.top=`${j}px`,this.startStyle[oe]=`${G}px`,this.startStyle.height=`${X}px`,this.startStyle.display="block";const se=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${j+X-se}px`,this.bottomStyle[oe]=`${G}px`,this.bottomStyle.width=`${ne}px`,this.bottomStyle.display="block",this.endStyle.top=`${j}px`,this.endStyle[oe]=`${G+ne-se}px`,this.endStyle.height=`${X+1}px`,this.endStyle.display="block";let ve=this.settings.border.cornerVisible;ve=typeof ve=="function"?ve(this.settings.layerLevel):ve;const Pe=this.wot.getSetting("onModifyGetCellCoords",s,l);let[tt,Ne]=[s,l];if(Pe&&Array.isArray(Pe)&&([,,tt,Ne]=Pe),so()||!ve||this.isPartRange(tt,Ne))this.cornerStyle.display="none";else{this.cornerStyle.top=`${j+X+this.cornerCenterPointOffset-1}px`,this.cornerStyle[oe]=`${G+ne+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=Qs(n.TABLE);const h=R===i;h&&(R=r.documentElement);const g=parseInt(this.cornerDefaultStyle.width,10)/2,m=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const E=h?v.getBoundingClientRect().left:v.offsetLeft;let M=!1,O=0;W?(O=E-parseInt(this.cornerDefaultStyle.width,10)/2,M=O<0):(O=E+dt(v)+parseInt(this.cornerDefaultStyle.width,10)/2,M=O>=Lu(R)),M&&(this.cornerStyle[oe]=`${Math.floor(G+ne+this.cornerCenterPointOffset-g)}px`,this.cornerStyle[W?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(h?v.getBoundingClientRect().top:v.offsetTop)+Pt(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=oo(R)&&(this.cornerStyle.top=`${Math.floor(j+X+this.cornerCenterPointOffset-m)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}so()&&this.updateMultipleSelectionHandlesPosition(s,l,j,G,ne,X)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,d=null,f=null,p=null,w=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Pt(...arguments)},c="ht__selection--rows",p="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return dt(...arguments)},c="ht__selection--columns",p="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(w=l(n,y-i),v=l(r,y-i),!w||!v)return!1;const b=jt(w),_=jt(v);return w&&v&&(d=b[p]-o[p]-1,f=_[p]+u(v)-b[p]),[w,d,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?J(this[e],"hidden"):(De(this[e],"hidden")&&$e(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?J(this[e],"hidden"):$e(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",so()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const v0=$K;function kK(t,e){PP(t,e),e.add(t)}function ya(t,e,n){PP(t,e),e.set(t,n)}function PP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FK(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function qe(t,e){var n=xP(t,e,"get");return WK(t,n)}function WK(t,e){return e.get?e.get.call(t):e.value}function S0(t,e,n){var r=xP(t,e,"set");return VK(t,r,n),n}function xP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function VK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var bn=new WeakMap,er=new WeakMap,Im=new WeakMap,_u=new WeakMap,Pm=new WeakMap,ps=new WeakMap,y0=new WeakSet;class BK{constructor(e){kK(this,y0),ya(this,bn,{writable:!0,value:void 0}),ya(this,er,{writable:!0,value:void 0}),ya(this,Im,{writable:!0,value:new LK}),ya(this,_u,{writable:!0,value:new WeakMap}),ya(this,Pm,{writable:!0,value:new WeakSet}),ya(this,ps,{writable:!0,value:new Map}),S0(this,er,e)}setActiveOverlay(e){return S0(this,bn,e),qe(this,Im).setActiveOverlay(qe(this,bn)),qe(this,_u).has(qe(this,bn))||qe(this,_u).set(qe(this,bn),new Set),this}getFocusSelection(){return qe(this,er)!==null?qe(this,er).getFocus():null}getAreaSelection(){return qe(this,er)!==null?qe(this,er).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(qe(this,ps).has(e)){const r=qe(this,ps).get(e);if(r.has(qe(this,bn)))return r.get(qe(this,bn));const i=new v0(qe(this,bn),e.settings);return r.set(qe(this,bn),i),i}const n=new v0(qe(this,bn),e.settings);return qe(this,ps).set(e,new Map([[qe(this,bn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=qe(this,ps).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){qe(this,ps).get(e).forEach(n=>n.destroy()),qe(this,ps).delete(e)}render(e){if(qe(this,er)===null)return;e&&FK(this,y0,UK).call(this);const n=Array.from(qe(this,er)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;qe(this,Pm).has(s)||(qe(this,Pm).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const d=this.getBorderInstance(s);if(s.isEmpty()){d==null||d.disappear();continue}a&&qe(this,Im).setActiveSelection(s).scan().forEach(w=>{if(r.has(w)){const v=r.get(w);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(w,new Map([[a,1]]));l&&(i.has(w)||i.set(w,[]),w.nodeName==="TH"&&i.get(w).push(...l))});const f=s.getCorners();qe(this,bn).getSetting("onBeforeDrawBorders",f,c),d==null||d.appear(f)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,d]=u;return d===1?c:[c,...Array.from({length:d-1},(f,p)=>`${c}-${p+1}`)]}).flat();l.forEach(u=>qe(this,_u).get(qe(this,bn)).add(u)),J(s,l),s.nodeName==="TD"&&Array.isArray((a=qe(this,er).options)===null||a===void 0?void 0:a.cellAttributes)&&_e(s,qe(this,er).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{_e(o,[...i.get(o)])})}}function UK(){const t=qe(this,_u).get(qe(this,bn)),e=qe(this,bn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=qe(this,bn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=qe(this,er).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=qe(this,er).options.cellAttributes.map(a=>a[0])),Array.isArray((i=qe(this,er).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...qe(this,er).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)$e(o[a],n),ua(o[a],s)}),t.clear()}class YK extends Pc{constructor(e,n,r,i){super(e,n,ea,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new TK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),ng(r,`${o}px`,"0px")):(o=this.getScrollPosition(),_c(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,Ov(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=on(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=dt(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(aS.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=on(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(qd(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?$e(n,"emptyRows"):J(n,"emptyRows");let s=!1;if(i&&!r.length)J(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=De(n,"innerBorderInlineStart");e?(J(n,"innerBorderLeft innerBorderInlineStart"),s=!a):($e(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const GK="stickyRowsTop",HP={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Hi(HP,"MIXIN_NAME",GK,{writable:!1,enumerable:!1});const DP=HP;class lS extends Il{constructor(e,n,r,i){super(e,n,r,i,ta)}}mt(lS,DP);mt(lS,Qv);const zK=lS;function b0(t,e,n){return e=jK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jK(t){var e=KK(t,"string");return typeof e=="symbol"?e:String(e)}function KK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XK extends Pc{constructor(e,n,r,i,o,s){super(e,n,ta,r,i),b0(this,"topOverlay",void 0),b0(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new zK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();ng(e,`${i}px`,`${o}px`)}else _c(e);let n=Pt(this.clone.wtTable.TABLE);const r=dt(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class uS extends Il{constructor(e,n,r,i){super(e,n,r,i,Js)}}mt(uS,DP);mt(uS,tS);const qK=uS;function ZK(t,e,n){return e=QK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QK(t){var e=JK(t,"string");return typeof e=="symbol"?e:String(e)}function JK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e3 extends Pc{constructor(e,n,r,i){super(e,n,Js,r,i),ZK(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new qK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),ng(e,"0px",`${i}px`)}else i=this.getScrollPosition(),_c(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(tg(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=on(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Pt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(aS.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=on(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ic(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?$e(r,"emptyColumns"):J(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=De(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(J(r,"innerBorderTop"),o=!u):($e(r,"innerBorderTop"),o=u)}}return o}}function Fi(t,e,n){return e=t3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t3(t){var e=n3(t,"string");return typeof e=="symbol"?e:String(e)}function n3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r3{constructor(e,n,r,i,o,s){Fi(this,"wot",null),Fi(this,"topOverlay",null),Fi(this,"bottomOverlay",null),Fi(this,"inlineStartOverlay",null),Fi(this,"topInlineStartCornerOverlay",null),Fi(this,"bottomInlineStartCornerOverlay",null),Fi(this,"browserLineHeight",void 0),Fi(this,"wtSettings",null),Fi(this,"resizeObserver",new ResizeObserver(c=>{cg(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=on(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:oc(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new e3(...e),this.bottomOverlay=new RK(...e),this.inlineStartOverlay=new YK(...e),this.topInlineStartCornerOverlay=new XK(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new wK(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",d=>this.onTableScroll(d),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!Nv())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:f}=d.clone.wtTable;this.eventManager.addEventListener(f,"wheel",p=>this.onCloneWheel(p,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Ol(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=oc(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:d,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return T(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const i3=r3;function R0(t,e,n){return e=o3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o3(t){var e=s3(t,"string");return typeof e=="symbol"?e:String(e)}function s3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a3{constructor(e){R0(this,"settings",{}),R0(this,"defaults",Object.freeze(this.getDefaults())),Ye(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);is(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ye(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class cS extends Il{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Qs(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=vl(e,"height",n),o=vl(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const p=parseInt(mo(f,n).height,10);r.removeChild(f),p===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=os(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}mt(cS,TP);mt(cS,tS);const l3=cS;class u3{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Pt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,d=o-c;let f,p;if(a)return dt(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(d,o):f=Math.min(this.getContainerFillWidth(),d,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(i!==r&&(p=vl(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),p==="scroll"||p==="hidden"||p==="auto"))return Math.max(f,i.clientWidth);const w=e.getSetting("stretchH");return w==="none"||!w?Math.max(f,dt(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return jt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Pt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=dt(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ys;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===Ys?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=on(this.domBindings.rootDocument),new dP({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:d=>r.getRowHeight(d),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ys;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=on(this.domBindings.rootDocument)),new jv({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(Rn),i=this.createColumnsCalculator(Rn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Ys),this.columnsRenderCalculator=this.createColumnsCalculator(Ys)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Rn),this.columnsVisibleCalculator=this.createColumnsCalculator(Rn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ye(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const c3=u3;class h3 extends eS{constructor(e,n){super(e,new a3(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new l3(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new c3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new BK(this.wtSettings.getSetting("selections")),this.wtEvent=new wP(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new i3(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ye(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),$e(this.wtTable.wtRootElement.parentNode,n),J(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class hS{constructor(e){e instanceof eS?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new hS(n);return()=>r},this._wot=new h3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function E0(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!o.inInSelection(i),f=n||r&&d;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function d3(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const f3=new Map([["mousedown",E0],["mouseover",d3],["touchstart",E0]]);function T0(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;f3.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:ag(t)||t.type==="touchstart",isRightClick:ss(t)})}const NP=new WeakMap,dS=Symbol("rootInstance");function g3(t){NP.set(t,!0)}function m3(t){return t===dS}function bd(t){return NP.has(t)}function _0(t,e){LP(t,e),e.add(t)}function ws(t,e,n){LP(t,e),e.set(t,n)}function LP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ao(t,e,n){return e=p3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p3(t){var e=w3(t,"string");return typeof e=="symbol"?e:String(e)}function w3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function un(t,e){var n=$P(t,e,"get");return C3(t,n)}function C3(t,e){return e.get?e.get.call(t):e.value}function Cr(t,e,n){var r=$P(t,e,"set");return v3(t,r,n),n}function $P(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function v3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xm=new WeakMap,lh=new WeakMap,uh=new WeakMap,Wi=new WeakMap,Lr=new WeakMap,Hm=new WeakMap,Dm=new WeakMap,sC=new WeakSet,M0=new WeakSet;class S3{constructor(e){_0(this,M0),_0(this,sC),Ao(this,"hot",void 0),Ao(this,"eventManager",void 0),Ao(this,"settings",void 0),Ao(this,"THEAD",void 0),Ao(this,"TBODY",void 0),Ao(this,"_wt",void 0),Ao(this,"activeWt",void 0),ws(this,xm,{writable:!0,value:0}),ws(this,lh,{writable:!0,value:0}),Ao(this,"postponedAdjustElementsSize",!1),ws(this,uh,{writable:!0,value:!1}),ws(this,Wi,{writable:!0,value:void 0}),ws(this,Lr,{writable:!0,value:void 0}),ws(this,Hm,{writable:!0,value:0}),ws(this,Dm,{writable:!0,value:0}),this.hot=e,this.eventManager=new gr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),J(e,"handsontable"),Cr(this,Lr,n.createElement("TABLE")),J(un(this,Lr),"htCore"),this.hot.getSettings().tableClassName&&J(un(this,Lr),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(_e(un(this,Lr),[Ti()]),_e(e,[sY(),CI(-1),eg(this.hot.countCols()),vY()])),this.THEAD=n.createElement("THEAD"),un(this,Lr).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),un(this,Lr).appendChild(this.TBODY),this.hot.table=un(this,Lr),this.hot.container.insertBefore(un(this,Lr),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(Cr(this,uh,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;jw(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{Cr(this,uh,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{un(this,uh)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&jw(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&ag(o)&&r.finish(),Cr(this,Wi,!1);const s=rg(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!ss(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&ss(o)&&(r.finish(),Cr(this,Wi,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),Cr(this,Wi,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(un(this,Wi)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const f=on(n);if(n.elementFromPoint(a+f,l)!==c||n.elementFromPoint(a,l+f)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(un(this,Lr),"selectstart",o=>{this.settings.fragmentSelection||Zd(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:un(this,Lr),isDataViewInstance:()=>bd(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Cr(this,lh,o.length),this.hot.getSettings().ariaTags&&oC(this,sC,kP).call(this)===this.hot.countCols()&&oC(this,M0,y3).call(this,un(this,lh)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Cr(this,xm,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let d=l,f=u;Array.isArray(c)&&([d,f]=c);const p=this.hot.getCellMeta(d,f),w=this.hot.colToProp(f);let v=this.hot.getDataAtRowProp(d,w);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,p)),this.hot.runHooks("beforeRenderer",a,l,u,w,v,p),this.hot.getCellRenderer(p)(this.hot,a,l,u,w,v,p),this.hot.runHooks("afterRenderer",a,l,u,w,v,p)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&os(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Cr(this,Wi,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Bo(o)&&(T0(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,f)=>this.hot._createCellCoords(d,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Cr(this,Wi,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Bo(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Bo(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Bo(o)&&(un(this,Wi)&&T0(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,f)=>this.hot._createCellCoords(d,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Bo(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){const p=d.peekByIndex(a??0);l=[p.from.row,p.from.col,p.to.row,p.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,d=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,c,a);if(Array.isArray(f)){const[p,w,v,y]=f;return[p>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(p,1)):p,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,v>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,-1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new hS(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Zd(e))return!0;const n=Qo(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return un(this,Wi)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!De(r,"relative")){ei(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;De(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(ei(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(_e(s,...Ti()),_e(a,...Ti())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(De(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):De(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?ca(e,r(n,i)):(is(e,String.fromCharCode(160)),J(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Cr(this,Hm,e),Cr(this,Dm,n)}getLastSize(){return{width:un(this,Hm),height:un(this,Dm)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return un(this,xm)}getRowHeadersCount(){return un(this,lh)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function kP(){return parseInt(this.hot.rootElement.getAttribute(eg()[0]),10)}function y3(t){const e=oC(this,sC,kP).call(this)+t;_e(this.hot.rootElement,...eg(e))}const b3=S3,FP="ABCDEFGHIJKLMNOPQRSTUVWXYZ",aC=FP.length;function hg(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%aC,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/aC,10);return n}function R3(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=aC**r*(FP.indexOf(t[n])+1);return e-=1,e}function E3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(hg(i)+(r+1));n.push(o)}return n}function T3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=hg(i)+(r+1);n.push(o)}return n}function _3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function fS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function gS(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Be(t[0])&&(e=sg(t[0]))),e}function WP(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function VP(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const M3=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:gS,createEmptySpreadsheetData:_3,createSpreadsheetData:E3,createSpreadsheetObjectData:T3,dataRowToChangesArray:fS,isArrayOfArrays:WP,isArrayOfObjects:VP,spreadsheetColumnIndex:R3,spreadsheetColumnLabel:hg},Symbol.toStringTag,{value:"Module"}));function zl(t,e,n){return e=A3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A3(t){var e=O3(t,"string");return typeof e=="symbol"?e:String(e)}function O3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];zl(this,"hot",void 0),zl(this,"data",void 0),zl(this,"dataType","array"),zl(this,"colToProp",()=>{}),zl(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return T(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):Ce(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Be(s)||wt(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;Ce(0,u,c=>{const d=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,s);i?a.push(f):Cd(a,d,f)}})}else Ye(s,(l,u)=>{Cd(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Xr(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:Cd(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=kI(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=Xr(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return Ce(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return gS(this.data)}destroy(){this.data=null,this.hot=null}}const P3=I3;function A0(t,e,n){return e=x3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x3(t){var e=H3(t,"string");return typeof e=="symbol"?e:String(e)}function H3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ha{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;A0(this,"indexedValues",[]),A0(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,wt(this.initValueOrFn)?Ce(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):Ce(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mt(ha,ir);function mS(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>wt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function pS(t,e){return fr(t,(n,r)=>e.includes(r)===!1)}class cs extends ha{insert(e,n){this.indexedValues=mS(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=pS(this.indexedValues,e),super.remove(e)}}class dg extends cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Yt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function wS(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function lc(t,e){return fr(t,n=>e.includes(n)===!1)}function CS(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function vS(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function D3(t,e,n){return e=N3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N3(t){var e=L3(t,"string");return typeof e=="symbol"?e:String(e)}function L3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fg extends ha{constructor(){super(...arguments),D3(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=lc(this.orderOfIndexes,[e]),wt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=mS(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=vS(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=pS(this.indexedValues,e),this.orderOfIndexes=lc(this.orderOfIndexes,e),this.orderOfIndexes=CS(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class xc extends cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Yt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const O0=new Map([["indexesSequence",{getListWithInsertedItems:wS,getListWithRemovedItems:lc}],["physicallyIndexed",{getListWithInsertedItems:mS,getListWithRemovedItems:pS}]]),BP=t=>{if(O0.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return O0.get(t)};class UP extends ha{constructor(){super(e=>e)}insert(e,n){const r=vS(this.indexedValues,n);this.indexedValues=wS(r,e,n),super.insert(e,n)}remove(e){const n=lc(this.indexedValues,e);this.indexedValues=CS(n,e),super.remove(e)}}const I0=new Map([["hiding",dg],["index",ha],["linkedPhysicalIndexToValue",fg],["physicalIndexToValue",cs],["trimming",xc]]);function $3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!I0.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(I0.get(t))(e)}function k3(t,e,n){return e=F3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F3(t){var e=W3(t,"string");return typeof e=="symbol"?e:String(e)}function W3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let lC=0;class SS{constructor(){k3(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),lC+=1)}unregister(e){const n=this.collection.get(e);ce(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),lC-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ct(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}mt(SS,ir);function V3(){return lC}function Nm(t,e,n){return e=B3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B3(t){var e=U3(t,"string");return typeof e=="symbol"?e:String(e)}function U3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P0 extends SS{constructor(e,n){super(),Nm(this,"mergedValuesCache",[]),Nm(this,"aggregationFunction",void 0),Nm(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=ce(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ce(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Y3(t,e,n){G3(t,e),e.set(t,n)}function G3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z3(t,e,n){var r=YP(t,e,"set");return j3(t,r,n),n}function j3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function K3(t,e){var n=YP(t,e,"get");return X3(t,n)}function YP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function X3(t,e){return e.get?e.get.call(t):e.value}var Lm=new WeakMap;class GP{constructor(){Y3(this,Lm,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(K3(this,Lm)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){z3(this,Lm,e)}}mt(GP,ir);function x0(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function jl(t,e,n){q3(t,e),e.set(t,n)}function q3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e){var n=zP(t,e,"get");return Z3(t,n)}function Z3(t,e){return e.get?e.get.call(t):e.value}function ch(t,e,n){var r=zP(t,e,"set");return Q3(t,r,n),n}function zP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Q3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var hh=new WeakMap,Kl=new WeakMap,dh=new WeakMap,fh=new WeakMap,gh=new WeakMap;class J3{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};jl(this,hh,{writable:!0,value:new Set}),jl(this,Kl,{writable:!0,value:[]}),jl(this,dh,{writable:!0,value:[]}),jl(this,fh,{writable:!0,value:!1}),jl(this,gh,{writable:!0,value:!1}),ch(this,gh,e??!1)}createObserver(){const e=new GP;return vr(this,hh).add(e),e.addLocalHook("unsubscribe",()=>{vr(this,hh).delete(e)}),e._writeInitialChanges(x0(vr(this,Kl),vr(this,dh))),e}emit(e){let n=vr(this,dh);(!vr(this,fh)||vr(this,Kl).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(vr(this,gh)):ch(this,Kl,new Array(e.length).fill(vr(this,gh))),vr(this,fh)||(ch(this,fh,!0),n=vr(this,Kl)));const r=x0(n,e);vr(this,hh).forEach(i=>i._write(r)),ch(this,dh,e)}}function Hn(t,e,n){return e=e4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e4(t){var e=t4(t,"string");return typeof e=="symbol"?e:String(e)}function t4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uC{constructor(){Hn(this,"indexesSequence",new UP),Hn(this,"trimmingMapsCollection",new P0(e=>e.some(n=>n===!0),!1)),Hn(this,"hidingMapsCollection",new P0(e=>e.some(n=>n===!0),!1)),Hn(this,"variousMapsCollection",new SS),Hn(this,"hidingChangesObservable",new J3({initialIndexValue:!1})),Hn(this,"notTrimmedIndexesCache",[]),Hn(this,"notHiddenIndexesCache",[]),Hn(this,"isBatched",!1),Hn(this,"indexesSequenceChanged",!1),Hn(this,"indexesChangeSource",void 0),Hn(this,"trimmedIndexesChanged",!1),Hn(this,"hiddenIndexesChanged",!1),Hn(this,"renderablePhysicalIndexesCache",[]),Hn(this,"fromPhysicalToVisualIndexesCache",new Map),Hn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,$3(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof xc?this.trimmingMapsCollection.register(e,n):n instanceof dg?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ce(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ce(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ce(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ce(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=lc(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(wS(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ce(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}mt(uC,ir);function n4(t,e){return Ye(e,(n,r)=>{Ct(t[r])&&(t[r]=n)}),t}function jP(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function KP(t){ce(t)&&Wv(ft`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function r4(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:i4,getValues:o4}=ni("phraseFormatters");function s4(t,e){i4(t,e)}function a4(){return o4()}s4("pluralize",r4);const XP="ContextMenu:items",We=XP,yS=`${We}.noItems`,bS=`${We}.insertRowAbove`,RS=`${We}.insertRowBelow`,ES=`${We}.insertColumnOnTheLeft`,TS=`${We}.insertColumnOnTheRight`,_S=`${We}.removeRow`,MS=`${We}.removeColumn`,AS=`${We}.undo`,OS=`${We}.redo`,IS=`${We}.readOnly`,PS=`${We}.clearColumn`,xS=`${We}.copy`,HS=`${We}.copyWithHeaders`,DS=`${We}.copyWithGroupHeaders`,NS=`${We}.copyHeadersOnly`,LS=`${We}.cut`,$S=`${We}.freezeColumn`,kS=`${We}.unfreezeColumn`,FS=`${We}.mergeCells`,WS=`${We}.unmergeCells`,VS=`${We}.addComment`,BS=`${We}.editComment`,US=`${We}.removeComment`,YS=`${We}.readOnlyComment`,GS=`${We}.align`,zS=`${We}.align.left`,jS=`${We}.align.center`,KS=`${We}.align.right`,XS=`${We}.align.justify`,qS=`${We}.align.top`,ZS=`${We}.align.middle`,QS=`${We}.align.bottom`,JS=`${We}.borders`,ey=`${We}.borders.top`,ty=`${We}.borders.right`,ny=`${We}.borders.bottom`,ry=`${We}.borders.left`,iy=`${We}.borders.remove`,oy=`${We}.nestedHeaders.insertChildRow`,sy=`${We}.nestedHeaders.detachFromParent`,ay=`${We}.hideColumn`,ly=`${We}.showColumn`,uy=`${We}.hideRow`,cy=`${We}.showRow`,Gn="Filters:",Wt=`${Gn}conditions`,gg=`${Wt}.none`,hy=`${Wt}.isEmpty`,dy=`${Wt}.isNotEmpty`,fy=`${Wt}.isEqualTo`,gy=`${Wt}.isNotEqualTo`,my=`${Wt}.beginsWith`,py=`${Wt}.endsWith`,wy=`${Wt}.contains`,Cy=`${Wt}.doesNotContain`,l4=`${Wt}.byValue`,vy=`${Wt}.greaterThan`,Sy=`${Wt}.greaterThanOrEqualTo`,yy=`${Wt}.lessThan`,by=`${Wt}.lessThanOrEqualTo`,Ry=`${Wt}.isBetween`,Ey=`${Wt}.isNotBetween`,Ty=`${Wt}.after`,_y=`${Wt}.before`,My=`${Wt}.today`,Ay=`${Wt}.tomorrow`,Oy=`${Wt}.yesterday`,Iy=`${Gn}labels.filterByCondition`,Py=`${Gn}labels.filterByValue`,xy=`${Gn}labels.conjunction`,mg=`${Gn}labels.disjunction`,lf=`${Gn}values.blankCells`,Hy=`${Gn}buttons.selectAll`,Dy=`${Gn}buttons.clear`,Ny=`${Gn}buttons.ok`,Ly=`${Gn}buttons.cancel`,$y=`${Gn}buttons.placeholder.search`,ky=`${Gn}buttons.placeholder.value`,Fy=`${Gn}buttons.placeholder.secondValue`,Wy="CheckboxRenderer:",Vy=`${Wy}checked`,By=`${Wy}unchecked`,u4=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Vy,CHECKBOX_RENDERER_NAMESPACE:Wy,CHECKBOX_UNCHECKED:By,CONTEXTMENU_ITEMS_ADD_COMMENT:VS,CONTEXTMENU_ITEMS_ALIGNMENT:GS,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:QS,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:jS,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:XS,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:zS,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:ZS,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:KS,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:qS,CONTEXTMENU_ITEMS_BORDERS:JS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:ny,CONTEXTMENU_ITEMS_BORDERS_LEFT:ry,CONTEXTMENU_ITEMS_BORDERS_RIGHT:ty,CONTEXTMENU_ITEMS_BORDERS_TOP:ey,CONTEXTMENU_ITEMS_CLEAR_COLUMN:PS,CONTEXTMENU_ITEMS_COPY:xS,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:NS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:DS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:HS,CONTEXTMENU_ITEMS_CUT:LS,CONTEXTMENU_ITEMS_EDIT_COMMENT:BS,CONTEXTMENU_ITEMS_FREEZE_COLUMN:$S,CONTEXTMENU_ITEMS_HIDE_COLUMN:ay,CONTEXTMENU_ITEMS_HIDE_ROW:uy,CONTEXTMENU_ITEMS_INSERT_LEFT:ES,CONTEXTMENU_ITEMS_INSERT_RIGHT:TS,CONTEXTMENU_ITEMS_MERGE_CELLS:FS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:sy,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:oy,CONTEXTMENU_ITEMS_NO_ITEMS:yS,CONTEXTMENU_ITEMS_READ_ONLY:IS,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:YS,CONTEXTMENU_ITEMS_REDO:OS,CONTEXTMENU_ITEMS_REMOVE_BORDERS:iy,CONTEXTMENU_ITEMS_REMOVE_COLUMN:MS,CONTEXTMENU_ITEMS_REMOVE_COMMENT:US,CONTEXTMENU_ITEMS_REMOVE_ROW:_S,CONTEXTMENU_ITEMS_ROW_ABOVE:bS,CONTEXTMENU_ITEMS_ROW_BELOW:RS,CONTEXTMENU_ITEMS_SHOW_COLUMN:ly,CONTEXTMENU_ITEMS_SHOW_ROW:cy,CONTEXTMENU_ITEMS_UNDO:AS,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:kS,CONTEXTMENU_ITEMS_UNMERGE_CELLS:WS,CONTEXT_MENU_ITEMS_NAMESPACE:XP,FILTERS_BUTTONS_CANCEL:Ly,FILTERS_BUTTONS_CLEAR:Dy,FILTERS_BUTTONS_OK:Ny,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:$y,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Fy,FILTERS_BUTTONS_PLACEHOLDER_VALUE:ky,FILTERS_BUTTONS_SELECT_ALL:Hy,FILTERS_CONDITIONS_AFTER:Ty,FILTERS_CONDITIONS_BEFORE:_y,FILTERS_CONDITIONS_BEGINS_WITH:my,FILTERS_CONDITIONS_BETWEEN:Ry,FILTERS_CONDITIONS_BY_VALUE:l4,FILTERS_CONDITIONS_CONTAINS:wy,FILTERS_CONDITIONS_EMPTY:hy,FILTERS_CONDITIONS_ENDS_WITH:py,FILTERS_CONDITIONS_EQUAL:fy,FILTERS_CONDITIONS_GREATER_THAN:vy,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Sy,FILTERS_CONDITIONS_LESS_THAN:yy,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:by,FILTERS_CONDITIONS_NAMESPACE:Wt,FILTERS_CONDITIONS_NONE:gg,FILTERS_CONDITIONS_NOT_BETWEEN:Ey,FILTERS_CONDITIONS_NOT_CONTAIN:Cy,FILTERS_CONDITIONS_NOT_EMPTY:dy,FILTERS_CONDITIONS_NOT_EQUAL:gy,FILTERS_CONDITIONS_TODAY:My,FILTERS_CONDITIONS_TOMORROW:Ay,FILTERS_CONDITIONS_YESTERDAY:Oy,FILTERS_DIVS_FILTER_BY_CONDITION:Iy,FILTERS_DIVS_FILTER_BY_VALUE:Py,FILTERS_LABELS_CONJUNCTION:xy,FILTERS_LABELS_DISJUNCTION:mg,FILTERS_NAMESPACE:Gn,FILTERS_VALUES_BLANK_CELLS:lf},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const c4={languageCode:"en-US",[yS]:"No available options",[bS]:"Insert row above",[RS]:"Insert row below",[ES]:"Insert column left",[TS]:"Insert column right",[_S]:["Remove row","Remove rows"],[MS]:["Remove column","Remove columns"],[AS]:"Undo",[OS]:"Redo",[IS]:"Read only",[PS]:"Clear column",[GS]:"Alignment",[zS]:"Left",[jS]:"Center",[KS]:"Right",[XS]:"Justify",[qS]:"Top",[ZS]:"Middle",[QS]:"Bottom",[$S]:"Freeze column",[kS]:"Unfreeze column",[JS]:"Borders",[ey]:"Top",[ty]:"Right",[ny]:"Bottom",[ry]:"Left",[iy]:"Remove border(s)",[VS]:"Add comment",[BS]:"Edit comment",[US]:"Delete comment",[YS]:"Read-only comment",[FS]:"Merge cells",[WS]:"Unmerge cells",[xS]:"Copy",[HS]:["Copy with header","Copy with headers"],[DS]:["Copy with group header","Copy with group headers"],[NS]:["Copy header only","Copy headers only"],[LS]:"Cut",[oy]:"Insert child row",[sy]:"Detach from parent",[ay]:["Hide column","Hide columns"],[ly]:["Show column","Show columns"],[uy]:["Hide row","Hide rows"],[cy]:["Show row","Show rows"],[gg]:"None",[hy]:"Is empty",[dy]:"Is not empty",[fy]:"Is equal to",[gy]:"Is not equal to",[my]:"Begins with",[py]:"Ends with",[wy]:"Contains",[Cy]:"Does not contain",[vy]:"Greater than",[Sy]:"Greater than or equal to",[yy]:"Less than",[by]:"Less than or equal to",[Ry]:"Is between",[Ey]:"Is not between",[Ty]:"After",[_y]:"Before",[My]:"Today",[Ay]:"Tomorrow",[Oy]:"Yesterday",[lf]:"Blank cells",[Iy]:"Filter by condition",[Py]:"Filter by value",[xy]:"And",[mg]:"Or",[Hy]:"Select all",[Dy]:"Clear",[Ny]:"OK",[Ly]:"Cancel",[$y]:"Search",[ky]:"Value",[Fy]:"Second value",[Vy]:"Checked",[By]:"Unchecked"},qP=c4,h4=u4,cC=qP.languageCode,{register:d4,getItem:ZP,hasItem:f4,getValues:g4}=ni("languagesDictionaries");QP(qP);function QP(t,e){let n=t,r=e;return Be(t)&&(r=t,n=r.languageCode),m4(n,r),d4(n,Mn(r)),Mn(r)}function m4(t,e){t!==cC&&n4(e,ZP(cC))}function JP(t){return Uy(t)?Mn(ZP(t)):null}function Uy(t){return f4(t)}function p4(){return g4()}function ex(t,e,n){const r=JP(t);if(r===null)return null;const i=r[e];if(Ct(i))return null;const o=w4(i,n);return Array.isArray(o)?o[0]:o}function w4(t,e){let n=t;return T(a4(),r=>{n=r(t,e)}),n}function C4(t){let e=jP(t);return Uy(e)||(e=cC,KP(t)),e}function v4(t,e,n){return e=S4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S4(t){var e=y4(t,"string");return typeof e=="symbol"?e:String(e)}function y4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b4 extends MK{constructor(e,n){super(e,null),v4(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Eo=b4;function $m(t){let{activeHeaderClassName:e,...n}=t;return new Eo({className:e,...n,selectionType:AP})}function R4(t){let{areaCornerVisible:e,...n}=t;return new Eo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:oS})}function E4(t){let{...e}=t;return new Eo({className:"highlight",...e,selectionType:oS})}function T4(t){let{columnClassName:e,...n}=t;return new Eo({className:e,...n,selectionType:IK})}function _4(t){let{cellCornerVisible:e,...n}=t;return new Eo({className:"current",headerAttributes:[Mv()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:sS})}function M4(t){let{border:e,visualCellRange:n,...r}=t;return new Eo({...e,...r,selectionType:PK},n)}function A4(t){let{...e}=t;return new Eo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:AK})}function H0(t){let{headerClassName:e,...n}=t;return new Eo({className:e,...n,selectionType:iS})}function O4(t){let{rowClassName:e,...n}=t;return new Eo({className:e,...n,selectionType:OK})}let tx;function I4(t,e){P4(t,e),e.add(t)}function P4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(t,e,n){return e=x4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x4(t){var e=H4(t,"string");return typeof e=="symbol"?e:String(e)}function H4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var li=new WeakSet;tx=Symbol.iterator;class D4{constructor(e){I4(this,li),jn(this,"options",void 0),jn(this,"layerLevel",0),jn(this,"focus",void 0),jn(this,"fill",void 0),jn(this,"layeredAreas",new Map),jn(this,"areas",new Map),jn(this,"rowHeaders",new Map),jn(this,"columnHeaders",new Map),jn(this,"activeRowHeaders",new Map),jn(this,"activeColumnHeaders",new Map),jn(this,"activeCornerHeaders",new Map),jn(this,"rowHighlights",new Map),jn(this,"columnHighlights",new Map),jn(this,"customSelections",[]),this.options=e,this.focus=_4(e),this.fill=A4(e)}isEnabledFor(e,n){let r=e;e===sS&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Vi(this,li,Bi).call(this,this.layeredAreas,R4)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Vi(this,li,Bi).call(this,this.areas,E4)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Vi(this,li,Bi).call(this,this.rowHeaders,H0)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Vi(this,li,Bi).call(this,this.columnHeaders,H0)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Vi(this,li,Bi).call(this,this.activeRowHeaders,$m)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Vi(this,li,Bi).call(this,this.activeColumnHeaders,$m)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Vi(this,li,Bi).call(this,this.activeCornerHeaders,$m)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Vi(this,li,Bi).call(this,this.rowHighlights,O4)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Vi(this,li,Bi).call(this,this.columnHighlights,T4)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(M4({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),T(this.areas.values(),e=>void e.clear()),T(this.layeredAreas.values(),e=>void e.clear()),T(this.rowHeaders.values(),e=>void e.clear()),T(this.columnHeaders.values(),e=>void e.clear()),T(this.activeRowHeaders.values(),e=>void e.clear()),T(this.activeColumnHeaders.values(),e=>void e.clear()),T(this.activeCornerHeaders.values(),e=>void e.clear()),T(this.rowHighlights.values(),e=>void e.clear()),T(this.columnHighlights.values(),e=>void e.clear())}[tx](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Bi(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const N4=D4;let nx;function D0(t,e,n){return e=L4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L4(t){var e=$4(t,"string");return typeof e=="symbol"?e:String(e)}function $4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}nx=Symbol.iterator;class k4{constructor(e){D0(this,"ranges",[]),D0(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[nx](){return this.ranges[Symbol.iterator]()}}const F4=k4;function Xl(t,e){rx(t,e),e.add(t)}function km(t,e,n){rx(t,e),e.set(t,n)}function rx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){var n=ix(t,e,"get");return W4(t,n)}function W4(t,e){return e.get?e.get.call(t):e.value}function qn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function hC(t,e,n){var r=ix(t,e,"set");return V4(t,r,n),n}function ix(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function V4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var mh=new WeakMap,st=new WeakMap,as=new WeakMap,Fm=new WeakSet,Wm=new WeakSet,dC=new WeakSet,Vm=new WeakSet,Cs=new WeakSet;class ox{constructor(e,n){Xl(this,Cs),Xl(this,Vm),Xl(this,dC),Xl(this,Wm),Xl(this,Fm),km(this,mh,{writable:!0,value:void 0}),km(this,st,{writable:!0,value:void 0}),km(this,as,{writable:!0,value:{x:0,y:0}}),hC(this,mh,e),hC(this,st,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;qn(this,Fm,N0).call(this,{x:Je(this,st).navigableHeaders()?Je(this,st).countRowHeaders():0,y:Je(this,st).navigableHeaders()?Je(this,st).countColHeaders():0});const i=Je(this,st).createCellCoords(e,n);let o=Je(this,mh).current().highlight;const s=Je(this,st).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=qn(this,dC,sx).call(this),{row:d,col:f}=qn(this,Vm,$0).call(this,o),p=Je(this,st).fixedRowsBottom(),w=Je(this,st).minSpareRows(),v=Je(this,st).minSpareCols(),y=Je(this,st).autoWrapRow(),b=Je(this,st).autoWrapCol(),_=Je(this,st).createCellCoords(d+i.row,f+i.col);if(_.row>=c){const x=Xr(r&&w>0&&p===0),W=_.col+1,G=Je(this,st).createCellCoords(_.row-c,W>=u?W-u:W);this.runLocalHooks("beforeColumnWrap",x,qn(this,Cs,ba).call(this,G),W>=u),x.value?this.runLocalHooks("insertRowRequire",Je(this,st).countRenderableRows()):b&&_.assign(G)}else if(_.row<0){const x=Xr(b),W=_.col-1,G=Je(this,st).createCellCoords(c+_.row,W<0?u+W:W);this.runLocalHooks("beforeColumnWrap",x,qn(this,Cs,ba).call(this,G),W<0),b&&_.assign(G)}if(_.col>=u){const x=Xr(r&&v>0),W=_.row+1,G=Je(this,st).createCellCoords(W>=c?W-c:W,_.col-u);this.runLocalHooks("beforeRowWrap",x,qn(this,Cs,ba).call(this,G),W>=c),x.value?this.runLocalHooks("insertColRequire",Je(this,st).countRenderableColumns()):y&&_.assign(G)}else if(_.col<0){const x=Xr(y),W=_.row-1,G=Je(this,st).createCellCoords(W<0?c+W:W,u+_.col);this.runLocalHooks("beforeRowWrap",x,qn(this,Cs,ba).call(this,G),W<0),y&&_.assign(G)}const{rowDir:I,colDir:L}=qn(this,Wm,L0).call(this,_);a=I,l=L,o=qn(this,Cs,ba).call(this,_)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){qn(this,Fm,N0).call(this,{x:Je(this,st).navigableHeaders()?Je(this,st).countRowHeaders():0,y:Je(this,st).navigableHeaders()?Je(this,st).countColHeaders():0});const r=Je(this,st).createCellCoords(e,n),i=Je(this,mh).current(),o=Je(this,st).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=qn(this,Vm,$0).call(this,i.to),d=Je(this,st).createCellCoords(u+r.row,c+r.col),{rowDir:f,colDir:p}=qn(this,Wm,L0).call(this,d);a=f,l=p;const w=qn(this,Cs,ba).call(this,d);r.row===0&&r.col!==0?s.col=w.col:r.row!==0&&r.col===0?s.row=w.row:(s.row=w.row,s.col=w.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function N0(t){let{x:e,y:n}=t;hC(this,as,{x:e,y:n})}function L0(t){const{width:e,height:n}=qn(this,dC,sx).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function sx(){return{width:Je(this,as).x+Je(this,st).countRenderableColumns(),height:Je(this,as).y+Je(this,st).countRenderableRows()}}function $0(t){const{row:e,col:n}=Je(this,st).visualToRenderableCoords(t);return Je(this,st).createCellCoords(Je(this,as).y+e,Je(this,as).x+n)}function ba(t){const e=t.clone();return e.col=t.col-Je(this,as).x,e.row=t.row-Je(this,as).y,Je(this,st).renderableToVisualCoords(e)}mt(ox,ir);const B4=ox,pg=0,wg=1,ax=2,Yy=3,U4=[Yy,ax],Y4=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Bm=Symbol("root"),k0=Symbol("child");function yl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bm;if(e!==Bm&&e!==k0)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Bm;let i=pg;if(n){const o=t[0];t.length===0?i=wg:r&&o instanceof qv?i=Yy:r&&Array.isArray(o)?i=yl(o,k0):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Y4[l].includes(typeof a))&&(i=ax)}return i}function uc(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!U4.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Yy;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ct(u)&&(u=a),Ct(c)&&(c=l),!r){const p=a,w=l,v=u,y=c;a=Math.min(p,v),l=Math.min(w,y),u=Math.max(p,v),c=Math.max(w,y)}const d=e(a,l),f=e(u,c);return n(d,d,f)}}function G4(t){const e=yl(t.getSelected());if(e===pg||e===wg)return[];const n=uc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;T(Array.from(new Array(c),(d,f)=>u+f),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return Yt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function z4(t){const e=yl(t.getSelected());if(e===pg||e===wg)return[];const n=uc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;T(Array.from(new Array(c),(d,f)=>u+f),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return Yt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function j4(t,e,n){K4(t,e),e.set(t,n)}function K4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oo(t,e,n){return e=X4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X4(t){var e=q4(t,"string");return typeof e=="symbol"?e:String(e)}function q4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function F0(t,e,n){var r=lx(t,e,"set");return Z4(t,r,n),n}function Z4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function W0(t,e){var n=lx(t,e,"get");return Q4(t,n)}function lx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Q4(t,e){return e.get?e.get.call(t):e.value}var ql=new WeakMap;class ux{constructor(e,n){var r=this;Oo(this,"settings",void 0),Oo(this,"tableProps",void 0),Oo(this,"inProgress",!1),Oo(this,"selectedRange",new F4((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Oo(this,"highlight",void 0),Oo(this,"transformation",void 0),Oo(this,"selectedByRowHeader",new Set),Oo(this,"selectedByColumnHeader",new Set),j4(this,ql,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new N4({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Mv()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new B4(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ct(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ct(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(sS,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(T(this.highlight.getAreas(),_=>void _.clear()),T(this.highlight.getLayeredAreas(),_=>void _.clear()),T(this.highlight.getRowHeaders(),_=>void _.clear()),T(this.highlight.getColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveRowHeaders(),_=>void _.clear()),T(this.highlight.getActiveColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveCornerHeaders(),_=>void _.clear()),T(this.highlight.getRowHighlights(),_=>void _.clear()),T(this.highlight.getColumnHighlights(),_=>void _.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),p=this.highlight.createActiveRowHeader(),w=this.highlight.createActiveColumnHeader(),v=this.highlight.createActiveCornerHeader(),y=this.highlight.createRowHighlight(),b=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),d.clear(),f.clear(),p.clear(),w.clear(),v.clear(),y.clear(),b.clear(),this.highlight.isEnabledFor(oS,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const _=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(_.from).commit().syncWith(_),this.highlight.createLayeredArea().add(_.from).commit().syncWith(_),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(iS,s.highlight)){if(!s.isSingleHeader()){const L=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),x=this.tableProps.createCellCoords(s.to.row,-1),W=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),G=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(d.add(L).commit(),f.add(W).commit(),y.add(L).commit(),b.add(W).commit()):(d.add(L).add(x).commit(),f.add(W).add(G).commit(),y.add(L).add(x).commit(),b.add(W).add(G).commit())}const _=!W0(this,ql)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),I=!W0(this,ql)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());_&&p.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),I&&w.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),_&&I&&v.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Xr(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:p}=i;F0(this,ql,p),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(d=this.tableProps.createCellCoords(rr(f.row,u,o-1),rr(f.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,d),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),F0(this,ql,!1)}selectCells(e){var n=this;const r=yl(e);if(r===wg)return!1;if(r===pg)throw new Error(ft`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=uc(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),T(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const p=l===0?0:rr(r,u,-1),w=s-1,v=this.tableProps.createCellCoords(p,i),y=this.tableProps.createCellCoords(w,o),b=this.tableProps.createCellCoords(rr(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",v,y,b),v.row=p,y.row=w,this.setRangeStartOnly(v,void 0,b),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectColumns",v,y,b),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const d=s===0?0:rr(r,a,-1),f=o-1,p=this.tableProps.createCellCoords(e,d),w=this.tableProps.createCellCoords(n,f),v=this.tableProps.createCellCoords(e,rr(r,a,o-1));this.runLocalHooks("beforeSelectRows",p,w,v),p.col=d,w.col=f,this.setRangeStartOnly(p,void 0,v),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",p,w,v),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),p=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),f.commit(),p.commit()}this.highlight.useLayerLevel(r)}}mt(ux,ir);const J4=ux,V0=/^(\r\n|\n\r|\r|\n)/,e6=/^[^\t\r\n]+/,B0=/^\t/;function t6(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(B0))t=t.replace(B0,""),n+=1,e[r][n]="";else if(t.match(V0))t=t.replace(V0,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(e6);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function $u(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function vs(t,e,n){return e=n6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n6(t){var e=r6(t,"string");return typeof e=="symbol"?e:String(e)}function r6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cl{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){vs(this,"hot",void 0),vs(this,"metaManager",void 0),vs(this,"tableMeta",void 0),vs(this,"dataSource",void 0),vs(this,"duckSchema",void 0),vs(this,"colToPropCache",void 0),vs(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=sg(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Be(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return gS(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ye(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ce(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ce(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Sl(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;a<n&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=Mn(this.getSchema()):(w=[],Ce(d-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},Ac(w,this.getSchema())),f.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const p=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",p,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let f=this.hot.countCols(),p=0,w=c;i==="end"&&(w=Math.min(w+1,a));const v=w;for(;p<n&&f<s;){if(typeof l!="number"||l>=f)if(d>0)for(let b=0;b<d;b+=1)typeof o[b]>"u"&&(o[b]=[]),o[b].push(null);else o.push([null]);else for(let b=0;b<d;b++)o[b].splice(w,0,null);p+=1,w+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,p),p>0&&(e==null?this.metaManager.createColumn(null,p):r!=="auto"&&this.metaManager.createColumn(v,n));const y=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",y,p,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:p,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ce(this.tableMeta.columns)||ce(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((d,f)=>f-d);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let d=0;d<u;d++)l&&o[0]!==o[d]-d&&(l=!1);if(l)for(let d=0,f=this.hot.countSourceRows();d<f;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(let d=0,f=this.hot.countSourceRows();d<f;d++)for(let p=0;p<u;p++)c[d].splice(s[p],1),d===0&&this.metaManager.removeColumn(s[p],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Vw(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return cI(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Vw(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&It(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=Xr(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=Xr(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&It(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,d;for(c=0,d=l.length-1;c<d;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,cl.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===cl.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=d;o++){a=[];const p=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=f&&p!==null;s++)a.push(c.call(this,o,this.colToProp(s)));p!==null&&i.push(a)}return i}getText(e,n){return $u(this.getRange(e,n,cl.DESTINATION_RENDERER))}getCopyableText(e,n){return $u(this.getRange(e,n,cl.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const i6=cl,{register:o6,getItem:s6,hasItem:cx,getNames:a6,getValues:yae}=ni("cellTypes");function Gy(t){if(!cx(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return s6(t)}function Sr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Jn(t,n),r&&Ci(t,r),i&&ul(t,i),o6(t,e)}function l6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!It(e,t)}function Cg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Gy(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ye(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Be(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ye(r,(o,s)=>{if(l6(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Kt(t,i)}function u6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}bo(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Rd(t){return Number.isInteger(t)&&t>=0}function Ed(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function ph(t){return t==null}const hx=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),en(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),en(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),og(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function U0(t,e,n){return e=c6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c6(t){var e=h6(t,"string");return typeof e=="symbol"?e:String(e)}function h6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d6(){return class{}}class f6{constructor(e){U0(this,"metaCtor",d6()),U0(this,"meta",void 0),this.meta=this.metaCtor.prototype,Kt(this.meta,hx()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Kt(this.meta,e),Cg(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function g6(t,e,n){return e=m6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m6(t){var e=p6(t,"string");return typeof e=="symbol"?e:String(e)}function p6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class w6{constructor(e){g6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Kt(this.meta,e),Cg(this.meta,e,e)}}let dx;function wh(t,e,n){return e=C6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C6(t){var e=v6(t,"string");return typeof e=="symbol"?e:String(e)}function v6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}dx=Symbol.iterator;class uf{constructor(e){wh(this,"valueFactory",void 0),wh(this,"data",[]),wh(this,"index",[]),wh(this,"holes",new Set),this.valueFactory=e}obtain(e){Ed(()=>Rd(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ed(()=>Rd(e)||ph(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=ph(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Ed(()=>Rd(e)||ph(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(ph(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return fr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[dx](){return this.entries()}}function Y0(t,e,n){return e=S6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S6(t){var e=y6(t,"string");return typeof e=="symbol"?e:String(e)}function y6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const b6=["data","width"];class R6{constructor(e){Y0(this,"globalMeta",void 0),Y0(this,"metas",new uf(()=>this._createMeta())),this.globalMeta=e,this.metas=new uf(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Kt(r,n),Cg(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return u6(this.globalMeta.getMetaConstructor(),b6).prototype}}function G0(t,e,n){return e=E6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E6(t){var e=T6(t,"string");return typeof e=="symbol"?e:String(e)}function T6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _6{constructor(e){G0(this,"columnMeta",void 0),G0(this,"metas",new uf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Kt(i,r),Cg(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){Ed(()=>Rd(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new uf(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class fx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new f6(e),this.tableMeta=new w6(this.globalMeta),this.columnMeta=new R6(this.globalMeta),this.cellMeta=new _6(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mt(fx,ir);function z0(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,d=_n(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":wt(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${d}`,t,c,l);const p=new i6(i,t,u);if(e(p),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=p.getSchema();t=[];let v,y=0,b=0;for(y=0,b=f.startRows;y<b;y++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)v=Mn(w),t.push(v);else if(i.dataType==="array")v=Mn(w[0]),t.push(v);else{v=[];for(let _=0,I=f.startCols;_<I;_++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,p.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=p.colToProp.bind(p),s.propToCol=p.propToCol.bind(p),s.countCachedColumns=p.countCachedColumns.bind(p),n(p),i.runHooks(`after${d}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&_e(i.rootElement,[CI(-1),eg(i.countCols()+(i.view?i.countRowHeaders():0))])}function j0(t,e,n){return e=M6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M6(t){var e=A6(t,"string");return typeof e=="symbol"?e:String(e)}function A6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O6{constructor(e){j0(this,"metaManager",void 0),j0(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),ge.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=It(e,"type")?e.type:null;let c=wt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var d;c.type=(d=c.type)!==null&&d!==void 0?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Um(t,e,n){return e=I6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I6(t){var e=P6(t,"string");return typeof e=="symbol"?e:String(e)}function P6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x6{constructor(e){Um(this,"metaManager",void 0),Um(this,"usageTracker",new Set),Um(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const gx="gridDefault",zy="editorManager.handlingEditor",H6={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},D6={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},N6={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},L6={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Pr(e))}};function $6(){return[H6,D6,N6,L6]}const k6={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},F6={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},W6={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},V6={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},B6={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},U6={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},Y6={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},G6={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},z6={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},j6={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},K6={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},X6={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},q6={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Z6={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Q6(){return[k6,F6,W6,V6,B6,U6,Y6,G6,z6,j6,K6,X6,q6,Z6]}const J6={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},e9={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},t9={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},n9={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},r9={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},i9={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},o9={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},s9={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},a9={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},l9={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},u9={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},c9={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},h9={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},d9={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},f9={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},g9={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function m9(){return[J6,e9,t9,n9,r9,i9,o9,s9,a9,l9,u9,c9,h9,d9,f9,g9]}const p9={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},w9={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},C9={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},v9={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},S9={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},y9=[...$6(),...Q6(),...m9(),p9,w9,C9,v9,S9];function mx(t){const e={};return y9.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function b9(t){const e=t.getShortcutManager().addContext("editor"),n=mx(t),r={group:zy};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function R9(t){const e=t.getShortcutManager().addContext("grid"),n=mx(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ce(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:gx};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:zy,runOnlyIf:()=>ce(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function E9(t){[b9,R9].forEach(e=>e(t))}function T9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=K0(t),i=K0(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function K0(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&_e(n,[Ti(),yo()]),n}function _9(t){let e;const{activate:n,deactivate:r}=T9(t,{onFocusFromTop(){var u;const c=(u=e)!==null&&u!==void 0?u:X0(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_above",c),t.selectCell(c.row,c.col)),t.listen()},onFocusFromBottom(){var u;const c=(u=e)!==null&&u!==void 0?u:q0(t);c&&(t.runHooks("modifyFocusOnTabNavigation","from_below",c),t.selectCell(c.row,c.col)),t.listen()}}),i={wrapped:!1,flipped:!1};let o=!0,s=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(u,c,d,f,p)=>{if(s&&i.wrapped&&i.flipped&&(p.value=!0),o){var w;e=(w=t.getSelectedRangeLast())===null||w===void 0?void 0:w.highlight}}),t.addHook("beforeRowWrap",(u,c,d)=>{i.wrapped=!0,i.flipped=d});function a(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}const l={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:gx,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...l,callback:()=>{s=!0,t.getSelectedRangeLast()&&!t.getSettings().tabNavigation&&(o=!1)},position:"before"},{...l,callback:u=>{const{tabNavigation:c,autoWrapRow:d}=t.getSettings();if(s=!1,o=!0,!c||!t.selection.isSelected()||d&&i.wrapped&&i.flipped||!d&&i.wrapped)return d&&i.wrapped&&i.flipped&&(e=u.shiftKey?X0(t):q0(t)),a(),!1;u.preventDefault()},position:"after"}])}function X0(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function q0(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const Z0=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Ch=t=>t.map(e=>{const n=e.toLowerCase();return Z0.has(n)?Z0.get(n):n}).sort().join("+"),M9=t=>t.split("+"),Q0=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),A9=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),Ym=t=>{let{key:e,code:n}=t,r=e;return Q0.test(n)?r=n.replace(Q0,"$1"):A9.has(n)&&(r=n),r.toLowerCase()},px=Symbol("shortcut-context");function wx(t){return Be(t)&&t.__kindOf===px}const O9=t=>{const e=ug({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:p=!0,stopPropagation:w=!1,relativeToGroup:v,position:y,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ct(c))throw new Error("You need to define the shortcut's group.");if(wt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ft`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:u,group:c,runOnlyIf:d,captureCtrl:f,preventDefault:p,stopPropagation:w};ce(v)&&([_.relativeToGroup,_.position]=[v,y]),wx(b)&&(_.forwardToContext=b),l.forEach(I=>{const L=Ch(I);if(e.hasItem(L)){const W=e.getItem(L);let G=W.findIndex(ne=>ne.group===v);G!==-1?y==="before"?G-=1:G+=1:G=W.length,W.splice(G,0,_)}else e.addItem(L,[_])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ye(u,(d,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},i=l=>{const u=Ch(l);e.removeItem(u)};return{__kindOf:px,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Ch(l),c=e.getItem(u);return ce(c)?c.slice():[]},hasShortcut:l=>{const u=Ch(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[d,f]=c;const p=f.filter(w=>w.group!==l);p.length===0?i(M9(d)):(f.length=0,f.push(...p))})}}};function I9(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const P9=["meta","alt","shift","control"],Zl=I9();let vh=0;function x9(t,e,n,r,i){const o=p=>P9.includes(p),s=function(p){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return p.altKey&&v.push("alt"),w&&(p.ctrlKey||p.metaKey)?v.push("control/meta"):(p.ctrlKey&&v.push("control"),p.metaKey&&v.push("meta")),p.shiftKey&&v.push("shift"),v},a=p=>{if(e(p)===!1)return;const w=n(p);if(p.keyCode===229||w===!1||Bo(p))return;const v=Ym(p);let y=[];o(v)||(y=s(p));const b=[v].concat(y);!i(p,b)&&(sc()&&y.includes("meta")||!sc()&&y.includes("control"))&&i(p,[v].concat(s(p,!0))),r(p)},l=p=>{const w=Ym(p);o(w)&&Zl.press(w)},u=p=>{const w=Ym(p);o(w)&&Zl.release(w)},c=()=>{Zl.releaseAll()};return{mount:()=>{let p=t;for(vh+=1;p;)vh===1&&(p.document.documentElement.addEventListener("keydown",l),p.document.documentElement.addEventListener("keyup",u)),p.document.documentElement.addEventListener("keydown",a),p.document.documentElement.addEventListener("blur",c),p=rc(p)},unmount:()=>{let p=t;for(vh-=1;p;)vh===0&&(p.document.documentElement.removeEventListener("keydown",l),p.document.documentElement.removeEventListener("keyup",u)),p.document.documentElement.removeEventListener("keydown",a),p.document.documentElement.removeEventListener("blur",c),p=rc(p)},isPressed:p=>Zl.isPressed(p),releasePressedKeys:()=>Zl.releaseAll()}}const H9=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=ug({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const v=O9(w);return o.addItem(w,v),v},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(ft`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let d=!1;const f=function(w,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=wx(y)?y:u(y);let _=!1;if(!b.hasShortcut(v))return _;const I=b.getShortcuts(v);for(let L=0;L<I.length;L++){const{callback:x,runOnlyIf:W,preventDefault:G,stopPropagation:ne,captureCtrl:j,forwardToContext:X}=I[L];if(W(w)===!0){if(d=j,_=x(w,v)===!1,d=!1,G&&w.preventDefault(),ne&&(Pr(w),w.stopPropagation()),_)break;X&&f(w,v,X)}}return _},p=x9(e,n,r,i,f);return p.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!d&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}};let Gm=null;const zm=new Map;function Cx(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new gr(s);let l,u,c,d,f,p=!0;m3(i)&&g3(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=C4(e.language);const y=new fx(s,e,[O6,x6]),b=y.getTableMeta(),_=y.getGlobalMeta(),I=ug();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),bd(this)&&gI(e.licenseKey,t),this.guid=`ht_${bv()}`,zm.set(this.guid,this),this.columnIndexMapper=new uC,this.rowIndexMapper=new uC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterRowSequenceChange",h)}),u=new P3(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const L=h=>{const{row:g,col:m}=h;return s._createCellCoords(g>=0?s.rowIndexMapper.getRenderableFromVisualIndex(g):g,m>=0?s.columnIndexMapper.getRenderableFromVisualIndex(m):m)},x=h=>{const{row:g,col:m}=h;return s._createCellCoords(g>=0?s.rowIndexMapper.getVisualFromRenderableIndex(g):g,m>=0?s.columnIndexMapper.getVisualFromRenderableIndex(m):m)};let W=new J4(b,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:h=>l.propToCol(h),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(h,g)=>s._createCellCoords(h,g),createCellRange:(h,g,m)=>s._createCellRange(h,g,m),visualToRenderableCoords:L,renderableToVisualCoords:x,isDisabledCellSelection:(h,g)=>h<0||g<0?s.getSettings().disableVisualSelection:s.getCellMeta(h,g).disableVisualSelection});this.selection=W;const G=h=>{let{hiddenIndexesChanged:g}=h;g&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",G),this.rowIndexMapper.addLocalHook("cacheUpdated",G),this.selection.addLocalHook("afterSetRangeEnd",h=>{const g=Xr(!1),m=this.selection.getSelectedRange(),{from:E,to:M}=m.current(),O=m.size()-1;this.runHooks("afterSelection",E.row,E.col,M.row,M.col,g,O),this.runHooks("afterSelectionByProp",E.row,s.colToProp(E.col),M.row,s.colToProp(M.col),g,O);let Y=!0;o&&(Y=!1),g.isTouched()&&(Y=!g.value);const B=this.selection.selectedRange.current(),q=this.selection.isSelectedByAnyHeader(),Q=this.selection.isSelectedByRowHeader(),K=this.selection.isSelectedByColumnHeader();if(Y!==!1)if(q)Q?this.scrollViewportTo({row:h.row}):K&&this.scrollViewportTo({col:h.col});else if(B&&!this.selection.isMultiple()){const{row:de,col:Ae}=B.from;de<0&&Ae>=0?this.scrollViewportTo({col:Ae}):Ae<0&&de>=0?this.scrollViewportTo({row:de}):this.scrollViewportTo({row:de,col:Ae})}else this.scrollViewportTo(h.toObject());Q&&K?J(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Q?($e(this.rootElement,"ht__selection--columns"),J(this.rootElement,"ht__selection--rows")):K?($e(this.rootElement,"ht__selection--rows"),J(this.rootElement,"ht__selection--columns")):$e(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",h=>{const g=h.length-1,{from:m,to:E}=h[g];this.runHooks("afterSelectionEnd",m.row,m.col,E.row,E.col,g),this.runHooks("afterSelectionEndByProp",m.row,s.colToProp(m.col),E.row,s.colToProp(E.col),g)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const g=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=g)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),$e(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSetRangeStart",...g)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSetRangeStartOnly",...g)}).addLocalHook("beforeSetRangeEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSetRangeEnd",...g)}).addLocalHook("beforeSelectColumns",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSelectColumns",...g)}).addLocalHook("afterSelectColumns",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("afterSelectColumns",...g)}).addLocalHook("beforeSelectRows",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeSelectRows",...g)}).addLocalHook("afterSelectRows",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("afterSelectRows",...g)}).addLocalHook("beforeModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("modifyTransformStart",...g)}).addLocalHook("afterModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("afterModifyTransformStart",...g)}).addLocalHook("beforeModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("modifyTransformEnd",...g)}).addLocalHook("afterModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("afterModifyTransformEnd",...g)}).addLocalHook("beforeRowWrap",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeRowWrap",...g)}).addLocalHook("beforeColumnWrap",function(){for(var h=arguments.length,g=new Array(h),m=0;m<h;m++)g[m]=arguments[m];return r.runHooks("beforeColumnWrap",...g)}).addLocalHook("insertRowRequire",h=>this.alter("insert_row_above",h,1,"auto")).addLocalHook("insertColRequire",h=>this.alter("insert_col_start",h,1,"auto")),c={alter(h,g){var m,E;let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=arguments.length>3?arguments[3]:void 0,Y=arguments.length>4?arguments[4]:void 0;const B=q=>{if(q.length===0)return[];const Q=[...q];return Q.sort((de,Ae)=>{let[Ee]=de,[Oe]=Ae;return Ee===Oe?0:Ee>Oe?1:-1}),Yt(Q,(de,Ae)=>{let[Ee,Oe]=Ae;const z=de[de.length-1],[je,ke]=z,ye=je+ke;if(Ee<=ye){const He=Math.max(Oe-(ye-Ee),0);z[1]+=He}else de.push([Ee,Oe]);return de},[Q[0]])};switch(h){case"insert_row_below":case"insert_row_above":const q=s.countSourceRows();if(b.maxRows===q)return;const Q=h==="insert_row_below"?"below":"above";g=(m=g)!==null&&m!==void 0?m:Q==="below"?q:0;const{delta:K,startPhysicalIndex:de}=l.createRow(g,M,{source:O,mode:Q});if(K){const ke=W.selectedRange.current(),ye=ke==null?void 0:ke.from,He=ye==null?void 0:ye.row,Re=s.toVisualRow(de);if(W.isSelectedByCorner())W.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ce(He)&&He>=Re){const{row:C,col:S}=ke.to;let A=ye.col;W.isSelectedByRowHeader()&&(A=-1),W.getSelectedRange().pop(),W.setRangeStartOnly(s._createCellCoords(He+K,A),!0),W.setRangeEnd(s._createCellCoords(C+K,S))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Ae=h==="insert_col_end"?"end":"start";g=(E=g)!==null&&E!==void 0?E:Ae==="end"?s.countSourceCols():0;const{delta:Ee,startPhysicalIndex:Oe}=l.createCol(g,M,{source:O,mode:Ae});if(Ee){if(Array.isArray(b.colHeaders)){const C=[s.toVisualColumn(Oe),0];C.length+=Ee,Array.prototype.splice.apply(b.colHeaders,C)}const ke=W.selectedRange.current(),ye=ke==null?void 0:ke.from,He=ye==null?void 0:ye.col,Re=s.toVisualColumn(Oe);if(W.isSelectedByCorner())W.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ce(He)&&He>=Re){const{row:C,col:S}=ke.to;let A=ye.row;W.isSelectedByColumnHeader()&&(A=-1),W.getSelectedRange().pop(),W.setRangeStartOnly(s._createCellCoords(A,He+Ee),!0),W.setRangeEnd(s._createCellCoords(C,S+Ee))}else s._refreshBorders()}break;case"remove_row":const z=ke=>{let ye=0;T(ke,He=>{let[Re,C]=He;const S=en(Re)?s.countRows()-1:Math.max(Re-ye,0);if(Number.isInteger(Re)&&(Re=Math.max(Re-ye,0)),!l.removeRow(Re,C,O))return;const F=s.countRows(),P=b.fixedRowsTop;P>=S+1&&(b.fixedRowsTop-=Math.min(C,P-S));const k=b.fixedRowsBottom;k&&S>=F-k&&(b.fixedRowsBottom-=Math.min(C,k)),ye+=C})};Array.isArray(g)?z(B(g)):z([[g,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const je=ke=>{let ye=0;T(ke,He=>{let[Re,C]=He;const S=en(Re)?s.countCols()-1:Math.max(Re-ye,0);let A=s.toPhysicalColumn(S);if(Number.isInteger(Re)&&(Re=Math.max(Re-ye,0)),!l.removeCol(Re,C,O))return;const P=b.fixedColumnsStart;P>=S+1&&(b.fixedColumnsStart-=Math.min(C,P-S)),Array.isArray(b.colHeaders)&&(typeof A>"u"&&(A=-1),b.colHeaders.splice(A,C)),ye+=C})};Array.isArray(g)?je(B(g)):je([[g,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${h}"`)}Y||c.adjustRowsAndCols()},adjustRowsAndCols(){const h=b.minRows,g=b.minSpareRows,m=b.minCols,E=b.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&W.deselect(),h){const M=s.countRows();M<h&&l.createRow(M,h-M,{source:"auto"})}if(g){const M=s.countEmptyRows(!0);if(M<g){const O=g-M,Y=Math.min(O,b.maxRows-s.countSourceRows());l.createRow(s.countRows(),Y,{source:"auto"})}}{let M;(m||E)&&(M=s.countEmptyCols(!0));let O=s.countCols();if(m&&!b.columns&&O<m){const Y=m-O;M+=Y,l.createCol(O,Y,{source:"auto"})}if(E&&!b.columns&&s.dataType==="array"&&M<E){O=s.countCols();const Y=E-M,B=Math.min(Y,b.maxCols-O);l.createCol(O,B,{source:"auto"})}}if(W.isSelected()){const M=s.countRows(),O=s.countCols();T(W.selectedRange,Y=>{let B=!1,q=Y.from.row,Q=Y.from.col,K=Y.to.row,de=Y.to.col;q>M-1?(q=M-1,B=!0,K>q&&(K=q)):K>M-1&&(K=M-1,B=!0,q>K&&(q=K)),Q>O-1?(Q=O-1,B=!0,de>Q&&(de=Q)):de>O-1&&(de=O-1,B=!0,Q>de&&(Q=de)),B&&s.selectCell(q,Q,K,de)})}s.view&&s.view.adjustElementsSize()},populateFromArray(h,g,m,E,M){let O,Y,B,q;const Q=[],K={},de=[],Ae=h.row,Ee=h.col;if(Y=g.length,Y===0)return!1;let Oe=0,z=0;switch(Be(m)&&(Oe=m.col-Ee+1,z=m.row-Ae+1),M){case"shift_down":const je=Hu(g),ke=je.length,ye=Math.max(ke,Oe),He=s.getData().slice(Ae),Re=Hu(He).slice(Ee,Ee+ye);for(B=0;B<ye;B+=1)if(B<ke){for(O=0,Y=je[B].length;O<z-Y;O+=1)je[B].push(je[B][O%Y]);B<Re.length?de.push(je[B].concat(Re[B])):de.push(je[B].concat(new Array(He.length).fill(null)))}else de.push(je[B%ke].concat(Re[B]));s.populateFromArray(Ae,Ee,Hu(de));break;case"shift_right":const C=g.length,S=Math.max(C,z),A=s.getData().slice(Ae).map(U=>U.slice(Ee));for(O=0;O<S;O+=1)if(O<C){for(B=0,q=g[O].length;B<Oe-q;B+=1)g[O].push(g[O][B%q]);if(O<A.length)for(let U=0;U<A[O].length;U+=1)g[O].push(A[O][U]);else g[O].push(...new Array(A[0].length).fill(null))}else g.push(g[O%Y].slice(0,S).concat(A[O]));s.populateFromArray(Ae,Ee,g);break;case"overwrite":default:K.row=h.row,K.col=h.col;let F=0,P=0,k=!0,H;const D=function(re){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const be=g[re%g.length];return fe!==null?be[fe%be.length]:be},V=g.length,$=m?m.row-h.row+1:0;for(m?Y=$:Y=Math.max(V,$),O=0;O<Y&&!(m&&K.row>m.row&&$>V||!b.allowInsertRow&&K.row>s.countRows()-1||K.row>=b.maxRows);O++){const U=O-F,re=D(U).length,fe=m?m.col-h.col+1:0;if(m?q=fe:q=Math.max(re,fe),K.col=h.col,H=s.getCellMeta(K.row,K.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&H.skipRowOnPaste){F+=1,K.row+=1,Y+=1;continue}for(P=0,B=0;B<q&&!(m&&K.col>m.col&&fe>re||!b.allowInsertColumn&&K.col>s.countCols()-1||K.col>=b.maxCols);B++){if(H=s.getCellMeta(K.row,K.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&H.skipColumnOnPaste){P+=1,K.col+=1,q+=1;continue}if(H.readOnly&&E!=="UndoRedo.undo"){K.col+=1;continue}const be=B-P;let xe=D(U,be),Ve=s.getDataAtCell(K.row,K.col);if(xe!==null&&typeof xe=="object")if(Array.isArray(xe)&&Ve===null&&(Ve=[]),Ve===null||typeof Ve!="object")k=!1;else{const St=Sl(Array.isArray(Ve)?Ve:Ve[0]||Ve),Ze=Sl(Array.isArray(xe)?xe:xe[0]||xe);og(St,Ze)||Array.isArray(St)&&Array.isArray(Ze)?xe=Mn(xe):k=!1}else Ve!==null&&typeof Ve=="object"&&(k=!1);k&&Q.push([K.row,K.col,xe]),k=!0,K.col+=1}K.row+=1}s.setDataAtCell(Q,null,null,E||"populateFromArray");break}}};function ne(h){const g=jP(h);Uy(g)?(s.runHooks("beforeLanguageChange",g),_.language=g,s.runHooks("afterLanguageChange",g)):KP(h)}function j(h,g){const m=h==="className"?s.rootElement:s.table;if(p)J(m,g);else{let E=[],M=[];_[h]&&(E=Array.isArray(_[h])?_[h]:Uw(_[h])),g&&(M=Array.isArray(g)?g:Uw(g));const O=Bw(E,M),Y=Bw(M,E);O.length&&$e(m,O),Y.length&&J(m,Y)}_[h]=g}this.init=function(){u.setData(b.data),s.runHooks("beforeInit"),(so()||kv())&&J(s.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new b3(this),d=PG.getInstance(s,b,W),f=new DG(s),bd(this)&&_9(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),p&&s.rootElement.offsetParent===null&&II(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof p=="object"&&(s.runHooks("afterChange",p[0],p[1]),p=!1),s.runHooks("afterInit")};function X(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function ie(h){const g=h.replace(",",".");return isNaN(parseFloat(g))===!1?parseFloat(g):h}function oe(h,g,m){if(!h.length)return;const E=s.getActiveEditor(),M=new X;let O=!0;M.onQueueEmpty=Y=>{E&&O&&E.cancelChanges(),m(Y)};for(let Y=h.length-1;Y>=0;Y--){const[B,q,,Q]=h[Y],K=l.propToCol(q),de=s.getCellMeta(B,K);de.type==="numeric"&&typeof Q=="string"&&tP(Q)&&(h[Y][3]=ie(Q)),s.getCellValidator(de)&&(M.addValidatorToQueue(),s.validateCell(h[Y][3],de,function(Ae,Ee){return function(Oe){if(typeof Oe!="boolean")throw new Error("Validation error: result is not boolean");if(Oe===!1&&Ee.allowInvalid===!1){O=!1,h.splice(Ae,1),Ee.valid=!0;const z=s.getCell(Ee.visualRow,Ee.visualCol);z!==null&&$e(z,b.invalidCellClassName)}M.removeValidatorFormQueue()}}(Y,de),g))}M.checkIfQueueIsEmpty()}function se(h,g){let m=h.length-1;if(m<0)return;for(;m>=0;m--){let M=!1;if(h[m]===null){h.splice(m,1);continue}if(!((h[m][2]===null||h[m][2]===void 0)&&(h[m][3]===null||h[m][3]===void 0))){if(b.allowInsertRow)for(;h[m][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:g});if(O===0){M=!0;break}}if(s.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;l.propToCol(h[m][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:g});if(O===0){M=!0;break}}M||l.set(h[m][0],h[m][1],h[m][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",h,g),d.lockEditor(),s._refreshBorders(null),d.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",h,g||"edit");const E=s.getActiveEditor();E&&ce(E.refreshValue)&&E.refreshValue()}this._createCellCoords=function(h,g){return s.view._wt.createCellCoords(h,g)},this._createCellRange=function(h,g,m){return s.view._wt.createCellRange(h,g,m)},this.validateCell=function(h,g,m,E){let M=s.getCellValidator(g);function O(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||g.hidden===!0){m(Y);return}const q=g.visualCol,Q=g.visualRow,K=s.getCell(Q,q,!0);if(K&&K.nodeName!=="TH"){const de=s.rowIndexMapper.getRenderableFromVisualIndex(Q),Ae=s.columnIndexMapper.getRenderableFromVisualIndex(q);s.view._wt.getSetting("cellRenderer",de,Ae,K)}m(Y)}fI(M)&&(M=function(Y){return function(B,q){q(Y.test(B))}}(M)),wt(M)?(h=s.runHooks("beforeValidate",h,g.visualRow,g.prop,E),s._registerImmediate(()=>{M.call(g,h,Y=>{s&&(Y=s.runHooks("afterValidate",Y,h,g.visualRow,g.prop,E),g.valid=Y,O(Y),s.runHooks("postAfterValidate",Y,h,g.visualRow,g.prop,E))})})):s._registerImmediate(()=>{g.valid=!0,O(g.valid,!1)})};function ve(h,g,m){return Array.isArray(h)?h:[[h,g,m]]}function Pe(h,g){const m=s.getActiveEditor(),E=s.runHooks("beforeChange",h,g||"edit"),M=h.filter(O=>O!==null);return E===!1||M.length===0?(m&&m.cancelChanges(),[]):M}this.setDataAtCell=function(h,g,m,E){const M=ve(h,g,m),O=[];let Y=E,B,q,Q;for(B=0,q=M.length;B<q;B++){if(typeof M[B]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M[B][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M[B][1]>=this.countCols()?Q=M[B][1]:Q=l.colToProp(M[B][1]),O.push([M[B][0],Q,u.getAtCell(this.toPhysicalRow(M[B][0]),M[B][1]),M[B][2]])}!Y&&typeof h=="object"&&(Y=g);const K=Pe(O,E);s.runHooks("afterSetDataAtCell",K,Y),oe(K,Y,()=>{se(K,Y)})},this.setDataAtRowProp=function(h,g,m,E){const M=ve(h,g,m),O=[];let Y=E,B,q;for(B=0,q=M.length;B<q;B++)O.push([M[B][0],M[B][1],u.getAtCell(this.toPhysicalRow(M[B][0]),M[B][1]),M[B][2]]);!Y&&typeof h=="object"&&(Y=g);const Q=Pe(O,E);s.runHooks("afterSetDataAtRowProp",Q,Y),oe(Q,Y,()=>{se(Q,Y)})},this.listen=function(){s&&!s.isListening()&&(zm.forEach(h=>{s!==h&&h.unlisten()}),Gm=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Gm=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Gm===s.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(h,g)},this.populateFromArray=function(h,g,m,E,M,O,Y){if(!(typeof m=="object"&&typeof m[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const B=typeof E=="number"?s._createCellCoords(E,M):null;return c.populateFromArray(s._createCellCoords(h,g),m,B,O,Y)},this.spliceCol=function(h,g,m){for(var E=arguments.length,M=new Array(E>3?E-3:0),O=3;O<E;O++)M[O-3]=arguments[O];return l.spliceCol(h,g,m,...M)},this.spliceRow=function(h,g,m){for(var E=arguments.length,M=new Array(E>3?E-3:0),O=3;O<E;O++)M[O-3]=arguments[O];return l.spliceRow(h,g,m,...M)},this.getSelected=function(){if(W.isSelected())return Ue(W.getSelectedRange(),h=>{let{from:g,to:m}=h;return[g.row,g.col,m.row,m.col]})},this.getSelectedLast=function(){const h=this.getSelected();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.getSelectedRange=function(){if(W.isSelected())return Array.from(W.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.emptySelectedCells=function(h){if(!W.isSelected()||this.countRows()===0||this.countCols()===0)return;const g=[];T(W.getSelectedRange(),m=>{if(m.isSingleHeader())return;const E=m.getTopStartCorner(),M=m.getBottomEndCorner();Ce(E.row,M.row,O=>{Ce(E.col,M.col,Y=>{this.getCellMeta(O,Y).readOnly||g.push([O,Y,null])})})}),g.length>0&&this.setDataAtCell(g,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(h){this.suspendRender();const g=h();return this.resumeRender(),g},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const g=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(g,0),(!this.isExecutionSuspended()&&g===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const m=h();return this.resumeExecution(g),m},this.batch=function(h){this.suspendRender(),this.suspendExecution();const g=h();return this.resumeExecution(),this.resumeRender(),g},this.refreshDimensions=function(){if(!s.view)return;const{width:h,height:g}=s.view.getLastSize(),{width:m,height:E}=s.rootElement.getBoundingClientRect(),M=m!==h||E!==g;s.runHooks("beforeRefreshDimensions",{width:h,height:g},{width:m,height:E},M)!==!1&&((M||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(m,E),s.render()),s.runHooks("afterRefreshDimensions",{width:h,height:g},{width:m,height:E},M))},this.updateData=function(h,g){z0(h,m=>{l=m},m=>{l=m,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:g,metaManager:y,firstRun:p})},this.loadData=function(h,g){z0(h,m=>{l=m},()=>{y.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),p&&(p=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:g,metaManager:y,firstRun:p})},this.getInitialColumnCount=function(){const h=b.columns;let g=0;if(Array.isArray(h))g=h.length;else if(wt(h))if(s.dataType==="array"){const m=this.countSourceCols();for(let E=0;E<m;E+=1)h(E)&&(g+=1)}else(s.dataType==="object"||s.dataType==="function")&&(g=l.colToPropCache.length);else if(ce(b.dataSchema)){const m=l.getSchema();g=Array.isArray(m)?m.length:sg(m)}else g=this.countSourceCols();return g},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,g,m,E){return Ct(h)?l.getAll():l.getRange(s._createCellCoords(h,g),s._createCellCoords(m,E),l.DESTINATION_RENDERER)},this.getCopyableText=function(h,g,m,E){return l.getCopyableText(s._createCellCoords(h,g),s._createCellCoords(m,E))},this.getCopyableData=function(h,g){return l.getCopyable(h,l.colToProp(g))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=(p?s.loadData:s.updateData).bind(this);let E=!1,M,O;if(ce(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ce(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ce(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(M in h)M==="data"||(M==="language"?ne(h.language):M==="className"?j("className",h.className):M==="tableClassName"&&s.table?(j("tableClassName",h.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):ge.getSingleton().isRegistered(M)||ge.getSingleton().isDeprecated(M)?(wt(h[M])||Array.isArray(h[M]))&&(h[M].initialHook=!0,s.addHook(M,h[M])):!g&&It(h,M)&&(_[M]=h[M]));h.data===void 0&&b.data===void 0?m(null,"updateSettings"):h.data!==void 0?m(h.data,"updateSettings"):h.columns!==void 0&&(l.createMap(),s.initIndexMappers());const Y=s.countCols(),B=b.columns;if(B&&wt(B)&&(E=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&y.clearCache(),Y>0)for(M=0,O=0;M<Y;M++){if(B){const K=E?B(M):B[O];K&&y.updateColumnMeta(O,K)}O+=1}ce(h.cell)&&Ye(h.cell,K=>{s.setCellMetaObject(K.row,K.col,K)}),s.runHooks("afterCellMetaReset");let q=s.rootElement.style.height;q!==""&&(q=parseInt(s.rootElement.style.height,10));let Q=h.height;if(wt(Q)&&(Q=Q()),g&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),Q===null){const K=s.rootElement.getAttribute("data-initialstyle");K&&(K.indexOf("height")>-1||K.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",K):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else Q!==void 0&&(s.rootElement.style.height=isNaN(Q)?`${Q}`:`${Q}px`,s.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let K=h.width;wt(K)&&(K=K()),s.rootElement.style.width=isNaN(K)?`${K}`:`${K}px`}g||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",h)),c.adjustRowsAndCols(),s.view&&!p&&(s.forceFullRender=!0,d.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!g&&s.view&&(q===""||Q===""||Q===void 0)&&q!==Q&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=s.getSelectedLast();if(b.getValue){if(wt(b.getValue))return b.getValue.call(s);if(h)return s.getData()[h[0][0]][b.getValue]}else if(h)return s.getDataAtCell(h[0],h[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,g,m,E,M){c.alter(h,g,m,E,M)},this.getCell=function(h,g){let m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=g,M=h;if(g>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(g)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(g)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;M=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return M===null||E===null?null:s.view.getCellAtCoords(s._createCellCoords(M,E),m)},this.getCoords=function(h){const g=this.view._wt.wtTable.getCoords(h);if(g===null)return null;const{row:m,col:E}=g;let M=m,O=E;return m>=0&&(M=this.rowIndexMapper.getVisualFromRenderableIndex(m)),E>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(E)),s._createCellCoords(M,O)},this.colToProp=function(h){return l.colToProp(h)},this.propToCol=function(h){return l.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,g){return l.get(h,l.colToProp(g))},this.getDataAtRowProp=function(h,g){return l.get(h,g)},this.getDataAtCol=function(h){const g=[],m=l.getRange(s._createCellCoords(0,h),s._createCellCoords(b.data.length-1,h),l.DESTINATION_RENDERER);for(let E=0;E<m.length;E+=1)for(let M=0;M<m[E].length;M+=1)g.push(m[E][M]);return g},this.getDataAtProp=function(h){const g=[],m=l.getRange(s._createCellCoords(0,l.propToCol(h)),s._createCellCoords(b.data.length-1,l.propToCol(h)),l.DESTINATION_RENDERER);for(let E=0;E<m.length;E+=1)for(let M=0;M<m[E].length;M+=1)g.push(m[E][M]);return g},this.getSourceData=function(h,g,m,E){let M;return h===void 0?M=u.getData():M=u.getByRange(s._createCellCoords(h,g),s._createCellCoords(m,E)),M},this.getSourceDataArray=function(h,g,m,E){let M;return h===void 0?M=u.getData(!0):M=u.getByRange(s._createCellCoords(h,g),s._createCellCoords(m,E),!0),M},this.getSourceDataAtCol=function(h){return u.getAtColumn(h)},this.setSourceDataAtCell=function(h,g,m,E){const M=ve(h,g,m),O=this.hasHook("afterSetSourceDataAtCell"),Y=[];O&&T(M,q=>{let[Q,K,de]=q;Y.push([Q,K,u.getAtCell(Q,K),de])}),T(M,q=>{let[Q,K,de]=q;u.setAtCell(Q,K,de)}),O&&this.runHooks("afterSetSourceDataAtCell",Y,E),this.render();const B=s.getActiveEditor();B&&ce(B.refreshValue)&&B.refreshValue()},this.getSourceDataAtRow=function(h){return u.getAtRow(h)},this.getSourceDataAtCell=function(h,g){return u.getAtCell(h,g)},this.getDataAtRow=function(h){return l.getRange(s._createCellCoords(h,0),s._createCellCoords(h,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,g,m,E){const M=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,g,m,E],[O,Y]=M;let[,,B,q]=M,Q=null,K=null;B===void 0&&(B=O),q===void 0&&(q=Y);let de="mixed";return Ce(Math.max(Math.min(O,B),0),Math.max(O,B),Ae=>{let Ee=!0;return Ce(Math.max(Math.min(Y,q),0),Math.max(Y,q),Oe=>(K=this.getCellMeta(Ae,Oe).type,Q?Ee=Q===K:Q=K,Ee)),de=Ee?K:"mixed",Ee}),de},this.removeCellMeta=function(h,g,m){const[E,M]=[this.toPhysicalRow(h),this.toPhysicalColumn(g)];let O=y.getCellMetaKeyValue(E,M,m);s.runHooks("beforeRemoveCellMeta",h,g,m,O)!==!1&&(y.removeCellMeta(E,M,m),s.runHooks("afterRemoveCellMeta",h,g,m,O)),O=null},this.spliceCellsMeta=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var m=arguments.length,E=new Array(m>2?m-2:0),M=2;M<m;M++)E[M-2]=arguments[M];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&y.removeRow(this.toPhysicalRow(h),g),E.length>0&&T(E.reverse(),O=>{y.createRow(this.toPhysicalRow(h)),T(O,(Y,B)=>this.setCellMetaObject(h,B,Y))}),s.render()},this.setCellMetaObject=function(h,g,m){typeof m=="object"&&Ye(m,(E,M)=>{this.setCellMeta(h,g,M,E)})},this.setCellMeta=function(h,g,m,E){if(s.runHooks("beforeSetCellMeta",h,g,m,E)===!1)return;let O=h,Y=g;h<this.countRows()&&(O=this.toPhysicalRow(h)),g<this.countCols()&&(Y=this.toPhysicalColumn(g)),y.setCellMeta(O,Y,m,E),s.runHooks("afterSetCellMeta",h,g,m,E)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(h,g){let m=this.toPhysicalRow(h),E=this.toPhysicalColumn(g);return m===null&&(m=h),E===null&&(E=g),y.getCellMeta(m,E,{visualRow:h,visualColumn:g})},this.getCellMetaAtRow=function(h){return y.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||b.columns)},this.getCellRenderer=function(h,g){const m=typeof h=="number"?s.getCellMeta(h,g).renderer:h.renderer;return typeof m=="string"?nf(m):Ct(m)?nf("text"):m},this.getCellEditor=function(h,g){const m=typeof h=="number"?s.getCellMeta(h,g).editor:h.editor;return typeof m=="string"?Jd(m):Ct(m)?Jd("text"):m},this.getCellValidator=function(h,g){const m=typeof h=="number"?s.getCellMeta(h,g).validator:h.validator;return typeof m=="string"?Gv(m):m},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,g){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(g,h)},this.validateColumns=function(h,g){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(g,void 0,h)},this._validateCells=function(h,g,m){const E=new X;h&&(E.onQueueEmpty=h);let M=s.countRows()-1;for(;M>=0;){if(g!==void 0&&g.indexOf(M)===-1){M-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(m!==void 0&&m.indexOf(O)===-1){O-=1;continue}E.addValidatorToQueue(),s.validateCell(s.getDataAtCell(M,O),s.getCellMeta(M,O),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),O-=1}M-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let g=b.rowHeaders,m=h;return m!==void 0&&(m=s.runHooks("modifyRowHeader",m)),m===void 0?(g=[],Ce(s.countRows()-1,E=>{g.push(s.getRowHeader(E))})):Array.isArray(g)&&g[m]!==void 0?g=g[m]:wt(g)?g=g(m):g&&typeof g!="string"&&typeof g!="number"&&(g=m+1),g},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let h=0,g=s.countCols();h<g;h++)if(s.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const m=s.runHooks("modifyColHeader",h);if(m===void 0){const B=[],q=s.countCols();for(let Q=0;Q<q;Q++)B.push(s.getColHeader(Q));return B}let E=b.colHeaders;const M=function(B){const q=[],Q=s.countCols();let K=0;for(;K<Q;K++)wt(b.columns)&&b.columns(K)&&q.push(K);return q[B]},O=s.toPhysicalColumn(m),Y=M(O);return b.colHeaders===!1?E=null:b.columns&&wt(b.columns)&&b.columns(Y)&&b.columns(Y).title?E=b.columns(Y).title:b.columns&&b.columns[O]&&b.columns[O].title?E=b.columns[O].title:Array.isArray(b.colHeaders)&&b.colHeaders[O]!==void 0?E=b.colHeaders[O]:wt(b.colHeaders)?E=b.colHeaders(O):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(E=hg(m)),E=s.runHooks("modifyColumnHeaderValue",E,h,g),E},this._getColWidthFromSettings=function(h){let g;if(h>=0&&(g=s.getCellMeta(0,h).width),(g===void 0||g===b.width)&&(g=b.colWidths),g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getColWidth=function(h){let g=s._getColWidthFromSettings(h);return g=s.runHooks("modifyColWidth",g,h),g===void 0&&(g=jv.DEFAULT_WIDTH),g},this._getRowHeightFromSettings=function(h){let g=b.rowHeights;if(g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getRowHeight=function(h){let g=s._getRowHeightFromSettings(h);return g=s.runHooks("modifyRowHeight",g,h),g},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const h=b.maxCols,g=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,g)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return tf(s.countRows()-1,m=>{if(s.isEmptyRow(m))g+=1;else if(h===!0)return!1}),g},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return tf(s.countCols()-1,m=>{if(s.isEmptyCol(m))g+=1;else if(h===!0)return!1}),g},this.isEmptyRow=function(h){return b.isEmptyRow.call(s,h)},this.isEmptyCol=function(h){return b.isEmptyCol.call(s,h)},this.selectCell=function(h,g,m,E){let M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ct(h)||Ct(g)?!1:this.selectCells([[h,g,m,E]],M,O)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g===!1&&(o=!0);const E=W.selectCells(h);return E&&m&&s.listen(),o=!1,E},this.selectColumns=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return W.selectColumns(h,g,m)},this.selectRows=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;return W.selectRows(h,g,m)},this.deselectCell=function(){W.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,m=arguments.length>2?arguments[2]:void 0;o=!0,W.selectAll(h,g,m),o=!1};const tt=(h,g)=>h.getNearestNotHiddenIndex(g,1,!0);this.scrollViewportTo=function(h){var g;if(typeof h=="number"){var m;h={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(m=arguments[4])!==null&&m!==void 0?m:!0}}const{row:E,col:M,verticalSnap:O,horizontalSnap:Y,considerHiddenIndexes:B}=(g=h)!==null&&g!==void 0?g:{};let q,Q,K,de;O!==void 0&&(q=O==="top",Q=!q),Y!==void 0&&(K=Y==="start",de=!K);let Ae=E,Ee=M;if(B===void 0||B){const je=Number.isInteger(E)&&E>=0,ke=Number.isInteger(M)&&M>=0,ye=je?tt(this.rowIndexMapper,E):void 0,He=ke?tt(this.columnIndexMapper,M):void 0;if(ye===null||He===null)return!1;Ae=je?s.rowIndexMapper.getRenderableFromVisualIndex(ye):E,Ee=ke?s.columnIndexMapper.getRenderableFromVisualIndex(He):M}const Oe=Number.isInteger(Ae),z=Number.isInteger(Ee);return Oe&&Ae>=0&&z&&Ee>=0?s.view.scrollViewport(s._createCellCoords(Ae,Ee),q,de,Q,K):Oe&&Ae>=0&&(z&&Ee<0||!z)?s.view.scrollViewportVertically(Ae,q,Q):z&&Ee>=0&&(Oe&&Ae<0||!Oe)?s.view.scrollViewportHorizontally(Ee,de,K):!1},this.scrollToFocusedCell=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",h);const{highlight:g}=this.getSelectedRangeLast();this.scrollViewportTo(g.toObject())?this.view.render():(this.removeHook("afterScroll",h),this._registerImmediate(()=>h()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),zm.delete(this.guid),bd(s)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}ei(s.rootElement),a.destroy(),d&&d.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),I.getItems().forEach(h=>{let[,g]=h;g.destroy()}),I.clear(),s.runHooks("afterDestroy")},!0),ge.getSingleton().destroy(s),Ye(s,(h,g,m)=>{wt(h)?m[g]=Ne(g):g!=="guid"&&(m[g]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,W=null,d=null,s=null};function Ne(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(h){const g=_n(h);return g==="UndoRedo"?this.undoRedo:I.getItem(g)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(h)},this.getInstance=function(){return s},this.addHook=function(h,g){ge.getSingleton().add(h,g,s)},this.hasHook=function(h){return ge.getSingleton().has(h,s)||ge.getSingleton().has(h)},this.addHookOnce=function(h,g){ge.getSingleton().once(h,g,s)},this.removeHook=function(h,g){ge.getSingleton().remove(h,g,s)},this.runHooks=function(h,g,m,E,M,O,Y){return ge.getSingleton().run(s,h,g,m,E,M,O,Y)},this.getTranslatedPhrase=function(h,g){return ex(b.language,h,g)},this.toHTML=()=>Zw(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",Zw(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,m=h;typeof m=="function"&&(m=setTimeout(m,g)),this.timeouts.push(m)},this._clearTimeouts=function(){T(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){T(this.immediates,h=>{clearImmediate(h)})},this._refreshBorders=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(h),s.view.render(),g&&W.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const R=H9({handleEvent(){return s.isListening()},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},Yv().forEach(h=>{const g=Oc(h);I.addItem(h,new g(this))}),E9(s),R.setActiveContextName("grid"),ge.getSingleton().run(s,"construct")}const D9="hooksRefRegisterer",vx={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){T(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ye(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Hi(vx,"MIXIN_NAME",D9,{writable:!1,enumerable:!1});const N9=vx;function $r(t,e,n){return e=L9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L9(t){var e=$9(t,"string");return typeof e=="symbol"?e:String(e)}function $9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const k9="base",Jt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),fC="baseEditor";class Pl{static get EDITOR_TYPE(){return k9}constructor(e){$r(this,"hot",void 0),$r(this,"state",Jt.VIRGIN),$r(this,"_opened",!1),$r(this,"_fullEditMode",!1),$r(this,"_closeCallback",null),$r(this,"TD",null),$r(this,"row",null),$r(this,"col",null),$r(this,"prop",null),$r(this,"originalValue",null),$r(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=Jt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const d=this.hot.getSelectedLast();r=Math.max(Math.min(d[0],d[2]),0),i=Math.max(Math.min(d[1],d[3]),0),o=Math.max(d[0],d[2]),s=Math.max(d[1],d[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>ce(this.hot.getSelected()),group:fC};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Jt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=Jt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Ft(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(fC),s.removeShortcutsByGroup(lg),this.state===Jt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Jt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=Jt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Jt.FINISHED,this.discardEditor(l)}):(this.state=Jt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Jt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Jt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Jt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Jt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Jt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=jt(n),a=dt(n),l=jt(this.hot.rootElement),u=dt(this.hot.rootElement),c=r.topOverlay.holder,d=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,p=d!==o?d.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,b=["master","inline_start"].includes(y)?f:0,_=["master","top","bottom"].includes(y)?p:0,I=s.top===l.top?0:1;let L=s.top-l.top-I-b,x=0;this.hot.isRtl()?x=o.innerWidth-s.left-a-w-1+_:x=s.left-l.left-1-_,["top","top_inline_start_corner"].includes(y)&&(L+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const W=this.hot.hasColHeaders(),G=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ne=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),X=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(W&&G<=0||G===X)&&(L+=1),ne<=0&&(x+=1);const ie=i.rowsRenderCalculator.startPosition,oe=i.columnsRenderCalculator.startPosition,se=Math.abs(r.inlineStartOverlay.getScrollPosition()),ve=r.topOverlay.getScrollPosition(),Pe=on(this.hot.rootDocument);let tt=n.offsetTop;if(["inline_start","master"].includes(y)&&(tt+=ie-ve),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:Q,wtTable:K}=r.bottomOverlay.clone;tt+=Q.getWorkspaceHeight()-K.getHeight()-Pe}let Ne=n.offsetLeft;this.hot.isRtl()?(Ne>=0?Ne=v.getWidth()-n.offsetLeft:Ne=Math.abs(Ne),Ne+=oe-se-a):["top","master","bottom"].includes(y)&&(Ne+=oe-se);const R=mo(this.TD,this.hot.rootWindow),h=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",g=parseInt(R[h],10)>0?0:1,m=parseInt(R.borderTopWidth,10)>0?0:1,E=dt(n)+g,M=Pt(n)+m,O=AI(c)?Pe:0,Y=OI(d)?Pe:0,B=this.hot.view.maximumVisibleElementWidth(Ne)-O+g,q=Math.max(this.hot.view.maximumVisibleElementHeight(tt)-Y+m,23);return{top:L,start:x,height:M,maxHeight:q,width:E,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}mt(Pl,N9);function J0(t,e,n){t.addEventListener(e,n,!1)}function eE(t,e,n){t.removeEventListener(e,n,!1)}function tE(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function F9(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=tE(o).fontSize,i.style.fontFamily=tE(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const d=o.style;d.height=`${e.minHeight}px`,e.minWidth>c?d.width=`${e.minWidth}px`:c>e.maxWidth?d.width=`${e.maxWidth}px`:d.width=`${c}px`;const f=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>f?d.height=`${e.minHeight}px`:e.maxHeight<f?(d.height=`${e.maxHeight}px`,d.overflowY="visible"):d.height=`${f}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const d=parseInt(c.minHeight,10);isNaN(d)||(e.minHeight=d)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const d=parseInt(c.maxHeight,10);isNaN(d)||(e.maxHeight=d)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const d=parseInt(c.minWidth,10);isNaN(d)||(e.minWidth=d)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const d=parseInt(c.maxWidth,10);isNaN(d)||(e.maxWidth=d)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.overflowY="",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),f&&(J0(o,"input",s),J0(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){eE(o,"input",s),eE(o,"keydown",a)}}}function nE(t,e){const n=Iv(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Tc(e,i)}function Ss(t,e,n){return e=W9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W9(t){var e=V9(t,"string");return typeof e=="symbol"?e:String(e)}function V9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const B9="ht_editor_visible",Sh="ht_editor_hidden",rE="textEditor",U9="text";class da extends Pl{static get EDITOR_TYPE(){return U9}constructor(e){super(e),Ss(this,"eventManager",new gr(this)),Ss(this,"autoResize",F9(this.hot.rootDocument)),Ss(this,"TEXTAREA",void 0),Ss(this,"textareaStyle",void 0),Ss(this,"TEXTAREA_PARENT",void 0),Ss(this,"textareaParentStyle",void 0),Ss(this,"layerClass",void 0),this.eventManager=new gr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),yI(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==Jt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===Jt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Tc(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),_e(this.TEXTAREA,[["data-hot-input",""],Ml(-1)]),this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[yo()]),J(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),J(this.TEXTAREA_PARENT,"handsontableInputHolder"),De(this.TEXTAREA_PARENT,this.layerClass)&&$e(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Sh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){UI()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",$e(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Sh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;Ce(e.length-1,r=>{const i=e[r];if(De(i,"handsontableEditor"))return n=!0,!1}),De(this.TEXTAREA_PARENT,Sh)&&$e(this.TEXTAREA_PARENT,Sh),n?(this.layerClass=B9,J(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),J(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Jt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=mo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=mo(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,p=s-d,w=o-c,v=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,w),minHeight:Math.min(p,v),maxWidth:w,maxHeight:v},!0)}bindEvents(){$v()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Jt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>ce(this.hot.getSelected()),group:rE},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;nE(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;nE(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(lg),n.removeShortcutsByGroup(rE),n.removeShortcutsByGroup(fC)}}const Y9="base";function Hc(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],d=[];s.className&&J(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(LR())):a&&c.push(LR()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push($R())):(u.push(s.invalidCellClassName),a&&c.push($R()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),$e(e,u),J(e,l),ua(e,c),_e(e,d)}Hc.RENDERER_TYPE=Y9;const G9="text";function To(t,e,n,r,i,o,s){Hc.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Ft(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){ei(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else is(e,a)}To.RENDERER_TYPE=G9;const z9="text",Sx={CELL_TYPE:z9,editor:da,renderer:To};Sr(Sx);Ie.editors={BaseEditor:Pl};function Ie(t,e){const n=new Cx(t,e||{},dS);return n.init(),n}Ie.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Cx(t,e,dS)};Ie.DefaultSettings=hx();Ie.hooks=ge.getSingleton();Ie.CellCoords=of;Ie.CellRange=qv;Ie.packageName="handsontable";Ie.buildDate="30/11/2023 09:47:48";Ie.version="14.0.0";Ie.languages={dictionaryKeys:h4,getLanguageDictionary:JP,getLanguagesDictionaries:p4,registerLanguageDictionary:QP,getTranslatedPhrase:ex};const iE="handsontableEditor",j9="handsontable";class jy extends da{static get EDITOR_TYPE(){return j9}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Tc(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const d=this.getSourceData(c.row,c.col);d!==void 0&&a.setValue(d),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Kt(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:iE,relativeToGroup:lg,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Pr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(iE)}}function K9(t,e,n){X9(t,e),e.set(t,n)}function X9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yh(t,e,n){return e=q9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q9(t){var e=Z9(t,"string");return typeof e=="symbol"?e:String(e)}function Z9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oE(t,e){var n=Q9(t,e,"get");return J9(t,n)}function Q9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function J9(t,e){return e.get?e.get.call(t):e.value}const e5="autocomplete";var jm=new WeakMap;class Ky extends jy{constructor(){super(...arguments),yh(this,"query",null),yh(this,"strippedChoices",[]),yh(this,"rawChoices",[]),K9(this,jm,{writable:!0,value:this.hot.guid.slice(0,9)}),yh(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,d;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=Gw(Ft(n[c])),r)d=u.indexOf(e);else{const f=this.cellProperties.locale;d=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}d!==-1&&(l=u.length-d-s,i.push({baseIndex:c,index:d,charsLeft:l,value:u}))}for(i.sort((f,p)=>{if(p.index===-1)return-1;if(f.index===-1)return 1;if(f.index<p.index)return-1;if(p.index<f.index)return 1;if(f.index===p.index){if(f.charsLeft<p.charsLeft)return-1;if(f.charsLeft>p.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return e5}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ce(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),J(this.htContainer,"autocompleteEditor"),J(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[wY(),dY(),wI("listbox"),bY()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[_r("false"),RY(`${oE(this,jm)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=on();a===0&&sc()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[dt(this.TEXTAREA)-2]:void 0,width:e?dt(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,d,f,p,w)=>{To(l,u,c,d,f,p,w);const{filteringCaseSensitive:v,allowHtml:y,locale:b}=this.cellProperties,_=this.query;let I=Ft(p),L,x;I&&!y&&(L=v===!0?I.indexOf(_):I.toLocaleLowerCase(b).indexOf(_.toLocaleLowerCase(b)),L!==-1&&(x=I.substr(L,_.length),I=I.replace(x,`<strong>${x}</strong>`))),n&&_e(u,[fY(),...r?[MY(i)]:[],...r?[AY(r.indexOf(p)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${d}`]]),u.innerHTML=I},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);_e(c,[Mv()]),_e(this.TEXTAREA,...EY(c.id))}}}),n&&(_e(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ti()),_e(this.htEditor.rootElement,[pI(),TY("polite"),_Y("text"),["id",`${oE(this,jm)}-listbox-${o}-${s}`]]),_e(this.TEXTAREA,..._r("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[_r("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=Iv(this.TEXTAREA),r=MI(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let d=0,f=l.length;d<f&&!(i&&u<=d);d++)u?c.push(l[s[d]]):c.push(l[d]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Hu([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Tc(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=Qs(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=jt(this.TEXTAREA),o=Pt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Pt(this.hot.view._wt.wtTable.THEAD),u=jt(e),c=i.top-u.top-l+a,d=e.scrollHeight-c-l-o,f=s>d&&c>d;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:d,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+on(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Ft(o));return Ue(r,o=>n?o:Gw(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===we.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===we.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(YI(e.keyCode)||e.keyCode===we.BACKSPACE||e.keyCode===we.DELETE||e.keyCode===we.INSERT){let n=10;if(e.keyCode===we.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const t5="checkbox";class yx extends Pl{static get EDITOR_TYPE(){return t5}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');De(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var bx={exports:{}};const n5=jD(jU);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=n5}catch{}t.exports=r(i)}})(cd,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(R,h,g,m){i?R.addEventListener(h,g,!!m):R.attachEvent("on"+h,g)},l=function(R,h,g,m){i?R.removeEventListener(h,g,!!m):R.detachEvent("on"+h,g)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,h){return(" "+R.className+" ").indexOf(" "+h+" ")!==-1},d=function(R,h){c(R,h)||(R.className=R.className===""?h:R.className+" "+h)},f=function(R,h){R.className=u((" "+R.className+" ").replace(" "+h+" "," "))},p=function(R){return/Array/.test(Object.prototype.toString.call(R))},w=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},v=function(R){var h=R.getDay();return h===0||h===6},y=function(R){return R%4===0&&R%100!==0||R%400===0},b=function(R,h){return[31,y(R)?29:28,31,30,31,30,31,31,30,31,30,31][h]},_=function(R){w(R)&&R.setHours(0,0,0,0)},I=function(R,h){return R.getTime()===h.getTime()},L=function(R,h,g){var m,E;for(m in h)E=R[m]!==void 0,E&&typeof h[m]=="object"&&h[m]!==null&&h[m].nodeName===void 0?w(h[m])?g&&(R[m]=new Date(h[m].getTime())):p(h[m])?g&&(R[m]=h[m].slice(0)):R[m]=L({},h[m],g):(g||!E)&&(R[m]=h[m]);return R},x=function(R,h,g){var m;o.createEvent?(m=o.createEvent("HTMLEvents"),m.initEvent(h,!0,!1),m=L(m,g),R.dispatchEvent(m)):o.createEventObject&&(m=o.createEventObject(),m=L(m,g),R.fireEvent("on"+h,m))},W=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},G={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ne=function(R,h,g){for(h+=R.firstDay;h>=7;)h-=7;return g?R.i18n.weekdaysShort[h]:R.i18n.weekdays[h]},j=function(R){var h=[],g="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)h.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||h.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&h.push("is-disabled"),R.isToday&&h.push("is-today"),R.isSelected&&(h.push("is-selected"),g="true"),R.hasEvent&&h.push("has-event"),R.isInRange&&h.push("is-inrange"),R.isStartRange&&h.push("is-startrange"),R.isEndRange&&h.push("is-endrange"),'<td data-day="'+R.day+'" class="'+h.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},X=function(R,h){R.setHours(0,0,0,0);var g=R.getDate(),m=R.getDay(),E=h,M=E-1,O=7,Y=function(de){return(de+O-1)%O};R.setDate(g+M-Y(m));var B=new Date(R.getFullYear(),0,E),q=24*60*60*1e3,Q=(R.getTime()-B.getTime())/q,K=1+Math.round((Q-M+Y(B.getDay()))/O);return K},ie=function(R,h,g,m){var E=new Date(g,h,R),M=r?n(E).isoWeek():X(E,m);return'<td class="pika-week">'+M+"</td>"},oe=function(R,h,g,m){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(m?" is-selected":"")+'">'+(h?R.reverse():R).join("")+"</tr>"},se=function(R){return"<tbody>"+R.join("")+"</tbody>"},ve=function(R){var h,g=[];for(R.showWeekNumber&&g.push("<th></th>"),h=0;h<7;h++)g.push('<th scope="col"><abbr title="'+ne(R,h)+'">'+ne(R,h,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?g.reverse():g).join("")+"</tr></thead>"},Pe=function(R,h,g,m,E,M){var O,Y,B,q=R._o,Q=g===q.minYear,K=g===q.maxYear,de='<div id="'+M+'" class="pika-title" role="heading" aria-live="assertive">',Ae,Ee,Oe=!0,z=!0;for(B=[],O=0;O<12;O++)B.push('<option value="'+(g===E?O-h:12+O-h)+'"'+(O===m?' selected="selected"':"")+(Q&&O<q.minMonth||K&&O>q.maxMonth?' disabled="disabled"':"")+">"+q.i18n.months[O]+"</option>");for(Ae='<div class="pika-label">'+q.i18n.months[m]+'<select class="pika-select pika-select-month" tabindex="-1">'+B.join("")+"</select></div>",p(q.yearRange)?(O=q.yearRange[0],Y=q.yearRange[1]+1):(O=g-q.yearRange,Y=1+g+q.yearRange),B=[];O<Y&&O<=q.maxYear;O++)O>=q.minYear&&B.push('<option value="'+O+'"'+(O===g?' selected="selected"':"")+">"+O+"</option>");return Ee='<div class="pika-label">'+g+q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+B.join("")+"</select></div>",q.showMonthAfterYear?de+=Ee+Ae:de+=Ae+Ee,Q&&(m===0||q.minMonth>=m)&&(Oe=!1),K&&(m===11||q.maxMonth<=m)&&(z=!1),h===0&&(de+='<button class="pika-prev'+(Oe?"":" is-disabled")+'" type="button">'+q.i18n.previousMonth+"</button>"),h===R._o.numberOfMonths-1&&(de+='<button class="pika-next'+(z?"":" is-disabled")+'" type="button">'+q.i18n.nextMonth+"</button>"),de+="</div>"},tt=function(R,h,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+ve(R)+se(h)+"</table>"},Ne=function(R){var h=this,g=h.config(R);h._onMouseDown=function(E){if(h._v){E=E||window.event;var M=E.target||E.srcElement;if(M)if(c(M,"is-disabled")||(c(M,"pika-button")&&!c(M,"is-empty")&&!c(M.parentNode,"is-disabled")?(h.setDate(new Date(M.getAttribute("data-pika-year"),M.getAttribute("data-pika-month"),M.getAttribute("data-pika-day"))),g.bound&&s(function(){h.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):c(M,"pika-prev")?h.prevMonth():c(M,"pika-next")&&h.nextMonth()),c(M,"pika-select"))h._c=!0;else if(E.preventDefault)E.preventDefault();else return E.returnValue=!1,!1}},h._onChange=function(E){E=E||window.event;var M=E.target||E.srcElement;M&&(c(M,"pika-select-month")?h.gotoMonth(M.value):c(M,"pika-select-year")&&h.gotoYear(M.value))},h._onKeyChange=function(E){if(E=E||window.event,h.isVisible())switch(E.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7);break;case 8:case 46:h.setDate(null);break}},h._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(r){var E=n(g.field.value,g.format,g.formatStrict);return E&&E.isValid()?E.toDate():null}else return new Date(Date.parse(g.field.value))},h._onInputChange=function(E){var M;E.firedBy!==h&&(M=h._parseFieldValue(),w(M)&&h.setDate(M),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var E=o.activeElement;do if(c(E,"pika-single"))return;while(E=E.parentNode);h._c||(h._b=s(function(){h.hide()},50)),h._c=!1},h._onClick=function(E){E=E||window.event;var M=E.target||E.srcElement,O=M;if(M){!i&&c(M,"pika-select")&&(M.onchange||(M.setAttribute("onchange","return;"),a(M,"change",h._onChange)));do if(c(O,"pika-single")||O===g.trigger)return;while(O=O.parentNode);h._v&&M!==g.trigger&&O!==g.trigger&&h.hide()}},h.el=o.createElement("div"),h.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),a(h.el,"mousedown",h._onMouseDown,!0),a(h.el,"touchend",h._onMouseDown,!0),a(h.el,"change",h._onChange),g.keyboardInput&&a(o,"keydown",h._onKeyChange),g.field&&(g.container?g.container.appendChild(h.el):g.bound?o.body.appendChild(h.el):g.field.parentNode.insertBefore(h.el,g.field.nextSibling),a(g.field,"change",h._onInputChange),g.defaultDate||(g.defaultDate=h._parseFieldValue(),g.setDefaultDate=!0));var m=g.defaultDate;w(m)?g.setDefaultDate?h.setDate(m,!0):h.gotoDate(m):h.gotoDate(new Date),g.bound?(this.hide(),h.el.className+=" is-bound",a(g.trigger,"click",h._onInputClick),a(g.trigger,"focus",h._onInputFocus),a(g.trigger,"blur",h._onInputBlur)):this.show()};return Ne.prototype={config:function(R){this._o||(this._o=L({},G,!0));var h=L(this._o,R,!0);h.isRTL=!!h.isRTL,h.field=h.field&&h.field.nodeName?h.field:null,h.theme=typeof h.theme=="string"&&h.theme?h.theme:null,h.bound=!!(h.bound!==void 0?h.field&&h.bound:h.field),h.trigger=h.trigger&&h.trigger.nodeName?h.trigger:h.field,h.disableWeekends=!!h.disableWeekends,h.disableDayFn=typeof h.disableDayFn=="function"?h.disableDayFn:null;var g=parseInt(h.numberOfMonths,10)||1;if(h.numberOfMonths=g>4?4:g,w(h.minDate)||(h.minDate=!1),w(h.maxDate)||(h.maxDate=!1),h.minDate&&h.maxDate&&h.maxDate<h.minDate&&(h.maxDate=h.minDate=!1),h.minDate&&this.setMinDate(h.minDate),h.maxDate&&this.setMaxDate(h.maxDate),p(h.yearRange)){var m=new Date().getFullYear()-10;h.yearRange[0]=parseInt(h.yearRange[0],10)||m,h.yearRange[1]=parseInt(h.yearRange[1],10)||m}else h.yearRange=Math.abs(parseInt(h.yearRange,10))||G.yearRange,h.yearRange>100&&(h.yearRange=100);return h},toString:function(R){return R=R||this._o.format,w(this._d)?this._o.toString?this._o.toString(this._d,R):r?n(this._d).format(R):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(R,h){r&&n.isMoment(R)&&this.setDate(R.toDate(),h)},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(R,h){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",x(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!w(R)){var g=this._o.minDate,m=this._o.maxDate;w(g)&&R<g?R=g:w(m)&&R>m&&(R=m),this._d=new Date(R.getTime()),_(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),x(this._o.field,"change",{firedBy:this})),!h&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var h=!0;if(w(R)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),m=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),E=R.getTime();m.setMonth(m.getMonth()+1),m.setDate(m.getDate()-1),h=E<g.getTime()||m.getTime()<E}h&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,h){var g=this.getDate()||new Date,m=parseInt(h)*24*60*60*1e3,E;R==="add"?E=new Date(g.valueOf()+m):R==="subtract"&&(E=new Date(g.valueOf()-m)),this.setDate(E)},adjustCalendars:function(){this.calendars[0]=W(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=W({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(_(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=G.minDate,this._o.minYear=G.minYear,this._o.minMonth=G.minMonth,this._o.startRange=G.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(_(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=G.maxDate,this._o.maxYear=G.maxYear,this._o.maxMonth=G.maxMonth,this._o.endRange=G.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var h=this._o,g=h.minYear,m=h.maxYear,E=h.minMonth,M=h.maxMonth,O="",Y;this._y<=g&&(this._y=g,!isNaN(E)&&this._m<E&&(this._m=E)),this._y>=m&&(this._y=m,!isNaN(M)&&this._m>M&&(this._m=M));for(var B=0;B<h.numberOfMonths;B++)Y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),O+='<div class="pika-lendar">'+Pe(this,B,this.calendars[B].year,this.calendars[B].month,this.calendars[0].year,Y)+this.render(this.calendars[B].year,this.calendars[B].month,Y)+"</div>";this.el.innerHTML=O,h.bound&&h.field.type!=="hidden"&&s(function(){h.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),h.bound&&h.field.setAttribute("aria-label",h.ariaLabel)}},adjustPosition:function(){var R,h,g,m,E,M,O,Y,B,q,Q,K;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,h=R,g=this.el.offsetWidth,m=this.el.offsetHeight,E=window.innerWidth||o.documentElement.clientWidth,M=window.innerHeight||o.documentElement.clientHeight,O=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,Q=!0,K=!0,typeof R.getBoundingClientRect=="function")q=R.getBoundingClientRect(),Y=q.left+window.pageXOffset,B=q.bottom+window.pageYOffset;else for(Y=h.offsetLeft,B=h.offsetTop+h.offsetHeight;h=h.offsetParent;)Y+=h.offsetLeft,B+=h.offsetTop;(this._o.reposition&&Y+g>E||this._o.position.indexOf("right")>-1&&Y-g+R.offsetWidth>0)&&(Y=Y-g+R.offsetWidth,Q=!1),(this._o.reposition&&B+m>M+O||this._o.position.indexOf("top")>-1&&B-m-R.offsetHeight>0)&&(B=B-m-R.offsetHeight,K=!1),this.el.style.left=Y+"px",this.el.style.top=B+"px",d(this.el,Q?"left-aligned":"right-aligned"),d(this.el,K?"bottom-aligned":"top-aligned"),f(this.el,Q?"right-aligned":"left-aligned"),f(this.el,K?"top-aligned":"bottom-aligned")}},render:function(R,h,g){var m=this._o,E=new Date,M=b(R,h),O=new Date(R,h,1).getDay(),Y=[],B=[];_(E),m.firstDay>0&&(O-=m.firstDay,O<0&&(O+=7));for(var q=h===0?11:h-1,Q=h===11?0:h+1,K=h===0?R-1:R,de=h===11?R+1:R,Ae=b(K,q),Ee=M+O,Oe=Ee;Oe>7;)Oe-=7;Ee+=7-Oe;for(var z=!1,je=0,ke=0;je<Ee;je++){var ye=new Date(R,h,1+(je-O)),He=w(this._d)?I(ye,this._d):!1,Re=I(ye,E),C=m.events.indexOf(ye.toDateString())!==-1,S=je<O||je>=M+O,A=1+(je-O),F=h,P=R,k=m.startRange&&I(m.startRange,ye),H=m.endRange&&I(m.endRange,ye),D=m.startRange&&m.endRange&&m.startRange<ye&&ye<m.endRange,V=m.minDate&&ye<m.minDate||m.maxDate&&ye>m.maxDate||m.disableWeekends&&v(ye)||m.disableDayFn&&m.disableDayFn(ye);S&&(je<O?(A=Ae+A,F=q,P=K):(A=A-M,F=Q,P=de));var $={day:A,month:F,year:P,hasEvent:C,isSelected:He,isToday:Re,isDisabled:V,isEmpty:S,isStartRange:k,isEndRange:H,isInRange:D,showDaysInNextAndPreviousMonths:m.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:m.enableSelectionDaysInNextAndPreviousMonths};m.pickWholeWeek&&He&&(z=!0),B.push(j($)),++ke===7&&(m.showWeekNumber&&B.unshift(ie(je-O,h,R,m.firstWeekOfYearMinDays)),Y.push(oe(B,m.isRTL,m.pickWholeWeek,z)),B=[],ke=0,z=!1)}return tt(m,Y,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(o,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ne})})(bx);var r5=bx.exports;const sE=RA(r5);function bh(t,e,n){return e=i5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i5(t){var e=o5(t,"string");return typeof e=="symbol"?e:String(e)}function o5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Rx="date",aE="dateEditor";class Ex extends da{constructor(){super(...arguments),bh(this,"defaultDateFormat","DD/MM/YYYY"),bh(this,"isCellEdited",!1),bh(this,"parentDestroyed",!1),bh(this,"$datePicker",null)}static get EDITOR_TYPE(){return Rx}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof sE!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),J(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new gr(this);e.addEventListener(this.datePicker,"mousedown",n=>{De(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:aE})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(aE),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?Fv(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new sE(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Pt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-dt(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,Z(s,r,!0).isValid()&&this.$datePicker.setMoment(Z(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Z(s,r,!0).isValid()&&this.$datePicker.setMoment(Z(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ac(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=Z(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const s5="dropdown";class Xy extends Ky{static get EDITOR_TYPE(){return s5}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}ge.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===Xy&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const a5="numeric";class Tx extends da{static get EDITOR_TYPE(){return a5}}const l5="password";class _x extends da{static get EDITOR_TYPE(){return l5}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&_e(this.TEXTAREA,[yo()]),ei(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Km="ht_editor_visible",lE="selectEditor",u5="select";class Mx extends Pl{static get EDITOR_TYPE(){return u5}init(){this.select=this.hot.rootDocument.createElement("SELECT"),J(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",De(this.select,Km)&&$e(this.select,Km),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ei(this.select),Ye(l,(u,c)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=c,ca(d,u),this.select.appendChild(d)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Jt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",J(this.select,Km)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:lE};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(lE)}}const c5="time";class Ax extends da{static get EDITOR_TYPE(){return c5}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function h5(){Jn(Pl),Jn(Ky),Jn(yx),Jn(Ex),Jn(Xy),Jn(jy),Jn(Tx),Jn(_x),Jn(Mx),Jn(da),Jn(Ax)}const d5="html";function qy(t,e,n,r,i,o,s){Hc.apply(this,[t,e,n,r,i,o,s]),ca(e,o??"",!1)}qy.RENDERER_TYPE=d5;const f5="autocomplete";function xl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?qy:To,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...yo()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),J(e,"htAutocomplete"),!t.acArrowListener){const d=new gr(t);t.acArrowListener=function(f){De(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{d.destroy()})}}xl.RENDERER_TYPE=f5;const uE=new WeakMap,cE=new WeakMap,g5="htBadValue",bl="data-row",Rl="data-col",m5="checkboxRenderer",Ox="checkbox";ge.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===Ox){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const d=this.getDataAtRowProp(o,u);c=d!==null?d:n}t=c}return t}});function Zy(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Hc.apply(this,[t,e,n,r,i,o,s]),p5(t);let u=w5(a);const c=s.label;let d=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),ei(e),o===s.checkedTemplate||Ft(o).toLocaleLowerCase(s.locale)===Ft(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Ft(o).toLocaleLowerCase(s.locale)===Ft(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:en(o)?J(u,"noValue"):(u.style.display="none",J(u,g5),d=!0),_e(u,[[bl,n],[Rl,r]]),l&&_e(u,[Tv(u.checked?t.getTranslatedPhrase(Vy):t.getTranslatedPhrase(By)),yY(u.checked),gY()]),!d&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const b=t.getDataAtRowProp(n,c.property);v=b!==null?b:""}const y=C5(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),d&&e.appendChild(a.createTextNode("#bad-value#")),uE.has(t)||(uE.set(t,!0),f());function f(){const y=t.getShortcutManager().getContext("grid"),b={group:m5};y.addShortcuts([{keys:[["space"]],callback:()=>(p(),!w())},{keys:[["enter"]],callback:()=>(p(),!w()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(p(!0),!w()),relativeToGroup:zy,position:"before"}],b)}function p(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange();if(y)for(let b=0;b<y.length;b++){const{row:_,col:I}=y[b].getTopStartCorner(),{row:L,col:x}=y[b].getBottomEndCorner(),W=[];for(let G=_;G<=L;G+=1)for(let ne=I;ne<=x;ne+=1){const j=t.getCellMeta(G,ne);if(j.type!=="checkbox")return;if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const X=t.getDataAtCell(G,ne);v===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(X)?W.push([G,ne,j.uncheckedTemplate]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(X)&&W.push([G,ne,j.checkedTemplate]):W.push([G,ne,j.uncheckedTemplate])}W.length>0&&t.setDataAtCell(W)}}function w(){const v=t.getSelectedRange();if(v){for(let y=0;y<v.length;y++){const b=v[y].getTopStartCorner(),_=v[y].getBottomEndCorner();for(let I=b.row;I<=_.row;I++)for(let L=b.col;L<=_.col;L++){const x=t.getCellMeta(I,L);if(x.type!=="checkbox")return!1;const W=t.getCell(I,L);if(W==null)return!0;if(W.querySelectorAll("input[type=checkbox]").length>0&&!x.readOnly)return!0}}return!1}}}Zy.RENDERER_TYPE=Ox;function p5(t){let e=cE.get(t);if(!e){const{rootElement:n}=t;e=new gr(t),e.addEventListener(n,"click",r=>S5(r,t)),e.addEventListener(n,"mouseup",r=>v5(r,t)),e.addEventListener(n,"change",r=>y5(r,t)),cE.set(t,e)}return e}function w5(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function C5(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function v5(t,e){const{target:n}=t;Qy(n)&&(!n.hasAttribute(bl)||!n.hasAttribute(Rl)||setTimeout(e.listen,10))}function S5(t,e){const{target:n}=t;if(!Qy(n)||!n.hasAttribute(bl)||!n.hasAttribute(Rl))return;const r=parseInt(n.getAttribute(bl),10),i=parseInt(n.getAttribute(Rl),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function y5(t,e){const{target:n}=t;if(!Qy(n)||!n.hasAttribute(bl)||!n.hasAttribute(Rl))return;const r=parseInt(n.getAttribute(bl),10),i=parseInt(n.getAttribute(Rl),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Qy(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function Rh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ix={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var d=typeof Rh=="function"&&Rh;if(!c&&d)return d(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var p=i[u]={exports:{}};r[u][0].call(p.exports,function(w){return s(r[u][1][w]||w)},p,p.exports,n,r,i,o)}return i[u].exports}for(var a=typeof Rh=="function"&&Rh,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",d=c+"Number primitive has more than 15 significant digits: ",f=1e14,p=14,w=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,b=1e9;function _(j){var X=0|j;return 0<j||j===X?X:X-1}function I(j){for(var X,ie,oe=1,se=j.length,ve=j[0]+"";oe<se;){for(X=j[oe++]+"",ie=p-X.length;ie--;X="0"+X);ve+=X}for(se=ve.length;ve.charCodeAt(--se)===48;);return ve.slice(0,se+1||1)}function L(j,X){var ie,oe,se=j.c,ve=X.c,Pe=j.s,tt=X.s,Ne=j.e,R=X.e;if(!Pe||!tt)return null;if(ie=se&&!se[0],oe=ve&&!ve[0],ie||oe)return ie?oe?0:-tt:Pe;if(Pe!=tt)return Pe;if(ie=Pe<0,oe=Ne==R,!se||!ve)return oe?0:!se^ie?1:-1;if(!oe)return R<Ne^ie?1:-1;for(tt=(Ne=se.length)<(R=ve.length)?Ne:R,Pe=0;Pe<tt;Pe++)if(se[Pe]!=ve[Pe])return se[Pe]>ve[Pe]^ie?1:-1;return Ne==R?0:R<Ne^ie?1:-1}function x(j,X,ie,oe){if(j<X||ie<j||j!==(j<0?l(j):u(j)))throw Error(c+(oe||"Argument")+(typeof j=="number"?j<X||ie<j?" out of range: ":" not an integer: ":" not a primitive number: ")+String(j))}function W(j){var X=j.c.length-1;return _(j.e/p)==X&&j.c[X]%2!=0}function G(j,X){return(1<j.length?j.charAt(0)+"."+j.slice(1):j)+(X<0?"e":"e+")+X}function ne(j,X,ie){var oe,se;if(X<0){for(se=ie+".";++X;se+=ie);j=se+j}else if(++X>(oe=j.length)){for(se=ie,X-=oe;--X;se+=ie);j+=se}else X<oe&&(j=j.slice(0,X)+"."+j.slice(X));return j}(s=function j(X){var ie,oe,se,ve,Pe,tt,Ne,R,h,g,m=z.prototype={constructor:z,toString:null,valueOf:null},E=new z(1),M=20,O=4,Y=-7,B=21,q=-1e7,Q=1e7,K=!1,de=1,Ae=0,Ee={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Oe="0123456789abcdefghijklmnopqrstuvwxyz";function z(C,S){var A,F,P,k,H,D,V,$,U=this;if(!(U instanceof z))return new z(C,S);if(S==null){if(C instanceof z)return U.s=C.s,U.e=C.e,void(U.c=(C=C.c)?C.slice():C);if((D=typeof C=="number")&&0*C==0){if(U.s=1/C<0?(C=-C,-1):1,C===~~C){for(k=0,H=C;10<=H;H/=10,k++);return U.e=k,void(U.c=[C])}$=String(C)}else{if($=String(C),!a.test($))return se(U,$,D);U.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(k=$.indexOf("."))&&($=$.replace(".","")),0<(H=$.search(/e/i))?(k<0&&(k=H),k+=+$.slice(H+1),$=$.substring(0,H)):k<0&&(k=$.length)}else{if(x(S,2,Oe.length,"Base"),$=String(C),S==10)return He(U=new z(C instanceof z?C:$),M+U.e+1,O);if(D=typeof C=="number"){if(0*C!=0)return se(U,$,D,S);if(U.s=1/C<0?($=$.slice(1),-1):1,z.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(d+C);D=!1}else U.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(A=Oe.slice(0,S),k=H=0,V=$.length;H<V;H++)if(A.indexOf(F=$.charAt(H))<0){if(F=="."){if(k<H){k=V;continue}}else if(!P&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){P=!0,H=-1,k=0;continue}return se(U,String(C),D,S)}-1<(k=($=oe($,S,10,U.s)).indexOf("."))?$=$.replace(".",""):k=$.length}for(H=0;$.charCodeAt(H)===48;H++);for(V=$.length;$.charCodeAt(--V)===48;);if($=$.slice(H,++V)){if(V-=H,D&&z.DEBUG&&15<V&&(w<C||C!==u(C)))throw Error(d+U.s*C);if(Q<(k=k-H-1))U.c=U.e=null;else if(k<q)U.c=[U.e=0];else{if(U.e=k,U.c=[],H=(k+1)%p,k<0&&(H+=p),H<V){for(H&&U.c.push(+$.slice(0,H)),V-=p;H<V;)U.c.push(+$.slice(H,H+=p));$=$.slice(H),H=p-$.length}else H-=V;for(;H--;$+="0");U.c.push(+$)}}else U.c=[U.e=0]}function je(C,S,A,F){var P,k,H,D,V;if(A==null?A=O:x(A,0,8),!C.c)return C.toString();if(P=C.c[0],H=C.e,S==null)V=I(C.c),V=F==1||F==2&&(H<=Y||B<=H)?G(V,H):ne(V,H,"0");else if(k=(C=He(new z(C),S,A)).e,D=(V=I(C.c)).length,F==1||F==2&&(S<=k||k<=Y)){for(;D<S;V+="0",D++);V=G(V,k)}else if(S-=H,V=ne(V,k,"0"),D<k+1){if(0<--S)for(V+=".";S--;V+="0");}else if(0<(S+=k-D))for(k+1==D&&(V+=".");S--;V+="0");return C.s<0&&P?"-"+V:V}function ke(C,S){for(var A,F=1,P=new z(C[0]);F<C.length;F++){if(!(A=new z(C[F])).s){P=A;break}S.call(P,A)&&(P=A)}return P}function ye(C,S,A){for(var F=1,P=S.length;!S[--P];S.pop());for(P=S[0];10<=P;P/=10,F++);return(A=F+A*p-1)>Q?C.c=C.e=null:C.c=A<q?[C.e=0]:(C.e=A,S),C}function He(C,S,A,F){var P,k,H,D,V,$,U,re=C.c,fe=v;if(re){e:{for(P=1,D=re[0];10<=D;D/=10,P++);if((k=S-P)<0)k+=p,H=S,U=(V=re[$=0])/fe[P-H-1]%10|0;else if(($=l((k+1)/p))>=re.length){if(!F)break e;for(;re.length<=$;re.push(0));V=U=0,H=(k%=p)-p+(P=1)}else{for(V=D=re[$],P=1;10<=D;D/=10,P++);U=(H=(k%=p)-p+P)<0?0:V/fe[P-H-1]%10|0}if(F=F||S<0||re[$+1]!=null||(H<0?V:V%fe[P-H-1]),F=A<4?(U||F)&&(A==0||A==(C.s<0?3:2)):5<U||U==5&&(A==4||F||A==6&&(0<k?0<H?V/fe[P-H]:0:re[$-1])%10&1||A==(C.s<0?8:7)),S<1||!re[0])return re.length=0,F?(S-=C.e+1,re[0]=fe[(p-S%p)%p],C.e=-S||0):re[0]=C.e=0,C;if(k==0?(re.length=$,D=1,$--):(re.length=$+1,D=fe[p-k],re[$]=0<H?u(V/fe[P-H]%fe[H])*D:0),F)for(;;){if($==0){for(k=1,H=re[0];10<=H;H/=10,k++);for(H=re[0]+=D,D=1;10<=H;H/=10,D++);k!=D&&(C.e++,re[0]==f&&(re[0]=1));break}if(re[$]+=D,re[$]!=f)break;re[$--]=0,D=1}for(k=re.length;re[--k]===0;re.pop());}C.e>Q?C.c=C.e=null:C.e<q&&(C.c=[C.e=0])}return C}function Re(C){var S,A=C.e;return A===null?C.toString():(S=I(C.c),S=A<=Y||B<=A?G(S,A):ne(S,A,"0"),C.s<0?"-"+S:S)}return z.clone=j,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(C){var S,A;if(C!=null){if(typeof C!="object")throw Error(c+"Object expected: "+C);if(C.hasOwnProperty(S="DECIMAL_PLACES")&&(x(A=C[S],0,b,S),M=A),C.hasOwnProperty(S="ROUNDING_MODE")&&(x(A=C[S],0,8,S),O=A),C.hasOwnProperty(S="EXPONENTIAL_AT")&&((A=C[S])&&A.pop?(x(A[0],-b,0,S),x(A[1],0,b,S),Y=A[0],B=A[1]):(x(A,-b,b,S),Y=-(B=A<0?-A:A))),C.hasOwnProperty(S="RANGE"))if((A=C[S])&&A.pop)x(A[0],-b,-1,S),x(A[1],1,b,S),q=A[0],Q=A[1];else{if(x(A,-b,b,S),!A)throw Error(c+S+" cannot be zero: "+A);q=-(Q=A<0?-A:A)}if(C.hasOwnProperty(S="CRYPTO")){if((A=C[S])!==!!A)throw Error(c+S+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw K=!A,Error(c+"crypto unavailable");K=A}else K=A}if(C.hasOwnProperty(S="MODULO_MODE")&&(x(A=C[S],0,9,S),de=A),C.hasOwnProperty(S="POW_PRECISION")&&(x(A=C[S],0,b,S),Ae=A),C.hasOwnProperty(S="FORMAT")){if(typeof(A=C[S])!="object")throw Error(c+S+" not an object: "+A);Ee=A}if(C.hasOwnProperty(S="ALPHABET")){if(typeof(A=C[S])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(c+S+" invalid: "+A);Oe=A}}return{DECIMAL_PLACES:M,ROUNDING_MODE:O,EXPONENTIAL_AT:[Y,B],RANGE:[q,Q],CRYPTO:K,MODULO_MODE:de,POW_PRECISION:Ae,FORMAT:Ee,ALPHABET:Oe}},z.isBigNumber=function(C){return C instanceof z||C&&C._isBigNumber===!0||!1},z.maximum=z.max=function(){return ke(arguments,m.lt)},z.minimum=z.min=function(){return ke(arguments,m.gt)},z.random=(ve=9007199254740992,Pe=Math.random()*ve&2097151?function(){return u(Math.random()*ve)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(C){var S,A,F,P,k,H=0,D=[],V=new z(E);if(C==null?C=M:x(C,0,b),P=l(C/p),K)if(crypto.getRandomValues){for(S=crypto.getRandomValues(new Uint32Array(P*=2));H<P;)9e15<=(k=131072*S[H]+(S[H+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),S[H]=A[0],S[H+1]=A[1]):(D.push(k%1e14),H+=2);H=P/2}else{if(!crypto.randomBytes)throw K=!1,Error(c+"crypto unavailable");for(S=crypto.randomBytes(P*=7);H<P;)9e15<=(k=281474976710656*(31&S[H])+1099511627776*S[H+1]+4294967296*S[H+2]+16777216*S[H+3]+(S[H+4]<<16)+(S[H+5]<<8)+S[H+6])?crypto.randomBytes(7).copy(S,H):(D.push(k%1e14),H+=7);H=P/7}if(!K)for(;H<P;)(k=Pe())<9e15&&(D[H++]=k%1e14);for(P=D[--H],C%=p,P&&C&&(k=v[p-C],D[H]=u(P/k)*k);D[H]===0;D.pop(),H--);if(H<0)D=[F=0];else{for(F=-1;D[0]===0;D.splice(0,1),F-=p);for(H=1,k=D[0];10<=k;k/=10,H++);H<p&&(F-=p-H)}return V.e=F,V.c=D,V}),z.sum=function(){for(var C=1,S=arguments,A=new z(S[0]);C<S.length;)A=A.plus(S[C++]);return A},oe=function(){var C="0123456789";function S(A,F,P,k){for(var H,D,V=[0],$=0,U=A.length;$<U;){for(D=V.length;D--;V[D]*=F);for(V[0]+=k.indexOf(A.charAt($++)),H=0;H<V.length;H++)V[H]>P-1&&(V[H+1]==null&&(V[H+1]=0),V[H+1]+=V[H]/P|0,V[H]%=P)}return V.reverse()}return function(A,F,P,k,H){var D,V,$,U,re,fe,be,xe,Ve=A.indexOf("."),St=M,Ze=O;for(0<=Ve&&(U=Ae,Ae=0,A=A.replace(".",""),fe=(xe=new z(F)).pow(A.length-Ve),Ae=U,xe.c=S(ne(I(fe.c),fe.e,"0"),10,P,C),xe.e=xe.c.length),$=U=(be=S(A,F,P,H?(D=Oe,C):(D=C,Oe))).length;be[--U]==0;be.pop());if(!be[0])return D.charAt(0);if(Ve<0?--$:(fe.c=be,fe.e=$,fe.s=k,be=(fe=ie(fe,xe,St,Ze,P)).c,re=fe.r,$=fe.e),Ve=be[V=$+St+1],U=P/2,re=re||V<0||be[V+1]!=null,re=Ze<4?(Ve!=null||re)&&(Ze==0||Ze==(fe.s<0?3:2)):U<Ve||Ve==U&&(Ze==4||re||Ze==6&&1&be[V-1]||Ze==(fe.s<0?8:7)),V<1||!be[0])A=re?ne(D.charAt(1),-St,D.charAt(0)):D.charAt(0);else{if(be.length=V,re)for(--P;++be[--V]>P;)be[V]=0,V||(++$,be=[1].concat(be));for(U=be.length;!be[--U];);for(Ve=0,A="";Ve<=U;A+=D.charAt(be[Ve++]));A=ne(A,$,D.charAt(0))}return A}}(),ie=function(){function C(F,P,k){var H,D,V,$,U=0,re=F.length,fe=P%y,be=P/y|0;for(F=F.slice();re--;)U=((D=fe*(V=F[re]%y)+(H=be*V+($=F[re]/y|0)*fe)%y*y+U)/k|0)+(H/y|0)+be*$,F[re]=D%k;return U&&(F=[U].concat(F)),F}function S(F,P,k,H){var D,V;if(k!=H)V=H<k?1:-1;else for(D=V=0;D<k;D++)if(F[D]!=P[D]){V=F[D]>P[D]?1:-1;break}return V}function A(F,P,k,H){for(var D=0;k--;)F[k]-=D,D=F[k]<P[k]?1:0,F[k]=D*H+F[k]-P[k];for(;!F[0]&&1<F.length;F.splice(0,1));}return function(F,P,k,H,D){var V,$,U,re,fe,be,xe,Ve,St,Ze,ct,_t,fa,Nl,Vt,dn,hs,Pn=F.s==P.s?1:-1,tn=F.c,yt=P.c;if(!(tn&&tn[0]&&yt&&yt[0]))return new z(F.s&&P.s&&(tn?!yt||tn[0]!=yt[0]:yt)?tn&&tn[0]==0||!yt?0*Pn:Pn/0:NaN);for(St=(Ve=new z(Pn)).c=[],Pn=k+($=F.e-P.e)+1,D||(D=f,$=_(F.e/p)-_(P.e/p),Pn=Pn/p|0),U=0;yt[U]==(tn[U]||0);U++);if(yt[U]>(tn[U]||0)&&$--,Pn<0)St.push(1),re=!0;else{for(Nl=tn.length,dn=yt.length,Pn+=2,1<(fe=u(D/(yt[U=0]+1)))&&(yt=C(yt,fe,D),tn=C(tn,fe,D),dn=yt.length,Nl=tn.length),fa=dn,ct=(Ze=tn.slice(0,dn)).length;ct<dn;Ze[ct++]=0);hs=yt.slice(),hs=[0].concat(hs),Vt=yt[0],yt[1]>=D/2&&Vt++;do{if(fe=0,(V=S(yt,Ze,dn,ct))<0){if(_t=Ze[0],dn!=ct&&(_t=_t*D+(Ze[1]||0)),1<(fe=u(_t/Vt)))for(D<=fe&&(fe=D-1),xe=(be=C(yt,fe,D)).length,ct=Ze.length;S(be,Ze,xe,ct)==1;)fe--,A(be,dn<xe?hs:yt,xe,D),xe=be.length,V=1;else fe==0&&(V=fe=1),xe=(be=yt.slice()).length;if(xe<ct&&(be=[0].concat(be)),A(Ze,be,ct,D),ct=Ze.length,V==-1)for(;S(yt,Ze,dn,ct)<1;)fe++,A(Ze,dn<ct?hs:yt,ct,D),ct=Ze.length}else V===0&&(fe++,Ze=[0]);St[U++]=fe,Ze[0]?Ze[ct++]=tn[fa]||0:(Ze=[tn[fa]],ct=1)}while((fa++<Nl||Ze[0]!=null)&&Pn--);re=Ze[0]!=null,St[0]||St.splice(0,1)}if(D==f){for(U=1,Pn=St[0];10<=Pn;Pn/=10,U++);He(Ve,k+(Ve.e=U+$*p-1)+1,H,re)}else Ve.e=$,Ve.r=+re;return Ve}}(),tt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ne=/^([^.]+)\.$/,R=/^\.([^.]+)$/,h=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,se=function(C,S,A,F){var P,k=A?S:S.replace(g,"");if(h.test(k))C.s=isNaN(k)?null:k<0?-1:1,C.c=C.e=null;else{if(!A&&(k=k.replace(tt,function(H,D,V){return P=(V=V.toLowerCase())=="x"?16:V=="b"?2:8,F&&F!=P?H:D}),F&&(P=F,k=k.replace(Ne,"$1").replace(R,"0.$1")),S!=k))return new z(k,P);if(z.DEBUG)throw Error(c+"Not a"+(F?" base "+F:"")+" number: "+S);C.c=C.e=C.s=null}},m.absoluteValue=m.abs=function(){var C=new z(this);return C.s<0&&(C.s=1),C},m.comparedTo=function(C,S){return L(this,new z(C,S))},m.decimalPlaces=m.dp=function(C,S){var A,F,P;if(C!=null)return x(C,0,b),S==null?S=O:x(S,0,8),He(new z(this),C+this.e+1,S);if(!(A=this.c))return null;if(F=((P=A.length-1)-_(this.e/p))*p,P=A[P])for(;P%10==0;P/=10,F--);return F<0&&(F=0),F},m.dividedBy=m.div=function(C,S){return ie(this,new z(C,S),M,O)},m.dividedToIntegerBy=m.idiv=function(C,S){return ie(this,new z(C,S),0,1)},m.exponentiatedBy=m.pow=function(C,S){var A,F,P,k,H,D,V,$,U=this;if((C=new z(C)).c&&!C.isInteger())throw Error(c+"Exponent not an integer: "+Re(C));if(S!=null&&(S=new z(S)),H=14<C.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!C.c||!C.c[0])return $=new z(Math.pow(+Re(U),H?2-W(C):+Re(C))),S?$.mod(S):$;if(D=C.s<0,S){if(S.c?!S.c[0]:!S.s)return new z(NaN);(F=!D&&U.isInteger()&&S.isInteger())&&(U=U.mod(S))}else{if(9<C.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||H&&24e7<=U.c[1]:U.c[0]<8e13||H&&U.c[0]<=9999975e7)))return k=U.s<0&&W(C)?-0:0,-1<U.e&&(k=1/k),new z(D?1/k:k);Ae&&(k=l(Ae/p+2))}for(V=H?(A=new z(.5),D&&(C.s=1),W(C)):(P=Math.abs(+Re(C)))%2,$=new z(E);;){if(V){if(!($=$.times(U)).c)break;k?$.c.length>k&&($.c.length=k):F&&($=$.mod(S))}if(P){if((P=u(P/2))===0)break;V=P%2}else if(He(C=C.times(A),C.e+1,1),14<C.e)V=W(C);else{if((P=+Re(C))==0)break;V=P%2}U=U.times(U),k?U.c&&U.c.length>k&&(U.c.length=k):F&&(U=U.mod(S))}return F?$:(D&&($=E.div($)),S?$.mod(S):k?He($,Ae,O,void 0):$)},m.integerValue=function(C){var S=new z(this);return C==null?C=O:x(C,0,8),He(S,S.e+1,C)},m.isEqualTo=m.eq=function(C,S){return L(this,new z(C,S))===0},m.isFinite=function(){return!!this.c},m.isGreaterThan=m.gt=function(C,S){return 0<L(this,new z(C,S))},m.isGreaterThanOrEqualTo=m.gte=function(C,S){return(S=L(this,new z(C,S)))===1||S===0},m.isInteger=function(){return!!this.c&&_(this.e/p)>this.c.length-2},m.isLessThan=m.lt=function(C,S){return L(this,new z(C,S))<0},m.isLessThanOrEqualTo=m.lte=function(C,S){return(S=L(this,new z(C,S)))===-1||S===0},m.isNaN=function(){return!this.s},m.isNegative=function(){return this.s<0},m.isPositive=function(){return 0<this.s},m.isZero=function(){return!!this.c&&this.c[0]==0},m.minus=function(C,S){var A,F,P,k,H=this,D=H.s;if(S=(C=new z(C,S)).s,!D||!S)return new z(NaN);if(D!=S)return C.s=-S,H.plus(C);var V=H.e/p,$=C.e/p,U=H.c,re=C.c;if(!V||!$){if(!U||!re)return U?(C.s=-S,C):new z(re?H:NaN);if(!U[0]||!re[0])return re[0]?(C.s=-S,C):new z(U[0]?H:O==3?-0:0)}if(V=_(V),$=_($),U=U.slice(),D=V-$){for((P=(k=D<0)?(D=-D,U):($=V,re)).reverse(),S=D;S--;P.push(0));P.reverse()}else for(F=(k=(D=U.length)<(S=re.length))?D:S,D=S=0;S<F;S++)if(U[S]!=re[S]){k=U[S]<re[S];break}if(k&&(P=U,U=re,re=P,C.s=-C.s),0<(S=(F=re.length)-(A=U.length)))for(;S--;U[A++]=0);for(S=f-1;D<F;){if(U[--F]<re[F]){for(A=F;A&&!U[--A];U[A]=S);--U[A],U[F]+=f}U[F]-=re[F]}for(;U[0]==0;U.splice(0,1),--$);return U[0]?ye(C,U,$):(C.s=O==3?-1:1,C.c=[C.e=0],C)},m.modulo=m.mod=function(C,S){var A,F,P=this;return C=new z(C,S),!P.c||!C.s||C.c&&!C.c[0]?new z(NaN):!C.c||P.c&&!P.c[0]?new z(P):(de==9?(F=C.s,C.s=1,A=ie(P,C,0,3),C.s=F,A.s*=F):A=ie(P,C,0,de),(C=P.minus(A.times(C))).c[0]||de!=1||(C.s=P.s),C)},m.multipliedBy=m.times=function(C,S){var A,F,P,k,H,D,V,$,U,re,fe,be,xe,Ve,St,Ze=this,ct=Ze.c,_t=(C=new z(C,S)).c;if(!(ct&&_t&&ct[0]&&_t[0]))return!Ze.s||!C.s||ct&&!ct[0]&&!_t||_t&&!_t[0]&&!ct?C.c=C.e=C.s=null:(C.s*=Ze.s,ct&&_t?(C.c=[0],C.e=0):C.c=C.e=null),C;for(F=_(Ze.e/p)+_(C.e/p),C.s*=Ze.s,(V=ct.length)<(re=_t.length)&&(xe=ct,ct=_t,_t=xe,P=V,V=re,re=P),P=V+re,xe=[];P--;xe.push(0));for(Ve=f,St=y,P=re;0<=--P;){for(A=0,fe=_t[P]%St,be=_t[P]/St|0,k=P+(H=V);P<k;)A=(($=fe*($=ct[--H]%St)+(D=be*$+(U=ct[H]/St|0)*fe)%St*St+xe[k]+A)/Ve|0)+(D/St|0)+be*U,xe[k--]=$%Ve;xe[k]=A}return A?++F:xe.splice(0,1),ye(C,xe,F)},m.negated=function(){var C=new z(this);return C.s=-C.s||null,C},m.plus=function(C,S){var A,F=this,P=F.s;if(S=(C=new z(C,S)).s,!P||!S)return new z(NaN);if(P!=S)return C.s=-S,F.minus(C);var k=F.e/p,H=C.e/p,D=F.c,V=C.c;if(!k||!H){if(!D||!V)return new z(P/0);if(!D[0]||!V[0])return V[0]?C:new z(D[0]?F:0*P)}if(k=_(k),H=_(H),D=D.slice(),P=k-H){for((A=0<P?(H=k,V):(P=-P,D)).reverse();P--;A.push(0));A.reverse()}for((P=D.length)-(S=V.length)<0&&(A=V,V=D,D=A,S=P),P=0;S;)P=(D[--S]=D[S]+V[S]+P)/f|0,D[S]=f===D[S]?0:D[S]%f;return P&&(D=[P].concat(D),++H),ye(C,D,H)},m.precision=m.sd=function(C,S){var A,F,P;if(C!=null&&C!==!!C)return x(C,1,b),S==null?S=O:x(S,0,8),He(new z(this),C,S);if(!(A=this.c))return null;if(F=(P=A.length-1)*p+1,P=A[P]){for(;P%10==0;P/=10,F--);for(P=A[0];10<=P;P/=10,F++);}return C&&this.e+1>F&&(F=this.e+1),F},m.shiftedBy=function(C){return x(C,-w,w),this.times("1e"+C)},m.squareRoot=m.sqrt=function(){var C,S,A,F,P,k=this,H=k.c,D=k.s,V=k.e,$=M+4,U=new z("0.5");if(D!==1||!H||!H[0])return new z(!D||D<0&&(!H||H[0])?NaN:H?k:1/0);if((A=(D=Math.sqrt(+Re(k)))==0||D==1/0?(((S=I(H)).length+V)%2==0&&(S+="0"),D=Math.sqrt(+S),V=_((V+1)/2)-(V<0||V%2),new z(S=D==1/0?"1e"+V:(S=D.toExponential()).slice(0,S.indexOf("e")+1)+V)):new z(D+"")).c[0]){for((D=(V=A.e)+$)<3&&(D=0);;)if(P=A,A=U.times(P.plus(ie(k,P,$,1))),I(P.c).slice(0,D)===(S=I(A.c)).slice(0,D)){if(A.e<V&&--D,(S=S.slice(D-3,D+1))!="9999"&&(F||S!="4999")){+S&&(+S.slice(1)||S.charAt(0)!="5")||(He(A,A.e+M+2,1),C=!A.times(A).eq(k));break}if(!F&&(He(P,P.e+M+2,0),P.times(P).eq(k))){A=P;break}$+=4,D+=4,F=1}}return He(A,A.e+M+1,O,C)},m.toExponential=function(C,S){return C!=null&&(x(C,0,b),C++),je(this,C,S,1)},m.toFixed=function(C,S){return C!=null&&(x(C,0,b),C=C+this.e+1),je(this,C,S)},m.toFormat=function(C,S,A){var F;if(A==null)C!=null&&S&&typeof S=="object"?(A=S,S=null):C&&typeof C=="object"?(A=C,C=S=null):A=Ee;else if(typeof A!="object")throw Error(c+"Argument not an object: "+A);if(F=this.toFixed(C,S),this.c){var P,k=F.split("."),H=+A.groupSize,D=+A.secondaryGroupSize,V=A.groupSeparator||"",$=k[0],U=k[1],re=this.s<0,fe=re?$.slice(1):$,be=fe.length;if(D&&(P=H,H=D,be-=D=P),0<H&&0<be){for(P=be%H||H,$=fe.substr(0,P);P<be;P+=H)$+=V+fe.substr(P,H);0<D&&($+=V+fe.slice(P)),re&&($="-"+$)}F=U?$+(A.decimalSeparator||"")+((D=+A.fractionGroupSize)?U.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):U):$}return(A.prefix||"")+F+(A.suffix||"")},m.toFraction=function(C){var S,A,F,P,k,H,D,V,$,U,re,fe,be=this,xe=be.c;if(C!=null&&(!(D=new z(C)).isInteger()&&(D.c||D.s!==1)||D.lt(E)))throw Error(c+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Re(D));if(!xe)return new z(be);for(S=new z(E),$=A=new z(E),F=V=new z(E),fe=I(xe),k=S.e=fe.length-be.e-1,S.c[0]=v[(H=k%p)<0?p+H:H],C=!C||0<D.comparedTo(S)?0<k?S:$:D,H=Q,Q=1/0,D=new z(fe),V.c[0]=0;U=ie(D,S,0,1),(P=A.plus(U.times(F))).comparedTo(C)!=1;)A=F,F=P,$=V.plus(U.times(P=$)),V=P,S=D.minus(U.times(P=S)),D=P;return P=ie(C.minus(A),F,0,1),V=V.plus(P.times($)),A=A.plus(P.times(F)),V.s=$.s=be.s,re=ie($,F,k*=2,O).minus(be).abs().comparedTo(ie(V,A,k,O).minus(be).abs())<1?[$,F]:[V,A],Q=H,re},m.toNumber=function(){return+Re(this)},m.toPrecision=function(C,S){return C!=null&&x(C,1,b),je(this,C,S,2)},m.toString=function(C){var S,A=this,F=A.s,P=A.e;return P===null?F?(S="Infinity",F<0&&(S="-"+S)):S="NaN":(S=C==null?P<=Y||B<=P?G(I(A.c),P):ne(I(A.c),P,"0"):C===10?ne(I((A=He(new z(A),M+P+1,O)).c),A.e,"0"):(x(C,2,Oe.length,"Base"),oe(ne(I(A.c),P,"0"),10,C,F,!0)),F<0&&A.c[0]&&(S="-"+S)),S},m.valueOf=m.toJSON=function(){return Re(this)},m._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(m[Symbol.toStringTag]="BigNumber",m[Symbol.for("nodejs.util.inspect.custom")]=m.valueOf),X!=null&&z.set(X),z}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(_,I){return function(L){if(Array.isArray(L))return L}(_)||function(L,x){var W=[],G=!0,ne=!1,j=void 0;try{for(var X,ie=L[Symbol.iterator]();!(G=(X=ie.next()).done)&&(W.push(X.value),!x||W.length!==x);G=!0);}catch(oe){ne=!0,j=oe}finally{try{G||ie.return==null||ie.return()}finally{if(ne)throw j}}return W}(_,I)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(_){var I=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},L=2<arguments.length?arguments[2]:void 0;if(typeof I=="string"&&(I=l.parseFormat(I)),!a.validateFormat(I))return"ERROR: invalid format";var x=I.prefix||"",W=I.postfix||"",G=function(ne,j,X){switch(j.output){case"currency":return j=b(j,s.currentCurrencyDefaultFormat()),function(Oe,z,je){var ke=je.currentCurrency(),ye=Object.assign({},d,z),He=void 0,Re="",C=!!ye.totalLength||!!ye.forceAverage||ye.average,S=z.currencyPosition||ke.position,A=z.currencySymbol||ke.symbol;ye.spaceSeparated&&(Re=" "),S==="infix"&&(He=Re+A+Re);var F=y({instance:Oe,providedFormat:z,state:je,decimalSeparator:He});return S==="prefix"&&(F=Oe._value<0&&ye.negative==="sign"?"-".concat(Re).concat(A).concat(F.slice(1)):A+Re+F),S&&S!=="postfix"||(F=F+(Re=C?"":Re)+A),F}(ne,j,s);case"percent":return j=b(j,s.currentPercentageDefaultFormat()),function(Oe,z,je,ke){var ye=z.prefixSymbol,He=y({instance:ke(100*Oe._value),providedFormat:z,state:je}),Re=Object.assign({},d,z);return ye?"%".concat(Re.spaceSeparated?" ":"").concat(He):"".concat(He).concat(Re.spaceSeparated?" ":"","%")}(ne,j,s,X);case"byte":return j=b(j,s.currentByteDefaultFormat()),E=ne,O=s,Y=X,B=(M=j).base||"binary",q=c[B],Q=p(E._value,q.suffixes,q.scale),K=Q.value,de=Q.suffix,Ae=y({instance:Y(K),providedFormat:M,state:O,defaults:O.currentByteDefaultFormat()}),Ee=O.currentAbbreviations(),"".concat(Ae).concat(Ee.spaced?" ":"").concat(de);case"time":return j=b(j,s.currentTimeDefaultFormat()),R=ne,h=Math.floor(R._value/60/60),g=Math.floor((R._value-60*h*60)/60),m=Math.round(R._value-60*h*60-60*g),"".concat(h,":").concat(g<10?"0":"").concat(g,":").concat(m<10?"0":"").concat(m);case"ordinal":return j=b(j,s.currentOrdinalDefaultFormat()),ie=ne,oe=j,ve=(se=s).currentOrdinal(),Pe=Object.assign({},d,oe),tt=y({instance:ie,providedFormat:oe,state:se}),Ne=ve(ie._value),"".concat(tt).concat(Pe.spaceSeparated?" ":"").concat(Ne);case"number":default:return y({instance:ne,providedFormat:j,numbro:X})}var ie,oe,se,ve,Pe,tt,Ne,R,h,g,m,E,M,O,Y,B,q,Q,K,de,Ae,Ee}(_,I,L);return G=(G=x+G)+W}function p(_,I,L){var x=I[0],W=Math.abs(_);if(L<=W){for(var G=1;G<I.length;++G){var ne=Math.pow(L,G),j=Math.pow(L,G+1);if(ne<=W&&W<j){x=I[G],_/=ne;break}}x===I[0]&&(_/=Math.pow(L,I.length-1),x=I[I.length-1])}return{value:_,suffix:x}}function w(_){for(var I="",L=0;L<_;L++)I+="0";return I}function v(_,I){return _.toString().indexOf("e")!==-1?function(L,x){var W=L.toString(),G=o(W.split("e"),2),ne=G[0],j=G[1],X=o(ne.split("."),2),ie=X[0],oe=X[1],se=oe===void 0?"":oe;if(0<+j)W=ie+se+w(j-se.length);else{var ve=".";ve=+ie<0?"-0".concat(ve):"0".concat(ve);var Pe=(w(-j-1)+Math.abs(ie)+se).substr(0,x);Pe.length<x&&(Pe+=w(x-Pe.length)),W=ve+Pe}return 0<+j&&0<x&&(W+=".".concat(w(x))),W}(_,I):(Math.round(+"".concat(_,"e+").concat(I))/Math.pow(10,I)).toFixed(I)}function y(_){var I=_.instance,L=_.providedFormat,x=_.state,W=x===void 0?s:x,G=_.decimalSeparator,ne=_.defaults,j=ne===void 0?W.currentDefaults():ne,X=I._value;if(X===0&&W.hasZeroFormat())return W.getZeroFormat();if(!isFinite(X))return X.toString();var ie,oe,se,ve,Pe,tt,Ne,R,h=Object.assign({},d,j,L),g=h.totalLength,m=g?0:h.characteristic,E=h.optionalCharacteristic,M=h.forceAverage,O=!!g||!!M||h.average,Y=g?-1:O&&L.mantissa===void 0?0:h.mantissa,B=!g&&(L.optionalMantissa===void 0?Y===-1:h.optionalMantissa),q=h.trimMantissa,Q=h.thousandSeparated,K=h.spaceSeparated,de=h.negative,Ae=h.forceSign,Ee=h.exponential,Oe="";if(O){var z=function(C){var S=C.value,A=C.forceAverage,F=C.abbreviations,P=C.spaceSeparated,k=P!==void 0&&P,H=C.totalLength,D=H===void 0?0:H,V="",$=Math.abs(S),U=-1;if($>=Math.pow(10,12)&&!A||A==="trillion"?(V=F.trillion,S/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!A||A==="billion"?(V=F.billion,S/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!A||A==="million"?(V=F.million,S/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!A||A==="thousand")&&(V=F.thousand,S/=Math.pow(10,3)),V&&(V=(k?" ":"")+V),D){var re=S.toString().split(".")[0];U=Math.max(D-re.length,0)}return{value:S,abbreviation:V,mantissaPrecision:U}}({value:X,forceAverage:M,abbreviations:W.currentAbbreviations(),spaceSeparated:K,totalLength:g});X=z.value,Oe+=z.abbreviation,g&&(Y=z.mantissaPrecision)}if(Ee){var je=(oe=(ie={value:X,characteristicPrecision:m}).value,se=ie.characteristicPrecision,ve=se===void 0?0:se,Pe=o(oe.toExponential().split("e"),2),tt=Pe[0],Ne=Pe[1],R=+tt,ve&&1<ve&&(R*=Math.pow(10,ve-1),Ne=0<=(Ne=+Ne-(ve-1))?"+".concat(Ne):Ne),{value:R,abbreviation:"e".concat(Ne)});X=je.value,Oe=je.abbreviation+Oe}var ke,ye,He,Re=function(C,S,A,F,P){if(F===-1)return C;var k=v(S,F),H=o(k.toString().split("."),2),D=H[0],V=H[1],$=V===void 0?"":V;if($.match(/^0+$/)&&(A||P))return D;var U=$.match(/0+$/);return P&&U?"".concat(D,".").concat($.toString().slice(0,U.index)):k.toString()}(X.toString(),X,B,Y,q);return Re=function(C,S,A,F,P){var k=F.currentDelimiters(),H=k.thousands;P=P||k.decimal;var D=k.thousandsSize||3,V=C.toString(),$=V.split(".")[0],U=V.split(".")[1];return A&&(S<0&&($=$.slice(1)),function(re,fe){for(var be=[],xe=0,Ve=re;0<Ve;Ve--)xe===fe&&(be.unshift(Ve),xe=0),xe++;return be}($.length,D).forEach(function(re,fe){$=$.slice(0,re+fe)+H+$.slice(re+fe)}),S<0&&($="-".concat($))),V=U?$+P+U:$}(Re=function(C,S,A,F){var P=C,k=o(P.toString().split("."),2),H=k[0],D=k[1];if(H.match(/^-?0$/)&&A)return D?"".concat(H.replace("0",""),".").concat(D):H.replace("0","");if(H.length<F)for(var V=F-H.length,$=0;$<V;$++)P="0".concat(P);return P.toString()}(Re,0,E,m),X,Q,W,G),(O||Ee)&&(Re=Re+Oe),(Ae||X<0)&&(ke=Re,He=de,Re=(ye=X)===0?ke:+ke==0?ke.replace("-",""):0<ye?"+".concat(ke):He==="sign"?ke:"(".concat(ke.replace("-",""),")")),Re}function b(_,I){if(!_)return I;var L=Object.keys(_);return L.length===1&&L[0]==="output"?I:_}r.exports=function(_){return{format:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return f.apply(void 0,L.concat([_]))},getByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(W){var G=c.general;return p(W._value,G.suffixes,G.scale).suffix}).apply(void 0,L.concat([_]))},getBinaryByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(W){var G=c.binary;return p(W._value,G.suffixes,G.scale).suffix}).apply(void 0,L.concat([_]))},getDecimalByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(W){var G=c.decimal;return p(W._value,G.suffixes,G.scale).suffix}).apply(void 0,L.concat([_]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},d=null,f={};function p(v){u=v}function w(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return w().currency},l.currentAbbreviations=function(){return w().abbreviations},l.currentDelimiters=function(){return w().delimiters},l.currentOrdinal=function(){return w().ordinal},l.currentDefaults=function(){return Object.assign({},w().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().timeFormat)},l.setDefaults=function(v){v=a.parseFormat(v),s.validateFormat(v)&&(f=v)},l.getZeroFormat=function(){return d},l.setZeroFormat=function(v){return d=typeof v=="string"?v:null},l.hasZeroFormat=function(){return d!==null},l.languageData=function(v){if(v){if(c[v])return c[v];throw new Error('Unknown tag "'.concat(v,'"'))}return w()},l.registerLanguage=function(v){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(v))throw new Error("Invalid language data");c[v.languageTag]=v,y&&p(v.languageTag)},l.setLanguage=function(v){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[v]){var b=v.split("-")[0],_=Object.keys(c).find(function(I){return I.split("-")[0]===b});return c[_]?void p(_):void p(y)}p(v)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),d=l;return u.isNumbro(l)&&(d=l._value),d=new o(d),a._value=c.minus(d).toNumber(),a}r.exports=function(a){return{add:function(l,u){return d=u,f=a,p=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=p.plus(w).toNumber(),c;var c,d,f,p,w},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return d=u,f=a,p=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=p.times(w).toNumber(),c;var c,d,f,p,w},divide:function(l,u){return d=u,f=a,p=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=p.dividedBy(w).toNumber(),c;var c,d,f,p,w},set:function(l,u){return c=l,f=d=u,a.isNumbro(d)&&(f=d._value),c._value=f,c;var c,d,f},difference:function(l,u){return c=u,s(f=(d=a)(l._value),c,d),Math.abs(f._value);var c,d,f}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(y,b){for(var _=0;_<b.length;_++){var I=b[_];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(y,I.key,I)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(v),u=n("./unformatting"),c=n("./formatting")(v),d=n("./manipulating")(v),f=n("./parsing"),p=function(){function y(I){(function(L,x){if(!(L instanceof x))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=I}var b,_;return b=y,(_=[{key:"clone",value:function(){return v(this._value)}},{key:"format",value:function(){var I=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,I)}},{key:"formatCurrency",value:function(I){return typeof I=="string"&&(I=f.parseFormat(I)),(I=c.formatOrDefault(I,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,I)}},{key:"formatTime",value:function(){var I=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return I.output="time",c.format(this,I)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(I){return d.difference(this,I)}},{key:"add",value:function(I){return d.add(this,I)}},{key:"subtract",value:function(I){return d.subtract(this,I)}},{key:"multiply",value:function(I){return d.multiply(this,I)}},{key:"divide",value:function(I){return d.divide(this,I)}},{key:"set",value:function(I){return d.set(this,w(I))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(b.prototype,_),y}();function w(y){var b=y;return v.isNumbro(y)?b=y._value:typeof y=="string"?b=v.unformat(y):isNaN(y)&&(b=NaN),b}function v(y){return new p(w(y))}v.version="2.1.2",v.isNumbro=function(y){return y instanceof p},v.language=s.currentLanguage,v.registerLanguage=s.registerLanguage,v.setLanguage=s.setLanguage,v.languages=s.languages,v.languageData=s.languageData,v.zeroFormat=s.setZeroFormat,v.defaultFormat=s.currentDefaults,v.setDefaults=s.setDefaults,v.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,v.validate=a.validate,v.loadLanguagesInNode=l.loadLanguagesInNode,v.unformat=u.unformat,r.exports=v},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,d,f,p,w,v,y,b,_,I,L,x,W,G,ne,j,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=X,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=X,function(ie,oe){if(ie.indexOf("$")===-1){if(ie.indexOf("%")===-1)return ie.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):ie.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):ie.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):ie.indexOf(":")===-1?ie.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(o=(d=(u=o).match(/{([^}]*)}$/))?(c.postfix=d[1],u.slice(0,-d[0].length)):u,X),f=X,(p=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+p[0]),w=X,(v=o.split(".")[0].match(/0+/))&&(w.characteristic=v[0].length),function(ie,oe){if(ie.indexOf(".")!==-1){var se=ie.split(".")[0];oe.optionalCharacteristic=se.indexOf("0")===-1}}(o,X),y=X,o.indexOf("a")!==-1&&(y.average=!0),_=X,(b=o).indexOf("K")!==-1?_.forceAverage="thousand":b.indexOf("M")!==-1?_.forceAverage="million":b.indexOf("B")!==-1?_.forceAverage="billion":b.indexOf("T")!==-1&&(_.forceAverage="trillion"),function(ie,oe){var se=ie.split(".")[1];if(se){var ve=se.match(/0+/);ve&&(oe.mantissa=ve[0].length)}}(o,X),L=X,(I=o).match(/\[\.]/)?L.optionalMantissa=!0:I.match(/\./)&&(L.optionalMantissa=!1),x=X,o.indexOf(",")!==-1&&(x.thousandSeparated=!0),W=X,o.indexOf(" ")!==-1&&(W.spaceSeparated=!0),ne=X,(G=o).match(/^\+?\([^)]*\)$/)&&(ne.negative="parenthesis"),G.match(/^\+?-/)&&(ne.negative="sign"),j=X,o.match(/^\+/)&&(j.forceSign=!0),X)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,p=5<arguments.length?arguments[5]:void 0,w=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function v(y,b){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",I=3<arguments.length?arguments[3]:void 0,L=4<arguments.length?arguments[4]:void 0,x=5<arguments.length?arguments[5]:void 0,W=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var G="",ne=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ne!==y)return-1*v(ne,b,_,I,L,x,W);for(var j=0;j<o.length;j++){var X=o[j];if((G=y.replace(X.key,""))!==y)return v(G,b,_,I,L,x,W)*X.factor}if((G=y.replace("%",""))!==y)return v(G,b,_,I,L,x,W)/100;var ie=parseFloat(y);if(!isNaN(ie)){var oe=I(ie);if(oe&&oe!=="."&&(G=y.replace(new RegExp("".concat(s(oe),"$")),""))!==y)return v(G,b,_,I,L,x,W);var se={};Object.keys(x).forEach(function(g){se[x[g]]=g});for(var ve=Object.keys(se).sort().reverse(),Pe=ve.length,tt=0;tt<Pe;tt++){var Ne=ve[tt],R=se[Ne];if((G=y.replace(Ne,""))!==y){var h=void 0;switch(R){case"thousand":h=Math.pow(10,3);break;case"million":h=Math.pow(10,6);break;case"billion":h=Math.pow(10,9);break;case"trillion":h=Math.pow(10,12)}return v(G,b,_,I,L,x,W)*h}}}}(function(v,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=v.replace(b,"");return _=(_=_.replace(new RegExp("([0-9])".concat(s(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(l,u,c),u,c,d,f,p,w)}r.exports={unformat:function(l,u){var c,d,f,p=n("./globalState"),w=p.currentDelimiters(),v=p.currentCurrency().symbol,y=p.currentOrdinal(),b=p.getZeroFormat(),_=p.currentAbbreviations(),I=void 0;if(typeof l=="string")I=function(L,x){if(!L.indexOf(":")||x.thousands===":")return!1;var W=L.split(":");if(W.length!==3)return!1;var G=+W[0],ne=+W[1],j=+W[2];return!isNaN(G)&&!isNaN(ne)&&!isNaN(j)}(l,w)?(c=l.split(":"),d=+c[0],f=+c[1],+c[2]+60*f+3600*d):a(l,w,v,y,b,_,u);else{if(typeof l!="number")return;I=l}if(I!==void 0)return I}}},{"./globalState":4}],10:[function(n,r,i){function o(w){return function(v){if(Array.isArray(v)){for(var y=0,b=new Array(v.length);y<v.length;y++)b[y]=v[y];return b}}(w)||function(v){if(Symbol.iterator in Object(v)||Object.prototype.toString.call(v)==="[object Arguments]")return Array.from(v)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(w){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(w)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(w,v){return v.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(w){return w.output==="byte"}},characteristic:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(w){return 0<=w},message:"value must be positive"},{restriction:function(w,v){return!v.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(w,v){return v.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(w){return w.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(w){return!!a.unformat(w)}function f(w,v,y){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],_=Object.keys(w).map(function(I){if(!v[I])return console.error("".concat(y," Invalid key: ").concat(I)),!1;var L=w[I],x=v[I];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!f(L,u,"[Validate ".concat(I,"]"),!0))return!1}else if(s(L)!==x.type)return console.error("".concat(y," ").concat(I,' type mismatched: "').concat(x.type,'" expected, "').concat(s(L),'" provided')),!1;if(x.restrictions&&x.restrictions.length)for(var W=x.restrictions.length,G=0;G<W;G++){var ne=x.restrictions[G],j=ne.restriction,X=ne.message;if(!j(L,w))return console.error("".concat(y," ").concat(I," invalid value: ").concat(X)),!1}return x.restriction&&!x.restriction(L,w)?(console.error("".concat(y," ").concat(I," invalid value: ").concat(x.message)),!1):x.validValues&&x.validValues.indexOf(L)===-1?(console.error("".concat(y," ").concat(I," invalid value: must be among ").concat(JSON.stringify(x.validValues),', "').concat(L,'" provided')),!1):!(x.children&&!f(L,x.children,"[Validate ".concat(I,"]")))});return b||_.push.apply(_,o(Object.keys(v).map(function(I){var L=v[I];if(typeof L=="string"&&(L={type:L}),L.mandatory){var x=L.mandatory;if(typeof x=="function"&&(x=x(w)),x&&w[I]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(I,'"')),!1}return!0}))),_.reduce(function(I,L){return I&&L},!0)}function p(w){return f(w,u,"[Validate format]")}r.exports={validate:function(w,v){var y=d(w),b=p(v);return y&&b},validateFormat:p,validateInput:d,validateLanguage:function(w){return f(w,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(Ix);var b5=Ix.exports;const ys=RA(b5),R5="numeric";function Jy(t,e,n,r,i,o,s){let a=o;if(Vn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,d=s.className||"",f=d.length?d.split(" "):[];if(typeof u<"u"&&!ys.languages()[u]){const p=u.replace("-",""),w=ys.allLanguages?ys.allLanguages[u]:ys[p];w&&ys.registerLanguage(w)}ys.setLanguage(u),a=ys(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}To(t,e,n,r,i,a,s)}Jy.RENDERER_TYPE=R5;const E5="password";function eb(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";Ce(a-1,()=>{u+=l}),ca(e,u)}eb.RENDERER_TYPE=E5;const T5="time";function tb(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}tb.RENDERER_TYPE=T5;function _5(){Ci(xl),Ci(Hc),Ci(Zy),Ci(qy),Ci(Jy),Ci(eb),Ci(To),Ci(tb)}const M5="autocomplete";function vg(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,hE(n,e)):hE(n,e)(this.source):e(!0)}vg.VALIDATOR_TYPE=M5;function hE(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function Px(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const A5=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:Px},Symbol.toStringTag,{value:"Module"})),O5="date";function nb(t,e){const n=qI(Rx,this.instance);let r=t,i=!0;r==null&&(r="");let o=Z(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Z(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=I5(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}nb.VALIDATOR_TYPE=O5;function I5(t,e){const n=Z(Px(t)),r=Z(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const P5="numeric";function rb(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Vn(t))}rb.VALIDATOR_TYPE=P5;const x5=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],H5="time";function ib(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Z(i,x5,!0).isValid()?Z(i):Z(i,n);let a=s.isValid(),l=Z(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,d,u,"timeValidator"),r=!0}else r=!1;e(r)}ib.VALIDATOR_TYPE=H5;function D5(){ul(vg),ul(nb),ul(rb),ul(ib)}const N5="autocomplete",L5={CELL_TYPE:N5,editor:Ky,renderer:xl,validator:vg},$5="checkbox",k5={CELL_TYPE:$5,editor:yx,renderer:Zy},F5="date";function xx(t,e,n,r,i,o,s){xl.apply(this,[t,e,n,r,i,o,s])}xx.RENDERER_TYPE=F5;const W5="date",V5={CELL_TYPE:W5,editor:Ex,renderer:xx,validator:nb},B5="dropdown",U5={CELL_TYPE:B5,editor:Xy,renderer:xl,validator:vg},Y5="handsontable";function Hx(t,e,n,r,i,o,s){xl.apply(this,[t,e,n,r,i,o,s])}Hx.RENDERER_TYPE=Y5;const G5="handsontable",z5={CELL_TYPE:G5,editor:jy,renderer:Hx},j5="numeric",K5={CELL_TYPE:j5,editor:Tx,renderer:Jy,validator:rb,dataType:"number"},X5="password",q5={CELL_TYPE:X5,editor:_x,renderer:eb,copyable:!1},Z5="select";function Dx(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s])}Dx.RENDERER_TYPE=Z5;const Q5="select",J5={CELL_TYPE:Q5,editor:Mx,renderer:Dx},e8="time",t8={CELL_TYPE:e8,editor:Ax,renderer:tb,validator:ib};function n8(){Sr(L5),Sr(k5),Sr(V5),Sr(U5),Sr(z5),Sr(K5),Sr(q5),Sr(J5),Sr(Sx),Sr(t8)}function r8(t,e){Nx(t,e),e.add(t)}function i8(t,e,n){Nx(t,e),e.set(t,n)}function Nx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ra(t,e,n){return e=o8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o8(t){var e=s8(t,"string");return typeof e=="symbol"?e:String(e)}function s8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function a8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ea(t,e){var n=l8(t,e,"get");return u8(t,n)}function l8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function u8(t,e){return e.get?e.get.call(t):e.value}const dE=new Map([["plugin",ZG],["cell-type",cx],["editor",XI],["renderer",iP],["validator",oP]]),c8="base",Xm=[];let ui=null;var bs=new WeakMap,fE=new WeakSet;class ot{static get PLUGIN_KEY(){return c8}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){r8(this,fE),Ra(this,"eventManager",new gr(this)),Ra(this,"pluginName",null),Ra(this,"pluginsInitializedCallbacks",[]),Ra(this,"isPluginsReady",!1),Ra(this,"enabled",!1),Ra(this,"initialized",!1),i8(this,bs,{writable:!0,value:{}}),Hi(this,"hot",e,{writable:!1}),ui=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!dE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);dE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Xm.push(o)}}if(ui||(ui=Yv()),ui.indexOf("UndoRedo")>=0&&ui.splice(ui.indexOf("UndoRedo"),1),ui.indexOf(this.pluginName)>=0&&ui.splice(ui.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ui.length===0){if(Xm.length>0){const i=[`${Xm.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){Ea(this,bs)[e]=Ea(this,bs)[e]||[];const r=Ea(this,bs)[e];this.hot.addHook(e,n),r.push(n),Ea(this,bs)[e]=r}removeHooks(e){T(Ea(this,bs)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Ea(this,bs);Ye(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){T(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=a8(this,fE,h8).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ye(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function h8(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Rs(t,e,n){return e=d8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d8(t){var e=f8(t,"string");return typeof e=="symbol"?e:String(e)}function f8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let g8=class{constructor(e){Rs(this,"hot",null),Rs(this,"container",null),Rs(this,"injected",!1),Rs(this,"rows",[]),Rs(this,"columns",[]),Rs(this,"samples",null),Rs(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),T(this.rows,n=>{e(n.row,Pt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),T(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{T(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{T(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{T(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),T(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{T(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),J(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return J(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const ob=g8;function Eh(t,e,n){return e=m8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m8(t){var e=p8(t,"string");return typeof e=="symbol"?e:String(e)}function p8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sb{static get SAMPLE_COUNT(){return 3}constructor(e){Eh(this,"samples",null),Eh(this,"dataFactory",null),Eh(this,"customSampleCount",null),Eh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:sb.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return Ce(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return Ce(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,d=typeof c=="string"&&c.length>0;let f;d?f=c:Be(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Ft(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const p=i.get(f);p.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||d)&&(p.strings.push({value:u,[o]:a}),s.push(u),p.needed-=1)}),i}}const Lx=sb;function Ta(t,e){$x(t,e),e.add(t)}function w8(t,e,n){$x(t,e),e.set(t,n)}function $x(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _a(t,e,n){return e=C8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C8(t){var e=v8(t,"string");return typeof e=="symbol"?e:String(e)}function v8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S8(t,e,n){var r=kx(t,e,"set");return y8(t,r,n),n}function y8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Th(t,e){var n=kx(t,e,"get");return b8(t,n)}function kx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b8(t,e){return e.get?e.get.call(t):e.value}function Es(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("modifyAutoColumnSizeSeed");const Ql="autoColumnSize",R8=10,E8="autoColumnSize";var rl=new WeakMap,gE=new WeakSet,mE=new WeakSet,pE=new WeakSet,qm=new WeakSet,wE=new WeakSet,CE=new WeakSet;class ku extends ot{static get PLUGIN_KEY(){return Ql}static get PLUGIN_PRIORITY(){return R8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Ta(this,CE),Ta(this,wE),Ta(this,qm),Ta(this,pE),Ta(this,mE),Ta(this,gE),_a(this,"ghostTable",new ob(this.hot)),_a(this,"samplesGenerator",new Lx((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),_a(this,"firstCalculation",!0),_a(this,"inProgress",!1),_a(this,"measuredColumns",0),_a(this,"columnWidthsMap",new cs),w8(this,rl,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(E8,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Es(this,qm,vE).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Ql]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Ql];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Es(e,mE,_8).call(e,...i)}),this.addHook("beforeChangeRender",r=>Es(this,pE,M8).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>Es(this,CE,O8).call(this,r)),this.addHook("beforeViewRender",r=>Es(this,gE,T8).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>Es(this,wE,A8).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Es(this,qm,vE).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;Ce(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);T(l,u=>{let[c,d]=u;return this.ghostTable.addColumn(c,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){ac(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+ku.CALCULATION_STEP,r)},e),n=n+ku.CALCULATION_STEP+1,n<r?i=cg(o):(ac(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Ql],n=e&&It(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&It(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Ql];let n=ku.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Be(e)&&(n=e.syncLimit,Rv(n)?n=Bv(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,jv.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Yt(e,(r,i,o)=>{const s=Th(this,rl).length;return(s-1<o||Th(this,rl)[o]!==i)&&r.push(o),s-1<o?Th(this,rl).push(i):Th(this,rl)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{T(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!fr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function T8(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function _8(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function M8(t){const e=Ue(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function vE(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function A8(){S8(this,rl,this.hot.getColHeader())}function O8(t){const e=fr(t,r=>{var i;return ce((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ue(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const zs={horizontal:"horizontal",vertical:"vertical"};function I8(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function P8(t){const e={};return t===!0?(e.directions=Object.keys(zs),e.autoInsertRow=!0):Be(t)?(ce(t.autoInsertRow)?t.direction===zs.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ce(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(zs)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Jl(t,e){x8(t,e),e.add(t)}function x8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ma(t,e,n){return e=H8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H8(t){var e=D8(t,"string");return typeof e=="symbol"?e:String(e)}function D8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("modifyAutofillRange");ge.getSingleton().register("beforeAutofill");ge.getSingleton().register("afterAutofill");const SE="autofill",N8=20,L8=["fillHandle"],$8="insert_row_below",k8=200;var yE=new WeakSet,bE=new WeakSet,RE=new WeakSet,EE=new WeakSet,TE=new WeakSet;class F8 extends ot{constructor(){super(...arguments),Jl(this,TE),Jl(this,EE),Jl(this,RE),Jl(this,bE),Jl(this,yE),Ma(this,"addingStarted",!1),Ma(this,"mouseDownOnCellCorner",!1),Ma(this,"mouseDragOutside",!1),Ma(this,"handleDraggedCells",0),Ma(this,"directions",[]),Ma(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return SE}static get PLUGIN_PRIORITY(){return N8}static get SETTING_KEYS(){return[SE,...L8]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>eu(this,bE,V8).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>eu(this,yE,W8).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>eu(this,RE,B8).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return T(s,c=>{for(let d=c.startRow;d<=c.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=c.startCol;d<=c.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),T(a,c=>{const d=[];T(l,f=>{d.push(this.hot.getCopyableData(c,f))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:d,endOfDragCoords:f}=I8(l,u,(p,w)=>this.hot._createCellCoords(p,w));if(d&&d.row>-1&&d.col>-1){const p=this.getSelectionData(),w=o.clone(),v=this.hot._createCellRange(d,d,f),y=this.hot.runHooks("beforeAutofill",p,w,v,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=y;const _=y;if(["up","left"].indexOf(c)>-1&&!(_.length===1&&_[0].length===0))if(b=[],c==="up"){const I=f.row-d.row+1,L=I%_.length;for(let x=0;x<I;x++)b.push(_[(x+(_.length-L))%_.length])}else{const I=f.col-d.col+1,L=I%_[0].length;for(let x=0;x<_.length;x++){b.push([]);for(let W=0;W<I;W++)b[x].push(_[x][(W+(_[x].length-L))%_[x].length])}}this.hot.populateFromArray(d.row,d.col,b,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",b,w,v,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(zs.vertical)&&this.directions.includes(zs.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(zs.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(zs.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter($8,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},k8)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=jt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Pt(this.hot.table),i=jt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+dt(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>eu(this,EE,U8).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>eu(this,TE,Y8).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=P8(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function W8(){this.selectAdjacent()&&this.fillIn()}function V8(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function B8(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function U8(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Y8(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function _h(t,e){G8(t,e),e.add(t)}function G8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ts(t,e,n){return e=z8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z8(t){var e=j8(t,"string");return typeof e=="symbol"?e:String(e)}function j8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Mh="autoRowSize",K8=40,X8="autoRowSize";var _E=new WeakSet,Zm=new WeakSet,ME=new WeakSet,AE=new WeakSet;class Fu extends ot{static get PLUGIN_KEY(){return Mh}static get PLUGIN_PRIORITY(){return K8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),_h(this,AE),_h(this,ME),_h(this,Zm),_h(this,_E),Ts(this,"headerHeight",null),Ts(this,"ghostTable",new ob(this.hot)),Ts(this,"samplesGenerator",new Lx((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),Ts(this,"firstCalculation",!0),Ts(this,"inProgress",!1),Ts(this,"measuredRows",0),Ts(this,"rowHeightsMap",new cs),this.hot.rowIndexMapper.registerMap(X8,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>tu(this,Zm,OE).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[Mh];return e===!0||Be(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return tu(e,ME,Z8).call(e,...r)}),this.addHook("beforeChangeRender",n=>tu(this,AE,Q8).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>tu(this,_E,q8).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>tu(this,Zm,OE).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}Ce(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);T(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){ac(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+Fu.CALCULATION_STEP,r)},e),n=n+Fu.CALCULATION_STEP+1,n<r?i=cg(o):(ac(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Mh],n=e&&It(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&It(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){os(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Mh];let n=Fu.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Be(e)&&(n=e.syncLimit,Rv(n)?n=Bv(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ce(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!fr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function q8(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function OE(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Z8(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function Q8(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:J8,getListWithRemovedItems:e7}=BP("physicallyIndexed");class t7 extends ha{constructor(){super(e=>e)}insert(e,n){const r=vS(this.indexedValues,n);this.indexedValues=J8(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=e7(this.indexedValues,e);this.indexedValues=CS(n,e),super.remove(e)}}const n7=t7,{getListWithInsertedItems:r7,getListWithRemovedItems:i7}=BP("physicallyIndexed");class o7 extends ha{constructor(){super(e=>e)}insert(e,n){this.indexedValues=r7(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=i7(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const s7=o7;function a7(t,e){l7(t,e),e.add(t)}function l7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u7(t,e,n){return e=c7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c7(t){var e=h7(t,"string");return typeof e=="symbol"?e:String(e)}function h7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Qm="bindRowsWithHeaders",f7=210,g7="loose",m7=new Map([["loose",n7],["strict",s7]]);var IE=new WeakSet;class p7 extends ot{constructor(){super(...arguments),a7(this,IE),u7(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Qm}static get PLUGIN_PRIORITY(){return f7}isEnabled(){return!!this.hot.getSettings()[Qm]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Qm];typeof e!="string"&&(e=g7);const n=m7.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>d7(this,IE,w7).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function w7(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Ah(t,e){Fx(t,e),e.add(t)}function C7(t,e,n){Fx(t,e),e.set(t,n)}function Fx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PE(t,e,n){return e=v7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v7(t){var e=S7(t,"string");return typeof e=="symbol"?e:String(e)}function S7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xE(t,e){var n=Wx(t,e,"get");return y7(t,n)}function y7(t,e){return e.get?e.get.call(t):e.value}function Oh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Jm(t,e,n){var r=Wx(t,e,"set");return b7(t,r,n),n}function Wx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Td="collapsibleColumns",R7=290,E7=["nestedHeaders"],ml="collapsibleIndicator",HE=Td,DE=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Aa=new WeakMap,NE=new WeakSet,LE=new WeakSet,$E=new WeakSet,kE=new WeakSet;class T7 extends ot{constructor(){super(...arguments),Ah(this,kE),Ah(this,$E),Ah(this,LE),Ah(this,NE),PE(this,"nestedHeadersPlugin",null),PE(this,"headerStateManager",null),C7(this,Aa,{writable:!0,value:null})}static get PLUGIN_KEY(){return Td}static get PLUGIN_PRIORITY(){return R7}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Td,...E7]}isEnabled(){return!!this.hot.getSettings()[Td]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||vt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Jm(this,Aa,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Oh(this,$E,A7).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oh(e,kE,O7).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Oh(e,NE,_7).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Oh(this,LE,M7).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Jm(this,Aa,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:HE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HE)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};Ce(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;Ce(0,a.childNodes.length-1,c=>{let d=a.childNodes[c].querySelector(`.${ml}`);o(d),l&&l.childNodes[c]&&(d=l.childNodes[c].querySelector(`.${ml}`),o(d)),i&&u&&u.childNodes[c]&&(d=u.childNodes[c].querySelector(`.${ml}`),o(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!DE.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=fr(e,f=>{let{row:p}=f;return p<0});let i=r.length>0;T(r,f=>{var p;let{row:w,col:v}=f;const{collapsible:y,isCollapsed:b}=(p=this.headerStateManager.getHeaderSettings(w,v))!==null&&p!==void 0?p:{};if(!y||b&&n==="collapse"||!b&&n==="expand")return i=!1,!1});const o=[],s=[];i&&T(r,f=>{let{row:p,col:w}=f;const{colspanCompensation:v,affectedColumns:y,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,p,w);v>0&&(s.push(...y),o.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=yv([...a,...s]):n==="expand"&&(l=fr(a,f=>!s.includes(f)));const u=DE.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){T(o,f=>{f()});return}this.hot.batchExecution(()=>{T(s,f=>{xE(this,Aa).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return xE(this,Aa).getHiddenIndexes()}destroy(){Jm(this,Aa,null),super.destroy()}}function _7(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${ml}`);if(ua(e,[_r("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),J(u,ml),e.querySelector("div:first-child").appendChild(u)),$e(u,["collapsed","expanded"]),s?(J(u,"collapsed"),is(u,"+"),l&&_e(e,..._r(!1))):(J(u,"expanded"),is(u,"-"),l&&_e(e,..._r(!0))),l&&_e(u,...yo());else{var c;(c=u)===null||c===void 0||c.remove()}}function M7(t,e){De(t.target,ml)&&(De(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):De(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Pr(t))}function A7(){this.updatePlugin()}function O7(t,e){e||this.updatePlugin()}function _s(t,e,n){return e=I7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I7(t){var e=P7(t,"string");return typeof e=="symbol"?e:String(e)}function P7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const x7=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],H7=!1,D7=!0,N7=!0;class L7{constructor(e,n){_s(this,"hot",void 0),_s(this,"sortingStates",new fg),_s(this,"sortEmptyCells",H7),_s(this,"indicator",D7),_s(this,"headerAction",N7),_s(this,"compareFunctionFactory",void 0),_s(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Be(e)&&Ye(e,(n,r)=>{x7.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Be(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ce(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const cf="asc",hf="desc",Vx="colHeader";function $7(t){if(Be(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[cf,hf].includes(n)}function k7(t){if(t.some(n=>$7(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function FE(t){if(t!==hf)return t===cf?hf:cf}function Bx(t){return t.querySelector(`.${Vx}`)}function Ux(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function ab(t,e,n){return t===-1&&e>=0&&ss(n)===!1}const F7="ascending",W7="descending",Yx="indicatorDisabled",Gx="columnSorting",zx="sortAction",jx=new Map([[cf,F7],[hf,W7]]);function V7(t,e,n,r){const i=[Gx];if(r&&i.push(zx),n===!1)return i.push(Yx),i;const o=t.getSortOrderOfColumn(e);return ce(o)&&i.push(jx.get(o)),i}function B7(){return Array.from(jx.values()).concat(zx,Yx,Gx)}function Kx(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Mi:en(i)?en(o)?Mi:s&&t==="asc"?$t:kt:en(o)?s&&t==="asc"?kt:$t:isNaN(i)&&!isNaN(o)?t==="asc"?kt:$t:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?$t:kt:i>o?t==="asc"?kt:$t:Mi}}const Xx="default";function U7(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Mi;if(a){if(en(r))return t==="asc"?$t:kt;if(en(i))return t==="asc"?kt:$t}return isNaN(o)?kt:isNaN(s)?$t:o<s?t==="asc"?$t:kt:o>s?t==="asc"?kt:$t:Mi}}const Y7="numeric";function G7(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=en(s),u=en(a),c=l?i:s,d=u?i:a,f=c===i||c===r,p=d===i||d===r;if(o===!1){if(l&&u===!1)return kt;if(l===!1&&u)return $t}return f===!1&&p?t==="asc"?$t:kt:f&&p===!1?t==="asc"?kt:$t:f===!1&&p===!1?Kx(t,e,n)(s,a):c===i&&d===r?t==="asc"?$t:kt:c===r&&d===i?t==="asc"?kt:$t:Mi}}const z7="checkbox";function j7(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Mi;if(en(r))return en(i)?Mi:o&&t==="asc"?$t:kt;if(en(i))return o&&t==="asc"?kt:$t;const s=e.dateFormat,a=Z(r,s),l=Z(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?$t:kt:l.isBefore(a)?t==="asc"?kt:$t:Mi:$t:kt}}const K7="date",{register:Sg,getItem:WE,hasItem:X7}=ni("sorting.compareFunctionFactory"),{register:qx,getItem:q7}=ni("sorting.mainSortComparator");function Zx(t){return X7(t)?WE(t):WE(Xx)}Sg(Y7,U7);Sg(z7,G7);Sg(K7,j7);Sg(Xx,Kx);const Mi=0,$t=-1,kt=1;function Z7(t,e){const n=q7(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function Q7(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],d=o[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:Zx(u.type))(l,u,f)(c,d)}(0)}}function Ih(t,e){J7(t,e),e.add(t)}function J7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ph(t,e,n){return e=eX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eX(t){var e=tX(t,"string");return typeof e=="symbol"?e:String(e)}function tX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function il(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const df="columnSorting",nX=50,ff="append",rX="replace",VE=df;qx(df,Q7);ge.getSingleton().register("beforeColumnSort");ge.getSingleton().register("afterColumnSort");var _d=new WeakSet,BE=new WeakSet,UE=new WeakSet,YE=new WeakSet;class Qx extends ot{constructor(){super(...arguments),Ih(this,YE),Ih(this,UE),Ih(this,BE),Ih(this,_d),Ph(this,"columnStatesManager",null),Ph(this,"columnMetaCache",null),Ph(this,"pluginKey",df),Ph(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return df}static get PLUGIN_PRIORITY(){return nX}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new L7(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new cs(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>il(this,BE,iX).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return il(e,YE,sX).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>il(this,_d,gC).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return il(e,UE,oX).call(e,...r)}),this.hot.view&&il(this,_d,gC).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=Bx(r);Ux(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:VE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VE)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new UP),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ce(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return k7(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ce(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ce(n)){const i=FE(n);return ce(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:FE()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ff;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ct(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===ff)return[...o.slice(0,r),...o.slice(r+1),s];if(n===rX)return[...o.slice(0,r),s,...o.slice(r+1)]}return ce(s)?o.concat(s):o}getPluginColumnConfig(e){if(Be(e)){const n=e[this.pluginKey];if(Be(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):wt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);Z7(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Be(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Be(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if($e(e,B7()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];J(e,V7(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ce(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&De(e.target,Vx)}onAfterOnCellMouseDown(e,n){ab(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function gC(){const t=this.getAllSavedSortSettings();if(Be(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function iX(t,e){const n=Bx(e);if(Ux(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);_e(e,...SY(s?`${s}ending`:"none"))}}function oX(t){t===!0&&this.hot.view&&il(this,_d,gC).call(this)}function sX(t,e,n,r){ab(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Ms(t,e,n){return e=aX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aX(t){var e=lX(t,"string");return typeof e=="symbol"?e:String(e)}function lX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uX{constructor(e,n){Ms(this,"plugin",void 0),Ms(this,"hot",void 0),Ms(this,"endpoints",[]),Ms(this,"settings",void 0),Ms(this,"settingsType","array"),Ms(this,"currentEndpoint",null),Ms(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),T(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();T(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,d=n;T(u,f=>{a==="row"&&f.destinationRow>=d&&(f.alterRowOffset=l*r),a==="col"&&f.destinationColumn>=d&&(f.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?T(u,f=>{this.extendEndpointRanges(f,d,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):T(u,f=>{this.shiftEndpointCoordinates(f,d)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){T(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];T(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),T(i,o=>{let s=[];T(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,T(e.ranges,r=>{T(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],T(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],T(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],T(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&T(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),T(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){vt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const cX=uX;function ep(t){return t==null||isNaN(t)}function tp(t,e){hX(t,e),e.add(t)}function hX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dX(t,e,n){return e=fX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fX(t){var e=gX(t,"string");return typeof e=="symbol"?e:String(e)}function gX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function np(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const rp="columnSummary",mX=220;var GE=new WeakSet,zE=new WeakSet,jE=new WeakSet;class pX extends ot{constructor(){super(...arguments),tp(this,jE),tp(this,zE),tp(this,GE),dX(this,"endpoints",null)}static get PLUGIN_KEY(){return rp}static get PLUGIN_PRIORITY(){return mX}isEnabled(){return!!this.hot.getSettings()[rp]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[rp],this.endpoints=new cX(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return np(e,GE,wX).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return np(e,zE,CX).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return np(e,jE,vX).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ye(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=ep(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ye(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=ep(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=ep(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ye(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ft`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function wX(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function CX(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function vX(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Oa(t,e,n){return e=SX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SX(t){var e=yX(t,"string");return typeof e=="symbol"?e:String(e)}function yX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Oa(this,"rootDocument",void 0),Oa(this,"isRtl",!1),Oa(this,"container",null),Oa(this,"editor",void 0),Oa(this,"editorStyle",void 0),Oa(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:dt(this.getInputElement()),height:Pt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),J(this.container,hl.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),J(e,hl.CLASS_EDITOR),J(n,hl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${hl.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const bX=hl;function ip(t,e,n){return e=RX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RX(t){var e=EX(t,"string");return typeof e=="symbol"?e:String(e)}function EX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const TX=250,_X=250;class Jx{constructor(e){ip(this,"wasLastActionShow",!0),ip(this,"showDebounced",null),ip(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},_X)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:TX;this.showDebounced=ig(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}mt(Jx,ir);const MX=Jx;function AX(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function OX(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function As(t,e){const n={};return T(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Fo(t,e,n,r,i){T(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&IX(s,a,e,n,r,i)})})}function IX(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=AX(s.className,r):a=OX(s.className,r)),o(t,e,"className",a)}function Ji(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function yi(t,e){let n=!1;return Array.isArray(t)&&T(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function yg(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const ze="---------";function PX(){return{name:ze}}const Rr="alignment";function xX(){return{key:Rr,name(){return this.getTranslatedPhrase(GS)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Rr}:left`,name(){let t=this.getTranslatedPhrase(zS);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:center`,name(){let t=this.getTranslatedPhrase(jS);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:right`,name(){let t=this.getTranslatedPhrase(KS);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:justify`,name(){let t=this.getTranslatedPhrase(XS);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:ze},{key:`${Rr}:top`,name(){let t=this.getTranslatedPhrase(qS);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:middle`,name(){let t=this.getTranslatedPhrase(ZS);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Rr}:bottom`,name(){let t=this.getTranslatedPhrase(QS);return yi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=As(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Fo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const bg="clear_column";function HX(){return{key:bg,name(){return this.getTranslatedPhrase(PS)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Dc="col_left";function DX(){return{key:Dc,name(){return this.getTranslatedPhrase(ES)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Nc="col_right";function NX(){return{key:Nc,name(){return this.getTranslatedPhrase(TS)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Lc="make_read_only";function LX(){return{key:Lc,name(){let t=this.getTranslatedPhrase(IS);return yi(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=Ji(t)),t},callback(){const t=this.getSelectedRange(),e=yi(t,(n,r)=>this.getCellMeta(n,r).readOnly);T(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Rg="redo";function $X(){return{key:Rg,name(){return this.getTranslatedPhrase(OS)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const $c="remove_col";function kX(){return{key:$c,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(MS,e)},callback(){this.alter("remove_col",G4(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Eg="remove_row";function FX(){return{key:Eg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(_S,e)},callback(){this.alter("remove_row",z4(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Tg="row_above";function WX(){return{key:Tg,name(){return this.getTranslatedPhrase(bS)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const _g="row_below";function VX(){return{key:_g,name(){return this.getTranslatedPhrase(RS)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const cc="no_items";function BX(){return{key:cc,name(){return this.getTranslatedPhrase(yS)},disabled:!0,isCommand:!1}}const Mg="undo";function UX(){return{key:Mg,name(){return this.getTranslatedPhrase(AS)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const YX=[Tg,_g,Dc,Nc,bg,Eg,$c,Mg,Rg,Lc,Rr,ze,cc],GX={[ze]:PX,[cc]:BX,[Tg]:WX,[_g]:VX,[Dc]:DX,[Nc]:NX,[bg]:HX,[Eg]:FX,[$c]:kX,[Mg]:UX,[Rg]:$X,[Lc]:LX,[Rr]:xX};function eH(){const t={};return Ye(GX,(e,n)=>{t[n]=e()}),t}function zX(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(BS):this.getTranslatedPhrase(VS)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function jX(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(US)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function KX(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(YS);return yi(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Md))?Ji(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Md);t.updateCommentMeta(n,r,{[Md]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ci(t,e){tH(t,e),e.add(t)}function Os(t,e,n){tH(t,e),e.set(t,n)}function tH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XX(t,e,n){return e=qX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qX(t){var e=ZX(t,"string");return typeof e=="symbol"?e:String(e)}function ZX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ao(t,e,n){var r=nH(t,e,"set");return QX(t,r,n),n}function QX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Qe(t,e){var n=nH(t,e,"get");return JX(t,n)}function nH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function JX(t,e){return e.get?e.get.call(t):e.value}const Wu="comments",eq=60,eo="comment",Mu="value",rH="style",Md="readOnly",xh=Wu,mC=`plugin:${Wu}`;var Rt=new WeakMap,Ur=new WeakMap,Ag=new WeakMap,Ad=new WeakMap,gf=new WeakMap,pC=new WeakMap,mf=new WeakMap,KE=new WeakSet,XE=new WeakSet,qE=new WeakSet,ZE=new WeakSet,QE=new WeakSet,JE=new WeakSet,eT=new WeakSet,tT=new WeakSet,nT=new WeakSet,rT=new WeakSet;class tq extends ot{constructor(){super(...arguments),ci(this,rT),ci(this,nT),ci(this,tT),ci(this,eT),ci(this,JE),ci(this,QE),ci(this,ZE),ci(this,qE),ci(this,XE),ci(this,KE),XX(this,"range",{}),Os(this,Rt,{writable:!0,value:null}),Os(this,Ur,{writable:!0,value:null}),Os(this,Ag,{writable:!0,value:!1}),Os(this,Ad,{writable:!0,value:!1}),Os(this,gf,{writable:!0,value:{}}),Os(this,pC,{writable:!0,value:null}),Os(this,mf,{writable:!0,value:""})}static get PLUGIN_KEY(){return Wu}static get PLUGIN_PRIORITY(){return eq}isEnabled(){return!!this.hot.getSettings()[Wu]}enablePlugin(){this.enabled||(Qe(this,Rt)||ao(this,Rt,new bX(this.hot.rootDocument,this.hot.isRtl())),Qe(this,Ur)||ao(this,Ur,new MX(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>hi(this,ZE,oq).call(this,e,s)),this.addHook("afterScroll",()=>hi(this,rT,hq).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>hi(this,nT,cq).call(this,e)),Qe(this,Ur).addLocalHook("hide",()=>this.hide()),Qe(this,Ur).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Qe(this,Ur).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(mC);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ao(this,Ad,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(mC),this.hot._registerTimeout(()=>{ao(this,Ad,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!Qe(this,Rt).isVisible()},group:xh}),r.addShortcut({keys:[["Escape"]],callback:()=>{Qe(this,Rt).setValue(Qe(this,mf)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Qe(this,Rt).isVisible()},group:xh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Qe(this,Rt).isVisible()},group:xh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>hi(this,XE,rq).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>hi(this,KE,nq).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>hi(this,qE,iq).call(this)),this.eventManager.addEventListener(n,"focus",()=>hi(this,JE,aq).call(this)),this.eventManager.addEventListener(n,"blur",()=>hi(this,QE,sq).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>hi(this,eT,lq).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>hi(this,tT,uq).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=rs(e.target,"TD","TBODY");return!!(n&&De(n,"htCommentCell")&&rs(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Qe(this,Rt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Mu]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,eo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Mu)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Mu)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Qe(this,Ur).cancelHiding(),Qe(this,Rt).setValue((e=i[eo]?i[eo][Mu]:null)!==null&&e!==void 0?e:""),Qe(this,Rt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Qe(this,Rt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Qe(this,Rt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;Qe(this,Rt).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const d=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:p,view:{_wt:w}}=this.hot,{wtTable:v}=w,y=w.getCell({row:l,col:u},!0),b=this.getCommentMeta(s,a,rH);b?Qe(this,Rt).setSize(b.width,b.height):Qe(this,Rt).resetSize();const _=f?0:v.getStretchedColumnWidth(u),I=c&&!d?Pt(y):0,{left:L,top:x,width:W,height:G}=y.getBoundingClientRect(),{width:ne,height:j}=Qe(this,Rt).getSize(),{innerWidth:X,innerHeight:ie}=this.hot.rootWindow,oe=this.hot.rootDocument.documentElement;let se=L+p.scrollX+_,ve=x+p.scrollY+I;this.hot.isRtl()&&(se-=ne+_),this.hot.isLtr()&&L+W+ne>X?se=L+p.scrollX-ne-1:this.hot.isRtl()&&se<-(oe.scrollWidth-oe.clientWidth)&&(se=L+p.scrollX+_+1),x+j>ie&&(ve-=j-G+1),Qe(this,Rt).setPosition(se,ve),Qe(this,Rt).setReadOnlyState(this.getCommentMeta(s,a,Md))}focusEditor(){Qe(this,Rt).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[eo];let o;i?(o=Mn(i),Ac(o,r)):o=r,this.hot.setCellMeta(e,n,eo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[eo])return i[eo][r]}addToContextMenu(e){e.items.push({name:ze},zX(this),jX(this),KX(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Wu];if(Be(e))return e.displayDelay}getEditorInputElement(){return Qe(this,Rt).getInputElement()}destroy(){Qe(this,Rt)&&Qe(this,Rt).destroy(),Qe(this,Ur)&&Qe(this,Ur).destroy(),super.destroy()}}function nq(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Qe(this,Ag)&&!this.targetIsCommentTextArea(t)){const e=rs(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function rq(t){const{rootDocument:e}=this.hot;if(!(Qe(this,Ag)||Qe(this,Rt).isFocused()||De(t.target,"wtBorder")||Qe(this,pC)===t.target||!Qe(this,Rt)))if(ao(this,pC,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Qe(this,Ur).show(n)}else Qo(t.target,e)&&!this.targetIsCommentTextArea(t)&&Qe(this,Ur).hide()}function iq(){ao(this,Ag,!1)}function oq(t,e){e[eo]&&e[eo][Mu]&&J(t,e.commentedCellClassName)}function sq(){ao(this,mf,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function aq(){ao(this,mf,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(mC)}function lq(t){ao(this,gf,{width:dt(t.target),height:Pt(t.target)})}function uq(t){const e=dt(t.target),n=Pt(t.target);(e!==Qe(this,gf).width+1||n!==Qe(this,gf).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[rH]:{width:e,height:n}})}function cq(t){Qe(this,Rt).isVisible()&&Pr(t)}function hq(){Qe(this,Ad)||this.hide()}var iT=kA,dq=TypeError,fq=function(t,e){if(!delete t[e])throw new dq("Cannot delete property "+iT(e)+" of "+iT(t))},gq=sa,mq=$f,pq=Ff,wq=tO,Cq=fq,vq=nO,Sq=[].unshift(0)!==1,yq=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},bq=Sq||!yq();gq({target:"Array",proto:!0,arity:1,forced:bq},{unshift:function(e){var n=mq(this),r=pq(n),i=arguments.length;if(i){vq(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:Cq(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return wq(n,r+i)}});function op(t,e,n){return e=Rq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rq(t){var e=Eq(t,"string");return typeof e=="symbol"?e:String(e)}function Eq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iH{constructor(e){op(this,"hot",void 0),op(this,"commands",{}),op(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Tq(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||It(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),T(u,c=>c.apply(this.hot,r))}}function Tq(t,e){let n;return T(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function sp(t,e,n){return e=_q(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _q(t){var e=Mq(t,"string");return typeof e=="symbol"?e:String(e)}function Mq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;sp(this,"hot",void 0),sp(this,"predefinedItems",eH()),sp(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ye(e,(r,i)=>{let o="";r.name===ze?(n[ze]=r,o=ze):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Aq(e,this.defaultOrderPattern,this.predefinedItems)}}function Aq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Be(i)?Ye(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Be(o)?Kt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):T(i,(o,s)=>{let a=n[o];!a&&YX.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Be(o)&&Kt(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Io(t,e,n){return e=Oq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oq(t){var e=Iq(t,"string");return typeof e=="symbol"?e:String(e)}function Iq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pq{constructor(e,n){Io(this,"top",void 0),Io(this,"topRelative",void 0),Io(this,"left",void 0),Io(this,"leftRelative",void 0),Io(this,"scrollTop",void 0),Io(this,"scrollLeft",void 0),Io(this,"cellHeight",void 0),Io(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function nu(t,e,n){xq(t,e),e.set(t,n)}function xq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xe(t,e){var n=sH(t,e,"get");return Hq(t,n)}function Hq(t,e){return e.get?e.get.call(t):e.value}function Hh(t,e,n){var r=sH(t,e,"set");return Dq(t,r,n),n}function sH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Dq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Dn=new WeakMap,Po=new WeakMap,gn=new WeakMap,ap=new WeakMap,Ia=new WeakMap;class Nq{constructor(e){nu(this,Dn,{writable:!0,value:void 0}),nu(this,Po,{writable:!0,value:void 0}),nu(this,gn,{writable:!0,value:void 0}),nu(this,ap,{writable:!0,value:!1}),nu(this,Ia,{writable:!0,value:{above:0,below:0,left:0,right:0}}),Hh(this,ap,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Xe(this,Ia)[e]=n,this}setElement(e){return Hh(this,Dn,e),this}setParentElement(e){return Hh(this,Po,e),this}updatePosition(e){Hh(this,gn,new Pq(e,Xe(this,Dn).ownerDocument.defaultView)),Xe(this,ap)?(Xe(this,gn).fitsBelow(Xe(this,Dn))?this.setPositionBelowCursor():Xe(this,gn).fitsAbove(Xe(this,Dn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Xe(this,Dn).dir==="rtl"?Xe(this,gn).fitsOnLeft(Xe(this,Dn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Xe(this,gn).fitsOnRight(Xe(this,Dn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Xe(this,Ia).above+Xe(this,gn).top-Xe(this,Dn).offsetHeight;Xe(this,Po)&&(e=Xe(this,gn).top+Xe(this,gn).cellHeight-Xe(this,Dn).offsetHeight+3),Xe(this,Dn).style.top=`${e}px`}setPositionBelowCursor(){let e=Xe(this,Ia).below+Xe(this,gn).top+1;Xe(this,Po)&&(e=Xe(this,gn).top-1),Xe(this,Dn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Xe(this,gn).left;if(Xe(this,Po)){const{right:n}=Xe(this,Po).getBoundingClientRect();e+=Xe(this,gn).cellWidth+n-(Xe(this,gn).left+Xe(this,gn).cellWidth)}else e+=Xe(this,Ia).right;Xe(this,Dn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Xe(this,Ia).left+Xe(this,gn).left-Xe(this,Dn).offsetWidth;if(Xe(this,Po)){const{left:n}=Xe(this,Po).getBoundingClientRect();e-=Xe(this,gn).left-n}Xe(this,Dn).style.left=`${e}px`}}function aH(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=rr(e,-1,w()-1);function a(y,b){const _=w()-1;return y<0&&(y=_),y>_&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(b===1?++y:--y,b)),y)}function l(y){y>-1&&y<w()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){w()>0&&(o.clear(),s=a(0,1))}function d(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function p(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:d,toNextItem:f,toPreviousItem:p,getSize:w,clear:v}}function Lq(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function wC(t){return It(t,"submenu")}function CC(t){return new RegExp(ze,"i").test(t.name)}function Od(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function oT(t){return It(t,"disableSelection")}function $q(t){return De(t,"htSeparator")}function kq(t){return De(t,"htSubmenu")}function Fq(t){return De(t,"htDisabled")}function Wq(t){return De(t,"htSelectionDisabled")}function Vq(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function lH(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Bq(t,e){let n=t.slice(0);return n.reverse(),n=lH(n,e),n.reverse(),n}function Uq(t){const e=[];return T(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Yq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ze,n=t.slice(0);return n=lH(n,e),n=Bq(n,e),n=Uq(n),n}function Gq(t){return aH({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||$q(r)||Fq(r)||Wq(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function zq(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const uH="menu",sT=uH;function jq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(zq(t)),e.forEach(u=>{let{shortcuts:c,contextName:d}=u;i(c,d)});function r(u,c){a(c).addShortcuts(u,{group:uH})}function i(u,c){const d=a(c);u.forEach(f=>{let{keys:p}=f;p.forEach(w=>d.removeShortcutsByKeys(w))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${sT}:${u}`:sT}function a(u){var c;const d=t.hotMenu.getShortcutManager(),f=s(u);return(c=d.getContext(f))!==null&&c!==void 0?c:d.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function Kq(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(ei(n),J(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!Od(a,t)&&!oT(a)&&!CC(a);_e(n,[hY(),Tv(u),...c?[Ml(-1)]:[],...Od(a,t)?[CY()]:[],...wC(a)?[_r(!1)]:[]])}n.className="",n.appendChild(l),CC(a)?J(n,"htSeparator"):typeof a.renderer=="function"?(J(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):ca(l,u),Od(a,t)?J(n,"htDisabled"):oT(a)?J(n,"htSelectionDisabled"):wC(a)&&J(n,"htSubmenu")}}function aT(t,e,n){Xq(t,e),e.set(t,n)}function Xq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function di(t,e,n){return e=qq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qq(t){var e=Zq(t,"string");return typeof e=="symbol"?e:String(e)}function Zq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lT(t,e,n){var r=cH(t,e,"set");return Qq(t,r,n),n}function Qq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ru(t,e){var n=cH(t,e,"get");return Jq(t,n)}function cH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Jq(t,e){return e.get?e.get.call(t):e.value}const uT=215;var iu=new WeakMap,Dh=new WeakMap;class Hl{constructor(e,n){var r=this;di(this,"hot",void 0),di(this,"options",void 0),di(this,"eventManager",new gr(this)),di(this,"container",void 0),di(this,"positioner",void 0),di(this,"hotMenu",null),di(this,"hotSubMenus",{}),di(this,"parentMenu",void 0),di(this,"menuItems",null),di(this,"origOutsideClickDeselects",null),aT(this,iu,{writable:!0,value:void 0}),aT(this,Dh,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:uT,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Nq(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=rc(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ru(this,iu)}getKeyboardShortcutsCtrl(){return ru(this,Dh)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=ig(a=>this.openSubMenu(a),300),n=this.options.minWidth||uT;let r=!1,i=fr(this.menuItems,a=>(a.key===cc&&(r=!0),Vq(a,this.hot)));if(i.length<1&&!r)i.push(eH()[cc]);else if(i.length===0)return;i=Yq(i,ze);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ce(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Kq(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{ru(this,iu).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===ze?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),Kw()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Kw()||!ss(a))&&o&&this.hasSelectedItem()&&(so()||kv()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),lT(this,iu,Gq(this.hotMenu)),lT(this,Dh,jq(this)),ru(this,Dh).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ru(this,iu).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);_e(r,[_r(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!kq(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Hl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&_e(n,[_r(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&_e(i,[_r(!1)])}}closeAllSubMenus(){T(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Lq(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||CC(e)||Od(e,this.hot)||wC(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(wt(r)&&(r=r.call(this.hot),r===null||Ct(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),J(i,`htMenu ${this.options.className}`),r&&J(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Yt(n,(a,l)=>a+(l.name===ze?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&_e(this.hotMenu.rootElement,[cY(),Ml(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Qo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Qo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&De(e.target,"htCore")&&Qo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}mt(Hl,ir);function Nh(t,e){eZ(t,e),e.add(t)}function eZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lp(t,e,n){return e=tZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:String(e)}function nZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Au="contextMenu",rZ=70,cT=Au;ge.getSingleton().register("afterContextMenuDefaultOptions");ge.getSingleton().register("beforeContextMenuShow");ge.getSingleton().register("afterContextMenuShow");ge.getSingleton().register("afterContextMenuHide");ge.getSingleton().register("afterContextMenuExecute");var hT=new WeakSet,dT=new WeakSet,fT=new WeakSet,gT=new WeakSet;class Og extends ot{constructor(){super(...arguments),Nh(this,gT),Nh(this,fT),Nh(this,dT),Nh(this,hT),lp(this,"commandExecutor",new iH(this.hot)),lp(this,"itemsFactory",null),lp(this,"menu",null)}static get PLUGIN_KEY(){return Au}static get PLUGIN_PRIORITY(){return rZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Tg,_g,ze,Dc,Nc,ze,Eg,$c,ze,Mg,Rg,ze,Lc,ze,Rr]}isEnabled(){return!!this.hot.getSettings()[Au]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Au];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Hl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Lh(this,dT,oZ).call(this)),this.menu.addLocalHook("afterOpen",()=>Lh(this,fT,sZ).call(this)),this.menu.addLocalHook("afterClose",()=>Lh(this,gT,aZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Lh(this,hT,iZ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=yg(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:cT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cT)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ye(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new oH(this.hot,Og.DEFAULT_ITEMS);const e=this.hot.getSettings()[Au],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),T(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function iZ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),De(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(De(o,"current")&&De(o,"wtBorder"))))return;const s=yg(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function oZ(){this.hot.runHooks("beforeContextMenuShow",this)}function sZ(){this.hot.runHooks("afterContextMenuShow",this)}function aZ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Og.SEPARATOR={name:ze};function lZ(t){return{key:"copy",name(){return this.getTranslatedPhrase(xS)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function uZ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?rr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(NS,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function cZ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?rr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(DS,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function hZ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?rr(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(HS,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function dZ(t){return{key:"cut",name(){return this.getTranslatedPhrase(LS)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class fZ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class gZ{constructor(){this.clipboardData=new fZ}}function mT(t,e){hH(t,e),e.add(t)}function Pa(t,e,n){hH(t,e),e.set(t,n)}function hH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $h(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function $n(t,e){var n=dH(t,e,"get");return mZ(t,n)}function mZ(t,e){return e.get?e.get.call(t):e.value}function xa(t,e,n){var r=dH(t,e,"set");return pZ(t,r,n),n}function dH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xo=new WeakMap,up=new WeakMap,ou=new WeakMap,vC=new WeakMap,SC=new WeakMap,su=new WeakMap,kh=new WeakSet,pT=new WeakSet;class wZ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;mT(this,pT),mT(this,kh),Pa(this,xo,{writable:!0,value:void 0}),Pa(this,up,{writable:!0,value:void 0}),Pa(this,ou,{writable:!0,value:void 0}),Pa(this,vC,{writable:!0,value:void 0}),Pa(this,SC,{writable:!0,value:void 0}),Pa(this,su,{writable:!0,value:void 0}),xa(this,up,n),xa(this,ou,r),xa(this,vC,i),xa(this,SC,o),xa(this,su,s)}setSelectedRange(e){xa(this,xo,e)}getCellsRange(){if($n(this,up).call(this)===0||$n(this,ou).call(this)===0)return null;const{row:e,col:n}=$n(this,xo).getTopStartCorner(),{row:r,col:i}=$n(this,xo).getBottomEndCorner(),o=$h(this,pT,CZ).call(this,e,r),s=$h(this,kh,cp).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if($n(this,ou).call(this)===0||$n(this,su).call(this)===0)return null;const{col:e}=$n(this,xo).getTopStartCorner(),{col:n}=$n(this,xo).getBottomEndCorner(),r=$h(this,kh,cp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if($n(this,ou).call(this)===0||$n(this,su).call(this)===0)return null;const{col:e}=$n(this,xo).getTopStartCorner(),{col:n}=$n(this,xo).getBottomEndCorner(),r=$h(this,kh,cp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-$n(this,su).call(this),startCol:e,endRow:-1,endCol:r}}}function cp(t,e){return Math.min(e,Math.max(t+$n(this,SC).call(this)-1,t))}function CZ(t,e){return Math.min(e,Math.max(t+$n(this,vC).call(this)-1,t))}function fH(t){const e=[],n=[];return T(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);Ce(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);Ce(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Ui(t,e){gH(t,e),e.add(t)}function Is(t,e,n){gH(t,e),e.set(t,n)}function gH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function au(t,e,n){return e=vZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vZ(t){var e=SZ(t,"string");return typeof e=="symbol"?e:String(e)}function SZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sr(t,e){var n=mH(t,e,"get");return yZ(t,n)}function yZ(t,e){return e.get?e.get.call(t):e.value}function Gr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Yi(t,e,n){var r=mH(t,e,"set");return bZ(t,r,n),n}function mH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ge.getSingleton().register("afterCopyLimit");ge.getSingleton().register("modifyCopyableRange");ge.getSingleton().register("beforeCut");ge.getSingleton().register("afterCut");ge.getSingleton().register("beforePaste");ge.getSingleton().register("afterPaste");ge.getSingleton().register("beforeCopy");ge.getSingleton().register("afterCopy");const Fh="copyPaste",RZ=80,EZ=["fragmentSelection"],wT=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var yC=new WeakMap,bC=new WeakMap,RC=new WeakMap,Ha=new WeakMap,Wh=new WeakMap,Vh=new WeakMap,Da=new WeakMap,hp=new WeakSet,CT=new WeakSet,pH=new WeakSet,lb=new WeakSet,vT=new WeakSet,ST=new WeakSet,yT=new WeakSet,bT=new WeakSet,RT=new WeakSet;class TZ extends ot{constructor(){super(...arguments),Ui(this,RT),Ui(this,bT),Ui(this,yT),Ui(this,ST),Ui(this,vT),Ui(this,lb),Ui(this,pH),Ui(this,CT),Ui(this,hp),au(this,"columnsLimit",1/0),au(this,"rowsLimit",1/0),au(this,"pasteMode","overwrite"),au(this,"uiContainer",this.hot.rootDocument.body),Is(this,yC,{writable:!0,value:!1}),Is(this,bC,{writable:!0,value:!1}),Is(this,RC,{writable:!0,value:!1}),Is(this,Ha,{writable:!0,value:"cells-only"}),Is(this,Wh,{writable:!0,value:!1}),Is(this,Vh,{writable:!0,value:!1}),Is(this,Da,{writable:!0,value:new wZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),au(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Fh}static get SETTING_KEYS(){return[Fh,...EZ]}static get PLUGIN_PRIORITY(){return RZ}isEnabled(){return!!this.hot.getSettings()[Fh]}enablePlugin(){var e=this;if(this.enabled)return;const{[Fh]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Yi(this,yC,!!n.copyColumnHeaders),Yi(this,bC,!!n.copyColumnGroupHeaders),Yi(this,RC,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Gr(this,vT,AZ).call(this,o)),this.addHook("afterSelectionEnd",()=>Gr(this,ST,OZ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),Lv()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Gr(e,yT,IZ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Gr(e,bT,PZ).call(e,...s)}),this.addHook("afterSelection",()=>Gr(this,RT,xZ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Yi(this,Ha,e),Yi(this,Wh,!0),Gr(this,hp,ET).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Yi(this,Vh,!0),Gr(this,hp,ET).call(this,"cut")}getRangedCopyableData(e){return $u(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=fH(e);return T(r,o=>{const s=[];T(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new gZ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}sr(this,Da).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);sr(this,Ha)==="column-headers-only"?n.set("headers",sr(this,Da).getMostBottomColumnHeadersRange()):(sr(this,Ha)==="with-column-headers"?n.set("headers",sr(this,Da).getMostBottomColumnHeadersRange()):sr(this,Ha)==="with-column-group-headers"&&n.set("headers",sr(this,Da).getAllColumnHeadersRange()),n.set("cells",sr(this,Da).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,d=a,f=s,p=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:w,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,w===!0)continue;f=v,d=a;const y=[],b=o.length%r;for(;y.length<i||d<=u;){const{skipColumnOnPaste:_,visualCol:I}=this.hot.getCellMeta(s,d);if(d=I+1,_===!0)continue;p=I;const L=y.length%i;y.push(e[b][L])}o.push(y)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,p]}onCopy(e){if(!this.hot.isListening()&&!sr(this,Wh)||this.isEditorOpened())return;this.setCopyableText(),Yi(this,Wh,!1);const n=this.getRangedData(this.copyableRanges),r=Gr(this,CT,_Z).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=$u(n);if(e&&e.clipboardData){const s=Qw(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[wT,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Yi(this,Ha,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!sr(this,Vh)||this.isEditorOpened())return;this.setCopyableText(),Yi(this,Vh,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=$u(n);if(e&&e.clipboardData){const o=Qw(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[wT,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=Jf(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=eP(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=t6(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function ET(t){if(Lv()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&PI(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function _Z(t){const{rows:e}=fH(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function MZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&xv(r)}}}function wH(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&Hv(r)}}}function AZ(t){t.items.push({name:"---------"},lZ(this)),sr(this,yC)&&t.items.push(hZ(this)),sr(this,bC)&&t.items.push(cZ(this)),sr(this,RC)&&t.items.push(uZ(this)),t.items.push(dZ(this))}function OZ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function IZ(){Gr(this,lb,wH).call(this)}function PZ(){Gr(this,pH,MZ).call(this)}function xZ(){Gr(this,lb,wH).call(this)}function CH(t,e){return`border_row${t}col${e}`}function Ou(){return{width:1,color:"#000"}}function lo(){return{hide:!0}}function HZ(){return{width:1,color:"#000",cornerVisible:!1}}function dp(t){if(ce(t.start)||ce(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ce(t.end)||ce(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function lu(t){return ce(t.start)&&(t.left=t.start),ce(t.end)&&(t.right=t.end),t}function fp(t,e){return{id:CH(t,e),border:HZ(),row:t,col:e,top:lo(),bottom:lo(),start:lo(),end:lo()}}function DZ(t,e){return It(e,"border")&&e.border&&(t.border=e.border),It(e,"top")&&ce(e.top)&&(e.top?(Be(e.top)||(e.top=Ou()),t.top=e.top):(e.top=lo(),t.top=e.top)),It(e,"bottom")&&ce(e.bottom)&&(e.bottom?(Be(e.bottom)||(e.bottom=Ou()),t.bottom=e.bottom):(e.bottom=lo(),t.bottom=e.bottom)),It(e,"start")&&ce(e.start)&&(e.start?(Be(e.start)||(e.start=Ou()),t.start=e.start):(e.start=lo(),t.start=e.start)),It(e,"end")&&ce(e.end)&&(e.end?(Be(e.end)||(e.end=Ou()),t.end=e.end):(e.end=lo(),t.end=e.end)),t}function po(t,e){let n=!1;return T(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!It(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Ig(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function NZ(t){return t.some(e=>ce(e.left)||ce(e.right))}function LZ(t){return t.some(e=>ce(e.start)||ce(e.end))}const $Z=new Map([["left","start"],["right","end"]]);function kZ(t){var e;return(e=$Z.get(t))!==null&&e!==void 0?e:t}function FZ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(ny);return po(this,"bottom")&&(e=Ig(e)),e},callback(e,n){const r=po(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function WZ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(ry);return po(this,e)&&(n=Ig(n)),n},callback(n,r){const i=po(this,e);t.prepareBorder(r,e,i)}}}function VZ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(iy)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!po(this)}}}function BZ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(ty);return po(this,e)&&(n=Ig(n)),n},callback(n,r){const i=po(this,e);t.prepareBorder(r,e,i)}}}function UZ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(ey);return po(this,"top")&&(e=Ig(e)),e},callback(e,n){const r=po(this,"top");t.prepareBorder(n,"top",r)}}}function TT(t,e){YZ(t,e),e.add(t)}function YZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GZ(t,e,n){return e=zZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:String(e)}function jZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _T(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Id="customBorders",KZ=90;var MT=new WeakSet,AT=new WeakSet;class XZ extends ot{constructor(){super(...arguments),TT(this,AT),TT(this,MT),GZ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Id}static get PLUGIN_PRIORITY(){return KZ}isEnabled(){return!!this.hot.getSettings()[Id]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>_T(this,MT,qZ).call(this,e)),this.addHook("init",()=>_T(this,AT,ZZ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=dp(n));const o=yl(e),s=uc(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});T(e,a=>{s(a).forAll((l,u)=>{T(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,kZ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=yl(e),r=uc(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return T(e,o=>{r(o).forAll((s,a)=>{T(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(lu(l))})})}),i}clearBorders(e){e?this.setBorders(e):(T(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=fp(e,n);r&&(a=DZ(a,r),T(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",lu(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Ce(e.from.row,r,o=>{Ce(e.from.col,i,s=>{const a=fp(o,s);let l=0;o===e.from.row&&It(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&It(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&It(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&It(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",lu(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=CH(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=fp(e,n):o=dp(o),i?(o[r]=lo(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",lu(o)))):(o[r]=Ou(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",lu(o)))}prepareBorder(e,n,r){T(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":Ce(o.col,s.col,a=>{Ce(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Ce(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":Ce(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":Ce(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":Ce(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){T(e,n=>{const r=dp(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Yt([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){T(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){T(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):T(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return T(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return T(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):T(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);T(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Id];if(Array.isArray(e)){const n=Mn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=NZ(e),r=LZ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function qZ(t){this.hot.getSettings()[Id]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(JS)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[UZ(this),BZ(this),FZ(this),WZ(this),VZ(this)]}})}function ZZ(){this.changeBorderSettings()}function QZ(t,e){JZ(t,e),e.add(t)}function JZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gp(t,e,n){return e=eQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eQ(t){var e=tQ(t,"string");return typeof e=="symbol"?e:String(e)}function tQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function OT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const IT="dragToScroll",nQ=100;var mp=new WeakSet;class rQ extends ot{constructor(){super(...arguments),QZ(this,mp),gp(this,"boundaries",null),gp(this,"callback",null),gp(this,"listening",!1)}static get PLUGIN_KEY(){return IT}static get PLUGIN_PRIORITY(){return nQ}isEnabled(){return!!this.hot.getSettings()[IT]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>OT(this,mp,PT).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>OT(this,mp,PT).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=rc(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function PT(t){if(ss(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function Ps(t,e){iQ(t,e),e.add(t)}function iQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pp(t,e,n){return e=oQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oQ(t){var e=sQ(t,"string");return typeof e=="symbol"?e:String(e)}function sQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("afterDropdownMenuDefaultOptions");ge.getSingleton().register("beforeDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuShow");ge.getSingleton().register("afterDropdownMenuHide");ge.getSingleton().register("afterDropdownMenuExecute");const Pd="dropdownMenu",aQ=230,EC="changeType",wp=Pd;var ub=new WeakSet,xT=new WeakSet,HT=new WeakSet,DT=new WeakSet,NT=new WeakSet,LT=new WeakSet,$T=new WeakSet;class Pg extends ot{static get PLUGIN_KEY(){return Pd}static get PLUGIN_PRIORITY(){return aQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Dc,Nc,ze,$c,ze,bg,ze,Lc,ze,Rr]}constructor(e){super(e),Ps(this,$T),Ps(this,LT),Ps(this,NT),Ps(this,DT),Ps(this,HT),Ps(this,xT),Ps(this,ub),pp(this,"commandExecutor",new iH(this.hot)),pp(this,"itemsFactory",null),pp(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>Wo(this,HT,uQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Pd]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new oH(this.hot,Pg.DEFAULT_ITEMS);const n=this.hot.getSettings()[Pd],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Hl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Wo(this,DT,cQ).call(this)),this.menu.addLocalHook("afterOpen",()=>Wo(this,NT,hQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>Wo(this,LT,dQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>Wo(this,$T,fQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),T(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=yg(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:wp},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:wp}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wp)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Wo(this,xT,lQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ye(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function vH(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function lQ(t){if(t.stopPropagation(),De(t.target,EC)){const e=yg(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function uQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${EC}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=EC,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(_e(s,[yo(),Tv(" ")]),_e(e,[wI("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function cQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function hQ(){this.hot.runHooks("afterDropdownMenuShow",this),Wo(this,ub,vH).call(this,this.menu)}function dQ(t){Wo(this,ub,vH).call(this,t)}function fQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}Pg.SEPARATOR={name:ze};function kT(t,e,n){return e=gQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gQ(t){var e=mQ(t,"string");return typeof e=="symbol"?e:String(e)}function mQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pQ{constructor(e){kT(this,"hot",void 0),kT(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return Ce(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(Ce(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();Ce(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();Ce(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const wQ=pQ;function FT(t,e,n){return e=CQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function CQ(t){var e=vQ(t,"string");return typeof e=="symbol"?e:String(e)}function vQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cb{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){FT(this,"dataProvider",void 0),FT(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Bn(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Kt(Bn(cb.DEFAULT_OPTIONS),n),n=Kt(n,e),n.filename=Ev(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const SQ=cb,yQ=String.fromCharCode(13),bQ=String.fromCharCode(34),RQ=String.fromCharCode(10);class EQ extends SQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ue(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),T(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Ft(e);return r!==""&&(n||r.indexOf(yQ)>=0||r.indexOf(bQ)>=0||r.indexOf(RQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const TQ=EQ,_Q="csv",TC={[_Q]:TQ};function MQ(t,e,n){return typeof TC[t]=="function"?new TC[t](e,n):null}const AQ="exportFile",OQ=240;class IQ extends ot{static get PLUGIN_KEY(){return AQ}static get PLUGIN_PRIORITY(){return OQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!TC[e])throw new Error(`Export format type "${e}" is not supported.`);return MQ(e,new wQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Na(t,e,n){return e=PQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PQ(t){var e=xQ(t,"string");return typeof e=="symbol"?e:String(e)}function xQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kc{constructor(e,n){let{id:r,stateless:i=!0}=n;Na(this,"hot",void 0),Na(this,"id",void 0),Na(this,"elements",[]),Na(this,"hidden",!1),Na(this,"stateId",""),Na(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new fg)}getElements(){return this.elements}reset(){T(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}mt(kc,ir);const hc={};function ls(t,e){if(!hc[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=hc[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function js(t){if(!hc[t])throw Error(`Filter condition "${t}" does not exist.`);return hc[t].descriptor}function Xt(t,e,n){n.key=t,hc[t]={condition:e,descriptor:n}}const hn="none";function HQ(){return!0}Xt(hn,HQ,{name:gg,inputsCount:0,showOperators:!1});const Vu="empty";function DQ(t){return en(t.value)}Xt(Vu,DQ,{name:hy,inputsCount:0,showOperators:!0});const xd="not_empty";function NQ(t,e){return!ls(Vu,e)(t)}Xt(xd,NQ,{name:dy,inputsCount:0,showOperators:!0});const Bu="eq";function LQ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale)===Ft(n)}Xt(Bu,LQ,{name:fy,inputsCount:1,showOperators:!0});const Hd="neq";function $Q(t,e){return!ls(Bu,e)(t)}Xt(Hd,$Q,{name:gy,inputsCount:1,showOperators:!0});const SH="gt";function kQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Xt(SH,kQ,{name:vy,inputsCount:1,showOperators:!0});const yH="gte";function FQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Xt(yH,FQ,{name:Sy,inputsCount:1,showOperators:!0});const bH="lt";function WQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Xt(bH,WQ,{name:yy,inputsCount:1,showOperators:!0});const RH="lte";function VQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Xt(RH,VQ,{name:by,inputsCount:1,showOperators:!0});const hb="date_after";function BQ(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Xt(hb,BQ,{name:Ty,inputsCount:1,showOperators:!0});const db="date_before";function UQ(t,e){let[n]=e;const r=Z(t.value,t.meta.dateFormat),i=Z(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Xt(db,UQ,{name:_y,inputsCount:1,showOperators:!0});const pf="between";function YQ(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ls(db,[o]),a=ls(hb,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Xt(pf,YQ,{name:Ry,inputsCount:2,showOperators:!0});const EH="not_between";function GQ(t,e){return!ls(pf,e)(t)}Xt(EH,GQ,{name:Ey,inputsCount:2,showOperators:!0});const TH="begins_with";function zQ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Ft(n))}Xt(TH,zQ,{name:my,inputsCount:1,showOperators:!0});const _H="ends_with";function jQ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Ft(n))}Xt(_H,jQ,{name:py,inputsCount:1,showOperators:!0});const fb="contains";function KQ(t,e){let[n]=e;return Ft(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Ft(n))>=0}Xt(fb,KQ,{name:wy,inputsCount:1,showOperators:!0});const MH="not_contains";function XQ(t,e){return!ls(fb,e)(t)}Xt(MH,XQ,{name:Cy,inputsCount:1,showOperators:!0});const AH="date_tomorrow";function qQ(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}Xt(AH,qQ,{name:Ay,inputsCount:0});const OH="date_today";function ZQ(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}Xt(OH,ZQ,{name:My,inputsCount:0});const IH="date_yesterday";function QQ(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}Xt(IH,QQ,{name:Oy,inputsCount:0});mP();function JQ(t,e){let n=t;return n===""&&(n=`(${e})`),n}const _C=new Set([1]).has(1),eJ=_C&&typeof Array.from=="function";function Fc(t){let e=t;return _C&&(e=new Set(e)),function(n){let r;return _C?r=e.has(n):r=!!~e.indexOf(n),r}}function PH(t){return t??""}function MC(t){let e=t;return eJ?e=Array.from(new Set(e)):e=yv(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function WT(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Fc(e)),T(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:JQ(a,n)};r&&r(u),i.push(u)}),i}const Ks="by_value";function tJ(t,e){let[n]=e;return n(t.value)}Xt(Ks,tJ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Fc(e)]},showOperators:!1});const dc={};function nJ(t){if(!dc[t])throw Error(`Operation with id "${t}" does not exist.`);const e=dc[t].func;return function(n,r){return e(n,r)}}function rJ(t){return dc[t].name}function gb(t,e,n){dc[t]={name:e,func:n}}const ts="conjunction",iJ=xy;function oJ(t,e){return t.every(n=>n.func(e))}gb(ts,iJ,oJ);const wf="disjunction",sJ=mg;function aJ(t,e){return t.some(n=>n.func(e))}gb(wf,sJ,aJ);const mb="disjunctionWithExtraCondition",lJ=mg;function uJ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}gb(mb,lJ,uJ);const cJ="numeric",xH="text",hJ="date",VT={[cJ]:[hn,ze,Vu,xd,ze,Bu,Hd,ze,SH,yH,bH,RH,pf,EH],[xH]:[hn,ze,Vu,xd,ze,Bu,Hd,ze,TH,_H,ze,fb,MH],[hJ]:[hn,ze,Vu,xd,ze,Bu,Hd,ze,db,hb,pf,ze,AH,OH,IH]};function dJ(t){const e=[];let n=t;return VT[n]||(n=xH),T(VT[n],r=>{let i;r===ze?i={name:ze}:i=Bn(js(r)),e.push(i)}),e}function uu(t,e,n){return e=fJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fJ(t){var e=gJ(t,"string");return typeof e=="symbol"?e:String(e)}function gJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Cp="built",vp="building",BT=["click","input","keydown","keypress","keyup","focus","blur","change"];let qr=class HH{static get DEFAULTS(){return Bn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){uu(this,"hot",void 0),uu(this,"eventManager",new gr(this)),uu(this,"options",void 0),uu(this,"_element",void 0),uu(this,"buildState",void 0),this.hot=e,this.options=Kt(HH.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===vp?this._element:this.buildState===Cp?(this.update(),this._element):(this.buildState=vp,this.build(),this.buildState=Cp,this._element)}isBuilt(){return this.buildState===Cp}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Gn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=vp),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&J(this._element,this.options.className),this.options.children.length)T(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ye(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),T(BT,r=>e(n,r))}else T(BT,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mt(qr,ir);function mJ(t,e){DH(t,e),e.add(t)}function pJ(t,e,n){DH(t,e),e.set(t,n)}function DH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bh(t,e){var n=NH(t,e,"get");return wJ(t,n)}function wJ(t,e){return e.get?e.get.call(t):e.value}function CJ(t,e,n){var r=NH(t,e,"set");return vJ(t,r,n),n}function NH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function SJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var La=new WeakMap,UT=new WeakSet;class ns extends qr{static get DEFAULTS(){return Bn({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Kt(ns.DEFAULTS,n)),mJ(this,UT),pJ(this,La,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>SJ(this,UT,yJ).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");CJ(this,La,this._element.firstChild),J(this._element,"htUIInput"),J(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Bh(this,La).type=this.options.type,Bh(this,La).placeholder=this.translateIfPossible(this.options.placeholder),Bh(this,La).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Bh(this,La).focus()}}function yJ(t){this.options.value=t.target.value}function Sp(t,e){LH(t,e),e.add(t)}function cu(t,e,n){LH(t,e),e.set(t,n)}function LH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $a(t,e,n){var r=$H(t,e,"set");return bJ(t,r,n),n}function bJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function yp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function xt(t,e){var n=$H(t,e,"get");return RJ(t,n)}function $H(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function RJ(t,e){return e.get?e.get.call(t):e.value}var nn=new WeakMap,Uh=new WeakMap,Yh=new WeakMap,bp=new WeakMap,Gh=new WeakMap,YT=new WeakSet,GT=new WeakSet,zT=new WeakSet;class fc extends qr{static get DEFAULTS(){return Bn({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Kt(fc.DEFAULTS,n)),Sp(this,zT),Sp(this,GT),Sp(this,YT),cu(this,nn,{writable:!0,value:null}),cu(this,Uh,{writable:!0,value:[]}),cu(this,Yh,{writable:!0,value:void 0}),cu(this,bp,{writable:!0,value:void 0}),cu(this,Gh,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return xt(this,nn)}registerHooks(){this.addLocalHook("click",()=>yp(this,zT,_J).call(this))}setItems(e){$a(this,Uh,this.translateNames(e)),xt(this,nn)&&xt(this,nn).setMenuItems(xt(this,Uh))}translateNames(e){return T(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),$a(this,nn,new Hl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),xt(this,nn).setMenuItems(xt(this,Uh));const e=new qr(this.hot,{className:"htUISelectCaption"}),n=new qr(this.hot,{className:"htUISelectDropdown"});$a(this,Yh,e),$a(this,bp,e.element),$a(this,Gh,n),this.hot.getSettings().ariaTags&&(_e(n.element,[yo()]),_e(this._element,[pI()])),T([e,n],r=>this._element.appendChild(r.element)),xt(this,nn).addLocalHook("select",r=>yp(this,YT,EJ).call(this,r)),xt(this,nn).addLocalHook("afterClose",()=>yp(this,GT,TJ).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=xt(this,nn).hot.getTranslatedPhrase(gg),xt(this,bp).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();xt(this,nn)&&(xt(this,nn).open(),xt(this,nn).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),xt(this,nn).getNavigator().toFirstItem(),xt(this,nn).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){xt(this,nn)&&xt(this,nn).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){xt(this,nn)&&(xt(this,nn).destroy(),$a(this,nn,null)),xt(this,Yh)&&xt(this,Yh).destroy(),xt(this,Gh)&&xt(this,Gh).destroy(),super.destroy()}}function EJ(t){t.name!==ze&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function TJ(){this.runLocalHooks("afterClose")}function _J(){this.openOptions()}function jT(t,e){MJ(t,e),e.add(t)}function MJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KT(t,e,n){return e=AJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AJ(t){var e=OJ(t,"string");return typeof e=="symbol"?e:String(e)}function OJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var qT=new WeakSet,ZT=new WeakSet;class AC extends kc{constructor(e,n){super(e,{id:n.id,stateless:!1}),jT(this,ZT),jT(this,qT),KT(this,"name",""),KT(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new fc(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new ns(this.hot,{placeholder:ky})),this.elements.push(new ns(this.hot,{placeholder:Fy})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>XT(this,qT,IJ).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),T(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>XT(this,ZT,PJ).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Bn(e.command);n.name.startsWith(Wt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),T(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||js(hn),n=[];return T(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=js(e?e.name:hn);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||T(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof fc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof ns)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{J(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&J(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[js(hn)];if(e!==null){const{visualIndex:r}=e;n=dJ(this.hot.getDataType(0,r,this.hot.countRows(),r))}T(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function IJ(t){T(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function PJ(t){Ol(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Pr(t))}function QT(t,e,n){xJ(t,e),e.set(t,n)}function xJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hu(t,e){var n=kH(t,e,"get");return HJ(t,n)}function HJ(t,e){return e.get?e.get.call(t):e.value}function JT(t,e,n){var r=kH(t,e,"set");return DJ(t,r,n),n}function kH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function DJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ka=new WeakMap,Rp=new WeakMap;class Cf extends qr{static get DEFAULTS(){return Bn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Kt(Cf.DEFAULTS,n)),QT(this,ka,{writable:!0,value:void 0}),QT(this,Rp,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),JT(this,Rp,e),JT(this,ka,this._element.firstChild),hu(this,ka).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(hu(this,Rp).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return hu(this,ka).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(hu(this,ka).checked=e)}focus(){this.isBuilt()&&hu(this,ka).focus()}}function NJ(t,e){LJ(t,e),e.add(t)}function LJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $J(t,e,n){return e=kJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kJ(t){var e=FJ(t,"string");return typeof e=="symbol"?e:String(e)}function FJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const e_=0;var t_=new WeakSet;class VJ extends kc{constructor(e,n){super(e,{id:n.id,stateless:!1}),NJ(this,t_),$J(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(J(n.parentNode,"htFiltersMenuOperators"),T(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ts,wf];T(e,n=>{const r=new Cf(this.hot,{name:"operator",label:{htmlFor:n,textContent:rJ(n)},value:n,checked:n===e[e_],id:n});r.addLocalHook("change",i=>WJ(this,t_,BJ).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ft`Radio button with index ${e} doesn't exist.`);T(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Cf&&n.isChecked());return e?e.getValue():ts}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&T(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ts,n=arguments.length>1?arguments[1]:void 0,r=e;r===mb&&(r=wf),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(e_)}}function BJ(t){this.setState(t.target.value)}function UJ(t,e,n){YJ(t,e),e.set(t,n)}function YJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ep(t,e){var n=FH(t,e,"get");return GJ(t,n)}function GJ(t,e){return e.get?e.get.call(t):e.value}function zJ(t,e,n){var r=FH(t,e,"set");return jJ(t,r,n),n}function FH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var du=new WeakMap;class gc extends qr{static get DEFAULTS(){return Bn({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Kt(gc.DEFAULTS,n)),UJ(this,du,{writable:!0,value:void 0})}build(){super.build(),zJ(this,du,this._element.firstChild)}update(){this.isBuilt()&&(Ep(this,du).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Ep(this,du).focus()}activate(){Ep(this,du).click()}}function zh(t,e){WH(t,e),e.add(t)}function Fa(t,e,n){WH(t,e),e.set(t,n)}function WH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Le(t,e){var n=VH(t,e,"get");return KJ(t,n)}function KJ(t,e){return e.get?e.get.call(t):e.value}function kr(t,e,n){var r=VH(t,e,"set");return XJ(t,r,n),n}function VH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function XJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const n_="multipleSelect.itemBox";var Yr=new WeakMap,At=new WeakMap,Tp=new WeakMap,Gi=new WeakMap,Ho=new WeakMap,Do=new WeakMap,r_=new WeakSet,i_=new WeakSet,o_=new WeakSet,s_=new WeakSet;class mc extends qr{static get DEFAULTS(){return Bn({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Kt(mc.DEFAULTS,n)),zh(this,s_),zh(this,o_),zh(this,i_),zh(this,r_),Fa(this,Yr,{writable:!0,value:[]}),Fa(this,At,{writable:!0,value:void 0}),Fa(this,Tp,{writable:!0,value:void 0}),Fa(this,Gi,{writable:!0,value:void 0}),Fa(this,Ho,{writable:!0,value:void 0}),Fa(this,Do,{writable:!0,value:void 0}),kr(this,Gi,new ns(this.hot,{placeholder:$y,className:"htUIMultipleSelectSearch"})),kr(this,Ho,new gc(this.hot,{textContent:Hy,className:"htUISelectAll"})),kr(this,Do,new gc(this.hot,{textContent:Dy,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Le(this,At)}registerHooks(){Le(this,Gi).addLocalHook("keydown",e=>jh(this,i_,ZJ).call(this,e)),Le(this,Gi).addLocalHook("input",e=>jh(this,r_,qJ).call(this,e)),Le(this,Ho).addLocalHook("click",e=>jh(this,o_,QJ).call(this,e)),Le(this,Do).addLocalHook("click",e=>jh(this,s_,JJ).call(this,e))}setItems(e){kr(this,Yr,e),Le(this,At)&&Le(this,At).loadData(Le(this,Yr))}setLocale(e){kr(this,Tp,e)}getLocale(){return Le(this,Tp)}getItems(){return[...Le(this,Yr)]}getValue(){return tee(Le(this,Yr))}getSearchInputElement(){return Le(this,Gi)}getSelectAllElement(){return Le(this,Ho)}getClearAllElement(){return Le(this,Do)}isSelectedAllValues(){return Le(this,Yr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new qr(this.hot,{className:"htUISelectionControls",children:[Le(this,Ho),Le(this,Do)]});this._element.appendChild(Le(this,Gi).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Le(this,At)&&Le(this,At).destroy(),J(o,"htUIMultipleSelectHot"),kr(this,At,new this.hot.constructor(o,{data:Le(this,Yr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,d,f,p)=>{l.title=p.instance.getDataAtRowProp(u,p.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Le(this,At).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Le(this,At).container.scrollWidth-on(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Le(this,At).init();const a=Le(this,At).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:n_}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Le(this,At).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:n_})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Le(this,At).listen()}reset(){Le(this,Gi).reset(),Le(this,Ho).reset(),Le(this,Do).reset()}update(){this.isBuilt()&&(Le(this,At).loadData(eee(Le(this,Yr),this.options.value)),super.update())}destroy(){Le(this,At)&&Le(this,At).destroy(),Le(this,Gi).destroy(),Le(this,Do).destroy(),Le(this,Ho).destroy(),kr(this,Gi,null),kr(this,Do,null),kr(this,Ho,null),kr(this,At,null),kr(this,Yr,null),super.destroy()}}function qJ(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Le(this,Yr)]:n=fr(Le(this,Yr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Le(this,At).loadData(n)}function ZJ(t){this.runLocalHooks("keydown",t,this),Dv(Ol,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Pr(t),Le(this,At).listen(),Le(this,At).selectCell(0,0))}function QJ(t){const e=[];t.preventDefault(),T(Le(this,At).getSourceData(),(n,r)=>{n.checked=!0,e.push(fS(n,r)[0])}),Le(this,At).setSourceDataAtCell(e)}function JJ(t){const e=[];t.preventDefault(),T(Le(this,At).getSourceData(),(n,r)=>{n.checked=!1,e.push(fS(n,r)[0])}),Le(this,At).setSourceDataAtCell(e)}function eee(t,e){const n=Fc(e);return Ue(t,r=>(r.checked=n(r.value),r))}function tee(t){const e=[];return T(t,n=>{n.checked&&e.push(n.value)}),e}function nee(t,e){ree(t,e),e.add(t)}function ree(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iee(t,e,n){return e=oee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=see(t,"string");return typeof e=="symbol"?e:String(e)}function see(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var a_=new WeakSet;class lee extends kc{constructor(e,n){super(e,{id:n.id,stateless:!1}),nee(this,a_),iee(this,"name",""),this.name=n.name,this.elements.push(new mc(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>aee(this,a_,uee).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Ks){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?hn:Ks},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=fr(i,d=>d.name===Ks),u={},c=this.hot.getTranslatedPhrase(lf);if(l){const d=MC(Ue(s(r,a),v=>v.value));o&&(l.args[0]=o);const f=[],p=WT(d,l.args[0],c,v=>{v.checked&&f.push(v.value)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[f],u.command=js(Ks),u.itemsSnapshot=p}else u.args=[],u.command=js(hn);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof mc)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{J(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(lf),n=MC(this._getColumnVisibleValues()),r=WT(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),n=>PH(n))}}function uee(t){Ol(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Pr(t))}var BH;function cee(t,e){hee(t,e),e.add(t)}function hee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dee(t,e,n){return e=fee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fee(t){var e=gee(t,"string");return typeof e=="symbol"?e:String(e)}function gee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var l_=new WeakSet;class pc extends kc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),cee(this,l_),dee(this,"name",""),this.name=n.name,this.elements.push(new ns(this.hot,{type:"button",value:Ny,className:"htUIButton htUIButtonOK",identifier:pc.BUTTON_OK})),this.elements.push(new ns(this.hot,{type:"button",value:Ly,className:"htUIButton htUIButtonCancel",identifier:pc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){T(this.elements,e=>{e.addLocalHook("click",(n,r)=>mee(this,l_,pee).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(J(n.parentNode,"htFiltersMenuActionBar"),T(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}BH=pc;function pee(t,e){e.options.identifier===BH.BUTTON_OK?this.accept():this.cancel()}function _p(t,e,n){return e=wee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:String(e)}function Cee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const u_="ConditionCollection.filteringStates";class UH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_p(this,"hot",void 0),_p(this,"isMapRegistrable",void 0),_p(this,"filteringStates",new fg),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(u_,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ts;return e.length?nJ(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ts,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ue(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ft`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ct(dc[r]))throw new Error(ft`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ls(a,s)}]},i):u.push({name:a,args:s,func:ls(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Yt(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ue(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),T(e,n=>{T(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(u_),this.filteringStates=null,this.clearLocalHooks()}}mt(UH,ir);const YH=UH;function c_(t,e,n){return e=vee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vee(t){var e=See(t,"string");return typeof e=="symbol"?e:String(e)}function See(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];c_(this,"conditionCollection",void 0),c_(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return T(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return T(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return T(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const GH=yee;function Mp(t,e){bee(t,e),e.add(t)}function bee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xs(t,e,n){return e=Ree(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ree(t){var e=Eee(t,"string");return typeof e=="symbol"?e:String(e)}function Eee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ap(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var h_=new WeakSet,d_=new WeakSet,f_=new WeakSet;class zH{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Mp(this,f_),Mp(this,d_),Mp(this,h_),xs(this,"hot",void 0),xs(this,"conditionCollection",void 0),xs(this,"columnDataFactory",void 0),xs(this,"changes",[]),xs(this,"grouping",!1),xs(this,"latestEditedColumnPosition",-1),xs(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>Ap(this,h_,Tee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>Ap(this,d_,_ee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>Ap(this,f_,Mee).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,T(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=HI(function(c,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const p=new YH(r.hot,!1),w=[].concat(c,f);p.importAllConditions(w);const v=r.columnDataFactory(d);let y;p.isEmpty()?y=v:y=new GH(p,_=>r.columnDataFactory(_)).filter(),y=Ue(y,_=>_.meta.visualRow);const b=Fc(y);return p.destroy(),fr(v,_=>b(_.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ye(this,(e,n)=>{this[n]=null})}}function Tee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function _ee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Mee(){T(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}mt(zH,ir);const Aee=zH;function Oee(t){return aH({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof mc)return r;if(i.element&&!os(i.element))return!1;i.focus()}})}const fu="filters";function Iee(t,e){let n=-1;const r=Oee(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(fu),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof qr&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(fu),callback:()=>{l.isSubMenu()&&l.close(),u.listen(fu)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:d=>{const f=t.getNavigator();f.getCurrentPage()>-1&&(n=f.getCurrentPage()),f.clear(),d.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:d=>{const f=e[r.getCurrentPage()];f instanceof fc&&(f.openOptions(),d.preventDefault()),f instanceof gc&&(f.activate(),d.preventDefault()),f instanceof qr||d.preventDefault()}}],fu)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(fu)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function zi(t,e){jH(t,e),e.add(t)}function Pee(t,e,n){jH(t,e),e.set(t,n)}function jH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gu(t,e,n){return e=xee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xee(t){var e=Hee(t,"string");return typeof e=="symbol"?e:String(e)}function Hee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dee(t,e,n){var r=KH(t,e,"set");return Nee(t,r,n),n}function Nee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function mu(t,e){var n=KH(t,e,"get");return Lee(t,n)}function KH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lee(t,e){return e.get?e.get.call(t):e.value}function Fr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const OC="filters",$ee=250,g_=OC;var Hs=new WeakMap,m_=new WeakSet,p_=new WeakSet,w_=new WeakSet,C_=new WeakSet,Op=new WeakSet,v_=new WeakSet,Ip=new WeakSet,S_=new WeakSet,y_=new WeakSet;class kee extends ot{static get PLUGIN_KEY(){return OC}static get PLUGIN_PRIORITY(){return $ee}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),zi(this,y_),zi(this,S_),zi(this,Ip),zi(this,v_),zi(this,Op),zi(this,C_),zi(this,w_),zi(this,p_),zi(this,m_),gu(this,"dropdownMenuPlugin",null),gu(this,"conditionCollection",null),gu(this,"conditionUpdateObserver",null),gu(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),gu(this,"filtersRowsMap",null),Pee(this,Hs,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Fr(this,S_,Yee).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[OC]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new xc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Fr(this,Op,b_).call(this,"accept")),s.addLocalHook("cancel",()=>Fr(this,Op,b_).call(this,"cancel")),s.addLocalHook("change",a=>Fr(this,v_,Uee).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(Iy)}:`,o=()=>`${this.hot.getTranslatedPhrase(Py)}:`;if(!this.components.get("filter_by_condition")){const s=new AC(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Fr(this,Ip,R_).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new VJ(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new AC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Fr(this,Ip,R_).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new lee(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new pc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new YH(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Aee(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Fr(this,y_,Gee).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Fr(this,C_,Bee).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Fr(this,p_,Wee).call(this)),this.addHook("afterDropdownMenuHide",()=>Fr(this,w_,Vee).call(this)),this.addHook("afterChange",s=>Fr(this,m_,Fee).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!mu(this,Hs)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=mu(this,Hs).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Dee(this,Hs,Iee(s,a));const l=u=>{mu(this,Hs).listen(),u.preventDefault(),Ol(u.keyCode,"TAB")&&(u.shiftKey?mu(this,Hs).toPreviousItem():mu(this,Hs).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:g_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(g_)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ts;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=Fc(i);Ce(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),T(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return T(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:p,locale:w}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:p,locale:w},value:PH(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=MC(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===wf&&n.command.key!==hn&&r.command.key!==hn&&i.command.key!==hn?o=mb:i.command.key!==hn&&(n.command.key===hn||r.command.key===hn)&&(o=ts),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new GH(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return T(i,s=>{T(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Fee(t){t&&T(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Wee(){this.restoreComponents(Array.from(this.components.values()))}function Vee(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Bee(t){t.items.push({name:ze}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function b_(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==hn&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==hn&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==hn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Uee(t,e){this.updateDependentComponentsVisibility(),t.constructor===AC&&!e.inputsCount&&this.setListeningDropdownMenu()}function R_(){this.setListeningDropdownMenu()}function Yee(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?J(e,"htFiltersActive"):$e(e,"htFiltersActive")}function Gee(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===Ks),o=n.filter(s=>s.name!==Ks);if(i.length>=2||o.length>=3)vt(ft`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const XH="internal-use-in-handsontable",IC={licenseKey:XH,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function qH(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[En])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function ZH(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function zee(t){var e;const n=t[En],r=ZH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=qH(t);return{...IC,...r,...i}}function jee(t){var e;const n=t[En],r=ZH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=qH(t);return{...r,...i}}function Kee(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function xg(){const t="engine_relationship",e=ni(En);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function pb(){const t="shared_engine_usage",e=ni(En);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Xee(t){const e=t.getSettings(),n=e[En],r=n==null?void 0:n.engine;if(n===!0||Ct(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return qee((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ct(r.hyperformula)){const o=xg(),s=pb().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:XH}),(r.getConfig().leapYear1900!==IC.leapYear1900||og(r.getConfig().nullDate,IC.nullDate)===!1)&&vt(ft`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function qee(t,e,n){const r=e[En],i=zee(e),o=xg(),s=pb();Zee(t,r.functions),Qee(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Jee(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function E_(t){var e;const n=xg(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function T_(t,e){if(t){const n=xg(),r=n.get(t),i=pb(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Zee(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){vt(s.message)}})}function Qee(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){vt(r.message)}}}function Jee(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){vt(a.message)}}),t.resumeEvaluation())}function ete(t,e){return(Ct(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const QH="DD/MM/YYYY";function JH(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function tte(t){return JH(t)?t.substr(1):t}function nte(t){return typeof t=="string"&&t.startsWith("=")}function wb(t,e){return typeof t=="string"&&e==="date"}function eD(t,e){return Z(t,e,!0).isValid()}function tD(t,e){return Z(t,e,!0).format(QH)}function rte(t,e){return Z(t,QH,!0).format(e)}function nD(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Z(r).format(e)}function Ds(t,e,n){ite(t,e),e.set(t,n)}function ite(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){var n=rD(t,e,"get");return ote(t,n)}function ote(t,e){return e.get?e.get.call(t):e.value}function No(t,e,n){var r=rD(t,e,"set");return ste(t,r,n),n}function rD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ste(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var pu=new WeakMap,Lo=new WeakMap,or=new WeakMap,Kh=new WeakMap,Pp=new WeakMap,xp=new WeakMap,Xh=new WeakMap;class ate{constructor(e,n,r){Ds(this,pu,{writable:!0,value:void 0}),Ds(this,Lo,{writable:!0,value:void 0}),Ds(this,or,{writable:!0,value:void 0}),Ds(this,Kh,{writable:!0,value:[]}),Ds(this,Pp,{writable:!0,value:[]}),Ds(this,xp,{writable:!0,value:void 0}),Ds(this,Xh,{writable:!0,value:[]}),No(this,pu,e),No(this,Lo,n),No(this,or,r)}setRemovedHfIndexes(e){return No(this,Xh,e.map(n=>{const r=bt(this,Lo).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),bt(this,Xh)}getRemovedHfIndexes(){return bt(this,Xh)}getHfIndexFromVisualIndex(e){const n=bt(this,Lo).getIndexesSequence(),r=bt(this,Lo).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${_n(bt(this,pu))}s`;bt(this,or).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&bt(this,or).getEngine()[r](bt(this,or).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(No(this,Pp,e.map(i=>this.getHfIndexFromVisualIndex(i))),No(this,xp,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=bt(this,Lo).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(bt(this,or).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(bt(this,Pp),bt(this,xp)));bt(this,or).getSheetId()===null?bt(this,or).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${_n(bt(this,pu))}Order`;return n=>{if(bt(this,or).isPerformingUndoRedo())return;const r=bt(this,Lo).getIndexesSequence();if(n==="update"){const i=bt(this,Kh).map(l=>r.indexOf(l)),o=bt(this,or).getEngine().getSheetDimensions(bt(this,or).getSheetId());let s;bt(this,pu)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);bt(this,or).getEngine()[e](bt(this,or).getSheetId(),i)}No(this,Kh,r)}}init(){No(this,Kh,bt(this,Lo).getIndexesSequence())}}const __=ate;function Ns(t,e,n){lte(t,e),e.set(t,n)}function lte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ji(t,e){var n=iD(t,e,"get");return ute(t,n)}function ute(t,e){return e.get?e.get.call(t):e.value}function Ls(t,e,n){var r=iD(t,e,"set");return cte(t,r,n),n}function iD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var qh=new WeakMap,Zh=new WeakMap,Hp=new WeakMap,Dp=new WeakMap,Np=new WeakMap,Lp=new WeakMap,$p=new WeakMap;class hte{constructor(e,n,r){Ns(this,qh,{writable:!0,value:void 0}),Ns(this,Zh,{writable:!0,value:void 0}),Ns(this,Hp,{writable:!0,value:void 0}),Ns(this,Dp,{writable:!0,value:!1}),Ns(this,Np,{writable:!0,value:!1}),Ns(this,Lp,{writable:!0,value:null}),Ns(this,$p,{writable:!0,value:null}),Ls(this,qh,new __("row",e,this)),Ls(this,Zh,new __("column",n,this)),Ls(this,Hp,r)}getForAxis(e){return e==="row"?ji(this,qh):ji(this,Zh)}setPerformUndo(e){Ls(this,Dp,e)}setPerformRedo(e){Ls(this,Np,e)}isPerformingUndoRedo(){return ji(this,Dp)||ji(this,Np)}getSheetId(){return ji(this,$p)}getEngine(){return ji(this,Lp)}getPostponeAction(){return ji(this,Hp)}setupSyncEndpoint(e,n){Ls(this,Lp,e),Ls(this,$p,n),ji(this,qh).init(),ji(this,Zh).init()}}const dte=hte;function Mt(t,e){oD(t,e),e.add(t)}function Wa(t,e,n){return e=fte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fte(t){var e=gte(t,"string");return typeof e=="symbol"?e:String(e)}function gte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kp(t,e,n){oD(t,e),e.set(t,n)}function oD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e,n){var r=sD(t,e,"set");return mte(t,r,n),n}function mte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function pl(t,e){var n=sD(t,e,"get");return pte(t,n)}function sD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pte(t,e){return e.get?e.get.call(t):e.value}function pt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const En="formulas",wte=["maxRows","maxColumns","language"],Cte=260;ge.getSingleton().register("afterNamedExpressionAdded");ge.getSingleton().register("afterNamedExpressionRemoved");ge.getSingleton().register("afterSheetAdded");ge.getSingleton().register("afterSheetRemoved");ge.getSingleton().register("afterSheetRenamed");ge.getSingleton().register("afterFormulasValuesUpdate");const Dl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var wo=new WeakMap,Cb=new WeakMap,wu=new WeakMap,M_=new WeakSet,A_=new WeakSet,Fp=new WeakSet,O_=new WeakSet,Wp=new WeakSet,I_=new WeakSet,P_=new WeakSet,Vp=new WeakSet,x_=new WeakSet,H_=new WeakSet,D_=new WeakSet,N_=new WeakSet,L_=new WeakSet,$_=new WeakSet,k_=new WeakSet,F_=new WeakSet,W_=new WeakSet,V_=new WeakSet,B_=new WeakSet,U_=new WeakSet,Y_=new WeakSet,G_=new WeakSet,z_=new WeakSet,j_=new WeakSet;class vte extends ot{constructor(){var e;super(...arguments),e=this,Mt(this,j_),Mt(this,z_),Mt(this,G_),Mt(this,Y_),Mt(this,U_),Mt(this,B_),Mt(this,V_),Mt(this,W_),Mt(this,F_),Mt(this,k_),Mt(this,$_),Mt(this,L_),Mt(this,N_),Mt(this,D_),Mt(this,H_),Mt(this,x_),Mt(this,Vp),Mt(this,P_),Mt(this,I_),Mt(this,Wp),Mt(this,O_),Mt(this,Fp),Mt(this,A_),Mt(this,M_),kp(this,wo,{writable:!0,value:!1}),kp(this,Cb,{writable:!0,value:!1}),kp(this,wu,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,B_,Nte).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,U_,Lte).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,Y_,$te).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,G_,kte).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,z_,Fte).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pt(e,j_,Wte).call(e,...r)}]]}),Wa(this,"staticRegister",ni("formulas")),Wa(this,"engine",null),Wa(this,"sheetName",null),Wa(this,"indexSyncer",null),Wa(this,"rowAxisSyncer",null),Wa(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return En}static get PLUGIN_PRIORITY(){return Cte}static get SETTING_KEYS(){return[En,...wte]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[En]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Xee(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){vt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Fp,K_).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Wp,X_).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Fp,K_).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Wp,X_).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,I_,Rte).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,P_,Ete).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,M_,Ste).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,x_,Tte).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Vp,q_).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,Vp,q_).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,H_,_te).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,D_,Mte).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,$_,Ite).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,k_,Pte).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,N_,Ate).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,L_,Ote).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,F_,xte).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,W_,Hte).call(n,...i)}),this.indexSyncer=new dte(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,O_,bte).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,V_,Dte).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return pt(n,A_,yte).call(n,...i)}),pl(this,wu).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){pl(this,wu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),T_(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=jee(this.hot.getSettings());Kee(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[En];if(ce(r)&&ce(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[En].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){pl(this,wu).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),us(this,wu,null),T_(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ce(n)&&!WP(n))return vt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return vt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return vt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Wv(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${_n(En)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),E_(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ce(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ce(l)===!1||ce(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,d=r(o);if(c!==void 0&&!i.has(d)){const f=E_(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){vt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return wb(r,o.type)&&(eD(r,o.dateFormat)?r=tD(r,o.dateFormat):nte(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Ste(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Vn(s)&&(s=nD(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function yte(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const p=this.engine.getFillRangeData(d,f),{row:w,col:v}=d.start,{row:y,col:b}=d.end,_=y-w+1,I=b-v+1;for(let L=0;L<p.length;L+=1)for(let x=0;x<p[L].length;x+=1){const W=p[L][x],G=L%_,ne=x%I,j=this.hot.getCellMeta(G,ne);wb(W,j.type)&&(W.startsWith("'")?p[L][x]=W.slice(1):this.isFormulaCellType(G,ne,this.sheetId)===!1&&(p[L][x]=rte(W,j.dateFormat)))}return p}function K_(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(_n(En))||us(this,Cb,Ct(this.hot.getSettings().data))}function bte(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;wb(i,s.type)&&(e=!0,eD(i,a)?t[r][o]=tD(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(us(this,wo,!0),this.engine.setSheetContent(this.sheetId,t),us(this,wo,!1))}function X_(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(_n(En)))if(this.sheetName=ete(this.engine,this.hot.getSettings()[En].sheetName),pl(this,Cb))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){us(this,wo,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),us(this,wo,!1)}}}function Rte(t,e,n,r){if(r!=="get"||pl(this,wo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){JH(n.value)&&(n.value=tte(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&Vn(a)&&(a=nD(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Ete(t,e,n,r){if(r!=="get"||pl(this,wo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function q_(t,e){if(Dl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),d=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&d!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Tte(t,e){if(Dl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Vn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){vt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function _te(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Mte(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Ate(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Ote(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Ite(t,e,n){if(Dl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Pte(t,e,n){if(Dl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function xte(t,e,n,r){if(Dl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Hte(t,e,n,r){if(Dl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Dte(t,e,n){var r;us(this,wo,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());us(this,wo,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Nte(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Lte(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function $te(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function kte(t){this.hot.runHooks("afterSheetAdded",t)}function Fte(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function Wte(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Vte(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(ay,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Bte(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(ly,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,f=l-a+1;if(d>f){const p=u.slice(i,o+1);c.push(...p.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const d=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===f&&d>o&&c.push(...u.slice(o+1))}return T(c,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function Va(t,e){aD(t,e),e.add(t)}function Z_(t,e,n){aD(t,e),e.set(t,n)}function aD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function cr(t,e){var n=lD(t,e,"get");return Ute(t,n)}function Ute(t,e){return e.get?e.get.call(t):e.value}function Cu(t,e,n){var r=lD(t,e,"set");return Yte(t,r,n),n}function lD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ge.getSingleton().register("beforeHideColumns");ge.getSingleton().register("afterHideColumns");ge.getSingleton().register("beforeUnhideColumns");ge.getSingleton().register("afterUnhideColumns");const Bp="hiddenColumns",Gte=310;var _i=new WeakMap,fi=new WeakMap,Q_=new WeakSet,J_=new WeakSet,eM=new WeakSet,tM=new WeakSet,nM=new WeakSet,rM=new WeakSet;class zte extends ot{constructor(){super(...arguments),Va(this,rM),Va(this,nM),Va(this,tM),Va(this,eM),Va(this,J_),Va(this,Q_),Z_(this,_i,{writable:!0,value:{}}),Z_(this,fi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Bp}static get PLUGIN_PRIORITY(){return Gte}isEnabled(){return!!this.hot.getSettings()[Bp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Bp];Be(n)&&(Cu(this,_i,n),Ct(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Cu(this,fi,new dg),cr(this,fi).addLocalHook("init",()=>Ba(this,rM,Qte).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,cr(this,fi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ba(e,nM,Zte).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Ba(this,J_,Kte).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>Ba(this,Q_,jte).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ba(e,tM,qte).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Ba(this,eM,Xte).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Cu(this,_i,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=cr(this,fi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));T(l,u=>{o[u]=!1}),i=Yt(o,(u,c,d)=>(c&&u.push(this.hot.toVisualColumn(d)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&cr(this,fi).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{cr(this,fi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(cr(this,fi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return cr(this,fi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Cu(this,_i,null),Cu(this,fi,null),super.destroy()}}function jte(t,e){if(this.isHidden(e))return 0;if(cr(this,_i).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Kte(t,e,n){if(cr(this,_i).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Xte(t){if(cr(this,_i).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;Ce(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function qte(t,e){if(!cr(this,_i).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),J(e,n)}function Zte(t){t.items.push({name:ze},Vte(this),Bte(this))}function Qte(){Array.isArray(cr(this,_i).columns)&&this.hideColumns(cr(this,_i).columns)}function Jte(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(uy,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function ene(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(cy,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,f=l-a+1;if(d>f){const p=u.slice(i,o+1);c.push(...p.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const d=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===f&&d>o&&c.push(...u.slice(o+1))}return T(c,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function Ua(t,e){uD(t,e),e.add(t)}function iM(t,e,n){uD(t,e),e.set(t,n)}function uD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ya(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Er(t,e){var n=cD(t,e,"get");return tne(t,n)}function tne(t,e){return e.get?e.get.call(t):e.value}function vu(t,e,n){var r=cD(t,e,"set");return nne(t,r,n),n}function cD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ge.getSingleton().register("beforeHideRows");ge.getSingleton().register("afterHideRows");ge.getSingleton().register("beforeUnhideRows");ge.getSingleton().register("afterUnhideRows");const Up="hiddenRows",rne=320;var uo=new WeakMap,gi=new WeakMap,oM=new WeakSet,sM=new WeakSet,aM=new WeakSet,lM=new WeakSet,uM=new WeakSet,cM=new WeakSet;class ine extends ot{constructor(){super(...arguments),Ua(this,cM),Ua(this,uM),Ua(this,lM),Ua(this,aM),Ua(this,sM),Ua(this,oM),iM(this,uo,{writable:!0,value:{}}),iM(this,gi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Up}static get PLUGIN_PRIORITY(){return rne}isEnabled(){return!!this.hot.getSettings()[Up]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Up];Be(n)&&(vu(this,uo,n),Ct(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),vu(this,gi,new dg),Er(this,gi).addLocalHook("init",()=>Ya(this,cM,cne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Er(this,gi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ya(e,uM,une).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Ya(this,sM,sne).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>Ya(this,oM,one).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ya(e,lM,lne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Ya(this,aM,ane).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),vu(this,uo,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Er(this,gi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));T(l,u=>{o[u]=!1}),i=Yt(o,(u,c,d)=>(c&&u.push(this.hot.toVisualRow(d)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Er(this,gi).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{Er(this,gi).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(Er(this,gi).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Er(this,gi).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){vu(this,uo,null),vu(this,gi,null),super.destroy()}}function one(t,e){return this.isHidden(e)?0:t}function sne(t,e,n){if(Er(this,uo).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function ane(t){if(Er(this,uo).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;Ce(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function lne(t,e){if(!Er(this,uo).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),J(e,n)}function une(t){t.items.push({name:ze},Jte(this),ene(this))}function cne(){Array.isArray(Er(this,uo).rows)&&this.hideRows(Er(this,uo).rows)}function hne(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase($S)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function dne(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(kS)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function hM(t,e){hD(t,e),e.add(t)}function fne(t,e,n){hD(t,e),e.set(t,n)}function hD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PC(t,e){var n=dD(t,e,"get");return gne(t,n)}function gne(t,e){return e.get?e.get.call(t):e.value}function Yp(t,e,n){var r=dD(t,e,"set");return mne(t,r,n),n}function dD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function dM(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("beforeColumnFreeze");ge.getSingleton().register("afterColumnFreeze");ge.getSingleton().register("beforeColumnUnfreeze");ge.getSingleton().register("afterColumnUnfreeze");const fM="manualColumnFreeze",pne=110;var Us=new WeakMap,gM=new WeakSet,mM=new WeakSet;class wne extends ot{constructor(){super(...arguments),hM(this,mM),hM(this,gM),fne(this,Us,{writable:!0,value:!1})}static get PLUGIN_KEY(){return fM}static get PLUGIN_PRIORITY(){return pne}isEnabled(){return!!this.hot.getSettings()[fM]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>dM(this,gM,Cne).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>dM(this,mM,vne).call(this,e,n)),super.enablePlugin())}disablePlugin(){Yp(this,Us,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;PC(this,Us)||Yp(this,Us,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;PC(this,Us)||Yp(this,Us,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Cne(t){t.items.push({name:"---------"},hne(this),dne(this))}function vne(t,e){if(PC(this,Us)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Qh(t,e,n){return e=Sne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sne(t){var e=yne(t,"string");return typeof e=="symbol"?e:String(e)}function yne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gp=0,pM=1,wM=2,Ga="px";let bne=class{constructor(e){Qh(this,"hot",void 0),Qh(this,"_element",null),Qh(this,"state",Gp),Qh(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=wM}build(){this.state===Gp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=pM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Gp}isAppended(){return this.state===wM}isBuilt(){return this.state>=pM}setPosition(e,n){Vn(e)&&(this._element.style.top=e+Ga),Vn(n)&&(this._element.style[this.inlineProperty]=n+Ga)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Vn(e)&&(this._element.style.width=e+Ga),Vn(n)&&(this._element.style.height=n+Ga)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Vn(e)&&(this._element.style.marginTop=e+Ga),Vn(n)&&(this._element.style[`margin${_n(this.inlineProperty)}`]=n+Ga)}getOffset(){const e=this._element.style,n=`margin${_n(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const fD=bne,Rne="ht__manualColumnMove--backlight";let Ene=class extends fD{build(){super.build(),J(this._element,Rne)}};const Tne=Ene,_ne="ht__manualColumnMove--guideline";let Mne=class extends fD{build(){super.build(),J(this._element,_ne)}};const Ane=Mne;function za(t,e){gD(t,e),e.add(t)}function Wr(t,e,n){gD(t,e),e.set(t,n)}function gD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tr(t,e,n){var r=mD(t,e,"set");return One(t,r,n),n}function One(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function pe(t,e){var n=mD(t,e,"get");return Ine(t,n)}function mD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ine(t,e){return e.get?e.get.call(t):e.value}function ja(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("beforeColumnMove");ge.getSingleton().register("afterColumnMove");const zp="manualColumnMove",Pne=120,CM="ht__manualColumnMove",vf="show-ui",xC="on-moving--columns",HC="after-selection--columns";var Fn=new WeakMap,Uo=new WeakMap,co=new WeakMap,Dd=new WeakMap,Xo=new WeakMap,kn=new WeakMap,Jh=new WeakMap,yr=new WeakMap,ol=new WeakMap,Sf=new WeakMap,Uu=new WeakMap,vM=new WeakSet,SM=new WeakSet,yM=new WeakSet,bM=new WeakSet,RM=new WeakSet,EM=new WeakSet;class xne extends ot{constructor(){super(...arguments),za(this,EM),za(this,RM),za(this,bM),za(this,yM),za(this,SM),za(this,vM),Wr(this,Fn,{writable:!0,value:new Tne(this.hot)}),Wr(this,Uo,{writable:!0,value:new Ane(this.hot)}),Wr(this,co,{writable:!0,value:[]}),Wr(this,Dd,{writable:!0,value:0}),Wr(this,Xo,{writable:!0,value:!1}),Wr(this,kn,{writable:!0,value:{}}),Wr(this,Jh,{writable:!0,value:void 0}),Wr(this,yr,{writable:!0,value:void 0}),Wr(this,ol,{writable:!0,value:void 0}),Wr(this,Sf,{writable:!0,value:void 0}),Wr(this,Uu,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return zp}static get PLUGIN_PRIORITY(){return Pne}isEnabled(){return!!this.hot.getSettings()[zp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ja(e,vM,Hne).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ja(e,yM,Nne).call(e,...r)}),this.addHook("afterScrollVertically",()=>ja(this,RM,$ne).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ja(e,EM,kne).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,CM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){$e(this.hot.rootElement,CM),this.unregisterEvents(),pe(this,Fn).destroy(),pe(this,Uo).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=pe(this,Jh),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(tr(this,Jh,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return tr(this,Jh,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Yt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[zp];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return Ce(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(pe(this,yr))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,pe(this,yr)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=pe(this,Fn).getOffset().start,u=pe(this,Fn).getSize().width;let c=0,d=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,v=dt(this.hot.rootElement),y=w.innerWidth-pe(this,ol)-v;d=w.innerWidth-pe(this,kn).eventPageX-y-(r.scrollX===void 0?i:0)}else d=pe(this,kn).eventPageX-(pe(this,ol)-(r.scrollX===void 0?i:0));if(pe(this,Sf)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(pe(this,yr))&&(o+=i),o+=c,pe(this,yr)<0)pe(this,Uu)>0?pe(this,kn).col=0:pe(this,kn).col=e>0?e-1:e;else if(pe(this,kn).TD.offsetWidth/2+o<=d){const w=pe(this,yr)>=pe(this,Dd)?pe(this,Dd)-1:pe(this,yr);pe(this,kn).col=w+1,o+=pe(this,kn).TD.offsetWidth}else pe(this,kn).col=pe(this,yr);let f=d,p=o;d+u+l>=s?f=s-u-l:d+l<a+c&&(f=a+c+Math.abs(l)),o>=s-1?p=s-1:p===0?p=1:r.scrollX!==void 0&&pe(this,yr)<pe(this,Uu)&&(p-=pe(this,ol)<=r.scrollX?pe(this,ol):0),pe(this,Fn).setPosition(null,f),pe(this,Uo).setPosition(null,p)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ja(this,SM,Dne).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ja(this,bM,Lne).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){pe(this,Fn).build(),pe(this,Uo).build()}destroy(){pe(this,Fn).destroy(),pe(this,Uo).destroy(),super.destroy()}}function Hne(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=De(t.target,"sortAction");if(!s||!o||pe(this,Xo)||t.button!==0||a){tr(this,Xo,!1),pe(this,co).length=0,$e(this.hot.rootElement,[xC,vf]);return}const l=pe(this,Uo).isBuilt()&&!pe(this,Uo).isAppended(),u=pe(this,Fn).isBuilt()&&!pe(this,Fn).isAppended();l&&u&&(pe(this,Uo).appendTo(i.hider),pe(this,Fn).appendTo(i.hider));const{from:c,to:d}=s,f=Math.min(c.col,d.col),p=Math.max(c.col,d.col);if(e.row<0&&e.col>=f&&e.col<=p){r.column=!0,tr(this,Xo,!0);const w=n.firstChild?zI(t,n.firstChild).x:t.offsetX;pe(this,kn).eventPageX=t.pageX,tr(this,yr,e.col),pe(this,kn).TD=n,pe(this,kn).col=e.col,tr(this,co,this.prepareColumnsToMoving(f,p)),tr(this,Sf,!!this.hot.getSettings().rowHeaders),tr(this,Dd,this.hot.countCols()),tr(this,Uu,this.hot.getSettings().fixedColumnsStart),tr(this,ol,jt(this.hot.rootElement).left);const v=pe(this,Sf)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,b=e.col<pe(this,Uu),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),I=Math.abs(w-(this.hot.isRtl()?n.offsetWidth:0)),L=this.getColumnsWidth(f,e.col-1)+I,x=this.getColumnsWidth(v,f-1)+(b?_:0)+L;pe(this,Fn).setPosition(y,x),pe(this,Fn).setSize(this.getColumnsWidth(f,p),i.hider.offsetHeight-y),pe(this,Fn).setOffset(null,-L),J(this.hot.rootElement,xC)}else $e(this.hot.rootElement,HC),tr(this,Xo,!1),pe(this,co).length=0}function Dne(t){pe(this,Xo)&&(pe(this,kn).eventPageX=t.pageX,this.refreshPositions())}function Nne(t,e,n,r){!this.hot.getSelectedRangeLast()||!pe(this,Xo)||(pe(this,co).indexOf(e.col)>-1?$e(this.hot.rootElement,vf):J(this.hot.rootElement,vf),r.row=!0,r.column=!0,r.cell=!0,tr(this,yr,e.col),pe(this,kn).TD=n)}function Lne(){const t=pe(this,kn).col,e=pe(this,co).length;if(tr(this,yr,void 0),tr(this,Xo,!1),$e(this.hot.rootElement,[xC,vf,HC]),this.hot.selection.isSelectedByColumnHeader()&&J(this.hot.rootElement,HC),e<1||t===void 0)return;const n=pe(this,co)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(pe(this,co),t);if(pe(this,co).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function $ne(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;pe(this,Fn).setPosition(r),pe(this,Fn).setSize(null,t.hider.offsetHeight-r)}function kne(){this.moveBySettingsOrLoad()}function Ki(t,e){pD(t,e),e.add(t)}function vn(t,e,n){pD(t,e),e.set(t,n)}function pD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ut(t,e,n){var r=wD(t,e,"set");return Fne(t,r,n),n}function Fne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function le(t,e){var n=wD(t,e,"get");return Wne(t,n)}function wD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Wne(t,e){return e.get?e.get.call(t):e.value}const yf="manualColumnResize",Vne=130,TM="manualColumnWidths";var to=new WeakMap,ed=new WeakMap,ar=new WeakMap,bf=new WeakMap,Ei=new WeakMap,Bne=new WeakMap,wl=new WeakMap,td=new WeakMap,Zn=new WeakMap,Zi=new WeakMap,na=new WeakMap,Rf=new WeakMap,Yu=new WeakMap,Gu=new WeakMap,ur=new WeakMap,zu=new WeakMap,_M=new WeakSet,MM=new WeakSet,AM=new WeakSet,OM=new WeakSet,IM=new WeakSet,PM=new WeakSet,xM=new WeakSet,HM=new WeakSet,DM=new WeakSet;class Une extends ot{static get PLUGIN_KEY(){return yf}static get PLUGIN_PRIORITY(){return Vne}constructor(e){super(e),Ki(this,DM),Ki(this,HM),Ki(this,xM),Ki(this,PM),Ki(this,IM),Ki(this,OM),Ki(this,AM),Ki(this,MM),Ki(this,_M),vn(this,to,{writable:!0,value:null}),vn(this,ed,{writable:!0,value:null}),vn(this,ar,{writable:!0,value:[]}),vn(this,bf,{writable:!0,value:null}),vn(this,Ei,{writable:!0,value:null}),vn(this,Bne,{writable:!0,value:null}),vn(this,wl,{writable:!0,value:null}),vn(this,td,{writable:!0,value:null}),vn(this,Zn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),vn(this,Zi,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),vn(this,na,{writable:!0,value:null}),vn(this,Rf,{writable:!0,value:!1}),vn(this,Yu,{writable:!0,value:0}),vn(this,Gu,{writable:!0,value:null}),vn(this,ur,{writable:!0,value:void 0}),vn(this,zu,{writable:!0,value:void 0}),J(le(this,Zn),"manualColumnResizer"),J(le(this,Zi),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[yf]}enablePlugin(){this.enabled||(Ut(this,ur,new cs),le(this,ur).addLocalHook("init",()=>Xi(this,_M,Yne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,le(this,ur)),this.addHook("modifyColWidth",(e,n)=>Xi(this,xM,qne).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Xi(this,HM,Zne).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Xi(this,DM,Qne).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ut(this,zu,le(this,ur).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",TM,le(this,ur).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",TM,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return le(this,ur).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);le(this,ur).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Ut(this,to,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(le(this,to)),i=r.col;if(i<0)return;const o=Pt(le(this,to)),s=le(this,to).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(le(this,to),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(le(this,to),r.row,r.col)),Ut(this,ed,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Ut(this,ar,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();T(c,d=>{const f=d.getTopStartCorner().col,p=d.getBottomEndCorner().col;Ce(f,p,w=>{le(this,ar).includes(w)||le(this,ar).push(w)})})}le(this,ar).includes(le(this,ed))||Ut(this,ar,[le(this,ed)]),Ut(this,td,l.start-6),Ut(this,wl,parseInt(s.width,10)),le(this,Zn).style.top=`${l.top}px`,le(this,Zn).style[this.inlineDir]=`${le(this,td)+le(this,wl)}px`,le(this,Zn).style.height=`${o}px`,this.hot.rootElement.appendChild(le(this,Zn))}refreshHandlePosition(){le(this,Zn).style[this.inlineDir]=`${le(this,td)+le(this,bf)}px`}setupGuidePosition(){const e=parseInt(Pt(le(this,Zn)),10),n=parseInt(le(this,Zn).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);J(le(this,Zn),"active"),J(le(this,Zi),"active"),le(this,Zi).style.top=`${n}px`,this.refreshGuidePosition(),le(this,Zi).style.height=`${r-e}px`,this.hot.rootElement.appendChild(le(this,Zi))}refreshGuidePosition(){le(this,Zi).style[this.inlineDir]=le(this,Zn).style[this.inlineDir]}hideHandleAndGuide(){$e(le(this,Zn),"active"),$e(le(this,Zi),"active")}checkIfColumnHeader(e){return!!rs(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",le(this,Ei),r,!0);o!==void 0&&Ut(this,Ei,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,le(this,Ei)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",le(this,Ei),r,!0),i&&e()};le(this,Yu)>=2&&(le(this,ar).length>1?(T(le(this,ar),i=>{n(i)}),e()):T(le(this,ar),i=>{n(i,!0)})),Ut(this,Yu,0),Ut(this,Gu,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Xi(this,MM,Gne).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Xi(this,AM,zne).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Xi(this,OM,jne).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Xi(this,IM,Kne).call(this)),this.eventManager.addEventListener(le(this,Zn),"contextmenu",()=>Xi(this,PM,Xne).call(this))}destroy(){super.destroy()}}function Yne(){const t=this.hot.getSettings()[yf],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{le(this,ur).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{le(this,ur).setValueAtIndex(r,n)})},!0),Ut(this,zu,t)):t===!0&&Array.isArray(le(this,zu))&&this.hot.batchExecution(()=>{le(this,zu).forEach((n,r)=>{le(this,ur).setValueAtIndex(r,n)})},!0)}function Gne(t){if(!Pv(t.target)&&le(this,Rf)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(le(this,na)||this.setupHandlePosition(e))}}function zne(t){De(t.target,"manualColumnResizer")&&(this.setupHandlePosition(le(this,to)),this.setupGuidePosition(),Ut(this,na,!0),le(this,Gu)===null&&(Ut(this,Gu,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(le(this,Gu))),Ut(this,Yu,le(this,Yu)+1),this.startX=t.pageX,Ut(this,Ei,le(this,wl)))}function jne(t){if(le(this,na)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Ut(this,bf,le(this,wl)+e),T(le(this,ar),n=>{Ut(this,Ei,this.setManualSize(n,le(this,bf)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Kne(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",le(this,Ei),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",le(this,Ei),n,!1)};le(this,na)&&(this.hideHandleAndGuide(),Ut(this,na,!1),le(this,Ei)!==le(this,wl)&&(le(this,ar).length>1?(T(le(this,ar),r=>{e(r)}),t()):T(le(this,ar),r=>{e(r,!0)})),this.setupHandlePosition(le(this,to)))}function Xne(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(le(this,Zn)),this.hot.rootElement.removeChild(le(this,Zi)),Ut(this,na,!1),Ut(this,Rf,!0),this.hot._registerImmediate(()=>{Ut(this,Rf,!1)})}function qne(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=le(this,ur).getValueAtIndex(r);this.hot.getSettings()[yf]&&i&&(n=i)}return n}function Zne(t,e){let n=le(this,ur).getValueAtIndex(e);return n===null&&(n=t),n}function Qne(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function jp(t,e,n){return e=Jne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jne(t){var e=ere(t,"string");return typeof e=="symbol"?e:String(e)}function ere(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Kp=0,NM=1,LM=2,Ka="px";let tre=class{constructor(e){jp(this,"hot",void 0),jp(this,"_element",null),jp(this,"state",Kp),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=LM}build(){this.state===Kp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=NM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Kp}isAppended(){return this.state===LM}isBuilt(){return this.state>=NM}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Ka),n!==void 0&&(this._element.style.left=n+Ka)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Ka),n&&(this._element.style.height=n+Ka)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Ka),n&&(this._element.style.marginLeft=n+Ka)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const CD=tre,nre="ht__manualRowMove--backlight";class rre extends CD{build(){super.build(),J(this._element,nre)}}const ire=rre,ore="ht__manualRowMove--guideline";class sre extends CD{build(){super.build(),J(this._element,ore)}}const are=sre;function Xa(t,e){vD(t,e),e.add(t)}function qa(t,e,n){vD(t,e),e.set(t,n)}function vD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xs(t,e,n){var r=SD(t,e,"set");return lre(t,r,n),n}function lre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fe(t,e){var n=SD(t,e,"get");return ure(t,n)}function SD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ure(t,e){return e.get?e.get.call(t):e.value}function Za(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("beforeRowMove");ge.getSingleton().register("afterRowMove");const Xp="manualRowMove",cre=140,$M="ht__manualRowMove",Ef="show-ui",DC="on-moving--rows",NC="after-selection--rows";var Wn=new WeakMap,Yo=new WeakMap,ho=new WeakMap,qo=new WeakMap,nr=new WeakMap,nd=new WeakMap,kM=new WeakSet,FM=new WeakSet,WM=new WeakSet,VM=new WeakSet,BM=new WeakSet,UM=new WeakSet;class hre extends ot{constructor(){super(...arguments),Xa(this,UM),Xa(this,BM),Xa(this,VM),Xa(this,WM),Xa(this,FM),Xa(this,kM),qa(this,Wn,{writable:!0,value:new ire(this.hot)}),qa(this,Yo,{writable:!0,value:new are(this.hot)}),qa(this,ho,{writable:!0,value:[]}),qa(this,qo,{writable:!0,value:void 0}),qa(this,nr,{writable:!0,value:{}}),qa(this,nd,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Xp}static get PLUGIN_PRIORITY(){return cre}isEnabled(){return!!this.hot.getSettings()[Xp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Za(e,kM,dre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Za(e,WM,gre).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Za(this,BM,pre).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Za(e,UM,wre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,$M),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){$e(this.hot.rootElement,$M),this.unregisterEvents(),Fe(this,Wn).destroy(),Fe(this,Yo).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Fe(this,nd),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Xs(this,nd,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Xs(this,nd,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Yt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Xp];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return Ce(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Fe(this,nr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Fe(this,nr).TD,a=this.hot.rootElement,l=jt(a),u=Qs(a),c=o.holder.scrollTop,d=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-d,p=Fe(this,nr).eventPageY-f+c,w=o.hider.offsetHeight,v=o.TBODY.offsetTop,y=Fe(this,Wn).getOffset().top,b=Fe(this,Wn).getSize().height,_=s.offsetHeight/2,I=s.offsetHeight;let L=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const x=p>=L+_;this.isFixedRowTop(e.row)&&(L+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Fe(this,nr).row=n>0?n-1:n:x?(Fe(this,nr).row=e.row+1,L+=e.row===0?I-1:I):Fe(this,nr).row=e.row;let W=p,G=L;p+b+y>=w?W=w-b-y:p+y<v&&(W=v+Math.abs(y)),L>=w-1&&(G=w-1),Fe(this,Wn).setPosition(W),Fe(this,Yo).setPosition(G)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Za(this,FM,fre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Za(this,VM,mre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Fe(this,Wn).build(),Fe(this,Yo).build()}destroy(){Fe(this,Wn).destroy(),Fe(this,Yo).destroy(),super.destroy()}}function dre(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Fe(this,qo)||t.button!==0){Xs(this,qo,!1),Fe(this,ho).length=0,$e(this.hot.rootElement,[DC,Ef]);return}const l=Fe(this,Yo).isBuilt()&&!Fe(this,Yo).isAppended(),u=Fe(this,Wn).isBuilt()&&!Fe(this,Wn).isAppended();l&&u&&(Fe(this,Yo).appendTo(i.hider),Fe(this,Wn).appendTo(i.hider));const{from:c,to:d}=a,f=Math.min(c.row,d.row),p=Math.max(c.row,d.row);if(e.col<0&&e.row>=f&&e.row<=p){r.row=!0,Xs(this,qo,!0),Fe(this,nr).eventPageY=t.pageY,Fe(this,nr).coords=e,Fe(this,nr).TD=n,Xs(this,ho,this.prepareRowsToMoving());const w=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(f,e.row-1)+t.offsetY;Fe(this,Wn).setPosition(null,w),Fe(this,Wn).setSize(i.hider.offsetWidth-w,this.getRowsHeight(f,p)),Fe(this,Wn).setOffset(-v,null),J(this.hot.rootElement,DC),this.refreshPositions()}else $e(this.hot.rootElement,NC),Xs(this,qo,!1),Fe(this,ho).length=0}function fre(t){Fe(this,qo)&&(Fe(this,nr).eventPageY=t.pageY,this.refreshPositions())}function gre(t,e,n,r){!this.hot.getSelectedRangeLast()||!Fe(this,qo)||(Fe(this,ho).indexOf(e.row)>-1?$e(this.hot.rootElement,Ef):J(this.hot.rootElement,Ef),r.row=!0,r.column=!0,r.cell=!0,Fe(this,nr).coords=e,Fe(this,nr).TD=n)}function mre(){const t=Fe(this,nr).row,e=Fe(this,ho).length;if(Xs(this,qo,!1),$e(this.hot.rootElement,[DC,Ef,NC]),this.hot.selection.isSelectedByRowHeader()&&J(this.hot.rootElement,NC),e<1||t===void 0)return;const n=Fe(this,ho)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Fe(this,ho),t);if(Fe(this,ho).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function pre(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;Fe(this,Wn).setPosition(null,r),Fe(this,Wn).setSize(t.hider.offsetWidth-r)}function wre(){this.moveBySettingsOrLoad()}function $s(t,e){yD(t,e),e.add(t)}function Sn(t,e,n){yD(t,e),e.set(t,n)}function yD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ks(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Lt(t,e,n){var r=bD(t,e,"set");return Cre(t,r,n),n}function Cre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ae(t,e){var n=bD(t,e,"get");return vre(t,n)}function bD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vre(t,e){return e.get?e.get.call(t):e.value}const Tf="manualRowResize",Sre=30,YM="manualRowHeights";var vi=new WeakMap,rd=new WeakMap,lr=new WeakMap,_f=new WeakMap,Go=new WeakMap,vb=new WeakMap,Cl=new WeakMap,id=new WeakMap,Ln=new WeakMap,pi=new WeakMap,ra=new WeakMap,Mf=new WeakMap,ju=new WeakMap,Ku=new WeakMap,zr=new WeakMap,Xu=new WeakMap,GM=new WeakSet,zM=new WeakSet,jM=new WeakSet,KM=new WeakSet,XM=new WeakSet,qM=new WeakSet,ZM=new WeakSet;class yre extends ot{static get PLUGIN_KEY(){return Tf}static get PLUGIN_PRIORITY(){return Sre}constructor(e){super(e),$s(this,ZM),$s(this,qM),$s(this,XM),$s(this,KM),$s(this,jM),$s(this,zM),$s(this,GM),Sn(this,vi,{writable:!0,value:null}),Sn(this,rd,{writable:!0,value:null}),Sn(this,lr,{writable:!0,value:[]}),Sn(this,_f,{writable:!0,value:null}),Sn(this,Go,{writable:!0,value:null}),Sn(this,vb,{writable:!0,value:null}),Sn(this,Cl,{writable:!0,value:null}),Sn(this,id,{writable:!0,value:null}),Sn(this,Ln,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Sn(this,pi,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Sn(this,ra,{writable:!0,value:!1}),Sn(this,Mf,{writable:!0,value:!1}),Sn(this,ju,{writable:!0,value:0}),Sn(this,Ku,{writable:!0,value:null}),Sn(this,zr,{writable:!0,value:void 0}),Sn(this,Xu,{writable:!0,value:void 0}),J(ae(this,Ln),"manualRowResizer"),J(ae(this,pi),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Tf]}enablePlugin(){this.enabled||(Lt(this,zr,new cs),ae(this,zr).addLocalHook("init",()=>ks(this,ZM,Are).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,ae(this,zr)),this.addHook("modifyRowHeight",(e,n)=>ks(this,qM,Mre).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Lt(this,Xu,ae(this,zr).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",YM,ae(this,zr).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",YM,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,dP.DEFAULT_HEIGHT);return ae(this,zr).setValueAtIndex(r,i),i}setupHandlePosition(e){Lt(this,vi,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(ae(this,vi)),o=i.row;if(o<0)return;const s=dt(ae(this,vi)),a=ae(this,vi).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(this,vi),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(ae(this,vi),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(ae(this,vi),i.row,i.col)),Lt(this,rd,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),Lt(this,lr,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const f=this.hot.getSelectedRange();T(f,p=>{const w=p.getTopStartCorner().row,v=p.getBottomStartCorner().row;Ce(w,v,y=>{ae(this,lr).includes(y)||ae(this,lr).push(y)})})}ae(this,lr).includes(ae(this,rd))||Lt(this,lr,[ae(this,rd)]),Lt(this,id,c.top-6),Lt(this,Cl,parseInt(a.height,10)),ae(this,Ln).style.top=`${ae(this,id)+ae(this,Cl)}px`,ae(this,Ln).style[this.inlineDir]=`${c.start}px`,ae(this,Ln).style.width=`${s}px`,this.hot.rootElement.appendChild(ae(this,Ln))}refreshHandlePosition(){ae(this,Ln).style.top=`${ae(this,id)+ae(this,_f)}px`}setupGuidePosition(){const e=parseInt(dt(ae(this,Ln)),10),n=parseInt(ae(this,Ln).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);J(ae(this,Ln),"active"),J(ae(this,pi),"active"),ae(this,pi).style.top=ae(this,Ln).style.top,ae(this,pi).style[this.inlineDir]=`${n}px`,ae(this,pi).style.width=`${r-e}px`,this.hot.rootElement.appendChild(ae(this,pi))}refreshGuidePosition(){ae(this,pi).style.top=ae(this,Ln).style.top}hideHandleAndGuide(){$e(ae(this,Ln),"active"),$e(ae(this,pi),"active")}checkIfRowHeader(e){var n;return rs(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&ae(this,Go)<n?n:ae(this,Go)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&Lt(this,Go,o),this.setManualSize(r,ae(this,Go)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};ae(this,ju)>=2&&(ae(this,lr).length>1?(T(ae(this,lr),i=>{n(i)}),e()):T(ae(this,lr),i=>{n(i,!0)})),Lt(this,ju,0),Lt(this,Ku,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>ks(this,GM,bre).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>ks(this,zM,Rre).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>ks(this,jM,Ere).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>ks(this,KM,Tre).call(this)),this.eventManager.addEventListener(ae(this,Ln),"contextmenu",()=>ks(this,XM,_re).call(this))}destroy(){super.destroy()}}function bre(t){if(!Pv(t.target)&&ae(this,Mf)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(ae(this,ra)||this.setupHandlePosition(e))}}function Rre(t){De(t.target,"manualRowResizer")&&(this.setupHandlePosition(ae(this,vi)),this.setupGuidePosition(),Lt(this,ra,!0),ae(this,Ku)===null&&(Lt(this,Ku,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(this,Ku))),Lt(this,ju,ae(this,ju)+1),Lt(this,vb,t.pageY),Lt(this,Go,ae(this,Cl)))}function Ere(t){ae(this,ra)&&(Lt(this,_f,ae(this,Cl)+(t.pageY-ae(this,vb))),T(ae(this,lr),e=>{Lt(this,Go,this.setManualSize(e,ae(this,_f)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Tre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};ae(this,ra)&&(this.hideHandleAndGuide(),Lt(this,ra,!1),ae(this,Go)!==ae(this,Cl)&&(ae(this,lr).length>1?(T(ae(this,lr),r=>{e(r)}),t()):T(ae(this,lr),r=>{e(r,!0)})),this.setupHandlePosition(ae(this,vi)))}function _re(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(this,Ln)),this.hot.rootElement.removeChild(ae(this,pi)),Lt(this,ra,!1),Lt(this,Mf,!0),this.hot._registerImmediate(()=>{Lt(this,Mf,!1)})}function Mre(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=ae(this,zr).getValueAtIndex(r);this.hot.getSettings()[Tf]&&i&&(n=i)}return n}function Are(){const t=this.hot.getSettings()[Tf],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{ae(this,zr).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{ae(this,zr).setValueAtIndex(r,n)}),Lt(this,Xu,t)):t===!0&&Array.isArray(ae(this,Xu))&&ae(this,Xu).forEach((n,r)=>{ae(this,zr).setValueAtIndex(r,n)})},!0)}function Fs(t,e,n){return e=Ore(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ore(t){var e=Ire(t,"string");return typeof e=="symbol"?e:String(e)}function Ire(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pre{constructor(e,n,r,i,o,s){Fs(this,"row",void 0),Fs(this,"col",void 0),Fs(this,"rowspan",void 0),Fs(this,"colspan",void 0),Fs(this,"removed",!1),Fs(this,"cellCoordsFactory",void 0),Fs(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ft`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ft`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const d=l-u+1,f=Math.abs(r)-d;this[s]-=f+r,this[o]-=d}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const d=c-a+1;this[o]-=d}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Si=Pre;function LC(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function qp(t,e,n){return e=xre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xre(t){var e=Hre(t,"string");return typeof e=="symbol"?e:String(e)}function Hre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sb{constructor(e){qp(this,"plugin",void 0),qp(this,"mergedCells",[]),qp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ft`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return T(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return T(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return T(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Si(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(vt(Sb.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];T(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,T(n,(i,o)=>{Ce(0,i.rowspan-1,s=>{Ce(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),T(n,i=>{LC(...i)}),T(r,i=>{LC(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return T(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}T(this.mergedCells,o=>{o.shift(i,n)}),tf(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Dre=Sb;function Zp(t,e,n){return e=Nre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nre(t){var e=Lre(t,"string");return typeof e=="symbol"?e:String(e)}function Lre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $re{constructor(e){Zp(this,"plugin",void 0),Zp(this,"mergedCellsCollection",void 0),Zp(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,f=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,p=Math.floor(s/f)*f,w=s-p,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const y=v.row+v.rowspan-a-w;o[2]+y>=this.plugin.hot.countRows()?o[2]-=w:o[2]+=w?y:0}else if(r==="right"){const y=v.col+v.colspan-l-w;o[3]+y>=this.plugin.hot.countCols()?o[3]-=w:o[3]+=w?y:0}else if(r==="up"){const y=u-w-v.row+1;o[0]+y<0?o[0]+=w:o[0]-=w?y:0}else if(r==="left"){const y=c-w-v.col+1;o[1]+y<0?o[1]+=w:o[1]-=w?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Kt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return d-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,d];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,d=u?o:s,f=this.getAutofillSize(e,n,r),p=u?a-o+1:l-s+1,w=Math.floor(f/p)*p,v=f-w;let y=null,b=null,_=null;switch(r){case"up":y="includesVertically",_=c-v+1;break;case"left":y="includesHorizontally",_=c-v+1;break;case"down":y="includesVertically",_=d+v-1;break;case"right":y="includesHorizontally",_=d+v-1;break}return T(i,I=>{I[y](_)&&I.isFarther(b,r)&&(b=I)}),b}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return T(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}const kre=$re;function Qp(t,e,n){return e=Fre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fre(t){var e=Wre(t,"string");return typeof e=="symbol"?e:String(e)}function Wre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vre{constructor(e){Qp(this,"plugin",void 0),Qp(this,"hot",void 0),Qp(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const d=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=d&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const Bre=Vre;function Ure(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(WS)}return this.getTranslatedPhrase(FS)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Si.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Bt(t,e){RD(t,e),e.add(t)}function Yre(t,e,n){RD(t,e),e.set(t,n)}function RD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jp(t,e,n){return e=Gre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gre(t){var e=zre(t,"string");return typeof e=="symbol"?e:String(e)}function zre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ew(t,e,n){var r=ED(t,e,"set");return jre(t,r,n),n}function jre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Qa(t,e){var n=ED(t,e,"get");return Kre(t,n)}function ED(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Kre(t,e){return e.get?e.get.call(t):e.value}function Ht(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ge.getSingleton().register("beforeMergeCells");ge.getSingleton().register("afterMergeCells");ge.getSingleton().register("beforeUnmergeCells");ge.getSingleton().register("afterUnmergeCells");const qu="mergeCells",Xre=150,QM=qu;var wi=new WeakMap,JM=new WeakSet,e1=new WeakSet,t1=new WeakSet,n1=new WeakSet,r1=new WeakSet,i1=new WeakSet,o1=new WeakSet,tw=new WeakSet,s1=new WeakSet,a1=new WeakSet,l1=new WeakSet,u1=new WeakSet,c1=new WeakSet,h1=new WeakSet,d1=new WeakSet,f1=new WeakSet,g1=new WeakSet,m1=new WeakSet,p1=new WeakSet,w1=new WeakSet,C1=new WeakSet,v1=new WeakSet;class qre extends ot{constructor(){super(...arguments),Bt(this,v1),Bt(this,C1),Bt(this,w1),Bt(this,p1),Bt(this,m1),Bt(this,g1),Bt(this,f1),Bt(this,d1),Bt(this,h1),Bt(this,c1),Bt(this,u1),Bt(this,l1),Bt(this,a1),Bt(this,s1),Bt(this,tw),Bt(this,o1),Bt(this,i1),Bt(this,r1),Bt(this,n1),Bt(this,t1),Bt(this,e1),Bt(this,JM),Jp(this,"mergedCellsCollection",null),Jp(this,"autofillCalculations",null),Jp(this,"selectionCalculations",null),Yre(this,wi,{writable:!0,value:null})}static get PLUGIN_KEY(){return qu}static get PLUGIN_PRIORITY(){return Xre}isEnabled(){return!!this.hot.getSettings()[qu]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Dre(this),this.autofillCalculations=new kre(this),this.selectionCalculations=new Bre(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,JM,Zre).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,t1,Jre).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,w1,mie).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,n1,eie).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,r1,tie).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,tw,S1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,tw,S1).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,s1,iie).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,e1,Qre).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,o1,rie).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,i1,nie).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,a1,oie).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,l1,sie).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,u1,aie).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,c1,lie).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,h1,uie).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,d1,cie).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,f1,hie).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,g1,die).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,m1,fie).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,p1,gie).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,C1,pie).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ht(e,v1,wie).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[qu];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!Nv())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=vl(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=vl(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(Si.containsNegativeValues(e)?(vt(Si.NEGATIVE_VALUES_WARNING(e)),n=!1):Si.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(vt(Si.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):Si.isSingleCell(e)?(vt(Si.IS_SINGLE_CELL(e)),n=!1):Si.containsZeroSpan(e)&&(vt(Si.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(T(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),Ce(r.row,r.row+r.rowspan-1,a=>{Ce(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),Ce(0,s.rowspan-1,c=>{Ce(0,s.colspan-1,d=>{let f=null;a[c]||(a[c]=[]),c===0&&d===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+d,"hidden",!0),a[c][d]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),T(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),Ce(0,i.rowspan-1,o=>{Ce(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:QM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(QM)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Be(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Be(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Be(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Be(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Zre(){this.generateFromSettings(this.hot.getSettings()[qu]),this.hot.render()}function Qre(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function Jre(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(Qa(this,wi)||ew(this,wi,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(Qa(this,wi))||ew(this,wi,this.hot._createCellCoords(null,null)),n.row=Qa(this,wi).row?Qa(this,wi).row-i.row:n.row,n.col=Qa(this,wi).col?Qa(this,wi).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);ew(this,wi,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function eie(t){const e=this.hot.getSelectedRangeLast(),n=Bn(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Bn(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Bn(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),T(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function tie(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function nie(t){t.items.push({name:"---------"},Ure(this))}function rie(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Be(r)?Bn(r):void 0;if(Be(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[d,f]=this.translateMergedCellToRenderable(a,c,l,u),p=o.getRenderableFromVisualIndex(e),w=s.getRenderableFromVisualIndex(n),v=d-p+1,y=f-w+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,v),i.colspan=Math.min(i.colspan,y)}LC(t,i,e,n)}function S1(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function iie(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function oie(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function sie(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function aie(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function lie(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function uie(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function cie(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function hie(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function die(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function fie(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function gie(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);T(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function mie(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,d=r.col===0;(i&&l||o&&u||a&&c||s&&d)&&(t.row=r.row,t.col=r.col)}function pie(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function wie(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Cie(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],d=o[a],f=u.multiColumnSorting,w=(f.compareFunctionFactory?f.compareFunctionFactory:Zx(u.type))(l,u,f)(c,d);if(w===Mi){const v=a+1;if(typeof e[v]<"u")return s(v)}return w}(0)}}function y1(){vt(ft`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const TD="sort";function vie(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${TD}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Sie(t){const e=t.className.split(" "),n=new RegExp(`^${TD}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function yie(t,e,n){return e=bie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bie(t){var e=Rie(t,"string");return typeof e=="symbol"?e:String(e)}function Rie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Af="multiColumnSorting",Eie=170,b1="columnSorting",R1=Af;qx(Af,Cie);class Tie extends Qx{constructor(){super(...arguments),yie(this,"pluginKey",Af)}static get PLUGIN_KEY(){return Af}static get PLUGIN_PRIORITY(){return Eie}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[b1]&&y1(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,ff))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:R1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(R1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),$e(e,Sie(e)),this.enabled!==!1&&J(e,vie(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[b1]&&y1(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){ab(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,ff))):this.sort(this.getColumnNextConfig(n.col)))}}function E1(t,e,n){return e=_ie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ie(t){var e=Mie(t,"string");return typeof e=="symbol"?e:String(e)}function Mie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Aie="multipleSelectionHandles",Oie=160;class Iie extends ot{constructor(){super(...arguments),E1(this,"dragged",[]),E1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Aie}static get PLUGIN_PRIORITY(){return Oie}isEnabled(){return so()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(De(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(De(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(De(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(De(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,d;if(e.dragged.length===0)return;const f=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),d=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function $C(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function _D(){return{label:"",isPlaceholder:!0}}function Pie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;T(t,i=>{const o=[];let s=0;n.push(o),T(i,a=>{const l=$C();if(Be(a)){const{label:c,colspan:d}=a;l.label=Ft(c),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=Ft(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(_D());return!u})});const r=Math.max(...Ue(n,i=>i.length));return T(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>$C());i.splice(i.length,0,...o)}}),n}function nw(t,e,n){xie(t,e),e.set(t,n)}function xie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vr(t,e){var n=MD(t,e,"get");return Hie(t,n)}function Hie(t,e){return e.get?e.get.call(t):e.value}function Su(t,e,n){var r=MD(t,e,"set");return Die(t,r,n),n}function MD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Die(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const T1=["label","collapsible"];var qi=new WeakMap,Ws=new WeakMap,rw=new WeakMap;class Nie{constructor(){nw(this,qi,{writable:!0,value:[]}),nw(this,Ws,{writable:!0,value:0}),nw(this,rw,{writable:!0,value:1/0})}setColumnsLimit(e){Su(this,rw,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Su(this,qi,Pie(e,Vr(this,rw))),Su(this,Ws,Vr(this,qi).length)}getData(){return Vr(this,qi)}mergeWith(e){T(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&Kt(s,o,T1)})}map(e){T(Vr(this,qi),n=>{T(n,r=>{const i=e({...r});Be(i)&&Kt(r,i,T1)})})}getHeaderSettings(e,n){var r;if(e>=Vr(this,Ws)||e<0)return null;const i=Vr(this,qi)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Vr(this,Ws)||e<0)return i;const o=Vr(this,qi)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Vr(this,Ws)}getColumnsCount(){return Vr(this,Ws)>0?Vr(this,qi)[0].length:0}clear(){Su(this,qi,[]),Su(this,Ws,0)}}function iw(t,e,n){return e=Lie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lie(t){var e=$ie(t,"string");return typeof e=="symbol"?e:String(e)}function $ie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const AD="DF-pre-order";function OD(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=OD.call(this.childs[r],t,e)}return n}const kie="DF-post-order";function ID(t,e){for(let n=0;n<this.childs.length;n++)if(ID.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const PD="BF";function Fie(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Wie=PD,_1=new Map([[AD,OD],[kie,ID],[PD,Fie]]);class Of{constructor(e){iw(this,"data",{}),iw(this,"parent",null),iw(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Of({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wie;if(!_1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);_1.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function ow(t,e,n){Vie(t,e),e.set(t,n)}function Vie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e){var n=xD(t,e,"get");return Bie(t,n)}function Bie(t,e){return e.get?e.get.call(t):e.value}function Uie(t,e,n){var r=xD(t,e,"set");return Yie(t,r,n),n}function xD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ja=new WeakMap,Vs=new WeakMap,el=new WeakMap;class Gie{constructor(e){ow(this,Ja,{writable:!0,value:new Map}),ow(this,Vs,{writable:!0,value:new Map}),ow(this,el,{writable:!0,value:null}),Uie(this,el,e)}getRoots(){return Array.from(Nn(this,Ja).values())}getRootByColumn(e){let n;return Nn(this,Vs).has(e)&&(n=Nn(this,Ja).get(Nn(this,Vs).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Nn(this,Vs).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Nn(this,Vs).clear(),T(Nn(this,Ja),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Nn(this,Vs).set(i,e);e+=r})}buildTree(){this.clear();const e=Nn(this,el).getColumnsCount();let n=0;for(;n<e;){const r=Nn(this,el).getHeaderSettings(0,n),i=new Of;Nn(this,Ja).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Nn(this,el).getHeadersSettings(r,n,i);r+=1,T(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Of(a),e.addChild(l)),r<Nn(this,el).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Nn(this,Ja).clear(),Nn(this,Vs).clear()}}function HD(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function If(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function Pf(t){return If(t,"origColspan")===t.data.origColspan}function yb(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Pf(t))return yb(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)T(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,HD(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):Pf(a)&&(l.isCollapsed=If(a,"isCollapsed"))}),{rollbackModification:()=>bb(t),affectedColumns:Array.from(o),colspanCompensation:s}}function bb(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(Pf(t))return bb(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)T(o,l=>{HD(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const d=u+c;s.add(d)}}const a=n.colspan-((e=If(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):Pf(l)&&(u.isCollapsed=If(l,"isCollapsed"))}),{rollbackModification:()=>yb(t),affectedColumns:Array.from(s),colspanCompensation:a}}function zie(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ft`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function jie(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ft`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const M1=new Map([["collapse",bb],["expand",yb],["hide-column",zie],["show-column",jie]]);function Kie(t,e,n){if(!M1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return M1.get(t)(e,n)}function od(t){const e=[];return T(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=qie(e,a);let c=!1;for(let d=s;d<s+o;d++)if(l.includes(d)||c)u.push(_D());else{const p=Xie(i);p.isRoot=!0,u.push(p),c=!0}})}),e}function Xie(t){const{crossHiddenColumns:e,...n}=$C(t);return n}function qie(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function sw(t,e,n){Zie(t,e),e.set(t,n)}function Zie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e,n){var r=DD(t,e,"set");return Qie(t,r,n),n}function Qie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Dt(t,e){var n=DD(t,e,"get");return Jie(t,n)}function DD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Jie(t,e){return e.get?e.get.call(t):e.value}var mi=new WeakMap,Kn=new WeakMap,Bs=new WeakMap;class eoe{constructor(){sw(this,mi,{writable:!0,value:new Nie}),sw(this,Kn,{writable:!0,value:new Gie(Dt(this,mi))}),sw(this,Bs,{writable:!0,value:[[]]})}setState(e){Dt(this,mi).setData(e);let n=!1;try{Dt(this,Kn).buildTree()}catch{Dt(this,Kn).clear(),Dt(this,mi).clear(),n=!0}return yu(this,Bs,od(Dt(this,Kn).getRoots())),n}setColumnsLimit(e){Dt(this,mi).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Dt(this,mi).mergeWith(n),Dt(this,Kn).buildTree(),yu(this,Bs,od(Dt(this,Kn).getRoots()))}mapState(e){Dt(this,mi).map(e),Dt(this,Kn).buildTree(),yu(this,Bs,od(Dt(this,Kn).getRoots()))}mapNodes(e){return Yt(Dt(this,Kn).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Dt(this,Kn).getNode(n,r);let o;return i&&(o=Kie(e,i,r),yu(this,Bs,od(Dt(this,Kn).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Dt(this,Bs)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Dt(this,Kn).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Dt(this,Kn).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:d,origColspan:f,isHidden:p}=u.data;p||f<=i&&c>=e&&c+f-1<=r&&(s===null||d<s)&&(s=d)},AD)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Dt(this,mi).getLayersCount()}getColumnsCount(){return Dt(this,mi).getColumnsCount()}clear(){yu(this,Bs,[]),Dt(this,mi).clear(),Dt(this,Kn).clear()}}function bu(t,e,n){return e=toe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function toe(t){var e=noe(t,"string");return typeof e=="symbol"?e:String(e)}function noe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class roe{constructor(e,n){bu(this,"hot",void 0),bu(this,"nestedHeaderSettingsGetter",void 0),bu(this,"layersCount",0),bu(this,"container",void 0),bu(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let d=r.getVisualFromRenderableIndex(c);d===null&&(d=c);const f=n.createElement("th"),p=this.nestedHeaderSettingsGetter(l,d);if(p&&(!p.isPlaceholder||p.isHidden)){let w=p.label;s&&(w+='<button class="changeType"></button>'),ca(f,w),f.colSpan=p.colspan,u.appendChild(f)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const ioe=roe;function cn(t,e){ND(t,e),e.add(t)}function A1(t,e,n){return e=ooe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ooe(t){var e=soe(t,"string");return typeof e=="symbol"?e:String(e)}function soe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sd(t,e,n){ND(t,e),e.set(t,n)}function ND(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qs(t,e,n){var r=LD(t,e,"set");return aoe(t,r,n),n}function aoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function nt(t,e){var n=LD(t,e,"get");return loe(t,n)}function LD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function loe(t,e){return e.get?e.get.call(t):e.value}function Qt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const O1="nestedHeaders",uoe=280;var ht=new WeakMap,$o=new WeakMap,Zu=new WeakMap,Hg=new WeakMap,ad=new WeakSet,I1=new WeakSet,P1=new WeakSet,x1=new WeakSet,H1=new WeakSet,D1=new WeakSet,N1=new WeakSet,L1=new WeakSet,$1=new WeakSet,k1=new WeakSet,F1=new WeakSet,W1=new WeakSet,V1=new WeakSet,B1=new WeakSet,U1=new WeakSet,Y1=new WeakSet,G1=new WeakSet,z1=new WeakSet;class coe extends ot{constructor(){super(...arguments),cn(this,z1),cn(this,G1),cn(this,Y1),cn(this,U1),cn(this,B1),cn(this,V1),cn(this,W1),cn(this,F1),cn(this,k1),cn(this,$1),cn(this,L1),cn(this,N1),cn(this,D1),cn(this,H1),cn(this,x1),cn(this,P1),cn(this,I1),cn(this,ad),sd(this,ht,{writable:!0,value:new eoe}),sd(this,$o,{writable:!0,value:null}),sd(this,Zu,{writable:!0,value:null}),sd(this,Hg,{writable:!0,value:!1}),A1(this,"ghostTable",new ioe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),A1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return O1}static get PLUGIN_PRIORITY(){return uoe}isEnabled(){return!!this.hot.getSettings()[O1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&vt(ft`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Qt(this,G1,_oe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,z1,Moe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,H1,goe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,D1,moe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,N1,poe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,L1,woe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,$1,Coe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,k1,voe).call(e,...i)}),this.addHook("afterSelection",()=>Qt(this,ad,aw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,I1,hoe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Qt(this,W1,yoe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,B1,Roe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,U1,Eoe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,P1,doe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,x1,foe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,F1,Soe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,V1,boe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Qt(e,Y1,Toe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Qt(this,ad,aw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Qt(this,ad,aw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();nt(this,ht).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=nt(this,ht).setState(e)),this.detectedOverlappedHeaders&&vt(ft`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";nt(this,ht).triggerColumnModification(i,r)}),!nt(this,$o)&&this.enabled&&qs(this,$o,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";nt(this,ht).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),nt(this,ht).clear(),nt(this,$o).unsubscribe(),qs(this,$o,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return nt(this,ht)}getLayersCount(){return nt(this,ht).getLayersCount()}getHeaderSettings(e,n){return nt(this,ht).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,d=a.childNodes.length;c<d;c++)a.childNodes[c].removeAttribute("colspan"),$e(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),$e(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),$e(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),$e(o,"hiddenHeader");const{colspan:c,isHidden:d,isPlaceholder:f}=(s=nt(this,ht).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||d)J(o,"hiddenHeader");else if(c>1){var p,w;const{wtOverlays:v}=l._wt,y=(p=v.topInlineStartCornerOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),b=(w=v.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o),_=y||b?Math.min(c,r-i):c;_>1&&o.setAttribute("colspan",_)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=nt(this,ht).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){qs(this,ht,null),nt(this,$o)!==null&&(nt(this,$o).unsubscribe(),qs(this,$o,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return nt(this,ht).getHeaderTreeNodeData(e.row,e.col)}}function aw(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=nt(this,ht).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function hoe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=nt(this,ht).findLeftMostColumnIndex(n.row,n.col),a=nt(this,ht).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function doe(t,e,n){const r=nt(this,ht).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=nt(this,ht).getHeaderSettings(e,t);if(o===iS){if(!a)return r.columnIndex}else if(o===AP&&(l>s-i||!a))return null;return t}function foe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,d=a-u+1;if(s>=0||d===1)break;for(let f=a;f<=u;f++)for(let p=s;p<=l;p++){var i;const w=c+p,v=f-a;if(v===0)continue;((i=nt(this,ht).getHeaderTreeNodeData(p,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[w][v]="")}}}function goe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function moe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;qs(this,Zu,e.clone()),qs(this,Hg,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(ag(t)||ss(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function poe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const d=[],f=rr(e.row,-1/0,-1);e.col<c.col?d.push(u.col,o,f):e.col>c.col?d.push(l.col,o+s-1,f):d.push(o,o+s-1,f),this.hot.selection.selectColumns(...d)}function woe(){qs(this,Hg,!1)}function Coe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!nt(this,Hg)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=nt(this,ht).getHeaderTreeNodeData(nt(this,Zu).row,nt(this,Zu).col);if(e.setHighlight(nt(this,Zu)),o>e.getWidth()||i<n||i+o-1>r){const s=nt(this,ht).findTopMostEntireHeaderLevel(rr(n,i,i+o-1),rr(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function voe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=nt(this,ht).findLeftMostColumnIndex(n.row,n.col),o=nt(this,ht).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Soe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function yoe(t){t.length=0;for(let e=0;e<nt(this,ht).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function boe(t){const e=nt(this,ht).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=nt(this,ht).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Vn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?nt(this,ht).getHeaderTreeNodeData(0,n).columnIndex:n}function Roe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Eoe(t,e,n){var r;const{label:i}=(r=nt(this,ht).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Toe(t,e){if(t<0)return this.hot.getCell(t,nt(this,ht).findLeftMostColumnIndex(t,e),!0)}function _oe(){this.updatePlugin()}function Moe(t,e){e||this.updatePlugin()}function Ru(t,e,n){return e=Aoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aoe(t){var e=Ooe(t,"string");return typeof e=="symbol"?e:String(e)}function Ooe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ioe{constructor(e,n){Ru(this,"hot",void 0),Ru(this,"data",null),Ru(this,"plugin",void 0),Ru(this,"parentReference",new WeakMap),Ru(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ce(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&T(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&T(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ye(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(T(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(Ce(e[0],e[2],f=>{const p=this.translateTrimmedRow(f);i.push(this.getDataObject(p))}),Ce(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let d=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const f=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,f,this.plugin.pluginName),u){d=c+this.countChildren(u);const p=this.getChild(u,this.countChildren(u)-1),w=this.getRowIndex(p);this.hot.runHooks("beforeCreateRow",w+1,s+1,this.plugin.pluginName),u.__children.push(r)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];T(r,o=>{i.push(this.getDataObject(o))}),T(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const d=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(d,0,l[0]),s.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const Poe=Ioe;function j1(t,e,n){return e=xoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xoe(t){var e=Hoe(t,"string");return typeof e=="symbol"?e:String(e)}function Hoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Doe{constructor(e,n){j1(this,"hot",void 0),j1(this,"plugin",void 0),this.hot=n,this.plugin=e}}const Rb=Doe;class no extends Rb{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(T(l,c=>{c&&s.removeChild(c)}),J(n,no.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,d=a.cloneNode(!0);s.innerHTML="",Ce(0,i-1,()=>{const f=c.createElement("SPAN");J(f,no.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(d)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&_e(c,[yo()]),J(n,no.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(J(c,`${no.CSS_CLASSES.button} ${no.CSS_CLASSES.expandButton}`),u&&_e(n,[_r(!1)])):(J(c,`${no.CSS_CLASSES.button} ${no.CSS_CLASSES.collapseButton}`),u&&_e(n,[_r(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const $D=no;class Noe extends Rb{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),T(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{Ce(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&T(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&T(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&T(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);De(e.target,$D.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Pr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Loe=Noe;function $oe(t,e,n){koe(t,e),e.set(t,n)}function koe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Foe(t,e,n){return e=Woe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Woe(t){var e=Voe(t,"string");return typeof e=="symbol"?e:String(e)}function Voe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Boe(t,e){var n=Uoe(t,e,"get");return Yoe(t,n)}function Uoe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yoe(t,e){return e.get?e.get.call(t):e.value}var K1=new WeakMap;class Goe extends Rb{constructor(){super(...arguments),Foe(this,"dataManager",this.plugin.dataManager),$oe(this,K1,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(oy)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(sy)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ce(0,e.items.length-1,r=>{if(r===0)return T(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Ce(0,e.items.length-1,n=>{const r=Boe(this,K1)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const zoe=Goe;function ld(t,e,n){return e=joe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function joe(t){var e=Koe(t,"string");return typeof e=="symbol"?e:String(e)}function Koe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xoe{constructor(e){ld(this,"plugin",void 0),ld(this,"hot",void 0),ld(this,"dataManager",void 0),ld(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(w=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const d=this.getBaseParent(u),f=this.getTargetParent(s,a),p=d===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,p),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Ct(i)&&(vt(ft`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function yn(t,e){kD(t,e),e.add(t)}function X1(t,e,n){kD(t,e),e.set(t,n)}function kD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lw(t,e,n){return e=qoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qoe(t){var e=Zoe(t,"string");return typeof e=="symbol"?e:String(e)}function Zoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nd(t,e){var n=FD(t,e,"get");return Qoe(t,n)}function Qoe(t,e){return e.get?e.get.call(t):e.value}function xf(t,e,n){var r=FD(t,e,"set");return Joe(t,r,n),n}function FD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Joe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function mn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Hf="nestedRows",ese=300,q1=Hf,tse="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Dg=new WeakMap,tl=new WeakMap,Z1=new WeakSet,Q1=new WeakSet,J1=new WeakSet,eA=new WeakSet,tA=new WeakSet,nA=new WeakSet,rA=new WeakSet,iA=new WeakSet,oA=new WeakSet,sA=new WeakSet,aA=new WeakSet,lA=new WeakSet,uA=new WeakSet,cA=new WeakSet,hA=new WeakSet,uw=new WeakSet;class nse extends ot{constructor(){super(...arguments),yn(this,uw),yn(this,hA),yn(this,cA),yn(this,uA),yn(this,lA),yn(this,aA),yn(this,sA),yn(this,oA),yn(this,iA),yn(this,rA),yn(this,nA),yn(this,tA),yn(this,eA),yn(this,J1),yn(this,Q1),yn(this,Z1),lw(this,"dataManager",null),lw(this,"headersUI",null),lw(this,"collapsedRowsMap",null),X1(this,Dg,{writable:!0,value:!1}),X1(this,tl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Hf}static get PLUGIN_PRIORITY(){return ese}isEnabled(){return!!this.hot.getSettings()[Hf]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new xc),this.dataManager=new Poe(this,this.hot),this.collapsingUI=new Loe(this,this.hot),this.headersUI=new $D(this,this.hot),this.contextMenuUI=new zoe(this,this.hot),this.rowMoveController=new Xoe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,cA,pse).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,hA,wse).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,J1,ose).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,eA,sse).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,tA,ase).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,Q1,ise).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,iA,cse).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,rA,use).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,oA,hse).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,sA,dse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,aA,fse).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,lA,gse).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,nA,lse).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,uA,mse).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return mn(e,Z1,rse).call(e,...r)}),this.addHook("beforeLoadData",n=>mn(this,uw,dA).call(this,n)),this.addHook("beforeUpdateData",n=>mn(this,uw,dA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:q1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(q1)}disableCoreAPIModifiers(){xf(this,tl,!0)}enableCoreAPIModifiers(){xf(this,tl,!1)}onModifyRowData(e){if(!Nd(this,tl))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Nd(this,tl))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return Nd(this,tl)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function rse(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function ise(t,e,n){this.collapsingUI.toggleState(t,e,n)}function ose(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),xf(this,Dg,!0),this.dataManager.getData().slice()}function sse(t){return this.contextMenuUI.appendOptions(t)}function ase(t,e){this.headersUI.appendLevelIndicators(t,e)}function lse(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function use(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{xf(this,Dg,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function cse(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function hse(){this.collapsingUI.collapsedRowsStash.stash()}function dse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function fse(){this.collapsingUI.collapsedRowsStash.stash()}function gse(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function mse(){this.dataManager.rewriteCache()}function pse(){this.headersUI.updateRowHeaderWidth()}function wse(t,e){Nd(this,Dg)&&(e.skipRender=!0)}function dA(t){if(!VP(t)){Wv(tse),this.hot.getSettings()[Hf]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function cw(t,e,n){return e=Cse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cse(t){var e=vse(t,"string");return typeof e=="symbol"?e:String(e)}function vse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sse{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;cw(this,"rootWindow",void 0),cw(this,"prefix",void 0),cw(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){T(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const yse=Sse;function bse(t,e,n){return e=Rse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rse(t){var e=Ese(t,"string");return typeof e=="symbol"?e:String(e)}function Ese(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ge.getSingleton().register("persistentStateSave");ge.getSingleton().register("persistentStateLoad");ge.getSingleton().register("persistentStateReset");const fA="persistentState",Tse=0;class _se extends ot{constructor(){super(...arguments),bse(this,"storage",void 0)}static get PLUGIN_KEY(){return fA}static get PLUGIN_PRIORITY(){return Tse}isEnabled(){return!!this.hot.getSettings()[fA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new yse(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Mse(t,e){Ase(t,e),e.add(t)}function Ase(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hw(t,e,n){return e=Ose(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ose(t){var e=Ise(t,"string");return typeof e=="symbol"?e:String(e)}function Ise(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gA(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const dw="search",Pse=190,xse="htSearchResult",Hse=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Dse=function(t,e,n){return Ct(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ct(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var fw=new WeakSet;class Nse extends ot{constructor(){super(...arguments),Mse(this,fw),hw(this,"callback",Hse),hw(this,"queryMethod",Dse),hw(this,"searchResultClass",xse)}static get PLUGIN_KEY(){return dw}static get PLUGIN_PRIORITY(){return Pse}isEnabled(){return this.hot.getSettings()[dw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[dw];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return gA(e,fw,mA).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return gA(e,fw,mA).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return Ce(0,i-1,l=>{Ce(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),d=this.hot.getCellMeta(l,u),f=d.search.callback||n,w=(d.search.queryMethod||r)(e,c,d);if(w){const v={row:l,col:u,data:c};s.push(v)}f&&f(a,l,u,c,w)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Be(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function mA(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function gw(t,e){Lse(t,e),e.add(t)}function Lse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ud(t,e,n){return e=$se(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $se(t){var e=kse(t,"string");return typeof e=="symbol"?e:String(e)}function kse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Fse="touchScroll",Wse=200;var pA=new WeakSet,wA=new WeakSet,CA=new WeakSet;class Vse extends ot{constructor(){super(...arguments),gw(this,CA),gw(this,wA),gw(this,pA),ud(this,"scrollbars",[]),ud(this,"clones",[]),ud(this,"lockedCollection",!1),ud(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Fse}static get PLUGIN_PRIORITY(){return Wse}static get SETTING_KEYS(){return!0}isEnabled(){return Zv()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>mw(this,pA,Bse).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>mw(this,wA,Use).call(this)),this.addHook("afterMomentumScroll",()=>mw(this,CA,Yse).call(this))}}function Bse(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Use(){this.freezeOverlays=!0,T(this.clones,t=>{J(t,"hide-tween")})}function Yse(){this.freezeOverlays=!1,T(this.clones,t=>{$e(t,"hide-tween"),J(t,"show-tween")}),this.hot._registerTimeout(()=>{T(this.clones,t=>{$e(t,"show-tween")})},400),T(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Gse(t,e){zse(t,e),e.add(t)}function zse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jse(t,e,n){return e=Kse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kse(t){var e=Xse(t,"string");return typeof e=="symbol"?e:String(e)}function Xse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qse(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ld="trimRows",Zse=330;var vA=new WeakSet;class Qse extends ot{constructor(){super(...arguments),Gse(this,vA),jse(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Ld}static get PLUGIN_PRIORITY(){return Zse}isEnabled(){return!!this.hot.getSettings()[Ld]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new xc),this.trimmedRowsMap.addLocalHook("init",()=>qse(this,vA,Jse).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Ld];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),T(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(T(e,l=>{o[l]=!1}),i=Yt(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Jse(){const t=this.hot.getSettings()[Ld];Array.isArray(t)&&this.hot.batchExecution(()=>{T(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const WD="undoRedo",eae="undoRedo";function he(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);T(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new he.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new he.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=Mn(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new he.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new he.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],d=[];Ce(a.length-1,w=>{const v=[],y=a[w];Ce(l,l+(r-1),b=>{v.push(y[t.toPhysicalColumn(b)])}),u.push(v)}),Ce(r-1,w=>{d.push(t.toPhysicalColumn(l+w))}),Array.isArray(t.getSettings().colHeaders)&&Ce(r-1,w=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+w)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),p=t.rowIndexMapper.getIndexesSequence();return new he.RemoveColumnAction(l,d,u,c,f,p,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new he.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new he.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new he.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new he.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new he.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}he.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};he.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Mn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};he.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Mn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};he.prototype.isUndoAvailable=function(){return this.doneActions.length>0};he.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};he.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};he.prototype.isEnabled=function(){return this.enabled};he.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,rae(t),this.registerShortcuts(),t.addHook("afterChange",VD)};he.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,iae(t),this.unregisterShortcuts(),t.removeHook("afterChange",VD)};he.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};he.Action=function(){};he.Action.prototype.undo=function(){};he.Action.prototype.redo=function(){};he.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};bo(he.ChangeAction,he.Action);he.ChangeAction.prototype.undo=function(t,e){const n=Mn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};he.ChangeAction.prototype.redo=function(t,e){const n=Mn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};he.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};bo(he.CreateRowAction,he.Action);he.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};he.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};he.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};bo(he.RemoveRowAction,he.Action);he.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};he.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};he.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};bo(he.CreateColumnAction,he.Action);he.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};he.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};he.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};bo(he.RemoveColumnAction,he.Action);he.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,d)=>d[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ue(this.data[u],i));const a=Ue(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),T(t.getSourceDataArray(),(u,c)=>{T(r,(d,f)=>{u[d]=s[c][f],l.push([c,d,u[d]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&T(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};he.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};he.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};he.CellAlignmentAction.prototype.undo=function(t,e){T(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};he.CellAlignmentAction.prototype.redo=function(t,e){Fo(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};he.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};bo(he.FiltersAction,he.Action);he.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};he.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class tae extends he.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}he.MergeCellsAction=tae;class nae extends he.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}he.UnmergeCellsAction=nae;he.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};bo(he.RowMoveAction,he.Action);he.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};he.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};he.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};he.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:WD};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};he.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(WD)};function VD(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function rae(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function iae(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Wc=ge.getSingleton();Wc.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Wc.register("beforeUndo");Wc.register("afterUndo");Wc.register("beforeRedo");Wc.register("afterRedo");he.PLUGIN_KEY=eae;he.SETTING_KEYS=!0;function oae(){rt(ku),rt(F8),rt(Fu),rt(p7),rt(T7),rt(Qx),rt(pX),rt(tq),rt(Og),rt(TZ),rt(XZ),rt(rQ),rt(Pg),rt(IQ),rt(kee),rt(vte),rt(zte),rt(ine),rt(wne),rt(xne),rt(Une),rt(hre),rt(yre),rt(qre),rt(Tie),rt(Iie),rt(coe),rt(nse),rt(_se),rt(Nse),rt(Vse),rt(Qse),rt(he)}function sae(){h5(),_5(),D5(),n8(),oae()}function aae(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var pw,ww,Cw,vw,Sw;sae();aae(Ie);Ie.__GhostTable=ob;Ie._getListenersCounter=TG;Ie._getRegisteredMapsCounter=V3;Ie.EventManager=gr;const lae=[JU,sG,M3,A5,nj,VY,rY,VG,rG,oY,uG,WG],uae=[$Y,cG];Ie.helper={};Ie.dom={};T(lae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ie.helper[e]=t[e])})});T(uae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ie.dom[e]=t[e])})});Ie.cellTypes=(pw=Ie.cellTypes)!==null&&pw!==void 0?pw:{};T(a6(),t=>{Ie.cellTypes[t]=Gy(t)});Ie.cellTypes.registerCellType=Sr;Ie.cellTypes.getCellType=Gy;Ie.editors=(ww=Ie.editors)!==null&&ww!==void 0?ww:{};T(CG(),t=>{Ie.editors[`${_n(t)}Editor`]=Jd(t)});Ie.editors.registerEditor=Jn;Ie.editors.getEditor=Jd;Ie.renderers=(Cw=Ie.renderers)!==null&&Cw!==void 0?Cw:{};T(nz(),t=>{const e=nf(t);t==="base"&&(Ie.renderers.cellDecorator=e),Ie.renderers[`${_n(t)}Renderer`]=e});Ie.renderers.registerRenderer=Ci;Ie.renderers.getRenderer=nf;Ie.validators=(vw=Ie.validators)!==null&&vw!==void 0?vw:{};T(oz(),t=>{Ie.validators[`${_n(t)}Validator`]=Gv(t)});Ie.validators.registerValidator=ul;Ie.validators.getValidator=Gv;Ie.plugins=(Sw=Ie.plugins)!==null&&Sw!==void 0?Sw:{};T(Yv(),t=>{Ie.plugins[t]=Oc(t)});Ie.plugins[`${_n(ot.PLUGIN_KEY)}Plugin`]=ot;Ie.plugins.registerPlugin=rt;Ie.plugins.getPlugin=Oc;const cae=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],SA="odd",yA=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),hae=(t,e,n,r,i,o)=>{if(n!==0)return;const s=t.parentElement;s!==null&&(e%2===0?Ie.dom.addClass(s,SA):Ie.dom.removeClass(s,SA))};function dae(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(yA.has(t.toString())?(Ie.dom.removeClass(e.firstChild,n),Ie.dom.addClass(e.firstChild,yA.get(t.toString()))):Ie.dom.addClass(e.firstChild,n))}const bA=document.getElementById("example1");bA?(new Ie(bA,{data:cae,height:450,colWidths:[170,222,130,120,120,130,156],colHeaders:["Company name","Name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:5,type:"text"},{data:2,type:"text"}],autoWrapRow:!0,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterGetColHeader:dae,beforeRenderer:hae,licenseKey:"non-commercial-and-evaluation"}),console.log(`Handsontable: v${Ie.version} (${Ie.buildDate})`)):console.error("Element with ID 'example1' not found.")});export default fae();
