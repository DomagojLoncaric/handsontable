var IN=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var rue=IN((vue,af)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var sh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function PN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Xl=function(t){return t&&t.Math===Math&&t},_n=Xl(typeof globalThis=="object"&&globalThis)||Xl(typeof window=="object"&&window)||Xl(typeof self=="object"&&self)||Xl(typeof sh=="object"&&sh)||Xl(typeof sh=="object"&&sh)||function(){return this}()||Function("return this")(),mv={},Hr=function(t){try{return!!t()}catch{return!0}},xN=Hr,Ni=!xN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),HN=Hr,rg=!HN(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),DN=rg,ah=Function.prototype.call,pa=DN?ah.bind(ah):function(){return ah.apply(ah,arguments)},fO={},gO={}.propertyIsEnumerable,mO=Object.getOwnPropertyDescriptor,NN=mO&&!gO.call({1:2},1);fO.f=NN?function(e){var n=mO(this,e);return!!n&&n.enumerable}:gO;var ig=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},pO=rg,wO=Function.prototype,Xw=wO.call,LN=pO&&wO.bind.bind(Xw,Xw),Un=pO?LN:function(t){return function(){return Xw.apply(t,arguments)}},CO=Un,$N=CO({}.toString),kN=CO("".slice),Nl=function(t){return kN($N(t),8,-1)},FN=Un,WN=Hr,VN=Nl,um=Object,BN=FN("".split),UN=WN(function(){return!um("z").propertyIsEnumerable(0)})?function(t){return VN(t)==="String"?BN(t,""):um(t)}:um,pv=function(t){return t==null},YN=pv,GN=TypeError,vO=function(t){if(YN(t))throw new GN("Can't call method on "+t);return t},zN=UN,jN=vO,og=function(t){return zN(jN(t))},cm=typeof document=="object"&&document.all,Mn=typeof cm>"u"&&cm!==void 0?function(t){return typeof t=="function"||t===cm}:function(t){return typeof t=="function"},KN=Mn,ws=function(t){return typeof t=="object"?t!==null:KN(t)},hm=_n,XN=Mn,qN=function(t){return XN(t)?t:void 0},Hc=function(t,e){return arguments.length<2?qN(hm[t]):hm[t]&&hm[t][e]},ZN=Un,wv=ZN({}.isPrototypeOf),Cv=typeof navigator<"u"&&String(navigator.userAgent)||"",SO=_n,dm=Cv,pR=SO.process,wR=SO.Deno,CR=pR&&pR.versions||wR&&wR.version,vR=CR&&CR.v8,Jr,lf;vR&&(Jr=vR.split("."),lf=Jr[0]>0&&Jr[0]<4?1:+(Jr[0]+Jr[1]));!lf&&dm&&(Jr=dm.match(/Edge\/(\d+)/),(!Jr||Jr[1]>=74)&&(Jr=dm.match(/Chrome\/(\d+)/),Jr&&(lf=+Jr[1])));var JN=lf,SR=JN,QN=Hr,eL=_n,tL=eL.String,vv=!!Object.getOwnPropertySymbols&&!QN(function(){var t=Symbol("symbol detection");return!tL(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&SR&&SR<41}),nL=vv,yO=nL&&!Symbol.sham&&typeof Symbol.iterator=="symbol",rL=Hc,iL=Mn,oL=wv,sL=yO,aL=Object,Sv=sL?function(t){return typeof t=="symbol"}:function(t){var e=rL("Symbol");return iL(e)&&oL(e.prototype,aL(t))},lL=String,sg=function(t){try{return lL(t)}catch{return"Object"}},uL=Mn,cL=sg,hL=TypeError,ag=function(t){if(uL(t))return t;throw new hL(cL(t)+" is not a function")},dL=ag,fL=pv,yv=function(t,e){var n=t[e];return fL(n)?void 0:dL(n)},fm=pa,gm=Mn,mm=ws,gL=TypeError,mL=function(t,e){var n,r;if(e==="string"&&gm(n=t.toString)&&!mm(r=fm(n,t))||gm(n=t.valueOf)&&!mm(r=fm(n,t))||e!=="string"&&gm(n=t.toString)&&!mm(r=fm(n,t)))return r;throw new gL("Can't convert object to primitive value")},bO={exports:{}},yR=_n,pL=Object.defineProperty,bv=function(t,e){try{pL(yR,t,{value:e,configurable:!0,writable:!0})}catch{yR[t]=e}return e},wL=_n,CL=bv,bR="__core-js_shared__",vL=wL[bR]||CL(bR,{}),Rv=vL,RR=Rv;(bO.exports=function(t,e){return RR[t]||(RR[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.35.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.0/LICENSE",source:"https://github.com/zloirock/core-js"});var RO=bO.exports,SL=vO,yL=Object,lg=function(t){return yL(SL(t))},bL=Un,RL=lg,EL=bL({}.hasOwnProperty),yo=Object.hasOwn||function(e,n){return EL(RL(e),n)},TL=Un,_L=0,ML=Math.random(),AL=TL(1 .toString),EO=function(t){return"Symbol("+(t===void 0?"":t)+")_"+AL(++_L+ML,36)},OL=_n,IL=RO,ER=yo,PL=EO,xL=vv,HL=yO,Cl=OL.Symbol,pm=IL("wks"),DL=HL?Cl.for||Cl:Cl&&Cl.withoutSetter||PL,Ll=function(t){return ER(pm,t)||(pm[t]=xL&&ER(Cl,t)?Cl[t]:DL("Symbol."+t)),pm[t]},NL=pa,TR=ws,_R=Sv,LL=yv,$L=mL,kL=Ll,FL=TypeError,WL=kL("toPrimitive"),VL=function(t,e){if(!TR(t)||_R(t))return t;var n=LL(t,WL),r;if(n){if(e===void 0&&(e="default"),r=NL(n,t,e),!TR(r)||_R(r))return r;throw new FL("Can't convert object to primitive value")}return e===void 0&&(e="number"),$L(t,e)},BL=VL,UL=Sv,Ev=function(t){var e=BL(t,"string");return UL(e)?e:e+""},YL=_n,MR=ws,qw=YL.document,GL=MR(qw)&&MR(qw.createElement),Tv=function(t){return GL?qw.createElement(t):{}},zL=Ni,jL=Hr,KL=Tv,TO=!zL&&!jL(function(){return Object.defineProperty(KL("div"),"a",{get:function(){return 7}}).a!==7}),XL=Ni,qL=pa,ZL=fO,JL=ig,QL=og,e$=Ev,t$=yo,n$=TO,AR=Object.getOwnPropertyDescriptor;mv.f=XL?AR:function(e,n){if(e=QL(e),n=e$(n),n$)try{return AR(e,n)}catch{}if(t$(e,n))return JL(!qL(ZL.f,e,n),e[n])};var Cs={},r$=Ni,i$=Hr,_O=r$&&i$(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),o$=ws,s$=String,a$=TypeError,vs=function(t){if(o$(t))return t;throw new a$(s$(t)+" is not an object")},l$=Ni,u$=TO,c$=_O,lh=vs,OR=Ev,h$=TypeError,wm=Object.defineProperty,d$=Object.getOwnPropertyDescriptor,Cm="enumerable",vm="configurable",Sm="writable";Cs.f=l$?c$?function(e,n,r){if(lh(e),n=OR(n),lh(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Sm in r&&!r[Sm]){var i=d$(e,n);i&&i[Sm]&&(e[n]=r.value,r={configurable:vm in r?r[vm]:i[vm],enumerable:Cm in r?r[Cm]:i[Cm],writable:!1})}return wm(e,n,r)}:wm:function(e,n,r){if(lh(e),n=OR(n),lh(r),u$)try{return wm(e,n,r)}catch{}if("get"in r||"set"in r)throw new h$("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var f$=Ni,g$=Cs,m$=ig,Dc=f$?function(t,e,n){return g$.f(t,e,m$(1,n))}:function(t,e,n){return t[e]=n,t},MO={exports:{}},Zw=Ni,p$=yo,AO=Function.prototype,w$=Zw&&Object.getOwnPropertyDescriptor,_v=p$(AO,"name"),C$=_v&&(function(){}).name==="something",v$=_v&&(!Zw||Zw&&w$(AO,"name").configurable),S$={EXISTS:_v,PROPER:C$,CONFIGURABLE:v$},y$=Un,b$=Mn,Jw=Rv,R$=y$(Function.toString);b$(Jw.inspectSource)||(Jw.inspectSource=function(t){return R$(t)});var E$=Jw.inspectSource,T$=_n,_$=Mn,IR=T$.WeakMap,M$=_$(IR)&&/native code/.test(String(IR)),A$=RO,O$=EO,PR=A$("keys"),OO=function(t){return PR[t]||(PR[t]=O$(t))},Mv={},I$=M$,IO=_n,P$=ws,x$=Dc,ym=yo,bm=Rv,H$=OO,D$=Mv,xR="Object already initialized",Qw=IO.TypeError,N$=IO.WeakMap,uf,mc,cf,L$=function(t){return cf(t)?mc(t):uf(t,{})},$$=function(t){return function(e){var n;if(!P$(e)||(n=mc(e)).type!==t)throw new Qw("Incompatible receiver, "+t+" required");return n}};if(I$||bm.state){var li=bm.state||(bm.state=new N$);li.get=li.get,li.has=li.has,li.set=li.set,uf=function(t,e){if(li.has(t))throw new Qw(xR);return e.facade=t,li.set(t,e),e},mc=function(t){return li.get(t)||{}},cf=function(t){return li.has(t)}}else{var Ea=H$("state");D$[Ea]=!0,uf=function(t,e){if(ym(t,Ea))throw new Qw(xR);return e.facade=t,x$(t,Ea,e),e},mc=function(t){return ym(t,Ea)?t[Ea]:{}},cf=function(t){return ym(t,Ea)}}var k$={set:uf,get:mc,has:cf,enforce:L$,getterFor:$$},Av=Un,F$=Hr,W$=Mn,uh=yo,eC=Ni,V$=S$.CONFIGURABLE,B$=E$,PO=k$,U$=PO.enforce,Y$=PO.get,HR=String,Hd=Object.defineProperty,G$=Av("".slice),z$=Av("".replace),j$=Av([].join),K$=eC&&!F$(function(){return Hd(function(){},"length",{value:8}).length!==8}),X$=String(String).split("String"),q$=MO.exports=function(t,e,n){G$(HR(e),0,7)==="Symbol("&&(e="["+z$(HR(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!uh(t,"name")||V$&&t.name!==e)&&(eC?Hd(t,"name",{value:e,configurable:!0}):t.name=e),K$&&n&&uh(n,"arity")&&t.length!==n.arity&&Hd(t,"length",{value:n.arity});try{n&&uh(n,"constructor")&&n.constructor?eC&&Hd(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=U$(t);return uh(r,"source")||(r.source=j$(X$,typeof e=="string"?e:"")),t};Function.prototype.toString=q$(function(){return W$(this)&&Y$(this).source||B$(this)},"toString");var Z$=MO.exports,J$=Mn,Q$=Cs,ek=Z$,tk=bv,nk=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(J$(n)&&ek(n,o,r),r.global)i?t[e]=n:tk(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:Q$.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},xO={},rk=Math.ceil,ik=Math.floor,ok=Math.trunc||function(e){var n=+e;return(n>0?ik:rk)(n)},sk=ok,Ov=function(t){var e=+t;return e!==e||e===0?0:sk(e)},ak=Ov,lk=Math.max,uk=Math.min,ck=function(t,e){var n=ak(t);return n<0?lk(n+e,0):uk(n,e)},hk=Ov,dk=Math.min,fk=function(t){return t>0?dk(hk(t),9007199254740991):0},gk=fk,Nc=function(t){return gk(t.length)},mk=og,pk=ck,wk=Nc,DR=function(t){return function(e,n,r){var i=mk(e),o=wk(i),s=pk(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Ck={includes:DR(!0),indexOf:DR(!1)},vk=Un,Rm=yo,Sk=og,yk=Ck.indexOf,bk=Mv,NR=vk([].push),HO=function(t,e){var n=Sk(t),r=0,i=[],o;for(o in n)!Rm(bk,o)&&Rm(n,o)&&NR(i,o);for(;e.length>r;)Rm(n,o=e[r++])&&(~yk(i,o)||NR(i,o));return i},Iv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Rk=HO,Ek=Iv,Tk=Ek.concat("length","prototype");xO.f=Object.getOwnPropertyNames||function(e){return Rk(e,Tk)};var DO={};DO.f=Object.getOwnPropertySymbols;var _k=Hc,Mk=Un,Ak=xO,Ok=DO,Ik=vs,Pk=Mk([].concat),xk=_k("Reflect","ownKeys")||function(e){var n=Ak.f(Ik(e)),r=Ok.f;return r?Pk(n,r(e)):n},LR=yo,Hk=xk,Dk=mv,Nk=Cs,NO=function(t,e,n){for(var r=Hk(e),i=Nk.f,o=Dk.f,s=0;s<r.length;s++){var a=r[s];!LR(t,a)&&!(n&&LR(n,a))&&i(t,a,o(e,a))}},Lk=Hr,$k=Mn,kk=/#|\.prototype\./,Lc=function(t,e){var n=Wk[Fk(t)];return n===Bk?!0:n===Vk?!1:$k(e)?Lk(e):!!e},Fk=Lc.normalize=function(t){return String(t).replace(kk,".").toLowerCase()},Wk=Lc.data={},Vk=Lc.NATIVE="N",Bk=Lc.POLYFILL="P",Uk=Lc,Em=_n,Yk=mv.f,Gk=Dc,zk=nk,jk=bv,Kk=NO,Xk=Uk,Ss=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Em:i?s=Em[n]||jk(n,{}):s=(Em[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=Yk(s,a),l=c&&c.value):l=s[a],o=Xk(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;Kk(u,l)}(t.sham||l&&l.sham)&&Gk(u,"sham",!0),zk(s,a,u,t)}},qk=Nl,LO=Array.isArray||function(e){return qk(e)==="Array"},Zk=Ni,Jk=LO,Qk=TypeError,eF=Object.getOwnPropertyDescriptor,tF=Zk&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),$O=tF?function(t,e){if(Jk(t)&&!eF(t,"length").writable)throw new Qk("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},nF=TypeError,rF=9007199254740991,kO=function(t){if(t>rF)throw nF("Maximum allowed index exceeded");return t},iF=Ss,oF=lg,sF=Nc,aF=$O,lF=kO,uF=Hr,cF=uF(function(){return[].push.call({length:4294967296},1)!==4294967297}),hF=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},dF=cF||!hF();iF({target:"Array",proto:!0,arity:1,forced:dF},{push:function(e){var n=oF(this),r=sF(n),i=arguments.length;lF(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return aF(n,r),r}});var fF=rg,FO=Function.prototype,$R=FO.apply,kR=FO.call,ug=typeof Reflect=="object"&&Reflect.apply||(fF?kR.bind($R):function(){return kR.apply($R,arguments)}),gF=Un,mF=ag,pF=function(t,e,n){try{return gF(mF(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},wF=ws,CF=function(t){return wF(t)||t===null},vF=CF,SF=String,yF=TypeError,bF=function(t){if(vF(t))return t;throw new yF("Can't set "+SF(t)+" as a prototype")},RF=pF,EF=vs,TF=bF,WO=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=RF(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return EF(i),TF(o),t?n(i,o):i.__proto__=o,i}}():void 0),_F=Cs.f,MF=function(t,e,n){n in t||_F(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},AF=Mn,OF=ws,FR=WO,IF=function(t,e,n){var r,i;return FR&&AF(r=e.constructor)&&r!==n&&OF(i=r.prototype)&&i!==n.prototype&&FR(t,i),t},PF=Ll,xF=PF("toStringTag"),VO={};VO[xF]="z";var HF=String(VO)==="[object z]",DF=HF,NF=Mn,Dd=Nl,LF=Ll,$F=LF("toStringTag"),kF=Object,FF=Dd(function(){return arguments}())==="Arguments",WF=function(t,e){try{return t[e]}catch{}},BO=DF?Dd:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=WF(e=kF(t),$F))=="string"?n:FF?Dd(e):(r=Dd(e))==="Object"&&NF(e.callee)?"Arguments":r},VF=BO,BF=String,UO=function(t){if(VF(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return BF(t)},UF=UO,YF=function(t,e){return t===void 0?arguments.length<2?"":e:UF(t)},GF=ws,zF=Dc,jF=function(t,e){GF(e)&&"cause"in e&&zF(t,"cause",e.cause)},KF=Un,YO=Error,XF=KF("".replace),qF=function(t){return String(new YO(t).stack)}("zxcasd"),GO=/\n\s*at [^:]*:[^\n]*/,ZF=GO.test(qF),JF=function(t,e){if(ZF&&typeof t=="string"&&!YO.prepareStackTrace)for(;e--;)t=XF(t,GO,"");return t},QF=Hr,eW=ig,tW=!QF(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",eW(1,7)),t.stack!==7):!0}),nW=Dc,rW=JF,iW=tW,WR=Error.captureStackTrace,oW=function(t,e,n,r){iW&&(WR?WR(t,e):nW(t,"stack",rW(n,r)))},VR=Hc,sW=yo,BR=Dc,aW=wv,UR=WO,YR=NO,GR=MF,lW=IF,uW=YF,cW=jF,hW=oW,dW=Ni,fW=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=VR.apply(null,s);if(l){var u=l.prototype;if(sW(u,"cause")&&delete u.cause,!n)return l;var c=VR("Error"),h=e(function(d,g){var p=uW(r?g:d,void 0),C=r?new l(d):new l;return p!==void 0&&BR(C,"message",p),hW(C,h,C.stack,2),this&&aW(u,this)&&lW(C,this,h),arguments.length>o&&cW(C,arguments[o]),C});h.prototype=u,a!=="Error"?UR?UR(h,c):YR(h,c,{name:!0}):dW&&i in l&&(GR(h,l,i),GR(h,l,"prepareStackTrace")),YR(h,l);try{u.name!==a&&BR(u,"name",a),u.constructor=h}catch{}return h}},zO=Ss,gW=_n,Li=ug,jO=fW,tC="WebAssembly",zR=gW[tC],hf=new Error("e",{cause:7}).cause!==7,wa=function(t,e){var n={};n[t]=jO(t,e,hf),zO({global:!0,constructor:!0,arity:1,forced:hf},n)},Pv=function(t,e){if(zR&&zR[t]){var n={};n[t]=jO(tC+"."+t,e,hf),zO({target:tC,stat:!0,constructor:!0,arity:1,forced:hf},n)}};wa("Error",function(t){return function(n){return Li(t,this,arguments)}});wa("EvalError",function(t){return function(n){return Li(t,this,arguments)}});wa("RangeError",function(t){return function(n){return Li(t,this,arguments)}});wa("ReferenceError",function(t){return function(n){return Li(t,this,arguments)}});wa("SyntaxError",function(t){return function(n){return Li(t,this,arguments)}});wa("TypeError",function(t){return function(n){return Li(t,this,arguments)}});wa("URIError",function(t){return function(n){return Li(t,this,arguments)}});Pv("CompileError",function(t){return function(n){return Li(t,this,arguments)}});Pv("LinkError",function(t){return function(n){return Li(t,this,arguments)}});Pv("RuntimeError",function(t){return function(n){return Li(t,this,arguments)}});var mW=Nl,pW=Un,wW=function(t){if(mW(t)==="Function")return pW(t)},jR=wW,CW=ag,vW=rg,SW=jR(jR.bind),KO=function(t,e){return CW(t),e===void 0?t:vW?SW(t,e):function(){return t.apply(e,arguments)}},yW=Hc,XO=yW("document","documentElement"),bW=Un,xv=bW([].slice),RW=TypeError,qO=function(t,e){if(t<e)throw new RW("Not enough arguments");return t},EW=Cv,TW=/(?:ipad|iphone|ipod).*applewebkit/i.test(EW),_W=_n,MW=Nl,AW=MW(_W.process)==="process",mr=_n,OW=ug,IW=KO,KR=Mn,PW=yo,ZO=Hr,XR=XO,xW=xv,qR=Tv,HW=qO,DW=TW,NW=AW,nC=mr.setImmediate,rC=mr.clearImmediate,LW=mr.process,Tm=mr.Dispatch,$W=mr.Function,ZR=mr.MessageChannel,kW=mr.String,_m=0,ju={},JR="onreadystatechange",pc,Rs,Mm,Am;ZO(function(){pc=mr.location});var Hv=function(t){if(PW(ju,t)){var e=ju[t];delete ju[t],e()}},Om=function(t){return function(){Hv(t)}},QR=function(t){Hv(t.data)},e0=function(t){mr.postMessage(kW(t),pc.protocol+"//"+pc.host)};(!nC||!rC)&&(nC=function(e){HW(arguments.length,1);var n=KR(e)?e:$W(e),r=xW(arguments,1);return ju[++_m]=function(){OW(n,void 0,r)},Rs(_m),_m},rC=function(e){delete ju[e]},NW?Rs=function(t){LW.nextTick(Om(t))}:Tm&&Tm.now?Rs=function(t){Tm.now(Om(t))}:ZR&&!DW?(Mm=new ZR,Am=Mm.port2,Mm.port1.onmessage=QR,Rs=IW(Am.postMessage,Am)):mr.addEventListener&&KR(mr.postMessage)&&!mr.importScripts&&pc&&pc.protocol!=="file:"&&!ZO(e0)?(Rs=e0,mr.addEventListener("message",QR,!1)):JR in qR("script")?Rs=function(t){XR.appendChild(qR("script"))[JR]=function(){XR.removeChild(this),Hv(t)}}:Rs=function(t){setTimeout(Om(t),0)});var JO={set:nC,clear:rC},FW=Ss,WW=_n,t0=JO.clear;FW({global:!0,bind:!0,enumerable:!0,forced:WW.clearImmediate!==t0},{clearImmediate:t0});var VW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",QO=_n,BW=ug,UW=Mn,YW=VW,GW=Cv,zW=xv,jW=qO,KW=QO.Function,XW=/MSIE .\./.test(GW)||YW&&function(){var t=QO.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),qW=function(t,e){var n=e?2:1;return XW?function(r,i){var o=jW(arguments.length,1)>n,s=UW(r)?r:KW(r),a=o?zW(arguments,n):[],l=o?function(){BW(s,this,a)}:s;return e?t(l,i):t(l)}:t},ZW=Ss,eI=_n,n0=JO.set,JW=qW,r0=eI.setImmediate?JW(n0,!1):n0;ZW({global:!0,bind:!0,enumerable:!0,forced:eI.setImmediate!==r0},{setImmediate:r0});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function jo(t){"@babel/helpers - typeof";return jo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jo(t)}function iC(t,e){return iC=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},iC(t,e)}function QW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nd(t,e,n){return QW()?Nd=Reflect.construct:Nd=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&iC(u,s.prototype),u},Nd.apply(null,arguments)}function jr(t){return eV(t)||tV(t)||nV(t)||rV()}function eV(t){if(Array.isArray(t))return oC(t)}function tV(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function nV(t,e){if(t){if(typeof t=="string")return oC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oC(t,e)}}function oC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function rV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var iV=Object.hasOwnProperty,i0=Object.setPrototypeOf,oV=Object.isFrozen,sV=Object.getPrototypeOf,aV=Object.getOwnPropertyDescriptor,Bn=Object.freeze,ni=Object.seal,lV=Object.create,tI=typeof Reflect<"u"&&Reflect,df=tI.apply,sC=tI.construct;df||(df=function(e,n,r){return e.apply(n,r)});Bn||(Bn=function(e){return e});ni||(ni=function(e){return e});sC||(sC=function(e,n){return Nd(e,jr(n))});var uV=Pr(Array.prototype.forEach),o0=Pr(Array.prototype.pop),ql=Pr(Array.prototype.push),Ld=Pr(String.prototype.toLowerCase),Im=Pr(String.prototype.toString),cV=Pr(String.prototype.match),$r=Pr(String.prototype.replace),hV=Pr(String.prototype.indexOf),dV=Pr(String.prototype.trim),Pn=Pr(RegExp.prototype.test),Pm=fV(TypeError);function Pr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return df(t,e,r)}}function fV(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return sC(t,n)}}function je(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Ld,i0&&i0(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(oV(e)||(e[i]=s),o=s)}t[o]=!0}return t}function Es(t){var e=lV(null),n;for(n in t)df(iV,t,[n])===!0&&(e[n]=t[n]);return e}function ch(t,e){for(;t!==null;){var n=aV(t,e);if(n){if(n.get)return Pr(n.get);if(typeof n.value=="function")return Pr(n.value)}t=sV(t)}function r(i){return console.warn("fallback value for",i),null}return r}var s0=Bn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),xm=Bn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Hm=Bn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),gV=Bn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Dm=Bn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),mV=Bn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),a0=Bn(["#text"]),l0=Bn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Nm=Bn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),u0=Bn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),hh=Bn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),pV=ni(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wV=ni(/<%[\w\W]*|[\w\W]*%>/gm),CV=ni(/\${[\w\W]*}/gm),vV=ni(/^data-[\-\w.\u00B7-\uFFFF]/),SV=ni(/^aria-[\-\w]+$/),yV=ni(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),bV=ni(/^(?:\w+script|data):/i),RV=ni(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),EV=ni(/^html$/i),TV=function(){return typeof window>"u"?null:window},_V=function(e,n){if(jo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function nI(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:TV(),e=function(x){return nI(x)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,d=t.DOMParser,g=t.trustedTypes,p=a.prototype,C=ch(p,"cloneNode"),S=ch(p,"nextSibling"),y=ch(p,"childNodes"),R=ch(p,"parentNode");if(typeof o=="function"){var T=r.createElement("template");T.content&&T.content.ownerDocument&&(r=T.content.ownerDocument)}var N=_V(g,n),I=N?N.createHTML(""):"",F=r,B=F.implementation,ee=F.createNodeIterator,U=F.createDocumentFragment,j=F.getElementsByTagName,re=n.importNode,ie={};try{ie=Es(r).documentMode?r.documentMode:{}}catch{}var oe={};e.isSupported=typeof R=="function"&&B&&B.createHTMLDocument!==void 0&&ie!==9;var Ce=pV,Me=wV,rt=CV,Fe=vV,pe=SV,f=bV,m=RV,w=yV,A=null,O=je({},[].concat(jr(s0),jr(xm),jr(Hm),jr(Dm),jr(a0))),D=null,z=je({},[].concat(jr(l0),jr(Nm),jr(u0),jr(hh))),G=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ne=null,Z=null,K=!0,Se=!0,Pe=!1,Oe=!0,He=!1,Y=!1,lt=!1,Be=!1,xe=!1,De=!1,be=!1,v=!0,b=!1,_="user-content-",k=!0,M=!1,$={},P=null,H=je({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),W=null,L=je({},["audio","video","img","source","image","track"]),V=null,te=je({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),he="http://www.w3.org/1998/Math/MathML",ye="http://www.w3.org/2000/svg",Ae="http://www.w3.org/1999/xhtml",We=Ae,St=!1,qe=null,ct=je({},[he,ye,Ae],Im),_t,Ra=["application/xhtml+xml","text/html"],jl="text/html",Bt,cn=null,bs=r.createElement("form"),In=function(x){return x instanceof RegExp||x instanceof Function},Jt=function(x){cn&&cn===x||((!x||jo(x)!=="object")&&(x={}),x=Es(x),_t=Ra.indexOf(x.PARSER_MEDIA_TYPE)===-1?_t=jl:_t=x.PARSER_MEDIA_TYPE,Bt=_t==="application/xhtml+xml"?Im:Ld,A="ALLOWED_TAGS"in x?je({},x.ALLOWED_TAGS,Bt):O,D="ALLOWED_ATTR"in x?je({},x.ALLOWED_ATTR,Bt):z,qe="ALLOWED_NAMESPACES"in x?je({},x.ALLOWED_NAMESPACES,Im):ct,V="ADD_URI_SAFE_ATTR"in x?je(Es(te),x.ADD_URI_SAFE_ATTR,Bt):te,W="ADD_DATA_URI_TAGS"in x?je(Es(L),x.ADD_DATA_URI_TAGS,Bt):L,P="FORBID_CONTENTS"in x?je({},x.FORBID_CONTENTS,Bt):H,ne="FORBID_TAGS"in x?je({},x.FORBID_TAGS,Bt):{},Z="FORBID_ATTR"in x?je({},x.FORBID_ATTR,Bt):{},$="USE_PROFILES"in x?x.USE_PROFILES:!1,K=x.ALLOW_ARIA_ATTR!==!1,Se=x.ALLOW_DATA_ATTR!==!1,Pe=x.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=x.ALLOW_SELF_CLOSE_IN_ATTR!==!1,He=x.SAFE_FOR_TEMPLATES||!1,Y=x.WHOLE_DOCUMENT||!1,xe=x.RETURN_DOM||!1,De=x.RETURN_DOM_FRAGMENT||!1,be=x.RETURN_TRUSTED_TYPE||!1,Be=x.FORCE_BODY||!1,v=x.SANITIZE_DOM!==!1,b=x.SANITIZE_NAMED_PROPS||!1,k=x.KEEP_CONTENT!==!1,M=x.IN_PLACE||!1,w=x.ALLOWED_URI_REGEXP||w,We=x.NAMESPACE||Ae,G=x.CUSTOM_ELEMENT_HANDLING||{},x.CUSTOM_ELEMENT_HANDLING&&In(x.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=x.CUSTOM_ELEMENT_HANDLING.tagNameCheck),x.CUSTOM_ELEMENT_HANDLING&&In(x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),x.CUSTOM_ELEMENT_HANDLING&&typeof x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(G.allowCustomizedBuiltInElements=x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),He&&(Se=!1),De&&(xe=!0),$&&(A=je({},jr(a0)),D=[],$.html===!0&&(je(A,s0),je(D,l0)),$.svg===!0&&(je(A,xm),je(D,Nm),je(D,hh)),$.svgFilters===!0&&(je(A,Hm),je(D,Nm),je(D,hh)),$.mathMl===!0&&(je(A,Dm),je(D,u0),je(D,hh))),x.ADD_TAGS&&(A===O&&(A=Es(A)),je(A,x.ADD_TAGS,Bt)),x.ADD_ATTR&&(D===z&&(D=Es(D)),je(D,x.ADD_ATTR,Bt)),x.ADD_URI_SAFE_ATTR&&je(V,x.ADD_URI_SAFE_ATTR,Bt),x.FORBID_CONTENTS&&(P===H&&(P=Es(P)),je(P,x.FORBID_CONTENTS,Bt)),k&&(A["#text"]=!0),Y&&je(A,["html","head","body"]),A.table&&(je(A,["tbody"]),delete ne.tbody),Bn&&Bn(x),cn=x)},yt=je({},["mi","mo","mn","ms","mtext"]),lR=je({},["foreignobject","desc","title","annotation-xml"]),_N=je({},["title","style","font","a","script"]),ih=je({},xm);je(ih,Hm),je(ih,gV);var sm=je({},Dm);je(sm,mV);var MN=function(x){var Q=R(x);(!Q||!Q.tagName)&&(Q={namespaceURI:We,tagName:"template"});var le=Ld(x.tagName),ut=Ld(Q.tagName);return qe[x.namespaceURI]?x.namespaceURI===ye?Q.namespaceURI===Ae?le==="svg":Q.namespaceURI===he?le==="svg"&&(ut==="annotation-xml"||yt[ut]):!!ih[le]:x.namespaceURI===he?Q.namespaceURI===Ae?le==="math":Q.namespaceURI===ye?le==="math"&&lR[ut]:!!sm[le]:x.namespaceURI===Ae?Q.namespaceURI===ye&&!lR[ut]||Q.namespaceURI===he&&!yt[ut]?!1:!sm[le]&&(_N[le]||!ih[le]):!!(_t==="application/xhtml+xml"&&qe[x.namespaceURI]):!1},Wi=function(x){ql(e.removed,{element:x});try{x.parentNode.removeChild(x)}catch{try{x.outerHTML=I}catch{x.remove()}}},am=function(x,Q){try{ql(e.removed,{attribute:Q.getAttributeNode(x),from:Q})}catch{ql(e.removed,{attribute:null,from:Q})}if(Q.removeAttribute(x),x==="is"&&!D[x])if(xe||De)try{Wi(Q)}catch{}else try{Q.setAttribute(x,"")}catch{}},uR=function(x){var Q,le;if(Be)x="<remove></remove>"+x;else{var ut=cV(x,/^[\r\n\t ]+/);le=ut&&ut[0]}_t==="application/xhtml+xml"&&We===Ae&&(x='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+x+"</body></html>");var Gn=N?N.createHTML(x):x;if(We===Ae)try{Q=new d().parseFromString(Gn,_t)}catch{}if(!Q||!Q.documentElement){Q=B.createDocument(We,"template",null);try{Q.documentElement.innerHTML=St?I:Gn}catch{}}var mn=Q.body||Q.documentElement;return x&&le&&mn.insertBefore(r.createTextNode(le),mn.childNodes[0]||null),We===Ae?j.call(Q,Y?"html":"body")[0]:Y?Q.documentElement:mn},cR=function(x){return ee.call(x.ownerDocument||x,x,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},AN=function(x){return x instanceof h&&(typeof x.nodeName!="string"||typeof x.textContent!="string"||typeof x.removeChild!="function"||!(x.attributes instanceof c)||typeof x.removeAttribute!="function"||typeof x.setAttribute!="function"||typeof x.namespaceURI!="string"||typeof x.insertBefore!="function"||typeof x.hasChildNodes!="function")},Kl=function(x){return jo(s)==="object"?x instanceof s:x&&jo(x)==="object"&&typeof x.nodeType=="number"&&typeof x.nodeName=="string"},Vi=function(x,Q,le){oe[x]&&uV(oe[x],function(ut){ut.call(e,Q,le,cn)})},hR=function(x){var Q;if(Vi("beforeSanitizeElements",x,null),AN(x)||Pn(/[\u0080-\uFFFF]/,x.nodeName))return Wi(x),!0;var le=Bt(x.nodeName);if(Vi("uponSanitizeElement",x,{tagName:le,allowedTags:A}),x.hasChildNodes()&&!Kl(x.firstElementChild)&&(!Kl(x.content)||!Kl(x.content.firstElementChild))&&Pn(/<[/\w]/g,x.innerHTML)&&Pn(/<[/\w]/g,x.textContent)||le==="select"&&Pn(/<template/i,x.innerHTML))return Wi(x),!0;if(!A[le]||ne[le]){if(!ne[le]&&fR(le)&&(G.tagNameCheck instanceof RegExp&&Pn(G.tagNameCheck,le)||G.tagNameCheck instanceof Function&&G.tagNameCheck(le)))return!1;if(k&&!P[le]){var ut=R(x)||x.parentNode,Gn=y(x)||x.childNodes;if(Gn&&ut)for(var mn=Gn.length,hn=mn-1;hn>=0;--hn)ut.insertBefore(C(Gn[hn],!0),S(x))}return Wi(x),!0}return x instanceof a&&!MN(x)||(le==="noscript"||le==="noembed"||le==="noframes")&&Pn(/<\/no(script|embed|frames)/i,x.innerHTML)?(Wi(x),!0):(He&&x.nodeType===3&&(Q=x.textContent,Q=$r(Q,Ce," "),Q=$r(Q,Me," "),Q=$r(Q,rt," "),x.textContent!==Q&&(ql(e.removed,{element:x.cloneNode()}),x.textContent=Q)),Vi("afterSanitizeElements",x,null),!1)},dR=function(x,Q,le){if(v&&(Q==="id"||Q==="name")&&(le in r||le in bs))return!1;if(!(Se&&!Z[Q]&&Pn(Fe,Q))){if(!(K&&Pn(pe,Q))){if(!D[Q]||Z[Q]){if(!(fR(x)&&(G.tagNameCheck instanceof RegExp&&Pn(G.tagNameCheck,x)||G.tagNameCheck instanceof Function&&G.tagNameCheck(x))&&(G.attributeNameCheck instanceof RegExp&&Pn(G.attributeNameCheck,Q)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(Q))||Q==="is"&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&Pn(G.tagNameCheck,le)||G.tagNameCheck instanceof Function&&G.tagNameCheck(le))))return!1}else if(!V[Q]){if(!Pn(w,$r(le,m,""))){if(!((Q==="src"||Q==="xlink:href"||Q==="href")&&x!=="script"&&hV(le,"data:")===0&&W[x])){if(!(Pe&&!Pn(f,$r(le,m,"")))){if(le)return!1}}}}}}return!0},fR=function(x){return x.indexOf("-")>0},gR=function(x){var Q,le,ut,Gn;Vi("beforeSanitizeAttributes",x,null);var mn=x.attributes;if(mn){var hn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:D};for(Gn=mn.length;Gn--;){Q=mn[Gn];var oh=Q,rn=oh.name,lm=oh.namespaceURI;if(le=rn==="value"?Q.value:dV(Q.value),ut=Bt(rn),hn.attrName=ut,hn.attrValue=le,hn.keepAttr=!0,hn.forceKeepAttr=void 0,Vi("uponSanitizeAttribute",x,hn),le=hn.attrValue,!hn.forceKeepAttr&&(am(rn,x),!!hn.keepAttr)){if(!Oe&&Pn(/\/>/i,le)){am(rn,x);continue}He&&(le=$r(le,Ce," "),le=$r(le,Me," "),le=$r(le,rt," "));var mR=Bt(x.nodeName);if(dR(mR,ut,le)){if(b&&(ut==="id"||ut==="name")&&(am(rn,x),le=_+le),N&&jo(g)==="object"&&typeof g.getAttributeType=="function"&&!lm)switch(g.getAttributeType(mR,ut)){case"TrustedHTML":{le=N.createHTML(le);break}case"TrustedScriptURL":{le=N.createScriptURL(le);break}}try{lm?x.setAttributeNS(lm,rn,le):x.setAttribute(rn,le),o0(e.removed)}catch{}}}}Vi("afterSanitizeAttributes",x,null)}},ON=function Re(x){var Q,le=cR(x);for(Vi("beforeSanitizeShadowDOM",x,null);Q=le.nextNode();)Vi("uponSanitizeShadowNode",Q,null),!hR(Q)&&(Q.content instanceof i&&Re(Q.content),gR(Q));Vi("afterSanitizeShadowDOM",x,null)};return e.sanitize=function(Re){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Q,le,ut,Gn,mn;if(St=!Re,St&&(Re="<!-->"),typeof Re!="string"&&!Kl(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw Pm("dirty is not a string, aborting")}else throw Pm("toString is not a function");if(!e.isSupported){if(jo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Re=="string")return t.toStaticHTML(Re);if(Kl(Re))return t.toStaticHTML(Re.outerHTML)}return Re}if(lt||Jt(x),e.removed=[],typeof Re=="string"&&(M=!1),M){if(Re.nodeName){var hn=Bt(Re.nodeName);if(!A[hn]||ne[hn])throw Pm("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof s)Q=uR("<!---->"),le=Q.ownerDocument.importNode(Re,!0),le.nodeType===1&&le.nodeName==="BODY"||le.nodeName==="HTML"?Q=le:Q.appendChild(le);else{if(!xe&&!He&&!Y&&Re.indexOf("<")===-1)return N&&be?N.createHTML(Re):Re;if(Q=uR(Re),!Q)return xe?null:be?I:""}Q&&Be&&Wi(Q.firstChild);for(var oh=cR(M?Re:Q);ut=oh.nextNode();)ut.nodeType===3&&ut===Gn||hR(ut)||(ut.content instanceof i&&ON(ut.content),gR(ut),Gn=ut);if(Gn=null,M)return Re;if(xe){if(De)for(mn=U.call(Q.ownerDocument);Q.firstChild;)mn.appendChild(Q.firstChild);else mn=Q;return(D.shadowroot||D.shadowrootmod)&&(mn=re.call(n,mn,!0)),mn}var rn=Y?Q.outerHTML:Q.innerHTML;return Y&&A["!doctype"]&&Q.ownerDocument&&Q.ownerDocument.doctype&&Q.ownerDocument.doctype.name&&Pn(EV,Q.ownerDocument.doctype.name)&&(rn="<!DOCTYPE "+Q.ownerDocument.doctype.name+`>
`+rn),He&&(rn=$r(rn,Ce," "),rn=$r(rn,Me," "),rn=$r(rn,rt," ")),N&&be?N.createHTML(rn):rn},e.setConfig=function(Re){Jt(Re),lt=!0},e.clearConfig=function(){cn=null,lt=!1},e.isValidAttribute=function(Re,x,Q){cn||Jt({});var le=Bt(Re),ut=Bt(x);return dR(le,ut,Q)},e.addHook=function(Re,x){typeof x=="function"&&(oe[Re]=oe[Re]||[],ql(oe[Re],x))},e.removeHook=function(Re){if(oe[Re])return o0(oe[Re])},e.removeHooks=function(Re){oe[Re]&&(oe[Re]=[])},e.removeAllHooks=function(){oe={}},e}var MV=nI();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var rI;function X(){return rI.apply(null,arguments)}function AV(t){rI=t}function ri(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ua(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function st(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Dv(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(st(t,e))return!1;return!0}function Jn(t){return t===void 0}function wo(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function $c(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function iI(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Jo(t,e){for(var n in e)st(e,n)&&(t[n]=e[n]);return st(e,"toString")&&(t.toString=e.toString),st(e,"valueOf")&&(t.valueOf=e.valueOf),t}function $i(t,e,n,r){return AI(t,e,n,r,!0).utc()}function OV(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ge(t){return t._pf==null&&(t._pf=OV()),t._pf}var aC;Array.prototype.some?aC=Array.prototype.some:aC=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function Nv(t){if(t._isValid==null){var e=Ge(t),n=aC.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function cg(t){var e=$i(NaN);return t!=null?Jo(Ge(e),t):Ge(e).userInvalidated=!0,e}var c0=X.momentProperties=[],Lm=!1;function Lv(t,e){var n,r,i,o=c0.length;if(Jn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Jn(e._i)||(t._i=e._i),Jn(e._f)||(t._f=e._f),Jn(e._l)||(t._l=e._l),Jn(e._strict)||(t._strict=e._strict),Jn(e._tzm)||(t._tzm=e._tzm),Jn(e._isUTC)||(t._isUTC=e._isUTC),Jn(e._offset)||(t._offset=e._offset),Jn(e._pf)||(t._pf=Ge(e)),Jn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=c0[n],i=e[r],Jn(i)||(t[r]=i);return t}function kc(t){Lv(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Lm===!1&&(Lm=!0,X.updateOffset(this),Lm=!1)}function ii(t){return t instanceof kc||t!=null&&t._isAMomentObject!=null}function oI(t){X.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Dr(t,e){var n=!0;return Jo(function(){if(X.deprecationHandler!=null&&X.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])st(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}oI(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var h0={};function sI(t,e){X.deprecationHandler!=null&&X.deprecationHandler(t,e),h0[t]||(oI(e),h0[t]=!0)}X.suppressDeprecationWarnings=!1;X.deprecationHandler=null;function ki(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function IV(t){var e,n;for(n in t)st(t,n)&&(e=t[n],ki(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function lC(t,e){var n=Jo({},t),r;for(r in e)st(e,r)&&(ua(t[r])&&ua(e[r])?(n[r]={},Jo(n[r],t[r]),Jo(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)st(t,r)&&!st(e,r)&&ua(t[r])&&(n[r]=Jo({},n[r]));return n}function $v(t){t!=null&&this.set(t)}var uC;Object.keys?uC=Object.keys:uC=function(t){var e,n=[];for(e in t)st(t,e)&&n.push(e);return n};var PV={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function xV(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return ki(r)?r.call(e,n):r}function Di(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var kv=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,dh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,$m={},Rl={};function Te(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Rl[t]=i),e&&(Rl[e[0]]=function(){return Di(i.apply(this,arguments),e[1],e[2])}),n&&(Rl[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function HV(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function DV(t){var e=t.match(kv),n,r;for(n=0,r=e.length;n<r;n++)Rl[e[n]]?e[n]=Rl[e[n]]:e[n]=HV(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=ki(e[s])?e[s].call(i,t):e[s];return o}}function $d(t,e){return t.isValid()?(e=aI(e,t.localeData()),$m[e]=$m[e]||DV(e),$m[e](t)):t.localeData().invalidDate()}function aI(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(dh.lastIndex=0;n>=0&&dh.test(t);)t=t.replace(dh,r),dh.lastIndex=0,n-=1;return t}var NV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function LV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(kv).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var $V="Invalid date";function kV(){return this._invalidDate}var FV="%d",WV=/\d{1,2}/;function VV(t){return this._ordinal.replace("%d",t)}var BV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function UV(t,e,n,r){var i=this._relativeTime[n];return ki(i)?i(t,e,n,r):i.replace(/%d/i,t)}function YV(t,e){var n=this._relativeTime[t>0?"future":"past"];return ki(n)?n(e):n.replace(/%s/i,e)}var Ku={};function An(t,e){var n=t.toLowerCase();Ku[n]=Ku[n+"s"]=Ku[e]=t}function Nr(t){return typeof t=="string"?Ku[t]||Ku[t.toLowerCase()]:void 0}function Fv(t){var e={},n,r;for(r in t)st(t,r)&&(n=Nr(r),n&&(e[n]=t[r]));return e}var lI={};function On(t,e){lI[t]=e}function GV(t){var e=[],n;for(n in t)st(t,n)&&e.push({unit:n,priority:lI[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function hg(t){return t%4===0&&t%100!==0||t%400===0}function Or(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Or(e)),n}function $l(t,e){return function(n){return n!=null?(uI(this,t,n),X.updateOffset(this,e),this):ff(this,t)}}function ff(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function uI(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&hg(t.year())&&t.month()===1&&t.date()===29?(n=Qe(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),wg(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function zV(t){return t=Nr(t),ki(this[t])?this[t]():this}function jV(t,e){if(typeof t=="object"){t=Fv(t);var n=GV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Nr(t),ki(this[t]))return this[t](e);return this}var cI=/\d/,wr=/\d\d/,hI=/\d{3}/,Wv=/\d{4}/,dg=/[+-]?\d{6}/,Tt=/\d\d?/,dI=/\d\d\d\d?/,fI=/\d\d\d\d\d\d?/,fg=/\d{1,3}/,Vv=/\d{1,4}/,gg=/[+-]?\d{1,6}/,kl=/\d+/,mg=/[+-]?\d+/,KV=/Z|[+-]\d\d:?\d\d/gi,pg=/Z|[+-]\d\d(?::?\d\d)?/gi,XV=/[+-]?\d+(\.\d{1,3})?/,Fc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,gf;gf={};function fe(t,e,n){gf[t]=ki(e)?e:function(r,i){return r&&n?n:e}}function qV(t,e){return st(gf,t)?gf[t](e._strict,e._locale):new RegExp(ZV(t))}function ZV(t){return gr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function gr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var cC={};function mt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),wo(e)&&(r=function(o,s){s[e]=Qe(o)}),i=t.length,n=0;n<i;n++)cC[t[n]]=r}function Wc(t,e){mt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function JV(t,e,n){e!=null&&st(cC,t)&&cC[t](e,n._a,n,t)}var Rn=0,ao=1,Ai=2,tn=3,Qr=4,lo=5,na=6,QV=7,eB=8;function tB(t,e){return(t%e+e)%e}var zt;Array.prototype.indexOf?zt=Array.prototype.indexOf:zt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function wg(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=tB(e,12);return t+=(e-n)/12,n===1?hg(t)?29:28:31-n%7%2}Te("M",["MM",2],"Mo",function(){return this.month()+1});Te("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Te("MMMM",0,0,function(t){return this.localeData().months(this,t)});An("month","M");On("month",8);fe("M",Tt);fe("MM",Tt,wr);fe("MMM",function(t,e){return e.monthsShortRegex(t)});fe("MMMM",function(t,e){return e.monthsRegex(t)});mt(["M","MM"],function(t,e){e[ao]=Qe(t)-1});mt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ao]=i:Ge(n).invalidMonth=t});var nB="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),gI="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),mI=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,rB=Fc,iB=Fc;function oB(t,e){return t?ri(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||mI).test(e)?"format":"standalone"][t.month()]:ri(this._months)?this._months:this._months.standalone}function sB(t,e){return t?ri(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[mI.test(e)?"format":"standalone"][t.month()]:ri(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function aB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=$i([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=zt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:(i=zt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=zt.call(this._longMonthsParse,s),i!==-1?i:(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null))}function lB(t,e,n){var r,i,o;if(this._monthsParseExact)return aB.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=$i([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function pI(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!wo(e))return t}return n=Math.min(t.date(),wg(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function wI(t){return t!=null?(pI(this,t),X.updateOffset(this,!0),this):ff(this,"Month")}function uB(){return wg(this.year(),this.month())}function cB(t){return this._monthsParseExact?(st(this,"_monthsRegex")||CI.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(st(this,"_monthsShortRegex")||(this._monthsShortRegex=rB),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function hB(t){return this._monthsParseExact?(st(this,"_monthsRegex")||CI.call(this),t?this._monthsStrictRegex:this._monthsRegex):(st(this,"_monthsRegex")||(this._monthsRegex=iB),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function CI(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=$i([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=gr(e[i]),n[i]=gr(n[i]);for(i=0;i<24;i++)r[i]=gr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Te("Y",0,0,function(){var t=this.year();return t<=9999?Di(t,4):"+"+t});Te(0,["YY",2],0,function(){return this.year()%100});Te(0,["YYYY",4],0,"year");Te(0,["YYYYY",5],0,"year");Te(0,["YYYYYY",6,!0],0,"year");An("year","y");On("year",1);fe("Y",mg);fe("YY",Tt,wr);fe("YYYY",Vv,Wv);fe("YYYYY",gg,dg);fe("YYYYYY",gg,dg);mt(["YYYYY","YYYYYY"],Rn);mt("YYYY",function(t,e){e[Rn]=t.length===2?X.parseTwoDigitYear(t):Qe(t)});mt("YY",function(t,e){e[Rn]=X.parseTwoDigitYear(t)});mt("Y",function(t,e){e[Rn]=parseInt(t,10)});function Xu(t){return hg(t)?366:365}X.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var vI=$l("FullYear",!0);function dB(){return hg(this.year())}function fB(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function wc(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function mf(t,e,n){var r=7+e-n,i=(7+wc(t,0,r).getUTCDay()-e)%7;return-i+r-1}function SI(t,e,n,r,i){var o=(7+n-r)%7,s=mf(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=Xu(l)+a):a>Xu(t)?(l=t+1,u=a-Xu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Cc(t,e,n){var r=mf(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+po(s,e,n)):i>po(t.year(),e,n)?(o=i-po(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function po(t,e,n){var r=mf(t,e,n),i=mf(t+1,e,n);return(Xu(t)-r+i)/7}Te("w",["ww",2],"wo","week");Te("W",["WW",2],"Wo","isoWeek");An("week","w");An("isoWeek","W");On("week",5);On("isoWeek",5);fe("w",Tt);fe("ww",Tt,wr);fe("W",Tt);fe("WW",Tt,wr);Wc(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Qe(t)});function gB(t){return Cc(t,this._week.dow,this._week.doy).week}var mB={dow:0,doy:6};function pB(){return this._week.dow}function wB(){return this._week.doy}function CB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function vB(t){var e=Cc(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Te("d",0,"do","day");Te("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Te("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Te("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Te("e",0,0,"weekday");Te("E",0,0,"isoWeekday");An("day","d");An("weekday","e");An("isoWeekday","E");On("day",11);On("weekday",11);On("isoWeekday",11);fe("d",Tt);fe("e",Tt);fe("E",Tt);fe("dd",function(t,e){return e.weekdaysMinRegex(t)});fe("ddd",function(t,e){return e.weekdaysShortRegex(t)});fe("dddd",function(t,e){return e.weekdaysRegex(t)});Wc(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ge(n).invalidWeekday=t});Wc(["d","e","E"],function(t,e,n,r){e[r]=Qe(t)});function SB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function yB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Bv(t,e){return t.slice(e,7).concat(t.slice(0,e))}var bB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),yI="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),RB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),EB=Fc,TB=Fc,_B=Fc;function MB(t,e){var n=ri(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Bv(n,this._week.dow):t?n[t.day()]:n}function AB(t){return t===!0?Bv(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function OB(t){return t===!0?Bv(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function IB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=$i([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1||(i=zt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=zt.call(this._minWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function PB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return IB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=$i([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function xB(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=SB(t,this.localeData()),this.add(t-e,"d")):e}function HB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function DB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=yB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function NB(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||Uv.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(st(this,"_weekdaysRegex")||(this._weekdaysRegex=EB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function LB(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||Uv.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(st(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=TB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function $B(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||Uv.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(st(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=_B),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Uv(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=$i([2e3,1]).day(o),a=gr(this.weekdaysMin(s,"")),l=gr(this.weekdaysShort(s,"")),u=gr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Yv(){return this.hours()%12||12}function kB(){return this.hours()||24}Te("H",["HH",2],0,"hour");Te("h",["hh",2],0,Yv);Te("k",["kk",2],0,kB);Te("hmm",0,0,function(){return""+Yv.apply(this)+Di(this.minutes(),2)});Te("hmmss",0,0,function(){return""+Yv.apply(this)+Di(this.minutes(),2)+Di(this.seconds(),2)});Te("Hmm",0,0,function(){return""+this.hours()+Di(this.minutes(),2)});Te("Hmmss",0,0,function(){return""+this.hours()+Di(this.minutes(),2)+Di(this.seconds(),2)});function bI(t,e){Te(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}bI("a",!0);bI("A",!1);An("hour","h");On("hour",13);function RI(t,e){return e._meridiemParse}fe("a",RI);fe("A",RI);fe("H",Tt);fe("h",Tt);fe("k",Tt);fe("HH",Tt,wr);fe("hh",Tt,wr);fe("kk",Tt,wr);fe("hmm",dI);fe("hmmss",fI);fe("Hmm",dI);fe("Hmmss",fI);mt(["H","HH"],tn);mt(["k","kk"],function(t,e,n){var r=Qe(t);e[tn]=r===24?0:r});mt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});mt(["h","hh"],function(t,e,n){e[tn]=Qe(t),Ge(n).bigHour=!0});mt("hmm",function(t,e,n){var r=t.length-2;e[tn]=Qe(t.substr(0,r)),e[Qr]=Qe(t.substr(r)),Ge(n).bigHour=!0});mt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[tn]=Qe(t.substr(0,r)),e[Qr]=Qe(t.substr(r,2)),e[lo]=Qe(t.substr(i)),Ge(n).bigHour=!0});mt("Hmm",function(t,e,n){var r=t.length-2;e[tn]=Qe(t.substr(0,r)),e[Qr]=Qe(t.substr(r))});mt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[tn]=Qe(t.substr(0,r)),e[Qr]=Qe(t.substr(r,2)),e[lo]=Qe(t.substr(i))});function FB(t){return(t+"").toLowerCase().charAt(0)==="p"}var WB=/[ap]\.?m?\.?/i,VB=$l("Hours",!0);function BB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var EI={calendar:PV,longDateFormat:NV,invalidDate:$V,ordinal:FV,dayOfMonthOrdinalParse:WV,relativeTime:BV,months:nB,monthsShort:gI,week:mB,weekdays:bB,weekdaysMin:RB,weekdaysShort:yI,meridiemParse:WB},It={},Zl={},vc;function UB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function d0(t){return t&&t.toLowerCase().replace("_","-")}function YB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=d0(t[e]).split("-"),n=o.length,r=d0(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Cg(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&UB(o,r)>=n-1)break;n--}e++}return vc}function GB(t){return t.match("^[^/\\\\]*$")!=null}function Cg(t){var e=null,n;if(It[t]===void 0&&typeof af<"u"&&af&&af.exports&&GB(t))try{e=vc._abbr,n=require,n("./locale/"+t),is(e)}catch{It[t]=null}return It[t]}function is(t,e){var n;return t&&(Jn(e)?n=bo(t):n=Gv(t,e),n?vc=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),vc._abbr}function Gv(t,e){if(e!==null){var n,r=EI;if(e.abbr=t,It[t]!=null)sI("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=It[t]._config;else if(e.parentLocale!=null)if(It[e.parentLocale]!=null)r=It[e.parentLocale]._config;else if(n=Cg(e.parentLocale),n!=null)r=n._config;else return Zl[e.parentLocale]||(Zl[e.parentLocale]=[]),Zl[e.parentLocale].push({name:t,config:e}),null;return It[t]=new $v(lC(r,e)),Zl[t]&&Zl[t].forEach(function(i){Gv(i.name,i.config)}),is(t),It[t]}else return delete It[t],null}function zB(t,e){if(e!=null){var n,r,i=EI;It[t]!=null&&It[t].parentLocale!=null?It[t].set(lC(It[t]._config,e)):(r=Cg(t),r!=null&&(i=r._config),e=lC(i,e),r==null&&(e.abbr=t),n=new $v(e),n.parentLocale=It[t],It[t]=n),is(t)}else It[t]!=null&&(It[t].parentLocale!=null?(It[t]=It[t].parentLocale,t===is()&&is(t)):It[t]!=null&&delete It[t]);return It[t]}function bo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return vc;if(!ri(t)){if(e=Cg(t),e)return e;t=[t]}return YB(t)}function jB(){return uC(It)}function zv(t){var e,n=t._a;return n&&Ge(t).overflow===-2&&(e=n[ao]<0||n[ao]>11?ao:n[Ai]<1||n[Ai]>wg(n[Rn],n[ao])?Ai:n[tn]<0||n[tn]>24||n[tn]===24&&(n[Qr]!==0||n[lo]!==0||n[na]!==0)?tn:n[Qr]<0||n[Qr]>59?Qr:n[lo]<0||n[lo]>59?lo:n[na]<0||n[na]>999?na:-1,Ge(t)._overflowDayOfYear&&(e<Rn||e>Ai)&&(e=Ai),Ge(t)._overflowWeeks&&e===-1&&(e=QV),Ge(t)._overflowWeekday&&e===-1&&(e=eB),Ge(t).overflow=e),t}var KB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,XB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,qB=/Z|[+-]\d\d(?::?\d\d)?/,fh=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],km=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ZB=/^\/?Date\((-?\d+)/i,JB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,QB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function TI(t){var e,n,r=t._i,i=KB.exec(r)||XB.exec(r),o,s,a,l,u=fh.length,c=km.length;if(i){for(Ge(t).iso=!0,e=0,n=u;e<n;e++)if(fh[e][1].exec(i[1])){s=fh[e][0],o=fh[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(km[e][1].exec(i[3])){a=(i[2]||" ")+km[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(qB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Kv(t)}else t._isValid=!1}function e2(t,e,n,r,i,o){var s=[t2(t),gI.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function t2(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function n2(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function r2(t,e,n){if(t){var r=yI.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ge(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function i2(t,e,n){if(t)return QB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function _I(t){var e=JB.exec(n2(t._i)),n;if(e){if(n=e2(e[4],e[3],e[2],e[5],e[6],e[7]),!r2(e[1],n,t))return;t._a=n,t._tzm=i2(e[8],e[9],e[10]),t._d=wc.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ge(t).rfc2822=!0}else t._isValid=!1}function o2(t){var e=ZB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(TI(t),t._isValid===!1)delete t._isValid;else return;if(_I(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:X.createFromInputFallback(t)}X.createFromInputFallback=Dr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function gl(t,e,n){return t??e??n}function s2(t){var e=new Date(X.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function jv(t){var e,n,r=[],i,o,s;if(!t._d){for(i=s2(t),t._w&&t._a[Ai]==null&&t._a[ao]==null&&a2(t),t._dayOfYear!=null&&(s=gl(t._a[Rn],i[Rn]),(t._dayOfYear>Xu(s)||t._dayOfYear===0)&&(Ge(t)._overflowDayOfYear=!0),n=wc(s,0,t._dayOfYear),t._a[ao]=n.getUTCMonth(),t._a[Ai]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[tn]===24&&t._a[Qr]===0&&t._a[lo]===0&&t._a[na]===0&&(t._nextDay=!0,t._a[tn]=0),t._d=(t._useUTC?wc:fB).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[tn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ge(t).weekdayMismatch=!0)}}function a2(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=gl(e.GG,t._a[Rn],Cc(Et(),1,4).year),r=gl(e.W,1),i=gl(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Cc(Et(),o,s),n=gl(e.gg,t._a[Rn],u.year),r=gl(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>po(n,o,s)?Ge(t)._overflowWeeks=!0:l!=null?Ge(t)._overflowWeekday=!0:(a=SI(n,r,i,o,s),t._a[Rn]=a.year,t._dayOfYear=a.dayOfYear)}X.ISO_8601=function(){};X.RFC_2822=function(){};function Kv(t){if(t._f===X.ISO_8601){TI(t);return}if(t._f===X.RFC_2822){_I(t);return}t._a=[],Ge(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=aI(t._f,t._locale).match(kv)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(qV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ge(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Rl[o]?(r?Ge(t).empty=!1:Ge(t).unusedTokens.push(o),JV(o,r,t)):t._strict&&!r&&Ge(t).unusedTokens.push(o);Ge(t).charsLeftOver=a-l,e.length>0&&Ge(t).unusedInput.push(e),t._a[tn]<=12&&Ge(t).bigHour===!0&&t._a[tn]>0&&(Ge(t).bigHour=void 0),Ge(t).parsedDateParts=t._a.slice(0),Ge(t).meridiem=t._meridiem,t._a[tn]=l2(t._locale,t._a[tn],t._meridiem),u=Ge(t).era,u!==null&&(t._a[Rn]=t._locale.erasConvertYear(u,t._a[Rn])),jv(t),zv(t)}function l2(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function u2(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ge(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Lv({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Kv(e),Nv(e)&&(s=!0),o+=Ge(e).charsLeftOver,o+=Ge(e).unusedTokens.length*10,Ge(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Jo(t,n||e)}function c2(t){if(!t._d){var e=Fv(t._i),n=e.day===void 0?e.date:e.day;t._a=iI([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),jv(t)}}function h2(t){var e=new kc(zv(MI(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function MI(t){var e=t._i,n=t._f;return t._locale=t._locale||bo(t._l),e===null||n===void 0&&e===""?cg({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ii(e)?new kc(zv(e)):($c(e)?t._d=e:ri(n)?u2(t):n?Kv(t):d2(t),Nv(t)||(t._d=null),t))}function d2(t){var e=t._i;Jn(e)?t._d=new Date(X.now()):$c(e)?t._d=new Date(e.valueOf()):typeof e=="string"?o2(t):ri(e)?(t._a=iI(e.slice(0),function(n){return parseInt(n,10)}),jv(t)):ua(e)?c2(t):wo(e)?t._d=new Date(e):X.createFromInputFallback(t)}function AI(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ua(t)&&Dv(t)||ri(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,h2(o)}function Et(t,e,n,r){return AI(t,e,n,r,!1)}var f2=Dr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:cg()}),g2=Dr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:cg()});function OI(t,e){var n,r;if(e.length===1&&ri(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function m2(){var t=[].slice.call(arguments,0);return OI("isBefore",t)}function p2(){var t=[].slice.call(arguments,0);return OI("isAfter",t)}var w2=function(){return Date.now?Date.now():+new Date},Jl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function C2(t){var e,n=!1,r,i=Jl.length;for(e in t)if(st(t,e)&&!(zt.call(Jl,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Jl[r]]){if(n)return!1;parseFloat(t[Jl[r]])!==Qe(t[Jl[r]])&&(n=!0)}return!0}function v2(){return this._isValid}function S2(){return si(NaN)}function vg(t){var e=Fv(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=C2(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=bo(),this._bubble()}function kd(t){return t instanceof vg}function hC(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function y2(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&Qe(t[s])!==Qe(e[s]))&&o++;return o+i}function II(t,e){Te(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Di(~~(n/60),2)+e+Di(~~n%60,2)})}II("Z",":");II("ZZ","");fe("Z",pg);fe("ZZ",pg);mt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Xv(pg,t)});var b2=/([\+\-]|\d\d)/gi;function Xv(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(b2)||["-",0,0],o=+(i[1]*60)+Qe(i[2]),o===0?0:i[0]==="+"?o:-o)}function qv(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ii(t)||$c(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),X.updateOffset(n,!1),n):Et(t).local()}function dC(t){return-Math.round(t._d.getTimezoneOffset())}X.updateOffset=function(){};function R2(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Xv(pg,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=dC(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?HI(this,si(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,X.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:dC(this)}function E2(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function T2(t){return this.utcOffset(0,t)}function _2(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(dC(this),"m")),this}function M2(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Xv(KV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function A2(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function O2(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function I2(){if(!Jn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Lv(t,this),t=MI(t),t._a?(e=t._isUTC?$i(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&y2(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function P2(){return this.isValid()?!this._isUTC:!1}function x2(){return this.isValid()?this._isUTC:!1}function PI(){return this.isValid()?this._isUTC&&this._offset===0:!1}var H2=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,D2=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function si(t,e){var n=t,r=null,i,o,s;return kd(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:wo(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=H2.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Qe(r[Ai])*i,h:Qe(r[tn])*i,m:Qe(r[Qr])*i,s:Qe(r[lo])*i,ms:Qe(hC(r[na]*1e3))*i}):(r=D2.exec(t))?(i=r[1]==="-"?-1:1,n={y:Ts(r[2],i),M:Ts(r[3],i),w:Ts(r[4],i),d:Ts(r[5],i),h:Ts(r[6],i),m:Ts(r[7],i),s:Ts(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=N2(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new vg(n),kd(t)&&st(t,"_locale")&&(o._locale=t._locale),kd(t)&&st(t,"_isValid")&&(o._isValid=t._isValid),o}si.fn=vg.prototype;si.invalid=S2;function Ts(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function f0(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function N2(t,e){var n;return t.isValid()&&e.isValid()?(e=qv(e,t),t.isBefore(e)?n=f0(t,e):(n=f0(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function xI(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(sI(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=si(n,r),HI(this,i,t),this}}function HI(t,e,n,r){var i=e._milliseconds,o=hC(e._days),s=hC(e._months);t.isValid()&&(r=r??!0,s&&pI(t,ff(t,"Month")+s*n),o&&uI(t,"Date",ff(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&X.updateOffset(t,o||s))}var L2=xI(1,"add"),$2=xI(-1,"subtract");function DI(t){return typeof t=="string"||t instanceof String}function k2(t){return ii(t)||$c(t)||DI(t)||wo(t)||W2(t)||F2(t)||t===null||t===void 0}function F2(t){var e=ua(t)&&!Dv(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||st(t,o);return e&&n}function W2(t){var e=ri(t),n=!1;return e&&(n=t.filter(function(r){return!wo(r)&&DI(t)}).length===0),e&&n}function V2(t){var e=ua(t)&&!Dv(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||st(t,o);return e&&n}function B2(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function U2(t,e){arguments.length===1&&(arguments[0]?k2(arguments[0])?(t=arguments[0],e=void 0):V2(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=qv(n,this).startOf("day"),i=X.calendarFormat(this,r)||"sameElse",o=e&&(ki(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function Y2(){return new kc(this)}function G2(t,e){var n=ii(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Nr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function z2(t,e){var n=ii(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Nr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function j2(t,e,n,r){var i=ii(t)?t:Et(t),o=ii(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function K2(t,e){var n=ii(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=Nr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function X2(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function q2(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function Z2(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=qv(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Nr(e),e){case"year":o=Fd(this,r)/12;break;case"month":o=Fd(this,r);break;case"quarter":o=Fd(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Or(o)}function Fd(t,e){if(t.date()<e.date())return-Fd(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}X.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";X.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function J2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Q2(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?$d(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ki(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",$d(n,"Z")):$d(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function eU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function tU(t){t||(t=this.isUtc()?X.defaultFormatUtc:X.defaultFormat);var e=$d(this,t);return this.localeData().postformat(e)}function nU(t,e){return this.isValid()&&(ii(t)&&t.isValid()||Et(t).isValid())?si({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function rU(t){return this.from(Et(),t)}function iU(t,e){return this.isValid()&&(ii(t)&&t.isValid()||Et(t).isValid())?si({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function oU(t){return this.to(Et(),t)}function NI(t){var e;return t===void 0?this._locale._abbr:(e=bo(t),e!=null&&(this._locale=e),this)}var LI=Dr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function $I(){return this._locale}var pf=1e3,El=60*pf,wf=60*El,kI=(365*400+97)*24*wf;function Tl(t,e){return(t%e+e)%e}function FI(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-kI:new Date(t,e,n).valueOf()}function WI(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-kI:Date.UTC(t,e,n)}function sU(t){var e,n;if(t=Nr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?WI:FI,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Tl(e+(this._isUTC?0:this.utcOffset()*El),wf);break;case"minute":e=this._d.valueOf(),e-=Tl(e,El);break;case"second":e=this._d.valueOf(),e-=Tl(e,pf);break}return this._d.setTime(e),X.updateOffset(this,!0),this}function aU(t){var e,n;if(t=Nr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?WI:FI,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=wf-Tl(e+(this._isUTC?0:this.utcOffset()*El),wf)-1;break;case"minute":e=this._d.valueOf(),e+=El-Tl(e,El)-1;break;case"second":e=this._d.valueOf(),e+=pf-Tl(e,pf)-1;break}return this._d.setTime(e),X.updateOffset(this,!0),this}function lU(){return this._d.valueOf()-(this._offset||0)*6e4}function uU(){return Math.floor(this.valueOf()/1e3)}function cU(){return new Date(this.valueOf())}function hU(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function dU(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function fU(){return this.isValid()?this.toISOString():null}function gU(){return Nv(this)}function mU(){return Jo({},Ge(this))}function pU(){return Ge(this).overflow}function wU(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Te("N",0,0,"eraAbbr");Te("NN",0,0,"eraAbbr");Te("NNN",0,0,"eraAbbr");Te("NNNN",0,0,"eraName");Te("NNNNN",0,0,"eraNarrow");Te("y",["y",1],"yo","eraYear");Te("y",["yy",2],0,"eraYear");Te("y",["yyy",3],0,"eraYear");Te("y",["yyyy",4],0,"eraYear");fe("N",Zv);fe("NN",Zv);fe("NNN",Zv);fe("NNNN",AU);fe("NNNNN",OU);mt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ge(n).era=i:Ge(n).invalidEra=t});fe("y",kl);fe("yy",kl);fe("yyy",kl);fe("yyyy",kl);fe("yo",IU);mt(["y","yy","yyy","yyyy"],Rn);mt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Rn]=n._locale.eraYearOrdinalParse(t,i):e[Rn]=parseInt(t,10)});function CU(t,e){var n,r,i,o=this._eras||bo("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=X(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=X(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function vU(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function SU(t,e){var n=t.since<=t.until?1:-1;return e===void 0?X(t.since).year():X(t.since).year()+(e-t.offset)*n}function yU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function bU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function RU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function EU(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-X(i[t].since).year())*n+i[t].offset;return this.year()}function TU(t){return st(this,"_erasNameRegex")||Jv.call(this),t?this._erasNameRegex:this._erasRegex}function _U(t){return st(this,"_erasAbbrRegex")||Jv.call(this),t?this._erasAbbrRegex:this._erasRegex}function MU(t){return st(this,"_erasNarrowRegex")||Jv.call(this),t?this._erasNarrowRegex:this._erasRegex}function Zv(t,e){return e.erasAbbrRegex(t)}function AU(t,e){return e.erasNameRegex(t)}function OU(t,e){return e.erasNarrowRegex(t)}function IU(t,e){return e._eraYearOrdinalRegex||kl}function Jv(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(gr(s[i].name)),t.push(gr(s[i].abbr)),n.push(gr(s[i].narrow)),r.push(gr(s[i].name)),r.push(gr(s[i].abbr)),r.push(gr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Te(0,["gg",2],0,function(){return this.weekYear()%100});Te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Sg(t,e){Te(0,[t,t.length],0,e)}Sg("gggg","weekYear");Sg("ggggg","weekYear");Sg("GGGG","isoWeekYear");Sg("GGGGG","isoWeekYear");An("weekYear","gg");An("isoWeekYear","GG");On("weekYear",1);On("isoWeekYear",1);fe("G",mg);fe("g",mg);fe("GG",Tt,wr);fe("gg",Tt,wr);fe("GGGG",Vv,Wv);fe("gggg",Vv,Wv);fe("GGGGG",gg,dg);fe("ggggg",gg,dg);Wc(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Qe(t)});Wc(["gg","GG"],function(t,e,n,r){e[r]=X.parseTwoDigitYear(t)});function PU(t){return VI.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function xU(t){return VI.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function HU(){return po(this.year(),1,4)}function DU(){return po(this.isoWeekYear(),1,4)}function NU(){var t=this.localeData()._week;return po(this.year(),t.dow,t.doy)}function LU(){var t=this.localeData()._week;return po(this.weekYear(),t.dow,t.doy)}function VI(t,e,n,r,i){var o;return t==null?Cc(this,r,i).year:(o=po(t,r,i),e>o&&(e=o),$U.call(this,t,e,n,r,i))}function $U(t,e,n,r,i){var o=SI(t,e,n,r,i),s=wc(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Te("Q",0,"Qo","quarter");An("quarter","Q");On("quarter",7);fe("Q",cI);mt("Q",function(t,e){e[ao]=(Qe(t)-1)*3});function kU(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Te("D",["DD",2],"Do","date");An("date","D");On("date",9);fe("D",Tt);fe("DD",Tt,wr);fe("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});mt(["D","DD"],Ai);mt("Do",function(t,e){e[Ai]=Qe(t.match(Tt)[0])});var BI=$l("Date",!0);Te("DDD",["DDDD",3],"DDDo","dayOfYear");An("dayOfYear","DDD");On("dayOfYear",4);fe("DDD",fg);fe("DDDD",hI);mt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function FU(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Te("m",["mm",2],0,"minute");An("minute","m");On("minute",14);fe("m",Tt);fe("mm",Tt,wr);mt(["m","mm"],Qr);var WU=$l("Minutes",!1);Te("s",["ss",2],0,"second");An("second","s");On("second",15);fe("s",Tt);fe("ss",Tt,wr);mt(["s","ss"],lo);var VU=$l("Seconds",!1);Te("S",0,0,function(){return~~(this.millisecond()/100)});Te(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Te(0,["SSS",3],0,"millisecond");Te(0,["SSSS",4],0,function(){return this.millisecond()*10});Te(0,["SSSSS",5],0,function(){return this.millisecond()*100});Te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});An("millisecond","ms");On("millisecond",16);fe("S",fg,cI);fe("SS",fg,wr);fe("SSS",fg,hI);var Qo,UI;for(Qo="SSSS";Qo.length<=9;Qo+="S")fe(Qo,kl);function BU(t,e){e[na]=Qe(("0."+t)*1e3)}for(Qo="S";Qo.length<=9;Qo+="S")mt(Qo,BU);UI=$l("Milliseconds",!1);Te("z",0,0,"zoneAbbr");Te("zz",0,0,"zoneName");function UU(){return this._isUTC?"UTC":""}function YU(){return this._isUTC?"Coordinated Universal Time":""}var J=kc.prototype;J.add=L2;J.calendar=U2;J.clone=Y2;J.diff=Z2;J.endOf=aU;J.format=tU;J.from=nU;J.fromNow=rU;J.to=iU;J.toNow=oU;J.get=zV;J.invalidAt=pU;J.isAfter=G2;J.isBefore=z2;J.isBetween=j2;J.isSame=K2;J.isSameOrAfter=X2;J.isSameOrBefore=q2;J.isValid=gU;J.lang=LI;J.locale=NI;J.localeData=$I;J.max=g2;J.min=f2;J.parsingFlags=mU;J.set=jV;J.startOf=sU;J.subtract=$2;J.toArray=hU;J.toObject=dU;J.toDate=cU;J.toISOString=Q2;J.inspect=eU;typeof Symbol<"u"&&Symbol.for!=null&&(J[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});J.toJSON=fU;J.toString=J2;J.unix=uU;J.valueOf=lU;J.creationData=wU;J.eraName=yU;J.eraNarrow=bU;J.eraAbbr=RU;J.eraYear=EU;J.year=vI;J.isLeapYear=dB;J.weekYear=PU;J.isoWeekYear=xU;J.quarter=J.quarters=kU;J.month=wI;J.daysInMonth=uB;J.week=J.weeks=CB;J.isoWeek=J.isoWeeks=vB;J.weeksInYear=NU;J.weeksInWeekYear=LU;J.isoWeeksInYear=HU;J.isoWeeksInISOWeekYear=DU;J.date=BI;J.day=J.days=xB;J.weekday=HB;J.isoWeekday=DB;J.dayOfYear=FU;J.hour=J.hours=VB;J.minute=J.minutes=WU;J.second=J.seconds=VU;J.millisecond=J.milliseconds=UI;J.utcOffset=R2;J.utc=T2;J.local=_2;J.parseZone=M2;J.hasAlignedHourOffset=A2;J.isDST=O2;J.isLocal=P2;J.isUtcOffset=x2;J.isUtc=PI;J.isUTC=PI;J.zoneAbbr=UU;J.zoneName=YU;J.dates=Dr("dates accessor is deprecated. Use date instead.",BI);J.months=Dr("months accessor is deprecated. Use month instead",wI);J.years=Dr("years accessor is deprecated. Use year instead",vI);J.zone=Dr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",E2);J.isDSTShifted=Dr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",I2);function GU(t){return Et(t*1e3)}function zU(){return Et.apply(null,arguments).parseZone()}function YI(t){return t}var at=$v.prototype;at.calendar=xV;at.longDateFormat=LV;at.invalidDate=kV;at.ordinal=VV;at.preparse=YI;at.postformat=YI;at.relativeTime=UV;at.pastFuture=YV;at.set=IV;at.eras=CU;at.erasParse=vU;at.erasConvertYear=SU;at.erasAbbrRegex=_U;at.erasNameRegex=TU;at.erasNarrowRegex=MU;at.months=oB;at.monthsShort=sB;at.monthsParse=lB;at.monthsRegex=hB;at.monthsShortRegex=cB;at.week=gB;at.firstDayOfYear=wB;at.firstDayOfWeek=pB;at.weekdays=MB;at.weekdaysMin=OB;at.weekdaysShort=AB;at.weekdaysParse=PB;at.weekdaysRegex=NB;at.weekdaysShortRegex=LB;at.weekdaysMinRegex=$B;at.isPM=FB;at.meridiem=BB;function Cf(t,e,n,r){var i=bo(),o=$i().set(r,e);return i[n](o,t)}function GI(t,e,n){if(wo(t)&&(e=t,t=void 0),t=t||"",e!=null)return Cf(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Cf(t,r,n,"month");return i}function Qv(t,e,n,r){typeof t=="boolean"?(wo(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,wo(e)&&(n=e,e=void 0),e=e||"");var i=bo(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Cf(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Cf(e,(s+o)%7,r,"day");return a}function jU(t,e){return GI(t,e,"months")}function KU(t,e){return GI(t,e,"monthsShort")}function XU(t,e,n){return Qv(t,e,n,"weekdays")}function qU(t,e,n){return Qv(t,e,n,"weekdaysShort")}function ZU(t,e,n){return Qv(t,e,n,"weekdaysMin")}is("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});X.lang=Dr("moment.lang is deprecated. Use moment.locale instead.",is);X.langData=Dr("moment.langData is deprecated. Use moment.localeData instead.",bo);var Bi=Math.abs;function JU(){var t=this._data;return this._milliseconds=Bi(this._milliseconds),this._days=Bi(this._days),this._months=Bi(this._months),t.milliseconds=Bi(t.milliseconds),t.seconds=Bi(t.seconds),t.minutes=Bi(t.minutes),t.hours=Bi(t.hours),t.months=Bi(t.months),t.years=Bi(t.years),this}function zI(t,e,n,r){var i=si(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function QU(t,e){return zI(this,t,e,1)}function eY(t,e){return zI(this,t,e,-1)}function g0(t){return t<0?Math.floor(t):Math.ceil(t)}function tY(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=g0(fC(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Or(t/1e3),r.seconds=i%60,o=Or(i/60),r.minutes=o%60,s=Or(o/60),r.hours=s%24,e+=Or(s/24),l=Or(jI(e)),n+=l,e-=g0(fC(l)),a=Or(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function jI(t){return t*4800/146097}function fC(t){return t*146097/4800}function nY(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Nr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+jI(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(fC(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function rY(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function Ro(t){return function(){return this.as(t)}}var iY=Ro("ms"),oY=Ro("s"),sY=Ro("m"),aY=Ro("h"),lY=Ro("d"),uY=Ro("w"),cY=Ro("M"),hY=Ro("Q"),dY=Ro("y");function fY(){return si(this)}function gY(t){return t=Nr(t),this.isValid()?this[t+"s"]():NaN}function Ca(t){return function(){return this.isValid()?this._data[t]:NaN}}var mY=Ca("milliseconds"),pY=Ca("seconds"),wY=Ca("minutes"),CY=Ca("hours"),vY=Ca("days"),SY=Ca("months"),yY=Ca("years");function bY(){return Or(this.days()/7)}var no=Math.round,vl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function RY(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function EY(t,e,n,r){var i=si(t).abs(),o=no(i.as("s")),s=no(i.as("m")),a=no(i.as("h")),l=no(i.as("d")),u=no(i.as("M")),c=no(i.as("w")),h=no(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,RY.apply(null,d)}function TY(t){return t===void 0?no:typeof t=="function"?(no=t,!0):!1}function _Y(t,e){return vl[t]===void 0?!1:e===void 0?vl[t]:(vl[t]=e,t==="s"&&(vl.ss=e-1),!0)}function MY(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=vl,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},vl,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=EY(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Fm=Math.abs;function Ta(t){return(t>0)-(t<0)||+t}function yg(){if(!this.isValid())return this.localeData().invalidDate();var t=Fm(this._milliseconds)/1e3,e=Fm(this._days),n=Fm(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Or(t/60),i=Or(r/60),t%=60,r%=60,o=Or(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Ta(this._months)!==Ta(a)?"-":"",c=Ta(this._days)!==Ta(a)?"-":"",h=Ta(this._milliseconds)!==Ta(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var nt=vg.prototype;nt.isValid=v2;nt.abs=JU;nt.add=QU;nt.subtract=eY;nt.as=nY;nt.asMilliseconds=iY;nt.asSeconds=oY;nt.asMinutes=sY;nt.asHours=aY;nt.asDays=lY;nt.asWeeks=uY;nt.asMonths=cY;nt.asQuarters=hY;nt.asYears=dY;nt.valueOf=rY;nt._bubble=tY;nt.clone=fY;nt.get=gY;nt.milliseconds=mY;nt.seconds=pY;nt.minutes=wY;nt.hours=CY;nt.days=vY;nt.weeks=bY;nt.months=SY;nt.years=yY;nt.humanize=MY;nt.toISOString=yg;nt.toString=yg;nt.toJSON=yg;nt.locale=NI;nt.localeData=$I;nt.toIsoString=Dr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",yg);nt.lang=LI;Te("X",0,0,"unix");Te("x",0,0,"valueOf");fe("x",mg);fe("X",XV);mt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});mt("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
X.version="2.29.4";AV(Et);X.fn=J;X.min=m2;X.max=p2;X.now=w2;X.utc=$i;X.unix=GU;X.months=jU;X.isDate=$c;X.locale=is;X.invalid=cg;X.duration=si;X.isMoment=ii;X.weekdays=XU;X.parseZone=zU;X.localeData=bo;X.isDuration=kd;X.monthsShort=KU;X.weekdaysMin=ZU;X.defineLocale=Gv;X.updateLocale=zB;X.locales=jB;X.weekdaysShort=qU;X.normalizeUnits=Nr;X.relativeTimeRounding=TY;X.relativeTimeThreshold=_Y;X.calendarFormat=B2;X.prototype=J;X.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function KI(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function gC(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function qu(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Yt(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function pr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function E(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function XI(t){return Yt(t,(e,n)=>e+n,0)}function AY(t){return Yt(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function OY(t){return Yt(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function IY(t){return t.length?XI(t)/t.length:0}function qI(t){return Yt(t,(e,n)=>e.concat(Array.isArray(n)?qI(n):n),[])}function eS(t){const e=[];return E(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function mC(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return E(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function PY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return E(i,s=>{o=o.filter(a=>s.includes(a))}),o}function xY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return E(i,s=>{E(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function pC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const HY=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:IY,arrayEach:E,arrayFilter:pr,arrayFlatten:qI,arrayMap:Ue,arrayMax:AY,arrayMin:OY,arrayReduce:Yt,arraySum:XI,arrayUnique:eS,extendArray:gC,getDifferenceOfArrays:mC,getIntersectionOfArrays:PY,getUnionOfArrays:xY,pivot:qu,stringToArray:pC,to2dArray:KI},Symbol.toStringTag,{value:"Module"}));function ht(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yt(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Wt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function vt(t){return typeof t>"u"}function Zt(t){return t===null||t===""||vt(t)}function ZI(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Vu="length",Zu=t=>parseInt(t,16),m0=t=>parseInt(t,10),vf=(t,e,n)=>t.substr(e,n),Ju=t=>t.codePointAt(0)-65,wC=t=>`${t}`.replace(/\-/g,""),DY=t=>Zu(vf(wC(t),Zu("12"),Ju("F")))/(Zu(vf(wC(t),Ju("B"),~~![][Vu]))||9),NY=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let p0=!1;const w0={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},C0={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function JI(t,e){const n=!Zt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.1.0";let o,s="invalid",a="invalid";t=wC(t||"");const l=LY(t);if(n||r||l)if(l){const u=X("16/01/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=DY(t);o=X((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(NY()&&(s="valid",a="valid"),!p0&&s!=="valid"&&(w0[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](w0[s]({keyValidityDate:o,hotVersion:i})),p0=!0),a!=="valid"&&e.parentNode&&C0[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=C0[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function LY(t){let e=[][Vu],n=e;if(t[Vu]!==Ju("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Ju(i.shift());o;o=Ju(i.shift()||"A"))--o<""[Vu]?n=n|(m0(`${m0(Zu(r)+(Zu(vf(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=vf(t,o,o?i[Vu]===1?9:8:6);return n===e}const $Y=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:JI,isDefined:ue,isEmpty:Zt,isRegExp:ZI,isUndefined:vt,stringify:Wt},Symbol.toStringTag,{value:"Module"}));function En(t){return t[0].toUpperCase()+t.substr(1)}function kY(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Wt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function tS(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function nS(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function rS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function CC(t){return bg(`${t}`,{ALLOWED_TAGS:[]})}function bg(t,e){return MV.sanitize(t,e)}const FY=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:kY,isPercentValue:nS,randomString:tS,sanitize:bg,stripTags:CC,substitute:rS,toUpperCaseFirst:En},Symbol.toStringTag,{value:"Module"})),Fl=t=>["tabindex",t],WY=()=>["role","treegrid"],Pi=()=>["role","presentation"],VY=()=>["role","gridcell"],BY=()=>["role","rowheader"],QI=()=>["role","rowgroup"],UY=()=>["role","columnheader"],vC=()=>["role","row"],YY=()=>["role","menu"],GY=()=>["role","menuitem"],zY=()=>["role","combobox"],eP=()=>["role","listbox"],jY=()=>["role","option"],KY=()=>["role","checkbox"],XY=()=>["scope","col"],qY=()=>["scope","row"],ZY=()=>["type","text"],iS=t=>["aria-label",t],Eo=()=>["aria-hidden","true"],JY=()=>["aria-disabled","true"],QY=()=>["aria-multiselectable","true"],tP=t=>["aria-haspopup",t],nP=t=>["aria-rowcount",t],Rg=t=>["aria-colcount",t],rP=t=>["aria-rowindex",t],oS=t=>["aria-colindex",t],Ir=t=>["aria-expanded",t],eG=t=>["aria-sort",t],v0=()=>["aria-readonly","true"],S0=()=>["aria-invalid","true"],tG=t=>["aria-checked",t],sS=()=>["aria-selected","true"],nG=()=>["aria-autocomplete","list"],rG=t=>["aria-controls",t],iG=t=>["aria-activedescendant",t],oG=t=>["aria-live",t],sG=t=>["aria-relevant",t],aG=t=>["aria-setsize",t],lG=t=>["aria-posinset",t];function iP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function oP(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function sP(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Sc(t){return sP(t)&&t.parent}function uG(t){return!!Object.getPrototypeOf(t.parent)}function cs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Bu(t,e,n){const r=[];let i=t;for(;i&&(i=cs(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function os(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function aP(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Uo(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function lP(t){return!t||!t.length?[]:t.filter(e=>!!e)}function uP(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function Ie(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=lP(e),e.length>0&&t.classList.add(...e)}function Le(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=uP(e,!0);n=lP(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function va(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=uP(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function aS(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)aS(e[n])}}function oi(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const cP=/(<(.*)>|&(.*);)/;function Sa(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;cP.test(e)?t.innerHTML=n?bg(e):e:hs(t,e)}function hs(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(oi(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ds(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return ds(n.host.impl);if(n.host)return ds(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(Co(n).display==="none")return!1;n=n.parentNode}return!0}function en(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function lS(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Eg(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Tg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?lS(e):t.scrollTop}function uS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Eg(e):t.scrollLeft}function yc(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function ca(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=Co(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Il(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=Co(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function cG(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Co(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ft(t){return t.offsetWidth}function xt(t){return t.offsetHeight}function ra(t){return t.clientHeight||t.innerHeight}function cS(t){return t.clientWidth||t.innerWidth}function hG(t,e,n){t.addEventListener(e,n,!1)}function dG(t,e,n){t.removeEventListener(e,n,!1)}function hS(t){return t.selectionStart?t.selectionStart:0}function hP(t){return t.selectionEnd?t.selectionEnd:0}function fG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function SC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Vc(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let Wm;function gG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function nn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Wm===void 0&&(Wm=gG(t)),Wm}function dP(t){return t.offsetWidth!==t.clientWidth}function fP(t){return t.offsetHeight!==t.clientHeight}function _g(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function mG(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Bc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Qu(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Mg(t){return Qu(t)&&t.hasAttribute("data-hot-input")===!1}function pG(t){const e=t.ownerDocument.activeElement;Mg(e)||t.select()}function dS(t){return!t.parentNode}function gP(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function fS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ee(t,"contenteditable",!0),n&&Ee(t,...Eo()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function gS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Le(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function mP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;fS(t,n),e(),gS(t,n)}const wG=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:cP,addClass:q,addEvent:hG,clearTextSelection:SC,closest:cs,closestDown:Bu,empty:oi,fastInnerHTML:Sa,fastInnerText:hs,getCaretPosition:hS,getComputedStyle:Co,getCssTransform:mG,getFrameElement:sP,getParent:iP,getParentWindow:Sc,getScrollLeft:uS,getScrollTop:Tg,getScrollableElement:yc,getScrollbarWidth:nn,getSelectionEndPosition:hP,getSelectionText:fG,getStyle:Il,getTrimmingContainer:ca,getWindowScrollLeft:Eg,getWindowScrollTop:lS,hasAccessToParentWindow:uG,hasClass:Ie,hasHorizontalScrollbar:fP,hasVerticalScrollbar:dP,index:aP,innerHeight:ra,innerWidth:cS,isChildOf:os,isDetached:dS,isInput:Qu,isOutsideInput:Mg,isThisHotChild:oP,isVisible:ds,makeElementContentEditableAndSelectItsContent:fS,matchesCSSRules:cG,observeVisibilityChangeOnce:gP,offset:en,outerHeight:xt,outerWidth:ft,overlayContainsElement:Uo,removeAttribute:va,removeClass:Le,removeContentEditableFromElementAndDeselect:gS,removeEvent:dG,removeTextNodes:aS,resetCssTransform:Bc,runWithSelectedContendEditableElement:mP,selectElementIfAllowed:pG,setAttribute:Ee,setCaretPosition:Vc,setOverlayPosition:_g},Symbol.toStringTag,{value:"Module"}));function Ct(t){return typeof t=="function"}function pP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function CG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=pP(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function Ag(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function vG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Yt(i,(u,c)=>c(u),r.apply(this,a))}}function mS(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function wP(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function SG(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Sf(t,e,n,r,i,o,s,a){return ue(a)?t.call(e,n,r,i,o,s,a):ue(s)?t.call(e,n,r,i,o,s):ue(o)?t.call(e,n,r,i,o):ue(i)?t.call(e,n,r,i):ue(r)?t.call(e,n,r):ue(n)?t.call(e,n):t.call(e)}const yG=Object.freeze(Object.defineProperty({__proto__:null,curry:wP,curryRight:SG,debounce:Ag,fastCall:Sf,isFunction:Ct,partial:mS,pipe:vG,throttle:pP,throttleAfterHits:CG},Symbol.toStringTag,{value:"Module"}));var bG=Un,y0=LO,RG=Mn,b0=Nl,EG=UO,R0=bG([].push),TG=function(t){if(RG(t))return t;if(y0(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?R0(n,i):(typeof i=="number"||b0(i)==="Number"||b0(i)==="String")&&R0(n,EG(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(y0(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},_G=Ss,CP=Hc,vP=ug,MG=pa,Uc=Un,SP=Hr,E0=Mn,T0=Sv,yP=xv,AG=TG,OG=vv,IG=String,ss=CP("JSON","stringify"),gh=Uc(/./.exec),_0=Uc("".charAt),PG=Uc("".charCodeAt),xG=Uc("".replace),HG=Uc(1 .toString),DG=/[\uD800-\uDFFF]/g,M0=/^[\uD800-\uDBFF]$/,A0=/^[\uDC00-\uDFFF]$/,O0=!OG||SP(function(){var t=CP("Symbol")("stringify detection");return ss([t])!=="[null]"||ss({a:t})!=="{}"||ss(Object(t))!=="{}"}),I0=SP(function(){return ss("\uDF06\uD834")!=='"\\udf06\\ud834"'||ss("\uDEAD")!=='"\\udead"'}),NG=function(t,e){var n=yP(arguments),r=AG(e);if(!(!E0(r)&&(t===void 0||T0(t))))return n[1]=function(i,o){if(E0(r)&&(o=MG(r,this,IG(i),o)),!T0(o))return o},vP(ss,null,n)},LG=function(t,e,n){var r=_0(n,e-1),i=_0(n,e+1);return gh(M0,t)&&!gh(A0,i)||gh(A0,t)&&!gh(M0,r)?"\\u"+HG(PG(t,0),16):t};ss&&_G({target:"JSON",stat:!0,arity:3,forced:O0||I0},{stringify:function(e,n,r){var i=yP(arguments),o=vP(O0?NG:ss,null,i);return I0&&typeof o=="string"?xG(o,DG,LG):o}});function Pl(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ye(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Pl(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Pl(n[0])]:e[r]=[]:e[r]=null)})),e}function To(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function jt(t,e,n){const r=Array.isArray(n);return Ye(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Yc(t,e){Ye(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Yc(t[r],e[r])):t[r]=e[r]})}function Tn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Vn(t){const e={};return Ye(t,(n,r)=>{e[r]=n}),e}function pt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return E(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ye(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=p=>{let C=p;return(Array.isArray(C)||Ve(C))&&(C=Tn(C)),C};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Og(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ve(t){return Object.prototype.toString.call(t)==="[object Object]"}function Fi(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ye(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function bP(t,e){const n=e.split(".");let r=t;return Ye(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Wd(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Pt(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function Ig(t){if(!Ve(t))return 0;const e=function(n){let r=0;return Ve(n)?Ye(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function ei(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Pt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const $G=Object.freeze(Object.defineProperty({__proto__:null,clone:Vn,createObjectPropListener:ei,deepClone:Tn,deepExtend:Yc,deepObjectSize:Ig,defineGetter:Fi,duckSchema:Pl,extend:jt,getProperty:bP,hasOwnProperty:Pt,inherit:To,isObject:Ve,isObjectEqual:Og,mixin:pt,objectEach:Ye,setProperty:Wd},Symbol.toStringTag,{value:"Module"}));function Pg(t){return window.requestAnimationFrame(t)}function bc(t){window.cancelAnimationFrame(t)}function pS(){return"ontouchstart"in window}function RP(){return typeof window<"u"}let _a;function EP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _a||(typeof Intl=="object"?_a=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?_a=(n,r)=>`${n}`.localeCompare(r):_a=(n,r)=>n===r?0:n>r?-1:1,_a)}const kG=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:bc,getComparisonFunction:EP,isCSR:RP,isTouchSupported:pS,requestAnimationFrame:Pg},Symbol.toStringTag,{value:"Module"})),Tr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},_o={chrome:Tr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Tr(t=>/CriOS/.test(t)),edge:Tr(t=>/Edge/.test(t)),edgeWebKit:Tr(t=>/EdgiOS/.test(t)),firefox:Tr(t=>/Firefox/.test(t)),firefoxWebKit:Tr(t=>/FxiOS/.test(t)),mobile:Tr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Tr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Wl={mac:Tr(t=>/^Mac/.test(t)),win:Tr(t=>/^Win/.test(t)),linux:Tr(t=>/^Linux/.test(t)),ios:Tr(t=>/iPhone|iPad|iPod/i.test(t))};function TP(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(_o,n=>{let{test:r}=n;return void r(t,e)})}function _P(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(Wl,e=>{let{test:n}=e;return void n(t)})}RP()&&(TP(),_P());function wS(){return _o.chrome.value}function MP(){return _o.chromeWebKit.value}function Vd(){return _o.firefox.value}function AP(){return _o.firefoxWebKit.value}function CS(){return _o.safari.value}function OP(){return _o.edge.value}function FG(){return _o.edgeWebKit.value}function uo(){return _o.mobile.value}function vS(){return Wl.ios.value}function SS(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Wl.mac.value}function yC(){return Wl.win.value}function Rc(){return Wl.mac.value}function WG(){return Wl.linux.value}const VG=Object.freeze(Object.defineProperty({__proto__:null,isChrome:wS,isChromeWebKit:MP,isEdge:OP,isEdgeWebKit:FG,isFirefox:Vd,isFirefoxWebKit:AP,isIOS:vS,isIpadOS:SS,isLinuxOS:WG,isMacOS:Rc,isMobileBrowser:uo,isSafari:CS,isWindowsOS:yC,setBrowserMeta:TP,setPlatformMeta:_P},Symbol.toStringTag,{value:"Module"})),we={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Vd()?182:174,AUDIO_MUTE:Vd()?181:173,AUDIO_UP:Vd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},BG=[we.ALT,we.ARROW_DOWN,we.ARROW_LEFT,we.ARROW_RIGHT,we.ARROW_UP,we.AUDIO_DOWN,we.AUDIO_MUTE,we.AUDIO_UP,we.BACKSPACE,we.CAPS_LOCK,we.DELETE,we.END,we.ENTER,we.ESCAPE,we.F1,we.F2,we.F3,we.F4,we.F5,we.F6,we.F7,we.F8,we.F9,we.F10,we.F11,we.F12,we.F13,we.F14,we.F15,we.F16,we.F17,we.F18,we.F19,we.HOME,we.INSERT,we.MEDIA_NEXT,we.MEDIA_PLAY_PAUSE,we.MEDIA_PREV,we.MEDIA_STOP,we.NULL,we.NUM_LOCK,we.PAGE_DOWN,we.PAGE_UP,we.PAUSE,we.SCROLL_LOCK,we.SHIFT,we.TAB];function IP(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function yS(t){return BG.includes(t)}function UG(t){const e=[];return Rc()?e.push(we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX):e.push(we.CONTROL),e.includes(t)}function PP(t){return[we.CONTROL,we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX].includes(t)}function Vl(t,e){const n=e.split("|");let r=!1;return E(n,i=>{if(t===we[i])return r=!0,!1}),r}const YG=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:we,isCtrlKey:UG,isCtrlMetaKey:PP,isFunctionKey:yS,isKey:Vl,isPrintableChar:IP},Symbol.toStringTag,{value:"Module"}));function Lr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ko(t){return t.isImmediatePropagationEnabled===!1}function fs(t){return t.button===2}function xg(t){return t.button===0}function xP(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const GG=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ko,isLeftClick:xg,isRightClick:fs,offsetRelativeTo:xP,stopImmediatePropagation:Lr},Symbol.toStringTag,{value:"Module"}));function gt(){ue(console)&&console.warn(...arguments)}function bS(){ue(console)&&console.error(...arguments)}function zG(t,e,n){return e=jG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jG(t){var e=KG(t,"string");return typeof e=="symbol"?e:String(e)}function KG(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ma=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],XG=ht`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Vm=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Bm=new Map([[]]);class HP{static getSingleton(){return ZG()}constructor(){zG(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return E(Ma,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))E(n,i=>this.add(e,i,r));else{Vm.has(e)&&gt(rS(XG,{hookName:e,removedInVersion:Vm.get(e)})),Bm.has(e)&&gt(Bm.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&E(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?E(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Sf(u[h],e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Sf(u[h],e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ye(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||Ma.push(e)}deregister(e){this.isRegistered(e)&&Ma.splice(Ma.indexOf(e),1)}isDeprecated(e){return Bm.has(e)||Vm.has(e)}isRegistered(e){return Ma.indexOf(e)>=0}getRegistered(){return Ma}}const qG=new HP;function ZG(){return qG}const de=HP,Um=new Map;function ai(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Um.has(t)||Um.set(t,new Map);const e=Um.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const bC=new WeakMap,{register:JG,getItem:DP,hasItem:NP,getNames:QG,getValues:sue}=ai("editors");function ez(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},de.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function LP(t,e){let n;if(typeof t=="function")bC.get(t)||Qn(null,t),n=bC.get(t);else if(typeof t=="string")n=DP(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function yf(t){if(typeof t=="function")return t;if(!NP(t))throw Error(`No registered editor found under "${t}" name`);return DP(t).getConstructor()}function Qn(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new ez(e);typeof t=="string"&&JG(t,n),bC.set(e,n)}function tz(t,e,n){return e=nz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nz(t){var e=rz(t,"string");return typeof e=="symbol"?e:String(e)}function rz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Bd=0;class iz{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;tz(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,oz(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Bd+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Bd-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Bd-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function oz(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Lr(this)},t}const xr=iz;function sz(){return Bd}function P0(t,e){az(t,e),e.add(t)}function az(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oo(t,e,n){return e=lz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lz(t){var e=uz(t,"string");return typeof e=="symbol"?e:String(e)}function uz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function x0(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Hg="editorManager.navigation";var H0=new WeakSet,D0=new WeakSet;class RC{constructor(e,n,r){P0(this,D0),P0(this,H0),Oo(this,"hot",void 0),Oo(this,"tableMeta",void 0),Oo(this,"selection",void 0),Oo(this,"eventManager",void 0),Oo(this,"destroyed",!1),Oo(this,"lock",!1),Oo(this,"activeEditor",void 0),Oo(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new xr(e),this.hot.addHook("afterDocumentKeyDown",i=>x0(this,H0,cz).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>x0(this,D0,hz).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i);let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=LP(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function cz(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ko(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!yS(n)&&!PP(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>ue(this.hot.getSelected()),group:Hg};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function hz(t,e){e.isCell()&&this.openEditor(null,t,!0)}const N0=new WeakMap;RC.getInstance=function(t,e,n){let r=N0.get(t);return r||(r=new RC(t,e,n),N0.set(t,r)),r};const dz=RC;function mh(t,e){$P(t,e),e.add(t)}function Ql(t,e,n){$P(t,e),e.set(t,n)}function $P(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Lt(t,e){var n=kP(t,e,"get");return fz(t,n)}function fz(t,e){return e.get?e.get.call(t):e.value}function eu(t,e,n){var r=kP(t,e,"set");return gz(t,r,n),n}function kP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gz(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const es=Object.freeze({CELL:"cell",MIXED:"mixed"});var gn=new WeakMap,ph=new WeakMap,wh=new WeakMap,Ch=new WeakMap,vh=new WeakMap,bf=new WeakSet,L0=new WeakSet,$0=new WeakSet,k0=new WeakSet;class mz{constructor(e){var n=this;mh(this,k0),mh(this,$0),mh(this,L0),mh(this,bf),Ql(this,gn,{writable:!0,value:void 0}),Ql(this,ph,{writable:!0,value:void 0}),Ql(this,wh,{writable:!0,value:50}),Ql(this,Ch,{writable:!0,value:null}),Ql(this,vh,{writable:!0,value:new Map});const r=e.getSettings();eu(this,gn,e),eu(this,ph,r.imeFastEdit?es.MIXED:es.CELL),Lt(this,gn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Sl(n,k0,Cz).call(n,...o)}),Lt(this,gn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Sl(n,L0,pz).call(n,...o)}),Lt(this,gn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Sl(n,$0,wz).call(n,...o)})}getFocusMode(){return Lt(this,ph)}setFocusMode(e){Object.values(es).includes(e)?eu(this,ph,e):gt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Lt(this,wh)}setRefocusDelay(e){eu(this,wh,e)}setRefocusElementGetter(e){eu(this,Ch,e)}getRefocusElement(){if(typeof Lt(this,Ch)=="function")return Lt(this,Ch).call(this);var e;return(e=Lt(this,gn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Lt(this,gn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Lt(this,gn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Lt(this,gn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Sl(this,bf,RS).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lt(this,wh);const r=this.getRefocusElement();Lt(this,gn).getSettings().imeFastEdit&&!((e=Lt(this,gn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Lt(this,vh).has(n)||Lt(this,vh).set(n,Ag(()=>{r.select()},n)),Lt(this,vh).get(n)())}}function RS(t){var e;const n=(e=Lt(this,gn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Lt(this,gn).selection.isCellVisible(n)){t(null);return}const r=Lt(this,gn).getCell(n.row,n.col,!0);r===null?Lt(this,gn).addHookOnce("afterScroll",()=>{t(Lt(this,gn).getCell(n.row,n.col,!0))}):t(r)}function pz(){Sl(this,bf,RS).call(this,t=>{const{activeElement:e}=Lt(this,gn).rootDocument;e&&Mg(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function wz(){Sl(this,bf,RS).call(this,t=>{this.getFocusMode()===es.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function Cz(t){t.imeFastEdit&&this.getFocusMode()!==es.MIXED?this.setFocusMode(es.MIXED):!t.imeFastEdit&&this.getFocusMode()!==es.CELL&&this.setFocusMode(es.CELL)}const FP={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},vz=new RegExp(Object.keys(FP).map(t=>`(${t})`).join("|"),"gi");function Sz(t){return(t&&t.nodeName||"")==="TABLE"}function EC(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,p=[];for(let S=0;S<s;S+=1){const y=!g&&n&&S===0;let R="";if(g)R=`<th>${t.getColHeader(S-c)}</th>`;else if(y)R=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][S],{hidden:N,rowspan:I,colspan:F}=t.getCellMeta(d-h,S-c);if(!N){const B=[];if(I&&B.push(`rowspan="${I}"`),F&&B.push(`colspan="${F}"`),Zt(T))R=`<td ${B.join(" ")}></td>`;else{const ee=T.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${B.join(" ")}>${ee}</td>`}}}p.push(R)}const C=["<tr>",...p,"</tr>"].join("");g?l.splice(1,0,C):u.splice(-1,0,C)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function TC(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Zt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function WP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,N=>{const I=N.match(/<td\b[^>]*?>/g)[0],F=N.substring(I.length,N.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${I}${F}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!Sz(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,N)=>T+N.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,p=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(N=>{const I=N.querySelector("td")!==null;return I&&h.push(N),!I});g=T.length,d=g>0,g>1?n.nestedHeaders=Array.from(T).reduce((N,I)=>{const F=Array.from(I.cells).reduce((B,ee,U)=>{if(a&&U===0)return B;const{colSpan:j,innerHTML:re}=ee,ie=j>1?{label:re,colspan:j}:re;return B.push(ie),B},[]);return N.push(F),N},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((N,I,F)=>(a&&F===0||N.push(I.innerHTML),N),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const C=[...h,...Array.from(o.tBodies).reduce((T,N)=>(T.push(...Array.from(N.rows)),T),[]),...c];p=C.length;const S=new Array(p);for(let T=0;T<p;T++)S[T]=new Array(u);const y=[],R=[];for(let T=0;T<p;T++){const N=C[T],I=Array.from(N.cells),F=I.length;for(let B=0;B<F;B++){const ee=I[B],{nodeName:U,innerHTML:j,rowSpan:re,colSpan:ie}=ee,oe=S[T].findIndex(Ce=>Ce===void 0);if(U==="TD"){if(re>1||ie>1){for(let Fe=T;Fe<T+re;Fe++)if(Fe<p)for(let pe=oe;pe<oe+ie;pe++)S[Fe][pe]=null;const Me=ee.getAttribute("style");Me&&Me.includes("mso-ignore:colspan")||y.push({col:oe,row:T,rowspan:re,colspan:ie})}let Ce="";s&&/excel/gi.test(s.content)?Ce=j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):Ce=j.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[T][oe]=Ce.replace(vz,Me=>FP[Me])}else R.push(j)}}return y.length&&(n.mergeCells=y),R.length&&(n.rowHeaders=R),S.length&&(n.data=S),n}const yz=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:TC,htmlToGridSettings:WP,instanceToHTML:EC},Symbol.toStringTag,{value:"Module"}));function Wn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function VP(t){return Wn(t,[","])}function me(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Rf(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function ES(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function ir(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const bz=Object.freeze(Object.defineProperty({__proto__:null,clamp:ir,isNumeric:Wn,isNumericLike:VP,rangeEach:me,rangeEachReverse:Rf,valueAccordingPercent:ES},Symbol.toStringTag,{value:"Module"})),_C="asc",Rz="desc",F0=new Map([[_C,[-1,1]],[Rz,[1,-1]]]),Ez=t=>`The priority '${t}' is already declared in a map.`,Tz=t=>`The priority '${t}' is not a number.`;function _z(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Ct(t)?t:Ez,e=Ct(e)?e:Tz;function r(o,s){if(!Wn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_C;const[s,a]=F0.get(o)||F0.get(_C);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const Mz=t=>`The id '${t}' is already declared in a map.`;function Dg(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ct(t)?t:Mz;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const Az=t=>`'${t}' value is already declared in a unique set.`;function Oz(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ct(t)?t:Az;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const TS=t=>`There is already registered "${t}" plugin.`,Iz=t=>`There is already registered plugin on priority "${t}".`,Pz=t=>`The priority "${t}" is not a number.`,BP=_z({errorPriorityExists:Iz,errorPriorityNaN:Pz}),UP=Oz({errorItemExists:TS}),MC=Dg({errorIdExists:TS});function _S(){return[...BP.getItems(),...UP.getItems()]}function Gc(t){const e=En(t);return MC.getItem(e)}function xz(t){return!!Gc(t)}function tt(t,e,n){[t,e,n]=Dz(t,e,n),Gc(t)===void 0&&Hz(t,e,n)}function Hz(t,e,n){const r=En(t);if(MC.hasItem(r))throw new Error(TS(r));n===void 0?UP.addItem(r):BP.addItem(n,r),MC.addItem(r,e)}function Dz(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Nz,getItem:Lz,hasItem:YP,getNames:$z,getValues:aue}=ai("renderers");function Ef(t){if(typeof t=="function")return t;if(!YP(t))throw Error(`No registered renderer found under "${t}" name`);return Lz(t)}function lr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Nz(t,e)}const{register:kz,getItem:Fz,hasItem:GP,getNames:Wz,getValues:lue}=ai("validators");function MS(t){if(typeof t=="function")return t;if(!GP(t))throw Error(`No registered validator found under "${t}" name`);return Fz(t)}function ta(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),kz(t,e)}function Sh(t,e,n){return e=Vz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vz(t){var e=Bz(t,"string");return typeof e=="symbol"?e:String(e)}function Bz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uz{constructor(e){Sh(this,"count",0),Sh(this,"startColumn",0),Sh(this,"endColumn",0),Sh(this,"startPosition",0),this.count=e.totalColumns,this.endColumn=this.count-1}}function yh(t,e,n){return e=Yz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yz(t){var e=Gz(t,"string");return typeof e=="symbol"?e:String(e)}function Gz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zz{constructor(e){yh(this,"count",0),yh(this,"startRow",0),yh(this,"endRow",0),yh(this,"startPosition",0),this.count=e.totalRows,this.endRow=this.count-1}}var zP={},jz=HO,Kz=Iv,Xz=Object.keys||function(e){return jz(e,Kz)},qz=Ni,Zz=_O,Jz=Cs,Qz=vs,ej=og,tj=Xz;zP.f=qz&&!Zz?Object.defineProperties:function(e,n){Qz(e);for(var r=ej(n),i=tj(n),o=i.length,s=0,a;o>s;)Jz.f(e,a=i[s++],r[a]);return e};var nj=vs,rj=zP,W0=Iv,ij=Mv,oj=XO,sj=Tv,aj=OO,V0=">",B0="<",AC="prototype",OC="script",jP=aj("IE_PROTO"),Ym=function(){},KP=function(t){return B0+OC+V0+t+B0+"/"+OC+V0},U0=function(t){t.write(KP("")),t.close();var e=t.parentWindow.Object;return t=null,e},lj=function(){var t=sj("iframe"),e="java"+OC+":",n;return t.style.display="none",oj.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(KP("document.F=Object")),n.close(),n.F},bh,Ud=function(){try{bh=new ActiveXObject("htmlfile")}catch{}Ud=typeof document<"u"?document.domain&&bh?U0(bh):lj():U0(bh);for(var t=W0.length;t--;)delete Ud[AC][W0[t]];return Ud()};ij[jP]=!0;var uj=Object.create||function(e,n){var r;return e!==null?(Ym[AC]=nj(e),r=new Ym,Ym[AC]=null,r[jP]=e):r=Ud(),n===void 0?r:rj.f(r,n)},cj=Ll,hj=uj,dj=Cs.f,IC=cj("unscopables"),PC=Array.prototype;PC[IC]===void 0&&dj(PC,IC,{configurable:!0,value:hj(null)});var XP=function(t){PC[IC][t]=!0},fj=Ss,gj=lg,mj=Nc,pj=Ov,wj=XP;fj({target:"Array",proto:!0},{at:function(e){var n=gj(this),r=mj(n),i=pj(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});wj("at");const Go=1,yn=2;function Cj(t,e,n){vj(t,e),e.set(t,n)}function vj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tu(t,e,n){return e=Sj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sj(t){var e=yj(t,"string");return typeof e=="symbol"?e:String(e)}function yj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aa(t,e){var n=qP(t,e,"get");return bj(t,n)}function bj(t,e){return e.get?e.get.call(t):e.value}function Rj(t,e,n){var r=qP(t,e,"set");return Ej(t,r,n),n}function qP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ej(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Io=new WeakMap;class zc{static get DEFAULT_WIDTH(){return 50}constructor(e){tu(this,"count",0),tu(this,"startColumn",null),tu(this,"endColumn",null),tu(this,"startPosition",null),tu(this,"isVisibleInTrimmingContainer",!1),Cj(this,Io,{writable:!0,value:void 0}),Rj(this,Io,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=Aa(this,Io),s=Math.max(Aa(this,Io).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,d=0,g=0;for(let y=0;y<i;y++)if(h=this._getColumnWidth(y),l<=s&&e!==yn&&(this.startColumn=y,d=h),l>=s&&l+(e===yn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y,d=h),this.endColumn=y),c.push(l),l+=h,g=h,e!==yn&&(this.endColumn=y),l>=s+o){u=!1;break}const p=r+o-a,C=e===yn?0:g,S=e===yn?d:0;if(p<-1*Aa(this,Io).inlineStartOffset||r>c.at(-1)+C||-1*Aa(this,Io).scrollOffset-Aa(this,Io).viewportWidth>-1*S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=c[this.endColumn]+h-c[this.startColumn-1];if((y<=o||e!==yn)&&(this.startColumn-=1),y>o)break}e===Go&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(e){let n=Aa(this,Io).columnWidthFn(e);return isNaN(n)&&(n=zc.DEFAULT_WIDTH),n}}function Tj(t,e,n){_j(t,e),e.set(t,n)}function _j(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nu(t,e,n){return e=Mj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mj(t){var e=Aj(t,"string");return typeof e=="symbol"?e:String(e)}function Aj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gm(t,e){var n=ZP(t,e,"get");return Oj(t,n)}function Oj(t,e){return e.get?e.get.call(t):e.value}function Ij(t,e,n){var r=ZP(t,e,"set");return Pj(t,r,n),n}function ZP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ru=new WeakMap;class Ng{static get DEFAULT_HEIGHT(){return 23}constructor(e){nu(this,"count",0),nu(this,"startRow",null),nu(this,"endRow",null),nu(this,"startPosition",null),nu(this,"isVisibleInTrimmingContainer",!1),Tj(this,ru,{writable:!0,value:void 0}),Ij(this,ru,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=Gm(this,ru),a=Math.max(Gm(this,ru).scrollOffset,0),l=Gm(this,ru).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let d,g=0,p=0;for(let R=0;R<o;R++)if(d=r(R),isNaN(d)&&(d=Ng.DEFAULT_HEIGHT),u<=a&&e!==yn&&(this.startRow=R,g=d),u>=a&&u+(e===yn?d:0)<=a+s-l&&(this.startRow===null&&(this.startRow=R,g=d),this.endRow=R),h.push(u),u+=d,p=d,e!==yn&&(this.endRow=R),u>=a+s-l){c=!1;break}const C=i+s-l,S=e===yn?g:0,y=e===yn?0:p;if(C<S||i>h.at(-1)+y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const R=h[this.endRow]+d-h[this.startRow-1];if((R<=s-l||e!==yn)&&(this.startRow-=1),R>=s-l)break}e===Go&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function xj(t,e,n){Hj(t,e),e.set(t,n)}function Hj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Y0(t,e,n){return e=Dj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dj(t){var e=Nj(t,"string");return typeof e=="symbol"?e:String(e)}function Nj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oa(t,e){var n=JP(t,e,"get");return Lj(t,n)}function Lj(t,e){return e.get?e.get.call(t):e.value}function G0(t,e,n){var r=JP(t,e,"set");return $j(t,r,n),n}function JP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $j(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ui=new WeakMap;class Tf{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Y0(this,"row",null),Y0(this,"col",null),xj(this,Ui,{writable:!0,value:!1}),G0(this,Ui,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Oa(this,Ui)}isSouthEastOf(e){return this.row>=e.row&&(Oa(this,Ui)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Oa(this,Ui)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Oa(this,Ui)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Oa(this,Ui)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Tf&&G0(this,Ui,e.isRtl()),this}clone(){return new Tf(this.row,this.col,Oa(this,Ui))}toObject(){return{row:this.row,col:this.col}}}const _f=Tf;function kj(t,e,n){Fj(t,e),e.set(t,n)}function Fj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zm(t,e,n){return e=Wj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wj(t){var e=Vj(t,"string");return typeof e=="symbol"?e:String(e)}function Vj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cr(t,e){var n=QP(t,e,"get");return Bj(t,n)}function Bj(t,e){return e.get?e.get.call(t):e.value}function Uj(t,e,n){var r=QP(t,e,"set");return Yj(t,r,n),n}function QP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var zn=new WeakMap;class AS{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;zm(this,"highlight",null),zm(this,"from",null),zm(this,"to",null),kj(this,zn,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Uj(this,zn,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),d=this._createCellCoords(u,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Cr(this,zn)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Cr(this,zn)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Cr(this,zn)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Cr(this,zn)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Cr(this,zn)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Cr(this,zn)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Cr(this,zn)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Cr(this,zn)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof _f))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Cr(this,zn)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Cr(this,zn)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new AS(this.highlight,this.from,this.to,Cr(this,zn))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new _f(e,n,Cr(this,zn))}}const OS=AS;function ui(t,e,n){Gj(t,e),e.set(t,n)}function Gj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ve(t,e){var n=ex(t,e,"get");return zj(t,n)}function zj(t,e){return e.get?e.get.call(t):e.value}function Po(t,e,n){var r=ex(t,e,"set");return jj(t,r,n),n}function ex(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var vr=new WeakMap,jm=new WeakMap,on=new WeakMap,Ia=new WeakMap,Rh=new WeakMap,kr=new WeakMap,Km=new WeakMap,iu=new WeakMap,_s=new WeakMap,ci=new WeakMap;let Kj=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ui(this,vr,{writable:!0,value:void 0}),ui(this,jm,{writable:!0,value:void 0}),ui(this,on,{writable:!0,value:void 0}),ui(this,Ia,{writable:!0,value:void 0}),ui(this,Rh,{writable:!0,value:void 0}),ui(this,kr,{writable:!0,value:void 0}),ui(this,Km,{writable:!0,value:void 0}),ui(this,iu,{writable:!0,value:void 0}),ui(this,_s,{writable:!0,value:[null,null]}),ui(this,ci,{writable:!0,value:[null,null]}),Po(this,vr,r),Po(this,jm,n),Po(this,on,o),Po(this,Ia,s),Po(this,Rh,a),Po(this,kr,i),Po(this,Km,e),this.registerEvents()}registerEvents(){ve(this,kr).addEventListener(ve(this,on).holder,"contextmenu",r=>this.onContextMenu(r)),ve(this,kr).addEventListener(ve(this,on).TABLE,"mouseover",r=>this.onMouseOver(r)),ve(this,kr).addEventListener(ve(this,on).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ve(this,kr).addEventListener(ve(this,on).holder,"touchstart",r=>this.onTouchStart(r)),ve(this,kr).addEventListener(ve(this,on).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ve(this,kr).addEventListener(ve(this,on).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ve(this,vr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ve(this,vr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ve(this,kr).addEventListener(ve(this,on).holder,"mouseup",r=>this.onMouseUp(r)),ve(this,kr).addEventListener(ve(this,on).holder,"mousedown",r=>this.onMouseDown(r))};uo()?e():(pS()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ve(this,iu)&&r){const[i,o]=[r.row,ve(this,iu).from.row],[s,a]=[r.col,ve(this,iu).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ve(this,on).TABLE,i=Bu(e,["TD","TH"],r);return i?(n.coords=ve(this,on).getCoords(i),n.TD=i):Ie(e,"wtBorder")&&Ie(e,"current")?(n.coords=ve(this,Ia).getFocusSelection().cellRange.highlight,n.TD=ve(this,on).getCell(n.coords)):Ie(e,"wtBorder")&&Ie(e,"area")&&ve(this,Ia).getAreaSelection().cellRange&&(n.coords=ve(this,Ia).getAreaSelection().cellRange.to,n.TD=ve(this,on).getCell(n.coords)),n}onMouseDown(e){const n=ve(this,jm).rootDocument.activeElement,r=mS(iP,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Ie(i,"corner")?ve(this,vr).getSetting("onCellCornerMouseDown",e,i):o.TD&&ve(this,vr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ve(this,ci)[0]=o.TD,clearTimeout(ve(this,_s)[0]),ve(this,_s)[0]=setTimeout(()=>{ve(this,ci)[0]=null},1e3))}onContextMenu(e){if(ve(this,vr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ve(this,vr).has("onCellMouseOver"))return;const n=ve(this,on).TABLE,r=Bu(e.target,["TD","TH"],n),i=ve(this,Rh)||this;r&&r!==i.lastMouseOver&&os(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ve(this,on).getCoords(r),r))}onMouseOut(e){if(!ve(this,vr).has("onCellMouseOut"))return;const n=ve(this,on).TABLE,r=Bu(e.target,["TD","TH"],n),i=Bu(e.relatedTarget,["TD","TH"],n),o=ve(this,Rh)||this;r&&r!==i&&os(r,n)&&(this.callListener("onCellMouseOut",e,ve(this,on).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ve(this,vr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ve(this,ci)[0]&&n.TD===ve(this,ci)[1]?(Ie(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ve(this,ci)[0]=null,ve(this,ci)[1]=null):n.TD===ve(this,ci)[0]&&(ve(this,ci)[1]=n.TD,clearTimeout(ve(this,_s)[1]),ve(this,_s)[1]=setTimeout(()=>{ve(this,ci)[1]=null},500)))}onTouchStart(e){Po(this,iu,ve(this,Ia).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ve(this,vr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];vS()&&(MP()||AP())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ve(this,vr).getSettingPure(e);o&&o(n,r,i,ve(this,Km).call(this))}destroy(){clearTimeout(ve(this,_s)[0]),clearTimeout(ve(this,_s)[1]),ve(this,kr).destroy()}};const tx=Kj;function Xm(t,e,n){return e=Xj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xj(t){var e=qj(t,"string");return typeof e=="symbol"?e:String(e)}function qj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zj{constructor(e,n,r){Xm(this,"offset",void 0),Xm(this,"total",void 0),Xm(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Jj=Zj;function qm(t,e,n){return e=Qj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qj(t){var e=eK(t,"string");return typeof e=="symbol"?e:String(e)}function eK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tK{constructor(e,n,r){qm(this,"offset",void 0),qm(this,"total",void 0),qm(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const nK=tK,rK=0,Mf=1,Af=2;function Eh(t,e,n){return e=iK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iK(t){var e=oK(t,"string");return typeof e=="symbol"?e:String(e)}function oK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class z0{constructor(){Eh(this,"currentSize",0),Eh(this,"nextSize",0),Eh(this,"currentOffset",0),Eh(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Zm(t,e,n){return e=sK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sK(t){var e=aK(t,"string");return typeof e=="symbol"?e:String(e)}function aK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lK{constructor(){Zm(this,"size",new z0),Zm(this,"workingSpace",rK),Zm(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof z0}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Mf,e.workingSpace=Af,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Af,e.workingSpace=Mf,this.sharedSize=e.getViewSize()}}function Pa(t,e,n){return e=uK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:String(e)}function cK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nx{constructor(e,n,r){Pa(this,"rootNode",void 0),Pa(this,"nodesPool",void 0),Pa(this,"sizeSet",new lK),Pa(this,"childNodeType",void 0),Pa(this,"visualIndex",0),Pa(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(Mf))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Af)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(Mf);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Af)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class rx extends nx{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function hK(t,e,n){return e=dK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dK(t){var e=fK(t,"string");return typeof e=="symbol"?e:String(e)}function fK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gK{constructor(e){hK(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function ou(t,e,n){return e=mK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mK(t){var e=pK(t,"string");return typeof e=="symbol"?e:String(e)}function pK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jc{constructor(e,n){ou(this,"nodesPool",null),ou(this,"nodeType",void 0),ou(this,"rootNode",void 0),ou(this,"table",null),ou(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new gK(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function j0(t,e,n){return e=wK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wK(t){var e=CK(t,"string");return typeof e=="symbol"?e:String(e)}function CK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vK extends jc{constructor(){super("TH"),j0(this,"orderViews",new WeakMap),j0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new rx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),va(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ee(d,[BY(),qY(),oS(h+1),Fl(-1)]),n[h](a,d,h)}u.end()}}}class SK extends jc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&oi(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ee(this.rootNode,[QI()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ee(s,[vC(),rP(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),va(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ee(u,[oS(a+1+this.table.rowHeadersCount),Fl(-1),UY(),...a>=0?[XY()]:[vC()]]),r[n](l,u,n)}}}}let K0=!1;class yK extends jc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!K0&&e>1e3&&(K0=!0,gt(ht`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function bK(t,e,n){return e=RK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RK(t){var e=EK(t,"string");return typeof e=="symbol"?e:String(e)}function EK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let X0=!1;class TK extends jc{constructor(e){super("TR",e),bK(this,"orderView",void 0),this.orderView=new nx(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!X0&&e>1e3&&(X0=!0,gt(ht`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ee(this.rootNode,[QI()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ee(o,[vC(),rP(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function q0(t,e,n){return e=_K(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _K(t){var e=MK(t,"string");return typeof e=="symbol"?e:String(e)}function MK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AK extends jc{constructor(){super("TD"),q0(this,"orderViews",new WeakMap),q0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new rx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){c.render();const g=c.getCurrentNode(),p=this.table.renderedColumnToSource(d);if(Ie(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),va(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,p,g),this.table.isAriaEnabled()){var o,s;Ee(g,[...g.hasAttribute("role")?[]:[VY()],Fl(-1),oS(p+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function sn(t,e,n){return e=OK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OK(t){var e=IK(t,"string");return typeof e=="symbol"?e:String(e)}function IK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PK{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sn(this,"rootNode",void 0),sn(this,"rootDocument",void 0),sn(this,"rowHeaders",null),sn(this,"columnHeaders",null),sn(this,"colGroup",null),sn(this,"rows",null),sn(this,"cells",null),sn(this,"rowFilter",null),sn(this,"columnFilter",null),sn(this,"rowUtils",null),sn(this,"columnUtils",null),sn(this,"rowsToRender",0),sn(this,"columnsToRender",0),sn(this,"rowHeaderFunctions",[]),sn(this,"rowHeadersCount",0),sn(this,"columnHeaderFunctions",[]),sn(this,"columnHeadersCount",0),sn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class xK{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new PK(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new vK,columnHeaders:new SK(n),colGroup:new yK(r),rows:new TK(i),cells:new AK}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function su(t,e,n){HK(t,e),e.set(t,n)}function HK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Th(t,e,n){return e=DK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DK(t){var e=NK(t,"string");return typeof e=="symbol"?e:String(e)}function NK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pn(t,e){var n=ix(t,e,"get");return LK(t,n)}function LK(t,e){return e.get?e.get.call(t):e.value}function au(t,e,n){var r=ix(t,e,"set");return $K(t,r,n),n}function ix(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $K(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var _h=new WeakMap,xa=new WeakMap,lu=new WeakMap,Mh=new WeakMap,Ms=new WeakMap;class IS{static get DEFAULT_WIDTH(){return 50}constructor(e){let{totalColumns:n,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:o}=e;Th(this,"stretchAllRatio",0),Th(this,"stretchLastWidth",0),Th(this,"stretchAllColumnsWidth",[]),su(this,_h,{writable:!0,value:0}),Th(this,"needVerifyLastColumnWidth",!0),su(this,xa,{writable:!0,value:()=>0}),su(this,lu,{writable:!0,value:s=>s}),su(this,Mh,{writable:!0,value:s=>s}),su(this,Ms,{writable:!0,value:()=>"none"}),au(this,xa,n),au(this,Ms,r),au(this,lu,i??pn(this,lu)),au(this,Mh,o??pn(this,Mh))}refreshStretching(e){if(pn(this,Ms).call(this)==="none")return;au(this,_h,e);let n=0;for(let i=0;i<pn(this,xa).call(this);i++){const o=this._getColumnWidth(i),s=pn(this,lu).call(this,void 0,i);typeof s=="number"?e-=s:n+=o}const r=e-n;if(pn(this,Ms).call(this)==="all"&&r>0)this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(pn(this,Ms).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(pn(this,xa).call(this)-1),o=r+i;this.stretchLastWidth=o>=0?o:i}}getStretchedColumnWidth(e,n){let r=null;return pn(this,Ms).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):pn(this,Ms).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(n*this.stretchAllRatio),o=pn(this,lu).call(this,i,e);o===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===pn(this,xa).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==pn(this,_h)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=pn(this,_h)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===pn(this,xa).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=pn(this,Mh).call(this,e);return isNaN(n)&&(n=IS.DEFAULT_WIDTH),n}}function Ah(t,e,n){return e=kK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kK(t){var e=FK(t,"string");return typeof e=="symbol"?e:String(e)}function FK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WK{constructor(e,n){Ah(this,"dataAccessObject",void 0),Ah(this,"wtSettings",void 0),Ah(this,"headerWidths",new Map),Ah(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=n,this.stretching=new IS({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let n=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,n);return r&&(n=r),n}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:n,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,o=i.offsetHeight<i.scrollHeight?nn():0;this.stretching.refreshStretching(n.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function Z0(t,e,n){return e=VK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VK(t){var e=BK(t,"string");return typeof e=="symbol"?e:String(e)}function BK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UK{constructor(e,n){Z0(this,"dataAccessObject",void 0),Z0(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function hi(t,e,n){return e=YK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YK(t){var e=GK(t,"string");return typeof e=="symbol"?e:String(e)}function GK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zK{constructor(e,n,r,i,o){hi(this,"wtSettings",null),hi(this,"domBindings",void 0),hi(this,"TBODY",null),hi(this,"THEAD",null),hi(this,"COLGROUP",null),hi(this,"hasTableHeight",!0),hi(this,"hasTableWidth",!0),hi(this,"isTableVisible",!1),hi(this,"tableOffset",0),hi(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,aS(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new UK(this.dataAccessObject,this.wtSettings),this.columnUtils=new WK(this.dataAccessObject,this.wtSettings),this.tableRenderer=new xK({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ee(r,[Pi()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ee(r,[Pi()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ee(r.parentNode,[Pi()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ee(r,[Pi()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,d=e;if(this.isMaster&&(this.holderOffset=en(this.holder),d=i.createRenderCalculators(d),l&&!n.getSetting("fixedColumnsStart"))){const p=r.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,C!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=en(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const p=o>0?this.getFirstRenderedRow():0,C=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new nK(p,o,c),this.columnFilter=new Jj(C,s,l);let S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),S=y.skipRender!==!0}if(S){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Oi)||this.is(as))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let y;if(this.isMaster&&(y=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Oi))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const R=ft(this.hider),T=ft(this.TABLE);R!==0&&T!==R&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Oi)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=ra(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Oi))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=cs(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=aP(r),s=n.cellIndex;return Uo(fa,n,this.wtRootElement)||Uo(ha,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Uo(as,n,this.wtRootElement)||Uo(Oi,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),Uo(fa,n,this.wtRootElement)||Uo(da,n,this.wtRootElement)||Uo(as,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=ra(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=ra(l):o=ra(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ft(this.TABLE)}getHeight(){return xt(this.TABLE)}getTotalWidth(){const e=ft(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=xt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ds(this.TABLE)}_modifyRowHeaderWidth(e){let n=Ct(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Bl=zK,jK="stickyRowsBottom",ox={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Fi(ox,"MIXIN_NAME",jK,{writable:!1,enumerable:!1});const sx=ox,KK="stickyColumnsStart",ax={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Fi(ax,"MIXIN_NAME",KK,{writable:!1,enumerable:!1});const PS=ax;class xS extends Bl{constructor(e,n,r,i){super(e,n,r,i,as)}}pt(xS,sx);pt(xS,PS);const XK=xS,ha="top",Oi="bottom",da="inline_start",fa="top_inline_start_corner",as="bottom_inline_start_corner",qK=[ha,Oi,da,fa,as],ZK=new Map([[ha,`ht_clone_${ha}`],[Oi,`ht_clone_${Oi}`],[da,`ht_clone_${da} ht_clone_left`],[fa,`ht_clone_${fa} ht_clone_top_left_corner`],[as,`ht_clone_${as} ht_clone_bottom_left_corner`]]);function Jm(t,e,n){return e=JK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JK(t){var e=QK(t,"string");return typeof e=="symbol"?e:String(e)}function QK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e3{constructor(e){Jm(this,"dataAccessObject",void 0),Jm(this,"lastScrolledColumnPos",-1),Jm(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?d=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(d=h.scrollTo(e,l?e>a:r)),d&&(this.lastScrolledRowPos=e),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=en(n.wtRootElement),l=Tg(o,o);if(a.top>l){const u=ra(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-g)}else u=en(r.wtRootElement).left;const c=Math.abs(uS(s,s));if(u>c){const h=cS(s);let d=i.getRowHeaderWidth();for(let g=1;g<=o;g++)if(d+=n.sumCellSizes(g-1,g),u+d-c>=h){a=g-2;break}}}return a}}const t3=e3;function Fr(t,e,n){return e=n3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n3(t){var e=r3(t,"string");return typeof e=="symbol"?e:String(e)}function r3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HS{get eventManager(){return new xr(this)}constructor(e,n){Fr(this,"wtTable",void 0),Fr(this,"wtScroll",void 0),Fr(this,"wtViewport",void 0),Fr(this,"wtOverlays",void 0),Fr(this,"selectionManager",void 0),Fr(this,"wtEvent",void 0),Fr(this,"guid",`wt_${tS()}`),Fr(this,"drawInterrupted",!1),Fr(this,"drawn",!1),Fr(this,"domBindings",void 0),Fr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new t3(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){hs(r,e[n])}])}}createCellCoords(e,n){return new _f(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new OS(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function J0(t,e,n){return e=i3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i3(t){var e=o3(t,"string");return typeof e=="symbol"?e:String(e)}function o3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class s3 extends HS{constructor(e,n,r){super(e,n),J0(this,"cloneSource",void 0),J0(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new tx(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function a3(t,e,n){return e=l3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l3(t){var e=u3(t,"string");return typeof e=="symbol"?e:String(e)}function u3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kc{constructor(e,n,r,i,o){a3(this,"wtSettings",null),Fi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=ca(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=ca(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=yc(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){gt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+nn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(qK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${ZK.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ee(o,[Pi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===ha||u==="vertical"&&this.type===da?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=yc(e.TABLE),new s3(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;E([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class c3 extends Kc{constructor(e,n,r,i,o,s){super(e,n,as,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new XK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Bc(n),this.repositionOverlay();let r=xt(this.clone.wtTable.TABLE);const i=ft(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=nn(r)),i.style.bottom=`${o}px`}}const h3="calculatedColumns",lx={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Fi(lx,"MIXIN_NAME",h3,{writable:!1,enumerable:!1});const DS=lx;class NS extends Bl{constructor(e,n,r,i){super(e,n,r,i,Oi)}}pt(NS,sx);pt(NS,DS);const d3=NS;function f3(t,e,n){return e=g3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g3(t){var e=m3(t,"string");return typeof e=="symbol"?e:String(e)}function m3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p3 extends Kc{constructor(e,n,r,i){super(e,n,Oi,r,i),f3(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new d3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=nn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Eg(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=nn(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=xt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=nn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Tg(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ie(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(Le(s,"innerBorderBottom"),o=a)}return o}}const w3="calculatedRows",ux={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Fi(ux,"MIXIN_NAME",w3,{writable:!1,enumerable:!1});const cx=ux;class LS extends Bl{constructor(e,n,r,i){super(e,n,r,i,da)}}pt(LS,cx);pt(LS,PS);const C3=LS,v3="localHooks",hx={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Sf(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Fi(hx,"MIXIN_NAME",v3,{writable:!1,enumerable:!1});const or=hx;let dx=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};pt(dx,or);const S3=dx,fx="active-header",$S="header",kS="area",FS="focus",y3="fill",b3="row",R3="column",E3="custom-selection",WS=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var T3=XP;T3("flat");function _3(t,e){gx(t,e),e.add(t)}function Q0(t,e,n){gx(t,e),e.set(t,n)}function gx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Gt(t,e){var n=mx(t,e,"get");return M3(t,n)}function M3(t,e){return e.get?e.get.call(t):e.value}function eE(t,e,n){var r=mx(t,e,"set");return A3(t,r,n),n}function mx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function A3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wr=new WeakMap,Xn=new WeakMap,Oh=new WeakSet;class O3{constructor(){_3(this,Oh),Q0(this,Wr,{writable:!0,value:void 0}),Q0(this,Xn,{writable:!0,value:void 0})}setActiveOverlay(e){return eE(this,Xn,e),this}setActiveSelection(e){return eE(this,Wr,e),this}scan(){const e=Gt(this,Wr).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Gt(this,Wr).getCorners(),{wtTable:s}=Gt(this,Xn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const g=d+l;let p=s.getColumnHeader(h,g);const C=Gt(this,Xn).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Gt(this,Wr).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});C!==null&&(C!==h&&(p=s.getColumnHeader(C,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Gt(this,Wr).getCorners(),{wtTable:s}=Gt(this,Xn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const g=d+l;let p=s.getRowHeader(h,g);const C=Gt(this,Xn).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Gt(this,Wr).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});C!==null&&(C!==h&&(p=s.getRowHeader(C,g)),e(p))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=Gt(this,Wr).getCorners(),{wtTable:s}=Gt(this,Xn);Qm(this,Oh,ep).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(Gt(this,Xn).createCellCoords(a,l)),c=Gt(this,Xn).getSetting("onAfterDrawSelection",a,l,Gt(this,Wr).settings.layerLevel);typeof c=="string"&&q(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=Gt(this,Wr).getCorners(),{wtTable:i}=Gt(this,Xn);Qm(this,Oh,ep).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Gt(this,Xn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Gt(this,Wr).getCorners(),{wtTable:i}=Gt(this,Xn);Qm(this,Oh,ep).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Gt(this,Xn).createCellCoords(o,s));e(a)}})}}function ep(t){const{wtTable:e}=Gt(this,Xn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class I3{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=WS,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Lr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),uo()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ye(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ye(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),C=parseInt(c.width,10),S=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(r-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(r-C/4*3,10)}px`,c[l]=`${parseInt(i-C/4*3,10)}px`;const R=Math.min(parseInt(i+o,10),S-p-g*2),T=Math.min(parseInt(i+o-C/4,10),S-C-g*2);h[l]=`${R}px`,d[l]=`${T}px`;const N=Math.min(parseInt(r+s,10),y-p-g*2),I=Math.min(parseInt(r+s-C/4,10),y-C-g*2);h.top=`${N}px`,d.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let pe=0;pe<h;pe+=1){const f=n.rowFilter.renderedToSource(pe);if(f>=e[0]&&f<=e[2]){o=f,u=e[0];break}}for(let pe=h-1;pe>=0;pe-=1){const f=n.rowFilter.renderedToSource(pe);if(f>=e[0]&&f<=e[2]){s=f;break}}const d=n.getRenderedColumnsCount();for(let pe=0;pe<d;pe+=1){const f=n.columnFilter.renderedToSource(pe);if(f>=e[1]&&f<=e[3]){a=f,c=e[1];break}}for(let pe=d-1;pe>=0;pe-=1){const f=n.columnFilter.renderedToSource(pe);if(f>=e[1]&&f<=e[3]){l=f;break}}if(o===void 0||a===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(o,a));const p=o!==s||a!==l,C=p?n.getCell(this.wot.createCellCoords(s,l)):g,S=en(g),y=p?en(C):S,R=en(n.TABLE),T=ft(n.TABLE),N=S.top,I=S.left,F=this.wot.wtSettings.getSetting("rtlMode");let B=0,ee=0;if(F){const pe=ft(g),f=i.innerWidth-R.left-T;ee=I+pe-y.left,B=i.innerWidth-I-pe-f-1}else ee=y.left+ft(C)-I,B=I-R.left-1;if(this.isEntireColumnSelected(o,s)){const pe=this.getDimensionsFromHeader("columns",a,l,u,R);let f=null;pe&&([f,B,ee]=pe),f&&(g=f)}let U=N-R.top-1,j=y.top+xt(C)-N;if(this.isEntireRowSelected(a,l)){const pe=this.getDimensionsFromHeader("rows",o,s,c,R);let f=null;pe&&([f,U,j]=pe),f&&(g=f)}const re=Co(g,i);parseInt(re.borderTopWidth,10)>0&&(U+=1,j=j>0?j-1:0),parseInt(re[F?"borderRightWidth":"borderLeftWidth"],10)>0&&(B+=1,ee=ee>0?ee-1:0);const ie=F?"right":"left";this.topStyle.top=`${U}px`,this.topStyle[ie]=`${B}px`,this.topStyle.width=`${ee}px`,this.topStyle.display="block",this.startStyle.top=`${U}px`,this.startStyle[ie]=`${B}px`,this.startStyle.height=`${j}px`,this.startStyle.display="block";const oe=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${U+j-oe}px`,this.bottomStyle[ie]=`${B}px`,this.bottomStyle.width=`${ee}px`,this.bottomStyle.display="block",this.endStyle.top=`${U}px`,this.endStyle[ie]=`${B+ee-oe}px`,this.endStyle.height=`${j+1}px`,this.endStyle.display="block";let Ce=this.settings.border.cornerVisible;Ce=typeof Ce=="function"?Ce(this.settings.layerLevel):Ce;const Me=this.wot.getSetting("onModifyGetCellCoords",s,l);let[rt,Fe]=[s,l];if(Me&&Array.isArray(Me)&&([,,rt,Fe]=Me),uo()||!Ce||this.isPartRange(rt,Fe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${U+j+this.cornerCenterPointOffset-1}px`,this.cornerStyle[ie]=`${B+ee+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let pe=ca(n.TABLE);const f=pe===i;f&&(pe=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const A=f?C.getBoundingClientRect().left:C.offsetLeft;let O=!1,D=0;F?(D=A-parseInt(this.cornerDefaultStyle.width,10)/2,O=D<0):(D=A+ft(C)+parseInt(this.cornerDefaultStyle.width,10)/2,O=D>=cS(pe)),O&&(this.cornerStyle[ie]=`${Math.floor(B+ee+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[F?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(f?C.getBoundingClientRect().top:C.offsetTop)+xt(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=ra(pe)&&(this.cornerStyle.top=`${Math.floor(U+j+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}uo()&&this.updateMultipleSelectionHandlesPosition(s,l,U,B,ee,j)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,p=null,C=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return xt(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ft(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const S=this.wot.getSetting("columnHeaders").length;if(p=l(n,S-i),C=l(r,S-i),!p||!C)return!1;const y=en(p),R=en(C);return p&&C&&(h=y[g]-o[g]-1,d=R[g]+u(C)-y[g]),[p,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(Ie(this[e],"hidden")&&Le(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):Le(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",uo()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const tE=I3;function P3(t,e){px(t,e),e.add(t)}function Ha(t,e,n){px(t,e),e.set(t,n)}function px(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x3(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Xe(t,e){var n=wx(t,e,"get");return H3(t,n)}function H3(t,e){return e.get?e.get.call(t):e.value}function nE(t,e,n){var r=wx(t,e,"set");return D3(t,r,n),n}function wx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function D3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Sn=new WeakMap,er=new WeakMap,tp=new WeakMap,Uu=new WeakMap,np=new WeakMap,As=new WeakMap,rE=new WeakSet;class N3{constructor(e){P3(this,rE),Ha(this,Sn,{writable:!0,value:void 0}),Ha(this,er,{writable:!0,value:void 0}),Ha(this,tp,{writable:!0,value:new O3}),Ha(this,Uu,{writable:!0,value:new WeakMap}),Ha(this,np,{writable:!0,value:new WeakSet}),Ha(this,As,{writable:!0,value:new Map}),nE(this,er,e)}setActiveOverlay(e){return nE(this,Sn,e),Xe(this,tp).setActiveOverlay(Xe(this,Sn)),Xe(this,Uu).has(Xe(this,Sn))||Xe(this,Uu).set(Xe(this,Sn),new Set),this}getFocusSelection(){return Xe(this,er)!==null?Xe(this,er).getFocus():null}getAreaSelection(){return Xe(this,er)!==null?Xe(this,er).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Xe(this,As).has(e)){const r=Xe(this,As).get(e);if(r.has(Xe(this,Sn)))return r.get(Xe(this,Sn));const i=new tE(Xe(this,Sn),e.settings);return r.set(Xe(this,Sn),i),i}const n=new tE(Xe(this,Sn),e.settings);return Xe(this,As).set(e,new Map([[Xe(this,Sn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Xe(this,As).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Xe(this,As).get(e).forEach(n=>n.destroy()),Xe(this,As).delete(e)}render(e){if(Xe(this,er)===null)return;e&&x3(this,rE,L3).call(this);const n=Array.from(Xe(this,er)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Xe(this,np).has(s)||(Xe(this,np).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Xe(this,tp).setActiveSelection(s).scan().forEach(p=>{if(r.has(p)){const C=r.get(p);C.has(a)&&u===!0?C.set(a,C.get(a)+1):C.set(a,1)}else r.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const d=s.getCorners();Xe(this,Sn).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>Xe(this,Uu).get(Xe(this,Sn)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=Xe(this,er).options)===null||a===void 0?void 0:a.cellAttributes)&&Ee(s,Xe(this,er).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ee(o,[...i.get(o)])})}}function L3(){const t=Xe(this,Uu).get(Xe(this,Sn)),e=Xe(this,Sn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Xe(this,Sn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Xe(this,er).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Xe(this,er).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Xe(this,er).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Xe(this,er).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Le(o[a],n),va(o[a],s)}),t.clear()}class $3 extends Kc{constructor(e,n,r,i){super(e,n,da,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new C3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),_g(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Bc(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,lS(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=nn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ft(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(WS.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=nn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(uS(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Le(n,"emptyRows"):q(n,"emptyRows");let s=!1;if(i&&!r.length)q(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=Ie(n,"innerBorderInlineStart");e?(q(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(Le(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const k3="stickyRowsTop",Cx={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Fi(Cx,"MIXIN_NAME",k3,{writable:!1,enumerable:!1});const vx=Cx;class VS extends Bl{constructor(e,n,r,i){super(e,n,r,i,fa)}}pt(VS,vx);pt(VS,PS);const F3=VS;function iE(t,e,n){return e=W3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W3(t){var e=V3(t,"string");return typeof e=="symbol"?e:String(e)}function V3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B3 extends Kc{constructor(e,n,r,i,o,s){super(e,n,fa,r,i),iE(this,"topOverlay",void 0),iE(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new F3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();_g(e,`${i}px`,`${o}px`)}else Bc(e);let n=xt(this.clone.wtTable.TABLE);const r=ft(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class BS extends Bl{constructor(e,n,r,i){super(e,n,r,i,ha)}}pt(BS,vx);pt(BS,DS);const U3=BS;function Y3(t,e,n){return e=G3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G3(t){var e=z3(t,"string");return typeof e=="symbol"?e:String(e)}function z3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class j3 extends Kc{constructor(e,n,r,i){super(e,n,ha,r,i),Y3(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new U3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),_g(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Bc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Eg(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=nn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=xt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(WS.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=nn(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Tg(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Le(r,"emptyColumns"):q(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=Ie(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(q(r,"innerBorderTop"),o=!u):(Le(r,"innerBorderTop"),o=u)}}return o}}function Yi(t,e,n){return e=K3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K3(t){var e=X3(t,"string");return typeof e=="symbol"?e:String(e)}function X3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q3{constructor(e,n,r,i,o,s){Yi(this,"wot",null),Yi(this,"topOverlay",null),Yi(this,"bottomOverlay",null),Yi(this,"inlineStartOverlay",null),Yi(this,"topInlineStartCornerOverlay",null),Yi(this,"bottomInlineStartCornerOverlay",null),Yi(this,"browserLineHeight",void 0),Yi(this,"wtSettings",null),Yi(this,"resizeObserver",new ResizeObserver(c=>{Pg(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=nn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:yc(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new j3(...e),this.bottomOverlay=new p3(...e),this.inlineStartOverlay=new $3(...e),this.topInlineStartCornerOverlay=new B3(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new c3(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!wS())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Vl(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=yc(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:d}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return E(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];E(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const Z3=q3;function oE(t,e,n){return e=J3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J3(t){var e=Q3(t,"string");return typeof e=="symbol"?e:String(e)}function Q3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class e4{constructor(e){oE(this,"settings",{}),oE(this,"defaults",Object.freeze(this.getDefaults())),Ye(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);hs(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ye(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class US extends Bl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=ca(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Il(e,"height",n),o=Il(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const g=parseInt(Co(d,n).height,10);r.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ds(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}pt(US,cx);pt(US,DS);const t4=US;class n4{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=xt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let d,g;if(a)return ft(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,o):d=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>d)return n.documentElement.clientWidth;if(i!==r&&(g=Il(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(d,i.clientWidth);const p=e.getSetting("stretchH");return p==="none"||!p?Math.max(d,ft(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return en(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=xt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=ft(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Go;const{wtSettings:n,wtTable:r}=this;if(n.getSetting("renderAllRows")&&e===Go)return new zz({totalRows:n.getSetting("totalRows")});let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=nn(this.domBindings.rootDocument),new Ng({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Go;const{wtSettings:n,wtTable:r}=this;if(n.getSetting("renderAllColumns")&&e===Go)return new Uz({totalColumns:n.getSetting("totalColumns")});let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=nn(this.domBindings.rootDocument)),new zc({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this;if(e&&!n.getSetting("renderAllRows")){const r=this.createRowsCalculator(yn);e=this.areAllProposedVisibleRowsAlreadyRendered(r)}if(e&&!n.getSetting("renderAllColumns")){const r=this.createColumnsCalculator(yn);e=this.areAllProposedVisibleColumnsAlreadyRendered(r)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(Go),this.columnsRenderCalculator=this.createColumnsCalculator(Go)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(yn),this.columnsVisibleCalculator=this.createColumnsCalculator(yn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ye(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const r4=n4;class i4 extends HS{constructor(e,n){super(e,new e4(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new t4(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new r4(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new N3(this.wtSettings.getSetting("selections")),this.wtEvent=new tx(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Z3(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ye(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),Le(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class YS{constructor(e){e instanceof HS?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new YS(n);return()=>r},this._wot=new i4(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function sE(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function o4(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const s4=new Map([["mousedown",sE],["mouseover",o4],["touchstart",sE]]);function aE(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;s4.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:xg(t)||t.type==="touchstart",isRightClick:fs(t)})}const Sx=new WeakMap,GS=Symbol("rootInstance");function a4(t){Sx.set(t,!0)}function l4(t){return t===GS}function Yd(t){return Sx.has(t)}function lE(t,e){yx(t,e),e.add(t)}function Os(t,e,n){yx(t,e),e.set(t,n)}function yx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xo(t,e,n){return e=u4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u4(t){var e=c4(t,"string");return typeof e=="symbol"?e:String(e)}function c4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function an(t,e){var n=bx(t,e,"get");return h4(t,n)}function h4(t,e){return e.get?e.get.call(t):e.value}function Sr(t,e,n){var r=bx(t,e,"set");return d4(t,r,n),n}function bx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function d4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var rp=new WeakMap,Ih=new WeakMap,Ph=new WeakMap,Gi=new WeakMap,Vr=new WeakMap,ip=new WeakMap,op=new WeakMap,HC=new WeakSet,uE=new WeakSet;class f4{constructor(e){lE(this,uE),lE(this,HC),xo(this,"hot",void 0),xo(this,"eventManager",void 0),xo(this,"settings",void 0),xo(this,"THEAD",void 0),xo(this,"TBODY",void 0),xo(this,"_wt",void 0),xo(this,"activeWt",void 0),Os(this,rp,{writable:!0,value:0}),Os(this,Ih,{writable:!0,value:0}),xo(this,"postponedAdjustElementsSize",!1),Os(this,Ph,{writable:!0,value:!1}),Os(this,Gi,{writable:!0,value:void 0}),Os(this,Vr,{writable:!0,value:void 0}),Os(this,ip,{writable:!0,value:0}),Os(this,op,{writable:!0,value:0}),this.hot=e,this.eventManager=new xr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),Sr(this,Vr,n.createElement("TABLE")),q(an(this,Vr),"htCore"),this.hot.getSettings().tableClassName&&q(an(this,Vr),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ee(an(this,Vr),[Pi()]),Ee(e,[WY(),nP(-1),Rg(this.hot.countCols()),QY()])),this.THEAD=n.createElement("THEAD"),an(this,Vr).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),an(this,Vr).appendChild(this.TBODY),this.hot.table=an(this,Vr),this.hot.container.insertBefore(an(this,Vr),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(Sr(this,Ph,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;SC(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{Sr(this,Ph,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{an(this,Ph)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&SC(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&xg(o)&&r.finish(),Sr(this,Gi,!1);const s=Mg(n.activeElement);Qu(n.activeElement)&&!s||(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!fs(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&fs(o)&&(r.finish(),Sr(this,Gi,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),Sr(this,Gi,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(an(this,Gi)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const d=nn(n);if(n.elementFromPoint(a+d,l)!==c||n.elementFromPoint(a,l+d)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(an(this,Vr),"selectstart",o=>{this.settings.fragmentSelection||Qu(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:an(this,Vr),isDataViewInstance:()=>Yd(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Sr(this,Ih,o.length),this.hot.getSettings().ariaTags&&xC(this,HC,Rx).call(this)===this.hot.countCols()&&xC(this,uE,g4).call(this,an(this,Ih)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Sr(this,rp,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let C=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(C=this.hot.runHooks("beforeValueRender",C,g)),this.hot.runHooks("beforeRenderer",a,l,u,p,C,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,p,C,g),this.hot.runHooks("afterRenderer",a,l,u,p,C,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ds(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Sr(this,Gi,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ko(o)&&(aE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Sr(this,Gi,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ko(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ko(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ko(o)&&(an(this,Gi)&&aE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ko(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[g,p,C,S]=d;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,-1)):C,S>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(S,-1)):S]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new YS(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Qu(e))return!0;const n=os(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return an(this,Gi)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Ie(r,"relative")){oi(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;Ie(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(oi(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Ee(s,...Pi()),Ee(a,...Pi())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ie(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ie(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Sa(e,r(n,i)):(hs(e,String.fromCharCode(160)),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Sr(this,ip,e),Sr(this,op,n)}getLastSize(){return{width:an(this,ip),height:an(this,op)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return an(this,rp)}getRowHeadersCount(){return an(this,Ih)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function Rx(){return parseInt(this.hot.rootElement.getAttribute(Rg()[0]),10)}function g4(t){const e=xC(this,HC,Rx).call(this)+t;Ee(this.hot.rootElement,...Rg(e))}const m4=f4,Ex="ABCDEFGHIJKLMNOPQRSTUVWXYZ",DC=Ex.length;function Lg(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%DC,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/DC,10);return n}function p4(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=DC**r*(Ex.indexOf(t[n])+1);return e-=1,e}function w4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Lg(i)+(r+1));n.push(o)}return n}function C4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Lg(i)+(r+1);n.push(o)}return n}function v4(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function zS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function jS(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ve(t[0])&&(e=Ig(t[0]))),e}function Tx(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function _x(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const S4=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:jS,createEmptySpreadsheetData:v4,createSpreadsheetData:w4,createSpreadsheetObjectData:C4,dataRowToChangesArray:zS,isArrayOfArrays:Tx,isArrayOfObjects:_x,spreadsheetColumnIndex:p4,spreadsheetColumnLabel:Lg},Symbol.toStringTag,{value:"Module"}));function uu(t,e,n){return e=y4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y4(t){var e=b4(t,"string");return typeof e=="symbol"?e:String(e)}function b4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];uu(this,"hot",void 0),uu(this,"data",void 0),uu(this,"dataType","array"),uu(this,"colToProp",()=>{}),uu(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return E(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):me(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Ve(s)||Ct(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;me(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const d=this.getAtPhysicalCell(e,h,s);i?a.push(d):Wd(a,h,d)}})}else Ye(s,(l,u)=>{Wd(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=ei(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:Wd(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=bP(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=ei(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return me(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return jS(this.data)}destroy(){this.data=null,this.hot=null}}const E4=R4;function cE(t,e,n){return e=T4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T4(t){var e=_4(t,"string");return typeof e=="symbol"?e:String(e)}function _4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ya{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;cE(this,"indexedValues",[]),cE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ct(this.initValueOrFn)?me(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}pt(ya,or);function KS(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>Ct(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function XS(t,e){return pr(t,(n,r)=>e.includes(r)===!1)}class ys extends ya{insert(e,n){this.indexedValues=KS(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=XS(this.indexedValues,e),super.remove(e)}}class $g extends ys{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Yt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function qS(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Ec(t,e){return pr(t,n=>e.includes(n)===!1)}function ZS(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function JS(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function M4(t,e,n){return e=A4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A4(t){var e=O4(t,"string");return typeof e=="symbol"?e:String(e)}function O4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kg extends ya{constructor(){super(...arguments),M4(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ec(this.orderOfIndexes,[e]),Ct(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=KS(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=JS(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=XS(this.indexedValues,e),this.orderOfIndexes=Ec(this.orderOfIndexes,e),this.orderOfIndexes=ZS(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Xc extends ys{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Yt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const hE=new Map([["indexesSequence",{getListWithInsertedItems:qS,getListWithRemovedItems:Ec}],["physicallyIndexed",{getListWithInsertedItems:KS,getListWithRemovedItems:XS}]]),Mx=t=>{if(hE.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return hE.get(t)};class Ax extends ya{constructor(){super(e=>e)}insert(e,n){const r=JS(this.indexedValues,n);this.indexedValues=qS(r,e,n),super.insert(e,n)}remove(e){const n=Ec(this.indexedValues,e);this.indexedValues=ZS(n,e),super.remove(e)}}const dE=new Map([["hiding",$g],["index",ya],["linkedPhysicalIndexToValue",kg],["physicalIndexToValue",ys],["trimming",Xc]]);function I4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!dE.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(dE.get(t))(e)}function P4(t,e,n){return e=x4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x4(t){var e=H4(t,"string");return typeof e=="symbol"?e:String(e)}function H4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let NC=0;class QS{constructor(){P4(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),NC+=1)}unregister(e){const n=this.collection.get(e);ue(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),NC-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return vt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}pt(QS,or);function D4(){return NC}function sp(t,e,n){return e=N4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N4(t){var e=L4(t,"string");return typeof e=="symbol"?e:String(e)}function L4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fE extends QS{constructor(e,n){super(),sp(this,"mergedValuesCache",[]),sp(this,"aggregationFunction",void 0),sp(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=ue(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ue(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function $4(t,e,n){k4(t,e),e.set(t,n)}function k4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F4(t,e,n){var r=Ox(t,e,"set");return W4(t,r,n),n}function W4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function V4(t,e){var n=Ox(t,e,"get");return B4(t,n)}function Ox(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function B4(t,e){return e.get?e.get.call(t):e.value}var ap=new WeakMap;class Ix{constructor(){$4(this,ap,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(V4(this,ap)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){F4(this,ap,e)}}pt(Ix,or);function gE(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function cu(t,e,n){U4(t,e),e.set(t,n)}function U4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yr(t,e){var n=Px(t,e,"get");return Y4(t,n)}function Y4(t,e){return e.get?e.get.call(t):e.value}function xh(t,e,n){var r=Px(t,e,"set");return G4(t,r,n),n}function Px(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function G4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Hh=new WeakMap,hu=new WeakMap,Dh=new WeakMap,Nh=new WeakMap,Lh=new WeakMap;class z4{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};cu(this,Hh,{writable:!0,value:new Set}),cu(this,hu,{writable:!0,value:[]}),cu(this,Dh,{writable:!0,value:[]}),cu(this,Nh,{writable:!0,value:!1}),cu(this,Lh,{writable:!0,value:!1}),xh(this,Lh,e??!1)}createObserver(){const e=new Ix;return yr(this,Hh).add(e),e.addLocalHook("unsubscribe",()=>{yr(this,Hh).delete(e)}),e._writeInitialChanges(gE(yr(this,hu),yr(this,Dh))),e}emit(e){let n=yr(this,Dh);(!yr(this,Nh)||yr(this,hu).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(yr(this,Lh)):xh(this,hu,new Array(e.length).fill(yr(this,Lh))),yr(this,Nh)||(xh(this,Nh,!0),n=yr(this,hu)));const r=gE(n,e);yr(this,Hh).forEach(i=>i._write(r)),xh(this,Dh,e)}}function xn(t,e,n){return e=j4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j4(t){var e=K4(t,"string");return typeof e=="symbol"?e:String(e)}function K4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LC{constructor(){xn(this,"indexesSequence",new Ax),xn(this,"trimmingMapsCollection",new fE(e=>e.some(n=>n===!0),!1)),xn(this,"hidingMapsCollection",new fE(e=>e.some(n=>n===!0),!1)),xn(this,"variousMapsCollection",new QS),xn(this,"hidingChangesObservable",new z4({initialIndexValue:!1})),xn(this,"notTrimmedIndexesCache",[]),xn(this,"notHiddenIndexesCache",[]),xn(this,"isBatched",!1),xn(this,"indexesSequenceChanged",!1),xn(this,"indexesChangeSource",void 0),xn(this,"trimmedIndexesChanged",!1),xn(this,"hiddenIndexesChanged",!1),xn(this,"renderablePhysicalIndexesCache",[]),xn(this,"fromPhysicalToVisualIndexesCache",new Map),xn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,I4(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Xc?this.trimmingMapsCollection.register(e,n):n instanceof $g?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ue(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ue(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ue(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ue(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Ec(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(qS(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ue(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}pt(LC,or);function X4(t,e){return Ye(e,(n,r)=>{vt(t[r])&&(t[r]=n)}),t}function xx(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Hx(t){ue(t)&&bS(ht`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function q4(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Z4,getValues:J4}=ai("phraseFormatters");function Q4(t,e){Z4(t,e)}function e6(){return J4()}Q4("pluralize",q4);const Dx="ContextMenu:items",ke=Dx,ey=`${ke}.noItems`,ty=`${ke}.insertRowAbove`,ny=`${ke}.insertRowBelow`,ry=`${ke}.insertColumnOnTheLeft`,iy=`${ke}.insertColumnOnTheRight`,oy=`${ke}.removeRow`,sy=`${ke}.removeColumn`,ay=`${ke}.undo`,ly=`${ke}.redo`,uy=`${ke}.readOnly`,cy=`${ke}.clearColumn`,hy=`${ke}.copy`,dy=`${ke}.copyWithHeaders`,fy=`${ke}.copyWithGroupHeaders`,gy=`${ke}.copyHeadersOnly`,my=`${ke}.cut`,py=`${ke}.freezeColumn`,wy=`${ke}.unfreezeColumn`,Cy=`${ke}.mergeCells`,vy=`${ke}.unmergeCells`,Sy=`${ke}.addComment`,yy=`${ke}.editComment`,by=`${ke}.removeComment`,Ry=`${ke}.readOnlyComment`,Ey=`${ke}.align`,Ty=`${ke}.align.left`,_y=`${ke}.align.center`,My=`${ke}.align.right`,Ay=`${ke}.align.justify`,Oy=`${ke}.align.top`,Iy=`${ke}.align.middle`,Py=`${ke}.align.bottom`,xy=`${ke}.borders`,Hy=`${ke}.borders.top`,Dy=`${ke}.borders.right`,Ny=`${ke}.borders.bottom`,Ly=`${ke}.borders.left`,$y=`${ke}.borders.remove`,ky=`${ke}.nestedHeaders.insertChildRow`,Fy=`${ke}.nestedHeaders.detachFromParent`,Wy=`${ke}.hideColumn`,Vy=`${ke}.showColumn`,By=`${ke}.hideRow`,Uy=`${ke}.showRow`,Yn="Filters:",Vt=`${Yn}conditions`,Fg=`${Vt}.none`,Yy=`${Vt}.isEmpty`,Gy=`${Vt}.isNotEmpty`,zy=`${Vt}.isEqualTo`,jy=`${Vt}.isNotEqualTo`,Ky=`${Vt}.beginsWith`,Xy=`${Vt}.endsWith`,qy=`${Vt}.contains`,Zy=`${Vt}.doesNotContain`,t6=`${Vt}.byValue`,Jy=`${Vt}.greaterThan`,Qy=`${Vt}.greaterThanOrEqualTo`,eb=`${Vt}.lessThan`,tb=`${Vt}.lessThanOrEqualTo`,nb=`${Vt}.isBetween`,rb=`${Vt}.isNotBetween`,ib=`${Vt}.after`,ob=`${Vt}.before`,sb=`${Vt}.today`,ab=`${Vt}.tomorrow`,lb=`${Vt}.yesterday`,ub=`${Yn}labels.filterByCondition`,cb=`${Yn}labels.filterByValue`,hb=`${Yn}labels.conjunction`,Wg=`${Yn}labels.disjunction`,Of=`${Yn}values.blankCells`,db=`${Yn}buttons.selectAll`,fb=`${Yn}buttons.clear`,gb=`${Yn}buttons.ok`,mb=`${Yn}buttons.cancel`,pb=`${Yn}buttons.placeholder.search`,wb=`${Yn}buttons.placeholder.value`,Cb=`${Yn}buttons.placeholder.secondValue`,vb="CheckboxRenderer:",Sb=`${vb}checked`,yb=`${vb}unchecked`,n6=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:Sb,CHECKBOX_RENDERER_NAMESPACE:vb,CHECKBOX_UNCHECKED:yb,CONTEXTMENU_ITEMS_ADD_COMMENT:Sy,CONTEXTMENU_ITEMS_ALIGNMENT:Ey,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:Py,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:_y,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Ay,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Ty,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Iy,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:My,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Oy,CONTEXTMENU_ITEMS_BORDERS:xy,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Ny,CONTEXTMENU_ITEMS_BORDERS_LEFT:Ly,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Dy,CONTEXTMENU_ITEMS_BORDERS_TOP:Hy,CONTEXTMENU_ITEMS_CLEAR_COLUMN:cy,CONTEXTMENU_ITEMS_COPY:hy,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:gy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:fy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:dy,CONTEXTMENU_ITEMS_CUT:my,CONTEXTMENU_ITEMS_EDIT_COMMENT:yy,CONTEXTMENU_ITEMS_FREEZE_COLUMN:py,CONTEXTMENU_ITEMS_HIDE_COLUMN:Wy,CONTEXTMENU_ITEMS_HIDE_ROW:By,CONTEXTMENU_ITEMS_INSERT_LEFT:ry,CONTEXTMENU_ITEMS_INSERT_RIGHT:iy,CONTEXTMENU_ITEMS_MERGE_CELLS:Cy,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Fy,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:ky,CONTEXTMENU_ITEMS_NO_ITEMS:ey,CONTEXTMENU_ITEMS_READ_ONLY:uy,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Ry,CONTEXTMENU_ITEMS_REDO:ly,CONTEXTMENU_ITEMS_REMOVE_BORDERS:$y,CONTEXTMENU_ITEMS_REMOVE_COLUMN:sy,CONTEXTMENU_ITEMS_REMOVE_COMMENT:by,CONTEXTMENU_ITEMS_REMOVE_ROW:oy,CONTEXTMENU_ITEMS_ROW_ABOVE:ty,CONTEXTMENU_ITEMS_ROW_BELOW:ny,CONTEXTMENU_ITEMS_SHOW_COLUMN:Vy,CONTEXTMENU_ITEMS_SHOW_ROW:Uy,CONTEXTMENU_ITEMS_UNDO:ay,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:wy,CONTEXTMENU_ITEMS_UNMERGE_CELLS:vy,CONTEXT_MENU_ITEMS_NAMESPACE:Dx,FILTERS_BUTTONS_CANCEL:mb,FILTERS_BUTTONS_CLEAR:fb,FILTERS_BUTTONS_OK:gb,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:pb,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Cb,FILTERS_BUTTONS_PLACEHOLDER_VALUE:wb,FILTERS_BUTTONS_SELECT_ALL:db,FILTERS_CONDITIONS_AFTER:ib,FILTERS_CONDITIONS_BEFORE:ob,FILTERS_CONDITIONS_BEGINS_WITH:Ky,FILTERS_CONDITIONS_BETWEEN:nb,FILTERS_CONDITIONS_BY_VALUE:t6,FILTERS_CONDITIONS_CONTAINS:qy,FILTERS_CONDITIONS_EMPTY:Yy,FILTERS_CONDITIONS_ENDS_WITH:Xy,FILTERS_CONDITIONS_EQUAL:zy,FILTERS_CONDITIONS_GREATER_THAN:Jy,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Qy,FILTERS_CONDITIONS_LESS_THAN:eb,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:tb,FILTERS_CONDITIONS_NAMESPACE:Vt,FILTERS_CONDITIONS_NONE:Fg,FILTERS_CONDITIONS_NOT_BETWEEN:rb,FILTERS_CONDITIONS_NOT_CONTAIN:Zy,FILTERS_CONDITIONS_NOT_EMPTY:Gy,FILTERS_CONDITIONS_NOT_EQUAL:jy,FILTERS_CONDITIONS_TODAY:sb,FILTERS_CONDITIONS_TOMORROW:ab,FILTERS_CONDITIONS_YESTERDAY:lb,FILTERS_DIVS_FILTER_BY_CONDITION:ub,FILTERS_DIVS_FILTER_BY_VALUE:cb,FILTERS_LABELS_CONJUNCTION:hb,FILTERS_LABELS_DISJUNCTION:Wg,FILTERS_NAMESPACE:Yn,FILTERS_VALUES_BLANK_CELLS:Of},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const r6={languageCode:"en-US",[ey]:"No available options",[ty]:"Insert row above",[ny]:"Insert row below",[ry]:"Insert column left",[iy]:"Insert column right",[oy]:["Remove row","Remove rows"],[sy]:["Remove column","Remove columns"],[ay]:"Undo",[ly]:"Redo",[uy]:"Read only",[cy]:"Clear column",[Ey]:"Alignment",[Ty]:"Left",[_y]:"Center",[My]:"Right",[Ay]:"Justify",[Oy]:"Top",[Iy]:"Middle",[Py]:"Bottom",[py]:"Freeze column",[wy]:"Unfreeze column",[xy]:"Borders",[Hy]:"Top",[Dy]:"Right",[Ny]:"Bottom",[Ly]:"Left",[$y]:"Remove border(s)",[Sy]:"Add comment",[yy]:"Edit comment",[by]:"Delete comment",[Ry]:"Read-only comment",[Cy]:"Merge cells",[vy]:"Unmerge cells",[hy]:"Copy",[dy]:["Copy with header","Copy with headers"],[fy]:["Copy with group header","Copy with group headers"],[gy]:["Copy header only","Copy headers only"],[my]:"Cut",[ky]:"Insert child row",[Fy]:"Detach from parent",[Wy]:["Hide column","Hide columns"],[Vy]:["Show column","Show columns"],[By]:["Hide row","Hide rows"],[Uy]:["Show row","Show rows"],[Fg]:"None",[Yy]:"Is empty",[Gy]:"Is not empty",[zy]:"Is equal to",[jy]:"Is not equal to",[Ky]:"Begins with",[Xy]:"Ends with",[qy]:"Contains",[Zy]:"Does not contain",[Jy]:"Greater than",[Qy]:"Greater than or equal to",[eb]:"Less than",[tb]:"Less than or equal to",[nb]:"Is between",[rb]:"Is not between",[ib]:"After",[ob]:"Before",[sb]:"Today",[ab]:"Tomorrow",[lb]:"Yesterday",[Of]:"Blank cells",[ub]:"Filter by condition",[cb]:"Filter by value",[hb]:"And",[Wg]:"Or",[db]:"Select all",[fb]:"Clear",[gb]:"OK",[mb]:"Cancel",[pb]:"Search",[wb]:"Value",[Cb]:"Second value",[Sb]:"Checked",[yb]:"Unchecked"},Nx=r6,i6=n6,$C=Nx.languageCode,{register:o6,getItem:Lx,hasItem:s6,getValues:a6}=ai("languagesDictionaries");$x(Nx);function $x(t,e){let n=t,r=e;return Ve(t)&&(r=t,n=r.languageCode),l6(n,r),o6(n,Tn(r)),Tn(r)}function l6(t,e){t!==$C&&X4(e,Lx($C))}function kx(t){return bb(t)?Tn(Lx(t)):null}function bb(t){return s6(t)}function u6(){return a6()}function Fx(t,e,n){const r=kx(t);if(r===null)return null;const i=r[e];if(vt(i))return null;const o=c6(i,n);return Array.isArray(o)?o[0]:o}function c6(t,e){let n=t;return E(e6(),r=>{n=r(t,e)}),n}function h6(t){let e=xx(t);return bb(e)||(e=$C,Hx(t)),e}function d6(t,e,n){return e=f6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f6(t){var e=g6(t,"string");return typeof e=="symbol"?e:String(e)}function g6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m6 extends S3{constructor(e,n){super(e,null),d6(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Mo=m6;function lp(t){let{activeHeaderClassName:e,...n}=t;return new Mo({className:e,...n,selectionType:fx})}function p6(t){let{areaCornerVisible:e,...n}=t;return new Mo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:kS})}function w6(t){let{...e}=t;return new Mo({className:"highlight",...e,selectionType:kS})}function C6(t){let{columnClassName:e,...n}=t;return new Mo({className:e,...n,selectionType:R3})}function v6(t){let{cellCornerVisible:e,...n}=t;return new Mo({className:"current",headerAttributes:[sS()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:FS})}function S6(t){let{border:e,visualCellRange:n,...r}=t;return new Mo({...e,...r,selectionType:E3},n)}function y6(t){let{...e}=t;return new Mo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:y3})}function mE(t){let{headerClassName:e,...n}=t;return new Mo({className:e,...n,selectionType:$S})}function b6(t){let{rowClassName:e,...n}=t;return new Mo({className:e,...n,selectionType:b3})}let Wx;function R6(t,e){E6(t,e),e.add(t)}function E6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(t,e,n){return e=T6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T6(t){var e=_6(t,"string");return typeof e=="symbol"?e:String(e)}function _6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var di=new WeakSet;Wx=Symbol.iterator;class M6{constructor(e){R6(this,di),jn(this,"options",void 0),jn(this,"layerLevel",0),jn(this,"focus",void 0),jn(this,"fill",void 0),jn(this,"layeredAreas",new Map),jn(this,"areas",new Map),jn(this,"rowHeaders",new Map),jn(this,"columnHeaders",new Map),jn(this,"activeRowHeaders",new Map),jn(this,"activeColumnHeaders",new Map),jn(this,"activeCornerHeaders",new Map),jn(this,"rowHighlights",new Map),jn(this,"columnHighlights",new Map),jn(this,"customSelections",[]),this.options=e,this.focus=v6(e),this.fill=y6(e)}isEnabledFor(e,n){let r=e;e===FS&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return zi(this,di,ji).call(this,this.layeredAreas,p6)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return zi(this,di,ji).call(this,this.areas,w6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return zi(this,di,ji).call(this,this.rowHeaders,mE)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return zi(this,di,ji).call(this,this.columnHeaders,mE)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return zi(this,di,ji).call(this,this.activeRowHeaders,lp)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return zi(this,di,ji).call(this,this.activeColumnHeaders,lp)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return zi(this,di,ji).call(this,this.activeCornerHeaders,lp)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return zi(this,di,ji).call(this,this.rowHighlights,b6)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return zi(this,di,ji).call(this,this.columnHighlights,C6)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(S6({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),E(this.areas.values(),e=>void e.clear()),E(this.layeredAreas.values(),e=>void e.clear()),E(this.rowHeaders.values(),e=>void e.clear()),E(this.columnHeaders.values(),e=>void e.clear()),E(this.activeRowHeaders.values(),e=>void e.clear()),E(this.activeColumnHeaders.values(),e=>void e.clear()),E(this.activeCornerHeaders.values(),e=>void e.clear()),E(this.rowHighlights.values(),e=>void e.clear()),E(this.columnHighlights.values(),e=>void e.clear())}[Wx](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ji(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const A6=M6;let Vx;function pE(t,e,n){return e=O6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O6(t){var e=I6(t,"string");return typeof e=="symbol"?e:String(e)}function I6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Vx=Symbol.iterator;class P6{constructor(e){pE(this,"ranges",[]),pE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Vx](){return this.ranges[Symbol.iterator]()}}const x6=P6;function du(t,e){Bx(t,e),e.add(t)}function up(t,e,n){Bx(t,e),e.set(t,n)}function Bx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){var n=Ux(t,e,"get");return H6(t,n)}function H6(t,e){return e.get?e.get.call(t):e.value}function qn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function kC(t,e,n){var r=Ux(t,e,"set");return D6(t,r,n),n}function Ux(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function D6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var $h=new WeakMap,ot=new WeakMap,gs=new WeakMap,cp=new WeakSet,hp=new WeakSet,FC=new WeakSet,dp=new WeakSet,Is=new WeakSet;class Yx{constructor(e,n){du(this,Is),du(this,dp),du(this,FC),du(this,hp),du(this,cp),up(this,$h,{writable:!0,value:void 0}),up(this,ot,{writable:!0,value:void 0}),up(this,gs,{writable:!0,value:{x:0,y:0}}),kC(this,$h,e),kC(this,ot,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;qn(this,cp,wE).call(this,{x:Je(this,ot).navigableHeaders()?Je(this,ot).countRowHeaders():0,y:Je(this,ot).navigableHeaders()?Je(this,ot).countColHeaders():0});const i=Je(this,ot).createCellCoords(e,n);let o=Je(this,$h).current().highlight;const s=Je(this,ot).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=qn(this,FC,Gx).call(this),{row:h,col:d}=qn(this,dp,vE).call(this,o),g=Je(this,ot).fixedRowsBottom(),p=Je(this,ot).minSpareRows(),C=Je(this,ot).minSpareCols(),S=Je(this,ot).autoWrapRow(),y=Je(this,ot).autoWrapCol(),R=Je(this,ot).createCellCoords(h+i.row,d+i.col);if(R.row>=c){const I=ei(r&&p>0&&g===0),F=R.col+1,B=Je(this,ot).createCellCoords(R.row-c,F>=u?F-u:F);this.runLocalHooks("beforeColumnWrap",I,qn(this,Is,Da).call(this,B),F>=u),I.value?this.runLocalHooks("insertRowRequire",Je(this,ot).countRenderableRows()):y&&R.assign(B)}else if(R.row<0){const I=ei(y),F=R.col-1,B=Je(this,ot).createCellCoords(c+R.row,F<0?u+F:F);this.runLocalHooks("beforeColumnWrap",I,qn(this,Is,Da).call(this,B),F<0),y&&R.assign(B)}if(R.col>=u){const I=ei(r&&C>0),F=R.row+1,B=Je(this,ot).createCellCoords(F>=c?F-c:F,R.col-u);this.runLocalHooks("beforeRowWrap",I,qn(this,Is,Da).call(this,B),F>=c),I.value?this.runLocalHooks("insertColRequire",Je(this,ot).countRenderableColumns()):S&&R.assign(B)}else if(R.col<0){const I=ei(S),F=R.row-1,B=Je(this,ot).createCellCoords(F<0?c+F:F,u+R.col);this.runLocalHooks("beforeRowWrap",I,qn(this,Is,Da).call(this,B),F<0),S&&R.assign(B)}const{rowDir:T,colDir:N}=qn(this,hp,CE).call(this,R);a=T,l=N,o=qn(this,Is,Da).call(this,R)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){qn(this,cp,wE).call(this,{x:Je(this,ot).navigableHeaders()?Je(this,ot).countRowHeaders():0,y:Je(this,ot).navigableHeaders()?Je(this,ot).countColHeaders():0});const r=Je(this,ot).createCellCoords(e,n),i=Je(this,$h).current(),o=Je(this,ot).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=qn(this,dp,vE).call(this,i.to),h=Je(this,ot).createCellCoords(u+r.row,c+r.col),{rowDir:d,colDir:g}=qn(this,hp,CE).call(this,h);a=d,l=g;const p=qn(this,Is,Da).call(this,h);r.row===0&&r.col!==0?s.col=p.col:r.row!==0&&r.col===0?s.row=p.row:(s.row=p.row,s.col=p.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function wE(t){let{x:e,y:n}=t;kC(this,gs,{x:e,y:n})}function CE(t){const{width:e,height:n}=qn(this,FC,Gx).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function Gx(){return{width:Je(this,gs).x+Je(this,ot).countRenderableColumns(),height:Je(this,gs).y+Je(this,ot).countRenderableRows()}}function vE(t){const{row:e,col:n}=Je(this,ot).visualToRenderableCoords(t);return Je(this,ot).createCellCoords(Je(this,gs).y+e,Je(this,gs).x+n)}function Da(t){const e=t.clone();return e.col=t.col-Je(this,gs).x,e.row=t.row-Je(this,gs).y,Je(this,ot).renderableToVisualCoords(e)}pt(Yx,or);const N6=Yx,Vg=0,Bg=1,zx=2,Rb=3,L6=[Rb,zx],$6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],fp=Symbol("root"),SE=Symbol("child");function xl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:fp;if(e!==fp&&e!==SE)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===fp;let i=Vg;if(n){const o=t[0];t.length===0?i=Bg:r&&o instanceof OS?i=Rb:r&&Array.isArray(o)?i=xl(o,SE):t.length>=2&&t.length<=4&&!t.some((a,l)=>!$6[l].includes(typeof a))&&(i=zx)}return i}function Tc(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!L6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Rb;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),vt(u)&&(u=a),vt(c)&&(c=l),!r){const g=a,p=l,C=u,S=c;a=Math.min(g,C),l=Math.min(p,S),u=Math.max(g,C),c=Math.max(p,S)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function k6(t){const e=xl(t.getSelected());if(e===Vg||e===Bg)return[];const n=Tc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;E(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;E(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Yt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function F6(t){const e=xl(t.getSelected());if(e===Vg||e===Bg)return[];const n=Tc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;E(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;E(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Yt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function W6(t,e,n){V6(t,e),e.set(t,n)}function V6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(t,e,n){return e=B6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B6(t){var e=U6(t,"string");return typeof e=="symbol"?e:String(e)}function U6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yE(t,e,n){var r=jx(t,e,"set");return Y6(t,r,n),n}function Y6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function bE(t,e){var n=jx(t,e,"get");return G6(t,n)}function jx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function G6(t,e){return e.get?e.get.call(t):e.value}var fu=new WeakMap;class Kx{constructor(e,n){var r=this;Ho(this,"settings",void 0),Ho(this,"tableProps",void 0),Ho(this,"inProgress",!1),Ho(this,"selectedRange",new x6((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Ho(this,"highlight",void 0),Ho(this,"transformation",void 0),Ho(this,"selectedByRowHeader",new Set),Ho(this,"selectedByColumnHeader",new Set),W6(this,fu,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new A6({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[sS()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new N6(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=vt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&vt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(FS,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(E(this.highlight.getAreas(),R=>void R.clear()),E(this.highlight.getLayeredAreas(),R=>void R.clear()),E(this.highlight.getRowHeaders(),R=>void R.clear()),E(this.highlight.getColumnHeaders(),R=>void R.clear()),E(this.highlight.getActiveRowHeaders(),R=>void R.clear()),E(this.highlight.getActiveColumnHeaders(),R=>void R.clear()),E(this.highlight.getActiveCornerHeaders(),R=>void R.clear()),E(this.highlight.getRowHighlights(),R=>void R.clear()),E(this.highlight.getColumnHighlights(),R=>void R.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),d=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),S=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),p.clear(),C.clear(),S.clear(),y.clear(),this.highlight.isEnabledFor(kS,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const R=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(R.from).commit().syncWith(R),this.highlight.createLayeredArea().add(R.from).commit().syncWith(R),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor($S,s.highlight)){if(!s.isSingleHeader()){const N=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),I=this.tableProps.createCellCoords(s.to.row,-1),F=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),B=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(N).commit(),d.add(F).commit(),S.add(N).commit(),y.add(F).commit()):(h.add(N).add(I).commit(),d.add(F).add(B).commit(),S.add(N).add(I).commit(),y.add(F).add(B).commit())}const R=!bE(this,fu)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),T=!bE(this,fu)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());R&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),T&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),R&&T&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=ei(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;yE(this,fu,g),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(ir(d.row,u,o-1),ir(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),C=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.finish(),yE(this,fu,!1)}selectCells(e){var n=this;const r=xl(e);if(r===Bg)return!1;if(r===Vg)throw new Error(ht`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Tc(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),E(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){const g=l===0?0:ir(r,u,-1),p=s-1,C=this.tableProps.createCellCoords(g,i),S=this.tableProps.createCellCoords(p,o),y=this.tableProps.createCellCoords(ir(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",C,S,y),C.row=g,S.row=p,this.setRangeStartOnly(C,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectColumns",C,S,y),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:ir(r,a,-1),d=o-1,g=this.tableProps.createCellCoords(e,h),p=this.tableProps.createCellCoords(n,d),C=this.tableProps.createCellCoords(e,ir(r,a,o-1));this.runLocalHooks("beforeSelectRows",g,p,C),g.col=h,p.col=d,this.setRangeStartOnly(g,void 0,C),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectRows",g,p,C),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}pt(Kx,or);const z6=Kx,RE=/^(\r\n|\n\r|\r|\n)/,j6=/^[^\t\r\n]+/,EE=/^\t/;function K6(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(EE))t=t.replace(EE,""),n+=1,e[r][n]="";else if(t.match(RE))t=t.replace(RE,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(j6);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function ec(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Ps(t,e,n){return e=X6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X6(t){var e=q6(t,"string");return typeof e=="symbol"?e:String(e)}function q6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yl{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Ps(this,"hot",void 0),Ps(this,"metaManager",void 0),Ps(this,"tableMeta",void 0),Ps(this,"dataSource",void 0),Ps(this,"duckSchema",void 0),Ps(this,"colToPropCache",void 0),Ps(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Ig(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Ve(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return jS(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ye(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ue(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ue(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Pl(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Tn(this.getSchema()):(p=[],me(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},Yc(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",g,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),g=0,p=c;i==="end"&&(p=Math.min(p+1,a));const C=p;for(;g<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let y=0;y<h;y+=1)typeof o[y]>"u"&&(o[y]=[]),o[y].push(null);else o.push([null]);else for(let y=0;y<h;y++)o[y].splice(p,0,null);g+=1,p+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):r!=="auto"&&this.metaManager.createColumn(C,n));const S=this.hot.toVisualColumn(C);return this.hot.runHooks("afterCreateCol",S,g,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:C}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];gC(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return KI(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];gC(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Pt(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=ei(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=ei(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Pt(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,yl.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===yl.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,n){return ec(this.getRange(e,n,yl.DESTINATION_RENDERER))}getCopyableText(e,n){return ec(this.getRange(e,n,yl.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const Z6=yl,{register:J6,getItem:Q6,hasItem:Xx,getNames:e9,getValues:hue}=ai("cellTypes");function Eb(t){if(!Xx(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Q6(t)}function br(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&Qn(t,n),r&&lr(t,r),i&&ta(t,i),J6(t,e)}function t9(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Pt(e,t)}function Ug(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Eb(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ye(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ve(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ye(r,(o,s)=>{if(t9(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),jt(t,i)}function n9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}To(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Gd(t){return Number.isInteger(t)&&t>=0}function zd(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function kh(t){return t==null}const qx=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Zt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Zt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Og(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function TE(t,e,n){return e=r9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r9(t){var e=i9(t,"string");return typeof e=="symbol"?e:String(e)}function i9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o9(){return class{}}class s9{constructor(e){TE(this,"metaCtor",o9()),TE(this,"meta",void 0),this.meta=this.metaCtor.prototype,jt(this.meta,qx()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;jt(this.meta,e),Ug(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function a9(t,e,n){return e=l9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l9(t){var e=u9(t,"string");return typeof e=="symbol"?e:String(e)}function u9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c9{constructor(e){a9(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){jt(this.meta,e),Ug(this.meta,e,e)}}let Zx;function Fh(t,e,n){return e=h9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h9(t){var e=d9(t,"string");return typeof e=="symbol"?e:String(e)}function d9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Zx=Symbol.iterator;class If{constructor(e){Fh(this,"valueFactory",void 0),Fh(this,"data",[]),Fh(this,"index",[]),Fh(this,"holes",new Set),this.valueFactory=e}obtain(e){zd(()=>Gd(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zd(()=>Gd(e)||kh(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=kh(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;zd(()=>Gd(e)||kh(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(kh(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return pr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Zx](){return this.entries()}}function _E(t,e,n){return e=f9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f9(t){var e=g9(t,"string");return typeof e=="symbol"?e:String(e)}function g9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const m9=["data","width"];class p9{constructor(e){_E(this,"globalMeta",void 0),_E(this,"metas",new If(()=>this._createMeta())),this.globalMeta=e,this.metas=new If(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);jt(r,n),Ug(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return n9(this.globalMeta.getMetaConstructor(),m9).prototype}}function ME(t,e,n){return e=w9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w9(t){var e=C9(t,"string");return typeof e=="symbol"?e:String(e)}function C9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v9{constructor(e){ME(this,"columnMeta",void 0),ME(this,"metas",new If(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);jt(i,r),Ug(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ue(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){zd(()=>Gd(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new If(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class Jx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new s9(e),this.tableMeta=new c9(this.globalMeta),this.columnMeta=new p9(this.globalMeta),this.cellMeta=new v9(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}pt(Jx,or);function AE(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=En(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Ct(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new Z6(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let C,S=0,y=0;for(S=0,y=d.startRows;S<y;S++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)C=Tn(p),t.push(C);else if(i.dataType==="array")C=Tn(p[0]),t.push(C);else{C=[];for(let R=0,T=d.startCols;R<T;R++)C.push(null);t.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ee(i.rootElement,[nP(-1),Rg(i.countCols()+(i.view?i.countRowHeaders():0))])}function OE(t,e,n){return e=S9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S9(t){var e=y9(t,"string");return typeof e=="symbol"?e:String(e)}function y9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b9{constructor(e){OE(this,"metaManager",void 0),OE(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),de.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Pt(e,"type")?e.type:null;let c=Ct(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function gp(t,e,n){return e=R9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R9(t){var e=E9(t,"string");return typeof e=="symbol"?e:String(e)}function E9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T9{constructor(e){gp(this,"metaManager",void 0),gp(this,"usageTracker",new Set),gp(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const Qx="gridDefault",Tb="editorManager.handlingEditor",_9={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},M9={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},A9={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},O9={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Lr(e))}};function I9(){return[_9,M9,A9,O9]}const P9={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},x9={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},H9={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},D9={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},N9={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},L9={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},$9={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},k9={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},F9={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},W9={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},V9={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},B9={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},U9={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Y9={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function G9(){return[P9,x9,H9,D9,N9,L9,$9,k9,F9,W9,V9,B9,U9,Y9]}const z9={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},j9={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},K9={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},X9={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},q9={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Z9={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},J9={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},Q9={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},e5={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},t5={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},n5={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},r5={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},i5={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},o5={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},s5={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},a5={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function l5(){return[z9,j9,K9,X9,q9,Z9,J9,Q9,e5,t5,n5,r5,i5,o5,s5,a5]}const u5={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},c5={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},h5={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},d5={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},f5={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},g5=[...I9(),...G9(),...l5(),u5,c5,h5,d5,f5];function eH(t){const e={};return g5.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function m5(t){const e=t.getShortcutManager().addContext("editor"),n=eH(t),r={group:Tb};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function p5(t){const e=t.getShortcutManager().addContext("grid"),n=eH(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:Qx};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Tb,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function w5(t){[m5,p5].forEach(e=>e(t))}function C5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=IE(t),i=IE(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function IE(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ee(n,[Pi(),Eo()]),n}function v5(t){const e=S5(t);let n;const{activate:r,deactivate:i}=C5(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:WC(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:VC(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,g,p,C)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,C.value=!0),s){var S;n=(S=t.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Qx,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(n=h.shiftKey?WC(t):VC(t)),u(),!1;h.preventDefault()},position:"after"}])}function WC(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function VC(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function S5(t){return e=>{if(!e)return null;const n=WC(t),r=VC(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}const PE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Wh=t=>t.map(e=>{const n=e.toLowerCase();return PE.has(n)?PE.get(n):n}).sort().join("+"),y5=t=>t.split("+"),xE=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),b5=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),mp=t=>{let{key:e,code:n}=t,r=e;return xE.test(n)?r=n.replace(xE,"$1"):b5.has(n)&&(r=n),r.toLowerCase()},tH=Symbol("shortcut-context");function nH(t){return Ve(t)&&t.__kindOf===tH}const R5=t=>{const e=Dg({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:C,position:S,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(vt(c))throw new Error("You need to define the shortcut's group.");if(Ct(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ht`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:g,stopPropagation:p};ue(C)&&([R.relativeToGroup,R.position]=[C,S]),nH(y)&&(R.forwardToContext=y),l.forEach(T=>{const N=Wh(T);if(e.hasItem(N)){const F=e.getItem(N);let B=F.findIndex(ee=>ee.group===C);B!==-1?S==="before"?B-=1:B+=1:B=F.length,F.splice(B,0,R)}else e.addItem(N,[R])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ye(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Wh(l);e.removeItem(u)};return{__kindOf:tH,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Wh(l),c=e.getItem(u);return ue(c)?c.slice():[]},hasShortcut:l=>{const u=Wh(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const g=d.filter(p=>p.group!==l);g.length===0?i(y5(h)):(d.length=0,d.push(...g))})}}};function E5(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const T5=["meta","alt","shift","control"],gu=E5();let Vh=0;function _5(t,e,n,r,i){const o=g=>T5.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return g.altKey&&C.push("alt"),p&&(g.ctrlKey||g.metaKey)?C.push("control/meta"):(g.ctrlKey&&C.push("control"),g.metaKey&&C.push("meta")),g.shiftKey&&C.push("shift"),C},a=g=>{if(e(g)===!1)return;const p=n(g);if(g.keyCode===229||p===!1||Ko(g))return;const C=mp(g);let S=[];o(C)||(S=s(g));const y=[C].concat(S);!i(g,y)&&(Rc()&&S.includes("meta")||!Rc()&&S.includes("control"))&&i(g,[C].concat(s(g,!0))),r(g)},l=g=>{const p=mp(g);o(p)&&gu.press(p)},u=g=>{const p=mp(g);o(p)&&gu.release(p)},c=()=>{gu.releaseAll()};return{mount:()=>{let g=t;for(Vh+=1;g;)Vh===1&&(g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("keyup",u)),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Sc(g)},unmount:()=>{let g=t;for(Vh-=1;g;)Vh===0&&(g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("keyup",u)),g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Sc(g)},isPressed:g=>gu.isPressed(g),releasePressedKeys:()=>gu.releaseAll()}}const M5=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Dg({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const C=R5(p);return o.addItem(p,C),C},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(ht`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const d=function(p,C){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=nH(S)?S:u(S);let R=!1;if(!y.hasShortcut(C))return R;const T=y.getShortcuts(C);for(let N=0;N<T.length;N++){const{callback:I,runOnlyIf:F,preventDefault:B,stopPropagation:ee,captureCtrl:U,forwardToContext:j}=T[N];if(F(p)===!0){if(h=U,R=I(p,C)===!1,h=!1,B&&p.preventDefault(),ee&&(Lr(p),p.stopPropagation()),R)break;j&&d(p,C,j)}}return R},g=_5(e,n,r,i,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let pp=null;const wp=new Map;function rH(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new xr(s);let l,u,c,h,d,g=!0;l4(i)&&a4(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",C=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=h6(e.language);const S=new Jx(s,e,[b9,T9]),y=S.getTableMeta(),R=S.getGlobalMeta(),T=Dg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Yd(this)&&JI(e.licenseKey,t),this.guid=`ht_${tS()}`,wp.set(this.guid,this),this.columnIndexMapper=new LC,this.rowIndexMapper=new LC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterRowSequenceChange",f)}),u=new E4(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const N=f=>{const{row:m,col:w}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},I=f=>{const{row:m,col:w}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)};let F=new z6(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:f=>l.propToCol(f),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(f,m)=>s._createCellCoords(f,m),createCellRange:(f,m,w)=>s._createCellRange(f,m,w),visualToRenderableCoords:N,renderableToVisualCoords:I,isDisabledCellSelection:(f,m)=>f<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(f,m).disableVisualSelection});this.selection=F;const B=f=>{let{hiddenIndexesChanged:m}=f;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",B),this.rowIndexMapper.addLocalHook("cacheUpdated",B),this.selection.addLocalHook("afterSetRangeEnd",f=>{const m=ei(!1),w=this.selection.getSelectedRange(),{from:A,to:O}=w.current(),D=w.size()-1;this.runHooks("afterSelection",A.row,A.col,O.row,O.col,m,D),this.runHooks("afterSelectionByProp",A.row,s.colToProp(A.col),O.row,s.colToProp(O.col),m,D);let z=!0;o&&(z=!1),m.isTouched()&&(z=!m.value);const G=this.selection.selectedRange.current(),ne=this.selection.isSelectedByAnyHeader(),Z=this.selection.isSelectedByRowHeader(),K=this.selection.isSelectedByColumnHeader();if(z!==!1)if(ne)Z?this.scrollViewportTo({row:f.row}):K&&this.scrollViewportTo({col:f.col});else if(G&&!this.selection.isMultiple()){const{row:Se,col:Pe}=G.from;Se<0&&Pe>=0?this.scrollViewportTo({col:Pe}):Pe<0&&Se>=0?this.scrollViewportTo({row:Se}):this.scrollViewportTo({row:Se,col:Pe})}else this.scrollViewportTo(f.toObject());Z&&K?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Z?(Le(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):K?(Le(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):Le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:w,to:A}=f[m];this.runHooks("afterSelectionEnd",w.row,w.col,A.row,A.col,m),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),A.row,s.colToProp(A.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),Le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),c={alter(f,m){var w,A;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,z=arguments.length>4?arguments[4]:void 0;const G=ne=>{if(ne.length===0)return[];const Z=[...ne];return Z.sort((Se,Pe)=>{let[Oe]=Se,[He]=Pe;return Oe===He?0:Oe>He?1:-1}),Yt(Z,(Se,Pe)=>{let[Oe,He]=Pe;const Y=Se[Se.length-1],[lt,Be]=Y,xe=lt+Be;if(Oe<=xe){const De=Math.max(He-(xe-Oe),0);Y[1]+=De}else Se.push([Oe,He]);return Se},[Z[0]])};switch(f){case"insert_row_below":case"insert_row_above":const ne=s.countSourceRows();if(y.maxRows===ne)return;const Z=f==="insert_row_below"?"below":"above";m=(w=m)!==null&&w!==void 0?w:Z==="below"?ne:0;const{delta:K,startPhysicalIndex:Se}=l.createRow(m,O,{source:D,mode:Z});if(K){const Be=F.selectedRange.current(),xe=Be==null?void 0:Be.from,De=xe==null?void 0:xe.row,be=s.toVisualRow(Se);if(F.isSelectedByCorner())F.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ue(De)&&De>=be){const{row:v,col:b}=Be.to;let _=xe.col;F.isSelectedByRowHeader()&&(_=-1),F.getSelectedRange().pop(),F.setRangeStartOnly(s._createCellCoords(De+K,_),!0),F.setRangeEnd(s._createCellCoords(v+K,b))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Pe=f==="insert_col_end"?"end":"start";m=(A=m)!==null&&A!==void 0?A:Pe==="end"?s.countSourceCols():0;const{delta:Oe,startPhysicalIndex:He}=l.createCol(m,O,{source:D,mode:Pe});if(Oe){if(Array.isArray(y.colHeaders)){const v=[s.toVisualColumn(He),0];v.length+=Oe,Array.prototype.splice.apply(y.colHeaders,v)}const Be=F.selectedRange.current(),xe=Be==null?void 0:Be.from,De=xe==null?void 0:xe.col,be=s.toVisualColumn(He);if(F.isSelectedByCorner())F.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ue(De)&&De>=be){const{row:v,col:b}=Be.to;let _=xe.row;F.isSelectedByColumnHeader()&&(_=-1),F.getSelectedRange().pop(),F.setRangeStartOnly(s._createCellCoords(_,De+Oe),!0),F.setRangeEnd(s._createCellCoords(v,b+Oe))}else s._refreshBorders()}break;case"remove_row":const Y=Be=>{let xe=0;E(Be,De=>{let[be,v]=De;const b=Zt(be)?s.countRows()-1:Math.max(be-xe,0);if(Number.isInteger(be)&&(be=Math.max(be-xe,0)),!l.removeRow(be,v,D))return;const k=s.countRows(),M=y.fixedRowsTop;M>=b+1&&(y.fixedRowsTop-=Math.min(v,M-b));const $=y.fixedRowsBottom;$&&b>=k-$&&(y.fixedRowsBottom-=Math.min(v,$)),xe+=v})};Array.isArray(m)?Y(G(m)):Y([[m,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const lt=Be=>{let xe=0;E(Be,De=>{let[be,v]=De;const b=Zt(be)?s.countCols()-1:Math.max(be-xe,0);let _=s.toPhysicalColumn(b);if(Number.isInteger(be)&&(be=Math.max(be-xe,0)),!l.removeCol(be,v,D))return;const M=y.fixedColumnsStart;M>=b+1&&(y.fixedColumnsStart-=Math.min(v,M-b)),Array.isArray(y.colHeaders)&&(typeof _>"u"&&(_=-1),y.colHeaders.splice(_,v)),xe+=v})};Array.isArray(m)?lt(G(m)):lt([[m,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${f}"`)}z||c.adjustRowsAndCols()},adjustRowsAndCols(){const f=y.minRows,m=y.minSpareRows,w=y.minCols,A=y.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&F.deselect(),f){const O=s.countRows();O<f&&l.createRow(O,f-O,{source:"auto"})}if(m){const O=s.countEmptyRows(!0);if(O<m){const D=m-O,z=Math.min(D,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),z,{source:"auto"})}}{let O;(w||A)&&(O=s.countEmptyCols(!0));let D=s.countCols();if(w&&!y.columns&&D<w){const z=w-D;O+=z,l.createCol(D,z,{source:"auto"})}if(A&&!y.columns&&s.dataType==="array"&&O<A){D=s.countCols();const z=A-O,G=Math.min(z,y.maxCols-D);l.createCol(D,G,{source:"auto"})}}if(F.isSelected()){const O=s.countRows(),D=s.countCols();E(F.selectedRange,z=>{let G=!1,ne=z.from.row,Z=z.from.col,K=z.to.row,Se=z.to.col;ne>O-1?(ne=O-1,G=!0,K>ne&&(K=ne)):K>O-1&&(K=O-1,G=!0,ne>K&&(ne=K)),Z>D-1?(Z=D-1,G=!0,Se>Z&&(Se=Z)):Se>D-1&&(Se=D-1,G=!0,Z>Se&&(Z=Se)),G&&(Z<0?s.selectRows(ne,K,Z):ne<0?s.selectColumns(Z,Se,ne):s.selectCell(ne,Z,K,Se))})}s.view&&s.view.adjustElementsSize()},populateFromArray(f,m,w,A,O){let D,z,G,ne;const Z=[],K={},Se=[],Pe=f.row,Oe=f.col;if(z=m.length,z===0)return!1;let He=0,Y=0;switch(Ve(w)&&(He=w.col-Oe+1,Y=w.row-Pe+1),O){case"shift_down":const lt=qu(m),Be=lt.length,xe=Math.max(Be,He),De=s.getData().slice(Pe),be=qu(De).slice(Oe,Oe+xe);for(G=0;G<xe;G+=1)if(G<Be){for(D=0,z=lt[G].length;D<Y-z;D+=1)lt[G].push(lt[G][D%z]);G<be.length?Se.push(lt[G].concat(be[G])):Se.push(lt[G].concat(new Array(De.length).fill(null)))}else Se.push(lt[G%Be].concat(be[G]));s.populateFromArray(Pe,Oe,qu(Se));break;case"shift_right":const v=m.length,b=Math.max(v,Y),_=s.getData().slice(Pe).map(V=>V.slice(Oe));for(D=0;D<b;D+=1)if(D<v){for(G=0,ne=m[D].length;G<He-ne;G+=1)m[D].push(m[D][G%ne]);if(D<_.length)for(let V=0;V<_[D].length;V+=1)m[D].push(_[D][V]);else m[D].push(...new Array(_[0].length).fill(null))}else m.push(m[D%z].slice(0,b).concat(_[D]));s.populateFromArray(Pe,Oe,m);break;case"overwrite":default:K.row=f.row,K.col=f.col;let k=0,M=0,$=!0,P;const H=function(te){let he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const ye=m[te%m.length];return he!==null?ye[he%ye.length]:ye},W=m.length,L=w?w.row-f.row+1:0;for(w?z=L:z=Math.max(W,L),D=0;D<z&&!(w&&K.row>w.row&&L>W||!y.allowInsertRow&&K.row>s.countRows()-1||K.row>=y.maxRows);D++){const V=D-k,te=H(V).length,he=w?w.col-f.col+1:0;if(w?ne=he:ne=Math.max(te,he),K.col=f.col,P=s.getCellMeta(K.row,K.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&P.skipRowOnPaste){k+=1,K.row+=1,z+=1;continue}for(M=0,G=0;G<ne&&!(w&&K.col>w.col&&he>te||!y.allowInsertColumn&&K.col>s.countCols()-1||K.col>=y.maxCols);G++){if(P=s.getCellMeta(K.row,K.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&P.skipColumnOnPaste){M+=1,K.col+=1,ne+=1;continue}if(P.readOnly&&A!=="UndoRedo.undo"){K.col+=1;continue}const ye=G-M;let Ae=H(V,ye),We=s.getDataAtCell(K.row,K.col);if(Ae!==null&&typeof Ae=="object")if(Array.isArray(Ae)&&We===null&&(We=[]),We===null||typeof We!="object")$=!1;else{const St=Pl(Array.isArray(We)?We:We[0]||We),qe=Pl(Array.isArray(Ae)?Ae:Ae[0]||Ae);Og(St,qe)||Array.isArray(St)&&Array.isArray(qe)?Ae=Tn(Ae):$=!1}else We!==null&&typeof We=="object"&&($=!1);$&&Z.push([K.row,K.col,Ae]),$=!0,K.col+=1}K.row+=1}s.setDataAtCell(Z,null,null,A||"populateFromArray");break}}};function ee(f){const m=xx(f);bb(m)?(s.runHooks("beforeLanguageChange",m),R.language=m,s.runHooks("afterLanguageChange",m)):Hx(f)}function U(f,m){const w=f==="className"?s.rootElement:s.table;if(g)q(w,m);else{let A=[],O=[];R[f]&&(A=Array.isArray(R[f])?R[f]:pC(R[f])),m&&(O=Array.isArray(m)?m:pC(m));const D=mC(A,O),z=mC(O,A);D.length&&Le(w,D),z.length&&q(w,z)}R[f]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(uo()||SS())&&q(s.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new m4(this),h=dz.getInstance(s,y,F),d=new mz(s),Yd(this)&&v5(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&gP(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function j(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function re(f){const m=f.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):f}function ie(f,m,w){if(!f.length)return;const A=s.getActiveEditor(),O=new j;let D=!0;O.onQueueEmpty=z=>{A&&D&&A.cancelChanges(),w(z)};for(let z=f.length-1;z>=0;z--){const[G,ne,,Z]=f[z],K=l.propToCol(ne),Se=s.getCellMeta(G,K);Se.type==="numeric"&&typeof Z=="string"&&VP(Z)&&(f[z][3]=re(Z)),s.getCellValidator(Se)&&(O.addValidatorToQueue(),s.validateCell(f[z][3],Se,function(Pe,Oe){return function(He){if(typeof He!="boolean")throw new Error("Validation error: result is not boolean");if(He===!1&&Oe.allowInvalid===!1){D=!1,f.splice(Pe,1),Oe.valid=!0;const Y=s.getCell(Oe.visualRow,Oe.visualCol);Y!==null&&Le(Y,y.invalidCellClassName)}O.removeValidatorFormQueue()}}(z,Se),m))}O.checkIfQueueIsEmpty()}function oe(f,m){let w=f.length-1;if(w<0)return;for(;w>=0;w--){let O=!1;if(f[w]===null){f.splice(w,1);continue}if(!((f[w][2]===null||f[w][2]===void 0)&&(f[w][3]===null||f[w][3]===void 0))){if(y.allowInsertRow)for(;f[w][0]>s.countRows()-1;){const{delta:D}=l.createRow(void 0,void 0,{source:m});if(D===0){O=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(f[w][1])>s.countCols()-1;){const{delta:D}=l.createCol(void 0,void 0,{source:m});if(D===0){O=!0;break}}O||l.set(f[w][0],f[w][1],f[w][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",f,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",f,m||"edit");const A=s.getActiveEditor();A&&ue(A.refreshValue)&&A.refreshValue()}this._createCellCoords=function(f,m){return s.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,w){return s.view._wt.createCellRange(f,m,w)},this.validateCell=function(f,m,w,A){let O=s.getCellValidator(m);function D(z){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(z);return}const ne=m.visualCol,Z=m.visualRow,K=s.getCell(Z,ne,!0);if(K&&K.nodeName!=="TH"){const Se=s.rowIndexMapper.getRenderableFromVisualIndex(Z),Pe=s.columnIndexMapper.getRenderableFromVisualIndex(ne);s.view._wt.getSetting("cellRenderer",Se,Pe,K)}w(z)}ZI(O)&&(O=function(z){return function(G,ne){ne(z.test(G))}}(O)),Ct(O)?(f=s.runHooks("beforeValidate",f,m.visualRow,m.prop,A),s._registerImmediate(()=>{O.call(m,f,z=>{s&&(z=s.runHooks("afterValidate",z,f,m.visualRow,m.prop,A),m.valid=z,D(z),s.runHooks("postAfterValidate",z,f,m.visualRow,m.prop,A))})})):s._registerImmediate(()=>{m.valid=!0,D(m.valid,!1)})};function Ce(f,m,w){return Array.isArray(f)?f:[[f,m,w]]}function Me(f,m){const w=s.getActiveEditor(),A=s.runHooks("beforeChange",f,m||"edit"),O=f.filter(D=>D!==null);return A===!1||O.length===0?(w&&w.cancelChanges(),[]):O}this.setDataAtCell=function(f,m,w,A){const O=Ce(f,m,w),D=[];let z=A,G,ne,Z;for(G=0,ne=O.length;G<ne;G++){if(typeof O[G]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[G][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[G][1]>=this.countCols()?Z=O[G][1]:Z=l.colToProp(O[G][1]),D.push([O[G][0],Z,u.getAtCell(this.toPhysicalRow(O[G][0]),O[G][1]),O[G][2]])}!z&&typeof f=="object"&&(z=m);const K=Me(D,A);s.runHooks("afterSetDataAtCell",K,z),ie(K,z,()=>{oe(K,z)})},this.setDataAtRowProp=function(f,m,w,A){const O=Ce(f,m,w),D=[];let z=A,G,ne;for(G=0,ne=O.length;G<ne;G++)D.push([O[G][0],O[G][1],u.getAtCell(this.toPhysicalRow(O[G][0]),O[G][1]),O[G][2]]);!z&&typeof f=="object"&&(z=m);const Z=Me(D,A);s.runHooks("afterSetDataAtRowProp",Z,z),ie(Z,z,()=>{oe(Z,z)})},this.listen=function(){s&&!s.isListening()&&(wp.forEach(f=>{s!==f&&f.unlisten()}),pp=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(pp=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return pp===s.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(f,m)},this.populateFromArray=function(f,m,w,A,O,D,z){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const G=typeof A=="number"?s._createCellCoords(A,O):null;return c.populateFromArray(s._createCellCoords(f,m),w,G,D,z)},this.spliceCol=function(f,m,w){for(var A=arguments.length,O=new Array(A>3?A-3:0),D=3;D<A;D++)O[D-3]=arguments[D];return l.spliceCol(f,m,w,...O)},this.spliceRow=function(f,m,w){for(var A=arguments.length,O=new Array(A>3?A-3:0),D=3;D<A;D++)O[D-3]=arguments[D];return l.spliceRow(f,m,w,...O)},this.getSelected=function(){if(F.isSelected())return Ue(F.getSelectedRange(),f=>{let{from:m,to:w}=f;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRange=function(){if(F.isSelected())return Array.from(F.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.emptySelectedCells=function(f){if(!F.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];E(F.getSelectedRange(),w=>{if(w.isSingleHeader())return;const A=w.getTopStartCorner(),O=w.getBottomEndCorner();me(A.row,O.row,D=>{me(A.col,O.col,z=>{this.getCellMeta(D,z).readOnly||m.push([D,z,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=f();return this.resumeExecution(m),w},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:f,height:m}=s.view.getLastSize(),{width:w,height:A}=s.rootElement.getBoundingClientRect(),O=w!==f||A!==m;s.runHooks("beforeRefreshDimensions",{width:f,height:m},{width:w,height:A},O)!==!1&&((O||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(w,A),s.render()),s.runHooks("afterRefreshDimensions",{width:f,height:m},{width:w,height:A},O))},this.updateData=function(f,m){AE(f,w=>{l=w},w=>{l=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:S,firstRun:g})},this.loadData=function(f,m){AE(f,w=>{l=w},()=>{S.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:S,firstRun:g})},this.getInitialColumnCount=function(){const f=y.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Ct(f))if(s.dataType==="array"){const w=this.countSourceCols();for(let A=0;A<w;A+=1)f(A)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(ue(y.dataSchema)){const w=l.getSchema();m=Array.isArray(w)?w.length:Ig(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,w,A){return vt(f)?l.getAll():l.getRange(s._createCellCoords(f,m),s._createCellCoords(w,A),l.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,w,A){return l.getCopyableText(s._createCellCoords(f,m),s._createCellCoords(w,A))},this.getCopyableData=function(f,m){return l.getCopyable(f,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(g?s.loadData:s.updateData).bind(this);let A=!1,O,D;if(ue(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in f)O==="data"||(O==="language"?ee(f.language):O==="className"?U("className",f.className):O==="tableClassName"&&s.table?(U("tableClassName",f.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):de.getSingleton().isRegistered(O)||de.getSingleton().isDeprecated(O)?(Ct(f[O])||Array.isArray(f[O]))&&(f[O].initialHook=!0,s.addHook(O,f[O])):!m&&Pt(f,O)&&(R[O]=f[O]));f.data===void 0&&y.data===void 0?w(null,"updateSettings"):f.data!==void 0?w(f.data,"updateSettings"):f.columns!==void 0&&(l.createMap(),s.initIndexMappers());const z=s.countCols(),G=y.columns;if(G&&Ct(G)&&(A=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&S.clearCache(),z>0)for(O=0,D=0;O<z;O++){if(G){const K=A?G(O):G[D];K&&S.updateColumnMeta(D,K)}D+=1}ue(f.cell)&&Ye(f.cell,K=>{s.setCellMetaObject(K.row,K.col,K)}),s.runHooks("afterCellMetaReset");let ne=s.rootElement.style.height;ne!==""&&(ne=parseInt(s.rootElement.style.height,10));let Z=f.height;if(Ct(Z)&&(Z=Z()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),Z===null){const K=s.rootElement.getAttribute("data-initialstyle");K&&(K.indexOf("height")>-1||K.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",K):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else Z!==void 0&&(s.rootElement.style.height=isNaN(Z)?`${Z}`:`${Z}px`,s.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let K=f.width;Ct(K)&&(K=K()),s.rootElement.style.width=isNaN(K)?`${K}`:`${K}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",f)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(ne===""||Z===""||Z===void 0)&&ne!==Z&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=s.getSelectedLast();if(y.getValue){if(Ct(y.getValue))return y.getValue.call(s);if(f)return s.getData()[f[0][0]][y.getValue]}else if(f)return s.getDataAtCell(f[0],f[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,w,A,O){c.alter(f,m,w,A,O)},this.getCell=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=m,O=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return O===null||A===null?null:s.view.getCellAtCoords(s._createCellCoords(O,A),w)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:w,col:A}=m;let O=w,D=A;return w>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(w)),A>=0&&(D=this.columnIndexMapper.getVisualFromRenderableIndex(A)),s._createCellCoords(O,D)},this.colToProp=function(f){return l.colToProp(f)},this.propToCol=function(f){return l.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return l.get(f,l.colToProp(m))},this.getDataAtRowProp=function(f,m){return l.get(f,m)},this.getDataAtCol=function(f){const m=[],w=l.getRange(s._createCellCoords(0,f),s._createCellCoords(y.data.length-1,f),l.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let O=0;O<w[A].length;O+=1)m.push(w[A][O]);return m},this.getDataAtProp=function(f){const m=[],w=l.getRange(s._createCellCoords(0,l.propToCol(f)),s._createCellCoords(y.data.length-1,l.propToCol(f)),l.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let O=0;O<w[A].length;O+=1)m.push(w[A][O]);return m},this.getSourceData=function(f,m,w,A){let O;return f===void 0?O=u.getData():O=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(w,A)),O},this.getSourceDataArray=function(f,m,w,A){let O;return f===void 0?O=u.getData(!0):O=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(w,A),!0),O},this.getSourceDataAtCol=function(f){return u.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,w,A){const O=Ce(f,m,w),D=this.hasHook("afterSetSourceDataAtCell"),z=[];D&&E(O,ne=>{let[Z,K,Se]=ne;z.push([Z,K,u.getAtCell(Z,K),Se])}),E(O,ne=>{let[Z,K,Se]=ne;u.setAtCell(Z,K,Se)}),D&&this.runHooks("afterSetSourceDataAtCell",z,A),this.render();const G=s.getActiveEditor();G&&ue(G.refreshValue)&&G.refreshValue()},this.getSourceDataAtRow=function(f){return u.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return u.getAtCell(f,m)},this.getDataAtRow=function(f){return l.getRange(s._createCellCoords(f,0),s._createCellCoords(f,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,w,A){const O=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,w,A],[D,z]=O;let[,,G,ne]=O,Z=null,K=null;G===void 0&&(G=D),ne===void 0&&(ne=z);let Se="mixed";return me(Math.max(Math.min(D,G),0),Math.max(D,G),Pe=>{let Oe=!0;return me(Math.max(Math.min(z,ne),0),Math.max(z,ne),He=>(K=this.getCellMeta(Pe,He).type,Z?Oe=Z===K:Z=K,Oe)),Se=Oe?K:"mixed",Oe}),Se},this.removeCellMeta=function(f,m,w){const[A,O]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let D=S.getCellMetaKeyValue(A,O,w);s.runHooks("beforeRemoveCellMeta",f,m,w,D)!==!1&&(S.removeCellMeta(A,O,w),s.runHooks("afterRemoveCellMeta",f,m,w,D)),D=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,A=new Array(w>2?w-2:0),O=2;O<w;O++)A[O-2]=arguments[O];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&S.removeRow(this.toPhysicalRow(f),m),A.length>0&&E(A.reverse(),D=>{S.createRow(this.toPhysicalRow(f)),E(D,(z,G)=>this.setCellMetaObject(f,G,z))}),s.render()},this.setCellMetaObject=function(f,m,w){typeof w=="object"&&Ye(w,(A,O)=>{this.setCellMeta(f,m,O,A)})},this.setCellMeta=function(f,m,w,A){if(s.runHooks("beforeSetCellMeta",f,m,w,A)===!1)return;let D=f,z=m;f<this.countRows()&&(D=this.toPhysicalRow(f)),m<this.countCols()&&(z=this.toPhysicalColumn(m)),S.setCellMeta(D,z,w,A),s.runHooks("afterSetCellMeta",f,m,w,A)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(f,m){let w=this.toPhysicalRow(f),A=this.toPhysicalColumn(m);return w===null&&(w=f),A===null&&(A=m),S.getCellMeta(w,A,{visualRow:f,visualColumn:m})},this.getCellMetaAtRow=function(f){return S.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).renderer:f.renderer;return typeof w=="string"?Ef(w):vt(w)?Ef("text"):w},this.getCellEditor=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).editor:f.editor;return typeof w=="string"?yf(w):vt(w)?yf("text"):w},this.getCellValidator=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).validator:f.validator;return typeof w=="string"?MS(w):w},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,w){const A=new j;f&&(A.onQueueEmpty=f);let O=s.countRows()-1;for(;O>=0;){if(m!==void 0&&m.indexOf(O)===-1){O-=1;continue}let D=s.countCols()-1;for(;D>=0;){if(w!==void 0&&w.indexOf(D)===-1){D-=1;continue}A.addValidatorToQueue(),s.validateCell(s.getDataAtCell(O,D),s.getCellMeta(O,D),z=>{if(typeof z!="boolean")throw new Error("Validation error: result is not boolean");z===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),D-=1}O-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=y.rowHeaders,w=f;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(m=[],me(s.countRows()-1,A=>{m.push(s.getRowHeader(A))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:Ct(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let f=0,m=s.countCols();f<m;f++)if(s.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",f);if(w===void 0){const G=[],ne=s.countCols();for(let Z=0;Z<ne;Z++)G.push(s.getColHeader(Z));return G}let A=y.colHeaders;const O=function(G){const ne=[],Z=s.countCols();let K=0;for(;K<Z;K++)Ct(y.columns)&&y.columns(K)&&ne.push(K);return ne[G]},D=s.toPhysicalColumn(w),z=O(D);return y.colHeaders===!1?A=null:y.columns&&Ct(y.columns)&&y.columns(z)&&y.columns(z).title?A=y.columns(z).title:y.columns&&y.columns[D]&&y.columns[D].title?A=y.columns[D].title:Array.isArray(y.colHeaders)&&y.colHeaders[D]!==void 0?A=y.colHeaders[D]:Ct(y.colHeaders)?A=y.colHeaders(D):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(A=Lg(w)),A=s.runHooks("modifyColumnHeaderValue",A,f,m),A},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=s.getCellMeta(0,f).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f){let m=s._getColWidthFromSettings(f);return m=s.runHooks("modifyColWidth",m,f),m===void 0&&(m=zc.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(f){let m=y.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(f){let m=s._getRowHeightFromSettings(f);return m=s.runHooks("modifyRowHeight",m,f),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const f=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Rf(s.countRows()-1,w=>{if(s.isEmptyRow(w))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Rf(s.countCols()-1,w=>{if(s.isEmptyCol(w))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return y.isEmptyRow.call(s,f)},this.isEmptyCol=function(f){return y.isEmptyCol.call(s,f)},this.selectCell=function(f,m,w,A){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,D=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return vt(f)||vt(m)?!1:this.selectCells([[f,m,w,A]],O,D)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(o=!0);const A=F.selectCells(f);return A&&w&&s.listen(),o=!1,A},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return F.selectColumns(f,m,w)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return F.selectRows(f,m,w)},this.deselectCell=function(){F.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;o=!0,F.selectAll(f,m,w),o=!1};const rt=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f){var m;if(typeof f=="number"){var w;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:A,col:O,verticalSnap:D,horizontalSnap:z,considerHiddenIndexes:G}=(m=f)!==null&&m!==void 0?m:{};let ne,Z,K,Se;D!==void 0&&(ne=D==="top",Z=!ne),z!==void 0&&(K=z==="start",Se=!K);let Pe=A,Oe=O;if(G===void 0||G){const lt=Number.isInteger(A)&&A>=0,Be=Number.isInteger(O)&&O>=0,xe=lt?rt(this.rowIndexMapper,A):void 0,De=Be?rt(this.columnIndexMapper,O):void 0;if(xe===null||De===null)return!1;Pe=lt?s.rowIndexMapper.getRenderableFromVisualIndex(xe):A,Oe=Be?s.columnIndexMapper.getRenderableFromVisualIndex(De):O}const He=Number.isInteger(Pe),Y=Number.isInteger(Oe);return He&&Pe>=0&&Y&&Oe>=0?s.view.scrollViewport(s._createCellCoords(Pe,Oe),ne,Se,Z,K):He&&Pe>=0&&(Y&&Oe<0||!Y)?s.view.scrollViewportVertically(Pe,ne,Z):Y&&Oe>=0&&(He&&Pe<0||!He)?s.view.scrollViewportHorizontally(Oe,Se,K):!1},this.scrollToFocusedCell=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",f),this._registerImmediate(()=>f()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),S.clearCache(),wp.delete(this.guid),Yd(s)){const f=this.rootDocument.querySelector(".hot-display-license-info");f&&f.parentNode.removeChild(f)}oi(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),T.getItems().forEach(f=>{let[,m]=f;m.destroy()}),T.clear(),s.runHooks("afterDestroy")},!0),de.getSingleton().destroy(s),Ye(s,(f,m,w)=>{Ct(f)?w[m]=Fe(m):m!=="guid"&&(w[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,F=null,h=null,s=null};function Fe(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(f){const m=En(f);return m==="UndoRedo"?this.undoRedo:T.getItem(m)},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:T.getId(f)},this.getInstance=function(){return s},this.addHook=function(f,m){de.getSingleton().add(f,m,s)},this.hasHook=function(f){return de.getSingleton().has(f,s)||de.getSingleton().has(f)},this.addHookOnce=function(f,m){de.getSingleton().once(f,m,s)},this.removeHook=function(f,m){de.getSingleton().remove(f,m,s)},this.runHooks=function(f,m,w,A,O,D,z){return de.getSingleton().run(s,f,m,w,A,O,D,z)},this.getTranslatedPhrase=function(f,m){return Fx(y.language,f,m)},this.toHTML=()=>EC(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",EC(this)),f.firstElementChild},this.timeouts=[],this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=f;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){E(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){E(this.immediates,f=>{clearImmediate(f)})},this._refreshBorders=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(f),s.view.render(),m&&F.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const pe=M5({handleEvent(){return s.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&pe.releasePressedKeys()}),this.getShortcutManager=function(){return pe},this.getFocusManager=function(){return d},_S().forEach(f=>{const m=Gc(f);T.addItem(f,new m(this))}),w5(s),pe.setActiveContextName("grid"),de.getSingleton().run(s,"construct")}const A5="hooksRefRegisterer",iH={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){E(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ye(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Fi(iH,"MIXIN_NAME",A5,{writable:!1,enumerable:!1});const O5=iH;function Br(t,e,n){return e=I5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I5(t){var e=P5(t,"string");return typeof e=="symbol"?e:String(e)}function P5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const x5="base",qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),BC="baseEditor";class Ul{static get EDITOR_TYPE(){return x5}constructor(e){Br(this,"hot",void 0),Br(this,"state",qt.VIRGIN),Br(this,"_opened",!1),Br(this,"_fullEditMode",!1),Br(this,"_closeCallback",null),Br(this,"TD",null),Br(this,"row",null),Br(this,"col",null),Br(this,"prop",null),Br(this,"originalValue",null),Br(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=qt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>ue(this.hot.getSelected()),group:BC};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==qt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=qt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Wt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(BC),s.removeShortcutsByGroup(Hg),this.state===qt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===qt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=qt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=qt.FINISHED,this.discardEditor(l)}):(this.state=qt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=qt.FINISHED,this.discardEditor()}discardEditor(e){this.state===qt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=qt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=qt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===qt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=en(n),a=ft(n),l=en(this.hot.rootElement),u=ft(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:C}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,S=C.name,y=["master","inline_start"].includes(S)?d:0,R=["master","top","bottom"].includes(S)?g:0,T=s.top===l.top?0:1;let N=s.top-l.top-T-y,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-p-1+R:I=s.left-l.left-1-R,["top","top_inline_start_corner"].includes(S)&&(N+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const F=this.hot.hasColHeaders(),B=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ee=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),j=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(F&&B<=0||B===j)&&(N+=1),ee<=0&&(I+=1);const re=i.rowsRenderCalculator.startPosition,ie=i.columnsRenderCalculator.startPosition,oe=Math.abs(r.inlineStartOverlay.getScrollPosition()),Ce=r.topOverlay.getScrollPosition(),Me=nn(this.hot.rootDocument);let rt=n.offsetTop;if(["inline_start","master"].includes(S)&&(rt+=re-Ce),["bottom","bottom_inline_start_corner"].includes(S)){const{wtViewport:Z,wtTable:K}=r.bottomOverlay.clone;rt+=Z.getWorkspaceHeight()-K.getHeight()-Me}let Fe=n.offsetLeft;this.hot.isRtl()?(Fe>=0?Fe=C.getWidth()-n.offsetLeft:Fe=Math.abs(Fe),Fe+=ie-oe-a):["top","master","bottom"].includes(S)&&(Fe+=ie-oe);const pe=Co(this.TD,this.hot.rootWindow),f=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(pe[f],10)>0?0:1,w=parseInt(pe.borderTopWidth,10)>0?0:1,A=ft(n)+m,O=xt(n)+w,D=dP(c)?Me:0,z=fP(h)?Me:0,G=this.hot.view.maximumVisibleElementWidth(Fe)-D+m,ne=Math.max(this.hot.view.maximumVisibleElementHeight(rt)-z+w,23);return{top:N,start:I,height:O,maxHeight:ne,width:A,maxWidth:G}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}pt(Ul,O5);function HE(t,e,n){t.addEventListener(e,n,!1)}function DE(t,e,n){t.removeEventListener(e,n,!1)}function NE(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function H5(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=NE(o).fontSize,i.style.fontFamily=NE(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const h=o.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),d&&(HE(o,"input",s),HE(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){DE(o,"input",s),DE(o,"keydown",a)}}}function LE(t,e){const n=hS(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Vc(e,i)}function xs(t,e,n){return e=D5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D5(t){var e=N5(t,"string");return typeof e=="symbol"?e:String(e)}function N5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const L5="ht_editor_visible",Bh="ht_editor_hidden",$E="textEditor",$5="text";class ba extends Ul{static get EDITOR_TYPE(){return $5}constructor(e){super(e),xs(this,"eventManager",new xr(this)),xs(this,"autoResize",H5(this.hot.rootDocument)),xs(this,"TEXTAREA",void 0),xs(this,"textareaStyle",void 0),xs(this,"TEXTAREA_PARENT",void 0),xs(this,"textareaParentStyle",void 0),xs(this,"layerClass",void 0),this.eventManager=new xr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),oP(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==qt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===qt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Vc(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ee(this.TEXTAREA,[["data-hot-input",""],Fl(-1)]),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Eo()]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ie(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Bh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){OP()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Bh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;me(e.length-1,r=>{const i=e[r];if(Ie(i,"handsontableEditor"))return n=!0,!1}),Ie(this.TEXTAREA_PARENT,Bh)&&Le(this.TEXTAREA_PARENT,Bh),n?(this.layerClass=L5,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==qt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=Co(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=Co(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-c,g=s-h,p=o-c,C=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,p),minHeight:Math.min(g,C),maxWidth:p,maxHeight:C},!0)}bindEvents(){vS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===qt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===qt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>ue(this.hot.getSelected()),group:$E},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;LE(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;LE(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Hg),n.removeShortcutsByGroup($E),n.removeShortcutsByGroup(BC)}}const k5="base";function qc(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(v0())):a&&c.push(v0()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(S0())):(u.push(s.invalidCellClassName),a&&c.push(S0()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Le(e,u),q(e,l),va(e,c),Ee(e,h)}qc.RENDERER_TYPE=k5;const F5="text";function Ao(t,e,n,r,i,o,s){qc.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Wt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){oi(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else hs(e,a)}Ao.RENDERER_TYPE=F5;const W5="text",oH={CELL_TYPE:W5,editor:ba,renderer:Ao};br(oH);_e.editors={BaseEditor:Ul};function _e(t,e){const n=new rH(t,e||{},GS);return n.init(),n}_e.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new rH(t,e,GS)};_e.DefaultSettings=qx();_e.hooks=de.getSingleton();_e.CellCoords=_f;_e.CellRange=OS;_e.packageName="handsontable";_e.buildDate="16/01/2024 09:37:55";_e.version="14.1.0";_e.languages={dictionaryKeys:i6,getLanguageDictionary:kx,getLanguagesDictionaries:u6,registerLanguageDictionary:$x,getTranslatedPhrase:Fx};const kE="handsontableEditor",V5="handsontable";class _b extends ba{static get EDITOR_TYPE(){return V5}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Vc(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&jt(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:kE,relativeToGroup:Hg,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Lr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(kE)}}function B5(t,e,n){U5(t,e),e.set(t,n)}function U5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uh(t,e,n){return e=Y5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y5(t){var e=G5(t,"string");return typeof e=="symbol"?e:String(e)}function G5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FE(t,e){var n=z5(t,e,"get");return j5(t,n)}function z5(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function j5(t,e){return e.get?e.get.call(t):e.value}const K5="autocomplete";var Cp=new WeakMap;class Mb extends _b{constructor(){super(...arguments),Uh(this,"query",null),Uh(this,"strippedChoices",[]),Uh(this,"rawChoices",[]),B5(this,Cp,{writable:!0,value:this.hot.guid.slice(0,9)}),Uh(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=CC(Wt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,g)=>{if(g.index===-1)return-1;if(d.index===-1)return 1;if(d.index<g.index)return-1;if(g.index<d.index)return 1;if(d.index===g.index){if(d.charsLeft<g.charsLeft)return-1;if(d.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return K5}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[ZY(),zY(),tP("listbox"),nG()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Ir("false"),rG(`${FE(this,Cp)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=nn();a===0&&Rc()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[ft(this.TEXTAREA)-2]:void 0,width:e?ft(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,d,g,p)=>{Ao(l,u,c,h,d,g,p);const{filteringCaseSensitive:C,allowHtml:S,locale:y}=this.cellProperties,R=this.query;let T=Wt(g),N,I;T&&!S&&(N=C===!0?T.indexOf(R):T.toLocaleLowerCase(y).indexOf(R.toLocaleLowerCase(y)),N!==-1&&(I=T.substr(N,R.length),T=T.replace(I,`<strong>${I}</strong>`))),n&&Ee(u,[jY(),...r?[aG(i)]:[],...r?[lG(r.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=T},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Ee(c,[sS()]),Ee(this.TEXTAREA,...iG(c.id))}}}),n&&(Ee(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Pi()),Ee(this.htEditor.rootElement,[eP(),oG("polite"),sG("text"),["id",`${FE(this,Cp)}-listbox-${o}-${s}`]]),Ee(this.TEXTAREA,...Ir("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Ir("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=hS(this.TEXTAREA),r=hP(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(qu([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Vc(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=ca(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=en(this.TEXTAREA),o=xt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=xt(this.hot.view._wt.wtTable.THEAD),u=en(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,d=s>h&&c>h;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,s),d}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+nn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Wt(o));return Ue(r,o=>n?o:CC(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===we.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===we.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(IP(e.keyCode)||e.keyCode===we.BACKSPACE||e.keyCode===we.DELETE||e.keyCode===we.INSERT){let n=10;if(e.keyCode===we.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const X5="checkbox";class sH extends Ul{static get EDITOR_TYPE(){return X5}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Ie(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ts=()=>window,Mr=()=>window.document,UC=(t,e)=>window.setTimeout(t,e),bi=function(t,e,n,r){t.addEventListener(e,n,!!r)},Ki=function(t,e,n,r){t.removeEventListener(e,n,!!r)},q5=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},ar=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},vp=function(t,e){ar(t,e)||(t.className=t.className===""?e:t.className+" "+e)},Sp=function(t,e){t.className=q5((" "+t.className+" ").replace(" "+e+" "," "))},Ab=function(t){return/Array/.test(Object.prototype.toString.call(t))},ur=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},Z5=function(t){let e=t.getDay();return e===0||e===6},J5=function(t){return t%4===0&&t%100!==0||t%400===0},WE=function(t,e){return[31,J5(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Yh=function(t){ur(t)&&t.setHours(0,0,0,0)},Gh=function(t,e){return t.getTime()===e.getTime()},Pf=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?ur(e[r])?n&&(t[r]=new Date(e[r].getTime())):Ab(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=Pf({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},VE=function(t,e,n){let r=Mr().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=Pf(r,n),t.dispatchEvent(r)},BE=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},fi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},UE=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},Q5=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},e8=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},t8=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():e8(o,i))+"</td>"},n8=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},r8=function(t){return"<tbody>"+t.join("")+"</tbody>"},i8=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+UE(t,e)+'">'+UE(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},o8=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',g,p,C=!0,S=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(g='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",Ab(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return p='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=p+g:d+=g+p,c&&(r===0||u.minMonth>=r)&&(C=!1),h&&(r===11||u.maxMonth<=r)&&(S=!1),e===0&&(d+='<button class="pika-prev'+(C?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},s8=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+i8(t)+r8(e)+"</table>"};function YC(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||ts().event;let o=i.target||i.srcElement;if(o)if(ar(o,"is-disabled")||(ar(o,"pika-button")&&!ar(o,"is-empty")&&!ar(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&UC(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):ar(o,"pika-prev")?e.prevMonth():ar(o,"pika-next")&&e.nextMonth()),ar(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||ts().event;let o=i.target||i.srcElement;o&&(ar(o,"pika-select-month")?e.gotoMonth(o.value):ar(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||ts().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),ur(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Mr().activeElement;do if(ar(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=UC(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||ts().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&ar(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),bi(o,"change",e._onChange)));do if(ar(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Mr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),bi(e.el,"mousedown",e._onMouseDown,!0),bi(e.el,"touchend",e._onMouseDown,!0),bi(e.el,"change",e._onChange),n.keyboardInput&&bi(Mr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Mr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),bi(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;ur(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",bi(n.trigger,"click",e._onInputClick),bi(n.trigger,"focus",e._onInputFocus),bi(n.trigger,"blur",e._onInputBlur)):this.show()}YC.prototype={config:function(t){this._o||(this._o=Pf({},fi,!0));let e=Pf(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,ur(e.minDate)||(e.minDate=!1),ur(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),Ab(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||fi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,ur(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return ur(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",VE(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!ur(t))return;let n=this._o.minDate,r=this._o.maxDate;ur(n)&&t<n?t=n:ur(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),Yh(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),VE(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(ur(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=BE(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=BE({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Yh(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=fi.minDate,this._o.minYear=fi.minYear,this._o.minMonth=fi.minMonth,this._o.startRange=fi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Yh(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=fi.maxDate,this._o.maxYear=fi.maxYear,this._o.maxMonth=fi.maxMonth,this._o.endRange=fi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+o8(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&UC(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=ts().innerWidth||Mr().documentElement.clientWidth,i=ts().innerHeight||Mr().documentElement.clientHeight,o=Mr().body.scrollTop||Mr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+ts().pageXOffset,a=l.bottom+ts().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",vp(this.el,u?"left-aligned":"right-aligned"),vp(this.el,c?"bottom-aligned":"top-aligned"),Sp(this.el,u?"right-aligned":"left-aligned"),Sp(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=WE(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];Yh(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,g=WE(h,u),p=o+s,C=p;for(;C>7;)C-=7;p+=7-C;let S=!1;for(let y=0,R=0;y<p;y++){let T=new Date(t,e,1+(y-s)),N=ur(this._d)?Gh(T,this._d):!1,I=Gh(T,i),F=r.events.indexOf(T.toDateString())!==-1,B=y<s||y>=o+s,ee=1+(y-s),U=e,j=t,re=r.startRange&&Gh(r.startRange,T),ie=r.endRange&&Gh(r.endRange,T),oe=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,Ce=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&Z5(T)||r.disableDayFn&&r.disableDayFn(T);B&&(y<s?(ee=g+ee,U=u,j=h):(ee=ee-o,U=c,j=d));let Me={day:ee,month:U,year:j,hasEvent:F,isSelected:N,isToday:I,isDisabled:Ce,isEmpty:B,isStartRange:re,isEndRange:ie,isInRange:oe,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&N&&(S=!0),l.push(Q5(Me)),++R===7&&(r.showWeekNumber&&l.unshift(t8(this,y-s,e,t,r.firstWeekOfYearMinDays)),a.push(n8(l,r.isRTL,r.pickWholeWeek,S)),l=[],R=0,S=!1)}return s8(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Sp(this.el,"is-hidden"),this._o.bound&&(bi(Mr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Ki(Mr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),vp(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Ki(this.el,"mousedown",this._onMouseDown,!0),Ki(this.el,"touchend",this._onMouseDown,!0),Ki(this.el,"change",this._onChange),t.keyboardInput&&Ki(Mr(),"keydown",this._onKeyChange),t.field&&(Ki(t.field,"change",this._onInputChange),t.bound&&(Ki(t.trigger,"click",this._onInputClick),Ki(t.trigger,"focus",this._onInputFocus),Ki(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function yp(t,e,n){return e=a8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a8(t){var e=l8(t,"string");return typeof e=="symbol"?e:String(e)}function l8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aH="date",YE="dateEditor";class lH extends ba{constructor(){super(...arguments),yp(this,"defaultDateFormat","DD/MM/YYYY"),yp(this,"parentDestroyed",!1),yp(this,"$datePicker",null)}static get EDITOR_TYPE(){return aH}init(){if(typeof X!="function")throw new Error("You need to include moment.js to your project.");if(typeof YC!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ie(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:YE})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(YE),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?yS(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new YC(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(X),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+xt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-ft(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,X(s,r,!0).isValid()&&this.$datePicker.setMoment(X(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,X(s,r,!0).isValid()&&this.$datePicker.setMoment(X(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Yc(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=X(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const u8="dropdown";class Ob extends Mb{static get EDITOR_TYPE(){return u8}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}de.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===Ob&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const c8="numeric";class uH extends ba{static get EDITOR_TYPE(){return c8}}const h8="password";class cH extends ba{static get EDITOR_TYPE(){return h8}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Eo()]),oi(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const bp="ht_editor_visible",GE="selectEditor",d8="select";class hH extends Ul{static get EDITOR_TYPE(){return d8}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",q(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Ie(this.select,bp)&&Le(this.select,bp),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),oi(this.select),Ye(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Sa(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.select,bp)}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={group:GE};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r,callback:()=>{}},{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(GE)}}const f8="time";class dH extends ba{static get EDITOR_TYPE(){return f8}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function g8(){Qn(Ul),Qn(Mb),Qn(sH),Qn(lH),Qn(Ob),Qn(_b),Qn(uH),Qn(cH),Qn(hH),Qn(ba),Qn(dH)}const m8="html";function Ib(t,e,n,r,i,o,s){qc.apply(this,[t,e,n,r,i,o,s]),Sa(e,o??"",!1)}Ib.RENDERER_TYPE=m8;const p8="autocomplete";function Yl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?Ib:Ao,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Eo()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new xr(t);t.acArrowListener=function(d){Ie(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Yl.RENDERER_TYPE=p8;const w8="dropdown";function Pb(t,e,n,r,i,o,s){Yl.apply(this,[t,e,n,r,i,o,s])}Pb.RENDERER_TYPE=w8;const zE=new WeakMap,jE=new WeakMap,C8="htBadValue",Hl="data-row",Dl="data-col",v8="checkboxRenderer",fH="checkbox";de.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===fH){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function xb(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;qc.apply(this,[t,e,n,r,i,o,s]),S8(t);let u=y8(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),oi(e),o===s.checkedTemplate||Wt(o).toLocaleLowerCase(s.locale)===Wt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Wt(o).toLocaleLowerCase(s.locale)===Wt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Zt(o)?q(u,"noValue"):(u.style.display="none",q(u,C8),h=!0),Ee(u,[[Hl,n],[Dl,r]]),l&&Ee(u,[iS(u.checked?t.getTranslatedPhrase(Sb):t.getTranslatedPhrase(yb)),tG(u.checked),KY()]),!h&&c){let C="";if(c.value)C=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const y=t.getDataAtRowProp(n,c.property);C=y!==null?y:""}const S=b8(a,C,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(S),e.appendChild(u)):(S.appendChild(u),u=S):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(S)):(S.insertBefore(u,S.firstChild),u=S))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),zE.has(t)||(zE.set(t,!0),d());function d(){const S=t.getShortcutManager().getContext("grid"),y={group:v8};S.addShortcuts([{keys:[["space"]],callback:()=>(g(),!p())},{keys:[["enter"]],callback:()=>(g(),!p()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!p()),relativeToGroup:Tb,position:"before"}],y)}function g(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=t.getSelectedRange();if(S)for(let y=0;y<S.length;y++){const{row:R,col:T}=S[y].getTopStartCorner(),{row:N,col:I}=S[y].getBottomEndCorner(),F=[];for(let B=R;B<=N;B+=1)for(let ee=T;ee<=I;ee+=1){const U=t.getCellMeta(B,ee);if(U.type!=="checkbox")return;if(U.readOnly===!0)continue;typeof U.checkedTemplate>"u"&&(U.checkedTemplate=!0),typeof U.uncheckedTemplate>"u"&&(U.uncheckedTemplate=!1);const j=t.getDataAtCell(B,ee);C===!1?[U.checkedTemplate,U.checkedTemplate.toString()].includes(j)?F.push([B,ee,U.uncheckedTemplate]):[U.uncheckedTemplate,U.uncheckedTemplate.toString(),null,void 0].includes(j)&&F.push([B,ee,U.checkedTemplate]):F.push([B,ee,U.uncheckedTemplate])}F.length>0&&t.setDataAtCell(F)}}function p(){const C=t.getSelectedRange();if(C){for(let S=0;S<C.length;S++){const y=C[S].getTopStartCorner(),R=C[S].getBottomEndCorner();for(let T=y.row;T<=R.row;T++)for(let N=y.col;N<=R.col;N++){const I=t.getCellMeta(T,N);if(I.type!=="checkbox")return!1;const F=t.getCell(T,N);if(F==null)return!0;if(F.querySelectorAll("input[type=checkbox]").length>0&&!I.readOnly)return!0}}return!1}}}xb.RENDERER_TYPE=fH;function S8(t){let e=jE.get(t);if(!e){const{rootElement:n}=t;e=new xr(t),e.addEventListener(n,"click",r=>E8(r,t)),e.addEventListener(n,"mouseup",r=>R8(r,t)),e.addEventListener(n,"change",r=>T8(r,t)),jE.set(t,e)}return e}function y8(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function b8(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function R8(t,e){const{target:n}=t;Hb(n)&&(!n.hasAttribute(Hl)||!n.hasAttribute(Dl)||setTimeout(e.listen,10))}function E8(t,e){const{target:n}=t;if(!Hb(n)||!n.hasAttribute(Hl)||!n.hasAttribute(Dl))return;const r=parseInt(n.getAttribute(Hl),10),i=parseInt(n.getAttribute(Dl),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function T8(t,e){const{target:n}=t;if(!Hb(n)||!n.hasAttribute(Hl)||!n.hasAttribute(Dl))return;const r=parseInt(n.getAttribute(Hl),10),i=parseInt(n.getAttribute(Dl),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Hb(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const _8="handsontable";function Db(t,e,n,r,i,o,s){Yl.apply(this,[t,e,n,r,i,o,s])}Db.RENDERER_TYPE=_8;function zh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gH={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof zh=="function"&&zh;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var g=i[u]={exports:{}};r[u][0].call(g.exports,function(p){return s(r[u][1][p]||p)},g,g.exports,n,r,i,o)}return i[u].exports}for(var a=typeof zh=="function"&&zh,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,g=14,p=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,y=1e9;function R(U){var j=0|U;return 0<U||U===j?j:j-1}function T(U){for(var j,re,ie=1,oe=U.length,Ce=U[0]+"";ie<oe;){for(j=U[ie++]+"",re=g-j.length;re--;j="0"+j);Ce+=j}for(oe=Ce.length;Ce.charCodeAt(--oe)===48;);return Ce.slice(0,oe+1||1)}function N(U,j){var re,ie,oe=U.c,Ce=j.c,Me=U.s,rt=j.s,Fe=U.e,pe=j.e;if(!Me||!rt)return null;if(re=oe&&!oe[0],ie=Ce&&!Ce[0],re||ie)return re?ie?0:-rt:Me;if(Me!=rt)return Me;if(re=Me<0,ie=Fe==pe,!oe||!Ce)return ie?0:!oe^re?1:-1;if(!ie)return pe<Fe^re?1:-1;for(rt=(Fe=oe.length)<(pe=Ce.length)?Fe:pe,Me=0;Me<rt;Me++)if(oe[Me]!=Ce[Me])return oe[Me]>Ce[Me]^re?1:-1;return Fe==pe?0:pe<Fe^re?1:-1}function I(U,j,re,ie){if(U<j||re<U||U!==(U<0?l(U):u(U)))throw Error(c+(ie||"Argument")+(typeof U=="number"?U<j||re<U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(U))}function F(U){var j=U.c.length-1;return R(U.e/g)==j&&U.c[j]%2!=0}function B(U,j){return(1<U.length?U.charAt(0)+"."+U.slice(1):U)+(j<0?"e":"e+")+j}function ee(U,j,re){var ie,oe;if(j<0){for(oe=re+".";++j;oe+=re);U=oe+U}else if(++j>(ie=U.length)){for(oe=re,j-=ie;--j;oe+=re);U+=oe}else j<ie&&(U=U.slice(0,j)+"."+U.slice(j));return U}(s=function U(j){var re,ie,oe,Ce,Me,rt,Fe,pe,f,m,w=Y.prototype={constructor:Y,toString:null,valueOf:null},A=new Y(1),O=20,D=4,z=-7,G=21,ne=-1e7,Z=1e7,K=!1,Se=1,Pe=0,Oe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},He="0123456789abcdefghijklmnopqrstuvwxyz";function Y(v,b){var _,k,M,$,P,H,W,L,V=this;if(!(V instanceof Y))return new Y(v,b);if(b==null){if(v instanceof Y)return V.s=v.s,V.e=v.e,void(V.c=(v=v.c)?v.slice():v);if((H=typeof v=="number")&&0*v==0){if(V.s=1/v<0?(v=-v,-1):1,v===~~v){for($=0,P=v;10<=P;P/=10,$++);return V.e=$,void(V.c=[v])}L=String(v)}else{if(L=String(v),!a.test(L))return oe(V,L,H);V.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<($=L.indexOf("."))&&(L=L.replace(".","")),0<(P=L.search(/e/i))?($<0&&($=P),$+=+L.slice(P+1),L=L.substring(0,P)):$<0&&($=L.length)}else{if(I(b,2,He.length,"Base"),L=String(v),b==10)return De(V=new Y(v instanceof Y?v:L),O+V.e+1,D);if(H=typeof v=="number"){if(0*v!=0)return oe(V,L,H,b);if(V.s=1/v<0?(L=L.slice(1),-1):1,Y.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(h+v);H=!1}else V.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(_=He.slice(0,b),$=P=0,W=L.length;P<W;P++)if(_.indexOf(k=L.charAt(P))<0){if(k=="."){if($<P){$=W;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,P=-1,$=0;continue}return oe(V,String(v),H,b)}-1<($=(L=ie(L,b,10,V.s)).indexOf("."))?L=L.replace(".",""):$=L.length}for(P=0;L.charCodeAt(P)===48;P++);for(W=L.length;L.charCodeAt(--W)===48;);if(L=L.slice(P,++W)){if(W-=P,H&&Y.DEBUG&&15<W&&(p<v||v!==u(v)))throw Error(h+V.s*v);if(Z<($=$-P-1))V.c=V.e=null;else if($<ne)V.c=[V.e=0];else{if(V.e=$,V.c=[],P=($+1)%g,$<0&&(P+=g),P<W){for(P&&V.c.push(+L.slice(0,P)),W-=g;P<W;)V.c.push(+L.slice(P,P+=g));L=L.slice(P),P=g-L.length}else P-=W;for(;P--;L+="0");V.c.push(+L)}}else V.c=[V.e=0]}function lt(v,b,_,k){var M,$,P,H,W;if(_==null?_=D:I(_,0,8),!v.c)return v.toString();if(M=v.c[0],P=v.e,b==null)W=T(v.c),W=k==1||k==2&&(P<=z||G<=P)?B(W,P):ee(W,P,"0");else if($=(v=De(new Y(v),b,_)).e,H=(W=T(v.c)).length,k==1||k==2&&(b<=$||$<=z)){for(;H<b;W+="0",H++);W=B(W,$)}else if(b-=P,W=ee(W,$,"0"),H<$+1){if(0<--b)for(W+=".";b--;W+="0");}else if(0<(b+=$-H))for($+1==H&&(W+=".");b--;W+="0");return v.s<0&&M?"-"+W:W}function Be(v,b){for(var _,k=1,M=new Y(v[0]);k<v.length;k++){if(!(_=new Y(v[k])).s){M=_;break}b.call(M,_)&&(M=_)}return M}function xe(v,b,_){for(var k=1,M=b.length;!b[--M];b.pop());for(M=b[0];10<=M;M/=10,k++);return(_=k+_*g-1)>Z?v.c=v.e=null:v.c=_<ne?[v.e=0]:(v.e=_,b),v}function De(v,b,_,k){var M,$,P,H,W,L,V,te=v.c,he=C;if(te){e:{for(M=1,H=te[0];10<=H;H/=10,M++);if(($=b-M)<0)$+=g,P=b,V=(W=te[L=0])/he[M-P-1]%10|0;else if((L=l(($+1)/g))>=te.length){if(!k)break e;for(;te.length<=L;te.push(0));W=V=0,P=($%=g)-g+(M=1)}else{for(W=H=te[L],M=1;10<=H;H/=10,M++);V=(P=($%=g)-g+M)<0?0:W/he[M-P-1]%10|0}if(k=k||b<0||te[L+1]!=null||(P<0?W:W%he[M-P-1]),k=_<4?(V||k)&&(_==0||_==(v.s<0?3:2)):5<V||V==5&&(_==4||k||_==6&&(0<$?0<P?W/he[M-P]:0:te[L-1])%10&1||_==(v.s<0?8:7)),b<1||!te[0])return te.length=0,k?(b-=v.e+1,te[0]=he[(g-b%g)%g],v.e=-b||0):te[0]=v.e=0,v;if($==0?(te.length=L,H=1,L--):(te.length=L+1,H=he[g-$],te[L]=0<P?u(W/he[M-P]%he[P])*H:0),k)for(;;){if(L==0){for($=1,P=te[0];10<=P;P/=10,$++);for(P=te[0]+=H,H=1;10<=P;P/=10,H++);$!=H&&(v.e++,te[0]==d&&(te[0]=1));break}if(te[L]+=H,te[L]!=d)break;te[L--]=0,H=1}for($=te.length;te[--$]===0;te.pop());}v.e>Z?v.c=v.e=null:v.e<ne&&(v.c=[v.e=0])}return v}function be(v){var b,_=v.e;return _===null?v.toString():(b=T(v.c),b=_<=z||G<=_?B(b,_):ee(b,_,"0"),v.s<0?"-"+b:b)}return Y.clone=U,Y.ROUND_UP=0,Y.ROUND_DOWN=1,Y.ROUND_CEIL=2,Y.ROUND_FLOOR=3,Y.ROUND_HALF_UP=4,Y.ROUND_HALF_DOWN=5,Y.ROUND_HALF_EVEN=6,Y.ROUND_HALF_CEIL=7,Y.ROUND_HALF_FLOOR=8,Y.EUCLID=9,Y.config=Y.set=function(v){var b,_;if(v!=null){if(typeof v!="object")throw Error(c+"Object expected: "+v);if(v.hasOwnProperty(b="DECIMAL_PLACES")&&(I(_=v[b],0,y,b),O=_),v.hasOwnProperty(b="ROUNDING_MODE")&&(I(_=v[b],0,8,b),D=_),v.hasOwnProperty(b="EXPONENTIAL_AT")&&((_=v[b])&&_.pop?(I(_[0],-y,0,b),I(_[1],0,y,b),z=_[0],G=_[1]):(I(_,-y,y,b),z=-(G=_<0?-_:_))),v.hasOwnProperty(b="RANGE"))if((_=v[b])&&_.pop)I(_[0],-y,-1,b),I(_[1],1,y,b),ne=_[0],Z=_[1];else{if(I(_,-y,y,b),!_)throw Error(c+b+" cannot be zero: "+_);ne=-(Z=_<0?-_:_)}if(v.hasOwnProperty(b="CRYPTO")){if((_=v[b])!==!!_)throw Error(c+b+" not true or false: "+_);if(_){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw K=!_,Error(c+"crypto unavailable");K=_}else K=_}if(v.hasOwnProperty(b="MODULO_MODE")&&(I(_=v[b],0,9,b),Se=_),v.hasOwnProperty(b="POW_PRECISION")&&(I(_=v[b],0,y,b),Pe=_),v.hasOwnProperty(b="FORMAT")){if(typeof(_=v[b])!="object")throw Error(c+b+" not an object: "+_);Oe=_}if(v.hasOwnProperty(b="ALPHABET")){if(typeof(_=v[b])!="string"||/^.$|[+-.\s]|(.).*\1/.test(_))throw Error(c+b+" invalid: "+_);He=_}}return{DECIMAL_PLACES:O,ROUNDING_MODE:D,EXPONENTIAL_AT:[z,G],RANGE:[ne,Z],CRYPTO:K,MODULO_MODE:Se,POW_PRECISION:Pe,FORMAT:Oe,ALPHABET:He}},Y.isBigNumber=function(v){return v instanceof Y||v&&v._isBigNumber===!0||!1},Y.maximum=Y.max=function(){return Be(arguments,w.lt)},Y.minimum=Y.min=function(){return Be(arguments,w.gt)},Y.random=(Ce=9007199254740992,Me=Math.random()*Ce&2097151?function(){return u(Math.random()*Ce)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(v){var b,_,k,M,$,P=0,H=[],W=new Y(A);if(v==null?v=O:I(v,0,y),M=l(v/g),K)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(M*=2));P<M;)9e15<=($=131072*b[P]+(b[P+1]>>>11))?(_=crypto.getRandomValues(new Uint32Array(2)),b[P]=_[0],b[P+1]=_[1]):(H.push($%1e14),P+=2);P=M/2}else{if(!crypto.randomBytes)throw K=!1,Error(c+"crypto unavailable");for(b=crypto.randomBytes(M*=7);P<M;)9e15<=($=281474976710656*(31&b[P])+1099511627776*b[P+1]+4294967296*b[P+2]+16777216*b[P+3]+(b[P+4]<<16)+(b[P+5]<<8)+b[P+6])?crypto.randomBytes(7).copy(b,P):(H.push($%1e14),P+=7);P=M/7}if(!K)for(;P<M;)($=Me())<9e15&&(H[P++]=$%1e14);for(M=H[--P],v%=g,M&&v&&($=C[g-v],H[P]=u(M/$)*$);H[P]===0;H.pop(),P--);if(P<0)H=[k=0];else{for(k=-1;H[0]===0;H.splice(0,1),k-=g);for(P=1,$=H[0];10<=$;$/=10,P++);P<g&&(k-=g-P)}return W.e=k,W.c=H,W}),Y.sum=function(){for(var v=1,b=arguments,_=new Y(b[0]);v<b.length;)_=_.plus(b[v++]);return _},ie=function(){var v="0123456789";function b(_,k,M,$){for(var P,H,W=[0],L=0,V=_.length;L<V;){for(H=W.length;H--;W[H]*=k);for(W[0]+=$.indexOf(_.charAt(L++)),P=0;P<W.length;P++)W[P]>M-1&&(W[P+1]==null&&(W[P+1]=0),W[P+1]+=W[P]/M|0,W[P]%=M)}return W.reverse()}return function(_,k,M,$,P){var H,W,L,V,te,he,ye,Ae,We=_.indexOf("."),St=O,qe=D;for(0<=We&&(V=Pe,Pe=0,_=_.replace(".",""),he=(Ae=new Y(k)).pow(_.length-We),Pe=V,Ae.c=b(ee(T(he.c),he.e,"0"),10,M,v),Ae.e=Ae.c.length),L=V=(ye=b(_,k,M,P?(H=He,v):(H=v,He))).length;ye[--V]==0;ye.pop());if(!ye[0])return H.charAt(0);if(We<0?--L:(he.c=ye,he.e=L,he.s=$,ye=(he=re(he,Ae,St,qe,M)).c,te=he.r,L=he.e),We=ye[W=L+St+1],V=M/2,te=te||W<0||ye[W+1]!=null,te=qe<4?(We!=null||te)&&(qe==0||qe==(he.s<0?3:2)):V<We||We==V&&(qe==4||te||qe==6&&1&ye[W-1]||qe==(he.s<0?8:7)),W<1||!ye[0])_=te?ee(H.charAt(1),-St,H.charAt(0)):H.charAt(0);else{if(ye.length=W,te)for(--M;++ye[--W]>M;)ye[W]=0,W||(++L,ye=[1].concat(ye));for(V=ye.length;!ye[--V];);for(We=0,_="";We<=V;_+=H.charAt(ye[We++]));_=ee(_,L,H.charAt(0))}return _}}(),re=function(){function v(k,M,$){var P,H,W,L,V=0,te=k.length,he=M%S,ye=M/S|0;for(k=k.slice();te--;)V=((H=he*(W=k[te]%S)+(P=ye*W+(L=k[te]/S|0)*he)%S*S+V)/$|0)+(P/S|0)+ye*L,k[te]=H%$;return V&&(k=[V].concat(k)),k}function b(k,M,$,P){var H,W;if($!=P)W=P<$?1:-1;else for(H=W=0;H<$;H++)if(k[H]!=M[H]){W=k[H]>M[H]?1:-1;break}return W}function _(k,M,$,P){for(var H=0;$--;)k[$]-=H,H=k[$]<M[$]?1:0,k[$]=H*P+k[$]-M[$];for(;!k[0]&&1<k.length;k.splice(0,1));}return function(k,M,$,P,H){var W,L,V,te,he,ye,Ae,We,St,qe,ct,_t,Ra,jl,Bt,cn,bs,In=k.s==M.s?1:-1,Jt=k.c,yt=M.c;if(!(Jt&&Jt[0]&&yt&&yt[0]))return new Y(k.s&&M.s&&(Jt?!yt||Jt[0]!=yt[0]:yt)?Jt&&Jt[0]==0||!yt?0*In:In/0:NaN);for(St=(We=new Y(In)).c=[],In=$+(L=k.e-M.e)+1,H||(H=d,L=R(k.e/g)-R(M.e/g),In=In/g|0),V=0;yt[V]==(Jt[V]||0);V++);if(yt[V]>(Jt[V]||0)&&L--,In<0)St.push(1),te=!0;else{for(jl=Jt.length,cn=yt.length,In+=2,1<(he=u(H/(yt[V=0]+1)))&&(yt=v(yt,he,H),Jt=v(Jt,he,H),cn=yt.length,jl=Jt.length),Ra=cn,ct=(qe=Jt.slice(0,cn)).length;ct<cn;qe[ct++]=0);bs=yt.slice(),bs=[0].concat(bs),Bt=yt[0],yt[1]>=H/2&&Bt++;do{if(he=0,(W=b(yt,qe,cn,ct))<0){if(_t=qe[0],cn!=ct&&(_t=_t*H+(qe[1]||0)),1<(he=u(_t/Bt)))for(H<=he&&(he=H-1),Ae=(ye=v(yt,he,H)).length,ct=qe.length;b(ye,qe,Ae,ct)==1;)he--,_(ye,cn<Ae?bs:yt,Ae,H),Ae=ye.length,W=1;else he==0&&(W=he=1),Ae=(ye=yt.slice()).length;if(Ae<ct&&(ye=[0].concat(ye)),_(qe,ye,ct,H),ct=qe.length,W==-1)for(;b(yt,qe,cn,ct)<1;)he++,_(qe,cn<ct?bs:yt,ct,H),ct=qe.length}else W===0&&(he++,qe=[0]);St[V++]=he,qe[0]?qe[ct++]=Jt[Ra]||0:(qe=[Jt[Ra]],ct=1)}while((Ra++<jl||qe[0]!=null)&&In--);te=qe[0]!=null,St[0]||St.splice(0,1)}if(H==d){for(V=1,In=St[0];10<=In;In/=10,V++);De(We,$+(We.e=V+L*g-1)+1,P,te)}else We.e=L,We.r=+te;return We}}(),rt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Fe=/^([^.]+)\.$/,pe=/^\.([^.]+)$/,f=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,oe=function(v,b,_,k){var M,$=_?b:b.replace(m,"");if(f.test($))v.s=isNaN($)?null:$<0?-1:1,v.c=v.e=null;else{if(!_&&($=$.replace(rt,function(P,H,W){return M=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,k&&k!=M?P:H}),k&&(M=k,$=$.replace(Fe,"$1").replace(pe,"0.$1")),b!=$))return new Y($,M);if(Y.DEBUG)throw Error(c+"Not a"+(k?" base "+k:"")+" number: "+b);v.c=v.e=v.s=null}},w.absoluteValue=w.abs=function(){var v=new Y(this);return v.s<0&&(v.s=1),v},w.comparedTo=function(v,b){return N(this,new Y(v,b))},w.decimalPlaces=w.dp=function(v,b){var _,k,M;if(v!=null)return I(v,0,y),b==null?b=D:I(b,0,8),De(new Y(this),v+this.e+1,b);if(!(_=this.c))return null;if(k=((M=_.length-1)-R(this.e/g))*g,M=_[M])for(;M%10==0;M/=10,k--);return k<0&&(k=0),k},w.dividedBy=w.div=function(v,b){return re(this,new Y(v,b),O,D)},w.dividedToIntegerBy=w.idiv=function(v,b){return re(this,new Y(v,b),0,1)},w.exponentiatedBy=w.pow=function(v,b){var _,k,M,$,P,H,W,L,V=this;if((v=new Y(v)).c&&!v.isInteger())throw Error(c+"Exponent not an integer: "+be(v));if(b!=null&&(b=new Y(b)),P=14<v.e,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!v.c||!v.c[0])return L=new Y(Math.pow(+be(V),P?2-F(v):+be(v))),b?L.mod(b):L;if(H=v.s<0,b){if(b.c?!b.c[0]:!b.s)return new Y(NaN);(k=!H&&V.isInteger()&&b.isInteger())&&(V=V.mod(b))}else{if(9<v.e&&(0<V.e||V.e<-1||(V.e==0?1<V.c[0]||P&&24e7<=V.c[1]:V.c[0]<8e13||P&&V.c[0]<=9999975e7)))return $=V.s<0&&F(v)?-0:0,-1<V.e&&($=1/$),new Y(H?1/$:$);Pe&&($=l(Pe/g+2))}for(W=P?(_=new Y(.5),H&&(v.s=1),F(v)):(M=Math.abs(+be(v)))%2,L=new Y(A);;){if(W){if(!(L=L.times(V)).c)break;$?L.c.length>$&&(L.c.length=$):k&&(L=L.mod(b))}if(M){if((M=u(M/2))===0)break;W=M%2}else if(De(v=v.times(_),v.e+1,1),14<v.e)W=F(v);else{if((M=+be(v))==0)break;W=M%2}V=V.times(V),$?V.c&&V.c.length>$&&(V.c.length=$):k&&(V=V.mod(b))}return k?L:(H&&(L=A.div(L)),b?L.mod(b):$?De(L,Pe,D,void 0):L)},w.integerValue=function(v){var b=new Y(this);return v==null?v=D:I(v,0,8),De(b,b.e+1,v)},w.isEqualTo=w.eq=function(v,b){return N(this,new Y(v,b))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(v,b){return 0<N(this,new Y(v,b))},w.isGreaterThanOrEqualTo=w.gte=function(v,b){return(b=N(this,new Y(v,b)))===1||b===0},w.isInteger=function(){return!!this.c&&R(this.e/g)>this.c.length-2},w.isLessThan=w.lt=function(v,b){return N(this,new Y(v,b))<0},w.isLessThanOrEqualTo=w.lte=function(v,b){return(b=N(this,new Y(v,b)))===-1||b===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(v,b){var _,k,M,$,P=this,H=P.s;if(b=(v=new Y(v,b)).s,!H||!b)return new Y(NaN);if(H!=b)return v.s=-b,P.plus(v);var W=P.e/g,L=v.e/g,V=P.c,te=v.c;if(!W||!L){if(!V||!te)return V?(v.s=-b,v):new Y(te?P:NaN);if(!V[0]||!te[0])return te[0]?(v.s=-b,v):new Y(V[0]?P:D==3?-0:0)}if(W=R(W),L=R(L),V=V.slice(),H=W-L){for((M=($=H<0)?(H=-H,V):(L=W,te)).reverse(),b=H;b--;M.push(0));M.reverse()}else for(k=($=(H=V.length)<(b=te.length))?H:b,H=b=0;b<k;b++)if(V[b]!=te[b]){$=V[b]<te[b];break}if($&&(M=V,V=te,te=M,v.s=-v.s),0<(b=(k=te.length)-(_=V.length)))for(;b--;V[_++]=0);for(b=d-1;H<k;){if(V[--k]<te[k]){for(_=k;_&&!V[--_];V[_]=b);--V[_],V[k]+=d}V[k]-=te[k]}for(;V[0]==0;V.splice(0,1),--L);return V[0]?xe(v,V,L):(v.s=D==3?-1:1,v.c=[v.e=0],v)},w.modulo=w.mod=function(v,b){var _,k,M=this;return v=new Y(v,b),!M.c||!v.s||v.c&&!v.c[0]?new Y(NaN):!v.c||M.c&&!M.c[0]?new Y(M):(Se==9?(k=v.s,v.s=1,_=re(M,v,0,3),v.s=k,_.s*=k):_=re(M,v,0,Se),(v=M.minus(_.times(v))).c[0]||Se!=1||(v.s=M.s),v)},w.multipliedBy=w.times=function(v,b){var _,k,M,$,P,H,W,L,V,te,he,ye,Ae,We,St,qe=this,ct=qe.c,_t=(v=new Y(v,b)).c;if(!(ct&&_t&&ct[0]&&_t[0]))return!qe.s||!v.s||ct&&!ct[0]&&!_t||_t&&!_t[0]&&!ct?v.c=v.e=v.s=null:(v.s*=qe.s,ct&&_t?(v.c=[0],v.e=0):v.c=v.e=null),v;for(k=R(qe.e/g)+R(v.e/g),v.s*=qe.s,(W=ct.length)<(te=_t.length)&&(Ae=ct,ct=_t,_t=Ae,M=W,W=te,te=M),M=W+te,Ae=[];M--;Ae.push(0));for(We=d,St=S,M=te;0<=--M;){for(_=0,he=_t[M]%St,ye=_t[M]/St|0,$=M+(P=W);M<$;)_=((L=he*(L=ct[--P]%St)+(H=ye*L+(V=ct[P]/St|0)*he)%St*St+Ae[$]+_)/We|0)+(H/St|0)+ye*V,Ae[$--]=L%We;Ae[$]=_}return _?++k:Ae.splice(0,1),xe(v,Ae,k)},w.negated=function(){var v=new Y(this);return v.s=-v.s||null,v},w.plus=function(v,b){var _,k=this,M=k.s;if(b=(v=new Y(v,b)).s,!M||!b)return new Y(NaN);if(M!=b)return v.s=-b,k.minus(v);var $=k.e/g,P=v.e/g,H=k.c,W=v.c;if(!$||!P){if(!H||!W)return new Y(M/0);if(!H[0]||!W[0])return W[0]?v:new Y(H[0]?k:0*M)}if($=R($),P=R(P),H=H.slice(),M=$-P){for((_=0<M?(P=$,W):(M=-M,H)).reverse();M--;_.push(0));_.reverse()}for((M=H.length)-(b=W.length)<0&&(_=W,W=H,H=_,b=M),M=0;b;)M=(H[--b]=H[b]+W[b]+M)/d|0,H[b]=d===H[b]?0:H[b]%d;return M&&(H=[M].concat(H),++P),xe(v,H,P)},w.precision=w.sd=function(v,b){var _,k,M;if(v!=null&&v!==!!v)return I(v,1,y),b==null?b=D:I(b,0,8),De(new Y(this),v,b);if(!(_=this.c))return null;if(k=(M=_.length-1)*g+1,M=_[M]){for(;M%10==0;M/=10,k--);for(M=_[0];10<=M;M/=10,k++);}return v&&this.e+1>k&&(k=this.e+1),k},w.shiftedBy=function(v){return I(v,-p,p),this.times("1e"+v)},w.squareRoot=w.sqrt=function(){var v,b,_,k,M,$=this,P=$.c,H=$.s,W=$.e,L=O+4,V=new Y("0.5");if(H!==1||!P||!P[0])return new Y(!H||H<0&&(!P||P[0])?NaN:P?$:1/0);if((_=(H=Math.sqrt(+be($)))==0||H==1/0?(((b=T(P)).length+W)%2==0&&(b+="0"),H=Math.sqrt(+b),W=R((W+1)/2)-(W<0||W%2),new Y(b=H==1/0?"1e"+W:(b=H.toExponential()).slice(0,b.indexOf("e")+1)+W)):new Y(H+"")).c[0]){for((H=(W=_.e)+L)<3&&(H=0);;)if(M=_,_=V.times(M.plus(re($,M,L,1))),T(M.c).slice(0,H)===(b=T(_.c)).slice(0,H)){if(_.e<W&&--H,(b=b.slice(H-3,H+1))!="9999"&&(k||b!="4999")){+b&&(+b.slice(1)||b.charAt(0)!="5")||(De(_,_.e+O+2,1),v=!_.times(_).eq($));break}if(!k&&(De(M,M.e+O+2,0),M.times(M).eq($))){_=M;break}L+=4,H+=4,k=1}}return De(_,_.e+O+1,D,v)},w.toExponential=function(v,b){return v!=null&&(I(v,0,y),v++),lt(this,v,b,1)},w.toFixed=function(v,b){return v!=null&&(I(v,0,y),v=v+this.e+1),lt(this,v,b)},w.toFormat=function(v,b,_){var k;if(_==null)v!=null&&b&&typeof b=="object"?(_=b,b=null):v&&typeof v=="object"?(_=v,v=b=null):_=Oe;else if(typeof _!="object")throw Error(c+"Argument not an object: "+_);if(k=this.toFixed(v,b),this.c){var M,$=k.split("."),P=+_.groupSize,H=+_.secondaryGroupSize,W=_.groupSeparator||"",L=$[0],V=$[1],te=this.s<0,he=te?L.slice(1):L,ye=he.length;if(H&&(M=P,P=H,ye-=H=M),0<P&&0<ye){for(M=ye%P||P,L=he.substr(0,M);M<ye;M+=P)L+=W+he.substr(M,P);0<H&&(L+=W+he.slice(M)),te&&(L="-"+L)}k=V?L+(_.decimalSeparator||"")+((H=+_.fractionGroupSize)?V.replace(new RegExp("\\d{"+H+"}\\B","g"),"$&"+(_.fractionGroupSeparator||"")):V):L}return(_.prefix||"")+k+(_.suffix||"")},w.toFraction=function(v){var b,_,k,M,$,P,H,W,L,V,te,he,ye=this,Ae=ye.c;if(v!=null&&(!(H=new Y(v)).isInteger()&&(H.c||H.s!==1)||H.lt(A)))throw Error(c+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+be(H));if(!Ae)return new Y(ye);for(b=new Y(A),L=_=new Y(A),k=W=new Y(A),he=T(Ae),$=b.e=he.length-ye.e-1,b.c[0]=C[(P=$%g)<0?g+P:P],v=!v||0<H.comparedTo(b)?0<$?b:L:H,P=Z,Z=1/0,H=new Y(he),W.c[0]=0;V=re(H,b,0,1),(M=_.plus(V.times(k))).comparedTo(v)!=1;)_=k,k=M,L=W.plus(V.times(M=L)),W=M,b=H.minus(V.times(M=b)),H=M;return M=re(v.minus(_),k,0,1),W=W.plus(M.times(L)),_=_.plus(M.times(k)),W.s=L.s=ye.s,te=re(L,k,$*=2,D).minus(ye).abs().comparedTo(re(W,_,$,D).minus(ye).abs())<1?[L,k]:[W,_],Z=P,te},w.toNumber=function(){return+be(this)},w.toPrecision=function(v,b){return v!=null&&I(v,1,y),lt(this,v,b,2)},w.toString=function(v){var b,_=this,k=_.s,M=_.e;return M===null?k?(b="Infinity",k<0&&(b="-"+b)):b="NaN":(b=v==null?M<=z||G<=M?B(T(_.c),M):ee(T(_.c),M,"0"):v===10?ee(T((_=De(new Y(_),O+M+1,D)).c),_.e,"0"):(I(v,2,He.length,"Base"),ie(ee(T(_.c),M,"0"),10,v,k,!0)),k<0&&_.c[0]&&(b="-"+b)),b},w.valueOf=w.toJSON=function(){return be(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),j!=null&&Y.set(j),Y}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(R,T){return function(N){if(Array.isArray(N))return N}(R)||function(N,I){var F=[],B=!0,ee=!1,U=void 0;try{for(var j,re=N[Symbol.iterator]();!(B=(j=re.next()).done)&&(F.push(j.value),!I||F.length!==I);B=!0);}catch(ie){ee=!0,U=ie}finally{try{B||re.return==null||re.return()}finally{if(ee)throw U}}return F}(R,T)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(R){var T=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},N=2<arguments.length?arguments[2]:void 0;if(typeof T=="string"&&(T=l.parseFormat(T)),!a.validateFormat(T))return"ERROR: invalid format";var I=T.prefix||"",F=T.postfix||"",B=function(ee,U,j){switch(U.output){case"currency":return U=y(U,s.currentCurrencyDefaultFormat()),function(He,Y,lt){var Be=lt.currentCurrency(),xe=Object.assign({},h,Y),De=void 0,be="",v=!!xe.totalLength||!!xe.forceAverage||xe.average,b=Y.currencyPosition||Be.position,_=Y.currencySymbol||Be.symbol;xe.spaceSeparated&&(be=" "),b==="infix"&&(De=be+_+be);var k=S({instance:He,providedFormat:Y,state:lt,decimalSeparator:De});return b==="prefix"&&(k=He._value<0&&xe.negative==="sign"?"-".concat(be).concat(_).concat(k.slice(1)):_+be+k),b&&b!=="postfix"||(k=k+(be=v?"":be)+_),k}(ee,U,s);case"percent":return U=y(U,s.currentPercentageDefaultFormat()),function(He,Y,lt,Be){var xe=Y.prefixSymbol,De=S({instance:Be(100*He._value),providedFormat:Y,state:lt}),be=Object.assign({},h,Y);return xe?"%".concat(be.spaceSeparated?" ":"").concat(De):"".concat(De).concat(be.spaceSeparated?" ":"","%")}(ee,U,s,j);case"byte":return U=y(U,s.currentByteDefaultFormat()),A=ee,D=s,z=j,G=(O=U).base||"binary",ne=c[G],Z=g(A._value,ne.suffixes,ne.scale),K=Z.value,Se=Z.suffix,Pe=S({instance:z(K),providedFormat:O,state:D,defaults:D.currentByteDefaultFormat()}),Oe=D.currentAbbreviations(),"".concat(Pe).concat(Oe.spaced?" ":"").concat(Se);case"time":return U=y(U,s.currentTimeDefaultFormat()),pe=ee,f=Math.floor(pe._value/60/60),m=Math.floor((pe._value-60*f*60)/60),w=Math.round(pe._value-60*f*60-60*m),"".concat(f,":").concat(m<10?"0":"").concat(m,":").concat(w<10?"0":"").concat(w);case"ordinal":return U=y(U,s.currentOrdinalDefaultFormat()),re=ee,ie=U,Ce=(oe=s).currentOrdinal(),Me=Object.assign({},h,ie),rt=S({instance:re,providedFormat:ie,state:oe}),Fe=Ce(re._value),"".concat(rt).concat(Me.spaceSeparated?" ":"").concat(Fe);case"number":default:return S({instance:ee,providedFormat:U,numbro:j})}var re,ie,oe,Ce,Me,rt,Fe,pe,f,m,w,A,O,D,z,G,ne,Z,K,Se,Pe,Oe}(R,T,N);return B=(B=I+B)+F}function g(R,T,N){var I=T[0],F=Math.abs(R);if(N<=F){for(var B=1;B<T.length;++B){var ee=Math.pow(N,B),U=Math.pow(N,B+1);if(ee<=F&&F<U){I=T[B],R/=ee;break}}I===T[0]&&(R/=Math.pow(N,T.length-1),I=T[T.length-1])}return{value:R,suffix:I}}function p(R){for(var T="",N=0;N<R;N++)T+="0";return T}function C(R,T){return R.toString().indexOf("e")!==-1?function(N,I){var F=N.toString(),B=o(F.split("e"),2),ee=B[0],U=B[1],j=o(ee.split("."),2),re=j[0],ie=j[1],oe=ie===void 0?"":ie;if(0<+U)F=re+oe+p(U-oe.length);else{var Ce=".";Ce=+re<0?"-0".concat(Ce):"0".concat(Ce);var Me=(p(-U-1)+Math.abs(re)+oe).substr(0,I);Me.length<I&&(Me+=p(I-Me.length)),F=Ce+Me}return 0<+U&&0<I&&(F+=".".concat(p(I))),F}(R,T):(Math.round(+"".concat(R,"e+").concat(T))/Math.pow(10,T)).toFixed(T)}function S(R){var T=R.instance,N=R.providedFormat,I=R.state,F=I===void 0?s:I,B=R.decimalSeparator,ee=R.defaults,U=ee===void 0?F.currentDefaults():ee,j=T._value;if(j===0&&F.hasZeroFormat())return F.getZeroFormat();if(!isFinite(j))return j.toString();var re,ie,oe,Ce,Me,rt,Fe,pe,f=Object.assign({},h,U,N),m=f.totalLength,w=m?0:f.characteristic,A=f.optionalCharacteristic,O=f.forceAverage,D=!!m||!!O||f.average,z=m?-1:D&&N.mantissa===void 0?0:f.mantissa,G=!m&&(N.optionalMantissa===void 0?z===-1:f.optionalMantissa),ne=f.trimMantissa,Z=f.thousandSeparated,K=f.spaceSeparated,Se=f.negative,Pe=f.forceSign,Oe=f.exponential,He="";if(D){var Y=function(v){var b=v.value,_=v.forceAverage,k=v.abbreviations,M=v.spaceSeparated,$=M!==void 0&&M,P=v.totalLength,H=P===void 0?0:P,W="",L=Math.abs(b),V=-1;if(L>=Math.pow(10,12)&&!_||_==="trillion"?(W=k.trillion,b/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!_||_==="billion"?(W=k.billion,b/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!_||_==="million"?(W=k.million,b/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!_||_==="thousand")&&(W=k.thousand,b/=Math.pow(10,3)),W&&(W=($?" ":"")+W),H){var te=b.toString().split(".")[0];V=Math.max(H-te.length,0)}return{value:b,abbreviation:W,mantissaPrecision:V}}({value:j,forceAverage:O,abbreviations:F.currentAbbreviations(),spaceSeparated:K,totalLength:m});j=Y.value,He+=Y.abbreviation,m&&(z=Y.mantissaPrecision)}if(Oe){var lt=(ie=(re={value:j,characteristicPrecision:w}).value,oe=re.characteristicPrecision,Ce=oe===void 0?0:oe,Me=o(ie.toExponential().split("e"),2),rt=Me[0],Fe=Me[1],pe=+rt,Ce&&1<Ce&&(pe*=Math.pow(10,Ce-1),Fe=0<=(Fe=+Fe-(Ce-1))?"+".concat(Fe):Fe),{value:pe,abbreviation:"e".concat(Fe)});j=lt.value,He=lt.abbreviation+He}var Be,xe,De,be=function(v,b,_,k,M){if(k===-1)return v;var $=C(b,k),P=o($.toString().split("."),2),H=P[0],W=P[1],L=W===void 0?"":W;if(L.match(/^0+$/)&&(_||M))return H;var V=L.match(/0+$/);return M&&V?"".concat(H,".").concat(L.toString().slice(0,V.index)):$.toString()}(j.toString(),j,G,z,ne);return be=function(v,b,_,k,M){var $=k.currentDelimiters(),P=$.thousands;M=M||$.decimal;var H=$.thousandsSize||3,W=v.toString(),L=W.split(".")[0],V=W.split(".")[1];return _&&(b<0&&(L=L.slice(1)),function(te,he){for(var ye=[],Ae=0,We=te;0<We;We--)Ae===he&&(ye.unshift(We),Ae=0),Ae++;return ye}(L.length,H).forEach(function(te,he){L=L.slice(0,te+he)+P+L.slice(te+he)}),b<0&&(L="-".concat(L))),W=V?L+M+V:L}(be=function(v,b,_,k){var M=v,$=o(M.toString().split("."),2),P=$[0],H=$[1];if(P.match(/^-?0$/)&&_)return H?"".concat(P.replace("0",""),".").concat(H):P.replace("0","");if(P.length<k)for(var W=k-P.length,L=0;L<W;L++)M="0".concat(M);return M.toString()}(be,0,A,w),j,Z,F,B),(D||Oe)&&(be=be+He),(Pe||j<0)&&(Be=be,De=Se,be=(xe=j)===0?Be:+Be==0?Be.replace("-",""):0<xe?"+".concat(Be):De==="sign"?Be:"(".concat(Be.replace("-",""),")")),be}function y(R,T){if(!R)return T;var N=Object.keys(R);return N.length===1&&N[0]==="output"?T:R}r.exports=function(R){return{format:function(){for(var T=arguments.length,N=new Array(T),I=0;I<T;I++)N[I]=arguments[I];return d.apply(void 0,N.concat([R]))},getByteUnit:function(){for(var T=arguments.length,N=new Array(T),I=0;I<T;I++)N[I]=arguments[I];return(function(F){var B=c.general;return g(F._value,B.suffixes,B.scale).suffix}).apply(void 0,N.concat([R]))},getBinaryByteUnit:function(){for(var T=arguments.length,N=new Array(T),I=0;I<T;I++)N[I]=arguments[I];return(function(F){var B=c.binary;return g(F._value,B.suffixes,B.scale).suffix}).apply(void 0,N.concat([R]))},getDecimalByteUnit:function(){for(var T=arguments.length,N=new Array(T),I=0;I<T;I++)N[I]=arguments[I];return(function(F){var B=c.decimal;return g(F._value,B.suffixes,B.scale).suffix}).apply(void 0,N.concat([R]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,d={};function g(C){u=C}function p(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return p().currency},l.currentAbbreviations=function(){return p().abbreviations},l.currentDelimiters=function(){return p().delimiters},l.currentOrdinal=function(){return p().ordinal},l.currentDefaults=function(){return Object.assign({},p().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().timeFormat)},l.setDefaults=function(C){C=a.parseFormat(C),s.validateFormat(C)&&(d=C)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(C){return h=typeof C=="string"?C:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(C){if(C){if(c[C])return c[C];throw new Error('Unknown tag "'.concat(C,'"'))}return p()},l.registerLanguage=function(C){var S=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(C))throw new Error("Invalid language data");c[C.languageTag]=C,S&&g(C.languageTag)},l.setLanguage=function(C){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[C]){var y=C.split("-")[0],R=Object.keys(c).find(function(T){return T.split("-")[0]===y});return c[R]?void g(R):void g(S)}g(C)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,d=a,g=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.plus(p).toNumber(),c;var c,h,d,g,p},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,d=a,g=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.times(p).toNumber(),c;var c,h,d,g,p},divide:function(l,u){return h=u,d=a,g=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.dividedBy(p).toNumber(),c;var c,h,d,g,p},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,s(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(S,y){for(var R=0;R<y.length;R++){var T=y[R];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(S,T.key,T)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(C),u=n("./unformatting"),c=n("./formatting")(C),h=n("./manipulating")(C),d=n("./parsing"),g=function(){function S(T){(function(N,I){if(!(N instanceof I))throw new TypeError("Cannot call a class as a function")})(this,S),this._value=T}var y,R;return y=S,(R=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var T=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,T)}},{key:"formatCurrency",value:function(T){return typeof T=="string"&&(T=d.parseFormat(T)),(T=c.formatOrDefault(T,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,T)}},{key:"formatTime",value:function(){var T=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return T.output="time",c.format(this,T)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(T){return h.difference(this,T)}},{key:"add",value:function(T){return h.add(this,T)}},{key:"subtract",value:function(T){return h.subtract(this,T)}},{key:"multiply",value:function(T){return h.multiply(this,T)}},{key:"divide",value:function(T){return h.divide(this,T)}},{key:"set",value:function(T){return h.set(this,p(T))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(y.prototype,R),S}();function p(S){var y=S;return C.isNumbro(S)?y=S._value:typeof S=="string"?y=C.unformat(S):isNaN(S)&&(y=NaN),y}function C(S){return new g(p(S))}C.version="2.1.2",C.isNumbro=function(S){return S instanceof g},C.language=s.currentLanguage,C.registerLanguage=s.registerLanguage,C.setLanguage=s.setLanguage,C.languages=s.languages,C.languageData=s.languageData,C.zeroFormat=s.setZeroFormat,C.defaultFormat=s.currentDefaults,C.setDefaults=s.setDefaults,C.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,C.validate=a.validate,C.loadLanguagesInNode=l.loadLanguagesInNode,C.unformat=u.unformat,r.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,d,g,p,C,S,y,R,T,N,I,F,B,ee,U,j=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=j,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=j,function(re,ie){if(re.indexOf("$")===-1){if(re.indexOf("%")===-1)return re.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):re.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):re.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):re.indexOf(":")===-1?re.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,j),d=j,(g=o.match(/[1-9]+[0-9]*/))&&(d.totalLength=+g[0]),p=j,(C=o.split(".")[0].match(/0+/))&&(p.characteristic=C[0].length),function(re,ie){if(re.indexOf(".")!==-1){var oe=re.split(".")[0];ie.optionalCharacteristic=oe.indexOf("0")===-1}}(o,j),S=j,o.indexOf("a")!==-1&&(S.average=!0),R=j,(y=o).indexOf("K")!==-1?R.forceAverage="thousand":y.indexOf("M")!==-1?R.forceAverage="million":y.indexOf("B")!==-1?R.forceAverage="billion":y.indexOf("T")!==-1&&(R.forceAverage="trillion"),function(re,ie){var oe=re.split(".")[1];if(oe){var Ce=oe.match(/0+/);Ce&&(ie.mantissa=Ce[0].length)}}(o,j),N=j,(T=o).match(/\[\.]/)?N.optionalMantissa=!0:T.match(/\./)&&(N.optionalMantissa=!1),I=j,o.indexOf(",")!==-1&&(I.thousandSeparated=!0),F=j,o.indexOf(" ")!==-1&&(F.spaceSeparated=!0),ee=j,(B=o).match(/^\+?\([^)]*\)$/)&&(ee.negative="parenthesis"),B.match(/^\+?-/)&&(ee.negative="sign"),U=j,o.match(/^\+/)&&(U.forceSign=!0),j)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function C(S,y){var R=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",T=3<arguments.length?arguments[3]:void 0,N=4<arguments.length?arguments[4]:void 0,I=5<arguments.length?arguments[5]:void 0,F=6<arguments.length?arguments[6]:void 0;if(!isNaN(+S))return+S;var B="",ee=S.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ee!==S)return-1*C(ee,y,R,T,N,I,F);for(var U=0;U<o.length;U++){var j=o[U];if((B=S.replace(j.key,""))!==S)return C(B,y,R,T,N,I,F)*j.factor}if((B=S.replace("%",""))!==S)return C(B,y,R,T,N,I,F)/100;var re=parseFloat(S);if(!isNaN(re)){var ie=T(re);if(ie&&ie!=="."&&(B=S.replace(new RegExp("".concat(s(ie),"$")),""))!==S)return C(B,y,R,T,N,I,F);var oe={};Object.keys(I).forEach(function(m){oe[I[m]]=m});for(var Ce=Object.keys(oe).sort().reverse(),Me=Ce.length,rt=0;rt<Me;rt++){var Fe=Ce[rt],pe=oe[Fe];if((B=S.replace(Fe,""))!==S){var f=void 0;switch(pe){case"thousand":f=Math.pow(10,3);break;case"million":f=Math.pow(10,6);break;case"billion":f=Math.pow(10,9);break;case"trillion":f=Math.pow(10,12)}return C(B,y,R,T,N,I,F)*f}}}}(function(C,S){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=C.replace(y,"");return R=(R=R.replace(new RegExp("([0-9])".concat(s(S.thousands),"([0-9])"),"g"),"$1$2")).replace(S.decimal,".")}(l,u,c),u,c,h,d,g,p)}r.exports={unformat:function(l,u){var c,h,d,g=n("./globalState"),p=g.currentDelimiters(),C=g.currentCurrency().symbol,S=g.currentOrdinal(),y=g.getZeroFormat(),R=g.currentAbbreviations(),T=void 0;if(typeof l=="string")T=function(N,I){if(!N.indexOf(":")||I.thousands===":")return!1;var F=N.split(":");if(F.length!==3)return!1;var B=+F[0],ee=+F[1],U=+F[2];return!isNaN(B)&&!isNaN(ee)&&!isNaN(U)}(l,p)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,p,C,S,y,R,u);else{if(typeof l!="number")return;T=l}if(T!==void 0)return T}}},{"./globalState":4}],10:[function(n,r,i){function o(p){return function(C){if(Array.isArray(C)){for(var S=0,y=new Array(C.length);S<C.length;S++)y[S]=C[S];return y}}(p)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(p)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p){return!!a.unformat(p)}function d(p,C,S){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],R=Object.keys(p).map(function(T){if(!C[T])return console.error("".concat(S," Invalid key: ").concat(T)),!1;var N=p[T],I=C[T];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!d(N,u,"[Validate ".concat(T,"]"),!0))return!1}else if(s(N)!==I.type)return console.error("".concat(S," ").concat(T,' type mismatched: "').concat(I.type,'" expected, "').concat(s(N),'" provided')),!1;if(I.restrictions&&I.restrictions.length)for(var F=I.restrictions.length,B=0;B<F;B++){var ee=I.restrictions[B],U=ee.restriction,j=ee.message;if(!U(N,p))return console.error("".concat(S," ").concat(T," invalid value: ").concat(j)),!1}return I.restriction&&!I.restriction(N,p)?(console.error("".concat(S," ").concat(T," invalid value: ").concat(I.message)),!1):I.validValues&&I.validValues.indexOf(N)===-1?(console.error("".concat(S," ").concat(T," invalid value: must be among ").concat(JSON.stringify(I.validValues),', "').concat(N,'" provided')),!1):!(I.children&&!d(N,I.children,"[Validate ".concat(T,"]")))});return y||R.push.apply(R,o(Object.keys(C).map(function(T){var N=C[T];if(typeof N=="string"&&(N={type:N}),N.mandatory){var I=N.mandatory;if(typeof I=="function"&&(I=I(p)),I&&p[T]===void 0)return console.error("".concat(S,' Missing mandatory key "').concat(T,'"')),!1}return!0}))),R.reduce(function(T,N){return T&&N},!0)}function g(p){return d(p,u,"[Validate format]")}r.exports={validate:function(p,C){var S=h(p),y=g(C);return S&&y},validateFormat:g,validateInput:h,validateLanguage:function(p){return d(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(gH);var M8=gH.exports;const Hs=PN(M8),A8="numeric";function Nb(t,e,n,r,i,o,s){let a=o;if(Wn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",d=h.length?h.split(" "):[];if(typeof u<"u"&&!Hs.languages()[u]){const g=u.replace("-",""),p=Hs.allLanguages?Hs.allLanguages[u]:Hs[g];p&&Hs.registerLanguage(p)}Hs.setLanguage(u),a=Hs(a).format(c||"0"),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),s.className=d.join(" "),e.dir="ltr"}Ao(t,e,n,r,i,a,s)}Nb.RENDERER_TYPE=A8;const O8="password";function Lb(t,e,n,r,i,o,s){Ao.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";me(a-1,()=>{u+=l}),Sa(e,u)}Lb.RENDERER_TYPE=O8;const I8="select";function $b(t,e,n,r,i,o,s){Ao.apply(this,[t,e,n,r,i,o,s])}$b.RENDERER_TYPE=I8;const P8="time";function kb(t,e,n,r,i,o,s){Ao.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}kb.RENDERER_TYPE=P8;function x8(){lr(Yl),lr(qc),lr(xb),lr(Pb),lr(Db),lr(Ib),lr(Nb),lr(Lb),lr($b),lr(Ao),lr(kb)}const H8="autocomplete";function Yg(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,KE(n,e)):KE(n,e)(this.source):e(!0)}Yg.VALIDATOR_TYPE=H8;function KE(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function mH(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const D8=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:mH},Symbol.toStringTag,{value:"Module"})),N8="date";function Fb(t,e){const n=LP(aH,this.instance);let r=t,i=!0;r==null&&(r="");let o=X(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=X(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=L8(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}Fb.VALIDATOR_TYPE=N8;function L8(t,e){const n=X(mH(t)),r=X(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const $8="dropdown";function Wb(t,e){Yg.apply(this,[t,e])}Wb.VALIDATOR_TYPE=$8;const k8="numeric";function Vb(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Wn(t))}Vb.VALIDATOR_TYPE=k8;const F8=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],W8="time";function Bb(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=X(i,F8,!0).isValid()?X(i):X(i,n);let a=s.isValid(),l=X(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}Bb.VALIDATOR_TYPE=W8;function V8(){ta(Yg),ta(Wb),ta(Fb),ta(Vb),ta(Bb)}const B8="autocomplete",U8={CELL_TYPE:B8,editor:Mb,renderer:Yl,validator:Yg},Y8="checkbox",G8={CELL_TYPE:Y8,editor:sH,renderer:xb},z8="date";function pH(t,e,n,r,i,o,s){Yl.apply(this,[t,e,n,r,i,o,s])}pH.RENDERER_TYPE=z8;const j8="date",K8={CELL_TYPE:j8,editor:lH,renderer:pH,validator:Fb},X8="dropdown",q8={CELL_TYPE:X8,editor:Ob,renderer:Pb,validator:Wb},Z8="handsontable",J8={CELL_TYPE:Z8,editor:_b,renderer:Db},Q8="numeric",e7={CELL_TYPE:Q8,editor:uH,renderer:Nb,validator:Vb,dataType:"number"},t7="password",n7={CELL_TYPE:t7,editor:cH,renderer:Lb,copyable:!1},r7="select",i7={CELL_TYPE:r7,editor:hH,renderer:$b},o7="time",s7={CELL_TYPE:o7,editor:dH,renderer:kb,validator:Bb};function a7(){br(U8),br(G8),br(K8),br(q8),br(J8),br(e7),br(n7),br(i7),br(oH),br(s7)}function l7(t,e){wH(t,e),e.add(t)}function u7(t,e,n){wH(t,e),e.set(t,n)}function wH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Na(t,e,n){return e=c7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c7(t){var e=h7(t,"string");return typeof e=="symbol"?e:String(e)}function h7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function La(t,e){var n=f7(t,e,"get");return g7(t,n)}function f7(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function g7(t,e){return e.get?e.get.call(t):e.value}const XE=new Map([["plugin",xz],["cell-type",Xx],["editor",NP],["renderer",YP],["validator",GP]]),m7="base",Rp=[];let gi=null;var Ds=new WeakMap,qE=new WeakSet;class it{static get PLUGIN_KEY(){return m7}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){l7(this,qE),Na(this,"eventManager",new xr(this)),Na(this,"pluginName",null),Na(this,"pluginsInitializedCallbacks",[]),Na(this,"isPluginsReady",!1),Na(this,"enabled",!1),Na(this,"initialized",!1),u7(this,Ds,{writable:!0,value:{}}),Fi(this,"hot",e,{writable:!1}),gi=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!XE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);XE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Rp.push(o)}}if(gi||(gi=_S()),gi.indexOf("UndoRedo")>=0&&gi.splice(gi.indexOf("UndoRedo"),1),gi.indexOf(this.pluginName)>=0&&gi.splice(gi.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),gi.length===0){if(Rp.length>0){const i=[`${Rp.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){La(this,Ds)[e]=La(this,Ds)[e]||[];const r=La(this,Ds)[e];this.hot.addHook(e,n),r.push(n),La(this,Ds)[e]=r}removeHooks(e){E(La(this,Ds)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=La(this,Ds);Ye(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){E(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=d7(this,qE,p7).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ye(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function p7(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ns(t,e,n){return e=w7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w7(t){var e=C7(t,"string");return typeof e=="symbol"?e:String(e)}function C7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let v7=class{constructor(e){Ns(this,"hot",null),Ns(this,"container",null),Ns(this,"injected",!1),Ns(this,"rows",[]),Ns(this,"columns",[]),Ns(this,"samples",null),Ns(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),E(this.rows,n=>{e(n.row,xt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),E(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{E(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{E(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{E(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),E(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{E(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const Ub=v7;function jh(t,e,n){return e=S7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S7(t){var e=y7(t,"string");return typeof e=="symbol"?e:String(e)}function y7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yb{static get SAMPLE_COUNT(){return 3}constructor(e){jh(this,"samples",null),jh(this,"dataFactory",null),jh(this,"customSampleCount",null),jh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Yb.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return me(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return me(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ve(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Wt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}const CH=Yb;function $a(t,e){vH(t,e),e.add(t)}function b7(t,e,n){vH(t,e),e.set(t,n)}function vH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ka(t,e,n){return e=R7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R7(t){var e=E7(t,"string");return typeof e=="symbol"?e:String(e)}function E7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T7(t,e,n){var r=SH(t,e,"set");return _7(t,r,n),n}function _7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Kh(t,e){var n=SH(t,e,"get");return M7(t,n)}function SH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function M7(t,e){return e.get?e.get.call(t):e.value}function Ls(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("modifyAutoColumnSizeSeed");const mu="autoColumnSize",A7=10,O7="autoColumnSize";var ml=new WeakMap,ZE=new WeakSet,JE=new WeakSet,QE=new WeakSet,Ep=new WeakSet,eT=new WeakSet,tT=new WeakSet;class tc extends it{static get PLUGIN_KEY(){return mu}static get PLUGIN_PRIORITY(){return A7}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),$a(this,tT),$a(this,eT),$a(this,Ep),$a(this,QE),$a(this,JE),$a(this,ZE),ka(this,"ghostTable",new Ub(this.hot)),ka(this,"samplesGenerator",new CH((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ka(this,"firstCalculation",!0),ka(this,"inProgress",!1),ka(this,"measuredColumns",0),ka(this,"columnWidthsMap",new ys),b7(this,ml,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(O7,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Ls(this,Ep,nT).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[mu]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[mu];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ls(e,JE,P7).call(e,...i)}),this.addHook("beforeChangeRender",r=>Ls(this,QE,x7).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>Ls(this,tT,D7).call(this,r)),this.addHook("beforeViewRender",r=>Ls(this,ZE,I7).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>Ls(this,eT,H7).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Ls(this,Ep,nT).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;me(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);E(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){bc(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+tc.CALCULATION_STEP,r)},e),n=n+tc.CALCULATION_STEP+1,n<r?i=Pg(o):(bc(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[mu],n=e&&Pt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[mu];let n=tc.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Ve(e)&&(n=e.syncLimit,nS(n)?n=ES(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,zc.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Yt(e,(r,i,o)=>{const s=Kh(this,ml).length;return(s-1<o||Kh(this,ml)[o]!==i)&&r.push(o),s-1<o?Kh(this,ml).push(i):Kh(this,ml)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{E(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!pr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function I7(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function P7(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function x7(t){const e=Ue(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function nT(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function H7(){T7(this,ml,this.hot.getColHeader())}function D7(t){const e=pr(t,r=>{var i;return ue((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ue(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const ia={horizontal:"horizontal",vertical:"vertical"};function N7(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function L7(t){const e={};return t===!0?(e.directions=Object.keys(ia),e.autoInsertRow=!0):Ve(t)?(ue(t.autoInsertRow)?t.direction===ia.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(ia)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function pu(t,e){$7(t,e),e.add(t)}function $7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fa(t,e,n){return e=k7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k7(t){var e=F7(t,"string");return typeof e=="symbol"?e:String(e)}function F7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("modifyAutofillRange");de.getSingleton().register("beforeAutofill");de.getSingleton().register("afterAutofill");const rT="autofill",W7=20,V7=["fillHandle"],B7="insert_row_below",U7=200;var iT=new WeakSet,oT=new WeakSet,sT=new WeakSet,aT=new WeakSet,lT=new WeakSet;class Y7 extends it{constructor(){super(...arguments),pu(this,lT),pu(this,aT),pu(this,sT),pu(this,oT),pu(this,iT),Fa(this,"addingStarted",!1),Fa(this,"mouseDownOnCellCorner",!1),Fa(this,"mouseDragOutside",!1),Fa(this,"handleDraggedCells",0),Fa(this,"directions",[]),Fa(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return rT}static get PLUGIN_PRIORITY(){return W7}static get SETTING_KEYS(){return[rT,...V7]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>wu(this,oT,z7).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>wu(this,iT,G7).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>wu(this,sT,j7).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return E(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),E(a,c=>{const h=[];E(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=N7(l,u,(g,p)=>this.hot._createCellCoords(g,p));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),p=o.clone(),C=this.hot._createCellRange(h,h,d),S=this.hot.runHooks("beforeAutofill",g,p,C,c);if(S===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=S;const R=S;if(["up","left"].indexOf(c)>-1&&!(R.length===1&&R[0].length===0))if(y=[],c==="up"){const T=d.row-h.row+1,N=T%R.length;for(let I=0;I<T;I++)y.push(R[(I+(R.length-N))%R.length])}else{const T=d.col-h.col+1,N=T%R[0].length;for(let I=0;I<R.length;I++){y.push([]);for(let F=0;F<T;F++)y[I].push(R[I][(F+(R[I].length-N))%R[I].length])}}this.hot.populateFromArray(h.row,h.col,y,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,p,C,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(ia.vertical)&&this.directions.includes(ia.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(ia.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(ia.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(B7,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},U7)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=en(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+xt(this.hot.table),i=en(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ft(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>wu(this,aT,K7).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>wu(this,lT,X7).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=L7(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function G7(){this.selectAdjacent()&&this.fillIn()}function z7(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function j7(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function K7(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function X7(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Xh(t,e){q7(t,e),e.add(t)}function q7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $s(t,e,n){return e=Z7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z7(t){var e=J7(t,"string");return typeof e=="symbol"?e:String(e)}function J7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const qh="autoRowSize",Q7=40,eX="autoRowSize";var uT=new WeakSet,Tp=new WeakSet,cT=new WeakSet,hT=new WeakSet;class nc extends it{static get PLUGIN_KEY(){return qh}static get PLUGIN_PRIORITY(){return Q7}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Xh(this,hT),Xh(this,cT),Xh(this,Tp),Xh(this,uT),$s(this,"headerHeight",null),$s(this,"ghostTable",new Ub(this.hot)),$s(this,"samplesGenerator",new CH((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),$s(this,"firstCalculation",!0),$s(this,"inProgress",!1),$s(this,"measuredRows",0),$s(this,"rowHeightsMap",new ys),this.hot.rowIndexMapper.registerMap(eX,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Cu(this,Tp,dT).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[qh];return e===!0||Ve(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Cu(e,cT,nX).call(e,...r)}),this.addHook("beforeChangeRender",n=>Cu(this,hT,rX).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Cu(this,uT,tX).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Cu(this,Tp,dT).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}me(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);E(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){bc(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+nc.CALCULATION_STEP,r)},e),n=n+nc.CALCULATION_STEP+1,n<r?i=Pg(o):(bc(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[qh],n=e&&Pt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){ds(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[qh];let n=nc.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Ve(e)&&(n=e.syncLimit,nS(n)?n=ES(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!pr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function tX(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function dT(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function nX(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function rX(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:iX,getListWithRemovedItems:oX}=Mx("physicallyIndexed");class sX extends ya{constructor(){super(e=>e)}insert(e,n){const r=JS(this.indexedValues,n);this.indexedValues=iX(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=oX(this.indexedValues,e);this.indexedValues=ZS(n,e),super.remove(e)}}const aX=sX,{getListWithInsertedItems:lX,getListWithRemovedItems:uX}=Mx("physicallyIndexed");class cX extends ya{constructor(){super(e=>e)}insert(e,n){this.indexedValues=lX(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=uX(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const hX=cX;function dX(t,e){fX(t,e),e.add(t)}function fX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gX(t,e,n){return e=mX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mX(t){var e=pX(t,"string");return typeof e=="symbol"?e:String(e)}function pX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wX(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const _p="bindRowsWithHeaders",CX=210,vX="loose",SX=new Map([["loose",aX],["strict",hX]]);var fT=new WeakSet;class yX extends it{constructor(){super(...arguments),dX(this,fT),gX(this,"headerIndexes",null)}static get PLUGIN_KEY(){return _p}static get PLUGIN_PRIORITY(){return CX}isEnabled(){return!!this.hot.getSettings()[_p]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[_p];typeof e!="string"&&(e=vX);const n=SX.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>wX(this,fT,bX).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function bX(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Zh(t,e){yH(t,e),e.add(t)}function RX(t,e,n){yH(t,e),e.set(t,n)}function yH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gT(t,e,n){return e=EX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EX(t){var e=TX(t,"string");return typeof e=="symbol"?e:String(e)}function TX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mT(t,e){var n=bH(t,e,"get");return _X(t,n)}function _X(t,e){return e.get?e.get.call(t):e.value}function Jh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Mp(t,e,n){var r=bH(t,e,"set");return MX(t,r,n),n}function bH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function MX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const jd="collapsibleColumns",AX=290,OX=["nestedHeaders"],_l="collapsibleIndicator",pT=jd,wT=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Wa=new WeakMap,CT=new WeakSet,vT=new WeakSet,ST=new WeakSet,yT=new WeakSet;class IX extends it{constructor(){super(...arguments),Zh(this,yT),Zh(this,ST),Zh(this,vT),Zh(this,CT),gT(this,"nestedHeadersPlugin",null),gT(this,"headerStateManager",null),RX(this,Wa,{writable:!0,value:null})}static get PLUGIN_KEY(){return jd}static get PLUGIN_PRIORITY(){return AX}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[jd,...OX]}isEnabled(){return!!this.hot.getSettings()[jd]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||gt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Mp(this,Wa,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Jh(this,ST,HX).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Jh(e,yT,DX).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Jh(e,CT,PX).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>Jh(this,vT,xX).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Mp(this,Wa,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:pT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pT)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};me(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;me(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${_l}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${_l}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${_l}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!wT.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=pr(e,d=>{let{row:g}=d;return g<0});let i=r.length>0;E(r,d=>{var g;let{row:p,col:C}=d;const{collapsible:S,isCollapsed:y}=(g=this.headerStateManager.getHeaderSettings(p,C))!==null&&g!==void 0?g:{};if(!S||y&&n==="collapse"||!y&&n==="expand")return i=!1,!1});const o=[],s=[];i&&E(r,d=>{let{row:g,col:p}=d;const{colspanCompensation:C,affectedColumns:S,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,g,p);C>0&&(s.push(...S),o.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=eS([...a,...s]):n==="expand"&&(l=pr(a,d=>!s.includes(d)));const u=wT.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){E(o,d=>{d()});return}this.hot.batchExecution(()=>{E(s,d=>{mT(this,Wa).setValueAtIndex(this.hot.toPhysicalColumn(d),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return mT(this,Wa).getHiddenIndexes()}destroy(){Mp(this,Wa,null),super.destroy()}}function PX(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${_l}`);if(va(e,[Ir("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,_l),e.querySelector("div:first-child").appendChild(u)),Le(u,["collapsed","expanded"]),s?(q(u,"collapsed"),hs(u,"+"),l&&Ee(e,...Ir(!1))):(q(u,"expanded"),hs(u,"-"),l&&Ee(e,...Ir(!0))),l&&Ee(u,...Eo());else{var c;(c=u)===null||c===void 0||c.remove()}}function xX(t,e){Ie(t.target,_l)&&(Ie(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ie(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Lr(t))}function HX(){this.updatePlugin()}function DX(t,e){e||this.updatePlugin()}function ks(t,e,n){return e=NX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NX(t){var e=LX(t,"string");return typeof e=="symbol"?e:String(e)}function LX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $X=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],kX=!1,FX=!0,WX=!0;class VX{constructor(e,n){ks(this,"hot",void 0),ks(this,"sortingStates",new kg),ks(this,"sortEmptyCells",kX),ks(this,"indicator",FX),ks(this,"headerAction",WX),ks(this,"compareFunctionFactory",void 0),ks(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ve(e)&&Ye(e,(n,r)=>{$X.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ve(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ue(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const xf="asc",Hf="desc",RH="colHeader";function BX(t){if(Ve(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[xf,Hf].includes(n)}function UX(t){if(t.some(n=>BX(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function bT(t){if(t!==Hf)return t===xf?Hf:xf}function EH(t){return t.querySelector(`.${RH}`)}function TH(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function Gb(t,e,n){return t===-1&&e>=0&&fs(n)===!1}const YX="ascending",GX="descending",_H="indicatorDisabled",MH="columnSorting",AH="sortAction",OH=new Map([[xf,YX],[Hf,GX]]);function zX(t,e,n,r){const i=[MH];if(r&&i.push(AH),n===!1)return i.push(_H),i;const o=t.getSortOrderOfColumn(e);return ue(o)&&i.push(OH.get(o)),i}function jX(){return Array.from(OH.values()).concat(AH,_H,MH)}function IH(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Hi:Zt(i)?Zt(o)?Hi:s&&t==="asc"?kt:Ft:Zt(o)?s&&t==="asc"?Ft:kt:isNaN(i)&&!isNaN(o)?t==="asc"?Ft:kt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?kt:Ft:i>o?t==="asc"?Ft:kt:Hi}}const PH="default";function KX(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Hi;if(a){if(Zt(r))return t==="asc"?kt:Ft;if(Zt(i))return t==="asc"?Ft:kt}return isNaN(o)?Ft:isNaN(s)?kt:o<s?t==="asc"?kt:Ft:o>s?t==="asc"?Ft:kt:Hi}}const XX="numeric";function qX(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Zt(s),u=Zt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,g=h===i||h===r;if(o===!1){if(l&&u===!1)return Ft;if(l===!1&&u)return kt}return d===!1&&g?t==="asc"?kt:Ft:d&&g===!1?t==="asc"?Ft:kt:d===!1&&g===!1?IH(t,e,n)(s,a):c===i&&h===r?t==="asc"?kt:Ft:c===r&&h===i?t==="asc"?Ft:kt:Hi}}const ZX="checkbox";function JX(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Hi;if(Zt(r))return Zt(i)?Hi:o&&t==="asc"?kt:Ft;if(Zt(i))return o&&t==="asc"?Ft:kt;const s=e.dateFormat,a=X(r,s),l=X(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?kt:Ft:l.isBefore(a)?t==="asc"?Ft:kt:Hi:kt:Ft}}const QX="date",{register:Gg,getItem:RT,hasItem:eq}=ai("sorting.compareFunctionFactory"),{register:xH,getItem:tq}=ai("sorting.mainSortComparator");function HH(t){return eq(t)?RT(t):RT(PH)}Gg(XX,KX);Gg(ZX,qX);Gg(QX,JX);Gg(PH,IH);const Hi=0,kt=-1,Ft=1;function nq(t,e){const n=tq(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function rq(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:HH(u.type))(l,u,d)(c,h)}(0)}}function Qh(t,e){iq(t,e),e.add(t)}function iq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ed(t,e,n){return e=oq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oq(t){var e=sq(t,"string");return typeof e=="symbol"?e:String(e)}function sq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Df="columnSorting",aq=50,Nf="append",lq="replace",ET=Df;xH(Df,rq);de.getSingleton().register("beforeColumnSort");de.getSingleton().register("afterColumnSort");var Kd=new WeakSet,TT=new WeakSet,_T=new WeakSet,MT=new WeakSet;class DH extends it{constructor(){super(...arguments),Qh(this,MT),Qh(this,_T),Qh(this,TT),Qh(this,Kd),ed(this,"columnStatesManager",null),ed(this,"columnMetaCache",null),ed(this,"pluginKey",Df),ed(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Df}static get PLUGIN_PRIORITY(){return aq}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new VX(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ys(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>pl(this,TT,uq).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pl(e,MT,hq).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>pl(this,Kd,GC).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pl(e,_T,cq).call(e,...r)}),this.hot.view&&pl(this,Kd,GC).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=EH(r);TH(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:ET})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ET)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Ax),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return UX(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ue(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ue(n)){const i=bT(n);return ue(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:bT()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Nf;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(vt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Nf)return[...o.slice(0,r),...o.slice(r+1),s];if(n===lq)return[...o.slice(0,r),s,...o.slice(r+1)]}return ue(s)?o.concat(s):o}getPluginColumnConfig(e){if(Ve(e)){const n=e[this.pluginKey];if(Ve(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):Ct(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);nq(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ve(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ve(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Le(e,jX()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,zX(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ie(e.target,RH)}onAfterOnCellMouseDown(e,n){Gb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function GC(){const t=this.getAllSavedSortSettings();if(Ve(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function uq(t,e){const n=EH(e);if(TH(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ee(e,...eG(s?`${s}ending`:"none"))}}function cq(t){t===!0&&this.hot.view&&pl(this,Kd,GC).call(this)}function hq(t,e,n,r){Gb(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Fs(t,e,n){return e=dq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dq(t){var e=fq(t,"string");return typeof e=="symbol"?e:String(e)}function fq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gq{constructor(e,n){Fs(this,"plugin",void 0),Fs(this,"hot",void 0),Fs(this,"endpoints",[]),Fs(this,"settings",void 0),Fs(this,"settingsType","array"),Fs(this,"currentEndpoint",null),Fs(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),E(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();E(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;E(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?E(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):E(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){E(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];E(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),E(i,o=>{let s=[];E(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,E(e.ranges,r=>{E(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],E(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],E(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],E(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&E(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),E(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){gt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const mq=gq;function Ap(t){return t==null||isNaN(t)}function Op(t,e){pq(t,e),e.add(t)}function pq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wq(t,e,n){return e=Cq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cq(t){var e=vq(t,"string");return typeof e=="symbol"?e:String(e)}function vq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ip(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Pp="columnSummary",Sq=220;var AT=new WeakSet,OT=new WeakSet,IT=new WeakSet;class yq extends it{constructor(){super(...arguments),Op(this,IT),Op(this,OT),Op(this,AT),wq(this,"endpoints",null)}static get PLUGIN_KEY(){return Pp}static get PLUGIN_PRIORITY(){return Sq}isEnabled(){return!!this.hot.getSettings()[Pp]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Pp],this.endpoints=new mq(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ip(e,AT,bq).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ip(e,OT,Rq).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ip(e,IT,Eq).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ye(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Ap(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ye(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Ap(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Ap(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ye(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ht`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function bq(){this.endpoints.initEndpoints()}function Rq(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Eq(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Va(t,e,n){return e=Tq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tq(t){var e=_q(t,"string");return typeof e=="symbol"?e:String(e)}function _q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Va(this,"rootDocument",void 0),Va(this,"isRtl",!1),Va(this,"container",null),Va(this,"editor",void 0),Va(this,"editorStyle",void 0),Va(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ft(this.getInputElement()),height:xt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),q(this.container,bl.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),q(e,bl.CLASS_EDITOR),q(n,bl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${bl.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const Mq=bl;function xp(t,e,n){return e=Aq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aq(t){var e=Oq(t,"string");return typeof e=="symbol"?e:String(e)}function Oq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Iq=250,Pq=250;class NH{constructor(e){xp(this,"wasLastActionShow",!0),xp(this,"showDebounced",null),xp(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},Pq)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Iq;this.showDebounced=Ag(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}pt(NH,or);const xq=NH;function Hq(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Dq(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ws(t,e){const n={};return E(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Yo(t,e,n,r,i){E(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&Nq(s,a,e,n,r,i)})})}function Nq(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Hq(s.className,r):a=Dq(s.className,r)),o(t,e,"className",a)}function ro(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Mi(t,e){let n=!1;return Array.isArray(t)&&E(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function zg(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const ze="---------";function Lq(){return{name:ze}}const _r="alignment";function $q(){return{key:_r,name(){return this.getTranslatedPhrase(Ey)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${_r}:left`,name(){let t=this.getTranslatedPhrase(Ty);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:center`,name(){let t=this.getTranslatedPhrase(_y);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:right`,name(){let t=this.getTranslatedPhrase(My);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:justify`,name(){let t=this.getTranslatedPhrase(Ay);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:ze},{key:`${_r}:top`,name(){let t=this.getTranslatedPhrase(Oy);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:middle`,name(){let t=this.getTranslatedPhrase(Iy);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:bottom`,name(){let t=this.getTranslatedPhrase(Py);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const jg="clear_column";function kq(){return{key:jg,name(){return this.getTranslatedPhrase(cy)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Zc="col_left";function Fq(){return{key:Zc,name(){return this.getTranslatedPhrase(ry)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Jc="col_right";function Wq(){return{key:Jc,name(){return this.getTranslatedPhrase(iy)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Qc="make_read_only";function Vq(){return{key:Qc,name(){let t=this.getTranslatedPhrase(uy);return Mi(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Mi(t,(n,r)=>this.getCellMeta(n,r).readOnly);E(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Kg="redo";function Bq(){return{key:Kg,name(){return this.getTranslatedPhrase(ly)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const eh="remove_col";function Uq(){return{key:eh,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(sy,e)},callback(){this.alter("remove_col",k6(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Xg="remove_row";function Yq(){return{key:Xg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(oy,e)},callback(){this.alter("remove_row",F6(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const qg="row_above";function Gq(){return{key:qg,name(){return this.getTranslatedPhrase(ty)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Zg="row_below";function zq(){return{key:Zg,name(){return this.getTranslatedPhrase(ny)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const _c="no_items";function jq(){return{key:_c,name(){return this.getTranslatedPhrase(ey)},disabled:!0,isCommand:!1}}const Jg="undo";function Kq(){return{key:Jg,name(){return this.getTranslatedPhrase(ay)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Xq=[qg,Zg,Zc,Jc,jg,Xg,eh,Jg,Kg,Qc,_r,ze,_c],qq={[ze]:Lq,[_c]:jq,[qg]:Gq,[Zg]:zq,[Zc]:Fq,[Jc]:Wq,[jg]:kq,[Xg]:Yq,[eh]:Uq,[Jg]:Kq,[Kg]:Bq,[Qc]:Vq,[_r]:$q};function LH(){const t={};return Ye(qq,(e,n)=>{t[n]=e()}),t}function Zq(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(yy):this.getTranslatedPhrase(Sy)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Jq(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(by)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Qq(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(Ry);return Mi(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Xd))?ro(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,Xd);t.updateCommentMeta(n,r,{[Xd]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function mi(t,e){$H(t,e),e.add(t)}function Vs(t,e,n){$H(t,e),e.set(t,n)}function $H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eZ(t,e,n){return e=tZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tZ(t){var e=nZ(t,"string");return typeof e=="symbol"?e:String(e)}function nZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function co(t,e,n){var r=kH(t,e,"set");return rZ(t,r,n),n}function rZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ze(t,e){var n=kH(t,e,"get");return iZ(t,n)}function kH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function iZ(t,e){return e.get?e.get.call(t):e.value}const rc="comments",oZ=60,io="comment",Yu="value",FH="style",Xd="readOnly",td=rc,zC=`plugin:${rc}`;var Rt=new WeakMap,Xr=new WeakMap,Qg=new WeakMap,qd=new WeakMap,Lf=new WeakMap,jC=new WeakMap,$f=new WeakMap,PT=new WeakSet,xT=new WeakSet,HT=new WeakSet,DT=new WeakSet,NT=new WeakSet,LT=new WeakSet,$T=new WeakSet,kT=new WeakSet,FT=new WeakSet,WT=new WeakSet;class sZ extends it{constructor(){super(...arguments),mi(this,WT),mi(this,FT),mi(this,kT),mi(this,$T),mi(this,LT),mi(this,NT),mi(this,DT),mi(this,HT),mi(this,xT),mi(this,PT),eZ(this,"range",{}),Vs(this,Rt,{writable:!0,value:null}),Vs(this,Xr,{writable:!0,value:null}),Vs(this,Qg,{writable:!0,value:!1}),Vs(this,qd,{writable:!0,value:!1}),Vs(this,Lf,{writable:!0,value:{}}),Vs(this,jC,{writable:!0,value:null}),Vs(this,$f,{writable:!0,value:""})}static get PLUGIN_KEY(){return rc}static get PLUGIN_PRIORITY(){return oZ}isEnabled(){return!!this.hot.getSettings()[rc]}enablePlugin(){this.enabled||(Ze(this,Rt)||co(this,Rt,new Mq(this.hot.rootDocument,this.hot.isRtl())),Ze(this,Xr)||co(this,Xr,new xq(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>pi(this,DT,cZ).call(this,e,s)),this.addHook("afterScroll",()=>pi(this,WT,pZ).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>pi(this,FT,mZ).call(this,e)),Ze(this,Xr).addLocalHook("hide",()=>this.hide()),Ze(this,Xr).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ze(this,Xr).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(zC);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();co(this,qd,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(zC),this.hot._registerTimeout(()=>{co(this,qd,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!Ze(this,Rt).isVisible()},group:td}),r.addShortcut({keys:[["Escape"]],callback:()=>{Ze(this,Rt).setValue(Ze(this,$f)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Ze(this,Rt).isVisible()},group:td}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Ze(this,Rt).isVisible()},group:td})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(td)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>pi(this,xT,lZ).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>pi(this,PT,aZ).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>pi(this,HT,uZ).call(this)),this.eventManager.addEventListener(n,"focus",()=>pi(this,LT,dZ).call(this)),this.eventManager.addEventListener(n,"blur",()=>pi(this,NT,hZ).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>pi(this,$T,fZ).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>pi(this,kT,gZ).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=cs(e.target,"TD","TBODY");return!!(n&&Ie(n,"htCommentCell")&&cs(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Ze(this,Rt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Yu]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,io),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Yu)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Yu)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ze(this,Xr).cancelHiding(),Ze(this,Rt).setValue((e=i[io]?i[io][Yu]:null)!==null&&e!==void 0?e:""),Ze(this,Rt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Ze(this,Rt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ze(this,Rt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;Ze(this,Rt).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:p}}=this.hot,{wtTable:C}=p,S=p.getCell({row:l,col:u},!0),y=this.getCommentMeta(s,a,FH);y?Ze(this,Rt).setSize(y.width,y.height):Ze(this,Rt).resetSize();const R=d?0:C.getStretchedColumnWidth(u),T=c&&!h?xt(S):0,{left:N,top:I,width:F,height:B}=S.getBoundingClientRect(),{width:ee,height:U}=Ze(this,Rt).getSize(),{innerWidth:j,innerHeight:re}=this.hot.rootWindow,ie=this.hot.rootDocument.documentElement;let oe=N+g.scrollX+R,Ce=I+g.scrollY+T;this.hot.isRtl()&&(oe-=ee+R),this.hot.isLtr()&&N+F+ee>j?oe=N+g.scrollX-ee-1:this.hot.isRtl()&&oe<-(ie.scrollWidth-ie.clientWidth)&&(oe=N+g.scrollX+R+1),I+U>re&&(Ce-=U-B+1),Ze(this,Rt).setPosition(oe,Ce),Ze(this,Rt).setReadOnlyState(this.getCommentMeta(s,a,Xd))}focusEditor(){Ze(this,Rt).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[io];let o;i?(o=Tn(i),Yc(o,r)):o=r,this.hot.setCellMeta(e,n,io,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[io])return i[io][r]}addToContextMenu(e){e.items.push({name:ze},Zq(this),Jq(this),Qq(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[rc];if(Ve(e))return e.displayDelay}getEditorInputElement(){return Ze(this,Rt).getInputElement()}destroy(){Ze(this,Rt)&&Ze(this,Rt).destroy(),Ze(this,Xr)&&Ze(this,Xr).destroy(),super.destroy()}}function aZ(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Ze(this,Qg)&&!this.targetIsCommentTextArea(t)){const e=cs(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function lZ(t){const{rootDocument:e}=this.hot;if(!(Ze(this,Qg)||Ze(this,Rt).isFocused()||Ie(t.target,"wtBorder")||Ze(this,jC)===t.target||!Ze(this,Rt)))if(co(this,jC,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Ze(this,Xr).show(n)}else os(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ze(this,Xr).hide()}function uZ(){co(this,Qg,!1)}function cZ(t,e){e[io]&&e[io][Yu]&&q(t,e.commentedCellClassName)}function hZ(){co(this,$f,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function dZ(){co(this,$f,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(zC)}function fZ(t){co(this,Lf,{width:ft(t.target),height:xt(t.target)})}function gZ(t){const e=ft(t.target),n=xt(t.target);(e!==Ze(this,Lf).width+1||n!==Ze(this,Lf).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[FH]:{width:e,height:n}})}function mZ(t){Ze(this,Rt).isVisible()&&Lr(t)}function pZ(){Ze(this,qd)||this.hide()}var VT=sg,wZ=TypeError,CZ=function(t,e){if(!delete t[e])throw new wZ("Cannot delete property "+VT(e)+" of "+VT(t))},vZ=Ss,SZ=lg,yZ=Nc,bZ=$O,RZ=CZ,EZ=kO,TZ=[].unshift(0)!==1,_Z=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},MZ=TZ||!_Z();vZ({target:"Array",proto:!0,arity:1,forced:MZ},{unshift:function(e){var n=SZ(this),r=yZ(n),i=arguments.length;if(i){EZ(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:RZ(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return bZ(n,r+i)}});function Hp(t,e,n){return e=AZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AZ(t){var e=OZ(t,"string");return typeof e=="symbol"?e:String(e)}function OZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WH{constructor(e){Hp(this,"hot",void 0),Hp(this,"commands",{}),Hp(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=IZ(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Pt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),E(u,c=>c.apply(this.hot,r))}}function IZ(t,e){let n;return E(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Dp(t,e,n){return e=PZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PZ(t){var e=xZ(t,"string");return typeof e=="symbol"?e:String(e)}function xZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Dp(this,"hot",void 0),Dp(this,"predefinedItems",LH()),Dp(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ye(e,(r,i)=>{let o="";r.name===ze?(n[ze]=r,o=ze):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return HZ(e,this.defaultOrderPattern,this.predefinedItems)}}function HZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ve(i)?Ye(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Ve(o)?jt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):E(i,(o,s)=>{let a=n[o];!a&&Xq.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ve(o)&&jt(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Do(t,e,n){return e=DZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DZ(t){var e=NZ(t,"string");return typeof e=="symbol"?e:String(e)}function NZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LZ{constructor(e,n){Do(this,"top",void 0),Do(this,"topRelative",void 0),Do(this,"left",void 0),Do(this,"leftRelative",void 0),Do(this,"scrollTop",void 0),Do(this,"scrollLeft",void 0),Do(this,"cellHeight",void 0),Do(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function vu(t,e,n){$Z(t,e),e.set(t,n)}function $Z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){var n=BH(t,e,"get");return kZ(t,n)}function kZ(t,e){return e.get?e.get.call(t):e.value}function nd(t,e,n){var r=BH(t,e,"set");return FZ(t,r,n),n}function BH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function FZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Hn=new WeakMap,No=new WeakMap,dn=new WeakMap,Np=new WeakMap,Ba=new WeakMap;class WZ{constructor(e){vu(this,Hn,{writable:!0,value:void 0}),vu(this,No,{writable:!0,value:void 0}),vu(this,dn,{writable:!0,value:void 0}),vu(this,Np,{writable:!0,value:!1}),vu(this,Ba,{writable:!0,value:{above:0,below:0,left:0,right:0}}),nd(this,Np,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ke(this,Ba)[e]=n,this}setElement(e){return nd(this,Hn,e),this}setParentElement(e){return nd(this,No,e),this}updatePosition(e){nd(this,dn,new LZ(e,Ke(this,Hn).ownerDocument.defaultView)),Ke(this,Np)?(Ke(this,dn).fitsBelow(Ke(this,Hn))?this.setPositionBelowCursor():Ke(this,dn).fitsAbove(Ke(this,Hn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ke(this,Hn).dir==="rtl"?Ke(this,dn).fitsOnLeft(Ke(this,Hn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ke(this,dn).fitsOnRight(Ke(this,Hn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ke(this,Ba).above+Ke(this,dn).top-Ke(this,Hn).offsetHeight;Ke(this,No)&&(e=Ke(this,dn).top+Ke(this,dn).cellHeight-Ke(this,Hn).offsetHeight+3),Ke(this,Hn).style.top=`${e}px`}setPositionBelowCursor(){let e=Ke(this,Ba).below+Ke(this,dn).top+1;Ke(this,No)&&(e=Ke(this,dn).top-1),Ke(this,Hn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ke(this,dn).left;if(Ke(this,No)){const{right:n}=Ke(this,No).getBoundingClientRect();e+=Ke(this,dn).cellWidth+n-(Ke(this,dn).left+Ke(this,dn).cellWidth)}else e+=Ke(this,Ba).right;Ke(this,Hn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ke(this,Ba).left+Ke(this,dn).left-Ke(this,Hn).offsetWidth;if(Ke(this,No)){const{left:n}=Ke(this,No).getBoundingClientRect();e-=Ke(this,dn).left-n}Ke(this,Hn).style.left=`${e}px`}}function UH(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=ir(e,-1,p()-1);function a(S,y){const R=p()-1;return S<0&&(S=R),S>R&&(S=0),o.has(S)?-1:(o.add(S),r(S,!1)===!1&&(S=a(y===1?++S:--S,y)),S)}function l(S){S>-1&&S<p()&&r(S,!0)!==!1&&(s=S)}function u(){return s}function c(){p()>0&&(o.clear(),s=a(0,1))}function h(){p()>0&&(o.clear(),s=a(p()-1,-1))}function d(){p()>0&&(o.clear(),s=a(++s,1))}function g(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:g,getSize:p,clear:C}}function VZ(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function KC(t){return Pt(t,"submenu")}function XC(t){return new RegExp(ze,"i").test(t.name)}function Zd(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function BT(t){return Pt(t,"disableSelection")}function BZ(t){return Ie(t,"htSeparator")}function UZ(t){return Ie(t,"htSubmenu")}function YZ(t){return Ie(t,"htDisabled")}function GZ(t){return Ie(t,"htSelectionDisabled")}function zZ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function YH(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function jZ(t,e){let n=t.slice(0);return n.reverse(),n=YH(n,e),n.reverse(),n}function KZ(t){const e=[];return E(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function XZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ze,n=t.slice(0);return n=YH(n,e),n=jZ(n,e),n=KZ(n),n}function qZ(t){return UH({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||BZ(r)||YZ(r)||GZ(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function ZZ(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const GH="menu",UT=GH;function JZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(ZZ(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:GH})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(p=>h.removeShortcutsByKeys(p))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${UT}:${u}`:UT}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function QZ(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(oi(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!Zd(a,t)&&!BT(a)&&!XC(a);Ee(n,[GY(),iS(u),...c?[Fl(-1)]:[],...Zd(a,t)?[JY()]:[],...KC(a)?[Ir(!1)]:[]])}n.className="",n.appendChild(l),XC(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Sa(l,u),Zd(a,t)?q(n,"htDisabled"):BT(a)?q(n,"htSelectionDisabled"):KC(a)&&q(n,"htSubmenu")}}function YT(t,e,n){eJ(t,e),e.set(t,n)}function eJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wi(t,e,n){return e=tJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tJ(t){var e=nJ(t,"string");return typeof e=="symbol"?e:String(e)}function nJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function GT(t,e,n){var r=zH(t,e,"set");return rJ(t,r,n),n}function rJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Su(t,e){var n=zH(t,e,"get");return iJ(t,n)}function zH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function iJ(t,e){return e.get?e.get.call(t):e.value}const zT=215;var yu=new WeakMap,rd=new WeakMap;class Gl{constructor(e,n){var r=this;wi(this,"hot",void 0),wi(this,"options",void 0),wi(this,"eventManager",new xr(this)),wi(this,"container",void 0),wi(this,"positioner",void 0),wi(this,"hotMenu",null),wi(this,"hotSubMenus",{}),wi(this,"parentMenu",void 0),wi(this,"menuItems",null),wi(this,"origOutsideClickDeselects",null),YT(this,yu,{writable:!0,value:void 0}),YT(this,rd,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:zT,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new WZ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Sc(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Su(this,yu)}getKeyboardShortcutsCtrl(){return Su(this,rd)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Ag(a=>this.openSubMenu(a),300),n=this.options.minWidth||zT;let r=!1,i=pr(this.menuItems,a=>(a.key===_c&&(r=!0),zZ(a,this.hot)));if(i.length<1&&!r)i.push(LH()[_c]);else if(i.length===0)return;i=XZ(i,ze);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:QZ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Su(this,yu).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===ze?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),yC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!yC()||!fs(a))&&o&&this.hasSelectedItem()&&(uo()||SS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),GT(this,yu,qZ(this.hotMenu)),GT(this,rd,JZ(this)),Su(this,rd).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Su(this,yu).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ee(r,[Ir(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!UZ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Gl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ee(n,[Ir(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ee(i,[Ir(!1)])}}closeAllSubMenus(){E(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?VZ(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||XC(e)||Zd(e,this.hot)||KC(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(Ct(r)&&(r=r.call(this.hot),r===null||vt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Yt(n,(a,l)=>a+(l.name===ze?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Ee(this.hotMenu.rootElement,[YY(),Fl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!os(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!os(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ie(e.target,"htCore")&&os(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}pt(Gl,or);function id(t,e){oJ(t,e),e.add(t)}function oJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lp(t,e,n){return e=sJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sJ(t){var e=aJ(t,"string");return typeof e=="symbol"?e:String(e)}function aJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function od(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Gu="contextMenu",lJ=70,jT=Gu;de.getSingleton().register("afterContextMenuDefaultOptions");de.getSingleton().register("beforeContextMenuShow");de.getSingleton().register("afterContextMenuShow");de.getSingleton().register("afterContextMenuHide");de.getSingleton().register("afterContextMenuExecute");var KT=new WeakSet,XT=new WeakSet,qT=new WeakSet,ZT=new WeakSet;class em extends it{constructor(){super(...arguments),id(this,ZT),id(this,qT),id(this,XT),id(this,KT),Lp(this,"commandExecutor",new WH(this.hot)),Lp(this,"itemsFactory",null),Lp(this,"menu",null)}static get PLUGIN_KEY(){return Gu}static get PLUGIN_PRIORITY(){return lJ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[qg,Zg,ze,Zc,Jc,ze,Xg,eh,ze,Jg,Kg,ze,Qc,ze,_r]}isEnabled(){return!!this.hot.getSettings()[Gu]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Gu];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Gl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>od(this,XT,cJ).call(this)),this.menu.addLocalHook("afterOpen",()=>od(this,qT,hJ).call(this)),this.menu.addLocalHook("afterClose",()=>od(this,ZT,dJ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>od(this,KT,uJ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=zg(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:jT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jT)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ye(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new VH(this.hot,em.DEFAULT_ITEMS);const e=this.hot.getSettings()[Gu],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),E(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function uJ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ie(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Ie(o,"current")&&Ie(o,"wtBorder"))))return;const s=zg(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function cJ(){this.hot.runHooks("beforeContextMenuShow",this)}function hJ(){this.hot.runHooks("afterContextMenuShow",this)}function dJ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}em.SEPARATOR={name:ze};function fJ(t){return{key:"copy",name(){return this.getTranslatedPhrase(hy)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function gJ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(gy,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function mJ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(fy,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function pJ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?ir(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(dy,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function wJ(t){return{key:"cut",name(){return this.getTranslatedPhrase(my)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class CJ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class vJ{constructor(){this.clipboardData=new CJ}}function JT(t,e){jH(t,e),e.add(t)}function Ua(t,e,n){jH(t,e),e.set(t,n)}function jH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ln(t,e){var n=KH(t,e,"get");return SJ(t,n)}function SJ(t,e){return e.get?e.get.call(t):e.value}function Ya(t,e,n){var r=KH(t,e,"set");return yJ(t,r,n),n}function KH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Lo=new WeakMap,$p=new WeakMap,bu=new WeakMap,qC=new WeakMap,ZC=new WeakMap,Ru=new WeakMap,ad=new WeakSet,QT=new WeakSet;class bJ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;JT(this,QT),JT(this,ad),Ua(this,Lo,{writable:!0,value:void 0}),Ua(this,$p,{writable:!0,value:void 0}),Ua(this,bu,{writable:!0,value:void 0}),Ua(this,qC,{writable:!0,value:void 0}),Ua(this,ZC,{writable:!0,value:void 0}),Ua(this,Ru,{writable:!0,value:void 0}),Ya(this,$p,n),Ya(this,bu,r),Ya(this,qC,i),Ya(this,ZC,o),Ya(this,Ru,s)}setSelectedRange(e){Ya(this,Lo,e)}getCellsRange(){if(Ln(this,$p).call(this)===0||Ln(this,bu).call(this)===0)return null;const{row:e,col:n}=Ln(this,Lo).getTopStartCorner(),{row:r,col:i}=Ln(this,Lo).getBottomEndCorner(),o=sd(this,QT,RJ).call(this,e,r),s=sd(this,ad,kp).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Ln(this,bu).call(this)===0||Ln(this,Ru).call(this)===0)return null;const{col:e}=Ln(this,Lo).getTopStartCorner(),{col:n}=Ln(this,Lo).getBottomEndCorner(),r=sd(this,ad,kp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Ln(this,bu).call(this)===0||Ln(this,Ru).call(this)===0)return null;const{col:e}=Ln(this,Lo).getTopStartCorner(),{col:n}=Ln(this,Lo).getBottomEndCorner(),r=sd(this,ad,kp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Ln(this,Ru).call(this),startCol:e,endRow:-1,endCol:r}}}function kp(t,e){return Math.min(e,Math.max(t+Ln(this,ZC).call(this)-1,t))}function RJ(t,e){return Math.min(e,Math.max(t+Ln(this,qC).call(this)-1,t))}function XH(t){const e=[],n=[];return E(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);me(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);me(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Ci(t,e){qH(t,e),e.add(t)}function $o(t,e,n){qH(t,e),e.set(t,n)}function qH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eu(t,e,n){return e=EJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EJ(t){var e=TJ(t,"string");return typeof e=="symbol"?e:String(e)}function TJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tr(t,e){var n=ZH(t,e,"get");return _J(t,n)}function _J(t,e){return e.get?e.get.call(t):e.value}function Rr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Kr(t,e,n){var r=ZH(t,e,"set");return MJ(t,r,n),n}function ZH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function MJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("afterCopyLimit");de.getSingleton().register("modifyCopyableRange");de.getSingleton().register("beforeCut");de.getSingleton().register("afterCut");de.getSingleton().register("beforePaste");de.getSingleton().register("afterPaste");de.getSingleton().register("beforeCopy");de.getSingleton().register("afterCopy");const ld="copyPaste",AJ=80,OJ=["fragmentSelection"],e_=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var JC=new WeakMap,QC=new WeakMap,ev=new WeakMap,Ga=new WeakMap,ud=new WeakMap,cd=new WeakMap,za=new WeakMap,kf=new WeakMap,Fp=new WeakSet,t_=new WeakSet,JH=new WeakSet,zb=new WeakSet,n_=new WeakSet,r_=new WeakSet,i_=new WeakSet,o_=new WeakSet,s_=new WeakSet,a_=new WeakSet;class IJ extends it{constructor(){super(...arguments),Ci(this,a_),Ci(this,s_),Ci(this,o_),Ci(this,i_),Ci(this,r_),Ci(this,n_),Ci(this,zb),Ci(this,JH),Ci(this,t_),Ci(this,Fp),Eu(this,"columnsLimit",1/0),Eu(this,"rowsLimit",1/0),Eu(this,"pasteMode","overwrite"),Eu(this,"uiContainer",this.hot.rootDocument.body),$o(this,JC,{writable:!0,value:!1}),$o(this,QC,{writable:!0,value:!1}),$o(this,ev,{writable:!0,value:!1}),$o(this,Ga,{writable:!0,value:"cells-only"}),$o(this,ud,{writable:!0,value:!1}),$o(this,cd,{writable:!0,value:!1}),$o(this,za,{writable:!0,value:new bJ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),$o(this,kf,{writable:!0,value:!1}),Eu(this,"copyableRanges",[])}static get PLUGIN_KEY(){return ld}static get SETTING_KEYS(){return[ld,...OJ]}static get PLUGIN_PRIORITY(){return AJ}isEnabled(){return!!this.hot.getSettings()[ld]}enablePlugin(){var e=this;if(this.enabled)return;const{[ld]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Kr(this,JC,!!n.copyColumnHeaders),Kr(this,QC,!!n.copyColumnGroupHeaders),Kr(this,ev,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Rr(this,n_,HJ).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Rr(e,r_,DJ).call(e,...s)}),this.addHook("afterSelectionEnd",()=>Rr(this,i_,NJ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),CS()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Rr(e,o_,LJ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Rr(e,s_,$J).call(e,...s)}),this.addHook("afterSelection",()=>Rr(this,a_,kJ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Kr(this,Ga,e),Kr(this,ud,!0),Rr(this,Fp,l_).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Kr(this,cd,!0),Rr(this,Fp,l_).call(this,"cut")}getRangedCopyableData(e){return ec(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=XH(e);return E(r,o=>{const s=[];E(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new vJ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}tr(this,za).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);tr(this,Ga)==="column-headers-only"?n.set("headers",tr(this,za).getMostBottomColumnHeadersRange()):(tr(this,Ga)==="with-column-headers"?n.set("headers",tr(this,za).getMostBottomColumnHeadersRange()):tr(this,Ga)==="with-column-group-headers"&&n.set("headers",tr(this,za).getAllColumnHeadersRange()),n.set("cells",tr(this,za).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,g=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:p,visualRow:C}=this.hot.getCellMeta(c,a);if(c=C+1,p===!0)continue;d=C,h=a;const S=[],y=o.length%r;for(;S.length<i||h<=u;){const{skipColumnOnPaste:R,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,R===!0)continue;g=T;const N=S.length%i;S.push(e[y][N])}o.push(S)}return Kr(this,kf,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,g]}onCopy(e){if(!this.hot.isListening()&&!tr(this,ud)||this.isEditorOpened())return;this.setCopyableText(),Kr(this,ud,!1);const n=this.getRangedData(this.copyableRanges),r=Rr(this,t_,PJ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=ec(n);if(e&&e.clipboardData){const s=TC(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[e_,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Kr(this,Ga,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!tr(this,cd)||this.isEditorOpened())return;this.setCopyableText(),Kr(this,cd,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=ec(n);if(e&&e.clipboardData){const o=TC(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[e_,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=bg(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=WP(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=K6(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function l_(t){if(CS()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&mP(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function PJ(t){const{rows:e}=XH(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function xJ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&fS(r)}}}function QH(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&gS(r)}}}function HJ(t){t.items.push({name:"---------"},fJ(this)),tr(this,JC)&&t.items.push(pJ(this)),tr(this,QC)&&t.items.push(mJ(this)),tr(this,ev)&&t.items.push(gJ(this)),t.items.push(wJ(this))}function DJ(t,e,n,r,i){tr(this,kf)&&(i.value=!0),Kr(this,kf,!1)}function NJ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function LJ(){Rr(this,zb,QH).call(this)}function $J(){Rr(this,JH,xJ).call(this)}function kJ(){Rr(this,zb,QH).call(this)}function eD(t,e){return`border_row${t}col${e}`}function zu(){return{width:1,color:"#000"}}function ho(){return{hide:!0}}function FJ(){return{width:1,color:"#000",cornerVisible:!1}}function Wp(t){if(ue(t.start)||ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ue(t.end)||ue(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Tu(t){return ue(t.start)&&(t.left=t.start),ue(t.end)&&(t.right=t.end),t}function Vp(t,e){return{id:eD(t,e),border:FJ(),row:t,col:e,top:ho(),bottom:ho(),start:ho(),end:ho()}}function WJ(t,e){return Pt(e,"border")&&e.border&&(t.border=e.border),Pt(e,"top")&&ue(e.top)&&(e.top?(Ve(e.top)||(e.top=zu()),t.top=e.top):(e.top=ho(),t.top=e.top)),Pt(e,"bottom")&&ue(e.bottom)&&(e.bottom?(Ve(e.bottom)||(e.bottom=zu()),t.bottom=e.bottom):(e.bottom=ho(),t.bottom=e.bottom)),Pt(e,"start")&&ue(e.start)&&(e.start?(Ve(e.start)||(e.start=zu()),t.start=e.start):(e.start=ho(),t.start=e.start)),Pt(e,"end")&&ue(e.end)&&(e.end?(Ve(e.end)||(e.end=zu()),t.end=e.end):(e.end=ho(),t.end=e.end)),t}function vo(t,e){let n=!1;return E(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Pt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function tm(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function VJ(t){return t.some(e=>ue(e.left)||ue(e.right))}function BJ(t){return t.some(e=>ue(e.start)||ue(e.end))}const UJ=new Map([["left","start"],["right","end"]]);function YJ(t){var e;return(e=UJ.get(t))!==null&&e!==void 0?e:t}function GJ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Ny);return vo(this,"bottom")&&(e=tm(e)),e},callback(e,n){const r=vo(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function zJ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(Ly);return vo(this,e)&&(n=tm(n)),n},callback(n,r){const i=vo(this,e);t.prepareBorder(r,e,i)}}}function jJ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase($y)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!vo(this)}}}function KJ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(Dy);return vo(this,e)&&(n=tm(n)),n},callback(n,r){const i=vo(this,e);t.prepareBorder(r,e,i)}}}function XJ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(Hy);return vo(this,"top")&&(e=tm(e)),e},callback(e,n){const r=vo(this,"top");t.prepareBorder(n,"top",r)}}}function u_(t,e){qJ(t,e),e.add(t)}function qJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZJ(t,e,n){return e=JJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JJ(t){var e=QJ(t,"string");return typeof e=="symbol"?e:String(e)}function QJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function c_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Jd="customBorders",eQ=90;var h_=new WeakSet,d_=new WeakSet;class tQ extends it{constructor(){super(...arguments),u_(this,d_),u_(this,h_),ZJ(this,"savedBorders",[])}static get PLUGIN_KEY(){return Jd}static get PLUGIN_PRIORITY(){return eQ}isEnabled(){return!!this.hot.getSettings()[Jd]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>c_(this,h_,nQ).call(this,e)),this.addHook("init",()=>c_(this,d_,rQ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Wp(n));const o=xl(e),s=Tc(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});E(e,a=>{s(a).forAll((l,u)=>{E(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,YJ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=xl(e),r=Tc(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return E(e,o=>{r(o).forAll((s,a)=>{E(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Tu(l))})})}),i}clearBorders(e){e?this.setBorders(e):(E(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Vp(e,n);r&&(a=WJ(a,r),E(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Tu(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,r,o=>{me(e.from.col,i,s=>{const a=Vp(o,s);let l=0;o===e.from.row&&Pt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Pt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Pt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Pt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Tu(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=eD(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Vp(e,n):o=Wp(o),i?(o[r]=ho(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Tu(o)))):(o[r]=zu(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Tu(o)))}prepareBorder(e,n,r){E(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":me(o.col,s.col,a=>{me(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":me(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":me(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":me(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){E(e,n=>{const r=Wp(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Yt([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){E(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){E(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):E(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return E(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return E(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):E(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);E(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[Jd];if(Array.isArray(e)){const n=Tn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=VJ(e),r=BJ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function nQ(t){this.hot.getSettings()[Jd]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(xy)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[XJ(this),KJ(this),GJ(this),zJ(this),jJ(this)]}})}function rQ(){this.changeBorderSettings()}function iQ(t,e){oQ(t,e),e.add(t)}function oQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bp(t,e,n){return e=sQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sQ(t){var e=aQ(t,"string");return typeof e=="symbol"?e:String(e)}function aQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const g_="dragToScroll",lQ=100;var Up=new WeakSet;class uQ extends it{constructor(){super(...arguments),iQ(this,Up),Bp(this,"boundaries",null),Bp(this,"callback",null),Bp(this,"listening",!1)}static get PLUGIN_KEY(){return g_}static get PLUGIN_PRIORITY(){return lQ}isEnabled(){return!!this.hot.getSettings()[g_]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>f_(this,Up,m_).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>f_(this,Up,m_).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Sc(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function m_(t){if(fs(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Bs(t,e){cQ(t,e),e.add(t)}function cQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yp(t,e,n){return e=hQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hQ(t){var e=dQ(t,"string");return typeof e=="symbol"?e:String(e)}function dQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("afterDropdownMenuDefaultOptions");de.getSingleton().register("beforeDropdownMenuShow");de.getSingleton().register("afterDropdownMenuShow");de.getSingleton().register("afterDropdownMenuHide");de.getSingleton().register("afterDropdownMenuExecute");const Qd="dropdownMenu",fQ=230,tv="changeType",Gp=Qd;var jb=new WeakSet,p_=new WeakSet,w_=new WeakSet,C_=new WeakSet,v_=new WeakSet,S_=new WeakSet,y_=new WeakSet;class nm extends it{static get PLUGIN_KEY(){return Qd}static get PLUGIN_PRIORITY(){return fQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Zc,Jc,ze,eh,ze,jg,ze,Qc,ze,_r]}constructor(e){super(e),Bs(this,y_),Bs(this,S_),Bs(this,v_),Bs(this,C_),Bs(this,w_),Bs(this,p_),Bs(this,jb),Yp(this,"commandExecutor",new WH(this.hot)),Yp(this,"itemsFactory",null),Yp(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>zo(this,w_,mQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[Qd]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new VH(this.hot,nm.DEFAULT_ITEMS);const n=this.hot.getSettings()[Qd],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Gl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>zo(this,C_,pQ).call(this)),this.menu.addLocalHook("afterOpen",()=>zo(this,v_,wQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>zo(this,S_,CQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>zo(this,y_,vQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),E(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=zg(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Gp},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Gp}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Gp)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>zo(this,p_,gQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ye(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function tD(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function gQ(t){if(t.stopPropagation(),Ie(t.target,tv)){const e=zg(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function mQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${tv}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=tv,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ee(s,[Eo(),iS(" ")]),Ee(e,[tP("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function pQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function wQ(){this.hot.runHooks("afterDropdownMenuShow",this),zo(this,jb,tD).call(this,this.menu)}function CQ(t){zo(this,jb,tD).call(this,t)}function vQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}nm.SEPARATOR={name:ze};function b_(t,e,n){return e=SQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SQ(t){var e=yQ(t,"string");return typeof e=="symbol"?e:String(e)}function yQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bQ{constructor(e){b_(this,"hot",void 0),b_(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return me(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(me(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();me(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();me(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const RQ=bQ;function R_(t,e,n){return e=EQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EQ(t){var e=TQ(t,"string");return typeof e=="symbol"?e:String(e)}function TQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Kb{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){R_(this,"dataProvider",void 0),R_(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Vn(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=jt(Vn(Kb.DEFAULT_OPTIONS),n),n=jt(n,e),n.filename=rS(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const _Q=Kb,MQ=String.fromCharCode(13),AQ=String.fromCharCode(34),OQ=String.fromCharCode(10);class IQ extends _Q{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ue(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),E(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Wt(e);return r!==""&&(n||r.indexOf(MQ)>=0||r.indexOf(AQ)>=0||r.indexOf(OQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const PQ=IQ,xQ="csv",nv={[xQ]:PQ};function HQ(t,e,n){return typeof nv[t]=="function"?new nv[t](e,n):null}const DQ="exportFile",NQ=240;class LQ extends it{static get PLUGIN_KEY(){return DQ}static get PLUGIN_PRIORITY(){return NQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!nv[e])throw new Error(`Export format type "${e}" is not supported.`);return HQ(e,new RQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function ja(t,e,n){return e=$Q(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Q(t){var e=kQ(t,"string");return typeof e=="symbol"?e:String(e)}function kQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class th{constructor(e,n){let{id:r,stateless:i=!0}=n;ja(this,"hot",void 0),ja(this,"id",void 0),ja(this,"elements",[]),ja(this,"hidden",!1),ja(this,"stateId",""),ja(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new kg)}getElements(){return this.elements}reset(){E(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),E(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}pt(th,or);const Mc={};function ms(t,e){if(!Mc[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Mc[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function oa(t){if(!Mc[t])throw Error(`Filter condition "${t}" does not exist.`);return Mc[t].descriptor}function Kt(t,e,n){n.key=t,Mc[t]={condition:e,descriptor:n}}const un="none";function FQ(){return!0}Kt(un,FQ,{name:Fg,inputsCount:0,showOperators:!1});const ic="empty";function WQ(t){return Zt(t.value)}Kt(ic,WQ,{name:Yy,inputsCount:0,showOperators:!0});const ef="not_empty";function VQ(t,e){return!ms(ic,e)(t)}Kt(ef,VQ,{name:Gy,inputsCount:0,showOperators:!0});const oc="eq";function BQ(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale)===Wt(n)}Kt(oc,BQ,{name:zy,inputsCount:1,showOperators:!0});const tf="neq";function UQ(t,e){return!ms(oc,e)(t)}Kt(tf,UQ,{name:jy,inputsCount:1,showOperators:!0});const nD="gt";function YQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Kt(nD,YQ,{name:Jy,inputsCount:1,showOperators:!0});const rD="gte";function GQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Kt(rD,GQ,{name:Qy,inputsCount:1,showOperators:!0});const iD="lt";function zQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Kt(iD,zQ,{name:eb,inputsCount:1,showOperators:!0});const oD="lte";function jQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Kt(oD,jQ,{name:tb,inputsCount:1,showOperators:!0});const Xb="date_after";function KQ(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Kt(Xb,KQ,{name:ib,inputsCount:1,showOperators:!0});const qb="date_before";function XQ(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Kt(qb,XQ,{name:ob,inputsCount:1,showOperators:!0});const Ff="between";function qQ(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ms(qb,[o]),a=ms(Xb,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Kt(Ff,qQ,{name:nb,inputsCount:2,showOperators:!0});const sD="not_between";function ZQ(t,e){return!ms(Ff,e)(t)}Kt(sD,ZQ,{name:rb,inputsCount:2,showOperators:!0});const aD="begins_with";function JQ(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Wt(n))}Kt(aD,JQ,{name:Ky,inputsCount:1,showOperators:!0});const lD="ends_with";function QQ(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Wt(n))}Kt(lD,QQ,{name:Xy,inputsCount:1,showOperators:!0});const Zb="contains";function eee(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Wt(n))>=0}Kt(Zb,eee,{name:qy,inputsCount:1,showOperators:!0});const uD="not_contains";function tee(t,e){return!ms(Zb,e)(t)}Kt(uD,tee,{name:Zy,inputsCount:1,showOperators:!0});const cD="date_tomorrow";function nee(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(-1,"days").startOf("day"),"d"):!1}Kt(cD,nee,{name:ab,inputsCount:0});const hD="date_today";function ree(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().startOf("day"),"d"):!1}Kt(hD,ree,{name:sb,inputsCount:0});const dD="date_yesterday";function iee(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(1,"days").startOf("day"),"d"):!1}Kt(dD,iee,{name:lb,inputsCount:0});EP();function oee(t,e){let n=t;return n===""&&(n=`(${e})`),n}const rv=new Set([1]).has(1),see=rv&&typeof Array.from=="function";function nh(t){let e=t;return rv&&(e=new Set(e)),function(n){let r;return rv?r=e.has(n):r=!!~e.indexOf(n),r}}function fD(t){return t??""}function iv(t){let e=t;return see?e=Array.from(new Set(e)):e=eS(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function E_(t,e,n,r){const i=[],o=t===e;let s;return o||(s=nh(e)),E(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:oee(a,n)};r&&r(u),i.push(u)}),i}const sa="by_value";function aee(t,e){let[n]=e;return n(t.value)}Kt(sa,aee,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[nh(e)]},showOperators:!1});const Ac={};function lee(t){if(!Ac[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Ac[t].func;return function(n,r){return e(n,r)}}function uee(t){return Ac[t].name}function Jb(t,e,n){Ac[t]={name:e,func:n}}const ls="conjunction",cee=hb;function hee(t,e){return t.every(n=>n.func(e))}Jb(ls,cee,hee);const Wf="disjunction",dee=Wg;function fee(t,e){return t.some(n=>n.func(e))}Jb(Wf,dee,fee);const Qb="disjunctionWithExtraCondition",gee=Wg;function mee(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}Jb(Qb,gee,mee);const pee="numeric",gD="text",wee="date",T_={[pee]:[un,ze,ic,ef,ze,oc,tf,ze,nD,rD,iD,oD,Ff,sD],[gD]:[un,ze,ic,ef,ze,oc,tf,ze,aD,lD,ze,Zb,uD],[wee]:[un,ze,ic,ef,ze,oc,tf,ze,qb,Xb,Ff,ze,cD,hD,dD]};function Cee(t){const e=[];let n=t;return T_[n]||(n=gD),E(T_[n],r=>{let i;r===ze?i={name:ze}:i=Vn(oa(r)),e.push(i)}),e}function _u(t,e,n){return e=vee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vee(t){var e=See(t,"string");return typeof e=="symbol"?e:String(e)}function See(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const zp="built",jp="building",__=["click","input","keydown","keypress","keyup","focus","blur","change"];let ti=class mD{static get DEFAULTS(){return Vn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){_u(this,"hot",void 0),_u(this,"eventManager",new xr(this)),_u(this,"options",void 0),_u(this,"_element",void 0),_u(this,"buildState",void 0),this.hot=e,this.options=jt(mD.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===jp?this._element:this.buildState===zp?(this.update(),this._element):(this.buildState=jp,this.build(),this.buildState=zp,this._element)}isBuilt(){return this.buildState===zp}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Yn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=jp),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)E(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ye(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),E(__,r=>e(n,r))}else E(__,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};pt(ti,or);function yee(t,e){pD(t,e),e.add(t)}function bee(t,e,n){pD(t,e),e.set(t,n)}function pD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hd(t,e){var n=wD(t,e,"get");return Ree(t,n)}function Ree(t,e){return e.get?e.get.call(t):e.value}function Eee(t,e,n){var r=wD(t,e,"set");return Tee(t,r,n),n}function wD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function _ee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Ka=new WeakMap,M_=new WeakSet;class us extends ti{static get DEFAULTS(){return Vn({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,jt(us.DEFAULTS,n)),yee(this,M_),bee(this,Ka,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>_ee(this,M_,Mee).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Eee(this,Ka,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(hd(this,Ka).type=this.options.type,hd(this,Ka).placeholder=this.translateIfPossible(this.options.placeholder),hd(this,Ka).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&hd(this,Ka).focus()}}function Mee(t){this.options.value=t.target.value}function Kp(t,e){CD(t,e),e.add(t)}function Mu(t,e,n){CD(t,e),e.set(t,n)}function CD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){var r=vD(t,e,"set");return Aee(t,r,n),n}function Aee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Xp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ht(t,e){var n=vD(t,e,"get");return Oee(t,n)}function vD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Oee(t,e){return e.get?e.get.call(t):e.value}var Qt=new WeakMap,dd=new WeakMap,fd=new WeakMap,qp=new WeakMap,gd=new WeakMap,A_=new WeakSet,O_=new WeakSet,I_=new WeakSet;class Oc extends ti{static get DEFAULTS(){return Vn({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,jt(Oc.DEFAULTS,n)),Kp(this,I_),Kp(this,O_),Kp(this,A_),Mu(this,Qt,{writable:!0,value:null}),Mu(this,dd,{writable:!0,value:[]}),Mu(this,fd,{writable:!0,value:void 0}),Mu(this,qp,{writable:!0,value:void 0}),Mu(this,gd,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Ht(this,Qt)}registerHooks(){this.addLocalHook("click",()=>Xp(this,I_,xee).call(this))}setItems(e){Xa(this,dd,this.translateNames(e)),Ht(this,Qt)&&Ht(this,Qt).setMenuItems(Ht(this,dd))}translateNames(e){return E(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Xa(this,Qt,new Gl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ht(this,Qt).setMenuItems(Ht(this,dd));const e=new ti(this.hot,{className:"htUISelectCaption"}),n=new ti(this.hot,{className:"htUISelectDropdown"});Xa(this,fd,e),Xa(this,qp,e.element),Xa(this,gd,n),this.hot.getSettings().ariaTags&&(Ee(n.element,[Eo()]),Ee(this._element,[eP()])),E([e,n],r=>this._element.appendChild(r.element)),Ht(this,Qt).addLocalHook("select",r=>Xp(this,A_,Iee).call(this,r)),Ht(this,Qt).addLocalHook("afterClose",()=>Xp(this,O_,Pee).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ht(this,Qt).hot.getTranslatedPhrase(Fg),Ht(this,qp).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ht(this,Qt)&&(Ht(this,Qt).open(),Ht(this,Qt).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ht(this,Qt).getNavigator().toFirstItem(),Ht(this,Qt).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ht(this,Qt)&&Ht(this,Qt).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ht(this,Qt)&&(Ht(this,Qt).destroy(),Xa(this,Qt,null)),Ht(this,fd)&&Ht(this,fd).destroy(),Ht(this,gd)&&Ht(this,gd).destroy(),super.destroy()}}function Iee(t){t.name!==ze&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Pee(){this.runLocalHooks("afterClose")}function xee(){this.openOptions()}function P_(t,e){Hee(t,e),e.add(t)}function Hee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x_(t,e,n){return e=Dee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=Nee(t,"string");return typeof e=="symbol"?e:String(e)}function Nee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function H_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var D_=new WeakSet,N_=new WeakSet;class ov extends th{constructor(e,n){super(e,{id:n.id,stateless:!1}),P_(this,N_),P_(this,D_),x_(this,"name",""),x_(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Oc(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new us(this.hot,{placeholder:wb})),this.elements.push(new us(this.hot,{placeholder:Cb})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>H_(this,D_,Lee).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),E(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>H_(this,N_,$ee).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Vn(e.command);n.name.startsWith(Vt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),E(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||oa(un),n=[];return E(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=oa(e?e.name:un);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||E(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Oc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof us)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),E(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[oa(un)];if(e!==null){const{visualIndex:r}=e;n=Cee(this.hot.getDataType(0,r,this.hot.countRows(),r))}E(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function Lee(t){E(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function $ee(t){Vl(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lr(t))}function L_(t,e,n){kee(t,e),e.set(t,n)}function kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Au(t,e){var n=SD(t,e,"get");return Fee(t,n)}function Fee(t,e){return e.get?e.get.call(t):e.value}function $_(t,e,n){var r=SD(t,e,"set");return Wee(t,r,n),n}function SD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Wee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var qa=new WeakMap,Zp=new WeakMap;class Vf extends ti{static get DEFAULTS(){return Vn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,jt(Vf.DEFAULTS,n)),L_(this,qa,{writable:!0,value:void 0}),L_(this,Zp,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),$_(this,Zp,e),$_(this,qa,this._element.firstChild),Au(this,qa).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Au(this,Zp).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Au(this,qa).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Au(this,qa).checked=e)}focus(){this.isBuilt()&&Au(this,qa).focus()}}function Vee(t,e){Bee(t,e),e.add(t)}function Bee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uee(t,e,n){return e=Yee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yee(t){var e=Gee(t,"string");return typeof e=="symbol"?e:String(e)}function Gee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const k_=0;var F_=new WeakSet;class jee extends th{constructor(e,n){super(e,{id:n.id,stateless:!1}),Vee(this,F_),Uee(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),E(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ls,Wf];E(e,n=>{const r=new Vf(this.hot,{name:"operator",label:{htmlFor:n,textContent:uee(n)},value:n,checked:n===e[k_],id:n});r.addLocalHook("change",i=>zee(this,F_,Kee).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ht`Radio button with index ${e} doesn't exist.`);E(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Vf&&n.isChecked());return e?e.getValue():ls}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&E(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ls,n=arguments.length>1?arguments[1]:void 0,r=e;r===Qb&&(r=Wf),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(k_)}}function Kee(t){this.setState(t.target.value)}function Xee(t,e,n){qee(t,e),e.set(t,n)}function qee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jp(t,e){var n=yD(t,e,"get");return Zee(t,n)}function Zee(t,e){return e.get?e.get.call(t):e.value}function Jee(t,e,n){var r=yD(t,e,"set");return Qee(t,r,n),n}function yD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Qee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ou=new WeakMap;class Ic extends ti{static get DEFAULTS(){return Vn({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,jt(Ic.DEFAULTS,n)),Xee(this,Ou,{writable:!0,value:void 0})}build(){super.build(),Jee(this,Ou,this._element.firstChild)}update(){this.isBuilt()&&(Jp(this,Ou).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Jp(this,Ou).focus()}activate(){Jp(this,Ou).click()}}function md(t,e){bD(t,e),e.add(t)}function Za(t,e,n){bD(t,e),e.set(t,n)}function bD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ne(t,e){var n=RD(t,e,"get");return ete(t,n)}function ete(t,e){return e.get?e.get.call(t):e.value}function Ur(t,e,n){var r=RD(t,e,"set");return tte(t,r,n),n}function RD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const W_="multipleSelect.itemBox";var qr=new WeakMap,Ot=new WeakMap,Qp=new WeakMap,Xi=new WeakMap,ko=new WeakMap,Fo=new WeakMap,V_=new WeakSet,B_=new WeakSet,U_=new WeakSet,Y_=new WeakSet;class Pc extends ti{static get DEFAULTS(){return Vn({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,jt(Pc.DEFAULTS,n)),md(this,Y_),md(this,U_),md(this,B_),md(this,V_),Za(this,qr,{writable:!0,value:[]}),Za(this,Ot,{writable:!0,value:void 0}),Za(this,Qp,{writable:!0,value:void 0}),Za(this,Xi,{writable:!0,value:void 0}),Za(this,ko,{writable:!0,value:void 0}),Za(this,Fo,{writable:!0,value:void 0}),Ur(this,Xi,new us(this.hot,{placeholder:pb,className:"htUIMultipleSelectSearch"})),Ur(this,ko,new Ic(this.hot,{textContent:db,className:"htUISelectAll"})),Ur(this,Fo,new Ic(this.hot,{textContent:fb,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ne(this,Ot)}registerHooks(){Ne(this,Xi).addLocalHook("keydown",e=>pd(this,B_,rte).call(this,e)),Ne(this,Xi).addLocalHook("input",e=>pd(this,V_,nte).call(this,e)),Ne(this,ko).addLocalHook("click",e=>pd(this,U_,ite).call(this,e)),Ne(this,Fo).addLocalHook("click",e=>pd(this,Y_,ote).call(this,e))}setItems(e){Ur(this,qr,e),Ne(this,Ot)&&Ne(this,Ot).loadData(Ne(this,qr))}setLocale(e){Ur(this,Qp,e)}getLocale(){return Ne(this,Qp)}getItems(){return[...Ne(this,qr)]}getValue(){return ate(Ne(this,qr))}getSearchInputElement(){return Ne(this,Xi)}getSelectAllElement(){return Ne(this,ko)}getClearAllElement(){return Ne(this,Fo)}isSelectedAllValues(){return Ne(this,qr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new ti(this.hot,{className:"htUISelectionControls",children:[Ne(this,ko),Ne(this,Fo)]});this._element.appendChild(Ne(this,Xi).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Ne(this,Ot)&&Ne(this,Ot).destroy(),q(o,"htUIMultipleSelectHot"),Ur(this,Ot,new this.hot.constructor(o,{data:Ne(this,qr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,d,g)=>{l.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ne(this,Ot).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Ne(this,Ot).container.scrollWidth-nn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ne(this,Ot).init();const a=Ne(this,Ot).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:W_}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Ne(this,Ot).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:W_})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ne(this,Ot).listen()}reset(){Ne(this,Xi).reset(),Ne(this,ko).reset(),Ne(this,Fo).reset()}update(){this.isBuilt()&&(Ne(this,Ot).loadData(ste(Ne(this,qr),this.options.value)),super.update())}destroy(){Ne(this,Ot)&&Ne(this,Ot).destroy(),Ne(this,Xi).destroy(),Ne(this,Fo).destroy(),Ne(this,ko).destroy(),Ur(this,Xi,null),Ur(this,Fo,null),Ur(this,ko,null),Ur(this,Ot,null),Ur(this,qr,null),super.destroy()}}function nte(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ne(this,qr)]:n=pr(Ne(this,qr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ne(this,Ot).loadData(n)}function rte(t){this.runLocalHooks("keydown",t,this),mS(Vl,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Lr(t),Ne(this,Ot).listen(),Ne(this,Ot).selectCell(0,0))}function ite(t){const e=[];t.preventDefault(),E(Ne(this,Ot).getSourceData(),(n,r)=>{n.checked=!0,e.push(zS(n,r)[0])}),Ne(this,Ot).setSourceDataAtCell(e)}function ote(t){const e=[];t.preventDefault(),E(Ne(this,Ot).getSourceData(),(n,r)=>{n.checked=!1,e.push(zS(n,r)[0])}),Ne(this,Ot).setSourceDataAtCell(e)}function ste(t,e){const n=nh(e);return Ue(t,r=>(r.checked=n(r.value),r))}function ate(t){const e=[];return E(t,n=>{n.checked&&e.push(n.value)}),e}function lte(t,e){ute(t,e),e.add(t)}function ute(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cte(t,e,n){return e=hte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hte(t){var e=dte(t,"string");return typeof e=="symbol"?e:String(e)}function dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fte(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var G_=new WeakSet;class gte extends th{constructor(e,n){super(e,{id:n.id,stateless:!1}),lte(this,G_),cte(this,"name",""),this.name=n.name,this.elements.push(new Pc(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>fte(this,G_,mte).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===sa){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?un:sa},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=pr(i,h=>h.name===sa),u={},c=this.hot.getTranslatedPhrase(Of);if(l){const h=iv(Ue(s(r,a),C=>C.value));o&&(l.args[0]=o);const d=[],g=E_(h,l.args[0],c,C=>{C.checked&&d.push(C.value)}),p=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,p).locale,u.args=[d],u.command=oa(sa),u.itemsSnapshot=g}else u.args=[],u.command=oa(un);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Pc)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),E(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Of),n=iv(this._getColumnVisibleValues()),r=E_(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),n=>fD(n))}}function mte(t){Vl(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lr(t))}var ED;function pte(t,e){wte(t,e),e.add(t)}function wte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cte(t,e,n){return e=vte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vte(t){var e=Ste(t,"string");return typeof e=="symbol"?e:String(e)}function Ste(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yte(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var z_=new WeakSet;class xc extends th{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),pte(this,z_),Cte(this,"name",""),this.name=n.name,this.elements.push(new us(this.hot,{type:"button",value:gb,className:"htUIButton htUIButtonOK",identifier:xc.BUTTON_OK})),this.elements.push(new us(this.hot,{type:"button",value:mb,className:"htUIButton htUIButtonCancel",identifier:xc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){E(this.elements,e=>{e.addLocalHook("click",(n,r)=>yte(this,z_,bte).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),E(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}ED=xc;function bte(t,e){e.options.identifier===ED.BUTTON_OK?this.accept():this.cancel()}function ew(t,e,n){return e=Rte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rte(t){var e=Ete(t,"string");return typeof e=="symbol"?e:String(e)}function Ete(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const j_="ConditionCollection.filteringStates";class TD{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;ew(this,"hot",void 0),ew(this,"isMapRegistrable",void 0),ew(this,"filteringStates",new kg),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(j_,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ls;return e.length?lee(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ls,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ue(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ht`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(vt(Ac[r]))throw new Error(ht`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ms(a,s)}]},i):u.push({name:a,args:s,func:ms(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Yt(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ue(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),E(e,n=>{E(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(j_),this.filteringStates=null,this.clearLocalHooks()}}pt(TD,or);const _D=TD;function K_(t,e,n){return e=Tte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=_te(t,"string");return typeof e=="symbol"?e:String(e)}function _te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mte{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];K_(this,"conditionCollection",void 0),K_(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return E(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return E(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return E(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const MD=Mte;function tw(t,e){Ate(t,e),e.add(t)}function Ate(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Us(t,e,n){return e=Ote(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ote(t){var e=Ite(t,"string");return typeof e=="symbol"?e:String(e)}function Ite(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var X_=new WeakSet,q_=new WeakSet,Z_=new WeakSet;class AD{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];tw(this,Z_),tw(this,q_),tw(this,X_),Us(this,"hot",void 0),Us(this,"conditionCollection",void 0),Us(this,"columnDataFactory",void 0),Us(this,"changes",[]),Us(this,"grouping",!1),Us(this,"latestEditedColumnPosition",-1),Us(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>nw(this,X_,Pte).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>nw(this,q_,xte).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>nw(this,Z_,Hte).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,E(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=wP(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new _D(r.hot,!1),p=[].concat(c,d);g.importAllConditions(p);const C=r.columnDataFactory(h);let S;g.isEmpty()?S=C:S=new MD(g,R=>r.columnDataFactory(R)).filter(),S=Ue(S,R=>R.meta.visualRow);const y=nh(S);return g.destroy(),pr(C,R=>y(R.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ye(this,(e,n)=>{this[n]=null})}}function Pte(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function xte(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Hte(){E(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}pt(AD,or);const Dte=AD;function Nte(t){return UH({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Pc)return r;if(i.element&&!ds(i.element))return!1;i.focus()}})}const Iu="filters";function Lte(t,e){let n=-1;const r=Nte(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Iu),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof ti&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Iu),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Iu)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const d=t.getNavigator();d.getCurrentPage()>-1&&(n=d.getCurrentPage()),d.clear(),h.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const d=e[r.getCurrentPage()];d instanceof Oc&&(d.openOptions(),h.preventDefault()),d instanceof Ic&&(d.activate(),h.preventDefault()),d instanceof ti||h.preventDefault()}}],Iu)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Iu)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function qi(t,e){OD(t,e),e.add(t)}function $te(t,e,n){OD(t,e),e.set(t,n)}function OD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pu(t,e,n){return e=kte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kte(t){var e=Fte(t,"string");return typeof e=="symbol"?e:String(e)}function Fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wte(t,e,n){var r=ID(t,e,"set");return Vte(t,r,n),n}function Vte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function xu(t,e){var n=ID(t,e,"get");return Bte(t,n)}function ID(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Bte(t,e){return e.get?e.get.call(t):e.value}function Yr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const sv="filters",Ute=250,J_=sv;var Ys=new WeakMap,Q_=new WeakSet,eM=new WeakSet,tM=new WeakSet,nM=new WeakSet,rw=new WeakSet,rM=new WeakSet,iw=new WeakSet,iM=new WeakSet,oM=new WeakSet;class Yte extends it{static get PLUGIN_KEY(){return sv}static get PLUGIN_PRIORITY(){return Ute}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),qi(this,oM),qi(this,iM),qi(this,iw),qi(this,rM),qi(this,rw),qi(this,nM),qi(this,tM),qi(this,eM),qi(this,Q_),Pu(this,"dropdownMenuPlugin",null),Pu(this,"conditionCollection",null),Pu(this,"conditionUpdateObserver",null),Pu(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Pu(this,"filtersRowsMap",null),$te(this,Ys,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Yr(this,iM,qte).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[sv]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Xc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Yr(this,rw,sM).call(this,"accept")),s.addLocalHook("cancel",()=>Yr(this,rw,sM).call(this,"cancel")),s.addLocalHook("change",a=>Yr(this,rM,Xte).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(ub)}:`,o=()=>`${this.hot.getTranslatedPhrase(cb)}:`;if(!this.components.get("filter_by_condition")){const s=new ov(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Yr(this,iw,aM).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new jee(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new ov(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Yr(this,iw,aM).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new gte(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new xc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new _D(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Dte(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Yr(this,oM,Zte).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Yr(this,nM,Kte).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Yr(this,eM,zte).call(this)),this.addHook("afterDropdownMenuHide",()=>Yr(this,tM,jte).call(this)),this.addHook("afterChange",s=>Yr(this,Q_,Gte).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!xu(this,Ys)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=xu(this,Ys).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Wte(this,Ys,Lte(s,a));const l=u=>{xu(this,Ys).listen(),u.preventDefault(),Vl(u.keyCode,"TAB")&&(u.shiftKey?xu(this,Ys).toPreviousItem():xu(this,Ys).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:J_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(J_)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ls;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=nh(i);me(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),E(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return E(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:g,locale:p}=this.hot.getCellMeta(o,n),C=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:g,locale:p},value:fD(C)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=iv(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Wf&&n.command.key!==un&&r.command.key!==un&&i.command.key!==un?o=Qb:i.command.key!==un&&(n.command.key===un||r.command.key===un)&&(o=ls),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new MD(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return E(i,s=>{E(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Gte(t){t&&E(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function zte(){this.restoreComponents(Array.from(this.components.values()))}function jte(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Kte(t){t.items.push({name:ze}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function sM(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==un&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==un&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==un&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Xte(t,e){this.updateDependentComponentsVisibility(),t.constructor===ov&&!e.inputsCount&&this.setListeningDropdownMenu()}function aM(){this.setListeningDropdownMenu()}function qte(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?q(e,"htFiltersActive"):Le(e,"htFiltersActive")}function Zte(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===sa),o=n.filter(s=>s.name!==sa);if(i.length>=2||o.length>=3)gt(ht`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const PD="internal-use-in-handsontable",av={licenseKey:PD,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function xD(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[bn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function HD(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Jte(t){var e;const n=t[bn],r=HD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=xD(t);return{...av,...r,...i}}function Qte(t){var e;const n=t[bn],r=HD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=xD(t);return{...r,...i}}function ene(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function rm(){const t="engine_relationship",e=ai(bn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function eR(){const t="shared_engine_usage",e=ai(bn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function tne(t){const e=t.getSettings(),n=e[bn],r=n==null?void 0:n.engine;if(n===!0||vt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return nne((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&vt(r.hyperformula)){const o=rm(),s=eR().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:PD}),(r.getConfig().leapYear1900!==av.leapYear1900||Og(r.getConfig().nullDate,av.nullDate)===!1)&&gt(ht`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function nne(t,e,n){const r=e[bn],i=Jte(e),o=rm(),s=eR();rne(t,r.functions),ine(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),one(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function lM(t){var e;const n=rm(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function uM(t,e){if(t){const n=rm(),r=n.get(t),i=eR(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function rne(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){gt(s.message)}})}function ine(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){gt(r.message)}}}function one(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){gt(a.message)}}),t.resumeEvaluation())}function sne(t,e){return(vt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const DD="DD/MM/YYYY";function ND(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function ane(t){return ND(t)?t.substr(1):t}function lne(t){return typeof t=="string"&&t.startsWith("=")}function tR(t,e){return typeof t=="string"&&e==="date"}function LD(t,e){return X(t,e,!0).isValid()}function $D(t,e){return X(t,e,!0).format(DD)}function une(t,e){return X(t,DD,!0).format(e)}function kD(t,e){const r=new Date(Date.UTC(0,0,t+-1));return X(r).format(e)}function Gs(t,e,n){cne(t,e),e.set(t,n)}function cne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){var n=FD(t,e,"get");return hne(t,n)}function hne(t,e){return e.get?e.get.call(t):e.value}function Wo(t,e,n){var r=FD(t,e,"set");return dne(t,r,n),n}function FD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Hu=new WeakMap,Vo=new WeakMap,sr=new WeakMap,wd=new WeakMap,ow=new WeakMap,sw=new WeakMap,Cd=new WeakMap;class fne{constructor(e,n,r){Gs(this,Hu,{writable:!0,value:void 0}),Gs(this,Vo,{writable:!0,value:void 0}),Gs(this,sr,{writable:!0,value:void 0}),Gs(this,wd,{writable:!0,value:[]}),Gs(this,ow,{writable:!0,value:[]}),Gs(this,sw,{writable:!0,value:void 0}),Gs(this,Cd,{writable:!0,value:[]}),Wo(this,Hu,e),Wo(this,Vo,n),Wo(this,sr,r)}setRemovedHfIndexes(e){return Wo(this,Cd,e.map(n=>{const r=bt(this,Vo).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),bt(this,Cd)}getRemovedHfIndexes(){return bt(this,Cd)}getHfIndexFromVisualIndex(e){const n=bt(this,Vo).getIndexesSequence(),r=bt(this,Vo).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${En(bt(this,Hu))}s`;bt(this,sr).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&bt(this,sr).getEngine()[r](bt(this,sr).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Wo(this,ow,e.map(i=>this.getHfIndexFromVisualIndex(i))),Wo(this,sw,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=bt(this,Vo).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(bt(this,sr).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(bt(this,ow),bt(this,sw)));bt(this,sr).getSheetId()===null?bt(this,sr).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${En(bt(this,Hu))}Order`;return n=>{if(bt(this,sr).isPerformingUndoRedo())return;const r=bt(this,Vo).getIndexesSequence();if(n==="update"&&r.length>0){const i=bt(this,wd).map(l=>r.indexOf(l)),o=bt(this,sr).getEngine().getSheetDimensions(bt(this,sr).getSheetId());let s;bt(this,Hu)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);bt(this,sr).getEngine()[e](bt(this,sr).getSheetId(),i)}Wo(this,wd,r)}}init(){Wo(this,wd,bt(this,Vo).getIndexesSequence())}}const cM=fne;function zs(t,e,n){gne(t,e),e.set(t,n)}function gne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zi(t,e){var n=WD(t,e,"get");return mne(t,n)}function mne(t,e){return e.get?e.get.call(t):e.value}function js(t,e,n){var r=WD(t,e,"set");return pne(t,r,n),n}function WD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var vd=new WeakMap,Sd=new WeakMap,aw=new WeakMap,lw=new WeakMap,uw=new WeakMap,cw=new WeakMap,hw=new WeakMap;class wne{constructor(e,n,r){zs(this,vd,{writable:!0,value:void 0}),zs(this,Sd,{writable:!0,value:void 0}),zs(this,aw,{writable:!0,value:void 0}),zs(this,lw,{writable:!0,value:!1}),zs(this,uw,{writable:!0,value:!1}),zs(this,cw,{writable:!0,value:null}),zs(this,hw,{writable:!0,value:null}),js(this,vd,new cM("row",e,this)),js(this,Sd,new cM("column",n,this)),js(this,aw,r)}getForAxis(e){return e==="row"?Zi(this,vd):Zi(this,Sd)}setPerformUndo(e){js(this,lw,e)}setPerformRedo(e){js(this,uw,e)}isPerformingUndoRedo(){return Zi(this,lw)||Zi(this,uw)}getSheetId(){return Zi(this,hw)}getEngine(){return Zi(this,cw)}getPostponeAction(){return Zi(this,aw)}setupSyncEndpoint(e,n){js(this,cw,e),js(this,hw,n),Zi(this,vd).init(),Zi(this,Sd).init()}}const Cne=wne;function Mt(t,e){VD(t,e),e.add(t)}function Ja(t,e,n){return e=vne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vne(t){var e=Sne(t,"string");return typeof e=="symbol"?e:String(e)}function Sne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dw(t,e,n){VD(t,e),e.set(t,n)}function VD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ps(t,e,n){var r=BD(t,e,"set");return yne(t,r,n),n}function yne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ml(t,e){var n=BD(t,e,"get");return bne(t,n)}function BD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function bne(t,e){return e.get?e.get.call(t):e.value}function wt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const bn="formulas",Rne=["maxRows","maxColumns","language"],Ene=260;de.getSingleton().register("afterNamedExpressionAdded");de.getSingleton().register("afterNamedExpressionRemoved");de.getSingleton().register("afterSheetAdded");de.getSingleton().register("afterSheetRemoved");de.getSingleton().register("afterSheetRenamed");de.getSingleton().register("afterFormulasValuesUpdate");const zl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var So=new WeakMap,nR=new WeakMap,Du=new WeakMap,hM=new WeakSet,dM=new WeakSet,fw=new WeakSet,fM=new WeakSet,gw=new WeakSet,gM=new WeakSet,mM=new WeakSet,mw=new WeakSet,pM=new WeakSet,wM=new WeakSet,CM=new WeakSet,vM=new WeakSet,SM=new WeakSet,yM=new WeakSet,bM=new WeakSet,RM=new WeakSet,EM=new WeakSet,TM=new WeakSet,_M=new WeakSet,MM=new WeakSet,AM=new WeakSet,OM=new WeakSet,IM=new WeakSet,PM=new WeakSet;class Tne extends it{constructor(){var e;super(...arguments),e=this,Mt(this,PM),Mt(this,IM),Mt(this,OM),Mt(this,AM),Mt(this,MM),Mt(this,_M),Mt(this,TM),Mt(this,EM),Mt(this,RM),Mt(this,bM),Mt(this,yM),Mt(this,SM),Mt(this,vM),Mt(this,CM),Mt(this,wM),Mt(this,pM),Mt(this,mw),Mt(this,mM),Mt(this,gM),Mt(this,gw),Mt(this,fM),Mt(this,fw),Mt(this,dM),Mt(this,hM),dw(this,So,{writable:!0,value:!1}),dw(this,nR,{writable:!0,value:!1}),dw(this,Du,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,_M,Vne).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,MM,Bne).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,AM,Une).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,OM,Yne).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,IM,Gne).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,PM,zne).call(e,...r)}]]}),Ja(this,"staticRegister",ai("formulas")),Ja(this,"engine",null),Ja(this,"sheetName",null),Ja(this,"indexSyncer",null),Ja(this,"rowAxisSyncer",null),Ja(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return bn}static get PLUGIN_PRIORITY(){return Ene}static get SETTING_KEYS(){return[bn,...Rne]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[bn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=tne(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){gt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,fw,xM).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,gw,HM).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,fw,xM).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,gw,HM).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,gM,One).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,mM,Ine).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,hM,_ne).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,pM,Pne).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,mw,DM).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,mw,DM).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,wM,xne).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,CM,Hne).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,yM,Lne).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,bM,$ne).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,vM,Dne).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,SM,Nne).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,RM,kne).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,EM,Fne).call(n,...i)}),this.indexSyncer=new Cne(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,fM,Ane).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,TM,Wne).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,dM,Mne).call(n,...i)}),Ml(this,Du).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Ml(this,Du).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),uM(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Qte(this.hot.getSettings());ene(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[bn];if(ue(r)&&ue(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[bn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Ml(this,Du).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),ps(this,Du,null),uM(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ue(n)&&!Tx(n))return gt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return gt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return gt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){bS(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${En(bn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),lM(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ue(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ue(l)===!1||ue(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=lM(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){gt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return tR(r,o.type)&&(LD(r,o.dateFormat)?r=$D(r,o.dateFormat):lne(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function _ne(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Wn(s)&&(s=kD(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Mne(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const g=this.engine.getFillRangeData(h,d),{row:p,col:C}=h.start,{row:S,col:y}=h.end,R=S-p+1,T=y-C+1;for(let N=0;N<g.length;N+=1)for(let I=0;I<g[N].length;I+=1){const F=g[N][I],B=N%R,ee=I%T,U=this.hot.getCellMeta(B,ee);tR(F,U.type)&&(F.startsWith("'")?g[N][I]=F.slice(1):this.isFormulaCellType(B,ee,this.sheetId)===!1&&(g[N][I]=une(F,U.dateFormat)))}return g}function xM(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(En(bn))||ps(this,nR,vt(this.hot.getSettings().data))}function Ane(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;tR(i,s.type)&&(e=!0,LD(i,a)?t[r][o]=$D(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(ps(this,So,!0),this.engine.setSheetContent(this.sheetId,t),ps(this,So,!1))}function HM(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(En(bn)))if(this.sheetName=sne(this.engine,this.hot.getSettings()[bn].sheetName),Ml(this,nR))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){ps(this,So,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),ps(this,So,!1)}}}function One(t,e,n,r){if(r!=="get"||Ml(this,So)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){ND(n.value)&&(n.value=ane(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find(c=>c.visualRow===i&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Wn(a)&&(a=kD(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Ine(t,e,n,r){if(r!=="get"||Ml(this,So)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function DM(t,e){if(zl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Pne(t,e){if(zl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Wn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){gt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function xne(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Hne(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Dne(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Nne(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Lne(t,e,n){if(zl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function $ne(t,e,n){if(zl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function kne(t,e,n,r){if(zl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Fne(t,e,n,r){if(zl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Wne(t,e,n){var r;ps(this,So,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());ps(this,So,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Vne(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Bne(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Une(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Yne(t){this.hot.runHooks("afterSheetAdded",t)}function Gne(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function zne(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function jne(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Wy,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Kne(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Vy,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const g=u.slice(i,o+1);c.push(...g.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return E(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Qa(t,e){UD(t,e),e.add(t)}function NM(t,e,n){UD(t,e),e.set(t,n)}function UD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function el(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function fr(t,e){var n=YD(t,e,"get");return Xne(t,n)}function Xne(t,e){return e.get?e.get.call(t):e.value}function Nu(t,e,n){var r=YD(t,e,"set");return qne(t,r,n),n}function YD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("beforeHideColumns");de.getSingleton().register("afterHideColumns");de.getSingleton().register("beforeUnhideColumns");de.getSingleton().register("afterUnhideColumns");const pw="hiddenColumns",Zne=310;var xi=new WeakMap,vi=new WeakMap,LM=new WeakSet,$M=new WeakSet,kM=new WeakSet,FM=new WeakSet,WM=new WeakSet,VM=new WeakSet;class Jne extends it{constructor(){super(...arguments),Qa(this,VM),Qa(this,WM),Qa(this,FM),Qa(this,kM),Qa(this,$M),Qa(this,LM),NM(this,xi,{writable:!0,value:{}}),NM(this,vi,{writable:!0,value:null})}static get PLUGIN_KEY(){return pw}static get PLUGIN_PRIORITY(){return Zne}isEnabled(){return!!this.hot.getSettings()[pw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[pw];Ve(n)&&(Nu(this,xi,n),vt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Nu(this,vi,new $g),fr(this,vi).addLocalHook("init",()=>el(this,VM,ire).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,fr(this,vi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return el(e,WM,rre).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>el(this,$M,ere).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>el(this,LM,Qne).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return el(e,FM,nre).call(e,...i)}),this.addHook("modifyCopyableRange",r=>el(this,kM,tre).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Nu(this,xi,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=fr(this,vi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));E(l,u=>{o[u]=!1}),i=Yt(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&fr(this,vi).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{fr(this,vi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(fr(this,vi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return fr(this,vi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){E(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Nu(this,xi,null),Nu(this,vi,null),super.destroy()}}function Qne(t,e){if(this.isHidden(e))return 0;if(fr(this,xi).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function ere(t,e,n){if(fr(this,xi).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function tre(t){if(fr(this,xi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return E(t,r=>{let i=!0,o=0;me(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function nre(t,e){if(!fr(this,xi).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function rre(t){t.items.push({name:ze},jne(this),Kne(this))}function ire(){Array.isArray(fr(this,xi).columns)&&this.hideColumns(fr(this,xi).columns)}function ore(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(By,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function sre(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Uy,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const g=u.slice(i,o+1);c.push(...g.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return E(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function tl(t,e){GD(t,e),e.add(t)}function BM(t,e,n){GD(t,e),e.set(t,n)}function GD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ar(t,e){var n=zD(t,e,"get");return are(t,n)}function are(t,e){return e.get?e.get.call(t):e.value}function Lu(t,e,n){var r=zD(t,e,"set");return lre(t,r,n),n}function zD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("beforeHideRows");de.getSingleton().register("afterHideRows");de.getSingleton().register("beforeUnhideRows");de.getSingleton().register("afterUnhideRows");const ww="hiddenRows",ure=320;var fo=new WeakMap,Si=new WeakMap,UM=new WeakSet,YM=new WeakSet,GM=new WeakSet,zM=new WeakSet,jM=new WeakSet,KM=new WeakSet;class cre extends it{constructor(){super(...arguments),tl(this,KM),tl(this,jM),tl(this,zM),tl(this,GM),tl(this,YM),tl(this,UM),BM(this,fo,{writable:!0,value:{}}),BM(this,Si,{writable:!0,value:null})}static get PLUGIN_KEY(){return ww}static get PLUGIN_PRIORITY(){return ure}isEnabled(){return!!this.hot.getSettings()[ww]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[ww];Ve(n)&&(Lu(this,fo,n),vt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Lu(this,Si,new $g),Ar(this,Si).addLocalHook("init",()=>nl(this,KM,pre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ar(this,Si)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nl(e,jM,mre).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>nl(this,YM,dre).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>nl(this,UM,hre).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nl(e,zM,gre).call(e,...i)}),this.addHook("modifyCopyableRange",r=>nl(this,GM,fre).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Lu(this,fo,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Ar(this,Si).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));E(l,u=>{o[u]=!1}),i=Yt(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Ar(this,Si).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{Ar(this,Si).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(Ar(this,Si).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ar(this,Si).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){E(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Lu(this,fo,null),Lu(this,Si,null),super.destroy()}}function hre(t,e){return this.isHidden(e)?0:t}function dre(t,e,n){if(Ar(this,fo).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function fre(t){if(Ar(this,fo).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return E(t,r=>{let i=!0,o=0;me(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function gre(t,e){if(!Ar(this,fo).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function mre(t){t.items.push({name:ze},ore(this),sre(this))}function pre(){Array.isArray(Ar(this,fo).rows)&&this.hideRows(Ar(this,fo).rows)}function wre(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(py)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Cre(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(wy)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function XM(t,e){jD(t,e),e.add(t)}function vre(t,e,n){jD(t,e),e.set(t,n)}function jD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lv(t,e){var n=KD(t,e,"get");return Sre(t,n)}function Sre(t,e){return e.get?e.get.call(t):e.value}function Cw(t,e,n){var r=KD(t,e,"set");return yre(t,r,n),n}function KD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function qM(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeColumnFreeze");de.getSingleton().register("afterColumnFreeze");de.getSingleton().register("beforeColumnUnfreeze");de.getSingleton().register("afterColumnUnfreeze");const ZM="manualColumnFreeze",bre=110;var ea=new WeakMap,JM=new WeakSet,QM=new WeakSet;class Rre extends it{constructor(){super(...arguments),XM(this,QM),XM(this,JM),vre(this,ea,{writable:!0,value:!1})}static get PLUGIN_KEY(){return ZM}static get PLUGIN_PRIORITY(){return bre}isEnabled(){return!!this.hot.getSettings()[ZM]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>qM(this,JM,Ere).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>qM(this,QM,Tre).call(this,e,n)),super.enablePlugin())}disablePlugin(){Cw(this,ea,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;lv(this,ea)||Cw(this,ea,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;lv(this,ea)||Cw(this,ea,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Ere(t){t.items.push({name:"---------"},wre(this),Cre(this))}function Tre(t,e){if(lv(this,ea)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function yd(t,e,n){return e=_re(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _re(t){var e=Mre(t,"string");return typeof e=="symbol"?e:String(e)}function Mre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vw=0,e1=1,t1=2,rl="px";let Are=class{constructor(e){yd(this,"hot",void 0),yd(this,"_element",null),yd(this,"state",vw),yd(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=t1}build(){this.state===vw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=e1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=vw}isAppended(){return this.state===t1}isBuilt(){return this.state>=e1}setPosition(e,n){Wn(e)&&(this._element.style.top=e+rl),Wn(n)&&(this._element.style[this.inlineProperty]=n+rl)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Wn(e)&&(this._element.style.width=e+rl),Wn(n)&&(this._element.style.height=n+rl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Wn(e)&&(this._element.style.marginTop=e+rl),Wn(n)&&(this._element.style[`margin${En(this.inlineProperty)}`]=n+rl)}getOffset(){const e=this._element.style,n=`margin${En(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const XD=Are,Ore="ht__manualColumnMove--backlight";let Ire=class extends XD{build(){super.build(),q(this._element,Ore)}};const Pre=Ire,xre="ht__manualColumnMove--guideline";let Hre=class extends XD{build(){super.build(),q(this._element,xre)}};const Dre=Hre;function il(t,e){qD(t,e),e.add(t)}function Gr(t,e,n){qD(t,e),e.set(t,n)}function qD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nr(t,e,n){var r=ZD(t,e,"set");return Nre(t,r,n),n}function Nre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ge(t,e){var n=ZD(t,e,"get");return Lre(t,n)}function ZD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lre(t,e){return e.get?e.get.call(t):e.value}function ol(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeColumnMove");de.getSingleton().register("afterColumnMove");const Sw="manualColumnMove",$re=120,n1="ht__manualColumnMove",Bf="show-ui",uv="on-moving--columns",cv="after-selection--columns";var kn=new WeakMap,Xo=new WeakMap,go=new WeakMap,nf=new WeakMap,ns=new WeakMap,$n=new WeakMap,bd=new WeakMap,Er=new WeakMap,wl=new WeakMap,Uf=new WeakMap,sc=new WeakMap,r1=new WeakSet,i1=new WeakSet,o1=new WeakSet,s1=new WeakSet,a1=new WeakSet,l1=new WeakSet;class kre extends it{constructor(){super(...arguments),il(this,l1),il(this,a1),il(this,s1),il(this,o1),il(this,i1),il(this,r1),Gr(this,kn,{writable:!0,value:new Pre(this.hot)}),Gr(this,Xo,{writable:!0,value:new Dre(this.hot)}),Gr(this,go,{writable:!0,value:[]}),Gr(this,nf,{writable:!0,value:0}),Gr(this,ns,{writable:!0,value:!1}),Gr(this,$n,{writable:!0,value:{}}),Gr(this,bd,{writable:!0,value:void 0}),Gr(this,Er,{writable:!0,value:void 0}),Gr(this,wl,{writable:!0,value:void 0}),Gr(this,Uf,{writable:!0,value:void 0}),Gr(this,sc,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Sw}static get PLUGIN_PRIORITY(){return $re}isEnabled(){return!!this.hot.getSettings()[Sw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ol(e,r1,Fre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ol(e,o1,Vre).call(e,...r)}),this.addHook("afterScrollVertically",()=>ol(this,a1,Ure).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ol(e,l1,Yre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,n1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Le(this.hot.rootElement,n1),this.unregisterEvents(),ge(this,kn).destroy(),ge(this,Xo).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=ge(this,bd),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(nr(this,bd,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return nr(this,bd,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Yt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Sw];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return me(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ge(this,Er))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ge(this,Er)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ge(this,kn).getOffset().start,u=ge(this,kn).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,C=ft(this.hot.rootElement),S=p.innerWidth-ge(this,wl)-C;h=p.innerWidth-ge(this,$n).eventPageX-S-(r.scrollX===void 0?i:0)}else h=ge(this,$n).eventPageX-(ge(this,wl)-(r.scrollX===void 0?i:0));if(ge(this,Uf)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ge(this,Er))&&(o+=i),o+=c,ge(this,Er)<0)ge(this,sc)>0?ge(this,$n).col=0:ge(this,$n).col=e>0?e-1:e;else if(ge(this,$n).TD.offsetWidth/2+o<=h){const p=ge(this,Er)>=ge(this,nf)?ge(this,nf)-1:ge(this,Er);ge(this,$n).col=p+1,o+=ge(this,$n).TD.offsetWidth}else ge(this,$n).col=ge(this,Er);let d=h,g=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?g=s-1:g===0?g=1:r.scrollX!==void 0&&ge(this,Er)<ge(this,sc)&&(g-=ge(this,wl)<=r.scrollX?ge(this,wl):0),ge(this,kn).setPosition(null,d),ge(this,Xo).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ol(this,i1,Wre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ol(this,s1,Bre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ge(this,kn).build(),ge(this,Xo).build()}destroy(){ge(this,kn).destroy(),ge(this,Xo).destroy(),super.destroy()}}function Fre(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ie(t.target,"sortAction");if(!s||!o||ge(this,ns)||t.button!==0||a){nr(this,ns,!1),ge(this,go).length=0,Le(this.hot.rootElement,[uv,Bf]);return}const l=ge(this,Xo).isBuilt()&&!ge(this,Xo).isAppended(),u=ge(this,kn).isBuilt()&&!ge(this,kn).isAppended();l&&u&&(ge(this,Xo).appendTo(i.hider),ge(this,kn).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=g){r.column=!0,nr(this,ns,!0);const p=n.firstChild?xP(t,n.firstChild).x:t.offsetX;ge(this,$n).eventPageX=t.pageX,nr(this,Er,e.col),ge(this,$n).TD=n,ge(this,$n).col=e.col,nr(this,go,this.prepareColumnsToMoving(d,g)),nr(this,Uf,!!this.hot.getSettings().rowHeaders),nr(this,nf,this.hot.countCols()),nr(this,sc,this.hot.getSettings().fixedColumnsStart),nr(this,wl,en(this.hot.rootElement).left);const C=ge(this,Uf)?-1:0,S=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<ge(this,sc),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),N=this.getColumnsWidth(d,e.col-1)+T,I=this.getColumnsWidth(C,d-1)+(y?R:0)+N;ge(this,kn).setPosition(S,I),ge(this,kn).setSize(this.getColumnsWidth(d,g),i.hider.offsetHeight-S),ge(this,kn).setOffset(null,-N),q(this.hot.rootElement,uv)}else Le(this.hot.rootElement,cv),nr(this,ns,!1),ge(this,go).length=0}function Wre(t){ge(this,ns)&&(ge(this,$n).eventPageX=t.pageX,this.refreshPositions())}function Vre(t,e,n,r){!this.hot.getSelectedRangeLast()||!ge(this,ns)||(ge(this,go).indexOf(e.col)>-1?Le(this.hot.rootElement,Bf):q(this.hot.rootElement,Bf),r.row=!0,r.column=!0,r.cell=!0,nr(this,Er,e.col),ge(this,$n).TD=n)}function Bre(){const t=ge(this,$n).col,e=ge(this,go).length;if(nr(this,Er,void 0),nr(this,ns,!1),Le(this.hot.rootElement,[uv,Bf,cv]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,cv),e<1||t===void 0)return;const n=ge(this,go)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(ge(this,go),t);if(ge(this,go).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Ure(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;ge(this,kn).setPosition(r),ge(this,kn).setSize(null,t.hider.offsetHeight-r)}function Yre(){this.moveBySettingsOrLoad()}function Ji(t,e){JD(t,e),e.add(t)}function wn(t,e,n){JD(t,e),e.set(t,n)}function JD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ut(t,e,n){var r=QD(t,e,"set");return Gre(t,r,n),n}function Gre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ae(t,e){var n=QD(t,e,"get");return zre(t,n)}function QD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zre(t,e){return e.get?e.get.call(t):e.value}const Yf="manualColumnResize",jre=130,u1="manualColumnWidths";var oo=new WeakMap,Rd=new WeakMap,cr=new WeakMap,Gf=new WeakMap,Ii=new WeakMap,Kre=new WeakMap,Al=new WeakMap,Ed=new WeakMap,Zn=new WeakMap,to=new WeakMap,ga=new WeakMap,zf=new WeakMap,ac=new WeakMap,lc=new WeakMap,dr=new WeakMap,uc=new WeakMap,c1=new WeakSet,h1=new WeakSet,d1=new WeakSet,f1=new WeakSet,g1=new WeakSet,m1=new WeakSet,p1=new WeakSet,w1=new WeakSet,C1=new WeakSet;class Xre extends it{static get PLUGIN_KEY(){return Yf}static get PLUGIN_PRIORITY(){return jre}constructor(e){super(e),Ji(this,C1),Ji(this,w1),Ji(this,p1),Ji(this,m1),Ji(this,g1),Ji(this,f1),Ji(this,d1),Ji(this,h1),Ji(this,c1),wn(this,oo,{writable:!0,value:null}),wn(this,Rd,{writable:!0,value:null}),wn(this,cr,{writable:!0,value:[]}),wn(this,Gf,{writable:!0,value:null}),wn(this,Ii,{writable:!0,value:null}),wn(this,Kre,{writable:!0,value:null}),wn(this,Al,{writable:!0,value:null}),wn(this,Ed,{writable:!0,value:null}),wn(this,Zn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),wn(this,to,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),wn(this,ga,{writable:!0,value:null}),wn(this,zf,{writable:!0,value:!1}),wn(this,ac,{writable:!0,value:0}),wn(this,lc,{writable:!0,value:null}),wn(this,dr,{writable:!0,value:void 0}),wn(this,uc,{writable:!0,value:void 0}),q(ae(this,Zn),"manualColumnResizer"),q(ae(this,to),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Yf]}enablePlugin(){this.enabled||(Ut(this,dr,new ys),ae(this,dr).addLocalHook("init",()=>Qi(this,c1,qre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ae(this,dr)),this.addHook("modifyColWidth",(e,n)=>Qi(this,p1,nie).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Qi(this,w1,rie).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Qi(this,C1,iie).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ut(this,uc,ae(this,dr).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",u1,ae(this,dr).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",u1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ae(this,dr).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ae(this,dr).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Ut(this,oo,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ae(this,oo)),i=r.col;if(i<0)return;const o=xt(ae(this,oo)),s=ae(this,oo).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(this,oo),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ae(this,oo),r.row,r.col)),Ut(this,Rd,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Ut(this,cr,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();E(c,h=>{const d=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;me(d,g,p=>{ae(this,cr).includes(p)||ae(this,cr).push(p)})})}ae(this,cr).includes(ae(this,Rd))||Ut(this,cr,[ae(this,Rd)]),Ut(this,Ed,l.start-6),Ut(this,Al,parseInt(s.width,10)),ae(this,Zn).style.top=`${l.top}px`,ae(this,Zn).style[this.inlineDir]=`${ae(this,Ed)+ae(this,Al)}px`,ae(this,Zn).style.height=`${o}px`,this.hot.rootElement.appendChild(ae(this,Zn))}refreshHandlePosition(){ae(this,Zn).style[this.inlineDir]=`${ae(this,Ed)+ae(this,Gf)}px`}setupGuidePosition(){const e=parseInt(xt(ae(this,Zn)),10),n=parseInt(ae(this,Zn).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);q(ae(this,Zn),"active"),q(ae(this,to),"active"),ae(this,to).style.top=`${n}px`,this.refreshGuidePosition(),ae(this,to).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ae(this,to))}refreshGuidePosition(){ae(this,to).style[this.inlineDir]=ae(this,Zn).style[this.inlineDir]}hideHandleAndGuide(){Le(ae(this,Zn),"active"),Le(ae(this,to),"active")}checkIfColumnHeader(e){const n=cs(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ae(this,Ii),r,!0);o!==void 0&&Ut(this,Ii,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,ae(this,Ii)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(this,Ii),r,!0),i&&e()};ae(this,ac)>=2&&(ae(this,cr).length>1?(E(ae(this,cr),i=>{n(i)}),e()):E(ae(this,cr),i=>{n(i,!0)})),Ut(this,ac,0),Ut(this,lc,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Qi(this,h1,Zre).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Qi(this,d1,Jre).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Qi(this,f1,Qre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Qi(this,g1,eie).call(this)),this.eventManager.addEventListener(ae(this,Zn),"contextmenu",()=>Qi(this,m1,tie).call(this))}destroy(){super.destroy()}}function qre(){const t=this.hot.getSettings()[Yf],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ae(this,dr).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ae(this,dr).setValueAtIndex(r,n)})},!0),Ut(this,uc,t)):t===!0&&Array.isArray(ae(this,uc))&&this.hot.batchExecution(()=>{ae(this,uc).forEach((n,r)=>{ae(this,dr).setValueAtIndex(r,n)})},!0)}function Zre(t){if(!dS(t.target)&&ae(this,zf)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ae(this,ga)||this.setupHandlePosition(e))}}function Jre(t){Ie(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ae(this,oo)),this.setupGuidePosition(),Ut(this,ga,!0),ae(this,lc)===null&&(Ut(this,lc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(this,lc))),Ut(this,ac,ae(this,ac)+1),this.startX=t.pageX,Ut(this,Ii,ae(this,Al)))}function Qre(t){if(ae(this,ga)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Ut(this,Gf,ae(this,Al)+e),E(ae(this,cr),n=>{Ut(this,Ii,this.setManualSize(n,ae(this,Gf)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function eie(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ae(this,Ii),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(this,Ii),n,!1)};ae(this,ga)&&(this.hideHandleAndGuide(),Ut(this,ga,!1),ae(this,Ii)!==ae(this,Al)&&(ae(this,cr).length>1?(E(ae(this,cr),r=>{e(r)}),t()):E(ae(this,cr),r=>{e(r,!0)})),this.setupHandlePosition(ae(this,oo)))}function tie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(this,Zn)),this.hot.rootElement.removeChild(ae(this,to)),Ut(this,ga,!1),Ut(this,zf,!0),this.hot._registerImmediate(()=>{Ut(this,zf,!1)})}function nie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ae(this,dr).getValueAtIndex(r);this.hot.getSettings()[Yf]&&i&&(n=i)}return n}function rie(t,e){let n=ae(this,dr).getValueAtIndex(e);return n===null&&(n=t),n}function iie(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function yw(t,e,n){return e=oie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oie(t){var e=sie(t,"string");return typeof e=="symbol"?e:String(e)}function sie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bw=0,v1=1,S1=2,sl="px";let aie=class{constructor(e){yw(this,"hot",void 0),yw(this,"_element",null),yw(this,"state",bw),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=S1}build(){this.state===bw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=v1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=bw}isAppended(){return this.state===S1}isBuilt(){return this.state>=v1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+sl),n!==void 0&&(this._element.style.left=n+sl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+sl),n&&(this._element.style.height=n+sl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+sl),n&&(this._element.style.marginLeft=n+sl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const eN=aie,lie="ht__manualRowMove--backlight";class uie extends eN{build(){super.build(),q(this._element,lie)}}const cie=uie,hie="ht__manualRowMove--guideline";class die extends eN{build(){super.build(),q(this._element,hie)}}const fie=die;function al(t,e){tN(t,e),e.add(t)}function ll(t,e,n){tN(t,e),e.set(t,n)}function tN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aa(t,e,n){var r=nN(t,e,"set");return gie(t,r,n),n}function gie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function $e(t,e){var n=nN(t,e,"get");return mie(t,n)}function nN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mie(t,e){return e.get?e.get.call(t):e.value}function ul(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeRowMove");de.getSingleton().register("afterRowMove");const Rw="manualRowMove",pie=140,y1="ht__manualRowMove",jf="show-ui",hv="on-moving--rows",dv="after-selection--rows";var Fn=new WeakMap,qo=new WeakMap,mo=new WeakMap,rs=new WeakMap,rr=new WeakMap,Td=new WeakMap,b1=new WeakSet,R1=new WeakSet,E1=new WeakSet,T1=new WeakSet,_1=new WeakSet,M1=new WeakSet;class wie extends it{constructor(){super(...arguments),al(this,M1),al(this,_1),al(this,T1),al(this,E1),al(this,R1),al(this,b1),ll(this,Fn,{writable:!0,value:new cie(this.hot)}),ll(this,qo,{writable:!0,value:new fie(this.hot)}),ll(this,mo,{writable:!0,value:[]}),ll(this,rs,{writable:!0,value:void 0}),ll(this,rr,{writable:!0,value:{}}),ll(this,Td,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Rw}static get PLUGIN_PRIORITY(){return pie}isEnabled(){return!!this.hot.getSettings()[Rw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ul(e,b1,Cie).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ul(e,E1,Sie).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ul(this,_1,bie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ul(e,M1,Rie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,y1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Le(this.hot.rootElement,y1),this.unregisterEvents(),$e(this,Fn).destroy(),$e(this,qo).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=$e(this,Td),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(aa(this,Td,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return aa(this,Td,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Yt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Rw];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return me(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=$e(this,rr).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=$e(this,rr).TD,a=this.hot.rootElement,l=en(a),u=ca(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,g=$e(this,rr).eventPageY-d+c,p=o.hider.offsetHeight,C=o.TBODY.offsetTop,S=$e(this,Fn).getOffset().top,y=$e(this,Fn).getSize().height,R=s.offsetHeight/2,T=s.offsetHeight;let N=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=g>=N+R;this.isFixedRowTop(e.row)&&(N+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?$e(this,rr).row=n>0?n-1:n:I?($e(this,rr).row=e.row+1,N+=e.row===0?T-1:T):$e(this,rr).row=e.row;let F=g,B=N;g+y+S>=p?F=p-y-S:g+S<C&&(F=C+Math.abs(S)),N>=p-1&&(B=p-1),$e(this,Fn).setPosition(F),$e(this,qo).setPosition(B)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ul(this,R1,vie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ul(this,T1,yie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){$e(this,Fn).build(),$e(this,qo).build()}destroy(){$e(this,Fn).destroy(),$e(this,qo).destroy(),super.destroy()}}function Cie(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||$e(this,rs)||t.button!==0){aa(this,rs,!1),$e(this,mo).length=0,Le(this.hot.rootElement,[hv,jf]);return}const l=$e(this,qo).isBuilt()&&!$e(this,qo).isAppended(),u=$e(this,Fn).isBuilt()&&!$e(this,Fn).isAppended();l&&u&&($e(this,qo).appendTo(i.hider),$e(this,Fn).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=g){r.row=!0,aa(this,rs,!0),$e(this,rr).eventPageY=t.pageY,$e(this,rr).coords=e,$e(this,rr).TD=n,aa(this,mo,this.prepareRowsToMoving());const p=i.holder.scrollLeft+o.getRowHeaderWidth(),C=this.getRowsHeight(d,e.row-1)+t.offsetY;$e(this,Fn).setPosition(null,p),$e(this,Fn).setSize(i.hider.offsetWidth-p,this.getRowsHeight(d,g)),$e(this,Fn).setOffset(-C,null),q(this.hot.rootElement,hv),this.refreshPositions()}else Le(this.hot.rootElement,dv),aa(this,rs,!1),$e(this,mo).length=0}function vie(t){$e(this,rs)&&($e(this,rr).eventPageY=t.pageY,this.refreshPositions())}function Sie(t,e,n,r){!this.hot.getSelectedRangeLast()||!$e(this,rs)||($e(this,mo).indexOf(e.row)>-1?Le(this.hot.rootElement,jf):q(this.hot.rootElement,jf),r.row=!0,r.column=!0,r.cell=!0,$e(this,rr).coords=e,$e(this,rr).TD=n)}function yie(){const t=$e(this,rr).row,e=$e(this,mo).length;if(aa(this,rs,!1),Le(this.hot.rootElement,[hv,jf,dv]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,dv),e<1||t===void 0)return;const n=$e(this,mo)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows($e(this,mo),t);if($e(this,mo).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function bie(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;$e(this,Fn).setPosition(null,r),$e(this,Fn).setSize(t.hider.offsetWidth-r)}function Rie(){this.moveBySettingsOrLoad()}function Ks(t,e){rN(t,e),e.add(t)}function Cn(t,e,n){rN(t,e),e.set(t,n)}function rN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function $t(t,e,n){var r=iN(t,e,"set");return Eie(t,r,n),n}function Eie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function se(t,e){var n=iN(t,e,"get");return Tie(t,n)}function iN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tie(t,e){return e.get?e.get.call(t):e.value}const Kf="manualRowResize",_ie=30,A1="manualRowHeights";var Ti=new WeakMap,_d=new WeakMap,hr=new WeakMap,Xf=new WeakMap,Zo=new WeakMap,rR=new WeakMap,Ol=new WeakMap,Md=new WeakMap,Nn=new WeakMap,Ri=new WeakMap,ma=new WeakMap,qf=new WeakMap,cc=new WeakMap,hc=new WeakMap,Zr=new WeakMap,dc=new WeakMap,O1=new WeakSet,I1=new WeakSet,P1=new WeakSet,x1=new WeakSet,H1=new WeakSet,D1=new WeakSet,N1=new WeakSet;class Mie extends it{static get PLUGIN_KEY(){return Kf}static get PLUGIN_PRIORITY(){return _ie}constructor(e){super(e),Ks(this,N1),Ks(this,D1),Ks(this,H1),Ks(this,x1),Ks(this,P1),Ks(this,I1),Ks(this,O1),Cn(this,Ti,{writable:!0,value:null}),Cn(this,_d,{writable:!0,value:null}),Cn(this,hr,{writable:!0,value:[]}),Cn(this,Xf,{writable:!0,value:null}),Cn(this,Zo,{writable:!0,value:null}),Cn(this,rR,{writable:!0,value:null}),Cn(this,Ol,{writable:!0,value:null}),Cn(this,Md,{writable:!0,value:null}),Cn(this,Nn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Cn(this,Ri,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Cn(this,ma,{writable:!0,value:!1}),Cn(this,qf,{writable:!0,value:!1}),Cn(this,cc,{writable:!0,value:0}),Cn(this,hc,{writable:!0,value:null}),Cn(this,Zr,{writable:!0,value:void 0}),Cn(this,dc,{writable:!0,value:void 0}),q(se(this,Nn),"manualRowResizer"),q(se(this,Ri),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Kf]}enablePlugin(){this.enabled||($t(this,Zr,new ys),se(this,Zr).addLocalHook("init",()=>Xs(this,N1,Die).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,se(this,Zr)),this.addHook("modifyRowHeight",(e,n)=>Xs(this,D1,Hie).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){$t(this,dc,se(this,Zr).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",A1,se(this,Zr).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",A1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,Ng.DEFAULT_HEIGHT);return se(this,Zr).setValueAtIndex(r,i),i}setupHandlePosition(e){$t(this,Ti,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(se(this,Ti)),o=i.row;if(o<0)return;const s=ft(se(this,Ti)),a=se(this,Ti).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(this,Ti),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(se(this,Ti),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(se(this,Ti),i.row,i.col)),$t(this,_d,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),$t(this,hr,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();E(d,g=>{const p=g.getTopStartCorner().row,C=g.getBottomStartCorner().row;me(p,C,S=>{se(this,hr).includes(S)||se(this,hr).push(S)})})}se(this,hr).includes(se(this,_d))||$t(this,hr,[se(this,_d)]),$t(this,Md,c.top-6),$t(this,Ol,parseInt(a.height,10)),se(this,Nn).style.top=`${se(this,Md)+se(this,Ol)}px`,se(this,Nn).style[this.inlineDir]=`${c.start}px`,se(this,Nn).style.width=`${s}px`,this.hot.rootElement.appendChild(se(this,Nn))}refreshHandlePosition(){se(this,Nn).style.top=`${se(this,Md)+se(this,Xf)}px`}setupGuidePosition(){const e=parseInt(ft(se(this,Nn)),10),n=parseInt(se(this,Nn).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);q(se(this,Nn),"active"),q(se(this,Ri),"active"),se(this,Ri).style.top=se(this,Nn).style.top,se(this,Ri).style[this.inlineDir]=`${n}px`,se(this,Ri).style.width=`${r-e}px`,this.hot.rootElement.appendChild(se(this,Ri))}refreshGuidePosition(){se(this,Ri).style.top=se(this,Nn).style.top}hideHandleAndGuide(){Le(se(this,Nn),"active"),Le(se(this,Ri),"active")}checkIfRowHeader(e){const n=cs(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&se(this,Zo)<n?n:se(this,Zo)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&$t(this,Zo,o),this.setManualSize(r,se(this,Zo)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};se(this,cc)>=2&&(se(this,hr).length>1?(E(se(this,hr),i=>{n(i)}),e()):E(se(this,hr),i=>{n(i,!0)})),$t(this,cc,0),$t(this,hc,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Xs(this,O1,Aie).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Xs(this,I1,Oie).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Xs(this,P1,Iie).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Xs(this,x1,Pie).call(this)),this.eventManager.addEventListener(se(this,Nn),"contextmenu",()=>Xs(this,H1,xie).call(this))}destroy(){super.destroy()}}function Aie(t){if(!dS(t.target)&&se(this,qf)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(se(this,ma)||this.setupHandlePosition(e))}}function Oie(t){Ie(t.target,"manualRowResizer")&&(this.setupHandlePosition(se(this,Ti)),this.setupGuidePosition(),$t(this,ma,!0),se(this,hc)===null&&($t(this,hc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(this,hc))),$t(this,cc,se(this,cc)+1),$t(this,rR,t.pageY),$t(this,Zo,se(this,Ol)))}function Iie(t){se(this,ma)&&($t(this,Xf,se(this,Ol)+(t.pageY-se(this,rR))),E(se(this,hr),e=>{$t(this,Zo,this.setManualSize(e,se(this,Xf)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Pie(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};se(this,ma)&&(this.hideHandleAndGuide(),$t(this,ma,!1),se(this,Zo)!==se(this,Ol)&&(se(this,hr).length>1?(E(se(this,hr),r=>{e(r)}),t()):E(se(this,hr),r=>{e(r,!0)})),this.setupHandlePosition(se(this,Ti)))}function xie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(this,Nn)),this.hot.rootElement.removeChild(se(this,Ri)),$t(this,ma,!1),$t(this,qf,!0),this.hot._registerImmediate(()=>{$t(this,qf,!1)})}function Hie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=se(this,Zr).getValueAtIndex(r);this.hot.getSettings()[Kf]&&i&&(n=i)}return n}function Die(){const t=this.hot.getSettings()[Kf],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{se(this,Zr).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{se(this,Zr).setValueAtIndex(r,n)}),$t(this,dc,t)):t===!0&&Array.isArray(se(this,dc))&&se(this,dc).forEach((n,r)=>{se(this,Zr).setValueAtIndex(r,n)})},!0)}function qs(t,e,n){return e=Nie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:String(e)}function Lie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ie{constructor(e,n,r,i,o,s){qs(this,"row",void 0),qs(this,"col",void 0),qs(this,"rowspan",void 0),qs(this,"colspan",void 0),qs(this,"removed",!1),qs(this,"cellCoordsFactory",void 0),qs(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ht`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ht`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const _i=$ie;function fv(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Ew(t,e,n){return e=kie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kie(t){var e=Fie(t,"string");return typeof e=="symbol"?e:String(e)}function Fie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iR{constructor(e){Ew(this,"plugin",void 0),Ew(this,"mergedCells",[]),Ew(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return E(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return E(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return E(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new _i(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(gt(iR.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];E(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,E(n,(i,o)=>{me(0,i.rowspan-1,s=>{me(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),E(n,i=>{fv(...i)}),E(r,i=>{fv(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return E(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}E(this.mergedCells,o=>{o.shift(i,n)}),Rf(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Wie=iR;function Tw(t,e,n){return e=Vie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vie(t){var e=Bie(t,"string");return typeof e=="symbol"?e:String(e)}function Bie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uie{constructor(e){Tw(this,"plugin",void 0),Tw(this,"mergedCellsCollection",void 0),Tw(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,g=Math.floor(s/d)*d,p=s-g,C=this.getFarthestCollection(e,n,r,i);if(C){if(r==="down"){const S=C.row+C.rowspan-a-p;o[2]+S>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?S:0}else if(r==="right"){const S=C.col+C.colspan-l-p;o[3]+S>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?S:0}else if(r==="up"){const S=u-p-C.row+1;o[0]+S<0?o[0]+=p:o[0]-=p?S:0}else if(r==="left"){const S=c-p-C.col+1;o[1]+S<0?o[1]+=p:o[1]-=p?S:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),jt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),g=u?a-o+1:l-s+1,p=Math.floor(d/g)*g,C=d-p;let S=null,y=null,R=null;switch(r){case"up":S="includesVertically",R=c-C+1;break;case"left":S="includesHorizontally",R=c-C+1;break;case"down":S="includesVertically",R=h+C-1;break;case"right":S="includesHorizontally",R=h+C-1;break}return E(i,T=>{T[S](R)&&T.isFarther(y,r)&&(y=T)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return E(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const Yie=Uie;function _w(t,e,n){return e=Gie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=zie(t,"string");return typeof e=="symbol"?e:String(e)}function zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jie{constructor(e){_w(this,"plugin",void 0),_w(this,"hot",void 0),_w(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const Kie=jie;function Xie(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(vy)}return this.getTranslatedPhrase(Cy)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?_i.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Dt(t,e){oN(t,e),e.add(t)}function qie(t,e,n){oN(t,e),e.set(t,n)}function oN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mw(t,e,n){return e=Zie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zie(t){var e=Jie(t,"string");return typeof e=="symbol"?e:String(e)}function Jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aw(t,e,n){var r=sN(t,e,"set");return Qie(t,r,n),n}function Qie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function cl(t,e){var n=sN(t,e,"get");return eoe(t,n)}function sN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function eoe(t,e){return e.get?e.get.call(t):e.value}function At(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeMergeCells");de.getSingleton().register("afterMergeCells");de.getSingleton().register("beforeUnmergeCells");de.getSingleton().register("afterUnmergeCells");const fc="mergeCells",toe=150,L1=fc;var Ei=new WeakMap,$1=new WeakSet,k1=new WeakSet,F1=new WeakSet,W1=new WeakSet,V1=new WeakSet,B1=new WeakSet,U1=new WeakSet,Ow=new WeakSet,Y1=new WeakSet,G1=new WeakSet,z1=new WeakSet,j1=new WeakSet,K1=new WeakSet,X1=new WeakSet,q1=new WeakSet,Z1=new WeakSet,J1=new WeakSet,Q1=new WeakSet,eA=new WeakSet,tA=new WeakSet,nA=new WeakSet,rA=new WeakSet,iA=new WeakSet;class noe extends it{constructor(){super(...arguments),Dt(this,iA),Dt(this,rA),Dt(this,nA),Dt(this,tA),Dt(this,eA),Dt(this,Q1),Dt(this,J1),Dt(this,Z1),Dt(this,q1),Dt(this,X1),Dt(this,K1),Dt(this,j1),Dt(this,z1),Dt(this,G1),Dt(this,Y1),Dt(this,Ow),Dt(this,U1),Dt(this,B1),Dt(this,V1),Dt(this,W1),Dt(this,F1),Dt(this,k1),Dt(this,$1),Mw(this,"mergedCellsCollection",null),Mw(this,"autofillCalculations",null),Mw(this,"selectionCalculations",null),qie(this,Ei,{writable:!0,value:null})}static get PLUGIN_KEY(){return fc}static get PLUGIN_PRIORITY(){return toe}isEnabled(){return!!this.hot.getSettings()[fc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Wie(this),this.autofillCalculations=new Yie(this),this.selectionCalculations=new Kie(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,$1,roe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,F1,ooe).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,tA,yoe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,W1,soe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,V1,aoe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Ow,oA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Ow,oA).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Y1,coe).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,k1,ioe).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,U1,uoe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,B1,loe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,G1,hoe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,z1,doe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,j1,foe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,K1,goe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,X1,moe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,q1,poe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Z1,woe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,J1,Coe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Q1,voe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,eA,Soe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,nA,boe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,rA,Roe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,iA,Eoe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[fc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!wS())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Il(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Il(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(_i.containsNegativeValues(e)?(gt(_i.NEGATIVE_VALUES_WARNING(e)),n=!1):_i.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(gt(_i.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):_i.isSingleCell(e)?(gt(_i.IS_SINGLE_CELL(e)),n=!1):_i.containsZeroSpan(e)&&(gt(_i.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(E(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),me(r.row,r.row+r.rowspan-1,a=>{me(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),me(0,s.rowspan-1,c=>{me(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),E(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),me(0,i.rowspan-1,o=>{me(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:L1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(L1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ve(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ve(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ve(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ve(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function roe(){this.generateFromSettings(this.hot.getSettings()[fc]),this.hot.render()}function ioe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function ooe(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(cl(this,Ei)||Aw(this,Ei,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(cl(this,Ei))||Aw(this,Ei,this.hot._createCellCoords(null,null)),n.row=cl(this,Ei).row?cl(this,Ei).row-i.row:n.row,n.col=cl(this,Ei).col?cl(this,Ei).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);Aw(this,Ei,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function soe(t){const e=this.hot.getSelectedRangeLast(),n=Vn(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Vn(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Vn(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),E(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function aoe(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function loe(t){t.items.push({name:"---------"},Xie(this))}function uoe(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Ve(r)?Vn(r):void 0;if(Ve(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,d]=this.translateMergedCellToRenderable(a,c,l,u),g=o.getRenderableFromVisualIndex(e),p=s.getRenderableFromVisualIndex(n),C=h-g+1,S=d-p+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,C),i.colspan=Math.min(i.colspan,S)}fv(t,i,e,n)}function oA(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function coe(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function hoe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function doe(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function foe(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function goe(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function moe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function poe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function woe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Coe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function voe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Soe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);E(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function yoe(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function boe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Roe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Eoe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function Toe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,p=(d.compareFunctionFactory?d.compareFunctionFactory:HH(u.type))(l,u,d)(c,h);if(p===Hi){const C=a+1;if(typeof e[C]<"u")return s(C)}return p}(0)}}function sA(){gt(ht`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const aN="sort";function _oe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${aN}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Moe(t){const e=t.className.split(" "),n=new RegExp(`^${aN}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Aoe(t,e,n){return e=Ooe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ooe(t){var e=Ioe(t,"string");return typeof e=="symbol"?e:String(e)}function Ioe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Zf="multiColumnSorting",Poe=170,aA="columnSorting",lA=Zf;xH(Zf,Toe);class xoe extends DH{constructor(){super(...arguments),Aoe(this,"pluginKey",Zf)}static get PLUGIN_KEY(){return Zf}static get PLUGIN_PRIORITY(){return Poe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[aA]&&sA(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Nf))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:lA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Le(e,Moe(e)),this.enabled!==!1&&q(e,_oe(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[aA]&&sA(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){Gb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Nf))):this.sort(this.getColumnNextConfig(n.col)))}}function uA(t,e,n){return e=Hoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hoe(t){var e=Doe(t,"string");return typeof e=="symbol"?e:String(e)}function Doe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Noe="multipleSelectionHandles",Loe=160;class $oe extends it{constructor(){super(...arguments),uA(this,"dragged",[]),uA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Noe}static get PLUGIN_PRIORITY(){return Loe}isEnabled(){return uo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Ie(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Ie(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Ie(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ie(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function gv(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function lN(){return{label:"",isPlaceholder:!0}}function koe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;E(t,i=>{const o=[];let s=0;n.push(o),E(i,a=>{const l=gv();if(Ve(a)){const{label:c,colspan:h}=a;l.label=Wt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Wt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(lN());return!u})});const r=Math.max(...Ue(n,i=>i.length));return E(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>gv());i.splice(i.length,0,...o)}}),n}function Iw(t,e,n){Foe(t,e),e.set(t,n)}function Foe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zr(t,e){var n=uN(t,e,"get");return Woe(t,n)}function Woe(t,e){return e.get?e.get.call(t):e.value}function $u(t,e,n){var r=uN(t,e,"set");return Voe(t,r,n),n}function uN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Voe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const cA=["label","collapsible"];var eo=new WeakMap,Zs=new WeakMap,Pw=new WeakMap;class Boe{constructor(){Iw(this,eo,{writable:!0,value:[]}),Iw(this,Zs,{writable:!0,value:0}),Iw(this,Pw,{writable:!0,value:1/0})}setColumnsLimit(e){$u(this,Pw,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];$u(this,eo,koe(e,zr(this,Pw))),$u(this,Zs,zr(this,eo).length)}getData(){return zr(this,eo)}mergeWith(e){E(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&jt(s,o,cA)})}map(e){E(zr(this,eo),n=>{E(n,r=>{const i=e({...r});Ve(i)&&jt(r,i,cA)})})}getHeaderSettings(e,n){var r;if(e>=zr(this,Zs)||e<0)return null;const i=zr(this,eo)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=zr(this,Zs)||e<0)return i;const o=zr(this,eo)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return zr(this,Zs)}getColumnsCount(){return zr(this,Zs)>0?zr(this,eo)[0].length:0}clear(){$u(this,eo,[]),$u(this,Zs,0)}}function xw(t,e,n){return e=Uoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uoe(t){var e=Yoe(t,"string");return typeof e=="symbol"?e:String(e)}function Yoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cN="DF-pre-order";function hN(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=hN.call(this.childs[r],t,e)}return n}const Goe="DF-post-order";function dN(t,e){for(let n=0;n<this.childs.length;n++)if(dN.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const fN="BF";function zoe(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const joe=fN,hA=new Map([[cN,hN],[Goe,dN],[fN,zoe]]);class Jf{constructor(e){xw(this,"data",{}),xw(this,"parent",null),xw(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new Jf({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:joe;if(!hA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);hA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function Hw(t,e,n){Koe(t,e),e.set(t,n)}function Koe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dn(t,e){var n=gN(t,e,"get");return Xoe(t,n)}function Xoe(t,e){return e.get?e.get.call(t):e.value}function qoe(t,e,n){var r=gN(t,e,"set");return Zoe(t,r,n),n}function gN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var hl=new WeakMap,Js=new WeakMap,dl=new WeakMap;class Joe{constructor(e){Hw(this,hl,{writable:!0,value:new Map}),Hw(this,Js,{writable:!0,value:new Map}),Hw(this,dl,{writable:!0,value:null}),qoe(this,dl,e)}getRoots(){return Array.from(Dn(this,hl).values())}getRootByColumn(e){let n;return Dn(this,Js).has(e)&&(n=Dn(this,hl).get(Dn(this,Js).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Dn(this,Js).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Dn(this,Js).clear(),E(Dn(this,hl),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Dn(this,Js).set(i,e);e+=r})}buildTree(){this.clear();const e=Dn(this,dl).getColumnsCount();let n=0;for(;n<e;){const r=Dn(this,dl).getHeaderSettings(0,n),i=new Jf;Dn(this,hl).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Dn(this,dl).getHeadersSettings(r,n,i);r+=1,E(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new Jf(a),e.addChild(l)),r<Dn(this,dl).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Dn(this,hl).clear(),Dn(this,Js).clear()}}function mN(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Qf(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function eg(t){return Qf(t,"origColspan")===t.data.origColspan}function oR(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(eg(t))return oR(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)E(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,mN(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):eg(a)&&(l.isCollapsed=Qf(a,"isCollapsed"))}),{rollbackModification:()=>sR(t),affectedColumns:Array.from(o),colspanCompensation:s}}function sR(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(eg(t))return sR(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)E(o,l=>{mN(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=Qf(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):eg(l)&&(u.isCollapsed=Qf(l,"isCollapsed"))}),{rollbackModification:()=>oR(t),affectedColumns:Array.from(s),colspanCompensation:a}}function Qoe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function ese(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const dA=new Map([["collapse",sR],["expand",oR],["hide-column",Qoe],["show-column",ese]]);function tse(t,e,n){if(!dA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return dA.get(t)(e,n)}function Ad(t){const e=[];return E(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=rse(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(lN());else{const g=nse(i);g.isRoot=!0,u.push(g),c=!0}})}),e}function nse(t){const{crossHiddenColumns:e,...n}=gv(t);return n}function rse(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Dw(t,e,n){ise(t,e),e.set(t,n)}function ise(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ku(t,e,n){var r=pN(t,e,"set");return ose(t,r,n),n}function ose(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Nt(t,e){var n=pN(t,e,"get");return sse(t,n)}function pN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function sse(t,e){return e.get?e.get.call(t):e.value}var yi=new WeakMap,Kn=new WeakMap,Qs=new WeakMap;class ase{constructor(){Dw(this,yi,{writable:!0,value:new Boe}),Dw(this,Kn,{writable:!0,value:new Joe(Nt(this,yi))}),Dw(this,Qs,{writable:!0,value:[[]]})}setState(e){Nt(this,yi).setData(e);let n=!1;try{Nt(this,Kn).buildTree()}catch{Nt(this,Kn).clear(),Nt(this,yi).clear(),n=!0}return ku(this,Qs,Ad(Nt(this,Kn).getRoots())),n}setColumnsLimit(e){Nt(this,yi).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Nt(this,yi).mergeWith(n),Nt(this,Kn).buildTree(),ku(this,Qs,Ad(Nt(this,Kn).getRoots()))}mapState(e){Nt(this,yi).map(e),Nt(this,Kn).buildTree(),ku(this,Qs,Ad(Nt(this,Kn).getRoots()))}mapNodes(e){return Yt(Nt(this,Kn).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Nt(this,Kn).getNode(n,r);let o;return i&&(o=tse(e,i,r),ku(this,Qs,Ad(Nt(this,Kn).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Nt(this,Qs)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Nt(this,Kn).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Nt(this,Kn).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:g}=u.data;g||d<=i&&c>=e&&c+d-1<=r&&(s===null||h<s)&&(s=h)},cN)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Nt(this,yi).getLayersCount()}getColumnsCount(){return Nt(this,yi).getColumnsCount()}clear(){ku(this,Qs,[]),Nt(this,yi).clear(),Nt(this,Kn).clear()}}function Fu(t,e,n){return e=lse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lse(t){var e=use(t,"string");return typeof e=="symbol"?e:String(e)}function use(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cse{constructor(e,n){Fu(this,"hot",void 0),Fu(this,"nestedHeaderSettingsGetter",void 0),Fu(this,"layersCount",0),Fu(this,"container",void 0),Fu(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let p=g.label;s&&(p+='<button class="changeType"></button>'),Sa(d,p),d.colSpan=g.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const hse=cse;function ln(t,e){wN(t,e),e.add(t)}function fA(t,e,n){return e=dse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dse(t){var e=fse(t,"string");return typeof e=="symbol"?e:String(e)}function fse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Od(t,e,n){wN(t,e),e.set(t,n)}function wN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function la(t,e,n){var r=CN(t,e,"set");return gse(t,r,n),n}function gse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function et(t,e){var n=CN(t,e,"get");return mse(t,n)}function CN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mse(t,e){return e.get?e.get.call(t):e.value}function Xt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const gA="nestedHeaders",pse=280;var dt=new WeakMap,Bo=new WeakMap,gc=new WeakMap,im=new WeakMap,Id=new WeakSet,mA=new WeakSet,pA=new WeakSet,wA=new WeakSet,CA=new WeakSet,vA=new WeakSet,SA=new WeakSet,yA=new WeakSet,bA=new WeakSet,RA=new WeakSet,EA=new WeakSet,TA=new WeakSet,_A=new WeakSet,MA=new WeakSet,AA=new WeakSet,OA=new WeakSet,IA=new WeakSet,PA=new WeakSet;class wse extends it{constructor(){super(...arguments),ln(this,PA),ln(this,IA),ln(this,OA),ln(this,AA),ln(this,MA),ln(this,_A),ln(this,TA),ln(this,EA),ln(this,RA),ln(this,bA),ln(this,yA),ln(this,SA),ln(this,vA),ln(this,CA),ln(this,wA),ln(this,pA),ln(this,mA),ln(this,Id),Od(this,dt,{writable:!0,value:new ase}),Od(this,Bo,{writable:!0,value:null}),Od(this,gc,{writable:!0,value:null}),Od(this,im,{writable:!0,value:!1}),fA(this,"ghostTable",new hse(this.hot,(e,n)=>this.getHeaderSettings(e,n))),fA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return gA}static get PLUGIN_PRIORITY(){return pse}isEnabled(){return!!this.hot.getSettings()[gA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&gt(ht`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Xt(this,IA,Hse).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,PA,Dse).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,CA,yse).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,vA,bse).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,SA,Rse).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,yA,Ese).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,bA,Tse).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,RA,_se).call(e,...i)}),this.addHook("afterSelection",()=>Xt(this,Id,Nw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,mA,Cse).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Xt(this,TA,Ase).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,MA,Ise).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,AA,Pse).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,pA,vse).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,wA,Sse).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,EA,Mse).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,_A,Ose).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,OA,xse).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Xt(this,Id,Nw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Xt(this,Id,Nw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();et(this,dt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=et(this,dt).setState(e)),this.detectedOverlappedHeaders&&gt(ht`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";et(this,dt).triggerColumnModification(i,r)}),!et(this,Bo)&&this.enabled&&la(this,Bo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";et(this,dt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),et(this,dt).clear(),et(this,Bo).unsubscribe(),la(this,Bo,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return et(this,dt)}getLayersCount(){return et(this,dt).getLayersCount()}getHeaderSettings(e,n){return et(this,dt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),Le(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Le(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Le(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),Le(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d}=(s=et(this,dt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,p;const{wtOverlays:C}=l._wt,S=(g=C.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),y=(p=C.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),R=S||y?Math.min(c,r-i):c;R>1&&o.setAttribute("colspan",R)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=et(this,dt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){la(this,dt,null),et(this,Bo)!==null&&(et(this,Bo).unsubscribe(),la(this,Bo,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return et(this,dt).getHeaderTreeNodeData(e.row,e.col)}}function Nw(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=et(this,dt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Cse(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=et(this,dt).findLeftMostColumnIndex(n.row,n.col),a=et(this,dt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function vse(t,e,n){const r=et(this,dt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=et(this,dt).getHeaderSettings(e,t);if(o===$S){if(!a)return r.columnIndex}else if(o===fx&&(l>s-i||!a))return null;return t}function Sse(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let g=s;g<=l;g++){var i;const p=c+g,C=d-a;if(C===0)continue;((i=et(this,dt).getHeaderTreeNodeData(g,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[p][C]="")}}}function yse(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function bse(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;la(this,gc,e.clone()),la(this,im,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(xg(t)||fs(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Rse(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=ir(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Ese(){la(this,im,!1)}function Tse(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!et(this,im)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=et(this,dt).getHeaderTreeNodeData(et(this,gc).row,et(this,gc).col);if(e.setHighlight(et(this,gc)),o>e.getWidth()||i<n||i+o-1>r){const s=et(this,dt).findTopMostEntireHeaderLevel(ir(n,i,i+o-1),ir(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function _se(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=et(this,dt).findLeftMostColumnIndex(n.row,n.col),o=et(this,dt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Mse(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Ase(t){t.length=0;for(let e=0;e<et(this,dt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Ose(t){const e=et(this,dt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=et(this,dt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Wn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?et(this,dt).getHeaderTreeNodeData(0,n).columnIndex:n}function Ise(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Pse(t,e,n){var r;const{label:i}=(r=et(this,dt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function xse(t,e){if(t<0)return this.hot.getCell(t,et(this,dt).findLeftMostColumnIndex(t,e),!0)}function Hse(){this.updatePlugin()}function Dse(t,e){e||this.updatePlugin()}function Wu(t,e,n){return e=Nse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nse(t){var e=Lse(t,"string");return typeof e=="symbol"?e:String(e)}function Lse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $se{constructor(e,n){Wu(this,"hot",void 0),Wu(this,"data",null),Wu(this,"plugin",void 0),Wu(this,"parentReference",new WeakMap),Wu(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&E(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&E(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ye(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(E(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(me(e[0],e[2],d=>{const g=this.translateTrimmedRow(d);i.push(this.getDataObject(g))}),me(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];E(r,o=>{i.push(this.getDataObject(o))}),E(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const kse=$se;function xA(t,e,n){return e=Fse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fse(t){var e=Wse(t,"string");return typeof e=="symbol"?e:String(e)}function Wse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vse{constructor(e,n){xA(this,"hot",void 0),xA(this,"plugin",void 0),this.hot=n,this.plugin=e}}const aR=Vse;class so extends aR{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(E(l,c=>{c&&s.removeChild(c)}),q(n,so.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",me(0,i-1,()=>{const d=c.createElement("SPAN");q(d,so.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ee(c,[Eo()]),q(n,so.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${so.CSS_CLASSES.button} ${so.CSS_CLASSES.expandButton}`),u&&Ee(n,[Ir(!1)])):(q(c,`${so.CSS_CLASSES.button} ${so.CSS_CLASSES.collapseButton}`),u&&Ee(n,[Ir(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const vN=so;class Bse extends aR{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),E(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{me(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&E(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];E(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return E(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);E(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return E(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);E(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&E(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];E(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];E(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];E(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{E(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{E(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&E(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Ie(e.target,vN.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Lr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Use=Bse;function Yse(t,e,n){Gse(t,e),e.set(t,n)}function Gse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zse(t,e,n){return e=jse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jse(t){var e=Kse(t,"string");return typeof e=="symbol"?e:String(e)}function Kse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xse(t,e){var n=qse(t,e,"get");return Zse(t,n)}function qse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zse(t,e){return e.get?e.get.call(t):e.value}var HA=new WeakMap;class Jse extends aR{constructor(){super(...arguments),zse(this,"dataManager",this.plugin.dataManager),Yse(this,HA,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(ky)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Fy)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,r=>{if(r===0)return E(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return me(0,e.items.length-1,n=>{const r=Xse(this,HA)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const Qse=Jse;function Pd(t,e,n){return e=eae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eae(t){var e=tae(t,"string");return typeof e=="symbol"?e:String(e)}function tae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nae{constructor(e){Pd(this,"plugin",void 0),Pd(this,"hot",void 0),Pd(this,"dataManager",void 0),Pd(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(p=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(C,a),C}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),g=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return vt(i)&&(gt(ht`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function vn(t,e){SN(t,e),e.add(t)}function DA(t,e,n){SN(t,e),e.set(t,n)}function SN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lw(t,e,n){return e=rae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rae(t){var e=iae(t,"string");return typeof e=="symbol"?e:String(e)}function iae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rf(t,e){var n=yN(t,e,"get");return oae(t,n)}function oae(t,e){return e.get?e.get.call(t):e.value}function tg(t,e,n){var r=yN(t,e,"set");return sae(t,r,n),n}function yN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function sae(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function fn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ng="nestedRows",aae=300,NA=ng,lae="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var om=new WeakMap,fl=new WeakMap,LA=new WeakSet,$A=new WeakSet,kA=new WeakSet,FA=new WeakSet,WA=new WeakSet,VA=new WeakSet,BA=new WeakSet,UA=new WeakSet,YA=new WeakSet,GA=new WeakSet,zA=new WeakSet,jA=new WeakSet,KA=new WeakSet,XA=new WeakSet,qA=new WeakSet,$w=new WeakSet;class uae extends it{constructor(){super(...arguments),vn(this,$w),vn(this,qA),vn(this,XA),vn(this,KA),vn(this,jA),vn(this,zA),vn(this,GA),vn(this,YA),vn(this,UA),vn(this,BA),vn(this,VA),vn(this,WA),vn(this,FA),vn(this,kA),vn(this,$A),vn(this,LA),Lw(this,"dataManager",null),Lw(this,"headersUI",null),Lw(this,"collapsedRowsMap",null),DA(this,om,{writable:!0,value:!1}),DA(this,fl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return ng}static get PLUGIN_PRIORITY(){return aae}isEnabled(){return!!this.hot.getSettings()[ng]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Xc),this.dataManager=new kse(this,this.hot),this.collapsingUI=new Use(this,this.hot),this.headersUI=new vN(this,this.hot),this.contextMenuUI=new Qse(this,this.hot),this.rowMoveController=new nae(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,XA,Rae).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,qA,Eae).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,kA,dae).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,FA,fae).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,WA,gae).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,$A,hae).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,UA,wae).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,BA,pae).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,YA,Cae).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,GA,vae).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,zA,Sae).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,jA,yae).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,VA,mae).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,KA,bae).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,LA,cae).call(e,...r)}),this.addHook("beforeLoadData",n=>fn(this,$w,ZA).call(this,n)),this.addHook("beforeUpdateData",n=>fn(this,$w,ZA).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:NA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(NA)}disableCoreAPIModifiers(){tg(this,fl,!0)}enableCoreAPIModifiers(){tg(this,fl,!1)}onModifyRowData(e){if(!rf(this,fl))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!rf(this,fl))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return rf(this,fl)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function cae(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function hae(t,e,n){this.collapsingUI.toggleState(t,e,n)}function dae(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),tg(this,om,!0),this.dataManager.getData().slice()}function fae(t){return this.contextMenuUI.appendOptions(t)}function gae(t,e){this.headersUI.appendLevelIndicators(t,e)}function mae(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function pae(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{tg(this,om,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function wae(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Cae(){this.collapsingUI.collapsedRowsStash.stash()}function vae(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Sae(){this.collapsingUI.collapsedRowsStash.stash()}function yae(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function bae(){this.dataManager.rewriteCache()}function Rae(){this.headersUI.updateRowHeaderWidth()}function Eae(t,e){rf(this,om)&&(e.skipRender=!0)}function ZA(t){if(!_x(t)){bS(lae),this.hot.getSettings()[ng]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function kw(t,e,n){return e=Tae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tae(t){var e=_ae(t,"string");return typeof e=="symbol"?e:String(e)}function _ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mae{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;kw(this,"rootWindow",void 0),kw(this,"prefix",void 0),kw(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){E(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Aae=Mae;function Oae(t,e,n){return e=Iae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Iae(t){var e=Pae(t,"string");return typeof e=="symbol"?e:String(e)}function Pae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}de.getSingleton().register("persistentStateSave");de.getSingleton().register("persistentStateLoad");de.getSingleton().register("persistentStateReset");const JA="persistentState",xae=0;class Hae extends it{constructor(){super(...arguments),Oae(this,"storage",void 0)}static get PLUGIN_KEY(){return JA}static get PLUGIN_PRIORITY(){return xae}isEnabled(){return!!this.hot.getSettings()[JA]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Aae(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Dae(t,e){Nae(t,e),e.add(t)}function Nae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fw(t,e,n){return e=Lae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lae(t){var e=$ae(t,"string");return typeof e=="symbol"?e:String(e)}function $ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QA(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ww="search",kae=190,Fae="htSearchResult",Wae=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Vae=function(t,e,n){return vt(t)||t===null||!t.toLocaleLowerCase||t.length===0||vt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Vw=new WeakSet;class Bae extends it{constructor(){super(...arguments),Dae(this,Vw),Fw(this,"callback",Wae),Fw(this,"queryMethod",Vae),Fw(this,"searchResultClass",Fae)}static get PLUGIN_KEY(){return Ww}static get PLUGIN_PRIORITY(){return kae}isEnabled(){return this.hot.getSettings()[Ww]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Ww];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return QA(e,Vw,eO).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return QA(e,Vw,eO).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return me(0,i-1,l=>{me(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,p=(h.search.queryMethod||r)(e,c,h);if(p){const C={row:l,col:u,data:c};s.push(C)}d&&d(a,l,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ve(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function eO(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Bw(t,e){Uae(t,e),e.add(t)}function Uae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xd(t,e,n){return e=Yae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yae(t){var e=Gae(t,"string");return typeof e=="symbol"?e:String(e)}function Gae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const zae="touchScroll",jae=200;var tO=new WeakSet,nO=new WeakSet,rO=new WeakSet;class Kae extends it{constructor(){super(...arguments),Bw(this,rO),Bw(this,nO),Bw(this,tO),xd(this,"scrollbars",[]),xd(this,"clones",[]),xd(this,"lockedCollection",!1),xd(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return zae}static get PLUGIN_PRIORITY(){return jae}static get SETTING_KEYS(){return!0}isEnabled(){return pS()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Uw(this,tO,Xae).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Uw(this,nO,qae).call(this)),this.addHook("afterMomentumScroll",()=>Uw(this,rO,Zae).call(this))}}function Xae(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function qae(){this.freezeOverlays=!0,E(this.clones,t=>{q(t,"hide-tween")})}function Zae(){this.freezeOverlays=!1,E(this.clones,t=>{Le(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{E(this.clones,t=>{Le(t,"show-tween")})},400),E(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Jae(t,e){Qae(t,e),e.add(t)}function Qae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ele(t,e,n){return e=tle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tle(t){var e=nle(t,"string");return typeof e=="symbol"?e:String(e)}function nle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rle(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const of="trimRows",ile=330;var iO=new WeakSet;class ole extends it{constructor(){super(...arguments),Jae(this,iO),ele(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return of}static get PLUGIN_PRIORITY(){return ile}isEnabled(){return!!this.hot.getSettings()[of]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Xc),this.trimmedRowsMap.addLocalHook("init",()=>rle(this,iO,sle).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[of];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),E(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(E(e,l=>{o[l]=!1}),i=Yt(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function sle(){const t=this.hot.getSettings()[of];Array.isArray(t)&&this.hot.batchExecution(()=>{E(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var bN={},ale=Ll,lle=bN,ule=ale("iterator"),cle=Array.prototype,hle=function(t){return t!==void 0&&(lle.Array===t||cle[ule]===t)},dle=BO,oO=yv,fle=pv,gle=bN,mle=Ll,ple=mle("iterator"),RN=function(t){if(!fle(t))return oO(t,ple)||oO(t,"@@iterator")||gle[dle(t)]},wle=pa,Cle=ag,vle=vs,Sle=sg,yle=RN,ble=TypeError,Rle=function(t,e){var n=arguments.length<2?yle(t):e;if(Cle(n))return vle(wle(n,t));throw new ble(Sle(t)+" is not iterable")},Ele=pa,sO=vs,Tle=yv,_le=function(t,e,n){var r,i;sO(t);try{if(r=Tle(t,"return"),!r){if(e==="throw")throw n;return n}r=Ele(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return sO(r),n},Mle=KO,Ale=pa,Ole=vs,Ile=sg,Ple=hle,xle=Nc,aO=wv,Hle=Rle,Dle=RN,lO=_le,Nle=TypeError,sf=function(t,e){this.stopped=t,this.result=e},uO=sf.prototype,Lle=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=Mle(e,r),u,c,h,d,g,p,C,S=function(R){return u&&lO(u,"normal",R),new sf(!0,R)},y=function(R){return i?(Ole(R),a?l(R[0],R[1],S):l(R[0],R[1])):a?l(R,S):l(R)};if(o)u=t.iterator;else if(s)u=t;else{if(c=Dle(t),!c)throw new Nle(Ile(t)+" is not iterable");if(Ple(c)){for(h=0,d=xle(t);d>h;h++)if(g=y(t[h]),g&&aO(uO,g))return g;return new sf(!1)}u=Hle(t,c)}for(p=o?t.next:u.next;!(C=Ale(p,u)).done;){try{g=y(C.value)}catch(R){lO(u,"throw",R)}if(typeof g=="object"&&g&&aO(uO,g))return g}return new sf(!1)},$le=Ev,kle=Cs,Fle=ig,Wle=function(t,e,n){var r=$le(e);r in t?kle.f(t,r,Fle(0,n)):t[r]=n},Vle=Ss,Ble=Lle,Ule=Wle;Vle({target:"Object",stat:!0},{fromEntries:function(e){var n={};return Ble(e,function(r,i){Ule(n,r,i)},{AS_ENTRIES:!0}),n}});const EN="undoRedo",Yle="undoRedo";function ce(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);E(l,c=>{c[1]=t.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new ce.ChangeAction(l,u)};e.done(a,i)}),t.addHook("afterCreateRow",(r,i,o)=>{e.done(()=>new ce.CreateRowAction(r,i),o)});const n=(r,i,o,s)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return me(o,s,c=>{me(r,i,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const g=Object.fromEntries(Object.entries(d).filter(p=>{let[C]=p;return a.includes(C)===!1}));u.push([d.visualRow,d.visualCol,g])}})}),u};t.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=t.toPhysicalRow(r),u=l+i-1,c=Tn(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new ce.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(l,u,0,t.countCols()-1))};e.done(a,s)}),t.addHook("afterCreateCol",(r,i,o)=>{e.done(()=>new ce.CreateColumnAction(r,i),o)}),t.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=u+i-1,h=[],d=[],g=[];me(l.length-1,S=>{const y=[],R=l[S];me(u,c,T=>{y.push(R[t.toPhysicalColumn(T)])}),h.push(y)}),me(i-1,S=>{g.push(t.toPhysicalColumn(u+S))}),Array.isArray(t.getSettings().colHeaders)&&me(i-1,S=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+S)]||null)});const p=t.columnIndexMapper.getIndexesSequence(),C=t.rowIndexMapper.getIndexesSequence();return new ce.RemoveColumnAction(u,g,h,d,p,C,t.getSettings().fixedColumnsStart,n(0,t.countRows(),u,c))};e.done(a,s)}),t.addHook("beforeCellAlignment",(r,i,o,s)=>{e.done(()=>new ce.CellAlignmentAction(r,i,o,s))}),t.addHook("beforeFilter",r=>{e.done(()=>new ce.FiltersAction(r))}),t.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new ce.RowMoveAction(r,i))}),t.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new ce.MergeCellsAction(t,r))}),t.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new ce.UnmergeCellsAction(t,r))}),t.addHook("afterInit",()=>{e.init()})}ce.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};ce.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Tn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};ce.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Tn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};ce.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ce.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ce.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ce.prototype.isEnabled=function(){return this.enabled};ce.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,jle(t),this.registerShortcuts(),t.addHook("afterChange",TN)};ce.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,Kle(t),this.unregisterShortcuts(),t.removeHook("afterChange",TN)};ce.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ce.Action=function(){};ce.Action.prototype.undo=function(){};ce.Action.prototype.redo=function(){};ce.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};To(ce.ChangeAction,ce.Action);ce.ChangeAction.prototype.undo=function(t,e){const n=Tn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,a=n.length;s<a;s++){const[l,u]=n[s];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const o=t.getSelectedLast();if(o!==void 0){const[s,a]=n[0],[l,u]=o,c=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),d=s>=c,g=a>=h;if((d&&g)===!1&&(l!==s||u!==a)===!0){const S={row:s,col:a};d===!1&&(S.verticalSnap="top"),g===!1&&(S.horizontalSnap="start"),t.scrollViewportTo(S)}}t.selectCells(this.selected,!1,!1)};ce.ChangeAction.prototype.redo=function(t,e){const n=Tn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};ce.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};To(ce.CreateRowAction,ce.Action);ce.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ce.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ce.RemoveRowAction=function(t,e,n,r,i,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=o};To(ce.RemoveRowAction,ce.Action);ce.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[o,s,a]=i;t.setCellMetaObject(o,s,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ce.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ce.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};To(ce.CreateColumnAction,ce.Action);ce.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ce.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ce.RemoveColumnAction=function(t,e,n,r,i,o,s,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a};To(ce.RemoveColumnAction,ce.Action);ce.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ue(this.data[u],i));const a=Ue(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),E(t.getSourceDataArray(),(u,c)=>{E(r,(h,d)=>{u[h]=s[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&E(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};ce.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ce.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};ce.CellAlignmentAction.prototype.undo=function(t,e){E(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};ce.CellAlignmentAction.prototype.redo=function(t,e){Yo(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};ce.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};To(ce.FiltersAction,ce.Action);ce.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};ce.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class Gle extends ce.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}ce.MergeCellsAction=Gle;class zle extends ce.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}ce.UnmergeCellsAction=zle;ce.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};To(ce.RowMoveAction,ce.Action);ce.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ce.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ce.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ce.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:EN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ce.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(EN)};function TN(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function jle(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Kle(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const rh=de.getSingleton();rh.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});rh.register("beforeUndo");rh.register("afterUndo");rh.register("beforeRedo");rh.register("afterRedo");ce.PLUGIN_KEY=Yle;ce.SETTING_KEYS=!0;function Xle(){tt(tc),tt(Y7),tt(nc),tt(yX),tt(IX),tt(DH),tt(yq),tt(sZ),tt(em),tt(IJ),tt(tQ),tt(uQ),tt(nm),tt(LQ),tt(Yte),tt(Tne),tt(Jne),tt(cre),tt(Rre),tt(kre),tt(Xre),tt(wie),tt(Mie),tt(noe),tt(xoe),tt($oe),tt(wse),tt(uae),tt(Hae),tt(Bae),tt(Kae),tt(ole),tt(ce)}function qle(){g8(),x8(),V8(),a7(),Xle()}function Zle(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var Yw,Gw,zw,jw,Kw;qle();Zle(_e);_e.__GhostTable=Ub;_e._getListenersCounter=sz;_e._getRegisteredMapsCounter=D4;_e.EventManager=xr;const Jle=[HY,VG,S4,D8,kG,yG,$Y,bz,$G,FY,YG,yz],Qle=[wG,GG];_e.helper={};_e.dom={};E(Jle,t=>{E(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(_e.helper[e]=t[e])})});E(Qle,t=>{E(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(_e.dom[e]=t[e])})});_e.cellTypes=(Yw=_e.cellTypes)!==null&&Yw!==void 0?Yw:{};E(e9(),t=>{_e.cellTypes[t]=Eb(t)});_e.cellTypes.registerCellType=br;_e.cellTypes.getCellType=Eb;_e.editors=(Gw=_e.editors)!==null&&Gw!==void 0?Gw:{};E(QG(),t=>{_e.editors[`${En(t)}Editor`]=yf(t)});_e.editors.registerEditor=Qn;_e.editors.getEditor=yf;_e.renderers=(zw=_e.renderers)!==null&&zw!==void 0?zw:{};E($z(),t=>{const e=Ef(t);t==="base"&&(_e.renderers.cellDecorator=e),_e.renderers[`${En(t)}Renderer`]=e});_e.renderers.registerRenderer=lr;_e.renderers.getRenderer=Ef;_e.validators=(jw=_e.validators)!==null&&jw!==void 0?jw:{};E(Wz(),t=>{_e.validators[`${En(t)}Validator`]=MS(t)});_e.validators.registerValidator=ta;_e.validators.getValidator=MS;_e.plugins=(Kw=_e.plugins)!==null&&Kw!==void 0?Kw:{};E(_S(),t=>{_e.plugins[t]=Gc(t)});_e.plugins[`${En(it.PLUGIN_KEY)}Plugin`]=it;_e.plugins.registerPlugin=tt;_e.plugins.getPlugin=Gc;const eue=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],cO="odd",hO=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]),tue=(t,e,n,r,i,o)=>{if(n!==0)return;const s=t.parentElement;s!==null&&(e%2===0?_e.dom.addClass(s,cO):_e.dom.removeClass(s,cO))};function nue(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(hO.has(t.toString())?(_e.dom.removeClass(e.firstChild,n),_e.dom.addClass(e.firstChild,hO.get(t.toString()))):_e.dom.addClass(e.firstChild,n))}const dO=document.getElementById("example1");dO?(new _e(dO,{data:eue,height:450,colWidths:[170,222,130,120,120,130,156],colHeaders:["Company name","Name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:5,type:"text"},{data:2,type:"text"}],autoWrapRow:!0,dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,afterGetColHeader:nue,beforeRenderer:tue,licenseKey:"non-commercial-and-evaluation"}),console.log(`Handsontable: v${_e.version} (${_e.buildDate})`)):console.error("Element with ID 'example1' not found.")});export default rue();
