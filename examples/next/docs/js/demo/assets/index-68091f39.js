var GN=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var mue=GN((Pue,gf)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var dh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ql=function(t){return t&&t.Math===Math&&t},Mn=ql(typeof globalThis=="object"&&globalThis)||ql(typeof window=="object"&&window)||ql(typeof self=="object"&&self)||ql(typeof dh=="object"&&dh)||ql(typeof dh=="object"&&dh)||function(){return this}()||Function("return this")(),HS={},Hr=function(t){try{return!!t()}catch{return!0}},jN=Hr,Ni=!jN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),KN=Hr,ug=!KN(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),XN=ug,fh=Function.prototype.call,pa=XN?fh.bind(fh):function(){return fh.apply(fh,arguments)},pO={},wO={}.propertyIsEnumerable,CO=Object.getOwnPropertyDescriptor,qN=CO&&!wO.call({1:2},1);pO.f=qN?function(e){var n=CO(this,e);return!!n&&n.enumerable}:wO;var cg=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},vO=ug,SO=Function.prototype,fv=SO.call,ZN=vO&&SO.bind.bind(fv,fv),Yn=vO?ZN:function(t){return function(){return fv.apply(t,arguments)}},yO=Yn,JN=yO({}.toString),QN=yO("".slice),Ll=function(t){return QN(JN(t),8,-1)},eL=Yn,tL=Hr,nL=Ll,Mp=Object,rL=eL("".split),iL=tL(function(){return!Mp("z").propertyIsEnumerable(0)})?function(t){return nL(t)==="String"?rL(t,""):Mp(t)}:Mp,DS=function(t){return t==null},oL=DS,sL=TypeError,bO=function(t){if(oL(t))throw new sL("Can't call method on "+t);return t},aL=iL,lL=bO,hg=function(t){return aL(lL(t))},Ap=typeof document=="object"&&document.all,An=typeof Ap>"u"&&Ap!==void 0?function(t){return typeof t=="function"||t===Ap}:function(t){return typeof t=="function"},uL=An,ws=function(t){return typeof t=="object"?t!==null:uL(t)},Op=Mn,cL=An,hL=function(t){return cL(t)?t:void 0},Nc=function(t,e){return arguments.length<2?hL(Op[t]):Op[t]&&Op[t][e]},dL=Yn,NS=dL({}.isPrototypeOf),LS=typeof navigator<"u"&&String(navigator.userAgent)||"",RO=Mn,Ip=LS,vR=RO.process,SR=RO.Deno,yR=vR&&vR.versions||SR&&SR.version,bR=yR&&yR.v8,Jr,mf;bR&&(Jr=bR.split("."),mf=Jr[0]>0&&Jr[0]<4?1:+(Jr[0]+Jr[1]));!mf&&Ip&&(Jr=Ip.match(/Edge\/(\d+)/),(!Jr||Jr[1]>=74)&&(Jr=Ip.match(/Chrome\/(\d+)/),Jr&&(mf=+Jr[1])));var fL=mf,RR=fL,gL=Hr,mL=Mn,pL=mL.String,$S=!!Object.getOwnPropertySymbols&&!gL(function(){var t=Symbol("symbol detection");return!pL(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&RR&&RR<41}),wL=$S,EO=wL&&!Symbol.sham&&typeof Symbol.iterator=="symbol",CL=Nc,vL=An,SL=NS,yL=EO,bL=Object,kS=yL?function(t){return typeof t=="symbol"}:function(t){var e=CL("Symbol");return vL(e)&&SL(e.prototype,bL(t))},RL=String,dg=function(t){try{return RL(t)}catch{return"Object"}},EL=An,TL=dg,_L=TypeError,fg=function(t){if(EL(t))return t;throw new _L(TL(t)+" is not a function")},ML=fg,AL=DS,FS=function(t,e){var n=t[e];return AL(n)?void 0:ML(n)},Pp=pa,xp=An,Hp=ws,OL=TypeError,IL=function(t,e){var n,r;if(e==="string"&&xp(n=t.toString)&&!Hp(r=Pp(n,t))||xp(n=t.valueOf)&&!Hp(r=Pp(n,t))||e!=="string"&&xp(n=t.toString)&&!Hp(r=Pp(n,t)))return r;throw new OL("Can't convert object to primitive value")},TO={exports:{}},ER=Mn,PL=Object.defineProperty,WS=function(t,e){try{PL(ER,t,{value:e,configurable:!0,writable:!0})}catch{ER[t]=e}return e},xL=Mn,HL=WS,TR="__core-js_shared__",DL=xL[TR]||HL(TR,{}),VS=DL,_R=VS;(TO.exports=function(t,e){return _R[t]||(_R[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.35.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.0/LICENSE",source:"https://github.com/zloirock/core-js"});var _O=TO.exports,NL=bO,LL=Object,gg=function(t){return LL(NL(t))},$L=Yn,kL=gg,FL=$L({}.hasOwnProperty),yo=Object.hasOwn||function(e,n){return FL(kL(e),n)},WL=Yn,VL=0,BL=Math.random(),UL=WL(1 .toString),MO=function(t){return"Symbol("+(t===void 0?"":t)+")_"+UL(++VL+BL,36)},YL=Mn,GL=_O,MR=yo,zL=MO,jL=$S,KL=EO,Cl=YL.Symbol,Dp=GL("wks"),XL=KL?Cl.for||Cl:Cl&&Cl.withoutSetter||zL,$l=function(t){return MR(Dp,t)||(Dp[t]=jL&&MR(Cl,t)?Cl[t]:XL("Symbol."+t)),Dp[t]},qL=pa,AR=ws,OR=kS,ZL=FS,JL=IL,QL=$l,e$=TypeError,t$=QL("toPrimitive"),n$=function(t,e){if(!AR(t)||OR(t))return t;var n=ZL(t,t$),r;if(n){if(e===void 0&&(e="default"),r=qL(n,t,e),!AR(r)||OR(r))return r;throw new e$("Can't convert object to primitive value")}return e===void 0&&(e="number"),JL(t,e)},r$=n$,i$=kS,BS=function(t){var e=r$(t,"string");return i$(e)?e:e+""},o$=Mn,IR=ws,gv=o$.document,s$=IR(gv)&&IR(gv.createElement),US=function(t){return s$?gv.createElement(t):{}},a$=Ni,l$=Hr,u$=US,AO=!a$&&!l$(function(){return Object.defineProperty(u$("div"),"a",{get:function(){return 7}}).a!==7}),c$=Ni,h$=pa,d$=pO,f$=cg,g$=hg,m$=BS,p$=yo,w$=AO,PR=Object.getOwnPropertyDescriptor;HS.f=c$?PR:function(e,n){if(e=g$(e),n=m$(n),w$)try{return PR(e,n)}catch{}if(p$(e,n))return f$(!h$(d$.f,e,n),e[n])};var Cs={},C$=Ni,v$=Hr,OO=C$&&v$(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),S$=ws,y$=String,b$=TypeError,vs=function(t){if(S$(t))return t;throw new b$(y$(t)+" is not an object")},R$=Ni,E$=AO,T$=OO,gh=vs,xR=BS,_$=TypeError,Np=Object.defineProperty,M$=Object.getOwnPropertyDescriptor,Lp="enumerable",$p="configurable",kp="writable";Cs.f=R$?T$?function(e,n,r){if(gh(e),n=xR(n),gh(r),typeof e=="function"&&n==="prototype"&&"value"in r&&kp in r&&!r[kp]){var i=M$(e,n);i&&i[kp]&&(e[n]=r.value,r={configurable:$p in r?r[$p]:i[$p],enumerable:Lp in r?r[Lp]:i[Lp],writable:!1})}return Np(e,n,r)}:Np:function(e,n,r){if(gh(e),n=xR(n),gh(r),E$)try{return Np(e,n,r)}catch{}if("get"in r||"set"in r)throw new _$("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var A$=Ni,O$=Cs,I$=cg,Lc=A$?function(t,e,n){return O$.f(t,e,I$(1,n))}:function(t,e,n){return t[e]=n,t},IO={exports:{}},mv=Ni,P$=yo,PO=Function.prototype,x$=mv&&Object.getOwnPropertyDescriptor,YS=P$(PO,"name"),H$=YS&&(function(){}).name==="something",D$=YS&&(!mv||mv&&x$(PO,"name").configurable),N$={EXISTS:YS,PROPER:H$,CONFIGURABLE:D$},L$=Yn,$$=An,pv=VS,k$=L$(Function.toString);$$(pv.inspectSource)||(pv.inspectSource=function(t){return k$(t)});var F$=pv.inspectSource,W$=Mn,V$=An,HR=W$.WeakMap,B$=V$(HR)&&/native code/.test(String(HR)),U$=_O,Y$=MO,DR=U$("keys"),xO=function(t){return DR[t]||(DR[t]=Y$(t))},GS={},G$=B$,HO=Mn,z$=ws,j$=Lc,Fp=yo,Wp=VS,K$=xO,X$=GS,NR="Object already initialized",wv=HO.TypeError,q$=HO.WeakMap,pf,pc,wf,Z$=function(t){return wf(t)?pc(t):pf(t,{})},J$=function(t){return function(e){var n;if(!z$(e)||(n=pc(e)).type!==t)throw new wv("Incompatible receiver, "+t+" required");return n}};if(G$||Wp.state){var li=Wp.state||(Wp.state=new q$);li.get=li.get,li.has=li.has,li.set=li.set,pf=function(t,e){if(li.has(t))throw new wv(NR);return e.facade=t,li.set(t,e),e},pc=function(t){return li.get(t)||{}},wf=function(t){return li.has(t)}}else{var Ea=K$("state");X$[Ea]=!0,pf=function(t,e){if(Fp(t,Ea))throw new wv(NR);return e.facade=t,j$(t,Ea,e),e},pc=function(t){return Fp(t,Ea)?t[Ea]:{}},wf=function(t){return Fp(t,Ea)}}var Q$={set:pf,get:pc,has:wf,enforce:Z$,getterFor:J$},zS=Yn,ek=Hr,tk=An,mh=yo,Cv=Ni,nk=N$.CONFIGURABLE,rk=F$,DO=Q$,ik=DO.enforce,ok=DO.get,LR=String,Fd=Object.defineProperty,sk=zS("".slice),ak=zS("".replace),lk=zS([].join),uk=Cv&&!ek(function(){return Fd(function(){},"length",{value:8}).length!==8}),ck=String(String).split("String"),hk=IO.exports=function(t,e,n){sk(LR(e),0,7)==="Symbol("&&(e="["+ak(LR(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!mh(t,"name")||nk&&t.name!==e)&&(Cv?Fd(t,"name",{value:e,configurable:!0}):t.name=e),uk&&n&&mh(n,"arity")&&t.length!==n.arity&&Fd(t,"length",{value:n.arity});try{n&&mh(n,"constructor")&&n.constructor?Cv&&Fd(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=ik(t);return mh(r,"source")||(r.source=lk(ck,typeof e=="string"?e:"")),t};Function.prototype.toString=hk(function(){return tk(this)&&ok(this).source||rk(this)},"toString");var dk=IO.exports,fk=An,gk=Cs,mk=dk,pk=WS,wk=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(fk(n)&&mk(n,o,r),r.global)i?t[e]=n:pk(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:gk.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},NO={},Ck=Math.ceil,vk=Math.floor,Sk=Math.trunc||function(e){var n=+e;return(n>0?vk:Ck)(n)},yk=Sk,jS=function(t){var e=+t;return e!==e||e===0?0:yk(e)},bk=jS,Rk=Math.max,Ek=Math.min,Tk=function(t,e){var n=bk(t);return n<0?Rk(n+e,0):Ek(n,e)},_k=jS,Mk=Math.min,Ak=function(t){return t>0?Mk(_k(t),9007199254740991):0},Ok=Ak,$c=function(t){return Ok(t.length)},Ik=hg,Pk=Tk,xk=$c,$R=function(t){return function(e,n,r){var i=Ik(e),o=xk(i),s=Pk(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Hk={includes:$R(!0),indexOf:$R(!1)},Dk=Yn,Vp=yo,Nk=hg,Lk=Hk.indexOf,$k=GS,kR=Dk([].push),LO=function(t,e){var n=Nk(t),r=0,i=[],o;for(o in n)!Vp($k,o)&&Vp(n,o)&&kR(i,o);for(;e.length>r;)Vp(n,o=e[r++])&&(~Lk(i,o)||kR(i,o));return i},KS=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],kk=LO,Fk=KS,Wk=Fk.concat("length","prototype");NO.f=Object.getOwnPropertyNames||function(e){return kk(e,Wk)};var $O={};$O.f=Object.getOwnPropertySymbols;var Vk=Nc,Bk=Yn,Uk=NO,Yk=$O,Gk=vs,zk=Bk([].concat),jk=Vk("Reflect","ownKeys")||function(e){var n=Uk.f(Gk(e)),r=Yk.f;return r?zk(n,r(e)):n},FR=yo,Kk=jk,Xk=HS,qk=Cs,kO=function(t,e,n){for(var r=Kk(e),i=qk.f,o=Xk.f,s=0;s<r.length;s++){var a=r[s];!FR(t,a)&&!(n&&FR(n,a))&&i(t,a,o(e,a))}},Zk=Hr,Jk=An,Qk=/#|\.prototype\./,kc=function(t,e){var n=tF[eF(t)];return n===rF?!0:n===nF?!1:Jk(e)?Zk(e):!!e},eF=kc.normalize=function(t){return String(t).replace(Qk,".").toLowerCase()},tF=kc.data={},nF=kc.NATIVE="N",rF=kc.POLYFILL="P",iF=kc,Bp=Mn,oF=HS.f,sF=Lc,aF=wk,lF=WS,uF=kO,cF=iF,Ss=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Bp:i?s=Bp[n]||lF(n,{}):s=(Bp[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=oF(s,a),l=c&&c.value):l=s[a],o=cF(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;uF(u,l)}(t.sham||l&&l.sham)&&sF(u,"sham",!0),aF(s,a,u,t)}},hF=Ll,FO=Array.isArray||function(e){return hF(e)==="Array"},dF=Ni,fF=FO,gF=TypeError,mF=Object.getOwnPropertyDescriptor,pF=dF&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),WO=pF?function(t,e){if(fF(t)&&!mF(t,"length").writable)throw new gF("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},wF=TypeError,CF=9007199254740991,VO=function(t){if(t>CF)throw wF("Maximum allowed index exceeded");return t},vF=Ss,SF=gg,yF=$c,bF=WO,RF=VO,EF=Hr,TF=EF(function(){return[].push.call({length:4294967296},1)!==4294967297}),_F=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},MF=TF||!_F();vF({target:"Array",proto:!0,arity:1,forced:MF},{push:function(e){var n=SF(this),r=yF(n),i=arguments.length;RF(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return bF(n,r),r}});var AF=ug,BO=Function.prototype,WR=BO.apply,VR=BO.call,mg=typeof Reflect=="object"&&Reflect.apply||(AF?VR.bind(WR):function(){return VR.apply(WR,arguments)}),OF=Yn,IF=fg,PF=function(t,e,n){try{return OF(IF(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},xF=ws,HF=function(t){return xF(t)||t===null},DF=HF,NF=String,LF=TypeError,$F=function(t){if(DF(t))return t;throw new LF("Can't set "+NF(t)+" as a prototype")},kF=PF,FF=vs,WF=$F,UO=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=kF(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return FF(i),WF(o),t?n(i,o):i.__proto__=o,i}}():void 0),VF=Cs.f,BF=function(t,e,n){n in t||VF(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},UF=An,YF=ws,BR=UO,GF=function(t,e,n){var r,i;return BR&&UF(r=e.constructor)&&r!==n&&YF(i=r.prototype)&&i!==n.prototype&&BR(t,i),t},zF=$l,jF=zF("toStringTag"),YO={};YO[jF]="z";var KF=String(YO)==="[object z]",XF=KF,qF=An,Wd=Ll,ZF=$l,JF=ZF("toStringTag"),QF=Object,eW=Wd(function(){return arguments}())==="Arguments",tW=function(t,e){try{return t[e]}catch{}},GO=XF?Wd:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=tW(e=QF(t),JF))=="string"?n:eW?Wd(e):(r=Wd(e))==="Object"&&qF(e.callee)?"Arguments":r},nW=GO,rW=String,zO=function(t){if(nW(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return rW(t)},iW=zO,oW=function(t,e){return t===void 0?arguments.length<2?"":e:iW(t)},sW=ws,aW=Lc,lW=function(t,e){sW(e)&&"cause"in e&&aW(t,"cause",e.cause)},uW=Yn,jO=Error,cW=uW("".replace),hW=function(t){return String(new jO(t).stack)}("zxcasd"),KO=/\n\s*at [^:]*:[^\n]*/,dW=KO.test(hW),fW=function(t,e){if(dW&&typeof t=="string"&&!jO.prepareStackTrace)for(;e--;)t=cW(t,KO,"");return t},gW=Hr,mW=cg,pW=!gW(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",mW(1,7)),t.stack!==7):!0}),wW=Lc,CW=fW,vW=pW,UR=Error.captureStackTrace,SW=function(t,e,n,r){vW&&(UR?UR(t,e):wW(t,"stack",CW(n,r)))},YR=Nc,yW=yo,GR=Lc,bW=NS,zR=UO,jR=kO,KR=BF,RW=GF,EW=oW,TW=lW,_W=SW,MW=Ni,AW=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=YR.apply(null,s);if(l){var u=l.prototype;if(yW(u,"cause")&&delete u.cause,!n)return l;var c=YR("Error"),h=e(function(d,g){var p=EW(r?g:d,void 0),C=r?new l(d):new l;return p!==void 0&&GR(C,"message",p),_W(C,h,C.stack,2),this&&bW(u,this)&&RW(C,this,h),arguments.length>o&&TW(C,arguments[o]),C});h.prototype=u,a!=="Error"?zR?zR(h,c):jR(h,c,{name:!0}):MW&&i in l&&(KR(h,l,i),KR(h,l,"prepareStackTrace")),jR(h,l);try{u.name!==a&&GR(u,"name",a),u.constructor=h}catch{}return h}},XO=Ss,OW=Mn,Li=mg,qO=AW,vv="WebAssembly",XR=OW[vv],Cf=new Error("e",{cause:7}).cause!==7,wa=function(t,e){var n={};n[t]=qO(t,e,Cf),XO({global:!0,constructor:!0,arity:1,forced:Cf},n)},XS=function(t,e){if(XR&&XR[t]){var n={};n[t]=qO(vv+"."+t,e,Cf),XO({target:vv,stat:!0,constructor:!0,arity:1,forced:Cf},n)}};wa("Error",function(t){return function(n){return Li(t,this,arguments)}});wa("EvalError",function(t){return function(n){return Li(t,this,arguments)}});wa("RangeError",function(t){return function(n){return Li(t,this,arguments)}});wa("ReferenceError",function(t){return function(n){return Li(t,this,arguments)}});wa("SyntaxError",function(t){return function(n){return Li(t,this,arguments)}});wa("TypeError",function(t){return function(n){return Li(t,this,arguments)}});wa("URIError",function(t){return function(n){return Li(t,this,arguments)}});XS("CompileError",function(t){return function(n){return Li(t,this,arguments)}});XS("LinkError",function(t){return function(n){return Li(t,this,arguments)}});XS("RuntimeError",function(t){return function(n){return Li(t,this,arguments)}});var IW=Ll,PW=Yn,xW=function(t){if(IW(t)==="Function")return PW(t)},qR=xW,HW=fg,DW=ug,NW=qR(qR.bind),ZO=function(t,e){return HW(t),e===void 0?t:DW?NW(t,e):function(){return t.apply(e,arguments)}},LW=Nc,JO=LW("document","documentElement"),$W=Yn,qS=$W([].slice),kW=TypeError,QO=function(t,e){if(t<e)throw new kW("Not enough arguments");return t},FW=LS,WW=/(?:ipad|iphone|ipod).*applewebkit/i.test(FW),VW=Mn,BW=Ll,UW=BW(VW.process)==="process",pr=Mn,YW=mg,GW=ZO,ZR=An,zW=yo,eI=Hr,JR=JO,jW=qS,QR=US,KW=QO,XW=WW,qW=UW,Sv=pr.setImmediate,yv=pr.clearImmediate,ZW=pr.process,Up=pr.Dispatch,JW=pr.Function,e0=pr.MessageChannel,QW=pr.String,Yp=0,Ku={},t0="onreadystatechange",wc,Rs,Gp,zp;eI(function(){wc=pr.location});var ZS=function(t){if(zW(Ku,t)){var e=Ku[t];delete Ku[t],e()}},jp=function(t){return function(){ZS(t)}},n0=function(t){ZS(t.data)},r0=function(t){pr.postMessage(QW(t),wc.protocol+"//"+wc.host)};(!Sv||!yv)&&(Sv=function(e){KW(arguments.length,1);var n=ZR(e)?e:JW(e),r=jW(arguments,1);return Ku[++Yp]=function(){YW(n,void 0,r)},Rs(Yp),Yp},yv=function(e){delete Ku[e]},qW?Rs=function(t){ZW.nextTick(jp(t))}:Up&&Up.now?Rs=function(t){Up.now(jp(t))}:e0&&!XW?(Gp=new e0,zp=Gp.port2,Gp.port1.onmessage=n0,Rs=GW(zp.postMessage,zp)):pr.addEventListener&&ZR(pr.postMessage)&&!pr.importScripts&&wc&&wc.protocol!=="file:"&&!eI(r0)?(Rs=r0,pr.addEventListener("message",n0,!1)):t0 in QR("script")?Rs=function(t){JR.appendChild(QR("script"))[t0]=function(){JR.removeChild(this),ZS(t)}}:Rs=function(t){setTimeout(jp(t),0)});var tI={set:Sv,clear:yv},eV=Ss,tV=Mn,i0=tI.clear;eV({global:!0,bind:!0,enumerable:!0,forced:tV.clearImmediate!==i0},{clearImmediate:i0});var nV=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",nI=Mn,rV=mg,iV=An,oV=nV,sV=LS,aV=qS,lV=QO,uV=nI.Function,cV=/MSIE .\./.test(sV)||oV&&function(){var t=nI.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),hV=function(t,e){var n=e?2:1;return cV?function(r,i){var o=lV(arguments.length,1)>n,s=iV(r)?r:uV(r),a=o?aV(arguments,n):[],l=o?function(){rV(s,this,a)}:s;return e?t(l,i):t(l)}:t},dV=Ss,rI=Mn,o0=tI.set,fV=hV,s0=rI.setImmediate?fV(o0,!1):o0;dV({global:!0,bind:!0,enumerable:!0,forced:rI.setImmediate!==s0},{setImmediate:s0});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function jo(t){"@babel/helpers - typeof";return jo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jo(t)}function bv(t,e){return bv=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},bv(t,e)}function gV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vd(t,e,n){return gV()?Vd=Reflect.construct:Vd=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&bv(u,s.prototype),u},Vd.apply(null,arguments)}function jr(t){return mV(t)||pV(t)||wV(t)||CV()}function mV(t){if(Array.isArray(t))return Rv(t)}function pV(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function wV(t,e){if(t){if(typeof t=="string")return Rv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rv(t,e)}}function Rv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function CV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var vV=Object.hasOwnProperty,a0=Object.setPrototypeOf,SV=Object.isFrozen,yV=Object.getPrototypeOf,bV=Object.getOwnPropertyDescriptor,Un=Object.freeze,ni=Object.seal,RV=Object.create,iI=typeof Reflect<"u"&&Reflect,vf=iI.apply,Ev=iI.construct;vf||(vf=function(e,n,r){return e.apply(n,r)});Un||(Un=function(e){return e});ni||(ni=function(e){return e});Ev||(Ev=function(e,n){return Vd(e,jr(n))});var EV=Pr(Array.prototype.forEach),l0=Pr(Array.prototype.pop),Zl=Pr(Array.prototype.push),Bd=Pr(String.prototype.toLowerCase),Kp=Pr(String.prototype.toString),TV=Pr(String.prototype.match),$r=Pr(String.prototype.replace),_V=Pr(String.prototype.indexOf),MV=Pr(String.prototype.trim),xn=Pr(RegExp.prototype.test),Xp=AV(TypeError);function Pr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return vf(t,e,r)}}function AV(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return Ev(t,n)}}function Ke(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Bd,a0&&a0(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(SV(e)||(e[i]=s),o=s)}t[o]=!0}return t}function Es(t){var e=RV(null),n;for(n in t)vf(vV,t,[n])===!0&&(e[n]=t[n]);return e}function ph(t,e){for(;t!==null;){var n=bV(t,e);if(n){if(n.get)return Pr(n.get);if(typeof n.value=="function")return Pr(n.value)}t=yV(t)}function r(i){return console.warn("fallback value for",i),null}return r}var u0=Un(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),qp=Un(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Zp=Un(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),OV=Un(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Jp=Un(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),IV=Un(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),c0=Un(["#text"]),h0=Un(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Qp=Un(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),d0=Un(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),wh=Un(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),PV=ni(/\{\{[\w\W]*|[\w\W]*\}\}/gm),xV=ni(/<%[\w\W]*|[\w\W]*%>/gm),HV=ni(/\${[\w\W]*}/gm),DV=ni(/^data-[\-\w.\u00B7-\uFFFF]/),NV=ni(/^aria-[\-\w]+$/),LV=ni(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$V=ni(/^(?:\w+script|data):/i),kV=ni(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),FV=ni(/^html$/i),WV=function(){return typeof window>"u"?null:window},VV=function(e,n){if(jo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function oI(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:WV(),e=function(x){return oI(x)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,d=t.DOMParser,g=t.trustedTypes,p=a.prototype,C=ph(p,"cloneNode"),S=ph(p,"nextSibling"),y=ph(p,"childNodes"),R=ph(p,"parentNode");if(typeof o=="function"){var T=r.createElement("template");T.content&&T.content.ownerDocument&&(r=T.content.ownerDocument)}var N=VV(g,n),I=N?N.createHTML(""):"",F=r,B=F.implementation,ee=F.createNodeIterator,U=F.createDocumentFragment,j=F.getElementsByTagName,re=n.importNode,ie={};try{ie=Es(r).documentMode?r.documentMode:{}}catch{}var oe={};e.isSupported=typeof R=="function"&&B&&B.createHTMLDocument!==void 0&&ie!==9;var Ce=PV,Me=xV,rt=HV,We=DV,pe=NV,f=$V,m=kV,w=LV,A=null,O=Ke({},[].concat(jr(u0),jr(qp),jr(Zp),jr(Jp),jr(c0))),D=null,z=Ke({},[].concat(jr(h0),jr(Qp),jr(d0),jr(wh))),G=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ne=null,Z=null,K=!0,Se=!0,Pe=!1,Oe=!0,He=!1,Y=!1,lt=!1,Ue=!1,xe=!1,De=!1,be=!1,v=!0,b=!1,_="user-content-",k=!0,M=!1,$={},P=null,H=Ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),W=null,L=Ke({},["audio","video","img","source","image","track"]),V=null,te=Ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),he="http://www.w3.org/1998/Math/MathML",ye="http://www.w3.org/2000/svg",Ae="http://www.w3.org/1999/xhtml",Ve=Ae,St=!1,Ze=null,ct=Ke({},[he,ye,Ae],Kp),_t,Ra=["application/xhtml+xml","text/html"],Kl="text/html",Bt,cn=null,bs=r.createElement("form"),Pn=function(x){return x instanceof RegExp||x instanceof Function},Jt=function(x){cn&&cn===x||((!x||jo(x)!=="object")&&(x={}),x=Es(x),_t=Ra.indexOf(x.PARSER_MEDIA_TYPE)===-1?_t=Kl:_t=x.PARSER_MEDIA_TYPE,Bt=_t==="application/xhtml+xml"?Kp:Bd,A="ALLOWED_TAGS"in x?Ke({},x.ALLOWED_TAGS,Bt):O,D="ALLOWED_ATTR"in x?Ke({},x.ALLOWED_ATTR,Bt):z,Ze="ALLOWED_NAMESPACES"in x?Ke({},x.ALLOWED_NAMESPACES,Kp):ct,V="ADD_URI_SAFE_ATTR"in x?Ke(Es(te),x.ADD_URI_SAFE_ATTR,Bt):te,W="ADD_DATA_URI_TAGS"in x?Ke(Es(L),x.ADD_DATA_URI_TAGS,Bt):L,P="FORBID_CONTENTS"in x?Ke({},x.FORBID_CONTENTS,Bt):H,ne="FORBID_TAGS"in x?Ke({},x.FORBID_TAGS,Bt):{},Z="FORBID_ATTR"in x?Ke({},x.FORBID_ATTR,Bt):{},$="USE_PROFILES"in x?x.USE_PROFILES:!1,K=x.ALLOW_ARIA_ATTR!==!1,Se=x.ALLOW_DATA_ATTR!==!1,Pe=x.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=x.ALLOW_SELF_CLOSE_IN_ATTR!==!1,He=x.SAFE_FOR_TEMPLATES||!1,Y=x.WHOLE_DOCUMENT||!1,xe=x.RETURN_DOM||!1,De=x.RETURN_DOM_FRAGMENT||!1,be=x.RETURN_TRUSTED_TYPE||!1,Ue=x.FORCE_BODY||!1,v=x.SANITIZE_DOM!==!1,b=x.SANITIZE_NAMED_PROPS||!1,k=x.KEEP_CONTENT!==!1,M=x.IN_PLACE||!1,w=x.ALLOWED_URI_REGEXP||w,Ve=x.NAMESPACE||Ae,G=x.CUSTOM_ELEMENT_HANDLING||{},x.CUSTOM_ELEMENT_HANDLING&&Pn(x.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(G.tagNameCheck=x.CUSTOM_ELEMENT_HANDLING.tagNameCheck),x.CUSTOM_ELEMENT_HANDLING&&Pn(x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(G.attributeNameCheck=x.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),x.CUSTOM_ELEMENT_HANDLING&&typeof x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(G.allowCustomizedBuiltInElements=x.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),He&&(Se=!1),De&&(xe=!0),$&&(A=Ke({},jr(c0)),D=[],$.html===!0&&(Ke(A,u0),Ke(D,h0)),$.svg===!0&&(Ke(A,qp),Ke(D,Qp),Ke(D,wh)),$.svgFilters===!0&&(Ke(A,Zp),Ke(D,Qp),Ke(D,wh)),$.mathMl===!0&&(Ke(A,Jp),Ke(D,d0),Ke(D,wh))),x.ADD_TAGS&&(A===O&&(A=Es(A)),Ke(A,x.ADD_TAGS,Bt)),x.ADD_ATTR&&(D===z&&(D=Es(D)),Ke(D,x.ADD_ATTR,Bt)),x.ADD_URI_SAFE_ATTR&&Ke(V,x.ADD_URI_SAFE_ATTR,Bt),x.FORBID_CONTENTS&&(P===H&&(P=Es(P)),Ke(P,x.FORBID_CONTENTS,Bt)),k&&(A["#text"]=!0),Y&&Ke(A,["html","head","body"]),A.table&&(Ke(A,["tbody"]),delete ne.tbody),Un&&Un(x),cn=x)},yt=Ke({},["mi","mo","mn","ms","mtext"]),hR=Ke({},["foreignobject","desc","title","annotation-xml"]),VN=Ke({},["title","style","font","a","script"]),ch=Ke({},qp);Ke(ch,Zp),Ke(ch,OV);var Ep=Ke({},Jp);Ke(Ep,IV);var BN=function(x){var Q=R(x);(!Q||!Q.tagName)&&(Q={namespaceURI:Ve,tagName:"template"});var le=Bd(x.tagName),ut=Bd(Q.tagName);return Ze[x.namespaceURI]?x.namespaceURI===ye?Q.namespaceURI===Ae?le==="svg":Q.namespaceURI===he?le==="svg"&&(ut==="annotation-xml"||yt[ut]):!!ch[le]:x.namespaceURI===he?Q.namespaceURI===Ae?le==="math":Q.namespaceURI===ye?le==="math"&&hR[ut]:!!Ep[le]:x.namespaceURI===Ae?Q.namespaceURI===ye&&!hR[ut]||Q.namespaceURI===he&&!yt[ut]?!1:!Ep[le]&&(VN[le]||!ch[le]):!!(_t==="application/xhtml+xml"&&Ze[x.namespaceURI]):!1},Wi=function(x){Zl(e.removed,{element:x});try{x.parentNode.removeChild(x)}catch{try{x.outerHTML=I}catch{x.remove()}}},Tp=function(x,Q){try{Zl(e.removed,{attribute:Q.getAttributeNode(x),from:Q})}catch{Zl(e.removed,{attribute:null,from:Q})}if(Q.removeAttribute(x),x==="is"&&!D[x])if(xe||De)try{Wi(Q)}catch{}else try{Q.setAttribute(x,"")}catch{}},dR=function(x){var Q,le;if(Ue)x="<remove></remove>"+x;else{var ut=TV(x,/^[\r\n\t ]+/);le=ut&&ut[0]}_t==="application/xhtml+xml"&&Ve===Ae&&(x='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+x+"</body></html>");var zn=N?N.createHTML(x):x;if(Ve===Ae)try{Q=new d().parseFromString(zn,_t)}catch{}if(!Q||!Q.documentElement){Q=B.createDocument(Ve,"template",null);try{Q.documentElement.innerHTML=St?I:zn}catch{}}var mn=Q.body||Q.documentElement;return x&&le&&mn.insertBefore(r.createTextNode(le),mn.childNodes[0]||null),Ve===Ae?j.call(Q,Y?"html":"body")[0]:Y?Q.documentElement:mn},fR=function(x){return ee.call(x.ownerDocument||x,x,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},UN=function(x){return x instanceof h&&(typeof x.nodeName!="string"||typeof x.textContent!="string"||typeof x.removeChild!="function"||!(x.attributes instanceof c)||typeof x.removeAttribute!="function"||typeof x.setAttribute!="function"||typeof x.namespaceURI!="string"||typeof x.insertBefore!="function"||typeof x.hasChildNodes!="function")},Xl=function(x){return jo(s)==="object"?x instanceof s:x&&jo(x)==="object"&&typeof x.nodeType=="number"&&typeof x.nodeName=="string"},Vi=function(x,Q,le){oe[x]&&EV(oe[x],function(ut){ut.call(e,Q,le,cn)})},gR=function(x){var Q;if(Vi("beforeSanitizeElements",x,null),UN(x)||xn(/[\u0080-\uFFFF]/,x.nodeName))return Wi(x),!0;var le=Bt(x.nodeName);if(Vi("uponSanitizeElement",x,{tagName:le,allowedTags:A}),x.hasChildNodes()&&!Xl(x.firstElementChild)&&(!Xl(x.content)||!Xl(x.content.firstElementChild))&&xn(/<[/\w]/g,x.innerHTML)&&xn(/<[/\w]/g,x.textContent)||le==="select"&&xn(/<template/i,x.innerHTML))return Wi(x),!0;if(!A[le]||ne[le]){if(!ne[le]&&pR(le)&&(G.tagNameCheck instanceof RegExp&&xn(G.tagNameCheck,le)||G.tagNameCheck instanceof Function&&G.tagNameCheck(le)))return!1;if(k&&!P[le]){var ut=R(x)||x.parentNode,zn=y(x)||x.childNodes;if(zn&&ut)for(var mn=zn.length,hn=mn-1;hn>=0;--hn)ut.insertBefore(C(zn[hn],!0),S(x))}return Wi(x),!0}return x instanceof a&&!BN(x)||(le==="noscript"||le==="noembed"||le==="noframes")&&xn(/<\/no(script|embed|frames)/i,x.innerHTML)?(Wi(x),!0):(He&&x.nodeType===3&&(Q=x.textContent,Q=$r(Q,Ce," "),Q=$r(Q,Me," "),Q=$r(Q,rt," "),x.textContent!==Q&&(Zl(e.removed,{element:x.cloneNode()}),x.textContent=Q)),Vi("afterSanitizeElements",x,null),!1)},mR=function(x,Q,le){if(v&&(Q==="id"||Q==="name")&&(le in r||le in bs))return!1;if(!(Se&&!Z[Q]&&xn(We,Q))){if(!(K&&xn(pe,Q))){if(!D[Q]||Z[Q]){if(!(pR(x)&&(G.tagNameCheck instanceof RegExp&&xn(G.tagNameCheck,x)||G.tagNameCheck instanceof Function&&G.tagNameCheck(x))&&(G.attributeNameCheck instanceof RegExp&&xn(G.attributeNameCheck,Q)||G.attributeNameCheck instanceof Function&&G.attributeNameCheck(Q))||Q==="is"&&G.allowCustomizedBuiltInElements&&(G.tagNameCheck instanceof RegExp&&xn(G.tagNameCheck,le)||G.tagNameCheck instanceof Function&&G.tagNameCheck(le))))return!1}else if(!V[Q]){if(!xn(w,$r(le,m,""))){if(!((Q==="src"||Q==="xlink:href"||Q==="href")&&x!=="script"&&_V(le,"data:")===0&&W[x])){if(!(Pe&&!xn(f,$r(le,m,"")))){if(le)return!1}}}}}}return!0},pR=function(x){return x.indexOf("-")>0},wR=function(x){var Q,le,ut,zn;Vi("beforeSanitizeAttributes",x,null);var mn=x.attributes;if(mn){var hn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:D};for(zn=mn.length;zn--;){Q=mn[zn];var hh=Q,rn=hh.name,_p=hh.namespaceURI;if(le=rn==="value"?Q.value:MV(Q.value),ut=Bt(rn),hn.attrName=ut,hn.attrValue=le,hn.keepAttr=!0,hn.forceKeepAttr=void 0,Vi("uponSanitizeAttribute",x,hn),le=hn.attrValue,!hn.forceKeepAttr&&(Tp(rn,x),!!hn.keepAttr)){if(!Oe&&xn(/\/>/i,le)){Tp(rn,x);continue}He&&(le=$r(le,Ce," "),le=$r(le,Me," "),le=$r(le,rt," "));var CR=Bt(x.nodeName);if(mR(CR,ut,le)){if(b&&(ut==="id"||ut==="name")&&(Tp(rn,x),le=_+le),N&&jo(g)==="object"&&typeof g.getAttributeType=="function"&&!_p)switch(g.getAttributeType(CR,ut)){case"TrustedHTML":{le=N.createHTML(le);break}case"TrustedScriptURL":{le=N.createScriptURL(le);break}}try{_p?x.setAttributeNS(_p,rn,le):x.setAttribute(rn,le),l0(e.removed)}catch{}}}}Vi("afterSanitizeAttributes",x,null)}},YN=function Re(x){var Q,le=fR(x);for(Vi("beforeSanitizeShadowDOM",x,null);Q=le.nextNode();)Vi("uponSanitizeShadowNode",Q,null),!gR(Q)&&(Q.content instanceof i&&Re(Q.content),wR(Q));Vi("afterSanitizeShadowDOM",x,null)};return e.sanitize=function(Re){var x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Q,le,ut,zn,mn;if(St=!Re,St&&(Re="<!-->"),typeof Re!="string"&&!Xl(Re))if(typeof Re.toString=="function"){if(Re=Re.toString(),typeof Re!="string")throw Xp("dirty is not a string, aborting")}else throw Xp("toString is not a function");if(!e.isSupported){if(jo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Re=="string")return t.toStaticHTML(Re);if(Xl(Re))return t.toStaticHTML(Re.outerHTML)}return Re}if(lt||Jt(x),e.removed=[],typeof Re=="string"&&(M=!1),M){if(Re.nodeName){var hn=Bt(Re.nodeName);if(!A[hn]||ne[hn])throw Xp("root node is forbidden and cannot be sanitized in-place")}}else if(Re instanceof s)Q=dR("<!---->"),le=Q.ownerDocument.importNode(Re,!0),le.nodeType===1&&le.nodeName==="BODY"||le.nodeName==="HTML"?Q=le:Q.appendChild(le);else{if(!xe&&!He&&!Y&&Re.indexOf("<")===-1)return N&&be?N.createHTML(Re):Re;if(Q=dR(Re),!Q)return xe?null:be?I:""}Q&&Ue&&Wi(Q.firstChild);for(var hh=fR(M?Re:Q);ut=hh.nextNode();)ut.nodeType===3&&ut===zn||gR(ut)||(ut.content instanceof i&&YN(ut.content),wR(ut),zn=ut);if(zn=null,M)return Re;if(xe){if(De)for(mn=U.call(Q.ownerDocument);Q.firstChild;)mn.appendChild(Q.firstChild);else mn=Q;return(D.shadowroot||D.shadowrootmod)&&(mn=re.call(n,mn,!0)),mn}var rn=Y?Q.outerHTML:Q.innerHTML;return Y&&A["!doctype"]&&Q.ownerDocument&&Q.ownerDocument.doctype&&Q.ownerDocument.doctype.name&&xn(FV,Q.ownerDocument.doctype.name)&&(rn="<!DOCTYPE "+Q.ownerDocument.doctype.name+`>
`+rn),He&&(rn=$r(rn,Ce," "),rn=$r(rn,Me," "),rn=$r(rn,rt," ")),N&&be?N.createHTML(rn):rn},e.setConfig=function(Re){Jt(Re),lt=!0},e.clearConfig=function(){cn=null,lt=!1},e.isValidAttribute=function(Re,x,Q){cn||Jt({});var le=Bt(Re),ut=Bt(x);return mR(le,ut,Q)},e.addHook=function(Re,x){typeof x=="function"&&(oe[Re]=oe[Re]||[],Zl(oe[Re],x))},e.removeHook=function(Re){if(oe[Re])return l0(oe[Re])},e.removeHooks=function(Re){oe[Re]&&(oe[Re]=[])},e.removeAllHooks=function(){oe={}},e}var BV=oI();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var sI;function X(){return sI.apply(null,arguments)}function UV(t){sI=t}function ri(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function ua(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function st(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function JS(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(st(t,e))return!1;return!0}function Qn(t){return t===void 0}function wo(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Fc(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function aI(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Jo(t,e){for(var n in e)st(e,n)&&(t[n]=e[n]);return st(e,"toString")&&(t.toString=e.toString),st(e,"valueOf")&&(t.valueOf=e.valueOf),t}function $i(t,e,n,r){return PI(t,e,n,r,!0).utc()}function YV(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(t){return t._pf==null&&(t._pf=YV()),t._pf}var Tv;Array.prototype.some?Tv=Array.prototype.some:Tv=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function QS(t){if(t._isValid==null){var e=ze(t),n=Tv.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function pg(t){var e=$i(NaN);return t!=null?Jo(ze(e),t):ze(e).userInvalidated=!0,e}var f0=X.momentProperties=[],ew=!1;function ey(t,e){var n,r,i,o=f0.length;if(Qn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Qn(e._i)||(t._i=e._i),Qn(e._f)||(t._f=e._f),Qn(e._l)||(t._l=e._l),Qn(e._strict)||(t._strict=e._strict),Qn(e._tzm)||(t._tzm=e._tzm),Qn(e._isUTC)||(t._isUTC=e._isUTC),Qn(e._offset)||(t._offset=e._offset),Qn(e._pf)||(t._pf=ze(e)),Qn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=f0[n],i=e[r],Qn(i)||(t[r]=i);return t}function Wc(t){ey(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ew===!1&&(ew=!0,X.updateOffset(this),ew=!1)}function ii(t){return t instanceof Wc||t!=null&&t._isAMomentObject!=null}function lI(t){X.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Dr(t,e){var n=!0;return Jo(function(){if(X.deprecationHandler!=null&&X.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])st(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}lI(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var g0={};function uI(t,e){X.deprecationHandler!=null&&X.deprecationHandler(t,e),g0[t]||(lI(e),g0[t]=!0)}X.suppressDeprecationWarnings=!1;X.deprecationHandler=null;function ki(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function GV(t){var e,n;for(n in t)st(t,n)&&(e=t[n],ki(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function _v(t,e){var n=Jo({},t),r;for(r in e)st(e,r)&&(ua(t[r])&&ua(e[r])?(n[r]={},Jo(n[r],t[r]),Jo(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)st(t,r)&&!st(e,r)&&ua(t[r])&&(n[r]=Jo({},n[r]));return n}function ty(t){t!=null&&this.set(t)}var Mv;Object.keys?Mv=Object.keys:Mv=function(t){var e,n=[];for(e in t)st(t,e)&&n.push(e);return n};var zV={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function jV(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return ki(r)?r.call(e,n):r}function Di(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var ny=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ch=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,tw={},Rl={};function Te(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Rl[t]=i),e&&(Rl[e[0]]=function(){return Di(i.apply(this,arguments),e[1],e[2])}),n&&(Rl[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function KV(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function XV(t){var e=t.match(ny),n,r;for(n=0,r=e.length;n<r;n++)Rl[e[n]]?e[n]=Rl[e[n]]:e[n]=KV(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=ki(e[s])?e[s].call(i,t):e[s];return o}}function Ud(t,e){return t.isValid()?(e=cI(e,t.localeData()),tw[e]=tw[e]||XV(e),tw[e](t)):t.localeData().invalidDate()}function cI(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Ch.lastIndex=0;n>=0&&Ch.test(t);)t=t.replace(Ch,r),Ch.lastIndex=0,n-=1;return t}var qV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function ZV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(ny).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var JV="Invalid date";function QV(){return this._invalidDate}var eB="%d",tB=/\d{1,2}/;function nB(t){return this._ordinal.replace("%d",t)}var rB={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function iB(t,e,n,r){var i=this._relativeTime[n];return ki(i)?i(t,e,n,r):i.replace(/%d/i,t)}function oB(t,e){var n=this._relativeTime[t>0?"future":"past"];return ki(n)?n(e):n.replace(/%s/i,e)}var Xu={};function On(t,e){var n=t.toLowerCase();Xu[n]=Xu[n+"s"]=Xu[e]=t}function Nr(t){return typeof t=="string"?Xu[t]||Xu[t.toLowerCase()]:void 0}function ry(t){var e={},n,r;for(r in t)st(t,r)&&(n=Nr(r),n&&(e[n]=t[r]));return e}var hI={};function In(t,e){hI[t]=e}function sB(t){var e=[],n;for(n in t)st(t,n)&&e.push({unit:n,priority:hI[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function wg(t){return t%4===0&&t%100!==0||t%400===0}function Or(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function et(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Or(e)),n}function kl(t,e){return function(n){return n!=null?(dI(this,t,n),X.updateOffset(this,e),this):Sf(this,t)}}function Sf(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function dI(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&wg(t.year())&&t.month()===1&&t.date()===29?(n=et(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Rg(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function aB(t){return t=Nr(t),ki(this[t])?this[t]():this}function lB(t,e){if(typeof t=="object"){t=ry(t);var n=sB(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=Nr(t),ki(this[t]))return this[t](e);return this}var fI=/\d/,Cr=/\d\d/,gI=/\d{3}/,iy=/\d{4}/,Cg=/[+-]?\d{6}/,Tt=/\d\d?/,mI=/\d\d\d\d?/,pI=/\d\d\d\d\d\d?/,vg=/\d{1,3}/,oy=/\d{1,4}/,Sg=/[+-]?\d{1,6}/,Fl=/\d+/,yg=/[+-]?\d+/,uB=/Z|[+-]\d\d:?\d\d/gi,bg=/Z|[+-]\d\d(?::?\d\d)?/gi,cB=/[+-]?\d+(\.\d{1,3})?/,Vc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,yf;yf={};function fe(t,e,n){yf[t]=ki(e)?e:function(r,i){return r&&n?n:e}}function hB(t,e){return st(yf,t)?yf[t](e._strict,e._locale):new RegExp(dB(t))}function dB(t){return mr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function mr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Av={};function mt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),wo(e)&&(r=function(o,s){s[e]=et(o)}),i=t.length,n=0;n<i;n++)Av[t[n]]=r}function Bc(t,e){mt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function fB(t,e,n){e!=null&&st(Av,t)&&Av[t](e,n._a,n,t)}var En=0,ao=1,Ai=2,tn=3,Qr=4,lo=5,na=6,gB=7,mB=8;function pB(t,e){return(t%e+e)%e}var zt;Array.prototype.indexOf?zt=Array.prototype.indexOf:zt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Rg(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=pB(e,12);return t+=(e-n)/12,n===1?wg(t)?29:28:31-n%7%2}Te("M",["MM",2],"Mo",function(){return this.month()+1});Te("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Te("MMMM",0,0,function(t){return this.localeData().months(this,t)});On("month","M");In("month",8);fe("M",Tt);fe("MM",Tt,Cr);fe("MMM",function(t,e){return e.monthsShortRegex(t)});fe("MMMM",function(t,e){return e.monthsRegex(t)});mt(["M","MM"],function(t,e){e[ao]=et(t)-1});mt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ao]=i:ze(n).invalidMonth=t});var wB="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),wI="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),CI=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,CB=Vc,vB=Vc;function SB(t,e){return t?ri(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||CI).test(e)?"format":"standalone"][t.month()]:ri(this._months)?this._months:this._months.standalone}function yB(t,e){return t?ri(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[CI.test(e)?"format":"standalone"][t.month()]:ri(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function bB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=$i([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=zt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=zt.call(this._shortMonthsParse,s),i!==-1?i:(i=zt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=zt.call(this._longMonthsParse,s),i!==-1?i:(i=zt.call(this._shortMonthsParse,s),i!==-1?i:null))}function RB(t,e,n){var r,i,o;if(this._monthsParseExact)return bB.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=$i([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function vI(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=et(e);else if(e=t.localeData().monthsParse(e),!wo(e))return t}return n=Math.min(t.date(),Rg(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function SI(t){return t!=null?(vI(this,t),X.updateOffset(this,!0),this):Sf(this,"Month")}function EB(){return Rg(this.year(),this.month())}function TB(t){return this._monthsParseExact?(st(this,"_monthsRegex")||yI.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(st(this,"_monthsShortRegex")||(this._monthsShortRegex=CB),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function _B(t){return this._monthsParseExact?(st(this,"_monthsRegex")||yI.call(this),t?this._monthsStrictRegex:this._monthsRegex):(st(this,"_monthsRegex")||(this._monthsRegex=vB),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function yI(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=$i([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=mr(e[i]),n[i]=mr(n[i]);for(i=0;i<24;i++)r[i]=mr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Te("Y",0,0,function(){var t=this.year();return t<=9999?Di(t,4):"+"+t});Te(0,["YY",2],0,function(){return this.year()%100});Te(0,["YYYY",4],0,"year");Te(0,["YYYYY",5],0,"year");Te(0,["YYYYYY",6,!0],0,"year");On("year","y");In("year",1);fe("Y",yg);fe("YY",Tt,Cr);fe("YYYY",oy,iy);fe("YYYYY",Sg,Cg);fe("YYYYYY",Sg,Cg);mt(["YYYYY","YYYYYY"],En);mt("YYYY",function(t,e){e[En]=t.length===2?X.parseTwoDigitYear(t):et(t)});mt("YY",function(t,e){e[En]=X.parseTwoDigitYear(t)});mt("Y",function(t,e){e[En]=parseInt(t,10)});function qu(t){return wg(t)?366:365}X.parseTwoDigitYear=function(t){return et(t)+(et(t)>68?1900:2e3)};var bI=kl("FullYear",!0);function MB(){return wg(this.year())}function AB(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Cc(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function bf(t,e,n){var r=7+e-n,i=(7+Cc(t,0,r).getUTCDay()-e)%7;return-i+r-1}function RI(t,e,n,r,i){var o=(7+n-r)%7,s=bf(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=qu(l)+a):a>qu(t)?(l=t+1,u=a-qu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function vc(t,e,n){var r=bf(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+po(s,e,n)):i>po(t.year(),e,n)?(o=i-po(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function po(t,e,n){var r=bf(t,e,n),i=bf(t+1,e,n);return(qu(t)-r+i)/7}Te("w",["ww",2],"wo","week");Te("W",["WW",2],"Wo","isoWeek");On("week","w");On("isoWeek","W");In("week",5);In("isoWeek",5);fe("w",Tt);fe("ww",Tt,Cr);fe("W",Tt);fe("WW",Tt,Cr);Bc(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=et(t)});function OB(t){return vc(t,this._week.dow,this._week.doy).week}var IB={dow:0,doy:6};function PB(){return this._week.dow}function xB(){return this._week.doy}function HB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function DB(t){var e=vc(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Te("d",0,"do","day");Te("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Te("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Te("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Te("e",0,0,"weekday");Te("E",0,0,"isoWeekday");On("day","d");On("weekday","e");On("isoWeekday","E");In("day",11);In("weekday",11);In("isoWeekday",11);fe("d",Tt);fe("e",Tt);fe("E",Tt);fe("dd",function(t,e){return e.weekdaysMinRegex(t)});fe("ddd",function(t,e){return e.weekdaysShortRegex(t)});fe("dddd",function(t,e){return e.weekdaysRegex(t)});Bc(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:ze(n).invalidWeekday=t});Bc(["d","e","E"],function(t,e,n,r){e[r]=et(t)});function NB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function LB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function sy(t,e){return t.slice(e,7).concat(t.slice(0,e))}var $B="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),EI="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),kB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),FB=Vc,WB=Vc,VB=Vc;function BB(t,e){var n=ri(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?sy(n,this._week.dow):t?n[t.day()]:n}function UB(t){return t===!0?sy(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function YB(t){return t===!0?sy(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function GB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=$i([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=zt.call(this._weekdaysParse,s),i!==-1||(i=zt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=zt.call(this._shortWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=zt.call(this._minWeekdaysParse,s),i!==-1||(i=zt.call(this._weekdaysParse,s),i!==-1)?i:(i=zt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function zB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return GB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=$i([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function jB(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=NB(t,this.localeData()),this.add(t-e,"d")):e}function KB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function XB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=LB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function qB(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||ay.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(st(this,"_weekdaysRegex")||(this._weekdaysRegex=FB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function ZB(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||ay.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(st(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=WB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function JB(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||ay.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(st(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=VB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ay(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=$i([2e3,1]).day(o),a=mr(this.weekdaysMin(s,"")),l=mr(this.weekdaysShort(s,"")),u=mr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function ly(){return this.hours()%12||12}function QB(){return this.hours()||24}Te("H",["HH",2],0,"hour");Te("h",["hh",2],0,ly);Te("k",["kk",2],0,QB);Te("hmm",0,0,function(){return""+ly.apply(this)+Di(this.minutes(),2)});Te("hmmss",0,0,function(){return""+ly.apply(this)+Di(this.minutes(),2)+Di(this.seconds(),2)});Te("Hmm",0,0,function(){return""+this.hours()+Di(this.minutes(),2)});Te("Hmmss",0,0,function(){return""+this.hours()+Di(this.minutes(),2)+Di(this.seconds(),2)});function TI(t,e){Te(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}TI("a",!0);TI("A",!1);On("hour","h");In("hour",13);function _I(t,e){return e._meridiemParse}fe("a",_I);fe("A",_I);fe("H",Tt);fe("h",Tt);fe("k",Tt);fe("HH",Tt,Cr);fe("hh",Tt,Cr);fe("kk",Tt,Cr);fe("hmm",mI);fe("hmmss",pI);fe("Hmm",mI);fe("Hmmss",pI);mt(["H","HH"],tn);mt(["k","kk"],function(t,e,n){var r=et(t);e[tn]=r===24?0:r});mt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});mt(["h","hh"],function(t,e,n){e[tn]=et(t),ze(n).bigHour=!0});mt("hmm",function(t,e,n){var r=t.length-2;e[tn]=et(t.substr(0,r)),e[Qr]=et(t.substr(r)),ze(n).bigHour=!0});mt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[tn]=et(t.substr(0,r)),e[Qr]=et(t.substr(r,2)),e[lo]=et(t.substr(i)),ze(n).bigHour=!0});mt("Hmm",function(t,e,n){var r=t.length-2;e[tn]=et(t.substr(0,r)),e[Qr]=et(t.substr(r))});mt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[tn]=et(t.substr(0,r)),e[Qr]=et(t.substr(r,2)),e[lo]=et(t.substr(i))});function e2(t){return(t+"").toLowerCase().charAt(0)==="p"}var t2=/[ap]\.?m?\.?/i,n2=kl("Hours",!0);function r2(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var MI={calendar:zV,longDateFormat:qV,invalidDate:JV,ordinal:eB,dayOfMonthOrdinalParse:tB,relativeTime:rB,months:wB,monthsShort:wI,week:IB,weekdays:$B,weekdaysMin:kB,weekdaysShort:EI,meridiemParse:t2},It={},Jl={},Sc;function i2(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function m0(t){return t&&t.toLowerCase().replace("_","-")}function o2(t){for(var e=0,n,r,i,o;e<t.length;){for(o=m0(t[e]).split("-"),n=o.length,r=m0(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Eg(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&i2(o,r)>=n-1)break;n--}e++}return Sc}function s2(t){return t.match("^[^/\\\\]*$")!=null}function Eg(t){var e=null,n;if(It[t]===void 0&&typeof gf<"u"&&gf&&gf.exports&&s2(t))try{e=Sc._abbr,n=require,n("./locale/"+t),is(e)}catch{It[t]=null}return It[t]}function is(t,e){var n;return t&&(Qn(e)?n=bo(t):n=uy(t,e),n?Sc=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Sc._abbr}function uy(t,e){if(e!==null){var n,r=MI;if(e.abbr=t,It[t]!=null)uI("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=It[t]._config;else if(e.parentLocale!=null)if(It[e.parentLocale]!=null)r=It[e.parentLocale]._config;else if(n=Eg(e.parentLocale),n!=null)r=n._config;else return Jl[e.parentLocale]||(Jl[e.parentLocale]=[]),Jl[e.parentLocale].push({name:t,config:e}),null;return It[t]=new ty(_v(r,e)),Jl[t]&&Jl[t].forEach(function(i){uy(i.name,i.config)}),is(t),It[t]}else return delete It[t],null}function a2(t,e){if(e!=null){var n,r,i=MI;It[t]!=null&&It[t].parentLocale!=null?It[t].set(_v(It[t]._config,e)):(r=Eg(t),r!=null&&(i=r._config),e=_v(i,e),r==null&&(e.abbr=t),n=new ty(e),n.parentLocale=It[t],It[t]=n),is(t)}else It[t]!=null&&(It[t].parentLocale!=null?(It[t]=It[t].parentLocale,t===is()&&is(t)):It[t]!=null&&delete It[t]);return It[t]}function bo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Sc;if(!ri(t)){if(e=Eg(t),e)return e;t=[t]}return o2(t)}function l2(){return Mv(It)}function cy(t){var e,n=t._a;return n&&ze(t).overflow===-2&&(e=n[ao]<0||n[ao]>11?ao:n[Ai]<1||n[Ai]>Rg(n[En],n[ao])?Ai:n[tn]<0||n[tn]>24||n[tn]===24&&(n[Qr]!==0||n[lo]!==0||n[na]!==0)?tn:n[Qr]<0||n[Qr]>59?Qr:n[lo]<0||n[lo]>59?lo:n[na]<0||n[na]>999?na:-1,ze(t)._overflowDayOfYear&&(e<En||e>Ai)&&(e=Ai),ze(t)._overflowWeeks&&e===-1&&(e=gB),ze(t)._overflowWeekday&&e===-1&&(e=mB),ze(t).overflow=e),t}var u2=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,c2=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,h2=/Z|[+-]\d\d(?::?\d\d)?/,vh=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],nw=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],d2=/^\/?Date\((-?\d+)/i,f2=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,g2={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function AI(t){var e,n,r=t._i,i=u2.exec(r)||c2.exec(r),o,s,a,l,u=vh.length,c=nw.length;if(i){for(ze(t).iso=!0,e=0,n=u;e<n;e++)if(vh[e][1].exec(i[1])){s=vh[e][0],o=vh[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(nw[e][1].exec(i[3])){a=(i[2]||" ")+nw[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(h2.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),dy(t)}else t._isValid=!1}function m2(t,e,n,r,i,o){var s=[p2(t),wI.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function p2(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function w2(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function C2(t,e,n){if(t){var r=EI.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return ze(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function v2(t,e,n){if(t)return g2[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function OI(t){var e=f2.exec(w2(t._i)),n;if(e){if(n=m2(e[4],e[3],e[2],e[5],e[6],e[7]),!C2(e[1],n,t))return;t._a=n,t._tzm=v2(e[8],e[9],e[10]),t._d=Cc.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ze(t).rfc2822=!0}else t._isValid=!1}function S2(t){var e=d2.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(AI(t),t._isValid===!1)delete t._isValid;else return;if(OI(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:X.createFromInputFallback(t)}X.createFromInputFallback=Dr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function gl(t,e,n){return t??e??n}function y2(t){var e=new Date(X.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function hy(t){var e,n,r=[],i,o,s;if(!t._d){for(i=y2(t),t._w&&t._a[Ai]==null&&t._a[ao]==null&&b2(t),t._dayOfYear!=null&&(s=gl(t._a[En],i[En]),(t._dayOfYear>qu(s)||t._dayOfYear===0)&&(ze(t)._overflowDayOfYear=!0),n=Cc(s,0,t._dayOfYear),t._a[ao]=n.getUTCMonth(),t._a[Ai]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[tn]===24&&t._a[Qr]===0&&t._a[lo]===0&&t._a[na]===0&&(t._nextDay=!0,t._a[tn]=0),t._d=(t._useUTC?Cc:AB).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[tn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ze(t).weekdayMismatch=!0)}}function b2(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=gl(e.GG,t._a[En],vc(Et(),1,4).year),r=gl(e.W,1),i=gl(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=vc(Et(),o,s),n=gl(e.gg,t._a[En],u.year),r=gl(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>po(n,o,s)?ze(t)._overflowWeeks=!0:l!=null?ze(t)._overflowWeekday=!0:(a=RI(n,r,i,o,s),t._a[En]=a.year,t._dayOfYear=a.dayOfYear)}X.ISO_8601=function(){};X.RFC_2822=function(){};function dy(t){if(t._f===X.ISO_8601){AI(t);return}if(t._f===X.RFC_2822){OI(t);return}t._a=[],ze(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=cI(t._f,t._locale).match(ny)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(hB(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&ze(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Rl[o]?(r?ze(t).empty=!1:ze(t).unusedTokens.push(o),fB(o,r,t)):t._strict&&!r&&ze(t).unusedTokens.push(o);ze(t).charsLeftOver=a-l,e.length>0&&ze(t).unusedInput.push(e),t._a[tn]<=12&&ze(t).bigHour===!0&&t._a[tn]>0&&(ze(t).bigHour=void 0),ze(t).parsedDateParts=t._a.slice(0),ze(t).meridiem=t._meridiem,t._a[tn]=R2(t._locale,t._a[tn],t._meridiem),u=ze(t).era,u!==null&&(t._a[En]=t._locale.erasConvertYear(u,t._a[En])),hy(t),cy(t)}function R2(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function E2(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){ze(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=ey({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],dy(e),QS(e)&&(s=!0),o+=ze(e).charsLeftOver,o+=ze(e).unusedTokens.length*10,ze(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Jo(t,n||e)}function T2(t){if(!t._d){var e=ry(t._i),n=e.day===void 0?e.date:e.day;t._a=aI([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),hy(t)}}function _2(t){var e=new Wc(cy(II(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function II(t){var e=t._i,n=t._f;return t._locale=t._locale||bo(t._l),e===null||n===void 0&&e===""?pg({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ii(e)?new Wc(cy(e)):(Fc(e)?t._d=e:ri(n)?E2(t):n?dy(t):M2(t),QS(t)||(t._d=null),t))}function M2(t){var e=t._i;Qn(e)?t._d=new Date(X.now()):Fc(e)?t._d=new Date(e.valueOf()):typeof e=="string"?S2(t):ri(e)?(t._a=aI(e.slice(0),function(n){return parseInt(n,10)}),hy(t)):ua(e)?T2(t):wo(e)?t._d=new Date(e):X.createFromInputFallback(t)}function PI(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(ua(t)&&JS(t)||ri(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,_2(o)}function Et(t,e,n,r){return PI(t,e,n,r,!1)}var A2=Dr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:pg()}),O2=Dr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:pg()});function xI(t,e){var n,r;if(e.length===1&&ri(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function I2(){var t=[].slice.call(arguments,0);return xI("isBefore",t)}function P2(){var t=[].slice.call(arguments,0);return xI("isAfter",t)}var x2=function(){return Date.now?Date.now():+new Date},Ql=["year","quarter","month","week","day","hour","minute","second","millisecond"];function H2(t){var e,n=!1,r,i=Ql.length;for(e in t)if(st(t,e)&&!(zt.call(Ql,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Ql[r]]){if(n)return!1;parseFloat(t[Ql[r]])!==et(t[Ql[r]])&&(n=!0)}return!0}function D2(){return this._isValid}function N2(){return si(NaN)}function Tg(t){var e=ry(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=H2(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=bo(),this._bubble()}function Yd(t){return t instanceof Tg}function Ov(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function L2(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&et(t[s])!==et(e[s]))&&o++;return o+i}function HI(t,e){Te(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+Di(~~(n/60),2)+e+Di(~~n%60,2)})}HI("Z",":");HI("ZZ","");fe("Z",bg);fe("ZZ",bg);mt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=fy(bg,t)});var $2=/([\+\-]|\d\d)/gi;function fy(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match($2)||["-",0,0],o=+(i[1]*60)+et(i[2]),o===0?0:i[0]==="+"?o:-o)}function gy(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ii(t)||Fc(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),X.updateOffset(n,!1),n):Et(t).local()}function Iv(t){return-Math.round(t._d.getTimezoneOffset())}X.updateOffset=function(){};function k2(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=fy(bg,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=Iv(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?LI(this,si(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,X.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:Iv(this)}function F2(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function W2(t){return this.utcOffset(0,t)}function V2(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Iv(this),"m")),this}function B2(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=fy(uB,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function U2(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Y2(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function G2(){if(!Qn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return ey(t,this),t=II(t),t._a?(e=t._isUTC?$i(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&L2(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function z2(){return this.isValid()?!this._isUTC:!1}function j2(){return this.isValid()?this._isUTC:!1}function DI(){return this.isValid()?this._isUTC&&this._offset===0:!1}var K2=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,X2=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function si(t,e){var n=t,r=null,i,o,s;return Yd(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:wo(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=K2.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:et(r[Ai])*i,h:et(r[tn])*i,m:et(r[Qr])*i,s:et(r[lo])*i,ms:et(Ov(r[na]*1e3))*i}):(r=X2.exec(t))?(i=r[1]==="-"?-1:1,n={y:Ts(r[2],i),M:Ts(r[3],i),w:Ts(r[4],i),d:Ts(r[5],i),h:Ts(r[6],i),m:Ts(r[7],i),s:Ts(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=q2(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Tg(n),Yd(t)&&st(t,"_locale")&&(o._locale=t._locale),Yd(t)&&st(t,"_isValid")&&(o._isValid=t._isValid),o}si.fn=Tg.prototype;si.invalid=N2;function Ts(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function p0(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function q2(t,e){var n;return t.isValid()&&e.isValid()?(e=gy(e,t),t.isBefore(e)?n=p0(t,e):(n=p0(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function NI(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(uI(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=si(n,r),LI(this,i,t),this}}function LI(t,e,n,r){var i=e._milliseconds,o=Ov(e._days),s=Ov(e._months);t.isValid()&&(r=r??!0,s&&vI(t,Sf(t,"Month")+s*n),o&&dI(t,"Date",Sf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&X.updateOffset(t,o||s))}var Z2=NI(1,"add"),J2=NI(-1,"subtract");function $I(t){return typeof t=="string"||t instanceof String}function Q2(t){return ii(t)||Fc(t)||$I(t)||wo(t)||tU(t)||eU(t)||t===null||t===void 0}function eU(t){var e=ua(t)&&!JS(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||st(t,o);return e&&n}function tU(t){var e=ri(t),n=!1;return e&&(n=t.filter(function(r){return!wo(r)&&$I(t)}).length===0),e&&n}function nU(t){var e=ua(t)&&!JS(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||st(t,o);return e&&n}function rU(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function iU(t,e){arguments.length===1&&(arguments[0]?Q2(arguments[0])?(t=arguments[0],e=void 0):nU(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=gy(n,this).startOf("day"),i=X.calendarFormat(this,r)||"sameElse",o=e&&(ki(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function oU(){return new Wc(this)}function sU(t,e){var n=ii(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Nr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function aU(t,e){var n=ii(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=Nr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function lU(t,e,n,r){var i=ii(t)?t:Et(t),o=ii(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function uU(t,e){var n=ii(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=Nr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function cU(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function hU(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function dU(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=gy(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=Nr(e),e){case"year":o=Gd(this,r)/12;break;case"month":o=Gd(this,r);break;case"quarter":o=Gd(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Or(o)}function Gd(t,e){if(t.date()<e.date())return-Gd(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}X.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";X.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function fU(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function gU(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Ud(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ki(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ud(n,"Z")):Ud(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function mU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function pU(t){t||(t=this.isUtc()?X.defaultFormatUtc:X.defaultFormat);var e=Ud(this,t);return this.localeData().postformat(e)}function wU(t,e){return this.isValid()&&(ii(t)&&t.isValid()||Et(t).isValid())?si({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function CU(t){return this.from(Et(),t)}function vU(t,e){return this.isValid()&&(ii(t)&&t.isValid()||Et(t).isValid())?si({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function SU(t){return this.to(Et(),t)}function kI(t){var e;return t===void 0?this._locale._abbr:(e=bo(t),e!=null&&(this._locale=e),this)}var FI=Dr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function WI(){return this._locale}var Rf=1e3,El=60*Rf,Ef=60*El,VI=(365*400+97)*24*Ef;function Tl(t,e){return(t%e+e)%e}function BI(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-VI:new Date(t,e,n).valueOf()}function UI(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-VI:Date.UTC(t,e,n)}function yU(t){var e,n;if(t=Nr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?UI:BI,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Tl(e+(this._isUTC?0:this.utcOffset()*El),Ef);break;case"minute":e=this._d.valueOf(),e-=Tl(e,El);break;case"second":e=this._d.valueOf(),e-=Tl(e,Rf);break}return this._d.setTime(e),X.updateOffset(this,!0),this}function bU(t){var e,n;if(t=Nr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?UI:BI,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Ef-Tl(e+(this._isUTC?0:this.utcOffset()*El),Ef)-1;break;case"minute":e=this._d.valueOf(),e+=El-Tl(e,El)-1;break;case"second":e=this._d.valueOf(),e+=Rf-Tl(e,Rf)-1;break}return this._d.setTime(e),X.updateOffset(this,!0),this}function RU(){return this._d.valueOf()-(this._offset||0)*6e4}function EU(){return Math.floor(this.valueOf()/1e3)}function TU(){return new Date(this.valueOf())}function _U(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function MU(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function AU(){return this.isValid()?this.toISOString():null}function OU(){return QS(this)}function IU(){return Jo({},ze(this))}function PU(){return ze(this).overflow}function xU(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Te("N",0,0,"eraAbbr");Te("NN",0,0,"eraAbbr");Te("NNN",0,0,"eraAbbr");Te("NNNN",0,0,"eraName");Te("NNNNN",0,0,"eraNarrow");Te("y",["y",1],"yo","eraYear");Te("y",["yy",2],0,"eraYear");Te("y",["yyy",3],0,"eraYear");Te("y",["yyyy",4],0,"eraYear");fe("N",my);fe("NN",my);fe("NNN",my);fe("NNNN",UU);fe("NNNNN",YU);mt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?ze(n).era=i:ze(n).invalidEra=t});fe("y",Fl);fe("yy",Fl);fe("yyy",Fl);fe("yyyy",Fl);fe("yo",GU);mt(["y","yy","yyy","yyyy"],En);mt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[En]=n._locale.eraYearOrdinalParse(t,i):e[En]=parseInt(t,10)});function HU(t,e){var n,r,i,o=this._eras||bo("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=X(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=X(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function DU(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function NU(t,e){var n=t.since<=t.until?1:-1;return e===void 0?X(t.since).year():X(t.since).year()+(e-t.offset)*n}function LU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function $U(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function kU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function FU(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-X(i[t].since).year())*n+i[t].offset;return this.year()}function WU(t){return st(this,"_erasNameRegex")||py.call(this),t?this._erasNameRegex:this._erasRegex}function VU(t){return st(this,"_erasAbbrRegex")||py.call(this),t?this._erasAbbrRegex:this._erasRegex}function BU(t){return st(this,"_erasNarrowRegex")||py.call(this),t?this._erasNarrowRegex:this._erasRegex}function my(t,e){return e.erasAbbrRegex(t)}function UU(t,e){return e.erasNameRegex(t)}function YU(t,e){return e.erasNarrowRegex(t)}function GU(t,e){return e._eraYearOrdinalRegex||Fl}function py(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(mr(s[i].name)),t.push(mr(s[i].abbr)),n.push(mr(s[i].narrow)),r.push(mr(s[i].name)),r.push(mr(s[i].abbr)),r.push(mr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Te(0,["gg",2],0,function(){return this.weekYear()%100});Te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function _g(t,e){Te(0,[t,t.length],0,e)}_g("gggg","weekYear");_g("ggggg","weekYear");_g("GGGG","isoWeekYear");_g("GGGGG","isoWeekYear");On("weekYear","gg");On("isoWeekYear","GG");In("weekYear",1);In("isoWeekYear",1);fe("G",yg);fe("g",yg);fe("GG",Tt,Cr);fe("gg",Tt,Cr);fe("GGGG",oy,iy);fe("gggg",oy,iy);fe("GGGGG",Sg,Cg);fe("ggggg",Sg,Cg);Bc(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=et(t)});Bc(["gg","GG"],function(t,e,n,r){e[r]=X.parseTwoDigitYear(t)});function zU(t){return YI.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function jU(t){return YI.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function KU(){return po(this.year(),1,4)}function XU(){return po(this.isoWeekYear(),1,4)}function qU(){var t=this.localeData()._week;return po(this.year(),t.dow,t.doy)}function ZU(){var t=this.localeData()._week;return po(this.weekYear(),t.dow,t.doy)}function YI(t,e,n,r,i){var o;return t==null?vc(this,r,i).year:(o=po(t,r,i),e>o&&(e=o),JU.call(this,t,e,n,r,i))}function JU(t,e,n,r,i){var o=RI(t,e,n,r,i),s=Cc(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Te("Q",0,"Qo","quarter");On("quarter","Q");In("quarter",7);fe("Q",fI);mt("Q",function(t,e){e[ao]=(et(t)-1)*3});function QU(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Te("D",["DD",2],"Do","date");On("date","D");In("date",9);fe("D",Tt);fe("DD",Tt,Cr);fe("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});mt(["D","DD"],Ai);mt("Do",function(t,e){e[Ai]=et(t.match(Tt)[0])});var GI=kl("Date",!0);Te("DDD",["DDDD",3],"DDDo","dayOfYear");On("dayOfYear","DDD");In("dayOfYear",4);fe("DDD",vg);fe("DDDD",gI);mt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=et(t)});function eY(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Te("m",["mm",2],0,"minute");On("minute","m");In("minute",14);fe("m",Tt);fe("mm",Tt,Cr);mt(["m","mm"],Qr);var tY=kl("Minutes",!1);Te("s",["ss",2],0,"second");On("second","s");In("second",15);fe("s",Tt);fe("ss",Tt,Cr);mt(["s","ss"],lo);var nY=kl("Seconds",!1);Te("S",0,0,function(){return~~(this.millisecond()/100)});Te(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Te(0,["SSS",3],0,"millisecond");Te(0,["SSSS",4],0,function(){return this.millisecond()*10});Te(0,["SSSSS",5],0,function(){return this.millisecond()*100});Te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});On("millisecond","ms");In("millisecond",16);fe("S",vg,fI);fe("SS",vg,Cr);fe("SSS",vg,gI);var Qo,zI;for(Qo="SSSS";Qo.length<=9;Qo+="S")fe(Qo,Fl);function rY(t,e){e[na]=et(("0."+t)*1e3)}for(Qo="S";Qo.length<=9;Qo+="S")mt(Qo,rY);zI=kl("Milliseconds",!1);Te("z",0,0,"zoneAbbr");Te("zz",0,0,"zoneName");function iY(){return this._isUTC?"UTC":""}function oY(){return this._isUTC?"Coordinated Universal Time":""}var J=Wc.prototype;J.add=Z2;J.calendar=iU;J.clone=oU;J.diff=dU;J.endOf=bU;J.format=pU;J.from=wU;J.fromNow=CU;J.to=vU;J.toNow=SU;J.get=aB;J.invalidAt=PU;J.isAfter=sU;J.isBefore=aU;J.isBetween=lU;J.isSame=uU;J.isSameOrAfter=cU;J.isSameOrBefore=hU;J.isValid=OU;J.lang=FI;J.locale=kI;J.localeData=WI;J.max=O2;J.min=A2;J.parsingFlags=IU;J.set=lB;J.startOf=yU;J.subtract=J2;J.toArray=_U;J.toObject=MU;J.toDate=TU;J.toISOString=gU;J.inspect=mU;typeof Symbol<"u"&&Symbol.for!=null&&(J[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});J.toJSON=AU;J.toString=fU;J.unix=EU;J.valueOf=RU;J.creationData=xU;J.eraName=LU;J.eraNarrow=$U;J.eraAbbr=kU;J.eraYear=FU;J.year=bI;J.isLeapYear=MB;J.weekYear=zU;J.isoWeekYear=jU;J.quarter=J.quarters=QU;J.month=SI;J.daysInMonth=EB;J.week=J.weeks=HB;J.isoWeek=J.isoWeeks=DB;J.weeksInYear=qU;J.weeksInWeekYear=ZU;J.isoWeeksInYear=KU;J.isoWeeksInISOWeekYear=XU;J.date=GI;J.day=J.days=jB;J.weekday=KB;J.isoWeekday=XB;J.dayOfYear=eY;J.hour=J.hours=n2;J.minute=J.minutes=tY;J.second=J.seconds=nY;J.millisecond=J.milliseconds=zI;J.utcOffset=k2;J.utc=W2;J.local=V2;J.parseZone=B2;J.hasAlignedHourOffset=U2;J.isDST=Y2;J.isLocal=z2;J.isUtcOffset=j2;J.isUtc=DI;J.isUTC=DI;J.zoneAbbr=iY;J.zoneName=oY;J.dates=Dr("dates accessor is deprecated. Use date instead.",GI);J.months=Dr("months accessor is deprecated. Use month instead",SI);J.years=Dr("years accessor is deprecated. Use year instead",bI);J.zone=Dr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",F2);J.isDSTShifted=Dr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",G2);function sY(t){return Et(t*1e3)}function aY(){return Et.apply(null,arguments).parseZone()}function jI(t){return t}var at=ty.prototype;at.calendar=jV;at.longDateFormat=ZV;at.invalidDate=QV;at.ordinal=nB;at.preparse=jI;at.postformat=jI;at.relativeTime=iB;at.pastFuture=oB;at.set=GV;at.eras=HU;at.erasParse=DU;at.erasConvertYear=NU;at.erasAbbrRegex=VU;at.erasNameRegex=WU;at.erasNarrowRegex=BU;at.months=SB;at.monthsShort=yB;at.monthsParse=RB;at.monthsRegex=_B;at.monthsShortRegex=TB;at.week=OB;at.firstDayOfYear=xB;at.firstDayOfWeek=PB;at.weekdays=BB;at.weekdaysMin=YB;at.weekdaysShort=UB;at.weekdaysParse=zB;at.weekdaysRegex=qB;at.weekdaysShortRegex=ZB;at.weekdaysMinRegex=JB;at.isPM=e2;at.meridiem=r2;function Tf(t,e,n,r){var i=bo(),o=$i().set(r,e);return i[n](o,t)}function KI(t,e,n){if(wo(t)&&(e=t,t=void 0),t=t||"",e!=null)return Tf(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Tf(t,r,n,"month");return i}function wy(t,e,n,r){typeof t=="boolean"?(wo(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,wo(e)&&(n=e,e=void 0),e=e||"");var i=bo(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Tf(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Tf(e,(s+o)%7,r,"day");return a}function lY(t,e){return KI(t,e,"months")}function uY(t,e){return KI(t,e,"monthsShort")}function cY(t,e,n){return wy(t,e,n,"weekdays")}function hY(t,e,n){return wy(t,e,n,"weekdaysShort")}function dY(t,e,n){return wy(t,e,n,"weekdaysMin")}is("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=et(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});X.lang=Dr("moment.lang is deprecated. Use moment.locale instead.",is);X.langData=Dr("moment.langData is deprecated. Use moment.localeData instead.",bo);var Bi=Math.abs;function fY(){var t=this._data;return this._milliseconds=Bi(this._milliseconds),this._days=Bi(this._days),this._months=Bi(this._months),t.milliseconds=Bi(t.milliseconds),t.seconds=Bi(t.seconds),t.minutes=Bi(t.minutes),t.hours=Bi(t.hours),t.months=Bi(t.months),t.years=Bi(t.years),this}function XI(t,e,n,r){var i=si(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function gY(t,e){return XI(this,t,e,1)}function mY(t,e){return XI(this,t,e,-1)}function w0(t){return t<0?Math.floor(t):Math.ceil(t)}function pY(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=w0(Pv(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Or(t/1e3),r.seconds=i%60,o=Or(i/60),r.minutes=o%60,s=Or(o/60),r.hours=s%24,e+=Or(s/24),l=Or(qI(e)),n+=l,e-=w0(Pv(l)),a=Or(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function qI(t){return t*4800/146097}function Pv(t){return t*146097/4800}function wY(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=Nr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+qI(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Pv(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function CY(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+et(this._months/12)*31536e6:NaN}function Ro(t){return function(){return this.as(t)}}var vY=Ro("ms"),SY=Ro("s"),yY=Ro("m"),bY=Ro("h"),RY=Ro("d"),EY=Ro("w"),TY=Ro("M"),_Y=Ro("Q"),MY=Ro("y");function AY(){return si(this)}function OY(t){return t=Nr(t),this.isValid()?this[t+"s"]():NaN}function Ca(t){return function(){return this.isValid()?this._data[t]:NaN}}var IY=Ca("milliseconds"),PY=Ca("seconds"),xY=Ca("minutes"),HY=Ca("hours"),DY=Ca("days"),NY=Ca("months"),LY=Ca("years");function $Y(){return Or(this.days()/7)}var no=Math.round,vl={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function kY(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function FY(t,e,n,r){var i=si(t).abs(),o=no(i.as("s")),s=no(i.as("m")),a=no(i.as("h")),l=no(i.as("d")),u=no(i.as("M")),c=no(i.as("w")),h=no(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,kY.apply(null,d)}function WY(t){return t===void 0?no:typeof t=="function"?(no=t,!0):!1}function VY(t,e){return vl[t]===void 0?!1:e===void 0?vl[t]:(vl[t]=e,t==="s"&&(vl.ss=e-1),!0)}function BY(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=vl,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},vl,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=FY(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var rw=Math.abs;function Ta(t){return(t>0)-(t<0)||+t}function Mg(){if(!this.isValid())return this.localeData().invalidDate();var t=rw(this._milliseconds)/1e3,e=rw(this._days),n=rw(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Or(t/60),i=Or(r/60),t%=60,r%=60,o=Or(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Ta(this._months)!==Ta(a)?"-":"",c=Ta(this._days)!==Ta(a)?"-":"",h=Ta(this._milliseconds)!==Ta(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var nt=Tg.prototype;nt.isValid=D2;nt.abs=fY;nt.add=gY;nt.subtract=mY;nt.as=wY;nt.asMilliseconds=vY;nt.asSeconds=SY;nt.asMinutes=yY;nt.asHours=bY;nt.asDays=RY;nt.asWeeks=EY;nt.asMonths=TY;nt.asQuarters=_Y;nt.asYears=MY;nt.valueOf=CY;nt._bubble=pY;nt.clone=AY;nt.get=OY;nt.milliseconds=IY;nt.seconds=PY;nt.minutes=xY;nt.hours=HY;nt.days=DY;nt.weeks=$Y;nt.months=NY;nt.years=LY;nt.humanize=BY;nt.toISOString=Mg;nt.toString=Mg;nt.toJSON=Mg;nt.locale=kI;nt.localeData=WI;nt.toIsoString=Dr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Mg);nt.lang=FI;Te("X",0,0,"unix");Te("x",0,0,"valueOf");fe("x",yg);fe("X",cB);mt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});mt("x",function(t,e,n){n._d=new Date(et(t))});//! moment.js
X.version="2.29.4";UV(Et);X.fn=J;X.min=I2;X.max=P2;X.now=x2;X.utc=$i;X.unix=sY;X.months=lY;X.isDate=Fc;X.locale=is;X.invalid=pg;X.duration=si;X.isMoment=ii;X.weekdays=cY;X.parseZone=aY;X.localeData=bo;X.isDuration=Yd;X.monthsShort=uY;X.weekdaysMin=dY;X.defineLocale=uy;X.updateLocale=a2;X.locales=l2;X.weekdaysShort=hY;X.normalizeUnits=Nr;X.relativeTimeRounding=WY;X.relativeTimeThreshold=VY;X.calendarFormat=rU;X.prototype=J;X.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function ZI(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function xv(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Zu(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Yt(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function wr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ye(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function E(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function JI(t){return Yt(t,(e,n)=>e+n,0)}function UY(t){return Yt(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function YY(t){return Yt(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function GY(t){return t.length?JI(t)/t.length:0}function QI(t){return Yt(t,(e,n)=>e.concat(Array.isArray(n)?QI(n):n),[])}function Cy(t){const e=[];return E(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function Hv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return E(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function zY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return E(i,s=>{o=o.filter(a=>s.includes(a))}),o}function jY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return E(i,s=>{E(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function Dv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const KY=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:GY,arrayEach:E,arrayFilter:wr,arrayFlatten:QI,arrayMap:Ye,arrayMax:UY,arrayMin:YY,arrayReduce:Yt,arraySum:JI,arrayUnique:Cy,extendArray:xv,getDifferenceOfArrays:Hv,getIntersectionOfArrays:zY,getUnionOfArrays:jY,pivot:Zu,stringToArray:Dv,to2dArray:ZI},Symbol.toStringTag,{value:"Module"}));function ht(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Yt(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Wt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function vt(t){return typeof t>"u"}function Zt(t){return t===null||t===""||vt(t)}function eP(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Bu="length",Ju=t=>parseInt(t,16),C0=t=>parseInt(t,10),_f=(t,e,n)=>t.substr(e,n),Qu=t=>t.codePointAt(0)-65,Nv=t=>`${t}`.replace(/\-/g,""),XY=t=>Ju(_f(Nv(t),Ju("12"),Qu("F")))/(Ju(_f(Nv(t),Qu("B"),~~![][Bu]))||9),qY=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let v0=!1;const S0={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},y0={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function tP(t,e){const n=!Zt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.1.0";let o,s="invalid",a="invalid";t=Nv(t||"");const l=ZY(t);if(n||r||l)if(l){const u=X("16/01/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=XY(t);o=X((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(qY()&&(s="valid",a="valid"),!v0&&s!=="valid"&&(S0[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](S0[s]({keyValidityDate:o,hotVersion:i})),v0=!0),a!=="valid"&&e.parentNode&&y0[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=y0[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function ZY(t){let e=[][Bu],n=e;if(t[Bu]!==Qu("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Qu(i.shift());o;o=Qu(i.shift()||"A"))--o<""[Bu]?n=n|(C0(`${C0(Ju(r)+(Ju(_f(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=_f(t,o,o?i[Bu]===1?9:8:6);return n===e}const JY=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:tP,isDefined:ue,isEmpty:Zt,isRegExp:eP,isUndefined:vt,stringify:Wt},Symbol.toStringTag,{value:"Module"}));function Tn(t){return t[0].toUpperCase()+t.substr(1)}function QY(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Wt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function vy(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function Sy(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function yy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Lv(t){return Ag(`${t}`,{ALLOWED_TAGS:[]})}function Ag(t,e){return BV.sanitize(t,e)}const eG=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:QY,isPercentValue:Sy,randomString:vy,sanitize:Ag,stripTags:Lv,substitute:yy,toUpperCaseFirst:Tn},Symbol.toStringTag,{value:"Module"})),Wl=t=>["tabindex",t],tG=()=>["role","treegrid"],Pi=()=>["role","presentation"],nG=()=>["role","gridcell"],rG=()=>["role","rowheader"],nP=()=>["role","rowgroup"],iG=()=>["role","columnheader"],$v=()=>["role","row"],oG=()=>["role","menu"],sG=()=>["role","menuitem"],aG=()=>["role","combobox"],rP=()=>["role","listbox"],lG=()=>["role","option"],uG=()=>["role","checkbox"],cG=()=>["scope","col"],hG=()=>["scope","row"],dG=()=>["type","text"],by=t=>["aria-label",t],Eo=()=>["aria-hidden","true"],fG=()=>["aria-disabled","true"],gG=()=>["aria-multiselectable","true"],iP=t=>["aria-haspopup",t],oP=t=>["aria-rowcount",t],Og=t=>["aria-colcount",t],sP=t=>["aria-rowindex",t],Ry=t=>["aria-colindex",t],Ir=t=>["aria-expanded",t],mG=t=>["aria-sort",t],b0=()=>["aria-readonly","true"],R0=()=>["aria-invalid","true"],pG=t=>["aria-checked",t],Ey=()=>["aria-selected","true"],wG=()=>["aria-autocomplete","list"],CG=t=>["aria-controls",t],vG=t=>["aria-activedescendant",t],SG=t=>["aria-live",t],yG=t=>["aria-relevant",t],bG=t=>["aria-setsize",t],RG=t=>["aria-posinset",t];function aP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function lP(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function uP(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function yc(t){return uP(t)&&t.parent}function EG(t){return!!Object.getPrototypeOf(t.parent)}function cs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Uu(t,e,n){const r=[];let i=t;for(;i&&(i=cs(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function os(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function cP(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Uo(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function hP(t){return!t||!t.length?[]:t.filter(e=>!!e)}function dP(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function Ie(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=hP(e),e.length>0&&t.classList.add(...e)}function Le(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=dP(e,!0);n=hP(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Ee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function va(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=dP(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function Ty(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)Ty(e[n])}}function oi(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const fP=/(<(.*)>|&(.*);)/;function Sa(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;fP.test(e)?t.innerHTML=n?Ag(e):e:hs(t,e)}function hs(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(oi(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ds(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return ds(n.host.impl);if(n.host)return ds(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(Co(n).display==="none")return!1;n=n.parentNode}return!0}function en(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function _y(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Ig(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Pg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?_y(e):t.scrollTop}function My(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Ig(e):t.scrollLeft}function bc(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function ca(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=Co(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Pl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=Co(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function TG(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function Co(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ft(t){return t.offsetWidth}function xt(t){return t.offsetHeight}function ra(t){return t.clientHeight||t.innerHeight}function Ay(t){return t.clientWidth||t.innerWidth}function _G(t,e,n){t.addEventListener(e,n,!1)}function MG(t,e,n){t.removeEventListener(e,n,!1)}function Oy(t){return t.selectionStart?t.selectionStart:0}function gP(t){return t.selectionEnd?t.selectionEnd:0}function AG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function kv(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Uc(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let iw;function OG(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function nn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return iw===void 0&&(iw=OG(t)),iw}function mP(t){return t.offsetWidth!==t.clientWidth}function pP(t){return t.offsetHeight!==t.clientHeight}function xg(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function IG(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Yc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function ec(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Hg(t){return ec(t)&&t.hasAttribute("data-hot-input")===!1}function PG(t){const e=t.ownerDocument.activeElement;Hg(e)||t.select()}function Iy(t){return!t.parentNode}function wP(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Py(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Ee(t,"contenteditable",!0),n&&Ee(t,...Eo()),e&&q(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function xy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Le(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function CP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Py(t,n),e(),xy(t,n)}const xG=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:fP,addClass:q,addEvent:_G,clearTextSelection:kv,closest:cs,closestDown:Uu,empty:oi,fastInnerHTML:Sa,fastInnerText:hs,getCaretPosition:Oy,getComputedStyle:Co,getCssTransform:IG,getFrameElement:uP,getParent:aP,getParentWindow:yc,getScrollLeft:My,getScrollTop:Pg,getScrollableElement:bc,getScrollbarWidth:nn,getSelectionEndPosition:gP,getSelectionText:AG,getStyle:Pl,getTrimmingContainer:ca,getWindowScrollLeft:Ig,getWindowScrollTop:_y,hasAccessToParentWindow:EG,hasClass:Ie,hasHorizontalScrollbar:pP,hasVerticalScrollbar:mP,index:cP,innerHeight:ra,innerWidth:Ay,isChildOf:os,isDetached:Iy,isInput:ec,isOutsideInput:Hg,isThisHotChild:lP,isVisible:ds,makeElementContentEditableAndSelectItsContent:Py,matchesCSSRules:TG,observeVisibilityChangeOnce:wP,offset:en,outerHeight:xt,outerWidth:ft,overlayContainsElement:Uo,removeAttribute:va,removeClass:Le,removeContentEditableFromElementAndDeselect:xy,removeEvent:MG,removeTextNodes:Ty,resetCssTransform:Yc,runWithSelectedContendEditableElement:CP,selectElementIfAllowed:PG,setAttribute:Ee,setCaretPosition:Uc,setOverlayPosition:xg},Symbol.toStringTag,{value:"Module"}));function Ct(t){return typeof t=="function"}function vP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function HG(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=vP(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function Dg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function DG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Yt(i,(u,c)=>c(u),r.apply(this,a))}}function Hy(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function SP(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function NG(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Mf(t,e,n,r,i,o,s,a){return ue(a)?t.call(e,n,r,i,o,s,a):ue(s)?t.call(e,n,r,i,o,s):ue(o)?t.call(e,n,r,i,o):ue(i)?t.call(e,n,r,i):ue(r)?t.call(e,n,r):ue(n)?t.call(e,n):t.call(e)}const LG=Object.freeze(Object.defineProperty({__proto__:null,curry:SP,curryRight:NG,debounce:Dg,fastCall:Mf,isFunction:Ct,partial:Hy,pipe:DG,throttle:vP,throttleAfterHits:HG},Symbol.toStringTag,{value:"Module"}));var $G=Yn,E0=FO,kG=An,T0=Ll,FG=zO,_0=$G([].push),WG=function(t){if(kG(t))return t;if(E0(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?_0(n,i):(typeof i=="number"||T0(i)==="Number"||T0(i)==="String")&&_0(n,FG(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(E0(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},VG=Ss,yP=Nc,bP=mg,BG=pa,Gc=Yn,RP=Hr,M0=An,A0=kS,EP=qS,UG=WG,YG=$S,GG=String,ss=yP("JSON","stringify"),Sh=Gc(/./.exec),O0=Gc("".charAt),zG=Gc("".charCodeAt),jG=Gc("".replace),KG=Gc(1 .toString),XG=/[\uD800-\uDFFF]/g,I0=/^[\uD800-\uDBFF]$/,P0=/^[\uDC00-\uDFFF]$/,x0=!YG||RP(function(){var t=yP("Symbol")("stringify detection");return ss([t])!=="[null]"||ss({a:t})!=="{}"||ss(Object(t))!=="{}"}),H0=RP(function(){return ss("\uDF06\uD834")!=='"\\udf06\\ud834"'||ss("\uDEAD")!=='"\\udead"'}),qG=function(t,e){var n=EP(arguments),r=UG(e);if(!(!M0(r)&&(t===void 0||A0(t))))return n[1]=function(i,o){if(M0(r)&&(o=BG(r,this,GG(i),o)),!A0(o))return o},bP(ss,null,n)},ZG=function(t,e,n){var r=O0(n,e-1),i=O0(n,e+1);return Sh(I0,t)&&!Sh(P0,i)||Sh(P0,t)&&!Sh(I0,r)?"\\u"+KG(zG(t,0),16):t};ss&&VG({target:"JSON",stat:!0,arity:3,forced:x0||H0},{stringify:function(e,n,r){var i=EP(arguments),o=bP(x0?qG:ss,null,i);return H0&&typeof o=="string"?jG(o,XG,ZG):o}});function xl(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ge(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=xl(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[xl(n[0])]:e[r]=[]:e[r]=null)})),e}function To(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function jt(t,e,n){const r=Array.isArray(n);return Ge(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function zc(t,e){Ge(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),zc(t[r],e[r])):t[r]=e[r]})}function _n(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Bn(t){const e={};return Ge(t,(n,r)=>{e[r]=n}),e}function pt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return E(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ge(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,g=p=>{let C=p;return(Array.isArray(C)||Be(C))&&(C=_n(C)),C};return function(){return this[d]===void 0&&(this[d]=g(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Ng(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Be(t){return Object.prototype.toString.call(t)==="[object Object]"}function Fi(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ge(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function TP(t,e){const n=e.split(".");let r=t;return Ge(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function zd(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(Pt(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function Lg(t){if(!Be(t))return 0;const e=function(n){let r=0;return Be(n)?Ge(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function ei(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Pt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const JG=Object.freeze(Object.defineProperty({__proto__:null,clone:Bn,createObjectPropListener:ei,deepClone:_n,deepExtend:zc,deepObjectSize:Lg,defineGetter:Fi,duckSchema:xl,extend:jt,getProperty:TP,hasOwnProperty:Pt,inherit:To,isObject:Be,isObjectEqual:Ng,mixin:pt,objectEach:Ge,setProperty:zd},Symbol.toStringTag,{value:"Module"}));function $g(t){return window.requestAnimationFrame(t)}function Rc(t){window.cancelAnimationFrame(t)}function Dy(){return"ontouchstart"in window}function _P(){return typeof window<"u"}let _a;function MP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _a||(typeof Intl=="object"?_a=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?_a=(n,r)=>`${n}`.localeCompare(r):_a=(n,r)=>n===r?0:n>r?-1:1,_a)}const QG=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Rc,getComparisonFunction:MP,isCSR:_P,isTouchSupported:Dy,requestAnimationFrame:$g},Symbol.toStringTag,{value:"Module"})),Tr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},_o={chrome:Tr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Tr(t=>/CriOS/.test(t)),edge:Tr(t=>/Edge/.test(t)),edgeWebKit:Tr(t=>/EdgiOS/.test(t)),firefox:Tr(t=>/Firefox/.test(t)),firefoxWebKit:Tr(t=>/FxiOS/.test(t)),mobile:Tr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Tr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Vl={mac:Tr(t=>/^Mac/.test(t)),win:Tr(t=>/^Win/.test(t)),linux:Tr(t=>/^Linux/.test(t)),ios:Tr(t=>/iPhone|iPad|iPod/i.test(t))};function AP(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(_o,n=>{let{test:r}=n;return void r(t,e)})}function OP(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(Vl,e=>{let{test:n}=e;return void n(t)})}_P()&&(AP(),OP());function Ny(){return _o.chrome.value}function IP(){return _o.chromeWebKit.value}function jd(){return _o.firefox.value}function PP(){return _o.firefoxWebKit.value}function Ly(){return _o.safari.value}function xP(){return _o.edge.value}function ez(){return _o.edgeWebKit.value}function uo(){return _o.mobile.value}function $y(){return Vl.ios.value}function ky(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Vl.mac.value}function Fv(){return Vl.win.value}function Ec(){return Vl.mac.value}function tz(){return Vl.linux.value}const nz=Object.freeze(Object.defineProperty({__proto__:null,isChrome:Ny,isChromeWebKit:IP,isEdge:xP,isEdgeWebKit:ez,isFirefox:jd,isFirefoxWebKit:PP,isIOS:$y,isIpadOS:ky,isLinuxOS:tz,isMacOS:Ec,isMobileBrowser:uo,isSafari:Ly,isWindowsOS:Fv,setBrowserMeta:AP,setPlatformMeta:OP},Symbol.toStringTag,{value:"Module"})),we={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:jd()?182:174,AUDIO_MUTE:jd()?181:173,AUDIO_UP:jd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},rz=[we.ALT,we.ARROW_DOWN,we.ARROW_LEFT,we.ARROW_RIGHT,we.ARROW_UP,we.AUDIO_DOWN,we.AUDIO_MUTE,we.AUDIO_UP,we.BACKSPACE,we.CAPS_LOCK,we.DELETE,we.END,we.ENTER,we.ESCAPE,we.F1,we.F2,we.F3,we.F4,we.F5,we.F6,we.F7,we.F8,we.F9,we.F10,we.F11,we.F12,we.F13,we.F14,we.F15,we.F16,we.F17,we.F18,we.F19,we.HOME,we.INSERT,we.MEDIA_NEXT,we.MEDIA_PLAY_PAUSE,we.MEDIA_PREV,we.MEDIA_STOP,we.NULL,we.NUM_LOCK,we.PAGE_DOWN,we.PAGE_UP,we.PAUSE,we.SCROLL_LOCK,we.SHIFT,we.TAB];function HP(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function Fy(t){return rz.includes(t)}function iz(t){const e=[];return Ec()?e.push(we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX):e.push(we.CONTROL),e.includes(t)}function DP(t){return[we.CONTROL,we.COMMAND_LEFT,we.COMMAND_RIGHT,we.COMMAND_FIREFOX].includes(t)}function Bl(t,e){const n=e.split("|");let r=!1;return E(n,i=>{if(t===we[i])return r=!0,!1}),r}const oz=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:we,isCtrlKey:iz,isCtrlMetaKey:DP,isFunctionKey:Fy,isKey:Bl,isPrintableChar:HP},Symbol.toStringTag,{value:"Module"}));function Lr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ko(t){return t.isImmediatePropagationEnabled===!1}function fs(t){return t.button===2}function kg(t){return t.button===0}function NP(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const sz=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ko,isLeftClick:kg,isRightClick:fs,offsetRelativeTo:NP,stopImmediatePropagation:Lr},Symbol.toStringTag,{value:"Module"}));function gt(){ue(console)&&console.warn(...arguments)}function Wy(){ue(console)&&console.error(...arguments)}function az(t,e,n){return e=lz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lz(t){var e=uz(t,"string");return typeof e=="symbol"?e:String(e)}function uz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ma=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],cz=ht`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,ow=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),sw=new Map([[]]);class LP{static getSingleton(){return dz()}constructor(){az(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return E(Ma,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))E(n,i=>this.add(e,i,r));else{ow.has(e)&&gt(yy(cz,{hookName:e,removedInVersion:ow.get(e)})),sw.has(e)&&gt(sw.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&E(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?E(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Mf(u[h],e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=Mf(u[h],e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ge(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||Ma.push(e)}deregister(e){this.isRegistered(e)&&Ma.splice(Ma.indexOf(e),1)}isDeprecated(e){return sw.has(e)||ow.has(e)}isRegistered(e){return Ma.indexOf(e)>=0}getRegistered(){return Ma}}const hz=new LP;function dz(){return hz}const de=LP,aw=new Map;function ai(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";aw.has(t)||aw.set(t,new Map);const e=aw.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const Wv=new WeakMap,{register:fz,getItem:$P,hasItem:kP,getNames:gz,getValues:Cue}=ai("editors");function mz(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},de.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function FP(t,e){let n;if(typeof t=="function")Wv.get(t)||er(null,t),n=Wv.get(t);else if(typeof t=="string")n=$P(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Af(t){if(typeof t=="function")return t;if(!kP(t))throw Error(`No registered editor found under "${t}" name`);return $P(t).getConstructor()}function er(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new mz(e);typeof t=="string"&&fz(t,n),Wv.set(e,n)}function pz(t,e,n){return e=wz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wz(t){var e=Cz(t,"string");return typeof e=="symbol"?e:String(e)}function Cz(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Kd=0;class vz{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;pz(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,Sz(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Kd+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Kd-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Kd-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function Sz(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Lr(this)},t}const xr=vz;function yz(){return Kd}function D0(t,e){bz(t,e),e.add(t)}function bz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oo(t,e,n){return e=Rz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rz(t){var e=Ez(t,"string");return typeof e=="symbol"?e:String(e)}function Ez(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function N0(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Fg="editorManager.navigation";var L0=new WeakSet,$0=new WeakSet;class Vv{constructor(e,n,r){D0(this,$0),D0(this,L0),Oo(this,"hot",void 0),Oo(this,"tableMeta",void 0),Oo(this,"selection",void 0),Oo(this,"eventManager",void 0),Oo(this,"destroyed",!1),Oo(this,"lock",!1),Oo(this,"activeEditor",void 0),Oo(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new xr(e),this.hot.addHook("afterDocumentKeyDown",i=>N0(this,L0,Tz).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>N0(this,$0,_z).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i);let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=FP(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Tz(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ko(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Fy(n)&&!DP(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>ue(this.hot.getSelected()),group:Fg};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function _z(t,e){e.isCell()&&this.openEditor(null,t,!0)}const k0=new WeakMap;Vv.getInstance=function(t,e,n){let r=k0.get(t);return r||(r=new Vv(t,e,n),k0.set(t,r)),r};const Mz=Vv;function yh(t,e){WP(t,e),e.add(t)}function eu(t,e,n){WP(t,e),e.set(t,n)}function WP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Lt(t,e){var n=VP(t,e,"get");return Az(t,n)}function Az(t,e){return e.get?e.get.call(t):e.value}function tu(t,e,n){var r=VP(t,e,"set");return Oz(t,r,n),n}function VP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Oz(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const es=Object.freeze({CELL:"cell",MIXED:"mixed"});var gn=new WeakMap,bh=new WeakMap,Rh=new WeakMap,Eh=new WeakMap,Th=new WeakMap,Of=new WeakSet,F0=new WeakSet,W0=new WeakSet,V0=new WeakSet;class Iz{constructor(e){var n=this;yh(this,V0),yh(this,W0),yh(this,F0),yh(this,Of),eu(this,gn,{writable:!0,value:void 0}),eu(this,bh,{writable:!0,value:void 0}),eu(this,Rh,{writable:!0,value:50}),eu(this,Eh,{writable:!0,value:null}),eu(this,Th,{writable:!0,value:new Map});const r=e.getSettings();tu(this,gn,e),tu(this,bh,r.imeFastEdit?es.MIXED:es.CELL),Lt(this,gn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Sl(n,V0,Hz).call(n,...o)}),Lt(this,gn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Sl(n,F0,Pz).call(n,...o)}),Lt(this,gn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Sl(n,W0,xz).call(n,...o)})}getFocusMode(){return Lt(this,bh)}setFocusMode(e){Object.values(es).includes(e)?tu(this,bh,e):gt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Lt(this,Rh)}setRefocusDelay(e){tu(this,Rh,e)}setRefocusElementGetter(e){tu(this,Eh,e)}getRefocusElement(){if(typeof Lt(this,Eh)=="function")return Lt(this,Eh).call(this);var e;return(e=Lt(this,gn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Lt(this,gn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Lt(this,gn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Lt(this,gn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Sl(this,Of,Vy).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lt(this,Rh);const r=this.getRefocusElement();Lt(this,gn).getSettings().imeFastEdit&&!((e=Lt(this,gn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Lt(this,Th).has(n)||Lt(this,Th).set(n,Dg(()=>{r.select()},n)),Lt(this,Th).get(n)())}}function Vy(t){var e;const n=(e=Lt(this,gn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Lt(this,gn).selection.isCellVisible(n)){t(null);return}const r=Lt(this,gn).getCell(n.row,n.col,!0);r===null?Lt(this,gn).addHookOnce("afterScroll",()=>{t(Lt(this,gn).getCell(n.row,n.col,!0))}):t(r)}function Pz(){Sl(this,Of,Vy).call(this,t=>{const{activeElement:e}=Lt(this,gn).rootDocument;e&&Hg(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function xz(){Sl(this,Of,Vy).call(this,t=>{this.getFocusMode()===es.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function Hz(t){t.imeFastEdit&&this.getFocusMode()!==es.MIXED?this.setFocusMode(es.MIXED):!t.imeFastEdit&&this.getFocusMode()!==es.CELL&&this.setFocusMode(es.CELL)}const BP={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Dz=new RegExp(Object.keys(BP).map(t=>`(${t})`).join("|"),"gi");function Nz(t){return(t&&t.nodeName||"")==="TABLE"}function Bv(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const g=e&&d===0,p=[];for(let S=0;S<s;S+=1){const y=!g&&n&&S===0;let R="";if(g)R=`<th>${t.getColHeader(S-c)}</th>`;else if(y)R=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][S],{hidden:N,rowspan:I,colspan:F}=t.getCellMeta(d-h,S-c);if(!N){const B=[];if(I&&B.push(`rowspan="${I}"`),F&&B.push(`colspan="${F}"`),Zt(T))R=`<td ${B.join(" ")}></td>`;else{const ee=T.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${B.join(" ")}>${ee}</td>`}}}p.push(R)}const C=["<tr>",...p,"</tr>"].join("");g?l.splice(1,0,C):u.splice(-1,0,C)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Uv(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Zt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function UP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,N=>{const I=N.match(/<td\b[^>]*?>/g)[0],F=N.substring(I.length,N.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${I}${F}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!Nz(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,N)=>T+N.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,g=0,p=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(N=>{const I=N.querySelector("td")!==null;return I&&h.push(N),!I});g=T.length,d=g>0,g>1?n.nestedHeaders=Array.from(T).reduce((N,I)=>{const F=Array.from(I.cells).reduce((B,ee,U)=>{if(a&&U===0)return B;const{colSpan:j,innerHTML:re}=ee,ie=j>1?{label:re,colspan:j}:re;return B.push(ie),B},[]);return N.push(F),N},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((N,I,F)=>(a&&F===0||N.push(I.innerHTML),N),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const C=[...h,...Array.from(o.tBodies).reduce((T,N)=>(T.push(...Array.from(N.rows)),T),[]),...c];p=C.length;const S=new Array(p);for(let T=0;T<p;T++)S[T]=new Array(u);const y=[],R=[];for(let T=0;T<p;T++){const N=C[T],I=Array.from(N.cells),F=I.length;for(let B=0;B<F;B++){const ee=I[B],{nodeName:U,innerHTML:j,rowSpan:re,colSpan:ie}=ee,oe=S[T].findIndex(Ce=>Ce===void 0);if(U==="TD"){if(re>1||ie>1){for(let We=T;We<T+re;We++)if(We<p)for(let pe=oe;pe<oe+ie;pe++)S[We][pe]=null;const Me=ee.getAttribute("style");Me&&Me.includes("mso-ignore:colspan")||y.push({col:oe,row:T,rowspan:re,colspan:ie})}let Ce="";s&&/excel/gi.test(s.content)?Ce=j.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):Ce=j.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[T][oe]=Ce.replace(Dz,Me=>BP[Me])}else R.push(j)}}return y.length&&(n.mergeCells=y),R.length&&(n.rowHeaders=R),S.length&&(n.data=S),n}const Lz=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Uv,htmlToGridSettings:UP,instanceToHTML:Bv},Symbol.toStringTag,{value:"Module"}));function Vn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function YP(t){return Vn(t,[","])}function me(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function If(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function By(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function or(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const $z=Object.freeze(Object.defineProperty({__proto__:null,clamp:or,isNumeric:Vn,isNumericLike:YP,rangeEach:me,rangeEachReverse:If,valueAccordingPercent:By},Symbol.toStringTag,{value:"Module"})),Yv="asc",kz="desc",B0=new Map([[Yv,[-1,1]],[kz,[1,-1]]]),Fz=t=>`The priority '${t}' is already declared in a map.`,Wz=t=>`The priority '${t}' is not a number.`;function Vz(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Ct(t)?t:Fz,e=Ct(e)?e:Wz;function r(o,s){if(!Vn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yv;const[s,a]=B0.get(o)||B0.get(Yv);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const Bz=t=>`The id '${t}' is already declared in a map.`;function Wg(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Ct(t)?t:Bz;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,g]=h;return u===g?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const Uz=t=>`'${t}' value is already declared in a unique set.`;function Yz(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Ct(t)?t:Uz;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const Uy=t=>`There is already registered "${t}" plugin.`,Gz=t=>`There is already registered plugin on priority "${t}".`,zz=t=>`The priority "${t}" is not a number.`,GP=Vz({errorPriorityExists:Gz,errorPriorityNaN:zz}),zP=Yz({errorItemExists:Uy}),Gv=Wg({errorIdExists:Uy});function Yy(){return[...GP.getItems(),...zP.getItems()]}function jc(t){const e=Tn(t);return Gv.getItem(e)}function jz(t){return!!jc(t)}function ke(t,e,n){[t,e,n]=Xz(t,e,n),jc(t)===void 0&&Kz(t,e,n)}function Kz(t,e,n){const r=Tn(t);if(Gv.hasItem(r))throw new Error(Uy(r));n===void 0?zP.addItem(r):GP.addItem(n,r),Gv.addItem(r,e)}function Xz(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:qz,getItem:Zz,hasItem:jP,getNames:Jz,getValues:vue}=ai("renderers");function Pf(t){if(typeof t=="function")return t;if(!jP(t))throw Error(`No registered renderer found under "${t}" name`);return Zz(t)}function ur(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),qz(t,e)}const{register:Qz,getItem:ej,hasItem:KP,getNames:tj,getValues:Sue}=ai("validators");function Gy(t){if(typeof t=="function")return t;if(!KP(t))throw Error(`No registered validator found under "${t}" name`);return ej(t)}function ta(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Qz(t,e)}function _h(t,e,n){return e=nj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nj(t){var e=rj(t,"string");return typeof e=="symbol"?e:String(e)}function rj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ij{constructor(e){_h(this,"count",0),_h(this,"startColumn",0),_h(this,"endColumn",0),_h(this,"startPosition",0),this.count=e.totalColumns,this.endColumn=this.count-1}}function Mh(t,e,n){return e=oj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oj(t){var e=sj(t,"string");return typeof e=="symbol"?e:String(e)}function sj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aj{constructor(e){Mh(this,"count",0),Mh(this,"startRow",0),Mh(this,"endRow",0),Mh(this,"startPosition",0),this.count=e.totalRows,this.endRow=this.count-1}}var XP={},lj=LO,uj=KS,cj=Object.keys||function(e){return lj(e,uj)},hj=Ni,dj=OO,fj=Cs,gj=vs,mj=hg,pj=cj;XP.f=hj&&!dj?Object.defineProperties:function(e,n){gj(e);for(var r=mj(n),i=pj(n),o=i.length,s=0,a;o>s;)fj.f(e,a=i[s++],r[a]);return e};var wj=vs,Cj=XP,U0=KS,vj=GS,Sj=JO,yj=US,bj=xO,Y0=">",G0="<",zv="prototype",jv="script",qP=bj("IE_PROTO"),lw=function(){},ZP=function(t){return G0+jv+Y0+t+G0+"/"+jv+Y0},z0=function(t){t.write(ZP("")),t.close();var e=t.parentWindow.Object;return t=null,e},Rj=function(){var t=yj("iframe"),e="java"+jv+":",n;return t.style.display="none",Sj.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(ZP("document.F=Object")),n.close(),n.F},Ah,Xd=function(){try{Ah=new ActiveXObject("htmlfile")}catch{}Xd=typeof document<"u"?document.domain&&Ah?z0(Ah):Rj():z0(Ah);for(var t=U0.length;t--;)delete Xd[zv][U0[t]];return Xd()};vj[qP]=!0;var Ej=Object.create||function(e,n){var r;return e!==null?(lw[zv]=wj(e),r=new lw,lw[zv]=null,r[qP]=e):r=Xd(),n===void 0?r:Cj.f(r,n)},Tj=$l,_j=Ej,Mj=Cs.f,Kv=Tj("unscopables"),Xv=Array.prototype;Xv[Kv]===void 0&&Mj(Xv,Kv,{configurable:!0,value:_j(null)});var JP=function(t){Xv[Kv][t]=!0},Aj=Ss,Oj=gg,Ij=$c,Pj=jS,xj=JP;Aj({target:"Array",proto:!0},{at:function(e){var n=Oj(this),r=Ij(n),i=Pj(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});xj("at");const Go=1,bn=2;function Hj(t,e,n){Dj(t,e),e.set(t,n)}function Dj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nu(t,e,n){return e=Nj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nj(t){var e=Lj(t,"string");return typeof e=="symbol"?e:String(e)}function Lj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aa(t,e){var n=QP(t,e,"get");return $j(t,n)}function $j(t,e){return e.get?e.get.call(t):e.value}function kj(t,e,n){var r=QP(t,e,"set");return Fj(t,r,n),n}function QP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Fj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Io=new WeakMap;class Kc{static get DEFAULT_WIDTH(){return 50}constructor(e){nu(this,"count",0),nu(this,"startColumn",null),nu(this,"endColumn",null),nu(this,"startPosition",null),nu(this,"isVisibleInTrimmingContainer",!1),Hj(this,Io,{writable:!0,value:void 0}),kj(this,Io,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=Aa(this,Io),s=Math.max(Aa(this,Io).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,d=0,g=0;for(let y=0;y<i;y++)if(h=this._getColumnWidth(y),l<=s&&e!==bn&&(this.startColumn=y,d=h),l>=s&&l+(e===bn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y,d=h),this.endColumn=y),c.push(l),l+=h,g=h,e!==bn&&(this.endColumn=y),l>=s+o){u=!1;break}const p=r+o-a,C=e===bn?0:g,S=e===bn?d:0;if(p<-1*Aa(this,Io).inlineStartOffset||r>c.at(-1)+C||-1*Aa(this,Io).scrollOffset-Aa(this,Io).viewportWidth>-1*S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=c[this.endColumn]+h-c[this.startColumn-1];if((y<=o||e!==bn)&&(this.startColumn-=1),y>o)break}e===Go&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(e){let n=Aa(this,Io).columnWidthFn(e);return isNaN(n)&&(n=Kc.DEFAULT_WIDTH),n}}function Wj(t,e,n){Vj(t,e),e.set(t,n)}function Vj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ru(t,e,n){return e=Bj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bj(t){var e=Uj(t,"string");return typeof e=="symbol"?e:String(e)}function Uj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uw(t,e){var n=ex(t,e,"get");return Yj(t,n)}function Yj(t,e){return e.get?e.get.call(t):e.value}function Gj(t,e,n){var r=ex(t,e,"set");return zj(t,r,n),n}function ex(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var iu=new WeakMap;class Vg{static get DEFAULT_HEIGHT(){return 23}constructor(e){ru(this,"count",0),ru(this,"startRow",null),ru(this,"endRow",null),ru(this,"startPosition",null),ru(this,"isVisibleInTrimmingContainer",!1),Wj(this,iu,{writable:!0,value:void 0}),Gj(this,iu,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=uw(this,iu),a=Math.max(uw(this,iu).scrollOffset,0),l=uw(this,iu).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let d,g=0,p=0;for(let R=0;R<o;R++)if(d=r(R),isNaN(d)&&(d=Vg.DEFAULT_HEIGHT),u<=a&&e!==bn&&(this.startRow=R,g=d),u>=a&&u+(e===bn?d:0)<=a+s-l&&(this.startRow===null&&(this.startRow=R,g=d),this.endRow=R),h.push(u),u+=d,p=d,e!==bn&&(this.endRow=R),u>=a+s-l){c=!1;break}const C=i+s-l,S=e===bn?g:0,y=e===bn?0:p;if(C<S||i>h.at(-1)+y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const R=h[this.endRow]+d-h[this.startRow-1];if((R<=s-l||e!==bn)&&(this.startRow-=1),R>=s-l)break}e===Go&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jj(t,e,n){Kj(t,e),e.set(t,n)}function Kj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j0(t,e,n){return e=Xj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xj(t){var e=qj(t,"string");return typeof e=="symbol"?e:String(e)}function qj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oa(t,e){var n=tx(t,e,"get");return Zj(t,n)}function Zj(t,e){return e.get?e.get.call(t):e.value}function K0(t,e,n){var r=tx(t,e,"set");return Jj(t,r,n),n}function tx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Jj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ui=new WeakMap;class xf{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;j0(this,"row",null),j0(this,"col",null),jj(this,Ui,{writable:!0,value:!1}),K0(this,Ui,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Oa(this,Ui)}isSouthEastOf(e){return this.row>=e.row&&(Oa(this,Ui)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Oa(this,Ui)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Oa(this,Ui)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Oa(this,Ui)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof xf&&K0(this,Ui,e.isRtl()),this}clone(){return new xf(this.row,this.col,Oa(this,Ui))}toObject(){return{row:this.row,col:this.col}}}const Hf=xf;function Qj(t,e,n){eK(t,e),e.set(t,n)}function eK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cw(t,e,n){return e=tK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tK(t){var e=nK(t,"string");return typeof e=="symbol"?e:String(e)}function nK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vr(t,e){var n=nx(t,e,"get");return rK(t,n)}function rK(t,e){return e.get?e.get.call(t):e.value}function iK(t,e,n){var r=nx(t,e,"set");return oK(t,r,n),n}function nx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function oK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var jn=new WeakMap;class zy{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;cw(this,"highlight",null),cw(this,"from",null),cw(this,"to",null),Qj(this,jn,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),iK(this,jn,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),d=this._createCellCoords(u,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return vr(this,jn)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return vr(this,jn)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return vr(this,jn)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return vr(this,jn)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return vr(this,jn)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return vr(this,jn)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return vr(this,jn)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return vr(this,jn)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Hf))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(vr(this,jn)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(vr(this,jn)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new zy(this.highlight,this.from,this.to,vr(this,jn))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Hf(e,n,vr(this,jn))}}const jy=zy;function ui(t,e,n){sK(t,e),e.set(t,n)}function sK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ve(t,e){var n=rx(t,e,"get");return aK(t,n)}function aK(t,e){return e.get?e.get.call(t):e.value}function Po(t,e,n){var r=rx(t,e,"set");return lK(t,r,n),n}function rx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Sr=new WeakMap,hw=new WeakMap,on=new WeakMap,Ia=new WeakMap,Oh=new WeakMap,kr=new WeakMap,dw=new WeakMap,ou=new WeakMap,_s=new WeakMap,ci=new WeakMap;let uK=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ui(this,Sr,{writable:!0,value:void 0}),ui(this,hw,{writable:!0,value:void 0}),ui(this,on,{writable:!0,value:void 0}),ui(this,Ia,{writable:!0,value:void 0}),ui(this,Oh,{writable:!0,value:void 0}),ui(this,kr,{writable:!0,value:void 0}),ui(this,dw,{writable:!0,value:void 0}),ui(this,ou,{writable:!0,value:void 0}),ui(this,_s,{writable:!0,value:[null,null]}),ui(this,ci,{writable:!0,value:[null,null]}),Po(this,Sr,r),Po(this,hw,n),Po(this,on,o),Po(this,Ia,s),Po(this,Oh,a),Po(this,kr,i),Po(this,dw,e),this.registerEvents()}registerEvents(){ve(this,kr).addEventListener(ve(this,on).holder,"contextmenu",r=>this.onContextMenu(r)),ve(this,kr).addEventListener(ve(this,on).TABLE,"mouseover",r=>this.onMouseOver(r)),ve(this,kr).addEventListener(ve(this,on).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{ve(this,kr).addEventListener(ve(this,on).holder,"touchstart",r=>this.onTouchStart(r)),ve(this,kr).addEventListener(ve(this,on).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),ve(this,kr).addEventListener(ve(this,on).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ve(this,Sr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ve(this,Sr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ve(this,kr).addEventListener(ve(this,on).holder,"mouseup",r=>this.onMouseUp(r)),ve(this,kr).addEventListener(ve(this,on).holder,"mousedown",r=>this.onMouseDown(r))};uo()?e():(Dy()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(ve(this,ou)&&r){const[i,o]=[r.row,ve(this,ou).from.row],[s,a]=[r.col,ve(this,ou).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=ve(this,on).TABLE,i=Uu(e,["TD","TH"],r);return i?(n.coords=ve(this,on).getCoords(i),n.TD=i):Ie(e,"wtBorder")&&Ie(e,"current")?(n.coords=ve(this,Ia).getFocusSelection().cellRange.highlight,n.TD=ve(this,on).getCell(n.coords)):Ie(e,"wtBorder")&&Ie(e,"area")&&ve(this,Ia).getAreaSelection().cellRange&&(n.coords=ve(this,Ia).getAreaSelection().cellRange.to,n.TD=ve(this,on).getCell(n.coords)),n}onMouseDown(e){const n=ve(this,hw).rootDocument.activeElement,r=Hy(aP,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Ie(i,"corner")?ve(this,Sr).getSetting("onCellCornerMouseDown",e,i):o.TD&&ve(this,Sr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(ve(this,ci)[0]=o.TD,clearTimeout(ve(this,_s)[0]),ve(this,_s)[0]=setTimeout(()=>{ve(this,ci)[0]=null},1e3))}onContextMenu(e){if(ve(this,Sr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ve(this,Sr).has("onCellMouseOver"))return;const n=ve(this,on).TABLE,r=Uu(e.target,["TD","TH"],n),i=ve(this,Oh)||this;r&&r!==i.lastMouseOver&&os(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,ve(this,on).getCoords(r),r))}onMouseOut(e){if(!ve(this,Sr).has("onCellMouseOut"))return;const n=ve(this,on).TABLE,r=Uu(e.target,["TD","TH"],n),i=Uu(e.relatedTarget,["TD","TH"],n),o=ve(this,Oh)||this;r&&r!==i&&os(r,n)&&(this.callListener("onCellMouseOut",e,ve(this,on).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ve(this,Sr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ve(this,ci)[0]&&n.TD===ve(this,ci)[1]?(Ie(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ve(this,ci)[0]=null,ve(this,ci)[1]=null):n.TD===ve(this,ci)[0]&&(ve(this,ci)[1]=n.TD,clearTimeout(ve(this,_s)[1]),ve(this,_s)[1]=setTimeout(()=>{ve(this,ci)[1]=null},500)))}onTouchStart(e){Po(this,ou,ve(this,Ia).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&ve(this,Sr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];$y()&&(IP()||PP())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=ve(this,Sr).getSettingPure(e);o&&o(n,r,i,ve(this,dw).call(this))}destroy(){clearTimeout(ve(this,_s)[0]),clearTimeout(ve(this,_s)[1]),ve(this,kr).destroy()}};const ix=uK;function fw(t,e,n){return e=cK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cK(t){var e=hK(t,"string");return typeof e=="symbol"?e:String(e)}function hK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dK{constructor(e,n,r){fw(this,"offset",void 0),fw(this,"total",void 0),fw(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const fK=dK;function gw(t,e,n){return e=gK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gK(t){var e=mK(t,"string");return typeof e=="symbol"?e:String(e)}function mK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pK{constructor(e,n,r){gw(this,"offset",void 0),gw(this,"total",void 0),gw(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const wK=pK,CK=0,Df=1,Nf=2;function Ih(t,e,n){return e=vK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vK(t){var e=SK(t,"string");return typeof e=="symbol"?e:String(e)}function SK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X0{constructor(){Ih(this,"currentSize",0),Ih(this,"nextSize",0),Ih(this,"currentOffset",0),Ih(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function mw(t,e,n){return e=yK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yK(t){var e=bK(t,"string");return typeof e=="symbol"?e:String(e)}function bK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RK{constructor(){mw(this,"size",new X0),mw(this,"workingSpace",CK),mw(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof X0}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Df,e.workingSpace=Nf,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Nf,e.workingSpace=Df,this.sharedSize=e.getViewSize()}}function Pa(t,e,n){return e=EK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EK(t){var e=TK(t,"string");return typeof e=="symbol"?e:String(e)}function TK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ox{constructor(e,n,r){Pa(this,"rootNode",void 0),Pa(this,"nodesPool",void 0),Pa(this,"sizeSet",new RK),Pa(this,"childNodeType",void 0),Pa(this,"visualIndex",0),Pa(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(Df))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Nf)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(Df);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Nf)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class sx extends ox{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function _K(t,e,n){return e=MK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MK(t){var e=AK(t,"string");return typeof e=="symbol"?e:String(e)}function AK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OK{constructor(e){_K(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function su(t,e,n){return e=IK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IK(t){var e=PK(t,"string");return typeof e=="symbol"?e:String(e)}function PK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xc{constructor(e,n){su(this,"nodesPool",null),su(this,"nodeType",void 0),su(this,"rootNode",void 0),su(this,"table",null),su(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new OK(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function q0(t,e,n){return e=xK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xK(t){var e=HK(t,"string");return typeof e=="symbol"?e:String(e)}function HK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DK extends Xc{constructor(){super("TH"),q0(this,"orderViews",new WeakMap),q0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new sx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),va(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ee(d,[rG(),hG(),Ry(h+1),Wl(-1)]),n[h](a,d,h)}u.end()}}}class NK extends Xc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&oi(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Ee(this.rootNode,[nP()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Ee(s,[$v(),sP(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),va(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Ee(u,[Ry(a+1+this.table.rowHeadersCount),Wl(-1),iG(),...a>=0?[cG()]:[$v()]]),r[n](l,u,n)}}}}let Z0=!1;class LK extends Xc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!Z0&&e>1e3&&(Z0=!0,gt(ht`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&q(r,"rowHeader")}}function $K(t,e,n){return e=kK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kK(t){var e=FK(t,"string");return typeof e=="symbol"?e:String(e)}function FK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let J0=!1;class WK extends Xc{constructor(e){super("TR",e),$K(this,"orderView",void 0),this.orderView=new ox(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!J0&&e>1e3&&(J0=!0,gt(ht`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Ee(this.rootNode,[nP()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Ee(o,[$v(),sP(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function Q0(t,e,n){return e=VK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VK(t){var e=BK(t,"string");return typeof e=="symbol"?e:String(e)}function BK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UK extends Xc{constructor(){super("TD"),Q0(this,"orderViews",new WeakMap),Q0(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new sx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){c.render();const g=c.getCurrentNode(),p=this.table.renderedColumnToSource(d);if(Ie(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),va(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,p,g),this.table.isAriaEnabled()){var o,s;Ee(g,[...g.hasAttribute("role")?[]:[nG()],Wl(-1),Ry(p+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function sn(t,e,n){return e=YK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YK(t){var e=GK(t,"string");return typeof e=="symbol"?e:String(e)}function GK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zK{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sn(this,"rootNode",void 0),sn(this,"rootDocument",void 0),sn(this,"rowHeaders",null),sn(this,"columnHeaders",null),sn(this,"colGroup",null),sn(this,"rows",null),sn(this,"cells",null),sn(this,"rowFilter",null),sn(this,"columnFilter",null),sn(this,"rowUtils",null),sn(this,"columnUtils",null),sn(this,"rowsToRender",0),sn(this,"columnsToRender",0),sn(this,"rowHeaderFunctions",[]),sn(this,"rowHeadersCount",0),sn(this,"columnHeaderFunctions",[]),sn(this,"columnHeadersCount",0),sn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class jK{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new zK(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new DK,columnHeaders:new NK(n),colGroup:new LK(r),rows:new WK(i),cells:new UK}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function au(t,e,n){KK(t,e),e.set(t,n)}function KK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ph(t,e,n){return e=XK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XK(t){var e=qK(t,"string");return typeof e=="symbol"?e:String(e)}function qK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pn(t,e){var n=ax(t,e,"get");return ZK(t,n)}function ZK(t,e){return e.get?e.get.call(t):e.value}function lu(t,e,n){var r=ax(t,e,"set");return JK(t,r,n),n}function ax(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function JK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xh=new WeakMap,xa=new WeakMap,uu=new WeakMap,Hh=new WeakMap,Ms=new WeakMap;class Ky{static get DEFAULT_WIDTH(){return 50}constructor(e){let{totalColumns:n,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:o}=e;Ph(this,"stretchAllRatio",0),Ph(this,"stretchLastWidth",0),Ph(this,"stretchAllColumnsWidth",[]),au(this,xh,{writable:!0,value:0}),Ph(this,"needVerifyLastColumnWidth",!0),au(this,xa,{writable:!0,value:()=>0}),au(this,uu,{writable:!0,value:s=>s}),au(this,Hh,{writable:!0,value:s=>s}),au(this,Ms,{writable:!0,value:()=>"none"}),lu(this,xa,n),lu(this,Ms,r),lu(this,uu,i??pn(this,uu)),lu(this,Hh,o??pn(this,Hh))}refreshStretching(e){if(pn(this,Ms).call(this)==="none")return;lu(this,xh,e);let n=0;for(let i=0;i<pn(this,xa).call(this);i++){const o=this._getColumnWidth(i),s=pn(this,uu).call(this,void 0,i);typeof s=="number"?e-=s:n+=o}const r=e-n;if(pn(this,Ms).call(this)==="all"&&r>0)this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(pn(this,Ms).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(pn(this,xa).call(this)-1),o=r+i;this.stretchLastWidth=o>=0?o:i}}getStretchedColumnWidth(e,n){let r=null;return pn(this,Ms).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):pn(this,Ms).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(n*this.stretchAllRatio),o=pn(this,uu).call(this,i,e);o===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===pn(this,xa).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==pn(this,xh)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=pn(this,xh)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===pn(this,xa).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=pn(this,Hh).call(this,e);return isNaN(n)&&(n=Ky.DEFAULT_WIDTH),n}}function Dh(t,e,n){return e=QK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QK(t){var e=e3(t,"string");return typeof e=="symbol"?e:String(e)}function e3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t3{constructor(e,n){Dh(this,"dataAccessObject",void 0),Dh(this,"wtSettings",void 0),Dh(this,"headerWidths",new Map),Dh(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=n,this.stretching=new Ky({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let n=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,n);return r&&(n=r),n}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:n,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,o=i.offsetHeight<i.scrollHeight?nn():0;this.stretching.refreshStretching(n.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function eE(t,e,n){return e=n3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n3(t){var e=r3(t,"string");return typeof e=="symbol"?e:String(e)}function r3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class i3{constructor(e,n){eE(this,"dataAccessObject",void 0),eE(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function hi(t,e,n){return e=o3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o3(t){var e=s3(t,"string");return typeof e=="symbol"?e:String(e)}function s3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class a3{constructor(e,n,r,i,o){hi(this,"wtSettings",null),hi(this,"domBindings",void 0),hi(this,"TBODY",null),hi(this,"THEAD",null),hi(this,"COLGROUP",null),hi(this,"hasTableHeight",!0),hi(this,"hasTableWidth",!0),hi(this,"isTableVisible",!1),hi(this,"tableOffset",0),hi(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,Ty(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new i3(this.dataAccessObject,this.wtSettings),this.columnUtils=new t3(this.dataAccessObject,this.wtSettings),this.tableRenderer=new jK({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Ee(r,[Pi()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ee(r,[Pi()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Ee(r.parentNode,[Pi()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Ee(r,[Pi()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,d=e;if(this.isMaster&&(this.holderOffset=en(this.holder),d=i.createRenderCalculators(d),l&&!n.getSetting("fixedColumnsStart"))){const p=r.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,C!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=en(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const p=o>0?this.getFirstRenderedRow():0,C=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new wK(p,o,c),this.columnFilter=new fK(C,s,l);let S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),S=y.skipRender!==!0}if(S){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(Oi)||this.is(as))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let y;if(this.isMaster&&(y=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Oi))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const R=ft(this.hider),T=ft(this.TABLE);R!==0&&T!==R&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Oi)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=ra(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Oi))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=cs(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=cP(r),s=n.cellIndex;return Uo(fa,n,this.wtRootElement)||Uo(ha,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Uo(as,n,this.wtRootElement)||Uo(Oi,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),Uo(fa,n,this.wtRootElement)||Uo(da,n,this.wtRootElement)||Uo(as,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=ra(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=ra(l):o=ra(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ft(this.TABLE)}getHeight(){return xt(this.TABLE)}getTotalWidth(){const e=ft(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=xt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ds(this.TABLE)}_modifyRowHeaderWidth(e){let n=Ct(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Ul=a3,l3="stickyRowsBottom",lx={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Fi(lx,"MIXIN_NAME",l3,{writable:!1,enumerable:!1});const ux=lx,u3="stickyColumnsStart",cx={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Fi(cx,"MIXIN_NAME",u3,{writable:!1,enumerable:!1});const Xy=cx;class qy extends Ul{constructor(e,n,r,i){super(e,n,r,i,as)}}pt(qy,ux);pt(qy,Xy);const c3=qy,ha="top",Oi="bottom",da="inline_start",fa="top_inline_start_corner",as="bottom_inline_start_corner",h3=[ha,Oi,da,fa,as],d3=new Map([[ha,`ht_clone_${ha}`],[Oi,`ht_clone_${Oi}`],[da,`ht_clone_${da} ht_clone_left`],[fa,`ht_clone_${fa} ht_clone_top_left_corner`],[as,`ht_clone_${as} ht_clone_bottom_left_corner`]]);function pw(t,e,n){return e=f3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f3(t){var e=g3(t,"string");return typeof e=="symbol"?e:String(e)}function g3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m3{constructor(e){pw(this,"dataAccessObject",void 0),pw(this,"lastScrolledColumnPos",-1),pw(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?d=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(d=h.scrollTo(e,l?e>a:r)),d&&(this.lastScrolledRowPos=e),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=en(n.wtRootElement),l=Pg(o,o);if(a.top>l){const u=ra(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-g)}else u=en(r.wtRootElement).left;const c=Math.abs(My(s,s));if(u>c){const h=Ay(s);let d=i.getRowHeaderWidth();for(let g=1;g<=o;g++)if(d+=n.sumCellSizes(g-1,g),u+d-c>=h){a=g-2;break}}}return a}}const p3=m3;function Fr(t,e,n){return e=w3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w3(t){var e=C3(t,"string");return typeof e=="symbol"?e:String(e)}function C3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zy{get eventManager(){return new xr(this)}constructor(e,n){Fr(this,"wtTable",void 0),Fr(this,"wtScroll",void 0),Fr(this,"wtViewport",void 0),Fr(this,"wtOverlays",void 0),Fr(this,"selectionManager",void 0),Fr(this,"wtEvent",void 0),Fr(this,"guid",`wt_${vy()}`),Fr(this,"drawInterrupted",!1),Fr(this,"drawn",!1),Fr(this,"domBindings",void 0),Fr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new p3(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){hs(r,e[n])}])}}createCellCoords(e,n){return new Hf(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new jy(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function tE(t,e,n){return e=v3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v3(t){var e=S3(t,"string");return typeof e=="symbol"?e:String(e)}function S3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y3 extends Zy{constructor(e,n,r){super(e,n),tE(this,"cloneSource",void 0),tE(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new ix(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function b3(t,e,n){return e=R3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R3(t){var e=E3(t,"string");return typeof e=="symbol"?e:String(e)}function E3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qc{constructor(e,n,r,i,o){b3(this,"wtSettings",null),Fi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=ca(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=ca(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=bc(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){gt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+nn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(h3.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${d3.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Ee(o,[Pi()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===ha||u==="vertical"&&this.type===da?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=bc(e.TABLE),new y3(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;E([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class T3 extends qc{constructor(e,n,r,i,o,s){super(e,n,as,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new c3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Yc(n),this.repositionOverlay();let r=xt(this.clone.wtTable.TABLE);const i=ft(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=nn(r)),i.style.bottom=`${o}px`}}const _3="calculatedColumns",hx={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Fi(hx,"MIXIN_NAME",_3,{writable:!1,enumerable:!1});const Jy=hx;class Qy extends Ul{constructor(e,n,r,i){super(e,n,r,i,Oi)}}pt(Qy,ux);pt(Qy,Jy);const M3=Qy;function A3(t,e,n){return e=O3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O3(t){var e=I3(t,"string");return typeof e=="symbol"?e:String(e)}function I3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class P3 extends qc{constructor(e,n,r,i){super(e,n,Oi,r,i),A3(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new M3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=nn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Ig(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=nn(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=xt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=nn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Pg(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ie(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(s,"innerBorderBottom"),o=!a):(Le(s,"innerBorderBottom"),o=a)}return o}}const x3="calculatedRows",dx={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Fi(dx,"MIXIN_NAME",x3,{writable:!1,enumerable:!1});const fx=dx;class eb extends Ul{constructor(e,n,r,i){super(e,n,r,i,da)}}pt(eb,fx);pt(eb,Xy);const H3=eb,D3="localHooks",gx={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)Mf(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Fi(gx,"MIXIN_NAME",D3,{writable:!1,enumerable:!1});const sr=gx;let mx=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};pt(mx,sr);const N3=mx,px="active-header",tb="header",nb="area",rb="focus",L3="fill",$3="row",k3="column",F3="custom-selection",ib=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var W3=JP;W3("flat");function V3(t,e){wx(t,e),e.add(t)}function nE(t,e,n){wx(t,e),e.set(t,n)}function wx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ww(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Gt(t,e){var n=Cx(t,e,"get");return B3(t,n)}function B3(t,e){return e.get?e.get.call(t):e.value}function rE(t,e,n){var r=Cx(t,e,"set");return U3(t,r,n),n}function Cx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function U3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wr=new WeakMap,qn=new WeakMap,Nh=new WeakSet;class Y3{constructor(){V3(this,Nh),nE(this,Wr,{writable:!0,value:void 0}),nE(this,qn,{writable:!0,value:void 0})}setActiveOverlay(e){return rE(this,qn,e),this}setActiveSelection(e){return rE(this,Wr,e),this}scan(){const e=Gt(this,Wr).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Gt(this,Wr).getCorners(),{wtTable:s}=Gt(this,qn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const g=d+l;let p=s.getColumnHeader(h,g);const C=Gt(this,qn).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Gt(this,Wr).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});C!==null&&(C!==h&&(p=s.getColumnHeader(C,g)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Gt(this,Wr).getCorners(),{wtTable:s}=Gt(this,qn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const g=d+l;let p=s.getRowHeader(h,g);const C=Gt(this,qn).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Gt(this,Wr).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});C!==null&&(C!==h&&(p=s.getRowHeader(C,g)),e(p))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=Gt(this,Wr).getCorners(),{wtTable:s}=Gt(this,qn);ww(this,Nh,Cw).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(Gt(this,qn).createCellCoords(a,l)),c=Gt(this,qn).getSetting("onAfterDrawSelection",a,l,Gt(this,Wr).settings.layerLevel);typeof c=="string"&&q(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=Gt(this,Wr).getCorners(),{wtTable:i}=Gt(this,qn);ww(this,Nh,Cw).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Gt(this,qn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Gt(this,Wr).getCorners(),{wtTable:i}=Gt(this,qn);ww(this,Nh,Cw).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Gt(this,qn).createCellCoords(o,s));e(a)}})}}function Cw(t){const{wtTable:e}=Gt(this,qn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class G3{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=ib,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Lr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),uo()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ge(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ge(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),p=parseInt(u.width,10),C=parseInt(c.width,10),S=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(r-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(r-C/4*3,10)}px`,c[l]=`${parseInt(i-C/4*3,10)}px`;const R=Math.min(parseInt(i+o,10),S-p-g*2),T=Math.min(parseInt(i+o-C/4,10),S-C-g*2);h[l]=`${R}px`,d[l]=`${T}px`;const N=Math.min(parseInt(r+s,10),y-p-g*2),I=Math.min(parseInt(r+s-C/4,10),y-C-g*2);h.top=`${N}px`,d.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let pe=0;pe<h;pe+=1){const f=n.rowFilter.renderedToSource(pe);if(f>=e[0]&&f<=e[2]){o=f,u=e[0];break}}for(let pe=h-1;pe>=0;pe-=1){const f=n.rowFilter.renderedToSource(pe);if(f>=e[0]&&f<=e[2]){s=f;break}}const d=n.getRenderedColumnsCount();for(let pe=0;pe<d;pe+=1){const f=n.columnFilter.renderedToSource(pe);if(f>=e[1]&&f<=e[3]){a=f,c=e[1];break}}for(let pe=d-1;pe>=0;pe-=1){const f=n.columnFilter.renderedToSource(pe);if(f>=e[1]&&f<=e[3]){l=f;break}}if(o===void 0||a===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(o,a));const p=o!==s||a!==l,C=p?n.getCell(this.wot.createCellCoords(s,l)):g,S=en(g),y=p?en(C):S,R=en(n.TABLE),T=ft(n.TABLE),N=S.top,I=S.left,F=this.wot.wtSettings.getSetting("rtlMode");let B=0,ee=0;if(F){const pe=ft(g),f=i.innerWidth-R.left-T;ee=I+pe-y.left,B=i.innerWidth-I-pe-f-1}else ee=y.left+ft(C)-I,B=I-R.left-1;if(this.isEntireColumnSelected(o,s)){const pe=this.getDimensionsFromHeader("columns",a,l,u,R);let f=null;pe&&([f,B,ee]=pe),f&&(g=f)}let U=N-R.top-1,j=y.top+xt(C)-N;if(this.isEntireRowSelected(a,l)){const pe=this.getDimensionsFromHeader("rows",o,s,c,R);let f=null;pe&&([f,U,j]=pe),f&&(g=f)}const re=Co(g,i);parseInt(re.borderTopWidth,10)>0&&(U+=1,j=j>0?j-1:0),parseInt(re[F?"borderRightWidth":"borderLeftWidth"],10)>0&&(B+=1,ee=ee>0?ee-1:0);const ie=F?"right":"left";this.topStyle.top=`${U}px`,this.topStyle[ie]=`${B}px`,this.topStyle.width=`${ee}px`,this.topStyle.display="block",this.startStyle.top=`${U}px`,this.startStyle[ie]=`${B}px`,this.startStyle.height=`${j}px`,this.startStyle.display="block";const oe=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${U+j-oe}px`,this.bottomStyle[ie]=`${B}px`,this.bottomStyle.width=`${ee}px`,this.bottomStyle.display="block",this.endStyle.top=`${U}px`,this.endStyle[ie]=`${B+ee-oe}px`,this.endStyle.height=`${j+1}px`,this.endStyle.display="block";let Ce=this.settings.border.cornerVisible;Ce=typeof Ce=="function"?Ce(this.settings.layerLevel):Ce;const Me=this.wot.getSetting("onModifyGetCellCoords",s,l);let[rt,We]=[s,l];if(Me&&Array.isArray(Me)&&([,,rt,We]=Me),uo()||!Ce||this.isPartRange(rt,We))this.cornerStyle.display="none";else{this.cornerStyle.top=`${U+j+this.cornerCenterPointOffset-1}px`,this.cornerStyle[ie]=`${B+ee+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let pe=ca(n.TABLE);const f=pe===i;f&&(pe=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const A=f?C.getBoundingClientRect().left:C.offsetLeft;let O=!1,D=0;F?(D=A-parseInt(this.cornerDefaultStyle.width,10)/2,O=D<0):(D=A+ft(C)+parseInt(this.cornerDefaultStyle.width,10)/2,O=D>=Ay(pe)),O&&(this.cornerStyle[ie]=`${Math.floor(B+ee+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[F?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(f?C.getBoundingClientRect().top:C.offsetTop)+xt(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=ra(pe)&&(this.cornerStyle.top=`${Math.floor(U+j+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}uo()&&this.updateMultipleSelectionHandlesPosition(s,l,U,B,ee,j)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,g=null,p=null,C=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return xt(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ft(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const S=this.wot.getSetting("columnHeaders").length;if(p=l(n,S-i),C=l(r,S-i),!p||!C)return!1;const y=en(p),R=en(C);return p&&C&&(h=y[g]-o[g]-1,d=R[g]+u(C)-y[g]),[p,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?q(this[e],"hidden"):(Ie(this[e],"hidden")&&Le(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):Le(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",uo()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const iE=G3;function z3(t,e){vx(t,e),e.add(t)}function Ha(t,e,n){vx(t,e),e.set(t,n)}function vx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function j3(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function qe(t,e){var n=Sx(t,e,"get");return K3(t,n)}function K3(t,e){return e.get?e.get.call(t):e.value}function oE(t,e,n){var r=Sx(t,e,"set");return X3(t,r,n),n}function Sx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function X3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Sn=new WeakMap,tr=new WeakMap,vw=new WeakMap,Yu=new WeakMap,Sw=new WeakMap,As=new WeakMap,sE=new WeakSet;class q3{constructor(e){z3(this,sE),Ha(this,Sn,{writable:!0,value:void 0}),Ha(this,tr,{writable:!0,value:void 0}),Ha(this,vw,{writable:!0,value:new Y3}),Ha(this,Yu,{writable:!0,value:new WeakMap}),Ha(this,Sw,{writable:!0,value:new WeakSet}),Ha(this,As,{writable:!0,value:new Map}),oE(this,tr,e)}setActiveOverlay(e){return oE(this,Sn,e),qe(this,vw).setActiveOverlay(qe(this,Sn)),qe(this,Yu).has(qe(this,Sn))||qe(this,Yu).set(qe(this,Sn),new Set),this}getFocusSelection(){return qe(this,tr)!==null?qe(this,tr).getFocus():null}getAreaSelection(){return qe(this,tr)!==null?qe(this,tr).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(qe(this,As).has(e)){const r=qe(this,As).get(e);if(r.has(qe(this,Sn)))return r.get(qe(this,Sn));const i=new iE(qe(this,Sn),e.settings);return r.set(qe(this,Sn),i),i}const n=new iE(qe(this,Sn),e.settings);return qe(this,As).set(e,new Map([[qe(this,Sn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=qe(this,As).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){qe(this,As).get(e).forEach(n=>n.destroy()),qe(this,As).delete(e)}render(e){if(qe(this,tr)===null)return;e&&j3(this,sE,Z3).call(this);const n=Array.from(qe(this,tr)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;qe(this,Sw).has(s)||(qe(this,Sw).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&qe(this,vw).setActiveSelection(s).scan().forEach(p=>{if(r.has(p)){const C=r.get(p);C.has(a)&&u===!0?C.set(a,C.get(a)+1):C.set(a,1)}else r.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const d=s.getCorners();qe(this,Sn).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>qe(this,Yu).get(qe(this,Sn)).add(u)),q(s,l),s.nodeName==="TD"&&Array.isArray((a=qe(this,tr).options)===null||a===void 0?void 0:a.cellAttributes)&&Ee(s,qe(this,tr).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Ee(o,[...i.get(o)])})}}function Z3(){const t=qe(this,Yu).get(qe(this,Sn)),e=qe(this,Sn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=qe(this,Sn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=qe(this,tr).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=qe(this,tr).options.cellAttributes.map(a=>a[0])),Array.isArray((i=qe(this,tr).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...qe(this,tr).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Le(o[a],n),va(o[a],s)}),t.clear()}class J3 extends qc{constructor(e,n,r,i){super(e,n,da,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new H3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),xg(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Yc(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,_y(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=nn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ft(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(ib.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=nn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(My(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Le(n,"emptyRows"):q(n,"emptyRows");let s=!1;if(i&&!r.length)q(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=Ie(n,"innerBorderInlineStart");e?(q(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(Le(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const Q3="stickyRowsTop",yx={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Fi(yx,"MIXIN_NAME",Q3,{writable:!1,enumerable:!1});const bx=yx;class ob extends Ul{constructor(e,n,r,i){super(e,n,r,i,fa)}}pt(ob,bx);pt(ob,Xy);const e4=ob;function aE(t,e,n){return e=t4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t4(t){var e=n4(t,"string");return typeof e=="symbol"?e:String(e)}function n4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r4 extends qc{constructor(e,n,r,i,o,s){super(e,n,fa,r,i),aE(this,"topOverlay",void 0),aE(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new e4(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();xg(e,`${i}px`,`${o}px`)}else Yc(e);let n=xt(this.clone.wtTable.TABLE);const r=ft(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class sb extends Ul{constructor(e,n,r,i){super(e,n,r,i,ha)}}pt(sb,bx);pt(sb,Jy);const i4=sb;function o4(t,e,n){return e=s4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s4(t){var e=a4(t,"string");return typeof e=="symbol"?e:String(e)}function a4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l4 extends qc{constructor(e,n,r,i){super(e,n,ha,r,i),o4(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new i4(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),xg(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Yc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Ig(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=nn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=xt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(ib.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=nn(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Pg(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Le(r,"emptyColumns"):q(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=Ie(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(q(r,"innerBorderTop"),o=!u):(Le(r,"innerBorderTop"),o=u)}}return o}}function Yi(t,e,n){return e=u4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u4(t){var e=c4(t,"string");return typeof e=="symbol"?e:String(e)}function c4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h4{constructor(e,n,r,i,o,s){Yi(this,"wot",null),Yi(this,"topOverlay",null),Yi(this,"bottomOverlay",null),Yi(this,"inlineStartOverlay",null),Yi(this,"topInlineStartCornerOverlay",null),Yi(this,"bottomInlineStartCornerOverlay",null),Yi(this,"browserLineHeight",void 0),Yi(this,"wtSettings",null),Yi(this,"resizeObserver",new ResizeObserver(c=>{$g(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=nn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:bc(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new l4(...e),this.bottomOverlay=new P3(...e),this.inlineStartOverlay=new J3(...e),this.topInlineStartCornerOverlay=new r4(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new T3(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!Ny())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Bl(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=bc(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:d}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return E(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];E(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const d4=h4;function lE(t,e,n){return e=f4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f4(t){var e=g4(t,"string");return typeof e=="symbol"?e:String(e)}function g4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class m4{constructor(e){lE(this,"settings",{}),lE(this,"defaults",Object.freeze(this.getDefaults())),Ge(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);hs(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ge(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class ab extends Ul{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=ca(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Pl(e,"height",n),o=Pl(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const g=parseInt(Co(d,n).height,10);r.removeChild(d),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ds(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}pt(ab,fx);pt(ab,Jy);const p4=ab;class w4{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=xt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let d,g;if(a)return ft(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,o):d=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>d)return n.documentElement.clientWidth;if(i!==r&&(g=Pl(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(d,i.clientWidth);const p=e.getSetting("stretchH");return p==="none"||!p?Math.max(d,ft(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return en(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=xt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=ft(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Go;const{wtSettings:n,wtTable:r}=this;if(n.getSetting("renderAllRows")&&e===Go)return new aj({totalRows:n.getSetting("totalRows")});let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=nn(this.domBindings.rootDocument),new Vg({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Go;const{wtSettings:n,wtTable:r}=this;if(n.getSetting("renderAllColumns")&&e===Go)return new ij({totalColumns:n.getSetting("totalColumns")});let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=nn(this.domBindings.rootDocument)),new Kc({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this;if(e&&!n.getSetting("renderAllRows")){const r=this.createRowsCalculator(bn);e=this.areAllProposedVisibleRowsAlreadyRendered(r)}if(e&&!n.getSetting("renderAllColumns")){const r=this.createColumnsCalculator(bn);e=this.areAllProposedVisibleColumnsAlreadyRendered(r)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(Go),this.columnsRenderCalculator=this.createColumnsCalculator(Go)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(bn),this.columnsVisibleCalculator=this.createColumnsCalculator(bn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ge(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const C4=w4;class v4 extends Zy{constructor(e,n){super(e,new m4(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new p4(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new C4(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new q3(this.wtSettings.getSetting("selections")),this.wtEvent=new ix(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new d4(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ge(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),Le(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class lb{constructor(e){e instanceof Zy?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new lb(n);return()=>r},this._wot=new v4(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function uE(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function S4(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const y4=new Map([["mousedown",uE],["mouseover",S4],["touchstart",uE]]);function cE(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;y4.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:kg(t)||t.type==="touchstart",isRightClick:fs(t)})}const Rx=new WeakMap,ub=Symbol("rootInstance");function b4(t){Rx.set(t,!0)}function R4(t){return t===ub}function qd(t){return Rx.has(t)}function hE(t,e){Ex(t,e),e.add(t)}function Os(t,e,n){Ex(t,e),e.set(t,n)}function Ex(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xo(t,e,n){return e=E4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E4(t){var e=T4(t,"string");return typeof e=="symbol"?e:String(e)}function T4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qv(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function an(t,e){var n=Tx(t,e,"get");return _4(t,n)}function _4(t,e){return e.get?e.get.call(t):e.value}function yr(t,e,n){var r=Tx(t,e,"set");return M4(t,r,n),n}function Tx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function M4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var yw=new WeakMap,Lh=new WeakMap,$h=new WeakMap,Gi=new WeakMap,Vr=new WeakMap,bw=new WeakMap,Rw=new WeakMap,Zv=new WeakSet,dE=new WeakSet;class A4{constructor(e){hE(this,dE),hE(this,Zv),xo(this,"hot",void 0),xo(this,"eventManager",void 0),xo(this,"settings",void 0),xo(this,"THEAD",void 0),xo(this,"TBODY",void 0),xo(this,"_wt",void 0),xo(this,"activeWt",void 0),Os(this,yw,{writable:!0,value:0}),Os(this,Lh,{writable:!0,value:0}),xo(this,"postponedAdjustElementsSize",!1),Os(this,$h,{writable:!0,value:!1}),Os(this,Gi,{writable:!0,value:void 0}),Os(this,Vr,{writable:!0,value:void 0}),Os(this,bw,{writable:!0,value:0}),Os(this,Rw,{writable:!0,value:0}),this.hot=e,this.eventManager=new xr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),q(e,"handsontable"),yr(this,Vr,n.createElement("TABLE")),q(an(this,Vr),"htCore"),this.hot.getSettings().tableClassName&&q(an(this,Vr),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Ee(an(this,Vr),[Pi()]),Ee(e,[tG(),oP(-1),Og(this.hot.countCols()),gG()])),this.THEAD=n.createElement("THEAD"),an(this,Vr).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),an(this,Vr).appendChild(this.TBODY),this.hot.table=an(this,Vr),this.hot.container.insertBefore(an(this,Vr),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(yr(this,$h,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;kv(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{yr(this,$h,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{an(this,$h)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&kv(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&kg(o)&&r.finish(),yr(this,Gi,!1);const s=Hg(n.activeElement);ec(n.activeElement)&&!s||(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!fs(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&fs(o)&&(r.finish(),yr(this,Gi,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),yr(this,Gi,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(an(this,Gi)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const d=nn(n);if(n.elementFromPoint(a+d,l)!==c||n.elementFromPoint(a,l+d)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(an(this,Vr),"selectstart",o=>{this.settings.fragmentSelection||ec(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:an(this,Vr),isDataViewInstance:()=>qd(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),yr(this,Lh,o.length),this.hot.getSettings().ariaTags&&qv(this,Zv,_x).call(this)===this.hot.countCols()&&qv(this,dE,O4).call(this,an(this,Lh)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),yr(this,yw,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const g=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let C=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(C=this.hot.runHooks("beforeValueRender",C,g)),this.hot.runHooks("beforeRenderer",a,l,u,p,C,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,p,C,g),this.hot.runHooks("afterRenderer",a,l,u,p,C,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ds(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,yr(this,Gi,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ko(o)&&(cE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,yr(this,Gi,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ko(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ko(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ko(o)&&(an(this,Gi)&&cE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ko(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[g,p,C,S]=d;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,-1)):C,S>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(S,-1)):S]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new lb(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(ec(e))return!0;const n=os(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return an(this,Gi)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Ie(r,"relative")){oi(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;Ie(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(oi(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Ee(s,...Pi()),Ee(a,...Pi())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ie(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ie(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Sa(e,r(n,i)):(hs(e,String.fromCharCode(160)),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){yr(this,bw,e),yr(this,Rw,n)}getLastSize(){return{width:an(this,bw),height:an(this,Rw)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return an(this,yw)}getRowHeadersCount(){return an(this,Lh)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function _x(){return parseInt(this.hot.rootElement.getAttribute(Og()[0]),10)}function O4(t){const e=qv(this,Zv,_x).call(this)+t;Ee(this.hot.rootElement,...Og(e))}const I4=A4,Mx="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Jv=Mx.length;function Bg(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%Jv,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/Jv,10);return n}function P4(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Jv**r*(Mx.indexOf(t[n])+1);return e-=1,e}function x4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Bg(i)+(r+1));n.push(o)}return n}function H4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Bg(i)+(r+1);n.push(o)}return n}function D4(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function cb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function hb(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Be(t[0])&&(e=Lg(t[0]))),e}function Ax(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Ox(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const N4=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:hb,createEmptySpreadsheetData:D4,createSpreadsheetData:x4,createSpreadsheetObjectData:H4,dataRowToChangesArray:cb,isArrayOfArrays:Ax,isArrayOfObjects:Ox,spreadsheetColumnIndex:P4,spreadsheetColumnLabel:Bg},Symbol.toStringTag,{value:"Module"}));function cu(t,e,n){return e=L4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L4(t){var e=$4(t,"string");return typeof e=="symbol"?e:String(e)}function $4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];cu(this,"hot",void 0),cu(this,"data",void 0),cu(this,"dataType","array"),cu(this,"colToProp",()=>{}),cu(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return E(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):me(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Be(s)||Ct(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;me(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const d=this.getAtPhysicalCell(e,h,s);i?a.push(d):zd(a,h,d)}})}else Ge(s,(l,u)=>{zd(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=ei(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:zd(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=TP(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=ei(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return me(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return hb(this.data)}destroy(){this.data=null,this.hot=null}}const F4=k4;function fE(t,e,n){return e=W4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W4(t){var e=V4(t,"string");return typeof e=="symbol"?e:String(e)}function V4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ya{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;fE(this,"indexedValues",[]),fE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Ct(this.initValueOrFn)?me(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}pt(ya,sr);function db(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>Ct(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function fb(t,e){return wr(t,(n,r)=>e.includes(r)===!1)}class ys extends ya{insert(e,n){this.indexedValues=db(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=fb(this.indexedValues,e),super.remove(e)}}class Ug extends ys{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Yt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function gb(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Tc(t,e){return wr(t,n=>e.includes(n)===!1)}function mb(t,e){return Ye(t,n=>n-e.filter(r=>r<n).length)}function pb(t,e){const n=e[0],r=e.length;return Ye(t,i=>i>=n?i+r:i)}function B4(t,e,n){return e=U4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U4(t){var e=Y4(t,"string");return typeof e=="symbol"?e:String(e)}function Y4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yg extends ya{constructor(){super(...arguments),B4(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Tc(this.orderOfIndexes,[e]),Ct(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=db(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=pb(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=fb(this.indexedValues,e),this.orderOfIndexes=Tc(this.orderOfIndexes,e),this.orderOfIndexes=mb(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Zc extends ys{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Yt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const gE=new Map([["indexesSequence",{getListWithInsertedItems:gb,getListWithRemovedItems:Tc}],["physicallyIndexed",{getListWithInsertedItems:db,getListWithRemovedItems:fb}]]),Ix=t=>{if(gE.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return gE.get(t)};class Px extends ya{constructor(){super(e=>e)}insert(e,n){const r=pb(this.indexedValues,n);this.indexedValues=gb(r,e,n),super.insert(e,n)}remove(e){const n=Tc(this.indexedValues,e);this.indexedValues=mb(n,e),super.remove(e)}}const mE=new Map([["hiding",Ug],["index",ya],["linkedPhysicalIndexToValue",Yg],["physicalIndexToValue",ys],["trimming",Zc]]);function G4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!mE.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(mE.get(t))(e)}function z4(t,e,n){return e=j4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j4(t){var e=K4(t,"string");return typeof e=="symbol"?e:String(e)}function K4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Qv=0;class wb{constructor(){z4(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),Qv+=1)}unregister(e){const n=this.collection.get(e);ue(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),Qv-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return vt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}pt(wb,sr);function X4(){return Qv}function Ew(t,e,n){return e=q4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q4(t){var e=Z4(t,"string");return typeof e=="symbol"?e:String(e)}function Z4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pE extends wb{constructor(e,n){super(),Ew(this,"mergedValuesCache",[]),Ew(this,"aggregationFunction",void 0),Ew(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ye(this.get(),o=>o.getValues()),r=[],i=ue(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ye(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ue(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function J4(t,e,n){Q4(t,e),e.set(t,n)}function Q4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e6(t,e,n){var r=xx(t,e,"set");return t6(t,r,n),n}function t6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function n6(t,e){var n=xx(t,e,"get");return r6(t,n)}function xx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function r6(t,e){return e.get?e.get.call(t):e.value}var Tw=new WeakMap;class Hx{constructor(){J4(this,Tw,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(n6(this,Tw)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){e6(this,Tw,e)}}pt(Hx,sr);function wE(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function hu(t,e,n){i6(t,e),e.set(t,n)}function i6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function br(t,e){var n=Dx(t,e,"get");return o6(t,n)}function o6(t,e){return e.get?e.get.call(t):e.value}function kh(t,e,n){var r=Dx(t,e,"set");return s6(t,r,n),n}function Dx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function s6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Fh=new WeakMap,du=new WeakMap,Wh=new WeakMap,Vh=new WeakMap,Bh=new WeakMap;class a6{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hu(this,Fh,{writable:!0,value:new Set}),hu(this,du,{writable:!0,value:[]}),hu(this,Wh,{writable:!0,value:[]}),hu(this,Vh,{writable:!0,value:!1}),hu(this,Bh,{writable:!0,value:!1}),kh(this,Bh,e??!1)}createObserver(){const e=new Hx;return br(this,Fh).add(e),e.addLocalHook("unsubscribe",()=>{br(this,Fh).delete(e)}),e._writeInitialChanges(wE(br(this,du),br(this,Wh))),e}emit(e){let n=br(this,Wh);(!br(this,Vh)||br(this,du).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(br(this,Bh)):kh(this,du,new Array(e.length).fill(br(this,Bh))),br(this,Vh)||(kh(this,Vh,!0),n=br(this,du)));const r=wE(n,e);br(this,Fh).forEach(i=>i._write(r)),kh(this,Wh,e)}}function Hn(t,e,n){return e=l6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l6(t){var e=u6(t,"string");return typeof e=="symbol"?e:String(e)}function u6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eS{constructor(){Hn(this,"indexesSequence",new Px),Hn(this,"trimmingMapsCollection",new pE(e=>e.some(n=>n===!0),!1)),Hn(this,"hidingMapsCollection",new pE(e=>e.some(n=>n===!0),!1)),Hn(this,"variousMapsCollection",new wb),Hn(this,"hidingChangesObservable",new a6({initialIndexValue:!1})),Hn(this,"notTrimmedIndexesCache",[]),Hn(this,"notHiddenIndexesCache",[]),Hn(this,"isBatched",!1),Hn(this,"indexesSequenceChanged",!1),Hn(this,"indexesChangeSource",void 0),Hn(this,"trimmedIndexesChanged",!1),Hn(this,"hiddenIndexesChanged",!1),Hn(this,"renderablePhysicalIndexesCache",[]),Hn(this,"fromPhysicalToVisualIndexesCache",new Map),Hn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,G4(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Zc?this.trimmingMapsCollection.register(e,n):n instanceof Ug?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ue(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ue(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ue(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ue(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ye(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Tc(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(gb(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ue(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ye(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}pt(eS,sr);function c6(t,e){return Ge(e,(n,r)=>{vt(t[r])&&(t[r]=n)}),t}function Nx(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Lx(t){ue(t)&&Wy(ht`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function h6(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:d6,getValues:f6}=ai("phraseFormatters");function g6(t,e){d6(t,e)}function m6(){return f6()}g6("pluralize",h6);const $x="ContextMenu:items",Fe=$x,Gg=`${Fe}.noItems`,zg=`${Fe}.insertRowAbove`,jg=`${Fe}.insertRowBelow`,Kg=`${Fe}.insertColumnOnTheLeft`,Xg=`${Fe}.insertColumnOnTheRight`,qg=`${Fe}.removeRow`,Zg=`${Fe}.removeColumn`,Jg=`${Fe}.undo`,Qg=`${Fe}.redo`,em=`${Fe}.readOnly`,tm=`${Fe}.clearColumn`,nm=`${Fe}.copy`,Cb=`${Fe}.copyWithHeaders`,vb=`${Fe}.copyWithGroupHeaders`,Sb=`${Fe}.copyHeadersOnly`,rm=`${Fe}.cut`,im=`${Fe}.freezeColumn`,om=`${Fe}.unfreezeColumn`,sm=`${Fe}.mergeCells`,am=`${Fe}.unmergeCells`,lm=`${Fe}.addComment`,um=`${Fe}.editComment`,cm=`${Fe}.removeComment`,hm=`${Fe}.readOnlyComment`,dm=`${Fe}.align`,fm=`${Fe}.align.left`,gm=`${Fe}.align.center`,mm=`${Fe}.align.right`,pm=`${Fe}.align.justify`,wm=`${Fe}.align.top`,Cm=`${Fe}.align.middle`,vm=`${Fe}.align.bottom`,Sm=`${Fe}.borders`,ym=`${Fe}.borders.top`,bm=`${Fe}.borders.right`,Rm=`${Fe}.borders.bottom`,Em=`${Fe}.borders.left`,Tm=`${Fe}.borders.remove`,_m=`${Fe}.nestedHeaders.insertChildRow`,Mm=`${Fe}.nestedHeaders.detachFromParent`,Am=`${Fe}.hideColumn`,Om=`${Fe}.showColumn`,Im=`${Fe}.hideRow`,Pm=`${Fe}.showRow`,Gn="Filters:",Vt=`${Gn}conditions`,Jc=`${Vt}.none`,xm=`${Vt}.isEmpty`,Hm=`${Vt}.isNotEmpty`,Dm=`${Vt}.isEqualTo`,Nm=`${Vt}.isNotEqualTo`,Lm=`${Vt}.beginsWith`,$m=`${Vt}.endsWith`,km=`${Vt}.contains`,Fm=`${Vt}.doesNotContain`,p6=`${Vt}.byValue`,Wm=`${Vt}.greaterThan`,Vm=`${Vt}.greaterThanOrEqualTo`,Bm=`${Vt}.lessThan`,Um=`${Vt}.lessThanOrEqualTo`,Ym=`${Vt}.isBetween`,Gm=`${Vt}.isNotBetween`,zm=`${Vt}.after`,jm=`${Vt}.before`,Km=`${Vt}.today`,Xm=`${Vt}.tomorrow`,qm=`${Vt}.yesterday`,Zm=`${Gn}labels.filterByCondition`,Jm=`${Gn}labels.filterByValue`,Qm=`${Gn}labels.conjunction`,Qc=`${Gn}labels.disjunction`,_c=`${Gn}values.blankCells`,ep=`${Gn}buttons.selectAll`,tp=`${Gn}buttons.clear`,np=`${Gn}buttons.ok`,rp=`${Gn}buttons.cancel`,ip=`${Gn}buttons.placeholder.search`,op=`${Gn}buttons.placeholder.value`,sp=`${Gn}buttons.placeholder.secondValue`,yb="CheckboxRenderer:",bb=`${yb}checked`,Rb=`${yb}unchecked`,w6=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:bb,CHECKBOX_RENDERER_NAMESPACE:yb,CHECKBOX_UNCHECKED:Rb,CONTEXTMENU_ITEMS_ADD_COMMENT:lm,CONTEXTMENU_ITEMS_ALIGNMENT:dm,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:vm,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:gm,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:pm,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:fm,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Cm,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:mm,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:wm,CONTEXTMENU_ITEMS_BORDERS:Sm,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Rm,CONTEXTMENU_ITEMS_BORDERS_LEFT:Em,CONTEXTMENU_ITEMS_BORDERS_RIGHT:bm,CONTEXTMENU_ITEMS_BORDERS_TOP:ym,CONTEXTMENU_ITEMS_CLEAR_COLUMN:tm,CONTEXTMENU_ITEMS_COPY:nm,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Sb,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:vb,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Cb,CONTEXTMENU_ITEMS_CUT:rm,CONTEXTMENU_ITEMS_EDIT_COMMENT:um,CONTEXTMENU_ITEMS_FREEZE_COLUMN:im,CONTEXTMENU_ITEMS_HIDE_COLUMN:Am,CONTEXTMENU_ITEMS_HIDE_ROW:Im,CONTEXTMENU_ITEMS_INSERT_LEFT:Kg,CONTEXTMENU_ITEMS_INSERT_RIGHT:Xg,CONTEXTMENU_ITEMS_MERGE_CELLS:sm,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:Mm,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:_m,CONTEXTMENU_ITEMS_NO_ITEMS:Gg,CONTEXTMENU_ITEMS_READ_ONLY:em,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:hm,CONTEXTMENU_ITEMS_REDO:Qg,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Tm,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Zg,CONTEXTMENU_ITEMS_REMOVE_COMMENT:cm,CONTEXTMENU_ITEMS_REMOVE_ROW:qg,CONTEXTMENU_ITEMS_ROW_ABOVE:zg,CONTEXTMENU_ITEMS_ROW_BELOW:jg,CONTEXTMENU_ITEMS_SHOW_COLUMN:Om,CONTEXTMENU_ITEMS_SHOW_ROW:Pm,CONTEXTMENU_ITEMS_UNDO:Jg,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:om,CONTEXTMENU_ITEMS_UNMERGE_CELLS:am,CONTEXT_MENU_ITEMS_NAMESPACE:$x,FILTERS_BUTTONS_CANCEL:rp,FILTERS_BUTTONS_CLEAR:tp,FILTERS_BUTTONS_OK:np,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:ip,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:sp,FILTERS_BUTTONS_PLACEHOLDER_VALUE:op,FILTERS_BUTTONS_SELECT_ALL:ep,FILTERS_CONDITIONS_AFTER:zm,FILTERS_CONDITIONS_BEFORE:jm,FILTERS_CONDITIONS_BEGINS_WITH:Lm,FILTERS_CONDITIONS_BETWEEN:Ym,FILTERS_CONDITIONS_BY_VALUE:p6,FILTERS_CONDITIONS_CONTAINS:km,FILTERS_CONDITIONS_EMPTY:xm,FILTERS_CONDITIONS_ENDS_WITH:$m,FILTERS_CONDITIONS_EQUAL:Dm,FILTERS_CONDITIONS_GREATER_THAN:Wm,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Vm,FILTERS_CONDITIONS_LESS_THAN:Bm,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Um,FILTERS_CONDITIONS_NAMESPACE:Vt,FILTERS_CONDITIONS_NONE:Jc,FILTERS_CONDITIONS_NOT_BETWEEN:Gm,FILTERS_CONDITIONS_NOT_CONTAIN:Fm,FILTERS_CONDITIONS_NOT_EMPTY:Hm,FILTERS_CONDITIONS_NOT_EQUAL:Nm,FILTERS_CONDITIONS_TODAY:Km,FILTERS_CONDITIONS_TOMORROW:Xm,FILTERS_CONDITIONS_YESTERDAY:qm,FILTERS_DIVS_FILTER_BY_CONDITION:Zm,FILTERS_DIVS_FILTER_BY_VALUE:Jm,FILTERS_LABELS_CONJUNCTION:Qm,FILTERS_LABELS_DISJUNCTION:Qc,FILTERS_NAMESPACE:Gn,FILTERS_VALUES_BLANK_CELLS:_c},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const C6={languageCode:"en-US",[Gg]:"No available options",[zg]:"Insert row above",[jg]:"Insert row below",[Kg]:"Insert column left",[Xg]:"Insert column right",[qg]:["Remove row","Remove rows"],[Zg]:["Remove column","Remove columns"],[Jg]:"Undo",[Qg]:"Redo",[em]:"Read only",[tm]:"Clear column",[dm]:"Alignment",[fm]:"Left",[gm]:"Center",[mm]:"Right",[pm]:"Justify",[wm]:"Top",[Cm]:"Middle",[vm]:"Bottom",[im]:"Freeze column",[om]:"Unfreeze column",[Sm]:"Borders",[ym]:"Top",[bm]:"Right",[Rm]:"Bottom",[Em]:"Left",[Tm]:"Remove border(s)",[lm]:"Add comment",[um]:"Edit comment",[cm]:"Delete comment",[hm]:"Read-only comment",[sm]:"Merge cells",[am]:"Unmerge cells",[nm]:"Copy",[Cb]:["Copy with header","Copy with headers"],[vb]:["Copy with group header","Copy with group headers"],[Sb]:["Copy header only","Copy headers only"],[rm]:"Cut",[_m]:"Insert child row",[Mm]:"Detach from parent",[Am]:["Hide column","Hide columns"],[Om]:["Show column","Show columns"],[Im]:["Hide row","Hide rows"],[Pm]:["Show row","Show rows"],[Jc]:"None",[xm]:"Is empty",[Hm]:"Is not empty",[Dm]:"Is equal to",[Nm]:"Is not equal to",[Lm]:"Begins with",[$m]:"Ends with",[km]:"Contains",[Fm]:"Does not contain",[Wm]:"Greater than",[Vm]:"Greater than or equal to",[Bm]:"Less than",[Um]:"Less than or equal to",[Ym]:"Is between",[Gm]:"Is not between",[zm]:"After",[jm]:"Before",[Km]:"Today",[Xm]:"Tomorrow",[qm]:"Yesterday",[_c]:"Blank cells",[Zm]:"Filter by condition",[Jm]:"Filter by value",[Qm]:"And",[Qc]:"Or",[ep]:"Select all",[tp]:"Clear",[np]:"OK",[rp]:"Cancel",[ip]:"Search",[op]:"Value",[sp]:"Second value",[bb]:"Checked",[Rb]:"Unchecked"},kx=C6,v6=w6,tS=kx.languageCode,{register:S6,getItem:Fx,hasItem:y6,getValues:b6}=ai("languagesDictionaries");Eb(kx);function Eb(t,e){let n=t,r=e;return Be(t)&&(r=t,n=r.languageCode),R6(n,r),S6(n,_n(r)),_n(r)}function R6(t,e){t!==tS&&c6(e,Fx(tS))}function Wx(t){return Tb(t)?_n(Fx(t)):null}function Tb(t){return y6(t)}function E6(){return b6()}function Vx(t,e,n){const r=Wx(t);if(r===null)return null;const i=r[e];if(vt(i))return null;const o=T6(i,n);return Array.isArray(o)?o[0]:o}function T6(t,e){let n=t;return E(m6(),r=>{n=r(t,e)}),n}function _6(t){let e=Nx(t);return Tb(e)||(e=tS,Lx(t)),e}function M6(t,e,n){return e=A6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A6(t){var e=O6(t,"string");return typeof e=="symbol"?e:String(e)}function O6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class I6 extends N3{constructor(e,n){super(e,null),M6(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Mo=I6;function _w(t){let{activeHeaderClassName:e,...n}=t;return new Mo({className:e,...n,selectionType:px})}function P6(t){let{areaCornerVisible:e,...n}=t;return new Mo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:nb})}function x6(t){let{...e}=t;return new Mo({className:"highlight",...e,selectionType:nb})}function H6(t){let{columnClassName:e,...n}=t;return new Mo({className:e,...n,selectionType:k3})}function D6(t){let{cellCornerVisible:e,...n}=t;return new Mo({className:"current",headerAttributes:[Ey()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:rb})}function N6(t){let{border:e,visualCellRange:n,...r}=t;return new Mo({...e,...r,selectionType:F3},n)}function L6(t){let{...e}=t;return new Mo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:L3})}function CE(t){let{headerClassName:e,...n}=t;return new Mo({className:e,...n,selectionType:tb})}function $6(t){let{rowClassName:e,...n}=t;return new Mo({className:e,...n,selectionType:$3})}let Bx;function k6(t,e){F6(t,e),e.add(t)}function F6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kn(t,e,n){return e=W6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W6(t){var e=V6(t,"string");return typeof e=="symbol"?e:String(e)}function V6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var di=new WeakSet;Bx=Symbol.iterator;class B6{constructor(e){k6(this,di),Kn(this,"options",void 0),Kn(this,"layerLevel",0),Kn(this,"focus",void 0),Kn(this,"fill",void 0),Kn(this,"layeredAreas",new Map),Kn(this,"areas",new Map),Kn(this,"rowHeaders",new Map),Kn(this,"columnHeaders",new Map),Kn(this,"activeRowHeaders",new Map),Kn(this,"activeColumnHeaders",new Map),Kn(this,"activeCornerHeaders",new Map),Kn(this,"rowHighlights",new Map),Kn(this,"columnHighlights",new Map),Kn(this,"customSelections",[]),this.options=e,this.focus=D6(e),this.fill=L6(e)}isEnabledFor(e,n){let r=e;e===rb&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return zi(this,di,ji).call(this,this.layeredAreas,P6)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return zi(this,di,ji).call(this,this.areas,x6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return zi(this,di,ji).call(this,this.rowHeaders,CE)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return zi(this,di,ji).call(this,this.columnHeaders,CE)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return zi(this,di,ji).call(this,this.activeRowHeaders,_w)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return zi(this,di,ji).call(this,this.activeColumnHeaders,_w)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return zi(this,di,ji).call(this,this.activeCornerHeaders,_w)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return zi(this,di,ji).call(this,this.rowHighlights,$6)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return zi(this,di,ji).call(this,this.columnHighlights,H6)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(N6({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),E(this.areas.values(),e=>void e.clear()),E(this.layeredAreas.values(),e=>void e.clear()),E(this.rowHeaders.values(),e=>void e.clear()),E(this.columnHeaders.values(),e=>void e.clear()),E(this.activeRowHeaders.values(),e=>void e.clear()),E(this.activeColumnHeaders.values(),e=>void e.clear()),E(this.activeCornerHeaders.values(),e=>void e.clear()),E(this.rowHighlights.values(),e=>void e.clear()),E(this.columnHighlights.values(),e=>void e.clear())}[Bx](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ji(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const U6=B6;let Ux;function vE(t,e,n){return e=Y6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y6(t){var e=G6(t,"string");return typeof e=="symbol"?e:String(e)}function G6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Ux=Symbol.iterator;class z6{constructor(e){vE(this,"ranges",[]),vE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Ux](){return this.ranges[Symbol.iterator]()}}const j6=z6;function fu(t,e){Yx(t,e),e.add(t)}function Mw(t,e,n){Yx(t,e),e.set(t,n)}function Yx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qe(t,e){var n=Gx(t,e,"get");return K6(t,n)}function K6(t,e){return e.get?e.get.call(t):e.value}function Zn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function nS(t,e,n){var r=Gx(t,e,"set");return X6(t,r,n),n}function Gx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function X6(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Uh=new WeakMap,ot=new WeakMap,gs=new WeakMap,Aw=new WeakSet,Ow=new WeakSet,rS=new WeakSet,Iw=new WeakSet,Is=new WeakSet;class zx{constructor(e,n){fu(this,Is),fu(this,Iw),fu(this,rS),fu(this,Ow),fu(this,Aw),Mw(this,Uh,{writable:!0,value:void 0}),Mw(this,ot,{writable:!0,value:void 0}),Mw(this,gs,{writable:!0,value:{x:0,y:0}}),nS(this,Uh,e),nS(this,ot,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Zn(this,Aw,SE).call(this,{x:Qe(this,ot).navigableHeaders()?Qe(this,ot).countRowHeaders():0,y:Qe(this,ot).navigableHeaders()?Qe(this,ot).countColHeaders():0});const i=Qe(this,ot).createCellCoords(e,n);let o=Qe(this,Uh).current().highlight;const s=Qe(this,ot).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Zn(this,rS,jx).call(this),{row:h,col:d}=Zn(this,Iw,bE).call(this,o),g=Qe(this,ot).fixedRowsBottom(),p=Qe(this,ot).minSpareRows(),C=Qe(this,ot).minSpareCols(),S=Qe(this,ot).autoWrapRow(),y=Qe(this,ot).autoWrapCol(),R=Qe(this,ot).createCellCoords(h+i.row,d+i.col);if(R.row>=c){const I=ei(r&&p>0&&g===0),F=R.col+1,B=Qe(this,ot).createCellCoords(R.row-c,F>=u?F-u:F);this.runLocalHooks("beforeColumnWrap",I,Zn(this,Is,Da).call(this,B),F>=u),I.value?this.runLocalHooks("insertRowRequire",Qe(this,ot).countRenderableRows()):y&&R.assign(B)}else if(R.row<0){const I=ei(y),F=R.col-1,B=Qe(this,ot).createCellCoords(c+R.row,F<0?u+F:F);this.runLocalHooks("beforeColumnWrap",I,Zn(this,Is,Da).call(this,B),F<0),y&&R.assign(B)}if(R.col>=u){const I=ei(r&&C>0),F=R.row+1,B=Qe(this,ot).createCellCoords(F>=c?F-c:F,R.col-u);this.runLocalHooks("beforeRowWrap",I,Zn(this,Is,Da).call(this,B),F>=c),I.value?this.runLocalHooks("insertColRequire",Qe(this,ot).countRenderableColumns()):S&&R.assign(B)}else if(R.col<0){const I=ei(S),F=R.row-1,B=Qe(this,ot).createCellCoords(F<0?c+F:F,u+R.col);this.runLocalHooks("beforeRowWrap",I,Zn(this,Is,Da).call(this,B),F<0),S&&R.assign(B)}const{rowDir:T,colDir:N}=Zn(this,Ow,yE).call(this,R);a=T,l=N,o=Zn(this,Is,Da).call(this,R)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Zn(this,Aw,SE).call(this,{x:Qe(this,ot).navigableHeaders()?Qe(this,ot).countRowHeaders():0,y:Qe(this,ot).navigableHeaders()?Qe(this,ot).countColHeaders():0});const r=Qe(this,ot).createCellCoords(e,n),i=Qe(this,Uh).current(),o=Qe(this,ot).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Zn(this,Iw,bE).call(this,i.to),h=Qe(this,ot).createCellCoords(u+r.row,c+r.col),{rowDir:d,colDir:g}=Zn(this,Ow,yE).call(this,h);a=d,l=g;const p=Zn(this,Is,Da).call(this,h);r.row===0&&r.col!==0?s.col=p.col:r.row!==0&&r.col===0?s.row=p.row:(s.row=p.row,s.col=p.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function SE(t){let{x:e,y:n}=t;nS(this,gs,{x:e,y:n})}function yE(t){const{width:e,height:n}=Zn(this,rS,jx).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function jx(){return{width:Qe(this,gs).x+Qe(this,ot).countRenderableColumns(),height:Qe(this,gs).y+Qe(this,ot).countRenderableRows()}}function bE(t){const{row:e,col:n}=Qe(this,ot).visualToRenderableCoords(t);return Qe(this,ot).createCellCoords(Qe(this,gs).y+e,Qe(this,gs).x+n)}function Da(t){const e=t.clone();return e.col=t.col-Qe(this,gs).x,e.row=t.row-Qe(this,gs).y,Qe(this,ot).renderableToVisualCoords(e)}pt(zx,sr);const q6=zx,ap=0,lp=1,Kx=2,_b=3,Z6=[_b,Kx],J6=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Pw=Symbol("root"),RE=Symbol("child");function Hl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pw;if(e!==Pw&&e!==RE)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Pw;let i=ap;if(n){const o=t[0];t.length===0?i=lp:r&&o instanceof jy?i=_b:r&&Array.isArray(o)?i=Hl(o,RE):t.length>=2&&t.length<=4&&!t.some((a,l)=>!J6[l].includes(typeof a))&&(i=Kx)}return i}function Mc(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Z6.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===_b;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),vt(u)&&(u=a),vt(c)&&(c=l),!r){const g=a,p=l,C=u,S=c;a=Math.min(g,C),l=Math.min(p,S),u=Math.max(g,C),c=Math.max(p,S)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function Q6(t){const e=Hl(t.getSelected());if(e===ap||e===lp)return[];const n=Mc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;E(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;E(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Yt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function e9(t){const e=Hl(t.getSelected());if(e===ap||e===lp)return[];const n=Mc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;E(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;E(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Yt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function t9(t,e,n){n9(t,e),e.set(t,n)}function n9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(t,e,n){return e=r9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r9(t){var e=i9(t,"string");return typeof e=="symbol"?e:String(e)}function i9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EE(t,e,n){var r=Xx(t,e,"set");return o9(t,r,n),n}function o9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function TE(t,e){var n=Xx(t,e,"get");return s9(t,n)}function Xx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function s9(t,e){return e.get?e.get.call(t):e.value}var gu=new WeakMap;class qx{constructor(e,n){var r=this;Ho(this,"settings",void 0),Ho(this,"tableProps",void 0),Ho(this,"inProgress",!1),Ho(this,"selectedRange",new j6((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Ho(this,"highlight",void 0),Ho(this,"transformation",void 0),Ho(this,"selectedByRowHeader",new Set),Ho(this,"selectedByColumnHeader",new Set),t9(this,gu,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new U6({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Ey()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new q6(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=vt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&vt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(rb,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(E(this.highlight.getAreas(),R=>void R.clear()),E(this.highlight.getLayeredAreas(),R=>void R.clear()),E(this.highlight.getRowHeaders(),R=>void R.clear()),E(this.highlight.getColumnHeaders(),R=>void R.clear()),E(this.highlight.getActiveRowHeaders(),R=>void R.clear()),E(this.highlight.getActiveColumnHeaders(),R=>void R.clear()),E(this.highlight.getActiveCornerHeaders(),R=>void R.clear()),E(this.highlight.getRowHighlights(),R=>void R.clear()),E(this.highlight.getColumnHighlights(),R=>void R.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),d=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),S=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),d.clear(),g.clear(),p.clear(),C.clear(),S.clear(),y.clear(),this.highlight.isEnabledFor(nb,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const R=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(R.from).commit().syncWith(R),this.highlight.createLayeredArea().add(R.from).commit().syncWith(R),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(tb,s.highlight)){if(!s.isSingleHeader()){const N=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),I=this.tableProps.createCellCoords(s.to.row,-1),F=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),B=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(N).commit(),d.add(F).commit(),S.add(N).commit(),y.add(F).commit()):(h.add(N).add(I).commit(),d.add(F).add(B).commit(),S.add(N).add(I).commit(),y.add(F).add(B).commit())}const R=!TE(this,gu)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),T=!TE(this,gu)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());R&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),T&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),R&&T&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=ei(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:g}=i;EE(this,gu,g),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(or(d.row,u,o-1),or(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),C=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.finish(),EE(this,gu,!1)}selectCells(e){var n=this;const r=Hl(e);if(r===lp)return!1;if(r===ap)throw new Error(ht`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Mc(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),E(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){const g=l===0?0:or(r,u,-1),p=s-1,C=this.tableProps.createCellCoords(g,i),S=this.tableProps.createCellCoords(p,o),y=this.tableProps.createCellCoords(or(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",C,S,y),C.row=g,S.row=p,this.setRangeStartOnly(C,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectColumns",C,S,y),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:or(r,a,-1),d=o-1,g=this.tableProps.createCellCoords(e,h),p=this.tableProps.createCellCoords(n,d),C=this.tableProps.createCellCoords(e,or(r,a,o-1));this.runLocalHooks("beforeSelectRows",g,p,C),g.col=h,p.col=d,this.setRangeStartOnly(g,void 0,C),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectRows",g,p,C),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),g.commit()}this.highlight.useLayerLevel(r)}}pt(qx,sr);const a9=qx,_E=/^(\r\n|\n\r|\r|\n)/,l9=/^[^\t\r\n]+/,ME=/^\t/;function u9(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(ME))t=t.replace(ME,""),n+=1,e[r][n]="";else if(t.match(_E))t=t.replace(_E,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(l9);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function tc(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Ps(t,e,n){return e=c9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c9(t){var e=h9(t,"string");return typeof e=="symbol"?e:String(e)}function h9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yl{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Ps(this,"hot",void 0),Ps(this,"metaManager",void 0),Ps(this,"tableMeta",void 0),Ps(this,"dataSource",void 0),Ps(this,"duckSchema",void 0),Ps(this,"colToPropCache",void 0),Ps(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Lg(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Be(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return hb(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ge(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ue(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ue(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?xl(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=_n(this.getSchema()):(p=[],me(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},zc(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",g,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),g=0,p=c;i==="end"&&(p=Math.min(p+1,a));const C=p;for(;g<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let y=0;y<h;y+=1)typeof o[y]>"u"&&(o[y]=[]),o[y].push(null);else o.push([null]);else for(let y=0;y<h;y++)o[y].splice(p,0,null);g+=1,p+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):r!=="auto"&&this.metaManager.createColumn(C,n));const S=this.hot.toVisualColumn(C);return this.hot.runHooks("afterCreateCol",S,g,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:C}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];xv(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return ZI(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];xv(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Pt(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=ei(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=ei(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Pt(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,yl.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===yl.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,n){return tc(this.getRange(e,n,yl.DESTINATION_RENDERER))}getCopyableText(e,n){return tc(this.getRange(e,n,yl.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const d9=yl,{register:f9,getItem:g9,hasItem:Zx,getNames:m9,getValues:Rue}=ai("cellTypes");function Mb(t){if(!Zx(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return g9(t)}function yn(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&er(t,n),r&&ur(t,r),i&&ta(t,i),f9(t,e)}function p9(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Pt(e,t)}function up(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Mb(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ge(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Be(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ge(r,(o,s)=>{if(p9(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),jt(t,i)}function w9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}To(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Zd(t){return Number.isInteger(t)&&t>=0}function Jd(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Yh(t){return t==null}const Jx=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Zt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Zt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Ng(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function AE(t,e,n){return e=C9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C9(t){var e=v9(t,"string");return typeof e=="symbol"?e:String(e)}function v9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S9(){return class{}}class y9{constructor(e){AE(this,"metaCtor",S9()),AE(this,"meta",void 0),this.meta=this.metaCtor.prototype,jt(this.meta,Jx()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;jt(this.meta,e),up(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function b9(t,e,n){return e=R9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function R9(t){var e=E9(t,"string");return typeof e=="symbol"?e:String(e)}function E9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T9{constructor(e){b9(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){jt(this.meta,e),up(this.meta,e,e)}}let Qx;function Gh(t,e,n){return e=_9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _9(t){var e=M9(t,"string");return typeof e=="symbol"?e:String(e)}function M9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Qx=Symbol.iterator;class Lf{constructor(e){Gh(this,"valueFactory",void 0),Gh(this,"data",[]),Gh(this,"index",[]),Gh(this,"holes",new Set),this.valueFactory=e}obtain(e){Jd(()=>Zd(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Jd(()=>Zd(e)||Yh(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Yh(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Jd(()=>Zd(e)||Yh(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Yh(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return wr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Qx](){return this.entries()}}function OE(t,e,n){return e=A9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A9(t){var e=O9(t,"string");return typeof e=="symbol"?e:String(e)}function O9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const I9=["data","width"];class P9{constructor(e){OE(this,"globalMeta",void 0),OE(this,"metas",new Lf(()=>this._createMeta())),this.globalMeta=e,this.metas=new Lf(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);jt(r,n),up(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return w9(this.globalMeta.getMetaConstructor(),I9).prototype}}function IE(t,e,n){return e=x9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x9(t){var e=H9(t,"string");return typeof e=="symbol"?e:String(e)}function H9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class D9{constructor(e){IE(this,"columnMeta",void 0),IE(this,"metas",new Lf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);jt(i,r),up(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ue(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Jd(()=>Zd(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Lf(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class eH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new y9(e),this.tableMeta=new T9(this.globalMeta),this.columnMeta=new P9(this.globalMeta),this.cellMeta=new D9(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}pt(eH,sr);function PE(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=Tn(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Ct(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new d9(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=g.getSchema();t=[];let C,S=0,y=0;for(S=0,y=d.startRows;S<y;S++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)C=_n(p),t.push(C);else if(i.dataType==="array")C=_n(p[0]),t.push(C);else{C=[];for(let R=0,T=d.startCols;R<T;R++)C.push(null);t.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Ee(i.rootElement,[oP(-1),Og(i.countCols()+(i.view?i.countRowHeaders():0))])}function xE(t,e,n){return e=N9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N9(t){var e=L9(t,"string");return typeof e=="symbol"?e:String(e)}function L9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $9{constructor(e){xE(this,"metaManager",void 0),xE(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),de.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=Pt(e,"type")?e.type:null;let c=Ct(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function xw(t,e,n){return e=k9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k9(t){var e=F9(t,"string");return typeof e=="symbol"?e:String(e)}function F9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class W9{constructor(e){xw(this,"metaManager",void 0),xw(this,"usageTracker",new Set),xw(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const tH="gridDefault",Ab="editorManager.handlingEditor",V9={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},B9={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},U9={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Y9={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Lr(e))}};function G9(){return[V9,B9,U9,Y9]}const z9={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},j9={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},K9={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},X9={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},q9={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},Z9={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},J9={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},Q9={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},e5={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},t5={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},n5={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},r5={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},i5={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},o5={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function s5(){return[z9,j9,K9,X9,q9,Z9,J9,Q9,e5,t5,n5,r5,i5,o5]}const a5={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},l5={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},u5={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},c5={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},h5={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},d5={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},f5={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},g5={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},m5={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},p5={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},w5={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},C5={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},v5={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},S5={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},y5={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},b5={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function R5(){return[a5,l5,u5,c5,h5,d5,f5,g5,m5,p5,w5,C5,v5,S5,y5,b5]}const E5={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},T5={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},_5={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},M5={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},A5={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},O5=[...G9(),...s5(),...R5(),E5,T5,_5,M5,A5];function nH(t){const e={};return O5.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function I5(t){const e=t.getShortcutManager().addContext("editor"),n=nH(t),r={group:Ab};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function P5(t){const e=t.getShortcutManager().addContext("grid"),n=nH(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:tH};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ab,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function x5(t){[I5,P5].forEach(e=>e(t))}function H5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=HE(t),i=HE(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function HE(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Ee(n,[Pi(),Eo()]),n}function D5(t){const e=N5(t);let n;const{activate:r,deactivate:i}=H5(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:iS(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:oS(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,g,p,C)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,C.value=!0),s){var S;n=(S=t.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight}}),t.addHook("beforeRowWrap",(h,d,g)=>{o.wrapped=!0,o.flipped=g});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:tH,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:g}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||g&&o.wrapped&&o.flipped||!g&&o.wrapped)return g&&o.wrapped&&o.flipped&&(n=h.shiftKey?iS(t):oS(t)),u(),!1;h.preventDefault()},position:"after"}])}function iS(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function oS(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function N5(t){return e=>{if(!e)return null;const n=iS(t),r=oS(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}const DE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),zh=t=>t.map(e=>{const n=e.toLowerCase();return DE.has(n)?DE.get(n):n}).sort().join("+"),L5=t=>t.split("+"),NE=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),$5=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),Hw=t=>{let{key:e,code:n}=t,r=e;return NE.test(n)?r=n.replace(NE,"$1"):$5.has(n)&&(r=n),r.toLowerCase()},rH=Symbol("shortcut-context");function iH(t){return Be(t)&&t.__kindOf===rH}const k5=t=>{const e=Wg({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:g=!0,stopPropagation:p=!1,relativeToGroup:C,position:S,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(vt(c))throw new Error("You need to define the shortcut's group.");if(Ct(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ht`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:g,stopPropagation:p};ue(C)&&([R.relativeToGroup,R.position]=[C,S]),iH(y)&&(R.forwardToContext=y),l.forEach(T=>{const N=zh(T);if(e.hasItem(N)){const F=e.getItem(N);let B=F.findIndex(ee=>ee.group===C);B!==-1?S==="before"?B-=1:B+=1:B=F.length,F.splice(B,0,R)}else e.addItem(N,[R])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ge(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=zh(l);e.removeItem(u)};return{__kindOf:rH,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=zh(l),c=e.getItem(u);return ue(c)?c.slice():[]},hasShortcut:l=>{const u=zh(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const g=d.filter(p=>p.group!==l);g.length===0?i(L5(h)):(d.length=0,d.push(...g))})}}};function F5(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const W5=["meta","alt","shift","control"],mu=F5();let jh=0;function V5(t,e,n,r,i){const o=g=>W5.includes(g),s=function(g){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return g.altKey&&C.push("alt"),p&&(g.ctrlKey||g.metaKey)?C.push("control/meta"):(g.ctrlKey&&C.push("control"),g.metaKey&&C.push("meta")),g.shiftKey&&C.push("shift"),C},a=g=>{if(e(g)===!1)return;const p=n(g);if(g.keyCode===229||p===!1||Ko(g))return;const C=Hw(g);let S=[];o(C)||(S=s(g));const y=[C].concat(S);!i(g,y)&&(Ec()&&S.includes("meta")||!Ec()&&S.includes("control"))&&i(g,[C].concat(s(g,!0))),r(g)},l=g=>{const p=Hw(g);o(p)&&mu.press(p)},u=g=>{const p=Hw(g);o(p)&&mu.release(p)},c=()=>{mu.releaseAll()};return{mount:()=>{let g=t;for(jh+=1;g;)jh===1&&(g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("keyup",u)),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=yc(g)},unmount:()=>{let g=t;for(jh-=1;g;)jh===0&&(g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("keyup",u)),g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=yc(g)},isPressed:g=>mu.isPressed(g),releasePressedKeys:()=>mu.releaseAll()}}const B5=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Wg({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const C=k5(p);return o.addItem(p,C),C},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(ht`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const d=function(p,C){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=iH(S)?S:u(S);let R=!1;if(!y.hasShortcut(C))return R;const T=y.getShortcuts(C);for(let N=0;N<T.length;N++){const{callback:I,runOnlyIf:F,preventDefault:B,stopPropagation:ee,captureCtrl:U,forwardToContext:j}=T[N];if(F(p)===!0){if(h=U,R=I(p,C)===!1,h=!1,B&&p.preventDefault(),ee&&(Lr(p),p.stopPropagation()),R)break;j&&d(p,C,j)}}return R},g=V5(e,n,r,i,d);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let Dw=null;const Nw=new Map;function oH(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new xr(s);let l,u,c,h,d,g=!0;R4(i)&&b4(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",C=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=_6(e.language);const S=new eH(s,e,[$9,W9]),y=S.getTableMeta(),R=S.getGlobalMeta(),T=Wg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),qd(this)&&tP(e.licenseKey,t),this.guid=`ht_${vy()}`,Nw.set(this.guid,this),this.columnIndexMapper=new eS,this.rowIndexMapper=new eS,this.columnIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterColumnSequenceChange",f)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",f=>{s.runHooks("afterRowSequenceChange",f)}),u=new F4(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const N=f=>{const{row:m,col:w}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},I=f=>{const{row:m,col:w}=f;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)};let F=new a9(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:f=>l.propToCol(f),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(f,m)=>s._createCellCoords(f,m),createCellRange:(f,m,w)=>s._createCellRange(f,m,w),visualToRenderableCoords:N,renderableToVisualCoords:I,isDisabledCellSelection:(f,m)=>f<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(f,m).disableVisualSelection});this.selection=F;const B=f=>{let{hiddenIndexesChanged:m}=f;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",B),this.rowIndexMapper.addLocalHook("cacheUpdated",B),this.selection.addLocalHook("afterSetRangeEnd",f=>{const m=ei(!1),w=this.selection.getSelectedRange(),{from:A,to:O}=w.current(),D=w.size()-1;this.runHooks("afterSelection",A.row,A.col,O.row,O.col,m,D),this.runHooks("afterSelectionByProp",A.row,s.colToProp(A.col),O.row,s.colToProp(O.col),m,D);let z=!0;o&&(z=!1),m.isTouched()&&(z=!m.value);const G=this.selection.selectedRange.current(),ne=this.selection.isSelectedByAnyHeader(),Z=this.selection.isSelectedByRowHeader(),K=this.selection.isSelectedByColumnHeader();if(z!==!1)if(ne)Z?this.scrollViewportTo({row:f.row}):K&&this.scrollViewportTo({col:f.col});else if(G&&!this.selection.isMultiple()){const{row:Se,col:Pe}=G.from;Se<0&&Pe>=0?this.scrollViewportTo({col:Pe}):Pe<0&&Se>=0?this.scrollViewportTo({row:Se}):this.scrollViewportTo({row:Se,col:Pe})}else this.scrollViewportTo(f.toObject());Z&&K?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Z?(Le(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):K?(Le(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):Le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",f=>{const m=f.length-1,{from:w,to:A}=f[m];this.runHooks("afterSelectionEnd",w.row,w.col,A.row,A.col,m),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),A.row,s.colToProp(A.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",f=>{const m=this.runHooks("afterIsMultipleSelection",f.value);f.value&&(f.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),Le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var f=arguments.length,m=new Array(f),w=0;w<f;w++)m[w]=arguments[w];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",f=>this.alter("insert_row_above",f,1,"auto")).addLocalHook("insertColRequire",f=>this.alter("insert_col_start",f,1,"auto")),c={alter(f,m){var w,A;let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,z=arguments.length>4?arguments[4]:void 0;const G=ne=>{if(ne.length===0)return[];const Z=[...ne];return Z.sort((Se,Pe)=>{let[Oe]=Se,[He]=Pe;return Oe===He?0:Oe>He?1:-1}),Yt(Z,(Se,Pe)=>{let[Oe,He]=Pe;const Y=Se[Se.length-1],[lt,Ue]=Y,xe=lt+Ue;if(Oe<=xe){const De=Math.max(He-(xe-Oe),0);Y[1]+=De}else Se.push([Oe,He]);return Se},[Z[0]])};switch(f){case"insert_row_below":case"insert_row_above":const ne=s.countSourceRows();if(y.maxRows===ne)return;const Z=f==="insert_row_below"?"below":"above";m=(w=m)!==null&&w!==void 0?w:Z==="below"?ne:0;const{delta:K,startPhysicalIndex:Se}=l.createRow(m,O,{source:D,mode:Z});if(K){const Ue=F.selectedRange.current(),xe=Ue==null?void 0:Ue.from,De=xe==null?void 0:xe.row,be=s.toVisualRow(Se);if(F.isSelectedByCorner())F.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ue(De)&&De>=be){const{row:v,col:b}=Ue.to;let _=xe.col;F.isSelectedByRowHeader()&&(_=-1),F.getSelectedRange().pop(),F.setRangeStartOnly(s._createCellCoords(De+K,_),!0),F.setRangeEnd(s._createCellCoords(v+K,b))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Pe=f==="insert_col_end"?"end":"start";m=(A=m)!==null&&A!==void 0?A:Pe==="end"?s.countSourceCols():0;const{delta:Oe,startPhysicalIndex:He}=l.createCol(m,O,{source:D,mode:Pe});if(Oe){if(Array.isArray(y.colHeaders)){const v=[s.toVisualColumn(He),0];v.length+=Oe,Array.prototype.splice.apply(y.colHeaders,v)}const Ue=F.selectedRange.current(),xe=Ue==null?void 0:Ue.from,De=xe==null?void 0:xe.col,be=s.toVisualColumn(He);if(F.isSelectedByCorner())F.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ue(De)&&De>=be){const{row:v,col:b}=Ue.to;let _=xe.row;F.isSelectedByColumnHeader()&&(_=-1),F.getSelectedRange().pop(),F.setRangeStartOnly(s._createCellCoords(_,De+Oe),!0),F.setRangeEnd(s._createCellCoords(v,b+Oe))}else s._refreshBorders()}break;case"remove_row":const Y=Ue=>{let xe=0;E(Ue,De=>{let[be,v]=De;const b=Zt(be)?s.countRows()-1:Math.max(be-xe,0);if(Number.isInteger(be)&&(be=Math.max(be-xe,0)),!l.removeRow(be,v,D))return;const k=s.countRows(),M=y.fixedRowsTop;M>=b+1&&(y.fixedRowsTop-=Math.min(v,M-b));const $=y.fixedRowsBottom;$&&b>=k-$&&(y.fixedRowsBottom-=Math.min(v,$)),xe+=v})};Array.isArray(m)?Y(G(m)):Y([[m,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const lt=Ue=>{let xe=0;E(Ue,De=>{let[be,v]=De;const b=Zt(be)?s.countCols()-1:Math.max(be-xe,0);let _=s.toPhysicalColumn(b);if(Number.isInteger(be)&&(be=Math.max(be-xe,0)),!l.removeCol(be,v,D))return;const M=y.fixedColumnsStart;M>=b+1&&(y.fixedColumnsStart-=Math.min(v,M-b)),Array.isArray(y.colHeaders)&&(typeof _>"u"&&(_=-1),y.colHeaders.splice(_,v)),xe+=v})};Array.isArray(m)?lt(G(m)):lt([[m,O]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${f}"`)}z||c.adjustRowsAndCols()},adjustRowsAndCols(){const f=y.minRows,m=y.minSpareRows,w=y.minCols,A=y.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&F.deselect(),f){const O=s.countRows();O<f&&l.createRow(O,f-O,{source:"auto"})}if(m){const O=s.countEmptyRows(!0);if(O<m){const D=m-O,z=Math.min(D,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),z,{source:"auto"})}}{let O;(w||A)&&(O=s.countEmptyCols(!0));let D=s.countCols();if(w&&!y.columns&&D<w){const z=w-D;O+=z,l.createCol(D,z,{source:"auto"})}if(A&&!y.columns&&s.dataType==="array"&&O<A){D=s.countCols();const z=A-O,G=Math.min(z,y.maxCols-D);l.createCol(D,G,{source:"auto"})}}if(F.isSelected()){const O=s.countRows(),D=s.countCols();E(F.selectedRange,z=>{let G=!1,ne=z.from.row,Z=z.from.col,K=z.to.row,Se=z.to.col;ne>O-1?(ne=O-1,G=!0,K>ne&&(K=ne)):K>O-1&&(K=O-1,G=!0,ne>K&&(ne=K)),Z>D-1?(Z=D-1,G=!0,Se>Z&&(Se=Z)):Se>D-1&&(Se=D-1,G=!0,Z>Se&&(Z=Se)),G&&(Z<0?s.selectRows(ne,K,Z):ne<0?s.selectColumns(Z,Se,ne):s.selectCell(ne,Z,K,Se))})}s.view&&s.view.adjustElementsSize()},populateFromArray(f,m,w,A,O){let D,z,G,ne;const Z=[],K={},Se=[],Pe=f.row,Oe=f.col;if(z=m.length,z===0)return!1;let He=0,Y=0;switch(Be(w)&&(He=w.col-Oe+1,Y=w.row-Pe+1),O){case"shift_down":const lt=Zu(m),Ue=lt.length,xe=Math.max(Ue,He),De=s.getData().slice(Pe),be=Zu(De).slice(Oe,Oe+xe);for(G=0;G<xe;G+=1)if(G<Ue){for(D=0,z=lt[G].length;D<Y-z;D+=1)lt[G].push(lt[G][D%z]);G<be.length?Se.push(lt[G].concat(be[G])):Se.push(lt[G].concat(new Array(De.length).fill(null)))}else Se.push(lt[G%Ue].concat(be[G]));s.populateFromArray(Pe,Oe,Zu(Se));break;case"shift_right":const v=m.length,b=Math.max(v,Y),_=s.getData().slice(Pe).map(V=>V.slice(Oe));for(D=0;D<b;D+=1)if(D<v){for(G=0,ne=m[D].length;G<He-ne;G+=1)m[D].push(m[D][G%ne]);if(D<_.length)for(let V=0;V<_[D].length;V+=1)m[D].push(_[D][V]);else m[D].push(...new Array(_[0].length).fill(null))}else m.push(m[D%z].slice(0,b).concat(_[D]));s.populateFromArray(Pe,Oe,m);break;case"overwrite":default:K.row=f.row,K.col=f.col;let k=0,M=0,$=!0,P;const H=function(te){let he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const ye=m[te%m.length];return he!==null?ye[he%ye.length]:ye},W=m.length,L=w?w.row-f.row+1:0;for(w?z=L:z=Math.max(W,L),D=0;D<z&&!(w&&K.row>w.row&&L>W||!y.allowInsertRow&&K.row>s.countRows()-1||K.row>=y.maxRows);D++){const V=D-k,te=H(V).length,he=w?w.col-f.col+1:0;if(w?ne=he:ne=Math.max(te,he),K.col=f.col,P=s.getCellMeta(K.row,K.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&P.skipRowOnPaste){k+=1,K.row+=1,z+=1;continue}for(M=0,G=0;G<ne&&!(w&&K.col>w.col&&he>te||!y.allowInsertColumn&&K.col>s.countCols()-1||K.col>=y.maxCols);G++){if(P=s.getCellMeta(K.row,K.col),(A==="CopyPaste.paste"||A==="Autofill.fill")&&P.skipColumnOnPaste){M+=1,K.col+=1,ne+=1;continue}if(P.readOnly&&A!=="UndoRedo.undo"){K.col+=1;continue}const ye=G-M;let Ae=H(V,ye),Ve=s.getDataAtCell(K.row,K.col);if(Ae!==null&&typeof Ae=="object")if(Array.isArray(Ae)&&Ve===null&&(Ve=[]),Ve===null||typeof Ve!="object")$=!1;else{const St=xl(Array.isArray(Ve)?Ve:Ve[0]||Ve),Ze=xl(Array.isArray(Ae)?Ae:Ae[0]||Ae);Ng(St,Ze)||Array.isArray(St)&&Array.isArray(Ze)?Ae=_n(Ae):$=!1}else Ve!==null&&typeof Ve=="object"&&($=!1);$&&Z.push([K.row,K.col,Ae]),$=!0,K.col+=1}K.row+=1}s.setDataAtCell(Z,null,null,A||"populateFromArray");break}}};function ee(f){const m=Nx(f);Tb(m)?(s.runHooks("beforeLanguageChange",m),R.language=m,s.runHooks("afterLanguageChange",m)):Lx(f)}function U(f,m){const w=f==="className"?s.rootElement:s.table;if(g)q(w,m);else{let A=[],O=[];R[f]&&(A=Array.isArray(R[f])?R[f]:Dv(R[f])),m&&(O=Array.isArray(m)?m:Dv(m));const D=Hv(A,O),z=Hv(O,A);D.length&&Le(w,D),z.length&&q(w,z)}R[f]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(uo()||ky())&&q(s.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new I4(this),h=Mz.getInstance(s,y,F),d=new Iz(s),qd(this)&&D5(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&wP(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function j(){let f=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,f=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&f===!1&&(f=!0,this.onQueueEmpty(this.valid))}}}function re(f){const m=f.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):f}function ie(f,m,w){if(!f.length)return;const A=s.getActiveEditor(),O=new j;let D=!0;O.onQueueEmpty=z=>{A&&D&&A.cancelChanges(),w(z)};for(let z=f.length-1;z>=0;z--){const[G,ne,,Z]=f[z],K=l.propToCol(ne),Se=s.getCellMeta(G,K);Se.type==="numeric"&&typeof Z=="string"&&YP(Z)&&(f[z][3]=re(Z)),s.getCellValidator(Se)&&(O.addValidatorToQueue(),s.validateCell(f[z][3],Se,function(Pe,Oe){return function(He){if(typeof He!="boolean")throw new Error("Validation error: result is not boolean");if(He===!1&&Oe.allowInvalid===!1){D=!1,f.splice(Pe,1),Oe.valid=!0;const Y=s.getCell(Oe.visualRow,Oe.visualCol);Y!==null&&Le(Y,y.invalidCellClassName)}O.removeValidatorFormQueue()}}(z,Se),m))}O.checkIfQueueIsEmpty()}function oe(f,m){let w=f.length-1;if(w<0)return;for(;w>=0;w--){let O=!1;if(f[w]===null){f.splice(w,1);continue}if(!((f[w][2]===null||f[w][2]===void 0)&&(f[w][3]===null||f[w][3]===void 0))){if(y.allowInsertRow)for(;f[w][0]>s.countRows()-1;){const{delta:D}=l.createRow(void 0,void 0,{source:m});if(D===0){O=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(f[w][1])>s.countCols()-1;){const{delta:D}=l.createCol(void 0,void 0,{source:m});if(D===0){O=!0;break}}O||l.set(f[w][0],f[w][1],f[w][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",f,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",f,m||"edit");const A=s.getActiveEditor();A&&ue(A.refreshValue)&&A.refreshValue()}this._createCellCoords=function(f,m){return s.view._wt.createCellCoords(f,m)},this._createCellRange=function(f,m,w){return s.view._wt.createCellRange(f,m,w)},this.validateCell=function(f,m,w,A){let O=s.getCellValidator(m);function D(z){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(z);return}const ne=m.visualCol,Z=m.visualRow,K=s.getCell(Z,ne,!0);if(K&&K.nodeName!=="TH"){const Se=s.rowIndexMapper.getRenderableFromVisualIndex(Z),Pe=s.columnIndexMapper.getRenderableFromVisualIndex(ne);s.view._wt.getSetting("cellRenderer",Se,Pe,K)}w(z)}eP(O)&&(O=function(z){return function(G,ne){ne(z.test(G))}}(O)),Ct(O)?(f=s.runHooks("beforeValidate",f,m.visualRow,m.prop,A),s._registerImmediate(()=>{O.call(m,f,z=>{s&&(z=s.runHooks("afterValidate",z,f,m.visualRow,m.prop,A),m.valid=z,D(z),s.runHooks("postAfterValidate",z,f,m.visualRow,m.prop,A))})})):s._registerImmediate(()=>{m.valid=!0,D(m.valid,!1)})};function Ce(f,m,w){return Array.isArray(f)?f:[[f,m,w]]}function Me(f,m){const w=s.getActiveEditor(),A=s.runHooks("beforeChange",f,m||"edit"),O=f.filter(D=>D!==null);return A===!1||O.length===0?(w&&w.cancelChanges(),[]):O}this.setDataAtCell=function(f,m,w,A){const O=Ce(f,m,w),D=[];let z=A,G,ne,Z;for(G=0,ne=O.length;G<ne;G++){if(typeof O[G]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof O[G][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");O[G][1]>=this.countCols()?Z=O[G][1]:Z=l.colToProp(O[G][1]),D.push([O[G][0],Z,u.getAtCell(this.toPhysicalRow(O[G][0]),O[G][1]),O[G][2]])}!z&&typeof f=="object"&&(z=m);const K=Me(D,A);s.runHooks("afterSetDataAtCell",K,z),ie(K,z,()=>{oe(K,z)})},this.setDataAtRowProp=function(f,m,w,A){const O=Ce(f,m,w),D=[];let z=A,G,ne;for(G=0,ne=O.length;G<ne;G++)D.push([O[G][0],O[G][1],u.getAtCell(this.toPhysicalRow(O[G][0]),O[G][1]),O[G][2]]);!z&&typeof f=="object"&&(z=m);const Z=Me(D,A);s.runHooks("afterSetDataAtRowProp",Z,z),ie(Z,z,()=>{oe(Z,z)})},this.listen=function(){s&&!s.isListening()&&(Nw.forEach(f=>{s!==f&&f.unlisten()}),Dw=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Dw=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Dw===s.guid},this.destroyEditor=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(f,m)},this.populateFromArray=function(f,m,w,A,O,D,z){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const G=typeof A=="number"?s._createCellCoords(A,O):null;return c.populateFromArray(s._createCellCoords(f,m),w,G,D,z)},this.spliceCol=function(f,m,w){for(var A=arguments.length,O=new Array(A>3?A-3:0),D=3;D<A;D++)O[D-3]=arguments[D];return l.spliceCol(f,m,w,...O)},this.spliceRow=function(f,m,w){for(var A=arguments.length,O=new Array(A>3?A-3:0),D=3;D<A;D++)O[D-3]=arguments[D];return l.spliceRow(f,m,w,...O)},this.getSelected=function(){if(F.isSelected())return Ye(F.getSelectedRange(),f=>{let{from:m,to:w}=f;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const f=this.getSelected();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.getSelectedRange=function(){if(F.isSelected())return Array.from(F.getSelectedRange())},this.getSelectedRangeLast=function(){const f=this.getSelectedRange();let m;return f&&f.length>0&&(m=f[f.length-1]),m},this.emptySelectedCells=function(f){if(!F.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];E(F.getSelectedRange(),w=>{if(w.isSingleHeader())return;const A=w.getTopStartCorner(),O=w.getBottomEndCorner();me(A.row,O.row,D=>{me(A.col,O.col,z=>{this.getCellMeta(D,z).readOnly||m.push([D,z,null])})})}),m.length>0&&this.setDataAtCell(m,f)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const f=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(f,0),!this.isRenderSuspended()&&f===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(f){this.suspendRender();const m=f();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||f)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=f();return this.resumeExecution(m),w},this.batch=function(f){this.suspendRender(),this.suspendExecution();const m=f();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:f,height:m}=s.view.getLastSize(),{width:w,height:A}=s.rootElement.getBoundingClientRect(),O=w!==f||A!==m;s.runHooks("beforeRefreshDimensions",{width:f,height:m},{width:w,height:A},O)!==!1&&((O||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(w,A),s.render()),s.runHooks("afterRefreshDimensions",{width:f,height:m},{width:w,height:A},O))},this.updateData=function(f,m){PE(f,w=>{l=w},w=>{l=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:S,firstRun:g})},this.loadData=function(f,m){PE(f,w=>{l=w},()=>{S.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:S,firstRun:g})},this.getInitialColumnCount=function(){const f=y.columns;let m=0;if(Array.isArray(f))m=f.length;else if(Ct(f))if(s.dataType==="array"){const w=this.countSourceCols();for(let A=0;A<w;A+=1)f(A)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(ue(y.dataSchema)){const w=l.getSchema();m=Array.isArray(w)?w.length:Lg(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(f,m,w,A){return vt(f)?l.getAll():l.getRange(s._createCellCoords(f,m),s._createCellCoords(w,A),l.DESTINATION_RENDERER)},this.getCopyableText=function(f,m,w,A){return l.getCopyableText(s._createCellCoords(f,m),s._createCellCoords(w,A))},this.getCopyableData=function(f,m){return l.getCopyable(f,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(g?s.loadData:s.updateData).bind(this);let A=!1,O,D;if(ue(f.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(f.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(f.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(O in f)O==="data"||(O==="language"?ee(f.language):O==="className"?U("className",f.className):O==="tableClassName"&&s.table?(U("tableClassName",f.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):de.getSingleton().isRegistered(O)||de.getSingleton().isDeprecated(O)?(Ct(f[O])||Array.isArray(f[O]))&&(f[O].initialHook=!0,s.addHook(O,f[O])):!m&&Pt(f,O)&&(R[O]=f[O]));f.data===void 0&&y.data===void 0?w(null,"updateSettings"):f.data!==void 0?w(f.data,"updateSettings"):f.columns!==void 0&&(l.createMap(),s.initIndexMappers());const z=s.countCols(),G=y.columns;if(G&&Ct(G)&&(A=!0),(f.cell!==void 0||f.cells!==void 0||f.columns!==void 0)&&S.clearCache(),z>0)for(O=0,D=0;O<z;O++){if(G){const K=A?G(O):G[D];K&&S.updateColumnMeta(D,K)}D+=1}ue(f.cell)&&Ge(f.cell,K=>{s.setCellMetaObject(K.row,K.col,K)}),s.runHooks("afterCellMetaReset");let ne=s.rootElement.style.height;ne!==""&&(ne=parseInt(s.rootElement.style.height,10));let Z=f.height;if(Ct(Z)&&(Z=Z()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),Z===null){const K=s.rootElement.getAttribute("data-initialstyle");K&&(K.indexOf("height")>-1||K.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",K):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else Z!==void 0&&(s.rootElement.style.height=isNaN(Z)?`${Z}`:`${Z}px`,s.rootElement.style.overflow="hidden");if(typeof f.width<"u"){let K=f.width;Ct(K)&&(K=K()),s.rootElement.style.width=isNaN(K)?`${K}`:`${K}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",f)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(ne===""||Z===""||Z===void 0)&&ne!==Z&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const f=s.getSelectedLast();if(y.getValue){if(Ct(y.getValue))return y.getValue.call(s);if(f)return s.getData()[f[0][0]][y.getValue]}else if(f)return s.getDataAtCell(f[0],f[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(f,m,w,A,O){c.alter(f,m,w,A,O)},this.getCell=function(f,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,A=m,O=f;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;A=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(f>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(f)))return null;O=this.rowIndexMapper.getRenderableFromVisualIndex(f)}return O===null||A===null?null:s.view.getCellAtCoords(s._createCellCoords(O,A),w)},this.getCoords=function(f){const m=this.view._wt.wtTable.getCoords(f);if(m===null)return null;const{row:w,col:A}=m;let O=w,D=A;return w>=0&&(O=this.rowIndexMapper.getVisualFromRenderableIndex(w)),A>=0&&(D=this.columnIndexMapper.getVisualFromRenderableIndex(A)),s._createCellCoords(O,D)},this.colToProp=function(f){return l.colToProp(f)},this.propToCol=function(f){return l.propToCol(f)},this.toVisualRow=f=>this.rowIndexMapper.getVisualFromPhysicalIndex(f),this.toVisualColumn=f=>this.columnIndexMapper.getVisualFromPhysicalIndex(f),this.toPhysicalRow=f=>this.rowIndexMapper.getPhysicalFromVisualIndex(f),this.toPhysicalColumn=f=>this.columnIndexMapper.getPhysicalFromVisualIndex(f),this.getDataAtCell=function(f,m){return l.get(f,l.colToProp(m))},this.getDataAtRowProp=function(f,m){return l.get(f,m)},this.getDataAtCol=function(f){const m=[],w=l.getRange(s._createCellCoords(0,f),s._createCellCoords(y.data.length-1,f),l.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let O=0;O<w[A].length;O+=1)m.push(w[A][O]);return m},this.getDataAtProp=function(f){const m=[],w=l.getRange(s._createCellCoords(0,l.propToCol(f)),s._createCellCoords(y.data.length-1,l.propToCol(f)),l.DESTINATION_RENDERER);for(let A=0;A<w.length;A+=1)for(let O=0;O<w[A].length;O+=1)m.push(w[A][O]);return m},this.getSourceData=function(f,m,w,A){let O;return f===void 0?O=u.getData():O=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(w,A)),O},this.getSourceDataArray=function(f,m,w,A){let O;return f===void 0?O=u.getData(!0):O=u.getByRange(s._createCellCoords(f,m),s._createCellCoords(w,A),!0),O},this.getSourceDataAtCol=function(f){return u.getAtColumn(f)},this.setSourceDataAtCell=function(f,m,w,A){const O=Ce(f,m,w),D=this.hasHook("afterSetSourceDataAtCell"),z=[];D&&E(O,ne=>{let[Z,K,Se]=ne;z.push([Z,K,u.getAtCell(Z,K),Se])}),E(O,ne=>{let[Z,K,Se]=ne;u.setAtCell(Z,K,Se)}),D&&this.runHooks("afterSetSourceDataAtCell",z,A),this.render();const G=s.getActiveEditor();G&&ue(G.refreshValue)&&G.refreshValue()},this.getSourceDataAtRow=function(f){return u.getAtRow(f)},this.getSourceDataAtCell=function(f,m){return u.getAtCell(f,m)},this.getDataAtRow=function(f){return l.getRange(s._createCellCoords(f,0),s._createCellCoords(f,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(f,m,w,A){const O=f===void 0?[0,0,this.countRows(),this.countCols()]:[f,m,w,A],[D,z]=O;let[,,G,ne]=O,Z=null,K=null;G===void 0&&(G=D),ne===void 0&&(ne=z);let Se="mixed";return me(Math.max(Math.min(D,G),0),Math.max(D,G),Pe=>{let Oe=!0;return me(Math.max(Math.min(z,ne),0),Math.max(z,ne),He=>(K=this.getCellMeta(Pe,He).type,Z?Oe=Z===K:Z=K,Oe)),Se=Oe?K:"mixed",Oe}),Se},this.removeCellMeta=function(f,m,w){const[A,O]=[this.toPhysicalRow(f),this.toPhysicalColumn(m)];let D=S.getCellMetaKeyValue(A,O,w);s.runHooks("beforeRemoveCellMeta",f,m,w,D)!==!1&&(S.removeCellMeta(A,O,w),s.runHooks("afterRemoveCellMeta",f,m,w,D)),D=null},this.spliceCellsMeta=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,A=new Array(w>2?w-2:0),O=2;O<w;O++)A[O-2]=arguments[O];if(A.length>0&&!Array.isArray(A[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&S.removeRow(this.toPhysicalRow(f),m),A.length>0&&E(A.reverse(),D=>{S.createRow(this.toPhysicalRow(f)),E(D,(z,G)=>this.setCellMetaObject(f,G,z))}),s.render()},this.setCellMetaObject=function(f,m,w){typeof w=="object"&&Ge(w,(A,O)=>{this.setCellMeta(f,m,O,A)})},this.setCellMeta=function(f,m,w,A){if(s.runHooks("beforeSetCellMeta",f,m,w,A)===!1)return;let D=f,z=m;f<this.countRows()&&(D=this.toPhysicalRow(f)),m<this.countCols()&&(z=this.toPhysicalColumn(m)),S.setCellMeta(D,z,w,A),s.runHooks("afterSetCellMeta",f,m,w,A)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(f,m){let w=this.toPhysicalRow(f),A=this.toPhysicalColumn(m);return w===null&&(w=f),A===null&&(A=m),S.getCellMeta(w,A,{visualRow:f,visualColumn:m})},this.getCellMetaAtRow=function(f){return S.getCellsMetaAtRow(f)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).renderer:f.renderer;return typeof w=="string"?Pf(w):vt(w)?Pf("text"):w},this.getCellEditor=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).editor:f.editor;return typeof w=="string"?Af(w):vt(w)?Af("text"):w},this.getCellValidator=function(f,m){const w=typeof f=="number"?s.getCellMeta(f,m).validator:f.validator;return typeof w=="string"?Gy(w):w},this.validateCells=function(f){this._validateCells(f)},this.validateRows=function(f,m){if(!Array.isArray(f))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,f)},this.validateColumns=function(f,m){if(!Array.isArray(f))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,f)},this._validateCells=function(f,m,w){const A=new j;f&&(A.onQueueEmpty=f);let O=s.countRows()-1;for(;O>=0;){if(m!==void 0&&m.indexOf(O)===-1){O-=1;continue}let D=s.countCols()-1;for(;D>=0;){if(w!==void 0&&w.indexOf(D)===-1){D-=1;continue}A.addValidatorToQueue(),s.validateCell(s.getDataAtCell(O,D),s.getCellMeta(O,D),z=>{if(typeof z!="boolean")throw new Error("Validation error: result is not boolean");z===!1&&(A.valid=!1),A.removeValidatorFormQueue()},"validateCells"),D-=1}O-=1}A.checkIfQueueIsEmpty()},this.getRowHeader=function(f){let m=y.rowHeaders,w=f;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(m=[],me(s.countRows()-1,A=>{m.push(s.getRowHeader(A))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:Ct(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let f=0,m=s.countCols();f<m;f++)if(s.getColHeader(f))return!0;return!1},this.getColHeader=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",f);if(w===void 0){const G=[],ne=s.countCols();for(let Z=0;Z<ne;Z++)G.push(s.getColHeader(Z));return G}let A=y.colHeaders;const O=function(G){const ne=[],Z=s.countCols();let K=0;for(;K<Z;K++)Ct(y.columns)&&y.columns(K)&&ne.push(K);return ne[G]},D=s.toPhysicalColumn(w),z=O(D);return y.colHeaders===!1?A=null:y.columns&&Ct(y.columns)&&y.columns(z)&&y.columns(z).title?A=y.columns(z).title:y.columns&&y.columns[D]&&y.columns[D].title?A=y.columns[D].title:Array.isArray(y.colHeaders)&&y.colHeaders[D]!==void 0?A=y.colHeaders[D]:Ct(y.colHeaders)?A=y.colHeaders(D):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(A=Bg(w)),A=s.runHooks("modifyColumnHeaderValue",A,f,m),A},this._getColWidthFromSettings=function(f){let m;if(f>=0&&(m=s.getCellMeta(0,f).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(f){let m=s._getColWidthFromSettings(f);return m=s.runHooks("modifyColWidth",m,f),m===void 0&&(m=Kc.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(f){let m=y.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[f];break;case"function":m=m(f);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(f){let m=s._getRowHeightFromSettings(f);return m=s.runHooks("modifyRowHeight",m,f),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const f=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(f,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return If(s.countRows()-1,w=>{if(s.isEmptyRow(w))m+=1;else if(f===!0)return!1}),m},this.countEmptyCols=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return If(s.countCols()-1,w=>{if(s.isEmptyCol(w))m+=1;else if(f===!0)return!1}),m},this.isEmptyRow=function(f){return y.isEmptyRow.call(s,f)},this.isEmptyCol=function(f){return y.isEmptyCol.call(s,f)},this.selectCell=function(f,m,w,A){let O=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,D=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return vt(f)||vt(m)?!1:this.selectCells([[f,m,w,A]],O,D)},this.selectCells=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(o=!0);const A=F.selectCells(f);return A&&w&&s.listen(),o=!1,A},this.selectColumns=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return F.selectColumns(f,m,w)},this.selectRows=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;return F.selectRows(f,m,w)},this.deselectCell=function(){F.deselect()},this.selectAll=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:f,w=arguments.length>2?arguments[2]:void 0;o=!0,F.selectAll(f,m,w),o=!1};const rt=(f,m)=>f.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(f){var m;if(typeof f=="number"){var w;f={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:A,col:O,verticalSnap:D,horizontalSnap:z,considerHiddenIndexes:G}=(m=f)!==null&&m!==void 0?m:{};let ne,Z,K,Se;D!==void 0&&(ne=D==="top",Z=!ne),z!==void 0&&(K=z==="start",Se=!K);let Pe=A,Oe=O;if(G===void 0||G){const lt=Number.isInteger(A)&&A>=0,Ue=Number.isInteger(O)&&O>=0,xe=lt?rt(this.rowIndexMapper,A):void 0,De=Ue?rt(this.columnIndexMapper,O):void 0;if(xe===null||De===null)return!1;Pe=lt?s.rowIndexMapper.getRenderableFromVisualIndex(xe):A,Oe=Ue?s.columnIndexMapper.getRenderableFromVisualIndex(De):O}const He=Number.isInteger(Pe),Y=Number.isInteger(Oe);return He&&Pe>=0&&Y&&Oe>=0?s.view.scrollViewport(s._createCellCoords(Pe,Oe),ne,Se,Z,K):He&&Pe>=0&&(Y&&Oe<0||!Y)?s.view.scrollViewportVertically(Pe,ne,Z):Y&&Oe>=0&&(He&&Pe<0||!He)?s.view.scrollViewportHorizontally(Oe,Se,K):!1},this.scrollToFocusedCell=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",f);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",f),this._registerImmediate(()=>f()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),S.clearCache(),Nw.delete(this.guid),qd(s)){const f=this.rootDocument.querySelector(".hot-display-license-info");f&&f.parentNode.removeChild(f)}oi(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),T.getItems().forEach(f=>{let[,m]=f;m.destroy()}),T.clear(),s.runHooks("afterDestroy")},!0),de.getSingleton().destroy(s),Ge(s,(f,m,w)=>{Ct(f)?w[m]=We(m):m!=="guid"&&(w[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,F=null,h=null,s=null};function We(f){return()=>{throw new Error(`The "${f}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(f){const m=Tn(f);return m==="UndoRedo"?this.undoRedo:T.getItem(m)},this.getPluginName=function(f){return f===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:T.getId(f)},this.getInstance=function(){return s},this.addHook=function(f,m){de.getSingleton().add(f,m,s)},this.hasHook=function(f){return de.getSingleton().has(f,s)||de.getSingleton().has(f)},this.addHookOnce=function(f,m){de.getSingleton().once(f,m,s)},this.removeHook=function(f,m){de.getSingleton().remove(f,m,s)},this.runHooks=function(f,m,w,A,O,D,z){return de.getSingleton().run(s,f,m,w,A,O,D,z)},this.getTranslatedPhrase=function(f,m){return Vx(y.language,f,m)},this.toHTML=()=>Bv(this),this.toTableElement=()=>{const f=this.rootDocument.createElement("div");return f.insertAdjacentHTML("afterbegin",Bv(this)),f.firstElementChild},this.timeouts=[],this._registerTimeout=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=f;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){E(this.timeouts,f=>{clearTimeout(f)})},this.immediates=[],this._registerImmediate=function(f){this.immediates.push(setImmediate(f))},this._clearImmediates=function(){E(this.immediates,f=>{clearImmediate(f)})},this._refreshBorders=function(){let f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(f),s.view.render(),m&&F.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const pe=B5({handleEvent(){return s.isListening()},beforeKeyDown:f=>this.runHooks("beforeKeyDown",f),afterKeyDown:f=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",f)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",f=>{f.ctrlKey===!1&&f.metaKey===!1&&pe.releasePressedKeys()}),this.getShortcutManager=function(){return pe},this.getFocusManager=function(){return d},Yy().forEach(f=>{const m=jc(f);T.addItem(f,new m(this))}),x5(s),pe.setActiveContextName("grid"),de.getSingleton().run(s,"construct")}const U5="hooksRefRegisterer",sH={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){E(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ge(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Fi(sH,"MIXIN_NAME",U5,{writable:!1,enumerable:!1});const Y5=sH;function Br(t,e,n){return e=G5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G5(t){var e=z5(t,"string");return typeof e=="symbol"?e:String(e)}function z5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const j5="base",qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),sS="baseEditor";class Yl{static get EDITOR_TYPE(){return j5}constructor(e){Br(this,"hot",void 0),Br(this,"state",qt.VIRGIN),Br(this,"_opened",!1),Br(this,"_fullEditMode",!1),Br(this,"_closeCallback",null),Br(this,"TD",null),Br(this,"row",null),Br(this,"col",null),Br(this,"prop",null),Br(this,"originalValue",null),Br(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=qt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>ue(this.hot.getSelected()),group:sS};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==qt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=qt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Wt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(sS),s.removeShortcutsByGroup(Fg),this.state===qt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===qt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=qt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=qt.FINISHED,this.discardEditor(l)}):(this.state=qt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=qt.FINISHED,this.discardEditor()}discardEditor(e){this.state===qt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=qt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=qt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===qt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=en(n),a=ft(n),l=en(this.hot.rootElement),u=ft(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:C}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,S=C.name,y=["master","inline_start"].includes(S)?d:0,R=["master","top","bottom"].includes(S)?g:0,T=s.top===l.top?0:1;let N=s.top-l.top-T-y,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-p-1+R:I=s.left-l.left-1-R,["top","top_inline_start_corner"].includes(S)&&(N+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const F=this.hot.hasColHeaders(),B=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ee=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),j=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(F&&B<=0||B===j)&&(N+=1),ee<=0&&(I+=1);const re=i.rowsRenderCalculator.startPosition,ie=i.columnsRenderCalculator.startPosition,oe=Math.abs(r.inlineStartOverlay.getScrollPosition()),Ce=r.topOverlay.getScrollPosition(),Me=nn(this.hot.rootDocument);let rt=n.offsetTop;if(["inline_start","master"].includes(S)&&(rt+=re-Ce),["bottom","bottom_inline_start_corner"].includes(S)){const{wtViewport:Z,wtTable:K}=r.bottomOverlay.clone;rt+=Z.getWorkspaceHeight()-K.getHeight()-Me}let We=n.offsetLeft;this.hot.isRtl()?(We>=0?We=C.getWidth()-n.offsetLeft:We=Math.abs(We),We+=ie-oe-a):["top","master","bottom"].includes(S)&&(We+=ie-oe);const pe=Co(this.TD,this.hot.rootWindow),f=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(pe[f],10)>0?0:1,w=parseInt(pe.borderTopWidth,10)>0?0:1,A=ft(n)+m,O=xt(n)+w,D=mP(c)?Me:0,z=pP(h)?Me:0,G=this.hot.view.maximumVisibleElementWidth(We)-D+m,ne=Math.max(this.hot.view.maximumVisibleElementHeight(rt)-z+w,23);return{top:N,start:I,height:O,maxHeight:ne,width:A,maxWidth:G}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}pt(Yl,Y5);function LE(t,e,n){t.addEventListener(e,n,!1)}function $E(t,e,n){t.removeEventListener(e,n,!1)}function kE(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function K5(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=kE(o).fontSize,i.style.fontFamily=kE(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const h=o.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),d&&(LE(o,"input",s),LE(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){$E(o,"input",s),$E(o,"keydown",a)}}}function FE(t,e){const n=Oy(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Uc(e,i)}function xs(t,e,n){return e=X5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X5(t){var e=q5(t,"string");return typeof e=="symbol"?e:String(e)}function q5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Z5="ht_editor_visible",Kh="ht_editor_hidden",WE="textEditor",J5="text";class ba extends Yl{static get EDITOR_TYPE(){return J5}constructor(e){super(e),xs(this,"eventManager",new xr(this)),xs(this,"autoResize",K5(this.hot.rootDocument)),xs(this,"TEXTAREA",void 0),xs(this,"textareaStyle",void 0),xs(this,"TEXTAREA_PARENT",void 0),xs(this,"textareaParentStyle",void 0),xs(this,"layerClass",void 0),this.eventManager=new xr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),lP(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==qt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===qt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Uc(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Ee(this.TEXTAREA,[["data-hot-input",""],Wl(-1)]),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Eo()]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ie(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Kh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){xP()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Kh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;me(e.length-1,r=>{const i=e[r];if(Ie(i,"handsontableEditor"))return n=!0,!1}),Ie(this.TEXTAREA_PARENT,Kh)&&Le(this.TEXTAREA_PARENT,Kh),n?(this.layerClass=Z5,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==qt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=Co(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=Co(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-c,g=s-h,p=o-c,C=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,p),minHeight:Math.min(g,C),maxWidth:p,maxHeight:C},!0)}bindEvents(){$y()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===qt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===qt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>ue(this.hot.getSelected()),group:WE},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;FE(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;FE(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Fg),n.removeShortcutsByGroup(WE),n.removeShortcutsByGroup(sS)}}const Q5="base";function eh(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&q(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(b0())):a&&c.push(b0()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(R0())):(u.push(s.invalidCellClassName),a&&c.push(R0()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Le(e,u),q(e,l),va(e,c),Ee(e,h)}eh.RENDERER_TYPE=Q5;const e8="text";function Ao(t,e,n,r,i,o,s){eh.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Wt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){oi(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else hs(e,a)}Ao.RENDERER_TYPE=e8;const t8="text",aH={CELL_TYPE:t8,editor:ba,renderer:Ao};yn(aH);_e.editors={BaseEditor:Yl};function _e(t,e){const n=new oH(t,e||{},ub);return n.init(),n}_e.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new oH(t,e,ub)};_e.DefaultSettings=Jx();_e.hooks=de.getSingleton();_e.CellCoords=Hf;_e.CellRange=jy;_e.packageName="handsontable";_e.buildDate="16/01/2024 09:37:55";_e.version="14.1.0";_e.languages={dictionaryKeys:v6,getLanguageDictionary:Wx,getLanguagesDictionaries:E6,registerLanguageDictionary:Eb,getTranslatedPhrase:Vx};const n8=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],VE="odd",lH=()=>["Ø¹ÙØ±","Ø¹ÙÙ","Ø¹Ø¨Ø¯ Ø§ÙÙÙ","ÙØ¹ØªØµÙ"][Math.floor(Math.random()*3)],uH=()=>["ØªØ±ÙÙØ§","ÙØµØ±","ÙØ¨ÙØ§Ù","Ø§ÙØ¹Ø±Ø§Ù"][Math.floor(Math.random()*3)],r8=()=>new Date(Math.floor(Math.random()*Date.now())).toLocaleDateString("en-gb"),BE=()=>Math.random()>.5,nc=(t=0,e=1e3)=>t+Math.floor(Math.random()*e),i8=()=>`${uH()} ${lH()} ${nc()}`,o8=()=>`${nc(1e5,999999).toString().match(/.{1,3}/g).join("-")}`;function s8(){return Array.from({length:50},()=>[BE(),lH(),uH(),i8(),r8(),o8(),BE(),nc(0,200).toString(),nc(1,10),nc(1,5)])}function Qd(){return new URLSearchParams(location.search.replace(/^\?/,"")).get("arabicExample")==="1"}function a8(){return Qd()?s8():n8}/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Feb 9, 2022
 *
 * Description: Definition file for Arabic - Without a specific country.
 */const l8={languageCode:"ar-AR",languageDirection:"rtl",[Gg]:"ÙØ§ ØªÙØ¬Ø¯ Ø®ÙØ§Ø±Ø§Øª ÙØªÙÙØ±Ø©",[zg]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø¹ÙÙ",[jg]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø³ÙÙ",[Kg]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙØ³Ø§Ø±",[Xg]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙÙÙÙ",[qg]:["Ø§Ø­Ø¯Ù Ø§ÙØµÙ","Ø§Ø­Ø°Ù Ø§ÙØµÙÙÙ"],[Zg]:["Ø§Ø­Ø¯Ù Ø§ÙØ¹ÙÙØ¯","Ø§Ø­Ø¯Ù Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Jg]:"ØªØ±Ø§Ø¬Ø¹",[Qg]:"Ø¥ÙØºØ§Ø¡ Ø§ÙØªØ±Ø§Ø¬Ø¹",[em]:"ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[tm]:"Ø§ÙØ±Øº Ø§ÙØ¹ÙÙØ¯",[dm]:"Ø§ÙÙØ­Ø§Ø°Ø§Ø©",[fm]:"ÙØ³Ø§Ø±",[gm]:"ÙØ³Ø·",[mm]:"ÙÙÙÙ",[pm]:"Ø¨Ø§ÙØªØ³Ø§ÙÙ",[wm]:"Ø£Ø¹ÙÙ",[Cm]:"ÙØªÙØ³Ø·",[vm]:"Ø£Ø³ÙÙ",[im]:"ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[om]:"Ø¥ÙØºØ§Ø¡ ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[Sm]:"Ø§ÙØ­Ø¯ÙØ¯",[ym]:"Ø£Ø¹ÙÙ",[bm]:"ÙÙÙÙ",[Rm]:"Ø£Ø³ÙÙ",[Em]:"ÙØ³Ø§Ø±",[Tm]:"Ø£Ø­Ø°Ù Ø§ÙØ­Ø¯(ÙØ¯)",[lm]:"Ø£Ø¶Ù ØªØ¹ÙÙÙØ§Ù",[um]:"ØªØ¹Ø¯ÙÙ Ø§ÙØªØ¹ÙÙÙ",[cm]:"Ø§Ø­Ø°Ù Ø§ÙØªØ¹ÙÙÙ",[hm]:"ØªØ¹ÙÙÙ ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[sm]:"Ø§Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[am]:"Ø¥ÙØºØ§Ø¡ Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[nm]:"ÙØ³Ø®",[rm]:"ÙØµ",[_m]:"Ø£Ø¯Ø®Ù ØµÙØ§Ù ÙØ±Ø¹ÙØ§Ù",[Mm]:"Ø§ÙØµÙ Ø¹Ù Ø§ÙØµÙ Ø§ÙØ£ØµÙÙ",[Am]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ¹ÙÙØ¯","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Om]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ¹ÙÙØ¯","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Im]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·Ø±","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·ÙØ±"],[Pm]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·Ø±","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·ÙØ±"],[Jc]:"Ø¨ÙØ§",[xm]:"ÙØ§Ø±Øº",[Hm]:"ØºÙØ± ÙØ§Ø±Øº",[Dm]:"ÙØ³Ø§ÙÙ",[Nm]:"ÙØ§ ÙØ³Ø§ÙÙ",[Lm]:"ÙØ¨Ø¯Ø§Ù Ø¨Ù",[$m]:"ÙÙØªÙÙ Ø¨Ù",[km]:"ÙØ­ØªÙÙ",[Fm]:"ÙØ§ ÙØ­ØªÙÙ",[Wm]:"Ø£ÙØ¨Ø± ÙÙ",[Vm]:"Ø£ÙØ¨Ø± Ø£Ù ÙØ³Ø§ÙÙ",[Bm]:"Ø£ØµØºØ±",[Um]:"Ø£ØµØºØ± Ø£Ù ÙØ³Ø§ÙÙ",[Ym]:"Ø¨ÙÙ",[Gm]:"Ø®Ø§Ø±Ø¬ Ø§ÙÙØ¬Ø§Ù",[zm]:"Ø¨Ø¹Ø¯",[jm]:"ÙØ¨Ù",[Km]:"Ø§ÙÙÙÙ",[Xm]:"ØºØ¯Ø§Ù",[qm]:"Ø§ÙØ¨Ø§Ø±Ø­Ø©",[_c]:"Ø®ÙØ§ÙØ§ ÙØ§Ø±ØºØ©",[Zm]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙØ´Ø±Ø·",[Jm]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙÙÙÙØ©",[Qm]:"Ù",[Qc]:"Ø£Ù",[ep]:"Ø§Ø®ØªÙØ§Ø± Ø§ÙÙÙ",[tp]:"Ø¥ÙØºØ§Ø¡",[np]:"ÙÙØ§ÙÙ",[rp]:"Ø¥ÙØºØ§Ø¡",[ip]:"Ø§ÙØ¨Ø­Ø«",[op]:"Ø§ÙÙÙÙØ©",[sp]:"Ø§ÙÙÙÙØ© Ø§ÙØ«Ø§ÙÙØ©"},cH=l8,UE="handsontableEditor",u8="handsontable";class Ob extends ba{static get EDITOR_TYPE(){return u8}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Uc(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&jt(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:UE,relativeToGroup:Fg,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Lr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(UE)}}function c8(t,e,n){h8(t,e),e.set(t,n)}function h8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xh(t,e,n){return e=d8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d8(t){var e=f8(t,"string");return typeof e=="symbol"?e:String(e)}function f8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YE(t,e){var n=g8(t,e,"get");return m8(t,n)}function g8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function m8(t,e){return e.get?e.get.call(t):e.value}const p8="autocomplete";var Lw=new WeakMap;class Ib extends Ob{constructor(){super(...arguments),Xh(this,"query",null),Xh(this,"strippedChoices",[]),Xh(this,"rawChoices",[]),c8(this,Lw,{writable:!0,value:this.hot.guid.slice(0,9)}),Xh(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=Lv(Wt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,g)=>{if(g.index===-1)return-1;if(d.index===-1)return 1;if(d.index<g.index)return-1;if(g.index<d.index)return 1;if(d.index===g.index){if(d.charsLeft<g.charsLeft)return-1;if(d.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return p8}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[dG(),aG(),iP("listbox"),wG()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Ir("false"),CG(`${YE(this,Lw)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=nn();a===0&&Ec()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[ft(this.TEXTAREA)-2]:void 0,width:e?ft(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,d,g,p)=>{Ao(l,u,c,h,d,g,p);const{filteringCaseSensitive:C,allowHtml:S,locale:y}=this.cellProperties,R=this.query;let T=Wt(g),N,I;T&&!S&&(N=C===!0?T.indexOf(R):T.toLocaleLowerCase(y).indexOf(R.toLocaleLowerCase(y)),N!==-1&&(I=T.substr(N,R.length),T=T.replace(I,`<strong>${I}</strong>`))),n&&Ee(u,[lG(),...r?[bG(i)]:[],...r?[RG(r.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=T},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Ee(c,[Ey()]),Ee(this.TEXTAREA,...vG(c.id))}}}),n&&(Ee(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Pi()),Ee(this.htEditor.rootElement,[rP(),SG("polite"),yG("text"),["id",`${YE(this,Lw)}-listbox-${o}-${s}`]]),Ee(this.TEXTAREA,...Ir("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Ir("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=Oy(this.TEXTAREA),r=gP(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Zu([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Uc(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=ca(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=en(this.TEXTAREA),o=xt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=xt(this.hot.view._wt.wtTable.THEAD),u=en(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,d=s>h&&c>h;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,s),d}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+nn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ye(e,o=>Wt(o));return Ye(r,o=>n?o:Lv(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===we.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===we.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(HP(e.keyCode)||e.keyCode===we.BACKSPACE||e.keyCode===we.DELETE||e.keyCode===we.INSERT){let n=10;if(e.keyCode===we.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const w8="html";function Pb(t,e,n,r,i,o,s){eh.apply(this,[t,e,n,r,i,o,s]),Sa(e,o??"",!1)}Pb.RENDERER_TYPE=w8;const C8="autocomplete";function Gl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?Pb:Ao,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Eo()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new xr(t);t.acArrowListener=function(d){Ie(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Gl.RENDERER_TYPE=C8;const v8="autocomplete";function cp(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,GE(n,e)):GE(n,e)(this.source):e(!0)}cp.VALIDATOR_TYPE=v8;function GE(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}const S8="autocomplete",y8={CELL_TYPE:S8,editor:Ib,renderer:Gl,validator:cp},b8="checkbox";class hH extends Yl{static get EDITOR_TYPE(){return b8}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Ie(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const zE=new WeakMap,jE=new WeakMap,R8="htBadValue",Dl="data-row",Nl="data-col",E8="checkboxRenderer",dH="checkbox";de.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===dH){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function xb(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;eh.apply(this,[t,e,n,r,i,o,s]),T8(t);let u=_8(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),oi(e),o===s.checkedTemplate||Wt(o).toLocaleLowerCase(s.locale)===Wt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Wt(o).toLocaleLowerCase(s.locale)===Wt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Zt(o)?q(u,"noValue"):(u.style.display="none",q(u,R8),h=!0),Ee(u,[[Dl,n],[Nl,r]]),l&&Ee(u,[by(u.checked?t.getTranslatedPhrase(bb):t.getTranslatedPhrase(Rb)),pG(u.checked),uG()]),!h&&c){let C="";if(c.value)C=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const y=t.getDataAtRowProp(n,c.property);C=y!==null?y:""}const S=M8(a,C,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(S),e.appendChild(u)):(S.appendChild(u),u=S):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(S)):(S.insertBefore(u,S.firstChild),u=S))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),zE.has(t)||(zE.set(t,!0),d());function d(){const S=t.getShortcutManager().getContext("grid"),y={group:E8};S.addShortcuts([{keys:[["space"]],callback:()=>(g(),!p())},{keys:[["enter"]],callback:()=>(g(),!p()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!p()),relativeToGroup:Ab,position:"before"}],y)}function g(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=t.getSelectedRange();if(S)for(let y=0;y<S.length;y++){const{row:R,col:T}=S[y].getTopStartCorner(),{row:N,col:I}=S[y].getBottomEndCorner(),F=[];for(let B=R;B<=N;B+=1)for(let ee=T;ee<=I;ee+=1){const U=t.getCellMeta(B,ee);if(U.type!=="checkbox")return;if(U.readOnly===!0)continue;typeof U.checkedTemplate>"u"&&(U.checkedTemplate=!0),typeof U.uncheckedTemplate>"u"&&(U.uncheckedTemplate=!1);const j=t.getDataAtCell(B,ee);C===!1?[U.checkedTemplate,U.checkedTemplate.toString()].includes(j)?F.push([B,ee,U.uncheckedTemplate]):[U.uncheckedTemplate,U.uncheckedTemplate.toString(),null,void 0].includes(j)&&F.push([B,ee,U.checkedTemplate]):F.push([B,ee,U.uncheckedTemplate])}F.length>0&&t.setDataAtCell(F)}}function p(){const C=t.getSelectedRange();if(C){for(let S=0;S<C.length;S++){const y=C[S].getTopStartCorner(),R=C[S].getBottomEndCorner();for(let T=y.row;T<=R.row;T++)for(let N=y.col;N<=R.col;N++){const I=t.getCellMeta(T,N);if(I.type!=="checkbox")return!1;const F=t.getCell(T,N);if(F==null)return!0;if(F.querySelectorAll("input[type=checkbox]").length>0&&!I.readOnly)return!0}}return!1}}}xb.RENDERER_TYPE=dH;function T8(t){let e=jE.get(t);if(!e){const{rootElement:n}=t;e=new xr(t),e.addEventListener(n,"click",r=>O8(r,t)),e.addEventListener(n,"mouseup",r=>A8(r,t)),e.addEventListener(n,"change",r=>I8(r,t)),jE.set(t,e)}return e}function _8(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function M8(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function A8(t,e){const{target:n}=t;Hb(n)&&(!n.hasAttribute(Dl)||!n.hasAttribute(Nl)||setTimeout(e.listen,10))}function O8(t,e){const{target:n}=t;if(!Hb(n)||!n.hasAttribute(Dl)||!n.hasAttribute(Nl))return;const r=parseInt(n.getAttribute(Dl),10),i=parseInt(n.getAttribute(Nl),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function I8(t,e){const{target:n}=t;if(!Hb(n)||!n.hasAttribute(Dl)||!n.hasAttribute(Nl))return;const r=parseInt(n.getAttribute(Dl),10),i=parseInt(n.getAttribute(Nl),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Hb(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const P8="checkbox",fH={CELL_TYPE:P8,editor:hH,renderer:xb};/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ts=()=>window,Mr=()=>window.document,aS=(t,e)=>window.setTimeout(t,e),bi=function(t,e,n,r){t.addEventListener(e,n,!!r)},Ki=function(t,e,n,r){t.removeEventListener(e,n,!!r)},x8=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},lr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},$w=function(t,e){lr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},kw=function(t,e){t.className=x8((" "+t.className+" ").replace(" "+e+" "," "))},Db=function(t){return/Array/.test(Object.prototype.toString.call(t))},cr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},H8=function(t){let e=t.getDay();return e===0||e===6},D8=function(t){return t%4===0&&t%100!==0||t%400===0},KE=function(t,e){return[31,D8(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},qh=function(t){cr(t)&&t.setHours(0,0,0,0)},Zh=function(t,e){return t.getTime()===e.getTime()},$f=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?cr(e[r])?n&&(t[r]=new Date(e[r].getTime())):Db(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=$f({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},XE=function(t,e,n){let r=Mr().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=$f(r,n),t.dispatchEvent(r)},qE=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},fi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ZE=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},N8=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},L8=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},$8=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():L8(o,i))+"</td>"},k8=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},F8=function(t){return"<tbody>"+t.join("")+"</tbody>"},W8=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+ZE(t,e)+'">'+ZE(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},V8=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',g,p,C=!0,S=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(g='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",Db(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return p='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=p+g:d+=g+p,c&&(r===0||u.minMonth>=r)&&(C=!1),h&&(r===11||u.maxMonth<=r)&&(S=!1),e===0&&(d+='<button class="pika-prev'+(C?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},B8=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+W8(t)+F8(e)+"</table>"};function lS(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||ts().event;let o=i.target||i.srcElement;if(o)if(lr(o,"is-disabled")||(lr(o,"pika-button")&&!lr(o,"is-empty")&&!lr(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&aS(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):lr(o,"pika-prev")?e.prevMonth():lr(o,"pika-next")&&e.nextMonth()),lr(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||ts().event;let o=i.target||i.srcElement;o&&(lr(o,"pika-select-month")?e.gotoMonth(o.value):lr(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||ts().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),cr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Mr().activeElement;do if(lr(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=aS(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||ts().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&lr(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),bi(o,"change",e._onChange)));do if(lr(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Mr().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),bi(e.el,"mousedown",e._onMouseDown,!0),bi(e.el,"touchend",e._onMouseDown,!0),bi(e.el,"change",e._onChange),n.keyboardInput&&bi(Mr(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Mr().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),bi(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;cr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",bi(n.trigger,"click",e._onInputClick),bi(n.trigger,"focus",e._onInputFocus),bi(n.trigger,"blur",e._onInputBlur)):this.show()}lS.prototype={config:function(t){this._o||(this._o=$f({},fi,!0));let e=$f(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,cr(e.minDate)||(e.minDate=!1),cr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),Db(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||fi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,cr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return cr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",XE(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!cr(t))return;let n=this._o.minDate,r=this._o.maxDate;cr(n)&&t<n?t=n:cr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),qh(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),XE(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(cr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=qE(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=qE({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(qh(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=fi.minDate,this._o.minYear=fi.minYear,this._o.minMonth=fi.minMonth,this._o.startRange=fi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(qh(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=fi.maxDate,this._o.maxYear=fi.maxYear,this._o.maxMonth=fi.maxMonth,this._o.endRange=fi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+V8(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&aS(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=ts().innerWidth||Mr().documentElement.clientWidth,i=ts().innerHeight||Mr().documentElement.clientHeight,o=Mr().body.scrollTop||Mr().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+ts().pageXOffset,a=l.bottom+ts().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",$w(this.el,u?"left-aligned":"right-aligned"),$w(this.el,c?"bottom-aligned":"top-aligned"),kw(this.el,u?"right-aligned":"left-aligned"),kw(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=KE(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];qh(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,g=KE(h,u),p=o+s,C=p;for(;C>7;)C-=7;p+=7-C;let S=!1;for(let y=0,R=0;y<p;y++){let T=new Date(t,e,1+(y-s)),N=cr(this._d)?Zh(T,this._d):!1,I=Zh(T,i),F=r.events.indexOf(T.toDateString())!==-1,B=y<s||y>=o+s,ee=1+(y-s),U=e,j=t,re=r.startRange&&Zh(r.startRange,T),ie=r.endRange&&Zh(r.endRange,T),oe=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,Ce=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&H8(T)||r.disableDayFn&&r.disableDayFn(T);B&&(y<s?(ee=g+ee,U=u,j=h):(ee=ee-o,U=c,j=d));let Me={day:ee,month:U,year:j,hasEvent:F,isSelected:N,isToday:I,isDisabled:Ce,isEmpty:B,isStartRange:re,isEndRange:ie,isInRange:oe,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&N&&(S=!0),l.push(N8(Me)),++R===7&&(r.showWeekNumber&&l.unshift($8(this,y-s,e,t,r.firstWeekOfYearMinDays)),a.push(k8(l,r.isRTL,r.pickWholeWeek,S)),l=[],R=0,S=!1)}return B8(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),kw(this.el,"is-hidden"),this._o.bound&&(bi(Mr(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Ki(Mr(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),$w(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Ki(this.el,"mousedown",this._onMouseDown,!0),Ki(this.el,"touchend",this._onMouseDown,!0),Ki(this.el,"change",this._onChange),t.keyboardInput&&Ki(Mr(),"keydown",this._onKeyChange),t.field&&(Ki(t.field,"change",this._onInputChange),t.bound&&(Ki(t.trigger,"click",this._onInputClick),Ki(t.trigger,"focus",this._onInputFocus),Ki(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Fw(t,e,n){return e=U8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U8(t){var e=Y8(t,"string");return typeof e=="symbol"?e:String(e)}function Y8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const gH="date",JE="dateEditor";class mH extends ba{constructor(){super(...arguments),Fw(this,"defaultDateFormat","DD/MM/YYYY"),Fw(this,"parentDestroyed",!1),Fw(this,"$datePicker",null)}static get EDITOR_TYPE(){return gH}init(){if(typeof X!="function")throw new Error("You need to include moment.js to your project.");if(typeof lS!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ie(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:JE})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(JE),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?Fy(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new lS(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(X),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+xt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-ft(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,X(s,r,!0).isValid()&&this.$datePicker.setMoment(X(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,X(s,r,!0).isValid()&&this.$datePicker.setMoment(X(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&zc(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=X(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const G8="date";function pH(t,e,n,r,i,o,s){Gl.apply(this,[t,e,n,r,i,o,s])}pH.RENDERER_TYPE=G8;function wH(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const z8=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:wH},Symbol.toStringTag,{value:"Module"})),j8="date";function Nb(t,e){const n=FP(gH,this.instance);let r=t,i=!0;r==null&&(r="");let o=X(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=X(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=K8(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}Nb.VALIDATOR_TYPE=j8;function K8(t,e){const n=X(wH(t)),r=X(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const X8="date",CH={CELL_TYPE:X8,editor:mH,renderer:pH,validator:Nb},q8="dropdown";class Lb extends Ib{static get EDITOR_TYPE(){return q8}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}de.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===Lb&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const Z8="dropdown";function $b(t,e,n,r,i,o,s){Gl.apply(this,[t,e,n,r,i,o,s])}$b.RENDERER_TYPE=Z8;const J8="dropdown";function kb(t,e){cp.apply(this,[t,e])}kb.VALIDATOR_TYPE=J8;const Q8="dropdown",vH={CELL_TYPE:Q8,editor:Lb,renderer:$b,validator:kb},e7="handsontable";function Fb(t,e,n,r,i,o,s){Gl.apply(this,[t,e,n,r,i,o,s])}Fb.RENDERER_TYPE=e7;const t7="handsontable",n7={CELL_TYPE:t7,editor:Ob,renderer:Fb},r7="numeric";class SH extends ba{static get EDITOR_TYPE(){return r7}}function Jh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yH={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof Jh=="function"&&Jh;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var g=i[u]={exports:{}};r[u][0].call(g.exports,function(p){return s(r[u][1][p]||p)},g,g.exports,n,r,i,o)}return i[u].exports}for(var a=typeof Jh=="function"&&Jh,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,g=14,p=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,y=1e9;function R(U){var j=0|U;return 0<U||U===j?j:j-1}function T(U){for(var j,re,ie=1,oe=U.length,Ce=U[0]+"";ie<oe;){for(j=U[ie++]+"",re=g-j.length;re--;j="0"+j);Ce+=j}for(oe=Ce.length;Ce.charCodeAt(--oe)===48;);return Ce.slice(0,oe+1||1)}function N(U,j){var re,ie,oe=U.c,Ce=j.c,Me=U.s,rt=j.s,We=U.e,pe=j.e;if(!Me||!rt)return null;if(re=oe&&!oe[0],ie=Ce&&!Ce[0],re||ie)return re?ie?0:-rt:Me;if(Me!=rt)return Me;if(re=Me<0,ie=We==pe,!oe||!Ce)return ie?0:!oe^re?1:-1;if(!ie)return pe<We^re?1:-1;for(rt=(We=oe.length)<(pe=Ce.length)?We:pe,Me=0;Me<rt;Me++)if(oe[Me]!=Ce[Me])return oe[Me]>Ce[Me]^re?1:-1;return We==pe?0:pe<We^re?1:-1}function I(U,j,re,ie){if(U<j||re<U||U!==(U<0?l(U):u(U)))throw Error(c+(ie||"Argument")+(typeof U=="number"?U<j||re<U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(U))}function F(U){var j=U.c.length-1;return R(U.e/g)==j&&U.c[j]%2!=0}function B(U,j){return(1<U.length?U.charAt(0)+"."+U.slice(1):U)+(j<0?"e":"e+")+j}function ee(U,j,re){var ie,oe;if(j<0){for(oe=re+".";++j;oe+=re);U=oe+U}else if(++j>(ie=U.length)){for(oe=re,j-=ie;--j;oe+=re);U+=oe}else j<ie&&(U=U.slice(0,j)+"."+U.slice(j));return U}(s=function U(j){var re,ie,oe,Ce,Me,rt,We,pe,f,m,w=Y.prototype={constructor:Y,toString:null,valueOf:null},A=new Y(1),O=20,D=4,z=-7,G=21,ne=-1e7,Z=1e7,K=!1,Se=1,Pe=0,Oe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},He="0123456789abcdefghijklmnopqrstuvwxyz";function Y(v,b){var _,k,M,$,P,H,W,L,V=this;if(!(V instanceof Y))return new Y(v,b);if(b==null){if(v instanceof Y)return V.s=v.s,V.e=v.e,void(V.c=(v=v.c)?v.slice():v);if((H=typeof v=="number")&&0*v==0){if(V.s=1/v<0?(v=-v,-1):1,v===~~v){for($=0,P=v;10<=P;P/=10,$++);return V.e=$,void(V.c=[v])}L=String(v)}else{if(L=String(v),!a.test(L))return oe(V,L,H);V.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<($=L.indexOf("."))&&(L=L.replace(".","")),0<(P=L.search(/e/i))?($<0&&($=P),$+=+L.slice(P+1),L=L.substring(0,P)):$<0&&($=L.length)}else{if(I(b,2,He.length,"Base"),L=String(v),b==10)return De(V=new Y(v instanceof Y?v:L),O+V.e+1,D);if(H=typeof v=="number"){if(0*v!=0)return oe(V,L,H,b);if(V.s=1/v<0?(L=L.slice(1),-1):1,Y.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(h+v);H=!1}else V.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(_=He.slice(0,b),$=P=0,W=L.length;P<W;P++)if(_.indexOf(k=L.charAt(P))<0){if(k=="."){if($<P){$=W;continue}}else if(!M&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){M=!0,P=-1,$=0;continue}return oe(V,String(v),H,b)}-1<($=(L=ie(L,b,10,V.s)).indexOf("."))?L=L.replace(".",""):$=L.length}for(P=0;L.charCodeAt(P)===48;P++);for(W=L.length;L.charCodeAt(--W)===48;);if(L=L.slice(P,++W)){if(W-=P,H&&Y.DEBUG&&15<W&&(p<v||v!==u(v)))throw Error(h+V.s*v);if(Z<($=$-P-1))V.c=V.e=null;else if($<ne)V.c=[V.e=0];else{if(V.e=$,V.c=[],P=($+1)%g,$<0&&(P+=g),P<W){for(P&&V.c.push(+L.slice(0,P)),W-=g;P<W;)V.c.push(+L.slice(P,P+=g));L=L.slice(P),P=g-L.length}else P-=W;for(;P--;L+="0");V.c.push(+L)}}else V.c=[V.e=0]}function lt(v,b,_,k){var M,$,P,H,W;if(_==null?_=D:I(_,0,8),!v.c)return v.toString();if(M=v.c[0],P=v.e,b==null)W=T(v.c),W=k==1||k==2&&(P<=z||G<=P)?B(W,P):ee(W,P,"0");else if($=(v=De(new Y(v),b,_)).e,H=(W=T(v.c)).length,k==1||k==2&&(b<=$||$<=z)){for(;H<b;W+="0",H++);W=B(W,$)}else if(b-=P,W=ee(W,$,"0"),H<$+1){if(0<--b)for(W+=".";b--;W+="0");}else if(0<(b+=$-H))for($+1==H&&(W+=".");b--;W+="0");return v.s<0&&M?"-"+W:W}function Ue(v,b){for(var _,k=1,M=new Y(v[0]);k<v.length;k++){if(!(_=new Y(v[k])).s){M=_;break}b.call(M,_)&&(M=_)}return M}function xe(v,b,_){for(var k=1,M=b.length;!b[--M];b.pop());for(M=b[0];10<=M;M/=10,k++);return(_=k+_*g-1)>Z?v.c=v.e=null:v.c=_<ne?[v.e=0]:(v.e=_,b),v}function De(v,b,_,k){var M,$,P,H,W,L,V,te=v.c,he=C;if(te){e:{for(M=1,H=te[0];10<=H;H/=10,M++);if(($=b-M)<0)$+=g,P=b,V=(W=te[L=0])/he[M-P-1]%10|0;else if((L=l(($+1)/g))>=te.length){if(!k)break e;for(;te.length<=L;te.push(0));W=V=0,P=($%=g)-g+(M=1)}else{for(W=H=te[L],M=1;10<=H;H/=10,M++);V=(P=($%=g)-g+M)<0?0:W/he[M-P-1]%10|0}if(k=k||b<0||te[L+1]!=null||(P<0?W:W%he[M-P-1]),k=_<4?(V||k)&&(_==0||_==(v.s<0?3:2)):5<V||V==5&&(_==4||k||_==6&&(0<$?0<P?W/he[M-P]:0:te[L-1])%10&1||_==(v.s<0?8:7)),b<1||!te[0])return te.length=0,k?(b-=v.e+1,te[0]=he[(g-b%g)%g],v.e=-b||0):te[0]=v.e=0,v;if($==0?(te.length=L,H=1,L--):(te.length=L+1,H=he[g-$],te[L]=0<P?u(W/he[M-P]%he[P])*H:0),k)for(;;){if(L==0){for($=1,P=te[0];10<=P;P/=10,$++);for(P=te[0]+=H,H=1;10<=P;P/=10,H++);$!=H&&(v.e++,te[0]==d&&(te[0]=1));break}if(te[L]+=H,te[L]!=d)break;te[L--]=0,H=1}for($=te.length;te[--$]===0;te.pop());}v.e>Z?v.c=v.e=null:v.e<ne&&(v.c=[v.e=0])}return v}function be(v){var b,_=v.e;return _===null?v.toString():(b=T(v.c),b=_<=z||G<=_?B(b,_):ee(b,_,"0"),v.s<0?"-"+b:b)}return Y.clone=U,Y.ROUND_UP=0,Y.ROUND_DOWN=1,Y.ROUND_CEIL=2,Y.ROUND_FLOOR=3,Y.ROUND_HALF_UP=4,Y.ROUND_HALF_DOWN=5,Y.ROUND_HALF_EVEN=6,Y.ROUND_HALF_CEIL=7,Y.ROUND_HALF_FLOOR=8,Y.EUCLID=9,Y.config=Y.set=function(v){var b,_;if(v!=null){if(typeof v!="object")throw Error(c+"Object expected: "+v);if(v.hasOwnProperty(b="DECIMAL_PLACES")&&(I(_=v[b],0,y,b),O=_),v.hasOwnProperty(b="ROUNDING_MODE")&&(I(_=v[b],0,8,b),D=_),v.hasOwnProperty(b="EXPONENTIAL_AT")&&((_=v[b])&&_.pop?(I(_[0],-y,0,b),I(_[1],0,y,b),z=_[0],G=_[1]):(I(_,-y,y,b),z=-(G=_<0?-_:_))),v.hasOwnProperty(b="RANGE"))if((_=v[b])&&_.pop)I(_[0],-y,-1,b),I(_[1],1,y,b),ne=_[0],Z=_[1];else{if(I(_,-y,y,b),!_)throw Error(c+b+" cannot be zero: "+_);ne=-(Z=_<0?-_:_)}if(v.hasOwnProperty(b="CRYPTO")){if((_=v[b])!==!!_)throw Error(c+b+" not true or false: "+_);if(_){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw K=!_,Error(c+"crypto unavailable");K=_}else K=_}if(v.hasOwnProperty(b="MODULO_MODE")&&(I(_=v[b],0,9,b),Se=_),v.hasOwnProperty(b="POW_PRECISION")&&(I(_=v[b],0,y,b),Pe=_),v.hasOwnProperty(b="FORMAT")){if(typeof(_=v[b])!="object")throw Error(c+b+" not an object: "+_);Oe=_}if(v.hasOwnProperty(b="ALPHABET")){if(typeof(_=v[b])!="string"||/^.$|[+-.\s]|(.).*\1/.test(_))throw Error(c+b+" invalid: "+_);He=_}}return{DECIMAL_PLACES:O,ROUNDING_MODE:D,EXPONENTIAL_AT:[z,G],RANGE:[ne,Z],CRYPTO:K,MODULO_MODE:Se,POW_PRECISION:Pe,FORMAT:Oe,ALPHABET:He}},Y.isBigNumber=function(v){return v instanceof Y||v&&v._isBigNumber===!0||!1},Y.maximum=Y.max=function(){return Ue(arguments,w.lt)},Y.minimum=Y.min=function(){return Ue(arguments,w.gt)},Y.random=(Ce=9007199254740992,Me=Math.random()*Ce&2097151?function(){return u(Math.random()*Ce)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(v){var b,_,k,M,$,P=0,H=[],W=new Y(A);if(v==null?v=O:I(v,0,y),M=l(v/g),K)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(M*=2));P<M;)9e15<=($=131072*b[P]+(b[P+1]>>>11))?(_=crypto.getRandomValues(new Uint32Array(2)),b[P]=_[0],b[P+1]=_[1]):(H.push($%1e14),P+=2);P=M/2}else{if(!crypto.randomBytes)throw K=!1,Error(c+"crypto unavailable");for(b=crypto.randomBytes(M*=7);P<M;)9e15<=($=281474976710656*(31&b[P])+1099511627776*b[P+1]+4294967296*b[P+2]+16777216*b[P+3]+(b[P+4]<<16)+(b[P+5]<<8)+b[P+6])?crypto.randomBytes(7).copy(b,P):(H.push($%1e14),P+=7);P=M/7}if(!K)for(;P<M;)($=Me())<9e15&&(H[P++]=$%1e14);for(M=H[--P],v%=g,M&&v&&($=C[g-v],H[P]=u(M/$)*$);H[P]===0;H.pop(),P--);if(P<0)H=[k=0];else{for(k=-1;H[0]===0;H.splice(0,1),k-=g);for(P=1,$=H[0];10<=$;$/=10,P++);P<g&&(k-=g-P)}return W.e=k,W.c=H,W}),Y.sum=function(){for(var v=1,b=arguments,_=new Y(b[0]);v<b.length;)_=_.plus(b[v++]);return _},ie=function(){var v="0123456789";function b(_,k,M,$){for(var P,H,W=[0],L=0,V=_.length;L<V;){for(H=W.length;H--;W[H]*=k);for(W[0]+=$.indexOf(_.charAt(L++)),P=0;P<W.length;P++)W[P]>M-1&&(W[P+1]==null&&(W[P+1]=0),W[P+1]+=W[P]/M|0,W[P]%=M)}return W.reverse()}return function(_,k,M,$,P){var H,W,L,V,te,he,ye,Ae,Ve=_.indexOf("."),St=O,Ze=D;for(0<=Ve&&(V=Pe,Pe=0,_=_.replace(".",""),he=(Ae=new Y(k)).pow(_.length-Ve),Pe=V,Ae.c=b(ee(T(he.c),he.e,"0"),10,M,v),Ae.e=Ae.c.length),L=V=(ye=b(_,k,M,P?(H=He,v):(H=v,He))).length;ye[--V]==0;ye.pop());if(!ye[0])return H.charAt(0);if(Ve<0?--L:(he.c=ye,he.e=L,he.s=$,ye=(he=re(he,Ae,St,Ze,M)).c,te=he.r,L=he.e),Ve=ye[W=L+St+1],V=M/2,te=te||W<0||ye[W+1]!=null,te=Ze<4?(Ve!=null||te)&&(Ze==0||Ze==(he.s<0?3:2)):V<Ve||Ve==V&&(Ze==4||te||Ze==6&&1&ye[W-1]||Ze==(he.s<0?8:7)),W<1||!ye[0])_=te?ee(H.charAt(1),-St,H.charAt(0)):H.charAt(0);else{if(ye.length=W,te)for(--M;++ye[--W]>M;)ye[W]=0,W||(++L,ye=[1].concat(ye));for(V=ye.length;!ye[--V];);for(Ve=0,_="";Ve<=V;_+=H.charAt(ye[Ve++]));_=ee(_,L,H.charAt(0))}return _}}(),re=function(){function v(k,M,$){var P,H,W,L,V=0,te=k.length,he=M%S,ye=M/S|0;for(k=k.slice();te--;)V=((H=he*(W=k[te]%S)+(P=ye*W+(L=k[te]/S|0)*he)%S*S+V)/$|0)+(P/S|0)+ye*L,k[te]=H%$;return V&&(k=[V].concat(k)),k}function b(k,M,$,P){var H,W;if($!=P)W=P<$?1:-1;else for(H=W=0;H<$;H++)if(k[H]!=M[H]){W=k[H]>M[H]?1:-1;break}return W}function _(k,M,$,P){for(var H=0;$--;)k[$]-=H,H=k[$]<M[$]?1:0,k[$]=H*P+k[$]-M[$];for(;!k[0]&&1<k.length;k.splice(0,1));}return function(k,M,$,P,H){var W,L,V,te,he,ye,Ae,Ve,St,Ze,ct,_t,Ra,Kl,Bt,cn,bs,Pn=k.s==M.s?1:-1,Jt=k.c,yt=M.c;if(!(Jt&&Jt[0]&&yt&&yt[0]))return new Y(k.s&&M.s&&(Jt?!yt||Jt[0]!=yt[0]:yt)?Jt&&Jt[0]==0||!yt?0*Pn:Pn/0:NaN);for(St=(Ve=new Y(Pn)).c=[],Pn=$+(L=k.e-M.e)+1,H||(H=d,L=R(k.e/g)-R(M.e/g),Pn=Pn/g|0),V=0;yt[V]==(Jt[V]||0);V++);if(yt[V]>(Jt[V]||0)&&L--,Pn<0)St.push(1),te=!0;else{for(Kl=Jt.length,cn=yt.length,Pn+=2,1<(he=u(H/(yt[V=0]+1)))&&(yt=v(yt,he,H),Jt=v(Jt,he,H),cn=yt.length,Kl=Jt.length),Ra=cn,ct=(Ze=Jt.slice(0,cn)).length;ct<cn;Ze[ct++]=0);bs=yt.slice(),bs=[0].concat(bs),Bt=yt[0],yt[1]>=H/2&&Bt++;do{if(he=0,(W=b(yt,Ze,cn,ct))<0){if(_t=Ze[0],cn!=ct&&(_t=_t*H+(Ze[1]||0)),1<(he=u(_t/Bt)))for(H<=he&&(he=H-1),Ae=(ye=v(yt,he,H)).length,ct=Ze.length;b(ye,Ze,Ae,ct)==1;)he--,_(ye,cn<Ae?bs:yt,Ae,H),Ae=ye.length,W=1;else he==0&&(W=he=1),Ae=(ye=yt.slice()).length;if(Ae<ct&&(ye=[0].concat(ye)),_(Ze,ye,ct,H),ct=Ze.length,W==-1)for(;b(yt,Ze,cn,ct)<1;)he++,_(Ze,cn<ct?bs:yt,ct,H),ct=Ze.length}else W===0&&(he++,Ze=[0]);St[V++]=he,Ze[0]?Ze[ct++]=Jt[Ra]||0:(Ze=[Jt[Ra]],ct=1)}while((Ra++<Kl||Ze[0]!=null)&&Pn--);te=Ze[0]!=null,St[0]||St.splice(0,1)}if(H==d){for(V=1,Pn=St[0];10<=Pn;Pn/=10,V++);De(Ve,$+(Ve.e=V+L*g-1)+1,P,te)}else Ve.e=L,Ve.r=+te;return Ve}}(),rt=/^(-?)0([xbo])(?=\w[\w.]*$)/i,We=/^([^.]+)\.$/,pe=/^\.([^.]+)$/,f=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,oe=function(v,b,_,k){var M,$=_?b:b.replace(m,"");if(f.test($))v.s=isNaN($)?null:$<0?-1:1,v.c=v.e=null;else{if(!_&&($=$.replace(rt,function(P,H,W){return M=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,k&&k!=M?P:H}),k&&(M=k,$=$.replace(We,"$1").replace(pe,"0.$1")),b!=$))return new Y($,M);if(Y.DEBUG)throw Error(c+"Not a"+(k?" base "+k:"")+" number: "+b);v.c=v.e=v.s=null}},w.absoluteValue=w.abs=function(){var v=new Y(this);return v.s<0&&(v.s=1),v},w.comparedTo=function(v,b){return N(this,new Y(v,b))},w.decimalPlaces=w.dp=function(v,b){var _,k,M;if(v!=null)return I(v,0,y),b==null?b=D:I(b,0,8),De(new Y(this),v+this.e+1,b);if(!(_=this.c))return null;if(k=((M=_.length-1)-R(this.e/g))*g,M=_[M])for(;M%10==0;M/=10,k--);return k<0&&(k=0),k},w.dividedBy=w.div=function(v,b){return re(this,new Y(v,b),O,D)},w.dividedToIntegerBy=w.idiv=function(v,b){return re(this,new Y(v,b),0,1)},w.exponentiatedBy=w.pow=function(v,b){var _,k,M,$,P,H,W,L,V=this;if((v=new Y(v)).c&&!v.isInteger())throw Error(c+"Exponent not an integer: "+be(v));if(b!=null&&(b=new Y(b)),P=14<v.e,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!v.c||!v.c[0])return L=new Y(Math.pow(+be(V),P?2-F(v):+be(v))),b?L.mod(b):L;if(H=v.s<0,b){if(b.c?!b.c[0]:!b.s)return new Y(NaN);(k=!H&&V.isInteger()&&b.isInteger())&&(V=V.mod(b))}else{if(9<v.e&&(0<V.e||V.e<-1||(V.e==0?1<V.c[0]||P&&24e7<=V.c[1]:V.c[0]<8e13||P&&V.c[0]<=9999975e7)))return $=V.s<0&&F(v)?-0:0,-1<V.e&&($=1/$),new Y(H?1/$:$);Pe&&($=l(Pe/g+2))}for(W=P?(_=new Y(.5),H&&(v.s=1),F(v)):(M=Math.abs(+be(v)))%2,L=new Y(A);;){if(W){if(!(L=L.times(V)).c)break;$?L.c.length>$&&(L.c.length=$):k&&(L=L.mod(b))}if(M){if((M=u(M/2))===0)break;W=M%2}else if(De(v=v.times(_),v.e+1,1),14<v.e)W=F(v);else{if((M=+be(v))==0)break;W=M%2}V=V.times(V),$?V.c&&V.c.length>$&&(V.c.length=$):k&&(V=V.mod(b))}return k?L:(H&&(L=A.div(L)),b?L.mod(b):$?De(L,Pe,D,void 0):L)},w.integerValue=function(v){var b=new Y(this);return v==null?v=D:I(v,0,8),De(b,b.e+1,v)},w.isEqualTo=w.eq=function(v,b){return N(this,new Y(v,b))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(v,b){return 0<N(this,new Y(v,b))},w.isGreaterThanOrEqualTo=w.gte=function(v,b){return(b=N(this,new Y(v,b)))===1||b===0},w.isInteger=function(){return!!this.c&&R(this.e/g)>this.c.length-2},w.isLessThan=w.lt=function(v,b){return N(this,new Y(v,b))<0},w.isLessThanOrEqualTo=w.lte=function(v,b){return(b=N(this,new Y(v,b)))===-1||b===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(v,b){var _,k,M,$,P=this,H=P.s;if(b=(v=new Y(v,b)).s,!H||!b)return new Y(NaN);if(H!=b)return v.s=-b,P.plus(v);var W=P.e/g,L=v.e/g,V=P.c,te=v.c;if(!W||!L){if(!V||!te)return V?(v.s=-b,v):new Y(te?P:NaN);if(!V[0]||!te[0])return te[0]?(v.s=-b,v):new Y(V[0]?P:D==3?-0:0)}if(W=R(W),L=R(L),V=V.slice(),H=W-L){for((M=($=H<0)?(H=-H,V):(L=W,te)).reverse(),b=H;b--;M.push(0));M.reverse()}else for(k=($=(H=V.length)<(b=te.length))?H:b,H=b=0;b<k;b++)if(V[b]!=te[b]){$=V[b]<te[b];break}if($&&(M=V,V=te,te=M,v.s=-v.s),0<(b=(k=te.length)-(_=V.length)))for(;b--;V[_++]=0);for(b=d-1;H<k;){if(V[--k]<te[k]){for(_=k;_&&!V[--_];V[_]=b);--V[_],V[k]+=d}V[k]-=te[k]}for(;V[0]==0;V.splice(0,1),--L);return V[0]?xe(v,V,L):(v.s=D==3?-1:1,v.c=[v.e=0],v)},w.modulo=w.mod=function(v,b){var _,k,M=this;return v=new Y(v,b),!M.c||!v.s||v.c&&!v.c[0]?new Y(NaN):!v.c||M.c&&!M.c[0]?new Y(M):(Se==9?(k=v.s,v.s=1,_=re(M,v,0,3),v.s=k,_.s*=k):_=re(M,v,0,Se),(v=M.minus(_.times(v))).c[0]||Se!=1||(v.s=M.s),v)},w.multipliedBy=w.times=function(v,b){var _,k,M,$,P,H,W,L,V,te,he,ye,Ae,Ve,St,Ze=this,ct=Ze.c,_t=(v=new Y(v,b)).c;if(!(ct&&_t&&ct[0]&&_t[0]))return!Ze.s||!v.s||ct&&!ct[0]&&!_t||_t&&!_t[0]&&!ct?v.c=v.e=v.s=null:(v.s*=Ze.s,ct&&_t?(v.c=[0],v.e=0):v.c=v.e=null),v;for(k=R(Ze.e/g)+R(v.e/g),v.s*=Ze.s,(W=ct.length)<(te=_t.length)&&(Ae=ct,ct=_t,_t=Ae,M=W,W=te,te=M),M=W+te,Ae=[];M--;Ae.push(0));for(Ve=d,St=S,M=te;0<=--M;){for(_=0,he=_t[M]%St,ye=_t[M]/St|0,$=M+(P=W);M<$;)_=((L=he*(L=ct[--P]%St)+(H=ye*L+(V=ct[P]/St|0)*he)%St*St+Ae[$]+_)/Ve|0)+(H/St|0)+ye*V,Ae[$--]=L%Ve;Ae[$]=_}return _?++k:Ae.splice(0,1),xe(v,Ae,k)},w.negated=function(){var v=new Y(this);return v.s=-v.s||null,v},w.plus=function(v,b){var _,k=this,M=k.s;if(b=(v=new Y(v,b)).s,!M||!b)return new Y(NaN);if(M!=b)return v.s=-b,k.minus(v);var $=k.e/g,P=v.e/g,H=k.c,W=v.c;if(!$||!P){if(!H||!W)return new Y(M/0);if(!H[0]||!W[0])return W[0]?v:new Y(H[0]?k:0*M)}if($=R($),P=R(P),H=H.slice(),M=$-P){for((_=0<M?(P=$,W):(M=-M,H)).reverse();M--;_.push(0));_.reverse()}for((M=H.length)-(b=W.length)<0&&(_=W,W=H,H=_,b=M),M=0;b;)M=(H[--b]=H[b]+W[b]+M)/d|0,H[b]=d===H[b]?0:H[b]%d;return M&&(H=[M].concat(H),++P),xe(v,H,P)},w.precision=w.sd=function(v,b){var _,k,M;if(v!=null&&v!==!!v)return I(v,1,y),b==null?b=D:I(b,0,8),De(new Y(this),v,b);if(!(_=this.c))return null;if(k=(M=_.length-1)*g+1,M=_[M]){for(;M%10==0;M/=10,k--);for(M=_[0];10<=M;M/=10,k++);}return v&&this.e+1>k&&(k=this.e+1),k},w.shiftedBy=function(v){return I(v,-p,p),this.times("1e"+v)},w.squareRoot=w.sqrt=function(){var v,b,_,k,M,$=this,P=$.c,H=$.s,W=$.e,L=O+4,V=new Y("0.5");if(H!==1||!P||!P[0])return new Y(!H||H<0&&(!P||P[0])?NaN:P?$:1/0);if((_=(H=Math.sqrt(+be($)))==0||H==1/0?(((b=T(P)).length+W)%2==0&&(b+="0"),H=Math.sqrt(+b),W=R((W+1)/2)-(W<0||W%2),new Y(b=H==1/0?"1e"+W:(b=H.toExponential()).slice(0,b.indexOf("e")+1)+W)):new Y(H+"")).c[0]){for((H=(W=_.e)+L)<3&&(H=0);;)if(M=_,_=V.times(M.plus(re($,M,L,1))),T(M.c).slice(0,H)===(b=T(_.c)).slice(0,H)){if(_.e<W&&--H,(b=b.slice(H-3,H+1))!="9999"&&(k||b!="4999")){+b&&(+b.slice(1)||b.charAt(0)!="5")||(De(_,_.e+O+2,1),v=!_.times(_).eq($));break}if(!k&&(De(M,M.e+O+2,0),M.times(M).eq($))){_=M;break}L+=4,H+=4,k=1}}return De(_,_.e+O+1,D,v)},w.toExponential=function(v,b){return v!=null&&(I(v,0,y),v++),lt(this,v,b,1)},w.toFixed=function(v,b){return v!=null&&(I(v,0,y),v=v+this.e+1),lt(this,v,b)},w.toFormat=function(v,b,_){var k;if(_==null)v!=null&&b&&typeof b=="object"?(_=b,b=null):v&&typeof v=="object"?(_=v,v=b=null):_=Oe;else if(typeof _!="object")throw Error(c+"Argument not an object: "+_);if(k=this.toFixed(v,b),this.c){var M,$=k.split("."),P=+_.groupSize,H=+_.secondaryGroupSize,W=_.groupSeparator||"",L=$[0],V=$[1],te=this.s<0,he=te?L.slice(1):L,ye=he.length;if(H&&(M=P,P=H,ye-=H=M),0<P&&0<ye){for(M=ye%P||P,L=he.substr(0,M);M<ye;M+=P)L+=W+he.substr(M,P);0<H&&(L+=W+he.slice(M)),te&&(L="-"+L)}k=V?L+(_.decimalSeparator||"")+((H=+_.fractionGroupSize)?V.replace(new RegExp("\\d{"+H+"}\\B","g"),"$&"+(_.fractionGroupSeparator||"")):V):L}return(_.prefix||"")+k+(_.suffix||"")},w.toFraction=function(v){var b,_,k,M,$,P,H,W,L,V,te,he,ye=this,Ae=ye.c;if(v!=null&&(!(H=new Y(v)).isInteger()&&(H.c||H.s!==1)||H.lt(A)))throw Error(c+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+be(H));if(!Ae)return new Y(ye);for(b=new Y(A),L=_=new Y(A),k=W=new Y(A),he=T(Ae),$=b.e=he.length-ye.e-1,b.c[0]=C[(P=$%g)<0?g+P:P],v=!v||0<H.comparedTo(b)?0<$?b:L:H,P=Z,Z=1/0,H=new Y(he),W.c[0]=0;V=re(H,b,0,1),(M=_.plus(V.times(k))).comparedTo(v)!=1;)_=k,k=M,L=W.plus(V.times(M=L)),W=M,b=H.minus(V.times(M=b)),H=M;return M=re(v.minus(_),k,0,1),W=W.plus(M.times(L)),_=_.plus(M.times(k)),W.s=L.s=ye.s,te=re(L,k,$*=2,D).minus(ye).abs().comparedTo(re(W,_,$,D).minus(ye).abs())<1?[L,k]:[W,_],Z=P,te},w.toNumber=function(){return+be(this)},w.toPrecision=function(v,b){return v!=null&&I(v,1,y),lt(this,v,b,2)},w.toString=function(v){var b,_=this,k=_.s,M=_.e;return M===null?k?(b="Infinity",k<0&&(b="-"+b)):b="NaN":(b=v==null?M<=z||G<=M?B(T(_.c),M):ee(T(_.c),M,"0"):v===10?ee(T((_=De(new Y(_),O+M+1,D)).c),_.e,"0"):(I(v,2,He.length,"Base"),ie(ee(T(_.c),M,"0"),10,v,k,!0)),k<0&&_.c[0]&&(b="-"+b)),b},w.valueOf=w.toJSON=function(){return be(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),j!=null&&Y.set(j),Y}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(R,T){return function(N){if(Array.isArray(N))return N}(R)||function(N,I){var F=[],B=!0,ee=!1,U=void 0;try{for(var j,re=N[Symbol.iterator]();!(B=(j=re.next()).done)&&(F.push(j.value),!I||F.length!==I);B=!0);}catch(ie){ee=!0,U=ie}finally{try{B||re.return==null||re.return()}finally{if(ee)throw U}}return F}(R,T)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(R){var T=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},N=2<arguments.length?arguments[2]:void 0;if(typeof T=="string"&&(T=l.parseFormat(T)),!a.validateFormat(T))return"ERROR: invalid format";var I=T.prefix||"",F=T.postfix||"",B=function(ee,U,j){switch(U.output){case"currency":return U=y(U,s.currentCurrencyDefaultFormat()),function(He,Y,lt){var Ue=lt.currentCurrency(),xe=Object.assign({},h,Y),De=void 0,be="",v=!!xe.totalLength||!!xe.forceAverage||xe.average,b=Y.currencyPosition||Ue.position,_=Y.currencySymbol||Ue.symbol;xe.spaceSeparated&&(be=" "),b==="infix"&&(De=be+_+be);var k=S({instance:He,providedFormat:Y,state:lt,decimalSeparator:De});return b==="prefix"&&(k=He._value<0&&xe.negative==="sign"?"-".concat(be).concat(_).concat(k.slice(1)):_+be+k),b&&b!=="postfix"||(k=k+(be=v?"":be)+_),k}(ee,U,s);case"percent":return U=y(U,s.currentPercentageDefaultFormat()),function(He,Y,lt,Ue){var xe=Y.prefixSymbol,De=S({instance:Ue(100*He._value),providedFormat:Y,state:lt}),be=Object.assign({},h,Y);return xe?"%".concat(be.spaceSeparated?" ":"").concat(De):"".concat(De).concat(be.spaceSeparated?" ":"","%")}(ee,U,s,j);case"byte":return U=y(U,s.currentByteDefaultFormat()),A=ee,D=s,z=j,G=(O=U).base||"binary",ne=c[G],Z=g(A._value,ne.suffixes,ne.scale),K=Z.value,Se=Z.suffix,Pe=S({instance:z(K),providedFormat:O,state:D,defaults:D.currentByteDefaultFormat()}),Oe=D.currentAbbreviations(),"".concat(Pe).concat(Oe.spaced?" ":"").concat(Se);case"time":return U=y(U,s.currentTimeDefaultFormat()),pe=ee,f=Math.floor(pe._value/60/60),m=Math.floor((pe._value-60*f*60)/60),w=Math.round(pe._value-60*f*60-60*m),"".concat(f,":").concat(m<10?"0":"").concat(m,":").concat(w<10?"0":"").concat(w);case"ordinal":return U=y(U,s.currentOrdinalDefaultFormat()),re=ee,ie=U,Ce=(oe=s).currentOrdinal(),Me=Object.assign({},h,ie),rt=S({instance:re,providedFormat:ie,state:oe}),We=Ce(re._value),"".concat(rt).concat(Me.spaceSeparated?" ":"").concat(We);case"number":default:return S({instance:ee,providedFormat:U,numbro:j})}var re,ie,oe,Ce,Me,rt,We,pe,f,m,w,A,O,D,z,G,ne,Z,K,Se,Pe,Oe}(R,T,N);return B=(B=I+B)+F}function g(R,T,N){var I=T[0],F=Math.abs(R);if(N<=F){for(var B=1;B<T.length;++B){var ee=Math.pow(N,B),U=Math.pow(N,B+1);if(ee<=F&&F<U){I=T[B],R/=ee;break}}I===T[0]&&(R/=Math.pow(N,T.length-1),I=T[T.length-1])}return{value:R,suffix:I}}function p(R){for(var T="",N=0;N<R;N++)T+="0";return T}function C(R,T){return R.toString().indexOf("e")!==-1?function(N,I){var F=N.toString(),B=o(F.split("e"),2),ee=B[0],U=B[1],j=o(ee.split("."),2),re=j[0],ie=j[1],oe=ie===void 0?"":ie;if(0<+U)F=re+oe+p(U-oe.length);else{var Ce=".";Ce=+re<0?"-0".concat(Ce):"0".concat(Ce);var Me=(p(-U-1)+Math.abs(re)+oe).substr(0,I);Me.length<I&&(Me+=p(I-Me.length)),F=Ce+Me}return 0<+U&&0<I&&(F+=".".concat(p(I))),F}(R,T):(Math.round(+"".concat(R,"e+").concat(T))/Math.pow(10,T)).toFixed(T)}function S(R){var T=R.instance,N=R.providedFormat,I=R.state,F=I===void 0?s:I,B=R.decimalSeparator,ee=R.defaults,U=ee===void 0?F.currentDefaults():ee,j=T._value;if(j===0&&F.hasZeroFormat())return F.getZeroFormat();if(!isFinite(j))return j.toString();var re,ie,oe,Ce,Me,rt,We,pe,f=Object.assign({},h,U,N),m=f.totalLength,w=m?0:f.characteristic,A=f.optionalCharacteristic,O=f.forceAverage,D=!!m||!!O||f.average,z=m?-1:D&&N.mantissa===void 0?0:f.mantissa,G=!m&&(N.optionalMantissa===void 0?z===-1:f.optionalMantissa),ne=f.trimMantissa,Z=f.thousandSeparated,K=f.spaceSeparated,Se=f.negative,Pe=f.forceSign,Oe=f.exponential,He="";if(D){var Y=function(v){var b=v.value,_=v.forceAverage,k=v.abbreviations,M=v.spaceSeparated,$=M!==void 0&&M,P=v.totalLength,H=P===void 0?0:P,W="",L=Math.abs(b),V=-1;if(L>=Math.pow(10,12)&&!_||_==="trillion"?(W=k.trillion,b/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!_||_==="billion"?(W=k.billion,b/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!_||_==="million"?(W=k.million,b/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!_||_==="thousand")&&(W=k.thousand,b/=Math.pow(10,3)),W&&(W=($?" ":"")+W),H){var te=b.toString().split(".")[0];V=Math.max(H-te.length,0)}return{value:b,abbreviation:W,mantissaPrecision:V}}({value:j,forceAverage:O,abbreviations:F.currentAbbreviations(),spaceSeparated:K,totalLength:m});j=Y.value,He+=Y.abbreviation,m&&(z=Y.mantissaPrecision)}if(Oe){var lt=(ie=(re={value:j,characteristicPrecision:w}).value,oe=re.characteristicPrecision,Ce=oe===void 0?0:oe,Me=o(ie.toExponential().split("e"),2),rt=Me[0],We=Me[1],pe=+rt,Ce&&1<Ce&&(pe*=Math.pow(10,Ce-1),We=0<=(We=+We-(Ce-1))?"+".concat(We):We),{value:pe,abbreviation:"e".concat(We)});j=lt.value,He=lt.abbreviation+He}var Ue,xe,De,be=function(v,b,_,k,M){if(k===-1)return v;var $=C(b,k),P=o($.toString().split("."),2),H=P[0],W=P[1],L=W===void 0?"":W;if(L.match(/^0+$/)&&(_||M))return H;var V=L.match(/0+$/);return M&&V?"".concat(H,".").concat(L.toString().slice(0,V.index)):$.toString()}(j.toString(),j,G,z,ne);return be=function(v,b,_,k,M){var $=k.currentDelimiters(),P=$.thousands;M=M||$.decimal;var H=$.thousandsSize||3,W=v.toString(),L=W.split(".")[0],V=W.split(".")[1];return _&&(b<0&&(L=L.slice(1)),function(te,he){for(var ye=[],Ae=0,Ve=te;0<Ve;Ve--)Ae===he&&(ye.unshift(Ve),Ae=0),Ae++;return ye}(L.length,H).forEach(function(te,he){L=L.slice(0,te+he)+P+L.slice(te+he)}),b<0&&(L="-".concat(L))),W=V?L+M+V:L}(be=function(v,b,_,k){var M=v,$=o(M.toString().split("."),2),P=$[0],H=$[1];if(P.match(/^-?0$/)&&_)return H?"".concat(P.replace("0",""),".").concat(H):P.replace("0","");if(P.length<k)for(var W=k-P.length,L=0;L<W;L++)M="0".concat(M);return M.toString()}(be,0,A,w),j,Z,F,B),(D||Oe)&&(be=be+He),(Pe||j<0)&&(Ue=be,De=Se,be=(xe=j)===0?Ue:+Ue==0?Ue.replace("-",""):0<xe?"+".concat(Ue):De==="sign"?Ue:"(".concat(Ue.replace("-",""),")")),be}function y(R,T){if(!R)return T;var N=Object.keys(R);return N.length===1&&N[0]==="output"?T:R}r.exports=function(R){return{format:function(){for(var T=arguments.length,N=new Array(T),I=0;I<T;I++)N[I]=arguments[I];return d.apply(void 0,N.concat([R]))},getByteUnit:function(){for(var T=arguments.length,N=new Array(T),I=0;I<T;I++)N[I]=arguments[I];return(function(F){var B=c.general;return g(F._value,B.suffixes,B.scale).suffix}).apply(void 0,N.concat([R]))},getBinaryByteUnit:function(){for(var T=arguments.length,N=new Array(T),I=0;I<T;I++)N[I]=arguments[I];return(function(F){var B=c.binary;return g(F._value,B.suffixes,B.scale).suffix}).apply(void 0,N.concat([R]))},getDecimalByteUnit:function(){for(var T=arguments.length,N=new Array(T),I=0;I<T;I++)N[I]=arguments[I];return(function(F){var B=c.decimal;return g(F._value,B.suffixes,B.scale).suffix}).apply(void 0,N.concat([R]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,d={};function g(C){u=C}function p(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return p().currency},l.currentAbbreviations=function(){return p().abbreviations},l.currentDelimiters=function(){return p().delimiters},l.currentOrdinal=function(){return p().ordinal},l.currentDefaults=function(){return Object.assign({},p().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().timeFormat)},l.setDefaults=function(C){C=a.parseFormat(C),s.validateFormat(C)&&(d=C)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(C){return h=typeof C=="string"?C:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(C){if(C){if(c[C])return c[C];throw new Error('Unknown tag "'.concat(C,'"'))}return p()},l.registerLanguage=function(C){var S=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(C))throw new Error("Invalid language data");c[C.languageTag]=C,S&&g(C.languageTag)},l.setLanguage=function(C){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[C]){var y=C.split("-")[0],R=Object.keys(c).find(function(T){return T.split("-")[0]===y});return c[R]?void g(R):void g(S)}g(C)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,d=a,g=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.plus(p).toNumber(),c;var c,h,d,g,p},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,d=a,g=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.times(p).toNumber(),c;var c,h,d,g,p},divide:function(l,u){return h=u,d=a,g=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=g.dividedBy(p).toNumber(),c;var c,h,d,g,p},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,s(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(S,y){for(var R=0;R<y.length;R++){var T=y[R];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(S,T.key,T)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(C),u=n("./unformatting"),c=n("./formatting")(C),h=n("./manipulating")(C),d=n("./parsing"),g=function(){function S(T){(function(N,I){if(!(N instanceof I))throw new TypeError("Cannot call a class as a function")})(this,S),this._value=T}var y,R;return y=S,(R=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var T=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,T)}},{key:"formatCurrency",value:function(T){return typeof T=="string"&&(T=d.parseFormat(T)),(T=c.formatOrDefault(T,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,T)}},{key:"formatTime",value:function(){var T=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return T.output="time",c.format(this,T)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(T){return h.difference(this,T)}},{key:"add",value:function(T){return h.add(this,T)}},{key:"subtract",value:function(T){return h.subtract(this,T)}},{key:"multiply",value:function(T){return h.multiply(this,T)}},{key:"divide",value:function(T){return h.divide(this,T)}},{key:"set",value:function(T){return h.set(this,p(T))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(y.prototype,R),S}();function p(S){var y=S;return C.isNumbro(S)?y=S._value:typeof S=="string"?y=C.unformat(S):isNaN(S)&&(y=NaN),y}function C(S){return new g(p(S))}C.version="2.1.2",C.isNumbro=function(S){return S instanceof g},C.language=s.currentLanguage,C.registerLanguage=s.registerLanguage,C.setLanguage=s.setLanguage,C.languages=s.languages,C.languageData=s.languageData,C.zeroFormat=s.setZeroFormat,C.defaultFormat=s.currentDefaults,C.setDefaults=s.setDefaults,C.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,C.validate=a.validate,C.loadLanguagesInNode=l.loadLanguagesInNode,C.unformat=u.unformat,r.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,d,g,p,C,S,y,R,T,N,I,F,B,ee,U,j=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=j,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=j,function(re,ie){if(re.indexOf("$")===-1){if(re.indexOf("%")===-1)return re.indexOf("bd")!==-1?(ie.output="byte",ie.base="general"):re.indexOf("b")!==-1?(ie.output="byte",ie.base="binary"):re.indexOf("d")!==-1?(ie.output="byte",ie.base="decimal"):re.indexOf(":")===-1?re.indexOf("o")!==-1&&(ie.output="ordinal"):ie.output="time";ie.output="percent"}else ie.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,j),d=j,(g=o.match(/[1-9]+[0-9]*/))&&(d.totalLength=+g[0]),p=j,(C=o.split(".")[0].match(/0+/))&&(p.characteristic=C[0].length),function(re,ie){if(re.indexOf(".")!==-1){var oe=re.split(".")[0];ie.optionalCharacteristic=oe.indexOf("0")===-1}}(o,j),S=j,o.indexOf("a")!==-1&&(S.average=!0),R=j,(y=o).indexOf("K")!==-1?R.forceAverage="thousand":y.indexOf("M")!==-1?R.forceAverage="million":y.indexOf("B")!==-1?R.forceAverage="billion":y.indexOf("T")!==-1&&(R.forceAverage="trillion"),function(re,ie){var oe=re.split(".")[1];if(oe){var Ce=oe.match(/0+/);Ce&&(ie.mantissa=Ce[0].length)}}(o,j),N=j,(T=o).match(/\[\.]/)?N.optionalMantissa=!0:T.match(/\./)&&(N.optionalMantissa=!1),I=j,o.indexOf(",")!==-1&&(I.thousandSeparated=!0),F=j,o.indexOf(" ")!==-1&&(F.spaceSeparated=!0),ee=j,(B=o).match(/^\+?\([^)]*\)$/)&&(ee.negative="parenthesis"),B.match(/^\+?-/)&&(ee.negative="sign"),U=j,o.match(/^\+/)&&(U.forceSign=!0),j)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function C(S,y){var R=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",T=3<arguments.length?arguments[3]:void 0,N=4<arguments.length?arguments[4]:void 0,I=5<arguments.length?arguments[5]:void 0,F=6<arguments.length?arguments[6]:void 0;if(!isNaN(+S))return+S;var B="",ee=S.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ee!==S)return-1*C(ee,y,R,T,N,I,F);for(var U=0;U<o.length;U++){var j=o[U];if((B=S.replace(j.key,""))!==S)return C(B,y,R,T,N,I,F)*j.factor}if((B=S.replace("%",""))!==S)return C(B,y,R,T,N,I,F)/100;var re=parseFloat(S);if(!isNaN(re)){var ie=T(re);if(ie&&ie!=="."&&(B=S.replace(new RegExp("".concat(s(ie),"$")),""))!==S)return C(B,y,R,T,N,I,F);var oe={};Object.keys(I).forEach(function(m){oe[I[m]]=m});for(var Ce=Object.keys(oe).sort().reverse(),Me=Ce.length,rt=0;rt<Me;rt++){var We=Ce[rt],pe=oe[We];if((B=S.replace(We,""))!==S){var f=void 0;switch(pe){case"thousand":f=Math.pow(10,3);break;case"million":f=Math.pow(10,6);break;case"billion":f=Math.pow(10,9);break;case"trillion":f=Math.pow(10,12)}return C(B,y,R,T,N,I,F)*f}}}}(function(C,S){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=C.replace(y,"");return R=(R=R.replace(new RegExp("([0-9])".concat(s(S.thousands),"([0-9])"),"g"),"$1$2")).replace(S.decimal,".")}(l,u,c),u,c,h,d,g,p)}r.exports={unformat:function(l,u){var c,h,d,g=n("./globalState"),p=g.currentDelimiters(),C=g.currentCurrency().symbol,S=g.currentOrdinal(),y=g.getZeroFormat(),R=g.currentAbbreviations(),T=void 0;if(typeof l=="string")T=function(N,I){if(!N.indexOf(":")||I.thousands===":")return!1;var F=N.split(":");if(F.length!==3)return!1;var B=+F[0],ee=+F[1],U=+F[2];return!isNaN(B)&&!isNaN(ee)&&!isNaN(U)}(l,p)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,p,C,S,y,R,u);else{if(typeof l!="number")return;T=l}if(T!==void 0)return T}}},{"./globalState":4}],10:[function(n,r,i){function o(p){return function(C){if(Array.isArray(C)){for(var S=0,y=new Array(C.length);S<C.length;S++)y[S]=C[S];return y}}(p)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(p)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p){return!!a.unformat(p)}function d(p,C,S){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],R=Object.keys(p).map(function(T){if(!C[T])return console.error("".concat(S," Invalid key: ").concat(T)),!1;var N=p[T],I=C[T];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!d(N,u,"[Validate ".concat(T,"]"),!0))return!1}else if(s(N)!==I.type)return console.error("".concat(S," ").concat(T,' type mismatched: "').concat(I.type,'" expected, "').concat(s(N),'" provided')),!1;if(I.restrictions&&I.restrictions.length)for(var F=I.restrictions.length,B=0;B<F;B++){var ee=I.restrictions[B],U=ee.restriction,j=ee.message;if(!U(N,p))return console.error("".concat(S," ").concat(T," invalid value: ").concat(j)),!1}return I.restriction&&!I.restriction(N,p)?(console.error("".concat(S," ").concat(T," invalid value: ").concat(I.message)),!1):I.validValues&&I.validValues.indexOf(N)===-1?(console.error("".concat(S," ").concat(T," invalid value: must be among ").concat(JSON.stringify(I.validValues),', "').concat(N,'" provided')),!1):!(I.children&&!d(N,I.children,"[Validate ".concat(T,"]")))});return y||R.push.apply(R,o(Object.keys(C).map(function(T){var N=C[T];if(typeof N=="string"&&(N={type:N}),N.mandatory){var I=N.mandatory;if(typeof I=="function"&&(I=I(p)),I&&p[T]===void 0)return console.error("".concat(S,' Missing mandatory key "').concat(T,'"')),!1}return!0}))),R.reduce(function(T,N){return T&&N},!0)}function g(p){return d(p,u,"[Validate format]")}r.exports={validate:function(p,C){var S=h(p),y=g(C);return S&&y},validateFormat:g,validateInput:h,validateLanguage:function(p){return d(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(yH);var i7=yH.exports;const Hs=zN(i7),o7="numeric";function Wb(t,e,n,r,i,o,s){let a=o;if(Vn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",d=h.length?h.split(" "):[];if(typeof u<"u"&&!Hs.languages()[u]){const g=u.replace("-",""),p=Hs.allLanguages?Hs.allLanguages[u]:Hs[g];p&&Hs.registerLanguage(p)}Hs.setLanguage(u),a=Hs(a).format(c||"0"),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),s.className=d.join(" "),e.dir="ltr"}Ao(t,e,n,r,i,a,s)}Wb.RENDERER_TYPE=o7;const s7="numeric";function Vb(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Vn(t))}Vb.VALIDATOR_TYPE=s7;const a7="numeric",bH={CELL_TYPE:a7,editor:SH,renderer:Wb,validator:Vb,dataType:"number"},l7="password";class RH extends ba{static get EDITOR_TYPE(){return l7}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Ee(this.TEXTAREA,[Eo()]),oi(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const u7="password";function Bb(t,e,n,r,i,o,s){Ao.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";me(a-1,()=>{u+=l}),Sa(e,u)}Bb.RENDERER_TYPE=u7;const c7="password",h7={CELL_TYPE:c7,editor:RH,renderer:Bb,copyable:!1},Ww="ht_editor_visible",QE="selectEditor",d7="select";class EH extends Yl{static get EDITOR_TYPE(){return d7}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",q(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Ie(this.select,Ww)&&Le(this.select,Ww),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),oi(this.select),Ge(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Sa(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",q(this.select,Ww)}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={group:QE};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r,callback:()=>{}},{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(QE)}}const f7="select";function Ub(t,e,n,r,i,o,s){Ao.apply(this,[t,e,n,r,i,o,s])}Ub.RENDERER_TYPE=f7;const g7="select",m7={CELL_TYPE:g7,editor:EH,renderer:Ub},p7="time";class TH extends ba{static get EDITOR_TYPE(){return p7}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}const w7="time";function Yb(t,e,n,r,i,o,s){Ao.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}Yb.RENDERER_TYPE=w7;const C7=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],v7="time";function Gb(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=X(i,C7,!0).isValid()?X(i):X(i,n);let a=s.isValid(),l=X(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}Gb.VALIDATOR_TYPE=v7;const S7="time",y7={CELL_TYPE:S7,editor:TH,renderer:Yb,validator:Gb};function b7(){yn(y8),yn(fH),yn(CH),yn(vH),yn(n7),yn(bH),yn(h7),yn(m7),yn(aH),yn(y7)}function R7(t,e){_H(t,e),e.add(t)}function E7(t,e,n){_H(t,e),e.set(t,n)}function _H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Na(t,e,n){return e=T7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T7(t){var e=_7(t,"string");return typeof e=="symbol"?e:String(e)}function _7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function M7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function La(t,e){var n=A7(t,e,"get");return O7(t,n)}function A7(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function O7(t,e){return e.get?e.get.call(t):e.value}const eT=new Map([["plugin",jz],["cell-type",Zx],["editor",kP],["renderer",jP],["validator",KP]]),I7="base",Vw=[];let gi=null;var Ds=new WeakMap,tT=new WeakSet;class it{static get PLUGIN_KEY(){return I7}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){R7(this,tT),Na(this,"eventManager",new xr(this)),Na(this,"pluginName",null),Na(this,"pluginsInitializedCallbacks",[]),Na(this,"isPluginsReady",!1),Na(this,"enabled",!1),Na(this,"initialized",!1),E7(this,Ds,{writable:!0,value:{}}),Fi(this,"hot",e,{writable:!1}),gi=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!eT.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);eT.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Vw.push(o)}}if(gi||(gi=Yy()),gi.indexOf("UndoRedo")>=0&&gi.splice(gi.indexOf("UndoRedo"),1),gi.indexOf(this.pluginName)>=0&&gi.splice(gi.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),gi.length===0){if(Vw.length>0){const i=[`${Vw.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){La(this,Ds)[e]=La(this,Ds)[e]||[];const r=La(this,Ds)[e];this.hot.addHook(e,n),r.push(n),La(this,Ds)[e]=r}removeHooks(e){E(La(this,Ds)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=La(this,Ds);Ge(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){E(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=M7(this,tT,P7).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ge(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function P7(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Ns(t,e,n){return e=x7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x7(t){var e=H7(t,"string");return typeof e=="symbol"?e:String(e)}function H7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let D7=class{constructor(e){Ns(this,"hot",null),Ns(this,"container",null),Ns(this,"injected",!1),Ns(this,"rows",[]),Ns(this,"columns",[]),Ns(this,"samples",null),Ns(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),E(this.rows,n=>{e(n.row,xt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),E(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{E(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{E(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{E(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),E(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{E(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),q(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return q(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const zb=D7;function Qh(t,e,n){return e=N7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N7(t){var e=L7(t,"string");return typeof e=="symbol"?e:String(e)}function L7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jb{static get SAMPLE_COUNT(){return 3}constructor(e){Qh(this,"samples",null),Qh(this,"dataFactory",null),Qh(this,"customSampleCount",null),Qh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:jb.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return me(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return me(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Be(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Wt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const g=i.get(d);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}const MH=jb;function $a(t,e){AH(t,e),e.add(t)}function $7(t,e,n){AH(t,e),e.set(t,n)}function AH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ka(t,e,n){return e=k7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k7(t){var e=F7(t,"string");return typeof e=="symbol"?e:String(e)}function F7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function W7(t,e,n){var r=OH(t,e,"set");return V7(t,r,n),n}function V7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ed(t,e){var n=OH(t,e,"get");return B7(t,n)}function OH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function B7(t,e){return e.get?e.get.call(t):e.value}function Ls(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("modifyAutoColumnSizeSeed");const pu="autoColumnSize",U7=10,Y7="autoColumnSize";var ml=new WeakMap,nT=new WeakSet,rT=new WeakSet,iT=new WeakSet,Bw=new WeakSet,oT=new WeakSet,sT=new WeakSet;class _l extends it{static get PLUGIN_KEY(){return pu}static get PLUGIN_PRIORITY(){return U7}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),$a(this,sT),$a(this,oT),$a(this,Bw),$a(this,iT),$a(this,rT),$a(this,nT),ka(this,"ghostTable",new zb(this.hot)),ka(this,"samplesGenerator",new MH((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),ka(this,"firstCalculation",!0),ka(this,"inProgress",!1),ka(this,"measuredColumns",0),ka(this,"columnWidthsMap",new ys),$7(this,ml,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(Y7,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Ls(this,Bw,aT).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[pu]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[pu];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ls(e,rT,z7).call(e,...i)}),this.addHook("beforeChangeRender",r=>Ls(this,iT,j7).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>Ls(this,sT,X7).call(this,r)),this.addHook("beforeViewRender",r=>Ls(this,nT,G7).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>Ls(this,oT,K7).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Ls(this,Bw,aT).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;me(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);E(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Rc(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+_l.CALCULATION_STEP,r)},e),n=n+_l.CALCULATION_STEP+1,n<r?i=$g(o):(Rc(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[pu],n=e&&Pt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[pu];let n=_l.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Be(e)&&(n=e.syncLimit,Sy(n)?n=By(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Kc.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Yt(e,(r,i,o)=>{const s=ed(this,ml).length;return(s-1<o||ed(this,ml)[o]!==i)&&r.push(o),s-1<o?ed(this,ml).push(i):ed(this,ml)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{E(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!wr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function G7(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function z7(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function j7(t){const e=Ye(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function aT(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function K7(){W7(this,ml,this.hot.getColHeader())}function X7(t){const e=wr(t,r=>{var i;return ue((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ye(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const ia={horizontal:"horizontal",vertical:"vertical"};function q7(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function Z7(t){const e={};return t===!0?(e.directions=Object.keys(ia),e.autoInsertRow=!0):Be(t)?(ue(t.autoInsertRow)?t.direction===ia.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(ia)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function wu(t,e){J7(t,e),e.add(t)}function J7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fa(t,e,n){return e=Q7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q7(t){var e=eX(t,"string");return typeof e=="symbol"?e:String(e)}function eX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("modifyAutofillRange");de.getSingleton().register("beforeAutofill");de.getSingleton().register("afterAutofill");const lT="autofill",tX=20,nX=["fillHandle"],rX="insert_row_below",iX=200;var uT=new WeakSet,cT=new WeakSet,hT=new WeakSet,dT=new WeakSet,fT=new WeakSet;class oX extends it{constructor(){super(...arguments),wu(this,fT),wu(this,dT),wu(this,hT),wu(this,cT),wu(this,uT),Fa(this,"addingStarted",!1),Fa(this,"mouseDownOnCellCorner",!1),Fa(this,"mouseDragOutside",!1),Fa(this,"handleDraggedCells",0),Fa(this,"directions",[]),Fa(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return lT}static get PLUGIN_PRIORITY(){return tX}static get SETTING_KEYS(){return[lT,...nX]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Cu(this,cT,aX).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Cu(this,uT,sX).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Cu(this,hT,lX).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return E(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),E(a,c=>{const h=[];E(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=q7(l,u,(g,p)=>this.hot._createCellCoords(g,p));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),p=o.clone(),C=this.hot._createCellRange(h,h,d),S=this.hot.runHooks("beforeAutofill",g,p,C,c);if(S===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=S;const R=S;if(["up","left"].indexOf(c)>-1&&!(R.length===1&&R[0].length===0))if(y=[],c==="up"){const T=d.row-h.row+1,N=T%R.length;for(let I=0;I<T;I++)y.push(R[(I+(R.length-N))%R.length])}else{const T=d.col-h.col+1,N=T%R[0].length;for(let I=0;I<R.length;I++){y.push([]);for(let F=0;F<T;F++)y[I].push(R[I][(F+(R[I].length-N))%R[I].length])}}this.hot.populateFromArray(h.row,h.col,y,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,p,C,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(ia.vertical)&&this.directions.includes(ia.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(ia.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(ia.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(rX,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},iX)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ye(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=en(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+xt(this.hot.table),i=en(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ft(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Cu(this,dT,uX).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Cu(this,fT,cX).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=Z7(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function sX(){this.selectAdjacent()&&this.fillIn()}function aX(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function lX(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function uX(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function cX(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function td(t,e){hX(t,e),e.add(t)}function hX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $s(t,e,n){return e=dX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dX(t){var e=fX(t,"string");return typeof e=="symbol"?e:String(e)}function fX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const nd="autoRowSize",gX=40,mX="autoRowSize";var gT=new WeakSet,Uw=new WeakSet,mT=new WeakSet,pT=new WeakSet;class rc extends it{static get PLUGIN_KEY(){return nd}static get PLUGIN_PRIORITY(){return gX}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),td(this,pT),td(this,mT),td(this,Uw),td(this,gT),$s(this,"headerHeight",null),$s(this,"ghostTable",new zb(this.hot)),$s(this,"samplesGenerator",new MH((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),$s(this,"firstCalculation",!0),$s(this,"inProgress",!1),$s(this,"measuredRows",0),$s(this,"rowHeightsMap",new ys),this.hot.rowIndexMapper.registerMap(mX,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>vu(this,Uw,wT).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[nd];return e===!0||Be(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return vu(e,mT,wX).call(e,...r)}),this.addHook("beforeChangeRender",n=>vu(this,pT,CX).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>vu(this,gT,pX).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>vu(this,Uw,wT).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}me(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);E(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Rc(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+rc.CALCULATION_STEP,r)},e),n=n+rc.CALCULATION_STEP+1,n<r?i=$g(o):(Rc(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[nd],n=e&&Pt(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Pt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){ds(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[nd];let n=rc.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Be(e)&&(n=e.syncLimit,Sy(n)?n=By(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!wr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function pX(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function wT(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function wX(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function CX(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:vX,getListWithRemovedItems:SX}=Ix("physicallyIndexed");class yX extends ya{constructor(){super(e=>e)}insert(e,n){const r=pb(this.indexedValues,n);this.indexedValues=vX(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=SX(this.indexedValues,e);this.indexedValues=mb(n,e),super.remove(e)}}const bX=yX,{getListWithInsertedItems:RX,getListWithRemovedItems:EX}=Ix("physicallyIndexed");class TX extends ya{constructor(){super(e=>e)}insert(e,n){this.indexedValues=RX(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=EX(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const _X=TX;function MX(t,e){AX(t,e),e.add(t)}function AX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OX(t,e,n){return e=IX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IX(t){var e=PX(t,"string");return typeof e=="symbol"?e:String(e)}function PX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xX(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Yw="bindRowsWithHeaders",HX=210,DX="loose",NX=new Map([["loose",bX],["strict",_X]]);var CT=new WeakSet;class LX extends it{constructor(){super(...arguments),MX(this,CT),OX(this,"headerIndexes",null)}static get PLUGIN_KEY(){return Yw}static get PLUGIN_PRIORITY(){return HX}isEnabled(){return!!this.hot.getSettings()[Yw]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Yw];typeof e!="string"&&(e=DX);const n=NX.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>xX(this,CT,$X).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function $X(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function rd(t,e){IH(t,e),e.add(t)}function kX(t,e,n){IH(t,e),e.set(t,n)}function IH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vT(t,e,n){return e=FX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FX(t){var e=WX(t,"string");return typeof e=="symbol"?e:String(e)}function WX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ST(t,e){var n=PH(t,e,"get");return VX(t,n)}function VX(t,e){return e.get?e.get.call(t):e.value}function id(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Gw(t,e,n){var r=PH(t,e,"set");return BX(t,r,n),n}function PH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function BX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const ef="collapsibleColumns",UX=290,YX=["nestedHeaders"],Ml="collapsibleIndicator",yT=ef,bT=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Wa=new WeakMap,RT=new WeakSet,ET=new WeakSet,TT=new WeakSet,_T=new WeakSet;class GX extends it{constructor(){super(...arguments),rd(this,_T),rd(this,TT),rd(this,ET),rd(this,RT),vT(this,"nestedHeadersPlugin",null),vT(this,"headerStateManager",null),kX(this,Wa,{writable:!0,value:null})}static get PLUGIN_KEY(){return ef}static get PLUGIN_PRIORITY(){return UX}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[ef,...YX]}isEnabled(){return!!this.hot.getSettings()[ef]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||gt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Gw(this,Wa,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>id(this,TT,KX).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return id(e,_T,XX).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return id(e,RT,zX).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>id(this,ET,jX).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Gw(this,Wa,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:yT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yT)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};me(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;me(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Ml}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Ml}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Ml}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!bT.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=wr(e,d=>{let{row:g}=d;return g<0});let i=r.length>0;E(r,d=>{var g;let{row:p,col:C}=d;const{collapsible:S,isCollapsed:y}=(g=this.headerStateManager.getHeaderSettings(p,C))!==null&&g!==void 0?g:{};if(!S||y&&n==="collapse"||!y&&n==="expand")return i=!1,!1});const o=[],s=[];i&&E(r,d=>{let{row:g,col:p}=d;const{colspanCompensation:C,affectedColumns:S,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,g,p);C>0&&(s.push(...S),o.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=Cy([...a,...s]):n==="expand"&&(l=wr(a,d=>!s.includes(d)));const u=bT.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){E(o,d=>{d()});return}this.hot.batchExecution(()=>{E(s,d=>{ST(this,Wa).setValueAtIndex(this.hot.toPhysicalColumn(d),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return ST(this,Wa).getHiddenIndexes()}destroy(){Gw(this,Wa,null),super.destroy()}}function zX(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Ml}`);if(va(e,[Ir("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),q(u,Ml),e.querySelector("div:first-child").appendChild(u)),Le(u,["collapsed","expanded"]),s?(q(u,"collapsed"),hs(u,"+"),l&&Ee(e,...Ir(!1))):(q(u,"expanded"),hs(u,"-"),l&&Ee(e,...Ir(!0))),l&&Ee(u,...Eo());else{var c;(c=u)===null||c===void 0||c.remove()}}function jX(t,e){Ie(t.target,Ml)&&(Ie(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ie(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Lr(t))}function KX(){this.updatePlugin()}function XX(t,e){e||this.updatePlugin()}function ks(t,e,n){return e=qX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qX(t){var e=ZX(t,"string");return typeof e=="symbol"?e:String(e)}function ZX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const JX=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],QX=!1,eq=!0,tq=!0;class nq{constructor(e,n){ks(this,"hot",void 0),ks(this,"sortingStates",new Yg),ks(this,"sortEmptyCells",QX),ks(this,"indicator",eq),ks(this,"headerAction",tq),ks(this,"compareFunctionFactory",void 0),ks(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Be(e)&&Ge(e,(n,r)=>{JX.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Be(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ue(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const kf="asc",Ff="desc",xH="colHeader";function rq(t){if(Be(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[kf,Ff].includes(n)}function iq(t){if(t.some(n=>rq(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function MT(t){if(t!==Ff)return t===kf?Ff:kf}function HH(t){return t.querySelector(`.${xH}`)}function DH(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function Kb(t,e,n){return t===-1&&e>=0&&fs(n)===!1}const oq="ascending",sq="descending",NH="indicatorDisabled",LH="columnSorting",$H="sortAction",kH=new Map([[kf,oq],[Ff,sq]]);function aq(t,e,n,r){const i=[LH];if(r&&i.push($H),n===!1)return i.push(NH),i;const o=t.getSortOrderOfColumn(e);return ue(o)&&i.push(kH.get(o)),i}function lq(){return Array.from(kH.values()).concat($H,NH,LH)}function FH(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Hi:Zt(i)?Zt(o)?Hi:s&&t==="asc"?kt:Ft:Zt(o)?s&&t==="asc"?Ft:kt:isNaN(i)&&!isNaN(o)?t==="asc"?Ft:kt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?kt:Ft:i>o?t==="asc"?Ft:kt:Hi}}const WH="default";function uq(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Hi;if(a){if(Zt(r))return t==="asc"?kt:Ft;if(Zt(i))return t==="asc"?Ft:kt}return isNaN(o)?Ft:isNaN(s)?kt:o<s?t==="asc"?kt:Ft:o>s?t==="asc"?Ft:kt:Hi}}const cq="numeric";function hq(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Zt(s),u=Zt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,g=h===i||h===r;if(o===!1){if(l&&u===!1)return Ft;if(l===!1&&u)return kt}return d===!1&&g?t==="asc"?kt:Ft:d&&g===!1?t==="asc"?Ft:kt:d===!1&&g===!1?FH(t,e,n)(s,a):c===i&&h===r?t==="asc"?kt:Ft:c===r&&h===i?t==="asc"?Ft:kt:Hi}}const dq="checkbox";function fq(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Hi;if(Zt(r))return Zt(i)?Hi:o&&t==="asc"?kt:Ft;if(Zt(i))return o&&t==="asc"?Ft:kt;const s=e.dateFormat,a=X(r,s),l=X(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?kt:Ft:l.isBefore(a)?t==="asc"?Ft:kt:Hi:kt:Ft}}const gq="date",{register:hp,getItem:AT,hasItem:mq}=ai("sorting.compareFunctionFactory"),{register:VH,getItem:pq}=ai("sorting.mainSortComparator");function BH(t){return mq(t)?AT(t):AT(WH)}hp(cq,uq);hp(dq,hq);hp(gq,fq);hp(WH,FH);const Hi=0,kt=-1,Ft=1;function wq(t,e){const n=pq(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function Cq(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:BH(u.type))(l,u,d)(c,h)}(0)}}function od(t,e){vq(t,e),e.add(t)}function vq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e,n){return e=Sq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sq(t){var e=yq(t,"string");return typeof e=="symbol"?e:String(e)}function yq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Wf="columnSorting",bq=50,Vf="append",Rq="replace",OT=Wf;VH(Wf,Cq);de.getSingleton().register("beforeColumnSort");de.getSingleton().register("afterColumnSort");var tf=new WeakSet,IT=new WeakSet,PT=new WeakSet,xT=new WeakSet;class UH extends it{constructor(){super(...arguments),od(this,xT),od(this,PT),od(this,IT),od(this,tf),sd(this,"columnStatesManager",null),sd(this,"columnMetaCache",null),sd(this,"pluginKey",Wf),sd(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Wf}static get PLUGIN_PRIORITY(){return bq}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new nq(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ys(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>pl(this,IT,Eq).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pl(e,xT,_q).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>pl(this,tf,uS).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pl(e,PT,Tq).call(e,...r)}),this.hot.view&&pl(this,tf,uS).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=HH(r);DH(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:OT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(OT)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Px),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return iq(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ye(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ue(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ye(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ue(n)){const i=MT(n);return ue(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:MT()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vf;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(vt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Vf)return[...o.slice(0,r),...o.slice(r+1),s];if(n===Rq)return[...o.slice(0,r),s,...o.slice(r+1)]}return ue(s)?o.concat(s):o}getPluginColumnConfig(e){if(Be(e)){const n=e[this.pluginKey];if(Be(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):Ct(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ye(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ye(n,u=>u[0]);wq(n,this.pluginKey,Ye(e,u=>u.sortOrder),Ye(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ye(n,u=>u[0]),a=new Map(Ye(o,(u,c)=>[u,s[c]])),l=Ye(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Be(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Be(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Le(e,lq()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];q(e,aq(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ie(e.target,xH)}onAfterOnCellMouseDown(e,n){Kb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function uS(){const t=this.getAllSavedSortSettings();if(Be(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Eq(t,e){const n=HH(e);if(DH(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Ee(e,...mG(s?`${s}ending`:"none"))}}function Tq(t){t===!0&&this.hot.view&&pl(this,tf,uS).call(this)}function _q(t,e,n,r){Kb(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Fs(t,e,n){return e=Mq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mq(t){var e=Aq(t,"string");return typeof e=="symbol"?e:String(e)}function Aq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oq{constructor(e,n){Fs(this,"plugin",void 0),Fs(this,"hot",void 0),Fs(this,"endpoints",[]),Fs(this,"settings",void 0),Fs(this,"settingsType","array"),Fs(this,"currentEndpoint",null),Fs(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),E(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();E(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;E(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?E(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):E(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){E(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];E(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),E(i,o=>{let s=[];E(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,E(e.ranges,r=>{E(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],E(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],E(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],E(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&E(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),E(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){gt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const Iq=Oq;function zw(t){return t==null||isNaN(t)}function jw(t,e){Pq(t,e),e.add(t)}function Pq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xq(t,e,n){return e=Hq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hq(t){var e=Dq(t,"string");return typeof e=="symbol"?e:String(e)}function Dq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Xw="columnSummary",Nq=220;var HT=new WeakSet,DT=new WeakSet,NT=new WeakSet;class Lq extends it{constructor(){super(...arguments),jw(this,NT),jw(this,DT),jw(this,HT),xq(this,"endpoints",null)}static get PLUGIN_KEY(){return Xw}static get PLUGIN_PRIORITY(){return Nq}isEnabled(){return!!this.hot.getSettings()[Xw]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Xw],this.endpoints=new Iq(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Kw(e,HT,$q).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Kw(e,DT,kq).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Kw(e,NT,Fq).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ge(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=zw(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ge(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=zw(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=zw(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ge(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ht`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function $q(){this.endpoints.initEndpoints()}function kq(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Fq(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Va(t,e,n){return e=Wq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wq(t){var e=Vq(t,"string");return typeof e=="symbol"?e:String(e)}function Vq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bl{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Va(this,"rootDocument",void 0),Va(this,"isRtl",!1),Va(this,"container",null),Va(this,"editor",void 0),Va(this,"editorStyle",void 0),Va(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ft(this.getInputElement()),height:xt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),q(this.container,bl.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),q(e,bl.CLASS_EDITOR),q(n,bl.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${bl.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const Bq=bl;function qw(t,e,n){return e=Uq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uq(t){var e=Yq(t,"string");return typeof e=="symbol"?e:String(e)}function Yq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Gq=250,zq=250;class YH{constructor(e){qw(this,"wasLastActionShow",!0),qw(this,"showDebounced",null),qw(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},zq)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Gq;this.showDebounced=Dg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}pt(YH,sr);const jq=YH;function Kq(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function Xq(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Ws(t,e){const n={};return E(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Yo(t,e,n,r,i){E(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&qq(s,a,e,n,r,i)})})}function qq(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=Kq(s.className,r):a=Xq(s.className,r)),o(t,e,"className",a)}function ro(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Mi(t,e){let n=!1;return Array.isArray(t)&&E(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function dp(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const je="---------";function Zq(){return{name:je}}const _r="alignment";function Jq(){return{key:_r,name(){return this.getTranslatedPhrase(dm)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${_r}:left`,name(){let t=this.getTranslatedPhrase(fm);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:center`,name(){let t=this.getTranslatedPhrase(gm);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:right`,name(){let t=this.getTranslatedPhrase(mm);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:justify`,name(){let t=this.getTranslatedPhrase(pm);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:je},{key:`${_r}:top`,name(){let t=this.getTranslatedPhrase(wm);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:middle`,name(){let t=this.getTranslatedPhrase(Cm);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${_r}:bottom`,name(){let t=this.getTranslatedPhrase(vm);return Mi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Ws(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const fp="clear_column";function Qq(){return{key:fp,name(){return this.getTranslatedPhrase(tm)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const th="col_left";function eZ(){return{key:th,name(){return this.getTranslatedPhrase(Kg)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const nh="col_right";function tZ(){return{key:nh,name(){return this.getTranslatedPhrase(Xg)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const rh="make_read_only";function nZ(){return{key:rh,name(){let t=this.getTranslatedPhrase(em);return Mi(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=ro(t)),t},callback(){const t=this.getSelectedRange(),e=Mi(t,(n,r)=>this.getCellMeta(n,r).readOnly);E(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const gp="redo";function rZ(){return{key:gp,name(){return this.getTranslatedPhrase(Qg)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ih="remove_col";function iZ(){return{key:ih,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Zg,e)},callback(){this.alter("remove_col",Q6(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const mp="remove_row";function oZ(){return{key:mp,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(qg,e)},callback(){this.alter("remove_row",e9(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const pp="row_above";function sZ(){return{key:pp,name(){return this.getTranslatedPhrase(zg)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const wp="row_below";function aZ(){return{key:wp,name(){return this.getTranslatedPhrase(jg)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Ac="no_items";function lZ(){return{key:Ac,name(){return this.getTranslatedPhrase(Gg)},disabled:!0,isCommand:!1}}const Cp="undo";function uZ(){return{key:Cp,name(){return this.getTranslatedPhrase(Jg)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const cZ=[pp,wp,th,nh,fp,mp,ih,Cp,gp,rh,_r,je,Ac],hZ={[je]:Zq,[Ac]:lZ,[pp]:sZ,[wp]:aZ,[th]:eZ,[nh]:tZ,[fp]:Qq,[mp]:oZ,[ih]:iZ,[Cp]:uZ,[gp]:rZ,[rh]:nZ,[_r]:Jq};function GH(){const t={};return Ge(hZ,(e,n)=>{t[n]=e()}),t}function dZ(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(um):this.getTranslatedPhrase(lm)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function fZ(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(cm)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function gZ(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(hm);return Mi(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,nf))?ro(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,nf);t.updateCommentMeta(n,r,{[nf]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function mi(t,e){zH(t,e),e.add(t)}function Vs(t,e,n){zH(t,e),e.set(t,n)}function zH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mZ(t,e,n){return e=pZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pZ(t){var e=wZ(t,"string");return typeof e=="symbol"?e:String(e)}function wZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function co(t,e,n){var r=jH(t,e,"set");return CZ(t,r,n),n}function CZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Je(t,e){var n=jH(t,e,"get");return vZ(t,n)}function jH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vZ(t,e){return e.get?e.get.call(t):e.value}const ic="comments",SZ=60,io="comment",Gu="value",KH="style",nf="readOnly",ad=ic,cS=`plugin:${ic}`;var Rt=new WeakMap,Xr=new WeakMap,vp=new WeakMap,rf=new WeakMap,Bf=new WeakMap,hS=new WeakMap,Uf=new WeakMap,LT=new WeakSet,$T=new WeakSet,kT=new WeakSet,FT=new WeakSet,WT=new WeakSet,VT=new WeakSet,BT=new WeakSet,UT=new WeakSet,YT=new WeakSet,GT=new WeakSet;class yZ extends it{constructor(){super(...arguments),mi(this,GT),mi(this,YT),mi(this,UT),mi(this,BT),mi(this,VT),mi(this,WT),mi(this,FT),mi(this,kT),mi(this,$T),mi(this,LT),mZ(this,"range",{}),Vs(this,Rt,{writable:!0,value:null}),Vs(this,Xr,{writable:!0,value:null}),Vs(this,vp,{writable:!0,value:!1}),Vs(this,rf,{writable:!0,value:!1}),Vs(this,Bf,{writable:!0,value:{}}),Vs(this,hS,{writable:!0,value:null}),Vs(this,Uf,{writable:!0,value:""})}static get PLUGIN_KEY(){return ic}static get PLUGIN_PRIORITY(){return SZ}isEnabled(){return!!this.hot.getSettings()[ic]}enablePlugin(){this.enabled||(Je(this,Rt)||co(this,Rt,new Bq(this.hot.rootDocument,this.hot.isRtl())),Je(this,Xr)||co(this,Xr,new jq(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>pi(this,FT,TZ).call(this,e,s)),this.addHook("afterScroll",()=>pi(this,GT,PZ).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>pi(this,YT,IZ).call(this,e)),Je(this,Xr).addLocalHook("hide",()=>this.hide()),Je(this,Xr).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Je(this,Xr).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(cS);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();co(this,rf,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(cS),this.hot._registerTimeout(()=>{co(this,rf,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!Je(this,Rt).isVisible()},group:ad}),r.addShortcut({keys:[["Escape"]],callback:()=>{Je(this,Rt).setValue(Je(this,Uf)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Je(this,Rt).isVisible()},group:ad}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Je(this,Rt).isVisible()},group:ad})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ad)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>pi(this,$T,RZ).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>pi(this,LT,bZ).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>pi(this,kT,EZ).call(this)),this.eventManager.addEventListener(n,"focus",()=>pi(this,VT,MZ).call(this)),this.eventManager.addEventListener(n,"blur",()=>pi(this,WT,_Z).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>pi(this,BT,AZ).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>pi(this,UT,OZ).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=cs(e.target,"TD","TBODY");return!!(n&&Ie(n,"htCommentCell")&&cs(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Je(this,Rt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Gu]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,io),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Gu)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Gu)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Je(this,Xr).cancelHiding(),Je(this,Rt).setValue((e=i[io]?i[io][Gu]:null)!==null&&e!==void 0?e:""),Je(this,Rt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Je(this,Rt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Je(this,Rt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;Je(this,Rt).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:p}}=this.hot,{wtTable:C}=p,S=p.getCell({row:l,col:u},!0),y=this.getCommentMeta(s,a,KH);y?Je(this,Rt).setSize(y.width,y.height):Je(this,Rt).resetSize();const R=d?0:C.getStretchedColumnWidth(u),T=c&&!h?xt(S):0,{left:N,top:I,width:F,height:B}=S.getBoundingClientRect(),{width:ee,height:U}=Je(this,Rt).getSize(),{innerWidth:j,innerHeight:re}=this.hot.rootWindow,ie=this.hot.rootDocument.documentElement;let oe=N+g.scrollX+R,Ce=I+g.scrollY+T;this.hot.isRtl()&&(oe-=ee+R),this.hot.isLtr()&&N+F+ee>j?oe=N+g.scrollX-ee-1:this.hot.isRtl()&&oe<-(ie.scrollWidth-ie.clientWidth)&&(oe=N+g.scrollX+R+1),I+U>re&&(Ce-=U-B+1),Je(this,Rt).setPosition(oe,Ce),Je(this,Rt).setReadOnlyState(this.getCommentMeta(s,a,nf))}focusEditor(){Je(this,Rt).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[io];let o;i?(o=_n(i),zc(o,r)):o=r,this.hot.setCellMeta(e,n,io,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[io])return i[io][r]}addToContextMenu(e){e.items.push({name:je},dZ(this),fZ(this),gZ(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[ic];if(Be(e))return e.displayDelay}getEditorInputElement(){return Je(this,Rt).getInputElement()}destroy(){Je(this,Rt)&&Je(this,Rt).destroy(),Je(this,Xr)&&Je(this,Xr).destroy(),super.destroy()}}function bZ(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Je(this,vp)&&!this.targetIsCommentTextArea(t)){const e=cs(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function RZ(t){const{rootDocument:e}=this.hot;if(!(Je(this,vp)||Je(this,Rt).isFocused()||Ie(t.target,"wtBorder")||Je(this,hS)===t.target||!Je(this,Rt)))if(co(this,hS,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Je(this,Xr).show(n)}else os(t.target,e)&&!this.targetIsCommentTextArea(t)&&Je(this,Xr).hide()}function EZ(){co(this,vp,!1)}function TZ(t,e){e[io]&&e[io][Gu]&&q(t,e.commentedCellClassName)}function _Z(){co(this,Uf,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function MZ(){co(this,Uf,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(cS)}function AZ(t){co(this,Bf,{width:ft(t.target),height:xt(t.target)})}function OZ(t){const e=ft(t.target),n=xt(t.target);(e!==Je(this,Bf).width+1||n!==Je(this,Bf).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[KH]:{width:e,height:n}})}function IZ(t){Je(this,Rt).isVisible()&&Lr(t)}function PZ(){Je(this,rf)||this.hide()}var zT=dg,xZ=TypeError,HZ=function(t,e){if(!delete t[e])throw new xZ("Cannot delete property "+zT(e)+" of "+zT(t))},DZ=Ss,NZ=gg,LZ=$c,$Z=WO,kZ=HZ,FZ=VO,WZ=[].unshift(0)!==1,VZ=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},BZ=WZ||!VZ();DZ({target:"Array",proto:!0,arity:1,forced:BZ},{unshift:function(e){var n=NZ(this),r=LZ(n),i=arguments.length;if(i){FZ(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:kZ(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return $Z(n,r+i)}});function Zw(t,e,n){return e=UZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UZ(t){var e=YZ(t,"string");return typeof e=="symbol"?e:String(e)}function YZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XH{constructor(e){Zw(this,"hot",void 0),Zw(this,"commands",{}),Zw(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=GZ(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Pt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),E(u,c=>c.apply(this.hot,r))}}function GZ(t,e){let n;return E(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Jw(t,e,n){return e=zZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zZ(t){var e=jZ(t,"string");return typeof e=="symbol"?e:String(e)}function jZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Jw(this,"hot",void 0),Jw(this,"predefinedItems",GH()),Jw(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ge(e,(r,i)=>{let o="";r.name===je?(n[je]=r,o=je):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return KZ(e,this.defaultOrderPattern,this.predefinedItems)}}function KZ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Be(i)?Ge(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Be(o)?jt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):E(i,(o,s)=>{let a=n[o];!a&&cZ.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Be(o)&&jt(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function Do(t,e,n){return e=XZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XZ(t){var e=qZ(t,"string");return typeof e=="symbol"?e:String(e)}function qZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZZ{constructor(e,n){Do(this,"top",void 0),Do(this,"topRelative",void 0),Do(this,"left",void 0),Do(this,"leftRelative",void 0),Do(this,"scrollTop",void 0),Do(this,"scrollLeft",void 0),Do(this,"cellHeight",void 0),Do(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Su(t,e,n){JZ(t,e),e.set(t,n)}function JZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xe(t,e){var n=ZH(t,e,"get");return QZ(t,n)}function QZ(t,e){return e.get?e.get.call(t):e.value}function ld(t,e,n){var r=ZH(t,e,"set");return eJ(t,r,n),n}function ZH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function eJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Dn=new WeakMap,No=new WeakMap,dn=new WeakMap,Qw=new WeakMap,Ba=new WeakMap;class tJ{constructor(e){Su(this,Dn,{writable:!0,value:void 0}),Su(this,No,{writable:!0,value:void 0}),Su(this,dn,{writable:!0,value:void 0}),Su(this,Qw,{writable:!0,value:!1}),Su(this,Ba,{writable:!0,value:{above:0,below:0,left:0,right:0}}),ld(this,Qw,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Xe(this,Ba)[e]=n,this}setElement(e){return ld(this,Dn,e),this}setParentElement(e){return ld(this,No,e),this}updatePosition(e){ld(this,dn,new ZZ(e,Xe(this,Dn).ownerDocument.defaultView)),Xe(this,Qw)?(Xe(this,dn).fitsBelow(Xe(this,Dn))?this.setPositionBelowCursor():Xe(this,dn).fitsAbove(Xe(this,Dn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Xe(this,Dn).dir==="rtl"?Xe(this,dn).fitsOnLeft(Xe(this,Dn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Xe(this,dn).fitsOnRight(Xe(this,Dn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Xe(this,Ba).above+Xe(this,dn).top-Xe(this,Dn).offsetHeight;Xe(this,No)&&(e=Xe(this,dn).top+Xe(this,dn).cellHeight-Xe(this,Dn).offsetHeight+3),Xe(this,Dn).style.top=`${e}px`}setPositionBelowCursor(){let e=Xe(this,Ba).below+Xe(this,dn).top+1;Xe(this,No)&&(e=Xe(this,dn).top-1),Xe(this,Dn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Xe(this,dn).left;if(Xe(this,No)){const{right:n}=Xe(this,No).getBoundingClientRect();e+=Xe(this,dn).cellWidth+n-(Xe(this,dn).left+Xe(this,dn).cellWidth)}else e+=Xe(this,Ba).right;Xe(this,Dn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Xe(this,Ba).left+Xe(this,dn).left-Xe(this,Dn).offsetWidth;if(Xe(this,No)){const{left:n}=Xe(this,No).getBoundingClientRect();e-=Xe(this,dn).left-n}Xe(this,Dn).style.left=`${e}px`}}function JH(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=or(e,-1,p()-1);function a(S,y){const R=p()-1;return S<0&&(S=R),S>R&&(S=0),o.has(S)?-1:(o.add(S),r(S,!1)===!1&&(S=a(y===1?++S:--S,y)),S)}function l(S){S>-1&&S<p()&&r(S,!0)!==!1&&(s=S)}function u(){return s}function c(){p()>0&&(o.clear(),s=a(0,1))}function h(){p()>0&&(o.clear(),s=a(p()-1,-1))}function d(){p()>0&&(o.clear(),s=a(++s,1))}function g(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:g,getSize:p,clear:C}}function nJ(t){return Ye(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function dS(t){return Pt(t,"submenu")}function fS(t){return new RegExp(je,"i").test(t.name)}function of(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function jT(t){return Pt(t,"disableSelection")}function rJ(t){return Ie(t,"htSeparator")}function iJ(t){return Ie(t,"htSubmenu")}function oJ(t){return Ie(t,"htDisabled")}function sJ(t){return Ie(t,"htSelectionDisabled")}function aJ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function QH(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function lJ(t,e){let n=t.slice(0);return n.reverse(),n=QH(n,e),n.reverse(),n}function uJ(t){const e=[];return E(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function cJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,n=t.slice(0);return n=QH(n,e),n=lJ(n,e),n=uJ(n),n}function hJ(t){return JH({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||rJ(r)||oJ(r)||sJ(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function dJ(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const eD="menu",KT=eD;function fJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(dJ(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:eD})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:g}=d;g.forEach(p=>h.removeShortcutsByKeys(p))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${KT}:${u}`:KT}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function gJ(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(oi(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!of(a,t)&&!jT(a)&&!fS(a);Ee(n,[sG(),by(u),...c?[Wl(-1)]:[],...of(a,t)?[fG()]:[],...dS(a)?[Ir(!1)]:[]])}n.className="",n.appendChild(l),fS(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Sa(l,u),of(a,t)?q(n,"htDisabled"):jT(a)?q(n,"htSelectionDisabled"):dS(a)&&q(n,"htSubmenu")}}function XT(t,e,n){mJ(t,e),e.set(t,n)}function mJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wi(t,e,n){return e=pJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pJ(t){var e=wJ(t,"string");return typeof e=="symbol"?e:String(e)}function wJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qT(t,e,n){var r=tD(t,e,"set");return CJ(t,r,n),n}function CJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function yu(t,e){var n=tD(t,e,"get");return vJ(t,n)}function tD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vJ(t,e){return e.get?e.get.call(t):e.value}const ZT=215;var bu=new WeakMap,ud=new WeakMap;class zl{constructor(e,n){var r=this;wi(this,"hot",void 0),wi(this,"options",void 0),wi(this,"eventManager",new xr(this)),wi(this,"container",void 0),wi(this,"positioner",void 0),wi(this,"hotMenu",null),wi(this,"hotSubMenus",{}),wi(this,"parentMenu",void 0),wi(this,"menuItems",null),wi(this,"origOutsideClickDeselects",null),XT(this,bu,{writable:!0,value:void 0}),XT(this,ud,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:ZT,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new tJ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=yc(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return yu(this,bu)}getKeyboardShortcutsCtrl(){return yu(this,ud)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Dg(a=>this.openSubMenu(a),300),n=this.options.minWidth||ZT;let r=!1,i=wr(this.menuItems,a=>(a.key===Ac&&(r=!0),aJ(a,this.hot)));if(i.length<1&&!r)i.push(GH()[Ac]);else if(i.length===0)return;i=cJ(i,je);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:gJ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{yu(this,bu).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===je?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),Fv()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Fv()||!fs(a))&&o&&this.hasSelectedItem()&&(uo()||ky()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),qT(this,bu,hJ(this.hotMenu)),qT(this,ud,fJ(this)),yu(this,ud).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(yu(this,bu).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Ee(r,[Ir(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!iJ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new zl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Ee(n,[Ir(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Ee(i,[Ir(!1)])}}closeAllSubMenus(){E(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?nJ(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||fS(e)||of(e,this.hot)||dS(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(Ct(r)&&(r=r.call(this.hot),r===null||vt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),q(i,`htMenu ${this.options.className}`),r&&q(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Yt(n,(a,l)=>a+(l.name===je?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Ee(this.hotMenu.rootElement,[oG(),Wl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!os(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!os(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ie(e.target,"htCore")&&os(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}pt(zl,sr);function cd(t,e){SJ(t,e),e.add(t)}function SJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eC(t,e,n){return e=yJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yJ(t){var e=bJ(t,"string");return typeof e=="symbol"?e:String(e)}function bJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const zu="contextMenu",RJ=70,JT=zu;de.getSingleton().register("afterContextMenuDefaultOptions");de.getSingleton().register("beforeContextMenuShow");de.getSingleton().register("afterContextMenuShow");de.getSingleton().register("afterContextMenuHide");de.getSingleton().register("afterContextMenuExecute");var QT=new WeakSet,e_=new WeakSet,t_=new WeakSet,n_=new WeakSet;class oh extends it{constructor(){super(...arguments),cd(this,n_),cd(this,t_),cd(this,e_),cd(this,QT),eC(this,"commandExecutor",new XH(this.hot)),eC(this,"itemsFactory",null),eC(this,"menu",null)}static get PLUGIN_KEY(){return zu}static get PLUGIN_PRIORITY(){return RJ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[pp,wp,je,th,nh,je,mp,ih,je,Cp,gp,je,rh,je,_r]}isEnabled(){return!!this.hot.getSettings()[zu]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[zu];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new zl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>hd(this,e_,TJ).call(this)),this.menu.addLocalHook("afterOpen",()=>hd(this,t_,_J).call(this)),this.menu.addLocalHook("afterClose",()=>hd(this,n_,MJ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>hd(this,QT,EJ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=dp(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:JT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JT)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ge(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new qH(this.hot,oh.DEFAULT_ITEMS);const e=this.hot.getSettings()[zu],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),E(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function EJ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ie(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Ie(o,"current")&&Ie(o,"wtBorder"))))return;const s=dp(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function TJ(){this.hot.runHooks("beforeContextMenuShow",this)}function _J(){this.hot.runHooks("afterContextMenuShow",this)}function MJ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}oh.SEPARATOR={name:je};function AJ(t){return{key:"copy",name(){return this.getTranslatedPhrase(nm)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function OJ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Sb,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function IJ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(vb,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function PJ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Cb,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function xJ(t){return{key:"cut",name(){return this.getTranslatedPhrase(rm)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class HJ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class DJ{constructor(){this.clipboardData=new HJ}}function r_(t,e){nD(t,e),e.add(t)}function Ua(t,e,n){nD(t,e),e.set(t,n)}function nD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function $n(t,e){var n=rD(t,e,"get");return NJ(t,n)}function NJ(t,e){return e.get?e.get.call(t):e.value}function Ya(t,e,n){var r=rD(t,e,"set");return LJ(t,r,n),n}function rD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function LJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Lo=new WeakMap,tC=new WeakMap,Ru=new WeakMap,gS=new WeakMap,mS=new WeakMap,Eu=new WeakMap,fd=new WeakSet,i_=new WeakSet;class $J{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;r_(this,i_),r_(this,fd),Ua(this,Lo,{writable:!0,value:void 0}),Ua(this,tC,{writable:!0,value:void 0}),Ua(this,Ru,{writable:!0,value:void 0}),Ua(this,gS,{writable:!0,value:void 0}),Ua(this,mS,{writable:!0,value:void 0}),Ua(this,Eu,{writable:!0,value:void 0}),Ya(this,tC,n),Ya(this,Ru,r),Ya(this,gS,i),Ya(this,mS,o),Ya(this,Eu,s)}setSelectedRange(e){Ya(this,Lo,e)}getCellsRange(){if($n(this,tC).call(this)===0||$n(this,Ru).call(this)===0)return null;const{row:e,col:n}=$n(this,Lo).getTopStartCorner(),{row:r,col:i}=$n(this,Lo).getBottomEndCorner(),o=dd(this,i_,kJ).call(this,e,r),s=dd(this,fd,nC).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if($n(this,Ru).call(this)===0||$n(this,Eu).call(this)===0)return null;const{col:e}=$n(this,Lo).getTopStartCorner(),{col:n}=$n(this,Lo).getBottomEndCorner(),r=dd(this,fd,nC).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if($n(this,Ru).call(this)===0||$n(this,Eu).call(this)===0)return null;const{col:e}=$n(this,Lo).getTopStartCorner(),{col:n}=$n(this,Lo).getBottomEndCorner(),r=dd(this,fd,nC).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-$n(this,Eu).call(this),startCol:e,endRow:-1,endCol:r}}}function nC(t,e){return Math.min(e,Math.max(t+$n(this,mS).call(this)-1,t))}function kJ(t,e){return Math.min(e,Math.max(t+$n(this,gS).call(this)-1,t))}function iD(t){const e=[],n=[];return E(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);me(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);me(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Ci(t,e){oD(t,e),e.add(t)}function $o(t,e,n){oD(t,e),e.set(t,n)}function oD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tu(t,e,n){return e=FJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FJ(t){var e=WJ(t,"string");return typeof e=="symbol"?e:String(e)}function WJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nr(t,e){var n=sD(t,e,"get");return VJ(t,n)}function VJ(t,e){return e.get?e.get.call(t):e.value}function Rr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Kr(t,e,n){var r=sD(t,e,"set");return BJ(t,r,n),n}function sD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function BJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("afterCopyLimit");de.getSingleton().register("modifyCopyableRange");de.getSingleton().register("beforeCut");de.getSingleton().register("afterCut");de.getSingleton().register("beforePaste");de.getSingleton().register("afterPaste");de.getSingleton().register("beforeCopy");de.getSingleton().register("afterCopy");const gd="copyPaste",UJ=80,YJ=["fragmentSelection"],o_=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var pS=new WeakMap,wS=new WeakMap,CS=new WeakMap,Ga=new WeakMap,md=new WeakMap,pd=new WeakMap,za=new WeakMap,Yf=new WeakMap,rC=new WeakSet,s_=new WeakSet,aD=new WeakSet,Xb=new WeakSet,a_=new WeakSet,l_=new WeakSet,u_=new WeakSet,c_=new WeakSet,h_=new WeakSet,d_=new WeakSet;class lD extends it{constructor(){super(...arguments),Ci(this,d_),Ci(this,h_),Ci(this,c_),Ci(this,u_),Ci(this,l_),Ci(this,a_),Ci(this,Xb),Ci(this,aD),Ci(this,s_),Ci(this,rC),Tu(this,"columnsLimit",1/0),Tu(this,"rowsLimit",1/0),Tu(this,"pasteMode","overwrite"),Tu(this,"uiContainer",this.hot.rootDocument.body),$o(this,pS,{writable:!0,value:!1}),$o(this,wS,{writable:!0,value:!1}),$o(this,CS,{writable:!0,value:!1}),$o(this,Ga,{writable:!0,value:"cells-only"}),$o(this,md,{writable:!0,value:!1}),$o(this,pd,{writable:!0,value:!1}),$o(this,za,{writable:!0,value:new $J({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),$o(this,Yf,{writable:!0,value:!1}),Tu(this,"copyableRanges",[])}static get PLUGIN_KEY(){return gd}static get SETTING_KEYS(){return[gd,...YJ]}static get PLUGIN_PRIORITY(){return UJ}isEnabled(){return!!this.hot.getSettings()[gd]}enablePlugin(){var e=this;if(this.enabled)return;const{[gd]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Kr(this,pS,!!n.copyColumnHeaders),Kr(this,wS,!!n.copyColumnGroupHeaders),Kr(this,CS,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Rr(this,a_,jJ).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Rr(e,l_,KJ).call(e,...s)}),this.addHook("afterSelectionEnd",()=>Rr(this,u_,XJ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),Ly()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Rr(e,c_,qJ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Rr(e,h_,ZJ).call(e,...s)}),this.addHook("afterSelection",()=>Rr(this,d_,JJ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Kr(this,Ga,e),Kr(this,md,!0),Rr(this,rC,f_).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Kr(this,pd,!0),Rr(this,rC,f_).call(this,"cut")}getRangedCopyableData(e){return tc(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=iD(e);return E(r,o=>{const s=[];E(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new DJ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}nr(this,za).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);nr(this,Ga)==="column-headers-only"?n.set("headers",nr(this,za).getMostBottomColumnHeadersRange()):(nr(this,Ga)==="with-column-headers"?n.set("headers",nr(this,za).getMostBottomColumnHeadersRange()):nr(this,Ga)==="with-column-group-headers"&&n.set("headers",nr(this,za).getAllColumnHeadersRange()),n.set("cells",nr(this,za).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,g=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:p,visualRow:C}=this.hot.getCellMeta(c,a);if(c=C+1,p===!0)continue;d=C,h=a;const S=[],y=o.length%r;for(;S.length<i||h<=u;){const{skipColumnOnPaste:R,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,R===!0)continue;g=T;const N=S.length%i;S.push(e[y][N])}o.push(S)}return Kr(this,Yf,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,g]}onCopy(e){if(!this.hot.isListening()&&!nr(this,md)||this.isEditorOpened())return;this.setCopyableText(),Kr(this,md,!1);const n=this.getRangedData(this.copyableRanges),r=Rr(this,s_,GJ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=tc(n);if(e&&e.clipboardData){const s=Uv(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[o_,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Kr(this,Ga,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!nr(this,pd)||this.isEditorOpened())return;this.setCopyableText(),Kr(this,pd,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=tc(n);if(e&&e.clipboardData){const o=Uv(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[o_,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=Ag(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=UP(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=u9(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function f_(t){if(Ly()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&CP(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function GJ(t){const{rows:e}=iD(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function zJ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&Py(r)}}}function uD(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&xy(r)}}}function jJ(t){t.items.push({name:"---------"},AJ(this)),nr(this,pS)&&t.items.push(PJ(this)),nr(this,wS)&&t.items.push(IJ(this)),nr(this,CS)&&t.items.push(OJ(this)),t.items.push(xJ(this))}function KJ(t,e,n,r,i){nr(this,Yf)&&(i.value=!0),Kr(this,Yf,!1)}function XJ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function qJ(){Rr(this,Xb,uD).call(this)}function ZJ(){Rr(this,aD,zJ).call(this)}function JJ(){Rr(this,Xb,uD).call(this)}function cD(t,e){return`border_row${t}col${e}`}function ju(){return{width:1,color:"#000"}}function ho(){return{hide:!0}}function QJ(){return{width:1,color:"#000",cornerVisible:!1}}function iC(t){if(ue(t.start)||ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ue(t.end)||ue(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function _u(t){return ue(t.start)&&(t.left=t.start),ue(t.end)&&(t.right=t.end),t}function oC(t,e){return{id:cD(t,e),border:QJ(),row:t,col:e,top:ho(),bottom:ho(),start:ho(),end:ho()}}function eQ(t,e){return Pt(e,"border")&&e.border&&(t.border=e.border),Pt(e,"top")&&ue(e.top)&&(e.top?(Be(e.top)||(e.top=ju()),t.top=e.top):(e.top=ho(),t.top=e.top)),Pt(e,"bottom")&&ue(e.bottom)&&(e.bottom?(Be(e.bottom)||(e.bottom=ju()),t.bottom=e.bottom):(e.bottom=ho(),t.bottom=e.bottom)),Pt(e,"start")&&ue(e.start)&&(e.start?(Be(e.start)||(e.start=ju()),t.start=e.start):(e.start=ho(),t.start=e.start)),Pt(e,"end")&&ue(e.end)&&(e.end?(Be(e.end)||(e.end=ju()),t.end=e.end):(e.end=ho(),t.end=e.end)),t}function vo(t,e){let n=!1;return E(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Pt(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function Sp(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function tQ(t){return t.some(e=>ue(e.left)||ue(e.right))}function nQ(t){return t.some(e=>ue(e.start)||ue(e.end))}const rQ=new Map([["left","start"],["right","end"]]);function iQ(t){var e;return(e=rQ.get(t))!==null&&e!==void 0?e:t}function oQ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Rm);return vo(this,"bottom")&&(e=Sp(e)),e},callback(e,n){const r=vo(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function sQ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(Em);return vo(this,e)&&(n=Sp(n)),n},callback(n,r){const i=vo(this,e);t.prepareBorder(r,e,i)}}}function aQ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Tm)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!vo(this)}}}function lQ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(bm);return vo(this,e)&&(n=Sp(n)),n},callback(n,r){const i=vo(this,e);t.prepareBorder(r,e,i)}}}function uQ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(ym);return vo(this,"top")&&(e=Sp(e)),e},callback(e,n){const r=vo(this,"top");t.prepareBorder(n,"top",r)}}}function g_(t,e){cQ(t,e),e.add(t)}function cQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hQ(t,e,n){return e=dQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dQ(t){var e=fQ(t,"string");return typeof e=="symbol"?e:String(e)}function fQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function m_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const sf="customBorders",gQ=90;var p_=new WeakSet,w_=new WeakSet;class mQ extends it{constructor(){super(...arguments),g_(this,w_),g_(this,p_),hQ(this,"savedBorders",[])}static get PLUGIN_KEY(){return sf}static get PLUGIN_PRIORITY(){return gQ}isEnabled(){return!!this.hot.getSettings()[sf]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>m_(this,p_,pQ).call(this,e)),this.addHook("init",()=>m_(this,w_,wQ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=iC(n));const o=Hl(e),s=Mc(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});E(e,a=>{s(a).forAll((l,u)=>{E(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,iQ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Hl(e),r=Mc(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return E(e,o=>{r(o).forAll((s,a)=>{E(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(_u(l))})})}),i}clearBorders(e){e?this.setBorders(e):(E(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=oC(e,n);r&&(a=eQ(a,r),E(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",_u(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,r,o=>{me(e.from.col,i,s=>{const a=oC(o,s);let l=0;o===e.from.row&&Pt(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Pt(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Pt(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Pt(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",_u(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=cD(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=oC(e,n):o=iC(o),i?(o[r]=ho(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",_u(o)))):(o[r]=ju(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",_u(o)))}prepareBorder(e,n,r){E(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":me(o.col,s.col,a=>{me(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":me(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":me(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":me(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){E(e,n=>{const r=iC(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Yt([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ye(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){E(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){E(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ye(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):E(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return E(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return E(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):E(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);E(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[sf];if(Array.isArray(e)){const n=_n(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=tQ(e),r=nQ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function pQ(t){this.hot.getSettings()[sf]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(Sm)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[uQ(this),lQ(this),oQ(this),sQ(this),aQ(this)]}})}function wQ(){this.changeBorderSettings()}function CQ(t,e){vQ(t,e),e.add(t)}function vQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sC(t,e,n){return e=SQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SQ(t){var e=yQ(t,"string");return typeof e=="symbol"?e:String(e)}function yQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function C_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const v_="dragToScroll",bQ=100;var aC=new WeakSet;class RQ extends it{constructor(){super(...arguments),CQ(this,aC),sC(this,"boundaries",null),sC(this,"callback",null),sC(this,"listening",!1)}static get PLUGIN_KEY(){return v_}static get PLUGIN_PRIORITY(){return bQ}isEnabled(){return!!this.hot.getSettings()[v_]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>C_(this,aC,S_).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>C_(this,aC,S_).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=yc(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function S_(t){if(fs(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Bs(t,e){EQ(t,e),e.add(t)}function EQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lC(t,e,n){return e=TQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TQ(t){var e=_Q(t,"string");return typeof e=="symbol"?e:String(e)}function _Q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("afterDropdownMenuDefaultOptions");de.getSingleton().register("beforeDropdownMenuShow");de.getSingleton().register("afterDropdownMenuShow");de.getSingleton().register("afterDropdownMenuHide");de.getSingleton().register("afterDropdownMenuExecute");const af="dropdownMenu",MQ=230,vS="changeType",uC=af;var qb=new WeakSet,y_=new WeakSet,b_=new WeakSet,R_=new WeakSet,E_=new WeakSet,T_=new WeakSet,__=new WeakSet;class sh extends it{static get PLUGIN_KEY(){return af}static get PLUGIN_PRIORITY(){return MQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[th,nh,je,ih,je,fp,je,rh,je,_r]}constructor(e){super(e),Bs(this,__),Bs(this,T_),Bs(this,E_),Bs(this,R_),Bs(this,b_),Bs(this,y_),Bs(this,qb),lC(this,"commandExecutor",new XH(this.hot)),lC(this,"itemsFactory",null),lC(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>zo(this,b_,OQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[af]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new qH(this.hot,sh.DEFAULT_ITEMS);const n=this.hot.getSettings()[af],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new zl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>zo(this,R_,IQ).call(this)),this.menu.addLocalHook("afterOpen",()=>zo(this,E_,PQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>zo(this,T_,xQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>zo(this,__,HQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),E(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=dp(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:uC},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:uC}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(uC)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>zo(this,y_,AQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ge(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function hD(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function AQ(t){if(t.stopPropagation(),Ie(t.target,vS)){const e=dp(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function OQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${vS}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=vS,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Ee(s,[Eo(),by(" ")]),Ee(e,[iP("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function IQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function PQ(){this.hot.runHooks("afterDropdownMenuShow",this),zo(this,qb,hD).call(this,this.menu)}function xQ(t){zo(this,qb,hD).call(this,t)}function HQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}sh.SEPARATOR={name:je};function M_(t,e,n){return e=DQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DQ(t){var e=NQ(t,"string");return typeof e=="symbol"?e:String(e)}function NQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LQ{constructor(e){M_(this,"hot",void 0),M_(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return me(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(me(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();me(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();me(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const $Q=LQ;function A_(t,e,n){return e=kQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kQ(t){var e=FQ(t,"string");return typeof e=="symbol"?e:String(e)}function FQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zb{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){A_(this,"dataProvider",void 0),A_(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Bn(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=jt(Bn(Zb.DEFAULT_OPTIONS),n),n=jt(n,e),n.filename=yy(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const WQ=Zb,VQ=String.fromCharCode(13),BQ=String.fromCharCode(34),UQ=String.fromCharCode(10);class YQ extends WQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ye(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),E(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Wt(e);return r!==""&&(n||r.indexOf(VQ)>=0||r.indexOf(BQ)>=0||r.indexOf(UQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const GQ=YQ,zQ="csv",SS={[zQ]:GQ};function jQ(t,e,n){return typeof SS[t]=="function"?new SS[t](e,n):null}const KQ="exportFile",XQ=240;class qQ extends it{static get PLUGIN_KEY(){return KQ}static get PLUGIN_PRIORITY(){return XQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!SS[e])throw new Error(`Export format type "${e}" is not supported.`);return jQ(e,new $Q(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function ja(t,e,n){return e=ZQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZQ(t){var e=JQ(t,"string");return typeof e=="symbol"?e:String(e)}function JQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ah{constructor(e,n){let{id:r,stateless:i=!0}=n;ja(this,"hot",void 0),ja(this,"id",void 0),ja(this,"elements",[]),ja(this,"hidden",!1),ja(this,"stateId",""),ja(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Yg)}getElements(){return this.elements}reset(){E(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),E(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}pt(ah,sr);const Oc={};function ms(t,e){if(!Oc[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Oc[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function oa(t){if(!Oc[t])throw Error(`Filter condition "${t}" does not exist.`);return Oc[t].descriptor}function Kt(t,e,n){n.key=t,Oc[t]={condition:e,descriptor:n}}const un="none";function QQ(){return!0}Kt(un,QQ,{name:Jc,inputsCount:0,showOperators:!1});const oc="empty";function eee(t){return Zt(t.value)}Kt(oc,eee,{name:xm,inputsCount:0,showOperators:!0});const lf="not_empty";function tee(t,e){return!ms(oc,e)(t)}Kt(lf,tee,{name:Hm,inputsCount:0,showOperators:!0});const sc="eq";function nee(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale)===Wt(n)}Kt(sc,nee,{name:Dm,inputsCount:1,showOperators:!0});const uf="neq";function ree(t,e){return!ms(sc,e)(t)}Kt(uf,ree,{name:Nm,inputsCount:1,showOperators:!0});const dD="gt";function iee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Kt(dD,iee,{name:Wm,inputsCount:1,showOperators:!0});const fD="gte";function oee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Kt(fD,oee,{name:Vm,inputsCount:1,showOperators:!0});const gD="lt";function see(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Kt(gD,see,{name:Bm,inputsCount:1,showOperators:!0});const mD="lte";function aee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Kt(mD,aee,{name:Um,inputsCount:1,showOperators:!0});const Jb="date_after";function lee(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Kt(Jb,lee,{name:zm,inputsCount:1,showOperators:!0});const Qb="date_before";function uee(t,e){let[n]=e;const r=X(t.value,t.meta.dateFormat),i=X(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Kt(Qb,uee,{name:jm,inputsCount:1,showOperators:!0});const Gf="between";function cee(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=ms(Qb,[o]),a=ms(Jb,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Kt(Gf,cee,{name:Ym,inputsCount:2,showOperators:!0});const pD="not_between";function hee(t,e){return!ms(Gf,e)(t)}Kt(pD,hee,{name:Gm,inputsCount:2,showOperators:!0});const wD="begins_with";function dee(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Wt(n))}Kt(wD,dee,{name:Lm,inputsCount:1,showOperators:!0});const CD="ends_with";function fee(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Wt(n))}Kt(CD,fee,{name:$m,inputsCount:1,showOperators:!0});const eR="contains";function gee(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Wt(n))>=0}Kt(eR,gee,{name:km,inputsCount:1,showOperators:!0});const vD="not_contains";function mee(t,e){return!ms(eR,e)(t)}Kt(vD,mee,{name:Fm,inputsCount:1,showOperators:!0});const SD="date_tomorrow";function pee(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(-1,"days").startOf("day"),"d"):!1}Kt(SD,pee,{name:Xm,inputsCount:0});const yD="date_today";function wee(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().startOf("day"),"d"):!1}Kt(yD,wee,{name:Km,inputsCount:0});const bD="date_yesterday";function Cee(t){const e=X(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(X().subtract(1,"days").startOf("day"),"d"):!1}Kt(bD,Cee,{name:qm,inputsCount:0});MP();function vee(t,e){let n=t;return n===""&&(n=`(${e})`),n}const yS=new Set([1]).has(1),See=yS&&typeof Array.from=="function";function lh(t){let e=t;return yS&&(e=new Set(e)),function(n){let r;return yS?r=e.has(n):r=!!~e.indexOf(n),r}}function RD(t){return t??""}function bS(t){let e=t;return See?e=Array.from(new Set(e)):e=Cy(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function O_(t,e,n,r){const i=[],o=t===e;let s;return o||(s=lh(e)),E(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:vee(a,n)};r&&r(u),i.push(u)}),i}const sa="by_value";function yee(t,e){let[n]=e;return n(t.value)}Kt(sa,yee,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[lh(e)]},showOperators:!1});const Ic={};function bee(t){if(!Ic[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Ic[t].func;return function(n,r){return e(n,r)}}function Ree(t){return Ic[t].name}function tR(t,e,n){Ic[t]={name:e,func:n}}const ls="conjunction",Eee=Qm;function Tee(t,e){return t.every(n=>n.func(e))}tR(ls,Eee,Tee);const zf="disjunction",_ee=Qc;function Mee(t,e){return t.some(n=>n.func(e))}tR(zf,_ee,Mee);const nR="disjunctionWithExtraCondition",Aee=Qc;function Oee(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}tR(nR,Aee,Oee);const Iee="numeric",ED="text",Pee="date",I_={[Iee]:[un,je,oc,lf,je,sc,uf,je,dD,fD,gD,mD,Gf,pD],[ED]:[un,je,oc,lf,je,sc,uf,je,wD,CD,je,eR,vD],[Pee]:[un,je,oc,lf,je,sc,uf,je,Qb,Jb,Gf,je,SD,yD,bD]};function xee(t){const e=[];let n=t;return I_[n]||(n=ED),E(I_[n],r=>{let i;r===je?i={name:je}:i=Bn(oa(r)),e.push(i)}),e}function Mu(t,e,n){return e=Hee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hee(t){var e=Dee(t,"string");return typeof e=="symbol"?e:String(e)}function Dee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cC="built",hC="building",P_=["click","input","keydown","keypress","keyup","focus","blur","change"];let ti=class TD{static get DEFAULTS(){return Bn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Mu(this,"hot",void 0),Mu(this,"eventManager",new xr(this)),Mu(this,"options",void 0),Mu(this,"_element",void 0),Mu(this,"buildState",void 0),this.hot=e,this.options=jt(TD.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===hC?this._element:this.buildState===cC?(this.update(),this._element):(this.buildState=hC,this.build(),this.buildState=cC,this._element)}isBuilt(){return this.buildState===cC}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Gn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=hC),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)E(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ge(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),E(P_,r=>e(n,r))}else E(P_,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};pt(ti,sr);function Nee(t,e){_D(t,e),e.add(t)}function Lee(t,e,n){_D(t,e),e.set(t,n)}function _D(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wd(t,e){var n=MD(t,e,"get");return $ee(t,n)}function $ee(t,e){return e.get?e.get.call(t):e.value}function kee(t,e,n){var r=MD(t,e,"set");return Fee(t,r,n),n}function MD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Fee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Wee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Ka=new WeakMap,x_=new WeakSet;class us extends ti{static get DEFAULTS(){return Bn({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,jt(us.DEFAULTS,n)),Nee(this,x_),Lee(this,Ka,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>Wee(this,x_,Vee).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");kee(this,Ka,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(wd(this,Ka).type=this.options.type,wd(this,Ka).placeholder=this.translateIfPossible(this.options.placeholder),wd(this,Ka).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&wd(this,Ka).focus()}}function Vee(t){this.options.value=t.target.value}function dC(t,e){AD(t,e),e.add(t)}function Au(t,e,n){AD(t,e),e.set(t,n)}function AD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){var r=OD(t,e,"set");return Bee(t,r,n),n}function Bee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function fC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ht(t,e){var n=OD(t,e,"get");return Uee(t,n)}function OD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Uee(t,e){return e.get?e.get.call(t):e.value}var Qt=new WeakMap,Cd=new WeakMap,vd=new WeakMap,gC=new WeakMap,Sd=new WeakMap,H_=new WeakSet,D_=new WeakSet,N_=new WeakSet;class Pc extends ti{static get DEFAULTS(){return Bn({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,jt(Pc.DEFAULTS,n)),dC(this,N_),dC(this,D_),dC(this,H_),Au(this,Qt,{writable:!0,value:null}),Au(this,Cd,{writable:!0,value:[]}),Au(this,vd,{writable:!0,value:void 0}),Au(this,gC,{writable:!0,value:void 0}),Au(this,Sd,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Ht(this,Qt)}registerHooks(){this.addLocalHook("click",()=>fC(this,N_,zee).call(this))}setItems(e){Xa(this,Cd,this.translateNames(e)),Ht(this,Qt)&&Ht(this,Qt).setMenuItems(Ht(this,Cd))}translateNames(e){return E(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Xa(this,Qt,new zl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ht(this,Qt).setMenuItems(Ht(this,Cd));const e=new ti(this.hot,{className:"htUISelectCaption"}),n=new ti(this.hot,{className:"htUISelectDropdown"});Xa(this,vd,e),Xa(this,gC,e.element),Xa(this,Sd,n),this.hot.getSettings().ariaTags&&(Ee(n.element,[Eo()]),Ee(this._element,[rP()])),E([e,n],r=>this._element.appendChild(r.element)),Ht(this,Qt).addLocalHook("select",r=>fC(this,H_,Yee).call(this,r)),Ht(this,Qt).addLocalHook("afterClose",()=>fC(this,D_,Gee).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ht(this,Qt).hot.getTranslatedPhrase(Jc),Ht(this,gC).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ht(this,Qt)&&(Ht(this,Qt).open(),Ht(this,Qt).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ht(this,Qt).getNavigator().toFirstItem(),Ht(this,Qt).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ht(this,Qt)&&Ht(this,Qt).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ht(this,Qt)&&(Ht(this,Qt).destroy(),Xa(this,Qt,null)),Ht(this,vd)&&Ht(this,vd).destroy(),Ht(this,Sd)&&Ht(this,Sd).destroy(),super.destroy()}}function Yee(t){t.name!==je&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Gee(){this.runLocalHooks("afterClose")}function zee(){this.openOptions()}function L_(t,e){jee(t,e),e.add(t)}function jee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $_(t,e,n){return e=Kee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kee(t){var e=Xee(t,"string");return typeof e=="symbol"?e:String(e)}function Xee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function k_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var F_=new WeakSet,W_=new WeakSet;class RS extends ah{constructor(e,n){super(e,{id:n.id,stateless:!1}),L_(this,W_),L_(this,F_),$_(this,"name",""),$_(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Pc(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new us(this.hot,{placeholder:op})),this.elements.push(new us(this.hot,{placeholder:sp})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>k_(this,F_,qee).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),E(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>k_(this,W_,Zee).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Bn(e.command);n.name.startsWith(Vt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),E(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||oa(un),n=[];return E(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=oa(e?e.name:un);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||E(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Pc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof us)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),E(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[oa(un)];if(e!==null){const{visualIndex:r}=e;n=xee(this.hot.getDataType(0,r,this.hot.countRows(),r))}E(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function qee(t){E(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function Zee(t){Bl(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lr(t))}function V_(t,e,n){Jee(t,e),e.set(t,n)}function Jee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ou(t,e){var n=ID(t,e,"get");return Qee(t,n)}function Qee(t,e){return e.get?e.get.call(t):e.value}function B_(t,e,n){var r=ID(t,e,"set");return ete(t,r,n),n}function ID(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ete(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var qa=new WeakMap,mC=new WeakMap;class jf extends ti{static get DEFAULTS(){return Bn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,jt(jf.DEFAULTS,n)),V_(this,qa,{writable:!0,value:void 0}),V_(this,mC,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),B_(this,mC,e),B_(this,qa,this._element.firstChild),Ou(this,qa).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ou(this,mC).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Ou(this,qa).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Ou(this,qa).checked=e)}focus(){this.isBuilt()&&Ou(this,qa).focus()}}function tte(t,e){nte(t,e),e.add(t)}function nte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rte(t,e,n){return e=ite(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ite(t){var e=ote(t,"string");return typeof e=="symbol"?e:String(e)}function ote(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ste(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const U_=0;var Y_=new WeakSet;class ate extends ah{constructor(e,n){super(e,{id:n.id,stateless:!1}),tte(this,Y_),rte(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),E(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ls,zf];E(e,n=>{const r=new jf(this.hot,{name:"operator",label:{htmlFor:n,textContent:Ree(n)},value:n,checked:n===e[U_],id:n});r.addLocalHook("change",i=>ste(this,Y_,lte).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ht`Radio button with index ${e} doesn't exist.`);E(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof jf&&n.isChecked());return e?e.getValue():ls}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&E(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ls,n=arguments.length>1?arguments[1]:void 0,r=e;r===nR&&(r=zf),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(U_)}}function lte(t){this.setState(t.target.value)}function ute(t,e,n){cte(t,e),e.set(t,n)}function cte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pC(t,e){var n=PD(t,e,"get");return hte(t,n)}function hte(t,e){return e.get?e.get.call(t):e.value}function dte(t,e,n){var r=PD(t,e,"set");return fte(t,r,n),n}function PD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function fte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Iu=new WeakMap;class xc extends ti{static get DEFAULTS(){return Bn({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,jt(xc.DEFAULTS,n)),ute(this,Iu,{writable:!0,value:void 0})}build(){super.build(),dte(this,Iu,this._element.firstChild)}update(){this.isBuilt()&&(pC(this,Iu).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&pC(this,Iu).focus()}activate(){pC(this,Iu).click()}}function yd(t,e){xD(t,e),e.add(t)}function Za(t,e,n){xD(t,e),e.set(t,n)}function xD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ne(t,e){var n=HD(t,e,"get");return gte(t,n)}function gte(t,e){return e.get?e.get.call(t):e.value}function Ur(t,e,n){var r=HD(t,e,"set");return mte(t,r,n),n}function HD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const G_="multipleSelect.itemBox";var qr=new WeakMap,Ot=new WeakMap,wC=new WeakMap,Xi=new WeakMap,ko=new WeakMap,Fo=new WeakMap,z_=new WeakSet,j_=new WeakSet,K_=new WeakSet,X_=new WeakSet;class Hc extends ti{static get DEFAULTS(){return Bn({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,jt(Hc.DEFAULTS,n)),yd(this,X_),yd(this,K_),yd(this,j_),yd(this,z_),Za(this,qr,{writable:!0,value:[]}),Za(this,Ot,{writable:!0,value:void 0}),Za(this,wC,{writable:!0,value:void 0}),Za(this,Xi,{writable:!0,value:void 0}),Za(this,ko,{writable:!0,value:void 0}),Za(this,Fo,{writable:!0,value:void 0}),Ur(this,Xi,new us(this.hot,{placeholder:ip,className:"htUIMultipleSelectSearch"})),Ur(this,ko,new xc(this.hot,{textContent:ep,className:"htUISelectAll"})),Ur(this,Fo,new xc(this.hot,{textContent:tp,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ne(this,Ot)}registerHooks(){Ne(this,Xi).addLocalHook("keydown",e=>bd(this,j_,wte).call(this,e)),Ne(this,Xi).addLocalHook("input",e=>bd(this,z_,pte).call(this,e)),Ne(this,ko).addLocalHook("click",e=>bd(this,K_,Cte).call(this,e)),Ne(this,Fo).addLocalHook("click",e=>bd(this,X_,vte).call(this,e))}setItems(e){Ur(this,qr,e),Ne(this,Ot)&&Ne(this,Ot).loadData(Ne(this,qr))}setLocale(e){Ur(this,wC,e)}getLocale(){return Ne(this,wC)}getItems(){return[...Ne(this,qr)]}getValue(){return yte(Ne(this,qr))}getSearchInputElement(){return Ne(this,Xi)}getSelectAllElement(){return Ne(this,ko)}getClearAllElement(){return Ne(this,Fo)}isSelectedAllValues(){return Ne(this,qr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new ti(this.hot,{className:"htUISelectionControls",children:[Ne(this,ko),Ne(this,Fo)]});this._element.appendChild(Ne(this,Xi).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Ne(this,Ot)&&Ne(this,Ot).destroy(),q(o,"htUIMultipleSelectHot"),Ur(this,Ot,new this.hot.constructor(o,{data:Ne(this,qr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,d,g)=>{l.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ne(this,Ot).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Ne(this,Ot).container.scrollWidth-nn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ne(this,Ot).init();const a=Ne(this,Ot).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:G_}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Ne(this,Ot).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:G_})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ne(this,Ot).listen()}reset(){Ne(this,Xi).reset(),Ne(this,ko).reset(),Ne(this,Fo).reset()}update(){this.isBuilt()&&(Ne(this,Ot).loadData(Ste(Ne(this,qr),this.options.value)),super.update())}destroy(){Ne(this,Ot)&&Ne(this,Ot).destroy(),Ne(this,Xi).destroy(),Ne(this,Fo).destroy(),Ne(this,ko).destroy(),Ur(this,Xi,null),Ur(this,Fo,null),Ur(this,ko,null),Ur(this,Ot,null),Ur(this,qr,null),super.destroy()}}function pte(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ne(this,qr)]:n=wr(Ne(this,qr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ne(this,Ot).loadData(n)}function wte(t){this.runLocalHooks("keydown",t,this),Hy(Bl,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Lr(t),Ne(this,Ot).listen(),Ne(this,Ot).selectCell(0,0))}function Cte(t){const e=[];t.preventDefault(),E(Ne(this,Ot).getSourceData(),(n,r)=>{n.checked=!0,e.push(cb(n,r)[0])}),Ne(this,Ot).setSourceDataAtCell(e)}function vte(t){const e=[];t.preventDefault(),E(Ne(this,Ot).getSourceData(),(n,r)=>{n.checked=!1,e.push(cb(n,r)[0])}),Ne(this,Ot).setSourceDataAtCell(e)}function Ste(t,e){const n=lh(e);return Ye(t,r=>(r.checked=n(r.value),r))}function yte(t){const e=[];return E(t,n=>{n.checked&&e.push(n.value)}),e}function bte(t,e){Rte(t,e),e.add(t)}function Rte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ete(t,e,n){return e=Tte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tte(t){var e=_te(t,"string");return typeof e=="symbol"?e:String(e)}function _te(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mte(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var q_=new WeakSet;class Ate extends ah{constructor(e,n){super(e,{id:n.id,stateless:!1}),bte(this,q_),Ete(this,"name",""),this.name=n.name,this.elements.push(new Hc(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Mte(this,q_,Ote).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===sa){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?un:sa},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=wr(i,h=>h.name===sa),u={},c=this.hot.getTranslatedPhrase(_c);if(l){const h=bS(Ye(s(r,a),C=>C.value));o&&(l.args[0]=o);const d=[],g=O_(h,l.args[0],c,C=>{C.checked&&d.push(C.value)}),p=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,p).locale,u.args=[d],u.command=oa(sa),u.itemsSnapshot=g}else u.args=[],u.command=oa(un);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Hc)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),E(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(_c),n=bS(this._getColumnVisibleValues()),r=O_(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ye(this.hot.getDataAtCol(e.visualIndex),n=>RD(n))}}function Ote(t){Bl(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Lr(t))}var DD;function Ite(t,e){Pte(t,e),e.add(t)}function Pte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xte(t,e,n){return e=Hte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hte(t){var e=Dte(t,"string");return typeof e=="symbol"?e:String(e)}function Dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nte(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Z_=new WeakSet;class Dc extends ah{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),Ite(this,Z_),xte(this,"name",""),this.name=n.name,this.elements.push(new us(this.hot,{type:"button",value:np,className:"htUIButton htUIButtonOK",identifier:Dc.BUTTON_OK})),this.elements.push(new us(this.hot,{type:"button",value:rp,className:"htUIButton htUIButtonCancel",identifier:Dc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){E(this.elements,e=>{e.addLocalHook("click",(n,r)=>Nte(this,Z_,Lte).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),E(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}DD=Dc;function Lte(t,e){e.options.identifier===DD.BUTTON_OK?this.accept():this.cancel()}function CC(t,e,n){return e=$te(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $te(t){var e=kte(t,"string");return typeof e=="symbol"?e:String(e)}function kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const J_="ConditionCollection.filteringStates";class ND{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;CC(this,"hot",void 0),CC(this,"isMapRegistrable",void 0),CC(this,"filteringStates",new Yg),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(J_,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ls;return e.length?bee(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ls,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ye(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ht`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(vt(Ic[r]))throw new Error(ht`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:ms(a,s)}]},i):u.push({name:a,args:s,func:ms(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Yt(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ye(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),E(e,n=>{E(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(J_),this.filteringStates=null,this.clearLocalHooks()}}pt(ND,sr);const LD=ND;function Q_(t,e,n){return e=Fte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fte(t){var e=Wte(t,"string");return typeof e=="symbol"?e:String(e)}function Wte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vte{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];Q_(this,"conditionCollection",void 0),Q_(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return E(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return E(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return E(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const $D=Vte;function vC(t,e){Bte(t,e),e.add(t)}function Bte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Us(t,e,n){return e=Ute(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ute(t){var e=Yte(t,"string");return typeof e=="symbol"?e:String(e)}function Yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var eM=new WeakSet,tM=new WeakSet,nM=new WeakSet;class kD{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];vC(this,nM),vC(this,tM),vC(this,eM),Us(this,"hot",void 0),Us(this,"conditionCollection",void 0),Us(this,"columnDataFactory",void 0),Us(this,"changes",[]),Us(this,"grouping",!1),Us(this,"latestEditedColumnPosition",-1),Us(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>SC(this,eM,Gte).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>SC(this,tM,zte).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>SC(this,nM,jte).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,E(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=SP(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new LD(r.hot,!1),p=[].concat(c,d);g.importAllConditions(p);const C=r.columnDataFactory(h);let S;g.isEmpty()?S=C:S=new $D(g,R=>r.columnDataFactory(R)).filter(),S=Ye(S,R=>R.meta.visualRow);const y=lh(S);return g.destroy(),wr(C,R=>y(R.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ge(this,(e,n)=>{this[n]=null})}}function Gte(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function zte(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function jte(){E(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}pt(kD,sr);const Kte=kD;function Xte(t){return JH({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Hc)return r;if(i.element&&!ds(i.element))return!1;i.focus()}})}const Pu="filters";function qte(t,e){let n=-1;const r=Xte(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Pu),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof ti&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Pu),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Pu)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const d=t.getNavigator();d.getCurrentPage()>-1&&(n=d.getCurrentPage()),d.clear(),h.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const d=e[r.getCurrentPage()];d instanceof Pc&&(d.openOptions(),h.preventDefault()),d instanceof xc&&(d.activate(),h.preventDefault()),d instanceof ti||h.preventDefault()}}],Pu)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Pu)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function qi(t,e){FD(t,e),e.add(t)}function Zte(t,e,n){FD(t,e),e.set(t,n)}function FD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xu(t,e,n){return e=Jte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jte(t){var e=Qte(t,"string");return typeof e=="symbol"?e:String(e)}function Qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ene(t,e,n){var r=WD(t,e,"set");return tne(t,r,n),n}function tne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Hu(t,e){var n=WD(t,e,"get");return nne(t,n)}function WD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nne(t,e){return e.get?e.get.call(t):e.value}function Yr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ES="filters",rne=250,rM=ES;var Ys=new WeakMap,iM=new WeakSet,oM=new WeakSet,sM=new WeakSet,aM=new WeakSet,yC=new WeakSet,lM=new WeakSet,bC=new WeakSet,uM=new WeakSet,cM=new WeakSet;class VD extends it{static get PLUGIN_KEY(){return ES}static get PLUGIN_PRIORITY(){return rne}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),qi(this,cM),qi(this,uM),qi(this,bC),qi(this,lM),qi(this,yC),qi(this,aM),qi(this,sM),qi(this,oM),qi(this,iM),xu(this,"dropdownMenuPlugin",null),xu(this,"conditionCollection",null),xu(this,"conditionUpdateObserver",null),xu(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),xu(this,"filtersRowsMap",null),Zte(this,Ys,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Yr(this,uM,une).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[ES]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Zc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Yr(this,yC,hM).call(this,"accept")),s.addLocalHook("cancel",()=>Yr(this,yC,hM).call(this,"cancel")),s.addLocalHook("change",a=>Yr(this,lM,lne).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(Zm)}:`,o=()=>`${this.hot.getTranslatedPhrase(Jm)}:`;if(!this.components.get("filter_by_condition")){const s=new RS(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Yr(this,bC,dM).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ate(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new RS(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Yr(this,bC,dM).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Ate(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Dc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new LD(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Kte(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Yr(this,cM,cne).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Yr(this,aM,ane).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Yr(this,oM,one).call(this)),this.addHook("afterDropdownMenuHide",()=>Yr(this,sM,sne).call(this)),this.addHook("afterChange",s=>Yr(this,iM,ine).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Hu(this,Ys)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=Hu(this,Ys).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];ene(this,Ys,qte(s,a));const l=u=>{Hu(this,Ys).listen(),u.preventDefault(),Bl(u.keyCode,"TAB")&&(u.shiftKey?Hu(this,Ys).toPreviousItem():Hu(this,Ys).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:rM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rM)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ls;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ye(n.filter(),u=>u.meta.visualRow);const l=lh(i);me(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),E(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return E(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:g,locale:p}=this.hot.getCellMeta(o,n),C=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:g,locale:p},value:RD(C)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=bS(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===zf&&n.command.key!==un&&r.command.key!==un&&i.command.key!==un?o=nR:i.command.key!==un&&(n.command.key===un||r.command.key===un)&&(o=ls),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new $D(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return E(i,s=>{E(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function ine(t){t&&E(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function one(){this.restoreComponents(Array.from(this.components.values()))}function sne(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function ane(t){t.items.push({name:je}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function hM(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==un&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==un&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==un&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function lne(t,e){this.updateDependentComponentsVisibility(),t.constructor===RS&&!e.inputsCount&&this.setListeningDropdownMenu()}function dM(){this.setListeningDropdownMenu()}function une(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?q(e,"htFiltersActive"):Le(e,"htFiltersActive")}function cne(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===sa),o=n.filter(s=>s.name!==sa);if(i.length>=2||o.length>=3)gt(ht`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const BD="internal-use-in-handsontable",TS={licenseKey:BD,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function UD(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Rn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function YD(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function hne(t){var e;const n=t[Rn],r=YD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=UD(t);return{...TS,...r,...i}}function dne(t){var e;const n=t[Rn],r=YD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=UD(t);return{...r,...i}}function fne(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function yp(){const t="engine_relationship",e=ai(Rn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function rR(){const t="shared_engine_usage",e=ai(Rn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function gne(t){const e=t.getSettings(),n=e[Rn],r=n==null?void 0:n.engine;if(n===!0||vt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return mne((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&vt(r.hyperformula)){const o=yp(),s=rR().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:BD}),(r.getConfig().leapYear1900!==TS.leapYear1900||Ng(r.getConfig().nullDate,TS.nullDate)===!1)&&gt(ht`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function mne(t,e,n){const r=e[Rn],i=hne(e),o=yp(),s=rR();pne(t,r.functions),wne(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Cne(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function fM(t){var e;const n=yp(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function gM(t,e){if(t){const n=yp(),r=n.get(t),i=rR(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function pne(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){gt(s.message)}})}function wne(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){gt(r.message)}}}function Cne(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){gt(a.message)}}),t.resumeEvaluation())}function vne(t,e){return(vt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const GD="DD/MM/YYYY";function zD(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Sne(t){return zD(t)?t.substr(1):t}function yne(t){return typeof t=="string"&&t.startsWith("=")}function iR(t,e){return typeof t=="string"&&e==="date"}function jD(t,e){return X(t,e,!0).isValid()}function KD(t,e){return X(t,e,!0).format(GD)}function bne(t,e){return X(t,GD,!0).format(e)}function XD(t,e){const r=new Date(Date.UTC(0,0,t+-1));return X(r).format(e)}function Gs(t,e,n){Rne(t,e),e.set(t,n)}function Rne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){var n=qD(t,e,"get");return Ene(t,n)}function Ene(t,e){return e.get?e.get.call(t):e.value}function Wo(t,e,n){var r=qD(t,e,"set");return Tne(t,r,n),n}function qD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Tne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Du=new WeakMap,Vo=new WeakMap,ar=new WeakMap,Rd=new WeakMap,RC=new WeakMap,EC=new WeakMap,Ed=new WeakMap;class _ne{constructor(e,n,r){Gs(this,Du,{writable:!0,value:void 0}),Gs(this,Vo,{writable:!0,value:void 0}),Gs(this,ar,{writable:!0,value:void 0}),Gs(this,Rd,{writable:!0,value:[]}),Gs(this,RC,{writable:!0,value:[]}),Gs(this,EC,{writable:!0,value:void 0}),Gs(this,Ed,{writable:!0,value:[]}),Wo(this,Du,e),Wo(this,Vo,n),Wo(this,ar,r)}setRemovedHfIndexes(e){return Wo(this,Ed,e.map(n=>{const r=bt(this,Vo).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),bt(this,Ed)}getRemovedHfIndexes(){return bt(this,Ed)}getHfIndexFromVisualIndex(e){const n=bt(this,Vo).getIndexesSequence(),r=bt(this,Vo).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${Tn(bt(this,Du))}s`;bt(this,ar).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&bt(this,ar).getEngine()[r](bt(this,ar).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Wo(this,RC,e.map(i=>this.getHfIndexFromVisualIndex(i))),Wo(this,EC,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=bt(this,Vo).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(bt(this,ar).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(bt(this,RC),bt(this,EC)));bt(this,ar).getSheetId()===null?bt(this,ar).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${Tn(bt(this,Du))}Order`;return n=>{if(bt(this,ar).isPerformingUndoRedo())return;const r=bt(this,Vo).getIndexesSequence();if(n==="update"&&r.length>0){const i=bt(this,Rd).map(l=>r.indexOf(l)),o=bt(this,ar).getEngine().getSheetDimensions(bt(this,ar).getSheetId());let s;bt(this,Du)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);bt(this,ar).getEngine()[e](bt(this,ar).getSheetId(),i)}Wo(this,Rd,r)}}init(){Wo(this,Rd,bt(this,Vo).getIndexesSequence())}}const mM=_ne;function zs(t,e,n){Mne(t,e),e.set(t,n)}function Mne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zi(t,e){var n=ZD(t,e,"get");return Ane(t,n)}function Ane(t,e){return e.get?e.get.call(t):e.value}function js(t,e,n){var r=ZD(t,e,"set");return One(t,r,n),n}function ZD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function One(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Td=new WeakMap,_d=new WeakMap,TC=new WeakMap,_C=new WeakMap,MC=new WeakMap,AC=new WeakMap,OC=new WeakMap;class Ine{constructor(e,n,r){zs(this,Td,{writable:!0,value:void 0}),zs(this,_d,{writable:!0,value:void 0}),zs(this,TC,{writable:!0,value:void 0}),zs(this,_C,{writable:!0,value:!1}),zs(this,MC,{writable:!0,value:!1}),zs(this,AC,{writable:!0,value:null}),zs(this,OC,{writable:!0,value:null}),js(this,Td,new mM("row",e,this)),js(this,_d,new mM("column",n,this)),js(this,TC,r)}getForAxis(e){return e==="row"?Zi(this,Td):Zi(this,_d)}setPerformUndo(e){js(this,_C,e)}setPerformRedo(e){js(this,MC,e)}isPerformingUndoRedo(){return Zi(this,_C)||Zi(this,MC)}getSheetId(){return Zi(this,OC)}getEngine(){return Zi(this,AC)}getPostponeAction(){return Zi(this,TC)}setupSyncEndpoint(e,n){js(this,AC,e),js(this,OC,n),Zi(this,Td).init(),Zi(this,_d).init()}}const Pne=Ine;function Mt(t,e){JD(t,e),e.add(t)}function Ja(t,e,n){return e=xne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xne(t){var e=Hne(t,"string");return typeof e=="symbol"?e:String(e)}function Hne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IC(t,e,n){JD(t,e),e.set(t,n)}function JD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ps(t,e,n){var r=QD(t,e,"set");return Dne(t,r,n),n}function Dne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Al(t,e){var n=QD(t,e,"get");return Nne(t,n)}function QD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Nne(t,e){return e.get?e.get.call(t):e.value}function wt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Rn="formulas",Lne=["maxRows","maxColumns","language"],$ne=260;de.getSingleton().register("afterNamedExpressionAdded");de.getSingleton().register("afterNamedExpressionRemoved");de.getSingleton().register("afterSheetAdded");de.getSingleton().register("afterSheetRemoved");de.getSingleton().register("afterSheetRenamed");de.getSingleton().register("afterFormulasValuesUpdate");const jl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var So=new WeakMap,oR=new WeakMap,Nu=new WeakMap,pM=new WeakSet,wM=new WeakSet,PC=new WeakSet,CM=new WeakSet,xC=new WeakSet,vM=new WeakSet,SM=new WeakSet,HC=new WeakSet,yM=new WeakSet,bM=new WeakSet,RM=new WeakSet,EM=new WeakSet,TM=new WeakSet,_M=new WeakSet,MM=new WeakSet,AM=new WeakSet,OM=new WeakSet,IM=new WeakSet,PM=new WeakSet,xM=new WeakSet,HM=new WeakSet,DM=new WeakSet,NM=new WeakSet,LM=new WeakSet;class kne extends it{constructor(){var e;super(...arguments),e=this,Mt(this,LM),Mt(this,NM),Mt(this,DM),Mt(this,HM),Mt(this,xM),Mt(this,PM),Mt(this,IM),Mt(this,OM),Mt(this,AM),Mt(this,MM),Mt(this,_M),Mt(this,TM),Mt(this,EM),Mt(this,RM),Mt(this,bM),Mt(this,yM),Mt(this,HC),Mt(this,SM),Mt(this,vM),Mt(this,xC),Mt(this,CM),Mt(this,PC),Mt(this,wM),Mt(this,pM),IC(this,So,{writable:!0,value:!1}),IC(this,oR,{writable:!0,value:!1}),IC(this,Nu,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,PM,ere).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,xM,tre).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,HM,nre).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,DM,rre).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,NM,ire).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,LM,ore).call(e,...r)}]]}),Ja(this,"staticRegister",ai("formulas")),Ja(this,"engine",null),Ja(this,"sheetName",null),Ja(this,"indexSyncer",null),Ja(this,"rowAxisSyncer",null),Ja(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Rn}static get PLUGIN_PRIORITY(){return $ne}static get SETTING_KEYS(){return[Rn,...Lne]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Rn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=gne(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){gt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,PC,$M).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,xC,kM).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,PC,$M).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,xC,kM).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,vM,Bne).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,SM,Une).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,pM,Fne).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,yM,Yne).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,HC,FM).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,HC,FM).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,bM,Gne).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,RM,zne).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,_M,Xne).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,MM,qne).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,EM,jne).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,TM,Kne).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,AM,Zne).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,OM,Jne).call(n,...i)}),this.indexSyncer=new Pne(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,CM,Vne).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,IM,Qne).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,wM,Wne).call(n,...i)}),Al(this,Nu).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Al(this,Nu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),gM(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=dne(this.hot.getSettings());fne(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Rn];if(ue(r)&&ue(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Rn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Al(this,Nu).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),ps(this,Nu,null),gM(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ue(n)&&!Ax(n))return gt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return gt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return gt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Wy(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Tn(Rn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),fM(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ue(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ue(l)===!1||ue(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=fM(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){gt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return iR(r,o.type)&&(jD(r,o.dateFormat)?r=KD(r,o.dateFormat):yne(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Fne(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Vn(s)&&(s=XD(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Wne(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const g=this.engine.getFillRangeData(h,d),{row:p,col:C}=h.start,{row:S,col:y}=h.end,R=S-p+1,T=y-C+1;for(let N=0;N<g.length;N+=1)for(let I=0;I<g[N].length;I+=1){const F=g[N][I],B=N%R,ee=I%T,U=this.hot.getCellMeta(B,ee);iR(F,U.type)&&(F.startsWith("'")?g[N][I]=F.slice(1):this.isFormulaCellType(B,ee,this.sheetId)===!1&&(g[N][I]=bne(F,U.dateFormat)))}return g}function $M(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Tn(Rn))||ps(this,oR,vt(this.hot.getSettings().data))}function Vne(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;iR(i,s.type)&&(e=!0,jD(i,a)?t[r][o]=KD(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(ps(this,So,!0),this.engine.setSheetContent(this.sheetId,t),ps(this,So,!1))}function kM(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Tn(Rn)))if(this.sheetName=vne(this.engine,this.hot.getSettings()[Rn].sheetName),Al(this,oR))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){ps(this,So,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),ps(this,So,!1)}}}function Bne(t,e,n,r){if(r!=="get"||Al(this,So)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){zD(n.value)&&(n.value=Sne(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find(c=>c.visualRow===i&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Vn(a)&&(a=XD(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Une(t,e,n,r){if(r!=="get"||Al(this,So)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function FM(t,e){if(jl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Yne(t,e){if(jl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Vn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){gt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Gne(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function zne(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function jne(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Kne(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Xne(t,e,n){if(jl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function qne(t,e,n){if(jl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Zne(t,e,n,r){if(jl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Jne(t,e,n,r){if(jl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Qne(t,e,n){var r;ps(this,So,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());ps(this,So,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function ere(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function tre(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function nre(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function rre(t){this.hot.runHooks("afterSheetAdded",t)}function ire(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function ore(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function sre(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Am,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function are(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Om,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ye(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const g=u.slice(i,o+1);c.push(...g.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return E(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function Qa(t,e){eN(t,e),e.add(t)}function WM(t,e,n){eN(t,e),e.set(t,n)}function eN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function el(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function gr(t,e){var n=tN(t,e,"get");return lre(t,n)}function lre(t,e){return e.get?e.get.call(t):e.value}function Lu(t,e,n){var r=tN(t,e,"set");return ure(t,r,n),n}function tN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ure(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("beforeHideColumns");de.getSingleton().register("afterHideColumns");de.getSingleton().register("beforeUnhideColumns");de.getSingleton().register("afterUnhideColumns");const DC="hiddenColumns",cre=310;var xi=new WeakMap,vi=new WeakMap,VM=new WeakSet,BM=new WeakSet,UM=new WeakSet,YM=new WeakSet,GM=new WeakSet,zM=new WeakSet;class nN extends it{constructor(){super(...arguments),Qa(this,zM),Qa(this,GM),Qa(this,YM),Qa(this,UM),Qa(this,BM),Qa(this,VM),WM(this,xi,{writable:!0,value:{}}),WM(this,vi,{writable:!0,value:null})}static get PLUGIN_KEY(){return DC}static get PLUGIN_PRIORITY(){return cre}isEnabled(){return!!this.hot.getSettings()[DC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[DC];Be(n)&&(Lu(this,xi,n),vt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Lu(this,vi,new Ug),gr(this,vi).addLocalHook("init",()=>el(this,zM,pre).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,gr(this,vi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return el(e,GM,mre).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>el(this,BM,dre).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>el(this,VM,hre).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return el(e,YM,gre).call(e,...i)}),this.addHook("modifyCopyableRange",r=>el(this,UM,fre).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Lu(this,xi,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=gr(this,vi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));E(l,u=>{o[u]=!1}),i=Yt(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&gr(this,vi).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{gr(this,vi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ye(gr(this,vi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return gr(this,vi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){E(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Lu(this,xi,null),Lu(this,vi,null),super.destroy()}}function hre(t,e){if(this.isHidden(e))return 0;if(gr(this,xi).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function dre(t,e,n){if(gr(this,xi).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function fre(t){if(gr(this,xi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return E(t,r=>{let i=!0,o=0;me(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function gre(t,e){if(!gr(this,xi).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function mre(t){t.items.push({name:je},sre(this),are(this))}function pre(){Array.isArray(gr(this,xi).columns)&&this.hideColumns(gr(this,xi).columns)}function wre(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Im,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Cre(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Pm,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ye(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const g=u.slice(i,o+1);c.push(...g.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return E(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function tl(t,e){rN(t,e),e.add(t)}function jM(t,e,n){rN(t,e),e.set(t,n)}function rN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ar(t,e){var n=iN(t,e,"get");return vre(t,n)}function vre(t,e){return e.get?e.get.call(t):e.value}function $u(t,e,n){var r=iN(t,e,"set");return Sre(t,r,n),n}function iN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Sre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("beforeHideRows");de.getSingleton().register("afterHideRows");de.getSingleton().register("beforeUnhideRows");de.getSingleton().register("afterUnhideRows");const NC="hiddenRows",yre=320;var fo=new WeakMap,Si=new WeakMap,KM=new WeakSet,XM=new WeakSet,qM=new WeakSet,ZM=new WeakSet,JM=new WeakSet,QM=new WeakSet;class oN extends it{constructor(){super(...arguments),tl(this,QM),tl(this,JM),tl(this,ZM),tl(this,qM),tl(this,XM),tl(this,KM),jM(this,fo,{writable:!0,value:{}}),jM(this,Si,{writable:!0,value:null})}static get PLUGIN_KEY(){return NC}static get PLUGIN_PRIORITY(){return yre}isEnabled(){return!!this.hot.getSettings()[NC]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[NC];Be(n)&&($u(this,fo,n),vt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),$u(this,Si,new Ug),Ar(this,Si).addLocalHook("init",()=>nl(this,QM,Mre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ar(this,Si)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nl(e,JM,_re).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>nl(this,XM,Rre).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>nl(this,KM,bre).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return nl(e,ZM,Tre).call(e,...i)}),this.addHook("modifyCopyableRange",r=>nl(this,qM,Ere).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),$u(this,fo,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Ar(this,Si).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));E(l,u=>{o[u]=!1}),i=Yt(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Ar(this,Si).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{Ar(this,Si).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ye(Ar(this,Si).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ar(this,Si).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){E(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){$u(this,fo,null),$u(this,Si,null),super.destroy()}}function bre(t,e){return this.isHidden(e)?0:t}function Rre(t,e,n){if(Ar(this,fo).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Ere(t){if(Ar(this,fo).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return E(t,r=>{let i=!0,o=0;me(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Tre(t,e){if(!Ar(this,fo).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function _re(t){t.items.push({name:je},wre(this),Cre(this))}function Mre(){Array.isArray(Ar(this,fo).rows)&&this.hideRows(Ar(this,fo).rows)}function Are(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(im)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Ore(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(om)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function e1(t,e){sN(t,e),e.add(t)}function Ire(t,e,n){sN(t,e),e.set(t,n)}function sN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _S(t,e){var n=aN(t,e,"get");return Pre(t,n)}function Pre(t,e){return e.get?e.get.call(t):e.value}function LC(t,e,n){var r=aN(t,e,"set");return xre(t,r,n),n}function aN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function t1(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeColumnFreeze");de.getSingleton().register("afterColumnFreeze");de.getSingleton().register("beforeColumnUnfreeze");de.getSingleton().register("afterColumnUnfreeze");const n1="manualColumnFreeze",Hre=110;var ea=new WeakMap,r1=new WeakSet,i1=new WeakSet;class Dre extends it{constructor(){super(...arguments),e1(this,i1),e1(this,r1),Ire(this,ea,{writable:!0,value:!1})}static get PLUGIN_KEY(){return n1}static get PLUGIN_PRIORITY(){return Hre}isEnabled(){return!!this.hot.getSettings()[n1]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>t1(this,r1,Nre).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>t1(this,i1,Lre).call(this,e,n)),super.enablePlugin())}disablePlugin(){LC(this,ea,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;_S(this,ea)||LC(this,ea,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;_S(this,ea)||LC(this,ea,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Nre(t){t.items.push({name:"---------"},Are(this),Ore(this))}function Lre(t,e){if(_S(this,ea)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Md(t,e,n){return e=$re(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $re(t){var e=kre(t,"string");return typeof e=="symbol"?e:String(e)}function kre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $C=0,o1=1,s1=2,rl="px";let Fre=class{constructor(e){Md(this,"hot",void 0),Md(this,"_element",null),Md(this,"state",$C),Md(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=s1}build(){this.state===$C&&(this._element=this.hot.rootDocument.createElement("div"),this.state=o1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=$C}isAppended(){return this.state===s1}isBuilt(){return this.state>=o1}setPosition(e,n){Vn(e)&&(this._element.style.top=e+rl),Vn(n)&&(this._element.style[this.inlineProperty]=n+rl)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Vn(e)&&(this._element.style.width=e+rl),Vn(n)&&(this._element.style.height=n+rl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Vn(e)&&(this._element.style.marginTop=e+rl),Vn(n)&&(this._element.style[`margin${Tn(this.inlineProperty)}`]=n+rl)}getOffset(){const e=this._element.style,n=`margin${Tn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const lN=Fre,Wre="ht__manualColumnMove--backlight";let Vre=class extends lN{build(){super.build(),q(this._element,Wre)}};const Bre=Vre,Ure="ht__manualColumnMove--guideline";let Yre=class extends lN{build(){super.build(),q(this._element,Ure)}};const Gre=Yre;function il(t,e){uN(t,e),e.add(t)}function Gr(t,e,n){uN(t,e),e.set(t,n)}function uN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(t,e,n){var r=cN(t,e,"set");return zre(t,r,n),n}function zre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ge(t,e){var n=cN(t,e,"get");return jre(t,n)}function cN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jre(t,e){return e.get?e.get.call(t):e.value}function ol(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeColumnMove");de.getSingleton().register("afterColumnMove");const kC="manualColumnMove",Kre=120,a1="ht__manualColumnMove",Kf="show-ui",MS="on-moving--columns",AS="after-selection--columns";var Fn=new WeakMap,Xo=new WeakMap,go=new WeakMap,cf=new WeakMap,ns=new WeakMap,kn=new WeakMap,Ad=new WeakMap,Er=new WeakMap,wl=new WeakMap,Xf=new WeakMap,ac=new WeakMap,l1=new WeakSet,u1=new WeakSet,c1=new WeakSet,h1=new WeakSet,d1=new WeakSet,f1=new WeakSet;class Xre extends it{constructor(){super(...arguments),il(this,f1),il(this,d1),il(this,h1),il(this,c1),il(this,u1),il(this,l1),Gr(this,Fn,{writable:!0,value:new Bre(this.hot)}),Gr(this,Xo,{writable:!0,value:new Gre(this.hot)}),Gr(this,go,{writable:!0,value:[]}),Gr(this,cf,{writable:!0,value:0}),Gr(this,ns,{writable:!0,value:!1}),Gr(this,kn,{writable:!0,value:{}}),Gr(this,Ad,{writable:!0,value:void 0}),Gr(this,Er,{writable:!0,value:void 0}),Gr(this,wl,{writable:!0,value:void 0}),Gr(this,Xf,{writable:!0,value:void 0}),Gr(this,ac,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return kC}static get PLUGIN_PRIORITY(){return Kre}isEnabled(){return!!this.hot.getSettings()[kC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ol(e,l1,qre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ol(e,c1,Jre).call(e,...r)}),this.addHook("afterScrollVertically",()=>ol(this,d1,eie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ol(e,f1,tie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,a1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Le(this.hot.rootElement,a1),this.unregisterEvents(),ge(this,Fn).destroy(),ge(this,Xo).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=ge(this,Ad),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(rr(this,Ad,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return rr(this,Ad,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Yt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[kC];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return me(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ge(this,Er))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ge(this,Er)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ge(this,Fn).getOffset().start,u=ge(this,Fn).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,C=ft(this.hot.rootElement),S=p.innerWidth-ge(this,wl)-C;h=p.innerWidth-ge(this,kn).eventPageX-S-(r.scrollX===void 0?i:0)}else h=ge(this,kn).eventPageX-(ge(this,wl)-(r.scrollX===void 0?i:0));if(ge(this,Xf)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ge(this,Er))&&(o+=i),o+=c,ge(this,Er)<0)ge(this,ac)>0?ge(this,kn).col=0:ge(this,kn).col=e>0?e-1:e;else if(ge(this,kn).TD.offsetWidth/2+o<=h){const p=ge(this,Er)>=ge(this,cf)?ge(this,cf)-1:ge(this,Er);ge(this,kn).col=p+1,o+=ge(this,kn).TD.offsetWidth}else ge(this,kn).col=ge(this,Er);let d=h,g=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?g=s-1:g===0?g=1:r.scrollX!==void 0&&ge(this,Er)<ge(this,ac)&&(g-=ge(this,wl)<=r.scrollX?ge(this,wl):0),ge(this,Fn).setPosition(null,d),ge(this,Xo).setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ol(this,u1,Zre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ol(this,h1,Qre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ge(this,Fn).build(),ge(this,Xo).build()}destroy(){ge(this,Fn).destroy(),ge(this,Xo).destroy(),super.destroy()}}function qre(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ie(t.target,"sortAction");if(!s||!o||ge(this,ns)||t.button!==0||a){rr(this,ns,!1),ge(this,go).length=0,Le(this.hot.rootElement,[MS,Kf]);return}const l=ge(this,Xo).isBuilt()&&!ge(this,Xo).isAppended(),u=ge(this,Fn).isBuilt()&&!ge(this,Fn).isAppended();l&&u&&(ge(this,Xo).appendTo(i.hider),ge(this,Fn).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=g){r.column=!0,rr(this,ns,!0);const p=n.firstChild?NP(t,n.firstChild).x:t.offsetX;ge(this,kn).eventPageX=t.pageX,rr(this,Er,e.col),ge(this,kn).TD=n,ge(this,kn).col=e.col,rr(this,go,this.prepareColumnsToMoving(d,g)),rr(this,Xf,!!this.hot.getSettings().rowHeaders),rr(this,cf,this.hot.countCols()),rr(this,ac,this.hot.getSettings().fixedColumnsStart),rr(this,wl,en(this.hot.rootElement).left);const C=ge(this,Xf)?-1:0,S=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<ge(this,ac),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),N=this.getColumnsWidth(d,e.col-1)+T,I=this.getColumnsWidth(C,d-1)+(y?R:0)+N;ge(this,Fn).setPosition(S,I),ge(this,Fn).setSize(this.getColumnsWidth(d,g),i.hider.offsetHeight-S),ge(this,Fn).setOffset(null,-N),q(this.hot.rootElement,MS)}else Le(this.hot.rootElement,AS),rr(this,ns,!1),ge(this,go).length=0}function Zre(t){ge(this,ns)&&(ge(this,kn).eventPageX=t.pageX,this.refreshPositions())}function Jre(t,e,n,r){!this.hot.getSelectedRangeLast()||!ge(this,ns)||(ge(this,go).indexOf(e.col)>-1?Le(this.hot.rootElement,Kf):q(this.hot.rootElement,Kf),r.row=!0,r.column=!0,r.cell=!0,rr(this,Er,e.col),ge(this,kn).TD=n)}function Qre(){const t=ge(this,kn).col,e=ge(this,go).length;if(rr(this,Er,void 0),rr(this,ns,!1),Le(this.hot.rootElement,[MS,Kf,AS]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,AS),e<1||t===void 0)return;const n=ge(this,go)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(ge(this,go),t);if(ge(this,go).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function eie(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;ge(this,Fn).setPosition(r),ge(this,Fn).setSize(null,t.hider.offsetHeight-r)}function tie(){this.moveBySettingsOrLoad()}function Ji(t,e){hN(t,e),e.add(t)}function wn(t,e,n){hN(t,e),e.set(t,n)}function hN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ut(t,e,n){var r=dN(t,e,"set");return nie(t,r,n),n}function nie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ae(t,e){var n=dN(t,e,"get");return rie(t,n)}function dN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rie(t,e){return e.get?e.get.call(t):e.value}const qf="manualColumnResize",iie=130,g1="manualColumnWidths";var oo=new WeakMap,Od=new WeakMap,hr=new WeakMap,Zf=new WeakMap,Ii=new WeakMap,oie=new WeakMap,Ol=new WeakMap,Id=new WeakMap,Jn=new WeakMap,to=new WeakMap,ga=new WeakMap,Jf=new WeakMap,lc=new WeakMap,uc=new WeakMap,fr=new WeakMap,cc=new WeakMap,m1=new WeakSet,p1=new WeakSet,w1=new WeakSet,C1=new WeakSet,v1=new WeakSet,S1=new WeakSet,y1=new WeakSet,b1=new WeakSet,R1=new WeakSet;class sie extends it{static get PLUGIN_KEY(){return qf}static get PLUGIN_PRIORITY(){return iie}constructor(e){super(e),Ji(this,R1),Ji(this,b1),Ji(this,y1),Ji(this,S1),Ji(this,v1),Ji(this,C1),Ji(this,w1),Ji(this,p1),Ji(this,m1),wn(this,oo,{writable:!0,value:null}),wn(this,Od,{writable:!0,value:null}),wn(this,hr,{writable:!0,value:[]}),wn(this,Zf,{writable:!0,value:null}),wn(this,Ii,{writable:!0,value:null}),wn(this,oie,{writable:!0,value:null}),wn(this,Ol,{writable:!0,value:null}),wn(this,Id,{writable:!0,value:null}),wn(this,Jn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),wn(this,to,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),wn(this,ga,{writable:!0,value:null}),wn(this,Jf,{writable:!0,value:!1}),wn(this,lc,{writable:!0,value:0}),wn(this,uc,{writable:!0,value:null}),wn(this,fr,{writable:!0,value:void 0}),wn(this,cc,{writable:!0,value:void 0}),q(ae(this,Jn),"manualColumnResizer"),q(ae(this,to),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[qf]}enablePlugin(){this.enabled||(Ut(this,fr,new ys),ae(this,fr).addLocalHook("init",()=>Qi(this,m1,aie).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ae(this,fr)),this.addHook("modifyColWidth",(e,n)=>Qi(this,y1,fie).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Qi(this,b1,gie).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Qi(this,R1,mie).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ut(this,cc,ae(this,fr).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",g1,ae(this,fr).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",g1,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ae(this,fr).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ae(this,fr).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Ut(this,oo,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ae(this,oo)),i=r.col;if(i<0)return;const o=xt(ae(this,oo)),s=ae(this,oo).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(this,oo),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ae(this,oo),r.row,r.col)),Ut(this,Od,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Ut(this,hr,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();E(c,h=>{const d=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;me(d,g,p=>{ae(this,hr).includes(p)||ae(this,hr).push(p)})})}ae(this,hr).includes(ae(this,Od))||Ut(this,hr,[ae(this,Od)]),Ut(this,Id,l.start-6),Ut(this,Ol,parseInt(s.width,10)),ae(this,Jn).style.top=`${l.top}px`,ae(this,Jn).style[this.inlineDir]=`${ae(this,Id)+ae(this,Ol)}px`,ae(this,Jn).style.height=`${o}px`,this.hot.rootElement.appendChild(ae(this,Jn))}refreshHandlePosition(){ae(this,Jn).style[this.inlineDir]=`${ae(this,Id)+ae(this,Zf)}px`}setupGuidePosition(){const e=parseInt(xt(ae(this,Jn)),10),n=parseInt(ae(this,Jn).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);q(ae(this,Jn),"active"),q(ae(this,to),"active"),ae(this,to).style.top=`${n}px`,this.refreshGuidePosition(),ae(this,to).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ae(this,to))}refreshGuidePosition(){ae(this,to).style[this.inlineDir]=ae(this,Jn).style[this.inlineDir]}hideHandleAndGuide(){Le(ae(this,Jn),"active"),Le(ae(this,to),"active")}checkIfColumnHeader(e){const n=cs(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ae(this,Ii),r,!0);o!==void 0&&Ut(this,Ii,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,ae(this,Ii)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(this,Ii),r,!0),i&&e()};ae(this,lc)>=2&&(ae(this,hr).length>1?(E(ae(this,hr),i=>{n(i)}),e()):E(ae(this,hr),i=>{n(i,!0)})),Ut(this,lc,0),Ut(this,uc,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Qi(this,p1,lie).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Qi(this,w1,uie).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Qi(this,C1,cie).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Qi(this,v1,hie).call(this)),this.eventManager.addEventListener(ae(this,Jn),"contextmenu",()=>Qi(this,S1,die).call(this))}destroy(){super.destroy()}}function aie(){const t=this.hot.getSettings()[qf],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ae(this,fr).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ae(this,fr).setValueAtIndex(r,n)})},!0),Ut(this,cc,t)):t===!0&&Array.isArray(ae(this,cc))&&this.hot.batchExecution(()=>{ae(this,cc).forEach((n,r)=>{ae(this,fr).setValueAtIndex(r,n)})},!0)}function lie(t){if(!Iy(t.target)&&ae(this,Jf)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ae(this,ga)||this.setupHandlePosition(e))}}function uie(t){Ie(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ae(this,oo)),this.setupGuidePosition(),Ut(this,ga,!0),ae(this,uc)===null&&(Ut(this,uc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(this,uc))),Ut(this,lc,ae(this,lc)+1),this.startX=t.pageX,Ut(this,Ii,ae(this,Ol)))}function cie(t){if(ae(this,ga)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Ut(this,Zf,ae(this,Ol)+e),E(ae(this,hr),n=>{Ut(this,Ii,this.setManualSize(n,ae(this,Zf)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function hie(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ae(this,Ii),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(this,Ii),n,!1)};ae(this,ga)&&(this.hideHandleAndGuide(),Ut(this,ga,!1),ae(this,Ii)!==ae(this,Ol)&&(ae(this,hr).length>1?(E(ae(this,hr),r=>{e(r)}),t()):E(ae(this,hr),r=>{e(r,!0)})),this.setupHandlePosition(ae(this,oo)))}function die(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(this,Jn)),this.hot.rootElement.removeChild(ae(this,to)),Ut(this,ga,!1),Ut(this,Jf,!0),this.hot._registerImmediate(()=>{Ut(this,Jf,!1)})}function fie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ae(this,fr).getValueAtIndex(r);this.hot.getSettings()[qf]&&i&&(n=i)}return n}function gie(t,e){let n=ae(this,fr).getValueAtIndex(e);return n===null&&(n=t),n}function mie(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function FC(t,e,n){return e=pie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pie(t){var e=wie(t,"string");return typeof e=="symbol"?e:String(e)}function wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const WC=0,E1=1,T1=2,sl="px";let Cie=class{constructor(e){FC(this,"hot",void 0),FC(this,"_element",null),FC(this,"state",WC),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=T1}build(){this.state===WC&&(this._element=this.hot.rootDocument.createElement("div"),this.state=E1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=WC}isAppended(){return this.state===T1}isBuilt(){return this.state>=E1}setPosition(e,n){e!==void 0&&(this._element.style.top=e+sl),n!==void 0&&(this._element.style.left=n+sl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+sl),n&&(this._element.style.height=n+sl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+sl),n&&(this._element.style.marginLeft=n+sl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const fN=Cie,vie="ht__manualRowMove--backlight";class Sie extends fN{build(){super.build(),q(this._element,vie)}}const yie=Sie,bie="ht__manualRowMove--guideline";class Rie extends fN{build(){super.build(),q(this._element,bie)}}const Eie=Rie;function al(t,e){gN(t,e),e.add(t)}function ll(t,e,n){gN(t,e),e.set(t,n)}function gN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aa(t,e,n){var r=mN(t,e,"set");return Tie(t,r,n),n}function Tie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function $e(t,e){var n=mN(t,e,"get");return _ie(t,n)}function mN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _ie(t,e){return e.get?e.get.call(t):e.value}function ul(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeRowMove");de.getSingleton().register("afterRowMove");const VC="manualRowMove",Mie=140,_1="ht__manualRowMove",Qf="show-ui",OS="on-moving--rows",IS="after-selection--rows";var Wn=new WeakMap,qo=new WeakMap,mo=new WeakMap,rs=new WeakMap,ir=new WeakMap,Pd=new WeakMap,M1=new WeakSet,A1=new WeakSet,O1=new WeakSet,I1=new WeakSet,P1=new WeakSet,x1=new WeakSet;class pN extends it{constructor(){super(...arguments),al(this,x1),al(this,P1),al(this,I1),al(this,O1),al(this,A1),al(this,M1),ll(this,Wn,{writable:!0,value:new yie(this.hot)}),ll(this,qo,{writable:!0,value:new Eie(this.hot)}),ll(this,mo,{writable:!0,value:[]}),ll(this,rs,{writable:!0,value:void 0}),ll(this,ir,{writable:!0,value:{}}),ll(this,Pd,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return VC}static get PLUGIN_PRIORITY(){return Mie}isEnabled(){return!!this.hot.getSettings()[VC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ul(e,M1,Aie).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ul(e,O1,Iie).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>ul(this,P1,xie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ul(e,x1,Hie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,_1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Le(this.hot.rootElement,_1),this.unregisterEvents(),$e(this,Wn).destroy(),$e(this,qo).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=$e(this,Pd),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(aa(this,Pd,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return aa(this,Pd,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Yt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[VC];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return me(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=$e(this,ir).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=$e(this,ir).TD,a=this.hot.rootElement,l=en(a),u=ca(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,g=$e(this,ir).eventPageY-d+c,p=o.hider.offsetHeight,C=o.TBODY.offsetTop,S=$e(this,Wn).getOffset().top,y=$e(this,Wn).getSize().height,R=s.offsetHeight/2,T=s.offsetHeight;let N=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=g>=N+R;this.isFixedRowTop(e.row)&&(N+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?$e(this,ir).row=n>0?n-1:n:I?($e(this,ir).row=e.row+1,N+=e.row===0?T-1:T):$e(this,ir).row=e.row;let F=g,B=N;g+y+S>=p?F=p-y-S:g+S<C&&(F=C+Math.abs(S)),N>=p-1&&(B=p-1),$e(this,Wn).setPosition(F),$e(this,qo).setPosition(B)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>ul(this,A1,Oie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ul(this,I1,Pie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){$e(this,Wn).build(),$e(this,qo).build()}destroy(){$e(this,Wn).destroy(),$e(this,qo).destroy(),super.destroy()}}function Aie(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||$e(this,rs)||t.button!==0){aa(this,rs,!1),$e(this,mo).length=0,Le(this.hot.rootElement,[OS,Qf]);return}const l=$e(this,qo).isBuilt()&&!$e(this,qo).isAppended(),u=$e(this,Wn).isBuilt()&&!$e(this,Wn).isAppended();l&&u&&($e(this,qo).appendTo(i.hider),$e(this,Wn).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=g){r.row=!0,aa(this,rs,!0),$e(this,ir).eventPageY=t.pageY,$e(this,ir).coords=e,$e(this,ir).TD=n,aa(this,mo,this.prepareRowsToMoving());const p=i.holder.scrollLeft+o.getRowHeaderWidth(),C=this.getRowsHeight(d,e.row-1)+t.offsetY;$e(this,Wn).setPosition(null,p),$e(this,Wn).setSize(i.hider.offsetWidth-p,this.getRowsHeight(d,g)),$e(this,Wn).setOffset(-C,null),q(this.hot.rootElement,OS),this.refreshPositions()}else Le(this.hot.rootElement,IS),aa(this,rs,!1),$e(this,mo).length=0}function Oie(t){$e(this,rs)&&($e(this,ir).eventPageY=t.pageY,this.refreshPositions())}function Iie(t,e,n,r){!this.hot.getSelectedRangeLast()||!$e(this,rs)||($e(this,mo).indexOf(e.row)>-1?Le(this.hot.rootElement,Qf):q(this.hot.rootElement,Qf),r.row=!0,r.column=!0,r.cell=!0,$e(this,ir).coords=e,$e(this,ir).TD=n)}function Pie(){const t=$e(this,ir).row,e=$e(this,mo).length;if(aa(this,rs,!1),Le(this.hot.rootElement,[OS,Qf,IS]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,IS),e<1||t===void 0)return;const n=$e(this,mo)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows($e(this,mo),t);if($e(this,mo).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function xie(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;$e(this,Wn).setPosition(null,r),$e(this,Wn).setSize(t.hider.offsetWidth-r)}function Hie(){this.moveBySettingsOrLoad()}function Ks(t,e){wN(t,e),e.add(t)}function Cn(t,e,n){wN(t,e),e.set(t,n)}function wN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function $t(t,e,n){var r=CN(t,e,"set");return Die(t,r,n),n}function Die(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function se(t,e){var n=CN(t,e,"get");return Nie(t,n)}function CN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Nie(t,e){return e.get?e.get.call(t):e.value}const eg="manualRowResize",Lie=30,H1="manualRowHeights";var Ti=new WeakMap,xd=new WeakMap,dr=new WeakMap,tg=new WeakMap,Zo=new WeakMap,sR=new WeakMap,Il=new WeakMap,Hd=new WeakMap,Ln=new WeakMap,Ri=new WeakMap,ma=new WeakMap,ng=new WeakMap,hc=new WeakMap,dc=new WeakMap,Zr=new WeakMap,fc=new WeakMap,D1=new WeakSet,N1=new WeakSet,L1=new WeakSet,$1=new WeakSet,k1=new WeakSet,F1=new WeakSet,W1=new WeakSet;class $ie extends it{static get PLUGIN_KEY(){return eg}static get PLUGIN_PRIORITY(){return Lie}constructor(e){super(e),Ks(this,W1),Ks(this,F1),Ks(this,k1),Ks(this,$1),Ks(this,L1),Ks(this,N1),Ks(this,D1),Cn(this,Ti,{writable:!0,value:null}),Cn(this,xd,{writable:!0,value:null}),Cn(this,dr,{writable:!0,value:[]}),Cn(this,tg,{writable:!0,value:null}),Cn(this,Zo,{writable:!0,value:null}),Cn(this,sR,{writable:!0,value:null}),Cn(this,Il,{writable:!0,value:null}),Cn(this,Hd,{writable:!0,value:null}),Cn(this,Ln,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Cn(this,Ri,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),Cn(this,ma,{writable:!0,value:!1}),Cn(this,ng,{writable:!0,value:!1}),Cn(this,hc,{writable:!0,value:0}),Cn(this,dc,{writable:!0,value:null}),Cn(this,Zr,{writable:!0,value:void 0}),Cn(this,fc,{writable:!0,value:void 0}),q(se(this,Ln),"manualRowResizer"),q(se(this,Ri),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[eg]}enablePlugin(){this.enabled||($t(this,Zr,new ys),se(this,Zr).addLocalHook("init",()=>Xs(this,W1,Yie).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,se(this,Zr)),this.addHook("modifyRowHeight",(e,n)=>Xs(this,F1,Uie).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){$t(this,fc,se(this,Zr).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",H1,se(this,Zr).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",H1,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,Vg.DEFAULT_HEIGHT);return se(this,Zr).setValueAtIndex(r,i),i}setupHandlePosition(e){$t(this,Ti,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(se(this,Ti)),o=i.row;if(o<0)return;const s=ft(se(this,Ti)),a=se(this,Ti).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(this,Ti),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(se(this,Ti),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(se(this,Ti),i.row,i.col)),$t(this,xd,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),$t(this,dr,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();E(d,g=>{const p=g.getTopStartCorner().row,C=g.getBottomStartCorner().row;me(p,C,S=>{se(this,dr).includes(S)||se(this,dr).push(S)})})}se(this,dr).includes(se(this,xd))||$t(this,dr,[se(this,xd)]),$t(this,Hd,c.top-6),$t(this,Il,parseInt(a.height,10)),se(this,Ln).style.top=`${se(this,Hd)+se(this,Il)}px`,se(this,Ln).style[this.inlineDir]=`${c.start}px`,se(this,Ln).style.width=`${s}px`,this.hot.rootElement.appendChild(se(this,Ln))}refreshHandlePosition(){se(this,Ln).style.top=`${se(this,Hd)+se(this,tg)}px`}setupGuidePosition(){const e=parseInt(ft(se(this,Ln)),10),n=parseInt(se(this,Ln).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);q(se(this,Ln),"active"),q(se(this,Ri),"active"),se(this,Ri).style.top=se(this,Ln).style.top,se(this,Ri).style[this.inlineDir]=`${n}px`,se(this,Ri).style.width=`${r-e}px`,this.hot.rootElement.appendChild(se(this,Ri))}refreshGuidePosition(){se(this,Ri).style.top=se(this,Ln).style.top}hideHandleAndGuide(){Le(se(this,Ln),"active"),Le(se(this,Ri),"active")}checkIfRowHeader(e){const n=cs(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&se(this,Zo)<n?n:se(this,Zo)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&$t(this,Zo,o),this.setManualSize(r,se(this,Zo)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};se(this,hc)>=2&&(se(this,dr).length>1?(E(se(this,dr),i=>{n(i)}),e()):E(se(this,dr),i=>{n(i,!0)})),$t(this,hc,0),$t(this,dc,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Xs(this,D1,kie).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Xs(this,N1,Fie).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Xs(this,L1,Wie).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Xs(this,$1,Vie).call(this)),this.eventManager.addEventListener(se(this,Ln),"contextmenu",()=>Xs(this,k1,Bie).call(this))}destroy(){super.destroy()}}function kie(t){if(!Iy(t.target)&&se(this,ng)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(se(this,ma)||this.setupHandlePosition(e))}}function Fie(t){Ie(t.target,"manualRowResizer")&&(this.setupHandlePosition(se(this,Ti)),this.setupGuidePosition(),$t(this,ma,!0),se(this,dc)===null&&($t(this,dc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(this,dc))),$t(this,hc,se(this,hc)+1),$t(this,sR,t.pageY),$t(this,Zo,se(this,Il)))}function Wie(t){se(this,ma)&&($t(this,tg,se(this,Il)+(t.pageY-se(this,sR))),E(se(this,dr),e=>{$t(this,Zo,this.setManualSize(e,se(this,tg)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Vie(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};se(this,ma)&&(this.hideHandleAndGuide(),$t(this,ma,!1),se(this,Zo)!==se(this,Il)&&(se(this,dr).length>1?(E(se(this,dr),r=>{e(r)}),t()):E(se(this,dr),r=>{e(r,!0)})),this.setupHandlePosition(se(this,Ti)))}function Bie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(this,Ln)),this.hot.rootElement.removeChild(se(this,Ri)),$t(this,ma,!1),$t(this,ng,!0),this.hot._registerImmediate(()=>{$t(this,ng,!1)})}function Uie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=se(this,Zr).getValueAtIndex(r);this.hot.getSettings()[eg]&&i&&(n=i)}return n}function Yie(){const t=this.hot.getSettings()[eg],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{se(this,Zr).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{se(this,Zr).setValueAtIndex(r,n)}),$t(this,fc,t)):t===!0&&Array.isArray(se(this,fc))&&se(this,fc).forEach((n,r)=>{se(this,Zr).setValueAtIndex(r,n)})},!0)}function qs(t,e,n){return e=Gie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gie(t){var e=zie(t,"string");return typeof e=="symbol"?e:String(e)}function zie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jie{constructor(e,n,r,i,o,s){qs(this,"row",void 0),qs(this,"col",void 0),qs(this,"rowspan",void 0),qs(this,"colspan",void 0),qs(this,"removed",!1),qs(this,"cellCoordsFactory",void 0),qs(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ht`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ht`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const _i=jie;function PS(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function BC(t,e,n){return e=Kie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kie(t){var e=Xie(t,"string");return typeof e=="symbol"?e:String(e)}function Xie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aR{constructor(e){BC(this,"plugin",void 0),BC(this,"mergedCells",[]),BC(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return E(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return E(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return E(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new _i(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(gt(aR.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];E(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,E(n,(i,o)=>{me(0,i.rowspan-1,s=>{me(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),E(n,i=>{PS(...i)}),E(r,i=>{PS(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return E(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}E(this.mergedCells,o=>{o.shift(i,n)}),If(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const qie=aR;function UC(t,e,n){return e=Zie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zie(t){var e=Jie(t,"string");return typeof e=="symbol"?e:String(e)}function Jie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qie{constructor(e){UC(this,"plugin",void 0),UC(this,"mergedCellsCollection",void 0),UC(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,g=Math.floor(s/d)*d,p=s-g,C=this.getFarthestCollection(e,n,r,i);if(C){if(r==="down"){const S=C.row+C.rowspan-a-p;o[2]+S>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?S:0}else if(r==="right"){const S=C.col+C.colspan-l-p;o[3]+S>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?S:0}else if(r==="up"){const S=u-p-C.row+1;o[0]+S<0?o[0]+=p:o[0]-=p?S:0}else if(r==="left"){const S=c-p-C.col+1;o[1]+S<0?o[1]+=p:o[1]-=p?S:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),jt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),g=u?a-o+1:l-s+1,p=Math.floor(d/g)*g,C=d-p;let S=null,y=null,R=null;switch(r){case"up":S="includesVertically",R=c-C+1;break;case"left":S="includesHorizontally",R=c-C+1;break;case"down":S="includesVertically",R=h+C-1;break;case"right":S="includesHorizontally",R=h+C-1;break}return E(i,T=>{T[S](R)&&T.isFarther(y,r)&&(y=T)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return E(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const eoe=Qie;function YC(t,e,n){return e=toe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function toe(t){var e=noe(t,"string");return typeof e=="symbol"?e:String(e)}function noe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class roe{constructor(e){YC(this,"plugin",void 0),YC(this,"hot",void 0),YC(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const ioe=roe;function ooe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(am)}return this.getTranslatedPhrase(sm)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?_i.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Dt(t,e){vN(t,e),e.add(t)}function soe(t,e,n){vN(t,e),e.set(t,n)}function vN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GC(t,e,n){return e=aoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aoe(t){var e=loe(t,"string");return typeof e=="symbol"?e:String(e)}function loe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zC(t,e,n){var r=SN(t,e,"set");return uoe(t,r,n),n}function uoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function cl(t,e){var n=SN(t,e,"get");return coe(t,n)}function SN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function coe(t,e){return e.get?e.get.call(t):e.value}function At(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeMergeCells");de.getSingleton().register("afterMergeCells");de.getSingleton().register("beforeUnmergeCells");de.getSingleton().register("afterUnmergeCells");const gc="mergeCells",hoe=150,V1=gc;var Ei=new WeakMap,B1=new WeakSet,U1=new WeakSet,Y1=new WeakSet,G1=new WeakSet,z1=new WeakSet,j1=new WeakSet,K1=new WeakSet,jC=new WeakSet,X1=new WeakSet,q1=new WeakSet,Z1=new WeakSet,J1=new WeakSet,Q1=new WeakSet,eA=new WeakSet,tA=new WeakSet,nA=new WeakSet,rA=new WeakSet,iA=new WeakSet,oA=new WeakSet,sA=new WeakSet,aA=new WeakSet,lA=new WeakSet,uA=new WeakSet;class doe extends it{constructor(){super(...arguments),Dt(this,uA),Dt(this,lA),Dt(this,aA),Dt(this,sA),Dt(this,oA),Dt(this,iA),Dt(this,rA),Dt(this,nA),Dt(this,tA),Dt(this,eA),Dt(this,Q1),Dt(this,J1),Dt(this,Z1),Dt(this,q1),Dt(this,X1),Dt(this,jC),Dt(this,K1),Dt(this,j1),Dt(this,z1),Dt(this,G1),Dt(this,Y1),Dt(this,U1),Dt(this,B1),GC(this,"mergedCellsCollection",null),GC(this,"autofillCalculations",null),GC(this,"selectionCalculations",null),soe(this,Ei,{writable:!0,value:null})}static get PLUGIN_KEY(){return gc}static get PLUGIN_PRIORITY(){return hoe}isEnabled(){return!!this.hot.getSettings()[gc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new qie(this),this.autofillCalculations=new eoe(this),this.selectionCalculations=new ioe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,B1,foe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Y1,moe).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,sA,Poe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,G1,poe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,z1,woe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,jC,cA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,jC,cA).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,X1,Soe).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,U1,goe).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,K1,voe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,j1,Coe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,q1,yoe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Z1,boe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,J1,Roe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Q1,Eoe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,eA,Toe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,tA,_oe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,nA,Moe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,rA,Aoe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,iA,Ooe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,oA,Ioe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,aA,xoe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,lA,Hoe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,uA,Doe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[gc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!Ny())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Pl(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Pl(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(_i.containsNegativeValues(e)?(gt(_i.NEGATIVE_VALUES_WARNING(e)),n=!1):_i.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(gt(_i.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):_i.isSingleCell(e)?(gt(_i.IS_SINGLE_CELL(e)),n=!1):_i.containsZeroSpan(e)&&(gt(_i.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(E(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),me(r.row,r.row+r.rowspan-1,a=>{me(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),me(0,s.rowspan-1,c=>{me(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),E(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),me(0,i.rowspan-1,o=>{me(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:V1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(V1)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Be(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Be(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Be(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Be(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function foe(){this.generateFromSettings(this.hot.getSettings()[gc]),this.hot.render()}function goe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function moe(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(cl(this,Ei)||zC(this,Ei,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(cl(this,Ei))||zC(this,Ei,this.hot._createCellCoords(null,null)),n.row=cl(this,Ei).row?cl(this,Ei).row-i.row:n.row,n.col=cl(this,Ei).col?cl(this,Ei).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);zC(this,Ei,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function poe(t){const e=this.hot.getSelectedRangeLast(),n=Bn(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Bn(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Bn(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),E(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function woe(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function Coe(t){t.items.push({name:"---------"},ooe(this))}function voe(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Be(r)?Bn(r):void 0;if(Be(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,d]=this.translateMergedCellToRenderable(a,c,l,u),g=o.getRenderableFromVisualIndex(e),p=s.getRenderableFromVisualIndex(n),C=h-g+1,S=d-p+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,C),i.colspan=Math.min(i.colspan,S)}PS(t,i,e,n)}function cA(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function Soe(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function yoe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function boe(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Roe(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Eoe(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function Toe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function _oe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Moe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Aoe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Ooe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Ioe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);E(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Poe(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function xoe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Hoe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Doe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function Noe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,p=(d.compareFunctionFactory?d.compareFunctionFactory:BH(u.type))(l,u,d)(c,h);if(p===Hi){const C=a+1;if(typeof e[C]<"u")return s(C)}return p}(0)}}function hA(){gt(ht`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const yN="sort";function Loe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${yN}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function $oe(t){const e=t.className.split(" "),n=new RegExp(`^${yN}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function koe(t,e,n){return e=Foe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Foe(t){var e=Woe(t,"string");return typeof e=="symbol"?e:String(e)}function Woe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rg="multiColumnSorting",Voe=170,dA="columnSorting",fA=rg;VH(rg,Noe);class bN extends UH{constructor(){super(...arguments),koe(this,"pluginKey",rg)}static get PLUGIN_KEY(){return rg}static get PLUGIN_PRIORITY(){return Voe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[dA]&&hA(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Vf))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:fA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Le(e,$oe(e)),this.enabled!==!1&&q(e,Loe(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[dA]&&hA(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){Kb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Vf))):this.sort(this.getColumnNextConfig(n.col)))}}function gA(t,e,n){return e=Boe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Boe(t){var e=Uoe(t,"string");return typeof e=="symbol"?e:String(e)}function Uoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Yoe="multipleSelectionHandles",Goe=160;class zoe extends it{constructor(){super(...arguments),gA(this,"dragged",[]),gA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Yoe}static get PLUGIN_PRIORITY(){return Goe}isEnabled(){return uo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Ie(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Ie(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Ie(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ie(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function xS(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function RN(){return{label:"",isPlaceholder:!0}}function joe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;E(t,i=>{const o=[];let s=0;n.push(o),E(i,a=>{const l=xS();if(Be(a)){const{label:c,colspan:h}=a;l.label=Wt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Wt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(RN());return!u})});const r=Math.max(...Ye(n,i=>i.length));return E(n,i=>{if(i.length<r){const o=Ye(new Array(r-i.length),()=>xS());i.splice(i.length,0,...o)}}),n}function KC(t,e,n){Koe(t,e),e.set(t,n)}function Koe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zr(t,e){var n=EN(t,e,"get");return Xoe(t,n)}function Xoe(t,e){return e.get?e.get.call(t):e.value}function ku(t,e,n){var r=EN(t,e,"set");return qoe(t,r,n),n}function EN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const mA=["label","collapsible"];var eo=new WeakMap,Zs=new WeakMap,XC=new WeakMap;class Zoe{constructor(){KC(this,eo,{writable:!0,value:[]}),KC(this,Zs,{writable:!0,value:0}),KC(this,XC,{writable:!0,value:1/0})}setColumnsLimit(e){ku(this,XC,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ku(this,eo,joe(e,zr(this,XC))),ku(this,Zs,zr(this,eo).length)}getData(){return zr(this,eo)}mergeWith(e){E(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&jt(s,o,mA)})}map(e){E(zr(this,eo),n=>{E(n,r=>{const i=e({...r});Be(i)&&jt(r,i,mA)})})}getHeaderSettings(e,n){var r;if(e>=zr(this,Zs)||e<0)return null;const i=zr(this,eo)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=zr(this,Zs)||e<0)return i;const o=zr(this,eo)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return zr(this,Zs)}getColumnsCount(){return zr(this,Zs)>0?zr(this,eo)[0].length:0}clear(){ku(this,eo,[]),ku(this,Zs,0)}}function qC(t,e,n){return e=Joe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Joe(t){var e=Qoe(t,"string");return typeof e=="symbol"?e:String(e)}function Qoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const TN="DF-pre-order";function _N(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=_N.call(this.childs[r],t,e)}return n}const ese="DF-post-order";function MN(t,e){for(let n=0;n<this.childs.length;n++)if(MN.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const AN="BF";function tse(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const nse=AN,pA=new Map([[TN,_N],[ese,MN],[AN,tse]]);class ig{constructor(e){qC(this,"data",{}),qC(this,"parent",null),qC(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new ig({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:nse;if(!pA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);pA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function ZC(t,e,n){rse(t,e),e.set(t,n)}function rse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nn(t,e){var n=ON(t,e,"get");return ise(t,n)}function ise(t,e){return e.get?e.get.call(t):e.value}function ose(t,e,n){var r=ON(t,e,"set");return sse(t,r,n),n}function ON(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function sse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var hl=new WeakMap,Js=new WeakMap,dl=new WeakMap;class ase{constructor(e){ZC(this,hl,{writable:!0,value:new Map}),ZC(this,Js,{writable:!0,value:new Map}),ZC(this,dl,{writable:!0,value:null}),ose(this,dl,e)}getRoots(){return Array.from(Nn(this,hl).values())}getRootByColumn(e){let n;return Nn(this,Js).has(e)&&(n=Nn(this,hl).get(Nn(this,Js).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Nn(this,Js).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Nn(this,Js).clear(),E(Nn(this,hl),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Nn(this,Js).set(i,e);e+=r})}buildTree(){this.clear();const e=Nn(this,dl).getColumnsCount();let n=0;for(;n<e;){const r=Nn(this,dl).getHeaderSettings(0,n),i=new ig;Nn(this,hl).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Nn(this,dl).getHeadersSettings(r,n,i);r+=1,E(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new ig(a),e.addChild(l)),r<Nn(this,dl).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Nn(this,hl).clear(),Nn(this,Js).clear()}}function IN(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function og(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function sg(t){return og(t,"origColspan")===t.data.origColspan}function lR(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sg(t))return lR(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)E(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,IN(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):sg(a)&&(l.isCollapsed=og(a,"isCollapsed"))}),{rollbackModification:()=>uR(t),affectedColumns:Array.from(o),colspanCompensation:s}}function uR(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sg(t))return uR(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)E(o,l=>{IN(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=og(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):sg(l)&&(u.isCollapsed=og(l,"isCollapsed"))}),{rollbackModification:()=>lR(t),affectedColumns:Array.from(s),colspanCompensation:a}}function lse(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function use(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const wA=new Map([["collapse",uR],["expand",lR],["hide-column",lse],["show-column",use]]);function cse(t,e,n){if(!wA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return wA.get(t)(e,n)}function Dd(t){const e=[];return E(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=dse(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(RN());else{const g=hse(i);g.isRoot=!0,u.push(g),c=!0}})}),e}function hse(t){const{crossHiddenColumns:e,...n}=xS(t);return n}function dse(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function JC(t,e,n){fse(t,e),e.set(t,n)}function fse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fu(t,e,n){var r=PN(t,e,"set");return gse(t,r,n),n}function gse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Nt(t,e){var n=PN(t,e,"get");return mse(t,n)}function PN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mse(t,e){return e.get?e.get.call(t):e.value}var yi=new WeakMap,Xn=new WeakMap,Qs=new WeakMap;class pse{constructor(){JC(this,yi,{writable:!0,value:new Zoe}),JC(this,Xn,{writable:!0,value:new ase(Nt(this,yi))}),JC(this,Qs,{writable:!0,value:[[]]})}setState(e){Nt(this,yi).setData(e);let n=!1;try{Nt(this,Xn).buildTree()}catch{Nt(this,Xn).clear(),Nt(this,yi).clear(),n=!0}return Fu(this,Qs,Dd(Nt(this,Xn).getRoots())),n}setColumnsLimit(e){Nt(this,yi).setColumnsLimit(e)}mergeStateWith(e){const n=Ye(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Nt(this,yi).mergeWith(n),Nt(this,Xn).buildTree(),Fu(this,Qs,Dd(Nt(this,Xn).getRoots()))}mapState(e){Nt(this,yi).map(e),Nt(this,Xn).buildTree(),Fu(this,Qs,Dd(Nt(this,Xn).getRoots()))}mapNodes(e){return Yt(Nt(this,Xn).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Nt(this,Xn).getNode(n,r);let o;return i&&(o=cse(e,i,r),Fu(this,Qs,Dd(Nt(this,Xn).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Nt(this,Qs)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Nt(this,Xn).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Nt(this,Xn).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:g}=u.data;g||d<=i&&c>=e&&c+d-1<=r&&(s===null||h<s)&&(s=h)},TN)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Nt(this,yi).getLayersCount()}getColumnsCount(){return Nt(this,yi).getColumnsCount()}clear(){Fu(this,Qs,[]),Nt(this,yi).clear(),Nt(this,Xn).clear()}}function Wu(t,e,n){return e=wse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wse(t){var e=Cse(t,"string");return typeof e=="symbol"?e:String(e)}function Cse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vse{constructor(e,n){Wu(this,"hot",void 0),Wu(this,"nestedHeaderSettingsGetter",void 0),Wu(this,"layersCount",0),Wu(this,"container",void 0),Wu(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let p=g.label;s&&(p+='<button class="changeType"></button>'),Sa(d,p),d.colSpan=g.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const Sse=vse;function ln(t,e){xN(t,e),e.add(t)}function CA(t,e,n){return e=yse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yse(t){var e=bse(t,"string");return typeof e=="symbol"?e:String(e)}function bse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nd(t,e,n){xN(t,e),e.set(t,n)}function xN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function la(t,e,n){var r=HN(t,e,"set");return Rse(t,r,n),n}function Rse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tt(t,e){var n=HN(t,e,"get");return Ese(t,n)}function HN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ese(t,e){return e.get?e.get.call(t):e.value}function Xt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const vA="nestedHeaders",Tse=280;var dt=new WeakMap,Bo=new WeakMap,mc=new WeakMap,bp=new WeakMap,Ld=new WeakSet,SA=new WeakSet,yA=new WeakSet,bA=new WeakSet,RA=new WeakSet,EA=new WeakSet,TA=new WeakSet,_A=new WeakSet,MA=new WeakSet,AA=new WeakSet,OA=new WeakSet,IA=new WeakSet,PA=new WeakSet,xA=new WeakSet,HA=new WeakSet,DA=new WeakSet,NA=new WeakSet,LA=new WeakSet;class _se extends it{constructor(){super(...arguments),ln(this,LA),ln(this,NA),ln(this,DA),ln(this,HA),ln(this,xA),ln(this,PA),ln(this,IA),ln(this,OA),ln(this,AA),ln(this,MA),ln(this,_A),ln(this,TA),ln(this,EA),ln(this,RA),ln(this,bA),ln(this,yA),ln(this,SA),ln(this,Ld),Nd(this,dt,{writable:!0,value:new pse}),Nd(this,Bo,{writable:!0,value:null}),Nd(this,mc,{writable:!0,value:null}),Nd(this,bp,{writable:!0,value:!1}),CA(this,"ghostTable",new Sse(this.hot,(e,n)=>this.getHeaderSettings(e,n))),CA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return vA}static get PLUGIN_PRIORITY(){return Tse}isEnabled(){return!!this.hot.getSettings()[vA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&gt(ht`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Xt(this,NA,Bse).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,LA,Use).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,RA,Ise).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,EA,Pse).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,TA,xse).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,_A,Hse).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,MA,Dse).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,AA,Nse).call(e,...i)}),this.addHook("afterSelection",()=>Xt(this,Ld,QC).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,SA,Mse).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Xt(this,IA,$se).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,xA,Fse).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,HA,Wse).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,yA,Ase).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,bA,Ose).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,OA,Lse).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,PA,kse).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,DA,Vse).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Xt(this,Ld,QC).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Xt(this,Ld,QC).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();tt(this,dt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=tt(this,dt).setState(e)),this.detectedOverlappedHeaders&&gt(ht`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";tt(this,dt).triggerColumnModification(i,r)}),!tt(this,Bo)&&this.enabled&&la(this,Bo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";tt(this,dt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),tt(this,dt).clear(),tt(this,Bo).unsubscribe(),la(this,Bo,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return tt(this,dt)}getLayersCount(){return tt(this,dt).getLayersCount()}getHeaderSettings(e,n){return tt(this,dt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),Le(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Le(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Le(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),Le(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d}=(s=tt(this,dt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(d||h)q(o,"hiddenHeader");else if(c>1){var g,p;const{wtOverlays:C}=l._wt,S=(g=C.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),y=(p=C.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),R=S||y?Math.min(c,r-i):c;R>1&&o.setAttribute("colspan",R)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=tt(this,dt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){la(this,dt,null),tt(this,Bo)!==null&&(tt(this,Bo).unsubscribe(),la(this,Bo,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return tt(this,dt).getHeaderTreeNodeData(e.row,e.col)}}function QC(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=tt(this,dt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Mse(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=tt(this,dt).findLeftMostColumnIndex(n.row,n.col),a=tt(this,dt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function Ase(t,e,n){const r=tt(this,dt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=tt(this,dt).getHeaderSettings(e,t);if(o===tb){if(!a)return r.columnIndex}else if(o===px&&(l>s-i||!a))return null;return t}function Ose(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let g=s;g<=l;g++){var i;const p=c+g,C=d-a;if(C===0)continue;((i=tt(this,dt).getHeaderTreeNodeData(g,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[p][C]="")}}}function Ise(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Pse(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;la(this,mc,e.clone()),la(this,bp,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(kg(t)||fs(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function xse(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=or(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Hse(){la(this,bp,!1)}function Dse(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!tt(this,bp)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=tt(this,dt).getHeaderTreeNodeData(tt(this,mc).row,tt(this,mc).col);if(e.setHighlight(tt(this,mc)),o>e.getWidth()||i<n||i+o-1>r){const s=tt(this,dt).findTopMostEntireHeaderLevel(or(n,i,i+o-1),or(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Nse(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=tt(this,dt).findLeftMostColumnIndex(n.row,n.col),o=tt(this,dt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Lse(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function $se(t){t.length=0;for(let e=0;e<tt(this,dt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function kse(t){const e=tt(this,dt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=tt(this,dt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Vn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?tt(this,dt).getHeaderTreeNodeData(0,n).columnIndex:n}function Fse(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Wse(t,e,n){var r;const{label:i}=(r=tt(this,dt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Vse(t,e){if(t<0)return this.hot.getCell(t,tt(this,dt).findLeftMostColumnIndex(t,e),!0)}function Bse(){this.updatePlugin()}function Use(t,e){e||this.updatePlugin()}function Vu(t,e,n){return e=Yse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yse(t){var e=Gse(t,"string");return typeof e=="symbol"?e:String(e)}function Gse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zse{constructor(e,n){Vu(this,"hot",void 0),Vu(this,"data",null),Vu(this,"plugin",void 0),Vu(this,"parentReference",new WeakMap),Vu(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&E(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&E(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ge(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(E(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(me(e[0],e[2],d=>{const g=this.translateTrimmedRow(d);i.push(this.getDataObject(g))}),me(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];E(r,o=>{i.push(this.getDataObject(o))}),E(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const jse=zse;function $A(t,e,n){return e=Kse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kse(t){var e=Xse(t,"string");return typeof e=="symbol"?e:String(e)}function Xse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qse{constructor(e,n){$A(this,"hot",void 0),$A(this,"plugin",void 0),this.hot=n,this.plugin=e}}const cR=qse;class so extends cR{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(E(l,c=>{c&&s.removeChild(c)}),q(n,so.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",me(0,i-1,()=>{const d=c.createElement("SPAN");q(d,so.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Ee(c,[Eo()]),q(n,so.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(q(c,`${so.CSS_CLASSES.button} ${so.CSS_CLASSES.expandButton}`),u&&Ee(n,[Ir(!1)])):(q(c,`${so.CSS_CLASSES.button} ${so.CSS_CLASSES.collapseButton}`),u&&Ee(n,[Ir(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const DN=so;class Zse extends cR{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),E(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{me(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&E(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];E(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return E(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);E(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return E(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);E(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&E(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];E(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];E(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];E(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{E(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{E(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&E(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Ie(e.target,DN.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Lr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Jse=Zse;function Qse(t,e,n){eae(t,e),e.set(t,n)}function eae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tae(t,e,n){return e=nae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nae(t){var e=rae(t,"string");return typeof e=="symbol"?e:String(e)}function rae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iae(t,e){var n=oae(t,e,"get");return sae(t,n)}function oae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function sae(t,e){return e.get?e.get.call(t):e.value}var kA=new WeakMap;class aae extends cR{constructor(){super(...arguments),tae(this,"dataManager",this.plugin.dataManager),Qse(this,kA,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(_m)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Mm)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,r=>{if(r===0)return E(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return me(0,e.items.length-1,n=>{const r=iae(this,kA)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const lae=aae;function $d(t,e,n){return e=uae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uae(t){var e=cae(t,"string");return typeof e=="symbol"?e:String(e)}function cae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hae{constructor(e){$d(this,"plugin",void 0),$d(this,"hot",void 0),$d(this,"dataManager",void 0),$d(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(p=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(C,a),C}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),g=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return vt(i)&&(gt(ht`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function vn(t,e){NN(t,e),e.add(t)}function FA(t,e,n){NN(t,e),e.set(t,n)}function NN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ev(t,e,n){return e=dae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dae(t){var e=fae(t,"string");return typeof e=="symbol"?e:String(e)}function fae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hf(t,e){var n=LN(t,e,"get");return gae(t,n)}function gae(t,e){return e.get?e.get.call(t):e.value}function ag(t,e,n){var r=LN(t,e,"set");return mae(t,r,n),n}function LN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mae(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function fn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lg="nestedRows",pae=300,WA=lg,wae="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Rp=new WeakMap,fl=new WeakMap,VA=new WeakSet,BA=new WeakSet,UA=new WeakSet,YA=new WeakSet,GA=new WeakSet,zA=new WeakSet,jA=new WeakSet,KA=new WeakSet,XA=new WeakSet,qA=new WeakSet,ZA=new WeakSet,JA=new WeakSet,QA=new WeakSet,eO=new WeakSet,tO=new WeakSet,tv=new WeakSet;class Cae extends it{constructor(){super(...arguments),vn(this,tv),vn(this,tO),vn(this,eO),vn(this,QA),vn(this,JA),vn(this,ZA),vn(this,qA),vn(this,XA),vn(this,KA),vn(this,jA),vn(this,zA),vn(this,GA),vn(this,YA),vn(this,UA),vn(this,BA),vn(this,VA),ev(this,"dataManager",null),ev(this,"headersUI",null),ev(this,"collapsedRowsMap",null),FA(this,Rp,{writable:!0,value:!1}),FA(this,fl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return lg}static get PLUGIN_PRIORITY(){return pae}isEnabled(){return!!this.hot.getSettings()[lg]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Zc),this.dataManager=new jse(this,this.hot),this.collapsingUI=new Jse(this,this.hot),this.headersUI=new DN(this,this.hot),this.contextMenuUI=new lae(this,this.hot),this.rowMoveController=new hae(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,eO,xae).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,tO,Hae).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,UA,yae).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,YA,bae).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,GA,Rae).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,BA,Sae).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,KA,_ae).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,jA,Tae).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,XA,Mae).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,qA,Aae).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,ZA,Oae).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,JA,Iae).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,zA,Eae).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,QA,Pae).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,VA,vae).call(e,...r)}),this.addHook("beforeLoadData",n=>fn(this,tv,nO).call(this,n)),this.addHook("beforeUpdateData",n=>fn(this,tv,nO).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:WA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(WA)}disableCoreAPIModifiers(){ag(this,fl,!0)}enableCoreAPIModifiers(){ag(this,fl,!1)}onModifyRowData(e){if(!hf(this,fl))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!hf(this,fl))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return hf(this,fl)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function vae(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Sae(t,e,n){this.collapsingUI.toggleState(t,e,n)}function yae(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),ag(this,Rp,!0),this.dataManager.getData().slice()}function bae(t){return this.contextMenuUI.appendOptions(t)}function Rae(t,e){this.headersUI.appendLevelIndicators(t,e)}function Eae(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function Tae(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{ag(this,Rp,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _ae(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Mae(){this.collapsingUI.collapsedRowsStash.stash()}function Aae(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Oae(){this.collapsingUI.collapsedRowsStash.stash()}function Iae(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Pae(){this.dataManager.rewriteCache()}function xae(){this.headersUI.updateRowHeaderWidth()}function Hae(t,e){hf(this,Rp)&&(e.skipRender=!0)}function nO(t){if(!Ox(t)){Wy(wae),this.hot.getSettings()[lg]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function nv(t,e,n){return e=Dae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dae(t){var e=Nae(t,"string");return typeof e=="symbol"?e:String(e)}function Nae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lae{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;nv(this,"rootWindow",void 0),nv(this,"prefix",void 0),nv(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){E(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const $ae=Lae;function kae(t,e,n){return e=Fae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fae(t){var e=Wae(t,"string");return typeof e=="symbol"?e:String(e)}function Wae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}de.getSingleton().register("persistentStateSave");de.getSingleton().register("persistentStateLoad");de.getSingleton().register("persistentStateReset");const rO="persistentState",Vae=0;class Bae extends it{constructor(){super(...arguments),kae(this,"storage",void 0)}static get PLUGIN_KEY(){return rO}static get PLUGIN_PRIORITY(){return Vae}isEnabled(){return!!this.hot.getSettings()[rO]}enablePlugin(){this.enabled||(this.storage||(this.storage=new $ae(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Uae(t,e){Yae(t,e),e.add(t)}function Yae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rv(t,e,n){return e=Gae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gae(t){var e=zae(t,"string");return typeof e=="symbol"?e:String(e)}function zae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iO(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const iv="search",jae=190,Kae="htSearchResult",Xae=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},qae=function(t,e,n){return vt(t)||t===null||!t.toLocaleLowerCase||t.length===0||vt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var ov=new WeakSet;class Zae extends it{constructor(){super(...arguments),Uae(this,ov),rv(this,"callback",Xae),rv(this,"queryMethod",qae),rv(this,"searchResultClass",Kae)}static get PLUGIN_KEY(){return iv}static get PLUGIN_PRIORITY(){return jae}isEnabled(){return this.hot.getSettings()[iv]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[iv];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return iO(e,ov,oO).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return iO(e,ov,oO).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return me(0,i-1,l=>{me(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,p=(h.search.queryMethod||r)(e,c,h);if(p){const C={row:l,col:u,data:c};s.push(C)}d&&d(a,l,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Be(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function oO(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function sv(t,e){Jae(t,e),e.add(t)}function Jae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kd(t,e,n){return e=Qae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qae(t){var e=ele(t,"string");return typeof e=="symbol"?e:String(e)}function ele(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function av(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const tle="touchScroll",nle=200;var sO=new WeakSet,aO=new WeakSet,lO=new WeakSet;class rle extends it{constructor(){super(...arguments),sv(this,lO),sv(this,aO),sv(this,sO),kd(this,"scrollbars",[]),kd(this,"clones",[]),kd(this,"lockedCollection",!1),kd(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return tle}static get PLUGIN_PRIORITY(){return nle}static get SETTING_KEYS(){return!0}isEnabled(){return Dy()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>av(this,sO,ile).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>av(this,aO,ole).call(this)),this.addHook("afterMomentumScroll",()=>av(this,lO,sle).call(this))}}function ile(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function ole(){this.freezeOverlays=!0,E(this.clones,t=>{q(t,"hide-tween")})}function sle(){this.freezeOverlays=!1,E(this.clones,t=>{Le(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{E(this.clones,t=>{Le(t,"show-tween")})},400),E(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function ale(t,e){lle(t,e),e.add(t)}function lle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ule(t,e,n){return e=cle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cle(t){var e=hle(t,"string");return typeof e=="symbol"?e:String(e)}function hle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dle(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const df="trimRows",fle=330;var uO=new WeakSet;class gle extends it{constructor(){super(...arguments),ale(this,uO),ule(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return df}static get PLUGIN_PRIORITY(){return fle}isEnabled(){return!!this.hot.getSettings()[df]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Zc),this.trimmedRowsMap.addLocalHook("init",()=>dle(this,uO,mle).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[df];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),E(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(E(e,l=>{o[l]=!1}),i=Yt(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function mle(){const t=this.hot.getSettings()[df];Array.isArray(t)&&this.hot.batchExecution(()=>{E(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var $N={},ple=$l,wle=$N,Cle=ple("iterator"),vle=Array.prototype,Sle=function(t){return t!==void 0&&(wle.Array===t||vle[Cle]===t)},yle=GO,cO=FS,ble=DS,Rle=$N,Ele=$l,Tle=Ele("iterator"),kN=function(t){if(!ble(t))return cO(t,Tle)||cO(t,"@@iterator")||Rle[yle(t)]},_le=pa,Mle=fg,Ale=vs,Ole=dg,Ile=kN,Ple=TypeError,xle=function(t,e){var n=arguments.length<2?Ile(t):e;if(Mle(n))return Ale(_le(n,t));throw new Ple(Ole(t)+" is not iterable")},Hle=pa,hO=vs,Dle=FS,Nle=function(t,e,n){var r,i;hO(t);try{if(r=Dle(t,"return"),!r){if(e==="throw")throw n;return n}r=Hle(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return hO(r),n},Lle=ZO,$le=pa,kle=vs,Fle=dg,Wle=Sle,Vle=$c,dO=NS,Ble=xle,Ule=kN,fO=Nle,Yle=TypeError,ff=function(t,e){this.stopped=t,this.result=e},gO=ff.prototype,Gle=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=Lle(e,r),u,c,h,d,g,p,C,S=function(R){return u&&fO(u,"normal",R),new ff(!0,R)},y=function(R){return i?(kle(R),a?l(R[0],R[1],S):l(R[0],R[1])):a?l(R,S):l(R)};if(o)u=t.iterator;else if(s)u=t;else{if(c=Ule(t),!c)throw new Yle(Fle(t)+" is not iterable");if(Wle(c)){for(h=0,d=Vle(t);d>h;h++)if(g=y(t[h]),g&&dO(gO,g))return g;return new ff(!1)}u=Ble(t,c)}for(p=o?t.next:u.next;!(C=$le(p,u)).done;){try{g=y(C.value)}catch(R){fO(u,"throw",R)}if(typeof g=="object"&&g&&dO(gO,g))return g}return new ff(!1)},zle=BS,jle=Cs,Kle=cg,Xle=function(t,e,n){var r=zle(e);r in t?jle.f(t,r,Kle(0,n)):t[r]=n},qle=Ss,Zle=Gle,Jle=Xle;qle({target:"Object",stat:!0},{fromEntries:function(e){var n={};return Zle(e,function(r,i){Jle(n,r,i)},{AS_ENTRIES:!0}),n}});const FN="undoRedo",Qle="undoRedo";function ce(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);E(l,c=>{c[1]=t.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new ce.ChangeAction(l,u)};e.done(a,i)}),t.addHook("afterCreateRow",(r,i,o)=>{e.done(()=>new ce.CreateRowAction(r,i),o)});const n=(r,i,o,s)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return me(o,s,c=>{me(r,i,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const g=Object.fromEntries(Object.entries(d).filter(p=>{let[C]=p;return a.includes(C)===!1}));u.push([d.visualRow,d.visualCol,g])}})}),u};t.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=t.toPhysicalRow(r),u=l+i-1,c=_n(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new ce.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(l,u,0,t.countCols()-1))};e.done(a,s)}),t.addHook("afterCreateCol",(r,i,o)=>{e.done(()=>new ce.CreateColumnAction(r,i),o)}),t.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=u+i-1,h=[],d=[],g=[];me(l.length-1,S=>{const y=[],R=l[S];me(u,c,T=>{y.push(R[t.toPhysicalColumn(T)])}),h.push(y)}),me(i-1,S=>{g.push(t.toPhysicalColumn(u+S))}),Array.isArray(t.getSettings().colHeaders)&&me(i-1,S=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+S)]||null)});const p=t.columnIndexMapper.getIndexesSequence(),C=t.rowIndexMapper.getIndexesSequence();return new ce.RemoveColumnAction(u,g,h,d,p,C,t.getSettings().fixedColumnsStart,n(0,t.countRows(),u,c))};e.done(a,s)}),t.addHook("beforeCellAlignment",(r,i,o,s)=>{e.done(()=>new ce.CellAlignmentAction(r,i,o,s))}),t.addHook("beforeFilter",r=>{e.done(()=>new ce.FiltersAction(r))}),t.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new ce.RowMoveAction(r,i))}),t.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new ce.MergeCellsAction(t,r))}),t.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new ce.UnmergeCellsAction(t,r))}),t.addHook("afterInit",()=>{e.init()})}ce.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};ce.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=_n(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};ce.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=_n(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};ce.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ce.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ce.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ce.prototype.isEnabled=function(){return this.enabled};ce.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,nue(t),this.registerShortcuts(),t.addHook("afterChange",WN)};ce.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,rue(t),this.unregisterShortcuts(),t.removeHook("afterChange",WN)};ce.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ce.Action=function(){};ce.Action.prototype.undo=function(){};ce.Action.prototype.redo=function(){};ce.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};To(ce.ChangeAction,ce.Action);ce.ChangeAction.prototype.undo=function(t,e){const n=_n(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,a=n.length;s<a;s++){const[l,u]=n[s];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const o=t.getSelectedLast();if(o!==void 0){const[s,a]=n[0],[l,u]=o,c=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),d=s>=c,g=a>=h;if((d&&g)===!1&&(l!==s||u!==a)===!0){const S={row:s,col:a};d===!1&&(S.verticalSnap="top"),g===!1&&(S.horizontalSnap="start"),t.scrollViewportTo(S)}}t.selectCells(this.selected,!1,!1)};ce.ChangeAction.prototype.redo=function(t,e){const n=_n(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};ce.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};To(ce.CreateRowAction,ce.Action);ce.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ce.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ce.RemoveRowAction=function(t,e,n,r,i,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=o};To(ce.RemoveRowAction,ce.Action);ce.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[o,s,a]=i;t.setCellMetaObject(o,s,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ce.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ce.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};To(ce.CreateColumnAction,ce.Action);ce.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ce.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ce.RemoveColumnAction=function(t,e,n,r,i,o,s,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a};To(ce.RemoveColumnAction,ce.Action);ce.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ye(this.data[u],i));const a=Ye(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),E(t.getSourceDataArray(),(u,c)=>{E(r,(h,d)=>{u[h]=s[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&E(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};ce.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ce.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};ce.CellAlignmentAction.prototype.undo=function(t,e){E(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};ce.CellAlignmentAction.prototype.redo=function(t,e){Yo(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};ce.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};To(ce.FiltersAction,ce.Action);ce.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};ce.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class eue extends ce.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}ce.MergeCellsAction=eue;class tue extends ce.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}ce.UnmergeCellsAction=tue;ce.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};To(ce.RowMoveAction,ce.Action);ce.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ce.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ce.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ce.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:FN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ce.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(FN)};function WN(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function nue(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function rue(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const uh=de.getSingleton();uh.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});uh.register("beforeUndo");uh.register("afterUndo");uh.register("beforeRedo");uh.register("afterRedo");ce.PLUGIN_KEY=Qle;ce.SETTING_KEYS=!0;function iue(){ke(_l),ke(oX),ke(rc),ke(LX),ke(GX),ke(UH),ke(Lq),ke(yZ),ke(oh),ke(lD),ke(mQ),ke(RQ),ke(sh),ke(qQ),ke(VD),ke(kne),ke(nN),ke(oN),ke(Dre),ke(Xre),ke(sie),ke(pN),ke($ie),ke(doe),ke(bN),ke(zoe),ke(_se),ke(Cae),ke(Bae),ke(Zae),ke(rle),ke(gle),ke(ce)}function oue(){er(Yl),er(Ib),er(hH),er(mH),er(Lb),er(Ob),er(SH),er(RH),er(EH),er(ba),er(TH)}function sue(){ur(Gl),ur(eh),ur(xb),ur($b),ur(Fb),ur(Pb),ur(Wb),ur(Bb),ur(Ub),ur(Ao),ur(Yb)}function aue(){ta(cp),ta(kb),ta(Nb),ta(Vb),ta(Gb)}function lue(){oue(),sue(),aue(),b7(),iue()}function uue(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var lv,uv,cv,hv,dv;lue();uue(_e);_e.__GhostTable=zb;_e._getListenersCounter=yz;_e._getRegisteredMapsCounter=X4;_e.EventManager=xr;const cue=[KY,nz,N4,z8,QG,LG,JY,$z,JG,eG,oz,Lz],hue=[xG,sz];_e.helper={};_e.dom={};E(cue,t=>{E(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(_e.helper[e]=t[e])})});E(hue,t=>{E(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(_e.dom[e]=t[e])})});_e.cellTypes=(lv=_e.cellTypes)!==null&&lv!==void 0?lv:{};E(m9(),t=>{_e.cellTypes[t]=Mb(t)});_e.cellTypes.registerCellType=yn;_e.cellTypes.getCellType=Mb;_e.editors=(uv=_e.editors)!==null&&uv!==void 0?uv:{};E(gz(),t=>{_e.editors[`${Tn(t)}Editor`]=Af(t)});_e.editors.registerEditor=er;_e.editors.getEditor=Af;_e.renderers=(cv=_e.renderers)!==null&&cv!==void 0?cv:{};E(Jz(),t=>{const e=Pf(t);t==="base"&&(_e.renderers.cellDecorator=e),_e.renderers[`${Tn(t)}Renderer`]=e});_e.renderers.registerRenderer=ur;_e.renderers.getRenderer=Pf;_e.validators=(hv=_e.validators)!==null&&hv!==void 0?hv:{};E(tj(),t=>{_e.validators[`${Tn(t)}Validator`]=Gy(t)});_e.validators.registerValidator=ta;_e.validators.getValidator=Gy;_e.plugins=(dv=_e.plugins)!==null&&dv!==void 0?dv:{};E(Yy(),t=>{_e.plugins[t]=jc(t)});_e.plugins[`${Tn(it.PLUGIN_KEY)}Plugin`]=it;_e.plugins.registerPlugin=ke;_e.plugins.getPlugin=jc;const mO=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function due(t,e,n,r,i,o){if(n!==0)return;const s=t.parentElement;s!==null&&(e%2===0?_e.dom.addClass(s,VE):_e.dom.removeClass(s,VE))}function fue(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(mO.has(t.toString())?(_e.dom.removeClass(e.firstChild,n),_e.dom.addClass(e.firstChild,mO.get(t.toString()))):_e.dom.addClass(e.firstChild,n))}ke(_l);ke(oh);ke(lD);ke(sh);ke(VD);ke(nN);ke(oN);ke(pN);ke(bN);ke(ce);yn(CH);yn(vH);yn(fH);yn(bH);Eb(cH);const gue=document.getElementById("example");new _e(gue,{data:a8(),layoutDirection:Qd()?"rtl":"ltr",language:Qd()?cH.languageCode:"en-US",height:450,colWidths:[170,222,130,120,120,130,156],colHeaders:["Company name","Name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1,dateFormat:Qd()?"M/D/YYYY":"DD/MM/YYYY"},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:5,type:"text"},{data:2,type:"text"}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,navigableHeaders:!0,autoWrapCol:!0,afterGetColHeader:fue,beforeRenderer:due,licenseKey:"non-commercial-and-evaluation"});console.log(`Handsontable: v${_e.version} (${_e.buildDate})`)});export default mue();
