var VD=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var mae=VD((Pae,wd)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Bh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function BD(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){if(this instanceof r){var i=[null];i.push.apply(i,arguments);var o=Function.bind.apply(e,i);return new o}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Ec=function(t){return t&&t.Math===Math&&t},En=Ec(typeof globalThis=="object"&&globalThis)||Ec(typeof window=="object"&&window)||Ec(typeof self=="object"&&self)||Ec(typeof Bh=="object"&&Bh)||function(){return this}()||Bh||Function("return this")(),bv={},wr=function(t){try{return!!t()}catch{return!0}},UD=wr,di=!UD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),YD=wr,lf=!YD(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),zD=lf,Tc=Function.prototype.call,uf=zD?Tc.bind(Tc):function(){return Tc.apply(Tc,arguments)},nA={},rA={}.propertyIsEnumerable,iA=Object.getOwnPropertyDescriptor,GD=iA&&!rA.call({1:2},1);nA.f=GD?function(e){var n=iA(this,e);return!!n&&n.enumerable}:rA;var Rv=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},oA=lf,sA=Function.prototype,sC=sA.call,jD=oA&&sA.bind.bind(sC,sC),Fn=oA?jD:function(t){return function(){return sC.apply(t,arguments)}},aA=Fn,KD=aA({}.toString),XD=aA("".slice),rl=function(t){return XD(KD(t),8,-1)},qD=Fn,ZD=wr,QD=rl,bm=Object,JD=qD("".split),eN=ZD(function(){return!bm("z").propertyIsEnumerable(0)})?function(t){return QD(t)==="String"?JD(t,""):bm(t)}:bm,lA=function(t){return t==null},tN=lA,nN=TypeError,uA=function(t){if(tN(t))throw nN("Can't call method on "+t);return t},rN=eN,iN=uA,cf=function(t){return rN(iN(t))},aC=typeof document=="object"&&document.all,oN=typeof aC>"u"&&aC!==void 0,cA={all:aC,IS_HTMLDDA:oN},hA=cA,sN=hA.all,dn=hA.IS_HTMLDDA?function(t){return typeof t=="function"||t===sN}:function(t){return typeof t=="function"},ub=dn,dA=cA,aN=dA.all,Us=dA.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:ub(t)||t===aN}:function(t){return typeof t=="object"?t!==null:ub(t)},Rm=En,lN=dn,uN=function(t){return lN(t)?t:void 0},ju=function(t,e){return arguments.length<2?uN(Rm[t]):Rm[t]&&Rm[t][e]},cN=Fn,fA=cN({}.isPrototypeOf),Ev=typeof navigator<"u"&&String(navigator.userAgent)||"",gA=En,Em=Ev,cb=gA.process,hb=gA.Deno,db=cb&&cb.versions||hb&&hb.version,fb=db&&db.v8,Dr,Cd;fb&&(Dr=fb.split("."),Cd=Dr[0]>0&&Dr[0]<4?1:+(Dr[0]+Dr[1]));!Cd&&Em&&(Dr=Em.match(/Edge\/(\d+)/),(!Dr||Dr[1]>=74)&&(Dr=Em.match(/Chrome\/(\d+)/),Dr&&(Cd=+Dr[1])));var hN=Cd,gb=hN,dN=wr,fN=En,gN=fN.String,Tv=!!Object.getOwnPropertySymbols&&!dN(function(){var t=Symbol("symbol detection");return!gN(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&gb&&gb<41}),mN=Tv,mA=mN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",pN=ju,wN=dn,CN=fA,vN=mA,SN=Object,_v=vN?function(t){return typeof t=="symbol"}:function(t){var e=pN("Symbol");return wN(e)&&CN(e.prototype,SN(t))},yN=String,pA=function(t){try{return yN(t)}catch{return"Object"}},bN=dn,RN=pA,EN=TypeError,Mv=function(t){if(bN(t))return t;throw EN(RN(t)+" is not a function")},TN=Mv,_N=lA,MN=function(t,e){var n=t[e];return _N(n)?void 0:TN(n)},Tm=uf,_m=dn,Mm=Us,AN=TypeError,ON=function(t,e){var n,r;if(e==="string"&&_m(n=t.toString)&&!Mm(r=Tm(n,t))||_m(n=t.valueOf)&&!Mm(r=Tm(n,t))||e!=="string"&&_m(n=t.toString)&&!Mm(r=Tm(n,t)))return r;throw AN("Can't convert object to primitive value")},wA={exports:{}},mb=En,IN=Object.defineProperty,Av=function(t,e){try{IN(mb,t,{value:e,configurable:!0,writable:!0})}catch{mb[t]=e}return e},PN=En,xN=Av,pb="__core-js_shared__",HN=PN[pb]||xN(pb,{}),Ov=HN,wb=Ov;(wA.exports=function(t,e){return wb[t]||(wb[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.32.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"});var CA=wA.exports,DN=uA,NN=Object,hf=function(t){return NN(DN(t))},LN=Fn,$N=hf,kN=LN({}.hasOwnProperty),Ji=Object.hasOwn||function(e,n){return kN($N(e),n)},FN=Fn,WN=0,VN=Math.random(),BN=FN(1 .toString),vA=function(t){return"Symbol("+(t===void 0?"":t)+")_"+BN(++WN+VN,36)},UN=En,YN=CA,Cb=Ji,zN=vA,GN=Tv,jN=mA,Wa=UN.Symbol,Am=YN("wks"),KN=jN?Wa.for||Wa:Wa&&Wa.withoutSetter||zN,df=function(t){return Cb(Am,t)||(Am[t]=GN&&Cb(Wa,t)?Wa[t]:KN("Symbol."+t)),Am[t]},XN=uf,vb=Us,Sb=_v,qN=MN,ZN=ON,QN=df,JN=TypeError,eL=QN("toPrimitive"),tL=function(t,e){if(!vb(t)||Sb(t))return t;var n=qN(t,eL),r;if(n){if(e===void 0&&(e="default"),r=XN(n,t,e),!vb(r)||Sb(r))return r;throw JN("Can't convert object to primitive value")}return e===void 0&&(e="number"),ZN(t,e)},nL=tL,rL=_v,SA=function(t){var e=nL(t,"string");return rL(e)?e:e+""},iL=En,yb=Us,lC=iL.document,oL=yb(lC)&&yb(lC.createElement),Iv=function(t){return oL?lC.createElement(t):{}},sL=di,aL=wr,lL=Iv,yA=!sL&&!aL(function(){return Object.defineProperty(lL("div"),"a",{get:function(){return 7}}).a!==7}),uL=di,cL=uf,hL=nA,dL=Rv,fL=cf,gL=SA,mL=Ji,pL=yA,bb=Object.getOwnPropertyDescriptor;bv.f=uL?bb:function(e,n){if(e=fL(e),n=gL(n),pL)try{return bb(e,n)}catch{}if(mL(e,n))return dL(!cL(hL.f,e,n),e[n])};var Ys={},wL=di,CL=wr,bA=wL&&CL(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),vL=Us,SL=String,yL=TypeError,Ku=function(t){if(vL(t))return t;throw yL(SL(t)+" is not an object")},bL=di,RL=yA,EL=bA,_c=Ku,Rb=SA,TL=TypeError,Om=Object.defineProperty,_L=Object.getOwnPropertyDescriptor,Im="enumerable",Pm="configurable",xm="writable";Ys.f=bL?EL?function(e,n,r){if(_c(e),n=Rb(n),_c(r),typeof e=="function"&&n==="prototype"&&"value"in r&&xm in r&&!r[xm]){var i=_L(e,n);i&&i[xm]&&(e[n]=r.value,r={configurable:Pm in r?r[Pm]:i[Pm],enumerable:Im in r?r[Im]:i[Im],writable:!1})}return Om(e,n,r)}:Om:function(e,n,r){if(_c(e),n=Rb(n),_c(r),RL)try{return Om(e,n,r)}catch{}if("get"in r||"set"in r)throw TL("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var ML=di,AL=Ys,OL=Rv,Xu=ML?function(t,e,n){return AL.f(t,e,OL(1,n))}:function(t,e,n){return t[e]=n,t},RA={exports:{}},uC=di,IL=Ji,EA=Function.prototype,PL=uC&&Object.getOwnPropertyDescriptor,Pv=IL(EA,"name"),xL=Pv&&(function(){}).name==="something",HL=Pv&&(!uC||uC&&PL(EA,"name").configurable),DL={EXISTS:Pv,PROPER:xL,CONFIGURABLE:HL},NL=Fn,LL=dn,cC=Ov,$L=NL(Function.toString);LL(cC.inspectSource)||(cC.inspectSource=function(t){return $L(t)});var kL=cC.inspectSource,FL=En,WL=dn,Eb=FL.WeakMap,VL=WL(Eb)&&/native code/.test(String(Eb)),BL=CA,UL=vA,Tb=BL("keys"),TA=function(t){return Tb[t]||(Tb[t]=UL(t))},xv={},YL=VL,_A=En,zL=Us,GL=Xu,Hm=Ji,Dm=Ov,jL=TA,KL=xv,_b="Object already initialized",hC=_A.TypeError,XL=_A.WeakMap,vd,_u,Sd,qL=function(t){return Sd(t)?_u(t):vd(t,{})},ZL=function(t){return function(e){var n;if(!zL(e)||(n=_u(e)).type!==t)throw hC("Incompatible receiver, "+t+" required");return n}};if(YL||Dm.state){var Yr=Dm.state||(Dm.state=new XL);Yr.get=Yr.get,Yr.has=Yr.has,Yr.set=Yr.set,vd=function(t,e){if(Yr.has(t))throw hC(_b);return e.facade=t,Yr.set(t,e),e},_u=function(t){return Yr.get(t)||{}},Sd=function(t){return Yr.has(t)}}else{var Qs=jL("state");KL[Qs]=!0,vd=function(t,e){if(Hm(t,Qs))throw hC(_b);return e.facade=t,GL(t,Qs,e),e},_u=function(t){return Hm(t,Qs)?t[Qs]:{}},Sd=function(t){return Hm(t,Qs)}}var QL={set:vd,get:_u,has:Sd,enforce:qL,getterFor:ZL},Hv=Fn,JL=wr,e$=dn,Mc=Ji,dC=di,t$=DL.CONFIGURABLE,n$=kL,MA=QL,r$=MA.enforce,i$=MA.get,Mb=String,Uh=Object.defineProperty,o$=Hv("".slice),s$=Hv("".replace),a$=Hv([].join),l$=dC&&!JL(function(){return Uh(function(){},"length",{value:8}).length!==8}),u$=String(String).split("String"),c$=RA.exports=function(t,e,n){o$(Mb(e),0,7)==="Symbol("&&(e="["+s$(Mb(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Mc(t,"name")||t$&&t.name!==e)&&(dC?Uh(t,"name",{value:e,configurable:!0}):t.name=e),l$&&n&&Mc(n,"arity")&&t.length!==n.arity&&Uh(t,"length",{value:n.arity});try{n&&Mc(n,"constructor")&&n.constructor?dC&&Uh(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=r$(t);return Mc(r,"source")||(r.source=a$(u$,typeof e=="string"?e:"")),t};Function.prototype.toString=c$(function(){return e$(this)&&i$(this).source||n$(this)},"toString");var h$=RA.exports,d$=dn,f$=Ys,g$=h$,m$=Av,p$=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(d$(n)&&g$(n,o,r),r.global)i?t[e]=n:m$(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:f$.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},AA={},w$=Math.ceil,C$=Math.floor,v$=Math.trunc||function(e){var n=+e;return(n>0?C$:w$)(n)},S$=v$,Dv=function(t){var e=+t;return e!==e||e===0?0:S$(e)},y$=Dv,b$=Math.max,R$=Math.min,E$=function(t,e){var n=y$(t);return n<0?b$(n+e,0):R$(n,e)},T$=Dv,_$=Math.min,M$=function(t){return t>0?_$(T$(t),9007199254740991):0},A$=M$,ff=function(t){return A$(t.length)},O$=cf,I$=E$,P$=ff,Ab=function(t){return function(e,n,r){var i=O$(e),o=P$(i),s=I$(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},x$={includes:Ab(!0),indexOf:Ab(!1)},H$=Fn,Nm=Ji,D$=cf,N$=x$.indexOf,L$=xv,Ob=H$([].push),OA=function(t,e){var n=D$(t),r=0,i=[],o;for(o in n)!Nm(L$,o)&&Nm(n,o)&&Ob(i,o);for(;e.length>r;)Nm(n,o=e[r++])&&(~N$(i,o)||Ob(i,o));return i},Nv=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],$$=OA,k$=Nv,F$=k$.concat("length","prototype");AA.f=Object.getOwnPropertyNames||function(e){return $$(e,F$)};var IA={};IA.f=Object.getOwnPropertySymbols;var W$=ju,V$=Fn,B$=AA,U$=IA,Y$=Ku,z$=V$([].concat),G$=W$("Reflect","ownKeys")||function(e){var n=B$.f(Y$(e)),r=U$.f;return r?z$(n,r(e)):n},Ib=Ji,j$=G$,K$=bv,X$=Ys,PA=function(t,e,n){for(var r=j$(e),i=X$.f,o=K$.f,s=0;s<r.length;s++){var a=r[s];!Ib(t,a)&&!(n&&Ib(n,a))&&i(t,a,o(e,a))}},q$=wr,Z$=dn,Q$=/#|\.prototype\./,qu=function(t,e){var n=ek[J$(t)];return n===nk?!0:n===tk?!1:Z$(e)?q$(e):!!e},J$=qu.normalize=function(t){return String(t).replace(Q$,".").toLowerCase()},ek=qu.data={},tk=qu.NATIVE="N",nk=qu.POLYFILL="P",rk=qu,Lm=En,ik=bv.f,ok=Xu,sk=p$,ak=Av,lk=PA,uk=rk,zs=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Lm:i?s=Lm[n]||ak(n,{}):s=(Lm[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=ik(s,a),l=c&&c.value):l=s[a],o=uk(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;lk(u,l)}(t.sham||l&&l.sham)&&ok(u,"sham",!0),sk(s,a,u,t)}},ck=rl,xA=Array.isArray||function(e){return ck(e)==="Array"},hk=di,dk=xA,fk=TypeError,gk=Object.getOwnPropertyDescriptor,mk=hk&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),HA=mk?function(t,e){if(dk(t)&&!gk(t,"length").writable)throw fk("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},pk=TypeError,wk=9007199254740991,DA=function(t){if(t>wk)throw pk("Maximum allowed index exceeded");return t},Ck=zs,vk=hf,Sk=ff,yk=HA,bk=DA,Rk=wr,Ek=Rk(function(){return[].push.call({length:4294967296},1)!==4294967297}),Tk=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},_k=Ek||!Tk();Ck({target:"Array",proto:!0,arity:1,forced:_k},{push:function(e){var n=vk(this),r=Sk(n),i=arguments.length;bk(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return yk(n,r),r}});var Mk=lf,NA=Function.prototype,Pb=NA.apply,xb=NA.call,gf=typeof Reflect=="object"&&Reflect.apply||(Mk?xb.bind(Pb):function(){return xb.apply(Pb,arguments)}),Ak=Fn,Ok=Mv,Ik=function(t,e,n){try{return Ak(Ok(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},Pk=dn,xk=String,Hk=TypeError,Dk=function(t){if(typeof t=="object"||Pk(t))return t;throw Hk("Can't set "+xk(t)+" as a prototype")},Nk=Ik,Lk=Ku,$k=Dk,LA=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=Nk(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return Lk(i),$k(o),t?n(i,o):i.__proto__=o,i}}():void 0),kk=Ys.f,Fk=function(t,e,n){n in t||kk(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},Wk=dn,Vk=Us,Hb=LA,Bk=function(t,e,n){var r,i;return Hb&&Wk(r=e.constructor)&&r!==n&&Vk(i=r.prototype)&&i!==n.prototype&&Hb(t,i),t},Uk=df,Yk=Uk("toStringTag"),$A={};$A[Yk]="z";var zk=String($A)==="[object z]",Gk=zk,jk=dn,Yh=rl,Kk=df,Xk=Kk("toStringTag"),qk=Object,Zk=Yh(function(){return arguments}())==="Arguments",Qk=function(t,e){try{return t[e]}catch{}},Jk=Gk?Yh:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=Qk(e=qk(t),Xk))=="string"?n:Zk?Yh(e):(r=Yh(e))==="Object"&&jk(e.callee)?"Arguments":r},eF=Jk,tF=String,kA=function(t){if(eF(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return tF(t)},nF=kA,rF=function(t,e){return t===void 0?arguments.length<2?"":e:nF(t)},iF=Us,oF=Xu,sF=function(t,e){iF(e)&&"cause"in e&&oF(t,"cause",e.cause)},aF=Fn,FA=Error,lF=aF("".replace),uF=function(t){return String(FA(t).stack)}("zxcasd"),WA=/\n\s*at [^:]*:[^\n]*/,cF=WA.test(uF),hF=function(t,e){if(cF&&typeof t=="string"&&!FA.prepareStackTrace)for(;e--;)t=lF(t,WA,"");return t},dF=wr,fF=Rv,gF=!dF(function(){var t=Error("a");return"stack"in t?(Object.defineProperty(t,"stack",fF(1,7)),t.stack!==7):!0}),mF=Xu,pF=hF,wF=gF,Db=Error.captureStackTrace,CF=function(t,e,n,r){wF&&(Db?Db(t,e):mF(t,"stack",pF(n,r)))},Nb=ju,vF=Ji,Lb=Xu,SF=fA,$b=LA,kb=PA,Fb=Fk,yF=Bk,bF=rF,RF=sF,EF=CF,TF=di,_F=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=Nb.apply(null,s);if(l){var u=l.prototype;if(vF(u,"cause")&&delete u.cause,!n)return l;var c=Nb("Error"),d=e(function(f,m){var w=bF(r?m:f,void 0),v=r?new l(f):new l;return w!==void 0&&Lb(v,"message",w),EF(v,d,v.stack,2),this&&SF(u,this)&&yF(v,this,d),arguments.length>o&&RF(v,arguments[o]),v});d.prototype=u,a!=="Error"?$b?$b(d,c):kb(d,c,{name:!0}):TF&&i in l&&(Fb(d,l,i),Fb(d,l,"prepareStackTrace")),kb(d,l);try{u.name!==a&&Lb(u,"name",a),u.constructor=d}catch{}return d}},VA=zs,MF=En,fi=gf,BA=_F,fC="WebAssembly",Wb=MF[fC],yd=Error("e",{cause:7}).cause!==7,Gs=function(t,e){var n={};n[t]=BA(t,e,yd),VA({global:!0,constructor:!0,arity:1,forced:yd},n)},Lv=function(t,e){if(Wb&&Wb[t]){var n={};n[t]=BA(fC+"."+t,e,yd),VA({target:fC,stat:!0,constructor:!0,arity:1,forced:yd},n)}};Gs("Error",function(t){return function(n){return fi(t,this,arguments)}});Gs("EvalError",function(t){return function(n){return fi(t,this,arguments)}});Gs("RangeError",function(t){return function(n){return fi(t,this,arguments)}});Gs("ReferenceError",function(t){return function(n){return fi(t,this,arguments)}});Gs("SyntaxError",function(t){return function(n){return fi(t,this,arguments)}});Gs("TypeError",function(t){return function(n){return fi(t,this,arguments)}});Gs("URIError",function(t){return function(n){return fi(t,this,arguments)}});Lv("CompileError",function(t){return function(n){return fi(t,this,arguments)}});Lv("LinkError",function(t){return function(n){return fi(t,this,arguments)}});Lv("RuntimeError",function(t){return function(n){return fi(t,this,arguments)}});var AF=rl,OF=Fn,IF=function(t){if(AF(t)==="Function")return OF(t)},Vb=IF,PF=Mv,xF=lf,HF=Vb(Vb.bind),DF=function(t,e){return PF(t),e===void 0?t:xF?HF(t,e):function(){return t.apply(e,arguments)}},NF=ju,UA=NF("document","documentElement"),LF=Fn,$v=LF([].slice),$F=TypeError,YA=function(t,e){if(t<e)throw $F("Not enough arguments");return t},kF=Ev,FF=/(?:ipad|iphone|ipod).*applewebkit/i.test(kF),WF=En,VF=rl,BF=VF(WF.process)==="process",rr=En,UF=gf,YF=DF,Bb=dn,zF=Ji,zA=wr,Ub=UA,GF=$v,Yb=Iv,jF=YA,KF=FF,XF=BF,gC=rr.setImmediate,mC=rr.clearImmediate,qF=rr.process,$m=rr.Dispatch,ZF=rr.Function,zb=rr.MessageChannel,QF=rr.String,km=0,lu={},Gb="onreadystatechange",Mu,Ko,Fm,Wm;zA(function(){Mu=rr.location});var kv=function(t){if(zF(lu,t)){var e=lu[t];delete lu[t],e()}},Vm=function(t){return function(){kv(t)}},jb=function(t){kv(t.data)},Kb=function(t){rr.postMessage(QF(t),Mu.protocol+"//"+Mu.host)};(!gC||!mC)&&(gC=function(e){jF(arguments.length,1);var n=Bb(e)?e:ZF(e),r=GF(arguments,1);return lu[++km]=function(){UF(n,void 0,r)},Ko(km),km},mC=function(e){delete lu[e]},XF?Ko=function(t){qF.nextTick(Vm(t))}:$m&&$m.now?Ko=function(t){$m.now(Vm(t))}:zb&&!KF?(Fm=new zb,Wm=Fm.port2,Fm.port1.onmessage=jb,Ko=YF(Wm.postMessage,Wm)):rr.addEventListener&&Bb(rr.postMessage)&&!rr.importScripts&&Mu&&Mu.protocol!=="file:"&&!zA(Kb)?(Ko=Kb,rr.addEventListener("message",jb,!1)):Gb in Yb("script")?Ko=function(t){Ub.appendChild(Yb("script"))[Gb]=function(){Ub.removeChild(this),kv(t)}}:Ko=function(t){setTimeout(Vm(t),0)});var GA={set:gC,clear:mC},JF=zs,eW=En,Xb=GA.clear;JF({global:!0,bind:!0,enumerable:!0,forced:eW.clearImmediate!==Xb},{clearImmediate:Xb});var tW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",jA=En,nW=gf,rW=dn,iW=tW,oW=Ev,sW=$v,aW=YA,lW=jA.Function,uW=/MSIE .\./.test(oW)||iW&&function(){var t=jA.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),cW=function(t,e){var n=e?2:1;return uW?function(r,i){var o=aW(arguments.length,1)>n,s=rW(r)?r:lW(r),a=o?sW(arguments,n):[],l=o?function(){nW(s,this,a)}:s;return e?t(l,i):t(l)}:t},hW=zs,KA=En,qb=GA.set,dW=cW,Zb=KA.setImmediate?dW(qb,!1):qb;hW({global:!0,bind:!0,enumerable:!0,forced:KA.setImmediate!==Zb},{setImmediate:Zb});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Ro(t){"@babel/helpers - typeof";return Ro=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ro(t)}function pC(t,e){return pC=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},pC(t,e)}function fW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function zh(t,e,n){return fW()?zh=Reflect.construct:zh=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&pC(u,s.prototype),u},zh.apply(null,arguments)}function Ir(t){return gW(t)||mW(t)||pW(t)||wW()}function gW(t){if(Array.isArray(t))return wC(t)}function mW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pW(t,e){if(t){if(typeof t=="string")return wC(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wC(t,e)}}function wC(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var CW=Object.hasOwnProperty,Qb=Object.setPrototypeOf,vW=Object.isFrozen,SW=Object.getPrototypeOf,yW=Object.getOwnPropertyDescriptor,kn=Object.freeze,kr=Object.seal,bW=Object.create,XA=typeof Reflect<"u"&&Reflect,bd=XA.apply,CC=XA.construct;bd||(bd=function(e,n,r){return e.apply(n,r)});kn||(kn=function(e){return e});kr||(kr=function(e){return e});CC||(CC=function(e,n){return zh(e,Ir(n))});var RW=pr(Array.prototype.forEach),Jb=pr(Array.prototype.pop),wl=pr(Array.prototype.push),Gh=pr(String.prototype.toLowerCase),Bm=pr(String.prototype.toString),EW=pr(String.prototype.match),yr=pr(String.prototype.replace),TW=pr(String.prototype.indexOf),_W=pr(String.prototype.trim),An=pr(RegExp.prototype.test),Um=MW(TypeError);function pr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return bd(t,e,r)}}function MW(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return CC(t,n)}}function je(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Gh,Qb&&Qb(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(vW(e)||(e[i]=s),o=s)}t[o]=!0}return t}function Xo(t){var e=bW(null),n;for(n in t)bd(CW,t,[n])===!0&&(e[n]=t[n]);return e}function Ac(t,e){for(;t!==null;){var n=yW(t,e);if(n){if(n.get)return pr(n.get);if(typeof n.value=="function")return pr(n.value)}t=SW(t)}function r(i){return console.warn("fallback value for",i),null}return r}var eR=kn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ym=kn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),zm=kn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),AW=kn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Gm=kn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),OW=kn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tR=kn(["#text"]),nR=kn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),jm=kn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),rR=kn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Oc=kn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),IW=kr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),PW=kr(/<%[\w\W]*|[\w\W]*%>/gm),xW=kr(/\${[\w\W]*}/gm),HW=kr(/^data-[\-\w.\u00B7-\uFFFF]/),DW=kr(/^aria-[\-\w]+$/),NW=kr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),LW=kr(/^(?:\w+script|data):/i),$W=kr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),kW=kr(/^html$/i),FW=function(){return typeof window>"u"?null:window},WW=function(e,n){if(Ro(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function qA(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:FW(),e=function(N){return qA(N)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,d=t.HTMLFormElement,f=t.DOMParser,m=t.trustedTypes,w=a.prototype,v=Ac(w,"cloneNode"),y=Ac(w,"nextSibling"),b=Ac(w,"childNodes"),_=Ac(w,"parentNode");if(typeof o=="function"){var I=r.createElement("template");I.content&&I.content.ownerDocument&&(r=I.content.ownerDocument)}var L=WW(m,n),x=L?L.createHTML(""):"",B=r,z=B.implementation,ee=B.createNodeIterator,j=B.createDocumentFragment,X=B.getElementsByTagName,ie=n.importNode,oe={};try{oe=Xo(r).documentMode?r.documentMode:{}}catch{}var se={};e.isSupported=typeof _=="function"&&z&&z.createHTMLDocument!==void 0&&oe!==9;var pe=IW,Me=PW,Je=xW,Pe=HW,R=DW,h=LW,g=$W,p=NW,E=null,M=je({},[].concat(Ir(eR),Ir(Ym),Ir(zm),Ir(Gm),Ir(tR))),O=null,Y=je({},[].concat(Ir(nR),Ir(jm),Ir(rR),Ir(Oc))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),q=null,Z=null,K=!0,ce=!0,Ae=!1,Te=!0,_e=!1,G=!1,Ge=!1,We=!1,ye=!1,xe=!1,Se=!1,C=!0,S=!1,A="user-content-",F=!0,P=!1,k={},H=null,D=je({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),V=null,$=je({},["audio","video","img","source","image","track"]),U=null,re=je({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),he="http://www.w3.org/1998/Math/MathML",Ce="http://www.w3.org/2000/svg",Oe="http://www.w3.org/1999/xhtml",ke=Oe,wt=!1,Xe=null,at=je({},[he,Ce,Oe],Bm),Rt,Zs=["application/xhtml+xml","text/html"],ml="text/html",$t,an=null,jo=r.createElement("form"),Mn=function(N){return N instanceof RegExp||N instanceof Function},qt=function(N){an&&an===N||((!N||Ro(N)!=="object")&&(N={}),N=Xo(N),Rt=Zs.indexOf(N.PARSER_MEDIA_TYPE)===-1?Rt=ml:Rt=N.PARSER_MEDIA_TYPE,$t=Rt==="application/xhtml+xml"?Bm:Gh,E="ALLOWED_TAGS"in N?je({},N.ALLOWED_TAGS,$t):M,O="ALLOWED_ATTR"in N?je({},N.ALLOWED_ATTR,$t):Y,Xe="ALLOWED_NAMESPACES"in N?je({},N.ALLOWED_NAMESPACES,Bm):at,U="ADD_URI_SAFE_ATTR"in N?je(Xo(re),N.ADD_URI_SAFE_ATTR,$t):re,V="ADD_DATA_URI_TAGS"in N?je(Xo($),N.ADD_DATA_URI_TAGS,$t):$,H="FORBID_CONTENTS"in N?je({},N.FORBID_CONTENTS,$t):D,q="FORBID_TAGS"in N?je({},N.FORBID_TAGS,$t):{},Z="FORBID_ATTR"in N?je({},N.FORBID_ATTR,$t):{},k="USE_PROFILES"in N?N.USE_PROFILES:!1,K=N.ALLOW_ARIA_ATTR!==!1,ce=N.ALLOW_DATA_ATTR!==!1,Ae=N.ALLOW_UNKNOWN_PROTOCOLS||!1,Te=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,_e=N.SAFE_FOR_TEMPLATES||!1,G=N.WHOLE_DOCUMENT||!1,ye=N.RETURN_DOM||!1,xe=N.RETURN_DOM_FRAGMENT||!1,Se=N.RETURN_TRUSTED_TYPE||!1,We=N.FORCE_BODY||!1,C=N.SANITIZE_DOM!==!1,S=N.SANITIZE_NAMED_PROPS||!1,F=N.KEEP_CONTENT!==!1,P=N.IN_PLACE||!1,p=N.ALLOWED_URI_REGEXP||p,ke=N.NAMESPACE||Oe,W=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&Mn(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&Mn(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),_e&&(ce=!1),xe&&(ye=!0),k&&(E=je({},Ir(tR)),O=[],k.html===!0&&(je(E,eR),je(O,nR)),k.svg===!0&&(je(E,Ym),je(O,jm),je(O,Oc)),k.svgFilters===!0&&(je(E,zm),je(O,jm),je(O,Oc)),k.mathMl===!0&&(je(E,Gm),je(O,rR),je(O,Oc))),N.ADD_TAGS&&(E===M&&(E=Xo(E)),je(E,N.ADD_TAGS,$t)),N.ADD_ATTR&&(O===Y&&(O=Xo(O)),je(O,N.ADD_ATTR,$t)),N.ADD_URI_SAFE_ATTR&&je(U,N.ADD_URI_SAFE_ATTR,$t),N.FORBID_CONTENTS&&(H===D&&(H=Xo(H)),je(H,N.FORBID_CONTENTS,$t)),F&&(E["#text"]=!0),G&&je(E,["html","head","body"]),E.table&&(je(E,["tbody"]),delete q.tbody),kn&&kn(N),an=N)},Ct=je({},["mi","mo","mn","ms","mtext"]),tb=je({},["foreignobject","desc","title","annotation-xml"]),$D=je({},["title","style","font","a","script"]),bc=je({},Ym);je(bc,zm),je(bc,AW);var vm=je({},Gm);je(vm,OW);var kD=function(N){var ne=_(N);(!ne||!ne.tagName)&&(ne={namespaceURI:ke,tagName:"template"});var ae=Gh(N.tagName),st=Gh(ne.tagName);return Xe[N.namespaceURI]?N.namespaceURI===Ce?ne.namespaceURI===Oe?ae==="svg":ne.namespaceURI===he?ae==="svg"&&(st==="annotation-xml"||Ct[st]):!!bc[ae]:N.namespaceURI===he?ne.namespaceURI===Oe?ae==="math":ne.namespaceURI===Ce?ae==="math"&&tb[st]:!!vm[ae]:N.namespaceURI===Oe?ne.namespaceURI===Ce&&!tb[st]||ne.namespaceURI===he&&!Ct[st]?!1:!vm[ae]&&($D[ae]||!bc[ae]):!!(Rt==="application/xhtml+xml"&&Xe[N.namespaceURI]):!1},wi=function(N){wl(e.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=x}catch{N.remove()}}},Sm=function(N,ne){try{wl(e.removed,{attribute:ne.getAttributeNode(N),from:ne})}catch{wl(e.removed,{attribute:null,from:ne})}if(ne.removeAttribute(N),N==="is"&&!O[N])if(ye||xe)try{wi(ne)}catch{}else try{ne.setAttribute(N,"")}catch{}},nb=function(N){var ne,ae;if(We)N="<remove></remove>"+N;else{var st=EW(N,/^[\r\n\t ]+/);ae=st&&st[0]}Rt==="application/xhtml+xml"&&ke===Oe&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var Vn=L?L.createHTML(N):N;if(ke===Oe)try{ne=new f().parseFromString(Vn,Rt)}catch{}if(!ne||!ne.documentElement){ne=z.createDocument(ke,"template",null);try{ne.documentElement.innerHTML=wt?x:Vn}catch{}}var fn=ne.body||ne.documentElement;return N&&ae&&fn.insertBefore(r.createTextNode(ae),fn.childNodes[0]||null),ke===Oe?X.call(ne,G?"html":"body")[0]:G?ne.documentElement:fn},rb=function(N){return ee.call(N.ownerDocument||N,N,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},FD=function(N){return N instanceof d&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},pl=function(N){return Ro(s)==="object"?N instanceof s:N&&Ro(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},Ci=function(N,ne,ae){se[N]&&RW(se[N],function(st){st.call(e,ne,ae,an)})},ib=function(N){var ne;if(Ci("beforeSanitizeElements",N,null),FD(N)||An(/[\u0080-\uFFFF]/,N.nodeName))return wi(N),!0;var ae=$t(N.nodeName);if(Ci("uponSanitizeElement",N,{tagName:ae,allowedTags:E}),N.hasChildNodes()&&!pl(N.firstElementChild)&&(!pl(N.content)||!pl(N.content.firstElementChild))&&An(/<[/\w]/g,N.innerHTML)&&An(/<[/\w]/g,N.textContent)||ae==="select"&&An(/<template/i,N.innerHTML))return wi(N),!0;if(!E[ae]||q[ae]){if(!q[ae]&&sb(ae)&&(W.tagNameCheck instanceof RegExp&&An(W.tagNameCheck,ae)||W.tagNameCheck instanceof Function&&W.tagNameCheck(ae)))return!1;if(F&&!H[ae]){var st=_(N)||N.parentNode,Vn=b(N)||N.childNodes;if(Vn&&st)for(var fn=Vn.length,ln=fn-1;ln>=0;--ln)st.insertBefore(v(Vn[ln],!0),y(N))}return wi(N),!0}return N instanceof a&&!kD(N)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&An(/<\/no(script|embed|frames)/i,N.innerHTML)?(wi(N),!0):(_e&&N.nodeType===3&&(ne=N.textContent,ne=yr(ne,pe," "),ne=yr(ne,Me," "),ne=yr(ne,Je," "),N.textContent!==ne&&(wl(e.removed,{element:N.cloneNode()}),N.textContent=ne)),Ci("afterSanitizeElements",N,null),!1)},ob=function(N,ne,ae){if(C&&(ne==="id"||ne==="name")&&(ae in r||ae in jo))return!1;if(!(ce&&!Z[ne]&&An(Pe,ne))){if(!(K&&An(R,ne))){if(!O[ne]||Z[ne]){if(!(sb(N)&&(W.tagNameCheck instanceof RegExp&&An(W.tagNameCheck,N)||W.tagNameCheck instanceof Function&&W.tagNameCheck(N))&&(W.attributeNameCheck instanceof RegExp&&An(W.attributeNameCheck,ne)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(ne))||ne==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&An(W.tagNameCheck,ae)||W.tagNameCheck instanceof Function&&W.tagNameCheck(ae))))return!1}else if(!U[ne]){if(!An(p,yr(ae,g,""))){if(!((ne==="src"||ne==="xlink:href"||ne==="href")&&N!=="script"&&TW(ae,"data:")===0&&V[N])){if(!(Ae&&!An(h,yr(ae,g,"")))){if(ae)return!1}}}}}}return!0},sb=function(N){return N.indexOf("-")>0},ab=function(N){var ne,ae,st,Vn;Ci("beforeSanitizeAttributes",N,null);var fn=N.attributes;if(fn){var ln={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:O};for(Vn=fn.length;Vn--;){ne=fn[Vn];var Rc=ne,en=Rc.name,ym=Rc.namespaceURI;if(ae=en==="value"?ne.value:_W(ne.value),st=$t(en),ln.attrName=st,ln.attrValue=ae,ln.keepAttr=!0,ln.forceKeepAttr=void 0,Ci("uponSanitizeAttribute",N,ln),ae=ln.attrValue,!ln.forceKeepAttr&&(Sm(en,N),!!ln.keepAttr)){if(!Te&&An(/\/>/i,ae)){Sm(en,N);continue}_e&&(ae=yr(ae,pe," "),ae=yr(ae,Me," "),ae=yr(ae,Je," "));var lb=$t(N.nodeName);if(ob(lb,st,ae)){if(S&&(st==="id"||st==="name")&&(Sm(en,N),ae=A+ae),L&&Ro(m)==="object"&&typeof m.getAttributeType=="function"&&!ym)switch(m.getAttributeType(lb,st)){case"TrustedHTML":{ae=L.createHTML(ae);break}case"TrustedScriptURL":{ae=L.createScriptURL(ae);break}}try{ym?N.setAttributeNS(ym,en,ae):N.setAttribute(en,ae),Jb(e.removed)}catch{}}}}Ci("afterSanitizeAttributes",N,null)}},WD=function be(N){var ne,ae=rb(N);for(Ci("beforeSanitizeShadowDOM",N,null);ne=ae.nextNode();)Ci("uponSanitizeShadowNode",ne,null),!ib(ne)&&(ne.content instanceof i&&be(ne.content),ab(ne));Ci("afterSanitizeShadowDOM",N,null)};return e.sanitize=function(be){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ne,ae,st,Vn,fn;if(wt=!be,wt&&(be="<!-->"),typeof be!="string"&&!pl(be))if(typeof be.toString=="function"){if(be=be.toString(),typeof be!="string")throw Um("dirty is not a string, aborting")}else throw Um("toString is not a function");if(!e.isSupported){if(Ro(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof be=="string")return t.toStaticHTML(be);if(pl(be))return t.toStaticHTML(be.outerHTML)}return be}if(Ge||qt(N),e.removed=[],typeof be=="string"&&(P=!1),P){if(be.nodeName){var ln=$t(be.nodeName);if(!E[ln]||q[ln])throw Um("root node is forbidden and cannot be sanitized in-place")}}else if(be instanceof s)ne=nb("<!---->"),ae=ne.ownerDocument.importNode(be,!0),ae.nodeType===1&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?ne=ae:ne.appendChild(ae);else{if(!ye&&!_e&&!G&&be.indexOf("<")===-1)return L&&Se?L.createHTML(be):be;if(ne=nb(be),!ne)return ye?null:Se?x:""}ne&&We&&wi(ne.firstChild);for(var Rc=rb(P?be:ne);st=Rc.nextNode();)st.nodeType===3&&st===Vn||ib(st)||(st.content instanceof i&&WD(st.content),ab(st),Vn=st);if(Vn=null,P)return be;if(ye){if(xe)for(fn=j.call(ne.ownerDocument);ne.firstChild;)fn.appendChild(ne.firstChild);else fn=ne;return(O.shadowroot||O.shadowrootmod)&&(fn=ie.call(n,fn,!0)),fn}var en=G?ne.outerHTML:ne.innerHTML;return G&&E["!doctype"]&&ne.ownerDocument&&ne.ownerDocument.doctype&&ne.ownerDocument.doctype.name&&An(kW,ne.ownerDocument.doctype.name)&&(en="<!DOCTYPE "+ne.ownerDocument.doctype.name+`>
`+en),_e&&(en=yr(en,pe," "),en=yr(en,Me," "),en=yr(en,Je," ")),L&&Se?L.createHTML(en):en},e.setConfig=function(be){qt(be),Ge=!0},e.clearConfig=function(){an=null,Ge=!1},e.isValidAttribute=function(be,N,ne){an||qt({});var ae=$t(be),st=$t(N);return ob(ae,st,ne)},e.addHook=function(be,N){typeof N=="function"&&(se[be]=se[be]||[],wl(se[be],N))},e.removeHook=function(be){if(se[be])return Jb(se[be])},e.removeHooks=function(be){se[be]&&(se[be]=[])},e.removeAllHooks=function(){se={}},e}var VW=qA();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var ZA;function Q(){return ZA.apply(null,arguments)}function BW(t){ZA=t}function Fr(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ls(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function it(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Fv(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(it(t,e))return!1;return!0}function Gn(t){return t===void 0}function Xi(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Zu(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function QA(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function To(t,e){for(var n in e)it(e,n)&&(t[n]=e[n]);return it(e,"toString")&&(t.toString=e.toString),it(e,"valueOf")&&(t.valueOf=e.valueOf),t}function gi(t,e,n,r){return bO(t,e,n,r,!0).utc()}function UW(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ye(t){return t._pf==null&&(t._pf=UW()),t._pf}var vC;Array.prototype.some?vC=Array.prototype.some:vC=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function Wv(t){if(t._isValid==null){var e=Ye(t),n=vC.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function mf(t){var e=gi(NaN);return t!=null?To(Ye(e),t):Ye(e).userInvalidated=!0,e}var iR=Q.momentProperties=[],Km=!1;function Vv(t,e){var n,r,i,o=iR.length;if(Gn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Gn(e._i)||(t._i=e._i),Gn(e._f)||(t._f=e._f),Gn(e._l)||(t._l=e._l),Gn(e._strict)||(t._strict=e._strict),Gn(e._tzm)||(t._tzm=e._tzm),Gn(e._isUTC)||(t._isUTC=e._isUTC),Gn(e._offset)||(t._offset=e._offset),Gn(e._pf)||(t._pf=Ye(e)),Gn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=iR[n],i=e[r],Gn(i)||(t[r]=i);return t}function Qu(t){Vv(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Km===!1&&(Km=!0,Q.updateOffset(this),Km=!1)}function Wr(t){return t instanceof Qu||t!=null&&t._isAMomentObject!=null}function JA(t){Q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Cr(t,e){var n=!0;return To(function(){if(Q.deprecationHandler!=null&&Q.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])it(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}JA(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var oR={};function eO(t,e){Q.deprecationHandler!=null&&Q.deprecationHandler(t,e),oR[t]||(JA(e),oR[t]=!0)}Q.suppressDeprecationWarnings=!1;Q.deprecationHandler=null;function mi(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function YW(t){var e,n;for(n in t)it(t,n)&&(e=t[n],mi(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function SC(t,e){var n=To({},t),r;for(r in e)it(e,r)&&(Ls(t[r])&&Ls(e[r])?(n[r]={},To(n[r],t[r]),To(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)it(t,r)&&!it(e,r)&&Ls(t[r])&&(n[r]=To({},n[r]));return n}function Bv(t){t!=null&&this.set(t)}var yC;Object.keys?yC=Object.keys:yC=function(t){var e,n=[];for(e in t)it(t,e)&&n.push(e);return n};var zW={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function GW(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return mi(r)?r.call(e,n):r}function hi(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var Uv=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ic=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Xm={},Ga={};function Re(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Ga[t]=i),e&&(Ga[e[0]]=function(){return hi(i.apply(this,arguments),e[1],e[2])}),n&&(Ga[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function jW(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function KW(t){var e=t.match(Uv),n,r;for(n=0,r=e.length;n<r;n++)Ga[e[n]]?e[n]=Ga[e[n]]:e[n]=jW(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=mi(e[s])?e[s].call(i,t):e[s];return o}}function jh(t,e){return t.isValid()?(e=tO(e,t.localeData()),Xm[e]=Xm[e]||KW(e),Xm[e](t)):t.localeData().invalidDate()}function tO(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(Ic.lastIndex=0;n>=0&&Ic.test(t);)t=t.replace(Ic,r),Ic.lastIndex=0,n-=1;return t}var XW={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function qW(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(Uv).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var ZW="Invalid date";function QW(){return this._invalidDate}var JW="%d",eV=/\d{1,2}/;function tV(t){return this._ordinal.replace("%d",t)}var nV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function rV(t,e,n,r){var i=this._relativeTime[n];return mi(i)?i(t,e,n,r):i.replace(/%d/i,t)}function iV(t,e){var n=this._relativeTime[t>0?"future":"past"];return mi(n)?n(e):n.replace(/%s/i,e)}var uu={};function Tn(t,e){var n=t.toLowerCase();uu[n]=uu[n+"s"]=uu[e]=t}function vr(t){return typeof t=="string"?uu[t]||uu[t.toLowerCase()]:void 0}function Yv(t){var e={},n,r;for(r in t)it(t,r)&&(n=vr(r),n&&(e[n]=t[r]));return e}var nO={};function _n(t,e){nO[t]=e}function oV(t){var e=[],n;for(n in t)it(t,n)&&e.push({unit:n,priority:nO[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function pf(t){return t%4===0&&t%100!==0||t%400===0}function mr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=mr(e)),n}function il(t,e){return function(n){return n!=null?(rO(this,t,n),Q.updateOffset(this,e),this):Rd(this,t)}}function Rd(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function rO(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&pf(t.year())&&t.month()===1&&t.date()===29?(n=Qe(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),bf(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function sV(t){return t=vr(t),mi(this[t])?this[t]():this}function aV(t,e){if(typeof t=="object"){t=Yv(t);var n=oV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=vr(t),mi(this[t]))return this[t](e);return this}var iO=/\d/,sr=/\d\d/,oO=/\d{3}/,zv=/\d{4}/,wf=/[+-]?\d{6}/,bt=/\d\d?/,sO=/\d\d\d\d?/,aO=/\d\d\d\d\d\d?/,Cf=/\d{1,3}/,Gv=/\d{1,4}/,vf=/[+-]?\d{1,6}/,ol=/\d+/,Sf=/[+-]?\d+/,lV=/Z|[+-]\d\d:?\d\d/gi,yf=/Z|[+-]\d\d(?::?\d\d)?/gi,uV=/[+-]?\d+(\.\d{1,3})?/,Ju=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ed;Ed={};function ge(t,e,n){Ed[t]=mi(e)?e:function(r,i){return r&&n?n:e}}function cV(t,e){return it(Ed,t)?Ed[t](e._strict,e._locale):new RegExp(hV(t))}function hV(t){return nr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function nr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var bC={};function ht(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Xi(e)&&(r=function(o,s){s[e]=Qe(o)}),i=t.length,n=0;n<i;n++)bC[t[n]]=r}function ec(t,e){ht(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function dV(t,e,n){e!=null&&it(bC,t)&&bC[t](e,n._a,n,t)}var yn=0,Fi=1,ai=2,Qt=3,Nr=4,Wi=5,Is=6,fV=7,gV=8;function mV(t,e){return(t%e+e)%e}var Vt;Array.prototype.indexOf?Vt=Array.prototype.indexOf:Vt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function bf(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=mV(e,12);return t+=(e-n)/12,n===1?pf(t)?29:28:31-n%7%2}Re("M",["MM",2],"Mo",function(){return this.month()+1});Re("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Re("MMMM",0,0,function(t){return this.localeData().months(this,t)});Tn("month","M");_n("month",8);ge("M",bt);ge("MM",bt,sr);ge("MMM",function(t,e){return e.monthsShortRegex(t)});ge("MMMM",function(t,e){return e.monthsRegex(t)});ht(["M","MM"],function(t,e){e[Fi]=Qe(t)-1});ht(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Fi]=i:Ye(n).invalidMonth=t});var pV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),lO="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),uO=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,wV=Ju,CV=Ju;function vV(t,e){return t?Fr(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||uO).test(e)?"format":"standalone"][t.month()]:Fr(this._months)?this._months:this._months.standalone}function SV(t,e){return t?Fr(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[uO.test(e)?"format":"standalone"][t.month()]:Fr(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function yV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=gi([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Vt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:(i=Vt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Vt.call(this._longMonthsParse,s),i!==-1?i:(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:null))}function bV(t,e,n){var r,i,o;if(this._monthsParseExact)return yV.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=gi([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function cO(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!Xi(e))return t}return n=Math.min(t.date(),bf(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function hO(t){return t!=null?(cO(this,t),Q.updateOffset(this,!0),this):Rd(this,"Month")}function RV(){return bf(this.year(),this.month())}function EV(t){return this._monthsParseExact?(it(this,"_monthsRegex")||dO.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=wV),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function TV(t){return this._monthsParseExact?(it(this,"_monthsRegex")||dO.call(this),t?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=CV),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function dO(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=gi([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=nr(e[i]),n[i]=nr(n[i]);for(i=0;i<24;i++)r[i]=nr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Re("Y",0,0,function(){var t=this.year();return t<=9999?hi(t,4):"+"+t});Re(0,["YY",2],0,function(){return this.year()%100});Re(0,["YYYY",4],0,"year");Re(0,["YYYYY",5],0,"year");Re(0,["YYYYYY",6,!0],0,"year");Tn("year","y");_n("year",1);ge("Y",Sf);ge("YY",bt,sr);ge("YYYY",Gv,zv);ge("YYYYY",vf,wf);ge("YYYYYY",vf,wf);ht(["YYYYY","YYYYYY"],yn);ht("YYYY",function(t,e){e[yn]=t.length===2?Q.parseTwoDigitYear(t):Qe(t)});ht("YY",function(t,e){e[yn]=Q.parseTwoDigitYear(t)});ht("Y",function(t,e){e[yn]=parseInt(t,10)});function cu(t){return pf(t)?366:365}Q.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var fO=il("FullYear",!0);function _V(){return pf(this.year())}function MV(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Au(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Td(t,e,n){var r=7+e-n,i=(7+Au(t,0,r).getUTCDay()-e)%7;return-i+r-1}function gO(t,e,n,r,i){var o=(7+n-r)%7,s=Td(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=cu(l)+a):a>cu(t)?(l=t+1,u=a-cu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Ou(t,e,n){var r=Td(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Ki(s,e,n)):i>Ki(t.year(),e,n)?(o=i-Ki(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Ki(t,e,n){var r=Td(t,e,n),i=Td(t+1,e,n);return(cu(t)-r+i)/7}Re("w",["ww",2],"wo","week");Re("W",["WW",2],"Wo","isoWeek");Tn("week","w");Tn("isoWeek","W");_n("week",5);_n("isoWeek",5);ge("w",bt);ge("ww",bt,sr);ge("W",bt);ge("WW",bt,sr);ec(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Qe(t)});function AV(t){return Ou(t,this._week.dow,this._week.doy).week}var OV={dow:0,doy:6};function IV(){return this._week.dow}function PV(){return this._week.doy}function xV(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function HV(t){var e=Ou(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Re("d",0,"do","day");Re("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Re("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Re("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Re("e",0,0,"weekday");Re("E",0,0,"isoWeekday");Tn("day","d");Tn("weekday","e");Tn("isoWeekday","E");_n("day",11);_n("weekday",11);_n("isoWeekday",11);ge("d",bt);ge("e",bt);ge("E",bt);ge("dd",function(t,e){return e.weekdaysMinRegex(t)});ge("ddd",function(t,e){return e.weekdaysShortRegex(t)});ge("dddd",function(t,e){return e.weekdaysRegex(t)});ec(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:Ye(n).invalidWeekday=t});ec(["d","e","E"],function(t,e,n,r){e[r]=Qe(t)});function DV(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function NV(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function jv(t,e){return t.slice(e,7).concat(t.slice(0,e))}var LV="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),mO="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),$V="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),kV=Ju,FV=Ju,WV=Ju;function VV(t,e){var n=Fr(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?jv(n,this._week.dow):t?n[t.day()]:n}function BV(t){return t===!0?jv(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function UV(t){return t===!0?jv(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function YV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=gi([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Vt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Vt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Vt.call(this._weekdaysParse,s),i!==-1||(i=Vt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Vt.call(this._shortWeekdaysParse,s),i!==-1||(i=Vt.call(this._weekdaysParse,s),i!==-1)?i:(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Vt.call(this._minWeekdaysParse,s),i!==-1||(i=Vt.call(this._weekdaysParse,s),i!==-1)?i:(i=Vt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function zV(t,e,n){var r,i,o;if(this._weekdaysParseExact)return YV.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=gi([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function GV(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=DV(t,this.localeData()),this.add(t-e,"d")):e}function jV(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function KV(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=NV(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function XV(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||Kv.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=kV),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function qV(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||Kv.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=FV),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function ZV(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||Kv.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=WV),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Kv(){function t(c,d){return d.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=gi([2e3,1]).day(o),a=nr(this.weekdaysMin(s,"")),l=nr(this.weekdaysShort(s,"")),u=nr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Xv(){return this.hours()%12||12}function QV(){return this.hours()||24}Re("H",["HH",2],0,"hour");Re("h",["hh",2],0,Xv);Re("k",["kk",2],0,QV);Re("hmm",0,0,function(){return""+Xv.apply(this)+hi(this.minutes(),2)});Re("hmmss",0,0,function(){return""+Xv.apply(this)+hi(this.minutes(),2)+hi(this.seconds(),2)});Re("Hmm",0,0,function(){return""+this.hours()+hi(this.minutes(),2)});Re("Hmmss",0,0,function(){return""+this.hours()+hi(this.minutes(),2)+hi(this.seconds(),2)});function pO(t,e){Re(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}pO("a",!0);pO("A",!1);Tn("hour","h");_n("hour",13);function wO(t,e){return e._meridiemParse}ge("a",wO);ge("A",wO);ge("H",bt);ge("h",bt);ge("k",bt);ge("HH",bt,sr);ge("hh",bt,sr);ge("kk",bt,sr);ge("hmm",sO);ge("hmmss",aO);ge("Hmm",sO);ge("Hmmss",aO);ht(["H","HH"],Qt);ht(["k","kk"],function(t,e,n){var r=Qe(t);e[Qt]=r===24?0:r});ht(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});ht(["h","hh"],function(t,e,n){e[Qt]=Qe(t),Ye(n).bigHour=!0});ht("hmm",function(t,e,n){var r=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[Nr]=Qe(t.substr(r)),Ye(n).bigHour=!0});ht("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[Nr]=Qe(t.substr(r,2)),e[Wi]=Qe(t.substr(i)),Ye(n).bigHour=!0});ht("Hmm",function(t,e,n){var r=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[Nr]=Qe(t.substr(r))});ht("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[Nr]=Qe(t.substr(r,2)),e[Wi]=Qe(t.substr(i))});function JV(t){return(t+"").toLowerCase().charAt(0)==="p"}var eB=/[ap]\.?m?\.?/i,tB=il("Hours",!0);function nB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var CO={calendar:zW,longDateFormat:XW,invalidDate:ZW,ordinal:JW,dayOfMonthOrdinalParse:eV,relativeTime:nV,months:pV,monthsShort:lO,week:OV,weekdays:LV,weekdaysMin:$V,weekdaysShort:mO,meridiemParse:eB},_t={},Cl={},Iu;function rB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function sR(t){return t&&t.toLowerCase().replace("_","-")}function iB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=sR(t[e]).split("-"),n=o.length,r=sR(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Rf(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&rB(o,r)>=n-1)break;n--}e++}return Iu}function oB(t){return t.match("^[^/\\\\]*$")!=null}function Rf(t){var e=null,n;if(_t[t]===void 0&&typeof wd<"u"&&wd&&wd.exports&&oB(t))try{e=Iu._abbr,n=require,n("./locale/"+t),Io(e)}catch{_t[t]=null}return _t[t]}function Io(t,e){var n;return t&&(Gn(e)?n=eo(t):n=qv(t,e),n?Iu=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Iu._abbr}function qv(t,e){if(e!==null){var n,r=CO;if(e.abbr=t,_t[t]!=null)eO("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=_t[t]._config;else if(e.parentLocale!=null)if(_t[e.parentLocale]!=null)r=_t[e.parentLocale]._config;else if(n=Rf(e.parentLocale),n!=null)r=n._config;else return Cl[e.parentLocale]||(Cl[e.parentLocale]=[]),Cl[e.parentLocale].push({name:t,config:e}),null;return _t[t]=new Bv(SC(r,e)),Cl[t]&&Cl[t].forEach(function(i){qv(i.name,i.config)}),Io(t),_t[t]}else return delete _t[t],null}function sB(t,e){if(e!=null){var n,r,i=CO;_t[t]!=null&&_t[t].parentLocale!=null?_t[t].set(SC(_t[t]._config,e)):(r=Rf(t),r!=null&&(i=r._config),e=SC(i,e),r==null&&(e.abbr=t),n=new Bv(e),n.parentLocale=_t[t],_t[t]=n),Io(t)}else _t[t]!=null&&(_t[t].parentLocale!=null?(_t[t]=_t[t].parentLocale,t===Io()&&Io(t)):_t[t]!=null&&delete _t[t]);return _t[t]}function eo(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Iu;if(!Fr(t)){if(e=Rf(t),e)return e;t=[t]}return iB(t)}function aB(){return yC(_t)}function Zv(t){var e,n=t._a;return n&&Ye(t).overflow===-2&&(e=n[Fi]<0||n[Fi]>11?Fi:n[ai]<1||n[ai]>bf(n[yn],n[Fi])?ai:n[Qt]<0||n[Qt]>24||n[Qt]===24&&(n[Nr]!==0||n[Wi]!==0||n[Is]!==0)?Qt:n[Nr]<0||n[Nr]>59?Nr:n[Wi]<0||n[Wi]>59?Wi:n[Is]<0||n[Is]>999?Is:-1,Ye(t)._overflowDayOfYear&&(e<yn||e>ai)&&(e=ai),Ye(t)._overflowWeeks&&e===-1&&(e=fV),Ye(t)._overflowWeekday&&e===-1&&(e=gV),Ye(t).overflow=e),t}var lB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,uB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,cB=/Z|[+-]\d\d(?::?\d\d)?/,Pc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],qm=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],hB=/^\/?Date\((-?\d+)/i,dB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,fB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function vO(t){var e,n,r=t._i,i=lB.exec(r)||uB.exec(r),o,s,a,l,u=Pc.length,c=qm.length;if(i){for(Ye(t).iso=!0,e=0,n=u;e<n;e++)if(Pc[e][1].exec(i[1])){s=Pc[e][0],o=Pc[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(qm[e][1].exec(i[3])){a=(i[2]||" ")+qm[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(cB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),Jv(t)}else t._isValid=!1}function gB(t,e,n,r,i,o){var s=[mB(t),lO.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function mB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function pB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function wB(t,e,n){if(t){var r=mO.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return Ye(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function CB(t,e,n){if(t)return fB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function SO(t){var e=dB.exec(pB(t._i)),n;if(e){if(n=gB(e[4],e[3],e[2],e[5],e[6],e[7]),!wB(e[1],n,t))return;t._a=n,t._tzm=CB(e[8],e[9],e[10]),t._d=Au.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ye(t).rfc2822=!0}else t._isValid=!1}function vB(t){var e=hB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(vO(t),t._isValid===!1)delete t._isValid;else return;if(SO(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Q.createFromInputFallback(t)}Q.createFromInputFallback=Cr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function La(t,e,n){return t??e??n}function SB(t){var e=new Date(Q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Qv(t){var e,n,r=[],i,o,s;if(!t._d){for(i=SB(t),t._w&&t._a[ai]==null&&t._a[Fi]==null&&yB(t),t._dayOfYear!=null&&(s=La(t._a[yn],i[yn]),(t._dayOfYear>cu(s)||t._dayOfYear===0)&&(Ye(t)._overflowDayOfYear=!0),n=Au(s,0,t._dayOfYear),t._a[Fi]=n.getUTCMonth(),t._a[ai]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Qt]===24&&t._a[Nr]===0&&t._a[Wi]===0&&t._a[Is]===0&&(t._nextDay=!0,t._a[Qt]=0),t._d=(t._useUTC?Au:MV).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Qt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(Ye(t).weekdayMismatch=!0)}}function yB(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=La(e.GG,t._a[yn],Ou(yt(),1,4).year),r=La(e.W,1),i=La(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Ou(yt(),o,s),n=La(e.gg,t._a[yn],u.year),r=La(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Ki(n,o,s)?Ye(t)._overflowWeeks=!0:l!=null?Ye(t)._overflowWeekday=!0:(a=gO(n,r,i,o,s),t._a[yn]=a.year,t._dayOfYear=a.dayOfYear)}Q.ISO_8601=function(){};Q.RFC_2822=function(){};function Jv(t){if(t._f===Q.ISO_8601){vO(t);return}if(t._f===Q.RFC_2822){SO(t);return}t._a=[],Ye(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=tO(t._f,t._locale).match(Uv)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(cV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&Ye(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Ga[o]?(r?Ye(t).empty=!1:Ye(t).unusedTokens.push(o),dV(o,r,t)):t._strict&&!r&&Ye(t).unusedTokens.push(o);Ye(t).charsLeftOver=a-l,e.length>0&&Ye(t).unusedInput.push(e),t._a[Qt]<=12&&Ye(t).bigHour===!0&&t._a[Qt]>0&&(Ye(t).bigHour=void 0),Ye(t).parsedDateParts=t._a.slice(0),Ye(t).meridiem=t._meridiem,t._a[Qt]=bB(t._locale,t._a[Qt],t._meridiem),u=Ye(t).era,u!==null&&(t._a[yn]=t._locale.erasConvertYear(u,t._a[yn])),Qv(t),Zv(t)}function bB(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function RB(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){Ye(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=Vv({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Jv(e),Wv(e)&&(s=!0),o+=Ye(e).charsLeftOver,o+=Ye(e).unusedTokens.length*10,Ye(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));To(t,n||e)}function EB(t){if(!t._d){var e=Yv(t._i),n=e.day===void 0?e.date:e.day;t._a=QA([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),Qv(t)}}function TB(t){var e=new Qu(Zv(yO(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function yO(t){var e=t._i,n=t._f;return t._locale=t._locale||eo(t._l),e===null||n===void 0&&e===""?mf({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Wr(e)?new Qu(Zv(e)):(Zu(e)?t._d=e:Fr(n)?RB(t):n?Jv(t):_B(t),Wv(t)||(t._d=null),t))}function _B(t){var e=t._i;Gn(e)?t._d=new Date(Q.now()):Zu(e)?t._d=new Date(e.valueOf()):typeof e=="string"?vB(t):Fr(e)?(t._a=QA(e.slice(0),function(n){return parseInt(n,10)}),Qv(t)):Ls(e)?EB(t):Xi(e)?t._d=new Date(e):Q.createFromInputFallback(t)}function bO(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Ls(t)&&Fv(t)||Fr(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,TB(o)}function yt(t,e,n,r){return bO(t,e,n,r,!1)}var MB=Cr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=yt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:mf()}),AB=Cr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=yt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:mf()});function RO(t,e){var n,r;if(e.length===1&&Fr(e[0])&&(e=e[0]),!e.length)return yt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function OB(){var t=[].slice.call(arguments,0);return RO("isBefore",t)}function IB(){var t=[].slice.call(arguments,0);return RO("isAfter",t)}var PB=function(){return Date.now?Date.now():+new Date},vl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function xB(t){var e,n=!1,r,i=vl.length;for(e in t)if(it(t,e)&&!(Vt.call(vl,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[vl[r]]){if(n)return!1;parseFloat(t[vl[r]])!==Qe(t[vl[r]])&&(n=!0)}return!0}function HB(){return this._isValid}function DB(){return Br(NaN)}function Ef(t){var e=Yv(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=xB(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=eo(),this._bubble()}function Kh(t){return t instanceof Ef}function RC(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function NB(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&Qe(t[s])!==Qe(e[s]))&&o++;return o+i}function EO(t,e){Re(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+hi(~~(n/60),2)+e+hi(~~n%60,2)})}EO("Z",":");EO("ZZ","");ge("Z",yf);ge("ZZ",yf);ht(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=eS(yf,t)});var LB=/([\+\-]|\d\d)/gi;function eS(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(LB)||["-",0,0],o=+(i[1]*60)+Qe(i[2]),o===0?0:i[0]==="+"?o:-o)}function tS(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(Wr(t)||Zu(t)?t.valueOf():yt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),Q.updateOffset(n,!1),n):yt(t).local()}function EC(t){return-Math.round(t._d.getTimezoneOffset())}Q.updateOffset=function(){};function $B(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=eS(yf,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=EC(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?MO(this,Br(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:EC(this)}function kB(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function FB(t){return this.utcOffset(0,t)}function WB(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(EC(this),"m")),this}function VB(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=eS(lV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function BB(t){return this.isValid()?(t=t?yt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function UB(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function YB(){if(!Gn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Vv(t,this),t=yO(t),t._a?(e=t._isUTC?gi(t._a):yt(t._a),this._isDSTShifted=this.isValid()&&NB(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function zB(){return this.isValid()?!this._isUTC:!1}function GB(){return this.isValid()?this._isUTC:!1}function TO(){return this.isValid()?this._isUTC&&this._offset===0:!1}var jB=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,KB=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Br(t,e){var n=t,r=null,i,o,s;return Kh(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Xi(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=jB.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Qe(r[ai])*i,h:Qe(r[Qt])*i,m:Qe(r[Nr])*i,s:Qe(r[Wi])*i,ms:Qe(RC(r[Is]*1e3))*i}):(r=KB.exec(t))?(i=r[1]==="-"?-1:1,n={y:qo(r[2],i),M:qo(r[3],i),w:qo(r[4],i),d:qo(r[5],i),h:qo(r[6],i),m:qo(r[7],i),s:qo(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=XB(yt(n.from),yt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Ef(n),Kh(t)&&it(t,"_locale")&&(o._locale=t._locale),Kh(t)&&it(t,"_isValid")&&(o._isValid=t._isValid),o}Br.fn=Ef.prototype;Br.invalid=DB;function qo(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function aR(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function XB(t,e){var n;return t.isValid()&&e.isValid()?(e=tS(e,t),t.isBefore(e)?n=aR(t,e):(n=aR(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function _O(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(eO(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Br(n,r),MO(this,i,t),this}}function MO(t,e,n,r){var i=e._milliseconds,o=RC(e._days),s=RC(e._months);t.isValid()&&(r=r??!0,s&&cO(t,Rd(t,"Month")+s*n),o&&rO(t,"Date",Rd(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&Q.updateOffset(t,o||s))}var qB=_O(1,"add"),ZB=_O(-1,"subtract");function AO(t){return typeof t=="string"||t instanceof String}function QB(t){return Wr(t)||Zu(t)||AO(t)||Xi(t)||e2(t)||JB(t)||t===null||t===void 0}function JB(t){var e=Ls(t)&&!Fv(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||it(t,o);return e&&n}function e2(t){var e=Fr(t),n=!1;return e&&(n=t.filter(function(r){return!Xi(r)&&AO(t)}).length===0),e&&n}function t2(t){var e=Ls(t)&&!Fv(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||it(t,o);return e&&n}function n2(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function r2(t,e){arguments.length===1&&(arguments[0]?QB(arguments[0])?(t=arguments[0],e=void 0):t2(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||yt(),r=tS(n,this).startOf("day"),i=Q.calendarFormat(this,r)||"sameElse",o=e&&(mi(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,yt(n)))}function i2(){return new Qu(this)}function o2(t,e){var n=Wr(t)?t:yt(t);return this.isValid()&&n.isValid()?(e=vr(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function s2(t,e){var n=Wr(t)?t:yt(t);return this.isValid()&&n.isValid()?(e=vr(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function a2(t,e,n,r){var i=Wr(t)?t:yt(t),o=Wr(e)?e:yt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function l2(t,e){var n=Wr(t)?t:yt(t),r;return this.isValid()&&n.isValid()?(e=vr(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function u2(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function c2(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function h2(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=tS(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=vr(e),e){case"year":o=Xh(this,r)/12;break;case"month":o=Xh(this,r);break;case"quarter":o=Xh(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:mr(o)}function Xh(t,e){if(t.date()<e.date())return-Xh(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}Q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function d2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function f2(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?jh(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):mi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",jh(n,"Z")):jh(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function g2(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function m2(t){t||(t=this.isUtc()?Q.defaultFormatUtc:Q.defaultFormat);var e=jh(this,t);return this.localeData().postformat(e)}function p2(t,e){return this.isValid()&&(Wr(t)&&t.isValid()||yt(t).isValid())?Br({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function w2(t){return this.from(yt(),t)}function C2(t,e){return this.isValid()&&(Wr(t)&&t.isValid()||yt(t).isValid())?Br({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function v2(t){return this.to(yt(),t)}function OO(t){var e;return t===void 0?this._locale._abbr:(e=eo(t),e!=null&&(this._locale=e),this)}var IO=Cr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function PO(){return this._locale}var _d=1e3,ja=60*_d,Md=60*ja,xO=(365*400+97)*24*Md;function Ka(t,e){return(t%e+e)%e}function HO(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-xO:new Date(t,e,n).valueOf()}function DO(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-xO:Date.UTC(t,e,n)}function S2(t){var e,n;if(t=vr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?DO:HO,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ka(e+(this._isUTC?0:this.utcOffset()*ja),Md);break;case"minute":e=this._d.valueOf(),e-=Ka(e,ja);break;case"second":e=this._d.valueOf(),e-=Ka(e,_d);break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function y2(t){var e,n;if(t=vr(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?DO:HO,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Md-Ka(e+(this._isUTC?0:this.utcOffset()*ja),Md)-1;break;case"minute":e=this._d.valueOf(),e+=ja-Ka(e,ja)-1;break;case"second":e=this._d.valueOf(),e+=_d-Ka(e,_d)-1;break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function b2(){return this._d.valueOf()-(this._offset||0)*6e4}function R2(){return Math.floor(this.valueOf()/1e3)}function E2(){return new Date(this.valueOf())}function T2(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function _2(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function M2(){return this.isValid()?this.toISOString():null}function A2(){return Wv(this)}function O2(){return To({},Ye(this))}function I2(){return Ye(this).overflow}function P2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Re("N",0,0,"eraAbbr");Re("NN",0,0,"eraAbbr");Re("NNN",0,0,"eraAbbr");Re("NNNN",0,0,"eraName");Re("NNNNN",0,0,"eraNarrow");Re("y",["y",1],"yo","eraYear");Re("y",["yy",2],0,"eraYear");Re("y",["yyy",3],0,"eraYear");Re("y",["yyyy",4],0,"eraYear");ge("N",nS);ge("NN",nS);ge("NNN",nS);ge("NNNN",B2);ge("NNNNN",U2);ht(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?Ye(n).era=i:Ye(n).invalidEra=t});ge("y",ol);ge("yy",ol);ge("yyy",ol);ge("yyyy",ol);ge("yo",Y2);ht(["y","yy","yyy","yyyy"],yn);ht(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[yn]=n._locale.eraYearOrdinalParse(t,i):e[yn]=parseInt(t,10)});function x2(t,e){var n,r,i,o=this._eras||eo("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=Q(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=Q(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function H2(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function D2(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Q(t.since).year():Q(t.since).year()+(e-t.offset)*n}function N2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function L2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function $2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function k2(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-Q(i[t].since).year())*n+i[t].offset;return this.year()}function F2(t){return it(this,"_erasNameRegex")||rS.call(this),t?this._erasNameRegex:this._erasRegex}function W2(t){return it(this,"_erasAbbrRegex")||rS.call(this),t?this._erasAbbrRegex:this._erasRegex}function V2(t){return it(this,"_erasNarrowRegex")||rS.call(this),t?this._erasNarrowRegex:this._erasRegex}function nS(t,e){return e.erasAbbrRegex(t)}function B2(t,e){return e.erasNameRegex(t)}function U2(t,e){return e.erasNarrowRegex(t)}function Y2(t,e){return e._eraYearOrdinalRegex||ol}function rS(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(nr(s[i].name)),t.push(nr(s[i].abbr)),n.push(nr(s[i].narrow)),r.push(nr(s[i].name)),r.push(nr(s[i].abbr)),r.push(nr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Re(0,["gg",2],0,function(){return this.weekYear()%100});Re(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Tf(t,e){Re(0,[t,t.length],0,e)}Tf("gggg","weekYear");Tf("ggggg","weekYear");Tf("GGGG","isoWeekYear");Tf("GGGGG","isoWeekYear");Tn("weekYear","gg");Tn("isoWeekYear","GG");_n("weekYear",1);_n("isoWeekYear",1);ge("G",Sf);ge("g",Sf);ge("GG",bt,sr);ge("gg",bt,sr);ge("GGGG",Gv,zv);ge("gggg",Gv,zv);ge("GGGGG",vf,wf);ge("ggggg",vf,wf);ec(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Qe(t)});ec(["gg","GG"],function(t,e,n,r){e[r]=Q.parseTwoDigitYear(t)});function z2(t){return NO.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function G2(t){return NO.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function j2(){return Ki(this.year(),1,4)}function K2(){return Ki(this.isoWeekYear(),1,4)}function X2(){var t=this.localeData()._week;return Ki(this.year(),t.dow,t.doy)}function q2(){var t=this.localeData()._week;return Ki(this.weekYear(),t.dow,t.doy)}function NO(t,e,n,r,i){var o;return t==null?Ou(this,r,i).year:(o=Ki(t,r,i),e>o&&(e=o),Z2.call(this,t,e,n,r,i))}function Z2(t,e,n,r,i){var o=gO(t,e,n,r,i),s=Au(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Re("Q",0,"Qo","quarter");Tn("quarter","Q");_n("quarter",7);ge("Q",iO);ht("Q",function(t,e){e[Fi]=(Qe(t)-1)*3});function Q2(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Re("D",["DD",2],"Do","date");Tn("date","D");_n("date",9);ge("D",bt);ge("DD",bt,sr);ge("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ht(["D","DD"],ai);ht("Do",function(t,e){e[ai]=Qe(t.match(bt)[0])});var LO=il("Date",!0);Re("DDD",["DDDD",3],"DDDo","dayOfYear");Tn("dayOfYear","DDD");_n("dayOfYear",4);ge("DDD",Cf);ge("DDDD",oO);ht(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function J2(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Re("m",["mm",2],0,"minute");Tn("minute","m");_n("minute",14);ge("m",bt);ge("mm",bt,sr);ht(["m","mm"],Nr);var eU=il("Minutes",!1);Re("s",["ss",2],0,"second");Tn("second","s");_n("second",15);ge("s",bt);ge("ss",bt,sr);ht(["s","ss"],Wi);var tU=il("Seconds",!1);Re("S",0,0,function(){return~~(this.millisecond()/100)});Re(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Re(0,["SSS",3],0,"millisecond");Re(0,["SSSS",4],0,function(){return this.millisecond()*10});Re(0,["SSSSS",5],0,function(){return this.millisecond()*100});Re(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Re(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Re(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Re(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Tn("millisecond","ms");_n("millisecond",16);ge("S",Cf,iO);ge("SS",Cf,sr);ge("SSS",Cf,oO);var _o,$O;for(_o="SSSS";_o.length<=9;_o+="S")ge(_o,ol);function nU(t,e){e[Is]=Qe(("0."+t)*1e3)}for(_o="S";_o.length<=9;_o+="S")ht(_o,nU);$O=il("Milliseconds",!1);Re("z",0,0,"zoneAbbr");Re("zz",0,0,"zoneName");function rU(){return this._isUTC?"UTC":""}function iU(){return this._isUTC?"Coordinated Universal Time":""}var te=Qu.prototype;te.add=qB;te.calendar=r2;te.clone=i2;te.diff=h2;te.endOf=y2;te.format=m2;te.from=p2;te.fromNow=w2;te.to=C2;te.toNow=v2;te.get=sV;te.invalidAt=I2;te.isAfter=o2;te.isBefore=s2;te.isBetween=a2;te.isSame=l2;te.isSameOrAfter=u2;te.isSameOrBefore=c2;te.isValid=A2;te.lang=IO;te.locale=OO;te.localeData=PO;te.max=AB;te.min=MB;te.parsingFlags=O2;te.set=aV;te.startOf=S2;te.subtract=ZB;te.toArray=T2;te.toObject=_2;te.toDate=E2;te.toISOString=f2;te.inspect=g2;typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});te.toJSON=M2;te.toString=d2;te.unix=R2;te.valueOf=b2;te.creationData=P2;te.eraName=N2;te.eraNarrow=L2;te.eraAbbr=$2;te.eraYear=k2;te.year=fO;te.isLeapYear=_V;te.weekYear=z2;te.isoWeekYear=G2;te.quarter=te.quarters=Q2;te.month=hO;te.daysInMonth=RV;te.week=te.weeks=xV;te.isoWeek=te.isoWeeks=HV;te.weeksInYear=X2;te.weeksInWeekYear=q2;te.isoWeeksInYear=j2;te.isoWeeksInISOWeekYear=K2;te.date=LO;te.day=te.days=GV;te.weekday=jV;te.isoWeekday=KV;te.dayOfYear=J2;te.hour=te.hours=tB;te.minute=te.minutes=eU;te.second=te.seconds=tU;te.millisecond=te.milliseconds=$O;te.utcOffset=$B;te.utc=FB;te.local=WB;te.parseZone=VB;te.hasAlignedHourOffset=BB;te.isDST=UB;te.isLocal=zB;te.isUtcOffset=GB;te.isUtc=TO;te.isUTC=TO;te.zoneAbbr=rU;te.zoneName=iU;te.dates=Cr("dates accessor is deprecated. Use date instead.",LO);te.months=Cr("months accessor is deprecated. Use month instead",hO);te.years=Cr("years accessor is deprecated. Use year instead",fO);te.zone=Cr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",kB);te.isDSTShifted=Cr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",YB);function oU(t){return yt(t*1e3)}function sU(){return yt.apply(null,arguments).parseZone()}function kO(t){return t}var ot=Bv.prototype;ot.calendar=GW;ot.longDateFormat=qW;ot.invalidDate=QW;ot.ordinal=tV;ot.preparse=kO;ot.postformat=kO;ot.relativeTime=rV;ot.pastFuture=iV;ot.set=YW;ot.eras=x2;ot.erasParse=H2;ot.erasConvertYear=D2;ot.erasAbbrRegex=W2;ot.erasNameRegex=F2;ot.erasNarrowRegex=V2;ot.months=vV;ot.monthsShort=SV;ot.monthsParse=bV;ot.monthsRegex=TV;ot.monthsShortRegex=EV;ot.week=AV;ot.firstDayOfYear=PV;ot.firstDayOfWeek=IV;ot.weekdays=VV;ot.weekdaysMin=UV;ot.weekdaysShort=BV;ot.weekdaysParse=zV;ot.weekdaysRegex=XV;ot.weekdaysShortRegex=qV;ot.weekdaysMinRegex=ZV;ot.isPM=JV;ot.meridiem=nB;function Ad(t,e,n,r){var i=eo(),o=gi().set(r,e);return i[n](o,t)}function FO(t,e,n){if(Xi(t)&&(e=t,t=void 0),t=t||"",e!=null)return Ad(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Ad(t,r,n,"month");return i}function iS(t,e,n,r){typeof t=="boolean"?(Xi(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Xi(e)&&(n=e,e=void 0),e=e||"");var i=eo(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Ad(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Ad(e,(s+o)%7,r,"day");return a}function aU(t,e){return FO(t,e,"months")}function lU(t,e){return FO(t,e,"monthsShort")}function uU(t,e,n){return iS(t,e,n,"weekdays")}function cU(t,e,n){return iS(t,e,n,"weekdaysShort")}function hU(t,e,n){return iS(t,e,n,"weekdaysMin")}Io("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Q.lang=Cr("moment.lang is deprecated. Use moment.locale instead.",Io);Q.langData=Cr("moment.langData is deprecated. Use moment.localeData instead.",eo);var vi=Math.abs;function dU(){var t=this._data;return this._milliseconds=vi(this._milliseconds),this._days=vi(this._days),this._months=vi(this._months),t.milliseconds=vi(t.milliseconds),t.seconds=vi(t.seconds),t.minutes=vi(t.minutes),t.hours=vi(t.hours),t.months=vi(t.months),t.years=vi(t.years),this}function WO(t,e,n,r){var i=Br(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function fU(t,e){return WO(this,t,e,1)}function gU(t,e){return WO(this,t,e,-1)}function lR(t){return t<0?Math.floor(t):Math.ceil(t)}function mU(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=lR(TC(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=mr(t/1e3),r.seconds=i%60,o=mr(i/60),r.minutes=o%60,s=mr(o/60),r.hours=s%24,e+=mr(s/24),l=mr(VO(e)),n+=l,e-=lR(TC(l)),a=mr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function VO(t){return t*4800/146097}function TC(t){return t*146097/4800}function pU(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=vr(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+VO(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(TC(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function wU(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function to(t){return function(){return this.as(t)}}var CU=to("ms"),vU=to("s"),SU=to("m"),yU=to("h"),bU=to("d"),RU=to("w"),EU=to("M"),TU=to("Q"),_U=to("y");function MU(){return Br(this)}function AU(t){return t=vr(t),this.isValid()?this[t+"s"]():NaN}function js(t){return function(){return this.isValid()?this._data[t]:NaN}}var OU=js("milliseconds"),IU=js("seconds"),PU=js("minutes"),xU=js("hours"),HU=js("days"),DU=js("months"),NU=js("years");function LU(){return mr(this.days()/7)}var Ni=Math.round,Va={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function $U(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function kU(t,e,n,r){var i=Br(t).abs(),o=Ni(i.as("s")),s=Ni(i.as("m")),a=Ni(i.as("h")),l=Ni(i.as("d")),u=Ni(i.as("M")),c=Ni(i.as("w")),d=Ni(i.as("y")),f=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||d<=1&&["y"]||["yy",d],f[2]=e,f[3]=+t>0,f[4]=r,$U.apply(null,f)}function FU(t){return t===void 0?Ni:typeof t=="function"?(Ni=t,!0):!1}function WU(t,e){return Va[t]===void 0?!1:e===void 0?Va[t]:(Va[t]=e,t==="s"&&(Va.ss=e-1),!0)}function VU(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Va,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Va,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=kU(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Zm=Math.abs;function Js(t){return(t>0)-(t<0)||+t}function _f(){if(!this.isValid())return this.localeData().invalidDate();var t=Zm(this._milliseconds)/1e3,e=Zm(this._days),n=Zm(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,d;return a?(r=mr(t/60),i=mr(r/60),t%=60,r%=60,o=mr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Js(this._months)!==Js(a)?"-":"",c=Js(this._days)!==Js(a)?"-":"",d=Js(this._milliseconds)!==Js(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?d+i+"H":"")+(r?d+r+"M":"")+(t?d+s+"S":"")):"P0D"}var tt=Ef.prototype;tt.isValid=HB;tt.abs=dU;tt.add=fU;tt.subtract=gU;tt.as=pU;tt.asMilliseconds=CU;tt.asSeconds=vU;tt.asMinutes=SU;tt.asHours=yU;tt.asDays=bU;tt.asWeeks=RU;tt.asMonths=EU;tt.asQuarters=TU;tt.asYears=_U;tt.valueOf=wU;tt._bubble=mU;tt.clone=MU;tt.get=AU;tt.milliseconds=OU;tt.seconds=IU;tt.minutes=PU;tt.hours=xU;tt.days=HU;tt.weeks=LU;tt.months=DU;tt.years=NU;tt.humanize=VU;tt.toISOString=_f;tt.toString=_f;tt.toJSON=_f;tt.locale=OO;tt.localeData=PO;tt.toIsoString=Cr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",_f);tt.lang=IO;Re("X",0,0,"unix");Re("x",0,0,"valueOf");ge("x",Sf);ge("X",uV);ht("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});ht("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
Q.version="2.29.4";BW(yt);Q.fn=te;Q.min=OB;Q.max=IB;Q.now=PB;Q.utc=gi;Q.unix=oU;Q.months=aU;Q.isDate=Zu;Q.locale=Io;Q.invalid=mf;Q.duration=Br;Q.isMoment=Wr;Q.weekdays=uU;Q.parseZone=sU;Q.localeData=eo;Q.isDuration=Kh;Q.monthsShort=lU;Q.weekdaysMin=hU;Q.defineLocale=qv;Q.updateLocale=sB;Q.locales=aB;Q.weekdaysShort=cU;Q.normalizeUnits=vr;Q.relativeTimeRounding=FU;Q.relativeTimeThreshold=WU;Q.calendarFormat=n2;Q.prototype=te;Q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const BU=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));function BO(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function _C(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function hu(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Ft(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function ir(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Be(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function T(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function UO(t){return Ft(t,(e,n)=>e+n,0)}function UU(t){return Ft(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function YU(t){return Ft(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function zU(t){return t.length?UO(t)/t.length:0}function YO(t){return Ft(t,(e,n)=>e.concat(Array.isArray(n)?YO(n):n),[])}function oS(t){const e=[];return T(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function MC(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function GU(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>s.includes(a))}),o}function jU(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return T(i,s=>{T(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function AC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const KU=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:zU,arrayEach:T,arrayFilter:ir,arrayFlatten:YO,arrayMap:Be,arrayMax:UU,arrayMin:YU,arrayReduce:Ft,arraySum:UO,arrayUnique:oS,extendArray:_C,getDifferenceOfArrays:MC,getIntersectionOfArrays:GU,getUnionOfArrays:jU,pivot:hu,stringToArray:AC,to2dArray:BO},Symbol.toStringTag,{value:"Module"}));function ct(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Ft(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Nt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function mt(t){return typeof t>"u"}function Xt(t){return t===null||t===""||mt(t)}function zO(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const nu="length",du=t=>parseInt(t,16),uR=t=>parseInt(t,10),Od=(t,e,n)=>t.substr(e,n),fu=t=>t.codePointAt(0)-65,OC=t=>`${t}`.replace(/\-/g,""),XU=t=>du(Od(OC(t),du("12"),fu("F")))/(du(Od(OC(t),fu("B"),~~![][nu]))||9),qU=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let cR=!1;const hR={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},dR={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function GO(t,e){const n=!Xt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0-next-b24d538-20231108";let o,s="invalid",a="invalid";t=OC(t||"");const l=ZU(t);if(n||r||l)if(l){const u=Q("15/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=XU(t);o=Q((d+1)*864e5,"x").format("MMMM DD, YYYY"),c>d?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(qU()&&(s="valid",a="valid"),!cR&&s!=="valid"&&(hR[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](hR[s]({keyValidityDate:o,hotVersion:i})),cR=!0),a!=="valid"&&e.parentNode&&dR[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=dR[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function ZU(t){let e=[][nu],n=e;if(t[nu]!==fu("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=fu(i.shift());o;o=fu(i.shift()||"A"))--o<""[nu]?n=n|(uR(`${uR(du(r)+(du(Od(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Od(t,o,o?i[nu]===1?9:8:6);return n===e}const QU=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:GO,isDefined:ue,isEmpty:Xt,isRegExp:zO,isUndefined:mt,stringify:Nt},Symbol.toStringTag,{value:"Module"}));function bn(t){return t[0].toUpperCase()+t.substr(1)}function JU(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Nt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function sS(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function aS(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function lS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function IC(t){return Mf(`${t}`,{ALLOWED_TAGS:[]})}function Mf(t,e){return VW.sanitize(t,e)}const eY=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:JU,isPercentValue:aS,randomString:sS,sanitize:Mf,stripTags:IC,substitute:lS,toUpperCaseFirst:bn},Symbol.toStringTag,{value:"Module"})),sl=t=>["tabindex",t],tY=()=>["role","treegrid"],Lr=()=>["role","presentation"],nY=()=>["role","gridcell"],rY=()=>["role","rowheader"],iY=()=>["role","columnheader"],jO=()=>["role","row"],oY=()=>["role","menu"],sY=()=>["role","menuitem"],aY=()=>["role","combobox"],KO=()=>["role","listbox"],lY=()=>["role","option"],uY=()=>["role","checkbox"],cY=()=>["scope","col"],hY=()=>["scope","row"],dY=()=>["type","text"],Lo=t=>["aria-label",t],Pu=t=>["aria-description",t],no=()=>["aria-hidden","true"],fY=()=>["aria-disabled","true"],gY=()=>["aria-multiselectable","true"],al=t=>["aria-haspopup",t],XO=t=>["aria-rowcount",t],qO=t=>["aria-colcount",t],ZO=t=>["aria-rowindex",t],uS=t=>["aria-colindex",t],sn=t=>["aria-expanded",t],mY=t=>["aria-sort",t],fR=()=>["aria-readonly","true"],gR=()=>["aria-invalid","true"],pY=t=>["aria-checked",t],PC=()=>["aria-selected","true"],wY=()=>["aria-autocomplete","list"],CY=t=>["aria-controls",t],vY=t=>["aria-activedescendant",t],SY=t=>["aria-live",t],yY=t=>["aria-relevant",t],bY=t=>["aria-setsize",t],RY=t=>["aria-posinset",t];function QO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function JO(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function eI(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function xu(t){return eI(t)&&t.parent}function EY(t){return!!Object.getPrototypeOf(t.parent)}function $o(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function ru(t,e,n){const r=[];let i=t;for(;i&&(i=$o(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function Po(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function tI(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function So(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function nI(t){return!t||!t.length?[]:t.filter(e=>!!e)}function rI(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function Ie(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function J(t,e){typeof e=="string"&&(e=e.split(" ")),e=nI(e),e.length>0&&t.classList.add(...e)}function De(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=rI(e,!0);n=nI(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function ve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Yo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=rI(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function cS(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)cS(e[n])}}function Vr(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const iI=/(<(.*)>|&(.*);)/;function Ks(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;iI.test(e)?t.innerHTML=n?Mf(e):e:ko(t,e)}function ko(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Vr(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Fo(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Fo(n.host.impl);if(n.host)return Fo(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(qi(n).display==="none")return!1;n=n.parentNode}return!0}function Bt(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function hS(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Af(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Hu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?hS(e):t.scrollTop}function Id(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Af(e):t.scrollLeft}function Du(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function $s(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=qi(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Qa(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=qi(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function TY(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function qi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ut(t){return t.offsetWidth}function Ot(t){return t.offsetHeight}function Vi(t){return t.clientHeight||t.innerHeight}function gu(t){return t.clientWidth||t.innerWidth}function _Y(t,e,n){t.addEventListener(e,n,!1)}function MY(t,e,n){t.removeEventListener(e,n,!1)}function dS(t){return t.selectionStart?t.selectionStart:0}function oI(t){return t.selectionEnd?t.selectionEnd:0}function AY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function xC(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function tc(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let Qm;function OY(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Jt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Qm===void 0&&(Qm=OY(t)),Qm}function sI(t){return t.offsetWidth!==t.clientWidth}function aI(t){return t.offsetHeight!==t.clientHeight}function Of(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function IY(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function nc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Pd(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function If(t){return Pd(t)&&t.hasAttribute("data-hot-input")===!1}function PY(t){const e=t.ownerDocument.activeElement;If(e)||t.select()}function fS(t){return!t.parentNode}function lI(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function gS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();ve(t,"contenteditable",!0),n&&ve(t,...no()),e&&J(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function mS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&De(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function uI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;gS(t,n),e(),mS(t,n)}function ks(t,e){let{tagName:n,className:r,attributes:i}=e;const o=t.ownerDocument.createElement(n);return r&&J(o,r),i&&i.length&&ve(o,i),t.appendChild(o),o}const xY=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:iI,addClass:J,addEvent:_Y,appendElement:ks,clearTextSelection:xC,closest:$o,closestDown:ru,empty:Vr,fastInnerHTML:Ks,fastInnerText:ko,getCaretPosition:dS,getComputedStyle:qi,getCssTransform:IY,getFrameElement:eI,getParent:QO,getParentWindow:xu,getScrollLeft:Id,getScrollTop:Hu,getScrollableElement:Du,getScrollbarWidth:Jt,getSelectionEndPosition:oI,getSelectionText:AY,getStyle:Qa,getTrimmingContainer:$s,getWindowScrollLeft:Af,getWindowScrollTop:hS,hasAccessToParentWindow:EY,hasClass:Ie,hasHorizontalScrollbar:aI,hasVerticalScrollbar:sI,index:tI,innerHeight:Vi,innerWidth:gu,isChildOf:Po,isDetached:fS,isInput:Pd,isOutsideInput:If,isThisHotChild:JO,isVisible:Fo,makeElementContentEditableAndSelectItsContent:gS,matchesCSSRules:TY,observeVisibilityChangeOnce:lI,offset:Bt,outerHeight:Ot,outerWidth:ut,overlayContainsElement:So,removeAttribute:Yo,removeClass:De,removeContentEditableFromElementAndDeselect:mS,removeEvent:MY,removeTextNodes:cS,resetCssTransform:nc,runWithSelectedContendEditableElement:uI,selectElementIfAllowed:PY,setAttribute:ve,setCaretPosition:tc,setOverlayPosition:Of},Symbol.toStringTag,{value:"Module"}));function gt(t){return typeof t=="function"}function cI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const d=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},d)),r}return o}function HY(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=cI(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function pS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function DY(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Ft(i,(u,c)=>c(u),r.apply(this,a))}}function wS(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function hI(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function NY(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function xd(t,e,n,r,i,o,s,a){return ue(a)?t.call(e,n,r,i,o,s,a):ue(s)?t.call(e,n,r,i,o,s):ue(o)?t.call(e,n,r,i,o):ue(i)?t.call(e,n,r,i):ue(r)?t.call(e,n,r):ue(n)?t.call(e,n):t.call(e)}const LY=Object.freeze(Object.defineProperty({__proto__:null,curry:hI,curryRight:NY,debounce:pS,fastCall:xd,isFunction:gt,partial:wS,pipe:DY,throttle:cI,throttleAfterHits:HY},Symbol.toStringTag,{value:"Module"}));var $Y=Fn,mR=xA,kY=dn,pR=rl,FY=kA,wR=$Y([].push),WY=function(t){if(kY(t))return t;if(mR(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?wR(n,i):(typeof i=="number"||pR(i)==="Number"||pR(i)==="String")&&wR(n,FY(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(mR(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},VY=zs,dI=ju,fI=gf,BY=uf,rc=Fn,gI=wr,CR=dn,vR=_v,mI=$v,UY=WY,YY=Tv,zY=String,xo=dI("JSON","stringify"),xc=rc(/./.exec),SR=rc("".charAt),GY=rc("".charCodeAt),jY=rc("".replace),KY=rc(1 .toString),XY=/[\uD800-\uDFFF]/g,yR=/^[\uD800-\uDBFF]$/,bR=/^[\uDC00-\uDFFF]$/,RR=!YY||gI(function(){var t=dI("Symbol")("stringify detection");return xo([t])!=="[null]"||xo({a:t})!=="{}"||xo(Object(t))!=="{}"}),ER=gI(function(){return xo("\uDF06\uD834")!=='"\\udf06\\ud834"'||xo("\uDEAD")!=='"\\udead"'}),qY=function(t,e){var n=mI(arguments),r=UY(e);if(!(!CR(r)&&(t===void 0||vR(t))))return n[1]=function(i,o){if(CR(r)&&(o=BY(r,this,zY(i),o)),!vR(o))return o},fI(xo,null,n)},ZY=function(t,e,n){var r=SR(n,e-1),i=SR(n,e+1);return xc(yR,t)&&!xc(bR,i)||xc(bR,t)&&!xc(yR,r)?"\\u"+KY(GY(t,0),16):t};xo&&VY({target:"JSON",stat:!0,arity:3,forced:RR||ER},{stringify:function(e,n,r){var i=mI(arguments),o=fI(RR?qY:xo,null,i);return ER&&typeof o=="string"?jY(o,XY,ZY):o}});function Ja(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ue(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=Ja(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[Ja(n[0])]:e[r]=[]:e[r]=null)})),e}function ro(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Ut(t,e,n){const r=Array.isArray(n);return Ue(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function ic(t,e){Ue(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),ic(t[r],e[r])):t[r]=e[r]})}function Rn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function $n(t){const e={};return Ue(t,(n,r)=>{e[r]=n}),e}function dt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return T(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ue(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,d){const f=`_${c}`,m=w=>{let v=w;return(Array.isArray(v)||Fe(v))&&(v=Rn(v)),v};return function(){return this[f]===void 0&&(this[f]=m(d)),this[f]}},l=function(c){const d=`_${c}`;return function(f){this[d]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Pf(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Fe(t){return Object.prototype.toString.call(t)==="[object Object]"}function pi(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ue(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function pI(t,e){const n=e.split(".");let r=t;return Ue(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function qh(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(At(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function xf(t){if(!Fe(t))return 0;const e=function(n){let r=0;return Fe(n)?Ue(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Fs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function At(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const QY=Object.freeze(Object.defineProperty({__proto__:null,clone:$n,createObjectPropListener:Fs,deepClone:Rn,deepExtend:ic,deepObjectSize:xf,defineGetter:pi,duckSchema:Ja,extend:Ut,getProperty:pI,hasOwnProperty:At,inherit:ro,isObject:Fe,isObjectEqual:Pf,mixin:dt,objectEach:Ue,setProperty:qh},Symbol.toStringTag,{value:"Module"})),dr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},io={chrome:dr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:dr(t=>/CriOS/.test(t)),edge:dr(t=>/Edge/.test(t)),edgeWebKit:dr(t=>/EdgiOS/.test(t)),firefox:dr(t=>/Firefox/.test(t)),firefoxWebKit:dr(t=>/FxiOS/.test(t)),mobile:dr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:dr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ll={mac:dr(t=>/^Mac/.test(t)),win:dr(t=>/^Win/.test(t)),linux:dr(t=>/^Linux/.test(t)),ios:dr(t=>/iPhone|iPad|iPod/i.test(t))};function wI(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ue(io,n=>{let{test:r}=n;return void r(t,e)})}function CI(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ue(ll,e=>{let{test:n}=e;return void n(t)})}wI();CI();function CS(){return io.chrome.value}function vI(){return io.chromeWebKit.value}function Zh(){return io.firefox.value}function SI(){return io.firefoxWebKit.value}function vS(){return io.safari.value}function yI(){return io.edge.value}function JY(){return io.edgeWebKit.value}function Bi(){return io.mobile.value}function SS(){return ll.ios.value}function yS(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ll.mac.value}function HC(){return ll.win.value}function Nu(){return ll.mac.value}function ez(){return ll.linux.value}const tz=Object.freeze(Object.defineProperty({__proto__:null,isChrome:CS,isChromeWebKit:vI,isEdge:yI,isEdgeWebKit:JY,isFirefox:Zh,isFirefoxWebKit:SI,isIOS:SS,isIpadOS:yS,isLinuxOS:ez,isMacOS:Nu,isMobileBrowser:Bi,isSafari:vS,isWindowsOS:HC,setBrowserMeta:wI,setPlatformMeta:CI},Symbol.toStringTag,{value:"Module"})),fe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Zh()?182:174,AUDIO_MUTE:Zh()?181:173,AUDIO_UP:Zh()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},nz=[fe.ALT,fe.ARROW_DOWN,fe.ARROW_LEFT,fe.ARROW_RIGHT,fe.ARROW_UP,fe.AUDIO_DOWN,fe.AUDIO_MUTE,fe.AUDIO_UP,fe.BACKSPACE,fe.CAPS_LOCK,fe.DELETE,fe.END,fe.ENTER,fe.ESCAPE,fe.F1,fe.F2,fe.F3,fe.F4,fe.F5,fe.F6,fe.F7,fe.F8,fe.F9,fe.F10,fe.F11,fe.F12,fe.F13,fe.F14,fe.F15,fe.F16,fe.F17,fe.F18,fe.F19,fe.HOME,fe.INSERT,fe.MEDIA_NEXT,fe.MEDIA_PLAY_PAUSE,fe.MEDIA_PREV,fe.MEDIA_STOP,fe.NULL,fe.NUM_LOCK,fe.PAGE_DOWN,fe.PAGE_UP,fe.PAUSE,fe.SCROLL_LOCK,fe.SHIFT,fe.TAB];function bI(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function bS(t){return nz.includes(t)}function rz(t){const e=[];return Nu()?e.push(fe.COMMAND_LEFT,fe.COMMAND_RIGHT,fe.COMMAND_FIREFOX):e.push(fe.CONTROL),e.includes(t)}function RI(t){return[fe.CONTROL,fe.COMMAND_LEFT,fe.COMMAND_RIGHT,fe.COMMAND_FIREFOX].includes(t)}function ul(t,e){const n=e.split("|");let r=!1;return T(n,i=>{if(t===fe[i])return r=!0,!1}),r}const iz=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:fe,isCtrlKey:rz,isCtrlMetaKey:RI,isFunctionKey:bS,isKey:ul,isPrintableChar:bI},Symbol.toStringTag,{value:"Module"}));function Sr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Eo(t){return t.isImmediatePropagationEnabled===!1}function Wo(t){return t.button===2}function Hf(t){return t.button===0}function EI(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const oz=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Eo,isLeftClick:Hf,isRightClick:Wo,offsetRelativeTo:EI,stopImmediatePropagation:Sr},Symbol.toStringTag,{value:"Module"}));function pt(){ue(console)&&console.warn(...arguments)}function RS(){ue(console)&&console.error(...arguments)}function sz(t,e,n){return e=az(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function az(t){var e=lz(t,"string");return typeof e=="symbol"?e:String(e)}function lz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ea=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],uz=ct`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Jm=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),ep=new Map([[]]);class TI{static getSingleton(){return hz()}constructor(){sz(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return T(ea,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))T(n,i=>this.add(e,i,r));else{Jm.has(e)&&pt(lS(uz,{hookName:e,removedInVersion:Jm.get(e)})),ep.has(e)&&pt(ep.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&T(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?T(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=xd(u[d],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[d]&&u[d].runOnce&&this.remove(n,u[d]),d+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=xd(u[d],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[d]&&u[d].runOnce&&this.remove(n,u[d],e),d+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ue(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||ea.push(e)}deregister(e){this.isRegistered(e)&&ea.splice(ea.indexOf(e),1)}isDeprecated(e){return ep.has(e)||Jm.has(e)}isRegistered(e){return ea.indexOf(e)>=0}getRegistered(){return ea}}const cz=new TI;function hz(){return cz}const de=TI,tp=new Map;function Ur(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";tp.has(t)||tp.set(t,new Map);const e=tp.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const DC=new WeakMap,{register:dz,getItem:_I,hasItem:MI,getNames:fz,getValues:Cae}=Ur("editors");function gz(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},de.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function AI(t,e){let n;if(typeof t=="function")DC.get(t)||jn(null,t),n=DC.get(t);else if(typeof t=="string")n=_I(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Hd(t){if(typeof t=="function")return t;if(!MI(t))throw Error(`No registered editor found under "${t}" name`);return _I(t).getConstructor()}function jn(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new gz(e);typeof t=="string"&&dz(t,n),DC.set(e,n)}function mz(t,e,n){return e=pz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pz(t){var e=wz(t,"string");return typeof e=="symbol"?e:String(e)}function wz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Qh=0;class Cz{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;mz(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,vz(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Qh+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Qh-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Qh-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function vz(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Sr(this)},t}const or=Cz;function Sz(){return Qh}function TR(t,e){yz(t,e),e.add(t)}function yz(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ao(t,e,n){return e=bz(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bz(t){var e=Rz(t,"string");return typeof e=="symbol"?e:String(e)}function Rz(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _R(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Df="editorManager.navigation";var MR=new WeakSet,AR=new WeakSet;class NC{constructor(e,n,r){TR(this,AR),TR(this,MR),ao(this,"hot",void 0),ao(this,"tableMeta",void 0),ao(this,"selection",void 0),ao(this,"eventManager",void 0),ao(this,"destroyed",!1),ao(this,"lock",!1),ao(this,"activeEditor",void 0),ao(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new or(e),this.hot.addHook("afterDocumentKeyDown",i=>_R(this,MR,Ez).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>_R(this,AR,Tz).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=AI(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Ez(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Eo(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!bS(n)&&!RI(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>ue(this.hot.getSelected()),group:Df};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function Tz(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const OR=new WeakMap;NC.getInstance=function(t,e,n){let r=OR.get(t);return r||(r=new NC(t,e,n),OR.set(t,r)),r};const _z=NC;function Hc(t,e){OI(t,e),e.add(t)}function Dc(t,e,n){OI(t,e),e.set(t,n)}function OI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function pn(t,e){var n=II(t,e,"get");return Mz(t,n)}function Mz(t,e){return e.get?e.get.call(t):e.value}function Sl(t,e,n){var r=II(t,e,"set");return Az(t,r,n),n}function II(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Az(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Mo=Object.freeze({CELL:"cell",MIXED:"mixed"});var er=new WeakMap,Nc=new WeakMap,Lc=new WeakMap,$c=new WeakMap,LC=new WeakSet,$C=new WeakSet,IR=new WeakSet,PR=new WeakSet;class Oz{constructor(e){var n=this;Hc(this,PR),Hc(this,IR),Hc(this,$C),Hc(this,LC),Dc(this,er,{writable:!0,value:void 0}),Dc(this,Nc,{writable:!0,value:void 0}),Dc(this,Lc,{writable:!0,value:50}),Dc(this,$c,{writable:!0,value:null});const r=e.getSettings();Sl(this,er,e),Sl(this,Nc,r.imeFastEdit?Mo.MIXED:Mo.CELL),pn(this,er).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ba(n,PR,Pz).call(n,...o)}),pn(this,er).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ba(n,IR,Iz).call(n,...o)})}getFocusMode(){return pn(this,Nc)}setFocusMode(e){Object.values(Mo).includes(e)?Sl(this,Nc,e):pt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return pn(this,Lc)}setRefocusDelay(e){Sl(this,Lc,e)}setRefocusElementGetter(e){Sl(this,$c,e)}getRefocusElement(){if(typeof pn(this,$c)=="function")return pn(this,$c).call(this);var e;return(e=pn(this,er).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){var n;const r=Ba(this,LC,PI).call(this),i=e||Ba(this,$C,xI).call(this);let o=pn(this,er).runHooks("modifyFocusedElement",r.row,r.col,i);o instanceof HTMLElement||(o=i),o&&!((n=pn(this,er).getActiveEditor())!==null&&n!==void 0&&n.isOpened())&&o.focus({preventScroll:!0})}refocusToEditorTextarea(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pn(this,Lc);const n=this.getRefocusElement();pn(this,er).getSettings().imeFastEdit&&n&&pn(this,er)._registerTimeout(()=>{n.select()},e)}}function PI(){return pn(this,er).getSelectedRangeLast().highlight}function xI(){const t=Ba(this,LC,PI).call(this);return pn(this,er).getCell(t.row,t.col,!0)}function Iz(){const t=Ba(this,$C,xI).call(this),{activeElement:e}=pn(this,er).rootDocument;e&&If(e)&&e.blur(),this.focusOnHighlightedCell(t),this.getFocusMode()===Mo.MIXED&&t.nodeName==="TD"&&pn(this,er).addHookOnce("afterSelectionEnd",()=>{this.refocusToEditorTextarea()})}function Pz(t){t.imeFastEdit&&this.getFocusMode()!==Mo.MIXED?this.setFocusMode(Mo.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Mo.CELL&&this.setFocusMode(Mo.CELL)}const HI={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},xz=new RegExp(Object.keys(HI).map(t=>`(${t})`).join("|"),"gi");function Hz(t){return(t&&t.nodeName||"")==="TABLE"}function kC(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,d=e?1:0;for(let f=0;f<o;f+=1){const m=e&&f===0,w=[];for(let y=0;y<s;y+=1){const b=!m&&n&&y===0;let _="";if(m)_=`<th>${t.getColHeader(y-c)}</th>`;else if(b)_=`<th>${t.getRowHeader(f-d)}</th>`;else{const I=i[f][y],{hidden:L,rowspan:x,colspan:B}=t.getCellMeta(f-d,y-c);if(!L){const z=[];if(x&&z.push(`rowspan="${x}"`),B&&z.push(`colspan="${B}"`),Xt(I))_=`<td ${z.join(" ")}></td>`;else{const ee=I.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${z.join(" ")}>${ee}</td>`}}}w.push(_)}const v=["<tr>",...w,"</tr>"].join("");m?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function FC(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Xt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function DI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const I=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,L=>{const x=L.match(/<td\b[^>]*?>/g)[0],B=L.substring(x.length,L.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${x}${B}</td>`});i.insertAdjacentHTML("afterbegin",`${I}`),o=i.querySelector("table")}if(!o||!Hz(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((I,L)=>I+L.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[];let f=!1,m=0,w=0;if(o.tHead){const I=Array.from(o.tHead.rows).filter(L=>{const x=L.querySelector("td")!==null;return x&&d.push(L),!x});m=I.length,f=m>0,m>1?n.nestedHeaders=Array.from(I).reduce((L,x)=>{const B=Array.from(x.cells).reduce((z,ee,j)=>{if(a&&j===0)return z;const{colSpan:X,innerHTML:ie}=ee,oe=X>1?{label:ie,colspan:X}:ie;return z.push(oe),z},[]);return L.push(B),L},[]):f&&(n.colHeaders=Array.from(I[0].children).reduce((L,x,B)=>(a&&B===0||L.push(x.innerHTML),L),[]))}d.length&&(n.fixedRowsTop=d.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...d,...Array.from(o.tBodies).reduce((I,L)=>(I.push(...Array.from(L.rows)),I),[]),...c];w=v.length;const y=new Array(w);for(let I=0;I<w;I++)y[I]=new Array(u);const b=[],_=[];for(let I=0;I<w;I++){const L=v[I],x=Array.from(L.cells),B=x.length;for(let z=0;z<B;z++){const ee=x[z],{nodeName:j,innerHTML:X,rowSpan:ie,colSpan:oe}=ee,se=y[I].findIndex(pe=>pe===void 0);if(j==="TD"){if(ie>1||oe>1){for(let Pe=I;Pe<I+ie;Pe++)if(Pe<w)for(let R=se;R<se+oe;R++)y[Pe][R]=null;const Me=ee.getAttribute("style");Me&&Me.includes("mso-ignore:colspan")||b.push({col:se,row:I,rowspan:ie,colspan:oe})}let pe="";s&&/excel/gi.test(s.content)?pe=X.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):pe=X.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),y[I][se]=pe.replace(xz,Me=>HI[Me])}else _.push(X)}}return b.length&&(n.mergeCells=b),_.length&&(n.rowHeaders=_),y.length&&(n.data=y),n}const Dz=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:FC,htmlToGridSettings:DI,instanceToHTML:kC},Symbol.toStringTag,{value:"Module"}));function Ln(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function NI(t){return Ln(t,[","])}function me(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Dd(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function ES(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function qn(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const Nz=Object.freeze(Object.defineProperty({__proto__:null,clamp:qn,isNumeric:Ln,isNumericLike:NI,rangeEach:me,rangeEachReverse:Dd,valueAccordingPercent:ES},Symbol.toStringTag,{value:"Module"})),WC="asc",Lz="desc",xR=new Map([[WC,[-1,1]],[Lz,[1,-1]]]),$z=t=>`The priority '${t}' is already declared in a map.`,kz=t=>`The priority '${t}' is not a number.`;function Fz(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=gt(t)?t:$z,e=gt(e)?e:kz;function r(o,s){if(!Ln(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:WC;const[s,a]=xR.get(o)||xR.get(WC);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const Wz=t=>`The id '${t}' is already declared in a map.`;function Nf(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=gt(t)?t:Wz;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(d=>{let[f,m]=d;return u===m?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const Vz=t=>`'${t}' value is already declared in a unique set.`;function Bz(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=gt(t)?t:Vz;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const TS=t=>`There is already registered "${t}" plugin.`,Uz=t=>`There is already registered plugin on priority "${t}".`,Yz=t=>`The priority "${t}" is not a number.`,LI=Fz({errorPriorityExists:Uz,errorPriorityNaN:Yz}),$I=Bz({errorItemExists:TS}),VC=Nf({errorIdExists:TS});function _S(){return[...LI.getItems(),...$I.getItems()]}function oc(t){const e=bn(t);return VC.getItem(e)}function zz(t){return!!oc(t)}function Ne(t,e,n){[t,e,n]=jz(t,e,n),oc(t)===void 0&&Gz(t,e,n)}function Gz(t,e,n){const r=bn(t);if(VC.hasItem(r))throw new Error(TS(r));n===void 0?$I.addItem(r):LI.addItem(n,r),VC.addItem(r,e)}function jz(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Kz,getItem:Xz,hasItem:kI,getNames:qz,getValues:vae}=Ur("renderers");function Nd(t){if(typeof t=="function")return t;if(!kI(t))throw Error(`No registered renderer found under "${t}" name`);return Xz(t)}function ii(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Kz(t,e)}const{register:Zz,getItem:Qz,hasItem:FI,getNames:Jz,getValues:Sae}=Ur("validators");function MS(t){if(typeof t=="function")return t;if(!FI(t))throw Error(`No registered validator found under "${t}" name`);return Qz(t)}function Ua(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Zz(t,e)}var WI={},eG=OA,tG=Nv,nG=Object.keys||function(e){return eG(e,tG)},rG=di,iG=bA,oG=Ys,sG=Ku,aG=cf,lG=nG;WI.f=rG&&!iG?Object.defineProperties:function(e,n){sG(e);for(var r=aG(n),i=lG(n),o=i.length,s=0,a;o>s;)oG.f(e,a=i[s++],r[a]);return e};var uG=Ku,cG=WI,HR=Nv,hG=xv,dG=UA,fG=Iv,gG=TA,DR=">",NR="<",BC="prototype",UC="script",VI=gG("IE_PROTO"),np=function(){},BI=function(t){return NR+UC+DR+t+NR+"/"+UC+DR},LR=function(t){t.write(BI("")),t.close();var e=t.parentWindow.Object;return t=null,e},mG=function(){var t=fG("iframe"),e="java"+UC+":",n;return t.style.display="none",dG.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(BI("document.F=Object")),n.close(),n.F},kc,Jh=function(){try{kc=new ActiveXObject("htmlfile")}catch{}Jh=typeof document<"u"?document.domain&&kc?LR(kc):mG():LR(kc);for(var t=HR.length;t--;)delete Jh[BC][HR[t]];return Jh()};hG[VI]=!0;var pG=Object.create||function(e,n){var r;return e!==null?(np[BC]=uG(e),r=new np,np[BC]=null,r[VI]=e):r=Jh(),n===void 0?r:cG.f(r,n)},wG=df,CG=pG,vG=Ys.f,YC=wG("unscopables"),zC=Array.prototype;zC[YC]===void 0&&vG(zC,YC,{configurable:!0,value:CG(null)});var UI=function(t){zC[YC][t]=!0},SG=zs,yG=hf,bG=ff,RG=Dv,EG=UI;SG({target:"Array",proto:!0},{at:function(e){var n=yG(this),r=bG(n),i=RG(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});EG("at");const Os=1,vn=2;function $R(t,e,n){TG(t,e),e.set(t,n)}function TG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(t,e,n){return e=_G(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _G(t){var e=MG(t,"string");return typeof e=="symbol"?e:String(e)}function MG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zt(t,e){var n=YI(t,e,"get");return AG(t,n)}function AG(t,e){return e.get?e.get.call(t):e.value}function kR(t,e,n){var r=YI(t,e,"set");return OG(t,r,n),n}function YI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function OG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Fc=new WeakMap,Gt=new WeakMap;class AS{static get DEFAULT_WIDTH(){return 50}constructor(e){Si(this,"count",0),Si(this,"startColumn",null),Si(this,"endColumn",null),Si(this,"startPosition",null),Si(this,"isVisibleInTrimmingContainer",!1),Si(this,"stretchAllRatio",0),Si(this,"stretchLastWidth",0),$R(this,Fc,{writable:!0,value:0}),Si(this,"needVerifyLastColumnWidth",!0),Si(this,"stretchAllColumnsWidth",[]),$R(this,Gt,{writable:!0,value:void 0}),kR(this,Gt,e),typeof zt(this,Gt).stretchingColumnWidthFn!="function"&&(zt(this,Gt).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=zt(this,Gt),s=Math.max(zt(this,Gt).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let d,f=0,m=0;for(let b=0;b<i;b++)if(d=this._getColumnWidth(b),l<=s&&e!==vn&&(this.startColumn=b,f=d),l>=s&&l+(e===vn?d:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=b,f=d),this.endColumn=b),c.push(l),l+=d,m=d,e!==vn&&(this.endColumn=b),l>=s+o){u=!1;break}const w=r+o-a,v=e===vn?0:m,y=e===vn?f:0;if(w<-1*zt(this,Gt).inlineStartOffset||r>c.at(-1)+v||-1*zt(this,Gt).scrollOffset-zt(this,Gt).viewportWidth>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=c[this.endColumn]+d-c[this.startColumn-1];if((b<=o||e!==vn)&&(this.startColumn-=1),b>o)break}e===Os&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(zt(this,Gt).stretchMode==="none")return;let n=e;kR(this,Fc,n);const r=zt(this,Gt).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=zt(this,Gt).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(zt(this,Gt).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(zt(this,Gt).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return zt(this,Gt).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):zt(this,Gt).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=zt(this,Gt).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=zt(this,Gt).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==zt(this,Fc)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=zt(this,Fc)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=zt(this,Gt).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=zt(this,Gt).columnWidthFn(e);return isNaN(n)&&(n=AS.DEFAULT_WIDTH),n}}const OS=AS;function IG(t,e,n){PG(t,e),e.set(t,n)}function PG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yl(t,e,n){return e=xG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xG(t){var e=HG(t,"string");return typeof e=="symbol"?e:String(e)}function HG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rp(t,e){var n=zI(t,e,"get");return DG(t,n)}function DG(t,e){return e.get?e.get.call(t):e.value}function NG(t,e,n){var r=zI(t,e,"set");return LG(t,r,n),n}function zI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function LG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var bl=new WeakMap;class IS{static get DEFAULT_HEIGHT(){return 23}constructor(e){yl(this,"count",0),yl(this,"startRow",null),yl(this,"endRow",null),yl(this,"startPosition",null),yl(this,"isVisibleInTrimmingContainer",!1),IG(this,bl,{writable:!0,value:void 0}),NG(this,bl,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=rp(this,bl),a=Math.max(rp(this,bl).scrollOffset,0),l=rp(this,bl).horizontalScrollbarHeight||0;let u=0,c=!0;const d=[];let f,m=0,w=0;for(let _=0;_<o;_++)if(f=r(_),isNaN(f)&&(f=IS.DEFAULT_HEIGHT),u<=a&&e!==vn&&(this.startRow=_,m=f),u>=a&&u+(e===vn?f:0)<=a+s-l&&(this.startRow===null&&(this.startRow=_,m=f),this.endRow=_),d.push(u),u+=f,w=f,e!==vn&&(this.endRow=_),u>=a+s-l){c=!1;break}const v=i+s-l,y=e===vn?m:0,b=e===vn?0:w;if(v<y||i>d.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const _=d[this.endRow]+f-d[this.startRow-1];if((_<=s-l||e!==vn)&&(this.startRow-=1),_>=s-l)break}e===Os&&this.startRow!==null&&n&&n(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const GI=IS;function $G(t,e,n){kG(t,e),e.set(t,n)}function kG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FR(t,e,n){return e=FG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FG(t){var e=WG(t,"string");return typeof e=="symbol"?e:String(e)}function WG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ta(t,e){var n=jI(t,e,"get");return VG(t,n)}function VG(t,e){return e.get?e.get.call(t):e.value}function WR(t,e,n){var r=jI(t,e,"set");return BG(t,r,n),n}function jI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function BG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var yi=new WeakMap;class Ld{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;FR(this,"row",null),FR(this,"col",null),$G(this,yi,{writable:!0,value:!1}),WR(this,yi,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return ta(this,yi)}isSouthEastOf(e){return this.row>=e.row&&(ta(this,yi)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(ta(this,yi)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(ta(this,yi)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(ta(this,yi)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Ld&&WR(this,yi,e.isRtl()),this}clone(){return new Ld(this.row,this.col,ta(this,yi))}toObject(){return{row:this.row,col:this.col}}}const $d=Ld;function UG(t,e,n){YG(t,e),e.set(t,n)}function YG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ip(t,e,n){return e=zG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zG(t){var e=GG(t,"string");return typeof e=="symbol"?e:String(e)}function GG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zr(t,e){var n=KI(t,e,"get");return jG(t,n)}function jG(t,e){return e.get?e.get.call(t):e.value}function KG(t,e,n){var r=KI(t,e,"set");return XG(t,r,n),n}function KI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function XG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ar=new WeakMap;class PS{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;ip(this,"highlight",null),ip(this,"from",null),ip(this,"to",null),UG(this,ar,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),KG(this,ar,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),d=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=d,this.to=f,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return zr(this,ar)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return zr(this,ar)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return zr(this,ar)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return zr(this,ar)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return zr(this,ar)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return zr(this,ar)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return zr(this,ar)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return zr(this,ar)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof $d))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new PS(this.highlight,this.from,this.to,zr(this,ar))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new $d(e,n,zr(this,ar))}}const xS=PS;function Lf(t){return window.requestAnimationFrame(t)}function Lu(t){window.cancelAnimationFrame(t)}function HS(){return"ontouchstart"in window}let na;function XI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return na||(typeof Intl=="object"?na=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?na=(n,r)=>`${n}`.localeCompare(r):na=(n,r)=>n===r?0:n>r?-1:1,na)}const qG=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Lu,getComparisonFunction:XI,isTouchSupported:HS,requestAnimationFrame:Lf},Symbol.toStringTag,{value:"Module"}));function Gr(t,e,n){ZG(t,e),e.set(t,n)}function ZG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function we(t,e){var n=qI(t,e,"get");return QG(t,n)}function QG(t,e){return e.get?e.get.call(t):e.value}function lo(t,e,n){var r=qI(t,e,"set");return JG(t,r,n),n}function qI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function JG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var lr=new WeakMap,op=new WeakMap,tn=new WeakMap,ra=new WeakMap,Wc=new WeakMap,br=new WeakMap,sp=new WeakMap,Rl=new WeakMap,Zo=new WeakMap,jr=new WeakMap;let ej=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Gr(this,lr,{writable:!0,value:void 0}),Gr(this,op,{writable:!0,value:void 0}),Gr(this,tn,{writable:!0,value:void 0}),Gr(this,ra,{writable:!0,value:void 0}),Gr(this,Wc,{writable:!0,value:void 0}),Gr(this,br,{writable:!0,value:void 0}),Gr(this,sp,{writable:!0,value:void 0}),Gr(this,Rl,{writable:!0,value:void 0}),Gr(this,Zo,{writable:!0,value:[null,null]}),Gr(this,jr,{writable:!0,value:[null,null]}),lo(this,lr,r),lo(this,op,n),lo(this,tn,o),lo(this,ra,s),lo(this,Wc,a),lo(this,br,i),lo(this,sp,e),this.registerEvents()}registerEvents(){we(this,br).addEventListener(we(this,tn).holder,"contextmenu",r=>this.onContextMenu(r)),we(this,br).addEventListener(we(this,tn).TABLE,"mouseover",r=>this.onMouseOver(r)),we(this,br).addEventListener(we(this,tn).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{we(this,br).addEventListener(we(this,tn).holder,"touchstart",r=>this.onTouchStart(r)),we(this,br).addEventListener(we(this,tn).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),we(this,br).addEventListener(we(this,tn).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||we(this,lr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,we(this,lr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{we(this,br).addEventListener(we(this,tn).holder,"mouseup",r=>this.onMouseUp(r)),we(this,br).addEventListener(we(this,tn).holder,"mousedown",r=>this.onMouseDown(r))};Bi()?e():(HS()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(we(this,Rl)&&r){const[i,o]=[r.row,we(this,Rl).from.row],[s,a]=[r.col,we(this,Rl).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=we(this,tn).TABLE,i=ru(e,["TD","TH"],r);return i?(n.coords=we(this,tn).getCoords(i),n.TD=i):Ie(e,"wtBorder")&&Ie(e,"current")?(n.coords=we(this,ra).getFocusSelection().cellRange.highlight,n.TD=we(this,tn).getCell(n.coords)):Ie(e,"wtBorder")&&Ie(e,"area")&&we(this,ra).getAreaSelection().cellRange&&(n.coords=we(this,ra).getAreaSelection().cellRange.to,n.TD=we(this,tn).getCell(n.coords)),n}onMouseDown(e){const n=we(this,op).rootDocument.activeElement,r=wS(QO,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Ie(i,"corner")?we(this,lr).getSetting("onCellCornerMouseDown",e,i):o.TD&&we(this,lr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(we(this,jr)[0]=o.TD,clearTimeout(we(this,Zo)[0]),we(this,Zo)[0]=setTimeout(()=>{we(this,jr)[0]=null},1e3))}onContextMenu(e){if(we(this,lr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!we(this,lr).has("onCellMouseOver"))return;const n=we(this,tn).TABLE,r=ru(e.target,["TD","TH"],n),i=we(this,Wc)||this;r&&r!==i.lastMouseOver&&Po(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,we(this,tn).getCoords(r),r))}onMouseOut(e){if(!we(this,lr).has("onCellMouseOut"))return;const n=we(this,tn).TABLE,r=ru(e.target,["TD","TH"],n),i=ru(e.relatedTarget,["TD","TH"],n),o=we(this,Wc)||this;r&&r!==i&&Po(r,n)&&(this.callListener("onCellMouseOut",e,we(this,tn).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&we(this,lr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===we(this,jr)[0]&&n.TD===we(this,jr)[1]?(Ie(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),we(this,jr)[0]=null,we(this,jr)[1]=null):n.TD===we(this,jr)[0]&&(we(this,jr)[1]=n.TD,clearTimeout(we(this,Zo)[1]),we(this,Zo)[1]=setTimeout(()=>{we(this,jr)[1]=null},500)))}onTouchStart(e){lo(this,Rl,we(this,ra).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&we(this,lr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];SS()&&(vI()||SI())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=we(this,lr).getSettingPure(e);o&&o(n,r,i,we(this,sp).call(this))}destroy(){clearTimeout(we(this,Zo)[0]),clearTimeout(we(this,Zo)[1]),we(this,br).destroy()}};const ZI=ej;function ap(t,e,n){return e=tj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tj(t){var e=nj(t,"string");return typeof e=="symbol"?e:String(e)}function nj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rj{constructor(e,n,r){ap(this,"offset",void 0),ap(this,"total",void 0),ap(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const ij=rj;function lp(t,e,n){return e=oj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oj(t){var e=sj(t,"string");return typeof e=="symbol"?e:String(e)}function sj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aj{constructor(e,n,r){lp(this,"offset",void 0),lp(this,"total",void 0),lp(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const lj=aj,uj=0,kd=1,Fd=2;function Vc(t,e,n){return e=cj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cj(t){var e=hj(t,"string");return typeof e=="symbol"?e:String(e)}function hj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VR{constructor(){Vc(this,"currentSize",0),Vc(this,"nextSize",0),Vc(this,"currentOffset",0),Vc(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function up(t,e,n){return e=dj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dj(t){var e=fj(t,"string");return typeof e=="symbol"?e:String(e)}function fj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gj{constructor(){up(this,"size",new VR),up(this,"workingSpace",uj),up(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof VR}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=kd,e.workingSpace=Fd,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Fd,e.workingSpace=kd,this.sharedSize=e.getViewSize()}}function ia(t,e,n){return e=mj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mj(t){var e=pj(t,"string");return typeof e=="symbol"?e:String(e)}function pj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QI{constructor(e,n,r){ia(this,"rootNode",void 0),ia(this,"nodesPool",void 0),ia(this,"sizeSet",new gj),ia(this,"childNodeType",void 0),ia(this,"visualIndex",0),ia(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(kd))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Fd)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(kd);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Fd)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class JI extends QI{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function wj(t,e,n){return e=Cj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cj(t){var e=vj(t,"string");return typeof e=="symbol"?e:String(e)}function vj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sj{constructor(e){wj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function El(t,e,n){return e=yj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yj(t){var e=bj(t,"string");return typeof e=="symbol"?e:String(e)}function bj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sc{constructor(e,n){El(this,"nodesPool",null),El(this,"nodeType",void 0),El(this,"rootNode",void 0),El(this,"table",null),El(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Sj(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function BR(t,e,n){return e=Rj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rj(t){var e=Ej(t,"string");return typeof e=="symbol"?e:String(e)}function Ej(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tj extends sc{constructor(){super("TH"),BR(this,"orderViews",new WeakMap),BR(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new JI(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),Yo(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(f,[rY(),hY(),uS(d+1),sl(-1)]),n[d](a,f,d)}u.end()}}}class _j extends sc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Vr(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ve(this.rootNode,[Lr()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ve(s,[jO(),ZO(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Yo(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(u,[uS(a+1+this.table.rowHeadersCount),sl(-1),...a<0?[Lr()]:[iY(),cY()]]),r[n](l,u,n)}}}}class Mj extends sc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&J(r,"rowHeader")}}function Aj(t,e,n){return e=Oj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oj(t){var e=Ij(t,"string");return typeof e=="symbol"?e:String(e)}function Ij(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let UR=!1;class Pj extends sc{constructor(e){super("TR",e),Aj(this,"orderView",void 0),this.orderView=new QI(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!UR&&e>1e3&&(UR=!0,pt(ct`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ve(this.rootNode,[Lr()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;ve(o,[jO(),ZO(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function YR(t,e,n){return e=xj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xj(t){var e=Hj(t,"string");return typeof e=="symbol"?e:String(e)}function Hj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dj extends sc{constructor(){super("TD"),YR(this,"orderViews",new WeakMap),YR(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new JI(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=i.obtainOrderView(u);c.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const m=c.getCurrentNode(),w=this.table.renderedColumnToSource(f);if(Ie(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Yo(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,w,m),this.table.isAriaEnabled()){var o,s;ve(m,[...m.hasAttribute("role")?[]:[nY()],sl(-1),uS(w+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function nn(t,e,n){return e=Nj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nj(t){var e=Lj(t,"string");return typeof e=="symbol"?e:String(e)}function Lj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $j{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};nn(this,"rootNode",void 0),nn(this,"rootDocument",void 0),nn(this,"rowHeaders",null),nn(this,"columnHeaders",null),nn(this,"colGroup",null),nn(this,"rows",null),nn(this,"cells",null),nn(this,"rowFilter",null),nn(this,"columnFilter",null),nn(this,"rowUtils",null),nn(this,"columnUtils",null),nn(this,"rowsToRender",0),nn(this,"columnsToRender",0),nn(this,"rowHeaderFunctions",[]),nn(this,"rowHeadersCount",0),nn(this,"columnHeaderFunctions",[]),nn(this,"columnHeadersCount",0),nn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class kj{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new $j(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new Tj,columnHeaders:new _j(n),colGroup:new Mj(r),rows:new Pj(i),cells:new Dj}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function cp(t,e,n){return e=Fj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fj(t){var e=Wj(t,"string");return typeof e=="symbol"?e:String(e)}function Wj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vj{constructor(e,n){cp(this,"dataAccessObject",void 0),cp(this,"wtSettings",void 0),cp(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?Jt():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let d=Array.isArray(a)?a[c]:a;d=d??u,this.headerWidths.set(c,d)}}}}function zR(t,e,n){return e=Bj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bj(t){var e=Uj(t,"string");return typeof e=="symbol"?e:String(e)}function Uj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yj{constructor(e,n){zR(this,"dataAccessObject",void 0),zR(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function Kr(t,e,n){return e=zj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zj(t){var e=Gj(t,"string");return typeof e=="symbol"?e:String(e)}function Gj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jj{constructor(e,n,r,i,o){Kr(this,"wtSettings",null),Kr(this,"domBindings",void 0),Kr(this,"TBODY",null),Kr(this,"THEAD",null),Kr(this,"COLGROUP",null),Kr(this,"hasTableHeight",!0),Kr(this,"hasTableWidth",!0),Kr(this,"isTableVisible",!1),Kr(this,"tableOffset",0),Kr(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,cS(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Yj(this.dataAccessObject,this.wtSettings),this.columnUtils=new Vj(this.dataAccessObject,this.wtSettings),this.tableRenderer=new kj({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ve(r,[Lr()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[Lr()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ie(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ve(r.parentNode,[Lr()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[Lr()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let d=!1,f=e;if(this.isMaster&&(this.holderOffset=Bt(this.holder),f=i.createRenderCalculators(f),l&&!n.getSetting("fixedColumnsStart"))){const w=r.inlineStartOverlay.getScrollPosition(),v=this.correctHeaderWidth;this.correctHeaderWidth=w!==0,v!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(d=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=Bt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const w=o>0?this.getFirstRenderedRow():0,v=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new lj(w,o,c),this.columnFilter=new ij(v,s,l);let y=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),y=b.skipRender!==!0}if(y){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(li)||this.is(Ho))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let b;if(this.isMaster&&(b=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(li))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const _=ut(this.hider),I=ut(this.TABLE);_!==0&&I!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(li)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let m=!1;return this.isMaster&&(m=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(m=r.bottomOverlay.resetFixedPosition()||m),m=r.inlineStartOverlay.resetFixedPosition()||m,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),d&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Vi(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(li))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=$o(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=tI(r),s=n.cellIndex;return So(Bs,n,this.wtRootElement)||So(Ws,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):So(Ho,n,this.wtRootElement)||So(li,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),So(Bs,n,this.wtRootElement)||So(Vs,n,this.wtRootElement)||So(Ho,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=Vi(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=Vi(l):o=Vi(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ut(this.TABLE)}getHeight(){return Ot(this.TABLE)}getTotalWidth(){const e=ut(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Ot(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Fo(this.TABLE)}_modifyRowHeaderWidth(e){let n=gt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const cl=jj,Kj="stickyRowsBottom",eP={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};pi(eP,"MIXIN_NAME",Kj,{writable:!1,enumerable:!1});const tP=eP,Xj="stickyColumnsStart",nP={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pi(nP,"MIXIN_NAME",Xj,{writable:!1,enumerable:!1});const DS=nP;class NS extends cl{constructor(e,n,r,i){super(e,n,r,i,Ho)}}dt(NS,tP);dt(NS,DS);const qj=NS,Ws="top",li="bottom",Vs="inline_start",Bs="top_inline_start_corner",Ho="bottom_inline_start_corner",Zj=[Ws,li,Vs,Bs,Ho],Qj=new Map([[Ws,`ht_clone_${Ws}`],[li,`ht_clone_${li}`],[Vs,`ht_clone_${Vs} ht_clone_left`],[Bs,`ht_clone_${Bs} ht_clone_top_left_corner`],[Ho,`ht_clone_${Ho} ht_clone_bottom_left_corner`]]);function hp(t,e,n){return e=Jj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jj(t){var e=eK(t,"string");return typeof e=="symbol"?e:String(e)}function eK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tK{constructor(e){hp(this,"dataAccessObject",void 0),hp(this,"lastScrolledColumnPos",-1),hp(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?d=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(d=c.scrollTo(e,l?e>a:n)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=d.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(f=d.scrollTo(e,l?e>a:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=Bt(n.wtRootElement),u=Vi(n.hider),c=Vi(s),d=Hu(s,s);if(l.top+u-c<=d){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let m=i;m>0;m--)if(f+=e.sumCellSizes(m-1,m),l.top+u-f<=d){a=m;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=Bt(n.wtRootElement),l=Hu(o,o);if(a.top>l){const u=Vi(o);let c=r.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(c+=e.sumCellSizes(d-1,d),a.top+c-l>=u){s=d-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=Bt(n.wtRootElement),l=gu(n.hider),u=gu(o),c=Math.abs(Id(o,o));if(a.left+l-u<=c){let d=r.getRowHeaderWidth();for(let f=i;f>0;f--)if(d+=e.sumCellSizes(f-1,f),a.left+l-d<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const d=r.TABLE.getBoundingClientRect(),m=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(d.right-m)}else u=Bt(r.wtRootElement).left;const c=Math.abs(Id(s,s));if(u>c){const d=gu(s);let f=i.getRowHeaderWidth();for(let m=1;m<=o;m++)if(f+=n.sumCellSizes(m-1,m),u+f-c>=d){a=m-2;break}}}return a}}const nK=tK;function Rr(t,e,n){return e=rK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rK(t){var e=iK(t,"string");return typeof e=="symbol"?e:String(e)}function iK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LS{get eventManager(){return new or(this)}constructor(e,n){Rr(this,"wtTable",void 0),Rr(this,"wtScroll",void 0),Rr(this,"wtViewport",void 0),Rr(this,"wtOverlays",void 0),Rr(this,"selectionManager",void 0),Rr(this,"wtEvent",void 0),Rr(this,"guid",`wt_${sS()}`),Rr(this,"drawInterrupted",!1),Rr(this,"drawn",!1),Rr(this,"domBindings",void 0),Rr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new nK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){ko(r,e[n])}])}}createCellCoords(e,n){return new $d(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new xS(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function GR(t,e,n){return e=oK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oK(t){var e=sK(t,"string");return typeof e=="symbol"?e:String(e)}function sK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aK extends LS{constructor(e,n,r){super(e,n),GR(this,"cloneSource",void 0),GR(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new ZI(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function lK(t,e,n){return e=uK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uK(t){var e=cK(t,"string");return typeof e=="symbol"?e:String(e)}function cK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ac{constructor(e,n,r,i,o){lK(this,"wtSettings",null),pi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=$s(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=$s(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Du(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){pt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,o,c,u):d=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Jt())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(Zj.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("DIV"),s=r.createElement("TABLE"),a=e.wtRootElement.parentNode;o.className=`${Qj.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ve(o,[Lr()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Ws||u==="vertical"&&this.type===Vs?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Du(e.TABLE),new aK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;T([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class hK extends ac{constructor(e,n,r,i,o,s){super(e,n,Ho,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new qj(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else nc(n),this.repositionOverlay();let r=Ot(this.clone.wtTable.TABLE);const i=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Jt(r)),i.style.bottom=`${o}px`}}const dK="calculatedColumns",rP={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};pi(rP,"MIXIN_NAME",dK,{writable:!1,enumerable:!1});const $S=rP;class kS extends cl{constructor(e,n,r,i){super(e,n,r,i,li)}}dt(kS,tP);dt(kS,$S);const fK=kS;function gK(t,e,n){return e=mK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mK(t){var e=pK(t,"string");return typeof e=="symbol"?e:String(e)}function pK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wK extends ac{constructor(e,n,r,i){super(e,n,li,r,i),gK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new fK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Jt(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Af(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=Jt(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Ot(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Jt(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Hu(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Ie(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(J(s,"innerBorderBottom"),o=!a):(De(s,"innerBorderBottom"),o=a)}return o}}const CK="calculatedRows",iP={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pi(iP,"MIXIN_NAME",CK,{writable:!1,enumerable:!1});const oP=iP;class FS extends cl{constructor(e,n,r,i){super(e,n,r,i,Vs)}}dt(FS,oP);dt(FS,DS);const vK=FS,SK="localHooks",sP={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)xd(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};pi(sP,"MIXIN_NAME",SK,{writable:!1,enumerable:!1});const Zn=sP;let aP=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};dt(aP,Zn);const yK=aP,lP="active-header",WS="header",VS="area",BS="focus",bK="fill",RK="row",EK="column",TK="custom-selection",US=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var _K=UI;_K("flat");function MK(t,e){uP(t,e),e.add(t)}function jR(t,e,n){uP(t,e),e.set(t,n)}function uP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Wt(t,e){var n=cP(t,e,"get");return AK(t,n)}function AK(t,e){return e.get?e.get.call(t):e.value}function KR(t,e,n){var r=cP(t,e,"set");return OK(t,r,n),n}function cP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function OK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Er=new WeakMap,Yn=new WeakMap,Bc=new WeakSet;class IK{constructor(){MK(this,Bc),jR(this,Er,{writable:!0,value:void 0}),jR(this,Yn,{writable:!0,value:void 0})}setActiveOverlay(e){return KR(this,Yn,e),this}setActiveSelection(e){return KR(this,Er,e),this}scan(){const e=Wt(this,Er).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Wt(this,Er).getCorners(),{wtTable:s}=Wt(this,Yn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const d=s.columnFilter.renderedToSource(c);if(!(d<r||d>o)){for(let f=-l;f<0;f++){if(f<n||f>i)continue;const m=f+l;let w=s.getColumnHeader(d,m);const v=Wt(this,Yn).getSetting("onBeforeHighlightingColumnHeader",d,m,{selectionType:Wt(this,Er).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==d&&(w=s.getColumnHeader(v,m)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Wt(this,Er).getCorners(),{wtTable:s}=Wt(this,Yn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const d=s.rowFilter.renderedToSource(c);if(!(d<n||d>i)){for(let f=-l;f<0;f++){if(f<r||f>o)continue;const m=f+l;let w=s.getRowHeader(d,m);const v=Wt(this,Yn).getSetting("onBeforeHighlightingRowHeader",d,m,{selectionType:Wt(this,Er).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==d&&(w=s.getRowHeader(v,m)),e(w))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=Wt(this,Er).getCorners(),{wtTable:s}=Wt(this,Yn);dp(this,Bc,fp).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(Wt(this,Yn).createCellCoords(a,l)),c=Wt(this,Yn).getSetting("onAfterDrawSelection",a,l,Wt(this,Er).settings.layerLevel);typeof c=="string"&&J(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=Wt(this,Er).getCorners(),{wtTable:i}=Wt(this,Yn);dp(this,Bc,fp).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Wt(this,Yn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Wt(this,Er).getCorners(),{wtTable:i}=Wt(this,Yn);dp(this,Bc,fp).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Wt(this,Yn).createCellCoords(o,s));e(a)}})}}function fp(t){const{wtTable:e}=Wt(this,Yn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class PK{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=US,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Sr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Bi()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ue(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ue(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:f}=this.selectionHandles.styles,m=parseInt(u.borderWidth,10),w=parseInt(u.width,10),v=parseInt(c.width,10),y=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();u.top=`${parseInt(r-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const _=Math.min(parseInt(i+o,10),y-w-m*2),I=Math.min(parseInt(i+o-v/4,10),y-v-m*2);d[l]=`${_}px`,f[l]=`${I}px`;const L=Math.min(parseInt(r+s,10),b-w-m*2),x=Math.min(parseInt(r+s-v/4,10),b-v-m*2);d.top=`${L}px`,f.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(d.display="none",f.display="none"):(d.display="block",f.display="block")):(u.display="none",d.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const d=n.getRenderedRowsCount();for(let R=0;R<d;R+=1){const h=n.rowFilter.renderedToSource(R);if(h>=e[0]&&h<=e[2]){o=h,u=e[0];break}}for(let R=d-1;R>=0;R-=1){const h=n.rowFilter.renderedToSource(R);if(h>=e[0]&&h<=e[2]){s=h;break}}const f=n.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const h=n.columnFilter.renderedToSource(R);if(h>=e[1]&&h<=e[3]){a=h,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const h=n.columnFilter.renderedToSource(R);if(h>=e[1]&&h<=e[3]){l=h;break}}if(o===void 0||a===void 0){this.disappear();return}let m=n.getCell(this.wot.createCellCoords(o,a));const w=o!==s||a!==l,v=w?n.getCell(this.wot.createCellCoords(s,l)):m,y=Bt(m),b=w?Bt(v):y,_=Bt(n.TABLE),I=ut(n.TABLE),L=y.top,x=y.left,B=this.wot.wtSettings.getSetting("rtlMode");let z=0,ee=0;if(B){const R=ut(m),h=i.innerWidth-_.left-I;ee=x+R-b.left,z=i.innerWidth-x-R-h-1}else ee=b.left+ut(v)-x,z=x-_.left-1;if(this.isEntireColumnSelected(o,s)){const R=this.getDimensionsFromHeader("columns",a,l,u,_);let h=null;R&&([h,z,ee]=R),h&&(m=h)}let j=L-_.top-1,X=b.top+Ot(v)-L;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",o,s,c,_);let h=null;R&&([h,j,X]=R),h&&(m=h)}const ie=qi(m,i);parseInt(ie.borderTopWidth,10)>0&&(j+=1,X=X>0?X-1:0),parseInt(ie[B?"borderRightWidth":"borderLeftWidth"],10)>0&&(z+=1,ee=ee>0?ee-1:0);const oe=B?"right":"left";this.topStyle.top=`${j}px`,this.topStyle[oe]=`${z}px`,this.topStyle.width=`${ee}px`,this.topStyle.display="block",this.startStyle.top=`${j}px`,this.startStyle[oe]=`${z}px`,this.startStyle.height=`${X}px`,this.startStyle.display="block";const se=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${j+X-se}px`,this.bottomStyle[oe]=`${z}px`,this.bottomStyle.width=`${ee}px`,this.bottomStyle.display="block",this.endStyle.top=`${j}px`,this.endStyle[oe]=`${z+ee-se}px`,this.endStyle.height=`${X+1}px`,this.endStyle.display="block";let pe=this.settings.border.cornerVisible;pe=typeof pe=="function"?pe(this.settings.layerLevel):pe;const Me=this.wot.getSetting("onModifyGetCellCoords",s,l);let[Je,Pe]=[s,l];if(Me&&Array.isArray(Me)&&([,,Je,Pe]=Me),Bi()||!pe||this.isPartRange(Je,Pe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${j+X+this.cornerCenterPointOffset-1}px`,this.cornerStyle[oe]=`${z+ee+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=$s(n.TABLE);const h=R===i;h&&(R=r.documentElement);const g=parseInt(this.cornerDefaultStyle.width,10)/2,p=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const E=h?v.getBoundingClientRect().left:v.offsetLeft;let M=!1,O=0;B?(O=E-parseInt(this.cornerDefaultStyle.width,10)/2,M=O<0):(O=E+ut(v)+parseInt(this.cornerDefaultStyle.width,10)/2,M=O>=gu(R)),M&&(this.cornerStyle[oe]=`${Math.floor(z+ee+this.cornerCenterPointOffset-g)}px`,this.cornerStyle[B?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(h?v.getBoundingClientRect().top:v.offsetTop)+Ot(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=Vi(R)&&(this.cornerStyle.top=`${Math.floor(j+X+this.cornerCenterPointOffset-p)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Bi()&&this.updateMultipleSelectionHandlesPosition(s,l,j,z,ee,X)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,d=null,f=null,m=null,w=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Ot(...arguments)},c="ht__selection--rows",m="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ut(...arguments)},c="ht__selection--columns",m="left";break}if(a.classList.contains(c)){const y=this.wot.getSetting("columnHeaders").length;if(w=l(n,y-i),v=l(r,y-i),!w||!v)return!1;const b=Bt(w),_=Bt(v);return w&&v&&(d=b[m]-o[m]-1,f=_[m]+u(v)-b[m]),[w,d,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?J(this[e],"hidden"):(Ie(this[e],"hidden")&&De(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?J(this[e],"hidden"):De(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Bi()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const XR=PK;function xK(t,e){hP(t,e),e.add(t)}function oa(t,e,n){hP(t,e),e.set(t,n)}function hP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HK(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ve(t,e){var n=dP(t,e,"get");return DK(t,n)}function DK(t,e){return e.get?e.get.call(t):e.value}function qR(t,e,n){var r=dP(t,e,"set");return NK(t,r,n),n}function dP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function NK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var mn=new WeakMap,wn=new WeakMap,gp=new WeakMap,iu=new WeakMap,mp=new WeakMap,Qo=new WeakMap,ZR=new WeakSet;class LK{constructor(e){xK(this,ZR),oa(this,mn,{writable:!0,value:void 0}),oa(this,wn,{writable:!0,value:void 0}),oa(this,gp,{writable:!0,value:new IK}),oa(this,iu,{writable:!0,value:new WeakMap}),oa(this,mp,{writable:!0,value:new WeakSet}),oa(this,Qo,{writable:!0,value:new Map}),qR(this,wn,e)}setActiveOverlay(e){return qR(this,mn,e),Ve(this,gp).setActiveOverlay(Ve(this,mn)),Ve(this,iu).has(Ve(this,mn))||Ve(this,iu).set(Ve(this,mn),new Set),this}getFocusSelection(){return Ve(this,wn)!==null?Ve(this,wn).getFocus():null}getAreaSelection(){return Ve(this,wn)!==null?Ve(this,wn).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ve(this,Qo).has(e)){const r=Ve(this,Qo).get(e);if(r.has(Ve(this,mn)))return r.get(Ve(this,mn));const i=new XR(Ve(this,mn),e.settings);return r.set(Ve(this,mn),i),i}const n=new XR(Ve(this,mn),e.settings);return Ve(this,Qo).set(e,new Map([[Ve(this,mn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Ve(this,Qo).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Ve(this,Qo).get(e).forEach(n=>n.destroy()),Ve(this,Qo).delete(e)}render(e){if(Ve(this,wn)===null)return;e&&HK(this,ZR,$K).call(this);const n=Array.from(Ve(this,wn)),r=new Map;for(let i=0;i<n.length;i++){const o=n[i],{className:s,createLayers:a,selectionType:l}=o.settings;Ve(this,mp).has(o)||(Ve(this,mp).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const u=this.getBorderInstance(o);if(o.isEmpty()){u==null||u.disappear();continue}s&&Ve(this,gp).setActiveSelection(o).scan().forEach(f=>{if(r.has(f)){const m=r.get(f);m.has(s)&&a===!0?m.set(s,m.get(s)+1):m.set(s,1)}else r.set(f,new Map([[s,1]]))});const c=o.getCorners();Ve(this,mn).getSetting("onBeforeDrawBorders",c,l),u==null||u.appear(c)}r.forEach((i,o)=>{var s,a;const l=Array.from(i).map(u=>{let[c,d]=u;return d===1?c:[c,...Array.from({length:d-1},(f,m)=>`${c}-${m+1}`)]}).flat();l.forEach(u=>Ve(this,iu).get(Ve(this,mn)).add(u)),J(o,l),o.nodeName==="TD"&&Array.isArray((s=Ve(this,wn).options)===null||s===void 0?void 0:s.cellAttributes)?ve(o,Ve(this,wn).options.cellAttributes):o.nodeName==="TH"&&Array.isArray((a=Ve(this,wn).options)===null||a===void 0?void 0:a.headerAttributes)&&ve(o,Ve(this,wn).options.headerAttributes)})}}function $K(){const t=Ve(this,iu).get(Ve(this,mn)),e=Ve(this,mn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Ve(this,mn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Ve(this,wn).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Ve(this,wn).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Ve(this,wn).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Ve(this,wn).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)De(o[a],n),Yo(o[a],s)}),t.clear()}class kK extends ac{constructor(e,n,r,i){super(e,n,Vs,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new vK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Of(r,`${o}px`,"0px")):(o=this.getScrollPosition(),nc(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,hS(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Jt(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ut(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(US.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=Jt(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Id(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?De(n,"emptyRows"):J(n,"emptyRows");let s=!1;if(i&&!r.length)J(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=Ie(n,"innerBorderInlineStart");e?(J(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(De(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const FK="stickyRowsTop",fP={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};pi(fP,"MIXIN_NAME",FK,{writable:!1,enumerable:!1});const gP=fP;class YS extends cl{constructor(e,n,r,i){super(e,n,r,i,Bs)}}dt(YS,gP);dt(YS,DS);const WK=YS;function QR(t,e,n){return e=VK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VK(t){var e=BK(t,"string");return typeof e=="symbol"?e:String(e)}function BK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UK extends ac{constructor(e,n,r,i,o,s){super(e,n,Bs,r,i),QR(this,"topOverlay",void 0),QR(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new WK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Of(e,`${i}px`,`${o}px`)}else nc(e);let n=Ot(this.clone.wtTable.TABLE);const r=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class zS extends cl{constructor(e,n,r,i){super(e,n,r,i,Ws)}}dt(zS,gP);dt(zS,$S);const YK=zS;function zK(t,e,n){return e=GK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GK(t){var e=jK(t,"string");return typeof e=="symbol"?e:String(e)}function jK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KK extends ac{constructor(e,n,r,i){super(e,n,Ws,r,i),zK(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new YK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Of(e,"0px",`${i}px`)}else i=this.getScrollPosition(),nc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Af(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Jt(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Ot(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(US.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=Jt(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Hu(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?De(r,"emptyColumns"):J(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=Ie(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(J(r,"innerBorderTop"),o=!u):(De(r,"innerBorderTop"),o=u)}}return o}}function bi(t,e,n){return e=XK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XK(t){var e=qK(t,"string");return typeof e=="symbol"?e:String(e)}function qK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZK{constructor(e,n,r,i,o,s){bi(this,"wot",null),bi(this,"topOverlay",null),bi(this,"bottomOverlay",null),bi(this,"inlineStartOverlay",null),bi(this,"topInlineStartCornerOverlay",null),bi(this,"bottomInlineStartCornerOverlay",null),bi(this,"browserLineHeight",void 0),bi(this,"wtSettings",null),bi(this,"resizeObserver",new ResizeObserver(c=>{Lf(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Jt(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Du(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new KK(...e),this.bottomOverlay=new wK(...e),this.inlineStartOverlay=new kK(...e),this.topInlineStartCornerOverlay=new UK(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new hK(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",d=>this.onTableScroll(d),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!CS())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:f}=d.clone.wtTable;this.eventManager.addEventListener(f,"wheel",m=>this.onCloneWheel(m,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=ul(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Du(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:d,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return T(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const QK=ZK;function JR(t,e,n){return e=JK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JK(t){var e=e3(t,"string");return typeof e=="symbol"?e:String(e)}function e3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t3{constructor(e){JR(this,"settings",{}),JR(this,"defaults",Object.freeze(this.getDefaults())),Ue(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);ko(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ue(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class GS extends cl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=$s(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=Qa(e,"height",n),o=Qa(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const m=parseInt(qi(f,n).height,10);r.removeChild(f),m===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Fo(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}dt(GS,oP);dt(GS,$S);const n3=GS;class r3{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Ot(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,d=o-c;let f,m;if(a)return ut(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(d,o):f=Math.min(this.getContainerFillWidth(),d,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(i!==r&&(m=Qa(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(f,i.clientWidth);const w=e.getSetting("stretchH");return w==="none"||!w?Math.max(f,ut(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return Bt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ot(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=ut(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Os;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===Os?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Jt(this.domBindings.rootDocument),new GI({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:d=>r.getRowHeight(d),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Os;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new OS({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(vn),i=this.createColumnsCalculator(vn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Os),this.columnsRenderCalculator=this.createColumnsCalculator(Os)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(vn),this.columnsVisibleCalculator=this.createColumnsCalculator(vn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ue(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const i3=r3;class o3 extends LS{constructor(e,n){super(e,new t3(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new n3(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new i3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new LK(this.wtSettings.getSetting("selections")),this.wtEvent=new ZI(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new QK(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ue(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),De(this.wtTable.wtRootElement.parentNode,n),J(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class jS{constructor(e){e instanceof LS?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new jS(n);return()=>r},this._wot=new o3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function e0(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const d=!o.inInSelection(i),f=n||r&&d;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function s3(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const a3=new Map([["mousedown",e0],["mouseover",s3],["touchstart",e0]]);function t0(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;a3.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Hf(t)||t.type==="touchstart",isRightClick:Wo(t)})}const mP=new WeakMap,KS=Symbol("rootInstance");function l3(t){mP.set(t,!0)}function u3(t){return t===KS}function ed(t){return mP.has(t)}function Jo(t,e,n){c3(t,e),e.set(t,n)}function c3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uo(t,e,n){return e=h3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h3(t){var e=d3(t,"string");return typeof e=="symbol"?e:String(e)}function d3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function un(t,e){var n=pP(t,e,"get");return f3(t,n)}function f3(t,e){return e.get?e.get.call(t):e.value}function ur(t,e,n){var r=pP(t,e,"set");return g3(t,r,n),n}function pP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function g3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var pp=new WeakMap,wp=new WeakMap,Uc=new WeakMap,Ri=new WeakMap,Tr=new WeakMap,Cp=new WeakMap,vp=new WeakMap;class m3{constructor(e){uo(this,"hot",void 0),uo(this,"eventManager",void 0),uo(this,"settings",void 0),uo(this,"THEAD",void 0),uo(this,"TBODY",void 0),uo(this,"_wt",void 0),uo(this,"activeWt",void 0),Jo(this,pp,{writable:!0,value:0}),Jo(this,wp,{writable:!0,value:0}),uo(this,"postponedAdjustElementsSize",!1),Jo(this,Uc,{writable:!0,value:!1}),Jo(this,Ri,{writable:!0,value:void 0}),Jo(this,Tr,{writable:!0,value:void 0}),Jo(this,Cp,{writable:!0,value:0}),Jo(this,vp,{writable:!0,value:0}),this.hot=e,this.eventManager=new or(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),J(e,"handsontable"),ur(this,Tr,n.createElement("TABLE")),J(un(this,Tr),"htCore"),this.hot.getSettings().tableClassName&&J(un(this,Tr),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ve(un(this,Tr),[Lr()]),ve(e,[tY(),XO(this.hot.countRows()),qO(this.hot.countCols()),gY()])),this.THEAD=n.createElement("THEAD"),un(this,Tr).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),un(this,Tr).appendChild(this.TBODY),this.hot.table=un(this,Tr),this.hot.container.insertBefore(un(this,Tr),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(ur(this,Uc,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;xC(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{ur(this,Uc,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{un(this,Uc)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&xC(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&Hf(o)&&r.finish(),ur(this,Ri,!1);const s=If(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!Wo(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&Wo(o)&&(r.finish(),ur(this,Ri,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),ur(this,Ri,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(un(this,Ri)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const f=Jt(n);if(n.elementFromPoint(a+f,l)!==c||n.elementFromPoint(a,l+f)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(un(this,Tr),"selectstart",o=>{this.settings.fragmentSelection||Pd(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:un(this,Tr),isDataViewInstance:()=>ed(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),ur(this,wp,o.length),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),ur(this,pp,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let d=l,f=u;Array.isArray(c)&&([d,f]=c);const m=this.hot.getCellMeta(d,f),w=this.hot.colToProp(f);let v=this.hot.getDataAtRowProp(d,w);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,m)),this.hot.runHooks("beforeRenderer",a,l,u,w,v,m),this.hot.getCellRenderer(m)(this.hot,a,l,u,w,v,m),this.hot.runHooks("afterRenderer",a,l,u,w,v,m)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Fo(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,ur(this,Ri,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Eo(o)&&(t0(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,f)=>this.hot._createCellCoords(d,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,ur(this,Ri,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Eo(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Eo(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Eo(o)&&(un(this,Ri)&&t0(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(d,f)=>this.hot._createCellCoords(d,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Eo(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const d=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){const m=d.peekByIndex(a??0);l=[m.from.row,m.from.col,m.to.row,m.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,d=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",d,c,a);if(Array.isArray(f)){const[m,w,v,y]=f;return[m>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(m,1)):m,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,v>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,-1)):v,y>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(y,-1)):y]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new jS(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Pd(e))return!0;const n=Po(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return un(this,Ri)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Ie(r,"relative")){Vr(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;Ie(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(Vr(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ie(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Ie(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ks(e,r(n,i)):(ko(e,String.fromCharCode(160)),J(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){ur(this,Cp,e),ur(this,vp,n)}getLastSize(){return{width:un(this,Cp),height:un(this,vp)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return un(this,pp)}getRowHeadersCount(){return un(this,wp)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const p3=m3,wP="ABCDEFGHIJKLMNOPQRSTUVWXYZ",GC=wP.length;function $f(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%GC,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/GC,10);return n}function w3(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=GC**r*(wP.indexOf(t[n])+1);return e-=1,e}function C3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push($f(i)+(r+1));n.push(o)}return n}function v3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=$f(i)+(r+1);n.push(o)}return n}function S3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function XS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function qS(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Fe(t[0])&&(e=xf(t[0]))),e}function CP(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function vP(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const y3=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:qS,createEmptySpreadsheetData:S3,createSpreadsheetData:C3,createSpreadsheetObjectData:v3,dataRowToChangesArray:XS,isArrayOfArrays:CP,isArrayOfObjects:vP,spreadsheetColumnIndex:w3,spreadsheetColumnLabel:$f},Symbol.toStringTag,{value:"Module"}));function Tl(t,e,n){return e=b3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b3(t){var e=R3(t,"string");return typeof e=="symbol"?e:String(e)}function R3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Tl(this,"hot",void 0),Tl(this,"data",void 0),Tl(this,"dataType","array"),Tl(this,"colToProp",()=>{}),Tl(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return T(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):me(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Fe(s)||gt(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;me(0,u,c=>{const d=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,s);i?a.push(f):qh(a,d,f)}})}else Ue(s,(l,u)=>{qh(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Fs(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:qh(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=pI(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=Fs(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return me(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return qS(this.data)}destroy(){this.data=null,this.hot=null}}const T3=E3;function n0(t,e,n){return e=_3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _3(t){var e=M3(t,"string");return typeof e=="symbol"?e:String(e)}function M3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;n0(this,"indexedValues",[]),n0(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,gt(this.initValueOrFn)?me(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}dt(Xs,Zn);function ZS(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>gt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function QS(t,e){return ir(t,(n,r)=>e.includes(r)===!1)}class zo extends Xs{insert(e,n){this.indexedValues=ZS(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=QS(this.indexedValues,e),super.remove(e)}}class kf extends zo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Ft(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function JS(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function $u(t,e){return ir(t,n=>e.includes(n)===!1)}function ey(t,e){return Be(t,n=>n-e.filter(r=>r<n).length)}function ty(t,e){const n=e[0],r=e.length;return Be(t,i=>i>=n?i+r:i)}function A3(t,e,n){return e=O3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O3(t){var e=I3(t,"string");return typeof e=="symbol"?e:String(e)}function I3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ff extends Xs{constructor(){super(...arguments),A3(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=$u(this.orderOfIndexes,[e]),gt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=ZS(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=ty(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=QS(this.indexedValues,e),this.orderOfIndexes=$u(this.orderOfIndexes,e),this.orderOfIndexes=ey(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class lc extends zo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Ft(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const r0=new Map([["indexesSequence",{getListWithInsertedItems:JS,getListWithRemovedItems:$u}],["physicallyIndexed",{getListWithInsertedItems:ZS,getListWithRemovedItems:QS}]]),SP=t=>{if(r0.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return r0.get(t)};class yP extends Xs{constructor(){super(e=>e)}insert(e,n){const r=ty(this.indexedValues,n);this.indexedValues=JS(r,e,n),super.insert(e,n)}remove(e){const n=$u(this.indexedValues,e);this.indexedValues=ey(n,e),super.remove(e)}}const i0=new Map([["hiding",kf],["index",Xs],["linkedPhysicalIndexToValue",Ff],["physicalIndexToValue",zo],["trimming",lc]]);function P3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!i0.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(i0.get(t))(e)}function x3(t,e,n){return e=H3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H3(t){var e=D3(t,"string");return typeof e=="symbol"?e:String(e)}function D3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let jC=0;class ny{constructor(){x3(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),jC+=1)}unregister(e){const n=this.collection.get(e);ue(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),jC-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return mt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}dt(ny,Zn);function N3(){return jC}function Sp(t,e,n){return e=L3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L3(t){var e=$3(t,"string");return typeof e=="symbol"?e:String(e)}function $3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o0 extends ny{constructor(e,n){super(),Sp(this,"mergedValuesCache",[]),Sp(this,"aggregationFunction",void 0),Sp(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Be(this.get(),o=>o.getValues()),r=[],i=ue(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Be(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ue(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function k3(t,e,n){F3(t,e),e.set(t,n)}function F3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function W3(t,e,n){var r=bP(t,e,"set");return V3(t,r,n),n}function V3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function B3(t,e){var n=bP(t,e,"get");return U3(t,n)}function bP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function U3(t,e){return e.get?e.get.call(t):e.value}var yp=new WeakMap;class RP{constructor(){k3(this,yp,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(B3(this,yp)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){W3(this,yp,e)}}dt(RP,Zn);function s0(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function _l(t,e,n){Y3(t,e),e.set(t,n)}function Y3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cr(t,e){var n=EP(t,e,"get");return z3(t,n)}function z3(t,e){return e.get?e.get.call(t):e.value}function Yc(t,e,n){var r=EP(t,e,"set");return G3(t,r,n),n}function EP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function G3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var zc=new WeakMap,Ml=new WeakMap,Gc=new WeakMap,jc=new WeakMap,Kc=new WeakMap;class j3{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_l(this,zc,{writable:!0,value:new Set}),_l(this,Ml,{writable:!0,value:[]}),_l(this,Gc,{writable:!0,value:[]}),_l(this,jc,{writable:!0,value:!1}),_l(this,Kc,{writable:!0,value:!1}),Yc(this,Kc,e??!1)}createObserver(){const e=new RP;return cr(this,zc).add(e),e.addLocalHook("unsubscribe",()=>{cr(this,zc).delete(e)}),e._writeInitialChanges(s0(cr(this,Ml),cr(this,Gc))),e}emit(e){let n=cr(this,Gc);(!cr(this,jc)||cr(this,Ml).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(cr(this,Kc)):Yc(this,Ml,new Array(e.length).fill(cr(this,Kc))),cr(this,jc)||(Yc(this,jc,!0),n=cr(this,Ml)));const r=s0(n,e);cr(this,zc).forEach(i=>i._write(r)),Yc(this,Gc,e)}}function On(t,e,n){return e=K3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K3(t){var e=X3(t,"string");return typeof e=="symbol"?e:String(e)}function X3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class KC{constructor(){On(this,"indexesSequence",new yP),On(this,"trimmingMapsCollection",new o0(e=>e.some(n=>n===!0),!1)),On(this,"hidingMapsCollection",new o0(e=>e.some(n=>n===!0),!1)),On(this,"variousMapsCollection",new ny),On(this,"hidingChangesObservable",new j3({initialIndexValue:!1})),On(this,"notTrimmedIndexesCache",[]),On(this,"notHiddenIndexesCache",[]),On(this,"isBatched",!1),On(this,"indexesSequenceChanged",!1),On(this,"indexesChangeSource",void 0),On(this,"trimmedIndexesChanged",!1),On(this,"hiddenIndexesChanged",!1),On(this,"renderablePhysicalIndexesCache",[]),On(this,"fromPhysicalToVisualIndexesCache",new Map),On(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,P3(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof lc?this.trimmingMapsCollection.register(e,n):n instanceof kf?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ue(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ue(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ue(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ue(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Be(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=$u(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(JS(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ue(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Be(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}dt(KC,Zn);function q3(t,e){return Ue(e,(n,r)=>{mt(t[r])&&(t[r]=n)}),t}function TP(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function _P(t){ue(t)&&RS(ct`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Z3(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:Q3,getValues:J3}=Ur("phraseFormatters");function e4(t,e){Q3(t,e)}function t4(){return J3()}e4("pluralize",Z3);const MP="ContextMenu:items",$e=MP,Wf=`${$e}.noItems`,Vf=`${$e}.insertRowAbove`,Bf=`${$e}.insertRowBelow`,Uf=`${$e}.insertColumnOnTheLeft`,Yf=`${$e}.insertColumnOnTheRight`,zf=`${$e}.removeRow`,Gf=`${$e}.removeColumn`,jf=`${$e}.undo`,Kf=`${$e}.redo`,Xf=`${$e}.readOnly`,qf=`${$e}.clearColumn`,Zf=`${$e}.copy`,ry=`${$e}.copyWithHeaders`,iy=`${$e}.copyWithGroupHeaders`,oy=`${$e}.copyHeadersOnly`,Qf=`${$e}.cut`,Jf=`${$e}.freezeColumn`,eg=`${$e}.unfreezeColumn`,tg=`${$e}.mergeCells`,ng=`${$e}.unmergeCells`,rg=`${$e}.addComment`,ig=`${$e}.editComment`,og=`${$e}.removeComment`,sg=`${$e}.readOnlyComment`,ag=`${$e}.align`,lg=`${$e}.align.left`,ug=`${$e}.align.center`,cg=`${$e}.align.right`,hg=`${$e}.align.justify`,dg=`${$e}.align.top`,fg=`${$e}.align.middle`,gg=`${$e}.align.bottom`,mg=`${$e}.borders`,pg=`${$e}.borders.top`,wg=`${$e}.borders.right`,Cg=`${$e}.borders.bottom`,vg=`${$e}.borders.left`,Sg=`${$e}.borders.remove`,yg=`${$e}.nestedHeaders.insertChildRow`,bg=`${$e}.nestedHeaders.detachFromParent`,Rg=`${$e}.hideColumn`,Eg=`${$e}.showColumn`,Tg=`${$e}.hideRow`,_g=`${$e}.showRow`,Wn="Filters:",Lt=`${Wn}conditions`,uc=`${Lt}.none`,Mg=`${Lt}.isEmpty`,Ag=`${Lt}.isNotEmpty`,Og=`${Lt}.isEqualTo`,Ig=`${Lt}.isNotEqualTo`,Pg=`${Lt}.beginsWith`,xg=`${Lt}.endsWith`,Hg=`${Lt}.contains`,Dg=`${Lt}.doesNotContain`,n4=`${Lt}.byValue`,Ng=`${Lt}.greaterThan`,Lg=`${Lt}.greaterThanOrEqualTo`,$g=`${Lt}.lessThan`,kg=`${Lt}.lessThanOrEqualTo`,Fg=`${Lt}.isBetween`,Wg=`${Lt}.isNotBetween`,Vg=`${Lt}.after`,Bg=`${Lt}.before`,Ug=`${Lt}.today`,Yg=`${Lt}.tomorrow`,zg=`${Lt}.yesterday`,Gg=`${Wn}labels.filterByCondition`,jg=`${Wn}labels.filterByValue`,Kg=`${Wn}labels.conjunction`,cc=`${Wn}labels.disjunction`,ku=`${Wn}values.blankCells`,Xg=`${Wn}buttons.selectAll`,qg=`${Wn}buttons.clear`,Zg=`${Wn}buttons.ok`,Qg=`${Wn}buttons.cancel`,Jg=`${Wn}buttons.placeholder.search`,em=`${Wn}buttons.placeholder.value`,tm=`${Wn}buttons.placeholder.secondValue`,sy="CheckboxRenderer:",ay=`${sy}checked`,ly=`${sy}unchecked`,Go="ColumnHeader:",uy=`${Go}description.expandColumn`,cy=`${Go}description.collapseColumn`,hy=`${Go}description.sortRows`,dy=`${Go}label.multiColumnSortOrder`,fy=`${Go}label.openMenu`,gy=`${Go}label.beforeHiddenColumn`,my=`${Go}label.afterHiddenColumn`,hc="RowHeader:",py=`${hc}description.expandRow`,wy=`${hc}description.collapseRow`,Cy=`${hc}label.beforeHiddenRow`,vy=`${hc}label.afterHiddenRow`,r4=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:ay,CHECKBOX_RENDERER_NAMESPACE:sy,CHECKBOX_UNCHECKED:ly,COLUMN_HEADER_DESCRIPTION_COLLAPSE_COLUMN:cy,COLUMN_HEADER_DESCRIPTION_EXPAND_COLUMN:uy,COLUMN_HEADER_DESCRIPTION_SORT_ROWS:hy,COLUMN_HEADER_LABEL_AFTER_HIDDEN_COLUMN:my,COLUMN_HEADER_LABEL_BEFORE_HIDDEN_COLUMN:gy,COLUMN_HEADER_LABEL_MULTI_COLUMN_SORT_ORDER:dy,COLUMN_HEADER_LABEL_OPEN_MENU:fy,COLUMN_HEADER_NAMESPACE:Go,CONTEXTMENU_ITEMS_ADD_COMMENT:rg,CONTEXTMENU_ITEMS_ALIGNMENT:ag,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:gg,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:ug,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:hg,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:lg,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:fg,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:cg,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:dg,CONTEXTMENU_ITEMS_BORDERS:mg,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Cg,CONTEXTMENU_ITEMS_BORDERS_LEFT:vg,CONTEXTMENU_ITEMS_BORDERS_RIGHT:wg,CONTEXTMENU_ITEMS_BORDERS_TOP:pg,CONTEXTMENU_ITEMS_CLEAR_COLUMN:qf,CONTEXTMENU_ITEMS_COPY:Zf,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:oy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:iy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:ry,CONTEXTMENU_ITEMS_CUT:Qf,CONTEXTMENU_ITEMS_EDIT_COMMENT:ig,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Jf,CONTEXTMENU_ITEMS_HIDE_COLUMN:Rg,CONTEXTMENU_ITEMS_HIDE_ROW:Tg,CONTEXTMENU_ITEMS_INSERT_LEFT:Uf,CONTEXTMENU_ITEMS_INSERT_RIGHT:Yf,CONTEXTMENU_ITEMS_MERGE_CELLS:tg,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:bg,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:yg,CONTEXTMENU_ITEMS_NO_ITEMS:Wf,CONTEXTMENU_ITEMS_READ_ONLY:Xf,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:sg,CONTEXTMENU_ITEMS_REDO:Kf,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Sg,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Gf,CONTEXTMENU_ITEMS_REMOVE_COMMENT:og,CONTEXTMENU_ITEMS_REMOVE_ROW:zf,CONTEXTMENU_ITEMS_ROW_ABOVE:Vf,CONTEXTMENU_ITEMS_ROW_BELOW:Bf,CONTEXTMENU_ITEMS_SHOW_COLUMN:Eg,CONTEXTMENU_ITEMS_SHOW_ROW:_g,CONTEXTMENU_ITEMS_UNDO:jf,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:eg,CONTEXTMENU_ITEMS_UNMERGE_CELLS:ng,CONTEXT_MENU_ITEMS_NAMESPACE:MP,FILTERS_BUTTONS_CANCEL:Qg,FILTERS_BUTTONS_CLEAR:qg,FILTERS_BUTTONS_OK:Zg,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Jg,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:tm,FILTERS_BUTTONS_PLACEHOLDER_VALUE:em,FILTERS_BUTTONS_SELECT_ALL:Xg,FILTERS_CONDITIONS_AFTER:Vg,FILTERS_CONDITIONS_BEFORE:Bg,FILTERS_CONDITIONS_BEGINS_WITH:Pg,FILTERS_CONDITIONS_BETWEEN:Fg,FILTERS_CONDITIONS_BY_VALUE:n4,FILTERS_CONDITIONS_CONTAINS:Hg,FILTERS_CONDITIONS_EMPTY:Mg,FILTERS_CONDITIONS_ENDS_WITH:xg,FILTERS_CONDITIONS_EQUAL:Og,FILTERS_CONDITIONS_GREATER_THAN:Ng,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Lg,FILTERS_CONDITIONS_LESS_THAN:$g,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:kg,FILTERS_CONDITIONS_NAMESPACE:Lt,FILTERS_CONDITIONS_NONE:uc,FILTERS_CONDITIONS_NOT_BETWEEN:Wg,FILTERS_CONDITIONS_NOT_CONTAIN:Dg,FILTERS_CONDITIONS_NOT_EMPTY:Ag,FILTERS_CONDITIONS_NOT_EQUAL:Ig,FILTERS_CONDITIONS_TODAY:Ug,FILTERS_CONDITIONS_TOMORROW:Yg,FILTERS_CONDITIONS_YESTERDAY:zg,FILTERS_DIVS_FILTER_BY_CONDITION:Gg,FILTERS_DIVS_FILTER_BY_VALUE:jg,FILTERS_LABELS_CONJUNCTION:Kg,FILTERS_LABELS_DISJUNCTION:cc,FILTERS_NAMESPACE:Wn,FILTERS_VALUES_BLANK_CELLS:ku,ROW_HEADER_DESCRIPTION_COLLAPSE_ROW:wy,ROW_HEADER_DESCRIPTION_EXPAND_ROW:py,ROW_HEADER_LABEL_AFTER_HIDDEN_ROW:vy,ROW_HEADER_LABEL_BEFORE_HIDDEN_ROW:Cy,ROW_HEADER_NAMESPACE:hc},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const i4={languageCode:"en-US",[Wf]:"No available options",[Vf]:"Insert row above",[Bf]:"Insert row below",[Uf]:"Insert column left",[Yf]:"Insert column right",[zf]:["Remove row","Remove rows"],[Gf]:["Remove column","Remove columns"],[jf]:"Undo",[Kf]:"Redo",[Xf]:"Read only",[qf]:"Clear column",[ag]:"Alignment",[lg]:"Left",[ug]:"Center",[cg]:"Right",[hg]:"Justify",[dg]:"Top",[fg]:"Middle",[gg]:"Bottom",[Jf]:"Freeze column",[eg]:"Unfreeze column",[mg]:"Borders",[pg]:"Top",[wg]:"Right",[Cg]:"Bottom",[vg]:"Left",[Sg]:"Remove border(s)",[rg]:"Add comment",[ig]:"Edit comment",[og]:"Delete comment",[sg]:"Read-only comment",[tg]:"Merge cells",[ng]:"Unmerge cells",[Zf]:"Copy",[ry]:["Copy with header","Copy with headers"],[iy]:["Copy with group header","Copy with group headers"],[oy]:["Copy header only","Copy headers only"],[Qf]:"Cut",[yg]:"Insert child row",[bg]:"Detach from parent",[Rg]:["Hide column","Hide columns"],[Eg]:["Show column","Show columns"],[Tg]:["Hide row","Hide rows"],[_g]:["Show row","Show rows"],[uc]:"None",[Mg]:"Is empty",[Ag]:"Is not empty",[Og]:"Is equal to",[Ig]:"Is not equal to",[Pg]:"Begins with",[xg]:"Ends with",[Hg]:"Contains",[Dg]:"Does not contain",[Ng]:"Greater than",[Lg]:"Greater than or equal to",[$g]:"Less than",[kg]:"Less than or equal to",[Fg]:"Is between",[Wg]:"Is not between",[Vg]:"After",[Bg]:"Before",[Ug]:"Today",[Yg]:"Tomorrow",[zg]:"Yesterday",[ku]:"Blank cells",[Gg]:"Filter by condition",[jg]:"Filter by value",[Kg]:"And",[cc]:"Or",[Xg]:"Select all",[qg]:"Clear",[Zg]:"OK",[Qg]:"Cancel",[Jg]:"Search",[em]:"Value",[tm]:"Second value",[ay]:"Checked",[ly]:"Unchecked",[uy]:"Press ENTER to expand column.",[cy]:"Press ENTER to collapse column.",[hy]:"Press ENTER to change sorting.",[dy]:"Multi-column sorting order:",[fy]:"Press CTRL/CMD+ENTER to open menu.",[gy]:"The next column is hidden.",[my]:"The previous column is hidden.",[py]:"Press ENTER to expand row.",[wy]:"Press ENTER to collapse row.",[Cy]:"The next row is hidden.",[vy]:"The previous row is hidden."},AP=i4,o4=r4,XC=AP.languageCode,{register:s4,getItem:OP,hasItem:a4,getValues:l4}=Ur("languagesDictionaries");Sy(AP);function Sy(t,e){let n=t,r=e;return Fe(t)&&(r=t,n=r.languageCode),u4(n,r),s4(n,Rn(r)),Rn(r)}function u4(t,e){t!==XC&&q3(e,OP(XC))}function IP(t){return yy(t)?Rn(OP(t)):null}function yy(t){return a4(t)}function c4(){return l4()}function PP(t,e,n){const r=IP(t);if(r===null)return null;const i=r[e];if(mt(i))return null;const o=h4(i,n);return Array.isArray(o)?o[0]:o}function h4(t,e){let n=t;return T(t4(),r=>{n=r(t,e)}),n}function d4(t){let e=TP(t);return yy(e)||(e=XC,_P(t)),e}function f4(t,e,n){return e=g4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g4(t){var e=m4(t,"string");return typeof e=="symbol"?e:String(e)}function m4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p4 extends yK{constructor(e,n){super(e,null),f4(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const oo=p4;function bp(t){let{activeHeaderClassName:e,...n}=t;return new oo({className:e,...n,selectionType:lP})}function w4(t){let{areaCornerVisible:e,...n}=t;return new oo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:VS})}function C4(t){let{...e}=t;return new oo({className:"highlight",...e,selectionType:VS})}function v4(t){let{columnClassName:e,...n}=t;return new oo({className:e,...n,selectionType:EK})}function S4(t){let{cellCornerVisible:e,...n}=t;return new oo({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:BS})}function y4(t){let{border:e,visualCellRange:n,...r}=t;return new oo({...e,...r,selectionType:TK},n)}function b4(t){let{...e}=t;return new oo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:bK})}function a0(t){let{headerClassName:e,...n}=t;return new oo({className:e,...n,selectionType:WS})}function R4(t){let{rowClassName:e,...n}=t;return new oo({className:e,...n,selectionType:RK})}let xP;function E4(t,e){T4(t,e),e.add(t)}function T4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e,n){return e=_4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _4(t){var e=M4(t,"string");return typeof e=="symbol"?e:String(e)}function M4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ei(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Xr=new WeakSet;xP=Symbol.iterator;class A4{constructor(e){E4(this,Xr),Bn(this,"options",void 0),Bn(this,"layerLevel",0),Bn(this,"focus",void 0),Bn(this,"fill",void 0),Bn(this,"layeredAreas",new Map),Bn(this,"areas",new Map),Bn(this,"rowHeaders",new Map),Bn(this,"columnHeaders",new Map),Bn(this,"activeRowHeaders",new Map),Bn(this,"activeColumnHeaders",new Map),Bn(this,"activeCornerHeaders",new Map),Bn(this,"rowHighlights",new Map),Bn(this,"columnHighlights",new Map),Bn(this,"customSelections",[]),this.options=e,this.focus=S4(e),this.fill=b4(e)}isEnabledFor(e,n){let r=e;e===BS&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Ei(this,Xr,Ti).call(this,this.layeredAreas,w4)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Ei(this,Xr,Ti).call(this,this.areas,C4)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Ei(this,Xr,Ti).call(this,this.rowHeaders,a0)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Ei(this,Xr,Ti).call(this,this.columnHeaders,a0)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Ei(this,Xr,Ti).call(this,this.activeRowHeaders,bp)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Ei(this,Xr,Ti).call(this,this.activeColumnHeaders,bp)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Ei(this,Xr,Ti).call(this,this.activeCornerHeaders,bp)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Ei(this,Xr,Ti).call(this,this.rowHighlights,R4)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Ei(this,Xr,Ti).call(this,this.columnHighlights,v4)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(y4({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),T(this.areas.values(),e=>void e.clear()),T(this.layeredAreas.values(),e=>void e.clear()),T(this.rowHeaders.values(),e=>void e.clear()),T(this.columnHeaders.values(),e=>void e.clear()),T(this.activeRowHeaders.values(),e=>void e.clear()),T(this.activeColumnHeaders.values(),e=>void e.clear()),T(this.activeCornerHeaders.values(),e=>void e.clear()),T(this.rowHighlights.values(),e=>void e.clear()),T(this.columnHighlights.values(),e=>void e.clear())}[xP](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Ti(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const O4=A4;let HP;function l0(t,e,n){return e=I4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I4(t){var e=P4(t,"string");return typeof e=="symbol"?e:String(e)}function P4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}HP=Symbol.iterator;class x4{constructor(e){l0(this,"ranges",[]),l0(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[HP](){return this.ranges[Symbol.iterator]()}}const H4=x4;function Al(t,e){DP(t,e),e.add(t)}function Rp(t,e,n){DP(t,e),e.set(t,n)}function DP(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(t,e){var n=NP(t,e,"get");return D4(t,n)}function D4(t,e){return e.get?e.get.call(t):e.value}function zn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function qC(t,e,n){var r=NP(t,e,"set");return N4(t,r,n),n}function NP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function N4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Xc=new WeakMap,rt=new WeakMap,Vo=new WeakMap,Ep=new WeakSet,Tp=new WeakSet,ZC=new WeakSet,_p=new WeakSet,es=new WeakSet;class LP{constructor(e,n){Al(this,es),Al(this,_p),Al(this,ZC),Al(this,Tp),Al(this,Ep),Rp(this,Xc,{writable:!0,value:void 0}),Rp(this,rt,{writable:!0,value:void 0}),Rp(this,Vo,{writable:!0,value:{x:0,y:0}}),qC(this,Xc,e),qC(this,rt,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;zn(this,Ep,u0).call(this,{x:Ze(this,rt).navigableHeaders()?Ze(this,rt).countRowHeaders():0,y:Ze(this,rt).navigableHeaders()?Ze(this,rt).countColHeaders():0});const i=Ze(this,rt).createCellCoords(e,n);let o=Ze(this,Xc).current().highlight;const s=Ze(this,rt).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=zn(this,ZC,$P).call(this),{row:d,col:f}=zn(this,_p,h0).call(this,o),m=Ze(this,rt).fixedRowsBottom(),w=Ze(this,rt).minSpareRows(),v=Ze(this,rt).minSpareCols(),y=Ze(this,rt).autoWrapRow(),b=Ze(this,rt).autoWrapCol(),_=Ze(this,rt).createCellCoords(d+i.row,f+i.col);if(_.row>=c){const x=r&&w>0&&m===0,B=!x&&b,z=_.col+1,ee=Ze(this,rt).createCellCoords(_.row-c,z>=u?z-u:z);this.runLocalHooks("beforeColumnWrap",B,zn(this,es,sa).call(this,ee),z>=u),x?this.runLocalHooks("insertRowRequire",Ze(this,rt).countRenderableRows()):B&&_.assign(ee)}else if(_.row<0){const x=_.col-1,B=Ze(this,rt).createCellCoords(c+_.row,x<0?u+x:x);this.runLocalHooks("beforeColumnWrap",b,zn(this,es,sa).call(this,B),x<0),b&&_.assign(B)}if(_.col>=u){const x=r&&v>0,B=!x&&y,z=_.row+1,ee=Ze(this,rt).createCellCoords(z>=c?z-c:z,_.col-u);this.runLocalHooks("beforeRowWrap",B,zn(this,es,sa).call(this,ee),z>=c),x?this.runLocalHooks("insertColRequire",Ze(this,rt).countRenderableColumns()):B&&_.assign(ee)}else if(_.col<0){const x=_.row-1,B=Ze(this,rt).createCellCoords(x<0?c+x:x,u+_.col);this.runLocalHooks("beforeRowWrap",y,zn(this,es,sa).call(this,B),x<0),y&&_.assign(B)}const{rowDir:I,colDir:L}=zn(this,Tp,c0).call(this,_);a=I,l=L,o=zn(this,es,sa).call(this,_)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){zn(this,Ep,u0).call(this,{x:Ze(this,rt).navigableHeaders()?Ze(this,rt).countRowHeaders():0,y:Ze(this,rt).navigableHeaders()?Ze(this,rt).countColHeaders():0});const r=Ze(this,rt).createCellCoords(e,n),i=Ze(this,Xc).current(),o=Ze(this,rt).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=zn(this,_p,h0).call(this,i.to),d=Ze(this,rt).createCellCoords(u+r.row,c+r.col),{rowDir:f,colDir:m}=zn(this,Tp,c0).call(this,d);a=f,l=m;const w=zn(this,es,sa).call(this,d);r.row===0&&r.col!==0?s.col=w.col:r.row!==0&&r.col===0?s.row=w.row:(s.row=w.row,s.col=w.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function u0(t){let{x:e,y:n}=t;qC(this,Vo,{x:e,y:n})}function c0(t){const{width:e,height:n}=zn(this,ZC,$P).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function $P(){return{width:Ze(this,Vo).x+Ze(this,rt).countRenderableColumns(),height:Ze(this,Vo).y+Ze(this,rt).countRenderableRows()}}function h0(t){const{row:e,col:n}=Ze(this,rt).visualToRenderableCoords(t);return Ze(this,rt).createCellCoords(Ze(this,Vo).y+e,Ze(this,Vo).x+n)}function sa(t){const e=t.clone();return e.col=t.col-Ze(this,Vo).x,e.row=t.row-Ze(this,Vo).y,Ze(this,rt).renderableToVisualCoords(e)}dt(LP,Zn);const L4=LP,nm=0,rm=1,kP=2,by=3,$4=[by,kP],k4=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Mp=Symbol("root"),d0=Symbol("child");function el(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mp;if(e!==Mp&&e!==d0)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Mp;let i=nm;if(n){const o=t[0];t.length===0?i=rm:r&&o instanceof xS?i=by:r&&Array.isArray(o)?i=el(o,d0):t.length>=2&&t.length<=4&&!t.some((a,l)=>!k4[l].includes(typeof a))&&(i=kP)}return i}function Fu(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!$4.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===by;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),mt(u)&&(u=a),mt(c)&&(c=l),!r){const m=a,w=l,v=u,y=c;a=Math.min(m,v),l=Math.min(w,y),u=Math.max(m,v),c=Math.max(w,y)}const d=e(a,l),f=e(u,c);return n(d,d,f)}}function F4(t){const e=el(t.getSelected());if(e===nm||e===rm)return[];const n=Fu(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;T(Array.from(new Array(c),(d,f)=>u+f),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return Ft(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function W4(t){const e=el(t.getSelected());if(e===nm||e===rm)return[];const n=Fu(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;T(Array.from(new Array(c),(d,f)=>u+f),d=>{r.has(d)||r.add(d)})});const i=Array.from(r).sort((s,a)=>s-a);return Ft(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function V4(t,e,n){B4(t,e),e.set(t,n)}function B4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function co(t,e,n){return e=U4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U4(t){var e=Y4(t,"string");return typeof e=="symbol"?e:String(e)}function Y4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f0(t,e,n){var r=FP(t,e,"set");return z4(t,r,n),n}function z4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function g0(t,e){var n=FP(t,e,"get");return G4(t,n)}function FP(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function G4(t,e){return e.get?e.get.call(t):e.value}var Ol=new WeakMap;class WP{constructor(e,n){var r=this;co(this,"settings",void 0),co(this,"tableProps",void 0),co(this,"inProgress",!1),co(this,"selectedRange",new H4((i,o,s)=>this.tableProps.createCellRange(i,o,s))),co(this,"highlight",void 0),co(this,"transformation",void 0),co(this,"selectedByRowHeader",new Set),co(this,"selectedByColumnHeader",new Set),V4(this,Ol,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new O4({headerClassName:e.currentHeaderClassName,headerAttributes:[PC()],activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[PC()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new L4(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&mt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(BS,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(T(this.highlight.getAreas(),_=>void _.clear()),T(this.highlight.getLayeredAreas(),_=>void _.clear()),T(this.highlight.getRowHeaders(),_=>void _.clear()),T(this.highlight.getColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveRowHeaders(),_=>void _.clear()),T(this.highlight.getActiveColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveCornerHeaders(),_=>void _.clear()),T(this.highlight.getRowHighlights(),_=>void _.clear()),T(this.highlight.getColumnHighlights(),_=>void _.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),m=this.highlight.createActiveRowHeader(),w=this.highlight.createActiveColumnHeader(),v=this.highlight.createActiveCornerHeader(),y=this.highlight.createRowHighlight(),b=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),d.clear(),f.clear(),m.clear(),w.clear(),v.clear(),y.clear(),b.clear(),this.highlight.isEnabledFor(VS,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const _=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(_.from).commit().syncWith(_),this.highlight.createLayeredArea().add(_.from).commit().syncWith(_),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(WS,s.highlight)){if(!s.isSingleHeader()){const L=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),x=this.tableProps.createCellCoords(s.to.row,-1),B=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),z=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(d.add(L).commit(),f.add(B).commit(),y.add(L).commit(),b.add(B).commit()):(d.add(L).add(x).commit(),f.add(B).add(z).commit(),y.add(L).add(x).commit(),b.add(B).add(z).commit())}const _=!g0(this,Ol)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),I=!g0(this,Ol)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());_&&m.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),I&&w.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),_&&I&&v.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Fs(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:m}=i;f0(this,Ol,m),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(d=this.tableProps.createCellCoords(qn(f.row,u,o-1),qn(f.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,d),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),f0(this,Ol,!1)}selectCells(e){var n=this;const r=el(e);if(r===rm)return!1;if(r===nm)throw new Error(ct`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Fu(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),T(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),d=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const m=l===0?0:qn(r,u,-1),w=s-1,v=this.tableProps.createCellCoords(m,i),y=this.tableProps.createCellCoords(w,o),b=this.tableProps.createCellCoords(qn(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",v,y,b),v.row=m,y.row=w,this.setRangeStartOnly(v,void 0,b),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectColumns",v,y,b),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const d=s===0?0:qn(r,a,-1),f=o-1,m=this.tableProps.createCellCoords(e,d),w=this.tableProps.createCellCoords(n,f),v=this.tableProps.createCellCoords(e,qn(r,a,o-1));this.runLocalHooks("beforeSelectRows",m,w,v),m.col=d,w.col=f,this.setRangeStartOnly(m,void 0,v),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",m,w,v),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),f.commit(),m.commit()}this.highlight.useLayerLevel(r)}}dt(WP,Zn);const j4=WP,m0=/^(\r\n|\n\r|\r|\n)/,K4=/^[^\t\r\n]+/,p0=/^\t/;function X4(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(p0))t=t.replace(p0,""),n+=1,e[r][n]="";else if(t.match(m0))t=t.replace(m0,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(K4);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function mu(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function ts(t,e,n){return e=q4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q4(t){var e=Z4(t,"string");return typeof e=="symbol"?e:String(e)}function Z4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ya{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){ts(this,"hot",void 0),ts(this,"metaManager",void 0),ts(this,"tableMeta",void 0),ts(this,"dataSource",void 0),ts(this,"duckSchema",void 0),ts(this,"colToPropCache",void 0),ts(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=xf(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Fe(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return qS(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ue(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ue(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ue(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ja(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;a<n&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=Rn(this.getSchema()):(w=[],me(d-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},ic(w,this.getSchema())),f.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const m=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",m,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const d=this.hot.countSourceRows();let f=this.hot.countCols(),m=0,w=c;i==="end"&&(w=Math.min(w+1,a));const v=w;for(;m<n&&f<s;){if(typeof l!="number"||l>=f)if(d>0)for(let b=0;b<d;b+=1)typeof o[b]>"u"&&(o[b]=[]),o[b].push(null);else o.push([null]);else for(let b=0;b<d;b++)o[b].splice(w,0,null);m+=1,w+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,m),m>0&&(e==null?this.metaManager.createColumn(null,m):r!=="auto"&&this.metaManager.createColumn(v,n));const y=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",y,m,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((d,f)=>f-d);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let d=0;d<u;d++)l&&o[0]!==o[d]-d&&(l=!1);if(l)for(let d=0,f=this.hot.countSourceRows();d<f;d++)c[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(let d=0,f=this.hot.countSourceRows();d<f;d++)for(let m=0;m<u;m++)c[d].splice(s[m],1),d===0&&this.metaManager.removeColumn(s[m],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];_C(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return BO(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];_C(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&At(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=Fs(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=Fs(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&At(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,d;for(c=0,d=l.length-1;c<d;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Ya.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Ya.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=d;o++){a=[];const m=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=f&&m!==null;s++)a.push(c.call(this,o,this.colToProp(s)));m!==null&&i.push(a)}return i}getText(e,n){return mu(this.getRange(e,n,Ya.DESTINATION_RENDERER))}getCopyableText(e,n){return mu(this.getRange(e,n,Ya.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const Q4=Ya,{register:J4,getItem:e6,hasItem:VP,getNames:t6,getValues:Rae}=Ur("cellTypes");function Ry(t){if(!VP(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return e6(t)}function Cn(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&jn(t,n),r&&ii(t,r),i&&Ua(t,i),J4(t,e)}function n6(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!At(e,t)}function im(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Ry(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ue(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Fe(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ue(r,(o,s)=>{if(n6(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Ut(t,i)}function r6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}ro(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function td(t){return Number.isInteger(t)&&t>=0}function nd(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function qc(t){return t==null}const BP=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Xt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Xt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Pf(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,disableTabNavigation:!1,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function w0(t,e,n){return e=i6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i6(t){var e=o6(t,"string");return typeof e=="symbol"?e:String(e)}function o6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s6(){return class{}}class a6{constructor(e){w0(this,"metaCtor",s6()),w0(this,"meta",void 0),this.meta=this.metaCtor.prototype,Ut(this.meta,BP()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Ut(this.meta,e),im(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function l6(t,e,n){return e=u6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u6(t){var e=c6(t,"string");return typeof e=="symbol"?e:String(e)}function c6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h6{constructor(e){l6(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Ut(this.meta,e),im(this.meta,e,e)}}let UP;function Zc(t,e,n){return e=d6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d6(t){var e=f6(t,"string");return typeof e=="symbol"?e:String(e)}function f6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}UP=Symbol.iterator;class Wd{constructor(e){Zc(this,"valueFactory",void 0),Zc(this,"data",[]),Zc(this,"index",[]),Zc(this,"holes",new Set),this.valueFactory=e}obtain(e){nd(()=>td(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;nd(()=>td(e)||qc(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=qc(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;nd(()=>td(e)||qc(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(qc(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return ir(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[UP](){return this.entries()}}function C0(t,e,n){return e=g6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g6(t){var e=m6(t,"string");return typeof e=="symbol"?e:String(e)}function m6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const p6=["data","width"];class w6{constructor(e){C0(this,"globalMeta",void 0),C0(this,"metas",new Wd(()=>this._createMeta())),this.globalMeta=e,this.metas=new Wd(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Ut(r,n),im(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return r6(this.globalMeta.getMetaConstructor(),p6).prototype}}function v0(t,e,n){return e=C6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C6(t){var e=v6(t,"string");return typeof e=="symbol"?e:String(e)}function v6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S6{constructor(e){v0(this,"columnMeta",void 0),v0(this,"metas",new Wd(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Ut(i,r),im(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){nd(()=>td(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Wd(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class YP{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new a6(e),this.tableMeta=new h6(this.globalMeta),this.columnMeta=new w6(this.globalMeta),this.cellMeta=new S6(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}dt(YP,Zn);function S0(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,d=bn(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":gt(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${d}`,t,c,l);const m=new Q4(i,t,u);if(e(m),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=m.getSchema();t=[];let v,y=0,b=0;for(y=0,b=f.startRows;y<b;y++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)v=Rn(w),t.push(v);else if(i.dataType==="array")v=Rn(w[0]),t.push(v);else{v=[];for(let _=0,I=f.startCols;_<I;_++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,m.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=m.colToProp.bind(m),s.propToCol=m.propToCol.bind(m),s.countCachedColumns=m.countCachedColumns.bind(m),n(m),i.runHooks(`after${d}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&ve(i.rootElement,[XO(i.countRows()),qO(i.countCols())])}function y0(t,e,n){return e=y6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y6(t){var e=b6(t,"string");return typeof e=="symbol"?e:String(e)}function b6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class R6{constructor(e){y0(this,"metaManager",void 0),y0(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),de.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=At(e,"type")?e.type:null;let c=gt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var d;c.type=(d=c.type)!==null&&d!==void 0?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Ap(t,e,n){return e=E6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E6(t){var e=T6(t,"string");return typeof e=="symbol"?e:String(e)}function T6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _6{constructor(e){Ap(this,"metaManager",void 0),Ap(this,"usageTracker",new Set),Ap(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const zP="gridDefault",Ey="editorManager.handlingEditor",M6={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(t.getShortcutManager().isCtrlPressed()),r.moveSelectionAfterEnter(n.includes("shift"))}},A6={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},O6={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},I6={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Sr(e))}};function P6(){return[M6,A6,O6,I6]}const x6={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},H6={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},D6={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},N6={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},L6={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},$6={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},k6={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},F6={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},W6={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},V6={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},B6={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},U6={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},Y6={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},z6={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function G6(){return[x6,H6,D6,N6,L6,$6,k6,F6,W6,V6,B6,U6,Y6,z6]}const j6={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},K6={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},X6={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},q6={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col,!0)}},Z6={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},Q6={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},J6={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},e9={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},t9={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},n9={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},r9={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},i9={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},o9={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},s9={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},a9={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},l9={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function u9(){return[j6,K6,X6,q6,Z6,Q6,J6,e9,t9,n9,r9,i9,o9,s9,a9,l9]}const c9={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},h9={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},d9={name:"selectAll",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},f9={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},g9=[...P6(),...G6(),...u9(),c9,h9,d9,f9];function GP(t){const e={};return g9.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function m9(t){const e=t.getShortcutManager().addContext("editor"),n=GP(t),r={group:Ey};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function p9(t){const e=t.getShortcutManager().addContext("grid"),n=GP(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:zP};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ey,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"],["Control/Meta","Shift","Space"]],callback:()=>n.selectAll()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function w9(t){[m9,p9].forEach(e=>e(t))}function C9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=b0(t),i=b0(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function b0(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ve(n,[Lr()]),n}function v9(t){let e;const{activate:n,deactivate:r}=C9(t,{onFocusFromTop(){var s;const a=(s=e)!==null&&s!==void 0?s:R0(t);a&&(t.runHooks("modifyFocusOnTabNavigation","from_above",a),t.selectCell(a.row,a.col)),t.listen()},onFocusFromBottom(){var s;const a=(s=e)!==null&&s!==void 0?s:E0(t);a&&(t.runHooks("modifyFocusOnTabNavigation","from_below",a),t.selectCell(a.row,a.col)),t.listen()}}),i={wrapped:!1,flipped:!1};t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",()=>{var s;e=(s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight}),t.addHook("beforeRowWrap",(s,a,l)=>{i.wrapped=!0,i.flipped=l});function o(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}t.getShortcutManager().getContext("grid").addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:s=>{const{disableTabNavigation:a,autoWrapRow:l}=t.getSettings();if(a||!t.selection.isSelected()||l&&i.wrapped&&i.flipped||!l&&i.wrapped)return l&&i.wrapped&&i.flipped&&(e=s.shiftKey?R0(t):E0(t)),o(),!1;s.preventDefault()},runOnlyIf:()=>!t.getSettings().minSpareCols,preventDefault:!1,stopPropagation:!1,position:"after",relativeToGroup:zP,group:"focusCatcher"})}function R0(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function E0(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const T0=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Qc=t=>t.map(e=>{const n=e.toLowerCase();return T0.has(n)?T0.get(n):n}).sort().join("+"),S9=t=>t.split("+"),_0=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Op=t=>{let{key:e,code:n}=t;return(_0.test(n)?n.replace(_0,"$1"):e).toLowerCase()},jP=Symbol("shortcut-context");function KP(t){return Fe(t)&&t.__kindOf===jP}const y9=t=>{const e=Nf({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:m=!0,stopPropagation:w=!1,relativeToGroup:v,position:y,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(mt(c))throw new Error("You need to define the shortcut's group.");if(gt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ct`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:u,group:c,runOnlyIf:d,captureCtrl:f,preventDefault:m,stopPropagation:w};ue(v)&&([_.relativeToGroup,_.position]=[v,y]),KP(b)&&(_.forwardToContext=b),l.forEach(I=>{const L=Qc(I);if(e.hasItem(L)){const B=e.getItem(L);let z=B.findIndex(ee=>ee.group===v);z!==-1?y==="before"?z-=1:z+=1:z=B.length,B.splice(z,0,_)}else e.addItem(L,[_])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ue(u,(d,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},i=l=>{const u=Qc(l);e.removeItem(u)};return{__kindOf:jP,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Qc(l),c=e.getItem(u);return ue(c)?c.slice():[]},hasShortcut:l=>{const u=Qc(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[d,f]=c;const m=f.filter(w=>w.group!==l);m.length===0?i(S9(d)):(f.length=0,f.push(...m))})}}};function b9(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const R9=["meta","alt","shift","control"],Il=b9();let Jc=0;function E9(t,e,n,r,i){const o=m=>R9.includes(m),s=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return m.altKey&&v.push("alt"),w&&(m.ctrlKey||m.metaKey)?v.push("control/meta"):(m.ctrlKey&&v.push("control"),m.metaKey&&v.push("meta")),m.shiftKey&&v.push("shift"),v},a=m=>{if(e(m)===!1)return;const w=n(m);if(m.keyCode===229||w===!1||Eo(m))return;const v=Op(m);let y=[];o(v)||(y=s(m));const b=[v].concat(y);!i(m,b)&&(Nu()&&y.includes("meta")||!Nu()&&y.includes("control"))&&i(m,[v].concat(s(m,!0))),r(m)},l=m=>{const w=Op(m);o(w)&&Il.press(w)},u=m=>{const w=Op(m);o(w)&&Il.release(w)},c=()=>{Il.releaseAll()};return{mount:()=>{let m=t;for(Jc+=1;m;)Jc===1&&(m.document.documentElement.addEventListener("keydown",l),m.document.documentElement.addEventListener("keyup",u)),m.document.documentElement.addEventListener("keydown",a),m.document.documentElement.addEventListener("blur",c),m=xu(m)},unmount:()=>{let m=t;for(Jc-=1;m;)Jc===0&&(m.document.documentElement.removeEventListener("keydown",l),m.document.documentElement.removeEventListener("keyup",u)),m.document.documentElement.removeEventListener("keydown",a),m.document.documentElement.removeEventListener("blur",c),m=xu(m)},isPressed:m=>Il.isPressed(m),releasePressedKeys:()=>Il.releaseAll()}}const T9=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Nf({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const v=y9(w);return o.addItem(w,v),v},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(ct`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let d=!1;const f=function(w,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=KP(y)?y:u(y);let _=!1;if(!b.hasShortcut(v))return _;const I=b.getShortcuts(v);for(let L=0;L<I.length;L++){const{callback:x,runOnlyIf:B,preventDefault:z,stopPropagation:ee,captureCtrl:j,forwardToContext:X}=I[L];if(B(w)===!0){if(d=j,_=x(w,v)===!1,d=!1,z&&w.preventDefault(),ee&&(Sr(w),w.stopPropagation()),_)break;X&&f(w,v,X)}}return _},m=E9(e,n,r,i,f);return m.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!d&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};let Ip=null;const Pp=new Map;function XP(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new or(s);let l,u,c,d,f,m=!0;u3(i)&&l3(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=d4(e.language);const y=new YP(s,e,[R6,_6]),b=y.getTableMeta(),_=y.getGlobalMeta(),I=Nf();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),ed(this)&&GO(e.licenseKey,t),this.guid=`ht_${sS()}`,Pp.set(this.guid,this),this.columnIndexMapper=new KC,this.rowIndexMapper=new KC,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{s.runHooks("afterRowSequenceChange",h)}),u=new T3(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const L=h=>{const{row:g,col:p}=h;return s._createCellCoords(g>=0?s.rowIndexMapper.getRenderableFromVisualIndex(g):g,p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p)},x=h=>{const{row:g,col:p}=h;return s._createCellCoords(g>=0?s.rowIndexMapper.getVisualFromRenderableIndex(g):g,p>=0?s.columnIndexMapper.getVisualFromRenderableIndex(p):p)};let B=new j4(b,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:h=>l.propToCol(h),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(h,g)=>s._createCellCoords(h,g),createCellRange:(h,g,p)=>s._createCellRange(h,g,p),visualToRenderableCoords:L,renderableToVisualCoords:x,isDisabledCellSelection:(h,g)=>h<0||g<0?s.getSettings().disableVisualSelection:s.getCellMeta(h,g).disableVisualSelection});this.selection=B;const z=h=>{let{hiddenIndexesChanged:g}=h;g&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("afterSetRangeEnd",h=>{const g=Fs(!1),p=this.selection.getSelectedRange(),{from:E,to:M}=p.current(),O=p.size()-1;this.runHooks("afterSelection",E.row,E.col,M.row,M.col,g,O),this.runHooks("afterSelectionByProp",E.row,s.colToProp(E.col),M.row,s.colToProp(M.col),g,O);let Y=!0;o&&(Y=!1),g.isTouched()&&(Y=!g.value);const W=this.selection.selectedRange.current(),q=this.selection.isSelectedByAnyHeader(),Z=this.selection.isSelectedByRowHeader(),K=this.selection.isSelectedByColumnHeader();if(Y!==!1)if(q)Z?this.scrollViewportTo({row:h.row}):K&&this.scrollViewportTo({col:h.col});else if(W&&!this.selection.isMultiple()){const{row:ce,col:Ae}=W.from;ce<0&&Ae>=0?this.scrollViewportTo({col:Ae}):Ae<0&&ce>=0?this.scrollViewportTo({row:ce}):this.scrollViewportTo({row:ce,col:Ae})}else this.scrollViewportTo(h.toObject());Z&&K?J(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Z?(De(this.rootElement,"ht__selection--columns"),J(this.rootElement,"ht__selection--rows")):K?(De(this.rootElement,"ht__selection--rows"),J(this.rootElement,"ht__selection--columns")):De(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",h=>{const g=h.length-1,{from:p,to:E}=h[g];this.runHooks("afterSelectionEnd",p.row,p.col,E.row,E.col,g),this.runHooks("afterSelectionEndByProp",p.row,s.colToProp(p.col),E.row,s.colToProp(E.col),g)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const g=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=g)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),De(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...g)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...g)}).addLocalHook("beforeSetRangeEnd",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...g)}).addLocalHook("beforeSelectColumns",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("beforeSelectColumns",...g)}).addLocalHook("afterSelectColumns",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("afterSelectColumns",...g)}).addLocalHook("beforeSelectRows",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("beforeSelectRows",...g)}).addLocalHook("afterSelectRows",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("afterSelectRows",...g)}).addLocalHook("beforeModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("modifyTransformStart",...g)}).addLocalHook("afterModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...g)}).addLocalHook("beforeModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("modifyTransformEnd",...g)}).addLocalHook("afterModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...g)}).addLocalHook("beforeRowWrap",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("beforeRowWrap",...g)}).addLocalHook("beforeColumnWrap",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return r.runHooks("beforeColumnWrap",...g)}).addLocalHook("insertRowRequire",h=>this.alter("insert_row_above",h,1,"auto")).addLocalHook("insertColRequire",h=>this.alter("insert_col_start",h,1,"auto")),c={alter(h,g){var p,E;let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=arguments.length>3?arguments[3]:void 0,Y=arguments.length>4?arguments[4]:void 0;const W=q=>{if(q.length===0)return[];const Z=[...q];return Z.sort((ce,Ae)=>{let[Te]=ce,[_e]=Ae;return Te===_e?0:Te>_e?1:-1}),Ft(Z,(ce,Ae)=>{let[Te,_e]=Ae;const G=ce[ce.length-1],[Ge,We]=G,ye=Ge+We;if(Te<=ye){const xe=Math.max(_e-(ye-Te),0);G[1]+=xe}else ce.push([Te,_e]);return ce},[Z[0]])};switch(h){case"insert_row_below":case"insert_row_above":const q=s.countSourceRows();if(b.maxRows===q)return;const Z=h==="insert_row_below"?"below":"above";g=(p=g)!==null&&p!==void 0?p:Z==="below"?q:0;const{delta:K,startPhysicalIndex:ce}=l.createRow(g,M,{source:O,mode:Z});if(K){const We=B.selectedRange.current(),ye=We==null?void 0:We.from,xe=ye==null?void 0:ye.row,Se=s.toVisualRow(ce);if(B.isSelectedByCorner())B.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ue(xe)&&xe>=Se){const{row:C,col:S}=We.to;let A=ye.col;B.isSelectedByRowHeader()&&(A=-1),B.getSelectedRange().pop(),B.setRangeStartOnly(s._createCellCoords(xe+K,A),!0),B.setRangeEnd(s._createCellCoords(C+K,S))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Ae=h==="insert_col_end"?"end":"start";g=(E=g)!==null&&E!==void 0?E:Ae==="end"?s.countSourceCols():0;const{delta:Te,startPhysicalIndex:_e}=l.createCol(g,M,{source:O,mode:Ae});if(Te){if(Array.isArray(b.colHeaders)){const C=[s.toVisualColumn(_e),0];C.length+=Te,Array.prototype.splice.apply(b.colHeaders,C)}const We=B.selectedRange.current(),ye=We==null?void 0:We.from,xe=ye==null?void 0:ye.col,Se=s.toVisualColumn(_e);if(B.isSelectedByCorner())B.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ue(xe)&&xe>=Se){const{row:C,col:S}=We.to;let A=ye.row;B.isSelectedByColumnHeader()&&(A=-1),B.getSelectedRange().pop(),B.setRangeStartOnly(s._createCellCoords(A,xe+Te),!0),B.setRangeEnd(s._createCellCoords(C,S+Te))}else s._refreshBorders()}break;case"remove_row":const G=We=>{let ye=0;T(We,xe=>{let[Se,C]=xe;const S=Xt(Se)?s.countRows()-1:Math.max(Se-ye,0);if(Number.isInteger(Se)&&(Se=Math.max(Se-ye,0)),!l.removeRow(Se,C,O))return;const F=s.countRows(),P=b.fixedRowsTop;P>=S+1&&(b.fixedRowsTop-=Math.min(C,P-S));const k=b.fixedRowsBottom;k&&S>=F-k&&(b.fixedRowsBottom-=Math.min(C,k)),ye+=C})};Array.isArray(g)?G(W(g)):G([[g,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Ge=We=>{let ye=0;T(We,xe=>{let[Se,C]=xe;const S=Xt(Se)?s.countCols()-1:Math.max(Se-ye,0);let A=s.toPhysicalColumn(S);if(Number.isInteger(Se)&&(Se=Math.max(Se-ye,0)),!l.removeCol(Se,C,O))return;const P=b.fixedColumnsStart;P>=S+1&&(b.fixedColumnsStart-=Math.min(C,P-S)),Array.isArray(b.colHeaders)&&(typeof A>"u"&&(A=-1),b.colHeaders.splice(A,C)),ye+=C})};Array.isArray(g)?Ge(W(g)):Ge([[g,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${h}"`)}Y||c.adjustRowsAndCols()},adjustRowsAndCols(){const h=b.minRows,g=b.minSpareRows,p=b.minCols,E=b.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&B.deselect(),h){const M=s.countRows();M<h&&l.createRow(M,h-M,{source:"auto"})}if(g){const M=s.countEmptyRows(!0);if(M<g){const O=g-M,Y=Math.min(O,b.maxRows-s.countSourceRows());l.createRow(s.countRows(),Y,{source:"auto"})}}{let M;(p||E)&&(M=s.countEmptyCols(!0));let O=s.countCols();if(p&&!b.columns&&O<p){const Y=p-O;M+=Y,l.createCol(O,Y,{source:"auto"})}if(E&&!b.columns&&s.dataType==="array"&&M<E){O=s.countCols();const Y=E-M,W=Math.min(Y,b.maxCols-O);l.createCol(O,W,{source:"auto"})}}if(B.isSelected()){const M=s.countRows(),O=s.countCols();T(B.selectedRange,Y=>{let W=!1,q=Y.from.row,Z=Y.from.col,K=Y.to.row,ce=Y.to.col;q>M-1?(q=M-1,W=!0,K>q&&(K=q)):K>M-1&&(K=M-1,W=!0,q>K&&(q=K)),Z>O-1?(Z=O-1,W=!0,ce>Z&&(ce=Z)):ce>O-1&&(ce=O-1,W=!0,Z>ce&&(Z=ce)),W&&s.selectCell(q,Z,K,ce)})}s.view&&s.view.adjustElementsSize()},populateFromArray(h,g,p,E,M){let O,Y,W,q;const Z=[],K={},ce=[],Ae=h.row,Te=h.col;if(Y=g.length,Y===0)return!1;let _e=0,G=0;switch(Fe(p)&&(_e=p.col-Te+1,G=p.row-Ae+1),M){case"shift_down":const Ge=hu(g),We=Ge.length,ye=Math.max(We,_e),xe=s.getData().slice(Ae),Se=hu(xe).slice(Te,Te+ye);for(W=0;W<ye;W+=1)if(W<We){for(O=0,Y=Ge[W].length;O<G-Y;O+=1)Ge[W].push(Ge[W][O%Y]);W<Se.length?ce.push(Ge[W].concat(Se[W])):ce.push(Ge[W].concat(new Array(xe.length).fill(null)))}else ce.push(Ge[W%We].concat(Se[W]));s.populateFromArray(Ae,Te,hu(ce));break;case"shift_right":const C=g.length,S=Math.max(C,G),A=s.getData().slice(Ae).map(U=>U.slice(Te));for(O=0;O<S;O+=1)if(O<C){for(W=0,q=g[O].length;W<_e-q;W+=1)g[O].push(g[O][W%q]);if(O<A.length)for(let U=0;U<A[O].length;U+=1)g[O].push(A[O][U]);else g[O].push(...new Array(A[0].length).fill(null))}else g.push(g[O%Y].slice(0,S).concat(A[O]));s.populateFromArray(Ae,Te,g);break;case"overwrite":default:K.row=h.row,K.col=h.col;let F=0,P=0,k=!0,H;const D=function(re){let he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ce=g[re%g.length];return he!==null?Ce[he%Ce.length]:Ce},V=g.length,$=p?p.row-h.row+1:0;for(p?Y=$:Y=Math.max(V,$),O=0;O<Y&&!(p&&K.row>p.row&&$>V||!b.allowInsertRow&&K.row>s.countRows()-1||K.row>=b.maxRows);O++){const U=O-F,re=D(U).length,he=p?p.col-h.col+1:0;if(p?q=he:q=Math.max(re,he),K.col=h.col,H=s.getCellMeta(K.row,K.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&H.skipRowOnPaste){F+=1,K.row+=1,Y+=1;continue}for(P=0,W=0;W<q&&!(p&&K.col>p.col&&he>re||!b.allowInsertColumn&&K.col>s.countCols()-1||K.col>=b.maxCols);W++){if(H=s.getCellMeta(K.row,K.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&H.skipColumnOnPaste){P+=1,K.col+=1,q+=1;continue}if(H.readOnly&&E!=="UndoRedo.undo"){K.col+=1;continue}const Ce=W-P;let Oe=D(U,Ce),ke=s.getDataAtCell(K.row,K.col);if(Oe!==null&&typeof Oe=="object")if(Array.isArray(Oe)&&ke===null&&(ke=[]),ke===null||typeof ke!="object")k=!1;else{const wt=Ja(Array.isArray(ke)?ke:ke[0]||ke),Xe=Ja(Array.isArray(Oe)?Oe:Oe[0]||Oe);Pf(wt,Xe)||Array.isArray(wt)&&Array.isArray(Xe)?Oe=Rn(Oe):k=!1}else ke!==null&&typeof ke=="object"&&(k=!1);k&&Z.push([K.row,K.col,Oe]),k=!0,K.col+=1}K.row+=1}s.setDataAtCell(Z,null,null,E||"populateFromArray");break}}};function ee(h){const g=TP(h);yy(g)?(s.runHooks("beforeLanguageChange",g),_.language=g,s.runHooks("afterLanguageChange",g)):_P(h)}function j(h,g){const p=h==="className"?s.rootElement:s.table;if(m)J(p,g);else{let E=[],M=[];_[h]&&(E=Array.isArray(_[h])?_[h]:AC(_[h])),g&&(M=Array.isArray(g)?g:AC(g));const O=MC(E,M),Y=MC(M,E);O.length&&De(p,O),Y.length&&J(p,Y)}_[h]=g}this.init=function(){u.setData(b.data),s.runHooks("beforeInit"),(Bi()||yS())&&J(s.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new p3(this),d=_z.getInstance(s,b,B),f=new Oz(s),ed(this)&&v9(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),m&&s.rootElement.offsetParent===null&&lI(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof m=="object"&&(s.runHooks("afterChange",m[0],m[1]),m=!1),s.runHooks("afterInit")};function X(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function ie(h){const g=h.replace(",",".");return isNaN(parseFloat(g))===!1?parseFloat(g):h}function oe(h,g,p){if(!h.length)return;const E=s.getActiveEditor(),M=new X;let O=!0;M.onQueueEmpty=Y=>{E&&O&&E.cancelChanges(),p(Y)};for(let Y=h.length-1;Y>=0;Y--){const[W,q,,Z]=h[Y],K=l.propToCol(q),ce=s.getCellMeta(W,K);ce.type==="numeric"&&typeof Z=="string"&&NI(Z)&&(h[Y][3]=ie(Z)),s.getCellValidator(ce)&&(M.addValidatorToQueue(),s.validateCell(h[Y][3],ce,function(Ae,Te){return function(_e){if(typeof _e!="boolean")throw new Error("Validation error: result is not boolean");if(_e===!1&&Te.allowInvalid===!1){O=!1,h.splice(Ae,1),Te.valid=!0;const G=s.getCell(Te.visualRow,Te.visualCol);G!==null&&De(G,b.invalidCellClassName)}M.removeValidatorFormQueue()}}(Y,ce),g))}M.checkIfQueueIsEmpty()}function se(h,g){let p=h.length-1;if(p<0)return;for(;p>=0;p--){let M=!1;if(h[p]===null){h.splice(p,1);continue}if(!((h[p][2]===null||h[p][2]===void 0)&&(h[p][3]===null||h[p][3]===void 0))){if(b.allowInsertRow)for(;h[p][0]>s.countRows()-1;){const{delta:O}=l.createRow(void 0,void 0,{source:g});if(O===0){M=!0;break}}if(s.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;l.propToCol(h[p][1])>s.countCols()-1;){const{delta:O}=l.createCol(void 0,void 0,{source:g});if(O===0){M=!0;break}}M||l.set(h[p][0],h[p][1],h[p][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",h,g),d.lockEditor(),s._refreshBorders(null),d.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",h,g||"edit");const E=s.getActiveEditor();E&&ue(E.refreshValue)&&E.refreshValue()}this._createCellCoords=function(h,g){return s.view._wt.createCellCoords(h,g)},this._createCellRange=function(h,g,p){return s.view._wt.createCellRange(h,g,p)},this.validateCell=function(h,g,p,E){let M=s.getCellValidator(g);function O(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||g.hidden===!0){p(Y);return}const q=g.visualCol,Z=g.visualRow,K=s.getCell(Z,q,!0);if(K&&K.nodeName!=="TH"){const ce=s.rowIndexMapper.getRenderableFromVisualIndex(Z),Ae=s.columnIndexMapper.getRenderableFromVisualIndex(q);s.view._wt.getSetting("cellRenderer",ce,Ae,K)}p(Y)}zO(M)&&(M=function(Y){return function(W,q){q(Y.test(W))}}(M)),gt(M)?(h=s.runHooks("beforeValidate",h,g.visualRow,g.prop,E),s._registerImmediate(()=>{M.call(g,h,Y=>{s&&(Y=s.runHooks("afterValidate",Y,h,g.visualRow,g.prop,E),g.valid=Y,O(Y),s.runHooks("postAfterValidate",Y,h,g.visualRow,g.prop,E))})})):s._registerImmediate(()=>{g.valid=!0,O(g.valid,!1)})};function pe(h,g,p){return Array.isArray(h)?h:[[h,g,p]]}function Me(h,g){const p=s.getActiveEditor(),E=s.runHooks("beforeChange",h,g||"edit"),M=h.filter(O=>O!==null);return E===!1||M.length===0?(p&&p.cancelChanges(),[]):M}this.setDataAtCell=function(h,g,p,E){const M=pe(h,g,p),O=[];let Y=E,W,q,Z;for(W=0,q=M.length;W<q;W++){if(typeof M[W]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M[W][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M[W][1]>=this.countCols()?Z=M[W][1]:Z=l.colToProp(M[W][1]),O.push([M[W][0],Z,u.getAtCell(this.toPhysicalRow(M[W][0]),M[W][1]),M[W][2]])}!Y&&typeof h=="object"&&(Y=g);const K=Me(O,E);s.runHooks("afterSetDataAtCell",K,Y),oe(K,Y,()=>{se(K,Y)})},this.setDataAtRowProp=function(h,g,p,E){const M=pe(h,g,p),O=[];let Y=E,W,q;for(W=0,q=M.length;W<q;W++)O.push([M[W][0],M[W][1],u.getAtCell(this.toPhysicalRow(M[W][0]),M[W][1]),M[W][2]]);!Y&&typeof h=="object"&&(Y=g);const Z=Me(O,E);s.runHooks("afterSetDataAtRowProp",Z,Y),oe(Z,Y,()=>{se(Z,Y)})},this.listen=function(){s&&!s.isListening()&&(Pp.forEach(h=>{s!==h&&h.unlisten()}),Ip=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Ip=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return Ip===s.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(h,g)},this.populateFromArray=function(h,g,p,E,M,O,Y){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const W=typeof E=="number"?s._createCellCoords(E,M):null;return c.populateFromArray(s._createCellCoords(h,g),p,W,O,Y)},this.spliceCol=function(h,g,p){for(var E=arguments.length,M=new Array(E>3?E-3:0),O=3;O<E;O++)M[O-3]=arguments[O];return l.spliceCol(h,g,p,...M)},this.spliceRow=function(h,g,p){for(var E=arguments.length,M=new Array(E>3?E-3:0),O=3;O<E;O++)M[O-3]=arguments[O];return l.spliceRow(h,g,p,...M)},this.getSelected=function(){if(B.isSelected())return Be(B.getSelectedRange(),h=>{let{from:g,to:p}=h;return[g.row,g.col,p.row,p.col]})},this.getSelectedLast=function(){const h=this.getSelected();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.getSelectedRange=function(){if(B.isSelected())return Array.from(B.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.emptySelectedCells=function(h){if(!B.isSelected()||this.countRows()===0||this.countCols()===0)return;const g=[];T(B.getSelectedRange(),p=>{if(p.isSingleHeader())return;const E=p.getTopStartCorner(),M=p.getBottomEndCorner();me(E.row,M.row,O=>{me(E.col,M.col,Y=>{this.getCellMeta(O,Y).readOnly||g.push([O,Y,null])})})}),g.length>0&&this.setDataAtCell(g,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(h){this.suspendRender();const g=h();return this.resumeRender(),g},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const g=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(g,0),(!this.isExecutionSuspended()&&g===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=h();return this.resumeExecution(g),p},this.batch=function(h){this.suspendRender(),this.suspendExecution();const g=h();return this.resumeExecution(),this.resumeRender(),g},this.refreshDimensions=function(){if(!s.view)return;const{width:h,height:g}=s.view.getLastSize(),{width:p,height:E}=s.rootElement.getBoundingClientRect(),M=p!==h||E!==g;s.runHooks("beforeRefreshDimensions",{width:h,height:g},{width:p,height:E},M)!==!1&&((M||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(p,E),s.render()),s.runHooks("afterRefreshDimensions",{width:h,height:g},{width:p,height:E},M))},this.updateData=function(h,g){S0(h,p=>{l=p},p=>{l=p,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:g,metaManager:y,firstRun:m})},this.loadData=function(h,g){S0(h,p=>{l=p},()=>{y.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),m&&(m=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:g,metaManager:y,firstRun:m})},this.getInitialColumnCount=function(){const h=b.columns;let g=0;if(Array.isArray(h))g=h.length;else if(gt(h))if(s.dataType==="array"){const p=this.countSourceCols();for(let E=0;E<p;E+=1)h(E)&&(g+=1)}else(s.dataType==="object"||s.dataType==="function")&&(g=l.colToPropCache.length);else if(ue(b.dataSchema)){const p=l.getSchema();g=Array.isArray(p)?p.length:xf(p)}else g=this.countSourceCols();return g},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,g,p,E){return mt(h)?l.getAll():l.getRange(s._createCellCoords(h,g),s._createCellCoords(p,E),l.DESTINATION_RENDERER)},this.getCopyableText=function(h,g,p,E){return l.getCopyableText(s._createCellCoords(h,g),s._createCellCoords(p,E))},this.getCopyableData=function(h,g){return l.getCopyable(h,l.colToProp(g))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(m?s.loadData:s.updateData).bind(this);let E=!1,M,O;if(ue(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(M in h)M==="data"||(M==="language"?ee(h.language):M==="className"?j("className",h.className):M==="tableClassName"&&s.table?(j("tableClassName",h.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):de.getSingleton().isRegistered(M)||de.getSingleton().isDeprecated(M)?(gt(h[M])||Array.isArray(h[M]))&&(h[M].initialHook=!0,s.addHook(M,h[M])):!g&&At(h,M)&&(_[M]=h[M]));h.data===void 0&&b.data===void 0?p(null,"updateSettings"):h.data!==void 0?p(h.data,"updateSettings"):h.columns!==void 0&&(l.createMap(),s.initIndexMappers());const Y=s.countCols(),W=b.columns;if(W&&gt(W)&&(E=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&y.clearCache(),Y>0)for(M=0,O=0;M<Y;M++){if(W){const K=E?W(M):W[O];K&&y.updateColumnMeta(O,K)}O+=1}ue(h.cell)&&Ue(h.cell,K=>{s.setCellMetaObject(K.row,K.col,K)}),s.runHooks("afterCellMetaReset");let q=s.rootElement.style.height;q!==""&&(q=parseInt(s.rootElement.style.height,10));let Z=h.height;if(gt(Z)&&(Z=Z()),g&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),Z===null){const K=s.rootElement.getAttribute("data-initialstyle");K&&(K.indexOf("height")>-1||K.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",K):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else Z!==void 0&&(s.rootElement.style.height=isNaN(Z)?`${Z}`:`${Z}px`,s.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let K=h.width;gt(K)&&(K=K()),s.rootElement.style.width=isNaN(K)?`${K}`:`${K}px`}g||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",h)),c.adjustRowsAndCols(),s.view&&!m&&(s.forceFullRender=!0,d.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!g&&s.view&&(q===""||Z===""||Z===void 0)&&q!==Z&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=s.getSelectedLast();if(b.getValue){if(gt(b.getValue))return b.getValue.call(s);if(h)return s.getData()[h[0][0]][b.getValue]}else if(h)return s.getDataAtCell(h[0],h[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,g,p,E,M){c.alter(h,g,p,E,M)},this.getCell=function(h,g){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=g,M=h;if(g>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(g)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(g)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;M=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return M===null||E===null?null:s.view.getCellAtCoords(s._createCellCoords(M,E),p)},this.getCoords=function(h){const g=this.view._wt.wtTable.getCoords(h);if(g===null)return null;const{row:p,col:E}=g;let M=p,O=E;return p>=0&&(M=this.rowIndexMapper.getVisualFromRenderableIndex(p)),E>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(E)),s._createCellCoords(M,O)},this.colToProp=function(h){return l.colToProp(h)},this.propToCol=function(h){return l.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,g){return l.get(h,l.colToProp(g))},this.getDataAtRowProp=function(h,g){return l.get(h,g)},this.getDataAtCol=function(h){const g=[],p=l.getRange(s._createCellCoords(0,h),s._createCellCoords(b.data.length-1,h),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let M=0;M<p[E].length;M+=1)g.push(p[E][M]);return g},this.getDataAtProp=function(h){const g=[],p=l.getRange(s._createCellCoords(0,l.propToCol(h)),s._createCellCoords(b.data.length-1,l.propToCol(h)),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let M=0;M<p[E].length;M+=1)g.push(p[E][M]);return g},this.getSourceData=function(h,g,p,E){let M;return h===void 0?M=u.getData():M=u.getByRange(s._createCellCoords(h,g),s._createCellCoords(p,E)),M},this.getSourceDataArray=function(h,g,p,E){let M;return h===void 0?M=u.getData(!0):M=u.getByRange(s._createCellCoords(h,g),s._createCellCoords(p,E),!0),M},this.getSourceDataAtCol=function(h){return u.getAtColumn(h)},this.setSourceDataAtCell=function(h,g,p,E){const M=pe(h,g,p),O=this.hasHook("afterSetSourceDataAtCell"),Y=[];O&&T(M,q=>{let[Z,K,ce]=q;Y.push([Z,K,u.getAtCell(Z,K),ce])}),T(M,q=>{let[Z,K,ce]=q;u.setAtCell(Z,K,ce)}),O&&this.runHooks("afterSetSourceDataAtCell",Y,E),this.render();const W=s.getActiveEditor();W&&ue(W.refreshValue)&&W.refreshValue()},this.getSourceDataAtRow=function(h){return u.getAtRow(h)},this.getSourceDataAtCell=function(h,g){return u.getAtCell(h,g)},this.getDataAtRow=function(h){return l.getRange(s._createCellCoords(h,0),s._createCellCoords(h,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,g,p,E){const M=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,g,p,E],[O,Y]=M;let[,,W,q]=M,Z=null,K=null;W===void 0&&(W=O),q===void 0&&(q=Y);let ce="mixed";return me(Math.max(Math.min(O,W),0),Math.max(O,W),Ae=>{let Te=!0;return me(Math.max(Math.min(Y,q),0),Math.max(Y,q),_e=>(K=this.getCellMeta(Ae,_e).type,Z?Te=Z===K:Z=K,Te)),ce=Te?K:"mixed",Te}),ce},this.removeCellMeta=function(h,g,p){const[E,M]=[this.toPhysicalRow(h),this.toPhysicalColumn(g)];let O=y.getCellMetaKeyValue(E,M,p);s.runHooks("beforeRemoveCellMeta",h,g,p,O)!==!1&&(y.removeCellMeta(E,M,p),s.runHooks("afterRemoveCellMeta",h,g,p,O)),O=null},this.spliceCellsMeta=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,E=new Array(p>2?p-2:0),M=2;M<p;M++)E[M-2]=arguments[M];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&y.removeRow(this.toPhysicalRow(h),g),E.length>0&&T(E.reverse(),O=>{y.createRow(this.toPhysicalRow(h)),T(O,(Y,W)=>this.setCellMetaObject(h,W,Y))}),s.render()},this.setCellMetaObject=function(h,g,p){typeof p=="object"&&Ue(p,(E,M)=>{this.setCellMeta(h,g,M,E)})},this.setCellMeta=function(h,g,p,E){if(s.runHooks("beforeSetCellMeta",h,g,p,E)===!1)return;let O=h,Y=g;h<this.countRows()&&(O=this.toPhysicalRow(h)),g<this.countCols()&&(Y=this.toPhysicalColumn(g)),y.setCellMeta(O,Y,p,E),s.runHooks("afterSetCellMeta",h,g,p,E)},this.getCellsMeta=function(){return y.getCellsMeta()},this.getCellMeta=function(h,g){let p=this.toPhysicalRow(h),E=this.toPhysicalColumn(g);return p===null&&(p=h),E===null&&(E=g),y.getCellMeta(p,E,{visualRow:h,visualColumn:g})},this.getCellMetaAtRow=function(h){return y.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||b.columns)},this.getCellRenderer=function(h,g){const p=typeof h=="number"?s.getCellMeta(h,g).renderer:h.renderer;return typeof p=="string"?Nd(p):mt(p)?Nd("text"):p},this.getCellEditor=function(h,g){const p=typeof h=="number"?s.getCellMeta(h,g).editor:h.editor;return typeof p=="string"?Hd(p):mt(p)?Hd("text"):p},this.getCellValidator=function(h,g){const p=typeof h=="number"?s.getCellMeta(h,g).validator:h.validator;return typeof p=="string"?MS(p):p},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,g){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(g,h)},this.validateColumns=function(h,g){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(g,void 0,h)},this._validateCells=function(h,g,p){const E=new X;h&&(E.onQueueEmpty=h);let M=s.countRows()-1;for(;M>=0;){if(g!==void 0&&g.indexOf(M)===-1){M-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(p!==void 0&&p.indexOf(O)===-1){O-=1;continue}E.addValidatorToQueue(),s.validateCell(s.getDataAtCell(M,O),s.getCellMeta(M,O),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),O-=1}M-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let g=b.rowHeaders,p=h;return p!==void 0&&(p=s.runHooks("modifyRowHeader",p)),p===void 0?(g=[],me(s.countRows()-1,E=>{g.push(s.getRowHeader(E))})):Array.isArray(g)&&g[p]!==void 0?g=g[p]:gt(g)?g=g(p):g&&typeof g!="string"&&typeof g!="number"&&(g=p+1),g},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let h=0,g=s.countCols();h<g;h++)if(s.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=s.runHooks("modifyColHeader",h);if(p===void 0){const W=[],q=s.countCols();for(let Z=0;Z<q;Z++)W.push(s.getColHeader(Z));return W}let E=b.colHeaders;const M=function(W){const q=[],Z=s.countCols();let K=0;for(;K<Z;K++)gt(b.columns)&&b.columns(K)&&q.push(K);return q[W]},O=s.toPhysicalColumn(p),Y=M(O);return b.colHeaders===!1?E=null:b.columns&&gt(b.columns)&&b.columns(Y)&&b.columns(Y).title?E=b.columns(Y).title:b.columns&&b.columns[O]&&b.columns[O].title?E=b.columns[O].title:Array.isArray(b.colHeaders)&&b.colHeaders[O]!==void 0?E=b.colHeaders[O]:gt(b.colHeaders)?E=b.colHeaders(O):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(E=$f(p)),E=s.runHooks("modifyColumnHeaderValue",E,h,g),E},this._getColWidthFromSettings=function(h){let g;if(h>=0&&(g=s.getCellMeta(0,h).width),(g===void 0||g===b.width)&&(g=b.colWidths),g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getColWidth=function(h){let g=s._getColWidthFromSettings(h);return g=s.runHooks("modifyColWidth",g,h),g===void 0&&(g=OS.DEFAULT_WIDTH),g},this._getRowHeightFromSettings=function(h){let g=b.rowHeights;if(g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getRowHeight=function(h){let g=s._getRowHeightFromSettings(h);return g=s.runHooks("modifyRowHeight",g,h),g},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const h=b.maxCols,g=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,g)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return Dd(s.countRows()-1,p=>{if(s.isEmptyRow(p))g+=1;else if(h===!0)return!1}),g},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return Dd(s.countCols()-1,p=>{if(s.isEmptyCol(p))g+=1;else if(h===!0)return!1}),g},this.isEmptyRow=function(h){return b.isEmptyRow.call(s,h)},this.isEmptyCol=function(h){return b.isEmptyCol.call(s,h)},this.selectCell=function(h,g,p,E){let M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mt(h)||mt(g)?!1:this.selectCells([[h,g,p,E]],M,O)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g===!1&&(o=!0);const E=B.selectCells(h);return E&&p&&s.listen(),o=!1,E},this.selectColumns=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,p=arguments.length>2?arguments[2]:void 0;return B.selectColumns(h,g,p)},this.selectRows=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,p=arguments.length>2?arguments[2]:void 0;return B.selectRows(h,g,p)},this.deselectCell=function(){B.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,p=arguments.length>2?arguments[2]:void 0;o=!0,B.selectAll(h,g,p),o=!1};const Je=(h,g)=>h.getNearestNotHiddenIndex(g,1,!0);this.scrollViewportTo=function(){let{row:h,col:g,verticalSnap:p,horizontalSnap:E,considerHiddenIndexes:M}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},O,Y,W,q;p!==void 0&&(O=p==="top",Y=!O),E!==void 0&&(W=E==="start",q=!W);let Z=h,K=g;if(M===void 0||M){const Te=Number.isInteger(h)&&h>=0,_e=Number.isInteger(g)&&g>=0,G=Te?Je(this.rowIndexMapper,h):void 0,Ge=_e?Je(this.columnIndexMapper,g):void 0;if(G===null||Ge===null)return!1;Z=Te?s.rowIndexMapper.getRenderableFromVisualIndex(G):h,K=_e?s.columnIndexMapper.getRenderableFromVisualIndex(Ge):g}const ce=Number.isInteger(Z),Ae=Number.isInteger(K);return ce&&Z>=0&&Ae&&K>=0?s.view.scrollViewport(s._createCellCoords(Z,K),O,q,Y,W):ce&&Z>=0&&(Ae&&K<0||!Ae)?s.view.scrollViewportVertically(Z,O,Y):Ae&&K>=0&&(ce&&Z<0||!ce)?s.view.scrollViewportHorizontally(K,q,W):!1},this.scrollToFocusedCell=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",h);const{highlight:g}=this.getSelectedRangeLast();this.scrollViewportTo(g.toObject())?this.view.render():(this.removeHook("afterScroll",h),this._registerImmediate(()=>h()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),y.clearCache(),Pp.delete(this.guid),ed(s)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}Vr(s.rootElement),a.destroy(),d&&d.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),I.getItems().forEach(h=>{let[,g]=h;g.destroy()}),I.clear(),s.runHooks("afterDestroy")},!0),de.getSingleton().destroy(s),Ue(s,(h,g,p)=>{gt(h)?p[g]=Pe(g):g!=="guid"&&(p[g]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,B=null,d=null,s=null};function Pe(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(h){const g=bn(h);return g==="UndoRedo"?this.undoRedo:I.getItem(g)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:I.getId(h)},this.getInstance=function(){return s},this.addHook=function(h,g){de.getSingleton().add(h,g,s)},this.hasHook=function(h){return de.getSingleton().has(h,s)||de.getSingleton().has(h)},this.addHookOnce=function(h,g){de.getSingleton().once(h,g,s)},this.removeHook=function(h,g){de.getSingleton().remove(h,g,s)},this.runHooks=function(h,g,p,E,M,O,Y){return de.getSingleton().run(s,h,g,p,E,M,O,Y)},this.getTranslatedPhrase=function(h,g){return PP(b.language,h,g)},this.toHTML=()=>kC(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",kC(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=h;typeof p=="function"&&(p=setTimeout(p,g)),this.timeouts.push(p)},this._clearTimeouts=function(){T(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){T(this.immediates,h=>{clearImmediate(h)})},this._refreshBorders=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(h),s.view.render(),g&&B.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const R=T9({handleEvent(){return s.isListening()},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},_S().forEach(h=>{const g=oc(h);I.addItem(h,new g(this))}),w9(s),R.setActiveContextName("grid"),de.getSingleton().run(s,"construct")}const _9="hooksRefRegisterer",qP={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){T(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ue(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};pi(qP,"MIXIN_NAME",_9,{writable:!1,enumerable:!1});const M9=qP;function _r(t,e,n){return e=A9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A9(t){var e=O9(t,"string");return typeof e=="symbol"?e:String(e)}function O9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const I9="base",Kt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),QC="baseEditor";class hl{static get EDITOR_TYPE(){return I9}constructor(e){_r(this,"hot",void 0),_r(this,"state",Kt.VIRGIN),_r(this,"_opened",!1),_r(this,"_fullEditMode",!1),_r(this,"_closeCallback",null),_r(this,"TD",null),_r(this,"row",null),_r(this,"col",null),_r(this,"prop",null),_r(this,"originalValue",null),_r(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=Kt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const d=this.hot.getSelectedLast();r=Math.max(Math.min(d[0],d[2]),0),i=Math.max(Math.min(d[1],d[3]),0),o=Math.max(d[0],d[2]),s=Math.max(d[1],d[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>ue(this.hot.getSelected()),group:QC};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Kt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=Kt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Nt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(QC),s.removeShortcutsByGroup(Df),this.state===Kt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Kt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=Kt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Kt.FINISHED,this.discardEditor(l)}):(this.state=Kt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Kt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Kt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Kt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Kt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Kt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Bt(n),a=ut(n),l=Bt(this.hot.rootElement),u=ut(this.hot.rootElement),c=r.topOverlay.holder,d=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,m=d!==o?d.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,y=v.name,b=["master","inline_start"].includes(y)?f:0,_=["master","top","bottom"].includes(y)?m:0,I=s.top===l.top?0:1;let L=s.top-l.top-I-b,x=0;this.hot.isRtl()?x=o.innerWidth-s.left-a-w-1+_:x=s.left-l.left-1-_,["top","top_inline_start_corner"].includes(y)&&(L+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(y)&&(x+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const B=this.hot.hasColHeaders(),z=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ee=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),X=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(B&&z<=0||z===X)&&(L+=1),ee<=0&&(x+=1);const ie=i.rowsRenderCalculator.startPosition,oe=i.columnsRenderCalculator.startPosition,se=Math.abs(r.inlineStartOverlay.getScrollPosition()),pe=r.topOverlay.getScrollPosition(),Me=Jt(this.hot.rootDocument);let Je=n.offsetTop;if(["inline_start","master"].includes(y)&&(Je+=ie-pe),["bottom","bottom_inline_start_corner"].includes(y)){const{wtViewport:Z,wtTable:K}=r.bottomOverlay.clone;Je+=Z.getWorkspaceHeight()-K.getHeight()-Me}let Pe=n.offsetLeft;this.hot.isRtl()?(Pe>=0?Pe=v.getWidth()-n.offsetLeft:Pe=Math.abs(Pe),Pe+=oe-se-a):["top","master","bottom"].includes(y)&&(Pe+=oe-se);const R=qi(this.TD,this.hot.rootWindow),h=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",g=parseInt(R[h],10)>0?0:1,p=parseInt(R.borderTopWidth,10)>0?0:1,E=ut(n)+g,M=Ot(n)+p,O=sI(c)?Me:0,Y=aI(d)?Me:0,W=this.hot.view.maximumVisibleElementWidth(Pe)-O+g,q=Math.max(this.hot.view.maximumVisibleElementHeight(Je)-Y+p,23);return{top:L,start:x,height:M,maxHeight:q,width:E,maxWidth:W}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}dt(hl,M9);function P9(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,n=document.body,r=document.createTextNode(""),i=document.createElement("SPAN"),o=function(f,m,w){f.addEventListener(m,w,!1)},s=function(f,m,w){f.removeEventListener(m,w,!1)},a=function(f){var m,w;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",r.textContent!==void 0?r.textContent=e.value+f:r.data=e.value+f,i.style.position="absolute",i.style.fontSize=d(e).fontSize,i.style.fontFamily=d(e).fontFamily,i.style.whiteSpace="pre",n.appendChild(i),m=i.clientWidth+2,n.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>m?e.style.width=t.minWidth+"px":m>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=m+"px",w=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>w?e.style.height=t.minHeight+"px":t.maxHeight<w?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=w+"px"},l=function(){window.setTimeout(a,0)},u=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")t.minHeight=e.clientHeight;else{var m=parseInt(f.minHeight);isNaN(m)||(t.minHeight=m)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var w=parseInt(f.maxHeight);isNaN(w)||(t.maxHeight=w)}if(f&&f.minWidth)if(f.minWidth=="inherit")t.minWidth=e.clientWidth;else{var v=parseInt(f.minWidth);isNaN(v)||(t.minWidth=v)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var y=parseInt(f.maxWidth);isNaN(y)||(t.maxWidth=y)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))},c=function(f,m,w){e=f,u(m),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),w&&(o(e,"change",a),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",a),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)),a()};function d(f){return f.currentStyle||document.defaultView.getComputedStyle(f)}return{init:function(f,m,w){c(f,m,w)},unObserve:function(){s(e,"change",a),s(e,"cut",l),s(e,"paste",l),s(e,"drop",l),s(e,"keydown",l),s(e,"focus",a),s(e,"compositionstart",l),s(e,"compositionupdate",l),s(e,"compositionend",l)},resize:a}}function M0(t,e){const n=dS(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}tc(e,i)}function ns(t,e,n){return e=x9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x9(t){var e=H9(t,"string");return typeof e=="symbol"?e:String(e)}function H9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const D9="ht_editor_visible",eh="ht_editor_hidden",A0="textEditor",N9="text";class qs extends hl{static get EDITOR_TYPE(){return N9}constructor(e){super(e),ns(this,"eventManager",new or(this)),ns(this,"autoResize",P9()),ns(this,"TEXTAREA",void 0),ns(this,"textareaStyle",void 0),ns(this,"TEXTAREA_PARENT",void 0),ns(this,"textareaParentStyle",void 0),ns(this,"layerClass",void 0),this.eventManager=new or(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",n=>this.onAfterDocumentKeyDown(n)),this.registerShortcuts()}close(){this.autoResize.unObserve(),JO(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==Kt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===Kt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),tc(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ve(this.TEXTAREA,[["data-hot-input",""],sl(-1)]),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[no()]),J(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),J(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ie(this.TEXTAREA_PARENT,this.layerClass)&&De(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,eh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){yI()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",De(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,eh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;me(e.length-1,r=>{const i=e[r];if(Ie(i,"handsontableEditor"))return n=!0,!1}),Ie(this.TEXTAREA_PARENT,eh)&&De(this.TEXTAREA_PARENT,eh),n?(this.layerClass=D9,J(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),J(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Kt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=qi(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=qi(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,m=s-d,w=o-c,v=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,w),minHeight:Math.min(m,v),maxWidth:w,maxHeight:v},!0)}bindEvents(){SS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Kt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Kt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>ue(this.hot.getSelected()),group:A0},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"]],callback:o=>{const s=this.hot.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(o):s.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:o=>{const s=this.hot.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(o):s.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;M0(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;M0(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],r)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Df),n.removeShortcutsByGroup(A0),n.removeShortcutsByGroup(QC)}onAfterDocumentKeyDown(e){[fe.ARROW_UP,fe.ARROW_RIGHT,fe.ARROW_DOWN,fe.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const L9="base";function dc(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],d=[];s.className&&J(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(fR())):a&&c.push(fR()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(gR())):(u.push(s.invalidCellClassName),a&&c.push(gR()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),De(e,u),J(e,l),Yo(e,c),ve(e,d)}dc.RENDERER_TYPE=L9;const $9="text";function so(t,e,n,r,i,o,s){dc.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Nt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){Vr(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else ko(e,a)}so.RENDERER_TYPE=$9;const k9="text",ZP={CELL_TYPE:k9,editor:qs,renderer:so};Cn(ZP);Ee.editors={BaseEditor:hl};function Ee(t,e){const n=new XP(t,e||{},KS);return n.init(),n}Ee.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new XP(t,e,KS)};Ee.DefaultSettings=BP();Ee.hooks=de.getSingleton();Ee.CellCoords=$d;Ee.CellRange=xS;Ee.packageName="handsontable";Ee.buildDate="08/11/2023 09:43:05";Ee.version="14.0.0-next-b24d538-20231108";Ee.languages={dictionaryKeys:o4,getLanguageDictionary:IP,getLanguagesDictionaries:c4,registerLanguageDictionary:Sy,getTranslatedPhrase:PP};const F9=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],O0="odd",QP=()=>["Ø¹ÙØ±","Ø¹ÙÙ","Ø¹Ø¨Ø¯ Ø§ÙÙÙ","ÙØ¹ØªØµÙ"][Math.floor(Math.random()*3)],JP=()=>["ØªØ±ÙÙØ§","ÙØµØ±","ÙØ¨ÙØ§Ù","Ø§ÙØ¹Ø±Ø§Ù"][Math.floor(Math.random()*3)],W9=()=>new Date(Math.floor(Math.random()*Date.now())).toLocaleDateString("en-gb"),I0=()=>Math.random()>.5,pu=(t=0,e=1e3)=>t+Math.floor(Math.random()*e),V9=()=>`${JP()} ${QP()} ${pu()}`,B9=()=>`${pu(1e5,999999).toString().match(/.{1,3}/g).join("-")}`;function U9(){return Array.from({length:50},()=>[I0(),QP(),JP(),V9(),W9(),B9(),I0(),pu(0,200).toString(),pu(1,10),pu(1,5)])}function rd(){return new URLSearchParams(location.search.replace(/^\?/,"")).get("arabicExample")==="1"}function Y9(){return rd()?U9():F9}/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Feb 9, 2022
 *
 * Description: Definition file for Arabic - Without a specific country.
 */const z9={languageCode:"ar-AR",languageDirection:"rtl",[Wf]:"ÙØ§ ØªÙØ¬Ø¯ Ø®ÙØ§Ø±Ø§Øª ÙØªÙÙØ±Ø©",[Vf]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø¹ÙÙ",[Bf]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø³ÙÙ",[Uf]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙØ³Ø§Ø±",[Yf]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙÙÙÙ",[zf]:["Ø§Ø­Ø¯Ù Ø§ÙØµÙ","Ø§Ø­Ø°Ù Ø§ÙØµÙÙÙ"],[Gf]:["Ø§Ø­Ø¯Ù Ø§ÙØ¹ÙÙØ¯","Ø§Ø­Ø¯Ù Ø§ÙØ£Ø¹ÙØ¯Ø©"],[jf]:"ØªØ±Ø§Ø¬Ø¹",[Kf]:"Ø¥ÙØºØ§Ø¡ Ø§ÙØªØ±Ø§Ø¬Ø¹",[Xf]:"ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[qf]:"Ø§ÙØ±Øº Ø§ÙØ¹ÙÙØ¯",[ag]:"Ø§ÙÙØ­Ø§Ø°Ø§Ø©",[lg]:"ÙØ³Ø§Ø±",[ug]:"ÙØ³Ø·",[cg]:"ÙÙÙÙ",[hg]:"Ø¨Ø§ÙØªØ³Ø§ÙÙ",[dg]:"Ø£Ø¹ÙÙ",[fg]:"ÙØªÙØ³Ø·",[gg]:"Ø£Ø³ÙÙ",[Jf]:"ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[eg]:"Ø¥ÙØºØ§Ø¡ ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[mg]:"Ø§ÙØ­Ø¯ÙØ¯",[pg]:"Ø£Ø¹ÙÙ",[wg]:"ÙÙÙÙ",[Cg]:"Ø£Ø³ÙÙ",[vg]:"ÙØ³Ø§Ø±",[Sg]:"Ø£Ø­Ø°Ù Ø§ÙØ­Ø¯(ÙØ¯)",[rg]:"Ø£Ø¶Ù ØªØ¹ÙÙÙØ§Ù",[ig]:"ØªØ¹Ø¯ÙÙ Ø§ÙØªØ¹ÙÙÙ",[og]:"Ø§Ø­Ø°Ù Ø§ÙØªØ¹ÙÙÙ",[sg]:"ØªØ¹ÙÙÙ ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[tg]:"Ø§Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[ng]:"Ø¥ÙØºØ§Ø¡ Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[Zf]:"ÙØ³Ø®",[Qf]:"ÙØµ",[yg]:"Ø£Ø¯Ø®Ù ØµÙØ§Ù ÙØ±Ø¹ÙØ§Ù",[bg]:"Ø§ÙØµÙ Ø¹Ù Ø§ÙØµÙ Ø§ÙØ£ØµÙÙ",[Rg]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ¹ÙÙØ¯","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Eg]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ¹ÙÙØ¯","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Tg]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·Ø±","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·ÙØ±"],[_g]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·Ø±","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·ÙØ±"],[uc]:"Ø¨ÙØ§",[Mg]:"ÙØ§Ø±Øº",[Ag]:"ØºÙØ± ÙØ§Ø±Øº",[Og]:"ÙØ³Ø§ÙÙ",[Ig]:"ÙØ§ ÙØ³Ø§ÙÙ",[Pg]:"ÙØ¨Ø¯Ø§Ù Ø¨Ù",[xg]:"ÙÙØªÙÙ Ø¨Ù",[Hg]:"ÙØ­ØªÙÙ",[Dg]:"ÙØ§ ÙØ­ØªÙÙ",[Ng]:"Ø£ÙØ¨Ø± ÙÙ",[Lg]:"Ø£ÙØ¨Ø± Ø£Ù ÙØ³Ø§ÙÙ",[$g]:"Ø£ØµØºØ±",[kg]:"Ø£ØµØºØ± Ø£Ù ÙØ³Ø§ÙÙ",[Fg]:"Ø¨ÙÙ",[Wg]:"Ø®Ø§Ø±Ø¬ Ø§ÙÙØ¬Ø§Ù",[Vg]:"Ø¨Ø¹Ø¯",[Bg]:"ÙØ¨Ù",[Ug]:"Ø§ÙÙÙÙ",[Yg]:"ØºØ¯Ø§Ù",[zg]:"Ø§ÙØ¨Ø§Ø±Ø­Ø©",[ku]:"Ø®ÙØ§ÙØ§ ÙØ§Ø±ØºØ©",[Gg]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙØ´Ø±Ø·",[jg]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙÙÙÙØ©",[Kg]:"Ù",[cc]:"Ø£Ù",[Xg]:"Ø§Ø®ØªÙØ§Ø± Ø§ÙÙÙ",[qg]:"Ø¥ÙØºØ§Ø¡",[Zg]:"ÙÙØ§ÙÙ",[Qg]:"Ø¥ÙØºØ§Ø¡",[Jg]:"Ø§ÙØ¨Ø­Ø«",[em]:"Ø§ÙÙÙÙØ©",[tm]:"Ø§ÙÙÙÙØ© Ø§ÙØ«Ø§ÙÙØ©"},ex=z9,P0="handsontableEditor",G9="handsontable";class Ty extends qs{static get EDITOR_TYPE(){return G9}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),tc(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions(),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("true")])}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("false")])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const d=this.getSourceData(c.row,c.col);d!==void 0&&a.setValue(d),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ut(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:P0,relativeToGroup:Df,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Sr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(P0)}}function j9(t,e,n){K9(t,e),e.set(t,n)}function K9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function th(t,e,n){return e=X9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X9(t){var e=q9(t,"string");return typeof e=="symbol"?e:String(e)}function q9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function x0(t,e){var n=Z9(t,e,"get");return Q9(t,n)}function Z9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Q9(t,e){return e.get?e.get.call(t):e.value}const J9="autocomplete";var xp=new WeakMap;class _y extends Ty{constructor(){super(...arguments),th(this,"query",null),th(this,"strippedChoices",[]),th(this,"rawChoices",[]),j9(this,xp,{writable:!0,value:this.hot.guid.slice(0,9)}),th(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,d;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=IC(Nt(n[c])),r)d=u.indexOf(e);else{const f=this.cellProperties.locale;d=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}d!==-1&&(l=u.length-d-s,i.push({baseIndex:c,index:d,charsLeft:l,value:u}))}for(i.sort((f,m)=>{if(m.index===-1)return-1;if(f.index===-1)return 1;if(f.index<m.index)return-1;if(m.index<f.index)return 1;if(f.index===m.index){if(f.charsLeft<m.charsLeft)return-1;if(f.charsLeft>m.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return J9}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),J(this.htContainer,"autocompleteEditor"),J(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[dY(),aY(),al("listbox"),wY()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[sn("false"),CY(`${x0(this,xp)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=Jt();a===0&&Nu()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[ut(this.TEXTAREA)-2]:void 0,width:e?ut(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,d,f,m,w)=>{so(l,u,c,d,f,m,w);const{filteringCaseSensitive:v,allowHtml:y,locale:b}=this.cellProperties,_=this.query;let I=Nt(m),L,x;I&&!y&&(L=v===!0?I.indexOf(_):I.toLocaleLowerCase(b).indexOf(_.toLocaleLowerCase(b)),L!==-1&&(x=I.substr(L,_.length),I=I.replace(x,`<strong>${x}</strong>`))),n&&ve(u,[lY(),...r?[bY(i)]:[],...r?[RY(r.indexOf(m)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${d}`]]),u.innerHTML=I},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);ve(c,[PC()]),ve(this.TEXTAREA,...vY(c.id))}}}),n&&(ve(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Lr()),ve(this.htEditor.rootElement,[KO(),SY("polite"),yY("text"),["id",`${x0(this,xp)}-listbox-${o}-${s}`]]),ve(this.TEXTAREA,...sn("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[sn("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=dS(this.TEXTAREA),r=oI(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let d=0,f=l.length;d<f&&!(i&&u<=d);d++)u?c.push(l[s[d]]):c.push(l[d]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(hu([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),tc(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=$s(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=Bt(this.TEXTAREA),o=Ot(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Ot(this.hot.view._wt.wtTable.THEAD),u=Bt(e),c=i.top-u.top-l+a,d=e.scrollHeight-c-l-o,f=s>d&&c>d;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:d,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Be(e,o=>Nt(o));return Be(r,o=>n?o:IC(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===fe.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===fe.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(bI(e.keyCode)||e.keyCode===fe.BACKSPACE||e.keyCode===fe.DELETE||e.keyCode===fe.INSERT){let n=10;if(e.keyCode===fe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const e5="html";function My(t,e,n,r,i,o,s){dc.apply(this,[t,e,n,r,i,o,s]),Ks(e,o??"",!1)}My.RENDERER_TYPE=e5;const t5="autocomplete";function dl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?My:so,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...no()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),J(e,"htAutocomplete"),c&&e.setAttribute(...al("listbox")),!t.acArrowListener){const d=new or(t);t.acArrowListener=function(f){Ie(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{d.destroy()})}}dl.RENDERER_TYPE=t5;const n5="autocomplete";function om(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,H0(n,e)):H0(n,e)(this.source):e(!0)}om.VALIDATOR_TYPE=n5;function H0(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}const r5="autocomplete",i5={CELL_TYPE:r5,editor:_y,renderer:dl,validator:om},o5="checkbox";class tx extends hl{static get EDITOR_TYPE(){return o5}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Ie(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const D0=new WeakMap,N0=new WeakMap,s5="htBadValue",tl="data-row",nl="data-col",a5="checkboxRenderer",nx="checkbox";de.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===nx){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const d=this.getDataAtRowProp(o,u);c=d!==null?d:n}t=c}return t}});function Ay(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;dc.apply(this,[t,e,n,r,i,o,s]),l5(t);let u=u5(a);const c=s.label;let d=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Vr(e),o===s.checkedTemplate||Nt(o).toLocaleLowerCase(s.locale)===Nt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Nt(o).toLocaleLowerCase(s.locale)===Nt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Xt(o)?J(u,"noValue"):(u.style.display="none",J(u,s5),d=!0),ve(u,[[tl,n],[nl,r]]),l&&ve(u,[Lo(u.checked?t.getTranslatedPhrase(ay):t.getTranslatedPhrase(ly)),pY(u.checked),uY()]),!d&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const b=t.getDataAtRowProp(n,c.property);v=b!==null?b:""}const y=c5(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(y),e.appendChild(u)):(y.appendChild(u),u=y):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(y)):(y.insertBefore(u,y.firstChild),u=y))}(!c||c&&!c.separated)&&e.appendChild(u),d&&e.appendChild(a.createTextNode("#bad-value#")),D0.has(t)||(D0.set(t,!0),f());function f(){const y=t.getShortcutManager().getContext("grid"),b={group:a5};y.addShortcuts([{keys:[["space"]],callback:()=>(m(),!w())},{keys:[["enter"]],callback:()=>(m(),!w()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(m(!0),!w()),relativeToGroup:Ey,position:"before"}],b)}function m(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const y=t.getSelectedRange();if(y)for(let b=0;b<y.length;b++){const{row:_,col:I}=y[b].getTopStartCorner(),{row:L,col:x}=y[b].getBottomEndCorner(),B=[];for(let z=_;z<=L;z+=1)for(let ee=I;ee<=x;ee+=1){const j=t.getCellMeta(z,ee);if(j.type!=="checkbox")return;if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const X=t.getDataAtCell(z,ee);v===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(X)?B.push([z,ee,j.uncheckedTemplate]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(X)&&B.push([z,ee,j.checkedTemplate]):B.push([z,ee,j.uncheckedTemplate])}B.length>0&&t.setDataAtCell(B)}}function w(){const v=t.getSelectedRange();if(v){for(let y=0;y<v.length;y++){const b=v[y].getTopStartCorner(),_=v[y].getBottomEndCorner();for(let I=b.row;I<=_.row;I++)for(let L=b.col;L<=_.col;L++){const x=t.getCellMeta(I,L);if(x.type!=="checkbox")return!1;const B=t.getCell(I,L);if(B==null)return!0;if(B.querySelectorAll("input[type=checkbox]").length>0&&!x.readOnly)return!0}}return!1}}}Ay.RENDERER_TYPE=nx;function l5(t){let e=N0.get(t);if(!e){const{rootElement:n}=t;e=new or(t),e.addEventListener(n,"click",r=>d5(r,t)),e.addEventListener(n,"mouseup",r=>h5(r,t)),e.addEventListener(n,"change",r=>f5(r,t)),N0.set(t,e)}return e}function u5(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function c5(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function h5(t,e){const{target:n}=t;Oy(n)&&(!n.hasAttribute(tl)||!n.hasAttribute(nl)||setTimeout(e.listen,10))}function d5(t,e){const{target:n}=t;if(!Oy(n)||!n.hasAttribute(tl)||!n.hasAttribute(nl))return;const r=parseInt(n.getAttribute(tl),10),i=parseInt(n.getAttribute(nl),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function f5(t,e){const{target:n}=t;if(!Oy(n)||!n.hasAttribute(tl)||!n.hasAttribute(nl))return;const r=parseInt(n.getAttribute(tl),10),i=parseInt(n.getAttribute(nl),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Oy(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const g5="checkbox",rx={CELL_TYPE:g5,editor:tx,renderer:Ay};var ix={exports:{}};const m5=BD(BU);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=m5}catch{}t.exports=r(i)}})(Bh,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(R,h,g,p){i?R.addEventListener(h,g,!!p):R.attachEvent("on"+h,g)},l=function(R,h,g,p){i?R.removeEventListener(h,g,!!p):R.detachEvent("on"+h,g)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,h){return(" "+R.className+" ").indexOf(" "+h+" ")!==-1},d=function(R,h){c(R,h)||(R.className=R.className===""?h:R.className+" "+h)},f=function(R,h){R.className=u((" "+R.className+" ").replace(" "+h+" "," "))},m=function(R){return/Array/.test(Object.prototype.toString.call(R))},w=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},v=function(R){var h=R.getDay();return h===0||h===6},y=function(R){return R%4===0&&R%100!==0||R%400===0},b=function(R,h){return[31,y(R)?29:28,31,30,31,30,31,31,30,31,30,31][h]},_=function(R){w(R)&&R.setHours(0,0,0,0)},I=function(R,h){return R.getTime()===h.getTime()},L=function(R,h,g){var p,E;for(p in h)E=R[p]!==void 0,E&&typeof h[p]=="object"&&h[p]!==null&&h[p].nodeName===void 0?w(h[p])?g&&(R[p]=new Date(h[p].getTime())):m(h[p])?g&&(R[p]=h[p].slice(0)):R[p]=L({},h[p],g):(g||!E)&&(R[p]=h[p]);return R},x=function(R,h,g){var p;o.createEvent?(p=o.createEvent("HTMLEvents"),p.initEvent(h,!0,!1),p=L(p,g),R.dispatchEvent(p)):o.createEventObject&&(p=o.createEventObject(),p=L(p,g),R.fireEvent("on"+h,p))},B=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},z={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ee=function(R,h,g){for(h+=R.firstDay;h>=7;)h-=7;return g?R.i18n.weekdaysShort[h]:R.i18n.weekdays[h]},j=function(R){var h=[],g="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)h.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||h.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&h.push("is-disabled"),R.isToday&&h.push("is-today"),R.isSelected&&(h.push("is-selected"),g="true"),R.hasEvent&&h.push("has-event"),R.isInRange&&h.push("is-inrange"),R.isStartRange&&h.push("is-startrange"),R.isEndRange&&h.push("is-endrange"),'<td data-day="'+R.day+'" class="'+h.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},X=function(R,h){R.setHours(0,0,0,0);var g=R.getDate(),p=R.getDay(),E=h,M=E-1,O=7,Y=function(ce){return(ce+O-1)%O};R.setDate(g+M-Y(p));var W=new Date(R.getFullYear(),0,E),q=24*60*60*1e3,Z=(R.getTime()-W.getTime())/q,K=1+Math.round((Z-M+Y(W.getDay()))/O);return K},ie=function(R,h,g,p){var E=new Date(g,h,R),M=r?n(E).isoWeek():X(E,p);return'<td class="pika-week">'+M+"</td>"},oe=function(R,h,g,p){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(h?R.reverse():R).join("")+"</tr>"},se=function(R){return"<tbody>"+R.join("")+"</tbody>"},pe=function(R){var h,g=[];for(R.showWeekNumber&&g.push("<th></th>"),h=0;h<7;h++)g.push('<th scope="col"><abbr title="'+ee(R,h)+'">'+ee(R,h,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?g.reverse():g).join("")+"</tr></thead>"},Me=function(R,h,g,p,E,M){var O,Y,W,q=R._o,Z=g===q.minYear,K=g===q.maxYear,ce='<div id="'+M+'" class="pika-title" role="heading" aria-live="assertive">',Ae,Te,_e=!0,G=!0;for(W=[],O=0;O<12;O++)W.push('<option value="'+(g===E?O-h:12+O-h)+'"'+(O===p?' selected="selected"':"")+(Z&&O<q.minMonth||K&&O>q.maxMonth?' disabled="disabled"':"")+">"+q.i18n.months[O]+"</option>");for(Ae='<div class="pika-label">'+q.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+W.join("")+"</select></div>",m(q.yearRange)?(O=q.yearRange[0],Y=q.yearRange[1]+1):(O=g-q.yearRange,Y=1+g+q.yearRange),W=[];O<Y&&O<=q.maxYear;O++)O>=q.minYear&&W.push('<option value="'+O+'"'+(O===g?' selected="selected"':"")+">"+O+"</option>");return Te='<div class="pika-label">'+g+q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+W.join("")+"</select></div>",q.showMonthAfterYear?ce+=Te+Ae:ce+=Ae+Te,Z&&(p===0||q.minMonth>=p)&&(_e=!1),K&&(p===11||q.maxMonth<=p)&&(G=!1),h===0&&(ce+='<button class="pika-prev'+(_e?"":" is-disabled")+'" type="button">'+q.i18n.previousMonth+"</button>"),h===R._o.numberOfMonths-1&&(ce+='<button class="pika-next'+(G?"":" is-disabled")+'" type="button">'+q.i18n.nextMonth+"</button>"),ce+="</div>"},Je=function(R,h,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+pe(R)+se(h)+"</table>"},Pe=function(R){var h=this,g=h.config(R);h._onMouseDown=function(E){if(h._v){E=E||window.event;var M=E.target||E.srcElement;if(M)if(c(M,"is-disabled")||(c(M,"pika-button")&&!c(M,"is-empty")&&!c(M.parentNode,"is-disabled")?(h.setDate(new Date(M.getAttribute("data-pika-year"),M.getAttribute("data-pika-month"),M.getAttribute("data-pika-day"))),g.bound&&s(function(){h.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):c(M,"pika-prev")?h.prevMonth():c(M,"pika-next")&&h.nextMonth()),c(M,"pika-select"))h._c=!0;else if(E.preventDefault)E.preventDefault();else return E.returnValue=!1,!1}},h._onChange=function(E){E=E||window.event;var M=E.target||E.srcElement;M&&(c(M,"pika-select-month")?h.gotoMonth(M.value):c(M,"pika-select-year")&&h.gotoYear(M.value))},h._onKeyChange=function(E){if(E=E||window.event,h.isVisible())switch(E.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7);break;case 8:case 46:h.setDate(null);break}},h._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(r){var E=n(g.field.value,g.format,g.formatStrict);return E&&E.isValid()?E.toDate():null}else return new Date(Date.parse(g.field.value))},h._onInputChange=function(E){var M;E.firedBy!==h&&(M=h._parseFieldValue(),w(M)&&h.setDate(M),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var E=o.activeElement;do if(c(E,"pika-single"))return;while(E=E.parentNode);h._c||(h._b=s(function(){h.hide()},50)),h._c=!1},h._onClick=function(E){E=E||window.event;var M=E.target||E.srcElement,O=M;if(M){!i&&c(M,"pika-select")&&(M.onchange||(M.setAttribute("onchange","return;"),a(M,"change",h._onChange)));do if(c(O,"pika-single")||O===g.trigger)return;while(O=O.parentNode);h._v&&M!==g.trigger&&O!==g.trigger&&h.hide()}},h.el=o.createElement("div"),h.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),a(h.el,"mousedown",h._onMouseDown,!0),a(h.el,"touchend",h._onMouseDown,!0),a(h.el,"change",h._onChange),g.keyboardInput&&a(o,"keydown",h._onKeyChange),g.field&&(g.container?g.container.appendChild(h.el):g.bound?o.body.appendChild(h.el):g.field.parentNode.insertBefore(h.el,g.field.nextSibling),a(g.field,"change",h._onInputChange),g.defaultDate||(g.defaultDate=h._parseFieldValue(),g.setDefaultDate=!0));var p=g.defaultDate;w(p)?g.setDefaultDate?h.setDate(p,!0):h.gotoDate(p):h.gotoDate(new Date),g.bound?(this.hide(),h.el.className+=" is-bound",a(g.trigger,"click",h._onInputClick),a(g.trigger,"focus",h._onInputFocus),a(g.trigger,"blur",h._onInputBlur)):this.show()};return Pe.prototype={config:function(R){this._o||(this._o=L({},z,!0));var h=L(this._o,R,!0);h.isRTL=!!h.isRTL,h.field=h.field&&h.field.nodeName?h.field:null,h.theme=typeof h.theme=="string"&&h.theme?h.theme:null,h.bound=!!(h.bound!==void 0?h.field&&h.bound:h.field),h.trigger=h.trigger&&h.trigger.nodeName?h.trigger:h.field,h.disableWeekends=!!h.disableWeekends,h.disableDayFn=typeof h.disableDayFn=="function"?h.disableDayFn:null;var g=parseInt(h.numberOfMonths,10)||1;if(h.numberOfMonths=g>4?4:g,w(h.minDate)||(h.minDate=!1),w(h.maxDate)||(h.maxDate=!1),h.minDate&&h.maxDate&&h.maxDate<h.minDate&&(h.maxDate=h.minDate=!1),h.minDate&&this.setMinDate(h.minDate),h.maxDate&&this.setMaxDate(h.maxDate),m(h.yearRange)){var p=new Date().getFullYear()-10;h.yearRange[0]=parseInt(h.yearRange[0],10)||p,h.yearRange[1]=parseInt(h.yearRange[1],10)||p}else h.yearRange=Math.abs(parseInt(h.yearRange,10))||z.yearRange,h.yearRange>100&&(h.yearRange=100);return h},toString:function(R){return R=R||this._o.format,w(this._d)?this._o.toString?this._o.toString(this._d,R):r?n(this._d).format(R):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(R,h){r&&n.isMoment(R)&&this.setDate(R.toDate(),h)},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(R,h){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",x(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!w(R)){var g=this._o.minDate,p=this._o.maxDate;w(g)&&R<g?R=g:w(p)&&R>p&&(R=p),this._d=new Date(R.getTime()),_(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),x(this._o.field,"change",{firedBy:this})),!h&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var h=!0;if(w(R)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),E=R.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),h=E<g.getTime()||p.getTime()<E}h&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,h){var g=this.getDate()||new Date,p=parseInt(h)*24*60*60*1e3,E;R==="add"?E=new Date(g.valueOf()+p):R==="subtract"&&(E=new Date(g.valueOf()-p)),this.setDate(E)},adjustCalendars:function(){this.calendars[0]=B(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=B({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(_(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=z.minDate,this._o.minYear=z.minYear,this._o.minMonth=z.minMonth,this._o.startRange=z.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(_(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=z.maxDate,this._o.maxYear=z.maxYear,this._o.maxMonth=z.maxMonth,this._o.endRange=z.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var h=this._o,g=h.minYear,p=h.maxYear,E=h.minMonth,M=h.maxMonth,O="",Y;this._y<=g&&(this._y=g,!isNaN(E)&&this._m<E&&(this._m=E)),this._y>=p&&(this._y=p,!isNaN(M)&&this._m>M&&(this._m=M));for(var W=0;W<h.numberOfMonths;W++)Y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),O+='<div class="pika-lendar">'+Me(this,W,this.calendars[W].year,this.calendars[W].month,this.calendars[0].year,Y)+this.render(this.calendars[W].year,this.calendars[W].month,Y)+"</div>";this.el.innerHTML=O,h.bound&&h.field.type!=="hidden"&&s(function(){h.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),h.bound&&h.field.setAttribute("aria-label",h.ariaLabel)}},adjustPosition:function(){var R,h,g,p,E,M,O,Y,W,q,Z,K;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,h=R,g=this.el.offsetWidth,p=this.el.offsetHeight,E=window.innerWidth||o.documentElement.clientWidth,M=window.innerHeight||o.documentElement.clientHeight,O=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,Z=!0,K=!0,typeof R.getBoundingClientRect=="function")q=R.getBoundingClientRect(),Y=q.left+window.pageXOffset,W=q.bottom+window.pageYOffset;else for(Y=h.offsetLeft,W=h.offsetTop+h.offsetHeight;h=h.offsetParent;)Y+=h.offsetLeft,W+=h.offsetTop;(this._o.reposition&&Y+g>E||this._o.position.indexOf("right")>-1&&Y-g+R.offsetWidth>0)&&(Y=Y-g+R.offsetWidth,Z=!1),(this._o.reposition&&W+p>M+O||this._o.position.indexOf("top")>-1&&W-p-R.offsetHeight>0)&&(W=W-p-R.offsetHeight,K=!1),this.el.style.left=Y+"px",this.el.style.top=W+"px",d(this.el,Z?"left-aligned":"right-aligned"),d(this.el,K?"bottom-aligned":"top-aligned"),f(this.el,Z?"right-aligned":"left-aligned"),f(this.el,K?"top-aligned":"bottom-aligned")}},render:function(R,h,g){var p=this._o,E=new Date,M=b(R,h),O=new Date(R,h,1).getDay(),Y=[],W=[];_(E),p.firstDay>0&&(O-=p.firstDay,O<0&&(O+=7));for(var q=h===0?11:h-1,Z=h===11?0:h+1,K=h===0?R-1:R,ce=h===11?R+1:R,Ae=b(K,q),Te=M+O,_e=Te;_e>7;)_e-=7;Te+=7-_e;for(var G=!1,Ge=0,We=0;Ge<Te;Ge++){var ye=new Date(R,h,1+(Ge-O)),xe=w(this._d)?I(ye,this._d):!1,Se=I(ye,E),C=p.events.indexOf(ye.toDateString())!==-1,S=Ge<O||Ge>=M+O,A=1+(Ge-O),F=h,P=R,k=p.startRange&&I(p.startRange,ye),H=p.endRange&&I(p.endRange,ye),D=p.startRange&&p.endRange&&p.startRange<ye&&ye<p.endRange,V=p.minDate&&ye<p.minDate||p.maxDate&&ye>p.maxDate||p.disableWeekends&&v(ye)||p.disableDayFn&&p.disableDayFn(ye);S&&(Ge<O?(A=Ae+A,F=q,P=K):(A=A-M,F=Z,P=ce));var $={day:A,month:F,year:P,hasEvent:C,isSelected:xe,isToday:Se,isDisabled:V,isEmpty:S,isStartRange:k,isEndRange:H,isInRange:D,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&xe&&(G=!0),W.push(j($)),++We===7&&(p.showWeekNumber&&W.unshift(ie(Ge-O,h,R,p.firstWeekOfYearMinDays)),Y.push(oe(W,p.isRTL,p.pickWholeWeek,G)),W=[],We=0,G=!1)}return Je(p,Y,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(o,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Pe})})(ix);var p5=ix.exports;const L0=tA(p5);function nh(t,e,n){return e=w5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w5(t){var e=C5(t,"string");return typeof e=="symbol"?e:String(e)}function C5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ox="date",$0="dateEditor";class sx extends qs{constructor(){super(...arguments),nh(this,"defaultDateFormat","DD/MM/YYYY"),nh(this,"isCellEdited",!1),nh(this,"parentDestroyed",!1),nh(this,"$datePicker",null)}static get EDITOR_TYPE(){return ox}init(){if(typeof Q!="function")throw new Error("You need to include moment.js to your project.");if(typeof L0!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),J(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new or(this);e.addEventListener(this.datePicker,"mousedown",n=>{Ie(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("true")]),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:$0})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.TD&&this.hot.getSettings().ariaTags&&ve(this.TD,[sn("false")]),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup($0),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?bS(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new L0(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Ot(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-ut(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,Q(s,r,!0).isValid()&&this.$datePicker.setMoment(Q(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Q(s,r,!0).isValid()&&this.$datePicker.setMoment(Q(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&ic(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=Q(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const v5="date";function ax(t,e,n,r,i,o,s){dl.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,[al("dialog"),sn("false")])}ax.RENDERER_TYPE=v5;function lx(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const S5=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:lx},Symbol.toStringTag,{value:"Module"})),y5="date";function Iy(t,e){const n=AI(ox,this.instance);let r=t,i=!0;r==null&&(r="");let o=Q(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=Q(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=b5(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}Iy.VALIDATOR_TYPE=y5;function b5(t,e){const n=Q(lx(t)),r=Q(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const R5="date",ux={CELL_TYPE:R5,editor:sx,renderer:ax,validator:Iy},E5="dropdown";class Py extends _y{static get EDITOR_TYPE(){return E5}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}de.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===Py&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const T5="dropdown",cx={CELL_TYPE:T5,editor:Py,renderer:dl,validator:om},_5="handsontable";function hx(t,e,n,r,i,o,s){dl.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,[al("true"),sn("false")])}hx.RENDERER_TYPE=_5;const M5="handsontable",A5={CELL_TYPE:M5,editor:Ty,renderer:hx},O5="numeric";class dx extends qs{static get EDITOR_TYPE(){return O5}}function rh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fx={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var d=typeof rh=="function"&&rh;if(!c&&d)return d(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var m=i[u]={exports:{}};r[u][0].call(m.exports,function(w){return s(r[u][1][w]||w)},m,m.exports,n,r,i,o)}return i[u].exports}for(var a=typeof rh=="function"&&rh,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",d=c+"Number primitive has more than 15 significant digits: ",f=1e14,m=14,w=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],y=1e7,b=1e9;function _(j){var X=0|j;return 0<j||j===X?X:X-1}function I(j){for(var X,ie,oe=1,se=j.length,pe=j[0]+"";oe<se;){for(X=j[oe++]+"",ie=m-X.length;ie--;X="0"+X);pe+=X}for(se=pe.length;pe.charCodeAt(--se)===48;);return pe.slice(0,se+1||1)}function L(j,X){var ie,oe,se=j.c,pe=X.c,Me=j.s,Je=X.s,Pe=j.e,R=X.e;if(!Me||!Je)return null;if(ie=se&&!se[0],oe=pe&&!pe[0],ie||oe)return ie?oe?0:-Je:Me;if(Me!=Je)return Me;if(ie=Me<0,oe=Pe==R,!se||!pe)return oe?0:!se^ie?1:-1;if(!oe)return R<Pe^ie?1:-1;for(Je=(Pe=se.length)<(R=pe.length)?Pe:R,Me=0;Me<Je;Me++)if(se[Me]!=pe[Me])return se[Me]>pe[Me]^ie?1:-1;return Pe==R?0:R<Pe^ie?1:-1}function x(j,X,ie,oe){if(j<X||ie<j||j!==(j<0?l(j):u(j)))throw Error(c+(oe||"Argument")+(typeof j=="number"?j<X||ie<j?" out of range: ":" not an integer: ":" not a primitive number: ")+String(j))}function B(j){var X=j.c.length-1;return _(j.e/m)==X&&j.c[X]%2!=0}function z(j,X){return(1<j.length?j.charAt(0)+"."+j.slice(1):j)+(X<0?"e":"e+")+X}function ee(j,X,ie){var oe,se;if(X<0){for(se=ie+".";++X;se+=ie);j=se+j}else if(++X>(oe=j.length)){for(se=ie,X-=oe;--X;se+=ie);j+=se}else X<oe&&(j=j.slice(0,X)+"."+j.slice(X));return j}(s=function j(X){var ie,oe,se,pe,Me,Je,Pe,R,h,g,p=G.prototype={constructor:G,toString:null,valueOf:null},E=new G(1),M=20,O=4,Y=-7,W=21,q=-1e7,Z=1e7,K=!1,ce=1,Ae=0,Te={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},_e="0123456789abcdefghijklmnopqrstuvwxyz";function G(C,S){var A,F,P,k,H,D,V,$,U=this;if(!(U instanceof G))return new G(C,S);if(S==null){if(C instanceof G)return U.s=C.s,U.e=C.e,void(U.c=(C=C.c)?C.slice():C);if((D=typeof C=="number")&&0*C==0){if(U.s=1/C<0?(C=-C,-1):1,C===~~C){for(k=0,H=C;10<=H;H/=10,k++);return U.e=k,void(U.c=[C])}$=String(C)}else{if($=String(C),!a.test($))return se(U,$,D);U.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(k=$.indexOf("."))&&($=$.replace(".","")),0<(H=$.search(/e/i))?(k<0&&(k=H),k+=+$.slice(H+1),$=$.substring(0,H)):k<0&&(k=$.length)}else{if(x(S,2,_e.length,"Base"),$=String(C),S==10)return xe(U=new G(C instanceof G?C:$),M+U.e+1,O);if(D=typeof C=="number"){if(0*C!=0)return se(U,$,D,S);if(U.s=1/C<0?($=$.slice(1),-1):1,G.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(d+C);D=!1}else U.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(A=_e.slice(0,S),k=H=0,V=$.length;H<V;H++)if(A.indexOf(F=$.charAt(H))<0){if(F=="."){if(k<H){k=V;continue}}else if(!P&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){P=!0,H=-1,k=0;continue}return se(U,String(C),D,S)}-1<(k=($=oe($,S,10,U.s)).indexOf("."))?$=$.replace(".",""):k=$.length}for(H=0;$.charCodeAt(H)===48;H++);for(V=$.length;$.charCodeAt(--V)===48;);if($=$.slice(H,++V)){if(V-=H,D&&G.DEBUG&&15<V&&(w<C||C!==u(C)))throw Error(d+U.s*C);if(Z<(k=k-H-1))U.c=U.e=null;else if(k<q)U.c=[U.e=0];else{if(U.e=k,U.c=[],H=(k+1)%m,k<0&&(H+=m),H<V){for(H&&U.c.push(+$.slice(0,H)),V-=m;H<V;)U.c.push(+$.slice(H,H+=m));$=$.slice(H),H=m-$.length}else H-=V;for(;H--;$+="0");U.c.push(+$)}}else U.c=[U.e=0]}function Ge(C,S,A,F){var P,k,H,D,V;if(A==null?A=O:x(A,0,8),!C.c)return C.toString();if(P=C.c[0],H=C.e,S==null)V=I(C.c),V=F==1||F==2&&(H<=Y||W<=H)?z(V,H):ee(V,H,"0");else if(k=(C=xe(new G(C),S,A)).e,D=(V=I(C.c)).length,F==1||F==2&&(S<=k||k<=Y)){for(;D<S;V+="0",D++);V=z(V,k)}else if(S-=H,V=ee(V,k,"0"),D<k+1){if(0<--S)for(V+=".";S--;V+="0");}else if(0<(S+=k-D))for(k+1==D&&(V+=".");S--;V+="0");return C.s<0&&P?"-"+V:V}function We(C,S){for(var A,F=1,P=new G(C[0]);F<C.length;F++){if(!(A=new G(C[F])).s){P=A;break}S.call(P,A)&&(P=A)}return P}function ye(C,S,A){for(var F=1,P=S.length;!S[--P];S.pop());for(P=S[0];10<=P;P/=10,F++);return(A=F+A*m-1)>Z?C.c=C.e=null:C.c=A<q?[C.e=0]:(C.e=A,S),C}function xe(C,S,A,F){var P,k,H,D,V,$,U,re=C.c,he=v;if(re){e:{for(P=1,D=re[0];10<=D;D/=10,P++);if((k=S-P)<0)k+=m,H=S,U=(V=re[$=0])/he[P-H-1]%10|0;else if(($=l((k+1)/m))>=re.length){if(!F)break e;for(;re.length<=$;re.push(0));V=U=0,H=(k%=m)-m+(P=1)}else{for(V=D=re[$],P=1;10<=D;D/=10,P++);U=(H=(k%=m)-m+P)<0?0:V/he[P-H-1]%10|0}if(F=F||S<0||re[$+1]!=null||(H<0?V:V%he[P-H-1]),F=A<4?(U||F)&&(A==0||A==(C.s<0?3:2)):5<U||U==5&&(A==4||F||A==6&&(0<k?0<H?V/he[P-H]:0:re[$-1])%10&1||A==(C.s<0?8:7)),S<1||!re[0])return re.length=0,F?(S-=C.e+1,re[0]=he[(m-S%m)%m],C.e=-S||0):re[0]=C.e=0,C;if(k==0?(re.length=$,D=1,$--):(re.length=$+1,D=he[m-k],re[$]=0<H?u(V/he[P-H]%he[H])*D:0),F)for(;;){if($==0){for(k=1,H=re[0];10<=H;H/=10,k++);for(H=re[0]+=D,D=1;10<=H;H/=10,D++);k!=D&&(C.e++,re[0]==f&&(re[0]=1));break}if(re[$]+=D,re[$]!=f)break;re[$--]=0,D=1}for(k=re.length;re[--k]===0;re.pop());}C.e>Z?C.c=C.e=null:C.e<q&&(C.c=[C.e=0])}return C}function Se(C){var S,A=C.e;return A===null?C.toString():(S=I(C.c),S=A<=Y||W<=A?z(S,A):ee(S,A,"0"),C.s<0?"-"+S:S)}return G.clone=j,G.ROUND_UP=0,G.ROUND_DOWN=1,G.ROUND_CEIL=2,G.ROUND_FLOOR=3,G.ROUND_HALF_UP=4,G.ROUND_HALF_DOWN=5,G.ROUND_HALF_EVEN=6,G.ROUND_HALF_CEIL=7,G.ROUND_HALF_FLOOR=8,G.EUCLID=9,G.config=G.set=function(C){var S,A;if(C!=null){if(typeof C!="object")throw Error(c+"Object expected: "+C);if(C.hasOwnProperty(S="DECIMAL_PLACES")&&(x(A=C[S],0,b,S),M=A),C.hasOwnProperty(S="ROUNDING_MODE")&&(x(A=C[S],0,8,S),O=A),C.hasOwnProperty(S="EXPONENTIAL_AT")&&((A=C[S])&&A.pop?(x(A[0],-b,0,S),x(A[1],0,b,S),Y=A[0],W=A[1]):(x(A,-b,b,S),Y=-(W=A<0?-A:A))),C.hasOwnProperty(S="RANGE"))if((A=C[S])&&A.pop)x(A[0],-b,-1,S),x(A[1],1,b,S),q=A[0],Z=A[1];else{if(x(A,-b,b,S),!A)throw Error(c+S+" cannot be zero: "+A);q=-(Z=A<0?-A:A)}if(C.hasOwnProperty(S="CRYPTO")){if((A=C[S])!==!!A)throw Error(c+S+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw K=!A,Error(c+"crypto unavailable");K=A}else K=A}if(C.hasOwnProperty(S="MODULO_MODE")&&(x(A=C[S],0,9,S),ce=A),C.hasOwnProperty(S="POW_PRECISION")&&(x(A=C[S],0,b,S),Ae=A),C.hasOwnProperty(S="FORMAT")){if(typeof(A=C[S])!="object")throw Error(c+S+" not an object: "+A);Te=A}if(C.hasOwnProperty(S="ALPHABET")){if(typeof(A=C[S])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(c+S+" invalid: "+A);_e=A}}return{DECIMAL_PLACES:M,ROUNDING_MODE:O,EXPONENTIAL_AT:[Y,W],RANGE:[q,Z],CRYPTO:K,MODULO_MODE:ce,POW_PRECISION:Ae,FORMAT:Te,ALPHABET:_e}},G.isBigNumber=function(C){return C instanceof G||C&&C._isBigNumber===!0||!1},G.maximum=G.max=function(){return We(arguments,p.lt)},G.minimum=G.min=function(){return We(arguments,p.gt)},G.random=(pe=9007199254740992,Me=Math.random()*pe&2097151?function(){return u(Math.random()*pe)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(C){var S,A,F,P,k,H=0,D=[],V=new G(E);if(C==null?C=M:x(C,0,b),P=l(C/m),K)if(crypto.getRandomValues){for(S=crypto.getRandomValues(new Uint32Array(P*=2));H<P;)9e15<=(k=131072*S[H]+(S[H+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),S[H]=A[0],S[H+1]=A[1]):(D.push(k%1e14),H+=2);H=P/2}else{if(!crypto.randomBytes)throw K=!1,Error(c+"crypto unavailable");for(S=crypto.randomBytes(P*=7);H<P;)9e15<=(k=281474976710656*(31&S[H])+1099511627776*S[H+1]+4294967296*S[H+2]+16777216*S[H+3]+(S[H+4]<<16)+(S[H+5]<<8)+S[H+6])?crypto.randomBytes(7).copy(S,H):(D.push(k%1e14),H+=7);H=P/7}if(!K)for(;H<P;)(k=Me())<9e15&&(D[H++]=k%1e14);for(P=D[--H],C%=m,P&&C&&(k=v[m-C],D[H]=u(P/k)*k);D[H]===0;D.pop(),H--);if(H<0)D=[F=0];else{for(F=-1;D[0]===0;D.splice(0,1),F-=m);for(H=1,k=D[0];10<=k;k/=10,H++);H<m&&(F-=m-H)}return V.e=F,V.c=D,V}),G.sum=function(){for(var C=1,S=arguments,A=new G(S[0]);C<S.length;)A=A.plus(S[C++]);return A},oe=function(){var C="0123456789";function S(A,F,P,k){for(var H,D,V=[0],$=0,U=A.length;$<U;){for(D=V.length;D--;V[D]*=F);for(V[0]+=k.indexOf(A.charAt($++)),H=0;H<V.length;H++)V[H]>P-1&&(V[H+1]==null&&(V[H+1]=0),V[H+1]+=V[H]/P|0,V[H]%=P)}return V.reverse()}return function(A,F,P,k,H){var D,V,$,U,re,he,Ce,Oe,ke=A.indexOf("."),wt=M,Xe=O;for(0<=ke&&(U=Ae,Ae=0,A=A.replace(".",""),he=(Oe=new G(F)).pow(A.length-ke),Ae=U,Oe.c=S(ee(I(he.c),he.e,"0"),10,P,C),Oe.e=Oe.c.length),$=U=(Ce=S(A,F,P,H?(D=_e,C):(D=C,_e))).length;Ce[--U]==0;Ce.pop());if(!Ce[0])return D.charAt(0);if(ke<0?--$:(he.c=Ce,he.e=$,he.s=k,Ce=(he=ie(he,Oe,wt,Xe,P)).c,re=he.r,$=he.e),ke=Ce[V=$+wt+1],U=P/2,re=re||V<0||Ce[V+1]!=null,re=Xe<4?(ke!=null||re)&&(Xe==0||Xe==(he.s<0?3:2)):U<ke||ke==U&&(Xe==4||re||Xe==6&&1&Ce[V-1]||Xe==(he.s<0?8:7)),V<1||!Ce[0])A=re?ee(D.charAt(1),-wt,D.charAt(0)):D.charAt(0);else{if(Ce.length=V,re)for(--P;++Ce[--V]>P;)Ce[V]=0,V||(++$,Ce=[1].concat(Ce));for(U=Ce.length;!Ce[--U];);for(ke=0,A="";ke<=U;A+=D.charAt(Ce[ke++]));A=ee(A,$,D.charAt(0))}return A}}(),ie=function(){function C(F,P,k){var H,D,V,$,U=0,re=F.length,he=P%y,Ce=P/y|0;for(F=F.slice();re--;)U=((D=he*(V=F[re]%y)+(H=Ce*V+($=F[re]/y|0)*he)%y*y+U)/k|0)+(H/y|0)+Ce*$,F[re]=D%k;return U&&(F=[U].concat(F)),F}function S(F,P,k,H){var D,V;if(k!=H)V=H<k?1:-1;else for(D=V=0;D<k;D++)if(F[D]!=P[D]){V=F[D]>P[D]?1:-1;break}return V}function A(F,P,k,H){for(var D=0;k--;)F[k]-=D,D=F[k]<P[k]?1:0,F[k]=D*H+F[k]-P[k];for(;!F[0]&&1<F.length;F.splice(0,1));}return function(F,P,k,H,D){var V,$,U,re,he,Ce,Oe,ke,wt,Xe,at,Rt,Zs,ml,$t,an,jo,Mn=F.s==P.s?1:-1,qt=F.c,Ct=P.c;if(!(qt&&qt[0]&&Ct&&Ct[0]))return new G(F.s&&P.s&&(qt?!Ct||qt[0]!=Ct[0]:Ct)?qt&&qt[0]==0||!Ct?0*Mn:Mn/0:NaN);for(wt=(ke=new G(Mn)).c=[],Mn=k+($=F.e-P.e)+1,D||(D=f,$=_(F.e/m)-_(P.e/m),Mn=Mn/m|0),U=0;Ct[U]==(qt[U]||0);U++);if(Ct[U]>(qt[U]||0)&&$--,Mn<0)wt.push(1),re=!0;else{for(ml=qt.length,an=Ct.length,Mn+=2,1<(he=u(D/(Ct[U=0]+1)))&&(Ct=C(Ct,he,D),qt=C(qt,he,D),an=Ct.length,ml=qt.length),Zs=an,at=(Xe=qt.slice(0,an)).length;at<an;Xe[at++]=0);jo=Ct.slice(),jo=[0].concat(jo),$t=Ct[0],Ct[1]>=D/2&&$t++;do{if(he=0,(V=S(Ct,Xe,an,at))<0){if(Rt=Xe[0],an!=at&&(Rt=Rt*D+(Xe[1]||0)),1<(he=u(Rt/$t)))for(D<=he&&(he=D-1),Oe=(Ce=C(Ct,he,D)).length,at=Xe.length;S(Ce,Xe,Oe,at)==1;)he--,A(Ce,an<Oe?jo:Ct,Oe,D),Oe=Ce.length,V=1;else he==0&&(V=he=1),Oe=(Ce=Ct.slice()).length;if(Oe<at&&(Ce=[0].concat(Ce)),A(Xe,Ce,at,D),at=Xe.length,V==-1)for(;S(Ct,Xe,an,at)<1;)he++,A(Xe,an<at?jo:Ct,at,D),at=Xe.length}else V===0&&(he++,Xe=[0]);wt[U++]=he,Xe[0]?Xe[at++]=qt[Zs]||0:(Xe=[qt[Zs]],at=1)}while((Zs++<ml||Xe[0]!=null)&&Mn--);re=Xe[0]!=null,wt[0]||wt.splice(0,1)}if(D==f){for(U=1,Mn=wt[0];10<=Mn;Mn/=10,U++);xe(ke,k+(ke.e=U+$*m-1)+1,H,re)}else ke.e=$,ke.r=+re;return ke}}(),Je=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Pe=/^([^.]+)\.$/,R=/^\.([^.]+)$/,h=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,se=function(C,S,A,F){var P,k=A?S:S.replace(g,"");if(h.test(k))C.s=isNaN(k)?null:k<0?-1:1,C.c=C.e=null;else{if(!A&&(k=k.replace(Je,function(H,D,V){return P=(V=V.toLowerCase())=="x"?16:V=="b"?2:8,F&&F!=P?H:D}),F&&(P=F,k=k.replace(Pe,"$1").replace(R,"0.$1")),S!=k))return new G(k,P);if(G.DEBUG)throw Error(c+"Not a"+(F?" base "+F:"")+" number: "+S);C.c=C.e=C.s=null}},p.absoluteValue=p.abs=function(){var C=new G(this);return C.s<0&&(C.s=1),C},p.comparedTo=function(C,S){return L(this,new G(C,S))},p.decimalPlaces=p.dp=function(C,S){var A,F,P;if(C!=null)return x(C,0,b),S==null?S=O:x(S,0,8),xe(new G(this),C+this.e+1,S);if(!(A=this.c))return null;if(F=((P=A.length-1)-_(this.e/m))*m,P=A[P])for(;P%10==0;P/=10,F--);return F<0&&(F=0),F},p.dividedBy=p.div=function(C,S){return ie(this,new G(C,S),M,O)},p.dividedToIntegerBy=p.idiv=function(C,S){return ie(this,new G(C,S),0,1)},p.exponentiatedBy=p.pow=function(C,S){var A,F,P,k,H,D,V,$,U=this;if((C=new G(C)).c&&!C.isInteger())throw Error(c+"Exponent not an integer: "+Se(C));if(S!=null&&(S=new G(S)),H=14<C.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!C.c||!C.c[0])return $=new G(Math.pow(+Se(U),H?2-B(C):+Se(C))),S?$.mod(S):$;if(D=C.s<0,S){if(S.c?!S.c[0]:!S.s)return new G(NaN);(F=!D&&U.isInteger()&&S.isInteger())&&(U=U.mod(S))}else{if(9<C.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||H&&24e7<=U.c[1]:U.c[0]<8e13||H&&U.c[0]<=9999975e7)))return k=U.s<0&&B(C)?-0:0,-1<U.e&&(k=1/k),new G(D?1/k:k);Ae&&(k=l(Ae/m+2))}for(V=H?(A=new G(.5),D&&(C.s=1),B(C)):(P=Math.abs(+Se(C)))%2,$=new G(E);;){if(V){if(!($=$.times(U)).c)break;k?$.c.length>k&&($.c.length=k):F&&($=$.mod(S))}if(P){if((P=u(P/2))===0)break;V=P%2}else if(xe(C=C.times(A),C.e+1,1),14<C.e)V=B(C);else{if((P=+Se(C))==0)break;V=P%2}U=U.times(U),k?U.c&&U.c.length>k&&(U.c.length=k):F&&(U=U.mod(S))}return F?$:(D&&($=E.div($)),S?$.mod(S):k?xe($,Ae,O,void 0):$)},p.integerValue=function(C){var S=new G(this);return C==null?C=O:x(C,0,8),xe(S,S.e+1,C)},p.isEqualTo=p.eq=function(C,S){return L(this,new G(C,S))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(C,S){return 0<L(this,new G(C,S))},p.isGreaterThanOrEqualTo=p.gte=function(C,S){return(S=L(this,new G(C,S)))===1||S===0},p.isInteger=function(){return!!this.c&&_(this.e/m)>this.c.length-2},p.isLessThan=p.lt=function(C,S){return L(this,new G(C,S))<0},p.isLessThanOrEqualTo=p.lte=function(C,S){return(S=L(this,new G(C,S)))===-1||S===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(C,S){var A,F,P,k,H=this,D=H.s;if(S=(C=new G(C,S)).s,!D||!S)return new G(NaN);if(D!=S)return C.s=-S,H.plus(C);var V=H.e/m,$=C.e/m,U=H.c,re=C.c;if(!V||!$){if(!U||!re)return U?(C.s=-S,C):new G(re?H:NaN);if(!U[0]||!re[0])return re[0]?(C.s=-S,C):new G(U[0]?H:O==3?-0:0)}if(V=_(V),$=_($),U=U.slice(),D=V-$){for((P=(k=D<0)?(D=-D,U):($=V,re)).reverse(),S=D;S--;P.push(0));P.reverse()}else for(F=(k=(D=U.length)<(S=re.length))?D:S,D=S=0;S<F;S++)if(U[S]!=re[S]){k=U[S]<re[S];break}if(k&&(P=U,U=re,re=P,C.s=-C.s),0<(S=(F=re.length)-(A=U.length)))for(;S--;U[A++]=0);for(S=f-1;D<F;){if(U[--F]<re[F]){for(A=F;A&&!U[--A];U[A]=S);--U[A],U[F]+=f}U[F]-=re[F]}for(;U[0]==0;U.splice(0,1),--$);return U[0]?ye(C,U,$):(C.s=O==3?-1:1,C.c=[C.e=0],C)},p.modulo=p.mod=function(C,S){var A,F,P=this;return C=new G(C,S),!P.c||!C.s||C.c&&!C.c[0]?new G(NaN):!C.c||P.c&&!P.c[0]?new G(P):(ce==9?(F=C.s,C.s=1,A=ie(P,C,0,3),C.s=F,A.s*=F):A=ie(P,C,0,ce),(C=P.minus(A.times(C))).c[0]||ce!=1||(C.s=P.s),C)},p.multipliedBy=p.times=function(C,S){var A,F,P,k,H,D,V,$,U,re,he,Ce,Oe,ke,wt,Xe=this,at=Xe.c,Rt=(C=new G(C,S)).c;if(!(at&&Rt&&at[0]&&Rt[0]))return!Xe.s||!C.s||at&&!at[0]&&!Rt||Rt&&!Rt[0]&&!at?C.c=C.e=C.s=null:(C.s*=Xe.s,at&&Rt?(C.c=[0],C.e=0):C.c=C.e=null),C;for(F=_(Xe.e/m)+_(C.e/m),C.s*=Xe.s,(V=at.length)<(re=Rt.length)&&(Oe=at,at=Rt,Rt=Oe,P=V,V=re,re=P),P=V+re,Oe=[];P--;Oe.push(0));for(ke=f,wt=y,P=re;0<=--P;){for(A=0,he=Rt[P]%wt,Ce=Rt[P]/wt|0,k=P+(H=V);P<k;)A=(($=he*($=at[--H]%wt)+(D=Ce*$+(U=at[H]/wt|0)*he)%wt*wt+Oe[k]+A)/ke|0)+(D/wt|0)+Ce*U,Oe[k--]=$%ke;Oe[k]=A}return A?++F:Oe.splice(0,1),ye(C,Oe,F)},p.negated=function(){var C=new G(this);return C.s=-C.s||null,C},p.plus=function(C,S){var A,F=this,P=F.s;if(S=(C=new G(C,S)).s,!P||!S)return new G(NaN);if(P!=S)return C.s=-S,F.minus(C);var k=F.e/m,H=C.e/m,D=F.c,V=C.c;if(!k||!H){if(!D||!V)return new G(P/0);if(!D[0]||!V[0])return V[0]?C:new G(D[0]?F:0*P)}if(k=_(k),H=_(H),D=D.slice(),P=k-H){for((A=0<P?(H=k,V):(P=-P,D)).reverse();P--;A.push(0));A.reverse()}for((P=D.length)-(S=V.length)<0&&(A=V,V=D,D=A,S=P),P=0;S;)P=(D[--S]=D[S]+V[S]+P)/f|0,D[S]=f===D[S]?0:D[S]%f;return P&&(D=[P].concat(D),++H),ye(C,D,H)},p.precision=p.sd=function(C,S){var A,F,P;if(C!=null&&C!==!!C)return x(C,1,b),S==null?S=O:x(S,0,8),xe(new G(this),C,S);if(!(A=this.c))return null;if(F=(P=A.length-1)*m+1,P=A[P]){for(;P%10==0;P/=10,F--);for(P=A[0];10<=P;P/=10,F++);}return C&&this.e+1>F&&(F=this.e+1),F},p.shiftedBy=function(C){return x(C,-w,w),this.times("1e"+C)},p.squareRoot=p.sqrt=function(){var C,S,A,F,P,k=this,H=k.c,D=k.s,V=k.e,$=M+4,U=new G("0.5");if(D!==1||!H||!H[0])return new G(!D||D<0&&(!H||H[0])?NaN:H?k:1/0);if((A=(D=Math.sqrt(+Se(k)))==0||D==1/0?(((S=I(H)).length+V)%2==0&&(S+="0"),D=Math.sqrt(+S),V=_((V+1)/2)-(V<0||V%2),new G(S=D==1/0?"1e"+V:(S=D.toExponential()).slice(0,S.indexOf("e")+1)+V)):new G(D+"")).c[0]){for((D=(V=A.e)+$)<3&&(D=0);;)if(P=A,A=U.times(P.plus(ie(k,P,$,1))),I(P.c).slice(0,D)===(S=I(A.c)).slice(0,D)){if(A.e<V&&--D,(S=S.slice(D-3,D+1))!="9999"&&(F||S!="4999")){+S&&(+S.slice(1)||S.charAt(0)!="5")||(xe(A,A.e+M+2,1),C=!A.times(A).eq(k));break}if(!F&&(xe(P,P.e+M+2,0),P.times(P).eq(k))){A=P;break}$+=4,D+=4,F=1}}return xe(A,A.e+M+1,O,C)},p.toExponential=function(C,S){return C!=null&&(x(C,0,b),C++),Ge(this,C,S,1)},p.toFixed=function(C,S){return C!=null&&(x(C,0,b),C=C+this.e+1),Ge(this,C,S)},p.toFormat=function(C,S,A){var F;if(A==null)C!=null&&S&&typeof S=="object"?(A=S,S=null):C&&typeof C=="object"?(A=C,C=S=null):A=Te;else if(typeof A!="object")throw Error(c+"Argument not an object: "+A);if(F=this.toFixed(C,S),this.c){var P,k=F.split("."),H=+A.groupSize,D=+A.secondaryGroupSize,V=A.groupSeparator||"",$=k[0],U=k[1],re=this.s<0,he=re?$.slice(1):$,Ce=he.length;if(D&&(P=H,H=D,Ce-=D=P),0<H&&0<Ce){for(P=Ce%H||H,$=he.substr(0,P);P<Ce;P+=H)$+=V+he.substr(P,H);0<D&&($+=V+he.slice(P)),re&&($="-"+$)}F=U?$+(A.decimalSeparator||"")+((D=+A.fractionGroupSize)?U.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):U):$}return(A.prefix||"")+F+(A.suffix||"")},p.toFraction=function(C){var S,A,F,P,k,H,D,V,$,U,re,he,Ce=this,Oe=Ce.c;if(C!=null&&(!(D=new G(C)).isInteger()&&(D.c||D.s!==1)||D.lt(E)))throw Error(c+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Se(D));if(!Oe)return new G(Ce);for(S=new G(E),$=A=new G(E),F=V=new G(E),he=I(Oe),k=S.e=he.length-Ce.e-1,S.c[0]=v[(H=k%m)<0?m+H:H],C=!C||0<D.comparedTo(S)?0<k?S:$:D,H=Z,Z=1/0,D=new G(he),V.c[0]=0;U=ie(D,S,0,1),(P=A.plus(U.times(F))).comparedTo(C)!=1;)A=F,F=P,$=V.plus(U.times(P=$)),V=P,S=D.minus(U.times(P=S)),D=P;return P=ie(C.minus(A),F,0,1),V=V.plus(P.times($)),A=A.plus(P.times(F)),V.s=$.s=Ce.s,re=ie($,F,k*=2,O).minus(Ce).abs().comparedTo(ie(V,A,k,O).minus(Ce).abs())<1?[$,F]:[V,A],Z=H,re},p.toNumber=function(){return+Se(this)},p.toPrecision=function(C,S){return C!=null&&x(C,1,b),Ge(this,C,S,2)},p.toString=function(C){var S,A=this,F=A.s,P=A.e;return P===null?F?(S="Infinity",F<0&&(S="-"+S)):S="NaN":(S=C==null?P<=Y||W<=P?z(I(A.c),P):ee(I(A.c),P,"0"):C===10?ee(I((A=xe(new G(A),M+P+1,O)).c),A.e,"0"):(x(C,2,_e.length,"Base"),oe(ee(I(A.c),P,"0"),10,C,F,!0)),F<0&&A.c[0]&&(S="-"+S)),S},p.valueOf=p.toJSON=function(){return Se(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),X!=null&&G.set(X),G}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(_,I){return function(L){if(Array.isArray(L))return L}(_)||function(L,x){var B=[],z=!0,ee=!1,j=void 0;try{for(var X,ie=L[Symbol.iterator]();!(z=(X=ie.next()).done)&&(B.push(X.value),!x||B.length!==x);z=!0);}catch(oe){ee=!0,j=oe}finally{try{z||ie.return==null||ie.return()}finally{if(ee)throw j}}return B}(_,I)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(_){var I=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},L=2<arguments.length?arguments[2]:void 0;if(typeof I=="string"&&(I=l.parseFormat(I)),!a.validateFormat(I))return"ERROR: invalid format";var x=I.prefix||"",B=I.postfix||"",z=function(ee,j,X){switch(j.output){case"currency":return j=b(j,s.currentCurrencyDefaultFormat()),function(_e,G,Ge){var We=Ge.currentCurrency(),ye=Object.assign({},d,G),xe=void 0,Se="",C=!!ye.totalLength||!!ye.forceAverage||ye.average,S=G.currencyPosition||We.position,A=G.currencySymbol||We.symbol;ye.spaceSeparated&&(Se=" "),S==="infix"&&(xe=Se+A+Se);var F=y({instance:_e,providedFormat:G,state:Ge,decimalSeparator:xe});return S==="prefix"&&(F=_e._value<0&&ye.negative==="sign"?"-".concat(Se).concat(A).concat(F.slice(1)):A+Se+F),S&&S!=="postfix"||(F=F+(Se=C?"":Se)+A),F}(ee,j,s);case"percent":return j=b(j,s.currentPercentageDefaultFormat()),function(_e,G,Ge,We){var ye=G.prefixSymbol,xe=y({instance:We(100*_e._value),providedFormat:G,state:Ge}),Se=Object.assign({},d,G);return ye?"%".concat(Se.spaceSeparated?" ":"").concat(xe):"".concat(xe).concat(Se.spaceSeparated?" ":"","%")}(ee,j,s,X);case"byte":return j=b(j,s.currentByteDefaultFormat()),E=ee,O=s,Y=X,W=(M=j).base||"binary",q=c[W],Z=m(E._value,q.suffixes,q.scale),K=Z.value,ce=Z.suffix,Ae=y({instance:Y(K),providedFormat:M,state:O,defaults:O.currentByteDefaultFormat()}),Te=O.currentAbbreviations(),"".concat(Ae).concat(Te.spaced?" ":"").concat(ce);case"time":return j=b(j,s.currentTimeDefaultFormat()),R=ee,h=Math.floor(R._value/60/60),g=Math.floor((R._value-60*h*60)/60),p=Math.round(R._value-60*h*60-60*g),"".concat(h,":").concat(g<10?"0":"").concat(g,":").concat(p<10?"0":"").concat(p);case"ordinal":return j=b(j,s.currentOrdinalDefaultFormat()),ie=ee,oe=j,pe=(se=s).currentOrdinal(),Me=Object.assign({},d,oe),Je=y({instance:ie,providedFormat:oe,state:se}),Pe=pe(ie._value),"".concat(Je).concat(Me.spaceSeparated?" ":"").concat(Pe);case"number":default:return y({instance:ee,providedFormat:j,numbro:X})}var ie,oe,se,pe,Me,Je,Pe,R,h,g,p,E,M,O,Y,W,q,Z,K,ce,Ae,Te}(_,I,L);return z=(z=x+z)+B}function m(_,I,L){var x=I[0],B=Math.abs(_);if(L<=B){for(var z=1;z<I.length;++z){var ee=Math.pow(L,z),j=Math.pow(L,z+1);if(ee<=B&&B<j){x=I[z],_/=ee;break}}x===I[0]&&(_/=Math.pow(L,I.length-1),x=I[I.length-1])}return{value:_,suffix:x}}function w(_){for(var I="",L=0;L<_;L++)I+="0";return I}function v(_,I){return _.toString().indexOf("e")!==-1?function(L,x){var B=L.toString(),z=o(B.split("e"),2),ee=z[0],j=z[1],X=o(ee.split("."),2),ie=X[0],oe=X[1],se=oe===void 0?"":oe;if(0<+j)B=ie+se+w(j-se.length);else{var pe=".";pe=+ie<0?"-0".concat(pe):"0".concat(pe);var Me=(w(-j-1)+Math.abs(ie)+se).substr(0,x);Me.length<x&&(Me+=w(x-Me.length)),B=pe+Me}return 0<+j&&0<x&&(B+=".".concat(w(x))),B}(_,I):(Math.round(+"".concat(_,"e+").concat(I))/Math.pow(10,I)).toFixed(I)}function y(_){var I=_.instance,L=_.providedFormat,x=_.state,B=x===void 0?s:x,z=_.decimalSeparator,ee=_.defaults,j=ee===void 0?B.currentDefaults():ee,X=I._value;if(X===0&&B.hasZeroFormat())return B.getZeroFormat();if(!isFinite(X))return X.toString();var ie,oe,se,pe,Me,Je,Pe,R,h=Object.assign({},d,j,L),g=h.totalLength,p=g?0:h.characteristic,E=h.optionalCharacteristic,M=h.forceAverage,O=!!g||!!M||h.average,Y=g?-1:O&&L.mantissa===void 0?0:h.mantissa,W=!g&&(L.optionalMantissa===void 0?Y===-1:h.optionalMantissa),q=h.trimMantissa,Z=h.thousandSeparated,K=h.spaceSeparated,ce=h.negative,Ae=h.forceSign,Te=h.exponential,_e="";if(O){var G=function(C){var S=C.value,A=C.forceAverage,F=C.abbreviations,P=C.spaceSeparated,k=P!==void 0&&P,H=C.totalLength,D=H===void 0?0:H,V="",$=Math.abs(S),U=-1;if($>=Math.pow(10,12)&&!A||A==="trillion"?(V=F.trillion,S/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!A||A==="billion"?(V=F.billion,S/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!A||A==="million"?(V=F.million,S/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!A||A==="thousand")&&(V=F.thousand,S/=Math.pow(10,3)),V&&(V=(k?" ":"")+V),D){var re=S.toString().split(".")[0];U=Math.max(D-re.length,0)}return{value:S,abbreviation:V,mantissaPrecision:U}}({value:X,forceAverage:M,abbreviations:B.currentAbbreviations(),spaceSeparated:K,totalLength:g});X=G.value,_e+=G.abbreviation,g&&(Y=G.mantissaPrecision)}if(Te){var Ge=(oe=(ie={value:X,characteristicPrecision:p}).value,se=ie.characteristicPrecision,pe=se===void 0?0:se,Me=o(oe.toExponential().split("e"),2),Je=Me[0],Pe=Me[1],R=+Je,pe&&1<pe&&(R*=Math.pow(10,pe-1),Pe=0<=(Pe=+Pe-(pe-1))?"+".concat(Pe):Pe),{value:R,abbreviation:"e".concat(Pe)});X=Ge.value,_e=Ge.abbreviation+_e}var We,ye,xe,Se=function(C,S,A,F,P){if(F===-1)return C;var k=v(S,F),H=o(k.toString().split("."),2),D=H[0],V=H[1],$=V===void 0?"":V;if($.match(/^0+$/)&&(A||P))return D;var U=$.match(/0+$/);return P&&U?"".concat(D,".").concat($.toString().slice(0,U.index)):k.toString()}(X.toString(),X,W,Y,q);return Se=function(C,S,A,F,P){var k=F.currentDelimiters(),H=k.thousands;P=P||k.decimal;var D=k.thousandsSize||3,V=C.toString(),$=V.split(".")[0],U=V.split(".")[1];return A&&(S<0&&($=$.slice(1)),function(re,he){for(var Ce=[],Oe=0,ke=re;0<ke;ke--)Oe===he&&(Ce.unshift(ke),Oe=0),Oe++;return Ce}($.length,D).forEach(function(re,he){$=$.slice(0,re+he)+H+$.slice(re+he)}),S<0&&($="-".concat($))),V=U?$+P+U:$}(Se=function(C,S,A,F){var P=C,k=o(P.toString().split("."),2),H=k[0],D=k[1];if(H.match(/^-?0$/)&&A)return D?"".concat(H.replace("0",""),".").concat(D):H.replace("0","");if(H.length<F)for(var V=F-H.length,$=0;$<V;$++)P="0".concat(P);return P.toString()}(Se,0,E,p),X,Z,B,z),(O||Te)&&(Se=Se+_e),(Ae||X<0)&&(We=Se,xe=ce,Se=(ye=X)===0?We:+We==0?We.replace("-",""):0<ye?"+".concat(We):xe==="sign"?We:"(".concat(We.replace("-",""),")")),Se}function b(_,I){if(!_)return I;var L=Object.keys(_);return L.length===1&&L[0]==="output"?I:_}r.exports=function(_){return{format:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return f.apply(void 0,L.concat([_]))},getByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(B){var z=c.general;return m(B._value,z.suffixes,z.scale).suffix}).apply(void 0,L.concat([_]))},getBinaryByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(B){var z=c.binary;return m(B._value,z.suffixes,z.scale).suffix}).apply(void 0,L.concat([_]))},getDecimalByteUnit:function(){for(var I=arguments.length,L=new Array(I),x=0;x<I;x++)L[x]=arguments[x];return(function(B){var z=c.decimal;return m(B._value,z.suffixes,z.scale).suffix}).apply(void 0,L.concat([_]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},d=null,f={};function m(v){u=v}function w(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return w().currency},l.currentAbbreviations=function(){return w().abbreviations},l.currentDelimiters=function(){return w().delimiters},l.currentOrdinal=function(){return w().ordinal},l.currentDefaults=function(){return Object.assign({},w().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().timeFormat)},l.setDefaults=function(v){v=a.parseFormat(v),s.validateFormat(v)&&(f=v)},l.getZeroFormat=function(){return d},l.setZeroFormat=function(v){return d=typeof v=="string"?v:null},l.hasZeroFormat=function(){return d!==null},l.languageData=function(v){if(v){if(c[v])return c[v];throw new Error('Unknown tag "'.concat(v,'"'))}return w()},l.registerLanguage=function(v){var y=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(v))throw new Error("Invalid language data");c[v.languageTag]=v,y&&m(v.languageTag)},l.setLanguage=function(v){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[v]){var b=v.split("-")[0],_=Object.keys(c).find(function(I){return I.split("-")[0]===b});return c[_]?void m(_):void m(y)}m(v)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),d=l;return u.isNumbro(l)&&(d=l._value),d=new o(d),a._value=c.minus(d).toNumber(),a}r.exports=function(a){return{add:function(l,u){return d=u,f=a,m=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=m.plus(w).toNumber(),c;var c,d,f,m,w},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return d=u,f=a,m=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=m.times(w).toNumber(),c;var c,d,f,m,w},divide:function(l,u){return d=u,f=a,m=new o((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new o(w),c._value=m.dividedBy(w).toNumber(),c;var c,d,f,m,w},set:function(l,u){return c=l,f=d=u,a.isNumbro(d)&&(f=d._value),c._value=f,c;var c,d,f},difference:function(l,u){return c=u,s(f=(d=a)(l._value),c,d),Math.abs(f._value);var c,d,f}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(y,b){for(var _=0;_<b.length;_++){var I=b[_];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(y,I.key,I)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(v),u=n("./unformatting"),c=n("./formatting")(v),d=n("./manipulating")(v),f=n("./parsing"),m=function(){function y(I){(function(L,x){if(!(L instanceof x))throw new TypeError("Cannot call a class as a function")})(this,y),this._value=I}var b,_;return b=y,(_=[{key:"clone",value:function(){return v(this._value)}},{key:"format",value:function(){var I=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,I)}},{key:"formatCurrency",value:function(I){return typeof I=="string"&&(I=f.parseFormat(I)),(I=c.formatOrDefault(I,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,I)}},{key:"formatTime",value:function(){var I=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return I.output="time",c.format(this,I)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(I){return d.difference(this,I)}},{key:"add",value:function(I){return d.add(this,I)}},{key:"subtract",value:function(I){return d.subtract(this,I)}},{key:"multiply",value:function(I){return d.multiply(this,I)}},{key:"divide",value:function(I){return d.divide(this,I)}},{key:"set",value:function(I){return d.set(this,w(I))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(b.prototype,_),y}();function w(y){var b=y;return v.isNumbro(y)?b=y._value:typeof y=="string"?b=v.unformat(y):isNaN(y)&&(b=NaN),b}function v(y){return new m(w(y))}v.version="2.1.2",v.isNumbro=function(y){return y instanceof m},v.language=s.currentLanguage,v.registerLanguage=s.registerLanguage,v.setLanguage=s.setLanguage,v.languages=s.languages,v.languageData=s.languageData,v.zeroFormat=s.setZeroFormat,v.defaultFormat=s.currentDefaults,v.setDefaults=s.setDefaults,v.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,v.validate=a.validate,v.loadLanguagesInNode=l.loadLanguagesInNode,v.unformat=u.unformat,r.exports=v},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,d,f,m,w,v,y,b,_,I,L,x,B,z,ee,j,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=X,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=X,function(ie,oe){if(ie.indexOf("$")===-1){if(ie.indexOf("%")===-1)return ie.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):ie.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):ie.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):ie.indexOf(":")===-1?ie.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(o=(d=(u=o).match(/{([^}]*)}$/))?(c.postfix=d[1],u.slice(0,-d[0].length)):u,X),f=X,(m=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+m[0]),w=X,(v=o.split(".")[0].match(/0+/))&&(w.characteristic=v[0].length),function(ie,oe){if(ie.indexOf(".")!==-1){var se=ie.split(".")[0];oe.optionalCharacteristic=se.indexOf("0")===-1}}(o,X),y=X,o.indexOf("a")!==-1&&(y.average=!0),_=X,(b=o).indexOf("K")!==-1?_.forceAverage="thousand":b.indexOf("M")!==-1?_.forceAverage="million":b.indexOf("B")!==-1?_.forceAverage="billion":b.indexOf("T")!==-1&&(_.forceAverage="trillion"),function(ie,oe){var se=ie.split(".")[1];if(se){var pe=se.match(/0+/);pe&&(oe.mantissa=pe[0].length)}}(o,X),L=X,(I=o).match(/\[\.]/)?L.optionalMantissa=!0:I.match(/\./)&&(L.optionalMantissa=!1),x=X,o.indexOf(",")!==-1&&(x.thousandSeparated=!0),B=X,o.indexOf(" ")!==-1&&(B.spaceSeparated=!0),ee=X,(z=o).match(/^\+?\([^)]*\)$/)&&(ee.negative="parenthesis"),z.match(/^\+?-/)&&(ee.negative="sign"),j=X,o.match(/^\+/)&&(j.forceSign=!0),X)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,m=5<arguments.length?arguments[5]:void 0,w=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function v(y,b){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",I=3<arguments.length?arguments[3]:void 0,L=4<arguments.length?arguments[4]:void 0,x=5<arguments.length?arguments[5]:void 0,B=6<arguments.length?arguments[6]:void 0;if(!isNaN(+y))return+y;var z="",ee=y.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ee!==y)return-1*v(ee,b,_,I,L,x,B);for(var j=0;j<o.length;j++){var X=o[j];if((z=y.replace(X.key,""))!==y)return v(z,b,_,I,L,x,B)*X.factor}if((z=y.replace("%",""))!==y)return v(z,b,_,I,L,x,B)/100;var ie=parseFloat(y);if(!isNaN(ie)){var oe=I(ie);if(oe&&oe!=="."&&(z=y.replace(new RegExp("".concat(s(oe),"$")),""))!==y)return v(z,b,_,I,L,x,B);var se={};Object.keys(x).forEach(function(g){se[x[g]]=g});for(var pe=Object.keys(se).sort().reverse(),Me=pe.length,Je=0;Je<Me;Je++){var Pe=pe[Je],R=se[Pe];if((z=y.replace(Pe,""))!==y){var h=void 0;switch(R){case"thousand":h=Math.pow(10,3);break;case"million":h=Math.pow(10,6);break;case"billion":h=Math.pow(10,9);break;case"trillion":h=Math.pow(10,12)}return v(z,b,_,I,L,x,B)*h}}}}(function(v,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=v.replace(b,"");return _=(_=_.replace(new RegExp("([0-9])".concat(s(y.thousands),"([0-9])"),"g"),"$1$2")).replace(y.decimal,".")}(l,u,c),u,c,d,f,m,w)}r.exports={unformat:function(l,u){var c,d,f,m=n("./globalState"),w=m.currentDelimiters(),v=m.currentCurrency().symbol,y=m.currentOrdinal(),b=m.getZeroFormat(),_=m.currentAbbreviations(),I=void 0;if(typeof l=="string")I=function(L,x){if(!L.indexOf(":")||x.thousands===":")return!1;var B=L.split(":");if(B.length!==3)return!1;var z=+B[0],ee=+B[1],j=+B[2];return!isNaN(z)&&!isNaN(ee)&&!isNaN(j)}(l,w)?(c=l.split(":"),d=+c[0],f=+c[1],+c[2]+60*f+3600*d):a(l,w,v,y,b,_,u);else{if(typeof l!="number")return;I=l}if(I!==void 0)return I}}},{"./globalState":4}],10:[function(n,r,i){function o(w){return function(v){if(Array.isArray(v)){for(var y=0,b=new Array(v.length);y<v.length;y++)b[y]=v[y];return b}}(w)||function(v){if(Symbol.iterator in Object(v)||Object.prototype.toString.call(v)==="[object Arguments]")return Array.from(v)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(w){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(w)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(w,v){return v.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(w){return w.output==="byte"}},characteristic:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(w){return 0<=w},message:"value must be positive"},{restriction:function(w,v){return!v.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(w,v){return v.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(w){return w.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(w){return!!a.unformat(w)}function f(w,v,y){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],_=Object.keys(w).map(function(I){if(!v[I])return console.error("".concat(y," Invalid key: ").concat(I)),!1;var L=w[I],x=v[I];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!f(L,u,"[Validate ".concat(I,"]"),!0))return!1}else if(s(L)!==x.type)return console.error("".concat(y," ").concat(I,' type mismatched: "').concat(x.type,'" expected, "').concat(s(L),'" provided')),!1;if(x.restrictions&&x.restrictions.length)for(var B=x.restrictions.length,z=0;z<B;z++){var ee=x.restrictions[z],j=ee.restriction,X=ee.message;if(!j(L,w))return console.error("".concat(y," ").concat(I," invalid value: ").concat(X)),!1}return x.restriction&&!x.restriction(L,w)?(console.error("".concat(y," ").concat(I," invalid value: ").concat(x.message)),!1):x.validValues&&x.validValues.indexOf(L)===-1?(console.error("".concat(y," ").concat(I," invalid value: must be among ").concat(JSON.stringify(x.validValues),', "').concat(L,'" provided')),!1):!(x.children&&!f(L,x.children,"[Validate ".concat(I,"]")))});return b||_.push.apply(_,o(Object.keys(v).map(function(I){var L=v[I];if(typeof L=="string"&&(L={type:L}),L.mandatory){var x=L.mandatory;if(typeof x=="function"&&(x=x(w)),x&&w[I]===void 0)return console.error("".concat(y,' Missing mandatory key "').concat(I,'"')),!1}return!0}))),_.reduce(function(I,L){return I&&L},!0)}function m(w){return f(w,u,"[Validate format]")}r.exports={validate:function(w,v){var y=d(w),b=m(v);return y&&b},validateFormat:m,validateInput:d,validateLanguage:function(w){return f(w,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(fx);var I5=fx.exports;const rs=tA(I5),P5="numeric";function xy(t,e,n,r,i,o,s){let a=o;if(Ln(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,d=s.className||"",f=d.length?d.split(" "):[];if(typeof u<"u"&&!rs.languages()[u]){const m=u.replace("-",""),w=rs.allLanguages?rs.allLanguages[u]:rs[m];w&&rs.registerLanguage(w)}rs.setLanguage(u),a=rs(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}so(t,e,n,r,i,a,s)}xy.RENDERER_TYPE=P5;const x5="numeric";function Hy(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Ln(t))}Hy.VALIDATOR_TYPE=x5;const H5="numeric",gx={CELL_TYPE:H5,editor:dx,renderer:xy,validator:Hy,dataType:"number"},D5="password";class mx extends qs{static get EDITOR_TYPE(){return D5}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Vr(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const N5="password";function Dy(t,e,n,r,i,o,s){so.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";me(a-1,()=>{u+=l}),Ks(e,u)}Dy.RENDERER_TYPE=N5;const L5="password",$5={CELL_TYPE:L5,editor:mx,renderer:Dy,copyable:!1},Hp="ht_editor_visible",k0="selectEditor",k5="select";class px extends hl{static get EDITOR_TYPE(){return k5}init(){this.select=this.hot.rootDocument.createElement("SELECT"),J(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Ie(this.select,Hp)&&De(this.select,Hp),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Vr(this.select),Ue(l,(u,c)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=c,Ks(d,u),this.select.appendChild(d)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Kt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",J(this.select,Hp)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:k0};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(k0)}}const F5="select";function wx(t,e,n,r,i,o,s){so.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,...al("listbox"))}wx.RENDERER_TYPE=F5;const W5="select",V5={CELL_TYPE:W5,editor:px,renderer:wx},B5="time";class Cx extends qs{static get EDITOR_TYPE(){return B5}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}const U5="time";function Ny(t,e,n,r,i,o,s){so.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}Ny.RENDERER_TYPE=U5;const Y5=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],z5="time";function Ly(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=Q(i,Y5,!0).isValid()?Q(i):Q(i,n);let a=s.isValid(),l=Q(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,d,u,"timeValidator"),r=!0}else r=!1;e(r)}Ly.VALIDATOR_TYPE=z5;const G5="time",j5={CELL_TYPE:G5,editor:Cx,renderer:Ny,validator:Ly};function K5(){Cn(i5),Cn(rx),Cn(ux),Cn(cx),Cn(A5),Cn(gx),Cn($5),Cn(V5),Cn(ZP),Cn(j5)}function X5(t,e){vx(t,e),e.add(t)}function q5(t,e,n){vx(t,e),e.set(t,n)}function vx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aa(t,e,n){return e=Z5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z5(t){var e=Q5(t,"string");return typeof e=="symbol"?e:String(e)}function Q5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function J5(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function la(t,e){var n=e8(t,e,"get");return t8(t,n)}function e8(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function t8(t,e){return e.get?e.get.call(t):e.value}const F0=new Map([["plugin",zz],["cell-type",VP],["editor",MI],["renderer",kI],["validator",FI]]),n8="base",Dp=[];let qr=null;var is=new WeakMap,W0=new WeakSet;class nt{static get PLUGIN_KEY(){return n8}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){X5(this,W0),aa(this,"eventManager",new or(this)),aa(this,"pluginName",null),aa(this,"pluginsInitializedCallbacks",[]),aa(this,"isPluginsReady",!1),aa(this,"enabled",!1),aa(this,"initialized",!1),q5(this,is,{writable:!0,value:{}}),pi(this,"hot",e,{writable:!1}),qr=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!F0.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);F0.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Dp.push(o)}}if(qr||(qr=_S()),qr.indexOf("UndoRedo")>=0&&qr.splice(qr.indexOf("UndoRedo"),1),qr.indexOf(this.pluginName)>=0&&qr.splice(qr.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),qr.length===0){if(Dp.length>0){const i=[`${Dp.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){la(this,is)[e]=la(this,is)[e]||[];const r=la(this,is)[e];this.hot.addHook(e,n),r.push(n),la(this,is)[e]=r}removeHooks(e){T(la(this,is)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=la(this,is);Ue(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){T(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=J5(this,W0,r8).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ue(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function r8(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function os(t,e,n){return e=i8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i8(t){var e=o8(t,"string");return typeof e=="symbol"?e:String(e)}function o8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let s8=class{constructor(e){os(this,"hot",null),os(this,"container",null),os(this,"injected",!1),os(this,"rows",[]),os(this,"columns",[]),os(this,"samples",null),os(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),T(this.rows,n=>{e(n.row,Ot(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),T(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{T(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{T(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{T(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),T(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{T(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),J(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return J(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const $y=s8;function ih(t,e,n){return e=a8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a8(t){var e=l8(t,"string");return typeof e=="symbol"?e:String(e)}function l8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ky{static get SAMPLE_COUNT(){return 3}constructor(e){ih(this,"samples",null),ih(this,"dataFactory",null),ih(this,"customSampleCount",null),ih(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:ky.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return me(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return me(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,d=typeof c=="string"&&c.length>0;let f;d?f=c:Fe(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Nt(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const m=i.get(f);m.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||d)&&(m.strings.push({value:u,[o]:a}),s.push(u),m.needed-=1)}),i}}const Sx=ky;function ua(t,e){yx(t,e),e.add(t)}function u8(t,e,n){yx(t,e),e.set(t,n)}function yx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ca(t,e,n){return e=c8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c8(t){var e=h8(t,"string");return typeof e=="symbol"?e:String(e)}function h8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d8(t,e,n){var r=bx(t,e,"set");return f8(t,r,n),n}function f8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function oh(t,e){var n=bx(t,e,"get");return g8(t,n)}function bx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function g8(t,e){return e.get?e.get.call(t):e.value}function ss(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("modifyAutoColumnSizeSeed");const Pl="autoColumnSize",m8=10,p8="autoColumnSize";var $a=new WeakMap,V0=new WeakSet,B0=new WeakSet,U0=new WeakSet,Np=new WeakSet,Y0=new WeakSet,z0=new WeakSet;class Xa extends nt{static get PLUGIN_KEY(){return Pl}static get PLUGIN_PRIORITY(){return m8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),ua(this,z0),ua(this,Y0),ua(this,Np),ua(this,U0),ua(this,B0),ua(this,V0),ca(this,"ghostTable",new $y(this.hot)),ca(this,"samplesGenerator",new Sx((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),ca(this,"firstCalculation",!0),ca(this,"inProgress",!1),ca(this,"measuredColumns",0),ca(this,"columnWidthsMap",new zo),u8(this,$a,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(p8,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>ss(this,Np,G0).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Pl]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Pl];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ss(e,B0,C8).call(e,...i)}),this.addHook("beforeChangeRender",r=>ss(this,U0,v8).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>ss(this,z0,y8).call(this,r)),this.addHook("beforeViewRender",r=>ss(this,V0,w8).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>ss(this,Y0,S8).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>ss(this,Np,G0).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;me(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);T(l,u=>{let[c,d]=u;return this.ghostTable.addColumn(c,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Lu(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Xa.CALCULATION_STEP,r)},e),n=n+Xa.CALCULATION_STEP+1,n<r?i=Lf(o):(Lu(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Pl],n=e&&At(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&At(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Pl];let n=Xa.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Fe(e)&&(n=e.syncLimit,aS(n)?n=ES(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,OS.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Ft(e,(r,i,o)=>{const s=oh(this,$a).length;return(s-1<o||oh(this,$a)[o]!==i)&&r.push(o),s-1<o?oh(this,$a).push(i):oh(this,$a)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{T(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!ir(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function w8(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function C8(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function v8(t){const e=Be(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function G0(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function S8(){d8(this,$a,this.hot.getColHeader())}function y8(t){const e=ir(t,r=>{var i;return ue((i=r.address)===null||i===void 0?void 0:i.col)}),n=Be(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const Ps={horizontal:"horizontal",vertical:"vertical"};function b8(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function R8(t){const e={};return t===!0?(e.directions=Object.keys(Ps),e.autoInsertRow=!0):Fe(t)?(ue(t.autoInsertRow)?t.direction===Ps.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ps)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function xl(t,e){E8(t,e),e.add(t)}function E8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ha(t,e,n){return e=T8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T8(t){var e=_8(t,"string");return typeof e=="symbol"?e:String(e)}function _8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("modifyAutofillRange");de.getSingleton().register("beforeAutofill");de.getSingleton().register("afterAutofill");const j0="autofill",M8=20,A8=["fillHandle"],O8="insert_row_below",I8=200;var K0=new WeakSet,X0=new WeakSet,q0=new WeakSet,Z0=new WeakSet,Q0=new WeakSet;class P8 extends nt{constructor(){super(...arguments),xl(this,Q0),xl(this,Z0),xl(this,q0),xl(this,X0),xl(this,K0),ha(this,"addingStarted",!1),ha(this,"mouseDownOnCellCorner",!1),ha(this,"mouseDragOutside",!1),ha(this,"handleDraggedCells",0),ha(this,"directions",[]),ha(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return j0}static get PLUGIN_PRIORITY(){return M8}static get SETTING_KEYS(){return[j0,...A8]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Hl(this,X0,H8).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Hl(this,K0,x8).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Hl(this,q0,D8).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return T(s,c=>{for(let d=c.startRow;d<=c.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=c.startCol;d<=c.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),T(a,c=>{const d=[];T(l,f=>{d.push(this.hot.getCopyableData(c,f))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:d,endOfDragCoords:f}=b8(l,u,(m,w)=>this.hot._createCellCoords(m,w));if(d&&d.row>-1&&d.col>-1){const m=this.getSelectionData(),w=o.clone(),v=this.hot._createCellRange(d,d,f),y=this.hot.runHooks("beforeAutofill",m,w,v,c);if(y===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=y;const _=y;if(["up","left"].indexOf(c)>-1&&!(_.length===1&&_[0].length===0))if(b=[],c==="up"){const I=f.row-d.row+1,L=I%_.length;for(let x=0;x<I;x++)b.push(_[(x+(_.length-L))%_.length])}else{const I=f.col-d.col+1,L=I%_[0].length;for(let x=0;x<_.length;x++){b.push([]);for(let B=0;B<I;B++)b[x].push(_[x][(B+(_[x].length-L))%_[x].length])}}this.hot.populateFromArray(d.row,d.col,b,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",b,w,v,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Ps.vertical)&&this.directions.includes(Ps.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Ps.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Ps.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(O8,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},I8)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Be(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Bt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Ot(this.hot.table),i=Bt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ut(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Hl(this,Z0,N8).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Hl(this,Q0,L8).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=R8(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function x8(){this.selectAdjacent()&&this.fillIn()}function H8(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function D8(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function N8(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function L8(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function sh(t,e){$8(t,e),e.add(t)}function $8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function as(t,e,n){return e=k8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k8(t){var e=F8(t,"string");return typeof e=="symbol"?e:String(e)}function F8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ah="autoRowSize",W8=40,V8="autoRowSize";var J0=new WeakSet,Lp=new WeakSet,eE=new WeakSet,tE=new WeakSet;class wu extends nt{static get PLUGIN_KEY(){return ah}static get PLUGIN_PRIORITY(){return W8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),sh(this,tE),sh(this,eE),sh(this,Lp),sh(this,J0),as(this,"headerHeight",null),as(this,"ghostTable",new $y(this.hot)),as(this,"samplesGenerator",new Sx((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),as(this,"firstCalculation",!0),as(this,"inProgress",!1),as(this,"measuredRows",0),as(this,"rowHeightsMap",new zo),this.hot.rowIndexMapper.registerMap(V8,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Dl(this,Lp,nE).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[ah];return e===!0||Fe(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dl(e,eE,U8).call(e,...r)}),this.addHook("beforeChangeRender",n=>Dl(this,tE,Y8).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Dl(this,J0,B8).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Dl(this,Lp,nE).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}me(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);T(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Lu(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+wu.CALCULATION_STEP,r)},e),n=n+wu.CALCULATION_STEP+1,n<r?i=Lf(o):(Lu(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[ah],n=e&&At(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&At(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Fo(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[ah];let n=wu.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Fe(e)&&(n=e.syncLimit,aS(n)?n=ES(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!ir(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function B8(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function nE(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function U8(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function Y8(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:z8,getListWithRemovedItems:G8}=SP("physicallyIndexed");class j8 extends Xs{constructor(){super(e=>e)}insert(e,n){const r=ty(this.indexedValues,n);this.indexedValues=z8(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=G8(this.indexedValues,e);this.indexedValues=ey(n,e),super.remove(e)}}const K8=j8,{getListWithInsertedItems:X8,getListWithRemovedItems:q8}=SP("physicallyIndexed");class Z8 extends Xs{constructor(){super(e=>e)}insert(e,n){this.indexedValues=X8(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=q8(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const Q8=Z8;function J8(t,e){e7(t,e),e.add(t)}function e7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t7(t,e,n){return e=n7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n7(t){var e=r7(t,"string");return typeof e=="symbol"?e:String(e)}function r7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const $p="bindRowsWithHeaders",o7=210,s7="loose",a7=new Map([["loose",K8],["strict",Q8]]);var rE=new WeakSet;class l7 extends nt{constructor(){super(...arguments),J8(this,rE),t7(this,"headerIndexes",null)}static get PLUGIN_KEY(){return $p}static get PLUGIN_PRIORITY(){return o7}isEnabled(){return!!this.hot.getSettings()[$p]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[$p];typeof e!="string"&&(e=s7);const n=a7.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>i7(this,rE,u7).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function u7(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function lh(t,e){Rx(t,e),e.add(t)}function c7(t,e,n){Rx(t,e),e.set(t,n)}function Rx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iE(t,e,n){return e=h7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h7(t){var e=d7(t,"string");return typeof e=="symbol"?e:String(e)}function d7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function oE(t,e){var n=Ex(t,e,"get");return f7(t,n)}function f7(t,e){return e.get?e.get.call(t):e.value}function uh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function kp(t,e,n){var r=Ex(t,e,"set");return g7(t,r,n),n}function Ex(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function g7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const id="collapsibleColumns",m7=290,p7=["nestedHeaders"],qa="collapsibleIndicator",sE=id,aE=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var da=new WeakMap,lE=new WeakSet,uE=new WeakSet,cE=new WeakSet,hE=new WeakSet;class w7 extends nt{constructor(){super(...arguments),lh(this,hE),lh(this,cE),lh(this,uE),lh(this,lE),iE(this,"nestedHeadersPlugin",null),iE(this,"headerStateManager",null),c7(this,da,{writable:!0,value:null})}static get PLUGIN_KEY(){return id}static get PLUGIN_PRIORITY(){return m7}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[id,...p7]}isEnabled(){return!!this.hot.getSettings()[id]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||pt("You need to configure the Nested Headers plugin in order to use collapsible headers."),kp(this,da,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>uh(this,cE,S7).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return uh(e,hE,y7).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return uh(e,lE,C7).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>uh(this,uE,v7).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),kp(this,da,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:sE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sE)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};me(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;me(0,a.childNodes.length-1,c=>{let d=a.childNodes[c].querySelector(`.${qa}`);o(d),l&&l.childNodes[c]&&(d=l.childNodes[c].querySelector(`.${qa}`),o(d)),i&&u&&u.childNodes[c]&&(d=u.childNodes[c].querySelector(`.${qa}`),o(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!aE.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=ir(e,f=>{let{row:m}=f;return m<0});let i=r.length>0;T(r,f=>{var m;let{row:w,col:v}=f;const{collapsible:y,isCollapsed:b}=(m=this.headerStateManager.getHeaderSettings(w,v))!==null&&m!==void 0?m:{};if(!y||b&&n==="collapse"||!b&&n==="expand")return i=!1,!1});const o=[],s=[];i&&T(r,f=>{let{row:m,col:w}=f;const{colspanCompensation:v,affectedColumns:y,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,m,w);v>0&&(s.push(...y),o.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=oS([...a,...s]):n==="expand"&&(l=ir(a,f=>!s.includes(f)));const u=aE.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){T(o,f=>{f()});return}this.hot.batchExecution(()=>{T(s,f=>{oE(this,da).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return oE(this,da).getHiddenIndexes()}destroy(){kp(this,da,null),super.destroy()}}function C7(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${qa}`);if(Yo(e,[sn("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),J(u,qa),e.querySelector("div:first-child").appendChild(u)),De(u,["collapsed","expanded"]),s?(J(u,"collapsed"),ko(u,"+"),l&&ve(e,[sn(!1),Pu(this.hot.getTranslatedPhrase(uy))])):(J(u,"expanded"),ko(u,"-"),l&&ve(e,[sn(!0),Pu(this.hot.getTranslatedPhrase(cy))])),l&&ve(u,...no());else{var c;(c=u)===null||c===void 0||c.remove()}}function v7(t,e){Ie(t.target,qa)&&(Ie(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ie(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Sr(t))}function S7(){this.updatePlugin()}function y7(t,e){e||this.updatePlugin()}function ls(t,e,n){return e=b7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b7(t){var e=R7(t,"string");return typeof e=="symbol"?e:String(e)}function R7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const E7=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],T7=!1,_7=!0,M7=!0;class A7{constructor(e,n){ls(this,"hot",void 0),ls(this,"sortingStates",new Ff),ls(this,"sortEmptyCells",T7),ls(this,"indicator",_7),ls(this,"headerAction",M7),ls(this,"compareFunctionFactory",void 0),ls(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Fe(e)&&Ue(e,(n,r)=>{E7.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Fe(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ue(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Vd="asc",Bd="desc",O7="colHeader";function I7(t){if(Fe(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Vd,Bd].includes(n)}function P7(t){if(t.some(n=>I7(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function dE(t){if(t!==Bd)return t===Vd?Bd:Vd}function Tx(t){return t.querySelector(`.${O7}`)}function _x(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function Fy(t,e,n){return t===-1&&e>=0&&Wo(n)===!1}const x7="ascending",H7="descending",Mx="indicatorDisabled",Ax="columnSorting",Ox="sortAction",Ix=new Map([[Vd,x7],[Bd,H7]]);function D7(t,e,n,r){const i=[Ax];if(r&&i.push(Ox),n===!1)return i.push(Mx),i;const o=t.getSortOrderOfColumn(e);return ue(o)&&i.push(Ix.get(o)),i}function N7(){return Array.from(Ix.values()).concat(Ox,Mx,Ax)}function Px(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?ci:Xt(i)?Xt(o)?ci:s&&t==="asc"?Ht:Dt:Xt(o)?s&&t==="asc"?Dt:Ht:isNaN(i)&&!isNaN(o)?t==="asc"?Dt:Ht:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Ht:Dt:i>o?t==="asc"?Dt:Ht:ci}}const xx="default";function L7(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return ci;if(a){if(Xt(r))return t==="asc"?Ht:Dt;if(Xt(i))return t==="asc"?Dt:Ht}return isNaN(o)?Dt:isNaN(s)?Ht:o<s?t==="asc"?Ht:Dt:o>s?t==="asc"?Dt:Ht:ci}}const $7="numeric";function k7(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Xt(s),u=Xt(a),c=l?i:s,d=u?i:a,f=c===i||c===r,m=d===i||d===r;if(o===!1){if(l&&u===!1)return Dt;if(l===!1&&u)return Ht}return f===!1&&m?t==="asc"?Ht:Dt:f&&m===!1?t==="asc"?Dt:Ht:f===!1&&m===!1?Px(t,e,n)(s,a):c===i&&d===r?t==="asc"?Ht:Dt:c===r&&d===i?t==="asc"?Dt:Ht:ci}}const F7="checkbox";function W7(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return ci;if(Xt(r))return Xt(i)?ci:o&&t==="asc"?Ht:Dt;if(Xt(i))return o&&t==="asc"?Dt:Ht;const s=e.dateFormat,a=Q(r,s),l=Q(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?Ht:Dt:l.isBefore(a)?t==="asc"?Dt:Ht:ci:Ht:Dt}}const V7="date",{register:sm,getItem:fE,hasItem:B7}=Ur("sorting.compareFunctionFactory"),{register:Hx,getItem:U7}=Ur("sorting.mainSortComparator");function Dx(t){return B7(t)?fE(t):fE(xx)}sm($7,L7);sm(F7,k7);sm(V7,W7);sm(xx,Px);const ci=0,Ht=-1,Dt=1;function Y7(t,e){const n=U7(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function z7(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],d=o[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:Dx(u.type))(l,u,f)(c,d)}(0)}}function ch(t,e){G7(t,e),e.add(t)}function G7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hh(t,e,n){return e=j7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j7(t){var e=K7(t,"string");return typeof e=="symbol"?e:String(e)}function K7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ka(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Ud="columnSorting",X7=50,Yd="append",q7="replace",gE=Ud,mE="columnSortingIndicator";Hx(Ud,z7);de.getSingleton().register("beforeColumnSort");de.getSingleton().register("afterColumnSort");var od=new WeakSet,pE=new WeakSet,wE=new WeakSet,CE=new WeakSet;class Nx extends nt{constructor(){super(...arguments),ch(this,CE),ch(this,wE),ch(this,pE),ch(this,od),hh(this,"columnStatesManager",null),hh(this,"columnMetaCache",null),hh(this,"pluginKey",Ud),hh(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Ud}static get PLUGIN_PRIORITY(){return X7}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new A7(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new zo(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>ka(this,pE,Z7).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ka(e,CE,J7).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>ka(this,od,JC).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ka(e,wE,Q7).call(e,...r)}),this.hot.view&&ka(this,od,JC).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=Tx(r);_x(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:gE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gE)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new yP),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return P7(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Be(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ue(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Be(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ue(n)){const i=dE(n);return ue(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:dE()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yd;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(mt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Yd)return[...o.slice(0,r),...o.slice(r+1),s];if(n===q7)return[...o.slice(0,r),s,...o.slice(r+1)]}return ue(s)?o.concat(s):o}getPluginColumnConfig(e){if(Fe(e)){const n=e[this.pluginKey];if(Fe(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):gt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Be(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Be(n,u=>u[0]);Y7(n,this.pluginKey,Be(e,u=>u.sortOrder),Be(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Be(n,u=>u[0]),a=new Map(Be(o,(u,c)=>[u,s[c]])),l=Be(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Fe(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Fe(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(De(e,N7()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];J(e,D7(...r))}}updateSortingIndicator(e,n){const r=this.getFirstCellSettings(e)[this.pluginKey],i=this.hot.getSettings().ariaTags,o=r.indicator,s=this.columnStatesManager.isColumnSorted(e),a=n.querySelector(`.${mE}`);o&&s&&!a&&ks(n,{tagName:"div",className:mE,attributes:i?[no()]:[]})}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onAfterOnCellMouseDown(e,n){Fy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function JC(){const t=this.getAllSavedSortSettings();if(Fe(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Z7(t,e){const n=Tx(e);if(_x(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=this.hot.getSettings().ariaTags,o=r.indicator,s=r.headerAction,a=this.columnStatesManager.getSortOrderOfColumn(t);this.updateHeaderClasses(n,this.columnStatesManager,t,o,s),this.updateSortingIndicator(t,n),i&&ve(e,[mY(a?`${a}ending`:"none"),Pu(this.hot.getTranslatedPhrase(hy))])}function Q7(t){t===!0&&this.hot.view&&ka(this,od,JC).call(this)}function J7(t,e,n,r){Fy(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function us(t,e,n){return e=eX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eX(t){var e=tX(t,"string");return typeof e=="symbol"?e:String(e)}function tX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nX{constructor(e,n){us(this,"plugin",void 0),us(this,"hot",void 0),us(this,"endpoints",[]),us(this,"settings",void 0),us(this,"settingsType","array"),us(this,"currentEndpoint",null),us(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),T(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();T(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,d=n;T(u,f=>{a==="row"&&f.destinationRow>=d&&(f.alterRowOffset=l*r),a==="col"&&f.destinationColumn>=d&&(f.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?T(u,f=>{this.extendEndpointRanges(f,d,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):T(u,f=>{this.shiftEndpointCoordinates(f,d)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){T(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];T(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),T(i,o=>{let s=[];T(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,T(e.ranges,r=>{T(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],T(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],T(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],T(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&T(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),T(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){pt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const rX=nX;function Fp(t){return t==null||isNaN(t)}function Wp(t,e){iX(t,e),e.add(t)}function iX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oX(t,e,n){return e=sX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sX(t){var e=aX(t,"string");return typeof e=="symbol"?e:String(e)}function aX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Bp="columnSummary",lX=220;var vE=new WeakSet,SE=new WeakSet,yE=new WeakSet;class uX extends nt{constructor(){super(...arguments),Wp(this,yE),Wp(this,SE),Wp(this,vE),oX(this,"endpoints",null)}static get PLUGIN_KEY(){return Bp}static get PLUGIN_PRIORITY(){return lX}isEnabled(){return!!this.hot.getSettings()[Bp]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Bp],this.endpoints=new rX(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vp(e,vE,cX).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vp(e,SE,hX).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Vp(e,yE,dX).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ue(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Fp(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ue(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Fp(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Fp(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ue(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ct`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function cX(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function hX(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function dX(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function fa(t,e,n){return e=fX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fX(t){var e=gX(t,"string");return typeof e=="symbol"?e:String(e)}function gX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class za{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){fa(this,"rootDocument",void 0),fa(this,"isRtl",!1),fa(this,"container",null),fa(this,"editor",void 0),fa(this,"editorStyle",void 0),fa(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ut(this.getInputElement()),height:Ot(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),J(this.container,za.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),J(e,za.CLASS_EDITOR),J(n,za.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${za.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const mX=za;function Up(t,e,n){return e=pX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pX(t){var e=wX(t,"string");return typeof e=="symbol"?e:String(e)}function wX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const CX=250,vX=250;class Lx{constructor(e){Up(this,"wasLastActionShow",!0),Up(this,"showDebounced",null),Up(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},vX)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:CX;this.showDebounced=pS(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}dt(Lx,Zn);const SX=Lx;function yX(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function bX(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function cs(t,e){const n={};return T(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function yo(t,e,n,r,i){T(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&RX(s,a,e,n,r,i)})})}function RX(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=yX(s.className,r):a=bX(s.className,r)),o(t,e,"className",a)}function Li(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function si(t,e){let n=!1;return Array.isArray(t)&&T(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function am(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const ze="---------";function EX(){return{name:ze}}const fr="alignment";function TX(){return{key:fr,name(){return this.getTranslatedPhrase(ag)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${fr}:left`,name(){let t=this.getTranslatedPhrase(lg);return si(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=Li(t)),t},callback(){const t=this.getSelectedRange(),e=cs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fr}:center`,name(){let t=this.getTranslatedPhrase(ug);return si(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=Li(t)),t},callback(){const t=this.getSelectedRange(),e=cs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fr}:right`,name(){let t=this.getTranslatedPhrase(cg);return si(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=Li(t)),t},callback(){const t=this.getSelectedRange(),e=cs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fr}:justify`,name(){let t=this.getTranslatedPhrase(hg);return si(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=Li(t)),t},callback(){const t=this.getSelectedRange(),e=cs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:ze},{key:`${fr}:top`,name(){let t=this.getTranslatedPhrase(dg);return si(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=Li(t)),t},callback(){const t=this.getSelectedRange(),e=cs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fr}:middle`,name(){let t=this.getTranslatedPhrase(fg);return si(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=Li(t)),t},callback(){const t=this.getSelectedRange(),e=cs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${fr}:bottom`,name(){let t=this.getTranslatedPhrase(gg);return si(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=Li(t)),t},callback(){const t=this.getSelectedRange(),e=cs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),yo(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const lm="clear_column";function _X(){return{key:lm,name(){return this.getTranslatedPhrase(qf)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const fc="col_left";function MX(){return{key:fc,name(){return this.getTranslatedPhrase(Uf)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const gc="col_right";function AX(){return{key:gc,name(){return this.getTranslatedPhrase(Yf)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const mc="make_read_only";function OX(){return{key:mc,name(){let t=this.getTranslatedPhrase(Xf);return si(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=Li(t)),t},callback(){const t=this.getSelectedRange(),e=si(t,(n,r)=>this.getCellMeta(n,r).readOnly);T(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const um="redo";function IX(){return{key:um,name(){return this.getTranslatedPhrase(Kf)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const pc="remove_col";function PX(){return{key:pc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Gf,e)},callback(){this.alter("remove_col",F4(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const cm="remove_row";function xX(){return{key:cm,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(zf,e)},callback(){this.alter("remove_row",W4(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const hm="row_above";function HX(){return{key:hm,name(){return this.getTranslatedPhrase(Vf)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const dm="row_below";function DX(){return{key:dm,name(){return this.getTranslatedPhrase(Bf)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Wu="no_items";function NX(){return{key:Wu,name(){return this.getTranslatedPhrase(Wf)},disabled:!0,isCommand:!1}}const fm="undo";function LX(){return{key:fm,name(){return this.getTranslatedPhrase(jf)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const $X=[hm,dm,fc,gc,lm,cm,pc,fm,um,mc,fr,ze,Wu],kX={[ze]:EX,[Wu]:NX,[hm]:HX,[dm]:DX,[fc]:MX,[gc]:AX,[lm]:_X,[cm]:xX,[pc]:PX,[fm]:LX,[um]:IX,[mc]:OX,[fr]:TX};function $x(){const t={};return Ue(kX,(e,n)=>{t[n]=e()}),t}function FX(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(ig):this.getTranslatedPhrase(rg)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function WX(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(og)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function VX(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(sg);return si(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,sd))?Li(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,sd);t.updateCommentMeta(n,r,{[sd]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Zr(t,e){kx(t,e),e.add(t)}function hs(t,e,n){kx(t,e),e.set(t,n)}function kx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BX(t,e,n){return e=UX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UX(t){var e=YX(t,"string");return typeof e=="symbol"?e:String(e)}function YX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ui(t,e,n){var r=Fx(t,e,"set");return zX(t,r,n),n}function zX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function qe(t,e){var n=Fx(t,e,"get");return GX(t,n)}function Fx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function GX(t,e){return e.get?e.get.call(t):e.value}const Cu="comments",jX=60,$i="comment",ou="value",Wx="style",sd="readOnly",dh=Cu,ev=`plugin:${Cu}`;var St=new WeakMap,Pr=new WeakMap,gm=new WeakMap,ad=new WeakMap,zd=new WeakMap,tv=new WeakMap,Gd=new WeakMap,bE=new WeakSet,RE=new WeakSet,EE=new WeakSet,TE=new WeakSet,_E=new WeakSet,ME=new WeakSet,AE=new WeakSet,OE=new WeakSet,IE=new WeakSet,PE=new WeakSet;class KX extends nt{constructor(){super(...arguments),Zr(this,PE),Zr(this,IE),Zr(this,OE),Zr(this,AE),Zr(this,ME),Zr(this,_E),Zr(this,TE),Zr(this,EE),Zr(this,RE),Zr(this,bE),BX(this,"range",{}),hs(this,St,{writable:!0,value:null}),hs(this,Pr,{writable:!0,value:null}),hs(this,gm,{writable:!0,value:!1}),hs(this,ad,{writable:!0,value:!1}),hs(this,zd,{writable:!0,value:{}}),hs(this,tv,{writable:!0,value:null}),hs(this,Gd,{writable:!0,value:""})}static get PLUGIN_KEY(){return Cu}static get PLUGIN_PRIORITY(){return jX}isEnabled(){return!!this.hot.getSettings()[Cu]}enablePlugin(){this.enabled||(qe(this,St)||Ui(this,St,new mX(this.hot.rootDocument,this.hot.isRtl())),qe(this,Pr)||Ui(this,Pr,new SX(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>Qr(this,TE,QX).call(this,e,s)),this.addHook("afterScroll",()=>Qr(this,PE,iq).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>Qr(this,IE,rq).call(this,e)),qe(this,Pr).addLocalHook("hide",()=>this.hide()),qe(this,Pr).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){qe(this,Pr).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(ev);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();Ui(this,ad,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(ev),this.hot._registerTimeout(()=>{Ui(this,ad,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!qe(this,St).isVisible()},group:dh}),r.addShortcut({keys:[["Escape"]],callback:()=>{qe(this,St).setValue(qe(this,Gd)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&qe(this,St).isVisible()},group:dh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&qe(this,St).isVisible()},group:dh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Qr(this,RE,qX).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Qr(this,bE,XX).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Qr(this,EE,ZX).call(this)),this.eventManager.addEventListener(n,"focus",()=>Qr(this,ME,eq).call(this)),this.eventManager.addEventListener(n,"blur",()=>Qr(this,_E,JX).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>Qr(this,AE,tq).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>Qr(this,OE,nq).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=$o(e.target,"TD","TBODY");return!!(n&&Ie(n,"htCommentCell")&&$o(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=qe(this,St).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[ou]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,$i),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,ou)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,ou)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return qe(this,Pr).cancelHiding(),qe(this,St).setValue((e=i[$i]?i[$i][ou]:null)!==null&&e!==void 0?e:""),qe(this,St).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){qe(this,St).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!qe(this,St).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;qe(this,St).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const d=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:m,view:{_wt:w}}=this.hot,{wtTable:v}=w,y=w.getCell({row:l,col:u},!0),b=this.getCommentMeta(s,a,Wx);b?qe(this,St).setSize(b.width,b.height):qe(this,St).resetSize();const _=f?0:v.getStretchedColumnWidth(u),I=c&&!d?Ot(y):0,{left:L,top:x,width:B,height:z}=y.getBoundingClientRect(),{width:ee,height:j}=qe(this,St).getSize(),{innerWidth:X,innerHeight:ie}=this.hot.rootWindow,oe=this.hot.rootDocument.documentElement;let se=L+m.scrollX+_,pe=x+m.scrollY+I;this.hot.isRtl()&&(se-=ee+_),this.hot.isLtr()&&L+B+ee>X?se=L+m.scrollX-ee-1:this.hot.isRtl()&&se<-(oe.scrollWidth-oe.clientWidth)&&(se=L+m.scrollX+_+1),x+j>ie&&(pe-=j-z+1),qe(this,St).setPosition(se,pe),qe(this,St).setReadOnlyState(this.getCommentMeta(s,a,sd))}focusEditor(){qe(this,St).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[$i];let o;i?(o=Rn(i),ic(o,r)):o=r,this.hot.setCellMeta(e,n,$i,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[$i])return i[$i][r]}addToContextMenu(e){e.items.push({name:ze},FX(this),WX(this),VX(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Cu];if(Fe(e))return e.displayDelay}getEditorInputElement(){return qe(this,St).getInputElement()}destroy(){qe(this,St)&&qe(this,St).destroy(),qe(this,Pr)&&qe(this,Pr).destroy(),super.destroy()}}function XX(t){if(!(!this.hot.view||!this.hot.view._wt)&&!qe(this,gm)&&!this.targetIsCommentTextArea(t)){const e=$o(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function qX(t){const{rootDocument:e}=this.hot;if(!(qe(this,gm)||qe(this,St).isFocused()||Ie(t.target,"wtBorder")||qe(this,tv)===t.target||!qe(this,St)))if(Ui(this,tv,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));qe(this,Pr).show(n)}else Po(t.target,e)&&!this.targetIsCommentTextArea(t)&&qe(this,Pr).hide()}function ZX(){Ui(this,gm,!1)}function QX(t,e){e[$i]&&e[$i][ou]&&J(t,e.commentedCellClassName)}function JX(){Ui(this,Gd,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function eq(){Ui(this,Gd,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(ev)}function tq(t){Ui(this,zd,{width:ut(t.target),height:Ot(t.target)})}function nq(t){const e=ut(t.target),n=Ot(t.target);(e!==qe(this,zd).width+1||n!==qe(this,zd).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Wx]:{width:e,height:n}})}function rq(t){qe(this,St).isVisible()&&Sr(t)}function iq(){qe(this,ad)||this.hide()}var xE=pA,oq=TypeError,sq=function(t,e){if(!delete t[e])throw oq("Cannot delete property "+xE(e)+" of "+xE(t))},aq=zs,lq=hf,uq=ff,cq=HA,hq=sq,dq=DA,fq=[].unshift(0)!==1,gq=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},mq=fq||!gq();aq({target:"Array",proto:!0,arity:1,forced:mq},{unshift:function(e){var n=lq(this),r=uq(n),i=arguments.length;if(i){dq(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:hq(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return cq(n,r+i)}});function Yp(t,e,n){return e=pq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pq(t){var e=wq(t,"string");return typeof e=="symbol"?e:String(e)}function wq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vx{constructor(e){Yp(this,"hot",void 0),Yp(this,"commands",{}),Yp(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=Cq(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||At(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),T(u,c=>c.apply(this.hot,r))}}function Cq(t,e){let n;return T(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function zp(t,e,n){return e=vq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vq(t){var e=Sq(t,"string");return typeof e=="symbol"?e:String(e)}function Sq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bx{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;zp(this,"hot",void 0),zp(this,"predefinedItems",$x()),zp(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ue(e,(r,i)=>{let o="";r.name===ze?(n[ze]=r,o=ze):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return yq(e,this.defaultOrderPattern,this.predefinedItems)}}function yq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Fe(i)?Ue(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Fe(o)?Ut(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):T(i,(o,s)=>{let a=n[o];!a&&$X.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Fe(o)&&Ut(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ho(t,e,n){return e=bq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bq(t){var e=Rq(t,"string");return typeof e=="symbol"?e:String(e)}function Rq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eq{constructor(e,n){ho(this,"top",void 0),ho(this,"topRelative",void 0),ho(this,"left",void 0),ho(this,"leftRelative",void 0),ho(this,"scrollTop",void 0),ho(this,"scrollLeft",void 0),ho(this,"cellHeight",void 0),ho(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Nl(t,e,n){Tq(t,e),e.set(t,n)}function Tq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){var n=Ux(t,e,"get");return _q(t,n)}function _q(t,e){return e.get?e.get.call(t):e.value}function fh(t,e,n){var r=Ux(t,e,"set");return Mq(t,r,n),n}function Ux(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Mq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var In=new WeakMap,fo=new WeakMap,cn=new WeakMap,Gp=new WeakMap,ga=new WeakMap;class Aq{constructor(e){Nl(this,In,{writable:!0,value:void 0}),Nl(this,fo,{writable:!0,value:void 0}),Nl(this,cn,{writable:!0,value:void 0}),Nl(this,Gp,{writable:!0,value:!1}),Nl(this,ga,{writable:!0,value:{above:0,below:0,left:0,right:0}}),fh(this,Gp,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ke(this,ga)[e]=n,this}setElement(e){return fh(this,In,e),this}setParentElement(e){return fh(this,fo,e),this}updatePosition(e){fh(this,cn,new Eq(e,Ke(this,In).ownerDocument.defaultView)),Ke(this,Gp)?(Ke(this,cn).fitsBelow(Ke(this,In))?this.setPositionBelowCursor():Ke(this,cn).fitsAbove(Ke(this,In))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ke(this,In).dir==="rtl"?Ke(this,cn).fitsOnLeft(Ke(this,In))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ke(this,cn).fitsOnRight(Ke(this,In))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ke(this,ga).above+Ke(this,cn).top-Ke(this,In).offsetHeight;Ke(this,fo)&&(e=Ke(this,cn).top+Ke(this,cn).cellHeight-Ke(this,In).offsetHeight+3),Ke(this,In).style.top=`${e}px`}setPositionBelowCursor(){let e=Ke(this,ga).below+Ke(this,cn).top+1;Ke(this,fo)&&(e=Ke(this,cn).top-1),Ke(this,In).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ke(this,cn).left;if(Ke(this,fo)){const{right:n}=Ke(this,fo).getBoundingClientRect();e+=Ke(this,cn).cellWidth+n-(Ke(this,cn).left+Ke(this,cn).cellWidth)}else e+=Ke(this,ga).right;Ke(this,In).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ke(this,ga).left+Ke(this,cn).left-Ke(this,In).offsetWidth;if(Ke(this,fo)){const{left:n}=Ke(this,fo).getBoundingClientRect();e-=Ke(this,cn).left-n}Ke(this,In).style.left=`${e}px`}}function Yx(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=qn(e,-1,w()-1);function a(y,b){const _=w()-1;return y<0&&(y=_),y>_&&(y=0),o.has(y)?-1:(o.add(y),r(y,!1)===!1&&(y=a(b===1?++y:--y,b)),y)}function l(y){y>-1&&y<w()&&r(y,!0)!==!1&&(s=y)}function u(){return s}function c(){w()>0&&(o.clear(),s=a(0,1))}function d(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function m(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:d,toNextItem:f,toPreviousItem:m,getSize:w,clear:v}}function Oq(t){return Be(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ld(t){return At(t,"submenu")}function nv(t){return new RegExp(ze,"i").test(t.name)}function ud(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function HE(t){return At(t,"disableSelection")}function Iq(t){return Ie(t,"htSeparator")}function Pq(t){return Ie(t,"htSubmenu")}function xq(t){return Ie(t,"htDisabled")}function Hq(t){return Ie(t,"htSelectionDisabled")}function Dq(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function zx(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function Nq(t,e){let n=t.slice(0);return n.reverse(),n=zx(n,e),n.reverse(),n}function Lq(t){const e=[];return T(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function $q(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ze,n=t.slice(0);return n=zx(n,e),n=Nq(n,e),n=Lq(n),n}function kq(t){return Yx({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||Iq(r)||xq(r)||Hq(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Fq(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const Gx="menu",DE=Gx;function Wq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(Fq(t)),e.forEach(u=>{let{shortcuts:c,contextName:d}=u;i(c,d)});function r(u,c){a(c).addShortcuts(u,{group:Gx})}function i(u,c){const d=a(c);u.forEach(f=>{let{keys:m}=f;m.forEach(w=>d.removeShortcutsByKeys(w))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${DE}:${u}`:DE}function a(u){var c;const d=t.hotMenu.getShortcutManager(),f=s(u);return(c=d.getContext(f))!==null&&c!==void 0?c:d.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}const Vq="submenuIndicator";function Bq(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(Vr(n),J(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!ud(a,t)&&!HE(a)&&!nv(a);ve(n,[sY(),Lo(u),...c?[sl(-1)]:[],...ud(a,t)?[fY()]:[],...ld(a)?[sn(!1)]:[]])}ld(a)&&(n.querySelector(".submenuIndicator")||ks(n,{tagName:"div",attributes:t.getSettings().ariaTags?[no()]:[],className:Vq})),n.className="",n.appendChild(l),nv(a)?J(n,"htSeparator"):typeof a.renderer=="function"?(J(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ks(l,u),ud(a,t)?J(n,"htDisabled"):HE(a)?J(n,"htSelectionDisabled"):ld(a)&&J(n,"htSubmenu")}}function NE(t,e,n){Uq(t,e),e.set(t,n)}function Uq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jr(t,e,n){return e=Yq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yq(t){var e=zq(t,"string");return typeof e=="symbol"?e:String(e)}function zq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function LE(t,e,n){var r=jx(t,e,"set");return Gq(t,r,n),n}function Gq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ll(t,e){var n=jx(t,e,"get");return jq(t,n)}function jx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jq(t,e){return e.get?e.get.call(t):e.value}const $E=215;var $l=new WeakMap,gh=new WeakMap;class fl{constructor(e,n){var r=this;Jr(this,"hot",void 0),Jr(this,"options",void 0),Jr(this,"eventManager",new or(this)),Jr(this,"container",void 0),Jr(this,"positioner",void 0),Jr(this,"hotMenu",null),Jr(this,"hotSubMenus",{}),Jr(this,"parentMenu",void 0),Jr(this,"menuItems",null),Jr(this,"origOutsideClickDeselects",null),NE(this,$l,{writable:!0,value:void 0}),NE(this,gh,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:$E,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Aq(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=xu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Ll(this,$l)}getKeyboardShortcutsCtrl(){return Ll(this,gh)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=pS(a=>this.openSubMenu(a),300),n=this.options.minWidth||$E;let r=!1,i=ir(this.menuItems,a=>(a.key===Wu&&(r=!0),Dq(a,this.hot)));if(i.length<1&&!r)i.push($x()[Wu]);else if(i.length===0)return;i=$q(i,ze);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:Bq(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Ll(this,$l).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===ze?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),HC()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!HC()||!Wo(a))&&o&&this.hasSelectedItem()&&(Bi()||yS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),LE(this,$l,kq(this.hotMenu)),LE(this,gh,Wq(this)),Ll(this,gh).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Ll(this,$l).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);ve(r,[sn(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!Pq(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new fl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&ve(n,[sn(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ve(i,[sn(!1)])}}closeAllSubMenus(){T(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?Oq(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||nv(e)||ud(e,this.hot)||ld(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(gt(r)&&(r=r.call(this.hot),r===null||mt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),J(i,`htMenu ${this.options.className}`),r&&J(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Ft(n,(a,l)=>a+(l.name===ze?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&ve(this.hotMenu.rootElement,[oY(),sl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Po(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Po(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ie(e.target,"htCore")&&Po(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}dt(fl,Zn);function mh(t,e){Kq(t,e),e.add(t)}function Kq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jp(t,e,n){return e=Xq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xq(t){var e=qq(t,"string");return typeof e=="symbol"?e:String(e)}function qq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ph(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const su="contextMenu",Zq=70,kE=su;de.getSingleton().register("afterContextMenuDefaultOptions");de.getSingleton().register("beforeContextMenuShow");de.getSingleton().register("afterContextMenuShow");de.getSingleton().register("afterContextMenuHide");de.getSingleton().register("afterContextMenuExecute");var FE=new WeakSet,WE=new WeakSet,VE=new WeakSet,BE=new WeakSet;class wc extends nt{constructor(){super(...arguments),mh(this,BE),mh(this,VE),mh(this,WE),mh(this,FE),jp(this,"commandExecutor",new Vx(this.hot)),jp(this,"itemsFactory",null),jp(this,"menu",null)}static get PLUGIN_KEY(){return su}static get PLUGIN_PRIORITY(){return Zq}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[hm,dm,ze,fc,gc,ze,cm,pc,ze,fm,um,ze,mc,ze,fr]}isEnabled(){return!!this.hot.getSettings()[su]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[su];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new fl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>ph(this,WE,Jq).call(this)),this.menu.addLocalHook("afterOpen",()=>ph(this,VE,eZ).call(this)),this.menu.addLocalHook("afterClose",()=>ph(this,BE,tZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>ph(this,FE,Qq).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","\\"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=am(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height})},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:kE})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kE)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ue(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new Bx(this.hot,wc.DEFAULT_ITEMS);const e=this.hot.getSettings()[su],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),T(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Qq(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Ie(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Ie(o,"current")&&Ie(o,"wtBorder"))))return;const s=am(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function Jq(){this.hot.runHooks("beforeContextMenuShow",this)}function eZ(){this.hot.runHooks("afterContextMenuShow",this)}function tZ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}wc.SEPARATOR={name:ze};function nZ(t){return{key:"copy",name(){return this.getTranslatedPhrase(Zf)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function rZ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(oy,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function iZ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(iy,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function oZ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(ry,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function sZ(t){return{key:"cut",name(){return this.getTranslatedPhrase(Qf)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class aZ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class lZ{constructor(){this.clipboardData=new aZ}}function UE(t,e){Kx(t,e),e.add(t)}function ma(t,e,n){Kx(t,e),e.set(t,n)}function Kx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Dn(t,e){var n=Xx(t,e,"get");return uZ(t,n)}function uZ(t,e){return e.get?e.get.call(t):e.value}function pa(t,e,n){var r=Xx(t,e,"set");return cZ(t,r,n),n}function Xx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var go=new WeakMap,Kp=new WeakMap,kl=new WeakMap,rv=new WeakMap,iv=new WeakMap,Fl=new WeakMap,Ch=new WeakSet,YE=new WeakSet;class hZ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;UE(this,YE),UE(this,Ch),ma(this,go,{writable:!0,value:void 0}),ma(this,Kp,{writable:!0,value:void 0}),ma(this,kl,{writable:!0,value:void 0}),ma(this,rv,{writable:!0,value:void 0}),ma(this,iv,{writable:!0,value:void 0}),ma(this,Fl,{writable:!0,value:void 0}),pa(this,Kp,n),pa(this,kl,r),pa(this,rv,i),pa(this,iv,o),pa(this,Fl,s)}setSelectedRange(e){pa(this,go,e)}getCellsRange(){if(Dn(this,Kp).call(this)===0||Dn(this,kl).call(this)===0)return null;const{row:e,col:n}=Dn(this,go).getTopStartCorner(),{row:r,col:i}=Dn(this,go).getBottomEndCorner(),o=wh(this,YE,dZ).call(this,e,r),s=wh(this,Ch,Xp).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Dn(this,kl).call(this)===0||Dn(this,Fl).call(this)===0)return null;const{col:e}=Dn(this,go).getTopStartCorner(),{col:n}=Dn(this,go).getBottomEndCorner(),r=wh(this,Ch,Xp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Dn(this,kl).call(this)===0||Dn(this,Fl).call(this)===0)return null;const{col:e}=Dn(this,go).getTopStartCorner(),{col:n}=Dn(this,go).getBottomEndCorner(),r=wh(this,Ch,Xp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Dn(this,Fl).call(this),startCol:e,endRow:-1,endCol:r}}}function Xp(t,e){return Math.min(e,Math.max(t+Dn(this,iv).call(this)-1,t))}function dZ(t,e){return Math.min(e,Math.max(t+Dn(this,rv).call(this)-1,t))}function qx(t){const e=[],n=[];return T(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);me(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);me(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function _i(t,e){Zx(t,e),e.add(t)}function ds(t,e,n){Zx(t,e),e.set(t,n)}function Zx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wl(t,e,n){return e=fZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fZ(t){var e=gZ(t,"string");return typeof e=="symbol"?e:String(e)}function gZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jn(t,e){var n=Qx(t,e,"get");return mZ(t,n)}function mZ(t,e){return e.get?e.get.call(t):e.value}function Hr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Mi(t,e,n){var r=Qx(t,e,"set");return pZ(t,r,n),n}function Qx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("afterCopyLimit");de.getSingleton().register("modifyCopyableRange");de.getSingleton().register("beforeCut");de.getSingleton().register("afterCut");de.getSingleton().register("beforePaste");de.getSingleton().register("afterPaste");de.getSingleton().register("beforeCopy");de.getSingleton().register("afterCopy");const vh="copyPaste",wZ=80,CZ=["fragmentSelection"],zE=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var ov=new WeakMap,sv=new WeakMap,av=new WeakMap,wa=new WeakMap,Sh=new WeakMap,yh=new WeakMap,Ca=new WeakMap,qp=new WeakSet,GE=new WeakSet,Jx=new WeakSet,Wy=new WeakSet,jE=new WeakSet,KE=new WeakSet,XE=new WeakSet,qE=new WeakSet,ZE=new WeakSet;class eH extends nt{constructor(){super(...arguments),_i(this,ZE),_i(this,qE),_i(this,XE),_i(this,KE),_i(this,jE),_i(this,Wy),_i(this,Jx),_i(this,GE),_i(this,qp),Wl(this,"columnsLimit",1/0),Wl(this,"rowsLimit",1/0),Wl(this,"pasteMode","overwrite"),Wl(this,"uiContainer",this.hot.rootDocument.body),ds(this,ov,{writable:!0,value:!1}),ds(this,sv,{writable:!0,value:!1}),ds(this,av,{writable:!0,value:!1}),ds(this,wa,{writable:!0,value:"cells-only"}),ds(this,Sh,{writable:!0,value:!1}),ds(this,yh,{writable:!0,value:!1}),ds(this,Ca,{writable:!0,value:new hZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Wl(this,"copyableRanges",[])}static get PLUGIN_KEY(){return vh}static get SETTING_KEYS(){return[vh,...CZ]}static get PLUGIN_PRIORITY(){return wZ}isEnabled(){return!!this.hot.getSettings()[vh]}enablePlugin(){var e=this;if(this.enabled)return;const{[vh]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Mi(this,ov,!!n.copyColumnHeaders),Mi(this,sv,!!n.copyColumnGroupHeaders),Mi(this,av,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Hr(this,jE,yZ).call(this,o)),this.addHook("afterSelectionEnd",()=>Hr(this,KE,bZ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),vS()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Hr(e,XE,RZ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Hr(e,qE,EZ).call(e,...s)}),this.addHook("afterSelection",()=>Hr(this,ZE,TZ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Mi(this,wa,e),Mi(this,Sh,!0),Hr(this,qp,QE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Mi(this,yh,!0),Hr(this,qp,QE).call(this,"cut")}getRangedCopyableData(e){return mu(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=qx(e);return T(r,o=>{const s=[];T(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new lZ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Jn(this,Ca).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);Jn(this,wa)==="column-headers-only"?n.set("headers",Jn(this,Ca).getMostBottomColumnHeadersRange()):(Jn(this,wa)==="with-column-headers"?n.set("headers",Jn(this,Ca).getMostBottomColumnHeadersRange()):Jn(this,wa)==="with-column-group-headers"&&n.set("headers",Jn(this,Ca).getAllColumnHeadersRange()),n.set("cells",Jn(this,Ca).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,d=a,f=s,m=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:w,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,w===!0)continue;f=v,d=a;const y=[],b=o.length%r;for(;y.length<i||d<=u;){const{skipColumnOnPaste:_,visualCol:I}=this.hot.getCellMeta(s,d);if(d=I+1,_===!0)continue;m=I;const L=y.length%i;y.push(e[b][L])}o.push(y)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,m]}onCopy(e){if(!this.hot.isListening()&&!Jn(this,Sh)||this.isEditorOpened())return;this.setCopyableText(),Mi(this,Sh,!1);const n=this.getRangedData(this.copyableRanges),r=Hr(this,GE,vZ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=mu(n);if(e&&e.clipboardData){const s=FC(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[zE,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Mi(this,wa,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!Jn(this,yh)||this.isEditorOpened())return;this.setCopyableText(),Mi(this,yh,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=mu(n);if(e&&e.clipboardData){const o=FC(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[zE,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=Mf(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=DI(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=X4(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function QE(t){if(vS()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&uI(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function vZ(t){const{rows:e}=qx(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function SZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&gS(r)}}}function tH(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&mS(r)}}}function yZ(t){t.items.push({name:"---------"},nZ(this)),Jn(this,ov)&&t.items.push(oZ(this)),Jn(this,sv)&&t.items.push(iZ(this)),Jn(this,av)&&t.items.push(rZ(this)),t.items.push(sZ(this))}function bZ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function RZ(){Hr(this,Wy,tH).call(this)}function EZ(){Hr(this,Jx,SZ).call(this)}function TZ(){Hr(this,Wy,tH).call(this)}function nH(t,e){return`border_row${t}col${e}`}function au(){return{width:1,color:"#000"}}function Yi(){return{hide:!0}}function _Z(){return{width:1,color:"#000",cornerVisible:!1}}function Zp(t){if(ue(t.start)||ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ue(t.end)||ue(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function Vl(t){return ue(t.start)&&(t.left=t.start),ue(t.end)&&(t.right=t.end),t}function Qp(t,e){return{id:nH(t,e),border:_Z(),row:t,col:e,top:Yi(),bottom:Yi(),start:Yi(),end:Yi()}}function MZ(t,e){return At(e,"border")&&e.border&&(t.border=e.border),At(e,"top")&&ue(e.top)&&(e.top?(Fe(e.top)||(e.top=au()),t.top=e.top):(e.top=Yi(),t.top=e.top)),At(e,"bottom")&&ue(e.bottom)&&(e.bottom?(Fe(e.bottom)||(e.bottom=au()),t.bottom=e.bottom):(e.bottom=Yi(),t.bottom=e.bottom)),At(e,"start")&&ue(e.start)&&(e.start?(Fe(e.start)||(e.start=au()),t.start=e.start):(e.start=Yi(),t.start=e.start)),At(e,"end")&&ue(e.end)&&(e.end?(Fe(e.end)||(e.end=au()),t.end=e.end):(e.end=Yi(),t.end=e.end)),t}function Zi(t,e){let n=!1;return T(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!At(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function mm(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function AZ(t){return t.some(e=>ue(e.left)||ue(e.right))}function OZ(t){return t.some(e=>ue(e.start)||ue(e.end))}const IZ=new Map([["left","start"],["right","end"]]);function PZ(t){var e;return(e=IZ.get(t))!==null&&e!==void 0?e:t}function xZ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Cg);return Zi(this,"bottom")&&(e=mm(e)),e},callback(e,n){const r=Zi(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function HZ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(vg);return Zi(this,e)&&(n=mm(n)),n},callback(n,r){const i=Zi(this,e);t.prepareBorder(r,e,i)}}}function DZ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Sg)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Zi(this)}}}function NZ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(wg);return Zi(this,e)&&(n=mm(n)),n},callback(n,r){const i=Zi(this,e);t.prepareBorder(r,e,i)}}}function LZ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(pg);return Zi(this,"top")&&(e=mm(e)),e},callback(e,n){const r=Zi(this,"top");t.prepareBorder(n,"top",r)}}}function JE(t,e){$Z(t,e),e.add(t)}function $Z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kZ(t,e,n){return e=FZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FZ(t){var e=WZ(t,"string");return typeof e=="symbol"?e:String(e)}function WZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const cd="customBorders",VZ=90;var tT=new WeakSet,nT=new WeakSet;class BZ extends nt{constructor(){super(...arguments),JE(this,nT),JE(this,tT),kZ(this,"savedBorders",[])}static get PLUGIN_KEY(){return cd}static get PLUGIN_PRIORITY(){return VZ}isEnabled(){return!!this.hot.getSettings()[cd]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>eT(this,tT,UZ).call(this,e)),this.addHook("init",()=>eT(this,nT,YZ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Zp(n));const o=el(e),s=Fu(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});T(e,a=>{s(a).forAll((l,u)=>{T(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,PZ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=el(e),r=Fu(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return T(e,o=>{r(o).forAll((s,a)=>{T(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(Vl(l))})})}),i}clearBorders(e){e?this.setBorders(e):(T(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Qp(e,n);r&&(a=MZ(a,r),T(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",Vl(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,r,o=>{me(e.from.col,i,s=>{const a=Qp(o,s);let l=0;o===e.from.row&&At(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&At(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&At(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&At(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",Vl(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=nH(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Qp(e,n):o=Zp(o),i?(o[r]=Yi(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Vl(o)))):(o[r]=au(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",Vl(o)))}prepareBorder(e,n,r){T(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":me(o.col,s.col,a=>{me(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":me(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":me(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":me(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){T(e,n=>{const r=Zp(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Ft([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Be(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){T(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){T(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Be(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):T(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return T(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return T(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):T(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);T(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[cd];if(Array.isArray(e)){const n=Rn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=AZ(e),r=OZ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function UZ(t){this.hot.getSettings()[cd]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(mg)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[LZ(this),NZ(this),xZ(this),HZ(this),DZ(this)]}})}function YZ(){this.changeBorderSettings()}function zZ(t,e){GZ(t,e),e.add(t)}function GZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jp(t,e,n){return e=jZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jZ(t){var e=KZ(t,"string");return typeof e=="symbol"?e:String(e)}function KZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const iT="dragToScroll",XZ=100;var ew=new WeakSet;class qZ extends nt{constructor(){super(...arguments),zZ(this,ew),Jp(this,"boundaries",null),Jp(this,"callback",null),Jp(this,"listening",!1)}static get PLUGIN_KEY(){return iT}static get PLUGIN_PRIORITY(){return XZ}isEnabled(){return!!this.hot.getSettings()[iT]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>rT(this,ew,oT).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>rT(this,ew,oT).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=xu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function oT(t){if(Wo(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function fs(t,e){ZZ(t,e),e.add(t)}function ZZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tw(t,e,n){return e=QZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QZ(t){var e=JZ(t,"string");return typeof e=="symbol"?e:String(e)}function JZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("afterDropdownMenuDefaultOptions");de.getSingleton().register("beforeDropdownMenuShow");de.getSingleton().register("afterDropdownMenuShow");de.getSingleton().register("afterDropdownMenuHide");de.getSingleton().register("afterDropdownMenuExecute");const hd="dropdownMenu",eQ=230,lv="changeType",nw=hd;var Vy=new WeakSet,sT=new WeakSet,aT=new WeakSet,lT=new WeakSet,uT=new WeakSet,cT=new WeakSet,hT=new WeakSet;class Cc extends nt{static get PLUGIN_KEY(){return hd}static get PLUGIN_PRIORITY(){return eQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[fc,gc,ze,pc,ze,lm,ze,mc,ze,fr]}constructor(e){super(e),fs(this,hT),fs(this,cT),fs(this,uT),fs(this,lT),fs(this,aT),fs(this,sT),fs(this,Vy),tw(this,"commandExecutor",new Vx(this.hot)),tw(this,"itemsFactory",null),tw(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>bo(this,aT,nQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[hd]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new Bx(this.hot,Cc.DEFAULT_ITEMS);const n=this.hot.getSettings()[hd],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new fl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>bo(this,lT,rQ).call(this)),this.menu.addLocalHook("afterOpen",()=>bo(this,uT,iQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>bo(this,cT,oQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>bo(this,hT,sQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),T(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=am(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width})}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:nw},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:nw}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nw)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>bo(this,sT,tQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ue(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function rH(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function tQ(t){if(t.stopPropagation(),Ie(t.target,lv)){const e=am(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function nQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${lv}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=lv,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ve(s,[Lo(this.hot.getTranslatedPhrase(fy))]),ve(e,[al("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function rQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function iQ(){this.hot.runHooks("afterDropdownMenuShow",this),bo(this,Vy,rH).call(this,this.menu)}function oQ(t){bo(this,Vy,rH).call(this,t)}function sQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}Cc.SEPARATOR={name:ze};function dT(t,e,n){return e=aQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aQ(t){var e=lQ(t,"string");return typeof e=="symbol"?e:String(e)}function lQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uQ{constructor(e){dT(this,"hot",void 0),dT(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return me(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(me(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();me(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();me(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const cQ=uQ;function fT(t,e,n){return e=hQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hQ(t){var e=dQ(t,"string");return typeof e=="symbol"?e:String(e)}function dQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class By{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){fT(this,"dataProvider",void 0),fT(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=$n(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Ut($n(By.DEFAULT_OPTIONS),n),n=Ut(n,e),n.filename=lS(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const fQ=By,gQ=String.fromCharCode(13),mQ=String.fromCharCode(34),pQ=String.fromCharCode(10);class wQ extends fQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Be(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),T(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Nt(e);return r!==""&&(n||r.indexOf(gQ)>=0||r.indexOf(mQ)>=0||r.indexOf(pQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const CQ=wQ,vQ="csv",uv={[vQ]:CQ};function SQ(t,e,n){return typeof uv[t]=="function"?new uv[t](e,n):null}const yQ="exportFile",bQ=240;class RQ extends nt{static get PLUGIN_KEY(){return yQ}static get PLUGIN_PRIORITY(){return bQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!uv[e])throw new Error(`Export format type "${e}" is not supported.`);return SQ(e,new cQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function va(t,e,n){return e=EQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EQ(t){var e=TQ(t,"string");return typeof e=="symbol"?e:String(e)}function TQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vc{constructor(e,n){let{id:r,stateless:i=!0}=n;va(this,"hot",void 0),va(this,"id",void 0),va(this,"elements",[]),va(this,"hidden",!1),va(this,"stateId",""),va(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ff)}getElements(){return this.elements}reset(){T(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}dt(vc,Zn);const Vu={};function Bo(t,e){if(!Vu[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Vu[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function xs(t){if(!Vu[t])throw Error(`Filter condition "${t}" does not exist.`);return Vu[t].descriptor}function Yt(t,e,n){n.key=t,Vu[t]={condition:e,descriptor:n}}const on="none";function _Q(){return!0}Yt(on,_Q,{name:uc,inputsCount:0,showOperators:!1});const vu="empty";function MQ(t){return Xt(t.value)}Yt(vu,MQ,{name:Mg,inputsCount:0,showOperators:!0});const dd="not_empty";function AQ(t,e){return!Bo(vu,e)(t)}Yt(dd,AQ,{name:Ag,inputsCount:0,showOperators:!0});const Su="eq";function OQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale)===Nt(n)}Yt(Su,OQ,{name:Og,inputsCount:1,showOperators:!0});const fd="neq";function IQ(t,e){return!Bo(Su,e)(t)}Yt(fd,IQ,{name:Ig,inputsCount:1,showOperators:!0});const iH="gt";function PQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Yt(iH,PQ,{name:Ng,inputsCount:1,showOperators:!0});const oH="gte";function xQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Yt(oH,xQ,{name:Lg,inputsCount:1,showOperators:!0});const sH="lt";function HQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Yt(sH,HQ,{name:$g,inputsCount:1,showOperators:!0});const aH="lte";function DQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Yt(aH,DQ,{name:kg,inputsCount:1,showOperators:!0});const Uy="date_after";function NQ(t,e){let[n]=e;const r=Q(t.value,t.meta.dateFormat),i=Q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Yt(Uy,NQ,{name:Vg,inputsCount:1,showOperators:!0});const Yy="date_before";function LQ(t,e){let[n]=e;const r=Q(t.value,t.meta.dateFormat),i=Q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Yt(Yy,LQ,{name:Bg,inputsCount:1,showOperators:!0});const jd="between";function $Q(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Bo(Yy,[o]),a=Bo(Uy,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Yt(jd,$Q,{name:Fg,inputsCount:2,showOperators:!0});const lH="not_between";function kQ(t,e){return!Bo(jd,e)(t)}Yt(lH,kQ,{name:Wg,inputsCount:2,showOperators:!0});const uH="begins_with";function FQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Nt(n))}Yt(uH,FQ,{name:Pg,inputsCount:1,showOperators:!0});const cH="ends_with";function WQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Nt(n))}Yt(cH,WQ,{name:xg,inputsCount:1,showOperators:!0});const zy="contains";function VQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Nt(n))>=0}Yt(zy,VQ,{name:Hg,inputsCount:1,showOperators:!0});const hH="not_contains";function BQ(t,e){return!Bo(zy,e)(t)}Yt(hH,BQ,{name:Dg,inputsCount:1,showOperators:!0});const dH="date_tomorrow";function UQ(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(-1,"days").startOf("day"),"d"):!1}Yt(dH,UQ,{name:Yg,inputsCount:0});const fH="date_today";function YQ(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().startOf("day"),"d"):!1}Yt(fH,YQ,{name:Ug,inputsCount:0});const gH="date_yesterday";function zQ(t){const e=Q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(1,"days").startOf("day"),"d"):!1}Yt(gH,zQ,{name:zg,inputsCount:0});XI();function GQ(t,e){let n=t;return n===""&&(n=`(${e})`),n}const cv=new Set([1]).has(1),jQ=cv&&typeof Array.from=="function";function Sc(t){let e=t;return cv&&(e=new Set(e)),function(n){let r;return cv?r=e.has(n):r=!!~e.indexOf(n),r}}function mH(t){return t??""}function hv(t){let e=t;return jQ?e=Array.from(new Set(e)):e=oS(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function gT(t,e,n,r){const i=[],o=t===e;let s;return o||(s=Sc(e)),T(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:GQ(a,n)};r&&r(u),i.push(u)}),i}const Hs="by_value";function KQ(t,e){let[n]=e;return n(t.value)}Yt(Hs,KQ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Sc(e)]},showOperators:!1});const Bu={};function XQ(t){if(!Bu[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Bu[t].func;return function(n,r){return e(n,r)}}function qQ(t){return Bu[t].name}function Gy(t,e,n){Bu[t]={name:e,func:n}}const Do="conjunction",ZQ=Kg;function QQ(t,e){return t.every(n=>n.func(e))}Gy(Do,ZQ,QQ);const Kd="disjunction",JQ=cc;function eJ(t,e){return t.some(n=>n.func(e))}Gy(Kd,JQ,eJ);const jy="disjunctionWithExtraCondition",tJ=cc;function nJ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}Gy(jy,tJ,nJ);const rJ="numeric",pH="text",iJ="date",mT={[rJ]:[on,ze,vu,dd,ze,Su,fd,ze,iH,oH,sH,aH,jd,lH],[pH]:[on,ze,vu,dd,ze,Su,fd,ze,uH,cH,ze,zy,hH],[iJ]:[on,ze,vu,dd,ze,Su,fd,ze,Yy,Uy,jd,ze,dH,fH,gH]};function oJ(t){const e=[];let n=t;return mT[n]||(n=pH),T(mT[n],r=>{let i;r===ze?i={name:ze}:i=$n(xs(r)),e.push(i)}),e}function Bl(t,e,n){return e=sJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sJ(t){var e=aJ(t,"string");return typeof e=="symbol"?e:String(e)}function aJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rw="built",iw="building",pT=["click","input","keydown","keypress","keyup","focus","blur","change"];let $r=class wH{static get DEFAULTS(){return $n({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Bl(this,"hot",void 0),Bl(this,"eventManager",new or(this)),Bl(this,"options",void 0),Bl(this,"_element",void 0),Bl(this,"buildState",void 0),this.hot=e,this.options=Ut(wH.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===iw?this._element:this.buildState===rw?(this.update(),this._element):(this.buildState=iw,this.build(),this.buildState=rw,this._element)}isBuilt(){return this.buildState===rw}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Wn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=iw),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&J(this._element,this.options.className),this.options.children.length)T(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ue(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),T(pT,r=>e(n,r))}else T(pT,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};dt($r,Zn);function lJ(t,e){CH(t,e),e.add(t)}function uJ(t,e,n){CH(t,e),e.set(t,n)}function CH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bh(t,e){var n=vH(t,e,"get");return cJ(t,n)}function cJ(t,e){return e.get?e.get.call(t):e.value}function hJ(t,e,n){var r=vH(t,e,"set");return dJ(t,r,n),n}function vH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function fJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Sa=new WeakMap,wT=new WeakSet;class No extends $r{static get DEFAULTS(){return $n({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Ut(No.DEFAULTS,n)),lJ(this,wT),uJ(this,Sa,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>fJ(this,wT,gJ).call(this,e))}build(){super.build(),hJ(this,Sa,this._element.firstChild),J(this._element,"htUIInput"),this.update()}update(){this.isBuilt()&&(bh(this,Sa).type=this.options.type,bh(this,Sa).placeholder=this.translateIfPossible(this.options.placeholder),bh(this,Sa).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&bh(this,Sa).focus()}}function gJ(t){this.options.value=t.target.value}function ow(t,e){SH(t,e),e.add(t)}function Ul(t,e,n){SH(t,e),e.set(t,n)}function SH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ya(t,e,n){var r=yH(t,e,"set");return mJ(t,r,n),n}function mJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function sw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function It(t,e){var n=yH(t,e,"get");return pJ(t,n)}function yH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pJ(t,e){return e.get?e.get.call(t):e.value}var Zt=new WeakMap,Rh=new WeakMap,Eh=new WeakMap,aw=new WeakMap,Th=new WeakMap,CT=new WeakSet,vT=new WeakSet,ST=new WeakSet;class Uu extends $r{static get DEFAULTS(){return $n({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Ut(Uu.DEFAULTS,n)),ow(this,ST),ow(this,vT),ow(this,CT),Ul(this,Zt,{writable:!0,value:null}),Ul(this,Rh,{writable:!0,value:[]}),Ul(this,Eh,{writable:!0,value:void 0}),Ul(this,aw,{writable:!0,value:void 0}),Ul(this,Th,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return It(this,Zt)}registerHooks(){this.addLocalHook("click",()=>sw(this,ST,vJ).call(this))}setItems(e){ya(this,Rh,this.translateNames(e)),It(this,Zt)&&It(this,Zt).setMenuItems(It(this,Rh))}translateNames(e){return T(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),ya(this,Zt,new fl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),It(this,Zt).setMenuItems(It(this,Rh));const e=new $r(this.hot,{className:"htUISelectCaption"}),n=new $r(this.hot,{className:"htUISelectDropdown"});ya(this,Eh,e),ya(this,aw,e.element),ya(this,Th,n),this.hot.getSettings().ariaTags&&(ve(n.element,[no()]),ve(this._element,[KO()])),T([e,n],r=>this._element.appendChild(r.element)),It(this,Zt).addLocalHook("select",r=>sw(this,CT,wJ).call(this,r)),It(this,Zt).addLocalHook("afterClose",()=>sw(this,vT,CJ).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=It(this,Zt).hot.getTranslatedPhrase(uc),It(this,aw).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();It(this,Zt)&&(It(this,Zt).open(),It(this,Zt).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),It(this,Zt).getNavigator().toFirstItem(),It(this,Zt).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){It(this,Zt)&&It(this,Zt).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){It(this,Zt)&&(It(this,Zt).destroy(),ya(this,Zt,null)),It(this,Eh)&&It(this,Eh).destroy(),It(this,Th)&&It(this,Th).destroy(),super.destroy()}}function wJ(t){t.name!==ze&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function CJ(){this.runLocalHooks("afterClose")}function vJ(){this.openOptions()}function yT(t,e){SJ(t,e),e.add(t)}function SJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bT(t,e,n){return e=yJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yJ(t){var e=bJ(t,"string");return typeof e=="symbol"?e:String(e)}function bJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var ET=new WeakSet,TT=new WeakSet;class dv extends vc{constructor(e,n){super(e,{id:n.id,stateless:!1}),yT(this,TT),yT(this,ET),bT(this,"name",""),bT(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Uu(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new No(this.hot,{placeholder:em})),this.elements.push(new No(this.hot,{placeholder:tm})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>RT(this,ET,RJ).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),T(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>RT(this,TT,EJ).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=$n(e.command);n.name.startsWith(Lt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),T(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||xs(on),n=[];return T(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=xs(e?e.name:on);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||T(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Uu)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof No)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{J(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&J(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[xs(on)];if(e!==null){const{visualIndex:r}=e;n=oJ(this.hot.getDataType(0,r,this.hot.countRows(),r))}T(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function RJ(t){T(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function EJ(t){ul(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Sr(t))}function _T(t,e,n){TJ(t,e),e.set(t,n)}function TJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yl(t,e){var n=bH(t,e,"get");return _J(t,n)}function _J(t,e){return e.get?e.get.call(t):e.value}function MT(t,e,n){var r=bH(t,e,"set");return MJ(t,r,n),n}function bH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function MJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ba=new WeakMap,lw=new WeakMap;class Xd extends $r{static get DEFAULTS(){return $n({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Ut(Xd.DEFAULTS,n)),_T(this,ba,{writable:!0,value:void 0}),_T(this,lw,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),MT(this,lw,e),MT(this,ba,this._element.firstChild),Yl(this,ba).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Yl(this,lw).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return Yl(this,ba).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Yl(this,ba).checked=e)}focus(){this.isBuilt()&&Yl(this,ba).focus()}}function AJ(t,e){OJ(t,e),e.add(t)}function OJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IJ(t,e,n){return e=PJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PJ(t){var e=xJ(t,"string");return typeof e=="symbol"?e:String(e)}function xJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const AT=0;var OT=new WeakSet;class DJ extends vc{constructor(e,n){super(e,{id:n.id,stateless:!1}),AJ(this,OT),IJ(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(J(n.parentNode,"htFiltersMenuOperators"),T(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[Do,Kd];T(e,n=>{const r=new Xd(this.hot,{name:"operator",label:{htmlFor:n,textContent:qQ(n)},value:n,checked:n===e[AT],id:n});r.addLocalHook("change",i=>HJ(this,OT,NJ).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ct`Radio button with index ${e} doesn't exist.`);T(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof Xd&&n.isChecked());return e?e.getValue():Do}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&T(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Do,n=arguments.length>1?arguments[1]:void 0,r=e;r===jy&&(r=Kd),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(AT)}}function NJ(t){this.setState(t.target.value)}function LJ(t,e,n){$J(t,e),e.set(t,n)}function $J(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uw(t,e){var n=RH(t,e,"get");return kJ(t,n)}function kJ(t,e){return e.get?e.get.call(t):e.value}function FJ(t,e,n){var r=RH(t,e,"set");return WJ(t,r,n),n}function RH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function WJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var zl=new WeakMap;class Yu extends $r{static get DEFAULTS(){return $n({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Ut(Yu.DEFAULTS,n)),LJ(this,zl,{writable:!0,value:void 0})}build(){super.build(),FJ(this,zl,this._element.firstChild)}update(){this.isBuilt()&&(uw(this,zl).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&uw(this,zl).focus()}activate(){uw(this,zl).click()}}function _h(t,e){EH(t,e),e.add(t)}function Ra(t,e,n){EH(t,e),e.set(t,n)}function EH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function He(t,e){var n=TH(t,e,"get");return VJ(t,n)}function VJ(t,e){return e.get?e.get.call(t):e.value}function Mr(t,e,n){var r=TH(t,e,"set");return BJ(t,r,n),n}function TH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function BJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const IT="multipleSelect.itemBox";var xr=new WeakMap,Tt=new WeakMap,cw=new WeakMap,Ai=new WeakMap,mo=new WeakMap,po=new WeakMap,PT=new WeakSet,xT=new WeakSet,HT=new WeakSet,DT=new WeakSet;class zu extends $r{static get DEFAULTS(){return $n({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Ut(zu.DEFAULTS,n)),_h(this,DT),_h(this,HT),_h(this,xT),_h(this,PT),Ra(this,xr,{writable:!0,value:[]}),Ra(this,Tt,{writable:!0,value:void 0}),Ra(this,cw,{writable:!0,value:void 0}),Ra(this,Ai,{writable:!0,value:void 0}),Ra(this,mo,{writable:!0,value:void 0}),Ra(this,po,{writable:!0,value:void 0}),Mr(this,Ai,new No(this.hot,{placeholder:Jg,className:"htUIMultipleSelectSearch"})),Mr(this,mo,new Yu(this.hot,{textContent:Xg,className:"htUISelectAll"})),Mr(this,po,new Yu(this.hot,{textContent:qg,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return He(this,Tt)}registerHooks(){He(this,Ai).addLocalHook("keydown",e=>Mh(this,xT,YJ).call(this,e)),He(this,Ai).addLocalHook("input",e=>Mh(this,PT,UJ).call(this,e)),He(this,mo).addLocalHook("click",e=>Mh(this,HT,zJ).call(this,e)),He(this,po).addLocalHook("click",e=>Mh(this,DT,GJ).call(this,e))}setItems(e){Mr(this,xr,e),He(this,Tt)&&He(this,Tt).loadData(He(this,xr))}setLocale(e){Mr(this,cw,e)}getLocale(){return He(this,cw)}getItems(){return[...He(this,xr)]}getValue(){return KJ(He(this,xr))}getSearchInputElement(){return He(this,Ai)}getSelectAllElement(){return He(this,mo)}getClearAllElement(){return He(this,po)}isSelectedAllValues(){return He(this,xr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new $r(this.hot,{className:"htUISelectionControls",children:[He(this,mo),He(this,po)]});this._element.appendChild(He(this,Ai).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;He(this,Tt)&&He(this,Tt).destroy(),J(o,"htUIMultipleSelectHot"),Mr(this,Tt,new this.hot.constructor(o,{data:He(this,xr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,d,f,m)=>{l.title=m.instance.getDataAtRowProp(u,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{He(this,Tt).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>He(this,Tt).container.scrollWidth-Jt(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),He(this,Tt).init();const a=He(this,Tt).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:IT}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{He(this,Tt).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:IT})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&He(this,Tt).listen()}reset(){He(this,Ai).reset(),He(this,mo).reset(),He(this,po).reset()}update(){this.isBuilt()&&(He(this,Tt).loadData(jJ(He(this,xr),this.options.value)),super.update())}destroy(){He(this,Tt)&&He(this,Tt).destroy(),He(this,Ai).destroy(),He(this,po).destroy(),He(this,mo).destroy(),Mr(this,Ai,null),Mr(this,po,null),Mr(this,mo,null),Mr(this,Tt,null),Mr(this,xr,null),super.destroy()}}function UJ(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...He(this,xr)]:n=ir(He(this,xr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),He(this,Tt).loadData(n)}function YJ(t){this.runLocalHooks("keydown",t,this),wS(ul,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Sr(t),He(this,Tt).listen(),He(this,Tt).selectCell(0,0))}function zJ(t){const e=[];t.preventDefault(),T(He(this,Tt).getSourceData(),(n,r)=>{n.checked=!0,e.push(XS(n,r)[0])}),He(this,Tt).setSourceDataAtCell(e)}function GJ(t){const e=[];t.preventDefault(),T(He(this,Tt).getSourceData(),(n,r)=>{n.checked=!1,e.push(XS(n,r)[0])}),He(this,Tt).setSourceDataAtCell(e)}function jJ(t,e){const n=Sc(e);return Be(t,r=>(r.checked=n(r.value),r))}function KJ(t){const e=[];return T(t,n=>{n.checked&&e.push(n.value)}),e}function XJ(t,e){qJ(t,e),e.add(t)}function qJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZJ(t,e,n){return e=QJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QJ(t){var e=JJ(t,"string");return typeof e=="symbol"?e:String(e)}function JJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var NT=new WeakSet;class tee extends vc{constructor(e,n){super(e,{id:n.id,stateless:!1}),XJ(this,NT),ZJ(this,"name",""),this.name=n.name,this.elements.push(new zu(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>eee(this,NT,nee).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Hs){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?on:Hs},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=ir(i,d=>d.name===Hs),u={},c=this.hot.getTranslatedPhrase(ku);if(l){const d=hv(Be(s(r,a),v=>v.value));o&&(l.args[0]=o);const f=[],m=gT(d,l.args[0],c,v=>{v.checked&&f.push(v.value)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[f],u.command=xs(Hs),u.itemsSnapshot=m}else u.args=[],u.command=xs(on);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof zu)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{J(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(ku),n=hv(this._getColumnVisibleValues()),r=gT(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Be(this.hot.getDataAtCol(e.visualIndex),n=>mH(n))}}function nee(t){ul(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Sr(t))}var _H;function ree(t,e){iee(t,e),e.add(t)}function iee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oee(t,e,n){return e=see(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function see(t){var e=aee(t,"string");return typeof e=="symbol"?e:String(e)}function aee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var LT=new WeakSet;class Gu extends vc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),ree(this,LT),oee(this,"name",""),this.name=n.name,this.elements.push(new No(this.hot,{type:"button",value:Zg,className:"htUIButton htUIButtonOK",identifier:Gu.BUTTON_OK})),this.elements.push(new No(this.hot,{type:"button",value:Qg,className:"htUIButton htUIButtonCancel",identifier:Gu.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){T(this.elements,e=>{e.addLocalHook("click",(n,r)=>lee(this,LT,uee).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(J(n.parentNode,"htFiltersMenuActionBar"),T(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}_H=Gu;function uee(t,e){e.options.identifier===_H.BUTTON_OK?this.accept():this.cancel()}function hw(t,e,n){return e=cee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cee(t){var e=hee(t,"string");return typeof e=="symbol"?e:String(e)}function hee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $T="ConditionCollection.filteringStates";class MH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;hw(this,"hot",void 0),hw(this,"isMapRegistrable",void 0),hw(this,"filteringStates",new Ff),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap($T,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Do;return e.length?XQ(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Do,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Be(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ct`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(mt(Bu[r]))throw new Error(ct`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Bo(a,s)}]},i):u.push({name:a,args:s,func:Bo(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Ft(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Be(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),T(e,n=>{T(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap($T),this.filteringStates=null,this.clearLocalHooks()}}dt(MH,Zn);const AH=MH;function kT(t,e,n){return e=dee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dee(t){var e=fee(t,"string");return typeof e=="symbol"?e:String(e)}function fee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gee{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];kT(this,"conditionCollection",void 0),kT(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return T(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return T(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return T(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const OH=gee;function dw(t,e){mee(t,e),e.add(t)}function mee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gs(t,e,n){return e=pee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pee(t){var e=wee(t,"string");return typeof e=="symbol"?e:String(e)}function wee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var FT=new WeakSet,WT=new WeakSet,VT=new WeakSet;class IH{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];dw(this,VT),dw(this,WT),dw(this,FT),gs(this,"hot",void 0),gs(this,"conditionCollection",void 0),gs(this,"columnDataFactory",void 0),gs(this,"changes",[]),gs(this,"grouping",!1),gs(this,"latestEditedColumnPosition",-1),gs(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>fw(this,FT,Cee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>fw(this,WT,vee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>fw(this,VT,See).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,T(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=hI(function(c,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const m=new AH(r.hot,!1),w=[].concat(c,f);m.importAllConditions(w);const v=r.columnDataFactory(d);let y;m.isEmpty()?y=v:y=new OH(m,_=>r.columnDataFactory(_)).filter(),y=Be(y,_=>_.meta.visualRow);const b=Sc(y);return m.destroy(),ir(v,_=>b(_.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ue(this,(e,n)=>{this[n]=null})}}function Cee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function vee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function See(){T(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}dt(IH,Zn);const yee=IH;function bee(t){return Yx({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof zu)return r;if(i.element&&!Fo(i.element))return!1;i.focus()}})}const Gl="filters";function Ree(t,e){const n=bee(e),r=s=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Gl),n.setCurrentPage(e.indexOf(s))};e.forEach(s=>{s instanceof $r&&(s.addLocalHook("click",r(s)),s.addLocalHook("focus",r(s)),s.addLocalHook("afterClose",r(s)))}),t.addLocalHook("afterSelectionChange",s=>{s.key.startsWith("filter_")||n.clear()});function i(s){const a=t.getKeyboardShortcutsCtrl(),l=s.getKeyboardShortcutsCtrl();n.clear(),l.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:a.getContext(Gl),callback:()=>{s.isSubMenu()&&s.close(),a.listen(Gl)}}]),!s.isSubMenu()&&a.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:u=>{t.getNavigator().clear(),u.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:u=>{const c=e[n.getCurrentPage()];c instanceof Uu&&(c.openOptions(),u.preventDefault()),c instanceof Yu&&(c.activate(),u.preventDefault()),c instanceof $r||u.preventDefault()}}],Gl)}t.addLocalHook("afterSubmenuOpen",i),t.addLocalHook("afterOpen",i);function o(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Gl)}return{...n,listen:o}}function Oi(t,e){PH(t,e),e.add(t)}function Eee(t,e,n){PH(t,e),e.set(t,n)}function PH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jl(t,e,n){return e=Tee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tee(t){var e=_ee(t,"string");return typeof e=="symbol"?e:String(e)}function _ee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mee(t,e,n){var r=xH(t,e,"set");return Aee(t,r,n),n}function Aee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ah(t,e){var n=xH(t,e,"get");return Oee(t,n)}function xH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Oee(t,e){return e.get?e.get.call(t):e.value}function Ar(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const fv="filters",Iee=250,BT=fv;var Ea=new WeakMap,UT=new WeakSet,YT=new WeakSet,zT=new WeakSet,GT=new WeakSet,gw=new WeakSet,jT=new WeakSet,mw=new WeakSet,KT=new WeakSet,XT=new WeakSet;class HH extends nt{static get PLUGIN_KEY(){return fv}static get PLUGIN_PRIORITY(){return Iee}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Oi(this,XT),Oi(this,KT),Oi(this,mw),Oi(this,jT),Oi(this,gw),Oi(this,GT),Oi(this,zT),Oi(this,YT),Oi(this,UT),jl(this,"dropdownMenuPlugin",null),jl(this,"conditionCollection",null),jl(this,"conditionUpdateObserver",null),jl(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),jl(this,"filtersRowsMap",null),Eee(this,Ea,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Ar(this,KT,Lee).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[fv]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new lc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Ar(this,gw,qT).call(this,"accept")),s.addLocalHook("cancel",()=>Ar(this,gw,qT).call(this,"cancel")),s.addLocalHook("change",a=>Ar(this,jT,Nee).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(Gg)}:`,o=()=>`${this.hot.getTranslatedPhrase(jg)}:`;if(!this.components.get("filter_by_condition")){const s=new dv(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Ar(this,mw,ZT).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new DJ(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new dv(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Ar(this,mw,ZT).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new tee(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Gu(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new AH(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new yee(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Ar(this,XT,$ee).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Ar(this,GT,Dee).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Ar(this,YT,xee).call(this)),this.addHook("afterDropdownMenuHide",()=>Ar(this,zT,Hee).call(this)),this.addHook("afterChange",s=>Ar(this,UT,Pee).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Ah(this,Ea)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>s.focus()},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Mee(this,Ea,Ree(s,a));const l=u=>{Ah(this,Ea).listen(),u.preventDefault(),ul(u.keyCode,"TAB")&&(u.shiftKey?Ah(this,Ea).toPreviousItem():Ah(this,Ea).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:BT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(BT)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Do;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Be(n.filter(),u=>u.meta.visualRow);const l=Sc(i);me(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),T(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return T(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:m,locale:w}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:m,locale:w},value:mH(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=hv(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Kd&&n.command.key!==on&&r.command.key!==on&&i.command.key!==on?o=jy:i.command.key!==on&&(n.command.key===on||r.command.key===on)&&(o=Do),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new OH(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return T(i,s=>{T(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Pee(t){t&&T(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function xee(){this.restoreComponents(Array.from(this.components.values()))}function Hee(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Dee(t){t.items.push({name:ze}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function qT(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==on&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==on&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==on&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Nee(t,e){this.updateDependentComponentsVisibility(),t.constructor===dv&&!e.inputsCount&&this.setListeningDropdownMenu()}function ZT(){this.setListeningDropdownMenu()}function Lee(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?J(e,"htFiltersActive"):De(e,"htFiltersActive")}function $ee(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===Hs),o=n.filter(s=>s.name!==Hs);if(i.length>=2||o.length>=3)pt(ct`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const DH="internal-use-in-handsontable",gv={licenseKey:DH,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function NH(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Sn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function LH(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function kee(t){var e;const n=t[Sn],r=LH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=NH(t);return{...gv,...r,...i}}function Fee(t){var e;const n=t[Sn],r=LH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=NH(t);return{...r,...i}}function Wee(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function pm(){const t="engine_relationship",e=Ur(Sn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Ky(){const t="shared_engine_usage",e=Ur(Sn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Vee(t){const e=t.getSettings(),n=e[Sn],r=n==null?void 0:n.engine;if(n===!0||mt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Bee((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&mt(r.hyperformula)){const o=pm(),s=Ky().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:DH}),(r.getConfig().leapYear1900!==gv.leapYear1900||Pf(r.getConfig().nullDate,gv.nullDate)===!1)&&pt(ct`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Bee(t,e,n){const r=e[Sn],i=kee(e),o=pm(),s=Ky();Uee(t,r.functions),Yee(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),zee(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function QT(t){var e;const n=pm(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function JT(t,e){if(t){const n=pm(),r=n.get(t),i=Ky(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Uee(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){pt(s.message)}})}function Yee(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){pt(r.message)}}}function zee(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){pt(a.message)}}),t.resumeEvaluation())}function Gee(t,e){return(mt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const $H="DD/MM/YYYY";function kH(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function jee(t){return kH(t)?t.substr(1):t}function Kee(t){return typeof t=="string"&&t.startsWith("=")}function Xy(t,e){return typeof t=="string"&&e==="date"}function FH(t,e){return Q(t,e,!0).isValid()}function WH(t,e){return Q(t,e,!0).format($H)}function Xee(t,e){return Q(t,$H,!0).format(e)}function VH(t,e){const r=new Date(Date.UTC(0,0,t+-1));return Q(r).format(e)}function ms(t,e,n){qee(t,e),e.set(t,n)}function qee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){var n=BH(t,e,"get");return Zee(t,n)}function Zee(t,e){return e.get?e.get.call(t):e.value}function wo(t,e,n){var r=BH(t,e,"set");return Qee(t,r,n),n}function BH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Qee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Kl=new WeakMap,Co=new WeakMap,Qn=new WeakMap,Oh=new WeakMap,pw=new WeakMap,ww=new WeakMap,Ih=new WeakMap;class Jee{constructor(e,n,r){ms(this,Kl,{writable:!0,value:void 0}),ms(this,Co,{writable:!0,value:void 0}),ms(this,Qn,{writable:!0,value:void 0}),ms(this,Oh,{writable:!0,value:[]}),ms(this,pw,{writable:!0,value:[]}),ms(this,ww,{writable:!0,value:void 0}),ms(this,Ih,{writable:!0,value:[]}),wo(this,Kl,e),wo(this,Co,n),wo(this,Qn,r)}setRemovedHfIndexes(e){return wo(this,Ih,e.map(n=>{const r=vt(this,Co).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),vt(this,Ih)}getRemovedHfIndexes(){return vt(this,Ih)}getHfIndexFromVisualIndex(e){const n=vt(this,Co).getIndexesSequence(),r=vt(this,Co).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${bn(vt(this,Kl))}s`;vt(this,Qn).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&vt(this,Qn).getEngine()[r](vt(this,Qn).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(wo(this,pw,e.map(i=>this.getHfIndexFromVisualIndex(i))),wo(this,ww,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=vt(this,Co).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(vt(this,Qn).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(vt(this,pw),vt(this,ww)));vt(this,Qn).getSheetId()===null?vt(this,Qn).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${bn(vt(this,Kl))}Order`;return n=>{if(vt(this,Qn).isPerformingUndoRedo())return;const r=vt(this,Co).getIndexesSequence();if(n==="update"){const i=vt(this,Oh).map(l=>r.indexOf(l)),o=vt(this,Qn).getEngine().getSheetDimensions(vt(this,Qn).getSheetId());let s;vt(this,Kl)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);vt(this,Qn).getEngine()[e](vt(this,Qn).getSheetId(),i)}wo(this,Oh,r)}}init(){wo(this,Oh,vt(this,Co).getIndexesSequence())}}const e_=Jee;function ps(t,e,n){ete(t,e),e.set(t,n)}function ete(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ii(t,e){var n=UH(t,e,"get");return tte(t,n)}function tte(t,e){return e.get?e.get.call(t):e.value}function ws(t,e,n){var r=UH(t,e,"set");return nte(t,r,n),n}function UH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ph=new WeakMap,xh=new WeakMap,Cw=new WeakMap,vw=new WeakMap,Sw=new WeakMap,yw=new WeakMap,bw=new WeakMap;class rte{constructor(e,n,r){ps(this,Ph,{writable:!0,value:void 0}),ps(this,xh,{writable:!0,value:void 0}),ps(this,Cw,{writable:!0,value:void 0}),ps(this,vw,{writable:!0,value:!1}),ps(this,Sw,{writable:!0,value:!1}),ps(this,yw,{writable:!0,value:null}),ps(this,bw,{writable:!0,value:null}),ws(this,Ph,new e_("row",e,this)),ws(this,xh,new e_("column",n,this)),ws(this,Cw,r)}getForAxis(e){return e==="row"?Ii(this,Ph):Ii(this,xh)}setPerformUndo(e){ws(this,vw,e)}setPerformRedo(e){ws(this,Sw,e)}isPerformingUndoRedo(){return Ii(this,vw)||Ii(this,Sw)}getSheetId(){return Ii(this,bw)}getEngine(){return Ii(this,yw)}getPostponeAction(){return Ii(this,Cw)}setupSyncEndpoint(e,n){ws(this,yw,e),ws(this,bw,n),Ii(this,Ph).init(),Ii(this,xh).init()}}const ite=rte;function Et(t,e){YH(t,e),e.add(t)}function Ta(t,e,n){return e=ote(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ote(t){var e=ste(t,"string");return typeof e=="symbol"?e:String(e)}function ste(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rw(t,e,n){YH(t,e),e.set(t,n)}function YH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uo(t,e,n){var r=zH(t,e,"set");return ate(t,r,n),n}function ate(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Za(t,e){var n=zH(t,e,"get");return lte(t,n)}function zH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lte(t,e){return e.get?e.get.call(t):e.value}function ft(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Sn="formulas",ute=["maxRows","maxColumns","language"],cte=260;de.getSingleton().register("afterNamedExpressionAdded");de.getSingleton().register("afterNamedExpressionRemoved");de.getSingleton().register("afterSheetAdded");de.getSingleton().register("afterSheetRemoved");de.getSingleton().register("afterSheetRenamed");de.getSingleton().register("afterFormulasValuesUpdate");const gl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Qi=new WeakMap,qy=new WeakMap,Xl=new WeakMap,t_=new WeakSet,n_=new WeakSet,Ew=new WeakSet,r_=new WeakSet,Tw=new WeakSet,i_=new WeakSet,o_=new WeakSet,_w=new WeakSet,s_=new WeakSet,a_=new WeakSet,l_=new WeakSet,u_=new WeakSet,c_=new WeakSet,h_=new WeakSet,d_=new WeakSet,f_=new WeakSet,g_=new WeakSet,m_=new WeakSet,p_=new WeakSet,w_=new WeakSet,C_=new WeakSet,v_=new WeakSet,S_=new WeakSet,y_=new WeakSet;class hte extends nt{constructor(){var e;super(...arguments),e=this,Et(this,y_),Et(this,S_),Et(this,v_),Et(this,C_),Et(this,w_),Et(this,p_),Et(this,m_),Et(this,g_),Et(this,f_),Et(this,d_),Et(this,h_),Et(this,c_),Et(this,u_),Et(this,l_),Et(this,a_),Et(this,s_),Et(this,_w),Et(this,o_),Et(this,i_),Et(this,Tw),Et(this,r_),Et(this,Ew),Et(this,n_),Et(this,t_),Rw(this,Qi,{writable:!0,value:!1}),Rw(this,qy,{writable:!0,value:!1}),Rw(this,Xl,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,p_,Mte).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,w_,Ate).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,C_,Ote).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,v_,Ite).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,S_,Pte).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,y_,xte).call(e,...r)}]]}),Ta(this,"staticRegister",Ur("formulas")),Ta(this,"engine",null),Ta(this,"sheetName",null),Ta(this,"indexSyncer",null),Ta(this,"rowAxisSyncer",null),Ta(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Sn}static get PLUGIN_PRIORITY(){return cte}static get SETTING_KEYS(){return[Sn,...ute]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Sn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Vee(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){pt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,Ew,b_).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,Tw,R_).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,Ew,b_).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,Tw,R_).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,i_,mte).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,o_,pte).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,t_,dte).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,s_,wte).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,_w,E_).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,_w,E_).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,a_,Cte).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,l_,vte).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,h_,bte).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,d_,Rte).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,u_,Ste).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,c_,yte).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,f_,Ete).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,g_,Tte).call(n,...i)}),this.indexSyncer=new ite(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,r_,gte).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,m_,_te).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,n_,fte).call(n,...i)}),Za(this,Xl).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Za(this,Xl).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),JT(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Fee(this.hot.getSettings());Wee(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[Sn];if(ue(r)&&ue(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Sn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Za(this,Xl).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Uo(this,Xl,null),JT(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ue(n)&&!CP(n))return pt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return pt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return pt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){RS(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${bn(Sn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),QT(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ue(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ue(l)===!1||ue(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,d=r(o);if(c!==void 0&&!i.has(d)){const f=QT(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){pt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return Xy(r,o.type)&&(FH(r,o.dateFormat)?r=WH(r,o.dateFormat):Kee(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function dte(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Ln(s)&&(s=VH(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function fte(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const m=this.engine.getFillRangeData(d,f),{row:w,col:v}=d.start,{row:y,col:b}=d.end,_=y-w+1,I=b-v+1;for(let L=0;L<m.length;L+=1)for(let x=0;x<m[L].length;x+=1){const B=m[L][x],z=L%_,ee=x%I,j=this.hot.getCellMeta(z,ee);Xy(B,j.type)&&(B.startsWith("'")?m[L][x]=B.slice(1):this.isFormulaCellType(z,ee,this.sheetId)===!1&&(m[L][x]=Xee(B,j.dateFormat)))}return m}function b_(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(bn(Sn))||Uo(this,qy,mt(this.hot.getSettings().data))}function gte(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;Xy(i,s.type)&&(e=!0,FH(i,a)?t[r][o]=WH(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(Uo(this,Qi,!0),this.engine.setSheetContent(this.sheetId,t),Uo(this,Qi,!1))}function R_(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(bn(Sn)))if(this.sheetName=Gee(this.engine,this.hot.getSettings()[Sn].sheetName),Za(this,qy))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Uo(this,Qi,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Uo(this,Qi,!1)}}}function mte(t,e,n,r){if(r!=="get"||Za(this,Qi)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){kH(n.value)&&(n.value=jee(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&Ln(a)&&(a=VH(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function pte(t,e,n,r){if(r!=="get"||Za(this,Qi)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function E_(t,e){if(gl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),d=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&d!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function wte(t,e){if(gl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Ln(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){pt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Cte(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function vte(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Ste(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function yte(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function bte(t,e,n){if(gl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Rte(t,e,n){if(gl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Ete(t,e,n,r){if(gl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Tte(t,e,n,r){if(gl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function _te(t,e,n){var r;Uo(this,Qi,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Uo(this,Qi,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function Mte(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function Ate(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Ote(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Ite(t){this.hot.runHooks("afterSheetAdded",t)}function Pte(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function xte(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Hte(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Rg,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function Dte(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Eg,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Be(t.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,f=l-a+1;if(d>f){const m=u.slice(i,o+1);c.push(...m.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const d=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===f&&d>o&&c.push(...u.slice(o+1))}return T(c,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function Cs(t,e){GH(t,e),e.add(t)}function T_(t,e,n){GH(t,e),e.set(t,n)}function GH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function tr(t,e){var n=jH(t,e,"get");return Nte(t,n)}function Nte(t,e){return e.get?e.get.call(t):e.value}function ql(t,e,n){var r=jH(t,e,"set");return Lte(t,r,n),n}function jH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("beforeHideColumns");de.getSingleton().register("afterHideColumns");de.getSingleton().register("beforeUnhideColumns");de.getSingleton().register("afterUnhideColumns");const Mw="hiddenColumns",$te=310,KH="beforeHiddenColumnIndicator",XH="afterHiddenColumnIndicator";var ui=new WeakMap,ei=new WeakMap,__=new WeakSet,M_=new WeakSet,A_=new WeakSet,O_=new WeakSet,I_=new WeakSet,P_=new WeakSet,x_=new WeakSet;class qH extends nt{constructor(){super(...arguments),Cs(this,x_),Cs(this,P_),Cs(this,I_),Cs(this,O_),Cs(this,A_),Cs(this,M_),Cs(this,__),T_(this,ui,{writable:!0,value:{}}),T_(this,ei,{writable:!0,value:null})}static get PLUGIN_KEY(){return Mw}static get PLUGIN_PRIORITY(){return $te}isEnabled(){return!!this.hot.getSettings()[Mw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Mw];Fe(n)&&(ql(this,ui,n),mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),ql(this,ei,new kf),tr(this,ei).addLocalHook("init",()=>vs(this,x_,Yte).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,tr(this,ei)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vs(e,P_,Ute).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>vs(this,A_,Wte).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>vs(this,M_,Fte).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return vs(e,I_,Bte).call(e,...i)}),this.addHook("modifyCopyableRange",r=>vs(this,O_,Vte).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(n,r)=>{vs(this,__,kte).call(this,r)};this.hot.columnIndexMapper.unregisterMap(this.pluginName),ql(this,ui,{}),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=tr(this,ei).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));T(l,u=>{o[u]=!1}),i=Ft(o,(u,c,d)=>(c&&u.push(this.hot.toVisualColumn(d)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&tr(this,ei).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{tr(this,ei).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Be(tr(this,ei).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return tr(this,ei).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){ql(this,ui,null),ql(this,ei,null),super.destroy()}}function kte(t){Array.from(t.querySelectorAll(`.${XH}, .${KH}`)).forEach(e=>{e.remove()})}function Fte(t,e){if(this.isHidden(e))return 0;if(tr(this,ui).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Wte(t,e,n){if(tr(this,ui).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Vte(t){if(tr(this,ui).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;me(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Bte(t,e){const n=this.hot.getSettings().ariaTags,r=e.querySelector(".beforeHiddenColumnIndicator"),i=e.querySelector(".afterHiddenColumnIndicator");if(!tr(this,ui).indicators||t<0){r==null||r.remove(),i==null||i.remove();return}const o=[];if(t>=1&&this.isHidden(t-1)){if(!i){const s=n?[Lo(this.hot.getTranslatedPhrase(my))]:[];ks(e,{tagName:"div",attributes:s,className:XH})}o.push("afterHiddenColumn")}if(t<this.hot.countCols()-1&&this.isHidden(t+1)){if(!r){const s=n?[Lo(this.hot.getTranslatedPhrase(gy))]:[];ks(e,{tagName:"div",attributes:s,className:KH})}o.push("beforeHiddenColumn")}J(e,o)}function Ute(t){t.items.push({name:ze},Hte(this),Dte(this))}function Yte(){Array.isArray(tr(this,ui).columns)&&this.hideColumns(tr(this,ui).columns)}function zte(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Tg,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Gte(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(_g,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Be(t.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const d=o-i+1,f=l-a+1;if(d>f){const m=u.slice(i,o+1);c.push(...m.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const d=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===f&&d>o&&c.push(...u.slice(o+1))}return T(c,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function Ss(t,e){ZH(t,e),e.add(t)}function H_(t,e,n){ZH(t,e),e.set(t,n)}function ZH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ys(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function gr(t,e){var n=QH(t,e,"get");return jte(t,n)}function jte(t,e){return e.get?e.get.call(t):e.value}function Zl(t,e,n){var r=QH(t,e,"set");return Kte(t,r,n),n}function QH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Kte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}de.getSingleton().register("beforeHideRows");de.getSingleton().register("afterHideRows");de.getSingleton().register("beforeUnhideRows");de.getSingleton().register("afterUnhideRows");const Aw="hiddenRows",Xte=320,JH="afterHiddenRowIndicator",eD="beforeHiddenRowIndicator";var zi=new WeakMap,ti=new WeakMap,D_=new WeakSet,N_=new WeakSet,L_=new WeakSet,$_=new WeakSet,k_=new WeakSet,F_=new WeakSet,W_=new WeakSet;class tD extends nt{constructor(){super(...arguments),Ss(this,W_),Ss(this,F_),Ss(this,k_),Ss(this,$_),Ss(this,L_),Ss(this,N_),Ss(this,D_),H_(this,zi,{writable:!0,value:{}}),H_(this,ti,{writable:!0,value:null})}static get PLUGIN_KEY(){return Aw}static get PLUGIN_PRIORITY(){return Xte}isEnabled(){return!!this.hot.getSettings()[Aw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Aw];Fe(n)&&(Zl(this,zi,n),mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Zl(this,ti,new kf),gr(this,ti).addLocalHook("init",()=>ys(this,W_,nne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,gr(this,ti)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ys(e,F_,tne).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>ys(this,L_,Qte).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>ys(this,N_,Zte).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ys(e,k_,ene).call(e,...i)}),this.addHook("modifyCopyableRange",r=>ys(this,$_,Jte).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(n,r)=>{ys(this,D_,qte).call(this,r)};this.hot.rowIndexMapper.unregisterMap(this.pluginName),Zl(this,zi,{}),this.hot.addHook("afterGetRowHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetRowHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=gr(this,ti).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));T(l,u=>{o[u]=!1}),i=Ft(o,(u,c,d)=>(c&&u.push(this.hot.toVisualRow(d)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&gr(this,ti).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{gr(this,ti).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Be(gr(this,ti).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return gr(this,ti).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Zl(this,zi,null),Zl(this,ti,null),super.destroy()}}function qte(t){Array.from(t.querySelectorAll(`.${JH}, .${eD}`)).forEach(e=>{e.remove()})}function Zte(t,e){return this.isHidden(e)?0:t}function Qte(t,e,n){if(gr(this,zi).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Jte(t){if(gr(this,zi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;me(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function ene(t,e){const n=this.hot.getSettings().ariaTags,r=e.querySelector(".beforeHiddenRowIndicator"),i=e.querySelector(".afterHiddenRowIndicator");if(!gr(this,zi).indicators||t<0){r==null||r.remove(),i==null||i.remove();return}const o=[];if(t>=1&&this.isHidden(t-1)){if(!i){const s=n?[Lo(this.hot.getTranslatedPhrase(vy))]:[];ks(e,{tagName:"div",attributes:s,className:JH})}o.push("afterHiddenRow")}if(t<this.hot.countRows()-1&&this.isHidden(t+1)){if(!r){const s=n?[Lo(this.hot.getTranslatedPhrase(Cy))]:[];ks(e,{tagName:"div",attributes:s,className:eD})}o.push("beforeHiddenRow")}J(e,o)}function tne(t){t.items.push({name:ze},zte(this),Gte(this))}function nne(){Array.isArray(gr(this,zi).rows)&&this.hideRows(gr(this,zi).rows)}function rne(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Jf)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function ine(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(eg)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function V_(t,e){nD(t,e),e.add(t)}function one(t,e,n){nD(t,e),e.set(t,n)}function nD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mv(t,e){var n=rD(t,e,"get");return sne(t,n)}function sne(t,e){return e.get?e.get.call(t):e.value}function Ow(t,e,n){var r=rD(t,e,"set");return ane(t,r,n),n}function rD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ane(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function B_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeColumnFreeze");de.getSingleton().register("afterColumnFreeze");de.getSingleton().register("beforeColumnUnfreeze");de.getSingleton().register("afterColumnUnfreeze");const U_="manualColumnFreeze",lne=110;var As=new WeakMap,Y_=new WeakSet,z_=new WeakSet;class une extends nt{constructor(){super(...arguments),V_(this,z_),V_(this,Y_),one(this,As,{writable:!0,value:!1})}static get PLUGIN_KEY(){return U_}static get PLUGIN_PRIORITY(){return lne}isEnabled(){return!!this.hot.getSettings()[U_]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>B_(this,Y_,cne).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>B_(this,z_,hne).call(this,e,n)),super.enablePlugin())}disablePlugin(){Ow(this,As,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;mv(this,As)||Ow(this,As,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;mv(this,As)||Ow(this,As,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function cne(t){t.items.push({name:"---------"},rne(this),ine(this))}function hne(t,e){if(mv(this,As)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Hh(t,e,n){return e=dne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dne(t){var e=fne(t,"string");return typeof e=="symbol"?e:String(e)}function fne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Iw=0,G_=1,j_=2,_a="px";let gne=class{constructor(e){Hh(this,"hot",void 0),Hh(this,"_element",null),Hh(this,"state",Iw),Hh(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=j_}build(){this.state===Iw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=G_)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Iw}isAppended(){return this.state===j_}isBuilt(){return this.state>=G_}setPosition(e,n){Ln(e)&&(this._element.style.top=e+_a),Ln(n)&&(this._element.style[this.inlineProperty]=n+_a)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Ln(e)&&(this._element.style.width=e+_a),Ln(n)&&(this._element.style.height=n+_a)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Ln(e)&&(this._element.style.marginTop=e+_a),Ln(n)&&(this._element.style[`margin${bn(this.inlineProperty)}`]=n+_a)}getOffset(){const e=this._element.style,n=`margin${bn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const iD=gne,mne="ht__manualColumnMove--backlight";let pne=class extends iD{build(){super.build(),J(this._element,mne)}};const wne=pne,Cne="ht__manualColumnMove--guideline";let vne=class extends iD{build(){super.build(),J(this._element,Cne)}};const Sne=vne;function Ma(t,e){oD(t,e),e.add(t)}function Pi(t,e,n){oD(t,e),e.set(t,n)}function oD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K_(t,e,n){return e=yne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yne(t){var e=bne(t,"string");return typeof e=="symbol"?e:String(e)}function bne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kn(t,e,n){var r=sD(t,e,"set");return Rne(t,r,n),n}function Rne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Le(t,e){var n=sD(t,e,"get");return Ene(t,n)}function sD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ene(t,e){return e.get?e.get.call(t):e.value}function Aa(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeColumnMove");de.getSingleton().register("afterColumnMove");const Pw="manualColumnMove",Tne=120,X_="ht__manualColumnMove",qd="show-ui",pv="on-moving--columns",wv="after-selection--columns";var Gi=new WeakMap,gd=new WeakMap,Ao=new WeakMap,Nn=new WeakMap,Dh=new WeakMap,hr=new WeakMap,Fa=new WeakMap,Zd=new WeakMap,yu=new WeakMap,q_=new WeakSet,Z_=new WeakSet,Q_=new WeakSet,J_=new WeakSet,eM=new WeakSet,tM=new WeakSet;class _ne extends nt{constructor(){super(...arguments),Ma(this,tM),Ma(this,eM),Ma(this,J_),Ma(this,Q_),Ma(this,Z_),Ma(this,q_),K_(this,"backlight",new wne(this.hot)),K_(this,"guideline",new Sne(this.hot)),Pi(this,Gi,{writable:!0,value:[]}),Pi(this,gd,{writable:!0,value:0}),Pi(this,Ao,{writable:!0,value:!1}),Pi(this,Nn,{writable:!0,value:{}}),Pi(this,Dh,{writable:!0,value:void 0}),Pi(this,hr,{writable:!0,value:void 0}),Pi(this,Fa,{writable:!0,value:void 0}),Pi(this,Zd,{writable:!0,value:void 0}),Pi(this,yu,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Pw}static get PLUGIN_PRIORITY(){return Tne}isEnabled(){return!!this.hot.getSettings()[Pw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Aa(e,q_,Mne).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Aa(e,Q_,One).call(e,...r)}),this.addHook("afterScrollVertically",()=>Aa(this,eM,Pne).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Aa(e,tM,xne).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,X_),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){De(this.hot.rootElement,X_),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=Le(this,Dh),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Kn(this,Dh,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Kn(this,Dh,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Ft(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Pw];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return me(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Le(this,hr))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Le(this,hr)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=this.backlight.getOffset().start,u=this.backlight.getSize().width;let c=0,d=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,v=ut(this.hot.rootElement),y=w.innerWidth-Le(this,Fa)-v;d=w.innerWidth-Le(this,Nn).eventPageX-y-(r.scrollX===void 0?i:0)}else d=Le(this,Nn).eventPageX-(Le(this,Fa)-(r.scrollX===void 0?i:0));if(Le(this,Zd)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Le(this,hr))&&(o+=i),o+=c,Le(this,hr)<0)Le(this,yu)>0?Le(this,Nn).col=0:Le(this,Nn).col=e>0?e-1:e;else if(Le(this,Nn).TD.offsetWidth/2+o<=d){const w=Le(this,hr)>=Le(this,gd)?Le(this,gd)-1:Le(this,hr);Le(this,Nn).col=w+1,o+=Le(this,Nn).TD.offsetWidth}else Le(this,Nn).col=Le(this,hr);let f=d,m=o;d+u+l>=s?f=s-u-l:d+l<a+c&&(f=a+c+Math.abs(l)),o>=s-1?m=s-1:m===0?m=1:r.scrollX!==void 0&&Le(this,hr)<Le(this,yu)&&(m-=Le(this,Fa)<=r.scrollX?Le(this,Fa):0),this.backlight.setPosition(null,f),this.guideline.setPosition(null,m)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Aa(this,Z_,Ane).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Aa(this,J_,Ine).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function Mne(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Ie(t.target,"sortAction");if(!s||!o||Le(this,Ao)||t.button!==0||a){Kn(this,Ao,!1),Le(this,Gi).length=0,De(this.hot.rootElement,[pv,qd]);return}const l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:d}=s,f=Math.min(c.col,d.col),m=Math.max(c.col,d.col);if(e.row<0&&e.col>=f&&e.col<=m){r.column=!0,Kn(this,Ao,!0);const w=n.firstChild?EI(t,n.firstChild).x:t.offsetX;Le(this,Nn).eventPageX=t.pageX,Kn(this,hr,e.col),Le(this,Nn).TD=n,Le(this,Nn).col=e.col,Kn(this,Gi,this.prepareColumnsToMoving(f,m)),Kn(this,Zd,!!this.hot.getSettings().rowHeaders),Kn(this,gd,this.hot.countCols()),Kn(this,yu,this.hot.getSettings().fixedColumnsStart),Kn(this,Fa,Bt(this.hot.rootElement).left);const v=Le(this,Zd)?-1:0,y=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,b=e.col<Le(this,yu),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),I=Math.abs(w-(this.hot.isRtl()?n.offsetWidth:0)),L=this.getColumnsWidth(f,e.col-1)+I,x=this.getColumnsWidth(v,f-1)+(b?_:0)+L;this.backlight.setPosition(y,x),this.backlight.setSize(this.getColumnsWidth(f,m),i.hider.offsetHeight-y),this.backlight.setOffset(null,-L),J(this.hot.rootElement,pv)}else De(this.hot.rootElement,wv),Kn(this,Ao,!1),Le(this,Gi).length=0}function Ane(t){Le(this,Ao)&&(Le(this,Nn).eventPageX=t.pageX,this.refreshPositions())}function One(t,e,n,r){!this.hot.getSelectedRangeLast()||!Le(this,Ao)||(Le(this,Gi).indexOf(e.col)>-1?De(this.hot.rootElement,qd):J(this.hot.rootElement,qd),r.row=!0,r.column=!0,r.cell=!0,Kn(this,hr,e.col),Le(this,Nn).TD=n)}function Ine(){const t=Le(this,Nn).col,e=Le(this,Gi).length;if(Kn(this,hr,void 0),Kn(this,Ao,!1),De(this.hot.rootElement,[pv,qd,wv]),this.hot.selection.isSelectedByColumnHeader()&&J(this.hot.rootElement,wv),e<1||t===void 0)return;const n=Le(this,Gi)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Le(this,Gi),t);if(Le(this,Gi).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Pne(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;this.backlight.setPosition(r),this.backlight.setSize(null,t.hider.offsetHeight-r)}function xne(){this.moveBySettingsOrLoad()}function xi(t,e){aD(t,e),e.add(t)}function Hne(t,e,n){aD(t,e),e.set(t,n)}function aD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pn(t,e,n){return e=Dne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dne(t){var e=Nne(t,"string");return typeof e=="symbol"?e:String(e)}function Nne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nM(t,e){var n=uD(t,e,"get");return Lne(t,n)}function Lne(t,e){return e.get?e.get.call(t):e.value}function lD(t,e,n){var r=uD(t,e,"set");return $ne(t,r,n),n}function uD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $ne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Hi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Qd="manualColumnResize",kne=130,rM="manualColumnWidths";var bu=new WeakMap,iM=new WeakSet,oM=new WeakSet,sM=new WeakSet,aM=new WeakSet,lM=new WeakSet,uM=new WeakSet,cM=new WeakSet,hM=new WeakSet,dM=new WeakSet;class Fne extends nt{static get PLUGIN_KEY(){return Qd}static get PLUGIN_PRIORITY(){return kne}constructor(e){super(e),xi(this,dM),xi(this,hM),xi(this,cM),xi(this,uM),xi(this,lM),xi(this,aM),xi(this,sM),xi(this,oM),xi(this,iM),Pn(this,"currentTH",null),Pn(this,"currentCol",null),Pn(this,"selectedCols",[]),Pn(this,"currentWidth",null),Pn(this,"newSize",null),Pn(this,"startY",null),Pn(this,"startWidth",null),Pn(this,"startOffset",null),Pn(this,"handle",this.hot.rootDocument.createElement("DIV")),Pn(this,"guide",this.hot.rootDocument.createElement("DIV")),Pn(this,"pressed",null),Pn(this,"isTriggeredByRMB",!1),Pn(this,"dblclick",0),Pn(this,"autoresizeTimeout",null),Pn(this,"columnWidthsMap",void 0),Hne(this,bu,{writable:!0,value:void 0}),J(this.handle,"manualColumnResizer"),J(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Qd]}enablePlugin(){this.enabled||(this.columnWidthsMap=new zo,this.columnWidthsMap.addLocalHook("init",()=>Hi(this,iM,Wne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,n)=>Hi(this,cM,Gne).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>Hi(this,hM,jne).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>Hi(this,dM,Kne).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){lD(this,bu,this.columnWidthsMap.getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",rM,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",rM,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(this.currentTH),i=r.col;if(i<0)return;const o=Ot(this.currentTH),s=this.currentTH.getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),this.selectedCols=[];const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();T(c,d=>{const f=d.getTopStartCorner().col,m=d.getBottomEndCorner().col;me(f,m,w=>{this.selectedCols.includes(w)||this.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(s.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${o}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(Ot(this.handle),10),n=parseInt(this.handle.style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);J(this.handle,"active"),J(this.guide,"active"),this.guide.style.top=`${n}px`,this.refreshGuidePosition(),this.guide.style.height=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){De(this.handle,"active"),De(this.guide,"active")}checkIfColumnHeader(e){return!!$o(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",this.newSize,r,!0);o!==void 0&&(this.newSize=o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!0),i&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(T(this.selectedCols,i=>{n(i)}),e()):T(this.selectedCols,i=>{n(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>Hi(this,oM,Vne).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>Hi(this,sM,Bne).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>Hi(this,aM,Une).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Hi(this,lM,Yne).call(this)),this.eventManager.addEventListener(this.handle,"contextmenu",()=>Hi(this,uM,zne).call(this))}destroy(){super.destroy()}}function Wne(){const t=this.hot.getSettings()[Qd],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0),lD(this,bu,t)):t===!0&&Array.isArray(nM(this,bu))&&this.hot.batchExecution(()=>{nM(this,bu).forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0)}function Vne(t){if(!fS(t.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(this.pressed||this.setupHandlePosition(e))}}function Bne(t){Ie(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}function Une(t){if(this.pressed){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+e,T(this.selectedCols,n=>{this.newSize=this.setManualSize(n,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function Yne(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",this.newSize,n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(T(this.selectedCols,r=>{e(r)}),t()):T(this.selectedCols,r=>{e(r,!0)})),this.setupHandlePosition(this.currentTH))}function zne(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}function Gne(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[Qd]&&i&&(n=i)}return n}function jne(t,e){let n=this.columnWidthsMap.getValueAtIndex(e);return n===null&&(n=t),n}function Kne(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function xw(t,e,n){return e=Xne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xne(t){var e=qne(t,"string");return typeof e=="symbol"?e:String(e)}function qne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Hw=0,fM=1,gM=2,Oa="px";let Zne=class{constructor(e){xw(this,"hot",void 0),xw(this,"_element",null),xw(this,"state",Hw),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=gM}build(){this.state===Hw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=fM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Hw}isAppended(){return this.state===gM}isBuilt(){return this.state>=fM}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Oa),n!==void 0&&(this._element.style.left=n+Oa)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Oa),n&&(this._element.style.height=n+Oa)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Oa),n&&(this._element.style.marginLeft=n+Oa)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const cD=Zne,Qne="ht__manualRowMove--backlight";class Jne extends cD{build(){super.build(),J(this._element,Qne)}}const ere=Jne,tre="ht__manualRowMove--guideline";class nre extends cD{build(){super.build(),J(this._element,tre)}}const rre=nre;function Ia(t,e){hD(t,e),e.add(t)}function Nh(t,e,n){hD(t,e),e.set(t,n)}function hD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mM(t,e,n){return e=ire(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ire(t){var e=ore(t,"string");return typeof e=="symbol"?e:String(e)}function ore(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ds(t,e,n){var r=dD(t,e,"set");return sre(t,r,n),n}function sre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Mt(t,e){var n=dD(t,e,"get");return are(t,n)}function dD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function are(t,e){return e.get?e.get.call(t):e.value}function Pa(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeRowMove");de.getSingleton().register("afterRowMove");const Dw="manualRowMove",lre=140,pM="ht__manualRowMove",Jd="show-ui",Cv="on-moving--rows",vv="after-selection--rows";var ji=new WeakMap,Oo=new WeakMap,Xn=new WeakMap,Lh=new WeakMap,wM=new WeakSet,CM=new WeakSet,vM=new WeakSet,SM=new WeakSet,yM=new WeakSet,bM=new WeakSet;class fD extends nt{constructor(){super(...arguments),Ia(this,bM),Ia(this,yM),Ia(this,SM),Ia(this,vM),Ia(this,CM),Ia(this,wM),mM(this,"backlight",new ere(this.hot)),mM(this,"guideline",new rre(this.hot)),Nh(this,ji,{writable:!0,value:[]}),Nh(this,Oo,{writable:!0,value:void 0}),Nh(this,Xn,{writable:!0,value:{}}),Nh(this,Lh,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Dw}static get PLUGIN_PRIORITY(){return lre}isEnabled(){return!!this.hot.getSettings()[Dw]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pa(e,wM,ure).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pa(e,vM,hre).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Pa(this,yM,fre).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pa(e,bM,gre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,pM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){De(this.hot.rootElement,pM),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Mt(this,Lh),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Ds(this,Lh,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return Ds(this,Lh,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Ft(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Dw];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return me(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Mt(this,Xn).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Mt(this,Xn).TD,a=this.hot.rootElement,l=Bt(a),u=$s(a),c=o.holder.scrollTop,d=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-d,m=Mt(this,Xn).eventPageY-f+c,w=o.hider.offsetHeight,v=o.TBODY.offsetTop,y=this.backlight.getOffset().top,b=this.backlight.getSize().height,_=s.offsetHeight/2,I=s.offsetHeight;let L=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const x=m>=L+_;this.isFixedRowTop(e.row)&&(L+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Mt(this,Xn).row=n>0?n-1:n:x?(Mt(this,Xn).row=e.row+1,L+=e.row===0?I-1:I):Mt(this,Xn).row=e.row;let B=m,z=L;m+b+y>=w?B=w-b-y:m+y<v&&(B=v+Math.abs(y)),L>=w-1&&(z=w-1),this.backlight.setPosition(B),this.guideline.setPosition(z)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Pa(this,CM,cre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Pa(this,SM,dre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function ure(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Mt(this,Oo)||t.button!==0){Ds(this,Oo,!1),Mt(this,ji).length=0,De(this.hot.rootElement,[Cv,Jd]);return}const l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:d}=a,f=Math.min(c.row,d.row),m=Math.max(c.row,d.row);if(e.col<0&&e.row>=f&&e.row<=m){r.row=!0,Ds(this,Oo,!0),Mt(this,Xn).eventPageY=t.pageY,Mt(this,Xn).coords=e,Mt(this,Xn).TD=n,Ds(this,ji,this.prepareRowsToMoving());const w=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(f,e.row-1)+t.offsetY;this.backlight.setPosition(null,w),this.backlight.setSize(i.hider.offsetWidth-w,this.getRowsHeight(f,m)),this.backlight.setOffset(-v,null),J(this.hot.rootElement,Cv),this.refreshPositions()}else De(this.hot.rootElement,vv),Ds(this,Oo,!1),Mt(this,ji).length=0}function cre(t){Mt(this,Oo)&&(Mt(this,Xn).eventPageY=t.pageY,this.refreshPositions())}function hre(t,e,n,r){!this.hot.getSelectedRangeLast()||!Mt(this,Oo)||(Mt(this,ji).indexOf(e.row)>-1?De(this.hot.rootElement,Jd):J(this.hot.rootElement,Jd),r.row=!0,r.column=!0,r.cell=!0,Mt(this,Xn).coords=e,Mt(this,Xn).TD=n)}function dre(){const t=Mt(this,Xn).row,e=Mt(this,ji).length;if(Ds(this,Oo,!1),De(this.hot.rootElement,[Cv,Jd,vv]),this.hot.selection.isSelectedByRowHeader()&&J(this.hot.rootElement,vv),e<1||t===void 0)return;const n=Mt(this,ji)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Mt(this,ji),t);if(Mt(this,ji).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function fre(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;this.backlight.setPosition(null,r),this.backlight.setSize(t.hider.offsetWidth-r)}function gre(){this.moveBySettingsOrLoad()}function bs(t,e){gD(t,e),e.add(t)}function mre(t,e,n){gD(t,e),e.set(t,n)}function gD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xn(t,e,n){return e=pre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pre(t){var e=wre(t,"string");return typeof e=="symbol"?e:String(e)}function wre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RM(t,e){var n=pD(t,e,"get");return Cre(t,n)}function Cre(t,e){return e.get?e.get.call(t):e.value}function mD(t,e,n){var r=pD(t,e,"set");return vre(t,r,n),n}function pD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Rs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const ef="manualRowResize",Sre=30,EM="manualRowHeights";var Ru=new WeakMap,TM=new WeakSet,_M=new WeakSet,MM=new WeakSet,AM=new WeakSet,OM=new WeakSet,IM=new WeakSet,PM=new WeakSet;class yre extends nt{static get PLUGIN_KEY(){return ef}static get PLUGIN_PRIORITY(){return Sre}constructor(e){super(e),bs(this,PM),bs(this,IM),bs(this,OM),bs(this,AM),bs(this,MM),bs(this,_M),bs(this,TM),xn(this,"currentTH",null),xn(this,"currentRow",null),xn(this,"selectedRows",[]),xn(this,"currentHeight",null),xn(this,"newSize",null),xn(this,"startY",null),xn(this,"startHeight",null),xn(this,"startOffset",null),xn(this,"handle",this.hot.rootDocument.createElement("DIV")),xn(this,"guide",this.hot.rootDocument.createElement("DIV")),xn(this,"pressed",!1),xn(this,"isTriggeredByRMB",!1),xn(this,"dblclick",0),xn(this,"autoresizeTimeout",null),xn(this,"rowHeightsMap",void 0),mre(this,Ru,{writable:!0,value:void 0}),J(this.handle,"manualRowResizer"),J(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ef]}enablePlugin(){this.enabled||(this.rowHeightsMap=new zo,this.rowHeightsMap.addLocalHook("init",()=>Rs(this,PM,Are).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,n)=>Rs(this,IM,Mre).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){mD(this,Ru,this.rowHeightsMap.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",EM,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",EM,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,GI.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(r,i),i}setupHandlePosition(e){this.currentTH=e;const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(this.currentTH),o=i.row;if(o<0)return;const s=ut(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.selectedRows=[];const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const f=this.hot.getSelectedRange();T(f,m=>{const w=m.getTopStartCorner().row,v=m.getBottomStartCorner().row;me(w,v,y=>{this.selectedRows.includes(y)||this.selectedRows.push(y)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${c.start}px`,this.handle.style.width=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(ut(this.handle),10),n=parseInt(this.handle.style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);J(this.handle,"active"),J(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${n}px`,this.guide.style.width=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){De(this.handle,"active"),De(this.guide,"active")}checkIfRowHeader(e){var n;return $o(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&this.newSize<n?n:this.newSize}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&(this.newSize=o),this.setManualSize(r,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(T(this.selectedRows,i=>{n(i)}),e()):T(this.selectedRows,i=>{n(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Rs(this,TM,bre).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Rs(this,_M,Rre).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Rs(this,MM,Ere).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Rs(this,AM,Tre).call(this)),this.eventManager.addEventListener(this.handle,"contextmenu",()=>Rs(this,OM,_re).call(this))}destroy(){super.destroy()}}function bre(t){if(!fS(t.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}function Rre(t){Ie(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}function Ere(t){this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),T(this.selectedRows,e=>{this.newSize=this.setManualSize(e,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Tre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(T(this.selectedRows,r=>{e(r)}),t()):T(this.selectedRows,r=>{e(r,!0)})),this.setupHandlePosition(this.currentTH))}function _re(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}function Mre(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[ef]&&i&&(n=i)}return n}function Are(){const t=this.hot.getSettings()[ef],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)}),mD(this,Ru,t)):t===!0&&Array.isArray(RM(this,Ru))&&RM(this,Ru).forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)})},!0)}function Es(t,e,n){return e=Ore(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ore(t){var e=Ire(t,"string");return typeof e=="symbol"?e:String(e)}function Ire(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pre{constructor(e,n,r,i,o,s){Es(this,"row",void 0),Es(this,"col",void 0),Es(this,"rowspan",void 0),Es(this,"colspan",void 0),Es(this,"removed",!1),Es(this,"cellCoordsFactory",void 0),Es(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ct`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ct`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const d=l-u+1,f=Math.abs(r)-d;this[s]-=f+r,this[o]-=d}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const d=c-a+1;this[o]-=d}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const oi=Pre;function Sv(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Nw(t,e,n){return e=xre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xre(t){var e=Hre(t,"string");return typeof e=="symbol"?e:String(e)}function Hre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zy{constructor(e){Nw(this,"plugin",void 0),Nw(this,"mergedCells",[]),Nw(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return T(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return T(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return T(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new oi(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(pt(Zy.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];T(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,T(n,(i,o)=>{me(0,i.rowspan-1,s=>{me(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),T(n,i=>{Sv(...i)}),T(r,i=>{Sv(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return T(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}T(this.mergedCells,o=>{o.shift(i,n)}),Dd(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const Dre=Zy;function Lw(t,e,n){return e=Nre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nre(t){var e=Lre(t,"string");return typeof e=="symbol"?e:String(e)}function Lre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $re{constructor(e){Lw(this,"plugin",void 0),Lw(this,"mergedCellsCollection",void 0),Lw(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,f=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,m=Math.floor(s/f)*f,w=s-m,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const y=v.row+v.rowspan-a-w;o[2]+y>=this.plugin.hot.countRows()?o[2]-=w:o[2]+=w?y:0}else if(r==="right"){const y=v.col+v.colspan-l-w;o[3]+y>=this.plugin.hot.countCols()?o[3]-=w:o[3]+=w?y:0}else if(r==="up"){const y=u-w-v.row+1;o[0]+y<0?o[0]+=w:o[0]-=w?y:0}else if(r==="left"){const y=c-w-v.col+1;o[1]+y<0?o[1]+=w:o[1]-=w?y:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Ut(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return d-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,d]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,d];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,d=u?o:s,f=this.getAutofillSize(e,n,r),m=u?a-o+1:l-s+1,w=Math.floor(f/m)*m,v=f-w;let y=null,b=null,_=null;switch(r){case"up":y="includesVertically",_=c-v+1;break;case"left":y="includesHorizontally",_=c-v+1;break;case"down":y="includesVertically",_=d+v-1;break;case"right":y="includesHorizontally",_=d+v-1;break}return T(i,I=>{I[y](_)&&I.isFarther(b,r)&&(b=I)}),b}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return T(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}const kre=$re;function $w(t,e,n){return e=Fre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fre(t){var e=Wre(t,"string");return typeof e=="symbol"?e:String(e)}function Wre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vre{constructor(e){$w(this,"plugin",void 0),$w(this,"hot",void 0),$w(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const d=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=d&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const Bre=Vre;function Ure(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(ng)}return this.getTranslatedPhrase(tg)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?oi.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function kt(t,e){wD(t,e),e.add(t)}function Yre(t,e,n){wD(t,e),e.set(t,n)}function wD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kw(t,e,n){return e=zre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zre(t){var e=Gre(t,"string");return typeof e=="symbol"?e:String(e)}function Gre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fw(t,e,n){var r=CD(t,e,"set");return jre(t,r,n),n}function jre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function xa(t,e){var n=CD(t,e,"get");return Kre(t,n)}function CD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Kre(t,e){return e.get?e.get.call(t):e.value}function Pt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}de.getSingleton().register("beforeMergeCells");de.getSingleton().register("afterMergeCells");de.getSingleton().register("beforeUnmergeCells");de.getSingleton().register("afterUnmergeCells");const Eu="mergeCells",Xre=150,xM=Eu;var ri=new WeakMap,HM=new WeakSet,DM=new WeakSet,NM=new WeakSet,LM=new WeakSet,$M=new WeakSet,kM=new WeakSet,FM=new WeakSet,Ww=new WeakSet,WM=new WeakSet,VM=new WeakSet,BM=new WeakSet,UM=new WeakSet,YM=new WeakSet,zM=new WeakSet,GM=new WeakSet,jM=new WeakSet,KM=new WeakSet,XM=new WeakSet,qM=new WeakSet,ZM=new WeakSet,QM=new WeakSet,JM=new WeakSet;class qre extends nt{constructor(){super(...arguments),kt(this,JM),kt(this,QM),kt(this,ZM),kt(this,qM),kt(this,XM),kt(this,KM),kt(this,jM),kt(this,GM),kt(this,zM),kt(this,YM),kt(this,UM),kt(this,BM),kt(this,VM),kt(this,WM),kt(this,Ww),kt(this,FM),kt(this,kM),kt(this,$M),kt(this,LM),kt(this,NM),kt(this,DM),kt(this,HM),kw(this,"mergedCellsCollection",null),kw(this,"autofillCalculations",null),kw(this,"selectionCalculations",null),Yre(this,ri,{writable:!0,value:null})}static get PLUGIN_KEY(){return Eu}static get PLUGIN_PRIORITY(){return Xre}isEnabled(){return!!this.hot.getSettings()[Eu]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new Dre(this),this.autofillCalculations=new kre(this),this.selectionCalculations=new Bre(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,HM,Zre).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,NM,Jre).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,ZM,mie).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,LM,eie).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,$M,tie).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,Ww,e1).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,Ww,e1).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,WM,iie).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,DM,Qre).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,FM,rie).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,kM,nie).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,VM,oie).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,BM,sie).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,UM,aie).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,YM,lie).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,zM,uie).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,GM,cie).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,jM,hie).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,KM,die).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,XM,fie).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,qM,gie).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,QM,pie).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pt(e,JM,wie).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Eu];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!CS())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=Qa(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Qa(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(oi.containsNegativeValues(e)?(pt(oi.NEGATIVE_VALUES_WARNING(e)),n=!1):oi.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(pt(oi.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):oi.isSingleCell(e)?(pt(oi.IS_SINGLE_CELL(e)),n=!1):oi.containsZeroSpan(e)&&(pt(oi.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(T(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),me(r.row,r.row+r.rowspan-1,a=>{me(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),me(0,s.rowspan-1,c=>{me(0,s.colspan-1,d=>{let f=null;a[c]||(a[c]=[]),c===0&&d===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+d,"hidden",!0),a[c][d]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),T(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),me(0,i.rowspan-1,o=>{me(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:xM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(xM)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Fe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Fe(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Fe(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Fe(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Zre(){this.generateFromSettings(this.hot.getSettings()[Eu]),this.hot.render()}function Qre(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function Jre(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(xa(this,ri)||Fw(this,ri,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(xa(this,ri))||Fw(this,ri,this.hot._createCellCoords(null,null)),n.row=xa(this,ri).row?xa(this,ri).row-i.row:n.row,n.col=xa(this,ri).col?xa(this,ri).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);Fw(this,ri,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function eie(t){const e=this.hot.getSelectedRangeLast(),n=$n(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=$n(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=$n(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),T(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function tie(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function nie(t){t.items.push({name:"---------"},Ure(this))}function rie(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Fe(r)?$n(r):void 0;if(Fe(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[d,f]=this.translateMergedCellToRenderable(a,c,l,u),m=o.getRenderableFromVisualIndex(e),w=s.getRenderableFromVisualIndex(n),v=d-m+1,y=f-w+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,v),i.colspan=Math.min(i.colspan,y)}Sv(t,i,e,n)}function e1(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function iie(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function oie(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function sie(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function aie(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function lie(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function uie(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function cie(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function hie(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function die(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function fie(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function gie(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);T(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function mie(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,d=r.col===0;(i&&l||o&&u||a&&c||s&&d)&&(t.row=r.row,t.col=r.col)}function pie(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function wie(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Cie(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],d=o[a],f=u.multiColumnSorting,w=(f.compareFunctionFactory?f.compareFunctionFactory:Dx(u.type))(l,u,f)(c,d);if(w===ci){const v=a+1;if(typeof e[v]<"u")return s(v)}return w}(0)}}function t1(){pt(ct`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const vD="sort";function vie(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${vD}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Sie(t){const e=t.className.split(" "),n=new RegExp(`^${vD}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function yie(t,e,n){return e=bie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bie(t){var e=Rie(t,"string");return typeof e=="symbol"?e:String(e)}function Rie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tf="multiColumnSorting",Eie=170,n1="columnSorting",r1=tf;Hx(tf,Cie);class SD extends Nx{constructor(){super(...arguments),yie(this,"pluginKey",tf)}static get PLUGIN_KEY(){return tf}static get PLUGIN_PRIORITY(){return Eie}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[n1]&&t1(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Yd))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:r1})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(r1)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),De(e,Sie(e)),this.enabled!==!1&&J(e,vie(...r))}updateSortingIndicator(e,n){super.updateSortingIndicator(e,n);const r=n.querySelector(".columnSortingIndicator");if(!r||!this.hot.getSettings().ariaTags||!this.columnStatesManager.isColumnSorted(e)||this.columnStatesManager.getNumberOfSortedColumns()<=1)return;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e)+1,o=Lo(`${this.hot.getTranslatedPhrase(dy)} ${i}.`);Yo(r,no()[0]),ve(r,...o)}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[n1]&&t1(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){Fy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Yd))):this.sort(this.getColumnNextConfig(n.col)))}}function i1(t,e,n){return e=Tie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tie(t){var e=_ie(t,"string");return typeof e=="symbol"?e:String(e)}function _ie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Mie="multipleSelectionHandles",Aie=160;class Oie extends nt{constructor(){super(...arguments),i1(this,"dragged",[]),i1(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Mie}static get PLUGIN_PRIORITY(){return Aie}isEnabled(){return Bi()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Ie(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Ie(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Ie(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Ie(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,d;if(e.dragged.length===0)return;const f=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),d=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function yv(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function yD(){return{label:"",isPlaceholder:!0}}function Iie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;T(t,i=>{const o=[];let s=0;n.push(o),T(i,a=>{const l=yv();if(Fe(a)){const{label:c,colspan:d}=a;l.label=Nt(c),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=Nt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(yD());return!u})});const r=Math.max(...Be(n,i=>i.length));return T(n,i=>{if(i.length<r){const o=Be(new Array(r-i.length),()=>yv());i.splice(i.length,0,...o)}}),n}function Vw(t,e,n){Pie(t,e),e.set(t,n)}function Pie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Or(t,e){var n=bD(t,e,"get");return xie(t,n)}function xie(t,e){return e.get?e.get.call(t):e.value}function Ql(t,e,n){var r=bD(t,e,"set");return Hie(t,r,n),n}function bD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Hie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const o1=["label","collapsible"];var Di=new WeakMap,Ts=new WeakMap,Bw=new WeakMap;class Die{constructor(){Vw(this,Di,{writable:!0,value:[]}),Vw(this,Ts,{writable:!0,value:0}),Vw(this,Bw,{writable:!0,value:1/0})}setColumnsLimit(e){Ql(this,Bw,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Ql(this,Di,Iie(e,Or(this,Bw))),Ql(this,Ts,Or(this,Di).length)}getData(){return Or(this,Di)}mergeWith(e){T(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&Ut(s,o,o1)})}map(e){T(Or(this,Di),n=>{T(n,r=>{const i=e({...r});Fe(i)&&Ut(r,i,o1)})})}getHeaderSettings(e,n){var r;if(e>=Or(this,Ts)||e<0)return null;const i=Or(this,Di)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Or(this,Ts)||e<0)return i;const o=Or(this,Di)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Or(this,Ts)}getColumnsCount(){return Or(this,Ts)>0?Or(this,Di)[0].length:0}clear(){Ql(this,Di,[]),Ql(this,Ts,0)}}function Uw(t,e,n){return e=Nie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:String(e)}function Lie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RD="DF-pre-order";function ED(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=ED.call(this.childs[r],t,e)}return n}const $ie="DF-post-order";function TD(t,e){for(let n=0;n<this.childs.length;n++)if(TD.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const _D="BF";function kie(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Fie=_D,s1=new Map([[RD,ED],[$ie,TD],[_D,kie]]);class nf{constructor(e){Uw(this,"data",{}),Uw(this,"parent",null),Uw(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new nf({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Fie;if(!s1.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);s1.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function Yw(t,e,n){Wie(t,e),e.set(t,n)}function Wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hn(t,e){var n=MD(t,e,"get");return Vie(t,n)}function Vie(t,e){return e.get?e.get.call(t):e.value}function Bie(t,e,n){var r=MD(t,e,"set");return Uie(t,r,n),n}function MD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Uie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ha=new WeakMap,_s=new WeakMap,Da=new WeakMap;class Yie{constructor(e){Yw(this,Ha,{writable:!0,value:new Map}),Yw(this,_s,{writable:!0,value:new Map}),Yw(this,Da,{writable:!0,value:null}),Bie(this,Da,e)}getRoots(){return Array.from(Hn(this,Ha).values())}getRootByColumn(e){let n;return Hn(this,_s).has(e)&&(n=Hn(this,Ha).get(Hn(this,_s).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Hn(this,_s).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Hn(this,_s).clear(),T(Hn(this,Ha),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Hn(this,_s).set(i,e);e+=r})}buildTree(){this.clear();const e=Hn(this,Da).getColumnsCount();let n=0;for(;n<e;){const r=Hn(this,Da).getHeaderSettings(0,n),i=new nf;Hn(this,Ha).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Hn(this,Da).getHeadersSettings(r,n,i);r+=1,T(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new nf(a),e.addChild(l)),r<Hn(this,Da).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Hn(this,Ha).clear(),Hn(this,_s).clear()}}function AD(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function rf(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function of(t){return rf(t,"origColspan")===t.data.origColspan}function Qy(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(of(t))return Qy(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)T(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,AD(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):of(a)&&(l.isCollapsed=rf(a,"isCollapsed"))}),{rollbackModification:()=>Jy(t),affectedColumns:Array.from(o),colspanCompensation:s}}function Jy(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(of(t))return Jy(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)T(o,l=>{AD(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const d=u+c;s.add(d)}}const a=n.colspan-((e=rf(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):of(l)&&(u.isCollapsed=rf(l,"isCollapsed"))}),{rollbackModification:()=>Qy(t),affectedColumns:Array.from(s),colspanCompensation:a}}function zie(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function Gie(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const a1=new Map([["collapse",Jy],["expand",Qy],["hide-column",zie],["show-column",Gie]]);function jie(t,e,n){if(!a1.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return a1.get(t)(e,n)}function $h(t){const e=[];return T(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=Xie(e,a);let c=!1;for(let d=s;d<s+o;d++)if(l.includes(d)||c)u.push(yD());else{const m=Kie(i);m.isRoot=!0,u.push(m),c=!0}})}),e}function Kie(t){const{crossHiddenColumns:e,...n}=yv(t);return n}function Xie(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function zw(t,e,n){qie(t,e),e.set(t,n)}function qie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jl(t,e,n){var r=OD(t,e,"set");return Zie(t,r,n),n}function Zie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function xt(t,e){var n=OD(t,e,"get");return Qie(t,n)}function OD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Qie(t,e){return e.get?e.get.call(t):e.value}var ni=new WeakMap,Un=new WeakMap,Ms=new WeakMap;class Jie{constructor(){zw(this,ni,{writable:!0,value:new Die}),zw(this,Un,{writable:!0,value:new Yie(xt(this,ni))}),zw(this,Ms,{writable:!0,value:[[]]})}setState(e){xt(this,ni).setData(e);let n=!1;try{xt(this,Un).buildTree()}catch{xt(this,Un).clear(),xt(this,ni).clear(),n=!0}return Jl(this,Ms,$h(xt(this,Un).getRoots())),n}setColumnsLimit(e){xt(this,ni).setColumnsLimit(e)}mergeStateWith(e){const n=Be(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});xt(this,ni).mergeWith(n),xt(this,Un).buildTree(),Jl(this,Ms,$h(xt(this,Un).getRoots()))}mapState(e){xt(this,ni).map(e),xt(this,Un).buildTree(),Jl(this,Ms,$h(xt(this,Un).getRoots()))}mapNodes(e){return Ft(xt(this,Un).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=xt(this,Un).getNode(n,r);let o;return i&&(o=jie(e,i,r),Jl(this,Ms,$h(xt(this,Un).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=xt(this,Ms)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=xt(this,Un).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=xt(this,Un).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:d,origColspan:f,isHidden:m}=u.data;m||f<=i&&c>=e&&c+f-1<=r&&(s===null||d<s)&&(s=d)},RD)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return xt(this,ni).getLayersCount()}getColumnsCount(){return xt(this,ni).getColumnsCount()}clear(){Jl(this,Ms,[]),xt(this,ni).clear(),xt(this,Un).clear()}}function eu(t,e,n){return e=eoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eoe(t){var e=toe(t,"string");return typeof e=="symbol"?e:String(e)}function toe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class noe{constructor(e,n){eu(this,"hot",void 0),eu(this,"nestedHeaderSettingsGetter",void 0),eu(this,"layersCount",0),eu(this,"container",void 0),eu(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let d=r.getVisualFromRenderableIndex(c);d===null&&(d=c);const f=n.createElement("th"),m=this.nestedHeaderSettingsGetter(l,d);if(m&&(!m.isPlaceholder||m.isHidden)){let w=m.label;s&&(w+='<button class="changeType"></button>'),Ks(f,w),f.colSpan=m.colspan,u.appendChild(f)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const roe=noe;function rn(t,e){ID(t,e),e.add(t)}function l1(t,e,n){return e=ioe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ioe(t){var e=ooe(t,"string");return typeof e=="symbol"?e:String(e)}function ooe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kh(t,e,n){ID(t,e),e.set(t,n)}function ID(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ns(t,e,n){var r=PD(t,e,"set");return soe(t,r,n),n}function soe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function et(t,e){var n=PD(t,e,"get");return aoe(t,n)}function PD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aoe(t,e){return e.get?e.get.call(t):e.value}function jt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const u1="nestedHeaders",loe=280;var lt=new WeakMap,vo=new WeakMap,Tu=new WeakMap,wm=new WeakMap,Fh=new WeakSet,c1=new WeakSet,h1=new WeakSet,d1=new WeakSet,f1=new WeakSet,g1=new WeakSet,m1=new WeakSet,p1=new WeakSet,w1=new WeakSet,C1=new WeakSet,v1=new WeakSet,S1=new WeakSet,y1=new WeakSet,b1=new WeakSet,R1=new WeakSet,E1=new WeakSet,T1=new WeakSet,_1=new WeakSet;class uoe extends nt{constructor(){super(...arguments),rn(this,_1),rn(this,T1),rn(this,E1),rn(this,R1),rn(this,b1),rn(this,y1),rn(this,S1),rn(this,v1),rn(this,C1),rn(this,w1),rn(this,p1),rn(this,m1),rn(this,g1),rn(this,f1),rn(this,d1),rn(this,h1),rn(this,c1),rn(this,Fh),kh(this,lt,{writable:!0,value:new Jie}),kh(this,vo,{writable:!0,value:null}),kh(this,Tu,{writable:!0,value:null}),kh(this,wm,{writable:!0,value:!1}),l1(this,"ghostTable",new roe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),l1(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return u1}static get PLUGIN_PRIORITY(){return loe}isEnabled(){return!!this.hot.getSettings()[u1]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&pt(ct`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>jt(this,T1,Toe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,_1,_oe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,f1,foe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,g1,goe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,m1,moe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,p1,poe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,w1,woe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,C1,Coe).call(e,...i)}),this.addHook("afterSelection",()=>jt(this,Fh,Gw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,c1,coe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>jt(this,S1,Soe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,b1,boe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,R1,Roe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,h1,hoe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,d1,doe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,v1,voe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,y1,yoe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,E1,Eoe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>jt(this,Fh,Gw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>jt(this,Fh,Gw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();et(this,lt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=et(this,lt).setState(e)),this.detectedOverlappedHeaders&&pt(ct`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";et(this,lt).triggerColumnModification(i,r)}),!et(this,vo)&&this.enabled&&Ns(this,vo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";et(this,lt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),et(this,lt).clear(),et(this,vo).unsubscribe(),Ns(this,vo,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return et(this,lt)}getLayersCount(){return et(this,lt).getLayersCount()}getHeaderSettings(e,n){return et(this,lt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,d=a.childNodes.length;c<d;c++)a.childNodes[c].removeAttribute("colspan"),De(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),De(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),De(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),De(o,"hiddenHeader");const{colspan:c,isHidden:d,isPlaceholder:f}=(s=et(this,lt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||d)J(o,"hiddenHeader");else if(c>1){var m,w;const{wtOverlays:v}=l._wt,y=(m=v.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(o),b=(w=v.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o),_=y||b?Math.min(c,r-i):c;_>1&&o.setAttribute("colspan",_)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=et(this,lt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Ns(this,lt,null),et(this,vo)!==null&&(et(this,vo).unsubscribe(),Ns(this,vo,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return et(this,lt).getHeaderTreeNodeData(e.row,e.col)}}function Gw(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=et(this,lt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function coe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=et(this,lt).findLeftMostColumnIndex(n.row,n.col),a=et(this,lt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function hoe(t,e,n){const r=et(this,lt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=et(this,lt).getHeaderSettings(e,t);if(o===WS){if(!a)return r.columnIndex}else if(o===lP&&(l>s-i||!a))return null;return t}function doe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,d=a-u+1;if(s>=0||d===1)break;for(let f=a;f<=u;f++)for(let m=s;m<=l;m++){var i;const w=c+m,v=f-a;if(v===0)continue;((i=et(this,lt).getHeaderTreeNodeData(m,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[w][v]="")}}}function foe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function goe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Ns(this,Tu,e.clone()),Ns(this,wm,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Hf(t)||Wo(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function moe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const d=[],f=qn(e.row,-1/0,-1);e.col<c.col?d.push(u.col,o,f):e.col>c.col?d.push(l.col,o+s-1,f):d.push(o,o+s-1,f),this.hot.selection.selectColumns(...d)}function poe(){Ns(this,wm,!1)}function woe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!et(this,wm)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=et(this,lt).getHeaderTreeNodeData(et(this,Tu).row,et(this,Tu).col);if(e.setHighlight(et(this,Tu)),o>e.getWidth()||i<n||i+o-1>r){const s=et(this,lt).findTopMostEntireHeaderLevel(qn(n,i,i+o-1),qn(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Coe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=et(this,lt).findLeftMostColumnIndex(n.row,n.col),o=et(this,lt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function voe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Soe(t){t.length=0;for(let e=0;e<et(this,lt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function yoe(t){const e=et(this,lt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=et(this,lt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Ln(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?et(this,lt).getHeaderTreeNodeData(0,n).columnIndex:n}function boe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Roe(t,e,n){var r;const{label:i}=(r=et(this,lt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Eoe(t,e){if(t<0)return this.hot.getCell(t,et(this,lt).findLeftMostColumnIndex(t,e),!0)}function Toe(){this.updatePlugin()}function _oe(t,e){e||this.updatePlugin()}function tu(t,e,n){return e=Moe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Moe(t){var e=Aoe(t,"string");return typeof e=="symbol"?e:String(e)}function Aoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ooe{constructor(e,n){tu(this,"hot",void 0),tu(this,"data",null),tu(this,"plugin",void 0),tu(this,"parentReference",new WeakMap),tu(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&T(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&T(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ue(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(T(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(me(e[0],e[2],f=>{const m=this.translateTrimmedRow(f);i.push(this.getDataObject(m))}),me(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let d=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const f=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,f,this.plugin.pluginName),u){d=c+this.countChildren(u);const m=this.getChild(u,this.countChildren(u)-1),w=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",w+1,s+1,this.plugin.pluginName),u.__children.push(r)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];T(r,o=>{i.push(this.getDataObject(o))}),T(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const d=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(d,0,l[0]),s.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const Ioe=Ooe;function M1(t,e,n){return e=Poe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Poe(t){var e=xoe(t,"string");return typeof e=="symbol"?e:String(e)}function xoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hoe{constructor(e,n){M1(this,"hot",void 0),M1(this,"plugin",void 0),this.hot=n,this.plugin=e}}const eb=Hoe;class ki extends eb{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(T(l,c=>{c&&s.removeChild(c)}),J(n,ki.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,d=a.cloneNode(!0);s.innerHTML="",me(0,i-1,()=>{const f=c.createElement("SPAN");J(f,ki.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(d)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ve(c,[no()]),J(n,ki.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(J(c,`${ki.CSS_CLASSES.button} ${ki.CSS_CLASSES.expandButton}`),u&&ve(n,[sn(!1),Pu(this.hot.getTranslatedPhrase(py))])):(J(c,`${ki.CSS_CLASSES.button} ${ki.CSS_CLASSES.collapseButton}`),u&&ve(n,[sn(!0),Pu(this.hot.getTranslatedPhrase(wy))])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const xD=ki;class Doe extends eb{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),T(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{me(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&T(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&T(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&T(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Ie(e.target,xD.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Sr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Noe=Doe;function Loe(t,e,n){$oe(t,e),e.set(t,n)}function $oe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function koe(t,e,n){return e=Foe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Foe(t){var e=Woe(t,"string");return typeof e=="symbol"?e:String(e)}function Woe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Voe(t,e){var n=Boe(t,e,"get");return Uoe(t,n)}function Boe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Uoe(t,e){return e.get?e.get.call(t):e.value}var A1=new WeakMap;class Yoe extends eb{constructor(){super(...arguments),koe(this,"dataManager",this.plugin.dataManager),Loe(this,A1,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(yg)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(bg)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,r=>{if(r===0)return T(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return me(0,e.items.length-1,n=>{const r=Voe(this,A1)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const zoe=Yoe;function Wh(t,e,n){return e=Goe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Goe(t){var e=joe(t,"string");return typeof e=="symbol"?e:String(e)}function joe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Koe{constructor(e){Wh(this,"plugin",void 0),Wh(this,"hot",void 0),Wh(this,"dataManager",void 0),Wh(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(w=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const d=this.getBaseParent(u),f=this.getTargetParent(s,a),m=d===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,m),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return mt(i)&&(pt(ct`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function gn(t,e){HD(t,e),e.add(t)}function O1(t,e,n){HD(t,e),e.set(t,n)}function HD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jw(t,e,n){return e=Xoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xoe(t){var e=qoe(t,"string");return typeof e=="symbol"?e:String(e)}function qoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function md(t,e){var n=DD(t,e,"get");return Zoe(t,n)}function Zoe(t,e){return e.get?e.get.call(t):e.value}function sf(t,e,n){var r=DD(t,e,"set");return Qoe(t,r,n),n}function DD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Qoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function hn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const af="nestedRows",Joe=300,I1=af,ese="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var Cm=new WeakMap,Na=new WeakMap,P1=new WeakSet,x1=new WeakSet,H1=new WeakSet,D1=new WeakSet,N1=new WeakSet,L1=new WeakSet,$1=new WeakSet,k1=new WeakSet,F1=new WeakSet,W1=new WeakSet,V1=new WeakSet,B1=new WeakSet,U1=new WeakSet,Y1=new WeakSet,z1=new WeakSet,Kw=new WeakSet;class tse extends nt{constructor(){super(...arguments),gn(this,Kw),gn(this,z1),gn(this,Y1),gn(this,U1),gn(this,B1),gn(this,V1),gn(this,W1),gn(this,F1),gn(this,k1),gn(this,$1),gn(this,L1),gn(this,N1),gn(this,D1),gn(this,H1),gn(this,x1),gn(this,P1),jw(this,"dataManager",null),jw(this,"headersUI",null),jw(this,"collapsedRowsMap",null),O1(this,Cm,{writable:!0,value:!1}),O1(this,Na,{writable:!0,value:!1})}static get PLUGIN_KEY(){return af}static get PLUGIN_PRIORITY(){return Joe}isEnabled(){return!!this.hot.getSettings()[af]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new lc),this.dataManager=new Ioe(this,this.hot),this.collapsingUI=new Noe(this,this.hot),this.headersUI=new xD(this,this.hot),this.contextMenuUI=new zoe(this,this.hot),this.rowMoveController=new Koe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,Y1,mse).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,z1,pse).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,H1,ise).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,D1,ose).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,N1,sse).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,x1,rse).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,k1,use).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,$1,lse).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,F1,cse).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,W1,hse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,V1,dse).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,B1,fse).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,L1,ase).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,U1,gse).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,P1,nse).call(e,...r)}),this.addHook("beforeLoadData",n=>hn(this,Kw,G1).call(this,n)),this.addHook("beforeUpdateData",n=>hn(this,Kw,G1).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:I1})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(I1)}disableCoreAPIModifiers(){sf(this,Na,!0)}enableCoreAPIModifiers(){sf(this,Na,!1)}onModifyRowData(e){if(!md(this,Na))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!md(this,Na))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return md(this,Na)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function nse(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function rse(t,e,n){this.collapsingUI.toggleState(t,e,n)}function ise(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),sf(this,Cm,!0),this.dataManager.getData().slice()}function ose(t){return this.contextMenuUI.appendOptions(t)}function sse(t,e){this.headersUI.appendLevelIndicators(t,e)}function ase(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function lse(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{sf(this,Cm,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function use(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function cse(){this.collapsingUI.collapsedRowsStash.stash()}function hse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function dse(){this.collapsingUI.collapsedRowsStash.stash()}function fse(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function gse(){this.dataManager.rewriteCache()}function mse(){this.headersUI.updateRowHeaderWidth()}function pse(t,e){md(this,Cm)&&(e.skipRender=!0)}function G1(t){if(!vP(t)){RS(ese),this.hot.getSettings()[af]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function Xw(t,e,n){return e=wse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wse(t){var e=Cse(t,"string");return typeof e=="symbol"?e:String(e)}function Cse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vse{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Xw(this,"rootWindow",void 0),Xw(this,"prefix",void 0),Xw(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){T(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Sse=vse;function yse(t,e,n){return e=bse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bse(t){var e=Rse(t,"string");return typeof e=="symbol"?e:String(e)}function Rse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}de.getSingleton().register("persistentStateSave");de.getSingleton().register("persistentStateLoad");de.getSingleton().register("persistentStateReset");const j1="persistentState",Ese=0;class Tse extends nt{constructor(){super(...arguments),yse(this,"storage",void 0)}static get PLUGIN_KEY(){return j1}static get PLUGIN_PRIORITY(){return Ese}isEnabled(){return!!this.hot.getSettings()[j1]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Sse(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function _se(t,e){Mse(t,e),e.add(t)}function Mse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qw(t,e,n){return e=Ase(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ase(t){var e=Ose(t,"string");return typeof e=="symbol"?e:String(e)}function Ose(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function K1(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Zw="search",Ise=190,Pse="htSearchResult",xse=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Hse=function(t,e,n){return mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||mt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Qw=new WeakSet;class Dse extends nt{constructor(){super(...arguments),_se(this,Qw),qw(this,"callback",xse),qw(this,"queryMethod",Hse),qw(this,"searchResultClass",Pse)}static get PLUGIN_KEY(){return Zw}static get PLUGIN_PRIORITY(){return Ise}isEnabled(){return this.hot.getSettings()[Zw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Zw];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return K1(e,Qw,X1).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return K1(e,Qw,X1).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return me(0,i-1,l=>{me(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),d=this.hot.getCellMeta(l,u),f=d.search.callback||n,w=(d.search.queryMethod||r)(e,c,d);if(w){const v={row:l,col:u,data:c};s.push(v)}f&&f(a,l,u,c,w)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Fe(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function X1(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Jw(t,e){Nse(t,e),e.add(t)}function Nse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vh(t,e,n){return e=Lse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lse(t){var e=$se(t,"string");return typeof e=="symbol"?e:String(e)}function $se(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eC(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const kse="touchScroll",Fse=200;var q1=new WeakSet,Z1=new WeakSet,Q1=new WeakSet;class Wse extends nt{constructor(){super(...arguments),Jw(this,Q1),Jw(this,Z1),Jw(this,q1),Vh(this,"scrollbars",[]),Vh(this,"clones",[]),Vh(this,"lockedCollection",!1),Vh(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return kse}static get PLUGIN_PRIORITY(){return Fse}static get SETTING_KEYS(){return!0}isEnabled(){return HS()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>eC(this,q1,Vse).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>eC(this,Z1,Bse).call(this)),this.addHook("afterMomentumScroll",()=>eC(this,Q1,Use).call(this))}}function Vse(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Bse(){this.freezeOverlays=!0,T(this.clones,t=>{J(t,"hide-tween")})}function Use(){this.freezeOverlays=!1,T(this.clones,t=>{De(t,"hide-tween"),J(t,"show-tween")}),this.hot._registerTimeout(()=>{T(this.clones,t=>{De(t,"show-tween")})},400),T(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Yse(t,e){zse(t,e),e.add(t)}function zse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gse(t,e,n){return e=jse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jse(t){var e=Kse(t,"string");return typeof e=="symbol"?e:String(e)}function Kse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xse(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const pd="trimRows",qse=330;var J1=new WeakSet;class Zse extends nt{constructor(){super(...arguments),Yse(this,J1),Gse(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return pd}static get PLUGIN_PRIORITY(){return qse}isEnabled(){return!!this.hot.getSettings()[pd]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new lc),this.trimmedRowsMap.addLocalHook("init",()=>Xse(this,J1,Qse).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[pd];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),T(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(T(e,l=>{o[l]=!1}),i=Ft(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Qse(){const t=this.hot.getSettings()[pd];Array.isArray(t)&&this.hot.batchExecution(()=>{T(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const ND="undoRedo",Jse="undoRedo";function le(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);T(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new le.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new le.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=Rn(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new le.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new le.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],d=[];me(a.length-1,w=>{const v=[],y=a[w];me(l,l+(r-1),b=>{v.push(y[t.toPhysicalColumn(b)])}),u.push(v)}),me(r-1,w=>{d.push(t.toPhysicalColumn(l+w))}),Array.isArray(t.getSettings().colHeaders)&&me(r-1,w=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+w)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),m=t.rowIndexMapper.getIndexesSequence();return new le.RemoveColumnAction(l,d,u,c,f,m,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new le.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new le.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new le.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new le.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new le.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}le.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};le.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Rn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};le.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Rn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};le.prototype.isUndoAvailable=function(){return this.doneActions.length>0};le.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};le.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};le.prototype.isEnabled=function(){return this.enabled};le.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,nae(t),this.registerShortcuts(),t.addHook("afterChange",LD)};le.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,rae(t),this.unregisterShortcuts(),t.removeHook("afterChange",LD)};le.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};le.Action=function(){};le.Action.prototype.undo=function(){};le.Action.prototype.redo=function(){};le.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};ro(le.ChangeAction,le.Action);le.ChangeAction.prototype.undo=function(t,e){const n=Rn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};le.ChangeAction.prototype.redo=function(t,e){const n=Rn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};le.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};ro(le.CreateRowAction,le.Action);le.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};le.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};le.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};ro(le.RemoveRowAction,le.Action);le.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};le.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};le.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};ro(le.CreateColumnAction,le.Action);le.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};le.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};le.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};ro(le.RemoveColumnAction,le.Action);le.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,d)=>d[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Be(this.data[u],i));const a=Be(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),T(t.getSourceDataArray(),(u,c)=>{T(r,(d,f)=>{u[d]=s[c][f],l.push([c,d,u[d]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&T(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};le.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};le.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};le.CellAlignmentAction.prototype.undo=function(t,e){T(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};le.CellAlignmentAction.prototype.redo=function(t,e){yo(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};le.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};ro(le.FiltersAction,le.Action);le.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};le.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class eae extends le.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}le.MergeCellsAction=eae;class tae extends le.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}le.UnmergeCellsAction=tae;le.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};ro(le.RowMoveAction,le.Action);le.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};le.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};le.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};le.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:ND};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};le.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(ND)};function LD(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function nae(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function rae(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const yc=de.getSingleton();yc.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});yc.register("beforeUndo");yc.register("afterUndo");yc.register("beforeRedo");yc.register("afterRedo");le.PLUGIN_KEY=Jse;le.SETTING_KEYS=!0;function iae(){Ne(Xa),Ne(P8),Ne(wu),Ne(l7),Ne(w7),Ne(Nx),Ne(uX),Ne(KX),Ne(wc),Ne(eH),Ne(BZ),Ne(qZ),Ne(Cc),Ne(RQ),Ne(HH),Ne(hte),Ne(qH),Ne(tD),Ne(une),Ne(_ne),Ne(Fne),Ne(fD),Ne(yre),Ne(qre),Ne(SD),Ne(Oie),Ne(uoe),Ne(tse),Ne(Tse),Ne(Dse),Ne(Wse),Ne(Zse),Ne(le)}function oae(){jn(hl),jn(_y),jn(tx),jn(sx),jn(Py),jn(Ty),jn(dx),jn(mx),jn(px),jn(qs),jn(Cx)}function sae(){ii(dl),ii(dc),ii(Ay),ii(My),ii(xy),ii(Dy),ii(so),ii(Ny)}function aae(){Ua(om),Ua(Iy),Ua(Hy),Ua(Ly)}function lae(){oae(),sae(),aae(),K5(),iae()}function uae(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var tC,nC,rC,iC,oC;lae();uae(Ee);Ee.__GhostTable=$y;Ee._getListenersCounter=Sz;Ee._getRegisteredMapsCounter=N3;Ee.EventManager=or;const cae=[KU,tz,y3,S5,qG,LY,QU,Nz,QY,eY,iz,Dz],hae=[xY,oz];Ee.helper={};Ee.dom={};T(cae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ee.helper[e]=t[e])})});T(hae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ee.dom[e]=t[e])})});Ee.cellTypes=(tC=Ee.cellTypes)!==null&&tC!==void 0?tC:{};T(t6(),t=>{Ee.cellTypes[t]=Ry(t)});Ee.cellTypes.registerCellType=Cn;Ee.cellTypes.getCellType=Ry;Ee.editors=(nC=Ee.editors)!==null&&nC!==void 0?nC:{};T(fz(),t=>{Ee.editors[`${bn(t)}Editor`]=Hd(t)});Ee.editors.registerEditor=jn;Ee.editors.getEditor=Hd;Ee.renderers=(rC=Ee.renderers)!==null&&rC!==void 0?rC:{};T(qz(),t=>{const e=Nd(t);t==="base"&&(Ee.renderers.cellDecorator=e),Ee.renderers[`${bn(t)}Renderer`]=e});Ee.renderers.registerRenderer=ii;Ee.renderers.getRenderer=Nd;Ee.validators=(iC=Ee.validators)!==null&&iC!==void 0?iC:{};T(Jz(),t=>{Ee.validators[`${bn(t)}Validator`]=MS(t)});Ee.validators.registerValidator=Ua;Ee.validators.getValidator=MS;Ee.plugins=(oC=Ee.plugins)!==null&&oC!==void 0?oC:{};T(_S(),t=>{Ee.plugins[t]=oc(t)});Ee.plugins[`${bn(nt.PLUGIN_KEY)}Plugin`]=nt;Ee.plugins.registerPlugin=Ne;Ee.plugins.getPlugin=oc;const eA=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function dae(t,e,n,r,i,o){if(n!==0)return;const s=t.parentElement;s!==null&&(e%2===0?Ee.dom.addClass(s,O0):Ee.dom.removeClass(s,O0))}function fae(t,e){if(t<0)return;const n=this.isRtl()?"htRight":"htLeft";e.firstChild&&(eA.has(t.toString())?(Ee.dom.removeClass(e.firstChild,n),Ee.dom.addClass(e.firstChild,eA.get(t.toString()))):Ee.dom.addClass(e.firstChild,n))}Ne(Xa);Ne(wc);Ne(eH);Ne(Cc);Ne(HH);Ne(qH);Ne(tD);Ne(fD);Ne(SD);Ne(le);Cn(ux);Cn(cx);Cn(rx);Cn(gx);Sy(ex);const gae=document.getElementById("example");new Ee(gae,{data:Y9(),layoutDirection:rd()?"rtl":"ltr",language:rd()?ex.languageCode:"en-US",height:450,colWidths:[170,222,130,120,120,130,156],colHeaders:["Company name","Name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1,dateFormat:rd()?"M/D/YYYY":"DD/MM/YYYY"},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:5,type:"text"},{data:2,type:"text"}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,navigableHeaders:!0,autoWrapCol:!0,afterGetColHeader:fae,beforeRenderer:dae,licenseKey:"non-commercial-and-evaluation"});console.log(`Handsontable: v${Ee.version} (${Ee.buildDate})`)});export default mae();
