var P1=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var h8=P1((_8,Mc)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();var nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xR(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function D1(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){if(this instanceof s){var o=[null];o.push.apply(o,arguments);var i=Function.bind.apply(e,o);return new i}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var o=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:function(){return n[s]}})}),t}var Kl=function(n){return n&&n.Math===Math&&n},cn=Kl(typeof globalThis=="object"&&globalThis)||Kl(typeof window=="object"&&window)||Kl(typeof self=="object"&&self)||Kl(typeof nc=="object"&&nc)||function(){return this}()||nc||Function("return this")(),kp={},Gn=function(n){try{return!!n()}catch{return!0}},N1=Gn,xs=!N1(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),L1=Gn,uh=!L1(function(){var n=(function(){}).bind();return typeof n!="function"||n.hasOwnProperty("prototype")}),k1=uh,Xl=Function.prototype.call,Lr=k1?Xl.bind(Xl):function(){return Xl.apply(Xl,arguments)},HR={},PR={}.propertyIsEnumerable,DR=Object.getOwnPropertyDescriptor,F1=DR&&!PR.call({1:2},1);HR.f=F1?function(e){var t=DR(this,e);return!!t&&t.enumerable}:PR;var Fp=function(n,e){return{enumerable:!(n&1),configurable:!(n&2),writable:!(n&4),value:e}},NR=uh,LR=Function.prototype,Pm=LR.call,$1=NR&&LR.bind.bind(Pm,Pm),Jt=NR?$1:function(n){return function(){return Pm.apply(n,arguments)}},kR=Jt,V1=kR({}.toString),W1=kR("".slice),Di=function(n){return W1(V1(n),8,-1)},B1=Jt,U1=Gn,Y1=Di,Cf=Object,z1=B1("".split),G1=U1(function(){return!Cf("z").propertyIsEnumerable(0)})?function(n){return Y1(n)==="String"?z1(n,""):Cf(n)}:Cf,$p=function(n){return n==null},j1=$p,K1=TypeError,Vp=function(n){if(j1(n))throw K1("Can't call method on "+n);return n},X1=G1,q1=Vp,ch=function(n){return X1(q1(n))},Dm=typeof document=="object"&&document.all,Z1=typeof Dm>"u"&&Dm!==void 0,FR={all:Dm,IS_HTMLDDA:Z1},$R=FR,Q1=$R.all,Kt=$R.IS_HTMLDDA?function(n){return typeof n=="function"||n===Q1}:function(n){return typeof n=="function"},_S=Kt,VR=FR,J1=VR.all,Zo=VR.IS_HTMLDDA?function(n){return typeof n=="object"?n!==null:_S(n)||n===J1}:function(n){return typeof n=="object"?n!==null:_S(n)},Sf=cn,eO=Kt,tO=function(n){return eO(n)?n:void 0},wl=function(n,e){return arguments.length<2?tO(Sf[n]):Sf[n]&&Sf[n][e]},nO=Jt,Wp=nO({}.isPrototypeOf),Bp=typeof navigator<"u"&&String(navigator.userAgent)||"",WR=cn,vf=Bp,OS=WR.process,AS=WR.Deno,IS=OS&&OS.versions||AS&&AS.version,xS=IS&&IS.v8,os,_c;xS&&(os=xS.split("."),_c=os[0]>0&&os[0]<4?1:+(os[0]+os[1]));!_c&&vf&&(os=vf.match(/Edge\/(\d+)/),(!os||os[1]>=74)&&(os=vf.match(/Chrome\/(\d+)/),os&&(_c=+os[1])));var sO=_c,HS=sO,oO=Gn,iO=cn,rO=iO.String,Up=!!Object.getOwnPropertySymbols&&!oO(function(){var n=Symbol("symbol detection");return!rO(n)||!(Object(n)instanceof Symbol)||!Symbol.sham&&HS&&HS<41}),aO=Up,BR=aO&&!Symbol.sham&&typeof Symbol.iterator=="symbol",lO=wl,uO=Kt,cO=Wp,hO=BR,dO=Object,Yp=hO?function(n){return typeof n=="symbol"}:function(n){var e=lO("Symbol");return uO(e)&&cO(e.prototype,dO(n))},fO=String,UR=function(n){try{return fO(n)}catch{return"Object"}},gO=Kt,mO=UR,pO=TypeError,zp=function(n){if(gO(n))return n;throw pO(mO(n)+" is not a function")},wO=zp,CO=$p,YR=function(n,e){var t=n[e];return CO(t)?void 0:wO(t)},yf=Lr,bf=Kt,Rf=Zo,SO=TypeError,vO=function(n,e){var t,s;if(e==="string"&&bf(t=n.toString)&&!Rf(s=yf(t,n))||bf(t=n.valueOf)&&!Rf(s=yf(t,n))||e!=="string"&&bf(t=n.toString)&&!Rf(s=yf(t,n)))return s;throw SO("Can't convert object to primitive value")},zR={exports:{}},PS=cn,yO=Object.defineProperty,Gp=function(n,e){try{yO(PS,n,{value:e,configurable:!0,writable:!0})}catch{PS[n]=e}return e},bO=cn,RO=Gp,DS="__core-js_shared__",EO=bO[DS]||RO(DS,{}),jp=EO,NS=jp;(zR.exports=function(n,e){return NS[n]||(NS[n]=e!==void 0?e:{})})("versions",[]).push({version:"3.32.1",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.1/LICENSE",source:"https://github.com/zloirock/core-js"});var GR=zR.exports,TO=Vp,MO=Object,Cl=function(n){return MO(TO(n))},_O=Jt,OO=Cl,AO=_O({}.hasOwnProperty),Hs=Object.hasOwn||function(e,t){return AO(OO(e),t)},IO=Jt,xO=0,HO=Math.random(),PO=IO(1 .toString),jR=function(n){return"Symbol("+(n===void 0?"":n)+")_"+PO(++xO+HO,36)},DO=cn,NO=GR,LS=Hs,LO=jR,kO=Up,FO=BR,Cr=DO.Symbol,Ef=NO("wks"),$O=FO?Cr.for||Cr:Cr&&Cr.withoutSetter||LO,kr=function(n){return LS(Ef,n)||(Ef[n]=kO&&LS(Cr,n)?Cr[n]:$O("Symbol."+n)),Ef[n]},VO=Lr,kS=Zo,FS=Yp,WO=YR,BO=vO,UO=kr,YO=TypeError,zO=UO("toPrimitive"),GO=function(n,e){if(!kS(n)||FS(n))return n;var t=WO(n,zO),s;if(t){if(e===void 0&&(e="default"),s=VO(t,n,e),!kS(s)||FS(s))return s;throw YO("Can't convert object to primitive value")}return e===void 0&&(e="number"),BO(n,e)},jO=GO,KO=Yp,KR=function(n){var e=jO(n,"string");return KO(e)?e:e+""},XO=cn,$S=Zo,Nm=XO.document,qO=$S(Nm)&&$S(Nm.createElement),Kp=function(n){return qO?Nm.createElement(n):{}},ZO=xs,QO=Gn,JO=Kp,XR=!ZO&&!QO(function(){return Object.defineProperty(JO("div"),"a",{get:function(){return 7}}).a!==7}),eA=xs,tA=Lr,nA=HR,sA=Fp,oA=ch,iA=KR,rA=Hs,aA=XR,VS=Object.getOwnPropertyDescriptor;kp.f=eA?VS:function(e,t){if(e=oA(e),t=iA(t),aA)try{return VS(e,t)}catch{}if(rA(e,t))return sA(!tA(nA.f,e,t),e[t])};var Ni={},lA=xs,uA=Gn,qR=lA&&uA(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),cA=Zo,hA=String,dA=TypeError,Fr=function(n){if(cA(n))return n;throw dA(hA(n)+" is not an object")},fA=xs,gA=XR,mA=qR,ql=Fr,WS=KR,pA=TypeError,Tf=Object.defineProperty,wA=Object.getOwnPropertyDescriptor,Mf="enumerable",_f="configurable",Of="writable";Ni.f=fA?mA?function(e,t,s){if(ql(e),t=WS(t),ql(s),typeof e=="function"&&t==="prototype"&&"value"in s&&Of in s&&!s[Of]){var o=wA(e,t);o&&o[Of]&&(e[t]=s.value,s={configurable:_f in s?s[_f]:o[_f],enumerable:Mf in s?s[Mf]:o[Mf],writable:!1})}return Tf(e,t,s)}:Tf:function(e,t,s){if(ql(e),t=WS(t),ql(s),gA)try{return Tf(e,t,s)}catch{}if("get"in s||"set"in s)throw pA("Accessors not supported");return"value"in s&&(e[t]=s.value),e};var CA=xs,SA=Ni,vA=Fp,Sl=CA?function(n,e,t){return SA.f(n,e,vA(1,t))}:function(n,e,t){return n[e]=t,n},ZR={exports:{}},Lm=xs,yA=Hs,QR=Function.prototype,bA=Lm&&Object.getOwnPropertyDescriptor,Xp=yA(QR,"name"),RA=Xp&&(function(){}).name==="something",EA=Xp&&(!Lm||Lm&&bA(QR,"name").configurable),TA={EXISTS:Xp,PROPER:RA,CONFIGURABLE:EA},MA=Jt,_A=Kt,km=jp,OA=MA(Function.toString);_A(km.inspectSource)||(km.inspectSource=function(n){return OA(n)});var AA=km.inspectSource,IA=cn,xA=Kt,BS=IA.WeakMap,HA=xA(BS)&&/native code/.test(String(BS)),PA=GR,DA=jR,US=PA("keys"),JR=function(n){return US[n]||(US[n]=DA(n))},qp={},NA=HA,e0=cn,LA=Zo,kA=Sl,Af=Hs,If=jp,FA=JR,$A=qp,YS="Object already initialized",Fm=e0.TypeError,VA=e0.WeakMap,Oc,Za,Ac,WA=function(n){return Ac(n)?Za(n):Oc(n,{})},BA=function(n){return function(e){var t;if(!LA(e)||(t=Za(e)).type!==n)throw Fm("Incompatible receiver, "+n+" required");return t}};if(NA||If.state){var gs=If.state||(If.state=new VA);gs.get=gs.get,gs.has=gs.has,gs.set=gs.set,Oc=function(n,e){if(gs.has(n))throw Fm(YS);return e.facade=n,gs.set(n,e),e},Za=function(n){return gs.get(n)||{}},Ac=function(n){return gs.has(n)}}else{var Bi=FA("state");$A[Bi]=!0,Oc=function(n,e){if(Af(n,Bi))throw Fm(YS);return e.facade=n,kA(n,Bi,e),e},Za=function(n){return Af(n,Bi)?n[Bi]:{}},Ac=function(n){return Af(n,Bi)}}var UA={set:Oc,get:Za,has:Ac,enforce:WA,getterFor:BA},Zp=Jt,YA=Gn,zA=Kt,Zl=Hs,$m=xs,GA=TA.CONFIGURABLE,jA=AA,t0=UA,KA=t0.enforce,XA=t0.get,zS=String,sc=Object.defineProperty,qA=Zp("".slice),ZA=Zp("".replace),QA=Zp([].join),JA=$m&&!YA(function(){return sc(function(){},"length",{value:8}).length!==8}),eI=String(String).split("String"),tI=ZR.exports=function(n,e,t){qA(zS(e),0,7)==="Symbol("&&(e="["+ZA(zS(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),t&&t.getter&&(e="get "+e),t&&t.setter&&(e="set "+e),(!Zl(n,"name")||GA&&n.name!==e)&&($m?sc(n,"name",{value:e,configurable:!0}):n.name=e),JA&&t&&Zl(t,"arity")&&n.length!==t.arity&&sc(n,"length",{value:t.arity});try{t&&Zl(t,"constructor")&&t.constructor?$m&&sc(n,"prototype",{writable:!1}):n.prototype&&(n.prototype=void 0)}catch{}var s=KA(n);return Zl(s,"source")||(s.source=QA(eI,typeof e=="string"?e:"")),n};Function.prototype.toString=tI(function(){return zA(this)&&XA(this).source||jA(this)},"toString");var nI=ZR.exports,sI=Kt,oI=Ni,iI=nI,rI=Gp,aI=function(n,e,t,s){s||(s={});var o=s.enumerable,i=s.name!==void 0?s.name:e;if(sI(t)&&iI(t,i,s),s.global)o?n[e]=t:rI(e,t);else{try{s.unsafe?n[e]&&(o=!0):delete n[e]}catch{}o?n[e]=t:oI.f(n,e,{value:t,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return n},n0={},lI=Math.ceil,uI=Math.floor,cI=Math.trunc||function(e){var t=+e;return(t>0?uI:lI)(t)},hI=cI,Qp=function(n){var e=+n;return e!==e||e===0?0:hI(e)},dI=Qp,fI=Math.max,gI=Math.min,mI=function(n,e){var t=dI(n);return t<0?fI(t+e,0):gI(t,e)},pI=Qp,wI=Math.min,CI=function(n){return n>0?wI(pI(n),9007199254740991):0},SI=CI,hh=function(n){return SI(n.length)},vI=ch,yI=mI,bI=hh,GS=function(n){return function(e,t,s){var o=vI(e),i=bI(o),r=yI(s,i),a;if(n&&t!==t){for(;i>r;)if(a=o[r++],a!==a)return!0}else for(;i>r;r++)if((n||r in o)&&o[r]===t)return n||r||0;return!n&&-1}},RI={includes:GS(!0),indexOf:GS(!1)},EI=Jt,xf=Hs,TI=ch,MI=RI.indexOf,_I=qp,jS=EI([].push),s0=function(n,e){var t=TI(n),s=0,o=[],i;for(i in t)!xf(_I,i)&&xf(t,i)&&jS(o,i);for(;e.length>s;)xf(t,i=e[s++])&&(~MI(o,i)||jS(o,i));return o},Jp=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],OI=s0,AI=Jp,II=AI.concat("length","prototype");n0.f=Object.getOwnPropertyNames||function(e){return OI(e,II)};var o0={};o0.f=Object.getOwnPropertySymbols;var xI=wl,HI=Jt,PI=n0,DI=o0,NI=Fr,LI=HI([].concat),kI=xI("Reflect","ownKeys")||function(e){var t=PI.f(NI(e)),s=DI.f;return s?LI(t,s(e)):t},KS=Hs,FI=kI,$I=kp,VI=Ni,i0=function(n,e,t){for(var s=FI(e),o=VI.f,i=$I.f,r=0;r<s.length;r++){var a=s[r];!KS(n,a)&&!(t&&KS(t,a))&&o(n,a,i(e,a))}},WI=Gn,BI=Kt,UI=/#|\.prototype\./,vl=function(n,e){var t=zI[YI(n)];return t===jI?!0:t===GI?!1:BI(e)?WI(e):!!e},YI=vl.normalize=function(n){return String(n).replace(UI,".").toLowerCase()},zI=vl.data={},GI=vl.NATIVE="N",jI=vl.POLYFILL="P",KI=vl,Hf=cn,XI=kp.f,qI=Sl,ZI=aI,QI=Gp,JI=i0,ex=KI,Qo=function(n,e){var t=n.target,s=n.global,o=n.stat,i,r,a,l,u,c;if(s?r=Hf:o?r=Hf[t]||QI(t,{}):r=(Hf[t]||{}).prototype,r)for(a in e){if(u=e[a],n.dontCallGetSet?(c=XI(r,a),l=c&&c.value):l=r[a],i=ex(s?a:t+(o?".":"#")+a,n.forced),!i&&l!==void 0){if(typeof u==typeof l)continue;JI(u,l)}(n.sham||l&&l.sham)&&qI(u,"sham",!0),ZI(r,a,u,n)}},tx=Di,r0=Array.isArray||function(e){return tx(e)==="Array"},nx=xs,sx=r0,ox=TypeError,ix=Object.getOwnPropertyDescriptor,rx=nx&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(n){return n instanceof TypeError}}(),a0=rx?function(n,e){if(sx(n)&&!ix(n,"length").writable)throw ox("Cannot set read only .length");return n.length=e}:function(n,e){return n.length=e},ax=TypeError,lx=9007199254740991,l0=function(n){if(n>lx)throw ax("Maximum allowed index exceeded");return n},ux=Qo,cx=Cl,hx=hh,dx=a0,fx=l0,gx=Gn,mx=gx(function(){return[].push.call({length:4294967296},1)!==4294967297}),px=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(n){return n instanceof TypeError}},wx=mx||!px();ux({target:"Array",proto:!0,arity:1,forced:wx},{push:function(e){var t=cx(this),s=hx(t),o=arguments.length;fx(s+o);for(var i=0;i<o;i++)t[s]=arguments[i],s++;return dx(t,s),s}});var Cx=uh,u0=Function.prototype,XS=u0.apply,qS=u0.call,dh=typeof Reflect=="object"&&Reflect.apply||(Cx?qS.bind(XS):function(){return qS.apply(XS,arguments)}),Sx=Jt,vx=zp,yx=function(n,e,t){try{return Sx(vx(Object.getOwnPropertyDescriptor(n,e)[t]))}catch{}},bx=Kt,Rx=String,Ex=TypeError,Tx=function(n){if(typeof n=="object"||bx(n))return n;throw Ex("Can't set "+Rx(n)+" as a prototype")},Mx=yx,_x=Fr,Ox=Tx,c0=Object.setPrototypeOf||("__proto__"in{}?function(){var n=!1,e={},t;try{t=Mx(Object.prototype,"__proto__","set"),t(e,[]),n=e instanceof Array}catch{}return function(o,i){return _x(o),Ox(i),n?t(o,i):o.__proto__=i,o}}():void 0),Ax=Ni.f,Ix=function(n,e,t){t in n||Ax(n,t,{configurable:!0,get:function(){return e[t]},set:function(s){e[t]=s}})},xx=Kt,Hx=Zo,ZS=c0,Px=function(n,e,t){var s,o;return ZS&&xx(s=e.constructor)&&s!==t&&Hx(o=s.prototype)&&o!==t.prototype&&ZS(n,o),n},Dx=kr,Nx=Dx("toStringTag"),h0={};h0[Nx]="z";var Lx=String(h0)==="[object z]",kx=Lx,Fx=Kt,oc=Di,$x=kr,Vx=$x("toStringTag"),Wx=Object,Bx=oc(function(){return arguments}())==="Arguments",Ux=function(n,e){try{return n[e]}catch{}},Yx=kx?oc:function(n){var e,t,s;return n===void 0?"Undefined":n===null?"Null":typeof(t=Ux(e=Wx(n),Vx))=="string"?t:Bx?oc(e):(s=oc(e))==="Object"&&Fx(e.callee)?"Arguments":s},zx=Yx,Gx=String,ew=function(n){if(zx(n)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Gx(n)},jx=ew,Kx=function(n,e){return n===void 0?arguments.length<2?"":e:jx(n)},Xx=Zo,qx=Sl,Zx=function(n,e){Xx(e)&&"cause"in e&&qx(n,"cause",e.cause)},Qx=Jt,d0=Error,Jx=Qx("".replace),eH=function(n){return String(d0(n).stack)}("zxcasd"),f0=/\n\s*at [^:]*:[^\n]*/,tH=f0.test(eH),nH=function(n,e){if(tH&&typeof n=="string"&&!d0.prepareStackTrace)for(;e--;)n=Jx(n,f0,"");return n},sH=Gn,oH=Fp,iH=!sH(function(){var n=Error("a");return"stack"in n?(Object.defineProperty(n,"stack",oH(1,7)),n.stack!==7):!0}),rH=Sl,aH=nH,lH=iH,QS=Error.captureStackTrace,uH=function(n,e,t,s){lH&&(QS?QS(n,e):rH(n,"stack",aH(t,s)))},JS=wl,cH=Hs,ev=Sl,hH=Wp,tv=c0,nv=i0,sv=Ix,dH=Px,fH=Kx,gH=Zx,mH=uH,pH=xs,wH=function(n,e,t,s){var o="stackTraceLimit",i=s?2:1,r=n.split("."),a=r[r.length-1],l=JS.apply(null,r);if(l){var u=l.prototype;if(cH(u,"cause")&&delete u.cause,!t)return l;var c=JS("Error"),d=e(function(f,m){var w=fH(s?m:f,void 0),C=s?new l(f):new l;return w!==void 0&&ev(C,"message",w),mH(C,d,C.stack,2),this&&hH(u,this)&&dH(C,this,d),arguments.length>i&&gH(C,arguments[i]),C});d.prototype=u,a!=="Error"?tv?tv(d,c):nv(d,c,{name:!0}):pH&&o in l&&(sv(d,l,o),sv(d,l,"prepareStackTrace")),nv(d,l);try{u.name!==a&&ev(u,"name",a),u.constructor=d}catch{}return d}},g0=Qo,CH=cn,Ps=dh,m0=wH,Vm="WebAssembly",ov=CH[Vm],Ic=Error("e",{cause:7}).cause!==7,Li=function(n,e){var t={};t[n]=m0(n,e,Ic),g0({global:!0,constructor:!0,arity:1,forced:Ic},t)},tw=function(n,e){if(ov&&ov[n]){var t={};t[n]=m0(Vm+"."+n,e,Ic),g0({target:Vm,stat:!0,constructor:!0,arity:1,forced:Ic},t)}};Li("Error",function(n){return function(t){return Ps(n,this,arguments)}});Li("EvalError",function(n){return function(t){return Ps(n,this,arguments)}});Li("RangeError",function(n){return function(t){return Ps(n,this,arguments)}});Li("ReferenceError",function(n){return function(t){return Ps(n,this,arguments)}});Li("SyntaxError",function(n){return function(t){return Ps(n,this,arguments)}});Li("TypeError",function(n){return function(t){return Ps(n,this,arguments)}});Li("URIError",function(n){return function(t){return Ps(n,this,arguments)}});tw("CompileError",function(n){return function(t){return Ps(n,this,arguments)}});tw("LinkError",function(n){return function(t){return Ps(n,this,arguments)}});tw("RuntimeError",function(n){return function(t){return Ps(n,this,arguments)}});var SH=Di,vH=Jt,yH=function(n){if(SH(n)==="Function")return vH(n)},iv=yH,bH=zp,RH=uh,EH=iv(iv.bind),TH=function(n,e){return bH(n),e===void 0?n:RH?EH(n,e):function(){return n.apply(e,arguments)}},MH=wl,p0=MH("document","documentElement"),_H=Jt,nw=_H([].slice),OH=TypeError,w0=function(n,e){if(n<e)throw OH("Not enough arguments");return n},AH=Bp,IH=/(?:ipad|iphone|ipod).*applewebkit/i.test(AH),xH=cn,HH=Di,PH=HH(xH.process)==="process",Ln=cn,DH=dh,NH=TH,rv=Kt,LH=Hs,C0=Gn,av=p0,kH=nw,lv=Kp,FH=w0,$H=IH,VH=PH,Wm=Ln.setImmediate,Bm=Ln.clearImmediate,WH=Ln.process,Pf=Ln.Dispatch,BH=Ln.Function,uv=Ln.MessageChannel,UH=Ln.String,Df=0,Fa={},cv="onreadystatechange",Qa,si,Nf,Lf;C0(function(){Qa=Ln.location});var sw=function(n){if(LH(Fa,n)){var e=Fa[n];delete Fa[n],e()}},kf=function(n){return function(){sw(n)}},hv=function(n){sw(n.data)},dv=function(n){Ln.postMessage(UH(n),Qa.protocol+"//"+Qa.host)};(!Wm||!Bm)&&(Wm=function(e){FH(arguments.length,1);var t=rv(e)?e:BH(e),s=kH(arguments,1);return Fa[++Df]=function(){DH(t,void 0,s)},si(Df),Df},Bm=function(e){delete Fa[e]},VH?si=function(n){WH.nextTick(kf(n))}:Pf&&Pf.now?si=function(n){Pf.now(kf(n))}:uv&&!$H?(Nf=new uv,Lf=Nf.port2,Nf.port1.onmessage=hv,si=NH(Lf.postMessage,Lf)):Ln.addEventListener&&rv(Ln.postMessage)&&!Ln.importScripts&&Qa&&Qa.protocol!=="file:"&&!C0(dv)?(si=dv,Ln.addEventListener("message",hv,!1)):cv in lv("script")?si=function(n){av.appendChild(lv("script"))[cv]=function(){av.removeChild(this),sw(n)}}:si=function(n){setTimeout(kf(n),0)});var S0={set:Wm,clear:Bm},YH=Qo,zH=cn,fv=S0.clear;YH({global:!0,bind:!0,enumerable:!0,forced:zH.clearImmediate!==fv},{clearImmediate:fv});var GH=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",v0=cn,jH=dh,KH=Kt,XH=GH,qH=Bp,ZH=nw,QH=w0,JH=v0.Function,eP=/MSIE .\./.test(qH)||XH&&function(){var n=v0.Bun.version.split(".");return n.length<3||n[0]==="0"&&(n[1]<3||n[1]==="3"&&n[2]==="0")}(),tP=function(n,e){var t=e?2:1;return eP?function(s,o){var i=QH(arguments.length,1)>t,r=KH(s)?s:JH(s),a=i?ZH(arguments,t):[],l=i?function(){jH(r,this,a)}:r;return e?n(l,o):n(l)}:n},nP=Qo,y0=cn,gv=S0.set,sP=tP,mv=y0.setImmediate?sP(gv,!1):gv;nP({global:!0,bind:!0,enumerable:!0,forced:y0.setImmediate!==mv},{setImmediate:mv});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Po(n){"@babel/helpers - typeof";return Po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Po(n)}function Um(n,e){return Um=Object.setPrototypeOf||function(s,o){return s.__proto__=o,s},Um(n,e)}function oP(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ic(n,e,t){return oP()?ic=Reflect.construct:ic=function(o,i,r){var a=[null];a.push.apply(a,i);var l=Function.bind.apply(o,a),u=new l;return r&&Um(u,r.prototype),u},ic.apply(null,arguments)}function ns(n){return iP(n)||rP(n)||aP(n)||lP()}function iP(n){if(Array.isArray(n))return Ym(n)}function rP(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function aP(n,e){if(n){if(typeof n=="string")return Ym(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ym(n,e)}}function Ym(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,s=new Array(e);t<e;t++)s[t]=n[t];return s}function lP(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var uP=Object.hasOwnProperty,pv=Object.setPrototypeOf,cP=Object.isFrozen,hP=Object.getPrototypeOf,dP=Object.getOwnPropertyDescriptor,vn=Object.freeze,ls=Object.seal,fP=Object.create,b0=typeof Reflect<"u"&&Reflect,xc=b0.apply,zm=b0.construct;xc||(xc=function(e,t,s){return e.apply(t,s)});vn||(vn=function(e){return e});ls||(ls=function(e){return e});zm||(zm=function(e,t){return ic(e,ns(t))});var gP=zn(Array.prototype.forEach),wv=zn(Array.prototype.pop),Zr=zn(Array.prototype.push),rc=zn(String.prototype.toLowerCase),Ff=zn(String.prototype.toString),mP=zn(String.prototype.match),qn=zn(String.prototype.replace),pP=zn(String.prototype.indexOf),wP=zn(String.prototype.trim),gn=zn(RegExp.prototype.test),$f=CP(TypeError);function zn(n){return function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];return xc(n,e,s)}}function CP(n){return function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return zm(n,t)}}function ze(n,e,t){var s;t=(s=t)!==null&&s!==void 0?s:rc,pv&&pv(n,null);for(var o=e.length;o--;){var i=e[o];if(typeof i=="string"){var r=t(i);r!==i&&(cP(e)||(e[o]=r),i=r)}n[i]=!0}return n}function oi(n){var e=fP(null),t;for(t in n)xc(uP,n,[t])===!0&&(e[t]=n[t]);return e}function Ql(n,e){for(;n!==null;){var t=dP(n,e);if(t){if(t.get)return zn(t.get);if(typeof t.value=="function")return zn(t.value)}n=hP(n)}function s(o){return console.warn("fallback value for",o),null}return s}var Cv=vn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Vf=vn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Wf=vn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),SP=vn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Bf=vn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),vP=vn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Sv=vn(["#text"]),vv=vn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Uf=vn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),yv=vn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Jl=vn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),yP=ls(/\{\{[\w\W]*|[\w\W]*\}\}/gm),bP=ls(/<%[\w\W]*|[\w\W]*%>/gm),RP=ls(/\${[\w\W]*}/gm),EP=ls(/^data-[\-\w.\u00B7-\uFFFF]/),TP=ls(/^aria-[\-\w]+$/),MP=ls(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),_P=ls(/^(?:\w+script|data):/i),OP=ls(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),AP=ls(/^html$/i),IP=function(){return typeof window>"u"?null:window},xP=function(e,t){if(Po(e)!=="object"||typeof e.createPolicy!="function")return null;var s=null,o="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(o)&&(s=t.currentScript.getAttribute(o));var i="dompurify"+(s?"#"+s:"");try{return e.createPolicy(i,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}};function R0(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:IP(),e=function(N){return R0(N)};if(e.version="2.4.7",e.removed=[],!n||!n.document||n.document.nodeType!==9)return e.isSupported=!1,e;var t=n.document,s=n.document,o=n.DocumentFragment,i=n.HTMLTemplateElement,r=n.Node,a=n.Element,l=n.NodeFilter,u=n.NamedNodeMap,c=u===void 0?n.NamedNodeMap||n.MozNamedAttrMap:u,d=n.HTMLFormElement,f=n.DOMParser,m=n.trustedTypes,w=a.prototype,C=Ql(w,"cloneNode"),b=Ql(w,"nextSibling"),y=Ql(w,"childNodes"),M=Ql(w,"parentNode");if(typeof i=="function"){var A=s.createElement("template");A.content&&A.content.ownerDocument&&(s=A.content.ownerDocument)}var $=xP(m,t),H=$?$.createHTML(""):"",V=s,z=V.implementation,ee=V.createNodeIterator,j=V.createDocumentFragment,X=V.getElementsByTagName,ie=t.importNode,ae={};try{ae=oi(s).documentMode?s.documentMode:{}}catch{}var re={};e.isSupported=typeof M=="function"&&z&&z.createHTMLDocument!==void 0&&ae!==9;var pe=yP,Oe=bP,Je=RP,Ie=EP,R=TP,h=_P,g=OP,p=MP,E=null,_=ze({},[].concat(ns(Cv),ns(Vf),ns(Wf),ns(Bf),ns(Sv))),I=null,Y=ze({},[].concat(ns(vv),ns(Uf),ns(yv),ns(Jl))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),q=null,Z=null,K=!0,ce=!0,Me=!1,Ee=!0,Te=!1,G=!1,Ye=!1,Fe=!1,ye=!1,xe=!1,ve=!1,S=!0,v=!1,O="user-content-",F=!0,x=!1,k={},P=null,D=ze({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),B=null,L=ze({},["audio","video","img","source","image","track"]),U=null,se=ze({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),he="http://www.w3.org/1998/Math/MathML",Ce="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml",ke=_e,gt=!1,je=null,rt=ze({},[he,Ce,_e],Ff),vt,Wi=["application/xhtml+xml","text/html"],Xr="text/html",Ht,Xt=null,ni=s.createElement("form"),fn=function(N){return N instanceof RegExp||N instanceof Function},Wt=function(N){Xt&&Xt===N||((!N||Po(N)!=="object")&&(N={}),N=oi(N),vt=Wi.indexOf(N.PARSER_MEDIA_TYPE)===-1?vt=Xr:vt=N.PARSER_MEDIA_TYPE,Ht=vt==="application/xhtml+xml"?Ff:rc,E="ALLOWED_TAGS"in N?ze({},N.ALLOWED_TAGS,Ht):_,I="ALLOWED_ATTR"in N?ze({},N.ALLOWED_ATTR,Ht):Y,je="ALLOWED_NAMESPACES"in N?ze({},N.ALLOWED_NAMESPACES,Ff):rt,U="ADD_URI_SAFE_ATTR"in N?ze(oi(se),N.ADD_URI_SAFE_ATTR,Ht):se,B="ADD_DATA_URI_TAGS"in N?ze(oi(L),N.ADD_DATA_URI_TAGS,Ht):L,P="FORBID_CONTENTS"in N?ze({},N.FORBID_CONTENTS,Ht):D,q="FORBID_TAGS"in N?ze({},N.FORBID_TAGS,Ht):{},Z="FORBID_ATTR"in N?ze({},N.FORBID_ATTR,Ht):{},k="USE_PROFILES"in N?N.USE_PROFILES:!1,K=N.ALLOW_ARIA_ATTR!==!1,ce=N.ALLOW_DATA_ATTR!==!1,Me=N.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Te=N.SAFE_FOR_TEMPLATES||!1,G=N.WHOLE_DOCUMENT||!1,ye=N.RETURN_DOM||!1,xe=N.RETURN_DOM_FRAGMENT||!1,ve=N.RETURN_TRUSTED_TYPE||!1,Fe=N.FORCE_BODY||!1,S=N.SANITIZE_DOM!==!1,v=N.SANITIZE_NAMED_PROPS||!1,F=N.KEEP_CONTENT!==!1,x=N.IN_PLACE||!1,p=N.ALLOWED_URI_REGEXP||p,ke=N.NAMESPACE||_e,W=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&fn(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&fn(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(W.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Te&&(ce=!1),xe&&(ye=!0),k&&(E=ze({},ns(Sv)),I=[],k.html===!0&&(ze(E,Cv),ze(I,vv)),k.svg===!0&&(ze(E,Vf),ze(I,Uf),ze(I,Jl)),k.svgFilters===!0&&(ze(E,Wf),ze(I,Uf),ze(I,Jl)),k.mathMl===!0&&(ze(E,Bf),ze(I,yv),ze(I,Jl))),N.ADD_TAGS&&(E===_&&(E=oi(E)),ze(E,N.ADD_TAGS,Ht)),N.ADD_ATTR&&(I===Y&&(I=oi(I)),ze(I,N.ADD_ATTR,Ht)),N.ADD_URI_SAFE_ATTR&&ze(U,N.ADD_URI_SAFE_ATTR,Ht),N.FORBID_CONTENTS&&(P===D&&(P=oi(P)),ze(P,N.FORBID_CONTENTS,Ht)),F&&(E["#text"]=!0),G&&ze(E,["html","head","body"]),E.table&&(ze(E,["tbody"]),delete q.tbody),vn&&vn(N),Xt=N)},mt=ze({},["mi","mo","mn","ms","mtext"]),SS=ze({},["foreignobject","desc","title","annotation-xml"]),A1=ze({},["title","style","font","a","script"]),Gl=ze({},Vf);ze(Gl,Wf),ze(Gl,SP);var mf=ze({},Bf);ze(mf,vP);var I1=function(N){var ne=M(N);(!ne||!ne.tagName)&&(ne={namespaceURI:ke,tagName:"template"});var le=rc(N.tagName),it=rc(ne.tagName);return je[N.namespaceURI]?N.namespaceURI===Ce?ne.namespaceURI===_e?le==="svg":ne.namespaceURI===he?le==="svg"&&(it==="annotation-xml"||mt[it]):!!Gl[le]:N.namespaceURI===he?ne.namespaceURI===_e?le==="math":ne.namespaceURI===Ce?le==="math"&&SS[it]:!!mf[le]:N.namespaceURI===_e?ne.namespaceURI===Ce&&!SS[it]||ne.namespaceURI===he&&!mt[it]?!1:!mf[le]&&(A1[le]||!Gl[le]):!!(vt==="application/xhtml+xml"&&je[N.namespaceURI]):!1},ks=function(N){Zr(e.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=H}catch{N.remove()}}},pf=function(N,ne){try{Zr(e.removed,{attribute:ne.getAttributeNode(N),from:ne})}catch{Zr(e.removed,{attribute:null,from:ne})}if(ne.removeAttribute(N),N==="is"&&!I[N])if(ye||xe)try{ks(ne)}catch{}else try{ne.setAttribute(N,"")}catch{}},vS=function(N){var ne,le;if(Fe)N="<remove></remove>"+N;else{var it=mP(N,/^[\r\n\t ]+/);le=it&&it[0]}vt==="application/xhtml+xml"&&ke===_e&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var bn=$?$.createHTML(N):N;if(ke===_e)try{ne=new f().parseFromString(bn,vt)}catch{}if(!ne||!ne.documentElement){ne=z.createDocument(ke,"template",null);try{ne.documentElement.innerHTML=gt?H:bn}catch{}}var en=ne.body||ne.documentElement;return N&&le&&en.insertBefore(s.createTextNode(le),en.childNodes[0]||null),ke===_e?X.call(ne,G?"html":"body")[0]:G?ne.documentElement:en},yS=function(N){return ee.call(N.ownerDocument||N,N,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},x1=function(N){return N instanceof d&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},qr=function(N){return Po(r)==="object"?N instanceof r:N&&Po(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},Fs=function(N,ne,le){re[N]&&gP(re[N],function(it){it.call(e,ne,le,Xt)})},bS=function(N){var ne;if(Fs("beforeSanitizeElements",N,null),x1(N)||gn(/[\u0080-\uFFFF]/,N.nodeName))return ks(N),!0;var le=Ht(N.nodeName);if(Fs("uponSanitizeElement",N,{tagName:le,allowedTags:E}),N.hasChildNodes()&&!qr(N.firstElementChild)&&(!qr(N.content)||!qr(N.content.firstElementChild))&&gn(/<[/\w]/g,N.innerHTML)&&gn(/<[/\w]/g,N.textContent)||le==="select"&&gn(/<template/i,N.innerHTML))return ks(N),!0;if(!E[le]||q[le]){if(!q[le]&&ES(le)&&(W.tagNameCheck instanceof RegExp&&gn(W.tagNameCheck,le)||W.tagNameCheck instanceof Function&&W.tagNameCheck(le)))return!1;if(F&&!P[le]){var it=M(N)||N.parentNode,bn=y(N)||N.childNodes;if(bn&&it)for(var en=bn.length,qt=en-1;qt>=0;--qt)it.insertBefore(C(bn[qt],!0),b(N))}return ks(N),!0}return N instanceof a&&!I1(N)||(le==="noscript"||le==="noembed"||le==="noframes")&&gn(/<\/no(script|embed|frames)/i,N.innerHTML)?(ks(N),!0):(Te&&N.nodeType===3&&(ne=N.textContent,ne=qn(ne,pe," "),ne=qn(ne,Oe," "),ne=qn(ne,Je," "),N.textContent!==ne&&(Zr(e.removed,{element:N.cloneNode()}),N.textContent=ne)),Fs("afterSanitizeElements",N,null),!1)},RS=function(N,ne,le){if(S&&(ne==="id"||ne==="name")&&(le in s||le in ni))return!1;if(!(ce&&!Z[ne]&&gn(Ie,ne))){if(!(K&&gn(R,ne))){if(!I[ne]||Z[ne]){if(!(ES(N)&&(W.tagNameCheck instanceof RegExp&&gn(W.tagNameCheck,N)||W.tagNameCheck instanceof Function&&W.tagNameCheck(N))&&(W.attributeNameCheck instanceof RegExp&&gn(W.attributeNameCheck,ne)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(ne))||ne==="is"&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&gn(W.tagNameCheck,le)||W.tagNameCheck instanceof Function&&W.tagNameCheck(le))))return!1}else if(!U[ne]){if(!gn(p,qn(le,g,""))){if(!((ne==="src"||ne==="xlink:href"||ne==="href")&&N!=="script"&&pP(le,"data:")===0&&B[N])){if(!(Me&&!gn(h,qn(le,g,"")))){if(le)return!1}}}}}}return!0},ES=function(N){return N.indexOf("-")>0},TS=function(N){var ne,le,it,bn;Fs("beforeSanitizeAttributes",N,null);var en=N.attributes;if(en){var qt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:I};for(bn=en.length;bn--;){ne=en[bn];var jl=ne,zt=jl.name,wf=jl.namespaceURI;if(le=zt==="value"?ne.value:wP(ne.value),it=Ht(zt),qt.attrName=it,qt.attrValue=le,qt.keepAttr=!0,qt.forceKeepAttr=void 0,Fs("uponSanitizeAttribute",N,qt),le=qt.attrValue,!qt.forceKeepAttr&&(pf(zt,N),!!qt.keepAttr)){if(!Ee&&gn(/\/>/i,le)){pf(zt,N);continue}Te&&(le=qn(le,pe," "),le=qn(le,Oe," "),le=qn(le,Je," "));var MS=Ht(N.nodeName);if(RS(MS,it,le)){if(v&&(it==="id"||it==="name")&&(pf(zt,N),le=O+le),$&&Po(m)==="object"&&typeof m.getAttributeType=="function"&&!wf)switch(m.getAttributeType(MS,it)){case"TrustedHTML":{le=$.createHTML(le);break}case"TrustedScriptURL":{le=$.createScriptURL(le);break}}try{wf?N.setAttributeNS(wf,zt,le):N.setAttribute(zt,le),wv(e.removed)}catch{}}}}Fs("afterSanitizeAttributes",N,null)}},H1=function be(N){var ne,le=yS(N);for(Fs("beforeSanitizeShadowDOM",N,null);ne=le.nextNode();)Fs("uponSanitizeShadowNode",ne,null),!bS(ne)&&(ne.content instanceof o&&be(ne.content),TS(ne));Fs("afterSanitizeShadowDOM",N,null)};return e.sanitize=function(be){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ne,le,it,bn,en;if(gt=!be,gt&&(be="<!-->"),typeof be!="string"&&!qr(be))if(typeof be.toString=="function"){if(be=be.toString(),typeof be!="string")throw $f("dirty is not a string, aborting")}else throw $f("toString is not a function");if(!e.isSupported){if(Po(n.toStaticHTML)==="object"||typeof n.toStaticHTML=="function"){if(typeof be=="string")return n.toStaticHTML(be);if(qr(be))return n.toStaticHTML(be.outerHTML)}return be}if(Ye||Wt(N),e.removed=[],typeof be=="string"&&(x=!1),x){if(be.nodeName){var qt=Ht(be.nodeName);if(!E[qt]||q[qt])throw $f("root node is forbidden and cannot be sanitized in-place")}}else if(be instanceof r)ne=vS("<!---->"),le=ne.ownerDocument.importNode(be,!0),le.nodeType===1&&le.nodeName==="BODY"||le.nodeName==="HTML"?ne=le:ne.appendChild(le);else{if(!ye&&!Te&&!G&&be.indexOf("<")===-1)return $&&ve?$.createHTML(be):be;if(ne=vS(be),!ne)return ye?null:ve?H:""}ne&&Fe&&ks(ne.firstChild);for(var jl=yS(x?be:ne);it=jl.nextNode();)it.nodeType===3&&it===bn||bS(it)||(it.content instanceof o&&H1(it.content),TS(it),bn=it);if(bn=null,x)return be;if(ye){if(xe)for(en=j.call(ne.ownerDocument);ne.firstChild;)en.appendChild(ne.firstChild);else en=ne;return(I.shadowroot||I.shadowrootmod)&&(en=ie.call(t,en,!0)),en}var zt=G?ne.outerHTML:ne.innerHTML;return G&&E["!doctype"]&&ne.ownerDocument&&ne.ownerDocument.doctype&&ne.ownerDocument.doctype.name&&gn(AP,ne.ownerDocument.doctype.name)&&(zt="<!DOCTYPE "+ne.ownerDocument.doctype.name+`>
`+zt),Te&&(zt=qn(zt,pe," "),zt=qn(zt,Oe," "),zt=qn(zt,Je," ")),$&&ve?$.createHTML(zt):zt},e.setConfig=function(be){Wt(be),Ye=!0},e.clearConfig=function(){Xt=null,Ye=!1},e.isValidAttribute=function(be,N,ne){Xt||Wt({});var le=Ht(be),it=Ht(N);return RS(le,it,ne)},e.addHook=function(be,N){typeof N=="function"&&(re[be]=re[be]||[],Zr(re[be],N))},e.removeHook=function(be){if(re[be])return wv(re[be])},e.removeHooks=function(be){re[be]&&(re[be]=[])},e.removeAllHooks=function(){re={}},e}var HP=R0();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var E0;function Q(){return E0.apply(null,arguments)}function PP(n){E0=n}function us(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function _i(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function st(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function ow(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(st(n,e))return!1;return!0}function _n(n){return n===void 0}function lo(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function yl(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function T0(n,e){var t=[],s,o=n.length;for(s=0;s<o;++s)t.push(e(n[s],s));return t}function No(n,e){for(var t in e)st(e,t)&&(n[t]=e[t]);return st(e,"toString")&&(n.toString=e.toString),st(e,"valueOf")&&(n.valueOf=e.valueOf),n}function Ds(n,e,t,s){return X0(n,e,t,s,!0).utc()}function DP(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Be(n){return n._pf==null&&(n._pf=DP()),n._pf}var Gm;Array.prototype.some?Gm=Array.prototype.some:Gm=function(n){var e=Object(this),t=e.length>>>0,s;for(s=0;s<t;s++)if(s in e&&n.call(this,e[s],s,e))return!0;return!1};function iw(n){if(n._isValid==null){var e=Be(n),t=Gm.call(e.parsedDateParts,function(o){return o!=null}),s=!isNaN(n._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t);if(n._strict&&(s=s&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=s;else return s}return n._isValid}function fh(n){var e=Ds(NaN);return n!=null?No(Be(e),n):Be(e).userInvalidated=!0,e}var bv=Q.momentProperties=[],Yf=!1;function rw(n,e){var t,s,o,i=bv.length;if(_n(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),_n(e._i)||(n._i=e._i),_n(e._f)||(n._f=e._f),_n(e._l)||(n._l=e._l),_n(e._strict)||(n._strict=e._strict),_n(e._tzm)||(n._tzm=e._tzm),_n(e._isUTC)||(n._isUTC=e._isUTC),_n(e._offset)||(n._offset=e._offset),_n(e._pf)||(n._pf=Be(e)),_n(e._locale)||(n._locale=e._locale),i>0)for(t=0;t<i;t++)s=bv[t],o=e[s],_n(o)||(n[s]=o);return n}function bl(n){rw(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Yf===!1&&(Yf=!0,Q.updateOffset(this),Yf=!1)}function cs(n){return n instanceof bl||n!=null&&n._isAMomentObject!=null}function M0(n){Q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function jn(n,e){var t=!0;return No(function(){if(Q.deprecationHandler!=null&&Q.deprecationHandler(null,n),t){var s=[],o,i,r,a=arguments.length;for(i=0;i<a;i++){if(o="",typeof arguments[i]=="object"){o+=`
[`+i+"] ";for(r in arguments[0])st(arguments[0],r)&&(o+=r+": "+arguments[0][r]+", ");o=o.slice(0,-2)}else o=arguments[i];s.push(o)}M0(n+`
Arguments: `+Array.prototype.slice.call(s).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var Rv={};function _0(n,e){Q.deprecationHandler!=null&&Q.deprecationHandler(n,e),Rv[n]||(M0(e),Rv[n]=!0)}Q.suppressDeprecationWarnings=!1;Q.deprecationHandler=null;function Ns(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function NP(n){var e,t;for(t in n)st(n,t)&&(e=n[t],Ns(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function jm(n,e){var t=No({},n),s;for(s in e)st(e,s)&&(_i(n[s])&&_i(e[s])?(t[s]={},No(t[s],n[s]),No(t[s],e[s])):e[s]!=null?t[s]=e[s]:delete t[s]);for(s in n)st(n,s)&&!st(e,s)&&_i(n[s])&&(t[s]=No({},t[s]));return t}function aw(n){n!=null&&this.set(n)}var Km;Object.keys?Km=Object.keys:Km=function(n){var e,t=[];for(e in n)st(n,e)&&t.push(e);return t};var LP={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function kP(n,e,t){var s=this._calendar[n]||this._calendar.sameElse;return Ns(s)?s.call(e,t):s}function Is(n,e,t){var s=""+Math.abs(n),o=e-s.length,i=n>=0;return(i?t?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+s}var lw=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,eu=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,zf={},Er={};function Re(n,e,t,s){var o=s;typeof s=="string"&&(o=function(){return this[s]()}),n&&(Er[n]=o),e&&(Er[e[0]]=function(){return Is(o.apply(this,arguments),e[1],e[2])}),t&&(Er[t]=function(){return this.localeData().ordinal(o.apply(this,arguments),n)})}function FP(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function $P(n){var e=n.match(lw),t,s;for(t=0,s=e.length;t<s;t++)Er[e[t]]?e[t]=Er[e[t]]:e[t]=FP(e[t]);return function(o){var i="",r;for(r=0;r<s;r++)i+=Ns(e[r])?e[r].call(o,n):e[r];return i}}function ac(n,e){return n.isValid()?(e=O0(e,n.localeData()),zf[e]=zf[e]||$P(e),zf[e](n)):n.localeData().invalidDate()}function O0(n,e){var t=5;function s(o){return e.longDateFormat(o)||o}for(eu.lastIndex=0;t>=0&&eu.test(n);)n=n.replace(eu,s),eu.lastIndex=0,t-=1;return n}var VP={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function WP(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(lw).map(function(s){return s==="MMMM"||s==="MM"||s==="DD"||s==="dddd"?s.slice(1):s}).join(""),this._longDateFormat[n])}var BP="Invalid date";function UP(){return this._invalidDate}var YP="%d",zP=/\d{1,2}/;function GP(n){return this._ordinal.replace("%d",n)}var jP={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function KP(n,e,t,s){var o=this._relativeTime[t];return Ns(o)?o(n,e,t,s):o.replace(/%d/i,n)}function XP(n,e){var t=this._relativeTime[n>0?"future":"past"];return Ns(t)?t(e):t.replace(/%s/i,e)}var $a={};function hn(n,e){var t=n.toLowerCase();$a[t]=$a[t+"s"]=$a[e]=n}function Kn(n){return typeof n=="string"?$a[n]||$a[n.toLowerCase()]:void 0}function uw(n){var e={},t,s;for(s in n)st(n,s)&&(t=Kn(s),t&&(e[t]=n[s]));return e}var A0={};function dn(n,e){A0[n]=e}function qP(n){var e=[],t;for(t in n)st(n,t)&&e.push({unit:t,priority:A0[t]});return e.sort(function(s,o){return s.priority-o.priority}),e}function gh(n){return n%4===0&&n%100!==0||n%400===0}function Yn(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function qe(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=Yn(e)),t}function $r(n,e){return function(t){return t!=null?(I0(this,n,t),Q.updateOffset(this,e),this):Hc(this,n)}}function Hc(n,e){return n.isValid()?n._d["get"+(n._isUTC?"UTC":"")+e]():NaN}function I0(n,e,t){n.isValid()&&!isNaN(t)&&(e==="FullYear"&&gh(n.year())&&n.month()===1&&n.date()===29?(t=qe(t),n._d["set"+(n._isUTC?"UTC":"")+e](t,n.month(),vh(t,n.month()))):n._d["set"+(n._isUTC?"UTC":"")+e](t))}function ZP(n){return n=Kn(n),Ns(this[n])?this[n]():this}function QP(n,e){if(typeof n=="object"){n=uw(n);var t=qP(n),s,o=t.length;for(s=0;s<o;s++)this[t[s].unit](n[t[s].unit])}else if(n=Kn(n),Ns(this[n]))return this[n](e);return this}var x0=/\d/,Fn=/\d\d/,H0=/\d{3}/,cw=/\d{4}/,mh=/[+-]?\d{6}/,St=/\d\d?/,P0=/\d\d\d\d?/,D0=/\d\d\d\d\d\d?/,ph=/\d{1,3}/,hw=/\d{1,4}/,wh=/[+-]?\d{1,6}/,Vr=/\d+/,Ch=/[+-]?\d+/,JP=/Z|[+-]\d\d:?\d\d/gi,Sh=/Z|[+-]\d\d(?::?\d\d)?/gi,eD=/[+-]?\d+(\.\d{1,3})?/,Rl=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Pc;Pc={};function ge(n,e,t){Pc[n]=Ns(e)?e:function(s,o){return s&&t?t:e}}function tD(n,e){return st(Pc,n)?Pc[n](e._strict,e._locale):new RegExp(nD(n))}function nD(n){return Nn(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,s,o,i){return t||s||o||i}))}function Nn(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Xm={};function ct(n,e){var t,s=e,o;for(typeof n=="string"&&(n=[n]),lo(e)&&(s=function(i,r){r[e]=qe(i)}),o=n.length,t=0;t<o;t++)Xm[n[t]]=s}function El(n,e){ct(n,function(t,s,o,i){o._w=o._w||{},e(t,o._w,o,i)})}function sD(n,e,t){e!=null&&st(Xm,n)&&Xm[n](e,t._a,t,n)}var ln=0,no=1,Ms=2,Ut=3,is=4,so=5,Ri=6,oD=7,iD=8;function rD(n,e){return(n%e+e)%e}var Nt;Array.prototype.indexOf?Nt=Array.prototype.indexOf:Nt=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function vh(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=rD(e,12);return n+=(e-t)/12,t===1?gh(n)?29:28:31-t%7%2}Re("M",["MM",2],"Mo",function(){return this.month()+1});Re("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});Re("MMMM",0,0,function(n){return this.localeData().months(this,n)});hn("month","M");dn("month",8);ge("M",St);ge("MM",St,Fn);ge("MMM",function(n,e){return e.monthsShortRegex(n)});ge("MMMM",function(n,e){return e.monthsRegex(n)});ct(["M","MM"],function(n,e){e[no]=qe(n)-1});ct(["MMM","MMMM"],function(n,e,t,s){var o=t._locale.monthsParse(n,s,t._strict);o!=null?e[no]=o:Be(t).invalidMonth=n});var aD="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),N0="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),L0=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,lD=Rl,uD=Rl;function cD(n,e){return n?us(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||L0).test(e)?"format":"standalone"][n.month()]:us(this._months)?this._months:this._months.standalone}function hD(n,e){return n?us(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[L0.test(e)?"format":"standalone"][n.month()]:us(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function dD(n,e,t){var s,o,i,r=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)i=Ds([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(i,"").toLocaleLowerCase();return t?e==="MMM"?(o=Nt.call(this._shortMonthsParse,r),o!==-1?o:null):(o=Nt.call(this._longMonthsParse,r),o!==-1?o:null):e==="MMM"?(o=Nt.call(this._shortMonthsParse,r),o!==-1?o:(o=Nt.call(this._longMonthsParse,r),o!==-1?o:null)):(o=Nt.call(this._longMonthsParse,r),o!==-1?o:(o=Nt.call(this._shortMonthsParse,r),o!==-1?o:null))}function fD(n,e,t){var s,o,i;if(this._monthsParseExact)return dD.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(o=Ds([2e3,s]),t&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),!t&&!this._monthsParse[s]&&(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[s]=new RegExp(i.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[s].test(n))return s;if(t&&e==="MMM"&&this._shortMonthsParse[s].test(n))return s;if(!t&&this._monthsParse[s].test(n))return s}}function k0(n,e){var t;if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=qe(e);else if(e=n.localeData().monthsParse(e),!lo(e))return n}return t=Math.min(n.date(),vh(n.year(),e)),n._d["set"+(n._isUTC?"UTC":"")+"Month"](e,t),n}function F0(n){return n!=null?(k0(this,n),Q.updateOffset(this,!0),this):Hc(this,"Month")}function gD(){return vh(this.year(),this.month())}function mD(n){return this._monthsParseExact?(st(this,"_monthsRegex")||$0.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(st(this,"_monthsShortRegex")||(this._monthsShortRegex=lD),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function pD(n){return this._monthsParseExact?(st(this,"_monthsRegex")||$0.call(this),n?this._monthsStrictRegex:this._monthsRegex):(st(this,"_monthsRegex")||(this._monthsRegex=uD),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function $0(){function n(r,a){return a.length-r.length}var e=[],t=[],s=[],o,i;for(o=0;o<12;o++)i=Ds([2e3,o]),e.push(this.monthsShort(i,"")),t.push(this.months(i,"")),s.push(this.months(i,"")),s.push(this.monthsShort(i,""));for(e.sort(n),t.sort(n),s.sort(n),o=0;o<12;o++)e[o]=Nn(e[o]),t[o]=Nn(t[o]);for(o=0;o<24;o++)s[o]=Nn(s[o]);this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Re("Y",0,0,function(){var n=this.year();return n<=9999?Is(n,4):"+"+n});Re(0,["YY",2],0,function(){return this.year()%100});Re(0,["YYYY",4],0,"year");Re(0,["YYYYY",5],0,"year");Re(0,["YYYYYY",6,!0],0,"year");hn("year","y");dn("year",1);ge("Y",Ch);ge("YY",St,Fn);ge("YYYY",hw,cw);ge("YYYYY",wh,mh);ge("YYYYYY",wh,mh);ct(["YYYYY","YYYYYY"],ln);ct("YYYY",function(n,e){e[ln]=n.length===2?Q.parseTwoDigitYear(n):qe(n)});ct("YY",function(n,e){e[ln]=Q.parseTwoDigitYear(n)});ct("Y",function(n,e){e[ln]=parseInt(n,10)});function Va(n){return gh(n)?366:365}Q.parseTwoDigitYear=function(n){return qe(n)+(qe(n)>68?1900:2e3)};var V0=$r("FullYear",!0);function wD(){return gh(this.year())}function CD(n,e,t,s,o,i,r){var a;return n<100&&n>=0?(a=new Date(n+400,e,t,s,o,i,r),isFinite(a.getFullYear())&&a.setFullYear(n)):a=new Date(n,e,t,s,o,i,r),a}function Ja(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function Dc(n,e,t){var s=7+e-t,o=(7+Ja(n,0,s).getUTCDay()-e)%7;return-o+s-1}function W0(n,e,t,s,o){var i=(7+t-s)%7,r=Dc(n,s,o),a=1+7*(e-1)+i+r,l,u;return a<=0?(l=n-1,u=Va(l)+a):a>Va(n)?(l=n+1,u=a-Va(n)):(l=n,u=a),{year:l,dayOfYear:u}}function el(n,e,t){var s=Dc(n.year(),e,t),o=Math.floor((n.dayOfYear()-s-1)/7)+1,i,r;return o<1?(r=n.year()-1,i=o+ao(r,e,t)):o>ao(n.year(),e,t)?(i=o-ao(n.year(),e,t),r=n.year()+1):(r=n.year(),i=o),{week:i,year:r}}function ao(n,e,t){var s=Dc(n,e,t),o=Dc(n+1,e,t);return(Va(n)-s+o)/7}Re("w",["ww",2],"wo","week");Re("W",["WW",2],"Wo","isoWeek");hn("week","w");hn("isoWeek","W");dn("week",5);dn("isoWeek",5);ge("w",St);ge("ww",St,Fn);ge("W",St);ge("WW",St,Fn);El(["w","ww","W","WW"],function(n,e,t,s){e[s.substr(0,1)]=qe(n)});function SD(n){return el(n,this._week.dow,this._week.doy).week}var vD={dow:0,doy:6};function yD(){return this._week.dow}function bD(){return this._week.doy}function RD(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function ED(n){var e=el(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}Re("d",0,"do","day");Re("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});Re("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});Re("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});Re("e",0,0,"weekday");Re("E",0,0,"isoWeekday");hn("day","d");hn("weekday","e");hn("isoWeekday","E");dn("day",11);dn("weekday",11);dn("isoWeekday",11);ge("d",St);ge("e",St);ge("E",St);ge("dd",function(n,e){return e.weekdaysMinRegex(n)});ge("ddd",function(n,e){return e.weekdaysShortRegex(n)});ge("dddd",function(n,e){return e.weekdaysRegex(n)});El(["dd","ddd","dddd"],function(n,e,t,s){var o=t._locale.weekdaysParse(n,s,t._strict);o!=null?e.d=o:Be(t).invalidWeekday=n});El(["d","e","E"],function(n,e,t,s){e[s]=qe(n)});function TD(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function MD(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function dw(n,e){return n.slice(e,7).concat(n.slice(0,e))}var _D="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),B0="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),OD="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),AD=Rl,ID=Rl,xD=Rl;function HD(n,e){var t=us(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?dw(t,this._week.dow):n?t[n.day()]:t}function PD(n){return n===!0?dw(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function DD(n){return n===!0?dw(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function ND(n,e,t){var s,o,i,r=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)i=Ds([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(i,"").toLocaleLowerCase();return t?e==="dddd"?(o=Nt.call(this._weekdaysParse,r),o!==-1?o:null):e==="ddd"?(o=Nt.call(this._shortWeekdaysParse,r),o!==-1?o:null):(o=Nt.call(this._minWeekdaysParse,r),o!==-1?o:null):e==="dddd"?(o=Nt.call(this._weekdaysParse,r),o!==-1||(o=Nt.call(this._shortWeekdaysParse,r),o!==-1)?o:(o=Nt.call(this._minWeekdaysParse,r),o!==-1?o:null)):e==="ddd"?(o=Nt.call(this._shortWeekdaysParse,r),o!==-1||(o=Nt.call(this._weekdaysParse,r),o!==-1)?o:(o=Nt.call(this._minWeekdaysParse,r),o!==-1?o:null)):(o=Nt.call(this._minWeekdaysParse,r),o!==-1||(o=Nt.call(this._weekdaysParse,r),o!==-1)?o:(o=Nt.call(this._shortWeekdaysParse,r),o!==-1?o:null))}function LD(n,e,t){var s,o,i;if(this._weekdaysParseExact)return ND.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(o=Ds([2e3,1]).day(s),t&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(o,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(o,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(o,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[s]=new RegExp(i.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[s].test(n))return s;if(t&&e==="ddd"&&this._shortWeekdaysParse[s].test(n))return s;if(t&&e==="dd"&&this._minWeekdaysParse[s].test(n))return s;if(!t&&this._weekdaysParse[s].test(n))return s}}function kD(n){if(!this.isValid())return n!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return n!=null?(n=TD(n,this.localeData()),this.add(n-e,"d")):e}function FD(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function $D(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=MD(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function VD(n){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||fw.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(st(this,"_weekdaysRegex")||(this._weekdaysRegex=AD),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function WD(n){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||fw.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(st(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ID),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function BD(n){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||fw.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(st(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=xD),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function fw(){function n(c,d){return d.length-c.length}var e=[],t=[],s=[],o=[],i,r,a,l,u;for(i=0;i<7;i++)r=Ds([2e3,1]).day(i),a=Nn(this.weekdaysMin(r,"")),l=Nn(this.weekdaysShort(r,"")),u=Nn(this.weekdays(r,"")),e.push(a),t.push(l),s.push(u),o.push(a),o.push(l),o.push(u);e.sort(n),t.sort(n),s.sort(n),o.sort(n),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function gw(){return this.hours()%12||12}function UD(){return this.hours()||24}Re("H",["HH",2],0,"hour");Re("h",["hh",2],0,gw);Re("k",["kk",2],0,UD);Re("hmm",0,0,function(){return""+gw.apply(this)+Is(this.minutes(),2)});Re("hmmss",0,0,function(){return""+gw.apply(this)+Is(this.minutes(),2)+Is(this.seconds(),2)});Re("Hmm",0,0,function(){return""+this.hours()+Is(this.minutes(),2)});Re("Hmmss",0,0,function(){return""+this.hours()+Is(this.minutes(),2)+Is(this.seconds(),2)});function U0(n,e){Re(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}U0("a",!0);U0("A",!1);hn("hour","h");dn("hour",13);function Y0(n,e){return e._meridiemParse}ge("a",Y0);ge("A",Y0);ge("H",St);ge("h",St);ge("k",St);ge("HH",St,Fn);ge("hh",St,Fn);ge("kk",St,Fn);ge("hmm",P0);ge("hmmss",D0);ge("Hmm",P0);ge("Hmmss",D0);ct(["H","HH"],Ut);ct(["k","kk"],function(n,e,t){var s=qe(n);e[Ut]=s===24?0:s});ct(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n});ct(["h","hh"],function(n,e,t){e[Ut]=qe(n),Be(t).bigHour=!0});ct("hmm",function(n,e,t){var s=n.length-2;e[Ut]=qe(n.substr(0,s)),e[is]=qe(n.substr(s)),Be(t).bigHour=!0});ct("hmmss",function(n,e,t){var s=n.length-4,o=n.length-2;e[Ut]=qe(n.substr(0,s)),e[is]=qe(n.substr(s,2)),e[so]=qe(n.substr(o)),Be(t).bigHour=!0});ct("Hmm",function(n,e,t){var s=n.length-2;e[Ut]=qe(n.substr(0,s)),e[is]=qe(n.substr(s))});ct("Hmmss",function(n,e,t){var s=n.length-4,o=n.length-2;e[Ut]=qe(n.substr(0,s)),e[is]=qe(n.substr(s,2)),e[so]=qe(n.substr(o))});function YD(n){return(n+"").toLowerCase().charAt(0)==="p"}var zD=/[ap]\.?m?\.?/i,GD=$r("Hours",!0);function jD(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var z0={calendar:LP,longDateFormat:VP,invalidDate:BP,ordinal:YP,dayOfMonthOrdinalParse:zP,relativeTime:jP,months:aD,monthsShort:N0,week:vD,weekdays:_D,weekdaysMin:OD,weekdaysShort:B0,meridiemParse:zD},bt={},Qr={},tl;function KD(n,e){var t,s=Math.min(n.length,e.length);for(t=0;t<s;t+=1)if(n[t]!==e[t])return t;return s}function Ev(n){return n&&n.toLowerCase().replace("_","-")}function XD(n){for(var e=0,t,s,o,i;e<n.length;){for(i=Ev(n[e]).split("-"),t=i.length,s=Ev(n[e+1]),s=s?s.split("-"):null;t>0;){if(o=yh(i.slice(0,t).join("-")),o)return o;if(s&&s.length>=t&&KD(i,s)>=t-1)break;t--}e++}return tl}function qD(n){return n.match("^[^/\\\\]*$")!=null}function yh(n){var e=null,t;if(bt[n]===void 0&&typeof Mc<"u"&&Mc&&Mc.exports&&qD(n))try{e=tl._abbr,t=require,t("./locale/"+n),Fo(e)}catch{bt[n]=null}return bt[n]}function Fo(n,e){var t;return n&&(_n(e)?t=ho(n):t=mw(n,e),t?tl=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),tl._abbr}function mw(n,e){if(e!==null){var t,s=z0;if(e.abbr=n,bt[n]!=null)_0("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=bt[n]._config;else if(e.parentLocale!=null)if(bt[e.parentLocale]!=null)s=bt[e.parentLocale]._config;else if(t=yh(e.parentLocale),t!=null)s=t._config;else return Qr[e.parentLocale]||(Qr[e.parentLocale]=[]),Qr[e.parentLocale].push({name:n,config:e}),null;return bt[n]=new aw(jm(s,e)),Qr[n]&&Qr[n].forEach(function(o){mw(o.name,o.config)}),Fo(n),bt[n]}else return delete bt[n],null}function ZD(n,e){if(e!=null){var t,s,o=z0;bt[n]!=null&&bt[n].parentLocale!=null?bt[n].set(jm(bt[n]._config,e)):(s=yh(n),s!=null&&(o=s._config),e=jm(o,e),s==null&&(e.abbr=n),t=new aw(e),t.parentLocale=bt[n],bt[n]=t),Fo(n)}else bt[n]!=null&&(bt[n].parentLocale!=null?(bt[n]=bt[n].parentLocale,n===Fo()&&Fo(n)):bt[n]!=null&&delete bt[n]);return bt[n]}function ho(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return tl;if(!us(n)){if(e=yh(n),e)return e;n=[n]}return XD(n)}function QD(){return Km(bt)}function pw(n){var e,t=n._a;return t&&Be(n).overflow===-2&&(e=t[no]<0||t[no]>11?no:t[Ms]<1||t[Ms]>vh(t[ln],t[no])?Ms:t[Ut]<0||t[Ut]>24||t[Ut]===24&&(t[is]!==0||t[so]!==0||t[Ri]!==0)?Ut:t[is]<0||t[is]>59?is:t[so]<0||t[so]>59?so:t[Ri]<0||t[Ri]>999?Ri:-1,Be(n)._overflowDayOfYear&&(e<ln||e>Ms)&&(e=Ms),Be(n)._overflowWeeks&&e===-1&&(e=oD),Be(n)._overflowWeekday&&e===-1&&(e=iD),Be(n).overflow=e),n}var JD=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,eN=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tN=/Z|[+-]\d\d(?::?\d\d)?/,tu=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Gf=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],nN=/^\/?Date\((-?\d+)/i,sN=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,oN={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function G0(n){var e,t,s=n._i,o=JD.exec(s)||eN.exec(s),i,r,a,l,u=tu.length,c=Gf.length;if(o){for(Be(n).iso=!0,e=0,t=u;e<t;e++)if(tu[e][1].exec(o[1])){r=tu[e][0],i=tu[e][2]!==!1;break}if(r==null){n._isValid=!1;return}if(o[3]){for(e=0,t=c;e<t;e++)if(Gf[e][1].exec(o[3])){a=(o[2]||" ")+Gf[e][0];break}if(a==null){n._isValid=!1;return}}if(!i&&a!=null){n._isValid=!1;return}if(o[4])if(tN.exec(o[4]))l="Z";else{n._isValid=!1;return}n._f=r+(a||"")+(l||""),Cw(n)}else n._isValid=!1}function iN(n,e,t,s,o,i){var r=[rN(n),N0.indexOf(e),parseInt(t,10),parseInt(s,10),parseInt(o,10)];return i&&r.push(parseInt(i,10)),r}function rN(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function aN(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function lN(n,e,t){if(n){var s=B0.indexOf(n),o=new Date(e[0],e[1],e[2]).getDay();if(s!==o)return Be(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function uN(n,e,t){if(n)return oN[n];if(e)return 0;var s=parseInt(t,10),o=s%100,i=(s-o)/100;return i*60+o}function j0(n){var e=sN.exec(aN(n._i)),t;if(e){if(t=iN(e[4],e[3],e[2],e[5],e[6],e[7]),!lN(e[1],t,n))return;n._a=t,n._tzm=uN(e[8],e[9],e[10]),n._d=Ja.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),Be(n).rfc2822=!0}else n._isValid=!1}function cN(n){var e=nN.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(G0(n),n._isValid===!1)delete n._isValid;else return;if(j0(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:Q.createFromInputFallback(n)}Q.createFromInputFallback=jn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function wr(n,e,t){return n??e??t}function hN(n){var e=new Date(Q.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function ww(n){var e,t,s=[],o,i,r;if(!n._d){for(o=hN(n),n._w&&n._a[Ms]==null&&n._a[no]==null&&dN(n),n._dayOfYear!=null&&(r=wr(n._a[ln],o[ln]),(n._dayOfYear>Va(r)||n._dayOfYear===0)&&(Be(n)._overflowDayOfYear=!0),t=Ja(r,0,n._dayOfYear),n._a[no]=t.getUTCMonth(),n._a[Ms]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=s[e]=o[e];for(;e<7;e++)n._a[e]=s[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[Ut]===24&&n._a[is]===0&&n._a[so]===0&&n._a[Ri]===0&&(n._nextDay=!0,n._a[Ut]=0),n._d=(n._useUTC?Ja:CD).apply(null,s),i=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[Ut]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==i&&(Be(n).weekdayMismatch=!0)}}function dN(n){var e,t,s,o,i,r,a,l,u;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(i=1,r=4,t=wr(e.GG,n._a[ln],el(Ct(),1,4).year),s=wr(e.W,1),o=wr(e.E,1),(o<1||o>7)&&(l=!0)):(i=n._locale._week.dow,r=n._locale._week.doy,u=el(Ct(),i,r),t=wr(e.gg,n._a[ln],u.year),s=wr(e.w,u.week),e.d!=null?(o=e.d,(o<0||o>6)&&(l=!0)):e.e!=null?(o=e.e+i,(e.e<0||e.e>6)&&(l=!0)):o=i),s<1||s>ao(t,i,r)?Be(n)._overflowWeeks=!0:l!=null?Be(n)._overflowWeekday=!0:(a=W0(t,s,o,i,r),n._a[ln]=a.year,n._dayOfYear=a.dayOfYear)}Q.ISO_8601=function(){};Q.RFC_2822=function(){};function Cw(n){if(n._f===Q.ISO_8601){G0(n);return}if(n._f===Q.RFC_2822){j0(n);return}n._a=[],Be(n).empty=!0;var e=""+n._i,t,s,o,i,r,a=e.length,l=0,u,c;for(o=O0(n._f,n._locale).match(lw)||[],c=o.length,t=0;t<c;t++)i=o[t],s=(e.match(tD(i,n))||[])[0],s&&(r=e.substr(0,e.indexOf(s)),r.length>0&&Be(n).unusedInput.push(r),e=e.slice(e.indexOf(s)+s.length),l+=s.length),Er[i]?(s?Be(n).empty=!1:Be(n).unusedTokens.push(i),sD(i,s,n)):n._strict&&!s&&Be(n).unusedTokens.push(i);Be(n).charsLeftOver=a-l,e.length>0&&Be(n).unusedInput.push(e),n._a[Ut]<=12&&Be(n).bigHour===!0&&n._a[Ut]>0&&(Be(n).bigHour=void 0),Be(n).parsedDateParts=n._a.slice(0),Be(n).meridiem=n._meridiem,n._a[Ut]=fN(n._locale,n._a[Ut],n._meridiem),u=Be(n).era,u!==null&&(n._a[ln]=n._locale.erasConvertYear(u,n._a[ln])),ww(n),pw(n)}function fN(n,e,t){var s;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(s=n.isPM(t),s&&e<12&&(e+=12),!s&&e===12&&(e=0)),e)}function gN(n){var e,t,s,o,i,r,a=!1,l=n._f.length;if(l===0){Be(n).invalidFormat=!0,n._d=new Date(NaN);return}for(o=0;o<l;o++)i=0,r=!1,e=rw({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[o],Cw(e),iw(e)&&(r=!0),i+=Be(e).charsLeftOver,i+=Be(e).unusedTokens.length*10,Be(e).score=i,a?i<s&&(s=i,t=e):(s==null||i<s||r)&&(s=i,t=e,r&&(a=!0));No(n,t||e)}function mN(n){if(!n._d){var e=uw(n._i),t=e.day===void 0?e.date:e.day;n._a=T0([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(s){return s&&parseInt(s,10)}),ww(n)}}function pN(n){var e=new bl(pw(K0(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function K0(n){var e=n._i,t=n._f;return n._locale=n._locale||ho(n._l),e===null||t===void 0&&e===""?fh({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),cs(e)?new bl(pw(e)):(yl(e)?n._d=e:us(t)?gN(n):t?Cw(n):wN(n),iw(n)||(n._d=null),n))}function wN(n){var e=n._i;_n(e)?n._d=new Date(Q.now()):yl(e)?n._d=new Date(e.valueOf()):typeof e=="string"?cN(n):us(e)?(n._a=T0(e.slice(0),function(t){return parseInt(t,10)}),ww(n)):_i(e)?mN(n):lo(e)?n._d=new Date(e):Q.createFromInputFallback(n)}function X0(n,e,t,s,o){var i={};return(e===!0||e===!1)&&(s=e,e=void 0),(t===!0||t===!1)&&(s=t,t=void 0),(_i(n)&&ow(n)||us(n)&&n.length===0)&&(n=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=o,i._l=t,i._i=n,i._f=e,i._strict=s,pN(i)}function Ct(n,e,t,s){return X0(n,e,t,s,!1)}var CN=jn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Ct.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:fh()}),SN=jn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Ct.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:fh()});function q0(n,e){var t,s;if(e.length===1&&us(e[0])&&(e=e[0]),!e.length)return Ct();for(t=e[0],s=1;s<e.length;++s)(!e[s].isValid()||e[s][n](t))&&(t=e[s]);return t}function vN(){var n=[].slice.call(arguments,0);return q0("isBefore",n)}function yN(){var n=[].slice.call(arguments,0);return q0("isAfter",n)}var bN=function(){return Date.now?Date.now():+new Date},Jr=["year","quarter","month","week","day","hour","minute","second","millisecond"];function RN(n){var e,t=!1,s,o=Jr.length;for(e in n)if(st(n,e)&&!(Nt.call(Jr,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(s=0;s<o;++s)if(n[Jr[s]]){if(t)return!1;parseFloat(n[Jr[s]])!==qe(n[Jr[s]])&&(t=!0)}return!0}function EN(){return this._isValid}function TN(){return ds(NaN)}function bh(n){var e=uw(n),t=e.year||0,s=e.quarter||0,o=e.month||0,i=e.week||e.isoWeek||0,r=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=RN(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+r+i*7,this._months=+o+s*3+t*12,this._data={},this._locale=ho(),this._bubble()}function lc(n){return n instanceof bh}function qm(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function MN(n,e,t){var s=Math.min(n.length,e.length),o=Math.abs(n.length-e.length),i=0,r;for(r=0;r<s;r++)(t&&n[r]!==e[r]||!t&&qe(n[r])!==qe(e[r]))&&i++;return i+o}function Z0(n,e){Re(n,0,0,function(){var t=this.utcOffset(),s="+";return t<0&&(t=-t,s="-"),s+Is(~~(t/60),2)+e+Is(~~t%60,2)})}Z0("Z",":");Z0("ZZ","");ge("Z",Sh);ge("ZZ",Sh);ct(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=Sw(Sh,n)});var _N=/([\+\-]|\d\d)/gi;function Sw(n,e){var t=(e||"").match(n),s,o,i;return t===null?null:(s=t[t.length-1]||[],o=(s+"").match(_N)||["-",0,0],i=+(o[1]*60)+qe(o[2]),i===0?0:o[0]==="+"?i:-i)}function vw(n,e){var t,s;return e._isUTC?(t=e.clone(),s=(cs(n)||yl(n)?n.valueOf():Ct(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+s),Q.updateOffset(t,!1),t):Ct(n).local()}function Zm(n){return-Math.round(n._d.getTimezoneOffset())}Q.updateOffset=function(){};function ON(n,e,t){var s=this._offset||0,o;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=Sw(Sh,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(o=Zm(this)),this._offset=n,this._isUTC=!0,o!=null&&this.add(o,"m"),s!==n&&(!e||this._changeInProgress?eE(this,ds(n-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?s:Zm(this)}function AN(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function IN(n){return this.utcOffset(0,n)}function xN(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(Zm(this),"m")),this}function HN(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=Sw(JP,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function PN(n){return this.isValid()?(n=n?Ct(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function DN(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function NN(){if(!_n(this._isDSTShifted))return this._isDSTShifted;var n={},e;return rw(n,this),n=K0(n),n._a?(e=n._isUTC?Ds(n._a):Ct(n._a),this._isDSTShifted=this.isValid()&&MN(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function LN(){return this.isValid()?!this._isUTC:!1}function kN(){return this.isValid()?this._isUTC:!1}function Q0(){return this.isValid()?this._isUTC&&this._offset===0:!1}var FN=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,$N=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ds(n,e){var t=n,s=null,o,i,r;return lc(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:lo(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(s=FN.exec(n))?(o=s[1]==="-"?-1:1,t={y:0,d:qe(s[Ms])*o,h:qe(s[Ut])*o,m:qe(s[is])*o,s:qe(s[so])*o,ms:qe(qm(s[Ri]*1e3))*o}):(s=$N.exec(n))?(o=s[1]==="-"?-1:1,t={y:ii(s[2],o),M:ii(s[3],o),w:ii(s[4],o),d:ii(s[5],o),h:ii(s[6],o),m:ii(s[7],o),s:ii(s[8],o)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(r=VN(Ct(t.from),Ct(t.to)),t={},t.ms=r.milliseconds,t.M=r.months),i=new bh(t),lc(n)&&st(n,"_locale")&&(i._locale=n._locale),lc(n)&&st(n,"_isValid")&&(i._isValid=n._isValid),i}ds.fn=bh.prototype;ds.invalid=TN;function ii(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function Tv(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function VN(n,e){var t;return n.isValid()&&e.isValid()?(e=vw(e,n),n.isBefore(e)?t=Tv(n,e):(t=Tv(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function J0(n,e){return function(t,s){var o,i;return s!==null&&!isNaN(+s)&&(_0(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=t,t=s,s=i),o=ds(t,s),eE(this,o,n),this}}function eE(n,e,t,s){var o=e._milliseconds,i=qm(e._days),r=qm(e._months);n.isValid()&&(s=s??!0,r&&k0(n,Hc(n,"Month")+r*t),i&&I0(n,"Date",Hc(n,"Date")+i*t),o&&n._d.setTime(n._d.valueOf()+o*t),s&&Q.updateOffset(n,i||r))}var WN=J0(1,"add"),BN=J0(-1,"subtract");function tE(n){return typeof n=="string"||n instanceof String}function UN(n){return cs(n)||yl(n)||tE(n)||lo(n)||zN(n)||YN(n)||n===null||n===void 0}function YN(n){var e=_i(n)&&!ow(n),t=!1,s=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o,i,r=s.length;for(o=0;o<r;o+=1)i=s[o],t=t||st(n,i);return e&&t}function zN(n){var e=us(n),t=!1;return e&&(t=n.filter(function(s){return!lo(s)&&tE(n)}).length===0),e&&t}function GN(n){var e=_i(n)&&!ow(n),t=!1,s=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],o,i;for(o=0;o<s.length;o+=1)i=s[o],t=t||st(n,i);return e&&t}function jN(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function KN(n,e){arguments.length===1&&(arguments[0]?UN(arguments[0])?(n=arguments[0],e=void 0):GN(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||Ct(),s=vw(t,this).startOf("day"),o=Q.calendarFormat(this,s)||"sameElse",i=e&&(Ns(e[o])?e[o].call(this,t):e[o]);return this.format(i||this.localeData().calendar(o,this,Ct(t)))}function XN(){return new bl(this)}function qN(n,e){var t=cs(n)?n:Ct(n);return this.isValid()&&t.isValid()?(e=Kn(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function ZN(n,e){var t=cs(n)?n:Ct(n);return this.isValid()&&t.isValid()?(e=Kn(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function QN(n,e,t,s){var o=cs(n)?n:Ct(n),i=cs(e)?e:Ct(e);return this.isValid()&&o.isValid()&&i.isValid()?(s=s||"()",(s[0]==="("?this.isAfter(o,t):!this.isBefore(o,t))&&(s[1]===")"?this.isBefore(i,t):!this.isAfter(i,t))):!1}function JN(n,e){var t=cs(n)?n:Ct(n),s;return this.isValid()&&t.isValid()?(e=Kn(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(s=t.valueOf(),this.clone().startOf(e).valueOf()<=s&&s<=this.clone().endOf(e).valueOf())):!1}function eL(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function tL(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function nL(n,e,t){var s,o,i;if(!this.isValid())return NaN;if(s=vw(n,this),!s.isValid())return NaN;switch(o=(s.utcOffset()-this.utcOffset())*6e4,e=Kn(e),e){case"year":i=uc(this,s)/12;break;case"month":i=uc(this,s);break;case"quarter":i=uc(this,s)/3;break;case"second":i=(this-s)/1e3;break;case"minute":i=(this-s)/6e4;break;case"hour":i=(this-s)/36e5;break;case"day":i=(this-s-o)/864e5;break;case"week":i=(this-s-o)/6048e5;break;default:i=this-s}return t?i:Yn(i)}function uc(n,e){if(n.date()<e.date())return-uc(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),s=n.clone().add(t,"months"),o,i;return e-s<0?(o=n.clone().add(t-1,"months"),i=(e-s)/(s-o)):(o=n.clone().add(t+1,"months"),i=(e-s)/(o-s)),-(t+i)||0}Q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function sL(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function oL(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?ac(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ns(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ac(t,"Z")):ac(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function iL(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,s,o,i;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=e+'[")]',this.format(t+s+o+i)}function rL(n){n||(n=this.isUtc()?Q.defaultFormatUtc:Q.defaultFormat);var e=ac(this,n);return this.localeData().postformat(e)}function aL(n,e){return this.isValid()&&(cs(n)&&n.isValid()||Ct(n).isValid())?ds({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function lL(n){return this.from(Ct(),n)}function uL(n,e){return this.isValid()&&(cs(n)&&n.isValid()||Ct(n).isValid())?ds({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function cL(n){return this.to(Ct(),n)}function nE(n){var e;return n===void 0?this._locale._abbr:(e=ho(n),e!=null&&(this._locale=e),this)}var sE=jn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function oE(){return this._locale}var Nc=1e3,Tr=60*Nc,Lc=60*Tr,iE=(365*400+97)*24*Lc;function Mr(n,e){return(n%e+e)%e}function rE(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-iE:new Date(n,e,t).valueOf()}function aE(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-iE:Date.UTC(n,e,t)}function hL(n){var e,t;if(n=Kn(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?aE:rE,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Mr(e+(this._isUTC?0:this.utcOffset()*Tr),Lc);break;case"minute":e=this._d.valueOf(),e-=Mr(e,Tr);break;case"second":e=this._d.valueOf(),e-=Mr(e,Nc);break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function dL(n){var e,t;if(n=Kn(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?aE:rE,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Lc-Mr(e+(this._isUTC?0:this.utcOffset()*Tr),Lc)-1;break;case"minute":e=this._d.valueOf(),e+=Tr-Mr(e,Tr)-1;break;case"second":e=this._d.valueOf(),e+=Nc-Mr(e,Nc)-1;break}return this._d.setTime(e),Q.updateOffset(this,!0),this}function fL(){return this._d.valueOf()-(this._offset||0)*6e4}function gL(){return Math.floor(this.valueOf()/1e3)}function mL(){return new Date(this.valueOf())}function pL(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function wL(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function CL(){return this.isValid()?this.toISOString():null}function SL(){return iw(this)}function vL(){return No({},Be(this))}function yL(){return Be(this).overflow}function bL(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Re("N",0,0,"eraAbbr");Re("NN",0,0,"eraAbbr");Re("NNN",0,0,"eraAbbr");Re("NNNN",0,0,"eraName");Re("NNNNN",0,0,"eraNarrow");Re("y",["y",1],"yo","eraYear");Re("y",["yy",2],0,"eraYear");Re("y",["yyy",3],0,"eraYear");Re("y",["yyyy",4],0,"eraYear");ge("N",yw);ge("NN",yw);ge("NNN",yw);ge("NNNN",PL);ge("NNNNN",DL);ct(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,s){var o=t._locale.erasParse(n,s,t._strict);o?Be(t).era=o:Be(t).invalidEra=n});ge("y",Vr);ge("yy",Vr);ge("yyy",Vr);ge("yyyy",Vr);ge("yo",NL);ct(["y","yy","yyy","yyyy"],ln);ct(["yo"],function(n,e,t,s){var o;t._locale._eraYearOrdinalRegex&&(o=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[ln]=t._locale.eraYearOrdinalParse(n,o):e[ln]=parseInt(n,10)});function RL(n,e){var t,s,o,i=this._eras||ho("en")._eras;for(t=0,s=i.length;t<s;++t){switch(typeof i[t].since){case"string":o=Q(i[t].since).startOf("day"),i[t].since=o.valueOf();break}switch(typeof i[t].until){case"undefined":i[t].until=1/0;break;case"string":o=Q(i[t].until).startOf("day").valueOf(),i[t].until=o.valueOf();break}}return i}function EL(n,e,t){var s,o,i=this.eras(),r,a,l;for(n=n.toUpperCase(),s=0,o=i.length;s<o;++s)if(r=i[s].name.toUpperCase(),a=i[s].abbr.toUpperCase(),l=i[s].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(a===n)return i[s];break;case"NNNN":if(r===n)return i[s];break;case"NNNNN":if(l===n)return i[s];break}else if([r,a,l].indexOf(n)>=0)return i[s]}function TL(n,e){var t=n.since<=n.until?1:-1;return e===void 0?Q(n.since).year():Q(n.since).year()+(e-n.offset)*t}function ML(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].name;return""}function _L(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].narrow;return""}function OL(){var n,e,t,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),s[n].since<=t&&t<=s[n].until||s[n].until<=t&&t<=s[n].since)return s[n].abbr;return""}function AL(){var n,e,t,s,o=this.localeData().eras();for(n=0,e=o.length;n<e;++n)if(t=o[n].since<=o[n].until?1:-1,s=this.clone().startOf("day").valueOf(),o[n].since<=s&&s<=o[n].until||o[n].until<=s&&s<=o[n].since)return(this.year()-Q(o[n].since).year())*t+o[n].offset;return this.year()}function IL(n){return st(this,"_erasNameRegex")||bw.call(this),n?this._erasNameRegex:this._erasRegex}function xL(n){return st(this,"_erasAbbrRegex")||bw.call(this),n?this._erasAbbrRegex:this._erasRegex}function HL(n){return st(this,"_erasNarrowRegex")||bw.call(this),n?this._erasNarrowRegex:this._erasRegex}function yw(n,e){return e.erasAbbrRegex(n)}function PL(n,e){return e.erasNameRegex(n)}function DL(n,e){return e.erasNarrowRegex(n)}function NL(n,e){return e._eraYearOrdinalRegex||Vr}function bw(){var n=[],e=[],t=[],s=[],o,i,r=this.eras();for(o=0,i=r.length;o<i;++o)e.push(Nn(r[o].name)),n.push(Nn(r[o].abbr)),t.push(Nn(r[o].narrow)),s.push(Nn(r[o].name)),s.push(Nn(r[o].abbr)),s.push(Nn(r[o].narrow));this._erasRegex=new RegExp("^("+s.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Re(0,["gg",2],0,function(){return this.weekYear()%100});Re(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Rh(n,e){Re(0,[n,n.length],0,e)}Rh("gggg","weekYear");Rh("ggggg","weekYear");Rh("GGGG","isoWeekYear");Rh("GGGGG","isoWeekYear");hn("weekYear","gg");hn("isoWeekYear","GG");dn("weekYear",1);dn("isoWeekYear",1);ge("G",Ch);ge("g",Ch);ge("GG",St,Fn);ge("gg",St,Fn);ge("GGGG",hw,cw);ge("gggg",hw,cw);ge("GGGGG",wh,mh);ge("ggggg",wh,mh);El(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,s){e[s.substr(0,2)]=qe(n)});El(["gg","GG"],function(n,e,t,s){e[s]=Q.parseTwoDigitYear(n)});function LL(n){return lE.call(this,n,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function kL(n){return lE.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function FL(){return ao(this.year(),1,4)}function $L(){return ao(this.isoWeekYear(),1,4)}function VL(){var n=this.localeData()._week;return ao(this.year(),n.dow,n.doy)}function WL(){var n=this.localeData()._week;return ao(this.weekYear(),n.dow,n.doy)}function lE(n,e,t,s,o){var i;return n==null?el(this,s,o).year:(i=ao(n,s,o),e>i&&(e=i),BL.call(this,n,e,t,s,o))}function BL(n,e,t,s,o){var i=W0(n,e,t,s,o),r=Ja(i.year,0,i.dayOfYear);return this.year(r.getUTCFullYear()),this.month(r.getUTCMonth()),this.date(r.getUTCDate()),this}Re("Q",0,"Qo","quarter");hn("quarter","Q");dn("quarter",7);ge("Q",x0);ct("Q",function(n,e){e[no]=(qe(n)-1)*3});function UL(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}Re("D",["DD",2],"Do","date");hn("date","D");dn("date",9);ge("D",St);ge("DD",St,Fn);ge("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ct(["D","DD"],Ms);ct("Do",function(n,e){e[Ms]=qe(n.match(St)[0])});var uE=$r("Date",!0);Re("DDD",["DDDD",3],"DDDo","dayOfYear");hn("dayOfYear","DDD");dn("dayOfYear",4);ge("DDD",ph);ge("DDDD",H0);ct(["DDD","DDDD"],function(n,e,t){t._dayOfYear=qe(n)});function YL(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}Re("m",["mm",2],0,"minute");hn("minute","m");dn("minute",14);ge("m",St);ge("mm",St,Fn);ct(["m","mm"],is);var zL=$r("Minutes",!1);Re("s",["ss",2],0,"second");hn("second","s");dn("second",15);ge("s",St);ge("ss",St,Fn);ct(["s","ss"],so);var GL=$r("Seconds",!1);Re("S",0,0,function(){return~~(this.millisecond()/100)});Re(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Re(0,["SSS",3],0,"millisecond");Re(0,["SSSS",4],0,function(){return this.millisecond()*10});Re(0,["SSSSS",5],0,function(){return this.millisecond()*100});Re(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Re(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Re(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Re(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});hn("millisecond","ms");dn("millisecond",16);ge("S",ph,x0);ge("SS",ph,Fn);ge("SSS",ph,H0);var Lo,cE;for(Lo="SSSS";Lo.length<=9;Lo+="S")ge(Lo,Vr);function jL(n,e){e[Ri]=qe(("0."+n)*1e3)}for(Lo="S";Lo.length<=9;Lo+="S")ct(Lo,jL);cE=$r("Milliseconds",!1);Re("z",0,0,"zoneAbbr");Re("zz",0,0,"zoneName");function KL(){return this._isUTC?"UTC":""}function XL(){return this._isUTC?"Coordinated Universal Time":""}var te=bl.prototype;te.add=WN;te.calendar=KN;te.clone=XN;te.diff=nL;te.endOf=dL;te.format=rL;te.from=aL;te.fromNow=lL;te.to=uL;te.toNow=cL;te.get=ZP;te.invalidAt=yL;te.isAfter=qN;te.isBefore=ZN;te.isBetween=QN;te.isSame=JN;te.isSameOrAfter=eL;te.isSameOrBefore=tL;te.isValid=SL;te.lang=sE;te.locale=nE;te.localeData=oE;te.max=SN;te.min=CN;te.parsingFlags=vL;te.set=QP;te.startOf=hL;te.subtract=BN;te.toArray=pL;te.toObject=wL;te.toDate=mL;te.toISOString=oL;te.inspect=iL;typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});te.toJSON=CL;te.toString=sL;te.unix=gL;te.valueOf=fL;te.creationData=bL;te.eraName=ML;te.eraNarrow=_L;te.eraAbbr=OL;te.eraYear=AL;te.year=V0;te.isLeapYear=wD;te.weekYear=LL;te.isoWeekYear=kL;te.quarter=te.quarters=UL;te.month=F0;te.daysInMonth=gD;te.week=te.weeks=RD;te.isoWeek=te.isoWeeks=ED;te.weeksInYear=VL;te.weeksInWeekYear=WL;te.isoWeeksInYear=FL;te.isoWeeksInISOWeekYear=$L;te.date=uE;te.day=te.days=kD;te.weekday=FD;te.isoWeekday=$D;te.dayOfYear=YL;te.hour=te.hours=GD;te.minute=te.minutes=zL;te.second=te.seconds=GL;te.millisecond=te.milliseconds=cE;te.utcOffset=ON;te.utc=IN;te.local=xN;te.parseZone=HN;te.hasAlignedHourOffset=PN;te.isDST=DN;te.isLocal=LN;te.isUtcOffset=kN;te.isUtc=Q0;te.isUTC=Q0;te.zoneAbbr=KL;te.zoneName=XL;te.dates=jn("dates accessor is deprecated. Use date instead.",uE);te.months=jn("months accessor is deprecated. Use month instead",F0);te.years=jn("years accessor is deprecated. Use year instead",V0);te.zone=jn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",AN);te.isDSTShifted=jn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",NN);function qL(n){return Ct(n*1e3)}function ZL(){return Ct.apply(null,arguments).parseZone()}function hE(n){return n}var ot=aw.prototype;ot.calendar=kP;ot.longDateFormat=WP;ot.invalidDate=UP;ot.ordinal=GP;ot.preparse=hE;ot.postformat=hE;ot.relativeTime=KP;ot.pastFuture=XP;ot.set=NP;ot.eras=RL;ot.erasParse=EL;ot.erasConvertYear=TL;ot.erasAbbrRegex=xL;ot.erasNameRegex=IL;ot.erasNarrowRegex=HL;ot.months=cD;ot.monthsShort=hD;ot.monthsParse=fD;ot.monthsRegex=pD;ot.monthsShortRegex=mD;ot.week=SD;ot.firstDayOfYear=bD;ot.firstDayOfWeek=yD;ot.weekdays=HD;ot.weekdaysMin=DD;ot.weekdaysShort=PD;ot.weekdaysParse=LD;ot.weekdaysRegex=VD;ot.weekdaysShortRegex=WD;ot.weekdaysMinRegex=BD;ot.isPM=YD;ot.meridiem=jD;function kc(n,e,t,s){var o=ho(),i=Ds().set(s,e);return o[t](i,n)}function dE(n,e,t){if(lo(n)&&(e=n,n=void 0),n=n||"",e!=null)return kc(n,e,t,"month");var s,o=[];for(s=0;s<12;s++)o[s]=kc(n,s,t,"month");return o}function Rw(n,e,t,s){typeof n=="boolean"?(lo(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,lo(e)&&(t=e,e=void 0),e=e||"");var o=ho(),i=n?o._week.dow:0,r,a=[];if(t!=null)return kc(e,(t+i)%7,s,"day");for(r=0;r<7;r++)a[r]=kc(e,(r+i)%7,s,"day");return a}function QL(n,e){return dE(n,e,"months")}function JL(n,e){return dE(n,e,"monthsShort")}function ek(n,e,t){return Rw(n,e,t,"weekdays")}function tk(n,e,t){return Rw(n,e,t,"weekdaysShort")}function nk(n,e,t){return Rw(n,e,t,"weekdaysMin")}Fo("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=qe(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}});Q.lang=jn("moment.lang is deprecated. Use moment.locale instead.",Fo);Q.langData=jn("moment.langData is deprecated. Use moment.localeData instead.",ho);var $s=Math.abs;function sk(){var n=this._data;return this._milliseconds=$s(this._milliseconds),this._days=$s(this._days),this._months=$s(this._months),n.milliseconds=$s(n.milliseconds),n.seconds=$s(n.seconds),n.minutes=$s(n.minutes),n.hours=$s(n.hours),n.months=$s(n.months),n.years=$s(n.years),this}function fE(n,e,t,s){var o=ds(e,t);return n._milliseconds+=s*o._milliseconds,n._days+=s*o._days,n._months+=s*o._months,n._bubble()}function ok(n,e){return fE(this,n,e,1)}function ik(n,e){return fE(this,n,e,-1)}function Mv(n){return n<0?Math.floor(n):Math.ceil(n)}function rk(){var n=this._milliseconds,e=this._days,t=this._months,s=this._data,o,i,r,a,l;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=Mv(Qm(t)+e)*864e5,e=0,t=0),s.milliseconds=n%1e3,o=Yn(n/1e3),s.seconds=o%60,i=Yn(o/60),s.minutes=i%60,r=Yn(i/60),s.hours=r%24,e+=Yn(r/24),l=Yn(gE(e)),t+=l,e-=Mv(Qm(l)),a=Yn(t/12),t%=12,s.days=e,s.months=t,s.years=a,this}function gE(n){return n*4800/146097}function Qm(n){return n*146097/4800}function ak(n){if(!this.isValid())return NaN;var e,t,s=this._milliseconds;if(n=Kn(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+s/864e5,t=this._months+gE(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round(Qm(this._months)),n){case"week":return e/7+s/6048e5;case"day":return e+s/864e5;case"hour":return e*24+s/36e5;case"minute":return e*1440+s/6e4;case"second":return e*86400+s/1e3;case"millisecond":return Math.floor(e*864e5)+s;default:throw new Error("Unknown unit "+n)}}function lk(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+qe(this._months/12)*31536e6:NaN}function fo(n){return function(){return this.as(n)}}var uk=fo("ms"),ck=fo("s"),hk=fo("m"),dk=fo("h"),fk=fo("d"),gk=fo("w"),mk=fo("M"),pk=fo("Q"),wk=fo("y");function Ck(){return ds(this)}function Sk(n){return n=Kn(n),this.isValid()?this[n+"s"]():NaN}function ki(n){return function(){return this.isValid()?this._data[n]:NaN}}var vk=ki("milliseconds"),yk=ki("seconds"),bk=ki("minutes"),Rk=ki("hours"),Ek=ki("days"),Tk=ki("months"),Mk=ki("years");function _k(){return Yn(this.days()/7)}var Js=Math.round,Sr={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Ok(n,e,t,s,o){return o.relativeTime(e||1,!!t,n,s)}function Ak(n,e,t,s){var o=ds(n).abs(),i=Js(o.as("s")),r=Js(o.as("m")),a=Js(o.as("h")),l=Js(o.as("d")),u=Js(o.as("M")),c=Js(o.as("w")),d=Js(o.as("y")),f=i<=t.ss&&["s",i]||i<t.s&&["ss",i]||r<=1&&["m"]||r<t.m&&["mm",r]||a<=1&&["h"]||a<t.h&&["hh",a]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(f=f||c<=1&&["w"]||c<t.w&&["ww",c]),f=f||u<=1&&["M"]||u<t.M&&["MM",u]||d<=1&&["y"]||["yy",d],f[2]=e,f[3]=+n>0,f[4]=s,Ok.apply(null,f)}function Ik(n){return n===void 0?Js:typeof n=="function"?(Js=n,!0):!1}function xk(n,e){return Sr[n]===void 0?!1:e===void 0?Sr[n]:(Sr[n]=e,n==="s"&&(Sr.ss=e-1),!0)}function Hk(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,s=Sr,o,i;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(s=Object.assign({},Sr,e),e.s!=null&&e.ss==null&&(s.ss=e.s-1)),o=this.localeData(),i=Ak(this,!t,s,o),t&&(i=o.pastFuture(+this,i)),o.postformat(i)}var jf=Math.abs;function Ui(n){return(n>0)-(n<0)||+n}function Eh(){if(!this.isValid())return this.localeData().invalidDate();var n=jf(this._milliseconds)/1e3,e=jf(this._days),t=jf(this._months),s,o,i,r,a=this.asSeconds(),l,u,c,d;return a?(s=Yn(n/60),o=Yn(s/60),n%=60,s%=60,i=Yn(t/12),t%=12,r=n?n.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=Ui(this._months)!==Ui(a)?"-":"",c=Ui(this._days)!==Ui(a)?"-":"",d=Ui(this._milliseconds)!==Ui(a)?"-":"",l+"P"+(i?u+i+"Y":"")+(t?u+t+"M":"")+(e?c+e+"D":"")+(o||s||n?"T":"")+(o?d+o+"H":"")+(s?d+s+"M":"")+(n?d+r+"S":"")):"P0D"}var et=bh.prototype;et.isValid=EN;et.abs=sk;et.add=ok;et.subtract=ik;et.as=ak;et.asMilliseconds=uk;et.asSeconds=ck;et.asMinutes=hk;et.asHours=dk;et.asDays=fk;et.asWeeks=gk;et.asMonths=mk;et.asQuarters=pk;et.asYears=wk;et.valueOf=lk;et._bubble=rk;et.clone=Ck;et.get=Sk;et.milliseconds=vk;et.seconds=yk;et.minutes=bk;et.hours=Rk;et.days=Ek;et.weeks=_k;et.months=Tk;et.years=Mk;et.humanize=Hk;et.toISOString=Eh;et.toString=Eh;et.toJSON=Eh;et.locale=nE;et.localeData=oE;et.toIsoString=jn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Eh);et.lang=sE;Re("X",0,0,"unix");Re("x",0,0,"valueOf");ge("x",Ch);ge("X",eD);ct("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)});ct("x",function(n,e,t){t._d=new Date(qe(n))});//! moment.js
Q.version="2.29.4";PP(Ct);Q.fn=te;Q.min=vN;Q.max=yN;Q.now=bN;Q.utc=Ds;Q.unix=qL;Q.months=QL;Q.isDate=yl;Q.locale=Fo;Q.invalid=fh;Q.duration=ds;Q.isMoment=cs;Q.weekdays=ek;Q.parseZone=ZL;Q.localeData=ho;Q.isDuration=lc;Q.monthsShort=JL;Q.weekdaysMin=nk;Q.defineLocale=mw;Q.updateLocale=ZD;Q.locales=QD;Q.weekdaysShort=tk;Q.normalizeUnits=Kn;Q.relativeTimeRounding=Ik;Q.relativeTimeThreshold=xk;Q.calendarFormat=jN;Q.prototype=te;Q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const Pk=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));function mE(n){const e=n.length;let t=0;for(;t<e;)n[t]=[n[t]],t+=1}function Jm(n,e){const t=e.length;let s=0;for(;s<t;)n.push(e[s]),s+=1}function Wa(n){const e=[];if(!n||n.length===0||!n[0]||n[0].length===0)return e;const t=n.length,s=n[0].length;for(let o=0;o<t;o++)for(let i=0;i<s;i++)e[i]||(e[i]=[]),e[i][o]=n[o][i];return e}function Pt(n,e,t,s){let o=-1,i=n,r=t;Array.isArray(n)||(i=Array.from(n));const a=i.length;for(s&&a&&(o+=1,r=i[o]),o+=1;o<a;)r=e(r,i[o],o,i),o+=1;return r}function kn(n,e){let t=0,s=n;Array.isArray(n)||(s=Array.from(n));const o=s.length,i=[];let r=-1;for(;t<o;){const a=s[t];e(a,t,s)&&(r+=1,i[r]=a),t+=1}return i}function Ve(n,e){let t=0,s=n;Array.isArray(n)||(s=Array.from(n));const o=s.length,i=[];let r=-1;for(;t<o;){const a=s[t];r+=1,i[r]=e(a,t,s),t+=1}return i}function T(n,e){let t=0,s=n;Array.isArray(n)||(s=Array.from(n));const o=s.length;for(;t<o&&e(s[t],t,s)!==!1;)t+=1;return n}function pE(n){return Pt(n,(e,t)=>e+t,0)}function Dk(n){return Pt(n,(e,t)=>e>t?e:t,Array.isArray(n)?n[0]:void 0)}function Nk(n){return Pt(n,(e,t)=>e<t?e:t,Array.isArray(n)?n[0]:void 0)}function Lk(n){return n.length?pE(n)/n.length:0}function wE(n){return Pt(n,(e,t)=>e.concat(Array.isArray(t)?wE(t):t),[])}function Ew(n){const e=[];return T(n,t=>{e.indexOf(t)===-1&&e.push(t)}),e}function ep(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[s,...o]=[...e];let i=s;return T(o,r=>{i=i.filter(a=>!r.includes(a))}),i}function kk(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[s,...o]=[...e];let i=s;return T(o,r=>{i=i.filter(a=>r.includes(a))}),i}function Fk(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[s,...o]=[...e],i=new Set(s);return T(o,r=>{T(r,a=>{i.has(a)||i.add(a)})}),Array.from(i)}function tp(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return n.split(e)}const $k=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Lk,arrayEach:T,arrayFilter:kn,arrayFlatten:wE,arrayMap:Ve,arrayMax:Dk,arrayMin:Nk,arrayReduce:Pt,arraySum:pE,arrayUnique:Ew,extendArray:Jm,getDifferenceOfArrays:ep,getIntersectionOfArrays:kk,getUnionOfArrays:Fk,pivot:Wa,stringToArray:tp,to2dArray:mE},Symbol.toStringTag,{value:"Module"}));function Qe(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return Pt(n,(i,r,a)=>{const l=r.replace(/\r?\n\s*/g,""),u=t[a]?t[a]:"";return i+l+u},"").trim()}function At(n){let e;switch(typeof n){case"string":case"number":e=`${n}`;break;case"object":e=n===null?"":n.toString();break;case"undefined":e="";break;default:e=n.toString();break}return e}function oe(n){return typeof n<"u"}function ft(n){return typeof n>"u"}function Vt(n){return n===null||n===""||ft(n)}function CE(n){return Object.prototype.toString.call(n)==="[object RegExp]"}const Ha="length",Ba=n=>parseInt(n,16),_v=n=>parseInt(n,10),Fc=(n,e,t)=>n.substr(e,t),Ua=n=>n.codePointAt(0)-65,np=n=>`${n}`.replace(/\-/g,""),Vk=n=>Ba(Fc(np(n),Ba("12"),Ua("F")))/(Ba(Fc(np(n),Ua("B"),~~![][Ha]))||9),Wk=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Ov=!1;const Av={invalid:()=>Qe`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Qe`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Qe`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Iv={invalid:()=>Qe`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:n=>{let{keyValidityDate:e,hotVersion:t}=n;return Qe`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${t}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Qe`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function SE(n,e){const t=!Vt(n),s=typeof n=="string"&&n.toLowerCase()==="non-commercial-and-evaluation",o="13.1.0";let i,r="invalid",a="invalid";n=np(n||"");const l=Bk(n);if(t||s||l)if(l){const u=Q("31/08/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),d=Vk(n);i=Q((d+1)*864e5,"x").format("MMMM DD, YYYY"),c>d?(r="expired",a="expired"):(r="valid",a="valid")}else s?(r="non_commercial",a="valid"):(r="invalid",a="invalid");else r="missing",a="missing";if(Wk()&&(r="valid",a="valid"),!Ov&&r!=="valid"&&(Av[r]({keyValidityDate:i,hotVersion:o})&&console[r==="non_commercial"?"info":"warn"](Av[r]({keyValidityDate:i,hotVersion:o})),Ov=!0),a!=="valid"&&e.parentNode&&Iv[a]({keyValidityDate:i,hotVersion:o})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=Iv[a]({keyValidityDate:i,hotVersion:o}),e.parentNode.insertBefore(c,e.nextSibling)}}function Bk(n){let e=[][Ha],t=e;if(n[Ha]!==Ua("Z"))return!1;for(let s="",o="B<H4P+".split(""),i=Ua(o.shift());i;i=Ua(o.shift()||"A"))--i<""[Ha]?t=t|(_v(`${_v(Ba(s)+(Ba(Fc(n,Math.abs(i),2))+[]).padStart(2,"0"))}`)%97||2)>>1:s=Fc(n,i,i?o[Ha]===1?9:8:6);return t===e}const Uk=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:SE,isDefined:oe,isEmpty:Vt,isRegExp:CE,isUndefined:ft,stringify:At},Symbol.toStringTag,{value:"Module"}));function un(n){return n[0].toUpperCase()+n.substr(1)}function Yk(){const n=[];for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];let o=t.length;for(;o;){o-=1;const i=At(t[o]).toLowerCase();n.indexOf(i)===-1&&n.push(i)}return n.length===1}function Tw(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+n()+n()}function Mw(n){return/^([0-9][0-9]?%$)|(^100%$)/.test(n)}function _w(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${n}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,s)=>t.charAt(0)==="\\"?t.substr(1,t.length-1):e[s]===void 0?"":e[s])}function sp(n){return Th(`${n}`,{ALLOWED_TAGS:[]})}function Th(n,e){return HP.sanitize(n,e)}const zk=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:Yk,isPercentValue:Mw,randomString:Tw,sanitize:Th,stripTags:sp,substitute:_w,toUpperCaseFirst:un},Symbol.toStringTag,{value:"Module"})),Wr=n=>["tabindex",n],Gk=()=>["role","treegrid"],rs=()=>["role","presentation"],jk=()=>["role","gridcell"],Kk=()=>["role","rowheader"],Xk=()=>["role","columnheader"],vE=()=>["role","row"],qk=()=>["role","menu"],Zk=()=>["role","menuitem"],Qk=()=>["role","combobox"],yE=()=>["role","listbox"],Jk=()=>["role","option"],eF=()=>["role","checkbox"],tF=()=>["scope","col"],nF=()=>["scope","row"],sF=()=>["type","text"],zo=n=>["aria-label",n],nl=n=>["aria-description",n],go=()=>["aria-hidden","true"],oF=()=>["aria-disabled","true"],iF=()=>["aria-multiselectable","true"],Br=n=>["aria-haspopup",n],bE=n=>["aria-rowcount",n],RE=n=>["aria-colcount",n],EE=n=>["aria-rowindex",n],Ow=n=>["aria-colindex",n],jt=n=>["aria-expanded",n],rF=n=>["aria-sort",n],xv=()=>["aria-readonly","true"],Hv=()=>["aria-invalid","true"],aF=n=>["aria-checked",n],op=()=>["aria-selected","true"],lF=()=>["aria-autocomplete","list"],uF=n=>["aria-controls",n],cF=n=>["aria-activedescendant",n],hF=n=>["aria-live",n],dF=n=>["aria-relevant",n],fF=n=>["aria-setsize",n],gF=n=>["aria-posinset",n];function TE(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=-1,s=null,o=n;for(;o!==null;){if(t===e){s=o;break}o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:(t+=1,o=o.parentNode)}return s}function ME(n,e){const t=n.closest(".handsontable");return!!t&&(t.parentNode===e||t===e)}function _E(n){return Object.getPrototypeOf(n.parent)&&n.frameElement}function sl(n){return _E(n)&&n.parent}function mF(n){return!!Object.getPrototypeOf(n.parent)}function $o(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:s,DOCUMENT_FRAGMENT_NODE:o}=Node;let i=n;for(;i!=null&&i!==t;){const{nodeType:r,nodeName:a}=i;if(r===s&&(e.includes(a)||e.includes(i)))return i;const{host:l}=i;l&&r===o?i=l:i=i.parentNode}return null}function Pa(n,e,t){const s=[];let o=n;for(;o&&(o=$o(o,e,t),!(!o||t&&!t.contains(o)));)s.push(o),o.host&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o=o.host:o=o.parentNode;const i=s.length;return i?s[i-1]:null}function Vo(n,e){let t=n.parentNode,s=[];for(typeof e=="string"?n.defaultView?s=Array.prototype.slice.call(n.querySelectorAll(e),0):s=Array.prototype.slice.call(n.ownerDocument.querySelectorAll(e),0):s.push(e);t!==null;){if(s.indexOf(t)>-1)return!0;t=t.parentNode}return!1}function OE(n){let e=0,t=n;if(t.previousSibling)for(;t=t.previousSibling;)e+=1;return e}function xo(n,e,t){const s=t.parentElement.querySelector(`.ht_clone_${n}`);return s?s.contains(e):null}function AE(n){return!n||!n.length?[]:n.filter(e=>!!e)}function IE(n,e){if(!n||!n.length)return e?{regexFree:[],regexes:[]}:[];const t=[],s=[];return s.push(...n.filter(o=>{const i=o instanceof RegExp;return i&&e&&t.push(o),!i})),e?{regexFree:s,regexes:t}:s}function Ae(n,e){return n.classList===void 0||typeof e!="string"||e===""?!1:n.classList.contains(e)}function J(n,e){typeof e=="string"&&(e=e.split(" ")),e=AE(e),e.length>0&&n.classList.add(...e)}function Pe(n,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:t,regexes:s}=IE(e,!0);t=AE(t),t.length>0&&n.classList.remove(...t),s.forEach(o=>{n.classList.forEach(i=>{o.test(i)&&n.classList.remove(i)})})}function Se(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,t]]),e.forEach(s=>{Array.isArray(s)&&s[0]!==""&&n.setAttribute(...s)})}function Jo(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:t,regexes:s}=IE(e,!0);t.forEach(o=>{o!==""&&n.removeAttribute(o)}),s.forEach(o=>{n.getAttributeNames().forEach(i=>{o.test(i)&&n.removeAttribute(i)})})}function Aw(n){if(n.nodeType===3)n.parentNode.removeChild(n);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(n.nodeName)>-1){const e=n.childNodes;for(let t=e.length-1;t>=0;t--)Aw(e[t])}}function hs(n){let e;for(;e=n.lastChild;)n.removeChild(e)}const xE=/(<(.*)>|&(.*);)/;function Fi(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;xE.test(e)?n.innerHTML=t?Th(e):e:Go(n,e)}function Go(n,e){const t=n.firstChild;t&&t.nodeType===3&&t.nextSibling===null?t.textContent=e:(hs(n),n.appendChild(n.ownerDocument.createTextNode(e)))}function jo(n){const e=n.ownerDocument.documentElement;let t=n;for(;t!==e;){if(t===null)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(t.host){if(t.host.impl)return jo(t.host.impl);if(t.host)return jo(t.host);throw new Error("Lost in Web Components world")}else return!1;else if(uo(t).display==="none")return!1;t=t.parentNode}return!0}function Lt(n){const e=n.ownerDocument,t=e.defaultView,s=e.documentElement;let o=n,i,r,a;for(i=o.offsetLeft,r=o.offsetTop,a=o;(o=o.offsetParent)&&!(o===e.body||!("offsetLeft"in o));)i+=o.offsetLeft,r+=o.offsetTop,a=o;return a&&a.style.position==="fixed"&&(i+=t.pageXOffset||s.scrollLeft,r+=t.pageYOffset||s.scrollTop),{left:i,top:r}}function Iw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Mh(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function ol(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?Iw(e):n.scrollTop}function $c(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n===e?Mh(e):n.scrollLeft}function il(n){let e=n.ownerDocument,t=e?e.defaultView:void 0;e||(e=n.document?n.document:n,t=e.defaultView);const s=["auto","scroll"];let o=n.parentNode;for(;o&&o.style&&e.body!==o;){let{overflow:i,overflowX:r,overflowY:a}=o.style;if([i,r,a].includes("scroll"))return o;if({overflow:i,overflowX:r,overflowY:a}=t.getComputedStyle(o),s.includes(i)||s.includes(r)||s.includes(a)||o.clientHeight<=o.scrollHeight+1&&(s.includes(a)||s.includes(i))||o.clientWidth<=o.scrollWidth+1&&(s.includes(r)||s.includes(i)))return o;o=o.parentNode}return t}function Oi(n){const e=n.ownerDocument,t=e.defaultView;let s=n.parentNode;for(;s&&s.style&&e.body!==s;){if(s.style.overflow!=="visible"&&s.style.overflow!=="")return s;const o=uo(s,t),i=["scroll","hidden","auto"],r=o.getPropertyValue("overflow"),a=o.getPropertyValue("overflow-y"),l=o.getPropertyValue("overflow-x");if(i.includes(r)||i.includes(a)||i.includes(l))return s;s=s.parentNode}return t}function Or(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(n){if(n===t)return e==="width"?`${t.innerWidth}px`:e==="height"?`${t.innerHeight}px`:void 0}else return;const s=n.style[e];if(s!==""&&s!==void 0)return s;const o=uo(n,t);if(o[e]!==""&&o[e]!==void 0)return o[e]}function pF(n,e){const{selectorText:t}=e;let s=!1;return e.type===CSSRule.STYLE_RULE&&t&&(n.msMatchesSelector?s=n.msMatchesSelector(t):n.matches&&(s=n.matches(t))),s}function uo(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return n.currentStyle||e.getComputedStyle(n)}function ut(n){return n.offsetWidth}function Et(n){return n.offsetHeight}function oo(n){return n.clientHeight||n.innerHeight}function Ya(n){return n.clientWidth||n.innerWidth}function wF(n,e,t){n.addEventListener(e,t,!1)}function CF(n,e,t){n.removeEventListener(e,t,!1)}function xw(n){return n.selectionStart?n.selectionStart:0}function HE(n){return n.selectionEnd?n.selectionEnd:0}function SF(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=n.document;let t="";return n.getSelection?t=n.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(t=e.selection.createRange().text),t}function ip(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;n.getSelection&&(n.getSelection().empty?n.getSelection().empty():n.getSelection().removeAllRanges&&n.getSelection().removeAllRanges())}function Tl(n,e,t){if(t===void 0&&(t=e),n.setSelectionRange){n.focus();try{n.setSelectionRange(e,t)}catch{const o=n.parentNode,i=o.style.display;o.style.display="block",n.setSelectionRange(e,t),o.style.display=i}}}let Kf;function vF(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=n.createElement("div");e.style.height="200px",e.style.width="100%";const t=n.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(n.body||n.documentElement).appendChild(t);const s=e.offsetWidth;t.style.overflow="scroll";let o=e.offsetWidth;return s===o&&(o=t.clientWidth),(n.body||n.documentElement).removeChild(t),s-o}function Yt(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Kf===void 0&&(Kf=vF(n)),Kf}function PE(n){return n.offsetWidth!==n.clientWidth}function DE(n){return n.offsetHeight!==n.clientHeight}function _h(n,e,t){n.style.transform=`translate3d(${e},${t},0)`}function yF(n){let e;return n.style.transform&&(e=n.style.transform)!==""?["transform",e]:-1}function Ml(n){n.style.transform&&n.style.transform!==""&&(n.style.transform="")}function Vc(n){return n&&(["INPUT","SELECT","TEXTAREA"].indexOf(n.nodeName)>-1||n.contentEditable==="true")}function Oh(n){return Vc(n)&&n.hasAttribute("data-hot-input")===!1}function bF(n){const e=n.ownerDocument.activeElement;Oh(e)||n.select()}function Hw(n){return!n.parentNode}function NE(n,e){new IntersectionObserver((s,o)=>{s.forEach(i=>{i.isIntersecting&&n.offsetParent!==null&&(e(),o.unobserve(n))})},{root:n.ownerDocument.body}).observe(n)}function Pw(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=n.ownerDocument,o=s.createRange(),i=s.defaultView.getSelection();Se(n,"contenteditable",!0),t&&Se(n,...go()),e&&J(n,"invisibleSelection"),o.selectNodeContents(n),i.removeAllRanges(),i.addRange(o)}function Dw(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const t=n.ownerDocument.defaultView.getSelection();n.hasAttribute("aria-hidden")&&n.removeAttribute("aria-hidden"),t.removeAllRanges(),e&&Pe(n,"invisibleSelection"),n.removeAttribute("contenteditable")}function LE(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Pw(n,t),e(),Dw(n,t)}function Ai(n,e){let{tagName:t,className:s,attributes:o}=e;const i=n.ownerDocument.createElement(t);return s&&J(i,s),o&&o.length&&Se(i,o),n.appendChild(i),i}const RF=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:xE,addClass:J,addEvent:wF,appendElement:Ai,clearTextSelection:ip,closest:$o,closestDown:Pa,empty:hs,fastInnerHTML:Fi,fastInnerText:Go,getCaretPosition:xw,getComputedStyle:uo,getCssTransform:yF,getFrameElement:_E,getParent:TE,getParentWindow:sl,getScrollLeft:$c,getScrollTop:ol,getScrollableElement:il,getScrollbarWidth:Yt,getSelectionEndPosition:HE,getSelectionText:SF,getStyle:Or,getTrimmingContainer:Oi,getWindowScrollLeft:Mh,getWindowScrollTop:Iw,hasAccessToParentWindow:mF,hasClass:Ae,hasHorizontalScrollbar:DE,hasVerticalScrollbar:PE,index:OE,innerHeight:oo,innerWidth:Ya,isChildOf:Vo,isDetached:Hw,isInput:Vc,isOutsideInput:Oh,isThisHotChild:ME,isVisible:jo,makeElementContentEditableAndSelectItsContent:Pw,matchesCSSRules:pF,observeVisibilityChangeOnce:NE,offset:Lt,outerHeight:Et,outerWidth:ut,overlayContainsElement:xo,removeAttribute:Jo,removeClass:Pe,removeContentEditableFromElementAndDeselect:Dw,removeEvent:CF,removeTextNodes:Aw,resetCssTransform:Ml,runWithSelectedContendEditableElement:LE,selectElementIfAllowed:bF,setAttribute:Se,setCaretPosition:Tl,setOverlayPosition:_h},Symbol.toStringTag,{value:"Module"}));function dt(n){return typeof n=="function"}function kE(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=0;const s={lastCallThrottled:!0};let o=null;function i(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];const u=Date.now();let c=!1;s.lastCallThrottled=!0,t||(t=u,c=!0);const d=e-(u-t);return c?(s.lastCallThrottled=!1,n.apply(this,a)):(o&&clearTimeout(o),o=setTimeout(()=>{s.lastCallThrottled=!1,n.apply(this,a),t=0,o=void 0},d)),s}return i}function EF(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const s=kE(n,e);let o=t;function i(){o=t}function r(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return o?(o-=1,n.apply(this,l)):s.apply(this,l)}return r.clearHits=i,r}function Nw(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,t=null,s;function o(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return t&&clearTimeout(t),t=setTimeout(()=>{s=n.apply(this,r)},e),s}return o}function TF(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];const[s,...o]=e;return function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];return Pt(o,(u,c)=>c(u),s.apply(this,a))}}function Lw(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n.apply(this,t.concat(r))}}function FE(n){const e=n.length;function t(s){return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];const l=s.concat(r);let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function MF(n){const e=n.length;function t(s){return function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];const l=s.concat(r.reverse());let u;return l.length>=e?u=n.apply(this,l):u=t(l),u}}return t([])}function Wc(n,e,t,s,o,i,r,a){return oe(a)?n.call(e,t,s,o,i,r,a):oe(r)?n.call(e,t,s,o,i,r):oe(i)?n.call(e,t,s,o,i):oe(o)?n.call(e,t,s,o):oe(s)?n.call(e,t,s):oe(t)?n.call(e,t):n.call(e)}const _F=Object.freeze(Object.defineProperty({__proto__:null,curry:FE,curryRight:MF,debounce:Nw,fastCall:Wc,isFunction:dt,partial:Lw,pipe:TF,throttle:kE,throttleAfterHits:EF},Symbol.toStringTag,{value:"Module"}));var OF=Jt,Pv=r0,AF=Kt,Dv=Di,IF=ew,Nv=OF([].push),xF=function(n){if(AF(n))return n;if(Pv(n)){for(var e=n.length,t=[],s=0;s<e;s++){var o=n[s];typeof o=="string"?Nv(t,o):(typeof o=="number"||Dv(o)==="Number"||Dv(o)==="String")&&Nv(t,IF(o))}var i=t.length,r=!0;return function(a,l){if(r)return r=!1,l;if(Pv(this))return l;for(var u=0;u<i;u++)if(t[u]===a)return l}}},HF=Qo,$E=wl,VE=dh,PF=Lr,_l=Jt,WE=Gn,Lv=Kt,kv=Yp,BE=nw,DF=xF,NF=Up,LF=String,Wo=$E("JSON","stringify"),nu=_l(/./.exec),Fv=_l("".charAt),kF=_l("".charCodeAt),FF=_l("".replace),$F=_l(1 .toString),VF=/[\uD800-\uDFFF]/g,$v=/^[\uD800-\uDBFF]$/,Vv=/^[\uDC00-\uDFFF]$/,Wv=!NF||WE(function(){var n=$E("Symbol")("stringify detection");return Wo([n])!=="[null]"||Wo({a:n})!=="{}"||Wo(Object(n))!=="{}"}),Bv=WE(function(){return Wo("\uDF06\uD834")!=='"\\udf06\\ud834"'||Wo("\uDEAD")!=='"\\udead"'}),WF=function(n,e){var t=BE(arguments),s=DF(e);if(!(!Lv(s)&&(n===void 0||kv(n))))return t[1]=function(o,i){if(Lv(s)&&(i=PF(s,this,LF(o),i)),!kv(i))return i},VE(Wo,null,t)},BF=function(n,e,t){var s=Fv(t,e-1),o=Fv(t,e+1);return nu($v,n)&&!nu(Vv,o)||nu(Vv,n)&&!nu($v,s)?"\\u"+$F(kF(n,0),16):n};Wo&&HF({target:"JSON",stat:!0,arity:3,forced:Wv||Bv},{stringify:function(e,t,s){var o=BE(arguments),i=VE(Wv?WF:Wo,null,o);return Bv&&typeof i=="string"?FF(i,VF,BF):i}});function Ar(n){let e;return Array.isArray(n)?e=n.length?new Array(n.length).fill(null):[]:(e={},We(n,(t,s)=>{s!=="__children"&&(t&&typeof t=="object"&&!Array.isArray(t)?e[s]=Ar(t):Array.isArray(t)?t.length&&typeof t[0]=="object"&&!Array.isArray(t[0])?e[s]=[Ar(t[0])]:e[s]=[]:e[s]=null)})),e}function mo(n,e){return e.prototype.constructor=e,n.prototype=new e,n.prototype.constructor=n,n}function kt(n,e,t){const s=Array.isArray(t);return We(e,(o,i)=>{(s===!1||t.includes(i))&&(n[i]=o)}),n}function Ol(n,e){We(e,(t,s)=>{e[s]&&typeof e[s]=="object"?(n[s]||(Array.isArray(e[s])?n[s]=[]:Object.prototype.toString.call(e[s])==="[object Date]"?n[s]=e[s]:n[s]={}),Ol(n[s],e[s])):n[s]=e[s]})}function Qt(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n}function Sn(n){const e={};return We(n,(t,s)=>{e[s]=t}),e}function ht(n){n.MIXINS||(n.MIXINS=[]);for(var e=arguments.length,t=new Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];return T(t,o=>{n.MIXINS.push(o.MIXIN_NAME),We(o,(i,r)=>{if(n.prototype[r]!==void 0)throw new Error(`Mixin conflict. Property '${r}' already exist and cannot be overwritten.`);if(typeof i=="function")n.prototype[r]=i;else{const a=function(c,d){const f=`_${c}`,m=w=>{let C=w;return(Array.isArray(C)||De(C))&&(C=Qt(C)),C};return function(){return this[f]===void 0&&(this[f]=m(d)),this[f]}},l=function(c){const d=`_${c}`;return function(f){this[d]=f}};Object.defineProperty(n.prototype,r,{get:a(r,i),set:l(r),configurable:!0})}})}),n}function Ah(n,e){return JSON.stringify(n)===JSON.stringify(e)}function De(n){return Object.prototype.toString.call(n)==="[object Object]"}function Ls(n,e,t,s){s.value=t,s.writable=s.writable!==!1,s.enumerable=s.enumerable!==!1,s.configurable=s.configurable!==!1,Object.defineProperty(n,e,s)}function We(n,e){for(const t in n)if((!n.hasOwnProperty||n.hasOwnProperty&&Object.prototype.hasOwnProperty.call(n,t))&&e(n[t],t,n)===!1)break;return n}function UE(n,e){const t=e.split(".");let s=n;return We(t,o=>{if(s=s[o],s===void 0)return s=void 0,!1}),s}function cc(n,e,t){const s=e.split(".");let o=n;s.forEach((i,r)=>{r!==s.length-1?(Rt(o,i)||(o[i]={}),o=o[i]):o[i]=t})}function Ih(n){if(!De(n))return 0;const e=function(t){let s=0;return De(t)?We(t,(o,i)=>{i!=="__children"&&(s+=e(o))}):s+=1,s};return e(n)}function Ii(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const t=`_${e}`,s={_touched:!1,[t]:n,isTouched(){return this._touched}};return Object.defineProperty(s,e,{get(){return this[t]},set(o){this._touched=!0,this[t]=o},enumerable:!0,configurable:!0}),s}function Rt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const UF=Object.freeze(Object.defineProperty({__proto__:null,clone:Sn,createObjectPropListener:Ii,deepClone:Qt,deepExtend:Ol,deepObjectSize:Ih,defineGetter:Ls,duckSchema:Ar,extend:kt,getProperty:UE,hasOwnProperty:Rt,inherit:mo,isObject:De,isObjectEqual:Ah,mixin:ht,objectEach:We,setProperty:cc},Symbol.toStringTag,{value:"Module"})),Bn=n=>{const e={value:!1};return e.test=(t,s)=>{e.value=n(t,s)},e},po={chrome:Bn((n,e)=>/Chrome/.test(n)&&/Google/.test(e)),chromeWebKit:Bn(n=>/CriOS/.test(n)),edge:Bn(n=>/Edge/.test(n)),edgeWebKit:Bn(n=>/EdgiOS/.test(n)),firefox:Bn(n=>/Firefox/.test(n)),firefoxWebKit:Bn(n=>/FxiOS/.test(n)),mobile:Bn(n=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)),safari:Bn((n,e)=>/Safari/.test(n)&&/Apple Computer/.test(e))},Ur={mac:Bn(n=>/^Mac/.test(n)),win:Bn(n=>/^Win/.test(n)),linux:Bn(n=>/^Linux/.test(n)),ios:Bn(n=>/iPhone|iPad|iPod/i.test(n))};function YE(){let{userAgent:n=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};We(po,t=>{let{test:s}=t;return void s(n,e)})}function zE(){let{platform:n=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};We(Ur,e=>{let{test:t}=e;return void t(n)})}YE();zE();function kw(){return po.chrome.value}function GE(){return po.chromeWebKit.value}function hc(){return po.firefox.value}function jE(){return po.firefoxWebKit.value}function Fw(){return po.safari.value}function KE(){return po.edge.value}function YF(){return po.edgeWebKit.value}function io(){return po.mobile.value}function $w(){return Ur.ios.value}function Vw(){let{maxTouchPoints:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return n>2&&Ur.mac.value}function rp(){return Ur.win.value}function Bc(){return Ur.mac.value}function zF(){return Ur.linux.value}const GF=Object.freeze(Object.defineProperty({__proto__:null,isChrome:kw,isChromeWebKit:GE,isEdge:KE,isEdgeWebKit:YF,isFirefox:hc,isFirefoxWebKit:jE,isIOS:$w,isIpadOS:Vw,isLinuxOS:zF,isMacOS:Bc,isMobileBrowser:io,isSafari:Fw,isWindowsOS:rp,setBrowserMeta:YE,setPlatformMeta:zE},Symbol.toStringTag,{value:"Module"})),fe={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:hc()?182:174,AUDIO_MUTE:hc()?181:173,AUDIO_UP:hc()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},jF=[fe.ALT,fe.ARROW_DOWN,fe.ARROW_LEFT,fe.ARROW_RIGHT,fe.ARROW_UP,fe.AUDIO_DOWN,fe.AUDIO_MUTE,fe.AUDIO_UP,fe.BACKSPACE,fe.CAPS_LOCK,fe.DELETE,fe.END,fe.ENTER,fe.ESCAPE,fe.F1,fe.F2,fe.F3,fe.F4,fe.F5,fe.F6,fe.F7,fe.F8,fe.F9,fe.F10,fe.F11,fe.F12,fe.F13,fe.F14,fe.F15,fe.F16,fe.F17,fe.F18,fe.F19,fe.HOME,fe.INSERT,fe.MEDIA_NEXT,fe.MEDIA_PLAY_PAUSE,fe.MEDIA_PREV,fe.MEDIA_STOP,fe.NULL,fe.NUM_LOCK,fe.PAGE_DOWN,fe.PAGE_UP,fe.PAUSE,fe.SCROLL_LOCK,fe.SHIFT,fe.TAB];function XE(n){return n===32||n>=48&&n<=57||n>=96&&n<=111||n>=186&&n<=192||n>=219&&n<=222||n>=226||n>=65&&n<=90}function Ww(n){return jF.includes(n)}function KF(n){const e=[];return Bc()?e.push(fe.COMMAND_LEFT,fe.COMMAND_RIGHT,fe.COMMAND_FIREFOX):e.push(fe.CONTROL),e.includes(n)}function qE(n){return[fe.CONTROL,fe.COMMAND_LEFT,fe.COMMAND_RIGHT,fe.COMMAND_FIREFOX].includes(n)}function Yr(n,e){const t=e.split("|");let s=!1;return T(t,o=>{if(n===fe[o])return s=!0,!1}),s}const XF=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:fe,isCtrlKey:KF,isCtrlMetaKey:qE,isFunctionKey:Ww,isKey:Yr,isPrintableChar:XE},Symbol.toStringTag,{value:"Module"}));function Xn(n){n.isImmediatePropagationEnabled=!1,n.cancelBubble=!0}function Do(n){return n.isImmediatePropagationEnabled===!1}function Ko(n){return n.button===2}function xh(n){return n.button===0}function ZE(n,e){const t={x:n.offsetX,y:n.offsetY};let s=n.target;if(!(e instanceof HTMLElement)||s!==e&&s.contains(e))return t;for(;s!==e;)t.x+=s.offsetLeft,t.y+=s.offsetTop,s=s.offsetParent;return t}const qF=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Do,isLeftClick:xh,isRightClick:Ko,offsetRelativeTo:ZE,stopImmediatePropagation:Xn},Symbol.toStringTag,{value:"Module"}));function lt(){oe(console)&&console.warn(...arguments)}function Bw(){oe(console)&&console.error(...arguments)}const Yi=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],ZF=Qe`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Xf=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),qf=new Map([[]]);class QE{static getSingleton(){return JF()}constructor(){this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return T(Yi,t=>e[t]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(t))T(t,o=>this.add(e,o,s));else{Xf.has(e)&&lt(_w(ZF,{hookName:e,removedInVersion:Xf.get(e)})),qf.has(e)&&lt(qf.get(e));const o=this.getBucket(s);if(typeof o[e]>"u"&&(this.register(e),o[e]=[]),t.skip=!1,o[e].indexOf(t)===-1){let i=!1;t.initialHook&&T(o[e],(r,a)=>{if(r.initialHook)return o[e][a]=t,i=!0,!1}),i||o[e].push(t)}}return this}once(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(t)?T(t,o=>this.once(e,o,s)):(t.runOnce=!0,this.add(e,t,s))}remove(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const o=this.getBucket(s);return typeof o[e]<"u"&&o[e].indexOf(t)>=0?(t.skip=!0,!0):!1}has(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const s=this.getBucket(t);return!!(s[e]!==void 0&&s[e].length)}run(e,t,s,o,i,r,a,l){{const u=this.globalBucket[t],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=Wc(u[d],e,s,o,i,r,a,l);f!==void 0&&(s=f),u[d]&&u[d].runOnce&&this.remove(t,u[d]),d+=1}}{const u=this.getBucket(e)[t],c=u?u.length:0;let d=0;if(c)for(;d<c;){if(!u[d]||u[d].skip){d+=1;continue}const f=Wc(u[d],e,s,o,i,r,a,l);f!==void 0&&(s=f),u[d]&&u[d].runOnce&&this.remove(t,u[d],e),d+=1}}return s}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;We(this.getBucket(e),(t,s,o)=>o[s].length=0)}register(e){this.isRegistered(e)||Yi.push(e)}deregister(e){this.isRegistered(e)&&Yi.splice(Yi.indexOf(e),1)}isDeprecated(e){return qf.has(e)||Xf.has(e)}isRegistered(e){return Yi.indexOf(e)>=0}getRegistered(){return Yi}}const QF=new QE;function JF(){return QF}const de=QE,Zf=new Map;function fs(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Zf.has(n)||Zf.set(n,new Map);const e=Zf.get(n);function t(a,l){e.set(a,l)}function s(a){return e.get(a)}function o(a){return e.has(a)}function i(){return[...e.keys()]}function r(){return[...e.values()]}return{register:t,getItem:s,hasItem:o,getNames:i,getValues:r}}const ap=new WeakMap,{register:e$,getItem:JE,hasItem:eT,getNames:t$,getValues:g8}=fs("editors");function n$(n){const e={},t=n;this.getConstructor=function(){return n},this.getInstance=function(s){return s.guid in e||(e[s.guid]=new t(s)),e[s.guid]},de.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function tT(n,e){let t;if(typeof n=="function")ap.get(n)||On(null,n),t=ap.get(n);else if(typeof n=="string")t=JE(n);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!t)throw Error(`No editor registered under name "${n}"`);return t.getInstance(e)}function Uc(n){if(typeof n=="function")return n;if(!eT(n))throw Error(`No registered editor found under "${n}" name`);return JE(n).getConstructor()}function On(n,e){n&&typeof n!="string"&&(e=n,n=e.EDITOR_TYPE);const t=new n$(e);typeof n=="string"&&e$(n,t),ap.set(e,t)}let dc=0;class s${constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function i(r){s.call(this,o$(r))}return this.context.eventListeners.push({element:e,event:t,callback:s,callbackProxy:i,options:o,eventManager:this}),e.addEventListener(t,i,o),dc+=1,()=>{this.removeEventListener(e,t,s)}}removeEventListener(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=this.context.eventListeners.length,r;for(;i;)if(i-=1,r=this.context.eventListeners[i],r.event===t&&r.element===e){if(s&&s!==r.callback||o&&r.eventManager!==this)continue;this.context.eventListeners.splice(i,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),dc-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const s=this.context.eventListeners[t];e&&s.eventManager!==this||(this.context.eventListeners.splice(t,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),dc-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let s=e.document,o=e;s||(s=e.ownerDocument?e.ownerDocument:e,o=s.defaultView);const i={bubbles:!0,cancelable:t!=="mousemove",view:o,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let r;s.createEvent?(r=s.createEvent("MouseEvents"),r.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,s.body.parentNode)):r=s.createEventObject(),e.dispatchEvent?e.dispatchEvent(r):e.fireEvent(`on${t}`,r)}}function o$(n){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=function(){e.apply(this),Xn(this)},n}const It=s$;function i$(){return dc}const Hh="editorManager.navigation";class lp{constructor(e,t,s){this.instance=e,this.tableMeta=t,this.selection=s,this.eventManager=new It(e),this.destroyed=!1,this.lock=!1,this.activeEditor=void 0,this.cellProperties=void 0,this.instance.addHook("afterDocumentKeyDown",o=>this.onAfterDocumentKeyDown(o)),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"compositionstart",o=>{!this.destroyed&&this.instance.isListening()&&this.openEditor("",o)}),this.instance.view._wt.update("onCellDblClick",(o,i,r)=>this.onCellDblClick(o,i,r))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.instance.getSelectedRangeLast();if(e.isHeader())return;const{row:t,col:s}=e,o=this.instance.runHooks("modifyGetCellCoords",t,s);let i=t,r=s;if(Array.isArray(o)&&([i,r]=o),this.cellProperties=this.instance.getCellMeta(i,r),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.instance.getCell(t,s,!0);if(a){const l=this.instance.getCellEditor(this.cellProperties),u=this.instance.colToProp(r),c=this.instance.getSourceDataAtCell(this.instance.toPhysicalRow(i),r);this.activeEditor=tT(l,this.instance),this.activeEditor.prepare(t,s,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.instance.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(s&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,s){this.activeEditor?this.activeEditor.finishEditing(e,t,s):s&&s(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.instance.getSelectedRangeLast();if(!e)return!1;const t=this.instance.getCellEditor(this.cellProperties),{row:s,col:o}=e.highlight,{rowIndexMapper:i,columnIndexMapper:r}=this.instance,a=i.isHidden(this.instance.toPhysicalRow(s))||r.isHidden(this.instance.toPhysicalColumn(o));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-t.row,-t.col):this.selection.transformStart(t.row,t.col,!0)}onAfterDocumentKeyDown(e){const t=this.instance.getSelectedRangeLast();if(!this.instance.isListening()||!t||t.highlight.isHeader()||Do(e))return;const{keyCode:s}=e,o=(e.ctrlKey||e.metaKey)&&!e.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!Ww(s)&&!qE(s)&&!o&&!this.isEditorOpened()){const r=this.instance.getShortcutManager().getContext("editor"),a={runOnlyIf:()=>oe(this.instance.getSelected()),group:Hh};r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.instance.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.instance.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.instance.selection.transformStart(0,-1*this.instance.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.instance.selection.transformStart(0,this.instance.getDirectionFactor())}}],a),this.openEditor("",e)}}onCellDblClick(e,t,s){s.nodeName==="TD"&&this.openEditor(null,e,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}const Uv=new WeakMap;lp.getInstance=function(n,e,t){let s=Uv.get(n);return s||(s=new lp(n,e,t),Uv.set(n,s)),s};const r$=lp;function su(n,e){nT(n,e),e.add(n)}function ou(n,e,t){nT(n,e),e.set(n,t)}function nT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function nn(n,e){var t=sT(n,e,"get");return a$(n,t)}function a$(n,e){return e.get?e.get.call(n):e.value}function ea(n,e,t){var s=sT(n,e,"set");return l$(n,s,t),t}function sT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function l$(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const ko=Object.freeze({CELL:"cell",MIXED:"mixed"});var Dn=new WeakMap,iu=new WeakMap,ru=new WeakMap,au=new WeakMap,up=new WeakSet,cp=new WeakSet,Yv=new WeakSet,zv=new WeakSet;class u${constructor(e){var t=this;su(this,zv),su(this,Yv),su(this,cp),su(this,up),ou(this,Dn,{writable:!0,value:void 0}),ou(this,iu,{writable:!0,value:void 0}),ou(this,ru,{writable:!0,value:50}),ou(this,au,{writable:!0,value:null});const s=e.getSettings();ea(this,Dn,e),ea(this,iu,s.imeFastEdit?ko.MIXED:ko.CELL),nn(this,Dn).addHook("afterUpdateSettings",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return vr(t,zv,h$).call(t,...i)}),nn(this,Dn).addHook("afterSelection",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return vr(t,Yv,c$).call(t,...i)})}getFocusMode(){return nn(this,iu)}setFocusMode(e){Object.values(ko).includes(e)?ea(this,iu,e):lt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return nn(this,ru)}setRefocusDelay(e){ea(this,ru,e)}setRefocusElementGetter(e){ea(this,au,e)}getRefocusElement(){if(typeof nn(this,au)=="function")return nn(this,au).call(this);var e;return(e=nn(this,Dn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){var t;const s=vr(this,up,oT).call(this),o=e||vr(this,cp,iT).call(this);let i=nn(this,Dn).runHooks("modifyFocusedElement",s.row,s.col,o);i instanceof HTMLElement||(i=o),i&&!((t=nn(this,Dn).getActiveEditor())!==null&&t!==void 0&&t.isOpened())&&i.focus({preventScroll:!0})}refocusToEditorTextarea(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nn(this,ru);const t=this.getRefocusElement();nn(this,Dn).getSettings().imeFastEdit&&t&&nn(this,Dn)._registerTimeout(()=>{t.select()},e)}}function oT(){return nn(this,Dn).getSelectedRangeLast().highlight}function iT(){const n=vr(this,up,oT).call(this);return nn(this,Dn).getCell(n.row,n.col,!0)}function c$(){const n=vr(this,cp,iT).call(this),{activeElement:e}=nn(this,Dn).rootDocument;e&&Oh(e)&&e.blur(),this.focusOnHighlightedCell(n),this.getFocusMode()===ko.MIXED&&n.nodeName==="TD"&&nn(this,Dn).addHookOnce("afterSelectionEnd",()=>{this.refocusToEditorTextarea()})}function h$(n){n.imeFastEdit&&this.getFocusMode()!==ko.MIXED?this.setFocusMode(ko.MIXED):!n.imeFastEdit&&this.getFocusMode()!==ko.CELL&&this.setFocusMode(ko.CELL)}var d$=Zo,f$=Di,g$=kr,m$=g$("match"),p$=function(n){var e;return d$(n)&&((e=n[m$])!==void 0?!!e:f$(n)==="RegExp")},w$=Fr,C$=function(){var n=w$(this),e="";return n.hasIndices&&(e+="d"),n.global&&(e+="g"),n.ignoreCase&&(e+="i"),n.multiline&&(e+="m"),n.dotAll&&(e+="s"),n.unicode&&(e+="u"),n.unicodeSets&&(e+="v"),n.sticky&&(e+="y"),e},S$=Lr,v$=Hs,y$=Wp,b$=C$,Gv=RegExp.prototype,R$=function(n){var e=n.flags;return e===void 0&&!("flags"in Gv)&&!v$(n,"flags")&&y$(Gv,n)?S$(b$,n):e},Uw=Jt,E$=Cl,T$=Math.floor,Qf=Uw("".charAt),M$=Uw("".replace),Jf=Uw("".slice),_$=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,O$=/\$([$&'`]|\d{1,2})/g,A$=function(n,e,t,s,o,i){var r=t+n.length,a=s.length,l=O$;return o!==void 0&&(o=E$(o),l=_$),M$(i,l,function(u,c){var d;switch(Qf(c,0)){case"$":return"$";case"&":return n;case"`":return Jf(e,0,t);case"'":return Jf(e,r);case"<":d=o[Jf(c,1,-1)];break;default:var f=+c;if(f===0)return u;if(f>a){var m=T$(f/10);return m===0?u:m<=a?s[m-1]===void 0?Qf(c,1):s[m-1]+Qf(c,1):u}d=s[f-1]}return d===void 0?"":d})},I$=Qo,x$=Lr,Yw=Jt,jv=Vp,H$=Kt,P$=$p,D$=p$,ta=ew,N$=YR,L$=R$,k$=A$,F$=kr,$$=F$("replace"),V$=TypeError,rT=Yw("".indexOf);Yw("".replace);var Kv=Yw("".slice),W$=Math.max,Xv=function(n,e,t){return t>n.length?-1:e===""?t:rT(n,e,t)};I$({target:"String",proto:!0},{replaceAll:function(e,t){var s=jv(this),o,i,r,a,l,u,c,d,f,m=0,w=0,C="";if(!P$(e)){if(o=D$(e),o&&(i=ta(jv(L$(e))),!~rT(i,"g")))throw V$("`.replaceAll` does not allow non-global regexes");if(r=N$(e,$$),r)return x$(r,e,s,t)}for(a=ta(s),l=ta(e),u=H$(t),u||(t=ta(t)),c=l.length,d=W$(1,c),m=Xv(a,l,0);m!==-1;)f=u?ta(t(l,m,a)):k$(l,a,m,[],void 0,t),C+=Kv(a,w,m)+f,w=m+c,m=Xv(a,l,m+d);return w<a.length&&(C+=Kv(a,w)),C}});function Cn(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=typeof n;if(t==="number")return!isNaN(n)&&isFinite(n);if(t==="string"){if(n.length===0)return!1;if(n.length===1)return/\d/.test(n);const s=Array.from(new Set([".",...e])).map(o=>`\\${o}`).join("|");return new RegExp(`^[+-]?\\s*(((${s})?\\d+((${s})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(n.trim())}else if(t==="object")return!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date);return!1}function aT(n){return Cn(n,[","])}function me(n,e,t){let s=-1;for(typeof e=="function"?(t=e,e=n):s=n-1;++s<=e&&t(s)!==!1;);}function Yc(n,e,t){let s=n+1;for(typeof e=="function"&&(t=e,e=0);--s>=e&&t(s)!==!1;);}function zw(n,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(n*e/100,10)}function An(n,e,t){return Math.min(n,e)===n?e:Math.max(n,t)===n?t:n}const B$=Object.freeze(Object.defineProperty({__proto__:null,clamp:An,isNumeric:Cn,isNumericLike:aT,rangeEach:me,rangeEachReverse:Yc,valueAccordingPercent:zw},Symbol.toStringTag,{value:"Module"})),lT={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},U$=new RegExp(Object.keys(lT).map(n=>`(${n})`).join("|"),"gi");function Y$(n){return(n&&n.nodeName||"")==="TABLE"}function Ir(n){return Vt(n)?"":n}function hp(n){const e=n.hasRowHeaders()?-1:0,t=n.hasColHeaders()?-1:0,s=Array.from({length:n.countRows()+Math.abs(t)},(i,r)=>r+t),o=Array.from({length:n.countCols()+Math.abs(e)},(i,r)=>r+e);return Gw(n,{rows:s,columns:o})}function Gw(n,e){return["<table>",...q$(n,e),...Q$(n,e),"</table>"].join("")}function jw(n,e){return[...Z$(n,e),...J$(n,e)]}function zc(n){return["<table>",...X$(n),...K$(n),"</table>"].join("")}function uT(n,e,t){return n.reduce((s,o,i)=>{if(e.includes(i-n.length))return s;const r=o.filter((a,l)=>t.includes(l)===!1);return r.length>0?s.concat([r]):s},[])}function z$(n,e,t){const s=[];return uT(n,e,t).forEach(o=>{const i=["<tr>"];for(let r=0;r<o.length;r+=1){const a=o[r];let l=a,u="";if(De(a)){const{colspan:c,label:d}=a;l=d,u=` colspan=${c}`}i.push(`<th${u}>${xr(Ir(l))}</th>`)}i.push("</tr>"),s.push(...i)}),s}function G$(n,e,t){if(e.includes(-1))return[];const s=n.filter((o,i)=>t.includes(i)===!1);return s.length===0?[]:["<tr>",...s.map(o=>`<th>${xr(Ir(o))}</th>`),"</tr>"]}function cT(n,e,t){return Array.isArray(n)===!1?[]:n.reduce((s,o,i)=>{if(e.includes(i))return s;const r=o.filter((a,l)=>t.includes(l)===!1);return r.length>0?s.concat([r]):s},[])}function j$(n){const e=new Map,t=new Set;let s=1,o=1;return n==null||n.forEach(i=>{const{row:r,col:a,rowspan:l,colspan:u}=i;e.set(`${r}x${a}`,{rowspan:l,colspan:u}),Number.isInteger(l)&&(s=l),Number.isInteger(u)&&(o=u),me(r,r+s-1,c=>{me(a,a+o-1,d=>{(c!==r||d!==a)&&t.add(`${c}x${d}`)})})}),{mergedCellsMap:e,mergedArea:t}}function K$(n){const e=n.excludedColumns||[],t=n.excludedRows||[],{data:s,mergeCells:o}=n,i=t.filter(c=>c>=0),r=cT(s,i,e),a=[];if(r.length===0)return[];const{mergedCellsMap:l,mergedArea:u}=j$(o);return r.forEach((c,d)=>{const f=["<tr>"];c.forEach((m,w)=>{const C=[],b=`${d}x${w}`,y=l.get(b);if(y!==void 0){const{rowspan:M,colspan:A}=y;Number.isInteger(M)&&M>1&&C.push(` rowspan="${M}"`),Number.isInteger(A)&&A>1&&C.push(` colspan="${A}"`)}else if(u.has(b))return;f.push(`<td${C.join("")}>${xr(Ir(m))}</td>`)}),f.push("</tr>"),a.push(...f)}),["<tbody>",...a,"</tbody>"]}function X$(n){const e=[],t=Array.isArray(n==null?void 0:n.excludedColumns)?n.excludedColumns:[],s=Array.isArray(n==null?void 0:n.excludedRows)?n.excludedRows:[],{nestedHeaders:o,colHeaders:i}=n,r=s.filter(a=>a<0);return Array.isArray(o)?e.push(...z$(o,r,t)):Array.isArray(i)&&e.push(...G$(i,r,t)),e.length>0?["<thead>",...e,"</thead>"]:[]}function Kw(n){const e=[],t=Array.isArray(n==null?void 0:n.excludedColumns)?n.excludedColumns:[],s=Array.isArray(n==null?void 0:n.excludedRows)?n.excludedRows:[],{data:o,nestedHeaders:i,colHeaders:r}=n,a=s.filter(l=>l<0);return Array.isArray(i)?e.push(...uT(i,a,t).map(l=>l.reduce((u,c)=>(De(c)?u.push(c.label,...new Array(c.colspan-1).fill("")):u.push(c),u),[]))):Array.isArray(r)&&e.push([...r.filter((l,u)=>t.includes(u)===!1)]),e.push(...cT(o,s.filter(l=>l>=0),t.filter(l=>l>=0))),e}function xr(n){return`${n}`.replace(/&/g,"&amp;").replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`).replace(/\t/gi,"&#9;")}function eg(n){return n.replace(U$,e=>lT[e]).replace(/<span style="mso-spacerun: yes">(.+?)<\/span>/,"$1").replaceAll("&nbsp;"," ")}function q$(n,e){const{rows:t,columns:s}=e,o=t.filter(r=>r<0),i=[];return o.length===0||s.length===0?[]:(o.forEach(r=>{const a=["<tr>"];for(let l=0;l<s.length;l+=1){const u=s[l],c=n.getCell(r,u),d=c==null?void 0:c.getAttribute("colspan");let f="";if(d){const m=parseInt(d,10);f=` colspan=${m}`,l+=m-1}a.push(`<th${f}>${xr(Ir(n.getColHeader(u,r)))}</th>`)}a.push("</tr>"),i.push(...a)}),["<thead>",...i,"</thead>"])}function Z$(n,e){const t=[],{columns:s,rows:o}=e;return o.filter(r=>r<0).forEach(r=>{const a=[];for(let l=0;l<s.length;l+=1){const u=s[l],c=n.getCell(r,u),d=c==null?void 0:c.getAttribute("colspan");if(a.push(n.getColHeader(u,r)),d){const f=parseInt(d,10);a.push(...new Array(f-1).fill("")),l+=f-1}}t.push(a)}),t}function Q$(n,e){const{columns:t,rows:s}=e,o=s.filter(r=>r>=0),i=[];return o.length===0||t.length===0?[]:(o.forEach((r,a)=>{const l=["<tr>"];t.forEach((u,c)=>{if(u<0){l.push(`<th>${xr(Ir(n.getRowHeader(r)))}</th>`);return}const d=n.getCopyableData(r,u),f=xr(Ir(d)),{hidden:m,rowspan:w,colspan:C}=n.getCellMeta(r,u);if(!m){const b=[];if(w){const y=Math.min(w,o.slice(a).length);y>1&&b.push(` rowspan="${y}"`)}if(C){const y=Math.min(C,t.slice(c).length);y>1&&b.push(` colspan="${y}"`)}l.push(`<td${b.join("")}>${f}</td>`)}}),l.push("</tr>"),i.push(...l)}),["<tbody>",...i,"</tbody>"])}function J$(n,e){const t=[],{columns:s,rows:o}=e;return o.filter(r=>r>=0).forEach(r=>{const a=[];s.forEach(l=>{const u=n.getCopyableData(r,l),c=Vt(u)?"":u;a.push(c)}),t.push(a)}),t}function hT(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const t={},s=e.createDocumentFragment(),o=e.createElement("div");s.appendChild(o);let i=n;if(typeof i=="string"){const A=i.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,$=>{const H=$.match(/<td\b[^>]*?>/g)[0],V=$.substring(H.length,$.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${H}${V}</td>`});o.insertAdjacentHTML("afterbegin",`${A}`),i=o.querySelector("table")}if(!i||!Y$(i))return;const r=o.querySelector('meta[name$="enerator"]'),a=i.querySelector("tbody th")!==null,l=i.querySelector("tr"),u=l?Array.from(l.cells).reduce((A,$)=>A+$.colSpan,0)-(a?1:0):0,c=i.tFoot&&Array.from(i.tFoot.rows)||[],d=[];let f=!1,m=0,w=0;if(i.tHead){const A=Array.from(i.tHead.rows).filter(H=>{const V=H.querySelector("td")!==null;return V&&d.push(H),!V}),$=A.find(H=>H.querySelector("th[colspan]")!==null)!==void 0;m=A.length,f=m>0,m>1||$?t.nestedHeaders=Array.from(A).reduce((H,V)=>{const z=Array.from(V.cells).reduce((ee,j,X)=>{if(a&&X===0)return ee;const{colSpan:ie}=j,ae=eg(j.innerHTML),re=ie>1?{label:ae,colspan:ie}:ae;return ee.push(re),ee},[]);return H.push(z),H},[]):f&&(t.colHeaders=Array.from(A[0].children).reduce((H,V,z)=>(a&&z===0||H.push(eg(V.innerHTML)),H),[]))}d.length&&(t.fixedRowsTop=d.length),c.length&&(t.fixedRowsBottom=c.length);const C=[...d,...Array.from(i.tBodies).reduce((A,$)=>(A.push(...Array.from($.rows)),A),[]),...c];w=C.length;const b=new Array(w);for(let A=0;A<w;A++)b[A]=new Array(u);const y=[],M=[];for(let A=0;A<w;A++){const $=C[A],H=Array.from($.cells),V=H.length;for(let z=0;z<V;z++){const ee=H[z],{nodeName:j,innerHTML:X,rowSpan:ie,colSpan:ae}=ee,re=b[A].findIndex(pe=>pe===void 0);if(j==="TD"){if(ie>1||ae>1){for(let Ie=A;Ie<A+ie;Ie++)if(Ie<w)for(let R=re;R<re+ae;R++)b[Ie][R]=null;const Oe=ee.getAttribute("style");Oe&&Oe.includes("mso-ignore:colspan")||y.push({col:re,row:A,rowspan:ie,colspan:ae})}let pe="";r&&/excel/gi.test(r.content)?pe=X.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):pe=X.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),b[A][re]=eg(pe)}else M.push(X)}}return y.length&&(t.mergeCells=y),M.length&&(t.rowHeaders=M),b.length&&(t.data=b),t}const eV=Object.freeze(Object.defineProperty({__proto__:null,getDataByCoords:jw,getDataWithHeadersByConfig:Kw,getHTMLByCoords:Gw,getHTMLFromConfig:zc,htmlToGridSettings:hT,instanceToHTML:hp},Symbol.toStringTag,{value:"Module"})),dp="asc",tV="desc",qv=new Map([[dp,[-1,1]],[tV,[1,-1]]]),nV=n=>`The priority '${n}' is already declared in a map.`,sV=n=>`The priority '${n}' is not a number.`;function oV(){let{errorPriorityExists:n,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=new Map;n=dt(n)?n:nV,e=dt(e)?e:sV;function s(i,r){if(!Cn(i))throw new Error(e(i));if(t.has(i))throw new Error(n(i));t.set(i,r)}function o(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dp;const[r,a]=qv.get(i)||qv.get(dp);return[...t].sort((l,u)=>l[0]<u[0]?r:a).map(l=>l[1])}return{addItem:s,getItems:o}}const iV=n=>`The id '${n}' is already declared in a map.`;function Ph(){let{errorIdExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;n=dt(n)?n:iV;function t(u,c){if(l(u))throw new Error(n(u));e.set(u,c)}function s(u){return e.delete(u)}function o(){e.clear()}function i(u){const[c]=a().find(d=>{let[f,m]=d;return u===m?f:!1})||[null];return c}function r(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:t,clear:o,getId:i,getItem:r,getItems:a,hasItem:l,removeItem:s}}const rV=n=>`'${n}' value is already declared in a unique set.`;function aV(){let{errorItemExists:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;n=dt(n)?n:rV;function t(i){if(e.has(i))throw new Error(n(i));e.add(i)}function s(){return[...e]}function o(){e.clear()}return{addItem:t,clear:o,getItems:s}}const Xw=n=>`There is already registered "${n}" plugin.`,lV=n=>`There is already registered plugin on priority "${n}".`,uV=n=>`The priority "${n}" is not a number.`,dT=oV({errorPriorityExists:lV,errorPriorityNaN:uV}),fT=aV({errorItemExists:Xw}),fp=Ph({errorIdExists:Xw});function qw(){return[...dT.getItems(),...fT.getItems()]}function Al(n){const e=un(n);return fp.getItem(e)}function cV(n){return!!Al(n)}function Ne(n,e,t){[n,e,t]=dV(n,e,t),Al(n)===void 0&&hV(n,e,t)}function hV(n,e,t){const s=un(n);if(fp.hasItem(s))throw new Error(Xw(s));t===void 0?fT.addItem(s):dT.addItem(t,s),fp.addItem(s,e)}function dV(n,e,t){return typeof n=="function"&&(e=n,n=e.PLUGIN_KEY,t=e.PLUGIN_PRIORITY),[n,e,t]}const{register:fV,getItem:gV,hasItem:gT,getNames:mV,getValues:m8}=fs("renderers");function Gc(n){if(typeof n=="function")return n;if(!gT(n))throw Error(`No registered renderer found under "${n}" name`);return gV(n)}function Rs(n,e){typeof n!="string"&&(e=n,n=e.RENDERER_TYPE),fV(n,e)}const{register:pV,getItem:wV,hasItem:mT,getNames:CV,getValues:p8}=fs("validators");function Zw(n){if(typeof n=="function")return n;if(!mT(n))throw Error(`No registered validator found under "${n}" name`);return wV(n)}function yr(n,e){typeof n!="string"&&(e=n,n=e.VALIDATOR_TYPE),pV(n,e)}var pT={},SV=s0,vV=Jp,yV=Object.keys||function(e){return SV(e,vV)},bV=xs,RV=qR,EV=Ni,TV=Fr,MV=ch,_V=yV;pT.f=bV&&!RV?Object.defineProperties:function(e,t){TV(e);for(var s=MV(t),o=_V(t),i=o.length,r=0,a;i>r;)EV.f(e,a=o[r++],s[a]);return e};var OV=Fr,AV=pT,Zv=Jp,IV=qp,xV=p0,HV=Kp,PV=JR,Qv=">",Jv="<",gp="prototype",mp="script",wT=PV("IE_PROTO"),tg=function(){},CT=function(n){return Jv+mp+Qv+n+Jv+"/"+mp+Qv},ey=function(n){n.write(CT("")),n.close();var e=n.parentWindow.Object;return n=null,e},DV=function(){var n=HV("iframe"),e="java"+mp+":",t;return n.style.display="none",xV.appendChild(n),n.src=String(e),t=n.contentWindow.document,t.open(),t.write(CT("document.F=Object")),t.close(),t.F},lu,fc=function(){try{lu=new ActiveXObject("htmlfile")}catch{}fc=typeof document<"u"?document.domain&&lu?ey(lu):DV():ey(lu);for(var n=Zv.length;n--;)delete fc[gp][Zv[n]];return fc()};IV[wT]=!0;var NV=Object.create||function(e,t){var s;return e!==null?(tg[gp]=OV(e),s=new tg,tg[gp]=null,s[wT]=e):s=fc(),t===void 0?s:AV.f(s,t)},LV=kr,kV=NV,FV=Ni.f,pp=LV("unscopables"),wp=Array.prototype;wp[pp]===void 0&&FV(wp,pp,{configurable:!0,value:kV(null)});var ST=function(n){wp[pp][n]=!0},$V=Qo,VV=Cl,WV=hh,BV=Qp,UV=ST;$V({target:"Array",proto:!0},{at:function(e){var t=VV(this),s=WV(t),o=BV(e),i=o>=0?o:s+o;return i<0||i>=s?void 0:t[i]}});UV("at");const bi=1,an=2,zi=new WeakMap;class Qw{static get DEFAULT_WIDTH(){return 50}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:s,itemSizeFn:o,overrideFn:i,calculationType:r,stretchMode:a,stretchingItemWidthFn:l=c=>c,inlineStartOffset:u}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};zi.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:s,columnWidthFn:o,overrideFn:i,calculationType:r,stretchingColumnWidthFn:l,inlineStartOffset:u}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}calculate(){let e=0,t=!0;const s=[];let o,i=0,r=0;const a=zi.get(this),l=a.calculationType,u=a.overrideFn,c=a.scrollOffset,d=Math.max(a.scrollOffset,0),f=a.totalColumns,m=a.viewportWidth,w=d>0?m+1:m;for(let M=0;M<f;M++)if(o=this._getColumnWidth(M),e<=d&&l!==an&&(this.startColumn=M,i=o),e>=d&&e+(l===an?o:0)<=d+w&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=M,i=o),this.endColumn=M),s.push(e),e+=o,r=o,l!==an&&(this.endColumn=M),e>=d+m){t=!1;break}const C=c+m-w,b=l===an?0:r,y=l===an?i:0;if(C<-1*a.inlineStartOffset||c>s.at(-1)+b||-1*a.scrollOffset-a.viewportWidth>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===f-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){const M=s[this.endColumn]+o-s[this.startColumn-1];if((M<=m||l!==an)&&(this.startColumn-=1),M>m)break}l===bi&&this.startColumn!==null&&u&&u(this),this.startPosition=s[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),f<this.endColumn&&(this.endColumn=f-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(this.stretch==="none")return;let t=e;this.totalTargetWidth=t;const s=zi.get(this),o=s.totalColumns;let i=0;for(let a=0;a<o;a++){const l=this._getColumnWidth(a),u=s.stretchingColumnWidthFn(void 0,a);typeof u=="number"?t-=u:i+=l}const r=t-i;if(this.stretch==="all"&&r>0)this.stretchAllRatio=t/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(this.stretch==="last"&&t!==1/0){const a=this._getColumnWidth(o-1),l=r+a;this.stretchLastWidth=l>=0?l:a}}getStretchedColumnWidth(e,t){let s=null;return this.stretch==="all"&&this.stretchAllRatio!==0?s=this._getStretchedAllColumnWidth(e,t):this.stretch==="last"&&this.stretchLastWidth!==0&&(s=this._getStretchedLastColumnWidth(e)),s}_getStretchedAllColumnWidth(e,t){let s=0;const o=zi.get(this),i=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){const r=Math.round(t*this.stretchAllRatio),a=o.stretchingColumnWidthFn(r,e);a===void 0?this.stretchAllColumnsWidth[e]=r:this.stretchAllColumnsWidth[e]=isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let r=0;r<this.stretchAllColumnsWidth.length;r++)s+=this.stretchAllColumnsWidth[r];s!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-s)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const s=zi.get(this).totalColumns;return e===s-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=zi.get(this).columnWidthFn(e);return isNaN(t)&&(t=Qw.DEFAULT_WIDTH),t}}const Jw=Qw,ty=new WeakMap;class eC{static get DEFAULT_HEIGHT(){return 23}constructor(){let{viewportSize:e,scrollOffset:t,totalItems:s,itemSizeFn:o,overrideFn:i,calculationType:r,scrollbarHeight:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ty.set(this,{viewportHeight:e,scrollOffset:t,totalRows:s,rowHeightFn:o,overrideFn:i,calculationType:r,horizontalScrollbarHeight:a}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.isVisibleInTrimmingContainer=!1,this.calculate()}calculate(){const e=ty.get(this),t=e.calculationType,s=e.overrideFn,o=e.rowHeightFn,i=e.scrollOffset,r=Math.max(e.scrollOffset,0),a=e.totalRows,l=e.viewportHeight,u=e.horizontalScrollbarHeight||0;let c=0,d=!0;const f=[];let m,w=0,C=0;for(let A=0;A<a;A++)if(m=o(A),isNaN(m)&&(m=eC.DEFAULT_HEIGHT),c<=r&&t!==an&&(this.startRow=A,w=m),c>=r&&c+(t===an?m:0)<=r+l-u&&(this.startRow===null&&(this.startRow=A,w=m),this.endRow=A),f.push(c),c+=m,C=m,t!==an&&(this.endRow=A),c>=r+l-u){d=!1;break}const b=i+l-u,y=t===an?w:0,M=t===an?0:C;if(b<y||i>f.at(-1)+M?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===a-1&&d)for(this.startRow=this.endRow;this.startRow>0;){const A=f[this.endRow]+m-f[this.startRow-1];if((A<=l-u||t!==an)&&(this.startRow-=1),A>=l-u)break}t===bi&&this.startRow!==null&&s&&s(this),this.startPosition=f[this.startRow],this.startPosition===void 0&&(this.startPosition=null),a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const vT=eC;function YV(n,e,t){zV(n,e),e.set(n,t)}function zV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ny(n,e,t){return e=GV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function GV(n){var e=jV(n,"string");return typeof e=="symbol"?e:String(e)}function jV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Gi(n,e){var t=yT(n,e,"get");return KV(n,t)}function KV(n,e){return e.get?e.get.call(n):e.value}function sy(n,e,t){var s=yT(n,e,"set");return XV(n,s,t),t}function yT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function XV(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Vs=new WeakMap;class jc{constructor(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;ny(this,"row",null),ny(this,"col",null),YV(this,Vs,{writable:!0,value:!1}),sy(this,Vs,s),typeof e<"u"&&typeof t<"u"&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:s,countRowHeaders:o,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-i||this.col<-o||this.row>=t||this.col>=s)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Gi(this,Vs)}isSouthEastOf(e){return this.row>=e.row&&(Gi(this,Vs)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Gi(this,Vs)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Gi(this,Vs)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Gi(this,Vs)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof jc&&sy(this,Vs,e.isRtl()),this}clone(){return new jc(this.row,this.col,Gi(this,Vs))}toObject(){return{row:this.row,col:this.col}}}const Os=jc;function qV(n,e,t){ZV(n,e),e.set(n,t)}function ZV(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ng(n,e,t){return e=QV(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function QV(n){var e=JV(n,"string");return typeof e=="symbol"?e:String(e)}function JV(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ms(n,e){var t=bT(n,e,"get");return eW(n,t)}function eW(n,e){return e.get?e.get.call(n):e.value}function tW(n,e,t){var s=bT(n,e,"set");return nW(n,s,t),t}function bT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function nW(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var $n=new WeakMap;class tC{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;ng(this,"highlight",null),ng(this,"from",null),ng(this,"to",null),qV(this,$n,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=t.clone(),this.to=s.clone(),tW(this,$n,o)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:s}=e,o=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return o.row<=t&&i.row>=t&&o.col<=s&&i.col>=s}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return e.row<t.row||e.col<t.col||e.row>s.row||e.col>s.col?(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(s.row,e.row),Math.max(s.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const t=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner(),o=this.getDirection(),i=e.getOuterTopStartCorner(),r=e.getOuterBottomEndCorner(),a=Math.min(t.row,i.row),l=Math.min(t.col,i.col),u=Math.max(s.row,r.row),c=Math.max(s.col,r.col),d=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=d,this.to=f,this.setDirection(o),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return ms(this,$n)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return ms(this,$n)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return ms(this,$n)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return ms(this,$n)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return ms(this,$n)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return ms(this,$n)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return ms(this,$n)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return ms(this,$n)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,t){return t&&t.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(t.from.row,t.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(t.from.row,t.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(t.to.row,t.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(t.to.row,t.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,t){if(!(e instanceof Os))return!1;if(t){const{from:s,to:o}=t;if(t.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(s.row,s.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(s.row,o.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(o.row,s.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(o.row,o.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},s={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return t.top===s.top&&o.push("top"),t.right===s.right&&o.push("right"),t.bottom===s.bottom&&o.push("bottom"),t.left===s.left&&o.push("left"),o}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),s=[];for(let o=e.row;o<=t.row;o++)for(let i=e.col;i<=t.col;i++)!(this.from.row===o&&this.from.col===i)&&!(this.to.row===o&&this.to.col===i)&&s.push(this._createCellCoords(o,i));return s}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),s=[];for(let o=e.row;o<=t.row;o++)for(let i=e.col;i<=t.col;i++)e.row===o&&e.col===i?s.push(e):t.row===o&&t.col===i?s.push(t):s.push(this._createCellCoords(o,i));return s}forAll(e){const t=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();for(let o=t.row;o<=s.row;o++)for(let i=t.col;i<=s.col;i++)if(e(o,i)===!1)return}clone(){return new tC(this.highlight,this.from,this.to,ms(this,$n))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new Os(e,t,ms(this,$n))}}const Hr=tC;function Dh(n){return window.requestAnimationFrame(n)}function rl(n){window.cancelAnimationFrame(n)}function nC(){return"ontouchstart"in window}let ji;function RT(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ji||(typeof Intl=="object"?ji=new Intl.Collator(n,e).compare:typeof String.prototype.localeCompare=="function"?ji=(t,s)=>`${t}`.localeCompare(s):ji=(t,s)=>t===s?0:t>s?-1:1,ji)}const sW=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:rl,getComparisonFunction:RT,isTouchSupported:nC,requestAnimationFrame:Dh},Symbol.toStringTag,{value:"Module"})),Ki=new WeakMap;let oW=class{constructor(e,t,s,o,i,r){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;this.wtSettings=s,this.domBindings=t,this.wtTable=i,this.selectionManager=r,this.parent=a,this.eventManager=o,this.facadeGetter=e,Ki.set(this,{selectedCellBeforeTouchEnd:void 0,dblClickTimeout:[null,null],dblClickOrigin:[null,null]}),this.registerEvents()}registerEvents(){this.eventManager.addEventListener(this.wtTable.holder,"contextmenu",s=>this.onContextMenu(s)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseover",s=>this.onMouseOver(s)),this.eventManager.addEventListener(this.wtTable.TABLE,"mouseout",s=>this.onMouseOut(s));const e=()=>{this.eventManager.addEventListener(this.wtTable.holder,"touchstart",s=>this.onTouchStart(s)),this.eventManager.addEventListener(this.wtTable.holder,"touchend",s=>this.onTouchEnd(s)),this.momentumScrolling||(this.momentumScrolling={}),this.eventManager.addEventListener(this.wtTable.holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||this.wtSettings.getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,this.wtSettings.getSetting("onAfterMomentumScroll"))},200)})},t=()=>{this.eventManager.addEventListener(this.wtTable.holder,"mouseup",s=>this.onMouseUp(s)),this.eventManager.addEventListener(this.wtTable.holder,"mousedown",s=>this.onMouseDown(s))};io()?e():(nC()&&e(),t())}selectedCellWasTouched(e){const t=Ki.get(this),o=this.parentCell(e).coords;if(t.selectedCellBeforeTouchEnd&&o){const[i,r]=[o.row,t.selectedCellBeforeTouchEnd.from.row],[a,l]=[o.col,t.selectedCellBeforeTouchEnd.from.col];return i===r&&a===l}return!1}parentCell(e){const t={},s=this.wtTable.TABLE,o=Pa(e,["TD","TH"],s);return o?(t.coords=this.wtTable.getCoords(o),t.TD=o):Ae(e,"wtBorder")&&Ae(e,"current")?(t.coords=this.selectionManager.getFocusSelection().cellRange.highlight,t.TD=this.wtTable.getCell(t.coords)):Ae(e,"wtBorder")&&Ae(e,"area")&&this.selectionManager.getAreaSelection().cellRange&&(t.coords=this.selectionManager.getAreaSelection().cellRange.to,t.TD=this.wtTable.getCell(t.coords)),t}onMouseDown(e){const t=Ki.get(this),s=this.domBindings.rootDocument.activeElement,o=Lw(TE,e.target),i=e.target;if(!["TD","TH"].includes(s.nodeName)&&(i===s||o(0)===s||o(1)===s))return;const r=this.parentCell(i);Ae(i,"corner")?this.wtSettings.getSetting("onCellCornerMouseDown",e,i):r.TD&&this.wtSettings.has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,r.coords,r.TD),(e.button===0||this.touchApplied)&&r.TD&&(t.dblClickOrigin[0]=r.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(()=>{t.dblClickOrigin[0]=null},1e3))}onContextMenu(e){if(this.wtSettings.has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!this.wtSettings.has("onCellMouseOver"))return;const t=this.wtTable.TABLE,s=Pa(e.target,["TD","TH"],t),o=this.parent||this;s&&s!==o.lastMouseOver&&Vo(s,t)&&(o.lastMouseOver=s,this.callListener("onCellMouseOver",e,this.wtTable.getCoords(s),s))}onMouseOut(e){if(!this.wtSettings.has("onCellMouseOut"))return;const t=this.wtTable.TABLE,s=Pa(e.target,["TD","TH"],t),o=Pa(e.relatedTarget,["TD","TH"],t),i=this.parent||this;s&&s!==o&&Vo(s,t)&&(this.callListener("onCellMouseOut",e,this.wtTable.getCoords(s),s),o===null&&(i.lastMouseOver=null))}onMouseUp(e){const t=Ki.get(this),s=this.parentCell(e.target);s.TD&&this.wtSettings.has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,s.coords,s.TD),!(e.button!==0&&!this.touchApplied)&&(s.TD===t.dblClickOrigin[0]&&s.TD===t.dblClickOrigin[1]?(Ae(e.target,"corner")?this.callListener("onCellCornerDblClick",e,s.coords,s.TD):this.callListener("onCellDblClick",e,s.coords,s.TD),t.dblClickOrigin[0]=null,t.dblClickOrigin[1]=null):s.TD===t.dblClickOrigin[0]&&(t.dblClickOrigin[1]=s.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(()=>{t.dblClickOrigin[1]=null},500)))}onTouchStart(e){const t=Ki.get(this);t.selectedCellBeforeTouchEnd=this.selectionManager.getFocusSelection().cellRange,this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const s=e.target,o=(t=this.parentCell(s))===null||t===void 0?void 0:t.coords,i=oe(o)&&o.row>=0&&o.col>=0;if(e.cancelable&&i&&this.wtSettings.getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];$w()&&(GE()||jE())&&this.selectedCellWasTouched(s)&&!a.includes(s.tagName)?e.preventDefault():this.selectedCellWasTouched(s)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,s,o){const i=this.wtSettings.getSettingPure(e);i&&i(t,s,o,this.facadeGetter())}destroy(){const e=Ki.get(this);clearTimeout(e.dblClickTimeout[0]),clearTimeout(e.dblClickTimeout[1]),this.eventManager.destroy()}};const ET=oW;class iW{constructor(e,t,s){this.offset=e,this.total=t,this.countTH=s}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const rW=iW;class aW{constructor(e,t,s){this.offset=e,this.total=t,this.countTH=s}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const lW=aW,uW=0,Kc=1,Xc=2;class oy{constructor(){this.currentSize=0,this.nextSize=0,this.currentOffset=0,this.nextOffset=0}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}class cW{constructor(){this.size=new oy,this.workingSpace=uW,this.sharedSize=null}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof oy}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Kc,e.workingSpace=Xc,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Xc,e.workingSpace=Kc,this.sharedSize=e.getViewSize()}}class TT{constructor(e,t,s){this.rootNode=e,this.nodesPool=t,this.sizeSet=new cW,this.childNodeType=s.toUpperCase(),this.visualIndex=0,this.collectedNodes=[]}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let s=0;if(this.isSharedViewSet()){let o=e.firstElementChild;for(;o;){if(o.tagName===this.childNodeType)s+=1;else if(t.isPlaceOn(Kc))break;o=o.nextElementSibling}}else s=e.childElementCount;return s}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,s=this.isSharedViewSet(),{nextSize:o}=t.getViewSize();let i=this.getRenderedChildCount();for(;i<o;){const a=this.nodesPool();!s||s&&t.isPlaceOn(Xc)?e.appendChild(a):e.insertBefore(a,e.firstChild),i+=1}const r=s&&t.isPlaceOn(Kc);for(;i>o;)e.removeChild(r?e.firstChild:e.lastChild),i-=1}render(){const{rootNode:e,sizeSet:t}=this;let s=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(Xc)&&(s+=t.sharedSize.nextSize);let o=e.childNodes[s];if(o.tagName!==this.childNodeType){const i=this.nodesPool();e.replaceChild(i,o),o=i}this.collectedNodes.push(o),this.visualIndex+=1}end(){}}class MT extends TT{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}class hW{constructor(e){this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}class Il{constructor(e,t){this.nodesPool=typeof e=="string"?new hW(e):null,this.nodeType=e,this.rootNode=t,this.table=null,this.renderedNodes=0}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}class dW extends Il{constructor(){super("TH"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new MT(e,s=>this.nodesPool.obtain(this.sourceRowIndex,s),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:s,rows:o,cells:i}=this.table;for(let r=0;r<e;r++){const a=this.table.renderedRowToSource(r),l=o.getRenderedNode(r);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=i.obtainOrderView(l);u.appendView(c).setSize(s).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<s;d++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),Jo(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Se(f,[Kk(),nF(),Ow(d+1),Wr(-1)]),t[d](a,f,d)}u.end()}}}class fW extends Il{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let s=this.rootNode.firstChild;if(e){const{columnsToRender:o}=this.table,i=o+t;for(let a=0,l=e;a<l;a++){for(s=this.rootNode.childNodes[a],s||(s=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(s)),this.renderedNodes=s.childNodes.length;this.renderedNodes<i;)s.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)s.removeChild(s.lastChild),this.renderedNodes-=1}const r=this.rootNode.childNodes.length;if(r>e)for(let a=e;a<r;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else s&&hs(s)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Se(this.rootNode,[rs()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:s,columnsToRender:o,rowHeadersCount:i}=this.table,r=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Se(r,[vE(),EE(t+1)]);for(let a=-1*i;a<o;a+=1){const l=this.table.renderedColumnToSource(a),u=r.childNodes[a+i];u.className="",u.removeAttribute("style"),Jo(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Se(u,[Ow(a+1+this.table.rowHeadersCount),Wr(-1),...a<0?[rs()]:[Xk(),tF()]]),s[t](l,u,t)}}}}class gW extends Il{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,s=e+t;for(;this.renderedNodes<s;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>s;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;for(let o=0;o<t;o++){const i=this.table.renderedColumnToSource(o),r=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[o].style.width=`${r}px`}for(let o=0;o<e;o++){const i=this.table.renderedColumnToSource(o),r=this.table.columnUtils.getStretchedColumnWidth(i);this.rootNode.childNodes[o+t].style.width=`${r}px`}const s=this.rootNode.firstChild;s&&J(s,"rowHeader")}}let iy=!1;class mW extends Il{constructor(e){super("TR",e),this.orderView=new TT(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!iy&&e>1e3&&(iy=!0,lt(Qe`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Se(this.rootNode,[rs()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let o=0;o<e;o++){this.orderView.render();const i=this.orderView.getCurrentNode(),r=this.table.renderedRowToSource(o);if(this.table.isAriaEnabled()){var t,s;Se(i,[vE(),EE(r+((t=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}}this.orderView.end()}}class pW extends Il{constructor(){super("TD"),this.orderViews=new WeakMap,this.sourceRowIndex=0}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new MT(e,s=>this.nodesPool.obtain(this.sourceRowIndex,s),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:s,rowHeaders:o}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=s.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),d=o.obtainOrderView(u);c.prependView(d).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<t;f++){c.render();const m=c.getCurrentNode(),w=this.table.renderedColumnToSource(f);if(Ae(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Jo(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,w,m),this.table.isAriaEnabled()){var i,r;Se(m,[...m.hasAttribute("role")?[]:[jk()],Wr(-1),Ow(w+((i=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.rowHeaders.length)!==null&&i!==void 0?i:0)+1)])}}c.end()}}}class wW{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.rowHeaders=null,this.columnHeaders=null,this.colGroup=null,this.rows=null,this.cells=null,this.rowFilter=null,this.columnFilter=null,this.rowUtils=null,this.columnUtils=null,this.rowsToRender=0,this.columnsToRender=0,this.rowHeaderFunctions=[],this.rowHeadersCount=0,this.columnHeaderFunctions=[],this.columnHeadersCount=0,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:s,rows:o,cells:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),s.setTable(this),o.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=s,this.rows=o,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let s=0;s<e;s++){const o=t.getRenderedNode(s);if(o.firstChild){const i=this.renderedRowToSource(s),r=this.rowUtils.getHeight(i);r?o.firstChild.style.height=`${r-1}px`:o.firstChild.style.height=""}}}}class CW{constructor(){let{TABLE:e,THEAD:t,COLGROUP:s,TBODY:o,rowUtils:i,columnUtils:r,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new wW(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new dW,columnHeaders:new fW(t),colGroup:new gW(s),rows:new mW(o),cells:new pW}),this.renderer.setAxisUtils(i,r)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}class SW{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t,this.headerWidths=new Map}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const t=this.dataAccessObject.wtViewport.columnsRenderCalculator;let s=this.getWidth(e);if(t){const o=t.getStretchedColumnWidth(e,s);o&&(s=o)}return s}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const s=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return s!==void 0&&(t=t?Math.max(t,s):s),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:t,wtViewport:s,cloneSource:o}=this.dataAccessObject,i=o?o.wtTable.holder:t.holder,r=i.offsetHeight<i.scrollHeight?Yt():0;let a=e.getSetting("rowHeaderWidth");if(s.columnsRenderCalculator.refreshStretching(s.getViewportWidth()-r),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let d=Array.isArray(a)?a[c]:a;d=d??u,this.headerWidths.set(c,d)}}}}class vW{constructor(e,t){this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const s=this.dataAccessObject.wtViewport.oversizedRows[e];return s!==void 0&&(t=t===void 0?s:Math.max(t,s)),t}}function ps(n,e,t){return e=yW(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yW(n){var e=bW(n,"string");return typeof e=="symbol"?e:String(e)}function bW(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class RW{constructor(e,t,s,o,i){ps(this,"wtSettings",null),ps(this,"domBindings",void 0),ps(this,"TBODY",null),ps(this,"THEAD",null),ps(this,"COLGROUP",null),ps(this,"hasTableHeight",!0),ps(this,"hasTableWidth",!0),ps(this,"isTableVisible",!1),ps(this,"tableOffset",0),ps(this,"holderOffset",0),this.domBindings=s,this.isMaster=i==="master",this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=o,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=s.rootTable,Aw(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const r=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(r)),this.rowUtils=new vW(this.dataAccessObject,this.wtSettings),this.columnUtils=new SW(this.dataAccessObject,this.wtSettings),this.tableRenderer=new CW({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let s;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ae(t,"wtHolder"))&&(s=this.domBindings.rootDocument.createElement("div"),s.className="wtSpreader",t&&t.insertBefore(s,e),s.appendChild(e)),s.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Se(s,[rs()]),s}createHider(e){const t=e.parentNode;let s;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ae(t,"wtHolder"))&&(s=this.domBindings.rootDocument.createElement("div"),s.className="wtHider",t&&t.insertBefore(s,e),s.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Se(s,[rs()]),s}createHolder(e){const t=e.parentNode;let s;return(!t||t.nodeType!==Node.ELEMENT_NODE||!Ae(t,"wtHolder"))&&(s=this.domBindings.rootDocument.createElement("div"),s.style.position="relative",s.className="wtHolder",t&&t.insertBefore(s,e),this.isMaster&&(s.parentNode.className+="ht_master handsontable",s.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Se(s.parentNode,[rs()])),s.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Se(s,[rs()]),s}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:s,wtViewport:o}=this.dataAccessObject,i=t.getSetting("totalRows"),r=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),l=a.length,u=t.getSetting("columnHeaders"),c=u.length;let d=!1,f=e;if(this.isMaster&&(this.holderOffset=Lt(this.holder),f=o.createRenderCalculators(f),l&&!t.getSetting("fixedColumnsStart"))){const w=s.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=w!==0,C!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(d=s.updateStateOfRendering()),f)this.isMaster&&o.createVisibleCalculators(),s&&s.refresh(!0);else{this.isMaster?this.tableOffset=Lt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const w=i>0?this.getFirstRenderedRow():0,C=r>0?this.getFirstRenderedColumn():0;this.rowFilter=new lW(w,i,c),this.columnFilter=new rW(C,r,l);let b=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),b=y.skipRender!==!0}if(b){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(_s)||this.is(Bo))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let y;if(this.isMaster&&(y=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(_s))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const M=ut(this.hider),A=ut(this.TABLE);M!==0&&A!==M&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(_s)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let m=!1;return this.isMaster&&(m=s.topOverlay.resetFixedPosition(),s.bottomOverlay.clone&&(m=s.bottomOverlay.resetFixedPosition()||m),m=s.inlineStartOverlay.resetFixedPosition()||m,s.topInlineStartCornerOverlay&&s.topInlineStartCornerOverlay.resetFixedPosition(),s.bottomInlineStartCornerOverlay&&s.bottomInlineStartCornerOverlay.clone&&s.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(s.refreshAll(),s.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),d&&s.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let s=this.wtSettings.getSetting("columnHeaders").length;const o=this.wtSettings.getSetting("defaultRowHeight");let i,r,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;s;)s-=1,i=this.getColumnHeaderHeight(s),r=this.getColumnHeader(t,s),r&&(a=oo(r),(!i&&o<a||i<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a),Array.isArray(l)?l[s]!==null&&l[s]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=l[s]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]<(l[s]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=l[s]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,s=this.dataAccessObject.wtViewport.oversizedColumnHeaders,o=e.getSetting("columnHeaders");for(let i=0,r=o.length;i<r;i++)if(s[i]){if(!t[i]||t[i].childNodes.length===0)return;t[i].childNodes[0].style.height=`${s[i]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(_s))&&!e.getSetting("externalRowCalculator")){const s=this.getRenderedRowsCount();for(let o=0;o<s;o++){const i=this.rowFilter.renderedToSource(o);t.oversizedRows&&t.oversizedRows[i]&&(t.oversizedRows[i]=void 0)}}}getCell(e){let t=e.row,s=e.col;const o=this.wtSettings.getSetting("onModifyGetCellCoords",t,s);if(o&&Array.isArray(o)&&([t,s]=o),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(s))return-3;if(this.isColumnAfterRenderedColumns(s))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const r=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(s)];if(!r&&s>=0)throw new Error("TD or TH was expected to be rendered but is not");return r}getRow(e){let t=null,s=null;if(e<0){var o;t=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceRowToVisibleColHeadedRow(e),s=this.THEAD}else{var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceToRendered(e),s=this.TBODY}return t!==void 0&&s!==void 0?s.childNodes.length<t+1?!1:s.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=this.THEAD.childNodes[t];return s==null?void 0:s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],s=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(o=>{const i=o.childNodes[s];i&&t.push(i)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=this.wtSettings.getSetting("rowHeaders").length;if(t>=s)return;const o=this.rowFilter.sourceToRendered(e),i=o<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):o,a=(o<0?this.THEAD:this.TBODY).childNodes[i];return a==null?void 0:a.childNodes[t]}getRowHeaders(e){const t=[],s=this.wtSettings.getSetting("rowHeaders").length;for(let o=0;o<s;o++){const i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],r=i==null?void 0:i.childNodes[o];r&&t.push(r)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=$o(t,["TD","TH"])),t===null)return null;const s=t.parentNode,o=s.parentNode;let i=OE(s),r=t.cellIndex;return xo(Pi,t,this.wtRootElement)||xo(xi,t,this.wtRootElement)?o.nodeName==="THEAD"&&(i-=o.childNodes.length):xo(Bo,t,this.wtRootElement)||xo(_s,t,this.wtRootElement)?i=this.wtSettings.getSetting("totalRows")-o.childNodes.length+i:o===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):i=this.rowFilter.renderedToSource(i),xo(Pi,t,this.wtRootElement)||xo(Hi,t,this.wtRootElement)||xo(Bo,t,this.wtRootElement)?r=this.columnFilter.offsettedTH(r):r=this.columnFilter.visibleRowHeadedColumnToSourceColumn(r),this.wot.createCellCoords(i,r)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),s=oo(this.TBODY)-1;let o,i,r,a,l;if(!(t===s&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,r=this.rowFilter.renderedToSource(e),o=this.getRowHeight(r),a=this.getTrForRow(r),l=a.querySelector("th"),l?i=oo(l):i=oo(a)-1,(!o&&this.wtSettings.getSetting("defaultRowHeight")<i||o<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[r]=i)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const s=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=s}isRowHeaderRendered(e){if(e>=0)return!1;const s=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=s}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ut(this.TABLE)}getHeight(){return Et(this.TABLE)}getTotalWidth(){const e=ut(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Et(this.hider);return e!==0?e:this.getHeight()}isVisible(){return jo(this.TABLE)}_modifyRowHeaderWidth(e){let t=dt(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const zr=RW,EW="stickyRowsBottom",_T={getFirstRenderedRow(){const n=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=n-e;return n===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Ls(_T,"MIXIN_NAME",EW,{writable:!1,enumerable:!1});const OT=_T,TW="stickyColumnsStart",AT={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const n=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),n)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ls(AT,"MIXIN_NAME",TW,{writable:!1,enumerable:!1});const sC=AT;class oC extends zr{constructor(e,t,s,o){super(e,t,s,o,Bo)}}ht(oC,OT);ht(oC,sC);const MW=oC,xi="top",_s="bottom",Hi="inline_start",Pi="top_inline_start_corner",Bo="bottom_inline_start_corner",_W=[xi,_s,Hi,Pi,Bo],OW=new Map([[xi,`ht_clone_${xi}`],[_s,`ht_clone_${_s}`],[Hi,`ht_clone_${Hi} ht_clone_left`],[Pi,`ht_clone_${Pi} ht_clone_top_left_corner`],[Bo,`ht_clone_${Bo} ht_clone_bottom_left_corner`]]);function sg(n,e,t){return e=AW(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AW(n){var e=IW(n,"string");return typeof e=="symbol"?e:String(e)}function IW(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xW{constructor(e){sg(this,"dataAccessObject",void 0),sg(this,"lastScrolledColumnPos",-1),sg(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,s,o,i){const r=this.scrollViewportHorizontally(e.col,s,i),a=this.scrollViewportVertically(e.row,t,o);return r||a}scrollViewportHorizontally(e,t,s){const{drawn:o,totalColumns:i}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;const r=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=t===void 0&&s===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),r===-1?d=c.scrollTo(e,l?e>this.lastScrolledColumnPos:t):(l&&(e<r||e>a)||!l)&&(d=c.scrollTo(e,l?e>a:t)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,t,s){const{drawn:o,totalRows:i}=this.dataAccessObject;if(!o||!Number.isInteger(e)||e<0||e>i)return!1;const r=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=t===void 0&&s===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:d}=this.dataAccessObject;if(l&&(e<c||e>i-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),r===-1?f=d.scrollTo(e,l?e>this.lastScrolledRowPos:s):(l&&(e<r||e>a)||!l)&&(f=d.scrollTo(e,l?e>a:s)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:s,totalRows:o,fixedRowsTop:i,rootWindow:r}=this.dataAccessObject;let a=t.getFirstVisibleRow();if(e.mainTableScrollableElement===r){const l=Lt(t.wtRootElement),u=oo(t.hider),c=oo(r),d=ol(r,r);if(l.top+u-c<=d){let f=s.getColumnHeaderHeight();f+=e.sumCellSizes(0,i);for(let m=o;m>0;m--)if(f+=e.sumCellSizes(m-1,m),l.top+u-f<=d){a=m;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:s,totalRows:o,rootWindow:i}=this.dataAccessObject;let r=t.getLastVisibleRow();if(e.mainTableScrollableElement===i){const a=Lt(t.wtRootElement),l=ol(i,i);if(a.top>l){const u=oo(i);let c=s.getColumnHeaderHeight();for(let d=1;d<=o;d++)if(c+=e.sumCellSizes(d-1,d),a.top+c-l>=u){r=d-2;break}}}return r}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:t,wtViewport:s,totalColumns:o,rootWindow:i}=this.dataAccessObject;let r=t.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){const a=Lt(t.wtRootElement),l=Ya(t.hider),u=Ya(i),c=Math.abs($c(i,i));if(a.left+l-u<=c){let d=s.getRowHeaderWidth();for(let f=o;f>0;f--)if(d+=e.sumCellSizes(f-1,f),a.left+l-d<=c){r=f;break}}}return r}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:t,wtTable:s,wtViewport:o,totalColumns:i,rootWindow:r}=this.dataAccessObject;let a=s.getLastVisibleColumn();if(t.mainTableScrollableElement===r){const l=e.getSetting("rtlMode");let u=null;if(l){const d=s.TABLE.getBoundingClientRect(),m=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(d.right-m)}else u=Lt(s.wtRootElement).left;const c=Math.abs($c(r,r));if(u>c){const d=Ya(r);let f=o.getRowHeaderWidth();for(let m=1;m<=i;m++)if(f+=t.sumCellSizes(m-1,m),u+f-c>=d){a=m-2;break}}}return a}}const HW=xW;function Zn(n,e,t){return e=PW(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function PW(n){var e=DW(n,"string");return typeof e=="symbol"?e:String(e)}function DW(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class iC{get eventManager(){return new It(this)}constructor(e,t){Zn(this,"wtTable",void 0),Zn(this,"wtScroll",void 0),Zn(this,"wtViewport",void 0),Zn(this,"wtOverlays",void 0),Zn(this,"selectionManager",void 0),Zn(this,"wtEvent",void 0),Zn(this,"guid",`wt_${Tw()}`),Zn(this,"drawInterrupted",!1),Zn(this,"drawn",!1),Zn(this,"domBindings",void 0),Zn(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new HW(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,s=this.wtTable.THEAD.childNodes[0].childNodes.length;t<s;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,s){Go(s,e[t])}])}}createCellCoords(e,t){return new Os(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,s){return new Hr(e,t,s,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const s=this.wtSettings.getSetting("totalRows"),o=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),r=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<o&&e.col<r)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<o)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<r&&e.row>=s-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<r)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<s&&e.row>=s-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,s,o,i){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,s,o,i)}scrollViewportHorizontally(e,t,s){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,s)}scrollViewportVertically(e,t,s){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,s)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function ry(n,e,t){return e=NW(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function NW(n){var e=LW(n,"string");return typeof e=="symbol"?e:String(e)}function LW(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class kW extends iC{constructor(e,t,s){super(e,t),ry(this,"cloneSource",void 0),ry(this,"cloneOverlay",void 0);const o=this.wtSettings.getSetting("facade",this);this.cloneSource=s.source,this.cloneOverlay=s.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),o,this.domBindings,this.wtSettings),this.wtViewport=s.viewport,this.selectionManager=s.selectionManager,this.wtEvent=new ET(o,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,s.event),this.findOriginalHeaders()}}function FW(n,e,t){return e=$W(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $W(n){var e=VW(n,"string");return typeof e=="symbol"?e:String(e)}function VW(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xl{constructor(e,t,s,o,i){FW(this,"wtSettings",null),Ls(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=o;const{TABLE:r,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=s,this.mainTableScrollableElement=null,this.TABLE=r,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Oi(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Oi(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=il(e.TABLE)}getRelativeCellPosition(e,t,s){if(this.clone.wtTable.holder.contains(e)===!1){lt(`The provided element is not a child of the ${this.type} overlay`);return}const o=this.mainTableScrollableElement===this.domBindings.rootWindow,i=s<this.wtSettings.getSetting("fixedColumnsStart"),r=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let d=null;return o?d=this.getRelativeCellPositionWithinWindow(r,i,c,u):d=this.getRelativeCellPositionWithinHolder(r,a,i,c,u),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,s,o){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let r=0,a=0;if(!t)r=o.start;else{let l=i.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(i.left+i.width+Yt())),r=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:a=o.top,{start:s.start+r,top:s.top+a}}getRelativeCellPositionWithinHolder(e,t,s,o,i){const r={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(s||(a=r.horizontal-i.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=r.vertical-i.top);return{start:o.start-a,top:o.top-l}}makeClone(){if(_W.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:s,rootWindow:o}=this.domBindings,i=s.createElement("DIV"),r=s.createElement("TABLE"),a=e.wtRootElement.parentNode;i.className=`${OW.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&Se(i,[rs()]),r.className=e.TABLE.className,e.TABLE.getAttribute("role")&&r.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(r),a.appendChild(i);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===xi||u==="vertical"&&this.type===Hi?this.mainTableScrollableElement=o:o.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=il(e.TABLE),new kW(r,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,s=e.style,o=t.style,i=e.parentNode.style;T([s,o,i],r=>{r.width="",r.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class WW extends xl{constructor(e,t,s,o,i,r){super(e,t,Bo,s,o),this.bottomOverlay=i,this.inlineStartOverlay=r}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new MW(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${i}px`,t.style.bottom=`${r}px`}else Ml(t),this.repositionOverlay();let s=Et(this.clone.wtTable.TABLE);const o=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(s=0),t.style.height=`${s}px`,t.style.width=`${o}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=Yt(s)),o.style.bottom=`${i}px`}}const BW="calculatedColumns",IT={getFirstRenderedColumn(){const n=this.dataAccessObject.startColumnRendered;return n===null?-1:n},getFirstVisibleColumn(){const n=this.dataAccessObject.startColumnVisible;return n===null?-1:n},getLastRenderedColumn(){const n=this.dataAccessObject.endColumnRendered;return n===null?-1:n},getLastVisibleColumn(){const n=this.dataAccessObject.endColumnVisible;return n===null?-1:n},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Ls(IT,"MIXIN_NAME",BW,{writable:!1,enumerable:!1});const rC=IT;class aC extends zr{constructor(e,t,s,o){super(e,t,s,o,_s)}}ht(aC,OT);ht(aC,rC);const UW=aC;function YW(n,e,t){return e=zW(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function zW(n){var e=GW(n,"string");return typeof e=="symbol"?e:String(e)}function GW(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class jW extends xl{constructor(e,t,s,o){super(e,t,_s,s,o),YW(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new UW(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let s=0;const o=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!o||o!=="vertical")?(s=this.getOverlayOffset(),t.style.bottom=`${s}px`):(s=this.getScrollPosition(),this.repositionOverlay());const i=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=Yt(s)),o.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let s=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Mh(t),e),s=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,s=!0),s}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:s,wtSettings:o}=this.wot,i=o.getSetting("defaultRowHeight");let r=e,a=0;for(;r<t;){const l=s.getRowHeight(r);a+=l===void 0?i:l,r+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:s,rootWindow:o}=this.domBindings,i=Yt(s),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==o||l==="horizontal"){let c=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=i),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Et(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let s=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let r=0;t&&i.offsetHeight!==i.clientHeight&&(r=Yt(this.domBindings.rootDocument)),t?(s+=this.sumCellSizes(0,e+1),s-=this.wot.wtViewport.getViewportHeight(),s+=1):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),s+=r,this.setScrollPosition(s)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ol(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let s=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),r=o-i,a=this.domBindings.rootDocument.documentElement.clientHeight;s=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+o,0),s>r&&(s=0)}return s}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),s=this.cachedFixedRowsBottom!==t,o=this.wtSettings.getSetting("columnHeaders");let i=!1;if((s||t===0)&&o.length>0){const r=this.wot.wtTable.holder.parentNode,a=Ae(r,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(J(r,"innerBorderBottom"),i=!a):(Pe(r,"innerBorderBottom"),i=a)}return i}}const KW="calculatedRows",xT={getFirstRenderedRow(){const n=this.dataAccessObject.startRowRendered;return n===null?-1:n},getFirstVisibleRow(){const n=this.dataAccessObject.startRowVisible;return n===null?-1:n},getLastRenderedRow(){const n=this.dataAccessObject.endRowRendered;return n===null?-1:n},getLastVisibleRow(){const n=this.dataAccessObject.endRowVisible;return n===null?-1:n},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ls(xT,"MIXIN_NAME",KW,{writable:!1,enumerable:!1});const HT=xT;class lC extends zr{constructor(e,t,s,o){super(e,t,s,o,Hi)}}ht(lC,HT);ht(lC,sC);const XW=lC,qW="localHooks",PT={_localHooks:Object.create(null),addLocalHook(n,e){return this._localHooks[n]||(this._localHooks[n]=[]),this._localHooks[n].push(e),this},runLocalHooks(n,e,t,s,o,i,r){if(this._localHooks[n]){const a=this._localHooks[n].length;for(let l=0;l<a;l++)Wc(this._localHooks[n][l],this,e,t,s,o,i,r)}},clearLocalHooks(){return this._localHooks={},this}};Ls(PT,"MIXIN_NAME",qW,{writable:!1,enumerable:!1});const In=PT;let DT=class{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}};ht(DT,In);const ZW=DT,NT="active-header",uC="header",cC="area",hC="focus",QW="fill",JW="row",eB="column",tB="custom-selection",dC=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var nB=ST;nB("flat");function sB(n,e){LT(n,e),e.add(n)}function ay(n,e,t){LT(n,e),e.set(n,t)}function LT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function og(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Dt(n,e){var t=kT(n,e,"get");return oB(n,t)}function oB(n,e){return e.get?e.get.call(n):e.value}function ly(n,e,t){var s=kT(n,e,"set");return iB(n,s,t),t}function kT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function iB(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Qn=new WeakMap,Tn=new WeakMap,uu=new WeakSet;class rB{constructor(){sB(this,uu),ay(this,Qn,{writable:!0,value:void 0}),ay(this,Tn,{writable:!0,value:void 0})}setActiveOverlay(e){return ly(this,Tn,e),this}setActiveSelection(e){return ly(this,Qn,e),this}scan(){const e=Dt(this,Qn).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(s=>t.add(s)),this.scanRowsInHeadersRange(s=>t.add(s))):e==="area"?this.scanCellsRange(s=>t.add(s)):e==="focus"?(this.scanColumnsInHeadersRange(s=>t.add(s)),this.scanRowsInHeadersRange(s=>t.add(s)),this.scanCellsRange(s=>t.add(s))):e==="fill"?this.scanCellsRange(s=>t.add(s)):e==="header"?(this.scanColumnsInHeadersRange(s=>t.add(s)),this.scanRowsInHeadersRange(s=>t.add(s))):e==="row"?(this.scanRowsInHeadersRange(s=>t.add(s)),this.scanRowsInCellsRange(s=>t.add(s))):e==="column"&&(this.scanColumnsInHeadersRange(s=>t.add(s)),this.scanColumnsInCellsRange(s=>t.add(s))),t}scanColumnsInHeadersRange(e){const[t,s,o,i]=Dt(this,Qn).getCorners(),{wtTable:r}=Dt(this,Tn),a=r.getRenderedColumnsCount(),l=r.getColumnHeadersCount();let u=0;for(let c=-r.getRowHeadersCount();c<a;c++){const d=r.columnFilter.renderedToSource(c);if(!(d<s||d>i)){for(let f=-l;f<0;f++){if(f<t||f>o)continue;const m=f+l;let w=r.getColumnHeader(d,m);const C=Dt(this,Tn).getSetting("onBeforeHighlightingColumnHeader",d,m,{selectionType:Dt(this,Qn).settings.selectionType,columnCursor:u,selectionWidth:i-s+1});C!==null&&(C!==d&&(w=r.getColumnHeader(C,m)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[t,s,o,i]=Dt(this,Qn).getCorners(),{wtTable:r}=Dt(this,Tn),a=r.getRenderedRowsCount(),l=r.getRowHeadersCount();let u=0;for(let c=-r.getColumnHeadersCount();c<a;c++){const d=r.rowFilter.renderedToSource(c);if(!(d<t||d>o)){for(let f=-l;f<0;f++){if(f<s||f>i)continue;const m=f+l;let w=r.getRowHeader(d,m);const C=Dt(this,Tn).getSetting("onBeforeHighlightingRowHeader",d,m,{selectionType:Dt(this,Qn).settings.selectionType,rowCursor:u,selectionHeight:o-t+1});C!==null&&(C!==d&&(w=r.getRowHeader(C,m)),e(w))}u+=1}}}scanCellsRange(e){const[t,s,o,i]=Dt(this,Qn).getCorners(),{wtTable:r}=Dt(this,Tn);og(this,uu,ig).call(this,(a,l)=>{if(a>=t&&a<=o&&l>=s&&l<=i){const u=r.getCell(Dt(this,Tn).createCellCoords(a,l)),c=Dt(this,Tn).getSetting("onAfterDrawSelection",a,l,Dt(this,Qn).settings.layerLevel);typeof c=="string"&&J(u,c),e(u)}})}scanRowsInCellsRange(e){const[t,,s]=Dt(this,Qn).getCorners(),{wtTable:o}=Dt(this,Tn);og(this,uu,ig).call(this,(i,r)=>{if(i>=t&&i<=s){const a=o.getCell(Dt(this,Tn).createCellCoords(i,r));e(a)}})}scanColumnsInCellsRange(e){const[,t,,s]=Dt(this,Qn).getCorners(),{wtTable:o}=Dt(this,Tn);og(this,uu,ig).call(this,(i,r)=>{if(r>=t&&r<=s){const a=o.getCell(Dt(this,Tn).createCellCoords(i,r));e(a)}})}}function ig(n){const{wtTable:e}=Dt(this,Tn),t=e.getRenderedRowsCount(),s=e.getRenderedColumnsCount();for(let o=0;o<t;o+=1){const i=e.rowFilter.renderedToSource(o);for(let r=0;r<s;r+=1)n(i,e.columnFilter.renderedToSource(r))}}class aB{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=dC,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,s=this.main.childNodes.length;t<s;t++){const o=this.main.childNodes[t];this.eventManager.addEventListener(o,"mouseenter",i=>this.onMouseEnter(i,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Xn(e);const s=this,o=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none";function r(l){if(l.clientY<Math.floor(i.top)||l.clientY>Math.ceil(i.top+i.height)||l.clientX<Math.floor(i.left)||l.clientX>Math.ceil(i.left+i.width))return!0}function a(l){r(l)&&(s.eventManager.removeEventListener(o,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(o,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const s=["top","start","bottom","end","corner"];let o=this.main.style;o.position="absolute",o.top=0,o.left=0;for(let a=0;a<5;a++){const l=s[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),o=u.style,o.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,o.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,o.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),io()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let r=i.bordersHolder;r||(r=t.createElement("div"),r.className="htBorders",i.bordersHolder=r,i.spreader.appendChild(r)),r.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,s=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const o={position:"absolute",height:`${s}px`,width:`${s}px`,"border-radius":`${parseInt(s/1.5,10)}px`};We(o,(r,a)=>{this.selectionHandles.styles.bottomHitArea[a]=r,this.selectionHandles.styles.topHitArea[a]=r});const i={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};We(i,(r,a)=>{this.selectionHandles.styles.bottom[a]=r,this.selectionHandles.styles.top[a]=r}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const s=this.wot.selectionManager.getAreaSelection();return!!(s.cellRange&&(e!==s.cellRange.to.row||t!==s.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,s,o,i,r){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:d,bottomHitArea:f}=this.selectionHandles.styles,m=parseInt(u.borderWidth,10),w=parseInt(u.width,10),C=parseInt(c.width,10),b=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(s-w-1,10)}px`,u[l]=`${parseInt(o-w-1,10)}px`,c.top=`${parseInt(s-C/4*3,10)}px`,c[l]=`${parseInt(o-C/4*3,10)}px`;const M=Math.min(parseInt(o+i,10),b-w-m*2),A=Math.min(parseInt(o+i-C/4,10),b-C-m*2);d[l]=`${M}px`,f[l]=`${A}px`;const $=Math.min(parseInt(s+r,10),y-w-m*2),H=Math.min(parseInt(s+r-C/4,10),y-C-m*2);d.top=`${$}px`,f.top=`${H}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,t)?(d.display="none",f.display="none"):(d.display="block",f.display="block")):(u.display="none",d.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:s,rootWindow:o}=this.wot;let i,r,a,l,u,c;const d=t.getRenderedRowsCount();for(let R=0;R<d;R+=1){const h=t.rowFilter.renderedToSource(R);if(h>=e[0]&&h<=e[2]){i=h,u=e[0];break}}for(let R=d-1;R>=0;R-=1){const h=t.rowFilter.renderedToSource(R);if(h>=e[0]&&h<=e[2]){r=h;break}}const f=t.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const h=t.columnFilter.renderedToSource(R);if(h>=e[1]&&h<=e[3]){a=h,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const h=t.columnFilter.renderedToSource(R);if(h>=e[1]&&h<=e[3]){l=h;break}}if(i===void 0||a===void 0){this.disappear();return}let m=t.getCell(this.wot.createCellCoords(i,a));const w=i!==r||a!==l,C=w?t.getCell(this.wot.createCellCoords(r,l)):m,b=Lt(m),y=w?Lt(C):b,M=Lt(t.TABLE),A=ut(t.TABLE),$=b.top,H=b.left,V=this.wot.wtSettings.getSetting("rtlMode");let z=0,ee=0;if(V){const R=ut(m),h=o.innerWidth-M.left-A;ee=H+R-y.left,z=o.innerWidth-H-R-h-1}else ee=y.left+ut(C)-H,z=H-M.left-1;if(this.isEntireColumnSelected(i,r)){const R=this.getDimensionsFromHeader("columns",a,l,u,M);let h=null;R&&([h,z,ee]=R),h&&(m=h)}let j=$-M.top-1,X=y.top+Et(C)-$;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",i,r,c,M);let h=null;R&&([h,j,X]=R),h&&(m=h)}const ie=uo(m,o);parseInt(ie.borderTopWidth,10)>0&&(j+=1,X=X>0?X-1:0),parseInt(ie[V?"borderRightWidth":"borderLeftWidth"],10)>0&&(z+=1,ee=ee>0?ee-1:0);const ae=V?"right":"left";this.topStyle.top=`${j}px`,this.topStyle[ae]=`${z}px`,this.topStyle.width=`${ee}px`,this.topStyle.display="block",this.startStyle.top=`${j}px`,this.startStyle[ae]=`${z}px`,this.startStyle.height=`${X}px`,this.startStyle.display="block";const re=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${j+X-re}px`,this.bottomStyle[ae]=`${z}px`,this.bottomStyle.width=`${ee}px`,this.bottomStyle.display="block",this.endStyle.top=`${j}px`,this.endStyle[ae]=`${z+ee-re}px`,this.endStyle.height=`${X+1}px`,this.endStyle.display="block";let pe=this.settings.border.cornerVisible;pe=typeof pe=="function"?pe(this.settings.layerLevel):pe;const Oe=this.wot.getSetting("onModifyGetCellCoords",r,l);let[Je,Ie]=[r,l];if(Oe&&Array.isArray(Oe)&&([,,Je,Ie]=Oe),io()||!pe||this.isPartRange(Je,Ie))this.cornerStyle.display="none";else{this.cornerStyle.top=`${j+X+this.cornerCenterPointOffset-1}px`,this.cornerStyle[ae]=`${z+ee+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=Oi(t.TABLE);const h=R===o;h&&(R=s.documentElement);const g=parseInt(this.cornerDefaultStyle.width,10)/2,p=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const E=h?C.getBoundingClientRect().left:C.offsetLeft;let _=!1,I=0;V?(I=E-parseInt(this.cornerDefaultStyle.width,10)/2,_=I<0):(I=E+ut(C)+parseInt(this.cornerDefaultStyle.width,10)/2,_=I>=Ya(R)),_&&(this.cornerStyle[ae]=`${Math.floor(z+ee+this.cornerCenterPointOffset-g)}px`,this.cornerStyle[V?"borderLeftWidth":"borderRightWidth"]=0)}r===this.wot.getSetting("totalRows")-1&&(h?C.getBoundingClientRect().top:C.offsetTop)+Et(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=oo(R)&&(this.cornerStyle.top=`${Math.floor(j+X+this.cornerCenterPointOffset-p)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}io()&&this.updateMultipleSelectionHandlesPosition(r,l,j,z,ee,X)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,s,o,i){const{wtTable:r}=this.wot,a=r.wtRootElement.parentNode;let l=null,u=null,c=null,d=null,f=null,m=null,w=null,C=null;switch(e){case"rows":l=function(){return r.getRowHeader(...arguments)},u=function(){return Et(...arguments)},c="ht__selection--rows",m="top";break;case"columns":l=function(){return r.getColumnHeader(...arguments)},u=function(){return ut(...arguments)},c="ht__selection--columns",m="left";break}if(a.classList.contains(c)){const b=this.wot.getSetting("columnHeaders").length;if(w=l(t,b-o),C=l(s,b-o),!w||!C)return!1;const y=Lt(w),M=Lt(C);return w&&C&&(d=y[m]-i[m]-1,f=M[m]+u(C)-y[m]),[w,d,f]}return!1}changeBorderStyle(e,t){const s=this[e].style,o=t[e];!o||o.hide?J(this[e],"hidden"):(Ae(this[e],"hidden")&&Pe(this[e],"hidden"),s.backgroundColor=o.color,(e==="top"||e==="bottom")&&(s.height=`${o.width}px`),(e==="start"||e==="end")&&(s.width=`${o.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},s=this[e].style;s.backgroundColor=t.color,s.width=`${t.width}px`,s.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?J(this[e],"hidden"):Pe(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",io()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const uy=aB;function lB(n,e){FT(n,e),e.add(n)}function Xi(n,e,t){FT(n,e),e.set(n,t)}function FT(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uB(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function $e(n,e){var t=$T(n,e,"get");return cB(n,t)}function cB(n,e){return e.get?e.get.call(n):e.value}function cy(n,e,t){var s=$T(n,e,"set");return hB(n,s,t),t}function $T(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function hB(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var tn=new WeakMap,sn=new WeakMap,rg=new WeakMap,Da=new WeakMap,ag=new WeakMap,ri=new WeakMap,hy=new WeakSet;class dB{constructor(e){lB(this,hy),Xi(this,tn,{writable:!0,value:void 0}),Xi(this,sn,{writable:!0,value:void 0}),Xi(this,rg,{writable:!0,value:new rB}),Xi(this,Da,{writable:!0,value:new WeakMap}),Xi(this,ag,{writable:!0,value:new WeakSet}),Xi(this,ri,{writable:!0,value:new Map}),cy(this,sn,e)}setActiveOverlay(e){return cy(this,tn,e),$e(this,rg).setActiveOverlay($e(this,tn)),$e(this,Da).has($e(this,tn))||$e(this,Da).set($e(this,tn),new Set),this}getFocusSelection(){return $e(this,sn)!==null?$e(this,sn).getFocus():null}getAreaSelection(){return $e(this,sn)!==null?$e(this,sn).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if($e(this,ri).has(e)){const s=$e(this,ri).get(e);if(s.has($e(this,tn)))return s.get($e(this,tn));const o=new uy($e(this,tn),e.settings);return s.set($e(this,tn),o),o}const t=new uy($e(this,tn),e.settings);return $e(this,ri).set(e,new Map([[$e(this,tn),t]])),t}getBorderInstances(e){var t,s;return Array.from((t=(s=$e(this,ri).get(e))===null||s===void 0?void 0:s.values())!==null&&t!==void 0?t:[])}destroyBorders(e){$e(this,ri).get(e).forEach(t=>t.destroy()),$e(this,ri).delete(e)}render(e){if($e(this,sn)===null)return;e&&uB(this,hy,fB).call(this);const t=Array.from($e(this,sn)),s=new Map;for(let o=0;o<t.length;o++){const i=t[o],{className:r,createLayers:a,selectionType:l}=i.settings;$e(this,ag).has(i)||($e(this,ag).add(i),i.addLocalHook("destroy",()=>this.destroyBorders(i)));const u=this.getBorderInstance(i);if(i.isEmpty()){u==null||u.disappear();continue}r&&$e(this,rg).setActiveSelection(i).scan().forEach(f=>{if(s.has(f)){const m=s.get(f);m.has(r)&&a===!0?m.set(r,m.get(r)+1):m.set(r,1)}else s.set(f,new Map([[r,1]]))});const c=i.getCorners();$e(this,tn).getSetting("onBeforeDrawBorders",c,l),u==null||u.appear(c)}s.forEach((o,i)=>{var r,a;const l=Array.from(o).map(u=>{let[c,d]=u;return d===1?c:[c,...Array.from({length:d-1},(f,m)=>`${c}-${m+1}`)]}).flat();l.forEach(u=>$e(this,Da).get($e(this,tn)).add(u)),J(i,l),i.nodeName==="TD"&&Array.isArray((r=$e(this,sn).options)===null||r===void 0?void 0:r.cellAttributes)?Se(i,$e(this,sn).options.cellAttributes):i.nodeName==="TH"&&Array.isArray((a=$e(this,sn).options)===null||a===void 0?void 0:a.headerAttributes)&&Se(i,$e(this,sn).options.headerAttributes)})}}function fB(){const n=$e(this,Da).get($e(this,tn)),e=$e(this,tn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)n.add(e[t]);n.forEach(t=>{var s,o;const i=$e(this,tn).wtTable.TABLE.querySelectorAll(`.${t}`);let r=[];Array.isArray((s=$e(this,sn).options)===null||s===void 0?void 0:s.cellAttributes)&&(r=$e(this,sn).options.cellAttributes.map(a=>a[0])),Array.isArray((o=$e(this,sn).options)===null||o===void 0?void 0:o.headerAttributes)&&(r=[...r,...$e(this,sn).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=i.length;a<l;a++)Pe(i[a],t),Jo(i[a],r)}),n.clear()}class gB extends xl{constructor(e,t,s,o){super(e,t,Hi,s,o)}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new XW(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,s=this.clone.wtTable.holder.parentNode,o=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer===t&&(!o||o!=="horizontal")?(i=this.getOverlayOffset()*(this.isRtl()?-1:1),_h(s,`${i}px`,"0px")):(i=this.getScrollPosition(),Ml(s));const r=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),r}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let s=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Iw(t)),s=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,s=!0),s}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const s=this.wtSettings.getSetting("defaultColumnWidth");let o=e,i=0;for(;o<t;)i+=this.wot.wtTable.getStretchedColumnWidth(o)||s,o+=1;return i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:s}=this.domBindings,o=Yt(t),r=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=o),u=Math.min(u,e.wtRootElement.scrollHeight),r.height=`${u}px`}else r.height="";this.clone.wtTable.holder.style.height=r.height;const l=ut(this.clone.wtTable.TABLE);r.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(dC.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let s=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let r=0;if(t){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(t=!1)}return t&&i.offsetWidth!==i.clientWidth&&(r=Yt(this.domBindings.rootDocument)),t?(s+=this.sumCellSizes(0,e+1),s-=this.wot.wtViewport.getViewportWidth()):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),s+=r,this.setScrollPosition(s)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs($c(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let s=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?s=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):s=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const o=this.wot.wtTable.getTotalWidth(),i=this.clone.wtTable.getTotalWidth(),r=o-i;s>r&&(s=0)}return s}adjustHeaderBordersPosition(e){const t=this.wot.wtTable.holder.parentNode,s=this.wtSettings.getSetting("rowHeaders"),o=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Pe(t,"emptyRows"):J(t,"emptyRows");let r=!1;if(o&&!s.length)J(t,"innerBorderLeft innerBorderInlineStart");else if(!o&&s.length){const a=Ae(t,"innerBorderInlineStart");e?(J(t,"innerBorderLeft innerBorderInlineStart"),r=!a):(Pe(t,"innerBorderLeft innerBorderInlineStart"),r=a)}return r}}const mB="stickyRowsTop",VT={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const n=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),n)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Ls(VT,"MIXIN_NAME",mB,{writable:!1,enumerable:!1});const WT=VT;class fC extends zr{constructor(e,t,s,o){super(e,t,s,o,Pi)}}ht(fC,WT);ht(fC,sC);const pB=fC;function dy(n,e,t){return e=wB(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function wB(n){var e=CB(n,"string");return typeof e=="symbol"?e:String(e)}function CB(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class SB extends xl{constructor(e,t,s,o,i,r){super(e,t,Pi,s,o),dy(this,"topOverlay",void 0),dy(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=r}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new pB(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();_h(e,`${o}px`,`${i}px`)}else Ml(e);let t=Et(this.clone.wtTable.TABLE);const s=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${s}px`,!1}}class gC extends zr{constructor(e,t,s,o){super(e,t,s,o,xi)}}ht(gC,WT);ht(gC,rC);const vB=gC;function yB(n,e,t){return e=bB(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function bB(n){var e=RB(n,"string");return typeof e=="symbol"?e:String(e)}function RB(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class EB extends xl{constructor(e,t,s,o){super(e,t,xi,s,o),yB(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return new vB(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,s=this.wtSettings.getSetting("preventOverflow");let o=0,i=!1;if(this.trimmingContainer===t&&(!s||s!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;i=u===c,o=this.getOverlayOffset(),_h(e,"0px",`${o}px`)}else o=this.getScrollPosition(),Ml(e);const r=this.adjustHeaderBordersPosition(o,i);return this.adjustElementsSize(),r}setScrollPosition(e){const t=this.domBindings.rootWindow;let s=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Mh(t),e),s=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,s=!0),s}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const s=this.wtSettings.getSetting("defaultRowHeight");let o=e,i=0;for(;o<t;){const r=this.wot.wtTable.getRowHeight(o);i+=r===void 0?s:r,o+=1}return i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:s}=this.domBindings,o=Yt(t),r=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=o),u=Math.min(u,e.wtRootElement.scrollWidth),r.width=`${u}px`}else r.width="";this.clone.wtTable.holder.style.width=r.width;let l=Et(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),r.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(dC.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:s,wtSettings:o}=this,r=(s.cloneSource?s.cloneSource:s).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(t){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(t=!1)}if(t&&r.offsetHeight!==r.clientHeight&&(l=Yt(this.domBindings.rootDocument)),t){const u=o.getSetting("fixedRowsBottom"),c=o.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=s.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(o.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ol(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let s=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const o=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),r=o-i;s=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),s>r&&(s=0)}return s}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Pe(s,"emptyColumns"):J(s,"emptyColumns");let i=!1;if(!t){const r=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==r,l=this.wtSettings.getSetting("columnHeaders");if((a||r===0)&&l.length>0){const u=Ae(s,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(J(s,"innerBorderTop"),i=!u):(Pe(s,"innerBorderTop"),i=u)}}return i}}function Ws(n,e,t){return e=TB(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TB(n){var e=MB(n,"string");return typeof e=="symbol"?e:String(e)}function MB(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class _B{constructor(e,t,s,o,i,r){Ws(this,"wot",null),Ws(this,"topOverlay",null),Ws(this,"bottomOverlay",null),Ws(this,"inlineStartOverlay",null),Ws(this,"topInlineStartCornerOverlay",null),Ws(this,"bottomInlineStartCornerOverlay",null),Ws(this,"browserLineHeight",void 0),Ws(this,"wtSettings",null),Ws(this,"resizeObserver",new ResizeObserver(c=>{Dh(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=o,this.domBindings=s,this.facadeGetter=t,this.wtTable=r;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Yt(a);const u=l.getComputedStyle(r.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?r.holder:il(r.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,s=e.getComputedStyle(t.body),o=parseInt(s.lineHeight,10),i=parseInt(s.fontSize,10)*1.2;this.browserLineHeight=o||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new EB(...e),this.bottomOverlay=new jW(...e),this.inlineStartOverlay=new gB(...e),this.topInlineStartCornerOverlay=new SB(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new WW(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:s}=this.topOverlay,{mainTableScrollableElement:o}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(s,"scroll",d=>this.onTableScroll(d),{passive:!0}),s!==o&&this.eventManager.addEventListener(o,"scroll",d=>this.onTableScroll(d),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,r=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),l={passive:r};(a||i||!kw())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){const{holder:f}=d.clone.wtTable;this.eventManager.addEventListener(f,"wheel",m=>this.onCloneWheel(m,a),l)}});let c;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),r||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,s=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(o!==t&&i!==t&&!e.target.contains(o)||s!==t&&i!==t&&!e.target.contains(s))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:s}=this.domBindings,o=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=e.target,a=i!==s&&r!==s&&!r.contains(i),l=o!==s&&r!==s&&!r.contains(o);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==s&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Yr(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,s=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(s+=s*this.browserLineHeight,t+=t*this.browserLineHeight);const o=this.scrollVertically(t),i=this.scrollHorizontally(s);return o||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,s=this.inlineStartOverlay.clone.wtTable.holder,[o,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==o||this.lastScrollX!==e.scrollX,this.verticalScrolling=s.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=o;const r=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;r&&(r.scrollLeft=o)}this.verticalScrolling&&(s.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:s}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=s)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=il(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,s=e.clientHeight,o=t!==this.spreaderLastSize.width||s!==this.spreaderLastSize.height;return o&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=s),o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:t}=this.wot,{wtTable:s}=this,o=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),r=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),l=s.hider.style;if(l.width=`${r+this.inlineStartOverlay.sumCellSizes(0,o)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=s.wtRootElement,{scrollHeight:d,scrollWidth:f}=s.holder;this.hasScrollbarRight=u<d,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&s.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&s.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let s=null;return T(t,o=>{o&&o.clone&&o.clone.wtTable.TABLE.contains(e)&&(s=o.clone)}),s}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(t,s=>{s&&(s.clone.wtTable.TABLE.className=e.className)})}}const OB=_B;function fy(n,e,t){return e=AB(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function AB(n){var e=IB(n,"string");return typeof e=="symbol"?e:String(e)}function IB(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class xB{constructor(e){fy(this,"settings",{}),fy(this,"defaults",Object.freeze(this.getDefaults())),We(this.defaults,(t,s)=>{if(e[s]!==void 0)this.settings[s]=e[s];else{if(t===void 0)throw new Error(`A required setting "${s}" was not provided`);this.settings[s]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,s)=>{const o=this.getSetting("data",e,t);Go(s,o??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?We(e,(s,o)=>{this.settings[o]=s}):this.settings[e]=t,this}getSetting(e,t,s,o,i){return typeof this.settings[e]=="function"?this.settings[e](t,s,o,i):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class mC extends zr{constructor(e,t,s,o){super(e,t,s,o,"master")}alignOverlaysWithTrimmingContainer(){const e=Oi(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const s=e.parentElement,o=Or(e,"height",t),i=Or(e,"overflow",t),r=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(s&&["auto","hidden","scroll"].includes(i)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?s.insertBefore(f,e.nextElementSibling):s.appendChild(f);const m=parseInt(uo(f,t).height,10);s.removeChild(f),m===0&&(c=0)}c=Math.min(c,l),r.height=o==="auto"?"auto":`${c}px`,u=Math.min(u,a),r.width=`${u}px`,r.overflow="",this.hasTableHeight=r.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=jo(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,s="master",i=e.getSetting("columnHeaders").length;if(i&&!t.hasOversizedColumnHeadersMarked[s]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<i;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);t.hasOversizedColumnHeadersMarked[s]=!0}}}ht(mC,HT);ht(mC,rC);const HB=mC;class PB{constructor(e,t,s,o,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=s,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=o,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let s=0;return t===this.domBindings.rootWindow?s=e.documentElement.clientHeight:s=Et(t)>0&&t.clientHeight>0?t.clientHeight:1/0,s}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:s}=this.domBindings,o=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,r=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-i:u.left,d=i-c;let f,m;if(a)return ut(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(d,i):f=Math.min(this.getContainerFillWidth(),d,i),o===s&&r>0&&this.sumColumnWidths(0,r-1)>f)return t.documentElement.clientWidth;if(o!==s&&(m=Or(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",s),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(f,o.clientWidth);const w=e.getSetting("stretchH");return w==="none"||!w?Math.max(f,ut(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let s=0,o=e;for(;o<t;)s+=this.wtTable.getColumnWidth(o),o+=1;return s}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const s=t.offsetWidth;return this.containerWidth=s,e.removeChild(t),s}getWorkspaceOffset(){return Lt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Et(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let s=0,o=t.length;s<o;s++)this.rowHeaderWidth+=e[s]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let s=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let o=0,i=t.length;o<i;o++)s?(this.rowHeaderWidth+=ut(s),s=s.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bi;const{wtSettings:t,wtTable:s}=this;let o,i,r;this.rowHeaderWidth=NaN,t.getSetting("renderAllRows")&&e===bi?o=1/0:o=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return l&&a>=0&&(r=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=r,o-=r),u&&this.dataAccessObject.bottomOverlay.clone&&(r=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),o-=r),s.holder.clientHeight===s.holder.offsetHeight?i=0:i=Yt(this.domBindings.rootDocument),new vT({viewportSize:o,scrollOffset:a,totalItems:t.getSetting("totalRows"),itemSizeFn:d=>s.getRowHeight(d),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,scrollbarHeight:i})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bi;const{wtSettings:t,wtTable:s}=this;let o=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const r=t.getSetting("fixedColumnsStart");if(r&&i>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,r);i+=a,o-=a}return s.holder.clientWidth!==s.holder.offsetWidth&&(o-=Yt(this.domBindings.rootDocument)),new Jw({viewportSize:o,scrollOffset:i,totalItems:t.getSetting("totalColumns"),itemSizeFn:a=>s.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingItemWidthFn:(a,l)=>t.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(t){const s=this.createRowsCalculator(an),o=this.createColumnsCalculator(an);this.areAllProposedVisibleRowsAlreadyRendered(s)&&this.areAllProposedVisibleColumnsAlreadyRendered(o)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(bi),this.columnsRenderCalculator=this.createColumnsCalculator(bi)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(an),this.columnsVisibleCalculator=this.createColumnsCalculator(an)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:t,endRow:s,isVisibleInTrimmingContainer:o}=e;if(t===null&&s===null)return!o;const{startRow:i,endRow:r}=this.rowsRenderCalculator;return t<i||t===i&&t>0?!1:!(s>r||s===r&&s<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:t,endColumn:s,isVisibleInTrimmingContainer:o}=e;if(t===null&&s===null)return!o;const{startColumn:i,endColumn:r}=this.columnsRenderCalculator;return t<i||t===i&&t>0?!1:!(s>r||s===r&&s<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){We(this.hasOversizedColumnHeadersMarked,(e,t,s)=>{s[t]=void 0})}}const DB=PB;class NB extends iC{constructor(e,t){super(e,new xB(t));const s=this.wtSettings.getSetting("facade",this);this.wtTable=new HB(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=new DB(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new dB(this.wtSettings.getSetting("selections")),this.wtEvent=new ET(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new OB(this,s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],s=[];We(e,(o,i)=>{this.wtSettings.getSetting(i).length&&s.push(o),t.push(o)}),Pe(this.wtTable.wtRootElement.parentNode,t),J(this.wtTable.wtRootElement.parentNode,s)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class pC{constructor(e){e instanceof iC?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const s=new pC(t);return()=>s},this._wot=new NB(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,s){return this._wot.createCellRange(e,t,s)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,s,o,i){return this._wot.scrollViewport(e,t,s,o,i)}scrollViewportHorizontally(e,t,s){return this._wot.scrollViewportHorizontally(e,t,s)}scrollViewportVertically(e,t,s){return this._wot.scrollViewportVertically(e,t,s)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,s,o,i){return this._wot.wtSettings.getSetting(e,t,s,o,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function gy(n){let{isShiftKey:e,isLeftClick:t,isRightClick:s,coords:o,selection:i,controller:r,cellCoordsFactory:a}=n;const l=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),c=i.isSelectedByRowHeader();if(e&&l)o.row>=0&&o.col>=0&&!r.cell?i.setRangeEnd(o):(u||c)&&o.row>=0&&o.col>=0&&!r.cell?i.setRangeEnd(a(o.row,o.col)):u&&o.row<0&&!r.column?i.setRangeEnd(a(l.to.row,o.col)):c&&o.col<0&&!r.row?i.setRangeEnd(a(o.row,l.to.col)):(!u&&!c&&o.col<0||u&&o.col<0)&&!r.row?i.selectRows(Math.max(l.from.row,0),o.row,o.col):(!u&&!c&&o.row<0||c&&o.row<0)&&!r.column&&i.selectColumns(Math.max(l.from.col,0),o.col,o.row);else{const d=!i.inInSelection(o),f=t||s&&d;o.row<0&&o.col>=0&&!r.column?f&&i.selectColumns(o.col,o.col,o.row):o.col<0&&o.row>=0&&!r.row?f&&i.selectRows(o.row,o.row,o.col):o.col>=0&&o.row>=0&&!r.cell?f&&i.setRangeStart(o):o.col<0&&o.row<0&&i.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function LB(n){let{isLeftClick:e,coords:t,selection:s,controller:o,cellCoordsFactory:i}=n;if(!e)return;const r=s.isSelectedByRowHeader(),a=s.isSelectedByColumnHeader(),l=s.tableProps.countCols(),u=s.tableProps.countRows();a&&!o.column?s.setRangeEnd(i(u-1,t.col)):r&&!o.row?s.setRangeEnd(i(t.row,l-1)):o.cell||s.setRangeEnd(t)}const kB=new Map([["mousedown",gy],["mouseover",LB],["touchstart",gy]]);function my(n,e){let{coords:t,selection:s,controller:o,cellCoordsFactory:i}=e;kB.get(n.type)({coords:t,selection:s,controller:o,cellCoordsFactory:i,isShiftKey:n.shiftKey,isLeftClick:xh(n)||n.type==="touchstart",isRightClick:Ko(n)})}const BT=new WeakMap,wC=Symbol("rootInstance");function FB(n){BT.set(n,!0)}function $B(n){return n===wC}function gc(n){return BT.has(n)}function py(n,e,t){VB(n,e),e.set(n,t)}function VB(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function So(n,e,t){return e=WB(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function WB(n){var e=BB(n,"string");return typeof e=="symbol"?e:String(e)}function BB(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function wy(n,e){var t=UT(n,e,"get");return UB(n,t)}function UB(n,e){return e.get?e.get.call(n):e.value}function Cy(n,e,t){var s=UT(n,e,"set");return YB(n,s,t),t}function UT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function YB(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const ai=new WeakMap;var lg=new WeakMap,ug=new WeakMap;class zB{constructor(e){So(this,"instance",void 0),So(this,"eventManager",void 0),So(this,"settings",void 0),So(this,"THEAD",void 0),So(this,"TBODY",void 0),So(this,"_wt",void 0),So(this,"activeWt",void 0),py(this,lg,{writable:!0,value:0}),py(this,ug,{writable:!0,value:0}),So(this,"postponedAdjustElementsSize",!1),this.instance=e,this.eventManager=new It(this.instance),this.settings=this.instance.getSettings(),ai.set(this,{selectionMouseDown:!1,mouseDown:void 0,table:void 0,lastWidth:0,lastHeight:0}),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.instance.isRenderSuspended()||(this.instance.runHooks("beforeRender",this.instance.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.instance.forceFullRender),this.instance.runHooks("afterRender",this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.instance.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){const s=this._wt.getCell(e,t);return s<0?null:s}scrollViewport(e,t,s,o,i){return this._wt.scrollViewport(e,t,s,o,i)}scrollViewportHorizontally(e,t,s){return this._wt.scrollViewportHorizontally(e,t,s)}scrollViewportVertically(e,t,s){return this._wt.scrollViewportVertically(e,t,s)}createElements(){const e=ai.get(this),{rootElement:t,rootDocument:s}=this.instance,o=t.getAttribute("style");o&&t.setAttribute("data-originalstyle",o),J(t,"handsontable"),e.table=s.createElement("TABLE"),J(e.table,"htCore"),this.instance.getSettings().tableClassName&&J(e.table,this.instance.getSettings().tableClassName),this.settings.ariaTags&&(Se(e.table,[rs()]),Se(t,[Gk(),bE(this.instance.countRows()),RE(this.instance.countCols()),iF()])),this.THEAD=s.createElement("THEAD"),e.table.appendChild(this.THEAD),this.TBODY=s.createElement("TBODY"),e.table.appendChild(this.TBODY),this.instance.table=e.table,this.instance.container.insertBefore(e.table,this.instance.container.firstChild)}registerEvents(){const e=ai.get(this),{rootElement:t,rootDocument:s,selection:o}=this.instance,i=s.documentElement;this.eventManager.addEventListener(t,"mousedown",r=>{if(e.selectionMouseDown=!0,!this.isTextSelectionAllowed(r.target)){const{rootWindow:a}=this.instance;ip(a),r.preventDefault(),a.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{e.selectionMouseDown=!1}),this.eventManager.addEventListener(t,"mousemove",r=>{e.selectionMouseDown&&!this.isTextSelectionAllowed(r.target)&&(this.settings.fragmentSelection&&ip(this.instance.rootWindow),r.preventDefault())}),this.eventManager.addEventListener(i,"keyup",r=>{o.isInProgress()&&!r.shiftKey&&o.finish()}),this.eventManager.addEventListener(i,"mouseup",r=>{o.isInProgress()&&xh(r)&&o.finish(),e.mouseDown=!1;const a=Oh(s.activeElement);a&&(a||!o.isSelected()&&!o.isSelectedByAnyHeader()&&!t.contains(r.target)&&!Ko(r))&&this.instance.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",r=>{o.isInProgress()&&Ko(r)&&(o.finish(),e.mouseDown=!1)}),this.eventManager.addEventListener(i,"touchend",()=>{o.isInProgress()&&o.finish(),e.mouseDown=!1}),this.eventManager.addEventListener(i,"mousedown",r=>{const a=r.target,l=r.x||r.clientX,u=r.y||r.clientY;let c=r.target;if(e.mouseDown||!t||!this.instance.view)return;const{holder:d}=this.instance.view._wt.wtTable;if(c===d){const m=Yt(s);if(s.elementFromPoint(l+m,u)!==d||s.elementFromPoint(l,u+m)!==d)return}else for(;c!==i;){if(c===null){if(r.isTargetWebComponent)break;return}if(c===t)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(a):this.settings.outsideClickDeselects)?this.instance.deselectCell():this.instance.destroyEditor(!1,!1)}),this.eventManager.addEventListener(e.table,"selectstart",r=>{this.settings.fragmentSelection||Vc(r.target)||r.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:s}=e;return this.instance._createCellCoords(...this.translateFromRenderableToVisualIndex(t,s))}translateFromRenderableToVisualIndex(e,t){let s=e>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(e):e,o=t>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(t):t;return s===null&&(s=e),o===null&&(o=t),[s,o]}countRenderableIndexes(e,t){const s=Math.min(e.getNotTrimmedIndexesLength(),t),o=e.getNearestNotHiddenIndex(s-1,-1);return o===null?0:e.getRenderableFromVisualIndex(o)+1}countRenderableColumns(){return this.countRenderableIndexes(this.instance.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.instance.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.instance.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,s,o){if(isNaN(e)||e<0)return 0;const i=s.getNearestNotHiddenIndex(e,t),r=s.getRenderableFromVisualIndex(i);if(!Number.isInteger(r))return 0;let a=0;return t<0?a=r+1:t>0&&(a=o-r),a}countNotHiddenFixedColumnsStart(){const e=this.instance.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.instance.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.instance.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let s=0;for(let o=e;o<=t;o++)this.instance.columnIndexMapper.getRenderableFromVisualIndex(o)!==null&&(s+=1);return s}countRenderableRowsInRange(e,t){let s=0;for(let o=e;o<=t;o++)this.instance.rowIndexMapper.getRenderableFromVisualIndex(o)!==null&&(s+=1);return s}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.instance.countRenderedRows()>e&&this.instance.countRenderedCols()>t}initializeWalkontable(){const e=ai.get(this),t={ariaTags:this.settings.ariaTags,rtlMode:this.instance.isRtl(),externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:e.table,isDataViewInstance:()=>gc(this.instance),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(r,a)=>this.instance.getDataAtCell(...this.translateFromRenderableToVisualIndex(r,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const r=[];return this.instance.hasRowHeaders()&&r.push((a,l)=>{const u=a>=0?this.instance.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(u,l)}),this.instance.runHooks("afterGetRowHeaderRenderers",r),Cy(this,ug,r.length),r},columnHeaders:()=>{const r=[];return this.instance.hasColHeaders()&&r.push((a,l)=>{const u=a>=0?this.instance.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(u,l)}),this.instance.runHooks("afterGetColumnHeaderRenderers",r),Cy(this,lg,r.length),r},columnWidth:r=>{const a=this.instance.columnIndexMapper.getVisualFromRenderableIndex(r);return this.instance.getColWidth(a===null?r:a)},rowHeight:r=>{const a=this.instance.rowIndexMapper.getVisualFromRenderableIndex(r);return this.instance.getRowHeight(a===null?r:a)},cellRenderer:(r,a,l)=>{const[u,c]=this.translateFromRenderableToVisualIndex(r,a),d=this.instance.runHooks("modifyGetCellCoords",u,c);let f=u,m=c;Array.isArray(d)&&([f,m]=d);const w=this.instance.getCellMeta(f,m),C=this.instance.colToProp(m);let b=this.instance.getDataAtRowProp(f,C);this.instance.hasHook("beforeValueRender")&&(b=this.instance.runHooks("beforeValueRender",b,w)),this.instance.runHooks("beforeRenderer",l,u,c,C,b,w),this.instance.getCellRenderer(w)(this.instance,l,u,c,C,b,w),this.instance.runHooks("afterRenderer",l,u,c,C,b,w)},selections:this.instance.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.instance&&!this.instance.isDestroyed&&this.instance.refreshDimensions()},onContainerElementResize:()=>{this.instance&&!this.instance.isDestroyed&&jo(this.instance.rootElement)&&this.instance.refreshDimensions()},onCellMouseDown:(r,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.instance.listen(),this.activeWt=u,e.mouseDown=!0,this.instance.runHooks("beforeOnCellMouseDown",r,c,l,d),!Do(r)&&(my(r,{coords:c,selection:this.instance.selection,controller:d,cellCoordsFactory:(f,m)=>this.instance._createCellCoords(f,m)}),this.instance.runHooks("afterOnCellMouseDown",r,c,l),this.activeWt=this._wt)},onCellContextMenu:(r,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,e.mouseDown=!1,this.instance.selection.isInProgress()&&this.instance.selection.finish(),this.instance.runHooks("beforeOnCellContextMenu",r,c,l),!Do(r)&&(this.instance.runHooks("afterOnCellContextMenu",r,c,l),this.activeWt=this._wt)},onCellMouseOut:(r,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.instance.runHooks("beforeOnCellMouseOut",r,c,l),!Do(r)&&(this.instance.runHooks("afterOnCellMouseOut",r,c,l),this.activeWt=this._wt)},onCellMouseOver:(r,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a),d={row:!1,column:!1,cell:!1};this.activeWt=u,this.instance.runHooks("beforeOnCellMouseOver",r,c,l,d),!Do(r)&&(e.mouseDown&&my(r,{coords:c,selection:this.instance.selection,controller:d,cellCoordsFactory:(f,m)=>this.instance._createCellCoords(f,m)}),this.instance.runHooks("afterOnCellMouseOver",r,c,l),this.activeWt=this._wt)},onCellMouseUp:(r,a,l,u)=>{const c=this.translateFromRenderableToVisualCoords(a);this.activeWt=u,this.instance.runHooks("beforeOnCellMouseUp",r,c,l),!(Do(r)||this.instance.isDestroyed)&&(this.instance.runHooks("afterOnCellMouseUp",r,c,l),this.activeWt=this._wt)},onCellCornerMouseDown:r=>{r.preventDefault(),this.instance.runHooks("afterOnCellCornerMouseDown",r)},onCellCornerDblClick:r=>{r.preventDefault(),this.instance.runHooks("afterOnCellCornerDblClick",r)},beforeDraw:(r,a)=>this.beforeRender(r,a),onDraw:r=>this.afterRender(r),onBeforeViewportScrollVertically:r=>{const a=this.instance.rowIndexMapper,l=r<0;let u=r;return!l&&(u=a.getVisualFromRenderableIndex(r),u===null)?r:(u=this.instance.runHooks("beforeViewportScrollVertically",u),this.instance.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onBeforeViewportScrollHorizontally:r=>{const a=this.instance.columnIndexMapper,l=r<0;let u=r;return!l&&(u=a.getVisualFromRenderableIndex(r),u===null)?r:(u=this.instance.runHooks("beforeViewportScrollHorizontally",u),this.instance.runHooks("beforeViewportScroll"),l?u:a.getRenderableFromVisualIndex(u))},onScrollVertically:()=>{this.instance.runHooks("afterScrollVertically"),this.instance.runHooks("afterScroll")},onScrollHorizontally:()=>{this.instance.runHooks("afterScrollHorizontally"),this.instance.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.instance.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(r,a,l)=>{const u=this.instance.rowIndexMapper,c=r<0;let d=r;c||(d=u.getVisualFromRenderableIndex(r));const f=this.instance.runHooks("beforeHighlightingRowHeader",d,a,l);return c?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onBeforeHighlightingColumnHeader:(r,a,l)=>{const u=this.instance.columnIndexMapper,c=r<0;let d=r;c||(d=u.getVisualFromRenderableIndex(r));const f=this.instance.runHooks("beforeHighlightingColumnHeader",d,a,l);return c?f:u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f,1))},onAfterDrawSelection:(r,a,l)=>{let u;const[c,d]=this.translateFromRenderableToVisualIndex(r,a),f=this.instance.selection.getSelectedRange();if(f.size()>0){const w=f.peekByIndex(l??0);u=[w.from.row,w.from.col,w.to.row,w.to.col]}return this.instance.runHooks("afterDrawSelection",c,d,u,l)},onBeforeDrawBorders:(r,a)=>{const[l,u,c,d]=r,f=[this.instance.rowIndexMapper.getVisualFromRenderableIndex(l),this.instance.columnIndexMapper.getVisualFromRenderableIndex(u),this.instance.rowIndexMapper.getVisualFromRenderableIndex(c),this.instance.columnIndexMapper.getVisualFromRenderableIndex(d)];return this.instance.runHooks("beforeDrawBorders",f,a)},onBeforeTouchScroll:()=>this.instance.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.instance.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(r,a)=>{const l=this.instance.columnIndexMapper.getVisualFromRenderableIndex(a);return this.instance.runHooks("beforeStretchingColumnWidth",r,l)},onModifyRowHeaderWidth:r=>this.instance.runHooks("modifyRowHeaderWidth",r),onModifyGetCellCoords:(r,a,l)=>{const u=this.instance.rowIndexMapper,c=this.instance.columnIndexMapper,d=a>=0?c.getVisualFromRenderableIndex(a):a,f=r>=0?u.getVisualFromRenderableIndex(r):r,m=this.instance.runHooks("modifyGetCellCoords",f,d,l);if(Array.isArray(m)){const[w,C,b,y]=m;return[w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,C>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(C,1)):C,b>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(b,-1)):b,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,-1)):y]}},viewportRowCalculatorOverride:r=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const l=this.countRenderableRows(),u=r.startRow,c=r.endRow;if(typeof a=="number")r.startRow=Math.max(u-a,0),r.endRow=Math.min(c+a,l-1);else if(a==="auto"){const d=Math.ceil(c/l*12);r.startRow=Math.max(u-d,0),r.endRow=Math.min(c+d,l-1)}}this.instance.runHooks("afterViewportRowCalculatorOverride",r)},viewportColumnCalculatorOverride:r=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const l=this.countRenderableColumns(),u=r.startColumn,c=r.endColumn;if(typeof a=="number"&&(r.startColumn=Math.max(u-a,0),r.endColumn=Math.min(c+a,l-1)),a==="auto"){const d=Math.ceil(c/l*6);r.startColumn=Math.max(u-d,0),r.endColumn=Math.min(c+d,l-1)}}this.instance.runHooks("afterViewportColumnCalculatorOverride",r)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const r=this.instance.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||r}};this.instance.runHooks("beforeInitWalkontable",t),this._wt=new pC(t),this.activeWt=this._wt;const s=this._wt.wtTable.spreader,{width:o,height:i}=this.instance.rootElement.getBoundingClientRect();this.setLastSize(o,i),this.eventManager.addEventListener(s,"mousedown",r=>{r.target===s&&r.which===3&&r.stopPropagation()}),this.eventManager.addEventListener(s,"contextmenu",r=>{r.target===s&&r.which===3&&r.stopPropagation()}),this.eventManager.addEventListener(this.instance.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.instance.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Vc(e))return!0;const t=Vo(e,this.instance.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return ai.get(this).mouseDown}isSelectedOnlyCell(){var e,t;return(e=(t=this.instance.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.instance.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.instance.runHooks("beforeViewRender",this.instance.forceFullRender,t)}afterRender(e){e&&this.instance.runHooks("afterViewRender",this.instance.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const s=t.firstChild;if(!Ae(s,"relative")){hs(t),this.appendRowHeader(e,t);return}this.updateCellHeader(s.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{const{rootDocument:s,getRowHeader:o}=this.instance,i=s.createElement("div"),r=s.createElement("span");i.className="relative",r.className="rowHeader",this.updateCellHeader(r,e,o),i.appendChild(r),t.appendChild(i)}this.instance.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.instance.getColHeader,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t.firstChild){const i=t.firstChild;Ae(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,s,o):(hs(t),this.appendColHeader(e,t,s,o))}else{const{rootDocument:i}=this.instance,r=i.createElement("div"),a=i.createElement("span");r.className="relative",a.className="colHeader",this.updateCellHeader(a,e,s,o),r.appendChild(a),t.appendChild(r)}this.instance.runHooks("afterGetColHeader",e,t,o)}updateCellHeader(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=t;const r=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ae(e,"colHeader")?i=r.wtTable.columnFilter.sourceToRendered(t):Ae(e,"rowHeader")&&(i=r.wtTable.rowFilter.sourceToRendered(t))),i>-1?Fi(e,s(t,o)):(Go(e,String.fromCharCode(160)),J(e,"cornerHeader"))}maximumVisibleElementWidth(e){const s=this._wt.wtViewport.getWorkspaceWidth()-e;return s>0?s:0}maximumVisibleElementHeight(e){const s=this._wt.wtViewport.getWorkspaceHeight()-e;return s>0?s:0}setLastSize(e,t){const s=ai.get(this);[s.lastWidth,s.lastHeight]=[e,t]}getLastSize(){const e=ai.get(this);return{width:e.lastWidth,height:e.lastHeight}}getFirstFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.instance.rowIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.instance.columnIndexMapper.getVisualFromRenderableIndex(this.instance.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return wy(this,lg)}getRowHeadersCount(){return wy(this,ug)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const GB=zB,YT="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Cp=YT.length;function Nh(n){let e=n+1,t="",s;for(;e>0;)s=(e-1)%Cp,t=String.fromCharCode(65+s)+t,e=parseInt((e-s)/Cp,10);return t}function jB(n){let e=0;if(n)for(let t=0,s=n.length-1;t<n.length;t+=1,s-=1)e+=Cp**s*(YT.indexOf(n[t])+1);return e-=1,e}function KB(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let s,o;for(s=0;s<n;s++){const i=[];for(o=0;o<e;o++)i.push(Nh(o)+(s+1));t.push(i)}return t}function XB(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const t=[];let s,o;for(s=0;s<n;s++){const i={};for(o=0;o<e;o++)i[`prop${o}`]=Nh(o)+(s+1);t.push(i)}return t}function qB(n,e){const t=[];let s;for(let o=0;o<n;o++){s=[];for(let i=0;i<e;i++)s.push("");t.push(s)}return t}function CC(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=n;const s=[];return(!Array.isArray(n)||!Array.isArray(n[0]))&&(t=[n]),t.forEach((o,i)=>{Array.isArray(o)?o.forEach((r,a)=>{s.push([i+e,a,r])}):Object.keys(o).forEach(r=>{s.push([i+e,r,o[r]])})}),s}function SC(n){let e=0;return Array.isArray(n)&&(n[0]&&Array.isArray(n[0])?e=n[0].length:n[0]&&De(n[0])&&(e=Ih(n[0]))),e}function zT(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>Array.isArray(e)))}function GT(n){return!!(Array.isArray(n)&&n.length&&n.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const ZB=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:SC,createEmptySpreadsheetData:qB,createSpreadsheetData:KB,createSpreadsheetObjectData:XB,dataRowToChangesArray:CC,isArrayOfArrays:zT,isArrayOfObjects:GT,spreadsheetColumnIndex:jB,spreadsheetColumnLabel:Nh},Symbol.toStringTag,{value:"Module"}));class QB{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=()=>{},this.propToCol=()=>{}}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return T(this.data,(s,o)=>{const i=this.getAtCell(o,e);t.push(i)}),t}getAtRow(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=t===void 0&&s===void 0;let r=null,a=null;if(r=this.modifyRowData(e),Array.isArray(r))a=[],i?r.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,r)}):me(t,s,l=>{a[l-t]=this.getAtPhysicalCell(e,l,r)});else if(De(r)||dt(r))if(o?a=[]:a={},!i||o){const u=this.countFirstRowKeys()-1;me(0,u,c=>{const d=this.colToProp(c);if(c>=(t||0)&&c<=(s||u)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,r);o?a.push(f):cc(a,d,f)}})}else We(r,(l,u)=>{cc(a,u,this.getAtPhysicalCell(e,u,r))});return a}setAtCell(e,t,s){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const o=Ii(s);this.hot.runHooks("modifySourceData",e,t,o,"set"),o.isTouched()&&(s=o.value)}Number.isInteger(t)?this.data[e][t]=s:cc(this.data[e],t,s)}}getAtPhysicalCell(e,t,s){let o=null;if(s&&(typeof t=="string"?o=UE(s,t):typeof t=="function"?o=t(s):o=s[t]),this.hot.hasHook("modifySourceData")){const i=Ii(o);this.hot.runHooks("modifySourceData",e,t,i,"get"),i.isTouched()&&(o=i.value)}return o}getAtCell(e,t){const s=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),s)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,i=null,r=null,a=null,l=null;e===null||t===null?(o=!0,i=0,a=this.countRows()-1):(i=Math.min(e.row,t.row),r=Math.min(e.col,t.col),a=Math.max(e.row,t.row),l=Math.max(e.col,t.col));const u=[];return me(i,a,c=>{u.push(o?this.getAtRow(c,void 0,void 0,s):this.getAtRow(c,r,l,s))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return SC(this.data)}destroy(){this.data=null,this.hot=null}}const JB=QB;class $i{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.indexedValues=[],this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length?(this.indexedValues[e]=t,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,dt(this.initValueOrFn)?me(e-1,t=>this.indexedValues.push(this.initValueOrFn(t))):me(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}ht($i,In);function vC(n,e,t,s){const o=t.length?t[0]:void 0;return[...n.slice(0,o),...t.map((i,r)=>dt(s)?s(i,r):s),...o===void 0?[]:n.slice(o)]}function yC(n,e){return kn(n,(t,s)=>e.includes(s)===!1)}class ei extends $i{insert(e,t){this.indexedValues=vC(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=yC(this.indexedValues,e),super.remove(e)}}class Lh extends ei{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Pt(this.getValues(),(e,t,s)=>(t&&e.push(s),e),[])}}function bC(n,e,t){return[...n.slice(0,e),...t,...n.slice(e)]}function al(n,e){return kn(n,t=>e.includes(t)===!1)}function RC(n,e){return Ve(n,t=>t-e.filter(s=>s<t).length)}function EC(n,e){const t=e[0],s=e.length;return Ve(n,o=>o>=t?o+s:o)}function e2(n,e,t){return e=t2(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function t2(n){var e=n2(n,"string");return typeof e=="symbol"?e:String(e)}function n2(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class kh extends $i{constructor(){super(...arguments),e2(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=t,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(s,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=al(this.orderOfIndexes,[e]),dt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=vC(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=EC(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=yC(this.indexedValues,e),this.orderOfIndexes=al(this.orderOfIndexes,e),this.orderOfIndexes=RC(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Hl extends ei{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Pt(this.getValues(),(e,t,s)=>(t&&e.push(s),e),[])}}const Sy=new Map([["indexesSequence",{getListWithInsertedItems:bC,getListWithRemovedItems:al}],["physicallyIndexed",{getListWithInsertedItems:vC,getListWithRemovedItems:yC}]]),jT=n=>{if(Sy.has(n)===!1)throw new Error(`Alter strategy with ID '${n}' does not exist.`);return Sy.get(n)};class KT extends $i{constructor(){super(e=>e)}insert(e,t){const s=EC(this.indexedValues,t);this.indexedValues=bC(s,e,t),super.insert(e,t)}remove(e){const t=al(this.indexedValues,e);this.indexedValues=RC(t,e),super.remove(e)}}const vy=new Map([["hiding",Lh],["index",$i],["linkedPhysicalIndexToValue",kh],["physicalIndexToValue",ei],["trimming",Hl]]);function s2(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!vy.has(n))throw new Error(`The provided map type ("${n}") does not exist.`);return new(vy.get(n))(e)}let Sp=0;class TC{constructor(){this.collection=new Map}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),Sp+=1)}unregister(e){const t=this.collection.get(e);oe(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Sp-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return ft(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(s=>{s.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}ht(TC,In);function o2(){return Sp}class yy extends TC{constructor(e,t){super(),this.mergedValuesCache=[],this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=Ve(this.get(),i=>i.getValues()),s=[],o=oe(t[0])&&t[0].length||0;for(let i=0;i<o;i+=1){const r=[];for(let a=0;a<this.getLength();a+=1)r.push(t[a][i]);s.push(r)}return Ve(s,this.aggregationFunction)}getMergedValueAtIndex(e,t){const s=this.getMergedValues(t)[e];return oe(s)?s:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function i2(n,e,t){r2(n,e),e.set(n,t)}function r2(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a2(n,e,t){var s=XT(n,e,"set");return l2(n,s,t),t}function l2(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function u2(n,e){var t=XT(n,e,"get");return c2(n,t)}function XT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function c2(n,e){return e.get?e.get.call(n):e.value}var cg=new WeakMap;class qT{constructor(){i2(this,cg,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(u2(this,cg)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){a2(this,cg,e)}}ht(qT,In);function by(n,e){const t=[];let s=0,o=0;for(;s<n.length&&o<e.length;s++,o++)n[s]!==e[o]&&t.push({op:"replace",index:o,oldValue:n[s],newValue:e[o]});for(;s<e.length;s++)t.push({op:"insert",index:s,oldValue:void 0,newValue:e[s]});for(;o<n.length;o++)t.push({op:"remove",index:o,oldValue:n[o],newValue:void 0});return t}function na(n,e,t){h2(n,e),e.set(n,t)}function h2(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vn(n,e){var t=ZT(n,e,"get");return d2(n,t)}function d2(n,e){return e.get?e.get.call(n):e.value}function cu(n,e,t){var s=ZT(n,e,"set");return f2(n,s,t),t}function ZT(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function f2(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var hu=new WeakMap,sa=new WeakMap,du=new WeakMap,fu=new WeakMap,gu=new WeakMap;class g2{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};na(this,hu,{writable:!0,value:new Set}),na(this,sa,{writable:!0,value:[]}),na(this,du,{writable:!0,value:[]}),na(this,fu,{writable:!0,value:!1}),na(this,gu,{writable:!0,value:!1}),cu(this,gu,e??!1)}createObserver(){const e=new qT;return Vn(this,hu).add(e),e.addLocalHook("unsubscribe",()=>{Vn(this,hu).delete(e)}),e._writeInitialChanges(by(Vn(this,sa),Vn(this,du))),e}emit(e){let t=Vn(this,du);(!Vn(this,fu)||Vn(this,sa).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(Vn(this,gu)):cu(this,sa,new Array(e.length).fill(Vn(this,gu))),Vn(this,fu)||(cu(this,fu,!0),t=Vn(this,sa)));const s=by(t,e);Vn(this,hu).forEach(o=>o._write(s)),cu(this,du,e)}}class vp{constructor(){this.indexesSequence=new KT,this.trimmingMapsCollection=new yy(e=>e.some(t=>t===!0),!1),this.hidingMapsCollection=new yy(e=>e.some(t=>t===!0),!1),this.variousMapsCollection=new TC,this.hidingChangesObservable=new g2({initialIndexValue:!1}),this.notTrimmedIndexesCache=[],this.notHiddenIndexesCache=[],this.isBatched=!1,this.indexesSequenceChanged=!1,this.indexesChangeSource=void 0,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1,this.renderablePhysicalIndexesCache=[],this.fromPhysicalToVisualIndexesCache=new Map,this.fromVisualToRenderableIndexesCache=new Map,this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,s){return this.registerMap(e,s2(t,s))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Hl?this.trimmingMapsCollection.register(e,t):t instanceof Lh?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const s=this.getNumberOfIndexes();return s>0&&t.init(s),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return oe(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return oe(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return oe(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return oe(t)?t:null}getNearestNotHiddenIndex(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let r=-1;return t>0?r=i.findIndex(a=>a>e):r=i.reverse().findIndex(a=>a<e),r===-1?s?this.getNearestNotHiddenIndex(e,-t,!1):null:i[r]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const s=[...Array(this.getNumberOfIndexes()-e).keys()].map(o=>o+e);this.removeIndexes(s)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(s=>this.isTrimmed(s)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(s=>this.isHidden(s)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(s=>this.isHidden(s)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const s=Ve(e,u=>this.getPhysicalFromVisualIndex(u)),o=this.getNotTrimmedIndexesLength(),i=e.length,r=al(this.getIndexesSequence(),s),a=r.filter(u=>this.isTrimmed(u)===!1);let l=r.indexOf(a[a.length-1])+1;if(t+i<o){const u=a[t];l=r.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(bC(r,l,s)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const s=this.getNotTrimmedIndexes()[e],o=oe(s)?s:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(s)?this.getIndexesSequence().indexOf(s):this.getNumberOfIndexes(),r=Ve(new Array(t).fill(o),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,r),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,r),this.hidingMapsCollection.insertToEvery(i,r),this.variousMapsCollection.insertToEvery(i,r),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const s=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(s,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const s=this.getPhysicalFromRenderableIndex(t),o=this.getVisualFromPhysicalIndex(s);this.fromVisualToRenderableIndexesCache.set(o,t)}}}ht(vp,In);function m2(n,e){return We(e,(t,s)=>{ft(n[s])&&(n[s]=t)}),n}function QT(n){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(n);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:n}function JT(n){oe(n)&&Bw(Qe`Language with code "${n}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function p2(n,e){return Array.isArray(n)&&Number.isInteger(e)?n[e]:n}const{register:w2,getValues:C2}=fs("phraseFormatters");function S2(n,e){w2(n,e)}function v2(){return C2()}S2("pluralize",p2);const eM="ContextMenu:items",Le=eM,Fh=`${Le}.noItems`,$h=`${Le}.insertRowAbove`,Vh=`${Le}.insertRowBelow`,Wh=`${Le}.insertColumnOnTheLeft`,Bh=`${Le}.insertColumnOnTheRight`,Uh=`${Le}.removeRow`,Yh=`${Le}.removeColumn`,zh=`${Le}.undo`,Gh=`${Le}.redo`,jh=`${Le}.readOnly`,Kh=`${Le}.clearColumn`,Xh=`${Le}.copy`,MC=`${Le}.copyWithHeaders`,_C=`${Le}.copyWithGroupHeaders`,OC=`${Le}.copyHeadersOnly`,qh=`${Le}.cut`,Zh=`${Le}.freezeColumn`,Qh=`${Le}.unfreezeColumn`,Jh=`${Le}.mergeCells`,ed=`${Le}.unmergeCells`,td=`${Le}.addComment`,nd=`${Le}.editComment`,sd=`${Le}.removeComment`,od=`${Le}.readOnlyComment`,id=`${Le}.align`,rd=`${Le}.align.left`,ad=`${Le}.align.center`,ld=`${Le}.align.right`,ud=`${Le}.align.justify`,cd=`${Le}.align.top`,hd=`${Le}.align.middle`,dd=`${Le}.align.bottom`,fd=`${Le}.borders`,gd=`${Le}.borders.top`,md=`${Le}.borders.right`,pd=`${Le}.borders.bottom`,wd=`${Le}.borders.left`,Cd=`${Le}.borders.remove`,Sd=`${Le}.nestedHeaders.insertChildRow`,vd=`${Le}.nestedHeaders.detachFromParent`,yd=`${Le}.hideColumn`,bd=`${Le}.showColumn`,Rd=`${Le}.hideRow`,Ed=`${Le}.showRow`,yn="Filters:",xt=`${yn}conditions`,Pl=`${xt}.none`,Td=`${xt}.isEmpty`,Md=`${xt}.isNotEmpty`,_d=`${xt}.isEqualTo`,Od=`${xt}.isNotEqualTo`,Ad=`${xt}.beginsWith`,Id=`${xt}.endsWith`,xd=`${xt}.contains`,Hd=`${xt}.doesNotContain`,y2=`${xt}.byValue`,Pd=`${xt}.greaterThan`,Dd=`${xt}.greaterThanOrEqualTo`,Nd=`${xt}.lessThan`,Ld=`${xt}.lessThanOrEqualTo`,kd=`${xt}.isBetween`,Fd=`${xt}.isNotBetween`,$d=`${xt}.after`,Vd=`${xt}.before`,Wd=`${xt}.today`,Bd=`${xt}.tomorrow`,Ud=`${xt}.yesterday`,Yd=`${yn}labels.filterByCondition`,zd=`${yn}labels.filterByValue`,Gd=`${yn}labels.conjunction`,Dl=`${yn}labels.disjunction`,ll=`${yn}values.blankCells`,jd=`${yn}buttons.selectAll`,Kd=`${yn}buttons.clear`,Xd=`${yn}buttons.ok`,qd=`${yn}buttons.cancel`,Zd=`${yn}buttons.placeholder.search`,Qd=`${yn}buttons.placeholder.value`,Jd=`${yn}buttons.placeholder.secondValue`,AC="CheckboxRenderer:",IC=`${AC}checked`,xC=`${AC}unchecked`,ti="ColumnHeader:",HC=`${ti}description.expandColumn`,PC=`${ti}description.collapseColumn`,DC=`${ti}description.sortRows`,NC=`${ti}label.multiColumnSortOrder`,LC=`${ti}label.openMenu`,kC=`${ti}label.beforeHiddenColumn`,FC=`${ti}label.afterHiddenColumn`,Nl="RowHeader:",$C=`${Nl}description.expandRow`,VC=`${Nl}description.collapseRow`,WC=`${Nl}label.beforeHiddenRow`,BC=`${Nl}label.afterHiddenRow`,b2=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:IC,CHECKBOX_RENDERER_NAMESPACE:AC,CHECKBOX_UNCHECKED:xC,COLUMN_HEADER_DESCRIPTION_COLLAPSE_COLUMN:PC,COLUMN_HEADER_DESCRIPTION_EXPAND_COLUMN:HC,COLUMN_HEADER_DESCRIPTION_SORT_ROWS:DC,COLUMN_HEADER_LABEL_AFTER_HIDDEN_COLUMN:FC,COLUMN_HEADER_LABEL_BEFORE_HIDDEN_COLUMN:kC,COLUMN_HEADER_LABEL_MULTI_COLUMN_SORT_ORDER:NC,COLUMN_HEADER_LABEL_OPEN_MENU:LC,COLUMN_HEADER_NAMESPACE:ti,CONTEXTMENU_ITEMS_ADD_COMMENT:td,CONTEXTMENU_ITEMS_ALIGNMENT:id,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:dd,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:ad,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:ud,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:rd,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:hd,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:ld,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:cd,CONTEXTMENU_ITEMS_BORDERS:fd,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:pd,CONTEXTMENU_ITEMS_BORDERS_LEFT:wd,CONTEXTMENU_ITEMS_BORDERS_RIGHT:md,CONTEXTMENU_ITEMS_BORDERS_TOP:gd,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Kh,CONTEXTMENU_ITEMS_COPY:Xh,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:OC,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:_C,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:MC,CONTEXTMENU_ITEMS_CUT:qh,CONTEXTMENU_ITEMS_EDIT_COMMENT:nd,CONTEXTMENU_ITEMS_FREEZE_COLUMN:Zh,CONTEXTMENU_ITEMS_HIDE_COLUMN:yd,CONTEXTMENU_ITEMS_HIDE_ROW:Rd,CONTEXTMENU_ITEMS_INSERT_LEFT:Wh,CONTEXTMENU_ITEMS_INSERT_RIGHT:Bh,CONTEXTMENU_ITEMS_MERGE_CELLS:Jh,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:vd,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Sd,CONTEXTMENU_ITEMS_NO_ITEMS:Fh,CONTEXTMENU_ITEMS_READ_ONLY:jh,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:od,CONTEXTMENU_ITEMS_REDO:Gh,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Cd,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Yh,CONTEXTMENU_ITEMS_REMOVE_COMMENT:sd,CONTEXTMENU_ITEMS_REMOVE_ROW:Uh,CONTEXTMENU_ITEMS_ROW_ABOVE:$h,CONTEXTMENU_ITEMS_ROW_BELOW:Vh,CONTEXTMENU_ITEMS_SHOW_COLUMN:bd,CONTEXTMENU_ITEMS_SHOW_ROW:Ed,CONTEXTMENU_ITEMS_UNDO:zh,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Qh,CONTEXTMENU_ITEMS_UNMERGE_CELLS:ed,CONTEXT_MENU_ITEMS_NAMESPACE:eM,FILTERS_BUTTONS_CANCEL:qd,FILTERS_BUTTONS_CLEAR:Kd,FILTERS_BUTTONS_OK:Xd,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:Zd,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Jd,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Qd,FILTERS_BUTTONS_SELECT_ALL:jd,FILTERS_CONDITIONS_AFTER:$d,FILTERS_CONDITIONS_BEFORE:Vd,FILTERS_CONDITIONS_BEGINS_WITH:Ad,FILTERS_CONDITIONS_BETWEEN:kd,FILTERS_CONDITIONS_BY_VALUE:y2,FILTERS_CONDITIONS_CONTAINS:xd,FILTERS_CONDITIONS_EMPTY:Td,FILTERS_CONDITIONS_ENDS_WITH:Id,FILTERS_CONDITIONS_EQUAL:_d,FILTERS_CONDITIONS_GREATER_THAN:Pd,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Dd,FILTERS_CONDITIONS_LESS_THAN:Nd,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:Ld,FILTERS_CONDITIONS_NAMESPACE:xt,FILTERS_CONDITIONS_NONE:Pl,FILTERS_CONDITIONS_NOT_BETWEEN:Fd,FILTERS_CONDITIONS_NOT_CONTAIN:Hd,FILTERS_CONDITIONS_NOT_EMPTY:Md,FILTERS_CONDITIONS_NOT_EQUAL:Od,FILTERS_CONDITIONS_TODAY:Wd,FILTERS_CONDITIONS_TOMORROW:Bd,FILTERS_CONDITIONS_YESTERDAY:Ud,FILTERS_DIVS_FILTER_BY_CONDITION:Yd,FILTERS_DIVS_FILTER_BY_VALUE:zd,FILTERS_LABELS_CONJUNCTION:Gd,FILTERS_LABELS_DISJUNCTION:Dl,FILTERS_NAMESPACE:yn,FILTERS_VALUES_BLANK_CELLS:ll,ROW_HEADER_DESCRIPTION_COLLAPSE_ROW:VC,ROW_HEADER_DESCRIPTION_EXPAND_ROW:$C,ROW_HEADER_LABEL_AFTER_HIDDEN_ROW:BC,ROW_HEADER_LABEL_BEFORE_HIDDEN_ROW:WC,ROW_HEADER_NAMESPACE:Nl},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const R2={languageCode:"en-US",[Fh]:"No available options",[$h]:"Insert row above",[Vh]:"Insert row below",[Wh]:"Insert column left",[Bh]:"Insert column right",[Uh]:["Remove row","Remove rows"],[Yh]:["Remove column","Remove columns"],[zh]:"Undo",[Gh]:"Redo",[jh]:"Read only",[Kh]:"Clear column",[id]:"Alignment",[rd]:"Left",[ad]:"Center",[ld]:"Right",[ud]:"Justify",[cd]:"Top",[hd]:"Middle",[dd]:"Bottom",[Zh]:"Freeze column",[Qh]:"Unfreeze column",[fd]:"Borders",[gd]:"Top",[md]:"Right",[pd]:"Bottom",[wd]:"Left",[Cd]:"Remove border(s)",[td]:"Add comment",[nd]:"Edit comment",[sd]:"Delete comment",[od]:"Read-only comment",[Jh]:"Merge cells",[ed]:"Unmerge cells",[Xh]:"Copy",[MC]:["Copy with header","Copy with headers"],[_C]:["Copy with group header","Copy with group headers"],[OC]:["Copy header only","Copy headers only"],[qh]:"Cut",[Sd]:"Insert child row",[vd]:"Detach from parent",[yd]:["Hide column","Hide columns"],[bd]:["Show column","Show columns"],[Rd]:["Hide row","Hide rows"],[Ed]:["Show row","Show rows"],[Pl]:"None",[Td]:"Is empty",[Md]:"Is not empty",[_d]:"Is equal to",[Od]:"Is not equal to",[Ad]:"Begins with",[Id]:"Ends with",[xd]:"Contains",[Hd]:"Does not contain",[Pd]:"Greater than",[Dd]:"Greater than or equal to",[Nd]:"Less than",[Ld]:"Less than or equal to",[kd]:"Is between",[Fd]:"Is not between",[$d]:"After",[Vd]:"Before",[Wd]:"Today",[Bd]:"Tomorrow",[Ud]:"Yesterday",[ll]:"Blank cells",[Yd]:"Filter by condition",[zd]:"Filter by value",[Gd]:"And",[Dl]:"Or",[jd]:"Select all",[Kd]:"Clear",[Xd]:"OK",[qd]:"Cancel",[Zd]:"Search",[Qd]:"Value",[Jd]:"Second value",[IC]:"Checked",[xC]:"Unchecked",[HC]:"Press ENTER to expand column.",[PC]:"Press ENTER to collapse column.",[DC]:"Press ENTER to change sorting.",[NC]:"Multi-column sorting order:",[LC]:"Press CTRL/CMD+ENTER to open menu.",[kC]:"The next column is hidden.",[FC]:"The previous column is hidden.",[$C]:"Press ENTER to expand row.",[VC]:"Press ENTER to collapse row.",[WC]:"The next row is hidden.",[BC]:"The previous row is hidden."},tM=R2,E2=b2,yp=tM.languageCode,{register:T2,getItem:nM,hasItem:M2,getValues:_2}=fs("languagesDictionaries");UC(tM);function UC(n,e){let t=n,s=e;return De(n)&&(s=n,t=s.languageCode),O2(t,s),T2(t,Qt(s)),Qt(s)}function O2(n,e){n!==yp&&m2(e,nM(yp))}function sM(n){return YC(n)?Qt(nM(n)):null}function YC(n){return M2(n)}function A2(){return _2()}function oM(n,e,t){const s=sM(n);if(s===null)return null;const o=s[e];if(ft(o))return null;const i=I2(o,t);return Array.isArray(i)?i[0]:i}function I2(n,e){let t=n;return T(v2(),s=>{t=s(n,e)}),t}function x2(n){let e=QT(n);return YC(e)||(e=yp,JT(n)),e}function H2(n,e,t){return e=P2(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function P2(n){var e=D2(n,"string");return typeof e=="symbol"?e:String(e)}function D2(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class N2 extends ZW{constructor(e,t){super(e,null),H2(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:s}=e,o=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(s,-1);return o===null||i===null?null:((o.row>i.row||o.col>i.col)&&(o=t,i=s),this.settings.createCellRange(o,o,i))}getNearestNotHiddenCoords(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const o=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(o===null)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,s);return i===null?null:this.settings.createCellCoords(o,i)}getNearestNotHiddenIndex(e,t,s){return t<0?t:e.getNearestNotHiddenIndex(t,s)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),s=e.getVerticalDirection()==="N-S"?1:-1,o=e.getHorizontalDirection()==="W-E"?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let r=null;if((i===null||i.col===null||i.row===null)&&(r=this.getNearestNotHiddenCoords(t,s,o)),r!==null&&e.overlaps(r)){const a=e.highlight.clone();if(a.row>=0&&(a.row=r.row),a.col>=0&&(a.col=r.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&i!==null&&r===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const s=this.settings.visualToRenderableCoords(e),o=this.settings.visualToRenderableCoords(t);return s.row===null||s.col===null||o.row===null||o.col===null?null:this.settings.createCellRange(s,s,o)}}const wo=N2;function hg(n){let{activeHeaderClassName:e,...t}=n;return new wo({className:e,...t,selectionType:NT})}function L2(n){let{areaCornerVisible:e,...t}=n;return new wo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...t,selectionType:cC})}function k2(n){let{...e}=n;return new wo({className:"highlight",...e,selectionType:cC})}function F2(n){let{columnClassName:e,...t}=n;return new wo({className:e,...t,selectionType:eB})}function $2(n){let{cellCornerVisible:e,...t}=n;return new wo({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...t,selectionType:hC})}function V2(n){let{border:e,visualCellRange:t,...s}=n;return new wo({...e,...s,selectionType:tB},t)}function W2(n){let{...e}=n;return new wo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:QW})}function Ry(n){let{headerClassName:e,...t}=n;return new wo({className:e,...t,selectionType:uC})}function B2(n){let{rowClassName:e,...t}=n;return new wo({className:e,...t,selectionType:JW})}let iM;function U2(n,e){Y2(n,e),e.add(n)}function Y2(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rn(n,e,t){return e=z2(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z2(n){var e=G2(n,"string");return typeof e=="symbol"?e:String(e)}function G2(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Bs(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var ws=new WeakSet;iM=Symbol.iterator;class j2{constructor(e){U2(this,ws),Rn(this,"options",void 0),Rn(this,"layerLevel",0),Rn(this,"focus",void 0),Rn(this,"fill",void 0),Rn(this,"layeredAreas",new Map),Rn(this,"areas",new Map),Rn(this,"rowHeaders",new Map),Rn(this,"columnHeaders",new Map),Rn(this,"activeRowHeaders",new Map),Rn(this,"activeColumnHeaders",new Map),Rn(this,"activeCornerHeaders",new Map),Rn(this,"rowHighlights",new Map),Rn(this,"columnHighlights",new Map),Rn(this,"customSelections",[]),this.options=e,this.focus=$2(e),this.fill=W2(e)}isEnabledFor(e,t){let s=e;e===hC&&(s="current");let o=!1;return t.isCell()&&(o=this.options.disabledCellSelection(t.row,t.col)),typeof o=="string"&&(o=[o]),o===!1||Array.isArray(o)&&!o.includes(s)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Bs(this,ws,Us).call(this,this.layeredAreas,L2)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Bs(this,ws,Us).call(this,this.areas,k2)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Bs(this,ws,Us).call(this,this.rowHeaders,Ry)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Bs(this,ws,Us).call(this,this.columnHeaders,Ry)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Bs(this,ws,Us).call(this,this.activeRowHeaders,hg)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Bs(this,ws,Us).call(this,this.activeColumnHeaders,hg)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Bs(this,ws,Us).call(this,this.activeCornerHeaders,hg)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Bs(this,ws,Us).call(this,this.rowHighlights,B2)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Bs(this,ws,Us).call(this,this.columnHighlights,F2)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(V2({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),T(this.areas.values(),e=>void e.clear()),T(this.layeredAreas.values(),e=>void e.clear()),T(this.rowHeaders.values(),e=>void e.clear()),T(this.columnHeaders.values(),e=>void e.clear()),T(this.activeRowHeaders.values(),e=>void e.clear()),T(this.activeColumnHeaders.values(),e=>void e.clear()),T(this.activeCornerHeaders.values(),e=>void e.clear()),T(this.rowHighlights.values(),e=>void e.clear()),T(this.columnHighlights.values(),e=>void e.clear())}[iM](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Us(n,e){const t=this.layerLevel;if(n.has(t))return n.get(t);const s=e({layerLevel:t,...this.options});return n.set(t,s),s}const K2=j2;class X2{constructor(e){this.ranges=[],this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const q2=X2;function oa(n,e){rM(n,e),e.add(n)}function dg(n,e,t){rM(n,e),e.set(n,t)}function rM(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xe(n,e){var t=aM(n,e,"get");return Z2(n,t)}function Z2(n,e){return e.get?e.get.call(n):e.value}function Mn(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function bp(n,e,t){var s=aM(n,e,"set");return Q2(n,s,t),t}function aM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Q2(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var mu=new WeakMap,nt=new WeakMap,Xo=new WeakMap,fg=new WeakSet,gg=new WeakSet,Rp=new WeakSet,mg=new WeakSet,li=new WeakSet;class lM{constructor(e,t){oa(this,li),oa(this,mg),oa(this,Rp),oa(this,gg),oa(this,fg),dg(this,mu,{writable:!0,value:void 0}),dg(this,nt,{writable:!0,value:void 0}),dg(this,Xo,{writable:!0,value:{x:0,y:0}}),bp(this,mu,e),bp(this,nt,t)}transformStart(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Mn(this,fg,Ey).call(this,{x:Xe(this,nt).navigableHeaders()?Xe(this,nt).countRowHeaders():0,y:Xe(this,nt).navigableHeaders()?Xe(this,nt).countColHeaders():0});const o=Xe(this,nt).createCellCoords(e,t);let i=Xe(this,mu).current().highlight;const r=Xe(this,nt).visualToRenderableCoords(i);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",o),r.row!==null&&r.col!==null){const{width:u,height:c}=Mn(this,Rp,uM).call(this),{row:d,col:f}=Mn(this,mg,My).call(this,i),m=Xe(this,nt).fixedRowsBottom(),w=Xe(this,nt).minSpareRows(),C=Xe(this,nt).minSpareCols(),b=Xe(this,nt).autoWrapRow(),y=Xe(this,nt).autoWrapCol(),M=Xe(this,nt).createCellCoords(d+o.row,f+o.col);if(M.row>=c){const H=s&&w>0&&m===0,V=!H&&y,z=M.col+1,ee=Xe(this,nt).createCellCoords(M.row-c,z>=u?z-u:z);this.runLocalHooks("beforeColumnWrap",V,Mn(this,li,qi).call(this,ee),z>=u),H?this.runLocalHooks("insertRowRequire",Xe(this,nt).countRenderableRows()):V&&M.assign(ee)}else if(M.row<0){const H=M.col-1,V=Xe(this,nt).createCellCoords(c+M.row,H<0?u+H:H);this.runLocalHooks("beforeColumnWrap",y,Mn(this,li,qi).call(this,V),H<0),y&&M.assign(V)}if(M.col>=u){const H=s&&C>0,V=!H&&b,z=M.row+1,ee=Xe(this,nt).createCellCoords(z>=c?z-c:z,M.col-u);this.runLocalHooks("beforeRowWrap",V,Mn(this,li,qi).call(this,ee),z>=c),H?this.runLocalHooks("insertColRequire",Xe(this,nt).countRenderableColumns()):V&&M.assign(ee)}else if(M.col<0){const H=M.row-1,V=Xe(this,nt).createCellCoords(H<0?c+H:H,u+M.col);this.runLocalHooks("beforeRowWrap",b,Mn(this,li,qi).call(this,V),H<0),b&&M.assign(V)}const{rowDir:A,colDir:$}=Mn(this,gg,Ty).call(this,M);a=A,l=$,i=Mn(this,li,qi).call(this,M)}return this.runLocalHooks("afterTransformStart",i,a,l),i}transformEnd(e,t){Mn(this,fg,Ey).call(this,{x:Xe(this,nt).navigableHeaders()?Xe(this,nt).countRowHeaders():0,y:Xe(this,nt).navigableHeaders()?Xe(this,nt).countColHeaders():0});const s=Xe(this,nt).createCellCoords(e,t),o=Xe(this,mu).current(),i=Xe(this,nt).visualToRenderableCoords(o.highlight),r=o.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",s),i.row!==null&&i.col!==null){const{row:u,col:c}=Mn(this,mg,My).call(this,o.to),d=Xe(this,nt).createCellCoords(u+s.row,c+s.col),{rowDir:f,colDir:m}=Mn(this,gg,Ty).call(this,d);a=f,l=m;const w=Mn(this,li,qi).call(this,d);s.row===0&&s.col!==0?r.col=w.col:s.row!==0&&s.col===0?r.row=w.row:(r.row=w.row,r.col=w.col)}return this.runLocalHooks("afterTransformEnd",r,a,l),r}}function Ey(n){let{x:e,y:t}=n;bp(this,Xo,{x:e,y:t})}function Ty(n){const{width:e,height:t}=Mn(this,Rp,uM).call(this);let s=0,o=0;return n.row<0?(s=-1,n.row=0):n.row>0&&n.row>=t&&(s=1,n.row=t-1),n.col<0?(o=-1,n.col=0):n.col>0&&n.col>=e&&(o=1,n.col=e-1),{rowDir:s,colDir:o}}function uM(){return{width:Xe(this,Xo).x+Xe(this,nt).countRenderableColumns(),height:Xe(this,Xo).y+Xe(this,nt).countRenderableRows()}}function My(n){const{row:e,col:t}=Xe(this,nt).visualToRenderableCoords(n);return Xe(this,nt).createCellCoords(Xe(this,Xo).y+e,Xe(this,Xo).x+t)}function qi(n){const e=n.clone();return e.col=n.col-Xe(this,Xo).x,e.row=n.row-Xe(this,Xo).y,Xe(this,nt).renderableToVisualCoords(e)}ht(lM,In);const J2=lM,ef=0,tf=1,cM=2,zC=3,eU=[zC,cM],tU=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],pg=Symbol("root"),_y=Symbol("child");function Pr(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pg;if(e!==pg&&e!==_y)throw new Error("The second argument is used internally only and cannot be overwritten.");const t=Array.isArray(n),s=e===pg;let o=ef;if(t){const i=n[0];n.length===0?o=tf:s&&i instanceof Hr?o=zC:s&&Array.isArray(i)?o=Pr(i,_y):n.length>=2&&n.length<=4&&!n.some((a,l)=>!tU[l].includes(typeof a))&&(o=cM)}return o}function ul(n){let{keepDirection:e=!1,propToCol:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!eU.includes(n))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=n===zC;let i=o?s.from.row:s[0],r=o?s.from.col:s[1],a=o?s.to.row:s[2],l=o?s.to.col:s[3];if(typeof t=="function"&&(typeof r=="string"&&(r=t(r)),typeof l=="string"&&(l=t(l))),ft(a)&&(a=i),ft(l)&&(l=r),!e){const d=i,f=r,m=a,w=l;i=Math.min(d,m),r=Math.min(f,w),a=Math.max(d,m),l=Math.max(f,w)}const u=new Os(i,r),c=new Os(a,l);return new Hr(u,u,c)}}function nU(n){const e=Pr(n);if(e===ef||e===tf)return[];const t=ul(e),s=new Set;T(n,r=>{const{from:a,to:l}=t(r),u=Math.max(a.col,0),c=l.col-u+1;T(Array.from(new Array(c),(d,f)=>u+f),d=>{s.has(d)||s.add(d)})});const o=Array.from(s).sort((r,a)=>r-a);return Pt(o,(r,a,l,u)=>(l!==0&&a===u[l-1]+1?r[r.length-1][1]+=1:r.push([a,1]),r),[])}function sU(n){const e=Pr(n);if(e===ef||e===tf)return[];const t=ul(e),s=new Set;T(n,r=>{const{from:a,to:l}=t(r),u=Math.max(a.row,0),c=l.row-u+1;T(Array.from(new Array(c),(d,f)=>u+f),d=>{s.has(d)||s.add(d)})});const o=Array.from(s).sort((r,a)=>r-a);return Pt(o,(r,a,l,u)=>(l!==0&&a===u[l-1]+1?r[r.length-1][1]+=1:r.push([a,1]),r),[])}function oU(n,e,t){iU(n,e),e.set(n,t)}function iU(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vo(n,e,t){return e=rU(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rU(n){var e=aU(n,"string");return typeof e=="symbol"?e:String(e)}function aU(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Oy(n,e,t){var s=hM(n,e,"set");return lU(n,s,t),t}function lU(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Ay(n,e){var t=hM(n,e,"get");return uU(n,t)}function hM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function uU(n,e){return e.get?e.get.call(n):e.value}var ia=new WeakMap;class dM{constructor(e,t){var s=this;vo(this,"settings",void 0),vo(this,"tableProps",void 0),vo(this,"inProgress",!1),vo(this,"selectedRange",new q2((o,i,r)=>this.tableProps.createCellRange(o,i,r))),vo(this,"highlight",void 0),vo(this,"transformation",void 0),vo(this,"selectedByRowHeader",new Set),vo(this,"selectedByColumnHeader",new Set),oU(this,ia,{writable:!0,value:!1}),this.settings=e,this.tableProps=t,this.highlight=new K2({headerClassName:e.currentHeaderClassName,headerAttributes:[op()],activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[op()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(o,i)=>this.tableProps.isDisabledCellSelection(o,i),cellCornerVisible:function(){return s.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return s.isAreaCornerVisible(...arguments)},visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,i)=>this.tableProps.createCellCoords(o,i),createCellRange:(o,i,r)=>this.tableProps.createCellRange(o,i,r)}),this.transformation=new J2(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:o=>this.tableProps.visualToRenderableCoords(o),renderableToVisualCoords:o=>this.tableProps.renderableToVisualCoords(o),createCellCoords:(o,i)=>this.tableProps.createCellCoords(o,i),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.runLocalHooks("beforeModifyTransformStart",...i)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.runLocalHooks("afterModifyTransformStart",...i)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.runLocalHooks("beforeModifyTransformEnd",...i)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.runLocalHooks("afterModifyTransformEnd",...i)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.runLocalHooks("insertRowRequire",...i)}),this.transformation.addLocalHook("insertColRequire",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.runLocalHooks("insertColRequire",...i)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.runLocalHooks("beforeRowWrap",...i)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.runLocalHooks("beforeColumnWrap",...i)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const i=this.settings.selectionMode==="multiple",r=ft(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${s?"Only":""}`,a),(!i||i&&!r&&ft(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(o.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),s||this.setRangeEnd(e)}setRangeStartOnly(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,s)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),s=this.tableProps.countRows(),o=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((s>0||o>0)&&(s===0&&t.col<0&&!i||o===0&&t.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const r=this.selectedRange.current();this.settings.navigableHeaders||r.highlight.normalize(),this.settings.selectionMode==="single"?(r.setFrom(r.highlight),r.setTo(r.highlight)):r.setTo(t),s>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!r.isSingleHeader())&&r.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(hC,r.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(r);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(T(this.highlight.getAreas(),M=>void M.clear()),T(this.highlight.getLayeredAreas(),M=>void M.clear()),T(this.highlight.getRowHeaders(),M=>void M.clear()),T(this.highlight.getColumnHeaders(),M=>void M.clear()),T(this.highlight.getActiveRowHeaders(),M=>void M.clear()),T(this.highlight.getActiveColumnHeaders(),M=>void M.clear()),T(this.highlight.getActiveCornerHeaders(),M=>void M.clear()),T(this.highlight.getRowHighlights(),M=>void M.clear()),T(this.highlight.getColumnHighlights(),M=>void M.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),m=this.highlight.createActiveRowHeader(),w=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),b=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),d.clear(),f.clear(),m.clear(),w.clear(),C.clear(),b.clear(),y.clear(),this.highlight.isEnabledFor(cC,r.highlight)&&(this.isMultiple()||l>=1)&&(u.add(r.from).add(r.to).commit(),c.add(r.from).add(r.to).commit(),l===1)){const M=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(M.from).commit().syncWith(M),this.highlight.createLayeredArea().add(M.from).commit().syncWith(M),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(uC,r.highlight)){if(!r.isSingleHeader()){const $=this.tableProps.createCellCoords(Math.max(r.from.row,0),-1),H=this.tableProps.createCellCoords(r.to.row,-1),V=this.tableProps.createCellCoords(-1,Math.max(r.from.col,0)),z=this.tableProps.createCellCoords(-1,r.to.col);this.settings.selectionMode==="single"?(d.add($).commit(),f.add(V).commit(),b.add($).commit(),y.add(V).commit()):(d.add($).add(H).commit(),f.add(V).add(z).commit(),b.add($).add(H).commit(),y.add(V).add(z).commit())}const M=!Ay(this,ia)&&this.isEntireRowSelected()&&(o>0&&o===r.getWidth()||o===0&&this.isSelectedByRowHeader()),A=!Ay(this,ia)&&this.isEntireColumnSelected()&&(s>0&&s===r.getHeight()||s===0&&this.isSelectedByColumnHeader());M&&m.add(this.tableProps.createCellCoords(Math.max(r.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(r.to.row,0),-1)).commit(),A&&w.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(r.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(r.to.col,0))).commit(),M&&A&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Ii(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,t,s))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=o=>{const{col:i}=o.getOuterTopStartCorner(),r=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(r>0&&i<0||r===0)&&o.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(o=>t(o));const s=this.selectedRange.peekByIndex(e);return s?t(s):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=o=>{const{row:i}=o.getOuterTopStartCorner(),r=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(r>0&&i<0||r===0)&&o.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(o=>t(o));const s=this.selectedRange.peekByIndex(e);return s?t(s):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),r=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=s?-l:0,c=t?-a:0;if(u===0&&c===0&&(i===0||r===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:m}=o;Oy(this,ia,m),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(d=this.tableProps.createCellCoords(An(f.row,u,i-1),An(f.col,c,r-1)));const w=this.tableProps.createCellCoords(u,c),C=this.tableProps.createCellCoords(i-1,r-1);this.clear(),this.setRangeStartOnly(w,void 0,d),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.finish(),Oy(this,ia,!1)}selectCells(e){const t=Pr(e);if(t===tf)return!1;if(t===ef)throw new Error(Qe`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const s=ul(t,{propToCol:a=>this.tableProps.propToCol(a),keepDirection:!0}),o=this.settings.navigableHeaders,i={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},r=!e.some(a=>{const l=s(a),u=l.isValid(i);return!(u&&!l.containsHeaders()||u&&l.containsHeaders()&&l.isSingleHeader())});return r&&(this.clear(),T(e,a=>{const{from:l,to:u}=s(a);this.setRangeStartOnly(l.clone(),!1),this.setRangeEnd(u.clone()),this.finish()})),r}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const o=typeof e=="string"?this.tableProps.propToCol(e):e,i=typeof t=="string"?this.tableProps.propToCol(t):t,r=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=new Os(u,o),d=new Os(r-1,i),f=new Hr(c,c,d).isValid({countRows:r,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const m=l===0?0:An(s,u,-1),w=r-1,C=this.tableProps.createCellCoords(m,o),b=this.tableProps.createCellCoords(w,i),y=this.tableProps.createCellCoords(An(s,u,r-1),o);this.runLocalHooks("beforeSelectColumns",C,b,y),C.row=m,b.row=w,this.setRangeStartOnly(C,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(b),this.runLocalHooks("afterSelectColumns",C,b,y),this.finish()}return f}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const o=this.tableProps.countRows(),i=this.tableProps.countCols(),r=this.tableProps.countRowHeaders(),a=r===0?0:-r,l=new Os(e,a),u=new Os(t,i-1),c=new Hr(l,l,u).isValid({countRows:o,countCols:i,countRowHeaders:r,countColHeaders:0});if(c){const d=r===0?0:An(s,a,-1),f=i-1,m=this.tableProps.createCellCoords(e,d),w=this.tableProps.createCellCoords(t,f),C=this.tableProps.createCellCoords(e,An(s,a,i-1));this.runLocalHooks("beforeSelectRows",m,w,C),m.col=d,w.col=f,this.setRangeStartOnly(m,void 0,C),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",m,w,C),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(o=>{o.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),s=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let o=0;o<this.selectedRange.size();o+=1){this.highlight.useLayerLevel(o);const i=this.highlight.createArea(),r=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();i.commit(),r.commit(),a.commit(),l.commit(),u.commit(),c.commit(),d.commit(),f.commit(),m.commit()}this.highlight.useLayerLevel(s)}}ht(dM,In);const cU=dM,Iy=/^(\r\n|\n\r|\r|\n)/,hU=/^[^\t\r\n]+/,xy=/^\t/;function dU(n){const e=[[""]];if(n.length===0)return e;let t=0,s=0,o;for(;n.length>0&&o!==n.length;)if(o=n.length,n.match(xy))n=n.replace(xy,""),t+=1,e[s][t]="";else if(n.match(Iy))n=n.replace(Iy,""),t=0,s+=1,e[s]=[""];else{let i="";if(n.startsWith('"')){let r=0,a=!0;for(;a;){const l=n.slice(0,1);l==='"'&&(r+=1),i+=l,n=n.slice(1),(n.length===0||n.match(/^[\t\r\n]/)&&r%2===0)&&(a=!1)}i=i.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const r=n.match(hU);i=r?r[0]:"",n=n.slice(i.length)}e[s][t]=i}return e}function za(n){let e,t,s,o,i="",r;for(e=0,t=n.length;e<t;e+=1){for(o=n[e].length,s=0;s<o;s+=1)s>0&&(i+="	"),r=n[e][s],typeof r=="string"?r.indexOf(`
`)>-1?i+=`"${r.replace(/"/g,'""')}"`:i+=r:r==null?i+="":i+=r;e!==t-1&&(i+=`
`)}return i}class br{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,s){this.instance=e,this.metaManager=s,this.tableMeta=s.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.colToPropCache=void 0,this.propToColCache=void 0,this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let s;if(this.colToPropCache=[],this.propToColCache=new Map,t){let o=0,i=0,r=!1;if(typeof t=="function"){const a=Ih(e);o=a>0?a:this.countFirstRowKeys(),r=!0}else{const a=this.tableMeta.maxCols;o=Math.min(a,t.length)}for(s=0;s<o;s++){const a=r?t(s):t[s];if(De(a)){if(typeof a.data<"u"){const l=r?i:s;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return SC(this.dataSource)}recursiveDuckColumns(e,t,s){let o=t,i=s,r;return typeof o>"u"&&(o=0,i=""),typeof e=="object"&&!Array.isArray(e)&&We(e,(a,l)=>{a===null?(r=i+l,this.colToPropCache.push(r),this.propToColCache.set(r,o),o+=1):o=this.recursiveDuckColumns(a,o,`${l}.`)}),o}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.instance.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&oe(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(oe(t))return this.instance.toVisualColumn(t);const s=this.instance.toVisualColumn(e);return s===null?e:s}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Ar(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:s,mode:o="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.instance.countSourceRows();let r=i,a=0,l=e;if((typeof l!="number"||l>=i)&&(l=i),l<this.instance.countRows()&&(r=this.instance.toPhysicalRow(l)),this.instance.runHooks("beforeCreateRow",l,t,s)===!1||r===null)return{delta:0};const c=this.tableMeta.maxRows,d=this.getSchema().length,f=[];for(;a<t&&i+a<c;){let w=null;this.instance.dataType==="array"?this.tableMeta.dataSchema?w=Qt(this.getSchema()):(w=[],me(d-1,()=>w.push(null))):this.instance.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},Ol(w,this.getSchema())),f.push(w),a+=1}this.instance.rowIndexMapper.insertIndexes(l,a),o==="below"&&(r=Math.min(r+1,i)),this.spliceData(r,0,f);const m=this.instance.toVisualRow(r);return this.instance.countSourceRows()===f.length&&this.instance.columnIndexMapper.initToLength(this.instance.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):s!=="auto"&&this.metaManager.createRow(r,t)),this.instance.runHooks("afterCreateRow",m,a,s),this.instance.forceFullRender=!0,{delta:a,startPhysicalIndex:r}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:s,mode:o="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,r=this.tableMeta.maxCols,a=this.instance.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.instance.runHooks("beforeCreateCol",l,t,s)===!1)return{delta:0};let c=a;l<this.instance.countCols()&&(c=this.instance.toPhysicalColumn(l));const d=this.instance.countSourceRows();let f=this.instance.countCols(),m=0,w=c;o==="end"&&(w=Math.min(w+1,a));const C=w;for(;m<t&&f<r;){if(typeof l!="number"||l>=f)if(d>0)for(let y=0;y<d;y+=1)typeof i[y]>"u"&&(i[y]=[]),i[y].push(null);else i.push([null]);else for(let y=0;y<d;y++)i[y].splice(w,0,null);m+=1,w+=1,f+=1}this.instance.columnIndexMapper.insertIndexes(l,m),m>0&&(e==null?this.metaManager.createColumn(null,m):s!=="auto"&&this.metaManager.createColumn(C,t));const b=this.instance.toVisualColumn(C);return this.instance.runHooks("afterCreateCol",b,m,s),this.instance.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:C}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2?arguments[2]:void 0,o=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(o,t),r=this.instance.countSourceRows();if(o=(r+o)%r,this.instance.runHooks("beforeRemoveRow",o,i.length,i,s)===!1)return!1;const l=i.length;if(this.filterData(o,l,i),o<this.instance.countRows()){this.instance.rowIndexMapper.removeIndexes(i);const c=oe(this.tableMeta.columns)||oe(this.tableMeta.dataSchema);this.instance.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.instance.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort((c,d)=>d-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.instance.runHooks("afterRemoveRow",o,l,i,s),this.instance.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2?arguments[2]:void 0;if(this.instance.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let o=typeof e!="number"?-t:e;o=(this.instance.countCols()+o)%this.instance.countCols();const i=this.visualColumnsToPhysical(o,t),r=i.slice(0).sort((d,f)=>f-d);if(this.instance.runHooks("beforeRemoveCol",o,t,i,s)===!1)return!1;let l=!0;const u=r.length,c=this.dataSource;for(let d=0;d<u;d++)l&&i[0]!==i[d]-d&&(l=!1);if(l)for(let d=0,f=this.instance.countSourceRows();d<f;d++)c[d].splice(i[0],t),d===0&&this.metaManager.removeColumn(i[0],t);else for(let d=0,f=this.instance.countSourceRows();d<f;d++)for(let m=0;m<u;m++)c[d].splice(r[m],1),d===0&&this.metaManager.removeColumn(r[m],1);return o<this.instance.countCols()&&(this.instance.columnIndexMapper.removeIndexes(i),this.instance.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.instance.rowIndexMapper.setIndexesSequence([])),this.instance.runHooks("afterRemoveCol",o,t,i,s),this.instance.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,s){const o=this.instance.getDataAtCol(e),i=o.slice(t,t+s),r=o.slice(t+s);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Jm(l,r);let c=0;for(;c<s;)l.push(null),c+=1;return mE(l),this.instance.populateFromArray(t,e,l,null,null,"spliceCol"),i}spliceRow(e,t,s){const o=this.instance.getSourceDataAtRow(e),i=o.slice(t,t+s),r=o.slice(t+s);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Jm(l,r);let c=0;for(;c<s;)l.push(null),c+=1;return this.instance.populateFromArray(e,t,[l],null,null,"spliceRow"),i}spliceData(e,t,s){if(this.instance.runHooks("beforeDataSplice",e,t,s)!==!1){const i=[...this.dataSource.slice(0,e),...s,...this.dataSource.slice(e)];this.dataSource.length=0,i.forEach(r=>this.dataSource.push(r))}}filterData(e,t,s){let o=this.instance.runHooks("filterData",e,t,s);Array.isArray(o)===!1&&(o=this.dataSource.filter((i,r)=>s.indexOf(r)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,o)}get(e,t){const s=this.instance.toPhysicalRow(e);let o=this.dataSource[s];const i=this.instance.runHooks("modifyRowData",s);o=isNaN(i)?i:o;let r=null;if(o&&o.hasOwnProperty&&Rt(o,t))r=o[t];else if(typeof t=="string"&&t.indexOf(".")>-1){const a=t.split(".");let l=o;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;r=l}else typeof t=="function"&&(r=t(this.dataSource.slice(s,s+1)[0]));if(this.instance.hasHook("modifyData")){const a=Ii(r);this.instance.runHooks("modifyData",s,this.propToCol(t),a,"get"),a.isTouched()&&(r=a.value)}return r}getCopyable(e,t){return this.instance.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,s){const o=this.instance.toPhysicalRow(e);let i=s,r=this.dataSource[o];const a=this.instance.runHooks("modifyRowData",o);if(r=isNaN(a)?a:r,this.instance.hasHook("modifyData")){const l=Ii(i);this.instance.runHooks("modifyData",o,this.propToCol(t),l,"set"),l.isTouched()&&(i=l.value)}if(r&&r.hasOwnProperty&&Rt(r,t))r[t]=i;else if(typeof t=="string"&&t.indexOf(".")>-1){const l=t.split(".");let u=r,c=0,d;for(c=0,d=l.length-1;c<d;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=i}else typeof t=="function"?t(this.dataSource.slice(o,o+1)[0],i):r[t]=i}visualRowsToPhysical(e,t){const s=this.instance.countSourceRows(),o=[];let i=(s+e)%s,r=t,a;for(;i<s&&r;)a=this.instance.toPhysicalRow(i),o.push(a),r-=1,i+=1;return o}visualColumnsToPhysical(e,t){const s=this.instance.countCols(),o=[];let i=(s+e)%s,r=t;for(;i<s&&r;){const a=this.instance.toPhysicalColumn(i);o.push(a),r-=1,i+=1}return o}clear(){for(let e=0;e<this.instance.countSourceRows();e++)for(let t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const s=this.instance.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(s,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.instance.countRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row===0&&!this.instance.countSourceRows()?[]:this.getRange(e,t,br.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,s){const o=[];let i,r,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=s===br.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=d;i++){a=[];const m=i>=0?this.instance.toPhysicalRow(i):i;for(r=Math.min(e.col,t.col);r<=f&&m!==null;r++)a.push(c.call(this,i,this.colToProp(r)));m!==null&&o.push(a)}return o}getText(e,t){return za(this.getRange(e,t,br.DESTINATION_RENDERER))}getCopyableText(e,t){return za(this.getRange(e,t,br.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.instance=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const fU=br,{register:gU,getItem:mU,hasItem:fM,getNames:pU,getValues:S8}=fs("cellTypes");function GC(n){if(!fM(n))throw Error(`You declared cell type "${n}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return mU(n)}function on(n,e){typeof n!="string"&&(e=n,n=e.CELL_TYPE);const{editor:t,renderer:s,validator:o}=e;t&&On(n,t),s&&Rs(n,s),o&&yr(n,o),gU(n,e)}function wU(n,e){var t;return n==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(n))||!Rt(e,n)}function nf(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const s=typeof e.type=="string"?GC(e.type):e.type;if(n._automaticallyAssignedMetaProps&&We(e,(i,r)=>void n._automaticallyAssignedMetaProps.delete(r)),!De(s))return;t===n&&!n._automaticallyAssignedMetaProps&&(n._automaticallyAssignedMetaProps=new Set);const o={};We(s,(i,r)=>{if(wU(r,t)){var a;o[r]=i,(a=n._automaticallyAssignedMetaProps)===null||a===void 0||a.add(r)}}),kt(n,o)}function CU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}mo(t,n);for(let s=0;s<e.length;s++)t.prototype[e[s]]=void 0;return t}function mc(n){return Number.isInteger(n)&&n>=0}function pc(n,e){if(!n())throw new Error(`Assertion failed: ${e}`)}function pu(n){return n==null}const gM=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(n){let e,t,s;for(e=0,t=this.countRows();e<t;e++)if(s=this.getDataAtCell(e,n),Vt(s)===!1)return!1;return!0},isEmptyRow(n){let e,t,s,o;for(e=0,t=this.countCols();e<t;e++)if(s=this.getDataAtCell(n,e),Vt(s)===!1)return typeof s=="object"?(o=this.getCellMeta(n,e),Ah(this.getSchema()[o.prop],s)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,disableTabNavigation:!1,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function SU(){return class{}}class vU{constructor(e){this.metaCtor=SU(),this.meta=this.metaCtor.prototype,kt(this.meta,gM()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;kt(this.meta,e),nf(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}class yU{constructor(e){const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){kt(this.meta,e),nf(this.meta,e,e)}}class Ep{constructor(e){this.valueFactory=e,this.data=[],this.index=[],this.holes=new Set}obtain(e){pc(()=>mc(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let s;if(t>=0)s=this.data[t],s===void 0&&(s=this.valueFactory(e),this.data[t]=s);else if(s=this.valueFactory(e),this.holes.size>0){const o=this.holes.values().next().value;this.holes.delete(o),this.data[o]=s,this.index[e]=o}else this.data.push(s),this.index[e]=this.data.length-1;return s}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;pc(()=>mc(e)||pu(e),"Expecting an unsigned number or null/undefined argument.");const s=[],o=this.data.length;for(let r=0;r<t;r++)s.push(o+r),this.data.push(void 0);const i=pu(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...s,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;pc(()=>mc(e)||pu(e),"Expecting an unsigned number or null/undefined argument.");const s=this.index.splice(pu(e)?this.index.length-t:e,t);for(let o=0;o<s.length;o++){const i=s[o];typeof i=="number"&&this.holes.add(i)}}size(){return this.data.length-this.holes.size}values(){return kn(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let s=0;s<this.data.length;s++){const o=this._getKeyByStorageIndex(s);o!==-1&&e.push([o,this.data[s]])}let t=0;return{next:()=>{if(t<e.length){const s=e[t];return t+=1,{value:s,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}const bU=["data","width"];class RU{constructor(e){this.globalMeta=e,this.metas=new Ep(()=>this._createMeta())}updateMeta(e,t){const s=this.getMeta(e);kt(s,t),nf(s,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return CU(this.globalMeta.getMetaConstructor(),bU).prototype}}class EU{constructor(e){this.columnMeta=e,this.metas=new Ep(()=>this._createRow())}updateMeta(e,t,s){const o=this.getMeta(e,t);kt(o,s),nf(o,s)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let s=0;s<this.metas.size();s++)this.metas.obtain(s).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let s=0;s<this.metas.size();s++)this.metas.obtain(s).remove(e,t)}getMeta(e,t,s){const o=this.metas.obtain(e).obtain(t);return s===void 0?o:o[s]}setMeta(e,t,s,o){var i;const r=this.metas.obtain(e).obtain(t);(i=r._automaticallyAssignedMetaProps)===null||i===void 0||i.delete(s),r[s]=o}removeMeta(e,t,s){const o=this.metas.obtain(e).obtain(t);delete o[s]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let s=0;s<t.length;s++)e.push(...t[s].values());return e}getMetasAtRow(e){pc(()=>mc(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Ep(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class mM{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new vU(e),this.tableMeta=new yU(this.globalMeta),this.columnMeta=new RU(this.globalMeta),this.cellMeta=new EU(this.columnMeta),s.forEach(o=>new o(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,s){let{visualRow:o,visualColumn:i}=s;const r=this.cellMeta.getMeta(e,t);return r.visualRow=o,r.visualCol=i,r.row=e,r.col=t,this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,t,s){if(typeof s!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,s)}setCellMeta(e,t,s,o){this.cellMeta.setMeta(e,t,s,o)}updateCellMeta(e,t,s){this.cellMeta.updateMeta(e,t,s)}removeCellMeta(e,t,s){this.cellMeta.removeMeta(e,t,s)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}ht(mM,In);function Hy(n,e,t,s){const{hotInstance:o,dataMap:i,dataSource:r,internalSource:a,source:l,metaManager:u,firstRun:c}=s,d=un(a),f=o.getSettings();Array.isArray(f.dataSchema)?o.dataType="array":dt(f.dataSchema)?o.dataType="function":o.dataType="object",i&&i.destroy(),n=o.runHooks(`before${d}`,n,c,l);const m=new fU(o,n,u);if(e(m),typeof n=="object"&&n!==null)n.push&&n.splice||(n=[n]);else if(n===null){const w=m.getSchema();n=[];let C,b=0,y=0;for(b=0,y=f.startRows;b<y;b++)if((o.dataType==="object"||o.dataType==="function")&&f.dataSchema)C=Qt(w),n.push(C);else if(o.dataType==="array")C=Qt(w[0]),n.push(C);else{C=[];for(let M=0,A=f.startCols;M<A;M++)C.push(null);n.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof n} given)`);Array.isArray(n[0])&&(o.dataType="array"),f.data=n,m.dataSource=n,r.data=n,r.dataType=o.dataType,r.colToProp=m.colToProp.bind(m),r.propToCol=m.propToCol.bind(m),r.countCachedColumns=m.countCachedColumns.bind(m),t(m),o.runHooks(`after${d}`,n,c,l),c||(o.runHooks("afterChange",null,a),o.render()),o.getSettings().ariaTags&&Se(o.rootElement,[bE(o.countRows()),RE(o.countCols())])}class TU{constructor(e){this.metaManager=e,this.metaSyncMemo=new Map,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),de.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:s,col:o}=e;if((t=this.metaSyncMemo.get(s))!==null&&t!==void 0&&t.has(o))return;const{visualRow:i,visualCol:r}=e,a=this.metaManager.hot,l=a.colToProp(r);e.prop=l,a.runHooks("beforeGetCellMeta",i,r,e);const u=Rt(e,"type")?e.type:null;let c=dt(e.cells)?e.cells(s,o,l):null;if(u)if(c){var d;c.type=(d=c.type)!==null&&d!==void 0?d:u}else c={type:u};c&&this.metaManager.updateCellMeta(s,o,c),a.runHooks("afterGetCellMeta",i,r,e),this.metaSyncMemo.has(s)||this.metaSyncMemo.set(s,new Set),this.metaSyncMemo.get(s).add(o)}}class MU{constructor(e){this.metaManager=e,this.usageTracker=new Set,this.propDescriptors=new Map([["ariaTags",{onChange(t,s,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,s,o){if(!o)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]]),this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{target:s,onChange:o=()=>{}}=e,i=typeof s=="string",r=i?s:t,a=`_${r}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[r],this.installPropWatcher(t,a,o),i&&this.installPropWatcher(s,a,o)})}installPropWatcher(e,t,s){const o=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const r=!o.usageTracker.has(e);o.usageTracker.add(e),s.call(o,e,i,r),this[t]=i},enumerable:!0,configurable:!0})}}const pM="gridDefault",jC="editorManager.handlingEditor",_U={name:"editorCloseAndSave",callback(n,e,t){const s=n._getEditorManager();s.closeEditorAndSaveChanges(n.getShortcutManager().isCtrlPressed()),s.moveSelectionAfterEnter(t.includes("shift"))}},OU={name:"editorCloseWithoutSaving",callback(n){const e=n._getEditorManager();e.closeEditorAndRestoreOriginalValue(n.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},AU={name:"editorFastOpen",callback(n,e){const{highlight:t}=n.getSelectedRangeLast();t.isHeader()||n._getEditorManager().openEditor(null,e,!0)}},IU={name:"editorOpen",callback(n,e,t){const s=n._getEditorManager(),{highlight:o}=n.getSelectedRangeLast();o.isHeader()||(n.getSettings().enterBeginsEditing?s.cellProperties.readOnly?s.moveSelectionAfterEnter():s.openEditor(null,e,!0):s.moveSelectionAfterEnter(t.includes("shift")),Xn(e))}};function xU(){return[_U,OU,AU,IU]}const HU={name:"extendCellsSelectionDown",callback(n){const{highlight:e}=n.getSelectedRangeLast();(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(1,0)}},PU={name:"extendCellsSelectionDownByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.min(e.row+n.countVisibleRows(),n.countRows()-1),s=n.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(s!==null){const o=n._createCellCoords(s,e.col),i=e.row-n.view.getFirstFullyVisibleRow(),r=Math.min(o.row-i,n.countRows()-1);n.selection.setRangeEnd(o),n.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}},DU={name:"extendCellsSelectionLeft",callback(n){const{highlight:e}=n.getSelectedRangeLast();(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,-1*n.getDirectionFactor())}},NU={name:"extendCellsSelectionRight",callback(n){const{highlight:e}=n.getSelectedRangeLast();(e.isCell()||e.isHeader()&&n.selection.isSelectedByColumnHeader())&&n.selection.transformEnd(0,n.getDirectionFactor())}},LU={name:"extendCellsSelectionToColumns",callback(n){const{highlight:e,from:t,to:s}=n.getSelectedRangeLast();n.selection.isSelectedByRowHeader()?n.selection.selectAll(!0,!0):n.selectColumns(t.col,s.col,e.row)}},kU={name:"extendCellsSelectionToMostBottom",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:s,from:o,to:i}=n.getSelectedRangeLast(),r=s.isHeader()&&n.selection.isSelectedByRowHeader();if(s.isCell()||r){const a=t.getNearestNotHiddenIndex(n.countRows()-1,-1);e.setRangeStart(o.clone()),r&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,i.col))}}},FU={name:"extendCellsSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:s}=n.getSelectedRangeLast();s.isCell()&&e.setRangeEnd(n._createCellCoords(e.selectedRange.current().from.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},$U={name:"extendCellsSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:s}=n.getSelectedRangeLast();s.isCell()&&e.setRangeEnd(n._createCellCoords(e.selectedRange.current().from.row,t.getNearestNotHiddenIndex(0,1)))}},VU={name:"extendCellsSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:s,from:o,to:i}=n.getSelectedRangeLast(),r=s.isHeader()&&n.selection.isSelectedByColumnHeader();if(s.isCell()||r){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);e.setRangeStart(o.clone()),r&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(i.row,a))}}},WU={name:"extendCellsSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{highlight:s,from:o,to:i}=n.getSelectedRangeLast(),r=s.isHeader()&&n.selection.isSelectedByColumnHeader();if(s.isCell()||r){const a=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);e.setRangeStart(o.clone()),r&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(i.row,a))}}},BU={name:"extendCellsSelectionToMostTop",callback(n){const{selection:e,rowIndexMapper:t}=n,{highlight:s,from:o,to:i}=n.getSelectedRangeLast(),r=s.isHeader()&&n.selection.isSelectedByRowHeader();if(s.isCell()||r){const a=t.getNearestNotHiddenIndex(0,1);e.setRangeStart(o.clone()),r&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(n._createCellCoords(a,i.col))}}},UU={name:"extendCellsSelectionToRows",callback(n){const{highlight:e,from:t,to:s}=n.getSelectedRangeLast();n.selection.isSelectedByColumnHeader()?n.selection.selectAll(!0,!0):n.selectRows(t.row,s.row,e.col)}},YU={name:"extendCellsSelectionUp",callback(n){const{highlight:e}=n.getSelectedRangeLast();(e.isCell()||e.isHeader()&&n.selection.isSelectedByRowHeader())&&n.selection.transformEnd(-1,0)}},zU={name:"extendCellsSelectionUpByViewportHeight",callback(n){const{to:e}=n.getSelectedRangeLast(),t=Math.max(e.row-n.countVisibleRows(),0),s=n.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(s!==null){const o=n._createCellCoords(s,e.col),i=e.row-n.view.getFirstFullyVisibleRow(),r=Math.max(o.row-i,0);n.selection.setRangeEnd(o),n.scrollViewportTo({row:r,verticalSnap:"top",horizontalSnap:"start"})}}};function GU(){return[HU,PU,DU,NU,LU,kU,FU,$U,VU,WU,BU,UU,YU,zU]}const jU={name:"moveCellSelectionDown",callback(n){let{selection:e}=n;e.transformStart(1,0)}},KU={name:"moveCellSelectionDownByViewportHeight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:s}=n.getSelectedRangeLast().highlight;let o=n.countVisibleRows()+t;s===n.countRows()-1?o=1:s+o>n.countRows()&&(o=n.countRows()-s-1),n.selection.transformStart(o,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}},XU={name:"moveCellSelectionInlineEnd",callback(n,e){const t=n.getSettings(),s=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.transformStart(-s.row,-s.col)}},qU={name:"moveCellSelectionInlineStart",callback(n,e){const t=n.getSettings(),s=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;n.selection.transformStart(s.row,s.col,!0)}},ZU={name:"moveCellSelectionLeft",callback(n){n.selection.transformStart(0,-1*n.getDirectionFactor())}},QU={name:"moveCellSelectionRight",callback(n){n.selection.transformStart(0,n.getDirectionFactor())}},JU={name:"moveCellSelectionToMostBottom",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(n.countRows()-1,-1);t===null&&(t=-1),n.selection.setRangeStart(n._createCellCoords(t,e))}},eY={name:"moveCellSelectionToMostBottomInlineEnd",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:s}=n,o=parseInt(n.getSettings().fixedRowsBottom,10),i=t.getNearestNotHiddenIndex(n.countRows()-o-1,-1),r=s.getNearestNotHiddenIndex(n.countCols()-1,-1);e.setRangeStart(n._createCellCoords(i,r))}},tY={name:"moveCellSelectionToMostInlineEnd",callback(n){const{selection:e,columnIndexMapper:t}=n;e.setRangeStart(n._createCellCoords(n.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(n.countCols()-1,-1)))}},nY={name:"moveCellSelectionToMostInlineStart",callback(n){const{selection:e,columnIndexMapper:t}=n,s=parseInt(n.getSettings().fixedColumnsStart,10),o=n.getSelectedRangeLast().highlight.row,i=t.getNearestNotHiddenIndex(s,1);e.setRangeStart(n._createCellCoords(o,i))}},sY={name:"moveCellSelectionToMostLeft",callback(n){const{selection:e,columnIndexMapper:t}=n,s=n.getSelectedRangeLast().highlight.row;let o=t.getNearestNotHiddenIndex(...n.isRtl()?[n.countCols()-1,-1]:[0,1]);o===null&&(o=n.isRtl()?-1:-n.countRowHeaders()),e.setRangeStart(n._createCellCoords(s,o))}},oY={name:"moveCellSelectionToMostRight",callback(n){const{selection:e,columnIndexMapper:t}=n,{row:s}=n.getSelectedRangeLast().highlight;let o=t.getNearestNotHiddenIndex(...n.isRtl()?[0,1]:[n.countCols()-1,-1]);o===null&&(o=n.isRtl()?-n.countRowHeaders():-1),e.setRangeStart(n._createCellCoords(s,o))}},iY={name:"moveCellSelectionToMostTop",callback(n){const{col:e}=n.getSelectedRangeLast().highlight;let t=n.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-n.countColHeaders()),n.selection.setRangeStart(n._createCellCoords(t,e))}},rY={name:"moveCellSelectionToMostTopInlineStart",callback(n){const{selection:e,rowIndexMapper:t,columnIndexMapper:s}=n,o=parseInt(n.getSettings().fixedRowsTop,10),i=parseInt(n.getSettings().fixedColumnsStart,10),r=t.getNearestNotHiddenIndex(o,1),a=s.getNearestNotHiddenIndex(i,1);e.setRangeStart(n._createCellCoords(r,a))}},aY={name:"moveCellSelectionUp",callback(n){let{selection:e}=n;e.transformStart(-1,0)}},lY={name:"moveCellSelectionUpByViewportHight",callback(n){const{navigableHeaders:e}=n.getSettings(),t=e?n.countColHeaders():0,{row:s}=n.getSelectedRangeLast().highlight;let o=-(n.countVisibleRows()+t);s===-t?o=-1:s+o<t&&(o=-(s+t)),n.selection.transformStart(o,0),n.getSelectedRangeLast().highlight.row<0&&n.scrollViewportTo({row:0})}};function uY(){return[jU,KU,XU,qU,ZU,QU,JU,eY,tY,nY,sY,oY,iY,rY,aY,lY]}const cY={name:"emptySelectedCells",callback(n){n.emptySelectedCells(),n._getEditorManager().prepareEditor()}},hY={name:"scrollToFocusedCell",callback(n){const{highlight:e}=n.getSelectedRangeLast(),t=n.view.getFirstFullyVisibleRow()-1,s=n.view.getFirstFullyVisibleColumn()-1,o=n.view.getLastFullyVisibleRow()+1,i=n.view.getLastFullyVisibleColumn()+1,r=n._createCellCoords(t,s),a=n._createCellCoords(o,i);if(!n._createCellRange(r,r,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(n.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(n.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}n.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},dY={name:"selectAll",callback(n){n.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},fY={name:"populateSelectedCellsData",callback(n){const e=n.getSelectedRange(),{row:t,col:s}=e[e.length-1].highlight.normalize(),o=n.getDataAtCell(t,s),i=new Map;for(let r=0;r<e.length;r++)e[r].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==t||l!==s)){const{readOnly:u}=n.getCellMeta(a,l);u||i.set(`${a}x${l}`,[a,l,o])}});n.setDataAtCell(Array.from(i.values()))}},gY=[...xU(),...GU(),...uY(),cY,hY,dY,fY];function wM(n){const e={};return gY.forEach(t=>{let{name:s,callback:o}=t;e[s]=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return o(n,...r)}}),e}function mY(n){const e=n.getShortcutManager().addContext("editor"),t=wM(n),s={group:jC};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(o,i)=>t.editorCloseAndSave(o,i)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],s)}function pY(n){const e=n.getShortcutManager().addContext("grid"),t=wM(n),s={runOnlyIf:()=>{const{navigableHeaders:o}=n.getSettings();return oe(n.getSelected())&&(o||!o&&n.countRenderedRows()>0&&n.countRenderedCols()>0)},group:pM};e.addShortcuts([{keys:[["F2"]],callback:o=>t.editorFastOpen(o)},{keys:[["Enter"],["Enter","Shift"]],callback:(o,i)=>t.editorOpen(o,i)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:jC,runOnlyIf:()=>oe(n.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"],["Control/Meta","Shift","Space"]],callback:()=>t.selectAll()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>!n.getSelectedRangeLast().highlight.isHeader()&&n.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(n.selection.isSelectedByCorner()||n.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>n.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>t.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>t.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],s)}function wY(n){[mY,pY].forEach(e=>e(n))}function CY(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=n.rootElement,s=Py(n),o=Py(n);return s.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),o.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),t.firstChild.before(s),t.lastChild.after(o),{activate(){n._registerTimeout(()=>{s.tabIndex=0,o.tabIndex=0},10)},deactivate(){n._registerTimeout(()=>{s.tabIndex=-1,o.tabIndex=-1},10)}}}function Py(n){const t=n.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),n.getSettings().ariaTags&&Se(t,[rs()]),t}function SY(n){let e;const{activate:t,deactivate:s}=CY(n,{onFocusFromTop(){var r;const a=(r=e)!==null&&r!==void 0?r:Dy(n);a&&(n.runHooks("modifyFocusOnTabNavigation","from_above",a),n.selectCell(a.row,a.col)),n.listen()},onFocusFromBottom(){var r;const a=(r=e)!==null&&r!==void 0?r:Ny(n);a&&(n.runHooks("modifyFocusOnTabNavigation","from_below",a),n.selectCell(a.row,a.col)),n.listen()}}),o={wrapped:!1,flipped:!1};n.addHook("afterListen",()=>s()),n.addHook("afterUnlisten",()=>t()),n.addHook("afterSelection",()=>{var r;e=(r=n.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight}),n.addHook("beforeRowWrap",(r,a,l)=>{o.wrapped=!0,o.flipped=l});function i(){o.wrapped=!1,o.flipped=!1,n.deselectCell(),n.unlisten()}n.getShortcutManager().getContext("grid").addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:r=>{const{disableTabNavigation:a,autoWrapRow:l}=n.getSettings();if(a||!n.selection.isSelected()||l&&o.wrapped&&o.flipped||!l&&o.wrapped)return l&&o.wrapped&&o.flipped&&(e=r.shiftKey?Dy(n):Ny(n)),i(),!1;r.preventDefault()},runOnlyIf:()=>!n.getSettings().minSpareCols,preventDefault:!1,stopPropagation:!1,position:"after",relativeToGroup:pM,group:"focusCatcher"})}function Dy(n){const{rowIndexMapper:e,columnIndexMapper:t}=n,{navigableHeaders:s}=n.getSettings();let o=s&&n.countColHeaders()>0?-n.countColHeaders():0,i=s&&n.countRowHeaders()>0?-n.countRowHeaders():0;return o===0&&(o=e.getVisualFromRenderableIndex(o)),i===0&&(i=t.getVisualFromRenderableIndex(i)),o===null||i===null?null:n._createCellCoords(o,i)}function Ny(n){var e,t;const{rowIndexMapper:s,columnIndexMapper:o}=n,{navigableHeaders:i}=n.getSettings();let r=s.getRenderableIndexesLength()-1,a=o.getRenderableIndexesLength()-1;if(r<0){if(!i||n.countColHeaders()===0)return null;r=-1}if(a<0){if(!i||n.countColHeaders()===0)return null;a=-1}return n._createCellCoords((e=s.getVisualFromRenderableIndex(r))!==null&&e!==void 0?e:r,(t=o.getVisualFromRenderableIndex(a))!==null&&t!==void 0?t:a)}const Ly=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),wu=n=>n.map(e=>{const t=e.toLowerCase();return Ly.has(t)?Ly.get(t):t}).sort().join("+"),vY=n=>n.split("+"),ky=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),wg=n=>{let{key:e,code:t}=n;return(ky.test(t)?t.replace(ky,"$1"):e).toLowerCase()},CM=Symbol("shortcut-context");function SM(n){return De(n)&&n.__kindOf===CM}const yY=n=>{const e=Ph({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${n}" context.`}),t=function(){let{keys:l,callback:u,group:c,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:m=!0,stopPropagation:w=!1,relativeToGroup:C,position:b,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ft(c))throw new Error("You need to define the shortcut's group.");if(dt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Qe`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const M={callback:u,group:c,runOnlyIf:d,captureCtrl:f,preventDefault:m,stopPropagation:w};oe(C)&&([M.relativeToGroup,M.position]=[C,b]),SM(y)&&(M.forwardToContext=y),l.forEach(A=>{const $=wu(A);if(e.hasItem($)){const V=e.getItem($);let z=V.findIndex(ee=>ee.group===C);z!==-1?b==="before"?z-=1:z+=1:z=V.length,V.splice(z,0,M)}else e.addItem($,[M])})},s=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{We(u,(d,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),t(c)})},o=l=>{const u=wu(l);e.removeItem(u)};return{__kindOf:CM,addShortcut:t,addShortcuts:s,getShortcuts:l=>{const u=wu(l),c=e.getItem(u);return oe(c)?c.slice():[]},hasShortcut:l=>{const u=wu(l);return e.hasItem(u)},removeShortcutsByKeys:o,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[d,f]=c;const m=f.filter(w=>w.group!==l);m.length===0?o(vY(d)):(f.length=0,f.push(...m))})}}};function bY(){const n=new Set;return{press(e){n.add(e)},release(e){n.delete(e)},releaseAll(){n.clear()},isPressed(e){return n.has(e)}}}const RY=["meta","alt","shift","control"],ra=bY();let Cu=0;function EY(n,e,t,s,o){const i=m=>RY.includes(m),r=function(m){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return m.altKey&&C.push("alt"),w&&(m.ctrlKey||m.metaKey)?C.push("control/meta"):(m.ctrlKey&&C.push("control"),m.metaKey&&C.push("meta")),m.shiftKey&&C.push("shift"),C},a=m=>{if(e(m)===!1)return;const w=t(m);if(m.keyCode===229||w===!1||Do(m))return;const C=wg(m);let b=[];i(C)||(b=r(m));const y=[C].concat(b);!o(m,y)&&(Bc()&&b.includes("meta")||!Bc()&&b.includes("control"))&&o(m,[C].concat(r(m,!0))),s(m)},l=m=>{const w=wg(m);i(w)&&ra.press(w)},u=m=>{const w=wg(m);i(w)&&ra.release(w)},c=()=>{ra.releaseAll()};return{mount:()=>{let m=n;for(Cu+=1;m;)Cu===1&&(m.document.documentElement.addEventListener("keydown",l),m.document.documentElement.addEventListener("keyup",u)),m.document.documentElement.addEventListener("keydown",a),m.document.documentElement.addEventListener("blur",c),m=sl(m)},unmount:()=>{let m=n;for(Cu-=1;m;)Cu===0&&(m.document.documentElement.removeEventListener("keydown",l),m.document.documentElement.removeEventListener("keyup",u)),m.document.documentElement.removeEventListener("keydown",a),m.document.documentElement.removeEventListener("blur",c),m=sl(m)},isPressed:m=>ra.isPressed(m),releasePressedKeys:()=>ra.releaseAll()}}const TY=n=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:s,afterKeyDown:o}=n;const i=Ph({errorIdExists:w=>`The "${w}" context name is already registered.`});let r="grid";const a=w=>{const C=yY(w);return i.addItem(w,C),C},l=()=>r,u=w=>i.getItem(w),c=w=>{if(!i.hasItem(w))throw new Error(Qe`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);r=w};let d=!1;const f=function(w,C){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=SM(b)?b:u(b);let M=!1;if(!y.hasShortcut(C))return M;const A=y.getShortcuts(C);for(let $=0;$<A.length;$++){const{callback:H,runOnlyIf:V,preventDefault:z,stopPropagation:ee,captureCtrl:j,forwardToContext:X}=A[$];if(V(w)!==!1){if(d=j,M=H(w,C)===!1,d=!1,z&&w.preventDefault(),ee&&(Xn(w),w.stopPropagation()),M)break;X&&f(w,C,X)}}return M},m=EY(e,t,s,o,f);return m.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!d&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};let Cg=null;const Sg=new Map;function vM(n,e){var t,s=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,r=this;const a=new It(r);let l,u,c,d,f,m=!0;$B(o)&&FB(this),this.rootElement=n,this.rootDocument=n.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",C=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1},e.language=x2(e.language);const b=new mM(r,e,[TU,MU]),y=b.getTableMeta(),M=b.getGlobalMeta(),A=Ph();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,n.insertBefore(this.container,n.firstChild),gc(this)&&SE(e.licenseKey,n),this.guid=`ht_${Tw()}`,Sg.set(this.guid,this),this.columnIndexMapper=new vp,this.rowIndexMapper=new vp,this.columnIndexMapper.addLocalHook("indexesSequenceChange",h=>{r.runHooks("afterColumnSequenceChange",h)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",h=>{r.runHooks("afterRowSequenceChange",h)}),u=new JB(r),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const $=h=>{const{row:g,col:p}=h;return r._createCellCoords(g>=0?r.rowIndexMapper.getRenderableFromVisualIndex(g):g,p>=0?r.columnIndexMapper.getRenderableFromVisualIndex(p):p)},H=h=>{const{row:g,col:p}=h;return r._createCellCoords(g>=0?r.rowIndexMapper.getVisualFromRenderableIndex(g):g,p>=0?r.columnIndexMapper.getVisualFromRenderableIndex(p):p)};let V=new cU(y,{rowIndexMapper:r.rowIndexMapper,columnIndexMapper:r.columnIndexMapper,countCols:()=>r.countCols(),countRows:()=>r.countRows(),propToCol:h=>l.propToCol(h),isEditorOpened:()=>r.getActiveEditor()?r.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>r.getShortcutManager(),createCellCoords:(h,g)=>r._createCellCoords(h,g),createCellRange:(h,g,p)=>r._createCellRange(h,g,p),visualToRenderableCoords:$,renderableToVisualCoords:H,isDisabledCellSelection:(h,g)=>r.getCellMeta(h,g).disableVisualSelection});this.selection=V;const z=h=>{let{hiddenIndexesChanged:g}=h;g&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("afterSetRangeEnd",h=>{const g=Ii(!1),p=this.selection.getSelectedRange(),{from:E,to:_}=p.current(),I=p.size()-1;this.runHooks("afterSelection",E.row,E.col,_.row,_.col,g,I),this.runHooks("afterSelectionByProp",E.row,r.colToProp(E.col),_.row,r.colToProp(_.col),g,I);let Y=!0;i&&(Y=!1),g.isTouched()&&(Y=!g.value);const W=this.selection.selectedRange.current(),q=this.selection.isSelectedByAnyHeader(),Z=this.selection.isSelectedByRowHeader(),K=this.selection.isSelectedByColumnHeader();if(Y!==!1)if(q)Z?this.scrollViewportTo({row:h.row}):K&&this.scrollViewportTo({col:h.col});else if(W&&!this.selection.isMultiple()){const{row:ce,col:Me}=W.from;ce<0&&Me>=0?this.scrollViewportTo({col:Me}):Me<0&&ce>=0?this.scrollViewportTo({row:ce}):this.scrollViewportTo({row:ce,col:Me})}else this.scrollViewportTo(h.toObject());Z&&K?J(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Z?(Pe(this.rootElement,"ht__selection--columns"),J(this.rootElement,"ht__selection--rows")):K?(Pe(this.rootElement,"ht__selection--rows"),J(this.rootElement,"ht__selection--columns")):Pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",h=>{const g=h.length-1,{from:p,to:E}=h[g];this.runHooks("afterSelectionEnd",p.row,p.col,E.row,E.col,g),this.runHooks("afterSelectionEndByProp",p.row,r.colToProp(p.col),E.row,r.colToProp(E.col),g)}),this.selection.addLocalHook("afterIsMultipleSelection",h=>{const g=this.runHooks("afterIsMultipleSelection",h.value);h.value&&(h.value=g)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),Pe(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("beforeSetRangeStart",...g)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("beforeSetRangeStartOnly",...g)}).addLocalHook("beforeSetRangeEnd",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("beforeSetRangeEnd",...g)}).addLocalHook("beforeSelectColumns",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("beforeSelectColumns",...g)}).addLocalHook("afterSelectColumns",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("afterSelectColumns",...g)}).addLocalHook("beforeSelectRows",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("beforeSelectRows",...g)}).addLocalHook("afterSelectRows",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("afterSelectRows",...g)}).addLocalHook("beforeModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("modifyTransformStart",...g)}).addLocalHook("afterModifyTransformStart",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("afterModifyTransformStart",...g)}).addLocalHook("beforeModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("modifyTransformEnd",...g)}).addLocalHook("afterModifyTransformEnd",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("afterModifyTransformEnd",...g)}).addLocalHook("beforeRowWrap",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("beforeRowWrap",...g)}).addLocalHook("beforeColumnWrap",function(){for(var h=arguments.length,g=new Array(h),p=0;p<h;p++)g[p]=arguments[p];return s.runHooks("beforeColumnWrap",...g)}).addLocalHook("insertRowRequire",h=>this.alter("insert_row_above",h,1,"auto")).addLocalHook("insertColRequire",h=>this.alter("insert_col_start",h,1,"auto")),c={alter(h,g){var p,E;let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,I=arguments.length>3?arguments[3]:void 0,Y=arguments.length>4?arguments[4]:void 0;const W=q=>{if(q.length===0)return[];const Z=[...q];return Z.sort((ce,Me)=>{let[Ee]=ce,[Te]=Me;return Ee===Te?0:Ee>Te?1:-1}),Pt(Z,(ce,Me)=>{let[Ee,Te]=Me;const G=ce[ce.length-1],[Ye,Fe]=G,ye=Ye+Fe;if(Ee<=ye){const xe=Math.max(Te-(ye-Ee),0);G[1]+=xe}else ce.push([Ee,Te]);return ce},[Z[0]])};switch(h){case"insert_row_below":case"insert_row_above":const q=r.countSourceRows();if(y.maxRows===q)return;const Z=h==="insert_row_below"?"below":"above";g=(p=g)!==null&&p!==void 0?p:Z==="below"?q:0;const{delta:K,startPhysicalIndex:ce}=l.createRow(g,_,{source:I,mode:Z});if(K){const Fe=V.selectedRange.current(),ye=Fe==null?void 0:Fe.from,xe=ye==null?void 0:ye.row,ve=r.toVisualRow(ce);if(V.isSelectedByCorner())V.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(oe(xe)&&xe>=ve){const{row:S,col:v}=Fe.to;let O=ye.col;V.isSelectedByRowHeader()&&(O=-1),V.getSelectedRange().pop(),V.setRangeStartOnly(r._createCellCoords(xe+K,O),!0),V.setRangeEnd(r._createCellCoords(S+K,v))}else r._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Me=h==="insert_col_end"?"end":"start";g=(E=g)!==null&&E!==void 0?E:Me==="end"?r.countSourceCols():0;const{delta:Ee,startPhysicalIndex:Te}=l.createCol(g,_,{source:I,mode:Me});if(Ee){if(Array.isArray(y.colHeaders)){const S=[r.toVisualColumn(Te),0];S.length+=Ee,Array.prototype.splice.apply(y.colHeaders,S)}const Fe=V.selectedRange.current(),ye=Fe==null?void 0:Fe.from,xe=ye==null?void 0:ye.col,ve=r.toVisualColumn(Te);if(V.isSelectedByCorner())V.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(oe(xe)&&xe>=ve){const{row:S,col:v}=Fe.to;let O=ye.row;V.isSelectedByColumnHeader()&&(O=-1),V.getSelectedRange().pop(),V.setRangeStartOnly(r._createCellCoords(O,xe+Ee),!0),V.setRangeEnd(r._createCellCoords(S,v+Ee))}else r._refreshBorders()}break;case"remove_row":const G=Fe=>{let ye=0;T(Fe,xe=>{let[ve,S]=xe;const v=Vt(ve)?r.countRows()-1:Math.max(ve-ye,0);if(Number.isInteger(ve)&&(ve=Math.max(ve-ye,0)),!l.removeRow(ve,S,I))return;const F=r.countRows(),x=y.fixedRowsTop;x>=v+1&&(y.fixedRowsTop-=Math.min(S,x-v));const k=y.fixedRowsBottom;k&&v>=F-k&&(y.fixedRowsBottom-=Math.min(S,k)),ye+=S})};Array.isArray(g)?G(W(g)):G([[g,_]]),c.adjustRowsAndCols(),r._refreshBorders();break;case"remove_col":const Ye=Fe=>{let ye=0;T(Fe,xe=>{let[ve,S]=xe;const v=Vt(ve)?r.countCols()-1:Math.max(ve-ye,0);let O=r.toPhysicalColumn(v);if(Number.isInteger(ve)&&(ve=Math.max(ve-ye,0)),!l.removeCol(ve,S,I))return;const x=y.fixedColumnsStart;x>=v+1&&(y.fixedColumnsStart-=Math.min(S,x-v)),Array.isArray(y.colHeaders)&&(typeof O>"u"&&(O=-1),y.colHeaders.splice(O,S)),ye+=S})};Array.isArray(g)?Ye(W(g)):Ye([[g,_]]),c.adjustRowsAndCols(),r._refreshBorders();break;default:throw new Error(`There is no such action "${h}"`)}Y||c.adjustRowsAndCols()},adjustRowsAndCols(){const h=y.minRows,g=y.minSpareRows,p=y.minCols,E=y.minSpareCols;if(r.countRows()===0&&r.countCols()===0&&V.deselect(),h){const _=r.countRows();_<h&&l.createRow(_,h-_,{source:"auto"})}if(g){const _=r.countEmptyRows(!0);if(_<g){const I=g-_,Y=Math.min(I,y.maxRows-r.countSourceRows());l.createRow(r.countRows(),Y,{source:"auto"})}}{let _;(p||E)&&(_=r.countEmptyCols(!0));let I=r.countCols();if(p&&!y.columns&&I<p){const Y=p-I;_+=Y,l.createCol(I,Y,{source:"auto"})}if(E&&!y.columns&&r.dataType==="array"&&_<E){I=r.countCols();const Y=E-_,W=Math.min(Y,y.maxCols-I);l.createCol(I,W,{source:"auto"})}}if(V.isSelected()){const _=r.countRows(),I=r.countCols();T(V.selectedRange,Y=>{let W=!1,q=Y.from.row,Z=Y.from.col,K=Y.to.row,ce=Y.to.col;q>_-1?(q=_-1,W=!0,K>q&&(K=q)):K>_-1&&(K=_-1,W=!0,q>K&&(q=K)),Z>I-1?(Z=I-1,W=!0,ce>Z&&(ce=Z)):ce>I-1&&(ce=I-1,W=!0,Z>ce&&(Z=ce)),W&&r.selectCell(q,Z,K,ce)})}r.view&&r.view.adjustElementsSize()},populateFromArray(h,g,p,E,_){let I,Y,W,q;const Z=[],K={},ce=[],Me=h.row,Ee=h.col;if(Y=g.length,Y===0)return!1;let Te=0,G=0;switch(De(p)&&(Te=p.col-Ee+1,G=p.row-Me+1),_){case"shift_down":const Ye=Wa(g),Fe=Ye.length,ye=Math.max(Fe,Te),xe=r.getData().slice(Me),ve=Wa(xe).slice(Ee,Ee+ye);for(W=0;W<ye;W+=1)if(W<Fe){for(I=0,Y=Ye[W].length;I<G-Y;I+=1)Ye[W].push(Ye[W][I%Y]);W<ve.length?ce.push(Ye[W].concat(ve[W])):ce.push(Ye[W].concat(new Array(xe.length).fill(null)))}else ce.push(Ye[W%Fe].concat(ve[W]));r.populateFromArray(Me,Ee,Wa(ce));break;case"shift_right":const S=g.length,v=Math.max(S,G),O=r.getData().slice(Me).map(U=>U.slice(Ee));for(I=0;I<v;I+=1)if(I<S){for(W=0,q=g[I].length;W<Te-q;W+=1)g[I].push(g[I][W%q]);if(I<O.length)for(let U=0;U<O[I].length;U+=1)g[I].push(O[I][U]);else g[I].push(...new Array(O[0].length).fill(null))}else g.push(g[I%Y].slice(0,v).concat(O[I]));r.populateFromArray(Me,Ee,g);break;case"overwrite":default:K.row=h.row,K.col=h.col;let F=0,x=0,k=!0,P;const D=function(se){let he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ce=g[se%g.length];return he!==null?Ce[he%Ce.length]:Ce},B=g.length,L=p?p.row-h.row+1:0;for(p?Y=L:Y=Math.max(B,L),I=0;I<Y&&!(p&&K.row>p.row&&L>B||!y.allowInsertRow&&K.row>r.countRows()-1||K.row>=y.maxRows);I++){const U=I-F,se=D(U).length,he=p?p.col-h.col+1:0;if(p?q=he:q=Math.max(se,he),K.col=h.col,P=r.getCellMeta(K.row,K.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&P.skipRowOnPaste){F+=1,K.row+=1,Y+=1;continue}for(x=0,W=0;W<q&&!(p&&K.col>p.col&&he>se||!y.allowInsertColumn&&K.col>r.countCols()-1||K.col>=y.maxCols);W++){if(P=r.getCellMeta(K.row,K.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&P.skipColumnOnPaste){x+=1,K.col+=1,q+=1;continue}if(P.readOnly&&E!=="UndoRedo.undo"){K.col+=1;continue}const Ce=W-x;let _e=D(U,Ce),ke=r.getDataAtCell(K.row,K.col);if(_e!==null&&typeof _e=="object")if(Array.isArray(_e)&&ke===null&&(ke=[]),ke===null||typeof ke!="object")k=!1;else{const gt=Ar(Array.isArray(ke)?ke:ke[0]||ke),je=Ar(Array.isArray(_e)?_e:_e[0]||_e);Ah(gt,je)||Array.isArray(gt)&&Array.isArray(je)?_e=Qt(_e):k=!1}else ke!==null&&typeof ke=="object"&&(k=!1);k&&Z.push([K.row,K.col,_e]),k=!0,K.col+=1}K.row+=1}r.setDataAtCell(Z,null,null,E||"populateFromArray");break}}};function ee(h){const g=QT(h);YC(g)?(r.runHooks("beforeLanguageChange",g),M.language=g,r.runHooks("afterLanguageChange",g)):JT(h)}function j(h,g){const p=h==="className"?r.rootElement:r.table;if(m)J(p,g);else{let E=[],_=[];M[h]&&(E=Array.isArray(M[h])?M[h]:tp(M[h])),g&&(_=Array.isArray(g)?g:tp(g));const I=ep(E,_),Y=ep(_,E);I.length&&Pe(p,I),Y.length&&J(p,Y)}M[h]=g}this.init=function(){u.setData(y.data),r.runHooks("beforeInit"),(io()||Vw())&&J(r.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new GB(this),d=r$.getInstance(r,y,V),f=new u$(r),gc(this)&&SY(r),r.runHooks("init"),this.forceFullRender=!0,this.view.render(),m&&r.rootElement.offsetParent===null&&NE(r.rootElement,()=>{r.view._wt.wtOverlays.updateLastSpreaderSize(),r.render(),r.view.adjustElementsSize()}),typeof m=="object"&&(r.runHooks("afterChange",m[0],m[1]),m=!1),r.runHooks("afterInit")};function X(){let h=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,h=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&h===!1&&(h=!0,this.onQueueEmpty(this.valid))}}}function ie(h){const g=h.replace(",",".");return isNaN(parseFloat(g))===!1?parseFloat(g):h}function ae(h,g,p){if(!h.length)return;const E=r.getActiveEditor(),_=new X;let I=!0;_.onQueueEmpty=Y=>{E&&I&&E.cancelChanges(),p(Y)};for(let Y=h.length-1;Y>=0;Y--){const[W,q,,Z]=h[Y],K=l.propToCol(q),ce=r.getCellMeta(W,K);ce.type==="numeric"&&typeof Z=="string"&&aT(Z)&&(h[Y][3]=ie(Z)),r.getCellValidator(ce)&&(_.addValidatorToQueue(),r.validateCell(h[Y][3],ce,function(Me,Ee){return function(Te){if(typeof Te!="boolean")throw new Error("Validation error: result is not boolean");if(Te===!1&&Ee.allowInvalid===!1){I=!1,h.splice(Me,1),Ee.valid=!0;const G=r.getCell(Ee.visualRow,Ee.visualCol);G!==null&&Pe(G,y.invalidCellClassName)}_.removeValidatorFormQueue()}}(Y,ce),g))}_.checkIfQueueIsEmpty()}function re(h,g){let p=h.length-1;if(p<0)return;for(;p>=0;p--){let _=!1;if(h[p]===null){h.splice(p,1);continue}if(!((h[p][2]===null||h[p][2]===void 0)&&(h[p][3]===null||h[p][3]===void 0))){if(y.allowInsertRow)for(;h[p][0]>r.countRows()-1;){const{delta:I}=l.createRow(void 0,void 0,{source:g});if(I===0){_=!0;break}}if(r.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(h[p][1])>r.countCols()-1;){const{delta:I}=l.createCol(void 0,void 0,{source:g});if(I===0){_=!0;break}}_||l.set(h[p][0],h[p][1],h[p][3])}}r.forceFullRender=!0,c.adjustRowsAndCols(),r.runHooks("beforeChangeRender",h,g),d.lockEditor(),r._refreshBorders(null),d.unlockEditor(),r.view.adjustElementsSize(),r.runHooks("afterChange",h,g||"edit");const E=r.getActiveEditor();E&&oe(E.refreshValue)&&E.refreshValue()}this._createCellCoords=function(h,g){return r.view._wt.createCellCoords(h,g)},this._createCellRange=function(h,g,p){return r.view._wt.createCellRange(h,g,p)},this.validateCell=function(h,g,p,E){let _=r.getCellValidator(g);function I(Y){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||g.hidden===!0){p(Y);return}const q=g.visualCol,Z=g.visualRow,K=r.getCell(Z,q,!0);if(K&&K.nodeName!=="TH"){const ce=r.rowIndexMapper.getRenderableFromVisualIndex(Z),Me=r.columnIndexMapper.getRenderableFromVisualIndex(q);r.view._wt.getSetting("cellRenderer",ce,Me,K)}p(Y)}CE(_)&&(_=function(Y){return function(W,q){q(Y.test(W))}}(_)),dt(_)?(h=r.runHooks("beforeValidate",h,g.visualRow,g.prop,E),r._registerImmediate(()=>{_.call(g,h,Y=>{r&&(Y=r.runHooks("afterValidate",Y,h,g.visualRow,g.prop,E),g.valid=Y,I(Y),r.runHooks("postAfterValidate",Y,h,g.visualRow,g.prop,E))})})):r._registerImmediate(()=>{g.valid=!0,I(g.valid,!1)})};function pe(h,g,p){return Array.isArray(h)?h:[[h,g,p]]}function Oe(h,g){const p=r.getActiveEditor(),E=r.runHooks("beforeChange",h,g||"edit"),_=h.filter(I=>I!==null);return E===!1||_.length===0?(p&&p.cancelChanges(),[]):_}this.setDataAtCell=function(h,g,p,E){const _=pe(h,g,p),I=[];let Y=E,W,q,Z;for(W=0,q=_.length;W<q;W++){if(typeof _[W]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof _[W][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");_[W][1]>=this.countCols()?Z=_[W][1]:Z=l.colToProp(_[W][1]),I.push([_[W][0],Z,u.getAtCell(this.toPhysicalRow(_[W][0]),_[W][1]),_[W][2]])}!Y&&typeof h=="object"&&(Y=g);const K=Oe(I,E);r.runHooks("afterSetDataAtCell",K,Y),ae(K,Y,()=>{re(K,Y)})},this.setDataAtRowProp=function(h,g,p,E){const _=pe(h,g,p),I=[];let Y=E,W,q;for(W=0,q=_.length;W<q;W++)I.push([_[W][0],_[W][1],u.getAtCell(this.toPhysicalRow(_[W][0]),_[W][1]),_[W][2]]);!Y&&typeof h=="object"&&(Y=g);const Z=Oe(I,E);r.runHooks("afterSetDataAtRowProp",Z,Y),ae(Z,Y,()=>{re(Z,Y)})},this.listen=function(){r&&!r.isListening()&&(Sg.forEach(h=>{r!==h&&h.unlisten()}),Cg=r.guid,r.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(Cg=null,r.runHooks("afterUnlisten"))},this.isListening=function(){return Cg===r.guid},this.destroyEditor=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;r._refreshBorders(h,g)},this.populateFromArray=function(h,g,p,E,_,I,Y){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const W=typeof E=="number"?r._createCellCoords(E,_):null;return c.populateFromArray(r._createCellCoords(h,g),p,W,I,Y)},this.spliceCol=function(h,g,p){for(var E=arguments.length,_=new Array(E>3?E-3:0),I=3;I<E;I++)_[I-3]=arguments[I];return l.spliceCol(h,g,p,..._)},this.spliceRow=function(h,g,p){for(var E=arguments.length,_=new Array(E>3?E-3:0),I=3;I<E;I++)_[I-3]=arguments[I];return l.spliceRow(h,g,p,..._)},this.getSelected=function(){if(V.isSelected())return Ve(V.getSelectedRange(),h=>{let{from:g,to:p}=h;return[g.row,g.col,p.row,p.col]})},this.getSelectedLast=function(){const h=this.getSelected();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.getSelectedRange=function(){if(V.isSelected())return Array.from(V.getSelectedRange())},this.getSelectedRangeLast=function(){const h=this.getSelectedRange();let g;return h&&h.length>0&&(g=h[h.length-1]),g},this.emptySelectedCells=function(h){if(!V.isSelected()||this.countRows()===0||this.countCols()===0)return;const g=[];T(V.getSelectedRange(),p=>{if(p.isSingleHeader())return;const E=p.getTopStartCorner(),_=p.getBottomEndCorner();me(E.row,_.row,I=>{me(E.col,_.col,Y=>{this.getCellMeta(I,Y).readOnly||g.push([I,Y,null])})})}),g.length>0&&this.setDataAtCell(g,h)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const h=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(h,0),!this.isRenderSuspended()&&h===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(h){this.suspendRender();const g=h();return this.resumeRender(),g},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const g=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(g,0),(!this.isExecutionSuspended()&&g===this.executionSuspendedCounter||h)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=h();return this.resumeExecution(g),p},this.batch=function(h){this.suspendRender(),this.suspendExecution();const g=h();return this.resumeExecution(),this.resumeRender(),g},this.refreshDimensions=function(){if(!r.view)return;const{width:h,height:g}=r.view.getLastSize(),{width:p,height:E}=r.rootElement.getBoundingClientRect(),_=p!==h||E!==g;r.runHooks("beforeRefreshDimensions",{width:h,height:g},{width:p,height:E},_)!==!1&&((_||r.view._wt.wtOverlays.scrollableElement===r.rootWindow)&&(r.view.setLastSize(p,E),r.render()),r.runHooks("afterRefreshDimensions",{width:h,height:g},{width:p,height:E},_))},this.updateData=function(h,g){Hy(h,p=>{l=p},p=>{l=p,r.columnIndexMapper.fitToLength(this.getInitialColumnCount()),r.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:r,dataMap:l,dataSource:u,internalSource:"updateData",source:g,metaManager:b,firstRun:m})},this.loadData=function(h,g){Hy(h,p=>{l=p},()=>{b.clearCellsCache(),r.initIndexMappers(),c.adjustRowsAndCols(),m&&(m=[null,"loadData"])},{hotInstance:r,dataMap:l,dataSource:u,internalSource:"loadData",source:g,metaManager:b,firstRun:m})},this.getInitialColumnCount=function(){const h=y.columns;let g=0;if(Array.isArray(h))g=h.length;else if(dt(h))if(r.dataType==="array"){const p=this.countSourceCols();for(let E=0;E<p;E+=1)h(E)&&(g+=1)}else(r.dataType==="object"||r.dataType==="function")&&(g=l.colToPropCache.length);else if(oe(y.dataSchema)){const p=l.getSchema();g=Array.isArray(p)?p.length:Ih(p)}else g=this.countSourceCols();return g},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(h,g,p,E){return ft(h)?l.getAll():l.getRange(r._createCellCoords(h,g),r._createCellCoords(p,E),l.DESTINATION_RENDERER)},this.getCopyableText=function(h,g,p,E){return l.getCopyableText(r._createCellCoords(h,g),r._createCellCoords(p,E))},this.getCopyableData=function(h,g){return l.getCopyable(h,l.colToProp(g))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(m?r.loadData:r.updateData).bind(this);let E=!1,_,I;if(oe(h.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(oe(h.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(oe(h.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(_ in h)_==="data"||(_==="language"?ee(h.language):_==="className"?j("className",h.className):_==="tableClassName"&&r.table?(j("tableClassName",h.tableClassName),r.view._wt.wtOverlays.syncOverlayTableClassNames()):de.getSingleton().isRegistered(_)||de.getSingleton().isDeprecated(_)?(dt(h[_])||Array.isArray(h[_]))&&(h[_].initialHook=!0,r.addHook(_,h[_])):!g&&Rt(h,_)&&(M[_]=h[_]));h.data===void 0&&y.data===void 0?p(null,"updateSettings"):h.data!==void 0?p(h.data,"updateSettings"):h.columns!==void 0&&(l.createMap(),r.initIndexMappers());const Y=r.countCols(),W=y.columns;if(W&&dt(W)&&(E=!0),(h.cell!==void 0||h.cells!==void 0||h.columns!==void 0)&&b.clearCache(),Y>0)for(_=0,I=0;_<Y;_++){if(W){const K=E?W(_):W[I];K&&b.updateColumnMeta(I,K)}I+=1}oe(h.cell)&&We(h.cell,K=>{r.setCellMetaObject(K.row,K.col,K)}),r.runHooks("afterCellMetaReset");let q=r.rootElement.style.height;q!==""&&(q=parseInt(r.rootElement.style.height,10));let Z=h.height;if(dt(Z)&&(Z=Z()),g&&r.rootElement.getAttribute("style")&&r.rootElement.setAttribute("data-initialstyle",r.rootElement.getAttribute("style")),Z===null){const K=r.rootElement.getAttribute("data-initialstyle");K&&(K.indexOf("height")>-1||K.indexOf("overflow")>-1)?r.rootElement.setAttribute("style",K):(r.rootElement.style.height="",r.rootElement.style.overflow="")}else Z!==void 0&&(r.rootElement.style.height=isNaN(Z)?`${Z}`:`${Z}px`,r.rootElement.style.overflow="hidden");if(typeof h.width<"u"){let K=h.width;dt(K)&&(K=K()),r.rootElement.style.width=isNaN(K)?`${K}`:`${K}px`}g||(r.view&&(r.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),r.view._wt.exportSettingsAsClassNames()),r.runHooks("afterUpdateSettings",h)),c.adjustRowsAndCols(),r.view&&!m&&(r.forceFullRender=!0,d.lockEditor(),r._refreshBorders(null),r.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!g&&r.view&&(q===""||Z===""||Z===void 0)&&q!==Z&&r.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const h=r.getSelectedLast();if(y.getValue){if(dt(y.getValue))return y.getValue.call(r);if(h)return r.getData()[h[0][0]][y.getValue]}else if(h)return r.getDataAtCell(h[0],h[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(h,g,p,E,_){c.alter(h,g,p,E,_)},this.getCell=function(h,g){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=g,_=h;if(g>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(g)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(g)}if(h>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(h)))return null;_=this.rowIndexMapper.getRenderableFromVisualIndex(h)}return _===null||E===null?null:r.view.getCellAtCoords(r._createCellCoords(_,E),p)},this.getCoords=function(h){const g=this.view._wt.wtTable.getCoords(h);if(g===null)return null;const{row:p,col:E}=g;let _=p,I=E;return p>=0&&(_=this.rowIndexMapper.getVisualFromRenderableIndex(p)),E>=0&&(I=this.columnIndexMapper.getVisualFromRenderableIndex(E)),r._createCellCoords(_,I)},this.colToProp=function(h){return l.colToProp(h)},this.propToCol=function(h){return l.propToCol(h)},this.toVisualRow=h=>this.rowIndexMapper.getVisualFromPhysicalIndex(h),this.toVisualColumn=h=>this.columnIndexMapper.getVisualFromPhysicalIndex(h),this.toPhysicalRow=h=>this.rowIndexMapper.getPhysicalFromVisualIndex(h),this.toPhysicalColumn=h=>this.columnIndexMapper.getPhysicalFromVisualIndex(h),this.getDataAtCell=function(h,g){return l.get(h,l.colToProp(g))},this.getDataAtRowProp=function(h,g){return l.get(h,g)},this.getDataAtCol=function(h){const g=[],p=l.getRange(r._createCellCoords(0,h),r._createCellCoords(y.data.length-1,h),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let _=0;_<p[E].length;_+=1)g.push(p[E][_]);return g},this.getDataAtProp=function(h){const g=[],p=l.getRange(r._createCellCoords(0,l.propToCol(h)),r._createCellCoords(y.data.length-1,l.propToCol(h)),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let _=0;_<p[E].length;_+=1)g.push(p[E][_]);return g},this.getSourceData=function(h,g,p,E){let _;return h===void 0?_=u.getData():_=u.getByRange(r._createCellCoords(h,g),r._createCellCoords(p,E)),_},this.getSourceDataArray=function(h,g,p,E){let _;return h===void 0?_=u.getData(!0):_=u.getByRange(r._createCellCoords(h,g),r._createCellCoords(p,E),!0),_},this.getSourceDataAtCol=function(h){return u.getAtColumn(h)},this.setSourceDataAtCell=function(h,g,p,E){const _=pe(h,g,p),I=this.hasHook("afterSetSourceDataAtCell"),Y=[];I&&T(_,q=>{let[Z,K,ce]=q;Y.push([Z,K,u.getAtCell(Z,K),ce])}),T(_,q=>{let[Z,K,ce]=q;u.setAtCell(Z,K,ce)}),I&&this.runHooks("afterSetSourceDataAtCell",Y,E),this.render();const W=r.getActiveEditor();W&&oe(W.refreshValue)&&W.refreshValue()},this.getSourceDataAtRow=function(h){return u.getAtRow(h)},this.getSourceDataAtCell=function(h,g){return u.getAtCell(h,g)},this.getDataAtRow=function(h){return l.getRange(r._createCellCoords(h,0),r._createCellCoords(h,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(h,g,p,E){const _=h===void 0?[0,0,this.countRows(),this.countCols()]:[h,g,p,E],[I,Y]=_;let[,,W,q]=_,Z=null,K=null;W===void 0&&(W=I),q===void 0&&(q=Y);let ce="mixed";return me(Math.max(Math.min(I,W),0),Math.max(I,W),Me=>{let Ee=!0;return me(Math.max(Math.min(Y,q),0),Math.max(Y,q),Te=>(K=this.getCellMeta(Me,Te).type,Z?Ee=Z===K:Z=K,Ee)),ce=Ee?K:"mixed",Ee}),ce},this.removeCellMeta=function(h,g,p){const[E,_]=[this.toPhysicalRow(h),this.toPhysicalColumn(g)];let I=b.getCellMetaKeyValue(E,_,p);r.runHooks("beforeRemoveCellMeta",h,g,p,I)!==!1&&(b.removeCellMeta(E,_,p),r.runHooks("afterRemoveCellMeta",h,g,p,I)),I=null},this.spliceCellsMeta=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,E=new Array(p>2?p-2:0),_=2;_<p;_++)E[_-2]=arguments[_];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");g>0&&b.removeRow(this.toPhysicalRow(h),g),E.length>0&&T(E.reverse(),I=>{b.createRow(this.toPhysicalRow(h)),T(I,(Y,W)=>this.setCellMetaObject(h,W,Y))}),r.render()},this.setCellMetaObject=function(h,g,p){typeof p=="object"&&We(p,(E,_)=>{this.setCellMeta(h,g,_,E)})},this.setCellMeta=function(h,g,p,E){if(r.runHooks("beforeSetCellMeta",h,g,p,E)===!1)return;let I=h,Y=g;h<this.countRows()&&(I=this.toPhysicalRow(h)),g<this.countCols()&&(Y=this.toPhysicalColumn(g)),b.setCellMeta(I,Y,p,E),r.runHooks("afterSetCellMeta",h,g,p,E)},this.getCellsMeta=function(){return b.getCellsMeta()},this.getCellMeta=function(h,g){let p=this.toPhysicalRow(h),E=this.toPhysicalColumn(g);return p===null&&(p=h),E===null&&(E=g),b.getCellMeta(p,E,{visualRow:h,visualColumn:g})},this.getCellMetaAtRow=function(h){return b.getCellsMetaAtRow(h)},this.isColumnModificationAllowed=function(){return!(r.dataType==="object"||y.columns)},this.getCellRenderer=function(h,g){const p=typeof h=="number"?r.getCellMeta(h,g).renderer:h.renderer;return typeof p=="string"?Gc(p):ft(p)?Gc("text"):p},this.getCellEditor=function(h,g){const p=typeof h=="number"?r.getCellMeta(h,g).editor:h.editor;return typeof p=="string"?Uc(p):ft(p)?Uc("text"):p},this.getCellValidator=function(h,g){const p=typeof h=="number"?r.getCellMeta(h,g).validator:h.validator;return typeof p=="string"?Zw(p):p},this.validateCells=function(h){this._validateCells(h)},this.validateRows=function(h,g){if(!Array.isArray(h))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(g,h)},this.validateColumns=function(h,g){if(!Array.isArray(h))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(g,void 0,h)},this._validateCells=function(h,g,p){const E=new X;h&&(E.onQueueEmpty=h);let _=r.countRows()-1;for(;_>=0;){if(g!==void 0&&g.indexOf(_)===-1){_-=1;continue}let I=r.countCols()-1;for(;I>=0;){if(p!==void 0&&p.indexOf(I)===-1){I-=1;continue}E.addValidatorToQueue(),r.validateCell(r.getDataAtCell(_,I),r.getCellMeta(_,I),Y=>{if(typeof Y!="boolean")throw new Error("Validation error: result is not boolean");Y===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),I-=1}_-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(h){let g=y.rowHeaders,p=h;return p!==void 0&&(p=r.runHooks("modifyRowHeader",p)),p===void 0?(g=[],me(r.countRows()-1,E=>{g.push(r.getRowHeader(E))})):Array.isArray(g)&&g[p]!==void 0?g=g[p]:dt(g)?g=g(p):g&&typeof g!="string"&&typeof g!="number"&&(g=p+1),g},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let h=0,g=r.countCols();h<g;h++)if(r.getColHeader(h))return!0;return!1},this.getColHeader=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=r.runHooks("modifyColHeader",h);if(p===void 0){const W=[],q=r.countCols();for(let Z=0;Z<q;Z++)W.push(r.getColHeader(Z));return W}let E=y.colHeaders;const _=function(W){const q=[],Z=r.countCols();let K=0;for(;K<Z;K++)dt(y.columns)&&y.columns(K)&&q.push(K);return q[W]},I=r.toPhysicalColumn(p),Y=_(I);return y.colHeaders===!1?E=null:y.columns&&dt(y.columns)&&y.columns(Y)&&y.columns(Y).title?E=y.columns(Y).title:y.columns&&y.columns[I]&&y.columns[I].title?E=y.columns[I].title:Array.isArray(y.colHeaders)&&y.colHeaders[I]!==void 0?E=y.colHeaders[I]:dt(y.colHeaders)?E=y.colHeaders(I):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(E=Nh(p)),E=r.runHooks("modifyColumnHeaderValue",E,h,g),E},this._getColWidthFromSettings=function(h){let g;if(h>=0&&(g=r.getCellMeta(0,h).width),(g===void 0||g===y.width)&&(g=y.colWidths),g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getColWidth=function(h){let g=r._getColWidthFromSettings(h);return g=r.runHooks("modifyColWidth",g,h),g===void 0&&(g=Jw.DEFAULT_WIDTH),g},this._getRowHeightFromSettings=function(h){let g=y.rowHeights;if(g!=null){switch(typeof g){case"object":g=g[h];break;case"function":g=g(h);break}typeof g=="string"&&(g=parseInt(g,10))}return g},this.getRowHeight=function(h){let g=r._getRowHeightFromSettings(h);return g=r.runHooks("modifyRowHeight",g,h),g},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const h=y.maxCols,g=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(h,g)},this.countRenderedRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return r.view._wt.drawn?r.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return Yc(r.countRows()-1,p=>{if(r.isEmptyRow(p))g+=1;else if(h===!0)return!1}),g},this.countEmptyCols=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=0;return Yc(r.countCols()-1,p=>{if(r.isEmptyCol(p))g+=1;else if(h===!0)return!1}),g},this.isEmptyRow=function(h){return y.isEmptyRow.call(r,h)},this.isEmptyCol=function(h){return y.isEmptyCol.call(r,h)},this.selectCell=function(h,g,p,E){let _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,I=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return ft(h)||ft(g)?!1:this.selectCells([[h,g,p,E]],_,I)},this.selectCells=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;g===!1&&(i=!0);const E=V.selectCells(h);return E&&p&&r.listen(),i=!1,E},this.selectColumns=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,p=arguments.length>2?arguments[2]:void 0;return V.selectColumns(h,g,p)},this.selectRows=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,p=arguments.length>2?arguments[2]:void 0;return V.selectRows(h,g,p)},this.deselectCell=function(){V.deselect()},this.selectAll=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h,p=arguments.length>2?arguments[2]:void 0;i=!0,V.selectAll(h,g,p),i=!1};const Je=(h,g)=>h.getNearestNotHiddenIndex(g,1,!0);this.scrollViewportTo=function(){let{row:h,col:g,verticalSnap:p,horizontalSnap:E,considerHiddenIndexes:_}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I,Y,W,q;p!==void 0&&(I=p==="top",Y=!I),E!==void 0&&(W=E==="start",q=!W);let Z=h,K=g;if(_===void 0||_){const Ee=Number.isInteger(h)&&h>=0,Te=Number.isInteger(g)&&g>=0,G=Ee?Je(this.rowIndexMapper,h):void 0,Ye=Te?Je(this.columnIndexMapper,g):void 0;if(G===null||Ye===null)return!1;Z=Ee?r.rowIndexMapper.getRenderableFromVisualIndex(G):h,K=Te?r.columnIndexMapper.getRenderableFromVisualIndex(Ye):g}const ce=Number.isInteger(Z),Me=Number.isInteger(K);return ce&&Z>=0&&Me&&K>=0?r.view.scrollViewport(r._createCellCoords(Z,K),I,q,Y,W):ce&&Z>=0&&(Me&&K<0||!Me)?r.view.scrollViewportVertically(Z,I,Y):Me&&K>=0&&(ce&&Z<0||!ce)?r.view.scrollViewportHorizontally(K,q,W):!1},this.scrollToFocusedCell=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",h);const{highlight:g}=this.getSelectedRangeLast();this.scrollViewportTo(g.toObject())?this.view.render():(this.removeHook("afterScroll",h),this._registerImmediate(()=>h()))},this.destroy=function(){if(r._clearTimeouts(),r._clearImmediates(),r.view&&r.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),b.clearCache(),Sg.delete(this.guid),gc(r)){const h=this.rootDocument.querySelector(".hot-display-license-info");h&&h.parentNode.removeChild(h)}hs(r.rootElement),a.destroy(),d&&d.destroy(),r.batchExecution(()=>{r.rowIndexMapper.unregisterAll(),r.columnIndexMapper.unregisterAll(),A.getItems().forEach(h=>{let[,g]=h;g.destroy()}),A.clear(),r.runHooks("afterDestroy")},!0),de.getSingleton().destroy(r),We(r,(h,g,p)=>{dt(h)?p[g]=Ie(g):g!=="guid"&&(p[g]=null)}),r.isDestroyed=!0,l&&l.destroy(),l=null,c=null,V=null,d=null,r=null};function Ie(h){return()=>{throw new Error(`The "${h}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(h){const g=un(h);return g==="UndoRedo"?this.undoRedo:A.getItem(g)},this.getPluginName=function(h){return h===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:A.getId(h)},this.getInstance=function(){return r},this.addHook=function(h,g){de.getSingleton().add(h,g,r)},this.hasHook=function(h){return de.getSingleton().has(h,r)||de.getSingleton().has(h)},this.addHookOnce=function(h,g){de.getSingleton().once(h,g,r)},this.removeHook=function(h,g){de.getSingleton().remove(h,g,r)},this.runHooks=function(h,g,p,E,_,I,Y){return de.getSingleton().run(r,h,g,p,E,_,I,Y)},this.getTranslatedPhrase=function(h,g){return oM(y.language,h,g)},this.toHTML=()=>hp(this),this.toTableElement=()=>{const h=this.rootDocument.createElement("div");return h.insertAdjacentHTML("afterbegin",hp(this)),h.firstElementChild},this.timeouts=[],this._registerTimeout=function(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=h;typeof p=="function"&&(p=setTimeout(p,g)),this.timeouts.push(p)},this._clearTimeouts=function(){T(this.timeouts,h=>{clearTimeout(h)})},this.immediates=[],this._registerImmediate=function(h){this.immediates.push(setImmediate(h))},this._clearImmediates=function(){T(this.immediates,h=>{clearImmediate(h)})},this._refreshBorders=function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(h),r.view.render(),g&&V.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return r.rootWindow.getComputedStyle(r.rootElement).direction==="rtl"},this.isLtr=function(){return!r.isRtl()},this.getDirectionFactor=function(){return r.isLtr()?1:-1};const R=TY({handleEvent(){return r.isListening()},beforeKeyDown:h=>this.runHooks("beforeKeyDown",h),afterKeyDown:h=>{this.isDestroyed||r.runHooks("afterDocumentKeyDown",h)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",h=>{h.ctrlKey===!1&&h.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},qw().forEach(h=>{const g=Al(h);A.addItem(h,new g(this))}),wY(r),R.setActiveContextName("grid"),de.getSingleton().run(r,"construct")}const MY="hooksRefRegisterer",yM={_hooksStorage:Object.create(null),addHook(n,e){return this._hooksStorage[n]||(this._hooksStorage[n]=[]),this.hot.addHook(n,e),this._hooksStorage[n].push(e),this},removeHooksByKey(n){T(this._hooksStorage[n]||[],e=>{this.hot.removeHook(n,e)})},clearHooks(){We(this._hooksStorage,(n,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Ls(yM,"MIXIN_NAME",MY,{writable:!1,enumerable:!1});const _Y=yM,OY="base",$t=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Tp="baseEditor";class Gr{static get EDITOR_TYPE(){return OY}constructor(e){this.hot=e,this.instance=e,this.state=$t.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.TD=null,this.row=null,this.col=null,this.prop=null,this.originalValue=null,this.cellProperties=null,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,s,o,i,r){this.TD=o,this.row=e,this.col=t,this.prop=s,this.originalValue=i,this.cellProperties=r,this.state=$t.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let s,o,i,r;if(t){const d=this.hot.getSelectedLast();s=Math.max(Math.min(d[0],d[2]),0),o=Math.max(Math.min(d[1],d[3]),0),i=Math.max(d[0],d[2]),r=Math.max(d[1],d[3])}else[s,o,i,r]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",s,o);Array.isArray(a)&&([s,o]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>oe(this.hot.getSelected()),group:Tp};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(s,o,e,i,r,"edit")}beginEditing(e,t){if(this.state!==$t.VIRGIN)return;const s=this.hot,o=s.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=s.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(s.view.scrollViewport(s._createCellCoords(o,i)),this.state=$t.EDITING,this.isInFullEditMode()){const r=typeof e=="string"?e:At(this.originalValue);this.setValue(r)}this.open(t),this._opened=!0,this.focus(),s.view.render(),s.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,s){let o;if(s){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),s(l),this.hot.view.render()}}if(this.isWaiting())return;const r=this.hot.getShortcutManager().getContext("editor");if(r.removeShortcutsByGroup(Tp),r.removeShortcutsByGroup(Hh),this.state===$t.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===$t.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?o=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:o=[[a]],this.state=$t.WAITING,this.saveValue(o,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=$t.FINISHED,this.discardEditor(l)}):(this.state=$t.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=$t.FINISHED,this.discardEditor()}discardEditor(e){this.state===$t.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=$t.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=$t.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===$t.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:s,wtViewport:o}=this.hot.view._wt,i=this.hot.rootWindow,r=Lt(t),a=ut(t),l=Lt(this.hot.rootElement),u=ut(this.hot.rootElement),c=s.topOverlay.holder,d=s.inlineStartOverlay.holder,f=c!==i?c.scrollTop:0,m=d!==i?d.scrollLeft:0,w=i.innerWidth-l.left-u,{wtTable:C}=(e=s.getParentOverlay(t))!==null&&e!==void 0?e:this.hot.view._wt,b=C.name,y=["master","inline_start"].includes(b)?f:0,M=["master","top","bottom"].includes(b)?m:0,A=r.top===l.top?0:1;let $=r.top-l.top-A-y,H=0;this.hot.isRtl()?H=i.innerWidth-r.left-a-w-1+M:H=r.left-l.left-1-M,["top","top_inline_start_corner"].includes(b)&&($+=s.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(b)&&(H+=Math.abs(s.inlineStartOverlay.getOverlayOffset()));const V=this.hot.hasColHeaders(),z=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),ee=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),X=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(V&&z<=0||z===X)&&($+=1),ee<=0&&(H+=1);const ie=o.rowsRenderCalculator.startPosition,ae=o.columnsRenderCalculator.startPosition,re=Math.abs(s.inlineStartOverlay.getScrollPosition()),pe=s.topOverlay.getScrollPosition(),Oe=Yt(this.hot.rootDocument);let Je=t.offsetTop;if(["inline_start","master"].includes(b)&&(Je+=ie-pe),["bottom","bottom_inline_start_corner"].includes(b)){const{wtViewport:Z,wtTable:K}=s.bottomOverlay.clone;Je+=Z.getWorkspaceHeight()-K.getHeight()-Oe}let Ie=t.offsetLeft;this.hot.isRtl()?(Ie>=0?Ie=C.getWidth()-t.offsetLeft:Ie=Math.abs(Ie),Ie+=ae-re-a):["top","master","bottom"].includes(b)&&(Ie+=ae-re);const R=uo(this.TD,this.hot.rootWindow),h=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",g=parseInt(R[h],10)>0?0:1,p=parseInt(R.borderTopWidth,10)>0?0:1,E=ut(t)+g,_=Et(t)+p,I=PE(c)?Oe:0,Y=DE(d)?Oe:0,W=this.hot.view.maximumVisibleElementWidth(Ie)-I+g,q=Math.max(this.hot.view.maximumVisibleElementHeight(Je)-Y+p,23);return{top:$,start:H,height:_,maxHeight:q,width:E,maxWidth:W}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?t="top-inline-start-corner":t="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?t="bottom-inline-start-corner":t="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}ht(Gr,_Y);function AY(){var n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,t=document.body,s=document.createTextNode(""),o=document.createElement("SPAN"),i=function(f,m,w){f.addEventListener(m,w,!1)},r=function(f,m,w){f.removeEventListener(m,w,!1)},a=function(f){var m,w;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",s.textContent!==void 0?s.textContent=e.value+f:s.data=e.value+f,o.style.position="absolute",o.style.fontSize=d(e).fontSize,o.style.fontFamily=d(e).fontFamily,o.style.whiteSpace="pre",t.appendChild(o),m=o.clientWidth+2,t.removeChild(o),e.style.height=n.minHeight+"px",n.minWidth>m?e.style.width=n.minWidth+"px":m>n.maxWidth?e.style.width=n.maxWidth+"px":e.style.width=m+"px",w=e.scrollHeight?e.scrollHeight-1:0,n.minHeight>w?e.style.height=n.minHeight+"px":n.maxHeight<w?(e.style.height=n.maxHeight+"px",e.style.overflowY="visible"):e.style.height=w+"px"},l=function(){window.setTimeout(a,0)},u=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")n.minHeight=e.clientHeight;else{var m=parseInt(f.minHeight);isNaN(m)||(n.minHeight=m)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")n.maxHeight=e.clientHeight;else{var w=parseInt(f.maxHeight);isNaN(w)||(n.maxHeight=w)}if(f&&f.minWidth)if(f.minWidth=="inherit")n.minWidth=e.clientWidth;else{var C=parseInt(f.minWidth);isNaN(C)||(n.minWidth=C)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")n.maxWidth=e.clientWidth;else{var b=parseInt(f.maxWidth);isNaN(b)||(n.maxWidth=b)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(s))},c=function(f,m,w){e=f,u(m),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=n.minHeight+"px",e.style.minWidth=n.minWidth+"px",e.style.maxWidth=n.maxWidth+"px",e.style.overflowY="hidden"),w&&(i(e,"change",a),i(e,"cut",l),i(e,"paste",l),i(e,"drop",l),i(e,"keydown",l),i(e,"focus",a),i(e,"compositionstart",l),i(e,"compositionupdate",l),i(e,"compositionend",l)),a()};function d(f){return f.currentStyle||document.defaultView.getComputedStyle(f)}return{init:function(f,m,w){c(f,m,w)},unObserve:function(){r(e,"change",a),r(e,"cut",l),r(e,"paste",l),r(e,"drop",l),r(e,"keydown",l),r(e,"focus",a),r(e,"compositionstart",l),r(e,"compositionupdate",l),r(e,"compositionend",l)},resize:a}}function Fy(n,e){const t=xw(e),s=e.value.split(`
`);let o=t,i=0;for(let r=0;r<s.length;r++){const a=s[r];r!==0&&(i+=s[r-1].length+1);const l=i+a.length;if(n==="home"?o=i:n==="end"&&(o=l),t<=l)break}Tl(e,o)}const IY="ht_editor_visible",Su="ht_editor_hidden",$y="textEditor",xY="text";class Vi extends Gr{static get EDITOR_TYPE(){return xY}constructor(e){super(e),this.eventManager=new It(this),this.autoResize=AY(),this.TEXTAREA=void 0,this.textareaStyle=void 0,this.TEXTAREA_PARENT=void 0,this.textareaParentStyle=void 0,this.layerClass=void 0,this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",t=>this.onAfterDocumentKeyDown(t)),this.registerShortcuts()}close(){this.autoResize.unObserve(),ME(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,t,s,o,i,r){const a=this.state;if(super.prepare(e,t,s,o,i,r),!r.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=r;l&&(this.TEXTAREA.value=""),a!==$t.FINISHED&&this.hideEditableElement()}}beginEditing(e,t){this.state===$t.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),Tl(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Se(this.TEXTAREA,[["data-hot-input",""],Wr(-1)]),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[go()]),J(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),J(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ae(this.TEXTAREA_PARENT,this.layerClass)&&Pe(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Su),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){KE()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Pe(this.TEXTAREA_PARENT,this.layerClass),J(this.TEXTAREA_PARENT,Su)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;me(e.length-1,s=>{const o=e[s];if(Ae(o,"handsontableEditor"))return t=!0,!1}),Ae(this.TEXTAREA_PARENT,Su)&&Pe(this.TEXTAREA_PARENT,Su),t?(this.layerClass=IY,J(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),J(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==$t.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:t,start:s,width:o,maxWidth:i,height:r,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${s}px`,this.showEditableElement();const l=uo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=uo(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=o-c,m=r-d,w=i-c,C=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,w),minHeight:Math.min(m,C),maxWidth:w,maxHeight:C},!0)}bindEvents(){$w()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===$t.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===$t.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>oe(this.hot.getSelected()),group:$y},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};t.addShortcuts([{keys:[["Tab"]],callback:i=>{const r=this.hot.getSettings(),a=typeof r.tabMoves=="function"?r.tabMoves(i):r.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:i=>{const r=this.hot.getSettings(),a=typeof r.tabMoves=="function"?r.tabMoves(i):r.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:i=>!this.hot.selection.isMultiple()&&!i.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(i,r)=>{let[a]=r;Fy(a,this.TEXTAREA)}},{keys:[["End"]],callback:(i,r)=>{let[a]=r;Fy(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],s)}unregisterShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");t.removeShortcutsByGroup(Hh),t.removeShortcutsByGroup($y),t.removeShortcutsByGroup(Tp)}onAfterDocumentKeyDown(e){[fe.ARROW_UP,fe.ARROW_RIGHT,fe.ARROW_DOWN,fe.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const HY="base";function Ll(n,e,t,s,o,i,r){const a=r.ariaTags,l=[],u=[],c=[],d=[];r.className&&J(e,r.className),r.readOnly?(l.push(r.readOnlyCellClassName),a&&d.push(xv())):a&&c.push(xv()[0]),r.valid===!1&&r.invalidCellClassName?(l.push(r.invalidCellClassName),a&&d.push(Hv())):(u.push(r.invalidCellClassName),a&&c.push(Hv()[0])),r.wordWrap===!1&&r.noWordWrapClassName&&l.push(r.noWordWrapClassName),!i&&r.placeholder&&l.push(r.placeholderCellClassName),Pe(e,u),J(e,l),Jo(e,c),Se(e,d)}Ll.RENDERER_TYPE=HY;const PY="text";function Co(n,e,t,s,o,i,r){Ll.apply(this,[n,e,t,s,o,i,r]);let a=i;if(!a&&r.placeholder&&(a=r.placeholder),a=At(a),r.trimWhitespace&&(a=a.trim()),r.rendererTemplate){hs(e);const l=n.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=r.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=n.getSourceDataAtRow(t),e.appendChild(l)}else Go(e,a)}Co.RENDERER_TYPE=PY;const DY="text",bM={CELL_TYPE:DY,editor:Vi,renderer:Co};on(bM);we.editors={BaseEditor:Gr};function we(n,e){const t=new vM(n,e||{},wC);return t.init(),t}we.Core=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new vM(n,e,wC)};we.DefaultSettings=gM();we.hooks=de.getSingleton();we.CellCoords=Os;we.CellRange=Hr;we.packageName="handsontable";we.buildDate="30/10/2023 14:16:10";we.version="13.1.0";we.languages={dictionaryKeys:E2,getLanguageDictionary:sM,getLanguagesDictionaries:A2,registerLanguageDictionary:UC,getTranslatedPhrase:oM};const NY=[[!1,"Tagcat","United Kingdom","Classic Vest","11/10/2020","01-2331942",!0,"172",2,2],[!0,"Zoomzone","Indonesia","Cycling Cap","03/05/2020","88-2768633",!0,"188",6,2],[!0,"Meeveo","United States","Full-Finger Gloves","27/03/2020","51-6775945",!0,"162",1,3],[!1,"Buzzdog","Philippines","HL Mountain Frame","29/08/2020","44-4028109",!0,"133",7,1],[!0,"Katz","India","Half-Finger Gloves","02/10/2020","08-2758492",!0,"87",1,3],[!1,"Jaxbean","China","HL Road Frame","28/09/2020","84-3557705",!1,"26",8,1],[!1,"Wikido","Brazil","HL Touring Frame","24/06/2020","20-9397637",!1,"110",4,1],[!1,"Browsedrive","United States","LL Mountain Frame","13/03/2020","36-0079556",!0,"50",4,4],[!1,"Twinder","United Kingdom","LL Road Frame","06/04/2020","41-1489542",!1,"160",6,1],[!1,"Jetwire","China","LL Touring Frame","01/02/2020","37-1531629",!0,"30",8,5],[!1,"Chatterpoint","China","Long-Sleeve Logo Jersey","14/07/2020","25-5083429",!0,"39",7,2],[!1,"Twinder","Egypt","Men's Bib-Shorts","31/08/2020","04-4281278",!1,"96",6,1],[!1,"Midel","United States","Men's Sports Shorts","27/06/2020","55-1711908",!0,"108",10,3],[!1,"Yodo","India","ML Mountain Frame","16/03/2020","58-8360815",!1,"46",1,1],[!1,"Camido","Russia","ML Mountain Frame-W","13/09/2020","10-3786104",!0,"97",8,3],[!1,"Eire","Thailand","ML Road Frame","10/04/2020","45-1186054",!0,"161",1,4],[!1,"Vinte","United Kingdom","ML Road Frame-W","22/01/2020","62-6202742",!0,"58",4,3],[!1,"Twitterlist","China","Mountain Bike Socks","09/11/2020","88-9646223",!0,"92",8,3],[!1,"Eidel","Bangladesh","Mountain-100","19/09/2020","45-5588112",!0,"5",6,5],[!1,"Trunyx","Nigeria","Mountain-200","09/03/2020","66-6271819",!0,"158",4,1],[!1,"Katz","Turkey","Mountain-300","05/03/2020","38-9245023",!1,"121",5,4],[!1,"Kaymbo","United States","Mountain-400-W","24/12/2020","44-5916927",!1,"61",5,4],[!1,"Ozu","Pakistan","Mountain-500","13/06/2020","31-5449914",!0,"155",2,2],[!1,"Rhynyx","India","Racing Socks","05/12/2020","19-9413869",!0,"162",2,4],[!1,"Flashset","Iran","Road-150","14/12/2020","25-9807605",!1,"46",7,1],[!1,"Yata","Congo (Kinshasa)","Road-250","12/06/2020","74-4291983",!0,"47",4,4],[!1,"Brainlounge","Vietnam","Road-350-W","10/03/2020","83-0980643",!0,"104",2,3],[!1,"Babblestorm","United States","Road-450","10/10/2020","19-2878430",!0,"101",6,4],[!1,"Youspan","Brazil","Road-550-W","16/12/2020","19-1838230",!0,"150",10,3],[!1,"Nlounge","China","Road-650","31/10/2020","32-2267938",!0,"42",4,2],[!1,"Twinte","India","Road-750","17/08/2020","79-2821972",!0,"144",9,3],[!1,"Oyonder","United Kingdom","Short-Sleeve Classic Jersey","04/12/2020","46-6597557",!0,"195",4,1],[!1,"Gigabox","Pakistan","Sport-100","03/02/2020","15-1793960",!0,"199",4,4],[!1,"Livetube","France","Touring-1000","16/05/2020","86-0811003",!0,"110",4,5],[!1,"Voomm","United Kingdom","Touring-2000","15/07/2020","95-3068680",!0,"51",4,4],[!1,"Voonyx","China","Touring-3000","27/11/2020","35-3085360",!1,"69",2,5],[!1,"Zoombeat","United States","Women's Mountain Shorts","03/11/2020","56-8673088",!1,"53",2,3],[!1,"Roomm","China","Women's Tights","16/03/2020","76-0085918",!0,"168",1,1],[!1,"Leenti","China","Mountain-400","16/05/2020","03-0893276",!1,"58",1,4],[!1,"Jetpulse","United States","Road-550","08/02/2020","79-9013306",!0,"152",9,3],[!1,"Katz","Peru","Road-350","15/02/2020","55-7799920",!0,"66",4,2],[!1,"Cogidoo","India","LL Mountain Front Wheel","04/06/2020","07-0881122",!1,"112",9,2],[!1,"Divavu","Colombia","Touring Rear Wheel","24/02/2020","58-6157387",!0,"50",10,4],[!1,"Mydeo","China","Touring Front Wheel","07/12/2020","12-2810010",!1,"31",3,5],[!1,"Browsebug","Japan","ML Mountain Front Wheel","14/01/2020","64-9249984",!0,"132",5,5],[!1,"Layo","China","HL Mountain Front Wheel","24/04/2020","45-0739652",!0,"45",1,5],[!1,"Snaptags","United Kingdom","LL Touring Handlebars","06/08/2020","09-5712761",!0,"197",4,2],[!1,"Cogilith","China","HL Touring Handlebars","31/05/2020","01-7345008",!0,"190",4,3],[!1,"Reallinks","United Kingdom","LL Road Front Wheel","14/05/2020","62-1065350",!0,"184",3,4],[!1,"Quaxo","United States","ML Road Front Wheel","23/03/2020","44-7241323",!0,"169",3,4],[!1,"Devify","China","HL Road Front Wheel","12/12/2020","52-0295699",!1,"152",4,4],[!1,"Youopia","Angola","LL Mountain Handlebars","01/04/2020","52-2650922",!1,"182",6,4],[!1,"Ainyx","China","Touring Pedal","27/02/2020","48-3618525",!0,"141",6,1],[!1,"Browsetype","Malaysia","ML Mountain Handlebars","28/04/2020","51-8893923",!0,"169",7,1],[!1,"Muxo","China","HL Mountain Handlebars","22/08/2020","68-5911361",!1,"39",7,1],[!1,"Bubbletube","China","LL Road Handlebars","04/10/2020","41-5880042",!0,"71",8,3],[!1,"Fadeo","Vietnam","ML Road Handlebars","23/04/2020","90-5913983",!0,"148",10,3],[!1,"Yadel","United Kingdom","HL Road Handlebars","18/04/2020","92-0960699",!0,"116",8,1],[!1,"Blognation","China","LL Headset","10/01/2020","06-9493898",!0,"96",10,1],[!1,"Devpoint","China","ML Headset","25/12/2020","69-5878565",!0,"35",4,2],[!1,"Aibox","United Kingdom","HL Headset","18/03/2020","13-1133017",!0,"16",8,2],[!1,"Brightdog","China","LL Mountain Pedal","11/09/2020","39-6530433",!0,"194",2,5],[!1,"Gabcube","Nigeria","ML Mountain Pedal","22/04/2020","96-6860388",!0,"24",1,3],[!1,"Muxo","China","HL Mountain Pedal","05/06/2020","30-0356137",!0,"170",4,4],[!1,"Tambee","China","ML Touring Seat/Saddle","22/02/2020","93-9058255",!0,"184",9,5],[!1,"Cogilith","India","LL Touring Seat/Saddle","06/04/2020","82-9268909",!1,"153",10,4],[!1,"Dynabox","Hong Kong","HL Touring Seat/Saddle","10/01/2020","20-6913815",!1,"88",10,1],[!1,"Shuffledrive","Sudan","LL Road Pedal","16/09/2020","08-8238817",!0,"57",9,2],[!1,"Fivechat","China","ML Road Pedal","26/08/2020","44-7370350",!1,"62",4,1],[!1,"Meembee","United States","HL Road Pedal","27/12/2020","01-3525949",!0,"123",2,4],[!1,"Dynazzy","United Kingdom","LL Mountain Seat/Saddle 1","15/12/2020","04-2414623",!0,"77",10,5],[!1,"Eare","China","ML Mountain Seat/Saddle 1","04/04/2020","15-1917509",!1,"199",9,4],[!1,"Yozio","China","HL Mountain Seat/Saddle 1","15/03/2020","06-2526845",!0,"149",8,2],[!1,"Quinu","Xi'an","425-777-7829","22/02/2020","83-1713558",!1,"191",9,5],[!1,"Jazzy","United Kingdom","ML Road Seat/Saddle 1","07/08/2020","00-8892524",!0,"150",10,2],[!1,"Thoughtsphere","China","HL Road Seat/Saddle 1","28/11/2020","39-5538991",!0,"130",7,3],[!1,"Leenti","China","ML Road Rear Wheel","29/12/2020","06-9002973",!0,"179",1,2],[!1,"Quaxo","United Kingdom","HL Road Rear Wheel","06/09/2020","73-6104901",!0,"98",5,3],[!1,"Tanoodle","Chile","LL Mountain Seat/Saddle 2","24/05/2020","68-7384479",!0,"175",2,3],[!1,"Feednation","China","ML Mountain Seat/Saddle 2","21/11/2020","26-7757763",!0,"11",1,3],[!1,"Kayveo","China","HL Mountain Seat/Saddle 2","21/06/2020","07-4873562",!1,"184",7,4],[!1,"Meevee","Saudi Arabia","LL Road Seat/Saddle 1","16/11/2020","46-5819554",!1,"27",9,3],[!1,"Twitterworks","China","ML Road Seat/Saddle 2","19/04/2020","01-2666826",!0,"186",3,2],[!1,"Wikizz","Tanzania","HL Road Seat/Saddle 2","08/03/2020","54-7090503",!0,"20",3,3],[!1,"Yoveo","United States","LL Mountain Tire","14/10/2020","78-7658520",!1,"153",2,1],[!1,"Yakidoo","China","ML Mountain Tire","12/10/2020","23-9926318",!0,"161",8,5],[!1,"Oyope","China","HL Mountain Tire","20/09/2020","20-0179517",!0,"98",10,5],[!1,"Skipstorm","United States","LL Road Tire","01/10/2020","02-9543343",!0,"30",7,3],[!1,"Minyx","United States","ML Road Tire","07/07/2020","98-3938169",!0,"73",10,2],[!1,"Miboo","China","HL Road Tire","25/07/2020","68-5197934",!0,"158",9,1],[!1,"Realfire","United States","Touring Tire","27/08/2020","39-8260460",!0,"122",5,2],[!1,"Shufflester","China","Mountain Tire Tube","08/06/2020","45-9776170",!0,"33",2,4],[!1,"Ntag","China","Road Tire Tube","06/12/2020","45-0858451",!0,"107",6,2],[!1,"Jabberbean","United States","Touring Tire Tube","26/04/2020","15-4247305",!0,"15",1,2],[!1,"Thoughtblab","China","LL Bottom Bracket","21/05/2020","15-8534931",!0,"168",5,2],[!1,"Jabbertype","China","Classic Vest","25/07/2020","23-1251557",!0,"135",4,2],[!1,"Buzzshare","United Kingdom","Cycling Cap","07/07/2020","86-5920601",!0,"11",1,4],[!1,"Roodel","United States","Full-Finger Gloves","13/01/2020","48-1055459",!0,"41",6,4],[!1,"Zoovu","China","Half-Finger Gloves","03/06/2020","12-7842022",!0,"144",6,1],[!1,"Photofeed","China","HL Mountain Frame","14/07/2020","94-5088099",!0,"106",1,4]],Vy="selected",Wy="odd",RM=()=>["Ø¹ÙØ±","Ø¹ÙÙ","Ø¹Ø¨Ø¯ Ø§ÙÙÙ","ÙØ¹ØªØµÙ"][Math.floor(Math.random()*3)],EM=()=>["ØªØ±ÙÙØ§","ÙØµØ±","ÙØ¨ÙØ§Ù","Ø§ÙØ¹Ø±Ø§Ù"][Math.floor(Math.random()*3)],LY=()=>new Date(Math.floor(Math.random()*Date.now())).toLocaleDateString("en-gb"),By=()=>Math.random()>.5,Ga=(n=0,e=1e3)=>n+Math.floor(Math.random()*e),kY=()=>`${EM()} ${RM()} ${Ga()}`,FY=()=>`${Ga(1e5,999999).toString().match(/.{1,3}/g).join("-")}`;function $Y(){return Array.from({length:50},()=>[By(),RM(),EM(),kY(),LY(),FY(),By(),Ga(0,200).toString(),Ga(1,10),Ga(1,5)])}function wc(){return new URLSearchParams(location.search.replace(/^\?/,"")).get("arabicExample")==="1"}function VY(){return wc()?$Y():NY}const Uy="handsontableEditor",WY="handsontable";class KC extends Vi{static get EDITOR_TYPE(){return WY}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Tl(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions(),this.hot.getSettings().ariaTags&&Se(this.TD,[jt("true")])}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Se(this.TD,[jt("false")])}prepare(e,t,s,o,i,r){super.prepare(e,t,s,o,i,r);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const d=this.getSourceData(c.row,c.col);d!==void 0&&a.setValue(d),a.instance.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&kt(l,r.handsontable),this.htOptions=l}beginEditing(e,t){const s=this.hot.getSettings().onBeginEditing;s&&s()===!1||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,s){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const o=this.htEditor.getValue();o!==void 0&&this.setValue(o)}super.finishEditing(e,t,s)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const s={group:Uy,relativeToGroup:Hh,position:"before"},o=(i,r)=>{const a=this.htEditor;if(i!==void 0&&(i<0||a.flipped&&i>a.countRows()-1?a.deselectCell():a.selectCell(i,0),a.getData().length))return r.preventDefault(),Xn(r),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:i=>{const r=this.htEditor;let a,l;return!r.getSelectedLast()&&r.flipped?a=r.countRows()-1:r.getSelectedLast()&&(r.flipped?(l=r.getSelectedLast()[0],a=Math.max(0,l-1)):(l=r.getSelectedLast()[0],a=l-1)),o(a,i)},preventDefault:!1},{keys:[["ArrowDown"]],callback:i=>{const r=this.htEditor;let a,l;if(!r.getSelectedLast()&&!r.flipped)a=0;else if(r.getSelectedLast()){if(r.flipped)a=r.getSelectedLast()[0]+1;else if(!r.flipped){const u=r.countRows()-1;l=r.getSelectedLast()[0],a=Math.min(u,l+1)}}return o(a,i)},preventDefault:!1}],s)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Uy)}}function BY(n,e,t){return e=UY(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function UY(n){var e=YY(n,"string");return typeof e=="symbol"?e:String(e)}function YY(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const vu=new WeakMap,zY="autocomplete";class XC extends KC{static get EDITOR_TYPE(){return zY}constructor(e){super(e),BY(this,"sortByRelevance",function(t,s,o){const i=[],r=[],a=t.length;let l=s.length,u,c,d,f;if(a===0){for(d=0;d<l;d++)r.push(d);return r}for(d=0;d<l;d++){if(c=sp(At(s[d])),o)f=c.indexOf(t);else{const m=this.cellProperties.locale;f=c.toLocaleLowerCase(m).indexOf(t.toLocaleLowerCase(m))}f!==-1&&(u=c.length-f-a,i.push({baseIndex:d,index:f,charsLeft:u,value:c}))}for(i.sort((m,w)=>{if(w.index===-1)return-1;if(m.index===-1)return 1;if(m.index<w.index)return-1;if(w.index<m.index)return 1;if(m.index===w.index){if(m.charsLeft<w.charsLeft)return-1;if(m.charsLeft>w.charsLeft)return 1}return 0}),d=0,l=i.length;d<l;d++)r.push(i[d].baseIndex);return r}),this.query=null,this.strippedChoices=[],this.rawChoices=[],vu.set(this,{skipOne:!1,isMacOS:this.hot.rootWindow.navigator.platform.indexOf("Mac")>-1,idPrefix:e.guid.slice(0,9)})}getValue(){const e=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return oe(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),J(this.htContainer,"autocompleteEditor"),J(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[sF(),Qk(),Br("listbox"),lF()])}prepare(e,t,s,o,i,r){const a=vu.get(this);super.prepare(e,t,s,o,i,r),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[jt("false"),uF(`${a.idPrefix}-listbox-${e}-${t}`)])}open(){const e=vu.get(this);super.open();const t=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,s=this.hot.getSettings().ariaTags,o=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=o==null?void 0:o.length,{row:r,col:a}=this;this.showEditableElement(),this.focus();let l=Yt();l===0&&e.isMacOS&&(l+=15),this.addHook("beforeKeyDown",u=>this.onBeforeKeyDown(u)),this.htEditor.updateSettings({colWidths:t?[ut(this.TEXTAREA)-2]:void 0,width:t?ut(this.TEXTAREA)+l:void 0,autoColumnSize:!0,renderer:(u,c,d,f,m,w,C)=>{Co(u,c,d,f,m,w,C);const{filteringCaseSensitive:b,allowHtml:y,locale:M}=this.cellProperties,A=this.query;let $=At(w),H,V;$&&!y&&(H=b===!0?$.indexOf(A):$.toLocaleLowerCase(M).indexOf(A.toLocaleLowerCase(M)),H!==-1&&(V=$.substr(H,A.length),$=$.replace(V,`<strong>${V}</strong>`))),s&&Se(c,[Jk(),...o?[fF(i)]:[],...o?[gF(o.indexOf(w)+1)]:[],["id",`${this.htEditor.rootElement.id}_${d}-${f}`]]),c.innerHTML=$},afterSelection:(u,c)=>{if(s){const d=this.htEditor.getCell(u,c,!0);Se(d,[op()]),Se(this.TEXTAREA,...cF(d.id))}}}),s&&(Se(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...rs()),Se(this.htEditor.rootElement,[yE(),hF("polite"),dF("text"),["id",`${e.idPrefix}-listbox-${r}-${a}`]]),Se(this.TEXTAREA,...jt("true"))),e.skipOne&&(e.skipOne=!1),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Se(this.TEXTAREA,[jt("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,typeof t=="function"?t.call(this.cellProperties,e,s=>{this.rawChoices=s,this.updateChoicesList(this.stripValuesIfNeeded(s))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=xw(this.TEXTAREA),s=HE(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter;let r=null,a=null,l=e;o&&(r=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(r)?r.length:0;if(i===!1)u&&(a=r[0]);else{const c=[];for(let d=0,f=l.length;d<f&&!(o&&u<=d);d++)u?c.push(l[r[d]]):c.push(l[d]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Wa([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Tl(this.TEXTAREA,t,t===s?void 0:s)}flipDropdownIfNeeded(){const e=Oi(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,s=this.cellProperties.preventOverflow;if(t||!t&&(s||s==="horizontal"))return!1;const o=Lt(this.TEXTAREA),i=Et(this.TEXTAREA),r=this.getDropdownHeight(),a=e.scrollTop,l=Et(this.hot.view._wt.wtTable.THEAD),u=Lt(e),c=o.top-u.top-l+a,d=e.scrollHeight-c-l-i,f=r>d&&c>d;return f?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:d,r),f}limitDropdownIfNeeded(e,t){if(t>e){let s=0,o=0,i=0,r=null;do i=this.htEditor.getRowHeight(o)||this.htEditor.view._wt.getSetting("defaultRowHeight"),s+=i,o+=1;while(s<e);r=s-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-r}px`),this.setDropdownHeight(s-i)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+Yt(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,s=Ve(e,i=>At(i));return Ve(s,i=>t?i:sp(i))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),s={row:t?t.from.row:-1};let o=!1;return e===fe.ARROW_DOWN&&s.row>0&&s.row<this.htEditor.countRows()-1&&(o=!0),e===fe.ARROW_UP&&s.row>-1&&(o=!0),o}onBeforeKeyDown(e){const t=vu.get(this);if(t.skipOne=!1,XE(e.keyCode)||e.keyCode===fe.BACKSPACE||e.keyCode===fe.DELETE||e.keyCode===fe.INSERT){let s=10;if(e.keyCode===fe.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(s+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value),t.skipOne=!0},s)}}}const GY="checkbox";class TM extends Gr{static get EDITOR_TYPE(){return GY}beginEditing(e,t){if(t&&t.type==="mouseup"){const s=this.TD.querySelector('input[type="checkbox"]');Ae(s,"htBadValue")||s.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var MM={exports:{}};const jY=D1(Pk);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(n,e){(function(t,s){var o;{try{o=jY}catch{}n.exports=s(o)}})(nc,function(t){var s=typeof t=="function",o=!!window.addEventListener,i=window.document,r=window.setTimeout,a=function(R,h,g,p){o?R.addEventListener(h,g,!!p):R.attachEvent("on"+h,g)},l=function(R,h,g,p){o?R.removeEventListener(h,g,!!p):R.detachEvent("on"+h,g)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,h){return(" "+R.className+" ").indexOf(" "+h+" ")!==-1},d=function(R,h){c(R,h)||(R.className=R.className===""?h:R.className+" "+h)},f=function(R,h){R.className=u((" "+R.className+" ").replace(" "+h+" "," "))},m=function(R){return/Array/.test(Object.prototype.toString.call(R))},w=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},C=function(R){var h=R.getDay();return h===0||h===6},b=function(R){return R%4===0&&R%100!==0||R%400===0},y=function(R,h){return[31,b(R)?29:28,31,30,31,30,31,31,30,31,30,31][h]},M=function(R){w(R)&&R.setHours(0,0,0,0)},A=function(R,h){return R.getTime()===h.getTime()},$=function(R,h,g){var p,E;for(p in h)E=R[p]!==void 0,E&&typeof h[p]=="object"&&h[p]!==null&&h[p].nodeName===void 0?w(h[p])?g&&(R[p]=new Date(h[p].getTime())):m(h[p])?g&&(R[p]=h[p].slice(0)):R[p]=$({},h[p],g):(g||!E)&&(R[p]=h[p]);return R},H=function(R,h,g){var p;i.createEvent?(p=i.createEvent("HTMLEvents"),p.initEvent(h,!0,!1),p=$(p,g),R.dispatchEvent(p)):i.createEventObject&&(p=i.createEventObject(),p=$(p,g),R.fireEvent("on"+h,p))},V=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},z={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},ee=function(R,h,g){for(h+=R.firstDay;h>=7;)h-=7;return g?R.i18n.weekdaysShort[h]:R.i18n.weekdays[h]},j=function(R){var h=[],g="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)h.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||h.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&h.push("is-disabled"),R.isToday&&h.push("is-today"),R.isSelected&&(h.push("is-selected"),g="true"),R.hasEvent&&h.push("has-event"),R.isInRange&&h.push("is-inrange"),R.isStartRange&&h.push("is-startrange"),R.isEndRange&&h.push("is-endrange"),'<td data-day="'+R.day+'" class="'+h.join(" ")+'" aria-selected="'+g+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},X=function(R,h){R.setHours(0,0,0,0);var g=R.getDate(),p=R.getDay(),E=h,_=E-1,I=7,Y=function(ce){return(ce+I-1)%I};R.setDate(g+_-Y(p));var W=new Date(R.getFullYear(),0,E),q=24*60*60*1e3,Z=(R.getTime()-W.getTime())/q,K=1+Math.round((Z-_+Y(W.getDay()))/I);return K},ie=function(R,h,g,p){var E=new Date(g,h,R),_=s?t(E).isoWeek():X(E,p);return'<td class="pika-week">'+_+"</td>"},ae=function(R,h,g,p){return'<tr class="pika-row'+(g?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(h?R.reverse():R).join("")+"</tr>"},re=function(R){return"<tbody>"+R.join("")+"</tbody>"},pe=function(R){var h,g=[];for(R.showWeekNumber&&g.push("<th></th>"),h=0;h<7;h++)g.push('<th scope="col"><abbr title="'+ee(R,h)+'">'+ee(R,h,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?g.reverse():g).join("")+"</tr></thead>"},Oe=function(R,h,g,p,E,_){var I,Y,W,q=R._o,Z=g===q.minYear,K=g===q.maxYear,ce='<div id="'+_+'" class="pika-title" role="heading" aria-live="assertive">',Me,Ee,Te=!0,G=!0;for(W=[],I=0;I<12;I++)W.push('<option value="'+(g===E?I-h:12+I-h)+'"'+(I===p?' selected="selected"':"")+(Z&&I<q.minMonth||K&&I>q.maxMonth?' disabled="disabled"':"")+">"+q.i18n.months[I]+"</option>");for(Me='<div class="pika-label">'+q.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+W.join("")+"</select></div>",m(q.yearRange)?(I=q.yearRange[0],Y=q.yearRange[1]+1):(I=g-q.yearRange,Y=1+g+q.yearRange),W=[];I<Y&&I<=q.maxYear;I++)I>=q.minYear&&W.push('<option value="'+I+'"'+(I===g?' selected="selected"':"")+">"+I+"</option>");return Ee='<div class="pika-label">'+g+q.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+W.join("")+"</select></div>",q.showMonthAfterYear?ce+=Ee+Me:ce+=Me+Ee,Z&&(p===0||q.minMonth>=p)&&(Te=!1),K&&(p===11||q.maxMonth<=p)&&(G=!1),h===0&&(ce+='<button class="pika-prev'+(Te?"":" is-disabled")+'" type="button">'+q.i18n.previousMonth+"</button>"),h===R._o.numberOfMonths-1&&(ce+='<button class="pika-next'+(G?"":" is-disabled")+'" type="button">'+q.i18n.nextMonth+"</button>"),ce+="</div>"},Je=function(R,h,g){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+g+'">'+pe(R)+re(h)+"</table>"},Ie=function(R){var h=this,g=h.config(R);h._onMouseDown=function(E){if(h._v){E=E||window.event;var _=E.target||E.srcElement;if(_)if(c(_,"is-disabled")||(c(_,"pika-button")&&!c(_,"is-empty")&&!c(_.parentNode,"is-disabled")?(h.setDate(new Date(_.getAttribute("data-pika-year"),_.getAttribute("data-pika-month"),_.getAttribute("data-pika-day"))),g.bound&&r(function(){h.hide(),g.blurFieldOnSelect&&g.field&&g.field.blur()},100)):c(_,"pika-prev")?h.prevMonth():c(_,"pika-next")&&h.nextMonth()),c(_,"pika-select"))h._c=!0;else if(E.preventDefault)E.preventDefault();else return E.returnValue=!1,!1}},h._onChange=function(E){E=E||window.event;var _=E.target||E.srcElement;_&&(c(_,"pika-select-month")?h.gotoMonth(_.value):c(_,"pika-select-year")&&h.gotoYear(_.value))},h._onKeyChange=function(E){if(E=E||window.event,h.isVisible())switch(E.keyCode){case 13:case 27:g.field&&g.field.blur();break;case 37:h.adjustDate("subtract",1);break;case 38:h.adjustDate("subtract",7);break;case 39:h.adjustDate("add",1);break;case 40:h.adjustDate("add",7);break;case 8:case 46:h.setDate(null);break}},h._parseFieldValue=function(){if(g.parse)return g.parse(g.field.value,g.format);if(s){var E=t(g.field.value,g.format,g.formatStrict);return E&&E.isValid()?E.toDate():null}else return new Date(Date.parse(g.field.value))},h._onInputChange=function(E){var _;E.firedBy!==h&&(_=h._parseFieldValue(),w(_)&&h.setDate(_),h._v||h.show())},h._onInputFocus=function(){h.show()},h._onInputClick=function(){h.show()},h._onInputBlur=function(){var E=i.activeElement;do if(c(E,"pika-single"))return;while(E=E.parentNode);h._c||(h._b=r(function(){h.hide()},50)),h._c=!1},h._onClick=function(E){E=E||window.event;var _=E.target||E.srcElement,I=_;if(_){!o&&c(_,"pika-select")&&(_.onchange||(_.setAttribute("onchange","return;"),a(_,"change",h._onChange)));do if(c(I,"pika-single")||I===g.trigger)return;while(I=I.parentNode);h._v&&_!==g.trigger&&I!==g.trigger&&h.hide()}},h.el=i.createElement("div"),h.el.className="pika-single"+(g.isRTL?" is-rtl":"")+(g.theme?" "+g.theme:""),a(h.el,"mousedown",h._onMouseDown,!0),a(h.el,"touchend",h._onMouseDown,!0),a(h.el,"change",h._onChange),g.keyboardInput&&a(i,"keydown",h._onKeyChange),g.field&&(g.container?g.container.appendChild(h.el):g.bound?i.body.appendChild(h.el):g.field.parentNode.insertBefore(h.el,g.field.nextSibling),a(g.field,"change",h._onInputChange),g.defaultDate||(g.defaultDate=h._parseFieldValue(),g.setDefaultDate=!0));var p=g.defaultDate;w(p)?g.setDefaultDate?h.setDate(p,!0):h.gotoDate(p):h.gotoDate(new Date),g.bound?(this.hide(),h.el.className+=" is-bound",a(g.trigger,"click",h._onInputClick),a(g.trigger,"focus",h._onInputFocus),a(g.trigger,"blur",h._onInputBlur)):this.show()};return Ie.prototype={config:function(R){this._o||(this._o=$({},z,!0));var h=$(this._o,R,!0);h.isRTL=!!h.isRTL,h.field=h.field&&h.field.nodeName?h.field:null,h.theme=typeof h.theme=="string"&&h.theme?h.theme:null,h.bound=!!(h.bound!==void 0?h.field&&h.bound:h.field),h.trigger=h.trigger&&h.trigger.nodeName?h.trigger:h.field,h.disableWeekends=!!h.disableWeekends,h.disableDayFn=typeof h.disableDayFn=="function"?h.disableDayFn:null;var g=parseInt(h.numberOfMonths,10)||1;if(h.numberOfMonths=g>4?4:g,w(h.minDate)||(h.minDate=!1),w(h.maxDate)||(h.maxDate=!1),h.minDate&&h.maxDate&&h.maxDate<h.minDate&&(h.maxDate=h.minDate=!1),h.minDate&&this.setMinDate(h.minDate),h.maxDate&&this.setMaxDate(h.maxDate),m(h.yearRange)){var p=new Date().getFullYear()-10;h.yearRange[0]=parseInt(h.yearRange[0],10)||p,h.yearRange[1]=parseInt(h.yearRange[1],10)||p}else h.yearRange=Math.abs(parseInt(h.yearRange,10))||z.yearRange,h.yearRange>100&&(h.yearRange=100);return h},toString:function(R){return R=R||this._o.format,w(this._d)?this._o.toString?this._o.toString(this._d,R):s?t(this._d).format(R):this._d.toDateString():""},getMoment:function(){return s?t(this._d):null},setMoment:function(R,h){s&&t.isMoment(R)&&this.setDate(R.toDate(),h)},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(R,h){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",H(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!w(R)){var g=this._o.minDate,p=this._o.maxDate;w(g)&&R<g?R=g:w(p)&&R>p&&(R=p),this._d=new Date(R.getTime()),M(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),H(this._o.field,"change",{firedBy:this})),!h&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var h=!0;if(w(R)){if(this.calendars){var g=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),E=R.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),h=E<g.getTime()||p.getTime()<E}h&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,h){var g=this.getDate()||new Date,p=parseInt(h)*24*60*60*1e3,E;R==="add"?E=new Date(g.valueOf()+p):R==="subtract"&&(E=new Date(g.valueOf()-p)),this.setDate(E)},adjustCalendars:function(){this.calendars[0]=V(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=V({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(M(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=z.minDate,this._o.minYear=z.minYear,this._o.minMonth=z.minMonth,this._o.startRange=z.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(M(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=z.maxDate,this._o.maxYear=z.maxYear,this._o.maxMonth=z.maxMonth,this._o.endRange=z.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var h=this._o,g=h.minYear,p=h.maxYear,E=h.minMonth,_=h.maxMonth,I="",Y;this._y<=g&&(this._y=g,!isNaN(E)&&this._m<E&&(this._m=E)),this._y>=p&&(this._y=p,!isNaN(_)&&this._m>_&&(this._m=_));for(var W=0;W<h.numberOfMonths;W++)Y="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),I+='<div class="pika-lendar">'+Oe(this,W,this.calendars[W].year,this.calendars[W].month,this.calendars[0].year,Y)+this.render(this.calendars[W].year,this.calendars[W].month,Y)+"</div>";this.el.innerHTML=I,h.bound&&h.field.type!=="hidden"&&r(function(){h.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),h.bound&&h.field.setAttribute("aria-label",h.ariaLabel)}},adjustPosition:function(){var R,h,g,p,E,_,I,Y,W,q,Z,K;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,h=R,g=this.el.offsetWidth,p=this.el.offsetHeight,E=window.innerWidth||i.documentElement.clientWidth,_=window.innerHeight||i.documentElement.clientHeight,I=window.pageYOffset||i.body.scrollTop||i.documentElement.scrollTop,Z=!0,K=!0,typeof R.getBoundingClientRect=="function")q=R.getBoundingClientRect(),Y=q.left+window.pageXOffset,W=q.bottom+window.pageYOffset;else for(Y=h.offsetLeft,W=h.offsetTop+h.offsetHeight;h=h.offsetParent;)Y+=h.offsetLeft,W+=h.offsetTop;(this._o.reposition&&Y+g>E||this._o.position.indexOf("right")>-1&&Y-g+R.offsetWidth>0)&&(Y=Y-g+R.offsetWidth,Z=!1),(this._o.reposition&&W+p>_+I||this._o.position.indexOf("top")>-1&&W-p-R.offsetHeight>0)&&(W=W-p-R.offsetHeight,K=!1),this.el.style.left=Y+"px",this.el.style.top=W+"px",d(this.el,Z?"left-aligned":"right-aligned"),d(this.el,K?"bottom-aligned":"top-aligned"),f(this.el,Z?"right-aligned":"left-aligned"),f(this.el,K?"top-aligned":"bottom-aligned")}},render:function(R,h,g){var p=this._o,E=new Date,_=y(R,h),I=new Date(R,h,1).getDay(),Y=[],W=[];M(E),p.firstDay>0&&(I-=p.firstDay,I<0&&(I+=7));for(var q=h===0?11:h-1,Z=h===11?0:h+1,K=h===0?R-1:R,ce=h===11?R+1:R,Me=y(K,q),Ee=_+I,Te=Ee;Te>7;)Te-=7;Ee+=7-Te;for(var G=!1,Ye=0,Fe=0;Ye<Ee;Ye++){var ye=new Date(R,h,1+(Ye-I)),xe=w(this._d)?A(ye,this._d):!1,ve=A(ye,E),S=p.events.indexOf(ye.toDateString())!==-1,v=Ye<I||Ye>=_+I,O=1+(Ye-I),F=h,x=R,k=p.startRange&&A(p.startRange,ye),P=p.endRange&&A(p.endRange,ye),D=p.startRange&&p.endRange&&p.startRange<ye&&ye<p.endRange,B=p.minDate&&ye<p.minDate||p.maxDate&&ye>p.maxDate||p.disableWeekends&&C(ye)||p.disableDayFn&&p.disableDayFn(ye);v&&(Ye<I?(O=Me+O,F=q,x=K):(O=O-_,F=Z,x=ce));var L={day:O,month:F,year:x,hasEvent:S,isSelected:xe,isToday:ve,isDisabled:B,isEmpty:v,isStartRange:k,isEndRange:P,isInRange:D,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&xe&&(G=!0),W.push(j(L)),++Fe===7&&(p.showWeekNumber&&W.unshift(ie(Ye-I,h,R,p.firstWeekOfYearMinDays)),Y.push(ae(W,p.isRTL,p.pickWholeWeek,G)),W=[],Fe=0,G=!1)}return Je(p,Y,g)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(i,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(i,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),d(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(i,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ie})})(MM);var KY=MM.exports;const Yy=xR(KY),_M="date",zy="dateEditor";class OM extends Vi{static get EDITOR_TYPE(){return _M}constructor(e){super(e),this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,this.$datePicker=null}init(){if(typeof Q!="function")throw new Error("You need to include moment.js to your project.");if(typeof Yy!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),J(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new It(this);e.addEventListener(this.datePicker,"mousedown",t=>{Ae(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",t=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.code)&&t.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,s,o,i,r){super.prepare(e,t,s,o,i,r)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const s=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),this.hot.getSettings().ariaTags&&Se(this.TD,[jt("true")]),s.addShortcut({keys:[["Enter"]],callback:o=>{o.stopPropagation()},group:zy})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.TD&&this.hot.getSettings().ariaTags&&Se(this.TD,[jt("false")]),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(zy),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const s=this.originalValue;s!==void 0&&this.setValue(s)}super.finishEditing(e,t)}showDatepicker(e){const t=this.TD.getBoundingClientRect(),s=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.hot.view.isMouseDown(),i=e?Ww(e.keyCode):!1;let r;this.datePicker.style.display="block",this.$datePicker=new Yy(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+Et(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=t.right-ut(this.datePicker):a=t.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(r=this.originalValue,Q(r,s,!0).isValid()&&this.$datePicker.setMoment(Q(r,s),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!o&&this.setValue("")):this.cellProperties.defaultDate?(r=this.cellProperties.defaultDate,Q(r,s,!0).isValid()&&this.$datePicker.setMoment(Q(r,s),!0),!i&&!o&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&Ol(t,this.cellProperties.datePickerConfig);const s=t.onSelect,o=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=i=>{let r=i;isNaN(r.getTime())||(r=Q(r).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(r),s&&s()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},t}}const XY="dropdown";class qC extends XC{static get EDITOR_TYPE(){return XY}prepare(e,t,s,o,i,r){super.prepare(e,t,s,o,i,r),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}de.getSingleton().add("beforeValidate",function(n,e,t){const s=this.getCellMeta(e,this.propToCol(t));s.editor===qC&&s.strict===void 0&&(s.filter=!1,s.strict=!0)});const qY="numeric";class AM extends Vi{static get EDITOR_TYPE(){return qY}}const ZY="password";class IM extends Vi{static get EDITOR_TYPE(){return ZY}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,hs(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const vg="ht_editor_visible",Gy="selectEditor",QY="select";class xM extends Gr{static get EDITOR_TYPE(){return QY}init(){this.select=this.hot.rootDocument.createElement("SELECT"),J(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Ae(this.select,vg)&&Pe(this.select,vg),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,s,o,i,r){super.prepare(e,t,s,o,i,r);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),hs(this.select),We(l,(u,c)=>{const d=this.hot.rootDocument.createElement("OPTION");d.value=c,Fi(d,u),this.select.appendChild(d)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let s=0,o=e.length;s<o;s++)t[e[s]]=e[s];else typeof e=="object"&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==$t.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:t,width:s,height:o}=this.getEditedCellRect(),i=this.select.style;i.height=`${o}px`,i.width=`${s}px`,i.top=`${e}px`,i[this.hot.isRtl()?"right":"left"]=`${t}px`,i.margin="0px",J(this.select,vg)}registerShortcuts(){const t=this.hot.getShortcutManager().getContext("editor"),s={group:Gy};this.isInFullEditMode()!==!1&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],s)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Gy)}}const JY="time";class HM extends Vi{static get EDITOR_TYPE(){return JY}prepare(e,t,s,o,i,r){super.prepare(e,t,s,o,i,r),this.TEXTAREA.dir="ltr"}}function ez(){On(Gr),On(XC),On(TM),On(OM),On(qC),On(KC),On(AM),On(IM),On(xM),On(Vi),On(HM)}const tz="html";function ZC(n,e,t,s,o,i,r){Ll.apply(this,[n,e,t,s,o,i,r]),Fi(e,i??"",!1)}ZC.RENDERER_TYPE=tz;const nz="autocomplete";function jr(n,e,t,s,o,i,r){const{rootDocument:a}=n,l=r.allowHtml?ZC:Co,u=a.createElement("DIV"),c=n.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...go()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[n,e,t,s,o,i,r]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),J(e,"htAutocomplete"),c&&e.setAttribute(...Br("listbox")),!n.acArrowListener){const d=new It(n);n.acArrowListener=function(f){Ae(f.target,"htAutocompleteArrow")&&n.view._wt.getSetting("onCellDblClick",null,n._createCellCoords(t,s),e)},d.addEventListener(n.rootElement,"mousedown",n.acArrowListener),n.addHookOnce("afterDestroy",()=>{d.destroy()})}}jr.RENDERER_TYPE=nz;const jy=new WeakMap,Ky=new WeakMap,sz="htBadValue",Dr="data-row",Nr="data-col",oz="checkboxRenderer",PM="checkbox";de.getSingleton().add("modifyAutoColumnSizeSeed",function(n,e,t){const{label:s,type:o,row:i,column:r,prop:a}=e;if(o===PM){if(s){const{value:l,property:u}=s;let c=t;if(l)c=typeof l=="function"?l(i,r,a,t):l;else if(u){const d=this.getDataAtRowProp(i,u);c=d!==null?d:t}n=c}return n}});function QC(n,e,t,s,o,i,r){const{rootDocument:a}=n,l=n.getSettings().ariaTags;Ll.apply(this,[n,e,t,s,o,i,r]),iz(n);let u=rz(a);const c=r.label;let d=!1;if(typeof r.checkedTemplate>"u"&&(r.checkedTemplate=!0),typeof r.uncheckedTemplate>"u"&&(r.uncheckedTemplate=!1),hs(e),i===r.checkedTemplate||At(i).toLocaleLowerCase(r.locale)===At(r.checkedTemplate).toLocaleLowerCase(r.locale)?u.checked=!0:i===r.uncheckedTemplate||At(i).toLocaleLowerCase(r.locale)===At(r.uncheckedTemplate).toLocaleLowerCase(r.locale)?u.checked=!1:Vt(i)?J(u,"noValue"):(u.style.display="none",J(u,sz),d=!0),Se(u,[[Dr,t],[Nr,s]]),l&&Se(u,[zo(u.checked?n.getTranslatedPhrase(IC):n.getTranslatedPhrase(xC)),aF(u.checked),eF()]),!d&&c){let C="";if(c.value)C=typeof c.value=="function"?c.value.call(this,t,s,o,i):c.value;else if(c.property){const y=n.getDataAtRowProp(t,c.property);C=y!==null?y:""}const b=az(a,C,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(b),e.appendChild(u)):(b.appendChild(u),u=b):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(b)):(b.insertBefore(u,b.firstChild),u=b))}(!c||c&&!c.separated)&&e.appendChild(u),d&&e.appendChild(a.createTextNode("#bad-value#")),jy.has(n)||(jy.set(n,!0),f());function f(){const b=n.getShortcutManager().getContext("grid"),y={group:oz};b.addShortcuts([{keys:[["space"]],callback:()=>(m(),!w())},{keys:[["enter"]],callback:()=>(m(),!w()),runOnlyIf:()=>n.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(m(!0),!w()),relativeToGroup:jC,position:"before"}],y)}function m(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const b=n.getSelectedRange();if(b)for(let y=0;y<b.length;y++){const{row:M,col:A}=b[y].getTopStartCorner(),{row:$,col:H}=b[y].getBottomEndCorner(),V=[];for(let z=M;z<=$;z+=1)for(let ee=A;ee<=H;ee+=1){const j=n.getCellMeta(z,ee);if(j.type!=="checkbox")return;if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const X=n.getDataAtCell(z,ee);C===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(X)?V.push([z,ee,j.uncheckedTemplate]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(X)&&V.push([z,ee,j.checkedTemplate]):V.push([z,ee,j.uncheckedTemplate])}V.length>0&&n.setDataAtCell(V)}}function w(){const C=n.getSelectedRange();if(C){for(let b=0;b<C.length;b++){const y=C[b].getTopStartCorner(),M=C[b].getBottomEndCorner();for(let A=y.row;A<=M.row;A++)for(let $=y.col;$<=M.col;$++){const H=n.getCellMeta(A,$);if(H.type!=="checkbox")return!1;const V=n.getCell(A,$);if(V==null)return!0;if(V.querySelectorAll("input[type=checkbox]").length>0&&!H.readOnly)return!0}}return!1}}}QC.RENDERER_TYPE=PM;function iz(n){let e=Ky.get(n);if(!e){const{rootElement:t}=n;e=new It(n),e.addEventListener(t,"click",s=>uz(s,n)),e.addEventListener(t,"mouseup",s=>lz(s,n)),e.addEventListener(t,"change",s=>cz(s,n)),Ky.set(n,e)}return e}function rz(n){const e=n.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function az(n,e,t){const s=n.createElement("label");return s.className=`htCheckboxRendererLabel ${t?"fullWidth":""}`,s.appendChild(n.createTextNode(e)),s.cloneNode(!0)}function lz(n,e){const{target:t}=n;JC(t)&&(!t.hasAttribute(Dr)||!t.hasAttribute(Nr)||setTimeout(e.listen,10))}function uz(n,e){const{target:t}=n;if(!JC(t)||!t.hasAttribute(Dr)||!t.hasAttribute(Nr))return;const s=parseInt(t.getAttribute(Dr),10),o=parseInt(t.getAttribute(Nr),10);e.getCellMeta(s,o).readOnly&&n.preventDefault()}function cz(n,e){const{target:t}=n;if(!JC(t)||!t.hasAttribute(Dr)||!t.hasAttribute(Nr))return;const s=parseInt(t.getAttribute(Dr),10),o=parseInt(t.getAttribute(Nr),10),i=e.getCellMeta(s,o);if(!i.readOnly){let r=null;n.target.checked?r=i.uncheckedTemplate===void 0?!0:i.checkedTemplate:r=i.uncheckedTemplate===void 0?!1:i.uncheckedTemplate,e.setDataAtCell(s,o,r)}}function JC(n){return n.tagName==="INPUT"&&n.getAttribute("type")==="checkbox"}function yu(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var DM={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(s,o,i){function r(u,c){if(!o[u]){if(!s[u]){var d=typeof yu=="function"&&yu;if(!c&&d)return d(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var m=o[u]={exports:{}};s[u][0].call(m.exports,function(w){return r(s[u][1][w]||w)},m,m.exports,t,s,o,i)}return o[u].exports}for(var a=typeof yu=="function"&&yu,l=0;l<i.length;l++)r(i[l]);return r}({1:[function(t,s,o){(function(i){var r,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",d=c+"Number primitive has more than 15 significant digits: ",f=1e14,m=14,w=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],b=1e7,y=1e9;function M(j){var X=0|j;return 0<j||j===X?X:X-1}function A(j){for(var X,ie,ae=1,re=j.length,pe=j[0]+"";ae<re;){for(X=j[ae++]+"",ie=m-X.length;ie--;X="0"+X);pe+=X}for(re=pe.length;pe.charCodeAt(--re)===48;);return pe.slice(0,re+1||1)}function $(j,X){var ie,ae,re=j.c,pe=X.c,Oe=j.s,Je=X.s,Ie=j.e,R=X.e;if(!Oe||!Je)return null;if(ie=re&&!re[0],ae=pe&&!pe[0],ie||ae)return ie?ae?0:-Je:Oe;if(Oe!=Je)return Oe;if(ie=Oe<0,ae=Ie==R,!re||!pe)return ae?0:!re^ie?1:-1;if(!ae)return R<Ie^ie?1:-1;for(Je=(Ie=re.length)<(R=pe.length)?Ie:R,Oe=0;Oe<Je;Oe++)if(re[Oe]!=pe[Oe])return re[Oe]>pe[Oe]^ie?1:-1;return Ie==R?0:R<Ie^ie?1:-1}function H(j,X,ie,ae){if(j<X||ie<j||j!==(j<0?l(j):u(j)))throw Error(c+(ae||"Argument")+(typeof j=="number"?j<X||ie<j?" out of range: ":" not an integer: ":" not a primitive number: ")+String(j))}function V(j){var X=j.c.length-1;return M(j.e/m)==X&&j.c[X]%2!=0}function z(j,X){return(1<j.length?j.charAt(0)+"."+j.slice(1):j)+(X<0?"e":"e+")+X}function ee(j,X,ie){var ae,re;if(X<0){for(re=ie+".";++X;re+=ie);j=re+j}else if(++X>(ae=j.length)){for(re=ie,X-=ae;--X;re+=ie);j+=re}else X<ae&&(j=j.slice(0,X)+"."+j.slice(X));return j}(r=function j(X){var ie,ae,re,pe,Oe,Je,Ie,R,h,g,p=G.prototype={constructor:G,toString:null,valueOf:null},E=new G(1),_=20,I=4,Y=-7,W=21,q=-1e7,Z=1e7,K=!1,ce=1,Me=0,Ee={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Te="0123456789abcdefghijklmnopqrstuvwxyz";function G(S,v){var O,F,x,k,P,D,B,L,U=this;if(!(U instanceof G))return new G(S,v);if(v==null){if(S instanceof G)return U.s=S.s,U.e=S.e,void(U.c=(S=S.c)?S.slice():S);if((D=typeof S=="number")&&0*S==0){if(U.s=1/S<0?(S=-S,-1):1,S===~~S){for(k=0,P=S;10<=P;P/=10,k++);return U.e=k,void(U.c=[S])}L=String(S)}else{if(L=String(S),!a.test(L))return re(U,L,D);U.s=L.charCodeAt(0)==45?(L=L.slice(1),-1):1}-1<(k=L.indexOf("."))&&(L=L.replace(".","")),0<(P=L.search(/e/i))?(k<0&&(k=P),k+=+L.slice(P+1),L=L.substring(0,P)):k<0&&(k=L.length)}else{if(H(v,2,Te.length,"Base"),L=String(S),v==10)return xe(U=new G(S instanceof G?S:L),_+U.e+1,I);if(D=typeof S=="number"){if(0*S!=0)return re(U,L,D,v);if(U.s=1/S<0?(L=L.slice(1),-1):1,G.DEBUG&&15<L.replace(/^0\.0*|\./,"").length)throw Error(d+S);D=!1}else U.s=L.charCodeAt(0)===45?(L=L.slice(1),-1):1;for(O=Te.slice(0,v),k=P=0,B=L.length;P<B;P++)if(O.indexOf(F=L.charAt(P))<0){if(F=="."){if(k<P){k=B;continue}}else if(!x&&(L==L.toUpperCase()&&(L=L.toLowerCase())||L==L.toLowerCase()&&(L=L.toUpperCase()))){x=!0,P=-1,k=0;continue}return re(U,String(S),D,v)}-1<(k=(L=ae(L,v,10,U.s)).indexOf("."))?L=L.replace(".",""):k=L.length}for(P=0;L.charCodeAt(P)===48;P++);for(B=L.length;L.charCodeAt(--B)===48;);if(L=L.slice(P,++B)){if(B-=P,D&&G.DEBUG&&15<B&&(w<S||S!==u(S)))throw Error(d+U.s*S);if(Z<(k=k-P-1))U.c=U.e=null;else if(k<q)U.c=[U.e=0];else{if(U.e=k,U.c=[],P=(k+1)%m,k<0&&(P+=m),P<B){for(P&&U.c.push(+L.slice(0,P)),B-=m;P<B;)U.c.push(+L.slice(P,P+=m));L=L.slice(P),P=m-L.length}else P-=B;for(;P--;L+="0");U.c.push(+L)}}else U.c=[U.e=0]}function Ye(S,v,O,F){var x,k,P,D,B;if(O==null?O=I:H(O,0,8),!S.c)return S.toString();if(x=S.c[0],P=S.e,v==null)B=A(S.c),B=F==1||F==2&&(P<=Y||W<=P)?z(B,P):ee(B,P,"0");else if(k=(S=xe(new G(S),v,O)).e,D=(B=A(S.c)).length,F==1||F==2&&(v<=k||k<=Y)){for(;D<v;B+="0",D++);B=z(B,k)}else if(v-=P,B=ee(B,k,"0"),D<k+1){if(0<--v)for(B+=".";v--;B+="0");}else if(0<(v+=k-D))for(k+1==D&&(B+=".");v--;B+="0");return S.s<0&&x?"-"+B:B}function Fe(S,v){for(var O,F=1,x=new G(S[0]);F<S.length;F++){if(!(O=new G(S[F])).s){x=O;break}v.call(x,O)&&(x=O)}return x}function ye(S,v,O){for(var F=1,x=v.length;!v[--x];v.pop());for(x=v[0];10<=x;x/=10,F++);return(O=F+O*m-1)>Z?S.c=S.e=null:S.c=O<q?[S.e=0]:(S.e=O,v),S}function xe(S,v,O,F){var x,k,P,D,B,L,U,se=S.c,he=C;if(se){e:{for(x=1,D=se[0];10<=D;D/=10,x++);if((k=v-x)<0)k+=m,P=v,U=(B=se[L=0])/he[x-P-1]%10|0;else if((L=l((k+1)/m))>=se.length){if(!F)break e;for(;se.length<=L;se.push(0));B=U=0,P=(k%=m)-m+(x=1)}else{for(B=D=se[L],x=1;10<=D;D/=10,x++);U=(P=(k%=m)-m+x)<0?0:B/he[x-P-1]%10|0}if(F=F||v<0||se[L+1]!=null||(P<0?B:B%he[x-P-1]),F=O<4?(U||F)&&(O==0||O==(S.s<0?3:2)):5<U||U==5&&(O==4||F||O==6&&(0<k?0<P?B/he[x-P]:0:se[L-1])%10&1||O==(S.s<0?8:7)),v<1||!se[0])return se.length=0,F?(v-=S.e+1,se[0]=he[(m-v%m)%m],S.e=-v||0):se[0]=S.e=0,S;if(k==0?(se.length=L,D=1,L--):(se.length=L+1,D=he[m-k],se[L]=0<P?u(B/he[x-P]%he[P])*D:0),F)for(;;){if(L==0){for(k=1,P=se[0];10<=P;P/=10,k++);for(P=se[0]+=D,D=1;10<=P;P/=10,D++);k!=D&&(S.e++,se[0]==f&&(se[0]=1));break}if(se[L]+=D,se[L]!=f)break;se[L--]=0,D=1}for(k=se.length;se[--k]===0;se.pop());}S.e>Z?S.c=S.e=null:S.e<q&&(S.c=[S.e=0])}return S}function ve(S){var v,O=S.e;return O===null?S.toString():(v=A(S.c),v=O<=Y||W<=O?z(v,O):ee(v,O,"0"),S.s<0?"-"+v:v)}return G.clone=j,G.ROUND_UP=0,G.ROUND_DOWN=1,G.ROUND_CEIL=2,G.ROUND_FLOOR=3,G.ROUND_HALF_UP=4,G.ROUND_HALF_DOWN=5,G.ROUND_HALF_EVEN=6,G.ROUND_HALF_CEIL=7,G.ROUND_HALF_FLOOR=8,G.EUCLID=9,G.config=G.set=function(S){var v,O;if(S!=null){if(typeof S!="object")throw Error(c+"Object expected: "+S);if(S.hasOwnProperty(v="DECIMAL_PLACES")&&(H(O=S[v],0,y,v),_=O),S.hasOwnProperty(v="ROUNDING_MODE")&&(H(O=S[v],0,8,v),I=O),S.hasOwnProperty(v="EXPONENTIAL_AT")&&((O=S[v])&&O.pop?(H(O[0],-y,0,v),H(O[1],0,y,v),Y=O[0],W=O[1]):(H(O,-y,y,v),Y=-(W=O<0?-O:O))),S.hasOwnProperty(v="RANGE"))if((O=S[v])&&O.pop)H(O[0],-y,-1,v),H(O[1],1,y,v),q=O[0],Z=O[1];else{if(H(O,-y,y,v),!O)throw Error(c+v+" cannot be zero: "+O);q=-(Z=O<0?-O:O)}if(S.hasOwnProperty(v="CRYPTO")){if((O=S[v])!==!!O)throw Error(c+v+" not true or false: "+O);if(O){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw K=!O,Error(c+"crypto unavailable");K=O}else K=O}if(S.hasOwnProperty(v="MODULO_MODE")&&(H(O=S[v],0,9,v),ce=O),S.hasOwnProperty(v="POW_PRECISION")&&(H(O=S[v],0,y,v),Me=O),S.hasOwnProperty(v="FORMAT")){if(typeof(O=S[v])!="object")throw Error(c+v+" not an object: "+O);Ee=O}if(S.hasOwnProperty(v="ALPHABET")){if(typeof(O=S[v])!="string"||/^.$|[+-.\s]|(.).*\1/.test(O))throw Error(c+v+" invalid: "+O);Te=O}}return{DECIMAL_PLACES:_,ROUNDING_MODE:I,EXPONENTIAL_AT:[Y,W],RANGE:[q,Z],CRYPTO:K,MODULO_MODE:ce,POW_PRECISION:Me,FORMAT:Ee,ALPHABET:Te}},G.isBigNumber=function(S){return S instanceof G||S&&S._isBigNumber===!0||!1},G.maximum=G.max=function(){return Fe(arguments,p.lt)},G.minimum=G.min=function(){return Fe(arguments,p.gt)},G.random=(pe=9007199254740992,Oe=Math.random()*pe&2097151?function(){return u(Math.random()*pe)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(S){var v,O,F,x,k,P=0,D=[],B=new G(E);if(S==null?S=_:H(S,0,y),x=l(S/m),K)if(crypto.getRandomValues){for(v=crypto.getRandomValues(new Uint32Array(x*=2));P<x;)9e15<=(k=131072*v[P]+(v[P+1]>>>11))?(O=crypto.getRandomValues(new Uint32Array(2)),v[P]=O[0],v[P+1]=O[1]):(D.push(k%1e14),P+=2);P=x/2}else{if(!crypto.randomBytes)throw K=!1,Error(c+"crypto unavailable");for(v=crypto.randomBytes(x*=7);P<x;)9e15<=(k=281474976710656*(31&v[P])+1099511627776*v[P+1]+4294967296*v[P+2]+16777216*v[P+3]+(v[P+4]<<16)+(v[P+5]<<8)+v[P+6])?crypto.randomBytes(7).copy(v,P):(D.push(k%1e14),P+=7);P=x/7}if(!K)for(;P<x;)(k=Oe())<9e15&&(D[P++]=k%1e14);for(x=D[--P],S%=m,x&&S&&(k=C[m-S],D[P]=u(x/k)*k);D[P]===0;D.pop(),P--);if(P<0)D=[F=0];else{for(F=-1;D[0]===0;D.splice(0,1),F-=m);for(P=1,k=D[0];10<=k;k/=10,P++);P<m&&(F-=m-P)}return B.e=F,B.c=D,B}),G.sum=function(){for(var S=1,v=arguments,O=new G(v[0]);S<v.length;)O=O.plus(v[S++]);return O},ae=function(){var S="0123456789";function v(O,F,x,k){for(var P,D,B=[0],L=0,U=O.length;L<U;){for(D=B.length;D--;B[D]*=F);for(B[0]+=k.indexOf(O.charAt(L++)),P=0;P<B.length;P++)B[P]>x-1&&(B[P+1]==null&&(B[P+1]=0),B[P+1]+=B[P]/x|0,B[P]%=x)}return B.reverse()}return function(O,F,x,k,P){var D,B,L,U,se,he,Ce,_e,ke=O.indexOf("."),gt=_,je=I;for(0<=ke&&(U=Me,Me=0,O=O.replace(".",""),he=(_e=new G(F)).pow(O.length-ke),Me=U,_e.c=v(ee(A(he.c),he.e,"0"),10,x,S),_e.e=_e.c.length),L=U=(Ce=v(O,F,x,P?(D=Te,S):(D=S,Te))).length;Ce[--U]==0;Ce.pop());if(!Ce[0])return D.charAt(0);if(ke<0?--L:(he.c=Ce,he.e=L,he.s=k,Ce=(he=ie(he,_e,gt,je,x)).c,se=he.r,L=he.e),ke=Ce[B=L+gt+1],U=x/2,se=se||B<0||Ce[B+1]!=null,se=je<4?(ke!=null||se)&&(je==0||je==(he.s<0?3:2)):U<ke||ke==U&&(je==4||se||je==6&&1&Ce[B-1]||je==(he.s<0?8:7)),B<1||!Ce[0])O=se?ee(D.charAt(1),-gt,D.charAt(0)):D.charAt(0);else{if(Ce.length=B,se)for(--x;++Ce[--B]>x;)Ce[B]=0,B||(++L,Ce=[1].concat(Ce));for(U=Ce.length;!Ce[--U];);for(ke=0,O="";ke<=U;O+=D.charAt(Ce[ke++]));O=ee(O,L,D.charAt(0))}return O}}(),ie=function(){function S(F,x,k){var P,D,B,L,U=0,se=F.length,he=x%b,Ce=x/b|0;for(F=F.slice();se--;)U=((D=he*(B=F[se]%b)+(P=Ce*B+(L=F[se]/b|0)*he)%b*b+U)/k|0)+(P/b|0)+Ce*L,F[se]=D%k;return U&&(F=[U].concat(F)),F}function v(F,x,k,P){var D,B;if(k!=P)B=P<k?1:-1;else for(D=B=0;D<k;D++)if(F[D]!=x[D]){B=F[D]>x[D]?1:-1;break}return B}function O(F,x,k,P){for(var D=0;k--;)F[k]-=D,D=F[k]<x[k]?1:0,F[k]=D*P+F[k]-x[k];for(;!F[0]&&1<F.length;F.splice(0,1));}return function(F,x,k,P,D){var B,L,U,se,he,Ce,_e,ke,gt,je,rt,vt,Wi,Xr,Ht,Xt,ni,fn=F.s==x.s?1:-1,Wt=F.c,mt=x.c;if(!(Wt&&Wt[0]&&mt&&mt[0]))return new G(F.s&&x.s&&(Wt?!mt||Wt[0]!=mt[0]:mt)?Wt&&Wt[0]==0||!mt?0*fn:fn/0:NaN);for(gt=(ke=new G(fn)).c=[],fn=k+(L=F.e-x.e)+1,D||(D=f,L=M(F.e/m)-M(x.e/m),fn=fn/m|0),U=0;mt[U]==(Wt[U]||0);U++);if(mt[U]>(Wt[U]||0)&&L--,fn<0)gt.push(1),se=!0;else{for(Xr=Wt.length,Xt=mt.length,fn+=2,1<(he=u(D/(mt[U=0]+1)))&&(mt=S(mt,he,D),Wt=S(Wt,he,D),Xt=mt.length,Xr=Wt.length),Wi=Xt,rt=(je=Wt.slice(0,Xt)).length;rt<Xt;je[rt++]=0);ni=mt.slice(),ni=[0].concat(ni),Ht=mt[0],mt[1]>=D/2&&Ht++;do{if(he=0,(B=v(mt,je,Xt,rt))<0){if(vt=je[0],Xt!=rt&&(vt=vt*D+(je[1]||0)),1<(he=u(vt/Ht)))for(D<=he&&(he=D-1),_e=(Ce=S(mt,he,D)).length,rt=je.length;v(Ce,je,_e,rt)==1;)he--,O(Ce,Xt<_e?ni:mt,_e,D),_e=Ce.length,B=1;else he==0&&(B=he=1),_e=(Ce=mt.slice()).length;if(_e<rt&&(Ce=[0].concat(Ce)),O(je,Ce,rt,D),rt=je.length,B==-1)for(;v(mt,je,Xt,rt)<1;)he++,O(je,Xt<rt?ni:mt,rt,D),rt=je.length}else B===0&&(he++,je=[0]);gt[U++]=he,je[0]?je[rt++]=Wt[Wi]||0:(je=[Wt[Wi]],rt=1)}while((Wi++<Xr||je[0]!=null)&&fn--);se=je[0]!=null,gt[0]||gt.splice(0,1)}if(D==f){for(U=1,fn=gt[0];10<=fn;fn/=10,U++);xe(ke,k+(ke.e=U+L*m-1)+1,P,se)}else ke.e=L,ke.r=+se;return ke}}(),Je=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ie=/^([^.]+)\.$/,R=/^\.([^.]+)$/,h=/^-?(Infinity|NaN)$/,g=/^\s*\+(?=[\w.])|^\s+|\s+$/g,re=function(S,v,O,F){var x,k=O?v:v.replace(g,"");if(h.test(k))S.s=isNaN(k)?null:k<0?-1:1,S.c=S.e=null;else{if(!O&&(k=k.replace(Je,function(P,D,B){return x=(B=B.toLowerCase())=="x"?16:B=="b"?2:8,F&&F!=x?P:D}),F&&(x=F,k=k.replace(Ie,"$1").replace(R,"0.$1")),v!=k))return new G(k,x);if(G.DEBUG)throw Error(c+"Not a"+(F?" base "+F:"")+" number: "+v);S.c=S.e=S.s=null}},p.absoluteValue=p.abs=function(){var S=new G(this);return S.s<0&&(S.s=1),S},p.comparedTo=function(S,v){return $(this,new G(S,v))},p.decimalPlaces=p.dp=function(S,v){var O,F,x;if(S!=null)return H(S,0,y),v==null?v=I:H(v,0,8),xe(new G(this),S+this.e+1,v);if(!(O=this.c))return null;if(F=((x=O.length-1)-M(this.e/m))*m,x=O[x])for(;x%10==0;x/=10,F--);return F<0&&(F=0),F},p.dividedBy=p.div=function(S,v){return ie(this,new G(S,v),_,I)},p.dividedToIntegerBy=p.idiv=function(S,v){return ie(this,new G(S,v),0,1)},p.exponentiatedBy=p.pow=function(S,v){var O,F,x,k,P,D,B,L,U=this;if((S=new G(S)).c&&!S.isInteger())throw Error(c+"Exponent not an integer: "+ve(S));if(v!=null&&(v=new G(v)),P=14<S.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!S.c||!S.c[0])return L=new G(Math.pow(+ve(U),P?2-V(S):+ve(S))),v?L.mod(v):L;if(D=S.s<0,v){if(v.c?!v.c[0]:!v.s)return new G(NaN);(F=!D&&U.isInteger()&&v.isInteger())&&(U=U.mod(v))}else{if(9<S.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||P&&24e7<=U.c[1]:U.c[0]<8e13||P&&U.c[0]<=9999975e7)))return k=U.s<0&&V(S)?-0:0,-1<U.e&&(k=1/k),new G(D?1/k:k);Me&&(k=l(Me/m+2))}for(B=P?(O=new G(.5),D&&(S.s=1),V(S)):(x=Math.abs(+ve(S)))%2,L=new G(E);;){if(B){if(!(L=L.times(U)).c)break;k?L.c.length>k&&(L.c.length=k):F&&(L=L.mod(v))}if(x){if((x=u(x/2))===0)break;B=x%2}else if(xe(S=S.times(O),S.e+1,1),14<S.e)B=V(S);else{if((x=+ve(S))==0)break;B=x%2}U=U.times(U),k?U.c&&U.c.length>k&&(U.c.length=k):F&&(U=U.mod(v))}return F?L:(D&&(L=E.div(L)),v?L.mod(v):k?xe(L,Me,I,void 0):L)},p.integerValue=function(S){var v=new G(this);return S==null?S=I:H(S,0,8),xe(v,v.e+1,S)},p.isEqualTo=p.eq=function(S,v){return $(this,new G(S,v))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(S,v){return 0<$(this,new G(S,v))},p.isGreaterThanOrEqualTo=p.gte=function(S,v){return(v=$(this,new G(S,v)))===1||v===0},p.isInteger=function(){return!!this.c&&M(this.e/m)>this.c.length-2},p.isLessThan=p.lt=function(S,v){return $(this,new G(S,v))<0},p.isLessThanOrEqualTo=p.lte=function(S,v){return(v=$(this,new G(S,v)))===-1||v===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(S,v){var O,F,x,k,P=this,D=P.s;if(v=(S=new G(S,v)).s,!D||!v)return new G(NaN);if(D!=v)return S.s=-v,P.plus(S);var B=P.e/m,L=S.e/m,U=P.c,se=S.c;if(!B||!L){if(!U||!se)return U?(S.s=-v,S):new G(se?P:NaN);if(!U[0]||!se[0])return se[0]?(S.s=-v,S):new G(U[0]?P:I==3?-0:0)}if(B=M(B),L=M(L),U=U.slice(),D=B-L){for((x=(k=D<0)?(D=-D,U):(L=B,se)).reverse(),v=D;v--;x.push(0));x.reverse()}else for(F=(k=(D=U.length)<(v=se.length))?D:v,D=v=0;v<F;v++)if(U[v]!=se[v]){k=U[v]<se[v];break}if(k&&(x=U,U=se,se=x,S.s=-S.s),0<(v=(F=se.length)-(O=U.length)))for(;v--;U[O++]=0);for(v=f-1;D<F;){if(U[--F]<se[F]){for(O=F;O&&!U[--O];U[O]=v);--U[O],U[F]+=f}U[F]-=se[F]}for(;U[0]==0;U.splice(0,1),--L);return U[0]?ye(S,U,L):(S.s=I==3?-1:1,S.c=[S.e=0],S)},p.modulo=p.mod=function(S,v){var O,F,x=this;return S=new G(S,v),!x.c||!S.s||S.c&&!S.c[0]?new G(NaN):!S.c||x.c&&!x.c[0]?new G(x):(ce==9?(F=S.s,S.s=1,O=ie(x,S,0,3),S.s=F,O.s*=F):O=ie(x,S,0,ce),(S=x.minus(O.times(S))).c[0]||ce!=1||(S.s=x.s),S)},p.multipliedBy=p.times=function(S,v){var O,F,x,k,P,D,B,L,U,se,he,Ce,_e,ke,gt,je=this,rt=je.c,vt=(S=new G(S,v)).c;if(!(rt&&vt&&rt[0]&&vt[0]))return!je.s||!S.s||rt&&!rt[0]&&!vt||vt&&!vt[0]&&!rt?S.c=S.e=S.s=null:(S.s*=je.s,rt&&vt?(S.c=[0],S.e=0):S.c=S.e=null),S;for(F=M(je.e/m)+M(S.e/m),S.s*=je.s,(B=rt.length)<(se=vt.length)&&(_e=rt,rt=vt,vt=_e,x=B,B=se,se=x),x=B+se,_e=[];x--;_e.push(0));for(ke=f,gt=b,x=se;0<=--x;){for(O=0,he=vt[x]%gt,Ce=vt[x]/gt|0,k=x+(P=B);x<k;)O=((L=he*(L=rt[--P]%gt)+(D=Ce*L+(U=rt[P]/gt|0)*he)%gt*gt+_e[k]+O)/ke|0)+(D/gt|0)+Ce*U,_e[k--]=L%ke;_e[k]=O}return O?++F:_e.splice(0,1),ye(S,_e,F)},p.negated=function(){var S=new G(this);return S.s=-S.s||null,S},p.plus=function(S,v){var O,F=this,x=F.s;if(v=(S=new G(S,v)).s,!x||!v)return new G(NaN);if(x!=v)return S.s=-v,F.minus(S);var k=F.e/m,P=S.e/m,D=F.c,B=S.c;if(!k||!P){if(!D||!B)return new G(x/0);if(!D[0]||!B[0])return B[0]?S:new G(D[0]?F:0*x)}if(k=M(k),P=M(P),D=D.slice(),x=k-P){for((O=0<x?(P=k,B):(x=-x,D)).reverse();x--;O.push(0));O.reverse()}for((x=D.length)-(v=B.length)<0&&(O=B,B=D,D=O,v=x),x=0;v;)x=(D[--v]=D[v]+B[v]+x)/f|0,D[v]=f===D[v]?0:D[v]%f;return x&&(D=[x].concat(D),++P),ye(S,D,P)},p.precision=p.sd=function(S,v){var O,F,x;if(S!=null&&S!==!!S)return H(S,1,y),v==null?v=I:H(v,0,8),xe(new G(this),S,v);if(!(O=this.c))return null;if(F=(x=O.length-1)*m+1,x=O[x]){for(;x%10==0;x/=10,F--);for(x=O[0];10<=x;x/=10,F++);}return S&&this.e+1>F&&(F=this.e+1),F},p.shiftedBy=function(S){return H(S,-w,w),this.times("1e"+S)},p.squareRoot=p.sqrt=function(){var S,v,O,F,x,k=this,P=k.c,D=k.s,B=k.e,L=_+4,U=new G("0.5");if(D!==1||!P||!P[0])return new G(!D||D<0&&(!P||P[0])?NaN:P?k:1/0);if((O=(D=Math.sqrt(+ve(k)))==0||D==1/0?(((v=A(P)).length+B)%2==0&&(v+="0"),D=Math.sqrt(+v),B=M((B+1)/2)-(B<0||B%2),new G(v=D==1/0?"1e"+B:(v=D.toExponential()).slice(0,v.indexOf("e")+1)+B)):new G(D+"")).c[0]){for((D=(B=O.e)+L)<3&&(D=0);;)if(x=O,O=U.times(x.plus(ie(k,x,L,1))),A(x.c).slice(0,D)===(v=A(O.c)).slice(0,D)){if(O.e<B&&--D,(v=v.slice(D-3,D+1))!="9999"&&(F||v!="4999")){+v&&(+v.slice(1)||v.charAt(0)!="5")||(xe(O,O.e+_+2,1),S=!O.times(O).eq(k));break}if(!F&&(xe(x,x.e+_+2,0),x.times(x).eq(k))){O=x;break}L+=4,D+=4,F=1}}return xe(O,O.e+_+1,I,S)},p.toExponential=function(S,v){return S!=null&&(H(S,0,y),S++),Ye(this,S,v,1)},p.toFixed=function(S,v){return S!=null&&(H(S,0,y),S=S+this.e+1),Ye(this,S,v)},p.toFormat=function(S,v,O){var F;if(O==null)S!=null&&v&&typeof v=="object"?(O=v,v=null):S&&typeof S=="object"?(O=S,S=v=null):O=Ee;else if(typeof O!="object")throw Error(c+"Argument not an object: "+O);if(F=this.toFixed(S,v),this.c){var x,k=F.split("."),P=+O.groupSize,D=+O.secondaryGroupSize,B=O.groupSeparator||"",L=k[0],U=k[1],se=this.s<0,he=se?L.slice(1):L,Ce=he.length;if(D&&(x=P,P=D,Ce-=D=x),0<P&&0<Ce){for(x=Ce%P||P,L=he.substr(0,x);x<Ce;x+=P)L+=B+he.substr(x,P);0<D&&(L+=B+he.slice(x)),se&&(L="-"+L)}F=U?L+(O.decimalSeparator||"")+((D=+O.fractionGroupSize)?U.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(O.fractionGroupSeparator||"")):U):L}return(O.prefix||"")+F+(O.suffix||"")},p.toFraction=function(S){var v,O,F,x,k,P,D,B,L,U,se,he,Ce=this,_e=Ce.c;if(S!=null&&(!(D=new G(S)).isInteger()&&(D.c||D.s!==1)||D.lt(E)))throw Error(c+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+ve(D));if(!_e)return new G(Ce);for(v=new G(E),L=O=new G(E),F=B=new G(E),he=A(_e),k=v.e=he.length-Ce.e-1,v.c[0]=C[(P=k%m)<0?m+P:P],S=!S||0<D.comparedTo(v)?0<k?v:L:D,P=Z,Z=1/0,D=new G(he),B.c[0]=0;U=ie(D,v,0,1),(x=O.plus(U.times(F))).comparedTo(S)!=1;)O=F,F=x,L=B.plus(U.times(x=L)),B=x,v=D.minus(U.times(x=v)),D=x;return x=ie(S.minus(O),F,0,1),B=B.plus(x.times(L)),O=O.plus(x.times(F)),B.s=L.s=Ce.s,se=ie(L,F,k*=2,I).minus(Ce).abs().comparedTo(ie(B,O,k,I).minus(Ce).abs())<1?[L,F]:[B,O],Z=P,se},p.toNumber=function(){return+ve(this)},p.toPrecision=function(S,v){return S!=null&&H(S,1,y),Ye(this,S,v,2)},p.toString=function(S){var v,O=this,F=O.s,x=O.e;return x===null?F?(v="Infinity",F<0&&(v="-"+v)):v="NaN":(v=S==null?x<=Y||W<=x?z(A(O.c),x):ee(A(O.c),x,"0"):S===10?ee(A((O=xe(new G(O),_+x+1,I)).c),O.e,"0"):(H(S,2,Te.length,"Base"),ae(ee(A(O.c),x,"0"),10,S,F,!0)),F<0&&O.c[0]&&(v="-"+v)),v},p.valueOf=p.toJSON=function(){return ve(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),X!=null&&G.set(X),G}()).default=r.BigNumber=r,s!==void 0&&s.exports?s.exports=r:(i||(i=typeof self<"u"&&self?self:window),i.BigNumber=r)})(this)},{}],2:[function(t,s,o){s.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(i){var r=i%10;return~~(i%100/10)==1?"th":r===1?"st":r===2?"nd":r===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,s,o){function i(M,A){return function($){if(Array.isArray($))return $}(M)||function($,H){var V=[],z=!0,ee=!1,j=void 0;try{for(var X,ie=$[Symbol.iterator]();!(z=(X=ie.next()).done)&&(V.push(X.value),!H||V.length!==H);z=!0);}catch(ae){ee=!0,j=ae}finally{try{z||ie.return==null||ie.return()}finally{if(ee)throw j}}return V}(M,A)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var r=t("./globalState"),a=t("./validating"),l=t("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},d={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(M){var A=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},$=2<arguments.length?arguments[2]:void 0;if(typeof A=="string"&&(A=l.parseFormat(A)),!a.validateFormat(A))return"ERROR: invalid format";var H=A.prefix||"",V=A.postfix||"",z=function(ee,j,X){switch(j.output){case"currency":return j=y(j,r.currentCurrencyDefaultFormat()),function(Te,G,Ye){var Fe=Ye.currentCurrency(),ye=Object.assign({},d,G),xe=void 0,ve="",S=!!ye.totalLength||!!ye.forceAverage||ye.average,v=G.currencyPosition||Fe.position,O=G.currencySymbol||Fe.symbol;ye.spaceSeparated&&(ve=" "),v==="infix"&&(xe=ve+O+ve);var F=b({instance:Te,providedFormat:G,state:Ye,decimalSeparator:xe});return v==="prefix"&&(F=Te._value<0&&ye.negative==="sign"?"-".concat(ve).concat(O).concat(F.slice(1)):O+ve+F),v&&v!=="postfix"||(F=F+(ve=S?"":ve)+O),F}(ee,j,r);case"percent":return j=y(j,r.currentPercentageDefaultFormat()),function(Te,G,Ye,Fe){var ye=G.prefixSymbol,xe=b({instance:Fe(100*Te._value),providedFormat:G,state:Ye}),ve=Object.assign({},d,G);return ye?"%".concat(ve.spaceSeparated?" ":"").concat(xe):"".concat(xe).concat(ve.spaceSeparated?" ":"","%")}(ee,j,r,X);case"byte":return j=y(j,r.currentByteDefaultFormat()),E=ee,I=r,Y=X,W=(_=j).base||"binary",q=c[W],Z=m(E._value,q.suffixes,q.scale),K=Z.value,ce=Z.suffix,Me=b({instance:Y(K),providedFormat:_,state:I,defaults:I.currentByteDefaultFormat()}),Ee=I.currentAbbreviations(),"".concat(Me).concat(Ee.spaced?" ":"").concat(ce);case"time":return j=y(j,r.currentTimeDefaultFormat()),R=ee,h=Math.floor(R._value/60/60),g=Math.floor((R._value-60*h*60)/60),p=Math.round(R._value-60*h*60-60*g),"".concat(h,":").concat(g<10?"0":"").concat(g,":").concat(p<10?"0":"").concat(p);case"ordinal":return j=y(j,r.currentOrdinalDefaultFormat()),ie=ee,ae=j,pe=(re=r).currentOrdinal(),Oe=Object.assign({},d,ae),Je=b({instance:ie,providedFormat:ae,state:re}),Ie=pe(ie._value),"".concat(Je).concat(Oe.spaceSeparated?" ":"").concat(Ie);case"number":default:return b({instance:ee,providedFormat:j,numbro:X})}var ie,ae,re,pe,Oe,Je,Ie,R,h,g,p,E,_,I,Y,W,q,Z,K,ce,Me,Ee}(M,A,$);return z=(z=H+z)+V}function m(M,A,$){var H=A[0],V=Math.abs(M);if($<=V){for(var z=1;z<A.length;++z){var ee=Math.pow($,z),j=Math.pow($,z+1);if(ee<=V&&V<j){H=A[z],M/=ee;break}}H===A[0]&&(M/=Math.pow($,A.length-1),H=A[A.length-1])}return{value:M,suffix:H}}function w(M){for(var A="",$=0;$<M;$++)A+="0";return A}function C(M,A){return M.toString().indexOf("e")!==-1?function($,H){var V=$.toString(),z=i(V.split("e"),2),ee=z[0],j=z[1],X=i(ee.split("."),2),ie=X[0],ae=X[1],re=ae===void 0?"":ae;if(0<+j)V=ie+re+w(j-re.length);else{var pe=".";pe=+ie<0?"-0".concat(pe):"0".concat(pe);var Oe=(w(-j-1)+Math.abs(ie)+re).substr(0,H);Oe.length<H&&(Oe+=w(H-Oe.length)),V=pe+Oe}return 0<+j&&0<H&&(V+=".".concat(w(H))),V}(M,A):(Math.round(+"".concat(M,"e+").concat(A))/Math.pow(10,A)).toFixed(A)}function b(M){var A=M.instance,$=M.providedFormat,H=M.state,V=H===void 0?r:H,z=M.decimalSeparator,ee=M.defaults,j=ee===void 0?V.currentDefaults():ee,X=A._value;if(X===0&&V.hasZeroFormat())return V.getZeroFormat();if(!isFinite(X))return X.toString();var ie,ae,re,pe,Oe,Je,Ie,R,h=Object.assign({},d,j,$),g=h.totalLength,p=g?0:h.characteristic,E=h.optionalCharacteristic,_=h.forceAverage,I=!!g||!!_||h.average,Y=g?-1:I&&$.mantissa===void 0?0:h.mantissa,W=!g&&($.optionalMantissa===void 0?Y===-1:h.optionalMantissa),q=h.trimMantissa,Z=h.thousandSeparated,K=h.spaceSeparated,ce=h.negative,Me=h.forceSign,Ee=h.exponential,Te="";if(I){var G=function(S){var v=S.value,O=S.forceAverage,F=S.abbreviations,x=S.spaceSeparated,k=x!==void 0&&x,P=S.totalLength,D=P===void 0?0:P,B="",L=Math.abs(v),U=-1;if(L>=Math.pow(10,12)&&!O||O==="trillion"?(B=F.trillion,v/=Math.pow(10,12)):L<Math.pow(10,12)&&L>=Math.pow(10,9)&&!O||O==="billion"?(B=F.billion,v/=Math.pow(10,9)):L<Math.pow(10,9)&&L>=Math.pow(10,6)&&!O||O==="million"?(B=F.million,v/=Math.pow(10,6)):(L<Math.pow(10,6)&&L>=Math.pow(10,3)&&!O||O==="thousand")&&(B=F.thousand,v/=Math.pow(10,3)),B&&(B=(k?" ":"")+B),D){var se=v.toString().split(".")[0];U=Math.max(D-se.length,0)}return{value:v,abbreviation:B,mantissaPrecision:U}}({value:X,forceAverage:_,abbreviations:V.currentAbbreviations(),spaceSeparated:K,totalLength:g});X=G.value,Te+=G.abbreviation,g&&(Y=G.mantissaPrecision)}if(Ee){var Ye=(ae=(ie={value:X,characteristicPrecision:p}).value,re=ie.characteristicPrecision,pe=re===void 0?0:re,Oe=i(ae.toExponential().split("e"),2),Je=Oe[0],Ie=Oe[1],R=+Je,pe&&1<pe&&(R*=Math.pow(10,pe-1),Ie=0<=(Ie=+Ie-(pe-1))?"+".concat(Ie):Ie),{value:R,abbreviation:"e".concat(Ie)});X=Ye.value,Te=Ye.abbreviation+Te}var Fe,ye,xe,ve=function(S,v,O,F,x){if(F===-1)return S;var k=C(v,F),P=i(k.toString().split("."),2),D=P[0],B=P[1],L=B===void 0?"":B;if(L.match(/^0+$/)&&(O||x))return D;var U=L.match(/0+$/);return x&&U?"".concat(D,".").concat(L.toString().slice(0,U.index)):k.toString()}(X.toString(),X,W,Y,q);return ve=function(S,v,O,F,x){var k=F.currentDelimiters(),P=k.thousands;x=x||k.decimal;var D=k.thousandsSize||3,B=S.toString(),L=B.split(".")[0],U=B.split(".")[1];return O&&(v<0&&(L=L.slice(1)),function(se,he){for(var Ce=[],_e=0,ke=se;0<ke;ke--)_e===he&&(Ce.unshift(ke),_e=0),_e++;return Ce}(L.length,D).forEach(function(se,he){L=L.slice(0,se+he)+P+L.slice(se+he)}),v<0&&(L="-".concat(L))),B=U?L+x+U:L}(ve=function(S,v,O,F){var x=S,k=i(x.toString().split("."),2),P=k[0],D=k[1];if(P.match(/^-?0$/)&&O)return D?"".concat(P.replace("0",""),".").concat(D):P.replace("0","");if(P.length<F)for(var B=F-P.length,L=0;L<B;L++)x="0".concat(x);return x.toString()}(ve,0,E,p),X,Z,V,z),(I||Ee)&&(ve=ve+Te),(Me||X<0)&&(Fe=ve,xe=ce,ve=(ye=X)===0?Fe:+Fe==0?Fe.replace("-",""):0<ye?"+".concat(Fe):xe==="sign"?Fe:"(".concat(Fe.replace("-",""),")")),ve}function y(M,A){if(!M)return A;var $=Object.keys(M);return $.length===1&&$[0]==="output"?A:M}s.exports=function(M){return{format:function(){for(var A=arguments.length,$=new Array(A),H=0;H<A;H++)$[H]=arguments[H];return f.apply(void 0,$.concat([M]))},getByteUnit:function(){for(var A=arguments.length,$=new Array(A),H=0;H<A;H++)$[H]=arguments[H];return(function(V){var z=c.general;return m(V._value,z.suffixes,z.scale).suffix}).apply(void 0,$.concat([M]))},getBinaryByteUnit:function(){for(var A=arguments.length,$=new Array(A),H=0;H<A;H++)$[H]=arguments[H];return(function(V){var z=c.binary;return m(V._value,z.suffixes,z.scale).suffix}).apply(void 0,$.concat([M]))},getDecimalByteUnit:function(){for(var A=arguments.length,$=new Array(A),H=0;H<A;H++)$[H]=arguments[H];return(function(V){var z=c.decimal;return m(V._value,z.suffixes,z.scale).suffix}).apply(void 0,$.concat([M]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,s,o){var i=t("./en-US"),r=t("./validating"),a=t("./parsing"),l={},u=void 0,c={},d=null,f={};function m(C){u=C}function w(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return w().currency},l.currentAbbreviations=function(){return w().abbreviations},l.currentDelimiters=function(){return w().delimiters},l.currentOrdinal=function(){return w().ordinal},l.currentDefaults=function(){return Object.assign({},w().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().timeFormat)},l.setDefaults=function(C){C=a.parseFormat(C),r.validateFormat(C)&&(f=C)},l.getZeroFormat=function(){return d},l.setZeroFormat=function(C){return d=typeof C=="string"?C:null},l.hasZeroFormat=function(){return d!==null},l.languageData=function(C){if(C){if(c[C])return c[C];throw new Error('Unknown tag "'.concat(C,'"'))}return w()},l.registerLanguage=function(C){var b=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!r.validateLanguage(C))throw new Error("Invalid language data");c[C.languageTag]=C,b&&m(C.languageTag)},l.setLanguage=function(C){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:i.languageTag;if(!c[C]){var y=C.split("-")[0],M=Object.keys(c).find(function(A){return A.split("-")[0]===y});return c[M]?void m(M):void m(b)}m(C)},l.registerLanguage(i),u=i.languageTag,s.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,s,o){s.exports=function(i){return{loadLanguagesInNode:function(r){return a=i,void r.forEach(function(l){var u=void 0;try{u=t("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(t,s,o){var i=t("bignumber.js");function r(a,l,u){var c=new i(a._value),d=l;return u.isNumbro(l)&&(d=l._value),d=new i(d),a._value=c.minus(d).toNumber(),a}s.exports=function(a){return{add:function(l,u){return d=u,f=a,m=new i((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new i(w),c._value=m.plus(w).toNumber(),c;var c,d,f,m,w},subtract:function(l,u){return r(l,u,a)},multiply:function(l,u){return d=u,f=a,m=new i((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new i(w),c._value=m.times(w).toNumber(),c;var c,d,f,m,w},divide:function(l,u){return d=u,f=a,m=new i((c=l)._value),w=d,f.isNumbro(d)&&(w=d._value),w=new i(w),c._value=m.dividedBy(w).toNumber(),c;var c,d,f,m,w},set:function(l,u){return c=l,f=d=u,a.isNumbro(d)&&(f=d._value),c._value=f,c;var c,d,f},difference:function(l,u){return c=u,r(f=(d=a)(l._value),c,d),Math.abs(f._value);var c,d,f}}}},{"bignumber.js":1}],7:[function(t,s,o){function i(b,y){for(var M=0;M<y.length;M++){var A=y[M];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(b,A.key,A)}}var r=t("./globalState"),a=t("./validating"),l=t("./loading")(C),u=t("./unformatting"),c=t("./formatting")(C),d=t("./manipulating")(C),f=t("./parsing"),m=function(){function b(A){(function($,H){if(!($ instanceof H))throw new TypeError("Cannot call a class as a function")})(this,b),this._value=A}var y,M;return y=b,(M=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var A=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,A)}},{key:"formatCurrency",value:function(A){return typeof A=="string"&&(A=f.parseFormat(A)),(A=c.formatOrDefault(A,r.currentCurrencyDefaultFormat())).output="currency",c.format(this,A)}},{key:"formatTime",value:function(){var A=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return A.output="time",c.format(this,A)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(A){return d.difference(this,A)}},{key:"add",value:function(A){return d.add(this,A)}},{key:"subtract",value:function(A){return d.subtract(this,A)}},{key:"multiply",value:function(A){return d.multiply(this,A)}},{key:"divide",value:function(A){return d.divide(this,A)}},{key:"set",value:function(A){return d.set(this,w(A))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&i(y.prototype,M),b}();function w(b){var y=b;return C.isNumbro(b)?y=b._value:typeof b=="string"?y=C.unformat(b):isNaN(b)&&(y=NaN),y}function C(b){return new m(w(b))}C.version="2.1.2",C.isNumbro=function(b){return b instanceof m},C.language=r.currentLanguage,C.registerLanguage=r.registerLanguage,C.setLanguage=r.setLanguage,C.languages=r.languages,C.languageData=r.languageData,C.zeroFormat=r.setZeroFormat,C.defaultFormat=r.currentDefaults,C.setDefaults=r.setDefaults,C.defaultCurrencyFormat=r.currentCurrencyDefaultFormat,C.validate=a.validate,C.loadLanguagesInNode=l.loadLanguagesInNode,C.unformat=u.unformat,s.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,s,o){s.exports={parseFormat:function(i){var r,a,l,u,c,d,f,m,w,C,b,y,M,A,$,H,V,z,ee,j,X=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof i!="string"?i:(a=X,i=(l=(r=i).match(/^{([^}]*)}/))?(a.prefix=l[1],r.slice(l[0].length)):r,c=X,function(ie,ae){if(ie.indexOf("$")===-1){if(ie.indexOf("%")===-1)return ie.indexOf("bd")!==-1?(ae.output="byte",ae.base="general"):ie.indexOf("b")!==-1?(ae.output="byte",ae.base="binary"):ie.indexOf("d")!==-1?(ae.output="byte",ae.base="decimal"):ie.indexOf(":")===-1?ie.indexOf("o")!==-1&&(ae.output="ordinal"):ae.output="time";ae.output="percent"}else ae.output="currency"}(i=(d=(u=i).match(/{([^}]*)}$/))?(c.postfix=d[1],u.slice(0,-d[0].length)):u,X),f=X,(m=i.match(/[1-9]+[0-9]*/))&&(f.totalLength=+m[0]),w=X,(C=i.split(".")[0].match(/0+/))&&(w.characteristic=C[0].length),function(ie,ae){if(ie.indexOf(".")!==-1){var re=ie.split(".")[0];ae.optionalCharacteristic=re.indexOf("0")===-1}}(i,X),b=X,i.indexOf("a")!==-1&&(b.average=!0),M=X,(y=i).indexOf("K")!==-1?M.forceAverage="thousand":y.indexOf("M")!==-1?M.forceAverage="million":y.indexOf("B")!==-1?M.forceAverage="billion":y.indexOf("T")!==-1&&(M.forceAverage="trillion"),function(ie,ae){var re=ie.split(".")[1];if(re){var pe=re.match(/0+/);pe&&(ae.mantissa=pe[0].length)}}(i,X),$=X,(A=i).match(/\[\.]/)?$.optionalMantissa=!0:A.match(/\./)&&($.optionalMantissa=!1),H=X,i.indexOf(",")!==-1&&(H.thousandSeparated=!0),V=X,i.indexOf(" ")!==-1&&(V.spaceSeparated=!0),ee=X,(z=i).match(/^\+?\([^)]*\)$/)&&(ee.negative="parenthesis"),z.match(/^\+?-/)&&(ee.negative="sign"),j=X,i.match(/^\+/)&&(j.forceSign=!0),X)}}},{}],9:[function(t,s,o){var i=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function r(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",d=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,m=5<arguments.length?arguments[5]:void 0,w=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function C(b,y){var M=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",A=3<arguments.length?arguments[3]:void 0,$=4<arguments.length?arguments[4]:void 0,H=5<arguments.length?arguments[5]:void 0,V=6<arguments.length?arguments[6]:void 0;if(!isNaN(+b))return+b;var z="",ee=b.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(ee!==b)return-1*C(ee,y,M,A,$,H,V);for(var j=0;j<i.length;j++){var X=i[j];if((z=b.replace(X.key,""))!==b)return C(z,y,M,A,$,H,V)*X.factor}if((z=b.replace("%",""))!==b)return C(z,y,M,A,$,H,V)/100;var ie=parseFloat(b);if(!isNaN(ie)){var ae=A(ie);if(ae&&ae!=="."&&(z=b.replace(new RegExp("".concat(r(ae),"$")),""))!==b)return C(z,y,M,A,$,H,V);var re={};Object.keys(H).forEach(function(g){re[H[g]]=g});for(var pe=Object.keys(re).sort().reverse(),Oe=pe.length,Je=0;Je<Oe;Je++){var Ie=pe[Je],R=re[Ie];if((z=b.replace(Ie,""))!==b){var h=void 0;switch(R){case"thousand":h=Math.pow(10,3);break;case"million":h=Math.pow(10,6);break;case"billion":h=Math.pow(10,9);break;case"trillion":h=Math.pow(10,12)}return C(z,y,M,A,$,H,V)*h}}}}(function(C,b){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",M=C.replace(y,"");return M=(M=M.replace(new RegExp("([0-9])".concat(r(b.thousands),"([0-9])"),"g"),"$1$2")).replace(b.decimal,".")}(l,u,c),u,c,d,f,m,w)}s.exports={unformat:function(l,u){var c,d,f,m=t("./globalState"),w=m.currentDelimiters(),C=m.currentCurrency().symbol,b=m.currentOrdinal(),y=m.getZeroFormat(),M=m.currentAbbreviations(),A=void 0;if(typeof l=="string")A=function($,H){if(!$.indexOf(":")||H.thousands===":")return!1;var V=$.split(":");if(V.length!==3)return!1;var z=+V[0],ee=+V[1],j=+V[2];return!isNaN(z)&&!isNaN(ee)&&!isNaN(j)}(l,w)?(c=l.split(":"),d=+c[0],f=+c[1],+c[2]+60*f+3600*d):a(l,w,C,b,y,M,u);else{if(typeof l!="number")return;A=l}if(A!==void 0)return A}}},{"./globalState":4}],10:[function(t,s,o){function i(w){return function(C){if(Array.isArray(C)){for(var b=0,y=new Array(C.length);b<C.length;b++)y[b]=C[b];return y}}(w)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(w){return(r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(w)}var a=t("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(w,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(w){return w.output==="byte"}},characteristic:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(w){return 0<=w},message:"value must be positive"},{restriction:function(w,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(w,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(w){return w.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function d(w){return!!a.unformat(w)}function f(w,C,b){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],M=Object.keys(w).map(function(A){if(!C[A])return console.error("".concat(b," Invalid key: ").concat(A)),!1;var $=w[A],H=C[A];if(typeof H=="string"&&(H={type:H}),H.type==="format"){if(!f($,u,"[Validate ".concat(A,"]"),!0))return!1}else if(r($)!==H.type)return console.error("".concat(b," ").concat(A,' type mismatched: "').concat(H.type,'" expected, "').concat(r($),'" provided')),!1;if(H.restrictions&&H.restrictions.length)for(var V=H.restrictions.length,z=0;z<V;z++){var ee=H.restrictions[z],j=ee.restriction,X=ee.message;if(!j($,w))return console.error("".concat(b," ").concat(A," invalid value: ").concat(X)),!1}return H.restriction&&!H.restriction($,w)?(console.error("".concat(b," ").concat(A," invalid value: ").concat(H.message)),!1):H.validValues&&H.validValues.indexOf($)===-1?(console.error("".concat(b," ").concat(A," invalid value: must be among ").concat(JSON.stringify(H.validValues),', "').concat($,'" provided')),!1):!(H.children&&!f($,H.children,"[Validate ".concat(A,"]")))});return y||M.push.apply(M,i(Object.keys(C).map(function(A){var $=C[A];if(typeof $=="string"&&($={type:$}),$.mandatory){var H=$.mandatory;if(typeof H=="function"&&(H=H(w)),H&&w[A]===void 0)return console.error("".concat(b,' Missing mandatory key "').concat(A,'"')),!1}return!0}))),M.reduce(function(A,$){return A&&$},!0)}function m(w){return f(w,u,"[Validate format]")}s.exports={validate:function(w,C){var b=d(w),y=m(C);return b&&y},validateFormat:m,validateInput:d,validateLanguage:function(w){return f(w,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(DM);var hz=DM.exports;const ui=xR(hz),dz="numeric";function eS(n,e,t,s,o,i,r){let a=i;if(Cn(a)){const l=r.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,d=r.className||"",f=d.length?d.split(" "):[];if(typeof u<"u"&&!ui.languages()[u]){const m=u.replace("-",""),w=ui.allLanguages?ui.allLanguages[u]:ui[m];w&&ui.registerLanguage(w)}ui.setLanguage(u),a=ui(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),r.className=f.join(" "),e.dir="ltr"}Co(n,e,t,s,o,a,r)}eS.RENDERER_TYPE=dz;const fz="password";function tS(n,e,t,s,o,i,r){Co.apply(this,[n,e,t,s,o,i,r]);const a=r.hashLength||e.innerHTML.length,l=r.hashSymbol||"*";let u="";me(a-1,()=>{u+=l}),Fi(e,u)}tS.RENDERER_TYPE=fz;const gz="time";function nS(n,e,t,s,o,i,r){Co.apply(this,[n,e,t,s,o,i,r]),e.dir="ltr"}nS.RENDERER_TYPE=gz;function mz(){Rs(jr),Rs(Ll),Rs(QC),Rs(ZC),Rs(eS),Rs(tS),Rs(Co),Rs(nS)}const pz="autocomplete";function sf(n,e){let t=n;if(t==null&&(t=""),this.allowEmpty&&t===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(t,Xy(t,e)):Xy(t,e)(this.source):e(!0)}sf.VALIDATOR_TYPE=pz;function Xy(n,e){const t=n;return function(s){let o=!1;for(let i=0,r=s.length;i<r;i++)if(t===s[i]){o=!0;break}e(o)}}function NM(n){const e=new Date(n);return isNaN(new Date(`${n}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const wz=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:NM},Symbol.toStringTag,{value:"Module"})),Cz="date";function sS(n,e){const t=tT(_M,this.instance);let s=n,o=!0;s==null&&(s="");let i=Q(s,this.dateFormat||t.defaultDateFormat,!0).isValid(),r=Q(new Date(s)).isValid()||i;if(this.allowEmpty&&s===""&&(r=!0,i=!0),r||(o=!1),!r&&i&&(o=!0),r&&!i)if(this.correctFormat===!0){const a=Sz(s,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),o=!0}else o=!1;e(o)}sS.VALIDATOR_TYPE=Cz;function Sz(n,e){const t=Q(NM(n)),s=Q(n,e),o=n.search(/[A-z]/g)>-1;let i;return t.isValid()&&t.format("x")===s.format("x")||!s.isValid()||o?i=t:i=s,i.format(e)}const vz="numeric";function oS(n,e){let t=n;t==null&&(t=""),this.allowEmpty&&t===""?e(!0):e(t===""?!1:Cn(n))}oS.VALIDATOR_TYPE=vz;const yz=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],bz="time";function iS(n,e){const t=this.timeFormat||"h:mm:ss a";let s=!0,o=n;o===null&&(o=""),o=/^\d{3,}$/.test(o)?parseInt(o,10):o;const i=/^\d{1,2}$/.test(o);i&&(o+=":00");const r=Q(o,yz,!0).isValid()?Q(o):Q(o,t);let a=r.isValid(),l=Q(o,t,!0).isValid()&&!i;if(this.allowEmpty&&o===""&&(a=!0,l=!0),a||(s=!1),!a&&l&&(s=!0),a&&!l)if(this.correctFormat===!0){const u=r.format(t),c=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,d,u,"timeValidator"),s=!0}else s=!1;e(s)}iS.VALIDATOR_TYPE=bz;function Rz(){yr(sf),yr(sS),yr(oS),yr(iS)}const Ez="autocomplete",Tz={CELL_TYPE:Ez,editor:XC,renderer:jr,validator:sf},Mz="checkbox",LM={CELL_TYPE:Mz,editor:TM,renderer:QC},_z="date";function kM(n,e,t,s,o,i,r){jr.apply(this,[n,e,t,s,o,i,r]),n.getSettings().ariaTags&&Se(e,[Br("dialog"),jt("false")])}kM.RENDERER_TYPE=_z;const Oz="date",FM={CELL_TYPE:Oz,editor:OM,renderer:kM,validator:sS},Az="dropdown",$M={CELL_TYPE:Az,editor:qC,renderer:jr,validator:sf},Iz="handsontable";function VM(n,e,t,s,o,i,r){jr.apply(this,[n,e,t,s,o,i,r]),n.getSettings().ariaTags&&Se(e,[Br("true"),jt("false")])}VM.RENDERER_TYPE=Iz;const xz="handsontable",Hz={CELL_TYPE:xz,editor:KC,renderer:VM},Pz="numeric",WM={CELL_TYPE:Pz,editor:AM,renderer:eS,validator:oS,dataType:"number"},Dz="password",Nz={CELL_TYPE:Dz,editor:IM,renderer:tS,copyable:!1},Lz="select";function BM(n,e,t,s,o,i,r){Co.apply(this,[n,e,t,s,o,i,r]),n.getSettings().ariaTags&&Se(e,...Br("listbox"))}BM.RENDERER_TYPE=Lz;const kz="select",Fz={CELL_TYPE:kz,editor:xM,renderer:BM},$z="time",Vz={CELL_TYPE:$z,editor:HM,renderer:nS,validator:iS};function Wz(){on(Tz),on(LM),on(FM),on($M),on(Hz),on(WM),on(Nz),on(Fz),on(bM),on(Vz)}function Bz(n,e){Uz(n,e),e.add(n)}function Uz(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yz(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const qy=new Map([["plugin",cV],["cell-type",fM],["editor",eT],["renderer",gT],["validator",mT]]),zz="base",ci=new WeakMap,yg=[];let Cs=null;var Zy=new WeakSet;class tt{static get PLUGIN_KEY(){return zz}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Bz(this,Zy),Ls(this,"hot",e,{writable:!1}),ci.set(this,{hooks:{}}),Cs=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const o=[];if(t.forEach(i=>{const[r,a]=i.split(":");if(!qy.has(r))throw new Error(`Unknown plugin dependency type "${r}" was found.`);qy.get(r)(a)||o.push(` - ${a} (${r})`)}),o.length>0){const i=[`The ${this.pluginName} plugin requires the following modules:
`,`${o.join(`
`)}
`].join("");yg.push(i)}}if(Cs||(Cs=qw()),Cs.indexOf("UndoRedo")>=0&&Cs.splice(Cs.indexOf("UndoRedo"),1),Cs.indexOf(this.pluginName)>=0&&Cs.splice(Cs.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Cs.length===0){if(yg.length>0){const o=[`${yg.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(o)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t){ci.get(this).hooks[e]=ci.get(this).hooks[e]||[];const s=ci.get(this).hooks[e];this.hot.addHook(e,t),s.push(t),ci.get(this).hooks[e]=s}removeHooks(e){T(ci.get(this).hooks[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){const e=ci.get(this).hooks;We(e,(t,s)=>this.removeHooks(s)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){T(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=Yz(this,Zy,Gz).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){this.eventManager&&this.eventManager.destroy(),this.clearHooks(),We(this,(e,t)=>{t!=="hot"&&(this[t]=null)}),delete this.t,delete this.hot}}function Gz(n){if(!n)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let t=0;t<e.length;t++)if(n[e[t]]!==void 0)return!0;return!1}function hi(n,e,t){return e=jz(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function jz(n){var e=Kz(n,"string");return typeof e=="symbol"?e:String(e)}function Kz(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}let Xz=class{constructor(e){hi(this,"hot",null),hi(this,"container",null),hi(this,"injected",!1),hi(this,"rows",[]),hi(this,"columns",[]),hi(this,"samples",null),hi(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const s={row:e};this.rows.push(s),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),s.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(t!=null){const s={row:-1};this.rows.push(s),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),s.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const s={col:e};this.columns.push(s),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),s.table=this.table.table}getHeights(e){this.injected||this.injectTable(),T(this.rows,t=>{e(t.row,Et(t.table)-1)})}getWidths(e){this.injected||this.injectTable(),T(this.columns,t=>{const{width:s}=t.table.getBoundingClientRect();e(t.col,Math.ceil(s))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(s=>{T(s.strings,o=>{t.appendChild(this.createColElement(o.col,e))})}),t}createRow(e){const{rootDocument:t}=this.hot,s=t.createDocumentFragment(),o=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),s.appendChild(o)),this.samples.forEach(i=>{T(i.strings,r=>{const a=r.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=t.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),r.value,l),s.appendChild(c)})}),s}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),s=[];if(this.hot.hasRowHeaders()){const o=e.createElement("th");s.push([-1,o]),t.appendChild(o)}this.samples.forEach(o=>{T(o.strings,i=>{const r=i.col,a=e.createElement("th");s.push([r,a]),t.appendChild(a)})}),this.table.tHead.appendChild(t),T(s,o=>{const[i,r]=o;this.hot.view.appendColHeader(i,r)})}createCol(e){const{rootDocument:t}=this.hot,s=t.createDocumentFragment();return this.samples.forEach(o=>{T(o.strings,i=>{const r=i.row,a=this.hot.getCellMeta(r,e);a.col=e,a.row=r;const l=this.hot.getCellRenderer(a),u=t.createElement("td"),c=t.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,r,e,this.hot.colToProp(e),i.value,a),c.appendChild(u),s.appendChild(c)})}),s}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const s=this.hot.rootDocument.createElement("col");let o=0;t>=0&&e>=0&&(o=this.hot.getCellMeta(t,e).colspan);let i=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(o>1)for(let r=e+1;r<e+o;r++)i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(r);return s.style.width=`${i}px`,s}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,s=t.createDocumentFragment(),o=t.createElement("table"),i=t.createElement("thead"),r=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&o.appendChild(a),this.isHorizontal()&&(l.appendChild(u),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&r.appendChild(l),o.appendChild(r),J(o,e),s.appendChild(o),{fragment:s,table:o,tHead:i,tBody:r,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:t}=this.hot,s=t.createDocumentFragment(),o=t.createElement("div"),i=`htGhostTable htAutoSize ${e.trim()}`;return J(o,i),s.appendChild(o),{fragment:s,container:o}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const rS=Xz;function bu(n,e,t){return e=qz(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function qz(n){var e=Zz(n,"string");return typeof e=="symbol"?e:String(e)}function Zz(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class aS{static get SAMPLE_COUNT(){return 3}constructor(e){bu(this,"samples",null),bu(this,"dataFactory",null),bu(this,"customSampleCount",null),bu(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:aS.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,s){const o=new Map,{from:i,to:r}=typeof s=="number"?{from:s,to:s}:s;return me(i,r,a=>{const l=this.generateSample(e,t,a);o.set(a,l)}),o}generateSample(e,t,s){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const o=new Map,i=e==="row"?"col":"row",r=[];return me(t.from,t.to,a=>{const l=e==="row"?this.dataFactory(s,a):this.dataFactory(a,s);if(l===!1)return;const{value:u,bundleSeed:c}=l,d=typeof c=="string"&&c.length>0;let f;d?f=c:De(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${At(u).length}`,o.has(f)||o.set(f,{needed:this.getSampleCount(),strings:[]});const m=o.get(f);m.needed&&(!(r.indexOf(u)>-1)||this.allowDuplicates||d)&&(m.strings.push({value:u,[i]:a}),r.push(u),m.needed-=1)}),o}}const UM=aS;de.getSingleton().register("modifyAutoColumnSizeSeed");const aa="autoColumnSize",Qz=10,bg=new WeakMap,Jz="autoColumnSize";class _r extends tt{static get PLUGIN_KEY(){return aa}static get PLUGIN_PRIORITY(){return Qz}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),bg.set(this,{cachedColumnHeaders:[]}),this.ghostTable=new rS(this.hot),this.samplesGenerator=new UM((t,s)=>{const o=this.hot.getCellMeta(t,s);let i="";o.spanned||(i=this.hot.getDataAtCell(t,s));let r="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(r=this.hot.runHooks("modifyAutoColumnSizeSeed",r,o,i)),{value:i,bundleSeed:r}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredColumns=0,this.columnWidthsMap=new ei,this.hot.columnIndexMapper.registerMap(Jz,this.columnWidthsMap),this.addHook("beforeColumnResize",(t,s,o)=>this.onBeforeColumnResize(t,s,o))}isEnabled(){return this.hot.getSettings()[aa]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[aa];t&&t.useHeaders!==null&&t.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",s=>this.onBeforeChange(s)),this.addHook("afterFormulasValuesUpdate",s=>this.onAfterFormulasValuesUpdate(s)),this.addHook("beforeViewRender",s=>this.onBeforeViewRender(s)),this.addHook("modifyColWidth",(s,o)=>this.getColumnWidth(o,s)),this.addHook("afterInit",()=>this.onAfterInit()),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,s)=>this.onBeforeColumnResize(e,t,s))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const t=this.hot.renderCall,s=this.getFirstVisibleColumn(),o=this.getLastVisibleColumn();s===-1||o===-1||this.calculateColumnsWidth({from:s,to:o},void 0,t)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,i=typeof t=="number"?{from:t,to:t}:t;me(o.from,o.to,r=>{let a=this.hot.toPhysicalColumn(r);if(a===null&&(a=r),s||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(r,i);T(l,u=>{let[c,d]=u;return this.ghostTable.addColumn(c,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,a)=>{const l=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=o.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=0;const s=this.hot.countCols()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot){rl(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:t,to:Math.min(t+_r.CALCULATION_STEP,s)},e),t=t+_r.CALCULATION_STEP+1,t<s?o=Dh(i):(rl(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateColumnsWidth({from:0,to:r},e),this.firstCalculation=!1,t=r+1),t<s?i():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[aa],t=e&&Rt(e,"samplingRatio")?e.samplingRatio:void 0,s=e&&Rt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),s&&this.samplesGenerator.setAllowDuplicates(s)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[aa];let t=_r.SYNC_CALCULATION_LIMIT;const s=this.hot.countCols()-1;return De(e)&&(t=e.syncLimit,Mw(t)?t=zw(s,t):t>>=0),Math.min(t,s)}getColumnWidth(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=t;return o===void 0&&(o=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),s&&typeof o=="number"&&(o=Math.max(o,Jw.DEFAULT_WIDTH))),o}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getFirstVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getFirstRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const t=e.wtTable.getLastVisibleColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}if(e.wtViewport.columnsRenderCalculator){const t=e.wtTable.getLastRenderedColumn();if(t!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(t)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader(),{cachedColumnHeaders:t}=bg.get(this);return Pt(e,(o,i,r)=>{const a=t.length;return(a-1<r||t[r]!==i)&&o.push(r),a-1<r?t.push(i):t[r]=i,o},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{T(e,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!kn(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}onBeforeViewRender(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}onAfterLoadData(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}onBeforeChange(e){const t=Ve(e,s=>{let[,o]=s;return this.hot.toPhysicalColumn(this.hot.propToCol(o))});this.clearCache(Array.from(new Set(t)))}onBeforeColumnResize(e,t,s){let o=e;return s&&(this.calculateColumnsWidth(t,void 0,!0),o=this.getColumnWidth(t,void 0,!1)),o}onAfterInit(){bg.get(this).cachedColumnHeaders=this.hot.getColHeader()}onAfterFormulasValuesUpdate(e){const t=kn(e,o=>{var i;return oe((i=o.address)===null||i===void 0?void 0:i.col)}),s=Ve(t,o=>o.address.col);this.clearCache(Array.from(new Set(s)))}destroy(){this.ghostTable.clean(),super.destroy()}}const Ei={horizontal:"horizontal",vertical:"vertical"};function eG(n,e,t){let s,o,i;return e[0]===n[0]&&e[1]<n[1]?(i="left",s=t(e[0],e[1]),o=t(e[2],n[1]-1)):e[2]===n[2]&&e[0]===n[0]&&e[3]>n[3]?(i="right",s=t(e[0],n[3]+1),o=t(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(i="up",s=t(e[0],e[1]),o=t(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(i="down",s=t(n[2]+1,e[1]),o=t(e[2],e[3])),s&&s.normalize(),o&&o.normalize(),{directionOfDrag:i,startOfDragCoords:s,endOfDragCoords:o}}function tG(n){const e={};return n===!0?(e.directions=Object.keys(Ei),e.autoInsertRow=!0):De(n)?(oe(n.autoInsertRow)?n.direction===Ei.horizontal?e.autoInsertRow=!1:e.autoInsertRow=n.autoInsertRow:e.autoInsertRow=!1,oe(n.direction)?e.directions=[n.direction]:e.directions=Object.keys(Ei)):typeof n=="string"?(e.directions=[n],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}de.getSingleton().register("modifyAutofillRange");de.getSingleton().register("beforeAutofill");de.getSingleton().register("afterAutofill");const Qy="autofill",nG=20,sG=["fillHandle"],oG="insert_row_below",iG=200;class rG extends tt{static get PLUGIN_KEY(){return Qy}static get PLUGIN_PRIORITY(){return nG}static get SETTING_KEYS(){return[Qy,...sG]}constructor(e){super(e),this.eventManager=new It(this),this.addingStarted=!1,this.mouseDownOnCellCorner=!1,this.mouseDragOutside=!1,this.handleDraggedCells=0,this.directions=[],this.autoInsertRow=!1}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>this.onAfterCellCornerMouseDown(e)),this.addHook("afterOnCellCornerDblClick",e=>this.onCellCornerDblClick(e)),this.addHook("beforeOnCellMouseOver",(e,t)=>this.onBeforeCellMouseOver(t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:s}=e.getTopStartCorner(),{row:o,col:i}=e.getBottomEndCorner(),r=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:s,endRow:o,endCol:i}]),a=[],l=[],u=[];return T(r,c=>{for(let d=c.startRow;d<=c.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=c.startCol;d<=c.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),T(a,c=>{const d=[];T(l,f=>{d.push(this.hot.getCopyableData(c,f))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,s,o]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),r=i.getTopStartCorner(),a=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[r.row,r.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(r.row,e),Math.min(r.col,t),Math.max(a.row,s),Math.max(a.col,o)],l),{directionOfDrag:c,startOfDragCoords:d,endOfDragCoords:f}=eG(l,u,(m,w)=>this.hot._createCellCoords(m,w));if(d&&d.row>-1&&d.col>-1){const m=this.getSelectionData(),w=i.clone(),C=this.hot._createCellRange(d,d,f),b=this.hot.runHooks("beforeAutofill",m,w,C,c);if(b===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=b;const M=b;if(["up","left"].indexOf(c)>-1&&!(M.length===1&&M[0].length===0))if(y=[],c==="up"){const A=f.row-d.row+1,$=A%M.length;for(let H=0;H<A;H++)y.push(M[(H+(M.length-$))%M.length])}else{const A=f.col-d.col+1,$=A%M[0].length;for(let H=0;H<M.length;H++){y.push([]);for(let V=0;V<A;V++)y[H].push(M[H][(V+(M[H].length-$))%M[H].length])}}this.hot.populateFromArray(d.row,d.col,y,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,w,C,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),s=t.getBottomEndCorner();let o=e;if(this.directions.includes(Ei.vertical)&&this.directions.includes(Ei.horizontal)){const i=t.getTopStartCorner();(s.col<=e.col||i.col>=e.col)&&(o=this.hot._createCellCoords(s.row,e.col)),(s.row<e.row||i.row>e.row)&&(o=this.hot._createCellCoords(e.row,s.col))}else if(this.directions.includes(Ei.vertical))o=this.hot._createCellCoords(e.row,s.col);else if(this.directions.includes(Ei.horizontal))o=this.hot._createCellCoords(s.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(o)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(oG,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},iG)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.countRows();e[2]<s-1&&t[2]===s-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),s=this.hot.countRows();let o;for(let i=e[2]+1;i<s;i++){for(let l=e[1];l<=e[3];l++)if(t[i][l])return-1;const r=t[i][e[1]-1],a=t[i][e[3]+1];(r||a)&&(o=i)}return o}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ve(e,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return t===-1||t===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,s=Lt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+Et(this.hot.table),o=Lt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+ut(this.hot.table);return e.clientY>s&&e.clientX<=o}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t))}onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}onBeforeCellMouseOver(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}onMouseUp(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}onMouseMove(e){const t=this.getIfMouseWasDraggedOutside(e);this.addingStarted===!1&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=tG(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}const Ru="autoRowSize",aG=40,lG="autoRowSize";class ja extends tt{static get PLUGIN_KEY(){return Ru}static get PLUGIN_PRIORITY(){return aG}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),this.rowHeightsMap=void 0,this.headerHeight=null,this.ghostTable=new rS(this.hot),this.samplesGenerator=new UM((t,s)=>{if(t>=0&&s>=0&&this.hot.getCellMeta(t,s).hidden)return!1;let o;return t>=0?o=this.hot.getDataAtCell(t,s):t===-1&&(o=this.hot.getColHeader(s)),{value:o}}),this.firstCalculation=!0,this.inProgress=!1,this.measuredRows=0,this.rowHeightsMap=new ei,this.hot.rowIndexMapper.registerMap(lG,this.rowHeightsMap),this.addHook("beforeRowResize",(t,s,o)=>this.onBeforeRowResize(t,s,o))}isEnabled(){const e=this.hot.getSettings()[Ru];return e===!0||De(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeChangeRender",t=>this.onBeforeChange(t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>this.onBeforeViewRender(t)),this.addHook("modifyRowHeight",(t,s)=>this.getRowHeight(s,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,s)=>this.onBeforeRowResize(e,t,s))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=typeof e=="number"?{from:e,to:e}:e,i=typeof t=="number"?{from:t,to:t}:t;if(this.hot.getColHeader(0)!==null){const r=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(r.get(-1))}me(o.from,o.to,r=>{if(s||this.rowHeightsMap.getValueAtIndex(r)===null){const a=this.samplesGenerator.generateRowSamples(r,i);T(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,a)=>{r<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(r),a)})},!0),this.measuredRows=o.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},t=0;const s=this.hot.countRows()-1;let o=null;this.inProgress=!0;const i=()=>{if(!this.hot){rl(o),this.inProgress=!1;return}this.calculateRowsHeight({from:t,to:Math.min(t+ja.CALCULATION_STEP,s)},e),t=t+ja.CALCULATION_STEP+1,t<s?o=Dh(i):(rl(o),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},r=this.getSyncCalculationLimit();this.firstCalculation&&r>=0&&(this.calculateRowsHeight({from:0,to:r},e),this.firstCalculation=!1,t=r+1),t<s?i():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[Ru],t=e&&Rt(e,"samplingRatio")?e.samplingRatio:void 0,s=e&&Rt(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),s&&this.samplesGenerator.setAllowDuplicates(s)}recalculateAllRowsHeight(){jo(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[Ru];let t=ja.SYNC_CALCULATION_LIMIT;const s=this.hot.countRows()-1;return De(e)&&(t=e.syncLimit,Mw(t)?t=zw(s,t):t>>=0),Math.min(t,s)}getRowHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const s=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let o=t;return s!==null&&s>(t||0)&&(o=s),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:t,to:s}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{me(Math.min(t,s),Math.max(t,s),o=>{this.rowHeightsMap.setValueAtIndex(o,null)})},!0)}isNeedRecalculate(){return!!kn(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}onBeforeViewRender(){const e=this.hot.renderCall,t=this.hot.getSettings().fixedRowsBottom,s=this.getFirstVisibleRow(),o=this.getLastVisibleRow();if(!(s===-1||o===-1)){if(this.calculateRowsHeight({from:s,to:o},void 0,e),t){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-t,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}onBeforeRowMove(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()}onBeforeRowResize(e,t,s){let o=e;return s&&(this.calculateRowsHeight(t,void 0,!0),o=this.getRowHeight(t)),o}onAfterLoadData(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}onBeforeChange(e){let t=null;e.length===1?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),t!==null&&this.clearCacheByRange(t)}destroy(){this.ghostTable.clean(),super.destroy()}}const{getListWithInsertedItems:uG,getListWithRemovedItems:cG}=jT("physicallyIndexed");class hG extends $i{constructor(){super(e=>e)}insert(e,t){const s=EC(this.indexedValues,t);this.indexedValues=uG(s,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=cG(this.indexedValues,e);this.indexedValues=RC(t,e),super.remove(e)}}const dG=hG,{getListWithInsertedItems:fG,getListWithRemovedItems:gG}=jT("physicallyIndexed");class mG extends $i{constructor(){super(e=>e)}insert(e,t){this.indexedValues=fG(this.indexedValues,e,t,(s,o)=>this.getNextValue(o)),super.insert(e,t)}remove(e){this.indexedValues=gG(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const pG=mG,Rg="bindRowsWithHeaders",wG=210,CG="loose",SG=new Map([["loose",dG],["strict",pG]]);class vG extends tt{static get PLUGIN_KEY(){return Rg}static get PLUGIN_PRIORITY(){return wG}constructor(e){super(e),this.headerIndexes=null}isEnabled(){return!!this.hot.getSettings()[Rg]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[Rg];typeof e!="string"&&(e=CG);const t=SG.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",s=>this.onModifyRowHeader(s)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}onModifyRowHeader(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}destroy(){super.destroy()}}function yG(n,e,t){bG(n,e),e.set(n,t)}function bG(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eg(n,e,t){return e=RG(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function RG(n){var e=EG(n,"string");return typeof e=="symbol"?e:String(e)}function EG(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Jy(n,e){var t=YM(n,e,"get");return TG(n,t)}function TG(n,e){return e.get?e.get.call(n):e.value}function Tg(n,e,t){var s=YM(n,e,"set");return MG(n,s,t),t}function YM(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function MG(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const Cc="collapsibleColumns",_G=290,OG=["nestedHeaders"],Zi="collapsibleIndicator",eb=Cc,tb=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Qi=new WeakMap;class AG extends tt{constructor(){super(...arguments),Eg(this,"nestedHeadersPlugin",null),Eg(this,"eventManager",new It(this)),Eg(this,"headerStateManager",null),yG(this,Qi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Cc}static get PLUGIN_PRIORITY(){return _G}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Cc,...OG]}isEnabled(){return!!this.hot.getSettings()[Cc]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||lt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Tg(this,Qi,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",(s,o,i)=>this.onBeforeOnCellMouseDown(s,o,i)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Tg(this,Qi,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:s}=this.hot.getSelectedRangeLast().highlight,{collapsible:o,isCollapsed:i,columnIndex:r}=(e=this.headerStateManager.getHeaderTreeNodeData(t,s))!==null&&e!==void 0?e:{};o&&(i?this.expandSection({row:t,col:r}):this.collapseSection({row:t,col:r}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:eb})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(eb)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,o=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(r){r&&r.parentNode.removeChild(r)};me(0,e-1,r=>{const a=t.childNodes[r],l=s.childNodes[r],u=o?o.childNodes[r]:null;me(0,a.childNodes.length-1,c=>{let d=a.childNodes[c].querySelector(`.${Zi}`);i(d),l&&l.childNodes[c]&&(d=l.childNodes[c].querySelector(`.${Zi}`),i(d)),o&&u&&u.childNodes[c]&&(d=u.childNodes[c].querySelector(`.${Zi}`),i(d))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes(s=>{const{collapsible:o,origColspan:i,headerLevel:r,columnIndex:a,isCollapsed:l}=s;if(o===!0&&i>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(r),col:a}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!tb.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const s=kn(e,f=>{let{row:m}=f;return m<0});let o=s.length>0;T(s,f=>{var m;let{row:w,col:C}=f;const{collapsible:b,isCollapsed:y}=(m=this.headerStateManager.getHeaderSettings(w,C))!==null&&m!==void 0?m:{};if(!b||y&&t==="collapse"||!y&&t==="expand")return o=!1,!1});const i=[],r=[];o&&T(s,f=>{let{row:m,col:w}=f;const{colspanCompensation:C,affectedColumns:b,rollbackModification:y}=this.headerStateManager.triggerNodeModification(t,m,w);C>0&&(r.push(...b),i.push(y))});const a=this.getCollapsedColumns();let l=[];t==="collapse"?l=Ew([...a,...r]):t==="expand"&&(l=kn(a,f=>!r.includes(f)));const u=tb.get(t);if(this.hot.runHooks(u.beforeHook,a,l,o)===!1){T(i,f=>{f()});return}this.hot.batchExecution(()=>{T(r,f=>{Jy(this,Qi).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,o,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return Jy(this,Qi).getHiddenIndexes()}onAfterGetColHeader(e,t,s){var o;const{collapsible:i,origColspan:r,isCollapsed:a}=(o=this.headerStateManager.getHeaderSettings(s,e))!==null&&o!==void 0?o:{},l=i&&r>1&&e>=this.hot.getSettings().fixedColumnsStart,u=this.hot.getSettings().ariaTags;let c=t.querySelector(`.${Zi}`);if(Jo(t,[jt("")[0]]),l)c||(c=this.hot.rootDocument.createElement("div"),J(c,Zi),t.querySelector("div:first-child").appendChild(c)),Pe(c,["collapsed","expanded"]),a?(J(c,"collapsed"),Go(c,"+"),u&&Se(t,[jt(!1),nl(this.hot.getTranslatedPhrase(HC))])):(J(c,"expanded"),Go(c,"-"),u&&Se(t,[jt(!0),nl(this.hot.getTranslatedPhrase(PC))])),u&&Se(c,...go());else{var d;(d=c)===null||d===void 0||d.remove()}}onBeforeOnCellMouseDown(e,t){Ae(e.target,Zi)&&(Ae(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Ae(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),Xn(e))}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){Tg(this,Qi,null),super.destroy()}}const IG=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],xG=!1,HG=!0,PG=!0;class DG{constructor(e,t){this.hot=e,this.sortingStates=new kh,this.sortEmptyCells=xG,this.indicator=HG,this.headerAction=PG,this.compareFunctionFactory=void 0,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){De(e)&&We(e,(t,s)=>{IG.includes(s)&&(this[s]=t)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||t===void 0?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[s]=t;return s===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return De(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(t=>{let[s,o]=t;return{column:this.hot.toVisualColumn(s),...o}})}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(oe(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const qc="asc",Zc="desc",NG="colHeader";function LG(n){if(De(n)===!1)return!1;const{column:e,sortOrder:t}=n;return Number.isInteger(e)&&[qc,Zc].includes(t)}function kG(n){if(n.some(t=>LG(t)===!1))return!1;const e=n.map(t=>{let{column:s}=t;return s});return new Set(e).size===e.length}function nb(n){if(n!==Zc)return n===qc?Zc:qc}function sb(n){return n.querySelector(`.${NG}`)}function ob(n,e){if(n<0||!e.parentNode)return!1;const t=e.parentNode.parentNode.childNodes;return Array.from(t).indexOf(e.parentNode)-t.length===-1}function Mp(n,e,t){return n===-1&&e>=0&&Ko(t)===!1}const FG="ascending",$G="descending",zM="indicatorDisabled",GM="columnSorting",jM="sortAction",KM=new Map([[qc,FG],[Zc,$G]]);function VG(n,e,t,s){const o=[GM];if(s&&o.push(jM),t===!1)return o.push(zM),o;const i=n.getSortOrderOfColumn(e);return oe(i)&&o.push(KM.get(i)),o}function WG(){return Array.from(KM.values()).concat(jM,zM,GM)}function XM(n,e,t){const s=e.locale;return function(o,i){const{sortEmptyCells:r}=t;return typeof o=="string"&&(o=o.toLocaleLowerCase(s)),typeof i=="string"&&(i=i.toLocaleLowerCase(s)),o===i?As:Vt(o)?Vt(i)?As:r&&n==="asc"?_t:Ot:Vt(i)?r&&n==="asc"?Ot:_t:isNaN(o)&&!isNaN(i)?n==="asc"?Ot:_t:!isNaN(o)&&isNaN(i)||(isNaN(o)||isNaN(i)||(o=parseFloat(o),i=parseFloat(i)),o<i)?n==="asc"?_t:Ot:o>i?n==="asc"?Ot:_t:As}}const qM="default";function BG(n,e,t){return function(s,o){const i=parseFloat(s),r=parseFloat(o),{sortEmptyCells:a}=t;if(i===r||isNaN(i)&&isNaN(r))return As;if(a){if(Vt(s))return n==="asc"?_t:Ot;if(Vt(o))return n==="asc"?Ot:_t}return isNaN(i)?Ot:isNaN(r)?_t:i<r?n==="asc"?_t:Ot:i>r?n==="asc"?Ot:_t:As}}const UG="numeric";function YG(n,e,t){const s=e.checkedTemplate,o=e.uncheckedTemplate,{sortEmptyCells:i}=t;return function(r,a){const l=Vt(r),u=Vt(a),c=l?o:r,d=u?o:a,f=c===o||c===s,m=d===o||d===s;if(i===!1){if(l&&u===!1)return Ot;if(l===!1&&u)return _t}return f===!1&&m?n==="asc"?_t:Ot:f&&m===!1?n==="asc"?Ot:_t:f===!1&&m===!1?XM(n,e,t)(r,a):c===o&&d===s?n==="asc"?_t:Ot:c===s&&d===o?n==="asc"?Ot:_t:As}}const zG="checkbox";function GG(n,e,t){return function(s,o){const{sortEmptyCells:i}=t;if(s===o)return As;if(Vt(s))return Vt(o)?As:i&&n==="asc"?_t:Ot;if(Vt(o))return i&&n==="asc"?Ot:_t;const r=e.dateFormat,a=Q(s,r),l=Q(o,r);return a.isValid()?l.isValid()?l.isAfter(a)?n==="asc"?_t:Ot:l.isBefore(a)?n==="asc"?Ot:_t:As:_t:Ot}}const jG="date",{register:of,getItem:ib,hasItem:KG}=fs("sorting.compareFunctionFactory"),{register:ZM,getItem:XG}=fs("sorting.mainSortComparator");function QM(n){return KG(n)?ib(n):ib(qM)}of(UG,BG);of(zG,YG);of(jG,GG);of(qM,XM);const As=0,_t=-1,Ot=1;function qG(n,e){const t=XG(e);for(var s=arguments.length,o=new Array(s>2?s-2:0),i=2;i<s;i++)o[i-2]=arguments[i];n.sort(t(...o))}function ZG(n,e){return function(t,s){const[,...o]=t,[,...i]=s;return function(a){const l=n[a],u=e[a],c=o[a],d=i[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:QM(u.type))(l,u,f)(c,d)}(0)}}const Qc="columnSorting",QG=50,Jc="append",JG="replace",rb=Qc,ab="columnSortingIndicator";ZM(Qc,ZG);de.getSingleton().register("beforeColumnSort");de.getSingleton().register("afterColumnSort");class JM extends tt{static get PLUGIN_KEY(){return Qc}static get PLUGIN_PRIORITY(){return QG}constructor(e){super(e),this.columnStatesManager=null,this.columnMetaCache=null,this.pluginKey=Qc,this.indexesSequenceCache=null}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new DG(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new ei(t=>{let s=this.hot.toVisualColumn(t);return s===null&&(s=t),this.getMergedPluginSettings(s)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,s)=>this.onAfterGetColHeader(t,s)),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",(t,s)=>this.onAfterOnCellMouseDown(t,s)),this.addHook("afterInit",()=>this.loadOrSortBySettings()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.hot.view&&this.loadOrSortBySettings(),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(t,s)=>{const o=sb(s);ob(t,s)===!1||o===null||this.updateHeaderClasses(o)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:rb})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rb)}sort(e){const t=this.getSortConfig(),s=this.getNormalizedSortConfigs(e),o=this.areValidSortConfigs(s);this.hot.runHooks("beforeColumnSort",t,s,o)!==!1&&(t.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new KT),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),o&&(this.columnStatesManager.setSortStates(s),this.sortByPresetSortStates(s),this.saveAllSortSettings(s)),this.hot.runHooks("afterColumnSort",t,o?s:t,o),o&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return oe(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return kG(e)&&e.every(s=>{let{column:o}=s;return o<=t&&o>=0})}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties(),s=o=>{let{column:i,...r}=o;return{column:this.hot.toPhysicalColumn(i),...r}};t.initialConfig=Ve(e,s),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,s=o=>{let{column:i,...r}=o;return{column:this.hot.toVisualColumn(i),...r}};return oe(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=Ve(t.initialConfig,s)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(oe(t)){const o=nb(t);return oe(o)?{column:e,sortOrder:o}:void 0}const s=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<s)return{column:e,sortOrder:nb()}}getNextSortConfig(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jc;const s=this.columnStatesManager.getIndexOfColumnInSortQueue(e),o=s!==-1,i=this.getSortConfig(),r=this.getColumnNextConfig(e);if(o){if(ft(r))return[...i.slice(0,s),...i.slice(s+1)];if(t===Jc)return[...i.slice(0,s),...i.slice(s+1),r];if(t===JG)return[...i.slice(0,s),r,...i.slice(s+1)]}return oe(r)?i.concat(r):i}getPluginColumnConfig(e){if(De(e)){const t=e[this.pluginKey];if(De(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],s=this.columnStatesManager.getAllColumnsProperties(),o=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(o);return Array.isArray(i.columns)?Object.assign(s,t,this.getPluginColumnConfig(i.columns[e])):dt(i.columns)?Object.assign(s,t,this.getPluginColumnConfig(i.columns(e))):Object.assign(s,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),s=Object.create(t);return s[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),s}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const t=[],s=this.hot.countRows(),o=u=>Ve(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(s);u+=1)t.push([this.hot.toPhysicalRow(u)].concat(o(u)));const i=Ve(t,u=>u[0]);qG(t,this.pluginKey,Ve(e,u=>u.sortOrder),Ve(e,u=>this.getFirstCellSettings(u.column)));for(let u=t.length;u<s;u+=1)t.push([u].concat(o(u)));const r=Ve(t,u=>u[0]),a=new Map(Ve(i,(u,c)=>[u,r[c]])),l=Ve(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}loadOrSortBySettings(){const e=this.getAllSavedSortSettings();if(De(e))this.sortBySettings(e);else{const t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}sortBySettings(e){if(De(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||De(t))&&this.sort(t)}else this.hot.render()}onAfterGetColHeader(e,t){const s=sb(t);if(ob(e,t)===!1||s===null)return;const o=this.getFirstCellSettings(e)[this.pluginKey],i=this.hot.getSettings().ariaTags,r=o.indicator,a=o.headerAction,l=this.columnStatesManager.getSortOrderOfColumn(e);this.updateHeaderClasses(s,this.columnStatesManager,e,r,a),this.updateSortingIndicator(e,s),i&&Se(t,[rF(l?`${l}ending`:"none"),nl(this.hot.getTranslatedPhrase(DC))])}updateHeaderClasses(e){if(Pe(e,WG()),this.enabled!==!1){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];J(e,VG(...s))}}updateSortingIndicator(e,t){const s=this.getFirstCellSettings(e)[this.pluginKey],o=this.hot.getSettings().ariaTags,i=s.indicator,r=this.columnStatesManager.isColumnSorted(e),a=t.querySelector(`.${ab}`);i&&r&&!a&&Ai(t,{tagName:"div",className:ab,attributes:o?[go()]:[]})}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),oe(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}onAfterLoadData(e){e===!0&&this.hot.view&&this.loadOrSortBySettings()}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onBeforeOnCellMouseDown(e,t,s,o){Mp(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(o.column=!0)}onAfterOnCellMouseDown(e,t){Mp(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}class ej{constructor(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let s=e;if(!s&&typeof this.settings=="function"){this.settingsType="function";return}return s||(s=this.settings),T(s,o=>{const i={};this.assignSetting(o,i,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(o,i,"reversedRowCoords",!1),this.assignSetting(o,i,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,i,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(o,i,"sourceColumn",o.destinationColumn),this.assignSetting(o,i,"type","sum"),this.assignSetting(o,i,"forceNumeric",!1),this.assignSetting(o,i,"suppressDataTypeErrors",!0),this.assignSetting(o,i,"suppressDataTypeErrors",!0),this.assignSetting(o,i,"customFunction",null),this.assignSetting(o,i,"readOnly",!0),this.assignSetting(o,i,"roundFloat",!1),t.push(i)}),t}assignSetting(e,t,s,o){if(s==="ranges"&&e[s]===void 0){t[s]=o;return}else if(s==="ranges"&&e[s].length===0)return;if(e[s]===void 0){if(o instanceof Error)throw o;t[s]=o}else s==="destinationRow"&&t.reversedRowCoords?t[s]=this.hot.countRows()-e[s]-1:t[s]=e[s]}resetSetupBeforeStructureAlteration(e,t,s){if(this.settingsType!=="function")return;const o=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();T(i,r=>{o==="row"&&r.destinationRow>=t&&(e==="insert_row"?r.alterRowOffset=s:e==="remove_row"&&(r.alterRowOffset=-1*s)),o==="col"&&r.destinationColumn>=t&&(e==="insert_col"?r.alterColumnOffset=s:e==="remove_col"&&(r.alterColumnOffset=-1*s))}),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,t,s,o,i){let r=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,d=t;T(u,f=>{a==="row"&&f.destinationRow>=d&&(f.alterRowOffset=l*s),a==="col"&&f.destinationColumn>=d&&(f.alterColumnOffset=l*s)}),this.resetAllEndpoints(u,!c),c?T(u,f=>{this.extendEndpointRanges(f,d,o[0],o.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):T(u,f=>{this.shiftEndpointCoordinates(f,d)}),r&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,s,o){T(e.ranges,i=>{i[1]&&(t>=i[0]&&t<=i[1]?s>i[1]?i[1]+=o:s<i[0]&&(i[0]-=o):s>=i[0]&&s<=i[1]&&(i[1]-=o,t<=i[0]&&(i[0]+=1,i[1]+=1)))})}recreatePhysicalRanges(e){const t=e.ranges,s=[],o=[];T(t,i=>{const r=[];if(i[1])for(let a=i[0];a<=i[1];a++)r.push(this.hot.toPhysicalRow(a));else r.push(this.hot.toPhysicalRow(i[0]));o.push(r)}),T(o,i=>{let r=[];T(i,(a,l)=>{l===0?r.push(a):i[l]!==i[l-1]+1&&(r.push(i[l-1]),s.push(r),r=[],r.push(a)),l===i.length-1&&(r.push(a),s.push(r))})}),e.ranges=s}shiftEndpointCoordinates(e,t){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,T(e.ranges,s=>{T(s,(o,i)=>{o>=t&&(s[i]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(o=>{const i=o.alterRowOffset||0,r=o.alterColumnOffset||0;return o.destinationRow+i>=this.hot.countRows()||o.destinationColumn+r>=this.hot.countCols()})||(this.cellsToSetCache=[],T(e,o=>{this.resetEndpointValue(o,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],T(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],T(e,(s,o,i)=>{`${s[2]||""}`!=`${s[3]}`&&T(this.getAllEndpoints(),(r,a)=>{this.hot.propToCol(i[o][1])===r.sourceColumn&&t.indexOf(a)===-1&&t.push(a)})}),T(t,s=>{this.refreshEndpoint(this.getEndpoint(s))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const s=e.alterRowOffset||0,o=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?s:0)),this.hot.toVisualColumn(e.destinationColumn+(t?o:0)),""])}setEndpointValue(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const i=this.hot.toVisualRow(e.destinationRow);if(i!==null){const r=this.hot.getCellMeta(i,e.destinationColumn);(t==="init"||r.readOnly!==e.readOnly)&&(r.readOnly=e.readOnly,r.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),s?this.hot.setDataAtCell(o,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([o,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){lt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const tj=ej;function Mg(n){return n==null||isNaN(n)}const _g="columnSummary",nj=220;class sj extends tt{static get PLUGIN_KEY(){return _g}static get PLUGIN_PRIORITY(){return nj}constructor(e){super(e),this.endpoints=null}isEnabled(){return!!this.hot.getSettings()[_g]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[_g],this.endpoints=new tj(this,this.settings),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeCreateRow",(t,s,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,s,null,o)),this.addHook("beforeCreateCol",(t,s,o)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,s,null,o)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...s)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...s)}),this.addHook("afterCreateRow",(t,s,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,s,null,o)),this.addHook("afterCreateCol",(t,s,o)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,s,null,o)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...s)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...s)}),this.addHook("afterRowMove",function(){return e.onAfterRowMove(...arguments)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let t=0;return We(e.ranges,s=>{t+=this.getPartialSum(s,e.sourceColumn)}),t}getPartialSum(e,t){let s=0,o=e[1]||e[0],i=null,r=0;do{if(i=this.getCellValue(o,t),i=Mg(i)?null:i,i!==null){const a=(`${i}`.split(".")[1]||[]).length||1;a>r&&(r=a)}s+=i||0,o-=1}while(o>=e[0]);return Math.round(s*10**r)/10**r}calculateMinMax(e,t){let s=null;return We(e.ranges,o=>{const i=this.getPartialMinMax(o,e.sourceColumn,t);if(s===null&&i!==null&&(s=i),i!==null)switch(t){case"min":s=Math.min(s,i);break;case"max":s=Math.max(s,i);break}}),s===null?"Not enough data":s}getPartialMinMax(e,t,s){let o=null,i=e[1]||e[0],r;do{if(r=this.getCellValue(i,t),r=Mg(r)?null:r,o===null)o=r;else if(r!==null)switch(s){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r);break}i-=1}while(i>=e[0]);return o}countEmpty(e,t){let s,o=0,i=e[1]||e[0];do s=this.getCellValue(i,t),s=Mg(s)?null:s,s===null&&(o+=1),i-=1;while(i>=e[0]);return o}countEntries(e){let t=0;const s=e.ranges;return We(s,o=>{const i=o[1]===void 0?1:o[1]-o[0]+1,r=this.countEmpty(o,e.sourceColumn);t+=i,t-=r}),t}calculateAverage(e){const t=this.calculateSum(e),s=this.countEntries(e);return t/s}getCellValue(e,t){const s=this.hot.toVisualRow(e),o=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),r="";if(s!==null&&o!==null&&(r=this.hot.getCellMeta(s,o).className||""),r.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof i=="string"&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Qe`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}onAfterInit(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}onAfterChange(e,t){e&&t!=="ColumnSummary.reset"&&t!=="ColumnSummary.set"&&t!=="loadData"&&this.endpoints.refreshChangedEndpoints(e)}onAfterRowMove(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}}class Rr{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){this.rootDocument=e,this.isRtl=t,this.container=null,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()}setPosition(e,t){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${t}px`}setSize(e,t){if(e&&t){const s=this.getInputElement();s.style.width=`${e}px`,s.style.height=`${t}px`}}getSize(){return{width:ut(this.getInputElement()),height:Et(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const t=this.getInputElement();t.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const t=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=t}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),t=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),J(this.container,Rr.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),J(e,Rr.CLASS_EDITOR),J(t,Rr.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Rr.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const oj=Rr,ij=250,rj=250;class e_{constructor(e){this.wasLastActionShow=!0,this.showDebounced=null,this.hidingTimer=null,this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},rj)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ij;this.showDebounced=Nw(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},e)}destroy(){this.clearLocalHooks()}}ht(e_,In);const aj=e_;function lj(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function uj(n,e){return n.indexOf(e)!==-1?n:`${n.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function di(n,e){const t={};return T(n,s=>{s.forAll((o,i)=>{o>=0&&i>=0&&(t[o]||(t[o]=[]),t[o][i]=e(o,i))})}),t}function Ho(n,e,t,s,o){T(n,i=>{i.forAll((r,a)=>{r>=0&&a>=0&&cj(r,a,e,t,s,o)})})}function cj(n,e,t,s,o,i){const r=o(n,e);let a=s;r.className&&(t==="vertical"?a=lj(r.className,s):a=uj(r.className,s)),i(n,e,"className",a)}function eo(n){return`<span class="selected">${String.fromCharCode(10003)}</span>${n}`}function Ts(n,e){let t=!1;return Array.isArray(n)&&T(n,s=>(s.forAll((o,i)=>{if(o>=0&&i>=0&&e(o,i))return t=!0,!1}),t)),t}function eh(n,e){const t={top:0,left:0};if(e!==n.ownerDocument){const{frameElement:s}=e.defaultView,{top:o,left:i}=s.getBoundingClientRect();t.top=o,t.left=i}return t}const Ue="---------";function hj(){return{name:Ue}}const Un="alignment";function dj(){return{key:Un,name(){return this.getTranslatedPhrase(id)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Un}:left`,name(){let n=this.getTranslatedPhrase(rd);return Ts(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htLeft")!==-1)return!0})&&(n=eo(n)),n},callback(){const n=this.getSelectedRange(),e=di(n,(o,i)=>this.getCellMeta(o,i).className),t="horizontal",s="htLeft";this.runHooks("beforeCellAlignment",e,n,t,s),Ho(n,t,s,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Un}:center`,name(){let n=this.getTranslatedPhrase(ad);return Ts(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htCenter")!==-1)return!0})&&(n=eo(n)),n},callback(){const n=this.getSelectedRange(),e=di(n,(o,i)=>this.getCellMeta(o,i).className),t="horizontal",s="htCenter";this.runHooks("beforeCellAlignment",e,n,t,s),Ho(n,t,s,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Un}:right`,name(){let n=this.getTranslatedPhrase(ld);return Ts(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htRight")!==-1)return!0})&&(n=eo(n)),n},callback(){const n=this.getSelectedRange(),e=di(n,(o,i)=>this.getCellMeta(o,i).className),t="horizontal",s="htRight";this.runHooks("beforeCellAlignment",e,n,t,s),Ho(n,t,s,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Un}:justify`,name(){let n=this.getTranslatedPhrase(ud);return Ts(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htJustify")!==-1)return!0})&&(n=eo(n)),n},callback(){const n=this.getSelectedRange(),e=di(n,(o,i)=>this.getCellMeta(o,i).className),t="horizontal",s="htJustify";this.runHooks("beforeCellAlignment",e,n,t,s),Ho(n,t,s,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{name:Ue},{key:`${Un}:top`,name(){let n=this.getTranslatedPhrase(cd);return Ts(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htTop")!==-1)return!0})&&(n=eo(n)),n},callback(){const n=this.getSelectedRange(),e=di(n,(o,i)=>this.getCellMeta(o,i).className),t="vertical",s="htTop";this.runHooks("beforeCellAlignment",e,n,t,s),Ho(n,t,s,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Un}:middle`,name(){let n=this.getTranslatedPhrase(hd);return Ts(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htMiddle")!==-1)return!0})&&(n=eo(n)),n},callback(){const n=this.getSelectedRange(),e=di(n,(o,i)=>this.getCellMeta(o,i).className),t="vertical",s="htMiddle";this.runHooks("beforeCellAlignment",e,n,t,s),Ho(n,t,s,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1},{key:`${Un}:bottom`,name(){let n=this.getTranslatedPhrase(dd);return Ts(this.getSelectedRange(),(t,s)=>{const o=this.getCellMeta(t,s).className;if(o&&o.indexOf("htBottom")!==-1)return!0})&&(n=eo(n)),n},callback(){const n=this.getSelectedRange(),e=di(n,(o,i)=>this.getCellMeta(o,i).className),t="vertical",s="htBottom";this.runHooks("beforeCellAlignment",e,n,t,s),Ho(n,t,s,(o,i)=>this.getCellMeta(o,i),(o,i,r,a)=>this.setCellMeta(o,i,r,a)),this.render()},disabled:!1}]}}}const rf="clear_column";function fj(){return{key:rf,name(){return this.getTranslatedPhrase(Kh)},callback(n,e){const t=e[0].start.col,s=e[0].end.col;this.countRows()&&this.populateFromArray(0,t,[[null]],Math.max(e[0].start.row,e[0].end.row),s,"ContextMenu.clearColumn")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const kl="col_left";function gj(){return{key:kl,name(){return this.getTranslatedPhrase(Wh)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,n.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Fl="col_right";function mj(){return{key:Fl,name(){return this.getTranslatedPhrase(Bh)},callback(){const n=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,n.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const $l="make_read_only";function pj(){return{key:$l,name(){let n=this.getTranslatedPhrase(jh);return Ts(this.getSelectedRange(),(t,s)=>this.getCellMeta(t,s).readOnly)&&(n=eo(n)),n},callback(){const n=this.getSelectedRange(),e=Ts(n,(t,s)=>this.getCellMeta(t,s).readOnly);T(n,t=>{t.forAll((s,o)=>{s>=0&&o>=0&&this.setCellMeta(s,o,"readOnly",!e)})}),this.render()},disabled(){const n=this.getSelectedRangeLast();return!!(!n||n.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const af="redo";function wj(){return{key:af,name(){return this.getTranslatedPhrase(Gh)},callback(){this.redo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Vl="remove_col";function Cj(){return{key:Vl,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[,t,,s]=n[0];t-s!==0&&(e=1)}return this.getTranslatedPhrase(Yh,e)},callback(){this.alter("remove_col",nU(this.getSelected()),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const lf="remove_row";function Sj(){return{key:lf,name(){const n=this.getSelected();let e=0;if(n)if(n.length>1)e=1;else{const[t,,s]=n[0];t-s!==0&&(e=1)}return this.getTranslatedPhrase(Uh,e)},callback(){this.alter("remove_row",sU(this.getSelected()),1,"ContextMenu.removeRow")},disabled(){const n=this.getSelectedRangeLast();if(!n||n.isSingleHeader()&&n.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const uf="row_above";function vj(){return{key:uf,name(){return this.getTranslatedPhrase($h)},callback(){const n=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",n.row,1,"ContextMenu.rowAbove")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const cf="row_below";function yj(){return{key:cf,name(){return this.getTranslatedPhrase(Vh)},callback(){const n=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",n.row,1,"ContextMenu.rowBelow")},disabled(){const n=this.getSelectedRangeLast();return!n||n.isSingleHeader()&&n.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const cl="no_items";function bj(){return{key:cl,name(){return this.getTranslatedPhrase(Fh)},disabled:!0,isCommand:!1}}const hf="undo";function Rj(){return{key:hf,name(){return this.getTranslatedPhrase(zh)},callback(){this.undo()},hidden(){const n=this.getPlugin("undoRedo");return!n||!n.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const Ej=[uf,cf,kl,Fl,rf,lf,Vl,hf,af,$l,Un,Ue,cl],Tj={[Ue]:hj,[cl]:bj,[uf]:vj,[cf]:yj,[kl]:gj,[Fl]:mj,[rf]:fj,[lf]:Sj,[Vl]:Cj,[hf]:Rj,[af]:wj,[$l]:pj,[Un]:dj};function t_(){const n={};return We(Tj,(e,t)=>{n[t]=e()}),n}function Mj(n){return{key:"commentsAddEdit",name(){var e;const t=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t!=null&&t.isCell()&&n.getCommentAtCell(t.row,t.col)?this.getTranslatedPhrase(nd):this.getTranslatedPhrase(td)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),n.setRange(e),n.show(),n.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!e||e.highlight.isHeader()?!0:this.countRenderedRows()===0||this.countRenderedCols()===0}}}function _j(n){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(sd)},callback(){this.getSelectedRangeLast().forAll((t,s)=>{t>=0&&s>=0&&n.removeCommentAtCell(t,s,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!e||e.highlight.isHeader()?!0:this.countRenderedRows()===0||this.countRenderedCols()===0}}}function Oj(n){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(od);return Ts(this.getSelectedRange(),(s,o)=>n.getCommentMeta(s,o,Sc))?eo(e):e},callback(){this.getSelectedRangeLast().forAll((t,s)=>{if(t>=0&&s>=0){const o=!!n.getCommentMeta(t,s,Sc);n.updateCommentMeta(t,s,{[Sc]:!o})}})},disabled(){const e=this.getSelectedRangeLast();return!e||e.highlight.isHeader()||!n.getCommentAtCell(e.highlight.row,e.highlight.col)?!0:this.countRenderedRows()===0||this.countRenderedCols()===0}}}function fi(n,e,t){Aj(n,e),e.set(n,t)}function Aj(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lb(n,e,t){return e=Ij(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ij(n){var e=xj(n,"string");return typeof e=="symbol"?e:String(e)}function xj(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ys(n,e,t){var s=n_(n,e,"set");return Hj(n,s,t),t}function Hj(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Ke(n,e){var t=n_(n,e,"get");return Pj(n,t)}function n_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Pj(n,e){return e.get?e.get.call(n):e.value}const Ka="comments",Dj=60,zs="comment",la="value",ub="style",Sc="readOnly",Eu=Ka,Og=`plugin:${Ka}`;var pt=new WeakMap,Jn=new WeakMap,Tu=new WeakMap,Mu=new WeakMap,_u=new WeakMap,Ag=new WeakMap,Ou=new WeakMap;class Nj extends tt{constructor(){super(...arguments),lb(this,"range",{}),lb(this,"eventManager",null),fi(this,pt,{writable:!0,value:null}),fi(this,Jn,{writable:!0,value:null}),fi(this,Tu,{writable:!0,value:!1}),fi(this,Mu,{writable:!0,value:!1}),fi(this,_u,{writable:!0,value:{}}),fi(this,Ag,{writable:!0,value:null}),fi(this,Ou,{writable:!0,value:""})}static get PLUGIN_KEY(){return Ka}static get PLUGIN_PRIORITY(){return Dj}isEnabled(){return!!this.hot.getSettings()[Ka]}enablePlugin(){this.enabled||(Ke(this,pt)||Ys(this,pt,new oj(this.hot.rootDocument,this.hot.isRtl())),this.eventManager||(this.eventManager=new It(this)),Ke(this,Jn)||Ys(this,Jn,new aj(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,s,o,i,r)=>this.onAfterRenderer(e,r)),this.addHook("afterScroll",()=>this.onAfterScroll()),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>this.onAfterDocumentKeyDown(e)),Ke(this,Jn).addLocalHook("hide",()=>this.hide()),Ke(this,Jn).addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ke(this,Jn).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),s=e.addContext(Og);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const o=this.hot.getSelectedRangeLast();Ys(this,Mu,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(o),this.show(),this.focusEditor(),e.setActiveContextName(Og),this.hot._registerTimeout(()=>{Ys(this,Mu,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var o;return((o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isCell())&&!Ke(this,pt).isVisible()},group:Eu}),s.addShortcut({keys:[["Escape"]],callback:()=>{Ke(this,pt).setValue(Ke(this,Ou)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var o;return((o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isCell())&&Ke(this,pt).isVisible()},group:Eu}),s.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var o;return((o=this.hot.getSelectedRangeLast())===null||o===void 0?void 0:o.highlight.isCell())&&Ke(this,pt).isVisible()},group:Eu})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Eu)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",s=>this.onMouseOver(s)),this.eventManager.addEventListener(e,"mousedown",s=>this.onMouseDown(s)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(t,"focus",()=>this.onEditorFocus()),this.eventManager.addEventListener(t,"blur",()=>this.onEditorBlur()),this.eventManager.addEventListener(t,"mousedown",s=>this.onEditorMouseDown(s)),this.eventManager.addEventListener(t,"mouseup",s=>this.onEditorMouseUp(s))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=$o(e.target,"TD","TBODY");return!!(t&&Ae(t,"htCommentCell")&&$o(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=Ke(this,pt).getValue();let s="";e!=null?s=e:t!=null&&(s=t);const o=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(o,i,{[la]:s}),this.hot.render()}setCommentAtCell(e,t,s){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(s)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,zs),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(s)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,la)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,la)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:s}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||s<0||s>this.hot.countSourceCols()-1)return!1;const o=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ke(this,Jn).cancelHiding(),Ke(this,pt).setValue((e=o[zs]?o[zs][la]:null)!==null&&e!==void 0?e:""),Ke(this,pt).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){Ke(this,pt).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ke(this,pt).isVisible()))return;const{rowIndexMapper:o,columnIndexMapper:i}=this.hot,{row:r,col:a}=this.range.from;let l=o.getRenderableFromVisualIndex(r),u=i.getRenderableFromVisualIndex(a);const c=l===null;Ke(this,pt).setPosition(0,0),l===null&&(l=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1))),u===null&&(u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1)));const d=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(t=u)!==null&&t!==void 0?t:0;const{rootWindow:m,view:{_wt:w}}=this.hot,{wtTable:C}=w,b=w.getCell({row:l,col:u},!0),y=this.getCommentMeta(r,a,ub);y?Ke(this,pt).setSize(y.width,y.height):Ke(this,pt).resetSize();const M=f?0:C.getStretchedColumnWidth(u),A=c&&!d?Et(b):0,{left:$,top:H,width:V,height:z}=b.getBoundingClientRect(),{width:ee,height:j}=Ke(this,pt).getSize(),{innerWidth:X,innerHeight:ie}=this.hot.rootWindow,ae=this.hot.rootDocument.documentElement;let re=$+m.scrollX+M,pe=H+m.scrollY+A;this.hot.isRtl()&&(re-=ee+M),this.hot.isLtr()&&$+V+ee>X?re=$+m.scrollX-ee-1:this.hot.isRtl()&&re<-(ae.scrollWidth-ae.clientWidth)&&(re=$+m.scrollX+M+1),H+j>ie&&(pe-=j-z+1),Ke(this,pt).setPosition(re,pe),Ke(this,pt).setReadOnlyState(this.getCommentMeta(r,a,Sc))}focusEditor(){Ke(this,pt).focus()}updateCommentMeta(e,t,s){const o=this.hot.getCellMeta(e,t)[zs];let i;o?(i=Qt(o),Ol(i,s)):i=s,this.hot.setCellMeta(e,t,zs,i)}getCommentMeta(e,t,s){const o=this.hot.getCellMeta(e,t);if(o[zs])return o[zs][s]}onMouseDown(e){if(!(!this.hot.view||!this.hot.view._wt)&&!Ke(this,Tu)&&!this.targetIsCommentTextArea(e)){const t=$o(e.target,"TD","TBODY");let s=null;t&&(s=this.hot.getCoords(t)),(!t||this.range.from&&s&&(this.range.from.row!==s.row||this.range.from.col!==s.col))&&this.hide()}}onMouseOver(e){const{rootDocument:t}=this.hot;if(!(Ke(this,Tu)||Ke(this,pt).isFocused()||Ae(e.target,"wtBorder")||Ke(this,Ag)===e.target||!Ke(this,pt)))if(Ys(this,Ag,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const s=this.hot._createCellRange(this.hot.getCoords(e.target));Ke(this,Jn).show(s)}else Vo(e.target,t)&&!this.targetIsCommentTextArea(e)&&Ke(this,Jn).hide()}onMouseUp(){Ys(this,Tu,!1)}onAfterRenderer(e,t){t[zs]&&t[zs][la]&&J(e,t.commentedCellClassName)}onEditorBlur(){Ys(this,Ou,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}onEditorFocus(){Ys(this,Ou,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Og)}onEditorMouseDown(e){Ys(this,_u,{width:ut(e.target),height:Et(e.target)})}onEditorMouseUp(e){const t=ut(e.target),s=Et(e.target);(t!==Ke(this,_u).width+1||s!==Ke(this,_u).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[ub]:{width:t,height:s}})}onAfterDocumentKeyDown(e){Ke(this,pt).isVisible()&&Xn(e)}onAfterScroll(){Ke(this,Mu)||this.hide()}addToContextMenu(e){e.items.push({name:Ue},Mj(this),_j(this),Oj(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Ka];if(De(e))return e.displayDelay}getEditorInputElement(){return Ke(this,pt).getInputElement()}destroy(){Ke(this,pt)&&Ke(this,pt).destroy(),Ke(this,Jn)&&Ke(this,Jn).destroy(),super.destroy()}}var cb=UR,Lj=TypeError,kj=function(n,e){if(!delete n[e])throw Lj("Cannot delete property "+cb(e)+" of "+cb(n))},Fj=Qo,$j=Cl,Vj=hh,Wj=a0,Bj=kj,Uj=l0,Yj=[].unshift(0)!==1,zj=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(n){return n instanceof TypeError}},Gj=Yj||!zj();Fj({target:"Array",proto:!0,arity:1,forced:Gj},{unshift:function(e){var t=$j(this),s=Vj(t),o=arguments.length;if(o){Uj(s+o);for(var i=s;i--;){var r=i+o;i in t?t[r]=t[i]:Bj(t,r)}for(var a=0;a<o;a++)t[a]=arguments[a]}return Wj(t,s+o)}});class s_{constructor(e){this.hot=e,this.commands={},this.commonCallback=null}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];const i=e.split(":"),r=i[0],a=i.length===2?i[1]:null;let l=this.commands[r];if(!l)throw new Error(`Menu command '${r}' not exists.`);if(a&&l.submenu&&(l=jj(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Rt(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),s.unshift(i.join(":")),T(u,c=>c.apply(this.hot,s))}}function jj(n,e){let t;return T(e,s=>{const o=s.key?s.key.split(":"):null;if(Array.isArray(o)&&o[1]===n)return t=s,!1}),t}class o_{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.hot=e,this.predefinedItems=t_(),this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,We(e,(s,o)=>{let i="";s.name===Ue?(t[Ue]=s,i=Ue):isNaN(parseInt(o,10))?(s.key=s.key===void 0?o:s.key,t[o]=s,i=s.key):(t[s.key]=s,i=s.key),this.defaultOrderPattern.push(i)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Kj(e,this.defaultOrderPattern,this.predefinedItems)}}function Kj(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=[];let o=n;return o&&o.items?o=o.items:Array.isArray(o)||(o=e),De(o)?We(o,(i,r)=>{let a=t[typeof i=="string"?i:r];a||(a=i),De(i)?kt(a,i):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=r),s.push(a)}):T(o,(i,r)=>{let a=t[i];!a&&Ej.indexOf(i)>=0||(a||(a={name:i,key:`${r}`}),De(i)&&kt(a,i),a.key===void 0&&(a.key=r),s.push(a))}),s}class Xj{constructor(e,t){const s=t.scrollY,o=t.scrollX;let i,r,a,l,u,c;this.rootWindow=t,this.type=this.getSourceType(e),this.type==="literal"?(i=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,r=i,l=a,i+=s,a+=o):this.type==="event"&&(i=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,r=i-s,l=a-o),this.top=i,this.topRelative=r,this.left=a,this.leftRelative=l,this.scrollTop=s,this.scrollLeft=o,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function ua(n,e,t){qj(n,e),e.set(n,t)}function qj(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ge(n,e){var t=i_(n,e,"get");return Zj(n,t)}function Zj(n,e){return e.get?e.get.call(n):e.value}function Au(n,e,t){var s=i_(n,e,"set");return Qj(n,s,t),t}function i_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function Qj(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var mn=new WeakMap,yo=new WeakMap,Zt=new WeakMap,Ig=new WeakMap,Ji=new WeakMap;class Jj{constructor(e){ua(this,mn,{writable:!0,value:void 0}),ua(this,yo,{writable:!0,value:void 0}),ua(this,Zt,{writable:!0,value:void 0}),ua(this,Ig,{writable:!0,value:!1}),ua(this,Ji,{writable:!0,value:{above:0,below:0,left:0,right:0}}),Au(this,Ig,e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ge(this,Ji)[e]=t,this}setElement(e){return Au(this,mn,e),this}setParentElement(e){return Au(this,yo,e),this}updatePosition(e){Au(this,Zt,new Xj(e,Ge(this,mn).ownerDocument.defaultView)),Ge(this,Ig)?(Ge(this,Zt).fitsBelow(Ge(this,mn))?this.setPositionBelowCursor():Ge(this,Zt).fitsAbove(Ge(this,mn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ge(this,mn).dir==="rtl"?Ge(this,Zt).fitsOnLeft(Ge(this,mn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ge(this,Zt).fitsOnRight(Ge(this,mn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ge(this,Ji).above+Ge(this,Zt).top-Ge(this,mn).offsetHeight;Ge(this,yo)&&(e=Ge(this,Zt).top+Ge(this,Zt).cellHeight-Ge(this,mn).offsetHeight+3),Ge(this,mn).style.top=`${e}px`}setPositionBelowCursor(){let e=Ge(this,Ji).below+Ge(this,Zt).top+1;Ge(this,yo)&&(e=Ge(this,Zt).top-1),Ge(this,mn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ge(this,Zt).left;if(Ge(this,yo)){const{right:t}=Ge(this,yo).getBoundingClientRect();e+=Ge(this,Zt).cellWidth+t-(Ge(this,Zt).left+Ge(this,Zt).cellWidth)}else e+=Ge(this,Ji).right;Ge(this,mn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ge(this,Ji).left+Ge(this,Zt).left-Ge(this,mn).offsetWidth;if(Ge(this,yo)){const{left:t}=Ge(this,yo).getBoundingClientRect();e-=Ge(this,Zt).left-t}Ge(this,mn).style.left=`${e}px`}}function r_(n){let{initialPage:e=-1,size:t=()=>0,onItemSelect:s=()=>{},onClear:o=()=>{}}=n;const i=new Set;let r=An(e,-1,w()-1);function a(b,y){const M=w()-1;return b<0&&(b=M),b>M&&(b=0),i.has(b)?-1:(i.add(b),s(b,!1)===!1&&(b=a(y===1?++b:--b,y)),b)}function l(b){b>-1&&b<w()&&s(b,!0)!==!1&&(r=b)}function u(){return r}function c(){w()>0&&(i.clear(),r=a(0,1))}function d(){w()>0&&(i.clear(),r=a(w()-1,-1))}function f(){w()>0&&(i.clear(),r=a(++r,1))}function m(){w()>0&&(i.clear(),r=a(--r,-1))}function w(){return Math.max(t(),0)}function C(){i.clear(),r=e,o()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:d,toNextItem:f,toPreviousItem:m,getSize:w,clear:C}}function e3(n){return Ve(n,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function vc(n){return Rt(n,"submenu")}function _p(n){return new RegExp(Ue,"i").test(n.name)}function yc(n,e){return n.disabled===!0||typeof n.disabled=="function"&&n.disabled.call(e)===!0}function hb(n){return Rt(n,"disableSelection")}function t3(n){return Ae(n,"htSeparator")}function n3(n){return Ae(n,"htSubmenu")}function s3(n){return Ae(n,"htDisabled")}function o3(n){return Ae(n,"htSelectionDisabled")}function i3(n,e){return!n.hidden||!(typeof n.hidden=="function"&&n.hidden.call(e))}function a_(n,e){const t=n.slice(0);for(let s=0;s<t.length&&t[s].name===e;)t.shift();return t}function r3(n,e){let t=n.slice(0);return t.reverse(),t=a_(t,e),t.reverse(),t}function a3(n){const e=[];return T(n,(t,s)=>{s>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}function l3(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ue,t=n.slice(0);return t=a_(t,e),t=r3(t,e),t=a3(t),t}function u3(n){return r_({size:()=>n.countRows(),onItemSelect(e,t){const s=n.getCell(e,0);if(!s||t3(s)||s3(s)||o3(s))return!1;n.selectCell(e,0,...t?[e,0,!1,!1]:[])},onClear(){n.deselectCell()}})}function c3(n){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:n.hot.getShortcutManager().getContext("grid"),callback:()=>n.close(!0)},{keys:[["Escape"]],callback:()=>n.close()},{keys:[["ArrowDown"]],callback:()=>n.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>n.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=n.hotMenu.getSelectedLast();if(e){const t=n.openSubMenu(e[0]);t&&t.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{n.hotMenu.getSelectedLast()&&n.isSubMenu()&&(n.close(),n.isSubMenu()&&n.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>n.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>n.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const t=n.hotMenu.getSelectedLast();t&&(n.hotMenu.getSourceDataAtRow(t[0]).submenu?n.openSubMenu(t[0]).getNavigator().toFirstItem():(n.executeCommand(e),n.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.hotMenu.getSelectedLast()?n.hotMenu.selection.transformStart(-n.hotMenu.countVisibleRows(),0):n.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.hotMenu.getSelectedLast()?n.hotMenu.selection.transformStart(n.hotMenu.countVisibleRows(),0):n.getNavigator().toLastItem()}}]}const l_="menu",db=l_;function h3(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const t=[];s(c3(n)),e.forEach(u=>{let{shortcuts:c,contextName:d}=u;o(c,d)});function s(u,c){a(c).addShortcuts(u,{group:l_})}function o(u,c){const d=a(c);u.forEach(f=>{let{keys:m}=f;m.forEach(w=>d.removeShortcutsByKeys(w))}),t.push({shortcuts:u,contextName:c}),s(u,c)}function i(){return[...t]}function r(u){return u?`${db}:${u}`:db}function a(u){var c;const d=n.hotMenu.getShortcutManager(),f=r(u);return(c=d.getContext(f))!==null&&c!==void 0?c:d.addContext(f)}function l(u){n.hotMenu.getShortcutManager().setActiveContextName(r(u))}return{addCustomShortcuts:o,getCustomShortcuts:i,getContext:a,listen:l}}const d3="submenuIndicator";function f3(n){return(e,t,s,o,i,r)=>{if(t.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(s),l=n.rootDocument.createElement("div"),u=typeof r=="function"?r.call(n):r;if(hs(t),J(l,"htItemWrapper"),n.getSettings().ariaTags){const c=!yc(a,n)&&!hb(a)&&!_p(a);Se(t,[Zk(),zo(u),...c?[Wr(-1)]:[],...yc(a,n)?[oF()]:[],...vc(a)?[jt(!1)]:[]])}vc(a)&&(t.querySelector(".submenuIndicator")||Ai(t,{tagName:"div",attributes:n.getSettings().ariaTags?[go()]:[],className:d3})),t.className="",t.appendChild(l),_p(a)?J(t,"htSeparator"):typeof a.renderer=="function"?(J(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,s,o,i,u))):Fi(l,u),yc(a,n)?J(t,"htDisabled"):hb(a)?J(t,"htSelectionDisabled"):vc(a)&&J(t,"htSubmenu")}}function fb(n,e,t){g3(n,e),e.set(n,t)}function g3(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gb(n,e,t){var s=u_(n,e,"set");return m3(n,s,t),t}function m3(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function ca(n,e){var t=u_(n,e,"get");return p3(n,t)}function u_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function p3(n,e){return e.get?e.get.call(n):e.value}const mb=215;var ha=new WeakMap,Iu=new WeakMap;class Kr{constructor(e,t){var s=this;fb(this,ha,{writable:!0,value:void 0}),fb(this,Iu,{writable:!0,value:void 0}),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:mb,container:this.hot.rootDocument.documentElement},this.eventManager=new It(this),this.container=this.createContainer(this.options.name),this.positioner=new Jj(this.options.keepInViewport),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return s.parentMenu.runLocalHooks("afterSelectionChange",...i)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(e.document,"contextmenu",t=>this.onDocumentContextMenu(t)),e=sl(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ca(this,ha)}getKeyboardShortcutsCtrl(){return ca(this,Iu)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Nw(a=>this.openSubMenu(a),300),t=this.options.minWidth||mb;let s=!1,o=kn(this.menuItems,a=>(a.key===cl&&(s=!0),i3(a,this.hot)));if(o.length<1&&!s)o.push(t_()[cl]);else if(o.length===0)return;o=l3(o,Ue);let i=!1;const r={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return oe(a)&&a<t?t:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:f3(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{ca(this,ha).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>o[a].name===Ue?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),rp()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!rp()||!Ko(a))&&i&&this.hasSelectedItem()&&(io()||Vw()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,r),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),gb(this,ha,u3(this.hotMenu)),gb(this,Iu,h3(this)),ca(this,Iu).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(ca(this,ha).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const t=this.parentMenu.hotMenu.getSelectedLast();if(t){const s=this.parentMenu.hotMenu.getCell(t[0],0);Se(s,[jt(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!n3(t))return!1;const s=this.hotMenu.getSourceDataAtRow(e),o=new Kr(this.hot,{parent:this,name:s.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return o.setMenuItems(s.submenu.items),o.open(),o.setPosition(t.getBoundingClientRect()),this.hotSubMenus[s.key]=o,this.hot.getSettings().ariaTags&&Se(t,[jt(!0)]),o}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),s=this.hotSubMenus[t.key];if(s){s.destroy(),delete this.hotSubMenus[t.key];const o=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Se(o,[jt(!1)])}}closeAllSubMenus(){T(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const s=this.hot.getSelectedRange(),o=s?e3(s):[];this.runLocalHooks("executeCommand",t.key,o,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,o,e)}isCommandPassive(e){return e.isCommand===!1||_p(e)||yc(e,this.hot)||vc(e)}setOffset(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const t=this.options.container.ownerDocument;let s=e,o;return s&&(dt(s)&&(s=s.call(this.hot),s===null||ft(s)?s="":s=s.toString()),s=s.replace(/[^A-z0-9]/g,"_"),s=`${this.options.className}Sub_${s}`,o=t.querySelector(`.${this.options.className}.${s}`)),o||(o=t.createElement("div"),J(o,`htMenu ${this.options.className}`),s&&J(o,s),this.options.container.appendChild(o)),o}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,s=e.hider.style,o=e.holder.style,i=parseInt(s.width,10),r=Pt(t,(a,l)=>a+(l.name===Ue?1:26),0);o.width=`${i+3}px`,o.height=`${r+3}px`,s.height=o.height,this.hot.getSettings().ariaTags&&Se(this.hotMenu.rootElement,[qk(),Wr(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Vo(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!Vo(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ae(e.target,"htCore")&&Vo(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}ht(Kr,In);const Na="contextMenu",w3=70,pb=Na;de.getSingleton().register("afterContextMenuDefaultOptions");de.getSingleton().register("beforeContextMenuShow");de.getSingleton().register("afterContextMenuShow");de.getSingleton().register("afterContextMenuHide");de.getSingleton().register("afterContextMenuExecute");class Wl extends tt{static get PLUGIN_KEY(){return Na}static get PLUGIN_PRIORITY(){return w3}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[uf,cf,Ue,kl,Fl,Ue,lf,Vl,Ue,hf,af,Ue,$l,Ue,Un]}constructor(e){super(e),this.eventManager=new It(this),this.commandExecutor=new s_(this.hot),this.itemsFactory=null,this.menu=null}isEnabled(){return!!this.hot.getSettings()[Na]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Na];typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new Kr(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return e.executeCommand.call(e,...o)}),this.addHook("afterOnCellContextMenu",s=>this.onAfterOnCellContextMenu(s)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","\\"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),s=eh(this.menu.container,this.hot.rootDocument);this.open({left:t.left+s.left,top:t.top+s.top-1+t.height},{left:t.width,above:-t.height})},runOnlyIf:()=>this.hot.getSelectedRangeLast()&&!this.menu.isOpened(),group:pb})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pb)}open(e){var t;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.prepareMenuItems(),this.menu.open(),We(s,(o,i)=>{this.menu.setOffset(i,o)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];this.commandExecutor.execute(e,...s)}prepareMenuItems(){this.itemsFactory=new o_(this.hot,Wl.DEFAULT_ITEMS);const e=this.hot.getSettings()[Na],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const s=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",s),this.menu.setMenuItems(s),T(s,o=>this.commandExecutor.registerCommand(o.key,o))}onAfterOnCellContextMenu(e){const t=this.hot.getSettings(),s=t.rowHeaders,o=t.colHeaders;function i(l){return l.nodeName==="TD"||l.parentNode.nodeName==="TD"}const r=e.target;if(this.close(),Ae(r,"handsontableInput")||(e.preventDefault(),e.stopPropagation(),!(s||o)&&!i(r)&&!(Ae(r,"current")&&Ae(r,"wtBorder"))))return;const a=eh(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+a.top,left:e.clientX+a.left})}onMenuBeforeOpen(){this.hot.runHooks("beforeContextMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterContextMenuShow",this)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}Wl.SEPARATOR={name:Ue};function C3(n){return{key:"copy",name(){return this.getTranslatedPhrase(Xh)},callback(){n.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function S3(n){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?An(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(OC,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function v3(n){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?An(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(_C,t)},callback(){n.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function y3(n){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?An(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(MC,t)},callback(){n.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function b3(n){return{key:"cut",name(){return this.getTranslatedPhrase(qh)},callback(){n.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}function wb(n,e){c_(n,e),e.add(n)}function er(n,e,t){c_(n,e),e.set(n,t)}function c_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xu(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function wn(n,e){var t=h_(n,e,"get");return R3(n,t)}function R3(n,e){return e.get?e.get.call(n):e.value}function tr(n,e,t){var s=h_(n,e,"set");return E3(n,s,t),t}function h_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function E3(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var bo=new WeakMap,xg=new WeakMap,da=new WeakMap,Op=new WeakMap,Ap=new WeakMap,fa=new WeakMap,Hu=new WeakSet,Cb=new WeakSet;class T3{constructor(e){let{countRows:t,countColumns:s,rowsLimit:o,columnsLimit:i,countColumnHeaders:r}=e;wb(this,Cb),wb(this,Hu),er(this,bo,{writable:!0,value:void 0}),er(this,xg,{writable:!0,value:void 0}),er(this,da,{writable:!0,value:void 0}),er(this,Op,{writable:!0,value:void 0}),er(this,Ap,{writable:!0,value:void 0}),er(this,fa,{writable:!0,value:void 0}),tr(this,xg,t),tr(this,da,s),tr(this,Op,o),tr(this,Ap,i),tr(this,fa,r)}setSelectedRange(e){tr(this,bo,e)}getCellsRange(){if(wn(this,xg).call(this)===0||wn(this,da).call(this)===0)return null;const{row:e,col:t}=wn(this,bo).getTopStartCorner(),{row:s,col:o}=wn(this,bo).getBottomEndCorner(),i=xu(this,Cb,M3).call(this,e,s),r=xu(this,Hu,Hg).call(this,t,o);return{isRangeTrimmed:s!==i||o!==r,startRow:e,startCol:t,endRow:i,endCol:r}}getMostBottomColumnHeadersRange(){if(wn(this,da).call(this)===0||wn(this,fa).call(this)===0)return null;const{col:e}=wn(this,bo).getTopStartCorner(),{col:t}=wn(this,bo).getBottomEndCorner(),s=xu(this,Hu,Hg).call(this,e,t);return{isRangeTrimmed:t!==s,startRow:-1,startCol:e,endRow:-1,endCol:s}}getAllColumnHeadersRange(){if(wn(this,da).call(this)===0||wn(this,fa).call(this)===0)return null;const{col:e}=wn(this,bo).getTopStartCorner(),{col:t}=wn(this,bo).getBottomEndCorner(),s=xu(this,Hu,Hg).call(this,e,t);return{isRangeTrimmed:t!==s,startRow:-wn(this,fa).call(this),startCol:e,endRow:-1,endCol:s}}}function Hg(n,e){return Math.min(e,Math.max(n+wn(this,Ap).call(this)-1,n))}function M3(n,e){return Math.min(e,Math.max(n+wn(this,Op).call(this)-1,n))}function d_(n){const e=[],t=[];return T(n,s=>{const o=Math.min(s.startRow,s.endRow),i=Math.max(s.startRow,s.endRow);me(o,i,l=>{e.indexOf(l)===-1&&e.push(l)});const r=Math.min(s.startCol,s.endCol),a=Math.max(s.startCol,s.endCol);me(r,a,l=>{t.indexOf(l)===-1&&t.push(l)})}),{rows:e,columns:t}}function Sb(n,e,t){return e=_3(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _3(n){var e=O3(n,"string");return typeof e=="symbol"?e:String(e)}function O3(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const th=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");class df{constructor(){if(Sb(this,"html",void 0),Sb(this,"data",void 0),this.constructor===df)throw new Error("The `ClipboardData` is an abstract class and it can't be instantiated. Please use `CopyClipboardData` or `PasteClipboardData` classes instead.")}getData(){return Qt(this.data)}getMetaInfo(){return hT(this.html)}overwriteInfo(e){this.html=[this.isSerializedHandsontable()?th:"",zc(e)].join(""),this.data=Kw(e)}adjustAfterColumnsRemoval(e,t){const s=e.mergeCells;oe(s)!==!1&&(e.mergeCells=s.reduce((o,i)=>{const{col:r,colspan:a}=i,u=t.filter(c=>c>=r&&c<r+a).length;return u===a?o:(a-u===1?delete i.colspan:u>0&&(i.colspan=a-u),Number.isInteger(i.rowspan)||Number.isInteger(i.colspan)?o.concat(i):o)},[]),e.mergeCells.forEach(o=>{const r=t.filter(a=>a<o.col).length;o.col=o.col-r}),e.mergeCells.length===0&&delete e.mergeCells)}adjustAfterRowRemoval(e,t){const s=e.mergeCells;oe(s)!==!1&&(e.mergeCells=s.reduce((o,i)=>{const{row:r,rowspan:a}=i,u=t.filter(c=>c>=r&&c<r+a).length;return u===a?o:(a-u===1?delete i.rowspan:u>0&&(i.rowspan=a-u),Number.isInteger(i.rowspan)||Number.isInteger(i.colspan)?o.concat(i):o)},[]),e.mergeCells.forEach(o=>{const r=t.filter(a=>a<o.row).length;o.row=o.row-r}),e.mergeCells.length===0&&delete e.mergeCells)}removeRows(e){if(this.isSerializedTable()===!1)return;const t=this.getMetaInfo();this.adjustAfterRowRemoval(t,e);const s={...t,excludedRows:e};this.overwriteInfo(s)}removeColumns(e){if(this.isSerializedTable()===!1)return;const t=this.getMetaInfo(),{nestedHeaders:s,colHeaders:o}=t;if(Array.isArray(s)&&e.length>0){lt("It's not possible to modify copied dataset containing nested headers.");return}Array.isArray(o)&&e.length>0&&(t.colHeaders=o.filter(r=>e.includes(r)===!1)),this.adjustAfterColumnsRemoval(t,e);const i={...t,excludedColumns:e};this.overwriteInfo(i)}getRowInsertionWarn(e,t){const s=this.getMetaInfo(),o=s.data,i=t.length;if(Array.isArray(o)===!1){const{nestedHeaders:l,colHeaders:u}=s;return e>0?Qe`Invalid row insertion done inside some \`CopyPaste\` hook. There is no possibility to\x20
      expand an empty dataset at position higher than zero.`:Array.isArray(l)&&l[0].length!==i||Array.isArray(u)&&u.length!==i?Qe`Invalid row insertion done inside some \`CopyPaste\` hook. Please provide proper number\x20
        of elements (corresponding to size of the dataset in other rows) for inserted rows.`:void 0}const r=o.length,a=o[0].length;if(e>r)return Qe`Invalid row insertion done inside some \`CopyPaste\` hook. Please provide an valid row\x20
      index (not too high) for row data insertion.`;if(a!==i)return Qe`Invalid row insertion done inside some \`CopyPaste\` hook. Please provide proper number of\x20
      elements (corresponding to size of the dataset in other rows) for inserted rows.`}adjustAfterRowInsertion(e,t){const{mergeCells:s,data:o}=e;s==null||s.forEach(i=>{const{row:r,col:a,rowspan:l,colspan:u}=i;if(t>r&&t<r+l){i.rowspan+=1;for(let c=0;c<u;c+=1)o[t][a+c]=""}}),s==null||s.forEach(i=>{t<=i.row&&(i.row+=1)})}insertAtRow(e,t){if(this.isSerializedTable()===!1)return;const s=this.getMetaInfo(),o=s.data||[],i=this.getRowInsertionWarn(e,t);if(oe(i)){lt(i);return}s.data=[...o.slice(0,e),t,...o.slice(e)],this.adjustAfterRowInsertion(s,e),this.overwriteInfo(s)}getColumnInsertionWarn(e,t){const{nestedHeaders:s,data:o,colHeaders:i}=this.getMetaInfo(),r=oe(i)?1:0;if(Array.isArray(s))return Qe`Invalid column insertion done inside some \`CopyPaste\` hook. It's not possible to modify\x20
      copied dataset containing nested headers`;if(Array.isArray(o)===!1)return;const a=o.length+r,l=o[0].length;if(e>l)return Qe`Invalid column insertion done inside some \`CopyPaste\` hook. Please provide an valid\x20
      column index (not too high) for column data insertion.`;if(t.length!==a)return Qe`Invalid column insertion done inside some \`CopyPaste\` hook. Please provide proper number\x20
      of elements (corresponding to size of the dataset in other columns, including headers) for inserted columns.`}adjustAfterColumnInsertion(e,t){const{mergeCells:s,data:o}=e;s==null||s.forEach(i=>{const{row:r,col:a,colspan:l,rowspan:u}=i;if(t>a&&t<a+l){i.colspan+=1;for(let c=0;c<u;c+=1)o[r+c][t]=""}}),s==null||s.forEach(i=>{t<=i.col&&(i.col+=1)})}insertAtColumn(e,t){if(this.isSerializedTable()===!1)return;const s=this.getMetaInfo(),{data:o,colHeaders:i}=s,r=oe(i)?1:0,a=this.getColumnInsertionWarn(e,t);if(oe(a)){lt(a);return}r>0&&i.splice(e,0,t[0]),o==null||o.forEach((l,u)=>{l.splice(e,0,t[u+r])}),this.adjustAfterColumnInsertion(s,e),this.overwriteInfo(s)}setCellAt(e,t,s){if(this.isSerializedTable()===!1)return;const o=this.getMetaInfo(),{data:i,nestedHeaders:r,colHeaders:a}=o;if(e<0)if(Array.isArray(r)){const l=e+r.length;Array.isArray(r[l])&&oe(r[l][t])&&(r[l][t]=s)}else Array.isArray(a)&&oe(a[t])&&(a[t]=s);else e>=0&&Array.isArray(i)&&Array.isArray(i[e])&&oe(i[e][t])&&(i[e][t]=s);this.overwriteInfo(o)}getCellAt(e,t){if(this.isSerializedTable()===!1)return;const s=this.getMetaInfo(),{data:o,nestedHeaders:i,colHeaders:r}=s;if(e<0){if(Array.isArray(i)){const a=e+i.length;if(Array.isArray(i[a])&&oe(i[a][t]))return i[a][t]}else if(Array.isArray(r)&&oe(r[t]))return r[t]}else if(e>=0&&Array.isArray(o)&&Array.isArray(o[e])&&oe(o[e][t]))return o[e][t]}isSerializedTable(){return!0}isSerializedHandsontable(){return!0}getType(){return"handsontable"}}function Pg(n,e,t){return e=A3(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A3(n){var e=I3(n,"string");return typeof e=="symbol"?e:String(e)}function I3(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class vb extends df{constructor(e,t){super(),Pg(this,"html",void 0),Pg(this,"data",void 0),Pg(this,"copyableRanges",void 0);const{rows:s,columns:o}=d_(t);this.html=[th,Gw(e,{rows:s,columns:o})].join(""),this.data=jw(e,{rows:s,columns:o}),this.copyableRanges=t}getRanges(){return this.copyableRanges}}function yb(n,e,t){return e=x3(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function x3(n){var e=H3(n,"string");return typeof e=="symbol"?e:String(e)}function H3(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class P3 extends df{constructor(e,t){super(),yb(this,"html",void 0),yb(this,"data",void 0),this.html=t,this.isSerializedTable()?this.data=Kw(this.getMetaInfo()):this.data=dU(e)}isSerializedTable(){return oe(this.html)&&/(<table)|(<TABLE)/g.test(this.html)}isSerializedHandsontable(){return this.isSerializedTable()&&/<meta (.*?)content="Handsontable"/.test(this.html)}getType(){return this.isSerializedHandsontable()?"handsontable":this.isSerializedTable()?"table":"unrecognizable"}}function Dg(n,e){f_(n,e),e.add(n)}function gi(n,e,t){f_(n,e),e.set(n,t)}function f_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ga(n,e,t){return e=D3(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function D3(n){var e=N3(n,"string");return typeof e=="symbol"?e:String(e)}function N3(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function xn(n,e){var t=g_(n,e,"get");return L3(n,t)}function L3(n,e){return e.get?e.get.call(n):e.value}function ma(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Gs(n,e,t){var s=g_(n,e,"set");return k3(n,s,t),t}function g_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function k3(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}de.getSingleton().register("afterCopyLimit");de.getSingleton().register("modifyCopyableRange");de.getSingleton().register("beforeCut");de.getSingleton().register("afterCut");de.getSingleton().register("beforePaste");de.getSingleton().register("afterPaste");de.getSingleton().register("beforeCopy");de.getSingleton().register("afterCopy");const Pu="copyPaste",F3=80,$3=["fragmentSelection"];var Ng=new WeakMap,Lg=new WeakMap,kg=new WeakMap,nr=new WeakMap,Du=new WeakMap,Nu=new WeakMap,sr=new WeakMap,Fg=new WeakSet,bb=new WeakSet,$g=new WeakSet;class m_ extends tt{constructor(){super(...arguments),Dg(this,$g),Dg(this,bb),Dg(this,Fg),ga(this,"columnsLimit",1/0),ga(this,"rowsLimit",1/0),ga(this,"pasteMode","overwrite"),ga(this,"uiContainer",this.hot.rootDocument.body),gi(this,Ng,{writable:!0,value:!1}),gi(this,Lg,{writable:!0,value:!1}),gi(this,kg,{writable:!0,value:!1}),gi(this,nr,{writable:!0,value:"cells-only"}),gi(this,Du,{writable:!0,value:!1}),gi(this,Nu,{writable:!0,value:!1}),gi(this,sr,{writable:!0,value:new T3({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),ga(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Pu}static get SETTING_KEYS(){return[Pu,...$3]}static get PLUGIN_PRIORITY(){return F3}isEnabled(){return!!this.hot.getSettings()[Pu]}enablePlugin(){var e=this;if(this.enabled)return;const{[Pu]:t}=this.hot.getSettings();if(typeof t=="object"){var s,o;this.pasteMode=(s=t.pasteMode)!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,Gs(this,Ng,!!t.copyColumnHeaders),Gs(this,Lg,!!t.copyColumnGroupHeaders),Gs(this,kg,!!t.copyColumnHeadersOnly),this.uiContainer=(o=t.uiContainer)!==null&&o!==void 0?o:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",i=>this.onAfterContextMenuDefaultOptions(i)),this.addHook("afterSelectionEnd",()=>this.onAfterSelectionEnd()),this.eventManager=new It(this),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),Fw()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){return e.onSafariMouseEnter(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){return e.onSafariMouseLeave(...arguments)}),this.addHook("afterSelection",()=>this.onSafariAfterSelection())),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Gs(this,nr,e),Gs(this,Du,!0),ma(this,Fg,Rb).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Gs(this,Nu,!0),ma(this,Fg,Rb).call(this,"cut")}getRangedCopyableData(e){return za(this.getRangedData(e))}getRangedData(e){const{rows:t,columns:s}=d_(e);return jw(this.hot,{rows:t,columns:s})}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!t)return;const s={clipboardData:{data:{},setData(o,i){this.data[o]=i},getData(o){return this.data[o]}}};e&&s.clipboardData.setData("text/plain",e),t&&s.clipboardData.setData("text/html",t),this.onPaste(s)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}xn(this,sr).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);xn(this,nr)==="column-headers-only"?t.set("headers",xn(this,sr).getMostBottomColumnHeadersRange()):(xn(this,nr)==="with-column-headers"?t.set("headers",xn(this,sr).getMostBottomColumnHeadersRange()):xn(this,nr)==="with-column-group-headers"&&t.set("headers",xn(this,sr).getAllColumnHeadersRange()),t.set("cells",xn(this,sr).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(o=>o!==null).map(o=>{let{startRow:i,startCol:r,endRow:a,endCol:l}=o;return{startRow:i,startCol:r,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const s=t.get("cells");if(s!==null&&s.isRangeTrimmed){const{startRow:o,startCol:i,endRow:r,endCol:a}=s;this.hot.runHooks("afterCopyLimit",r-o+1,a-i+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const s=e.length,o=e[0].length,i=[],{row:r,col:a}=t.getTopStartCorner(),{row:l,col:u}=t.getBottomEndCorner();let c=r,d=a,f=r,m=a;for(;i.length<s||c<=l;){const{skipRowOnPaste:w,visualRow:C}=this.hot.getCellMeta(c,a);if(c=C+1,w===!0)continue;f=C,d=a;const b=[],y=i.length%s;for(;b.length<o||d<=u;){const{skipColumnOnPaste:M,visualCol:A}=this.hot.getCellMeta(r,d);if(d=A+1,M===!0)continue;m=A;const $=b.length%o;b.push(e[y][$])}i.push(b)}return this.hot.populateFromArray(r,a,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[r,a,f,m]}onCopy(e){if(!this.hot.isListening()&&!xn(this,Du)||this.isEditorOpened())return;this.setCopyableText(),Gs(this,Du,!1);const t=new vb(this.hot,this.copyableRanges);!!this.hot.runHooks("beforeCopy",t)&&(e.clipboardData.setData("text/plain",za(t.getData())),e.clipboardData.setData("text/html",[t.getType()==="handsontable"?th:"",zc(t.getMetaInfo())].join("")),this.hot.runHooks("afterCopy",t)),Gs(this,nr,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!xn(this,Nu)||this.isEditorOpened())return;this.setCopyableText(),Gs(this,Nu,!1);const t=new vb(this.hot,this.copyableRanges);!!this.hot.runHooks("beforeCut",t)&&(e.clipboardData.setData("text/plain",za(t.getData())),e.clipboardData.setData("text/html",[t.getType()==="handsontable"?th:"",zc(t.getMetaInfo())].join("")),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t)),e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();const t=Th(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0}),s=new P3(e.clipboardData.getData("text/plain"),t);if(this.hot.runHooks("beforePaste",s)===!1)return;const o=s.getData();if(o.length===0)return;const[i,r,a,l]=this.populateValues(o);this.hot.selectCell(i,r,Math.min(this.hot.countRows()-1,a),Math.min(this.hot.countCols()-1,l)),this.hot.runHooks("afterPaste",s)}onAfterContextMenuDefaultOptions(e){e.items.push({name:"---------"},C3(this)),xn(this,Ng)&&e.items.push(y3(this)),xn(this,Lg)&&e.items.push(v3(this)),xn(this,kg)&&e.items.push(S3(this)),e.items.push(b3(this))}onAfterSelectionEnd(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}onSafariMouseEnter(){ma(this,$g,Eb).call(this)}onSafariMouseLeave(){ma(this,bb,V3).call(this)}onSafariAfterSelection(){ma(this,$g,Eb).call(this)}destroy(){super.destroy()}}function Rb(n){if(Fw()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:s}=e.highlight,o=this.hot.getCell(t,s,!0);o&&LE(o,()=>{this.hot.rootDocument.execCommand(n)})}}else this.hot.rootDocument.execCommand(n)}function V3(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,s=this.hot.getCell(e,t,!0);s&&Pw(s)}}}function Eb(){if(this.hot.isListening()){const n=this.hot.getSelectedRangeLast();if(n){const{row:e,col:t}=n.highlight,s=this.hot.getCell(e,t,!0);s!=null&&s.hasAttribute("contenteditable")&&Dw(s)}}}function p_(n,e){return`border_row${n}col${e}`}function La(){return{width:1,color:"#000"}}function ro(){return{hide:!0}}function W3(){return{width:1,color:"#000",cornerVisible:!1}}function Vg(n){if(oe(n.start)||oe(n.left)){var e;n.start=(e=n.start)!==null&&e!==void 0?e:n.left}if(oe(n.end)||oe(n.right)){var t;n.end=(t=n.end)!==null&&t!==void 0?t:n.right}return delete n.left,delete n.right,n}function pa(n){return oe(n.start)&&(n.left=n.start),oe(n.end)&&(n.right=n.end),n}function Wg(n,e){return{id:p_(n,e),border:W3(),row:n,col:e,top:ro(),bottom:ro(),start:ro(),end:ro()}}function B3(n,e){return Rt(e,"border")&&e.border&&(n.border=e.border),Rt(e,"top")&&oe(e.top)&&(e.top?(De(e.top)||(e.top=La()),n.top=e.top):(e.top=ro(),n.top=e.top)),Rt(e,"bottom")&&oe(e.bottom)&&(e.bottom?(De(e.bottom)||(e.bottom=La()),n.bottom=e.bottom):(e.bottom=ro(),n.bottom=e.bottom)),Rt(e,"start")&&oe(e.start)&&(e.start?(De(e.start)||(e.start=La()),n.start=e.start):(e.start=ro(),n.start=e.start)),Rt(e,"end")&&oe(e.end)&&(e.end?(De(e.end)||(e.end=La()),n.end=e.end):(e.end=ro(),n.end=e.end)),n}function co(n,e){let t=!1;return T(n.getSelectedRange(),s=>{s.forAll((o,i)=>{if(o<0||i<0)return;const r=n.getCellMeta(o,i).borders;if(r)if(e){if(!Rt(r[e],"hide")||r[e].hide===!1)return t=!0,!1}else return t=!0,!1})}),t}function ff(n){return`<span class="selected">${String.fromCharCode(10003)}</span>${n}`}function U3(n){return n.some(e=>oe(e.left)||oe(e.right))}function Y3(n){return n.some(e=>oe(e.start)||oe(e.end))}const z3=new Map([["left","start"],["right","end"]]);function G3(n){var e;return(e=z3.get(n))!==null&&e!==void 0?e:n}function j3(n){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(pd);return co(this,"bottom")&&(e=ff(e)),e},callback(e,t){const s=co(this,"bottom");n.prepareBorder(t,"bottom",s)}}}function K3(n){const e=n.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(wd);return co(this,e)&&(t=ff(t)),t},callback(t,s){const o=co(this,e);n.prepareBorder(s,e,o)}}}function X3(n){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Cd)},callback(e,t){n.prepareBorder(t,"noBorders")},disabled(){return!co(this)}}}function q3(n){const e=n.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(md);return co(this,e)&&(t=ff(t)),t},callback(t,s){const o=co(this,e);n.prepareBorder(s,e,o)}}}function Z3(n){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(gd);return co(this,"top")&&(e=ff(e)),e},callback(e,t){const s=co(this,"top");n.prepareBorder(t,"top",s)}}}function Q3(n,e,t){return e=J3(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function J3(n){var e=eK(n,"string");return typeof e=="symbol"?e:String(e)}function eK(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const Lu="customBorders",tK=90;class nK extends tt{constructor(){super(...arguments),Q3(this,"savedBorders",[])}static get PLUGIN_KEY(){return Lu}static get PLUGIN_PRIORITY(){return tK}isEnabled(){return!!this.hot.getSettings()[Lu]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.onAfterContextMenuDefaultOptions(e)),this.addHook("init",()=>this.onAfterInit()),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let s=["top","bottom","start","end"],o=null;t&&(this.checkSettingsCohesion([t]),s=Object.keys(t),o=Vg(t));const i=Pr(e),r=ul(i);T(e,a=>{r(a).forAll((l,u)=>{T(s,c=>{this.prepareBorderFromCustomAdded(l,u,o,G3(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=Pr(e),s=ul(t),o=[];return T(e,i=>{s(i).forAll((r,a)=>{T(this.savedBorders,l=>{l.row===r&&l.col===a&&o.push(pa(l))})})}),o}clearBorders(e){e?this.setBorders(e):(T(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const o=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,o,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:o})}prepareBorderFromCustomAdded(e,t,s,o){const i=this.hot.countRows(),r=this.hot.countCols();if(e>=i||t>=r)return;let a=Wg(e,t);s&&(a=B3(a,s),T(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,s),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,t,"borders",pa(a)),this.insertBorderIntoSettings(a,o)}prepareBorderFromCustomAddedRange(e,t){const s=Math.min(e.to.row,this.hot.countRows()-1),o=Math.min(e.to.col,this.hot.countCols()-1);me(e.from.row,s,i=>{me(e.from.col,o,r=>{const a=Wg(i,r);let l=0;i===e.from.row&&Rt(t,"top")&&(l+=1,a.top=t.top),i===e.to.row&&Rt(t,"bottom")&&(l+=1,a.bottom=t.bottom),r===e.from.col&&Rt(t,"start")&&(l+=1,a.start=t.start),r===e.to.col&&Rt(t,"end")&&(l+=1,a.end=t.end),l>0&&(this.hot.setCellMeta(i,r,"borders",pa(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,t){const s=p_(e,t);this.spliceBorder(s),this.clearBordersFromSelectionSettings(s),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,s,o){let i=this.hot.getCellMeta(e,t).borders;!i||i.border===void 0?i=Wg(e,t):i=Vg(i),o?(i[s]=ro(),this.countHide(i)===4?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(i,s,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",pa(i)))):(i[s]=La(),this.checkCustomSelectionsFromContextMenu(i,s,o)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",pa(i)))}prepareBorder(e,t,s){T(e,o=>{let{start:i,end:r}=o;if(i.row===r.row&&i.col===r.col)t==="noBorders"?this.removeAllBorders(i.row,i.col):this.setBorder(i.row,i.col,t,s);else switch(t){case"noBorders":me(i.col,r.col,a=>{me(i.row,r.row,l=>{this.removeAllBorders(l,a)})});break;case"top":me(i.col,r.col,a=>{this.setBorder(i.row,a,t,s)});break;case"bottom":me(i.col,r.col,a=>{this.setBorder(r.row,a,t,s)});break;case"start":me(i.row,r.row,a=>{this.setBorder(a,i.col,t,s)});break;case"end":me(i.row,r.row,a=>{this.setBorder(a,r.col,t,s)});break}})}createCustomBorders(e){T(e,t=>{const s=Vg(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,s):this.prepareBorderFromCustomAdded(t.row,t.col,s)})}countHide(e){const{top:t,bottom:s,start:o,end:i}=e;return Pt([t,s,o,i],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const t=Ve(this.hot.selection.highlight.customSelections,s=>s.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){T(this.hot.selection.highlight.customSelections,(e,t)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){T(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const t=Ve(this.savedBorders,s=>s.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),t=!0):T(this.savedBorders,(o,i)=>{if(e.id===o.id)return this.savedBorders[i]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,s){let o=!1;return T(this.hot.selection.highlight.customSelections,i=>{if(e.id===i.settings.id){const r=this.hot.view._wt.selectionManager.getBorderInstances(i);return T(r,a=>{a.toggleHiddenClass(t,s)}),o=!0,!1}}),o}checkCustomSelections(e,t,s){const o=this.countHide(e);let i=!1;return o===4?(this.removeAllBorders(e.row,e.col),i=!0):T(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id){if(r.visualCellRange=t,r.commit(),s){const a=this.hot.view._wt.selectionManager.getBorderInstances(r);T(a,l=>{l.changeBorderStyle(s,e)})}return i=!0,!1}}),i}changeBorderSettings(){const e=this.hot.getSettings()[Lu];if(Array.isArray(e)){const t=Qt(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=U3(e),s=Y3(e);if(t&&s)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}onAfterContextMenuDefaultOptions(e){this.hot.getSettings()[Lu]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(fd)},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[Z3(this),q3(this),j3(this),K3(this),X3(this)]}})}onAfterInit(){this.changeBorderSettings()}destroy(){super.destroy()}}const Tb="dragToScroll",sK=100;class oK extends tt{static get PLUGIN_KEY(){return Tb}static get PLUGIN_PRIORITY(){return sK}constructor(e){super(e),this.eventManager=new It(this),this.boundaries=null,this.callback=null,this.listening=!1}isEnabled(){return!!this.hot.getSettings()[Tb]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>this.setupListening(e)),this.addHook("afterOnCellCornerMouseDown",e=>this.setupListening(e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let s=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?s=e-this.boundaries.left:e>this.boundaries.right&&(s=e-this.boundaries.right),this.callback(s,o)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",s=>this.onMouseMove(s)),t=sl(t)}unregisterEvents(){this.eventManager.clear()}setupListening(e){if(Ko(e))return;const t=this.hot.view._wt.wtTable.holder;t!==this.hot.rootWindow&&(this.setBoundaries(t.getBoundingClientRect()),this.setCallback((s,o)=>{s<0?t.scrollLeft-=50:s>0&&(t.scrollLeft+=50),o<0?t.scrollTop-=20:o>0&&(t.scrollTop+=20)}),this.listen())}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function iK(n,e){rK(n,e),e.add(n)}function rK(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mb(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}de.getSingleton().register("afterDropdownMenuDefaultOptions");de.getSingleton().register("beforeDropdownMenuShow");de.getSingleton().register("afterDropdownMenuShow");de.getSingleton().register("afterDropdownMenuHide");de.getSingleton().register("afterDropdownMenuExecute");const bc="dropdownMenu",aK=230,Bg="changeType",Ug=bc;var Yg=new WeakSet;class Bl extends tt{static get PLUGIN_KEY(){return bc}static get PLUGIN_PRIORITY(){return aK}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[kl,Fl,Ue,Vl,Ue,rf,Ue,$l,Ue,Un]}constructor(e){super(e),iK(this,Yg),this.eventManager=new It(this),this.commandExecutor=new s_(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",(t,s)=>this.onAfterGetColHeader(t,s))}isEnabled(){return this.hot.getSettings()[bc]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new o_(this.hot,Bl.DEFAULT_ITEMS);const t=this.hot.getSettings()[bc],s={items:this.itemsFactory.getItems(t)};this.registerEvents(),typeof t.callback=="function"&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",s),this.itemsFactory.setPredefinedItems(s.items);const o=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new Kr(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",o),this.menu.setMenuItems(o),this.menu.addLocalHook("beforeOpen",()=>this.onMenuBeforeOpen()),this.menu.addLocalHook("afterOpen",()=>this.onMenuAfterOpen()),this.menu.addLocalHook("afterSubmenuOpen",i=>this.onSubMenuAfterOpen(i)),this.menu.addLocalHook("afterClose",()=>this.onMenuAfterClose()),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return e.executeCommand.call(e,...r)}),T(o,i=>this.commandExecutor.registerCommand(i.key,i))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),t=()=>{const{highlight:s}=this.hot.getSelectedRangeLast();if((s.isHeader()&&s.row===-1||s.isCell())&&s.col>=0){this.hot.selectColumns(s.col,s.col,-1);const{from:o}=this.hot.getSelectedRangeLast(),i=eh(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,o.col,!0),a=r.getBoundingClientRect();this.open({left:a.left+i.left,top:a.top+r.offsetHeight+i.top},{left:a.width})}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var s;return((s=this.hot.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isHeader())&&!this.menu.isOpened()},captureCtrl:!0,group:Ug},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var s;return((s=this.hot.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isCell())&&!this.menu.isOpened()},group:Ug}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Ug)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>this.onTableClick(e))}open(e){var t;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(t=this.menu)!==null&&t!==void 0&&t.isOpened()||(this.menu.open(),We(s,(o,i)=>{this.menu.setOffset(i,o)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];this.commandExecutor.execute(e,...s)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}onTableClick(e){if(e.stopPropagation(),Ae(e.target,Bg)){const t=eh(this.menu.container,this.hot.rootDocument),s=e.target.getBoundingClientRect();this.open({left:s.left+t.left,top:s.top+e.target.offsetHeight+3+t.top},{left:s.width})}}onAfterGetColHeader(e,t){const s=t.parentNode;if(!s)return;const o=s.parentNode.childNodes,i=Array.prototype.indexOf.call(o,s);if(e<0||i!==o.length-1)return;const r=t.querySelector(`.${Bg}`);if(this.enabled&&r)return;if(!this.enabled){r&&r.parentNode.removeChild(r);return}const a=this.hot.rootDocument.createElement("button");a.className=Bg,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(Se(a,[zo(this.hot.getTranslatedPhrase(LC))]),Se(t,[Br("menu")])),a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),Mb(this,Yg,_b).call(this,this.menu)}onSubMenuAfterOpen(e){Mb(this,Yg,_b).call(this,e)}onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _b(n){n.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}Bl.SEPARATOR={name:Ue};class lK{constructor(e){this.hot=e,this.options={}}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:s,endCol:o}=this._getDataRange(),i=this.options,r=[];return me(e,s,a=>{const l=[];!i.exportHiddenRows&&this._isHiddenRow(a)||(me(t,o,u=>{!i.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),r.push(l))}),r}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:s}=this._getDataRange(),o=this.hot.getRowHeader();me(t,s,i=>{!this.options.exportHiddenRows&&this._isHiddenRow(i)||e.push(o[i])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:s}=this._getDataRange(),o=this.hot.getColHeader();me(t,s,i=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(i)||e.push(o[i])})}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[s=0,o=0,i=t,r=e]=this.options.range;return s=Math.max(s,0),o=Math.max(o,0),i=Math.min(i,t),r=Math.min(r,e),{startRow:s,startCol:o,endRow:i,endCol:r}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const uK=lK;class lS{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=Sn(this.constructor.DEFAULT_OPTIONS);const s=new Date;return t=kt(Sn(lS.DEFAULT_OPTIONS),t),t=kt(t,e),t.filename=_w(t.filename,{YYYY:s.getFullYear(),MM:`${s.getMonth()+1}`.padStart(2,"0"),DD:`${s.getDate()}`.padStart(2,"0")}),t}}const cK=lS,hK=String.fromCharCode(13),dK=String.fromCharCode(34),fK=String.fromCharCode(10);class gK extends cK{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,t=this.dataProvider.getData();let s=this.dataProvider.getColumnHeaders();const o=s.length>0,i=this.dataProvider.getRowHeaders(),r=i.length>0;let a=e.bom?String.fromCharCode(65279):"";return o&&(s=Ve(s,l=>this._escapeCell(l,!0)),r&&(a+=e.columnDelimiter),a+=s.join(e.columnDelimiter),a+=e.rowDelimiter),T(t,(l,u)=>{u>0&&(a+=e.rowDelimiter),r&&(a+=this._escapeCell(i[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=At(e);return s!==""&&(t||s.indexOf(hK)>=0||s.indexOf(dK)>=0||s.indexOf(fK)>=0||s.indexOf(this.options.columnDelimiter)>=0)&&(s=s.replace(new RegExp('"',"g"),'""'),s=`"${s}"`),s}}const mK=gK,pK="csv",Ip={[pK]:mK};function wK(n,e,t){return typeof Ip[n]=="function"?new Ip[n](e,t):null}const CK="exportFile",SK=240;class vK extends tt{static get PLUGIN_KEY(){return CK}static get PLUGIN_PRIORITY(){return SK}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:s,rootWindow:o}=this.hot,i=this._createTypeFormatter(e,t),r=this._createBlob(i),a=o.URL||o.webkitURL,l=s.createElement("a"),u=`${i.options.filename}.${i.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(r);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),s.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),s.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,u)}_createTypeFormatter(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Ip[e])throw new Error(`Export format type "${e}" is not supported.`);return wK(e,new uK(this.hot),t)}_createBlob(e){let t=null;return typeof Blob<"u"&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function or(n,e,t){return e=yK(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function yK(n){var e=bK(n,"string");return typeof e=="symbol"?e:String(e)}function bK(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class Ul{constructor(e,t){let{id:s,stateless:o=!0}=t;or(this,"hot",void 0),or(this,"id",void 0),or(this,"elements",[]),or(this,"hidden",!1),or(this,"stateId",""),or(this,"state",void 0),this.hot=e,this.id=s,this.stateId=`Filters.component.${this.id}`,this.state=o?null:this.hot.columnIndexMapper.registerMap(this.stateId,new kh)}getElements(){return this.elements}reset(){T(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}ht(Ul,In);const hl={};function qo(n,e){if(!hl[n])throw Error(`Filter condition "${n}" does not exist.`);const{condition:t,descriptor:s}=hl[n];let o=e;return s.inputValuesDecorator&&(o=s.inputValuesDecorator(o)),function(i){return t.apply(i.meta.instance,[].concat([i],[o]))}}function Ti(n){if(!hl[n])throw Error(`Filter condition "${n}" does not exist.`);return hl[n].descriptor}function Ft(n,e,t){t.key=n,hl[n]={condition:e,descriptor:t}}const Gt="none";function RK(){return!0}Ft(Gt,RK,{name:Pl,inputsCount:0,showOperators:!1});const Xa="empty";function EK(n){return Vt(n.value)}Ft(Xa,EK,{name:Td,inputsCount:0,showOperators:!0});const Rc="not_empty";function TK(n,e){return!qo(Xa,e)(n)}Ft(Rc,TK,{name:Md,inputsCount:0,showOperators:!0});const qa="eq";function MK(n,e){let[t]=e;return At(n.value).toLocaleLowerCase(n.meta.locale)===At(t)}Ft(qa,MK,{name:_d,inputsCount:1,showOperators:!0});const Ec="neq";function _K(n,e){return!qo(qa,e)(n)}Ft(Ec,_K,{name:Od,inputsCount:1,showOperators:!0});const w_="gt";function OK(n,e){let[t]=e,s=t;return n.meta.type==="numeric"&&(s=parseFloat(s,10)),n.value>s}Ft(w_,OK,{name:Pd,inputsCount:1,showOperators:!0});const C_="gte";function AK(n,e){let[t]=e,s=t;return n.meta.type==="numeric"&&(s=parseFloat(s,10)),n.value>=s}Ft(C_,AK,{name:Dd,inputsCount:1,showOperators:!0});const S_="lt";function IK(n,e){let[t]=e,s=t;return n.meta.type==="numeric"&&(s=parseFloat(s,10)),n.value<s}Ft(S_,IK,{name:Nd,inputsCount:1,showOperators:!0});const v_="lte";function xK(n,e){let[t]=e,s=t;return n.meta.type==="numeric"&&(s=parseFloat(s,10)),n.value<=s}Ft(v_,xK,{name:Ld,inputsCount:1,showOperators:!0});const uS="date_after";function HK(n,e){let[t]=e;const s=Q(n.value,n.meta.dateFormat),o=Q(t,n.meta.dateFormat);return!s.isValid()||!o.isValid()?!1:s.diff(o)>=0}Ft(uS,HK,{name:$d,inputsCount:1,showOperators:!0});const cS="date_before";function PK(n,e){let[t]=e;const s=Q(n.value,n.meta.dateFormat),o=Q(t,n.meta.dateFormat);return!s.isValid()||!o.isValid()?!1:s.diff(o)<=0}Ft(cS,PK,{name:Vd,inputsCount:1,showOperators:!0});const nh="between";function DK(n,e){let[t,s]=e,o=t,i=s;if(n.meta.type==="numeric"){const r=parseFloat(o,10),a=parseFloat(i,10);o=Math.min(r,a),i=Math.max(r,a)}else if(n.meta.type==="date"){const r=qo(cS,[i]),a=qo(uS,[o]);return r(n)&&a(n)}return n.value>=o&&n.value<=i}Ft(nh,DK,{name:kd,inputsCount:2,showOperators:!0});const y_="not_between";function NK(n,e){return!qo(nh,e)(n)}Ft(y_,NK,{name:Fd,inputsCount:2,showOperators:!0});const b_="begins_with";function LK(n,e){let[t]=e;return At(n.value).toLocaleLowerCase(n.meta.locale).startsWith(At(t))}Ft(b_,LK,{name:Ad,inputsCount:1,showOperators:!0});const R_="ends_with";function kK(n,e){let[t]=e;return At(n.value).toLocaleLowerCase(n.meta.locale).endsWith(At(t))}Ft(R_,kK,{name:Id,inputsCount:1,showOperators:!0});const hS="contains";function FK(n,e){let[t]=e;return At(n.value).toLocaleLowerCase(n.meta.locale).indexOf(At(t))>=0}Ft(hS,FK,{name:xd,inputsCount:1,showOperators:!0});const E_="not_contains";function $K(n,e){return!qo(hS,e)(n)}Ft(E_,$K,{name:Hd,inputsCount:1,showOperators:!0});const T_="date_tomorrow";function VK(n){const e=Q(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(-1,"days").startOf("day"),"d"):!1}Ft(T_,VK,{name:Bd,inputsCount:0});const M_="date_today";function WK(n){const e=Q(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Q().startOf("day"),"d"):!1}Ft(M_,WK,{name:Wd,inputsCount:0});const __="date_yesterday";function BK(n){const e=Q(n.value,n.meta.dateFormat);return e.isValid()?e.isSame(Q().subtract(1,"days").startOf("day"),"d"):!1}Ft(__,BK,{name:Ud,inputsCount:0});RT();function UK(n,e){let t=n;return t===""&&(t=`(${e})`),t}const xp=new Set([1]).has(1),YK=xp&&typeof Array.from=="function";function Yl(n){let e=n;return xp&&(e=new Set(e)),function(t){let s;return xp?s=e.has(t):s=!!~e.indexOf(t),s}}function O_(n){return n??""}function Hp(n){let e=n;return YK?e=Array.from(new Set(e)):e=Ew(e),e=e.sort((t,s)=>typeof t=="number"&&typeof s=="number"?t-s:t===s?0:t>s?1:-1),e}function Ob(n,e,t,s){const o=[],i=n===e;let r;return i||(r=Yl(e)),T(n,a=>{let l=!1;(i||r(a))&&(l=!0);const u={checked:l,value:a,visualValue:UK(a,t)};s&&s(u),o.push(u)}),o}const Mi="by_value";function zK(n,e){let[t]=e;return t(n.value)}Ft(Mi,zK,{name:"By value",inputsCount:0,inputValuesDecorator(n){let[e]=n;return[Yl(e)]},showOperators:!1});const dl={};function GK(n){if(!dl[n])throw Error(`Operation with id "${n}" does not exist.`);const e=dl[n].func;return function(t,s){return e(t,s)}}function jK(n){return dl[n].name}function dS(n,e,t){dl[n]={name:e,func:t}}const Uo="conjunction",KK=Gd;function XK(n,e){return n.every(t=>t.func(e))}dS(Uo,KK,XK);const sh="disjunction",qK=Dl;function ZK(n,e){return n.some(t=>t.func(e))}dS(sh,qK,ZK);const fS="disjunctionWithExtraCondition",QK=Dl;function JK(n,e){if(n.length<3)throw Error("Operation doesn't work on less then three conditions.");return n.slice(0,n.length-1).some(t=>t.func(e))&&n[n.length-1].func(e)}dS(fS,QK,JK);const e4="numeric",A_="text",t4="date",Ab={[e4]:[Gt,Ue,Xa,Rc,Ue,qa,Ec,Ue,w_,C_,S_,v_,nh,y_],[A_]:[Gt,Ue,Xa,Rc,Ue,qa,Ec,Ue,b_,R_,Ue,hS,E_],[t4]:[Gt,Ue,Xa,Rc,Ue,qa,Ec,Ue,cS,uS,nh,Ue,T_,M_,__]};function n4(n){const e=[];let t=n;return Ab[t]||(t=A_),T(Ab[t],s=>{let o;s===Ue?o={name:Ue}:o=Sn(Ti(s)),e.push(o)}),e}function wa(n,e,t){return e=s4(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s4(n){var e=o4(n,"string");return typeof e=="symbol"?e:String(e)}function o4(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const zg="built",Gg="building",Ib=["click","input","keydown","keypress","keyup","focus","blur","change"];let as=class I_{static get DEFAULTS(){return Sn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){wa(this,"hot",void 0),wa(this,"eventManager",new It(this)),wa(this,"options",void 0),wa(this,"_element",void 0),wa(this,"buildState",void 0),this.hot=e,this.options=kt(I_.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Gg?this._element:this.buildState===zg?(this.update(),this._element):(this.buildState=Gg,this.build(),this.buildState=zg,this._element)}isBuilt(){return this.buildState===zg}translateIfPossible(e){return typeof e=="string"&&e.startsWith(yn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(t,s)=>{this.eventManager.addEventListener(t,s,o=>this.runLocalHooks(s,o,this))};if(this.buildState||(this.buildState=Gg),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&J(this._element,this.options.className),this.options.children.length)T(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),We(this.options,(s,o)=>{t[o]!==void 0&&o!=="className"&&o!=="tagName"&&o!=="children"&&(t[o]=this.translateIfPossible(s))}),this._element.appendChild(t),T(Ib,s=>e(t,s))}else T(Ib,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};ht(as,In);function i4(n,e){x_(n,e),e.add(n)}function r4(n,e,t){x_(n,e),e.set(n,t)}function x_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ku(n,e){var t=H_(n,e,"get");return a4(n,t)}function a4(n,e){return e.get?e.get.call(n):e.value}function l4(n,e,t){var s=H_(n,e,"set");return u4(n,s,t),t}function H_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function u4(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function c4(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var ir=new WeakMap,xb=new WeakSet;class Yo extends as{static get DEFAULTS(){return Sn({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,kt(Yo.DEFAULTS,t)),i4(this,xb),r4(this,ir,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>c4(this,xb,h4).call(this,e))}build(){super.build(),l4(this,ir,this._element.firstChild),J(this._element,"htUIInput"),this.update()}update(){this.isBuilt()&&(ku(this,ir).type=this.options.type,ku(this,ir).placeholder=this.translateIfPossible(this.options.placeholder),ku(this,ir).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&ku(this,ir).focus()}}function h4(n){this.options.value=n.target.value}function jg(n,e){P_(n,e),e.add(n)}function Ca(n,e,t){P_(n,e),e.set(n,t)}function P_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(n,e,t){var s=D_(n,e,"set");return d4(n,s,t),t}function d4(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Kg(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Tt(n,e){var t=D_(n,e,"get");return f4(n,t)}function D_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function f4(n,e){return e.get?e.get.call(n):e.value}var Bt=new WeakMap,Fu=new WeakMap,$u=new WeakMap,Xg=new WeakMap,Vu=new WeakMap,Hb=new WeakSet,Pb=new WeakSet,Db=new WeakSet;class fl extends as{static get DEFAULTS(){return Sn({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,kt(fl.DEFAULTS,t)),jg(this,Db),jg(this,Pb),jg(this,Hb),Ca(this,Bt,{writable:!0,value:null}),Ca(this,Fu,{writable:!0,value:[]}),Ca(this,$u,{writable:!0,value:void 0}),Ca(this,Xg,{writable:!0,value:void 0}),Ca(this,Vu,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Tt(this,Bt)}registerHooks(){this.addLocalHook("click",()=>Kg(this,Db,p4).call(this))}setItems(e){rr(this,Fu,this.translateNames(e)),Tt(this,Bt)&&Tt(this,Bt).setMenuItems(Tt(this,Fu))}translateNames(e){return T(e,t=>{t.name=this.translateIfPossible(t.name)}),e}build(){super.build(),rr(this,Bt,new Kr(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Tt(this,Bt).setMenuItems(Tt(this,Fu));const e=new as(this.hot,{className:"htUISelectCaption"}),t=new as(this.hot,{className:"htUISelectDropdown"});rr(this,$u,e),rr(this,Xg,e.element),rr(this,Vu,t),this.hot.getSettings().ariaTags&&(Se(t.element,[go()]),Se(this._element,[yE()])),T([e,t],s=>this._element.appendChild(s.element)),Tt(this,Bt).addLocalHook("select",s=>Kg(this,Hb,g4).call(this,s)),Tt(this,Bt).addLocalHook("afterClose",()=>Kg(this,Pb,m4).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Tt(this,Bt).hot.getTranslatedPhrase(Pl),Tt(this,Xg).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Tt(this,Bt)&&(Tt(this,Bt).open(),Tt(this,Bt).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Tt(this,Bt).getNavigator().toFirstItem(),Tt(this,Bt).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Tt(this,Bt)&&Tt(this,Bt).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Tt(this,Bt)&&(Tt(this,Bt).destroy(),rr(this,Bt,null)),Tt(this,$u)&&Tt(this,$u).destroy(),Tt(this,Vu)&&Tt(this,Vu).destroy(),super.destroy()}}function g4(n){n.name!==Ue&&(this.options.value=n,this.update(),this.runLocalHooks("select",this.options.value))}function m4(){this.runLocalHooks("afterClose")}function p4(){this.openOptions()}function Nb(n,e){w4(n,e),e.add(n)}function w4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lb(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var kb=new WeakSet,Fb=new WeakSet;class qg extends Ul{constructor(e,t){super(e,{id:t.id,stateless:!1}),Nb(this,Fb),Nb(this,kb),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new fl(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new Yo(this.hot,{placeholder:Qd})),this.elements.push(new Yo(this.hot,{placeholder:Jd})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>Lb(this,kb,C4).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),T(this.getInputElements(),e=>{e.addLocalHook("keydown",t=>Lb(this,Fb,S4).call(this,t))})}setState(e){if(this.reset(),!e)return;const t=Sn(e.command);t.name.startsWith(xt)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),T(e.args,(s,o)=>{if(o>t.inputsCount-1)return!1;const i=this.getInputElement(o);i.setValue(s),i[t.inputsCount>o?"show":"hide"](),o||this.hot._registerTimeout(()=>i.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ti(Gt),t=[];return T(this.getInputElements(),(s,o)=>{e.inputsCount>o&&t.push(s.getValue())}),{command:e,args:t}}updateState(e,t){const s=Ti(e?e.name:Gt);this.state.setValueAtIndex(t,{command:s,args:e?e.args:[]}),e||T(this.getInputElements(),o=>o.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof fl)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Yo)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,s,o,i,r)=>{J(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&J(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=r,t.appendChild(a),T(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[Ti(Gt)];if(e!==null){const{visualIndex:s}=e;t=n4(this.hot.getDataType(0,s,this.hot.countRows(),s))}T(this.getInputElements(),s=>s.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function C4(n){T(this.getInputElements(),(e,t)=>{e[n.inputsCount>t?"show":"hide"](),t===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",n)}function S4(n){Yr(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Xn(n))}function $b(n,e,t){v4(n,e),e.set(n,t)}function v4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sa(n,e){var t=N_(n,e,"get");return y4(n,t)}function y4(n,e){return e.get?e.get.call(n):e.value}function Vb(n,e,t){var s=N_(n,e,"set");return b4(n,s,t),t}function N_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function b4(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var ar=new WeakMap,Zg=new WeakMap;class oh extends as{static get DEFAULTS(){return Sn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,kt(oh.DEFAULTS,t)),$b(this,ar,{writable:!0,value:void 0}),$b(this,Zg,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),Vb(this,Zg,e),Vb(this,ar,this._element.firstChild),Sa(this,ar).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Sa(this,Zg).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return Sa(this,ar).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Sa(this,ar).checked=e)}focus(){this.isBuilt()&&Sa(this,ar).focus()}}function R4(n,e){E4(n,e),e.add(n)}function E4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function T4(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}const Wb=0;var Bb=new WeakSet;class M4 extends Ul{constructor(e,t){super(e,{id:t.id,stateless:!1}),R4(this,Bb),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(J(t.parentNode,"htFiltersMenuOperators"),T(this.elements,s=>t.appendChild(s.element)),t)}}buildOperatorsElement(){const e=[Uo,sh];T(e,t=>{const s=new oh(this.hot,{name:"operator",label:{htmlFor:t,textContent:jK(t)},value:t,checked:t===e[Wb],id:t});s.addLocalHook("change",o=>T4(this,Bb,_4).call(this,o)),this.elements.push(s)})}setChecked(e){if(this.elements.length<e)throw Error(Qe`Radio button with index ${e} doesn't exist.`);T(this.elements,(t,s)=>{t.setChecked(s===e)})}getActiveOperationId(){const e=this.elements.find(t=>t instanceof oh&&t.isChecked());return e?e.getValue():Uo}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&T(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Uo,t=arguments.length>1?arguments[1]:void 0,s=e;s===fS&&(s=sh),this.state.setValueAtIndex(t,s)}reset(){this.setChecked(Wb)}}function _4(n){this.setState(n.target.value)}function O4(n,e,t){A4(n,e),e.set(n,t)}function A4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qg(n,e){var t=L_(n,e,"get");return I4(n,t)}function I4(n,e){return e.get?e.get.call(n):e.value}function x4(n,e,t){var s=L_(n,e,"set");return H4(n,s,t),t}function L_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function H4(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var va=new WeakMap;class gl extends as{static get DEFAULTS(){return Sn({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,kt(gl.DEFAULTS,t)),O4(this,va,{writable:!0,value:void 0})}build(){super.build(),x4(this,va,this._element.firstChild)}update(){this.isBuilt()&&(Qg(this,va).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Qg(this,va).focus()}activate(){Qg(this,va).click()}}function Wu(n,e){k_(n,e),e.add(n)}function lr(n,e,t){k_(n,e),e.set(n,t)}function k_(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bu(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function He(n,e){var t=F_(n,e,"get");return P4(n,t)}function P4(n,e){return e.get?e.get.call(n):e.value}function es(n,e,t){var s=F_(n,e,"set");return D4(n,s,t),t}function F_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function D4(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const Ub="multipleSelect.itemBox";var ss=new WeakMap,yt=new WeakMap,Jg=new WeakMap,js=new WeakMap,Ro=new WeakMap,Eo=new WeakMap,Yb=new WeakSet,zb=new WeakSet,Gb=new WeakSet,jb=new WeakSet;class ml extends as{static get DEFAULTS(){return Sn({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,kt(ml.DEFAULTS,t)),Wu(this,jb),Wu(this,Gb),Wu(this,zb),Wu(this,Yb),lr(this,ss,{writable:!0,value:[]}),lr(this,yt,{writable:!0,value:void 0}),lr(this,Jg,{writable:!0,value:void 0}),lr(this,js,{writable:!0,value:void 0}),lr(this,Ro,{writable:!0,value:void 0}),lr(this,Eo,{writable:!0,value:void 0}),es(this,js,new Yo(this.hot,{placeholder:Zd,className:"htUIMultipleSelectSearch"})),es(this,Ro,new gl(this.hot,{textContent:jd,className:"htUISelectAll"})),es(this,Eo,new gl(this.hot,{textContent:Kd,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return He(this,yt)}registerHooks(){He(this,js).addLocalHook("keydown",e=>Bu(this,zb,L4).call(this,e)),He(this,js).addLocalHook("input",e=>Bu(this,Yb,N4).call(this,e)),He(this,Ro).addLocalHook("click",e=>Bu(this,Gb,k4).call(this,e)),He(this,Eo).addLocalHook("click",e=>Bu(this,jb,F4).call(this,e))}setItems(e){es(this,ss,e),He(this,yt)&&He(this,yt).loadData(He(this,ss))}setLocale(e){es(this,Jg,e)}getLocale(){return He(this,Jg)}getItems(){return[...He(this,ss)]}getValue(){return V4(He(this,ss))}getSearchInputElement(){return He(this,js)}getSelectAllElement(){return He(this,Ro)}getClearAllElement(){return He(this,Eo)}isSelectedAllValues(){return He(this,ss).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),s=new as(this.hot,{className:"htUISelectionControls",children:[He(this,Ro),He(this,Eo)]});this._element.appendChild(He(this,js).element),this._element.appendChild(s.element),this._element.appendChild(t);const o=i=>{if(!this._element)return;He(this,yt)&&He(this,yt).destroy(),J(i,"htUIMultipleSelectHot"),es(this,yt,new this.hot.constructor(i,{data:He(this,ss),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,d,f,m)=>{l.title=m.instance.getDataAtRowProp(u,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{He(this,yt).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>He(this,yt).container.scrollWidth-Yt(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),He(this,yt).init();const a=He(this,yt).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:Ub}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{He(this,yt).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:Ub})};o(t),this.hot._registerTimeout(()=>o(t),100)}focus(){this.isBuilt()&&He(this,yt).listen()}reset(){He(this,js).reset(),He(this,Ro).reset(),He(this,Eo).reset()}update(){this.isBuilt()&&(He(this,yt).loadData($4(He(this,ss),this.options.value)),super.update())}destroy(){He(this,yt)&&He(this,yt).destroy(),He(this,js).destroy(),He(this,Eo).destroy(),He(this,Ro).destroy(),es(this,js,null),es(this,Eo,null),es(this,Ro,null),es(this,yt,null),es(this,ss,null),super.destroy()}}function N4(n){const e=n.target.value.toLocaleLowerCase(this.getLocale());let t;e===""?t=[...He(this,ss)]:t=kn(He(this,ss),s=>`${s.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),He(this,yt).loadData(t)}function L4(n){this.runLocalHooks("keydown",n,this),Lw(Yr,n.keyCode)("ARROW_DOWN")&&(n.preventDefault(),Xn(n),He(this,yt).listen(),He(this,yt).selectCell(0,0))}function k4(n){const e=[];n.preventDefault(),T(He(this,yt).getSourceData(),(t,s)=>{t.checked=!0,e.push(CC(t,s)[0])}),He(this,yt).setSourceDataAtCell(e)}function F4(n){const e=[];n.preventDefault(),T(He(this,yt).getSourceData(),(t,s)=>{t.checked=!1,e.push(CC(t,s)[0])}),He(this,yt).setSourceDataAtCell(e)}function $4(n,e){const t=Yl(e);return Ve(n,s=>(s.checked=t(s.value),s))}function V4(n){const e=[];return T(n,t=>{t.checked&&e.push(t.value)}),e}function W4(n,e){B4(n,e),e.add(n)}function B4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function U4(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var Kb=new WeakSet;class Y4 extends Ul{constructor(e,t){super(e,{id:t.id,stateless:!1}),W4(this,Kb),this.name=t.name,this.elements.push(new ml(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>U4(this,Kb,z4).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Mi){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?Gt:Mi},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(s,o,i,r,a)=>{const[l]=kn(o,d=>d.name===Mi),u={},c=this.hot.getTranslatedPhrase(ll);if(l){const d=Hp(Ve(r(s,a),C=>C.value));i&&(l.args[0]=i);const f=[],m=Ob(d,l.args[0],c,C=>{C.checked&&f.push(C.value)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[f],u.command=Ti(Mi),u.itemsSnapshot=m}else u.args=[],u.command=Ti(Gt);this.state.setValueAtIndex(s,u)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof ml)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,s,o,i,r)=>{J(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return J(a,"htFiltersMenuLabel"),a.textContent=r,t.appendChild(a),T(this.elements,l=>t.appendChild(l.element)),t}}}reset(){const e=this.hot.getTranslatedPhrase(ll),t=Hp(this._getColumnVisibleValues()),s=Ob(t,t,e);this.getMultipleSelectElement().setItems(s),super.reset(),this.getMultipleSelectElement().setValue(t);const o=this.hot.getPlugin("filters").getSelectedColumn();o!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,o.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ve(this.hot.getDataAtCol(e.visualIndex),t=>O_(t))}}function z4(n){Yr(n.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Xn(n))}var $_;function G4(n,e){j4(n,e),e.add(n)}function j4(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K4(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var Xb=new WeakSet;class pl extends Ul{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),G4(this,Xb),this.name=t.name,this.elements.push(new Yo(this.hot,{type:"button",value:Xd,className:"htUIButton htUIButtonOK",identifier:pl.BUTTON_OK})),this.elements.push(new Yo(this.hot,{type:"button",value:qd,className:"htUIButton htUIButtonCancel",identifier:pl.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){T(this.elements,e=>{e.addLocalHook("click",(t,s)=>K4(this,Xb,X4).call(this,t,s))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(J(t.parentNode,"htFiltersMenuActionBar"),T(this.elements,s=>t.appendChild(s.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}$_=pl;function X4(n,e){e.options.identifier===$_.BUTTON_OK?this.accept():this.cancel()}const qb="ConditionCollection.filteringStates";class V_{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.hot=e,this.isMapRegistrable=t,this.filteringStates=new kh,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(qb,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,t){var s;const o=this.filteringStates.getValueAtIndex(t),i=(s=o==null?void 0:o.conditions)!==null&&s!==void 0?s:[],r=o==null?void 0:o.operation;return this.isMatchInConditions(i,e,r)}isMatchInConditions(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Uo;return e.length?GK(s)(e,t):!0}addCondition(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Uo,o=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,r=Ve(t.args,c=>typeof c=="string"?c.toLocaleLowerCase(i):c),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==s)throw Error(Qe`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(ft(dl[s]))throw new Error(Qe`Unexpected operation named \`${s}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:s,conditions:[{name:a,args:r,func:qo(a,r)}]},o):u.push({name:a,args:r,func:qo(a,r)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,s;return(t=(s=this.filteringStates.getValueAtIndex(e))===null||s===void 0?void 0:s.conditions)!==null&&t!==void 0?t:[]}getOperation(e){var t;return(t=this.filteringStates.getValueAtIndex(e))===null||t===void 0?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Pt(this.filteringStates.getEntries(),(e,t)=>{let[s,{operation:o,conditions:i}]=t;return e.push({column:s,operation:o,conditions:Ve(i,r=>{let{name:a,args:l}=r;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),T(e,t=>{T(t.conditions,s=>this.addCondition(t.column,s))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const s=this.getConditions(e);return t?s.some(o=>o.name===t):s.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(qb),this.filteringStates=null,this.clearLocalHooks()}}ht(V_,In);const W_=V_;class q4{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return T(this.conditionCollection.getFilteredColumns(),(t,s)=>{let o=this.columnDataFactory(t);s&&(o=this._getIntersectData(o,e)),e=this.filterByColumn(t,o)}),e}filterByColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const s=[];return T(t,o=>{o!==void 0&&this.conditionCollection.isMatch(o,e)&&s.push(o)}),s}_getIntersectData(e,t){const s=[];return T(t,o=>{const i=o.meta.visualRow;e[i]!==void 0&&(s[i]=e[i])}),s}}const B_=q4;class U_{constructor(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];this.hot=e,this.conditionCollection=t,this.columnDataFactory=s,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.conditionCollection.addLocalHook("beforeRemove",o=>this._onConditionBeforeModify(o)),this.conditionCollection.addLocalHook("afterRemove",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("afterAdd",o=>this.updateStatesAtColumn(o)),this.conditionCollection.addLocalHook("beforeClean",()=>this._onConditionBeforeClean()),this.conditionCollection.addLocalHook("afterClean",()=>this._onConditionAfterClean())}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,T(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}_onConditionBeforeModify(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}updateStatesAtColumn(e,t){var s=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const o=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);i===-1&&(i=this.latestEditedColumnPosition);const r=o.slice(0,i),a=o.slice(i);a.length&&a[0].column===e&&a.shift();const l=FE(function(c,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const m=new W_(s.hot,!1),w=[].concat(c,f);m.importAllConditions(w);const C=s.columnDataFactory(d);let b;m.isEmpty()?b=C:b=new B_(m,M=>s.columnDataFactory(M)).filter(),b=Ve(b,M=>M.meta.visualRow);const y=Yl(b);return m.destroy(),kn(C,M=>y(M.meta.visualRow))})(r),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:t})}_onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}_onConditionAfterClean(){T(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}destroy(){this.clearLocalHooks(),We(this,(e,t)=>{this[t]=null})}}ht(U_,In);const Z4=U_;function Q4(n){return r_({initialPage:0,size:()=>n.length,onItemSelect:(t,s)=>{const o=n[t];if(o instanceof ml)return s;if(o.element&&!jo(o.element))return!1;o.focus()}})}const ya="filters";function J4(n,e){const t=Q4(e),s=r=>()=>{n.isOpened()&&n.getKeyboardShortcutsCtrl().listen(ya),t.setCurrentPage(e.indexOf(r))};e.forEach(r=>{r instanceof as&&(r.addLocalHook("click",s(r)),r.addLocalHook("focus",s(r)),r.addLocalHook("afterClose",s(r)))}),n.addLocalHook("afterSelectionChange",r=>{r.key.startsWith("filter_")||t.clear()});function o(r){const a=n.getKeyboardShortcutsCtrl(),l=r.getKeyboardShortcutsCtrl();t.clear(),l.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:a.getContext(ya),callback:()=>{r.isSubMenu()&&r.close(),a.listen(ya)}}]),!r.isSubMenu()&&a.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:u=>{n.getNavigator().clear(),u.shiftKey?t.toPreviousItem():t.toNextItem()}},{keys:[["Escape"]],callback:()=>{n.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:u=>{const c=e[t.getCurrentPage()];c instanceof fl&&(c.openOptions(),u.preventDefault()),c instanceof gl&&(c.activate(),u.preventDefault()),c instanceof as||u.preventDefault()}}],ya)}n.addLocalHook("afterSubmenuOpen",o),n.addLocalHook("afterOpen",o);function i(){n.focus(),n.getKeyboardShortcutsCtrl().listen(ya)}return{...t,listen:i}}function e6(n,e,t){t6(n,e),e.set(n,t)}function t6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ba(n,e,t){return e=n6(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function n6(n){var e=s6(n,"string");return typeof e=="symbol"?e:String(e)}function s6(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function o6(n,e,t){var s=Y_(n,e,"set");return i6(n,s,t),t}function i6(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Uu(n,e){var t=Y_(n,e,"get");return r6(n,t)}function Y_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function r6(n,e){return e.get?e.get.call(n):e.value}const Pp="filters",a6=250,Zb=Pp;var ur=new WeakMap;class z_ extends tt{static get PLUGIN_KEY(){return Pp}static get PLUGIN_PRIORITY(){return a6}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),ba(this,"dropdownMenuPlugin",null),ba(this,"conditionCollection",null),ba(this,"conditionUpdateObserver",null),ba(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ba(this,"filtersRowsMap",null),e6(this,ur,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(t,s)=>this.onAfterGetColHeader(t,s))}isEnabled(){return!!this.hot.getSettings()[Pp]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Hl),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,s=r=>(r.addLocalHook("accept",()=>this.onActionBarSubmit("accept")),r.addLocalHook("cancel",()=>this.onActionBarSubmit("cancel")),r.addLocalHook("change",a=>this.onComponentChange(r,a)),r),o=()=>`${this.hot.getTranslatedPhrase(Yd)}:`,i=()=>`${this.hot.getTranslatedPhrase(zd)}:`;if(!this.components.get("filter_by_condition")){const r=new qg(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:t});r.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition",s(r))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new M4(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const r=new qg(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});r.addLocalHook("afterClose",()=>this.onSelectUIClosed()),this.components.set("filter_by_condition2",s(r))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new Y4(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new pl(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new W_(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Z4(this.hot,this.conditionCollection,r=>this.getDataMapAtColumn(r)),this.conditionUpdateObserver.addLocalHook("update",r=>this.updateComponents(r))),this.components.forEach(r=>r.show()),this.addHook("afterDropdownMenuDefaultOptions",r=>this.onAfterDropdownMenuDefaultOptions(r)),this.addHook("afterDropdownMenuShow",()=>this.onAfterDropdownMenuShow()),this.addHook("afterDropdownMenuHide",()=>this.onAfterDropdownMenuHide()),this.addHook("afterChange",r=>this.onAfterChange(r)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Uu(this,ur)&&this.dropdownMenuPlugin.enabled){const r=this.dropdownMenuPlugin.menu,a=[{focus:()=>r.focus()},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];o6(this,ur,J4(r,a));const l=u=>{Uu(this,ur).listen(),u.preventDefault(),Yr(u.keyCode,"TAB")&&(u.shiftKey?Uu(this,ur).toPreviousItem():Uu(this,ur).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,s)=>{t.destroy(),this.components.set(s,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:Zb})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Zb)}addCondition(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Uo;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:t},args:s},o)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),s=!this.conditionCollection.isEmpty();let o=[];const i=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",i)!==!1)if(s){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),o=Ve(t.filter(),u=>u.meta.visualRow);const l=Yl(o);me(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),T(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!o.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),s=[];return T(this.hot.getSourceDataAtCol(t),(o,i)=>{var r;const{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:m,locale:w}=this.hot.getCellMeta(i,t),C=(r=this.hot.getDataAtCell(this.hot.toVisualRow(i),t))!==null&&r!==void 0?r:o;s.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:d,instance:f,dateFormat:m,locale:w},value:O_(C)})}),s}onAfterChange(e){e&&T(e,t=>{const[,s]=t,o=this.hot.propToCol(s);this.conditionCollection.hasConditions(o)&&this.updateValueComponentCondition(o)})}updateValueComponentCondition(e){const t=this.hot.getDataAtCol(e),s=Hp(t);this.conditionUpdateObserver.updateStatesAtColumn(e,s)}restoreComponents(e){var t;const s=(t=this.getSelectedColumn())===null||t===void 0?void 0:t.physicalIndex;e.forEach(o=>{o.isHidden()||o.restoreState(s)}),this.updateDependentComponentsVisibility()}onAfterDropdownMenuShow(){this.restoreComponents(Array.from(this.components.values()))}onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}onAfterDropdownMenuDefaultOptions(e){e.items.push({name:Ue}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}getOperationBasedOnArguments(e,t,s,o){let i=e;return i===sh&&t.command.key!==Gt&&s.command.key!==Gt&&o.command.key!==Gt?i=fS:o.command.key!==Gt&&(t.command.key===Gt||s.command.key===Gt)&&(i=Uo),i}onActionBarSubmit(e){var t;if(e==="accept"){const o=this.getSelectedColumn();if(o===null){var s;(s=this.dropdownMenuPlugin)===null||s===void 0||s.close();return}const{physicalIndex:i}=o,r=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),u=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,a,l);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(i);c===-1&&(c=void 0),this.conditionCollection.removeConditions(i),r.command.key!==Gt&&(this.conditionCollection.addCondition(i,r,u,c),a.command.key!==Gt&&this.conditionCollection.addCondition(i,a,u,c)),l.command.key!==Gt&&this.conditionCollection.addCondition(i,l,u,c),this.conditionUpdateObserver.flush(),this.components.forEach(d=>d.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(t=this.dropdownMenuPlugin)===null||t===void 0||t.close()}onComponentChange(e,t){this.updateDependentComponentsVisibility(),e.constructor===qg&&!t.inputsCount&&this.setListeningDropdownMenu()}onSelectUIClosed(){this.setListeningDropdownMenu()}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),s=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...s):this.hideComponents(...s)}onAfterGetColHeader(e,t){const s=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(s)?J(t,"htFiltersActive"):Pe(t,"htFiltersActive")}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new B_(e,t=>this.getDataMapAtColumn(t))}updateComponents(e){var t;if(!((t=this.dropdownMenuPlugin)!==null&&t!==void 0&&t.enabled))return;const{editedConditionStack:{conditions:s,column:o}}=e,i=s.filter(a=>a.name===Mi),r=s.filter(a=>a.name!==Mi);if(i.length>=2||r.length>=3)lt(Qe`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(o);this.components.get("filter_by_condition").updateState(r[0],o),this.components.get("filter_by_condition2").updateState(r[1],o),this.components.get("filter_operators").updateState(a,o),this.components.get("filter_by_value").updateState(e)}}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return T(o,r=>{T(t.menuItems,(a,l)=>{a.key===r.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const s=this.dropdownMenuPlugin.menu.hotMenu,o=s.getPlugin("hiddenRows");for(var i=arguments.length,r=new Array(i>1?i-1:0),a=1;a<i;a++)r[a-1]=arguments[a];const l=this.getIndexesOfComponents(...r);e?o.showRows(l):o.hideRows(l),s.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{e!==null&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}const G_="internal-use-in-handsontable",Dp={licenseKey:G_,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function j_(n){var e;return{maxColumns:n.maxColumns,maxRows:n.maxRows,language:(e=n[rn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function K_(n){return Object.keys(n).reduce((e,t)=>(t!=="hyperformula"&&(e[t]=n[t]),e),{})}function l6(n){var e;const t=n[rn],s=K_(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=j_(n);return{...Dp,...s,...o}}function u6(n){var e;const t=n[rn],s=K_(t!=null&&(e=t.engine)!==null&&e!==void 0&&e.hyperformula?t.engine:{}),o=j_(n);return{...s,...o}}function c6(n,e){return Object.keys(e).some(t=>e[t]!==void 0&&e[t]!==n[t])}function gf(){const n="engine_relationship",e=fs(rn);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function gS(){const n="shared_engine_usage",e=fs(rn);return e.hasItem(n)||e.register(n,new Map),e.getItem(n)}function h6(n){const e=n.getSettings(),t=e[rn],s=t==null?void 0:t.engine;if(t===!0||ft(s))return null;if(typeof s.hyperformula=="function"||typeof s=="function"){var o;return d6((o=s.hyperformula)!==null&&o!==void 0?o:s,e,n)}else if(typeof s=="object"&&ft(s.hyperformula)){const i=gf(),r=gS().get(s);return i.has(s)||i.set(s,[]),i.get(s).push(n),r&&r.push(n.guid),s.getConfig().licenseKey||s.updateConfig({licenseKey:G_}),(s.getConfig().leapYear1900!==Dp.leapYear1900||Ah(s.getConfig().nullDate,Dp.nullDate)===!1)&&lt(Qe`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),s}return null}function d6(n,e,t){const s=e[rn],o=l6(e),i=gf(),r=gS();f6(n,s.functions),g6(n,s.language);const a=n.buildEmpty(o);return i.set(a,[t]),r.set(a,[t.guid]),m6(a,s.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function Qb(n){var e;const t=gf(),s=t.size===0?[]:Array.from((e=t.get(n))!==null&&e!==void 0?e:[]);return new Map(s.map(o=>[o.getPlugin("formulas").sheetId,o]))}function Jb(n,e){if(n){const t=gf(),s=t.get(n),o=gS(),i=o.get(n);s&&s.includes(e)&&(s.splice(s.indexOf(e),1),s.length===0&&t.delete(n)),i&&i.includes(e.guid)&&(i.splice(i.indexOf(e.guid),1),i.length===0&&(o.delete(n),n.destroy()))}}function f6(n,e){e&&e.forEach(t=>{const{name:s,plugin:o,translations:i}=t;try{n.registerFunction(s,o,i)}catch(r){lt(r.message)}})}function g6(n,e){if(e){const{langCode:t}=e;try{n.registerLanguage(t,e)}catch(s){lt(s.message)}}}function m6(n,e){e&&(n.suspendEvaluation(),e.forEach(t=>{const{name:s,expression:o,scope:i,options:r}=t;try{n.addNamedExpression(s,o,i,r)}catch(a){lt(a.message)}}),n.resumeEvaluation())}function p6(n,e){return(ft(e)||!n.doesSheetExist(e))&&(e=n.addSheet(e)),e}const X_="DD/MM/YYYY";function q_(n){return typeof n=="string"&&n.charAt(0)==="'"&&n.charAt(1)==="="}function w6(n){return q_(n)?n.substr(1):n}function C6(n){return typeof n=="string"&&n.startsWith("=")}function em(n,e){return typeof n=="string"&&e==="date"}function eR(n,e){return Q(n,e,!0).isValid()}function tR(n,e){return Q(n,e,!0).format(X_)}function S6(n,e){return Q(n,X_,!0).format(e)}function nR(n,e){const s=new Date(Date.UTC(0,0,n+-1));return Q(s).format(e)}function mi(n,e,t){v6(n,e),e.set(n,t)}function v6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wt(n,e){var t=Z_(n,e,"get");return y6(n,t)}function y6(n,e){return e.get?e.get.call(n):e.value}function To(n,e,t){var s=Z_(n,e,"set");return b6(n,s,t),t}function Z_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function b6(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Ra=new WeakMap,Mo=new WeakMap,Hn=new WeakMap,Yu=new WeakMap,tm=new WeakMap,nm=new WeakMap,zu=new WeakMap;class R6{constructor(e,t,s){mi(this,Ra,{writable:!0,value:void 0}),mi(this,Mo,{writable:!0,value:void 0}),mi(this,Hn,{writable:!0,value:void 0}),mi(this,Yu,{writable:!0,value:[]}),mi(this,tm,{writable:!0,value:[]}),mi(this,nm,{writable:!0,value:void 0}),mi(this,zu,{writable:!0,value:[]}),To(this,Ra,e),To(this,Mo,t),To(this,Hn,s)}setRemovedHfIndexes(e){return To(this,zu,e.map(t=>{const s=wt(this,Mo).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(s)})),wt(this,zu)}getRemovedHfIndexes(){return wt(this,zu)}getHfIndexFromVisualIndex(e){const t=wt(this,Mo).getIndexesSequence(),s=wt(this,Mo).getNotTrimmedIndexes();return t.indexOf(s[e])}syncMoves(e){const s=`move${un(wt(this,Ra))}s`;wt(this,Hn).getEngine().batch(()=>{e.forEach(o=>{const i=o.from!==o.to,r=o.from+1!==o.to;i&&r&&wt(this,Hn).getEngine()[s](wt(this,Hn).getSheetId(),o.from,1,o.to)})})}storeMovesInformation(e,t,s){s!==!1&&(To(this,tm,e.map(o=>this.getHfIndexFromVisualIndex(o))),To(this,nm,this.getHfIndexFromVisualIndex(t)))}getMoveLine(e,t){const s=wt(this,Mo).getNumberOfIndexes(),o=Array.from(Array(s).keys()).filter(r=>e.includes(r)===!1);if(t===0){var i;return(i=o[t])!==null&&i!==void 0?i:0}return o[t-1]+1}getInitiallyCalculatedMoves(e,t){let s=this.getMoveLine(e,t);const o=[];return e.forEach(i=>{const r={from:i,to:s};o.forEach(a=>{const l=a.from>a.to,u=a.to<=r.from;a.from>r.from&&u&&l&&(r.from+=1)}),r.from>=s&&(s+=1),o.push(r)}),o}adjustedCalculatedMoves(e){return e.forEach((t,s)=>{e.slice(s+1).forEach(i=>{const r=i.from<i.to;i.from>t.from&&r&&(i.from-=1)})}),e}calculateAndSyncMoves(e,t){if(wt(this,Hn).isPerformingUndoRedo()||e===!1||t===!1)return;const s=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(wt(this,tm),wt(this,nm)));wt(this,Hn).getSheetId()===null?wt(this,Hn).getPostponeAction(()=>this.syncMoves(s)):this.syncMoves(s)}getIndexesChangeSyncMethod(){const e=`set${un(wt(this,Ra))}Order`;return t=>{if(wt(this,Hn).isPerformingUndoRedo())return;const s=wt(this,Mo).getIndexesSequence();if(t==="update"){const o=wt(this,Yu).map(l=>s.indexOf(l)),i=wt(this,Hn).getEngine().getSheetDimensions(wt(this,Hn).getSheetId());let r;wt(this,Ra)==="row"?r=i.height:r=i.width;const a=o.length;for(let l=a;l<r;l+=1)o.push(l);wt(this,Hn).getEngine()[e](wt(this,Hn).getSheetId(),o)}To(this,Yu,s)}}init(){To(this,Yu,wt(this,Mo).getIndexesSequence())}}const sR=R6;function pi(n,e,t){E6(n,e),e.set(n,t)}function E6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ks(n,e){var t=Q_(n,e,"get");return T6(n,t)}function T6(n,e){return e.get?e.get.call(n):e.value}function wi(n,e,t){var s=Q_(n,e,"set");return M6(n,s,t),t}function Q_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function M6(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Gu=new WeakMap,ju=new WeakMap,sm=new WeakMap,om=new WeakMap,im=new WeakMap,rm=new WeakMap,am=new WeakMap;class _6{constructor(e,t,s){pi(this,Gu,{writable:!0,value:void 0}),pi(this,ju,{writable:!0,value:void 0}),pi(this,sm,{writable:!0,value:void 0}),pi(this,om,{writable:!0,value:!1}),pi(this,im,{writable:!0,value:!1}),pi(this,rm,{writable:!0,value:null}),pi(this,am,{writable:!0,value:null}),wi(this,Gu,new sR("row",e,this)),wi(this,ju,new sR("column",t,this)),wi(this,sm,s)}getForAxis(e){return e==="row"?Ks(this,Gu):Ks(this,ju)}setPerformUndo(e){wi(this,om,e)}setPerformRedo(e){wi(this,im,e)}isPerformingUndoRedo(){return Ks(this,om)||Ks(this,im)}getSheetId(){return Ks(this,am)}getEngine(){return Ks(this,rm)}getPostponeAction(){return Ks(this,sm)}setupSyncEndpoint(e,t){wi(this,rm,e),wi(this,am,t),Ks(this,Gu).init(),Ks(this,ju).init()}}const O6=_6;function cr(n,e,t){return e=A6(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function A6(n){var e=I6(n,"string");return typeof e=="symbol"?e:String(e)}function I6(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function lm(n,e,t){x6(n,e),e.set(n,t)}function x6(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _o(n,e,t){var s=J_(n,e,"set");return H6(n,s,t),t}function H6(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function hr(n,e){var t=J_(n,e,"get");return P6(n,t)}function J_(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function P6(n,e){return e.get?e.get.call(n):e.value}const rn="formulas",D6=["maxRows","maxColumns","language"],N6=260;de.getSingleton().register("afterNamedExpressionAdded");de.getSingleton().register("afterNamedExpressionRemoved");de.getSingleton().register("afterSheetAdded");de.getSingleton().register("afterSheetRemoved");de.getSingleton().register("afterSheetRenamed");de.getSingleton().register("afterFormulasValuesUpdate");const dr=n=>n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto";var Xs=new WeakMap,um=new WeakMap,Ea=new WeakMap;class L6 extends tt{constructor(){var e;super(...arguments),e=this,lm(this,Xs,{writable:!0,value:!1}),lm(this,um,{writable:!0,value:!1}),lm(this,Ea,{writable:!0,value:[["valuesUpdated",function(){return e.onEngineValuesUpdated(...arguments)}],["namedExpressionAdded",function(){return e.onEngineNamedExpressionsAdded(...arguments)}],["namedExpressionRemoved",function(){return e.onEngineNamedExpressionsRemoved(...arguments)}],["sheetAdded",function(){return e.onEngineSheetAdded(...arguments)}],["sheetRenamed",function(){return e.onEngineSheetRenamed(...arguments)}],["sheetRemoved",function(){return e.onEngineSheetRemoved(...arguments)}]]}),cr(this,"staticRegister",fs("formulas")),cr(this,"engine",null),cr(this,"sheetName",null),cr(this,"indexSyncer",null),cr(this,"rowAxisSyncer",null),cr(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return rn}static get PLUGIN_PRIORITY(){return N6}static get SETTING_KEYS(){return[rn,...D6]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[rn]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=(e=h6(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){lt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const s=this.addSheet(this.sheetName,this.hot.getSourceDataArray());s!==!1&&(this.sheetName=s)}this.addHook("beforeLoadData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterLoadData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("beforeUpdateData",function(){return t.onBeforeLoadData(...arguments)}),this.addHook("afterUpdateData",function(){return t.onAfterLoadData(...arguments)}),this.addHook("modifyData",function(){return t.onModifyData(...arguments)}),this.addHook("modifySourceData",function(){return t.onModifySourceData(...arguments)}),this.addHook("beforeValidate",function(){return t.onBeforeValidate(...arguments)}),this.addHook("afterSetSourceDataAtCell",function(){return t.onAfterSetSourceDataAtCell(...arguments)}),this.addHook("afterSetDataAtCell",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("afterSetDataAtRowProp",function(){return t.onAfterSetDataAtCell(...arguments)}),this.addHook("beforeCreateRow",function(){return t.onBeforeCreateRow(...arguments)}),this.addHook("beforeCreateCol",function(){return t.onBeforeCreateCol(...arguments)}),this.addHook("afterCreateRow",function(){return t.onAfterCreateRow(...arguments)}),this.addHook("afterCreateCol",function(){return t.onAfterCreateCol(...arguments)}),this.addHook("beforeRemoveRow",function(){return t.onBeforeRemoveRow(...arguments)}),this.addHook("beforeRemoveCol",function(){return t.onBeforeRemoveCol(...arguments)}),this.addHook("afterRemoveRow",function(){return t.onAfterRemoveRow(...arguments)}),this.addHook("afterRemoveCol",function(){return t.onAfterRemoveCol(...arguments)}),this.indexSyncer=new O6(this.hot.rowIndexMapper,this.hot.columnIndexMapper,s=>{this.hot.addHookOnce("init",()=>{s()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(s,o,i,r)=>{this.rowAxisSyncer.storeMovesInformation(s,o,r)}),this.hot.addHook("beforeColumnMove",(s,o,i,r)=>{this.columnAxisSyncer.storeMovesInformation(s,o,r)}),this.hot.addHook("afterRowMove",(s,o,i,r,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,a)}),this.hot.addHook("afterColumnMove",(s,o,i,r,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,a)}),this.hot.addHook("beforeColumnFreeze",(s,o)=>{this.columnAxisSyncer.storeMovesInformation([s],this.hot.getSettings().fixedColumnsStart,o)}),this.hot.addHook("afterColumnFreeze",(s,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.hot.addHook("beforeColumnUnfreeze",(s,o)=>{this.columnAxisSyncer.storeMovesInformation([s],this.hot.getSettings().fixedColumnsStart-1,o)}),this.hot.addHook("afterColumnUnfreeze",(s,o)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,o)}),this.addHook("afterCellMetaReset",function(){return t.onAfterCellMetaReset(...arguments)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){return t.onAfterDetachChild(...arguments)}),this.addHook("beforeAutofill",function(){return t.onBeforeAutofill(...arguments)}),hr(this,Ea).forEach(s=>{let[o,i]=s;return this.engine.on(o,i)}),super.enablePlugin()}}disablePlugin(){hr(this,Ea).forEach(e=>{let[t,s]=e;return this.engine.off(t,s)}),Jb(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=u6(this.hot.getSettings());c6(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const s=this.hot.getSettings()[rn];if(oe(s)&&oe(s.sheetName)&&s.sheetName!==this.sheetName&&this.switchSheet(s.sheetName),!e.data&&this.sheetName===null){const o=this.hot.getSettings()[rn].sheetName;o&&this.engine.doesSheetExist(o)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(o??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){hr(this,Ea).forEach(e=>{var t;let[s,o]=e;return(t=this.engine)===null||t===void 0?void 0:t.off(s,o)}),_o(this,Ea,null),Jb(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(oe(t)&&!zT(t))return lt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return lt("Sheet with the provided name already exists."),!1;try{const s=this.engine.addSheet(e??void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(s),t),s}catch(s){return lt(s.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Bw(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${un(rn)}.switchSheet`)}getCellType(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const o=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return o!==null&&i!==null?this.engine.getCellType({sheet:s,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:s,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=new Set;e.forEach(o=>{var i;const r=o==null||(i=o.address)===null||i===void 0?void 0:i.sheet;r!==void 0&&(s.has(r)||s.add(r))}),Qb(this.engine).forEach((o,i)=>{if((t||i!==this.sheetId)&&s.has(i)){var r;o.render(),(r=o.view)===null||r===void 0||r.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const s=i=>{var r;const{row:a,col:l,sheet:u}=(r=i==null?void 0:i.address)!==null&&r!==void 0?r:{};return oe(u)?`${u}:${a}x${l}`:""},o=new Set(t.map(i=>s(i)));e.forEach(i=>{var r,a;const{row:l,col:u}=(r=i.address)!==null&&r!==void 0?r:{};if(oe(l)===!1||oe(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=i==null||(a=i.address)===null||a===void 0?void 0:a.sheet,d=s(i);if(c!==void 0&&!o.has(d)){const f=Qb(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,t,s){const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(o)){lt(`Not possible to set cell data at ${JSON.stringify(o)}`);return}const i=this.hot.getCellMeta(e,t);return em(s,i.type)&&(eR(s,i.dateFormat)?s=tR(s,i.dateFormat):C6(s)===!1&&(s=`'${s}`)),this.engine.setCellContents(o,s)}onBeforeValidate(e,t,s){const o=this.hot.propToCol(s);if(this.isFormulaCellType(t,o)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId},r=this.hot.getCellMeta(t,o);let a=this.engine.getCellValue(i);return r.type==="date"&&Cn(a)&&(a=nR(a,r.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return e}onBeforeAutofill(e,t,s){const{row:o,col:i}=t.getTopStartCorner(),{row:r,col:a}=t.getBottomEndCorner(),{row:l,col:u}=s.getTopStartCorner(),{row:c,col:d}=s.getBottomEndCorner(),f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},m={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(m)===!1)return!1;const w=this.engine.getFillRangeData(f,m),{row:C,col:b}=f.start,{row:y,col:M}=f.end,A=y-C+1,$=M-b+1;for(let H=0;H<w.length;H+=1)for(let V=0;V<w[H].length;V+=1){const z=w[H][V],ee=H%A,j=V%$,X=this.hot.getCellMeta(ee,j);em(z,X.type)&&(z.startsWith("'")?w[H][V]=z.slice(1):this.isFormulaCellType(ee,j,this.sheetId)===!1&&(w[H][V]=S6(z,X.dateFormat)))}return w}onBeforeLoadData(e,t){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(un(rn))||_o(this,um,ft(this.hot.getSettings().data))}onAfterCellMetaReset(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach((s,o)=>{s.forEach((i,r)=>{const a=this.hot.getCellMeta(o,r),l=a.dateFormat;em(i,a.type)&&(t=!0,eR(i,l)?e[o][r]=tR(i,l):this.isFormulaCellType(o,r)===!1&&(e[o][r]=`'${i}`))})}),t===!0&&(_o(this,Xs,!0),this.engine.setSheetContent(this.sheetId,e),_o(this,Xs,!1))}onAfterLoadData(e,t){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(un(rn)))if(this.sheetName=p6(this.engine,this.hot.getSettings()[rn].sheetName),hr(this,um))this.switchSheet(this.sheetName);else{const o=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,o)){_o(this,Xs,!0);const i=this.engine.setSheetContent(this.sheetId,o);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),_o(this,Xs,!1)}}}onModifyData(e,t,s,o){if(o!=="get"||hr(this,Xs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e);if(i===null||t===null)return;if(!this.isFormulaCellType(i,t)&&this.getCellType(i,t)!=="ARRAY"){q_(s.value)&&(s.value=w6(s.value));return}const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let l=this.engine.getCellValue(a);const u=this.hot.getCellMeta(i,t);u.type==="date"&&Cn(l)&&(l=nR(l,u.dateFormat));const c=typeof l=="object"&&l!==null?l.value:l;s.value=c}onModifySourceData(e,t,s,o){if(o!=="get"||hr(this,Xs)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),r=this.hot.propToCol(t);if(i===null||r===null||!this.isFormulaCellType(i,r)&&this.getCellType(i,r)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};s.value=this.engine.getCellSerialized(u)}onAfterSetDataAtCell(e,t){if(dr(t))return;const s=[],o=[],i=this.engine.batch(()=>{e.forEach(r=>{let[a,l,,u]=r;const c=this.hot.propToCol(l),d=this.hot.toPhysicalRow(a),f=this.hot.toPhysicalColumn(c),m={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};d!==null&&f!==null?this.syncChangeWithEngine(a,c,u):s.push([a,c,u]),o.push({address:m})})});s.length&&this.hot.addHookOnce("afterChange",()=>{const r=this.engine.batch(()=>{s.forEach(a=>{let[l,u,c]=a;this.syncChangeWithEngine(l,u,c)})});this.renderDependentSheets(r,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,o)}onAfterSetSourceDataAtCell(e,t){if(dr(t))return;const s=[],o=[];e.forEach(i=>{let[r,a,,l]=i;const u=this.hot.propToCol(a);if(!Cn(u))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){lt(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}o.push({address:c}),s.push(...this.engine.setCellContents(c,l))}),this.renderDependentSheets(s),this.validateDependentCells(s,o)}onBeforeCreateRow(e,t){let s=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(s=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[s,t]))return!1}onBeforeCreateCol(e,t){let s=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(s=e),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[s,t]))return!1}onBeforeRemoveRow(e,t,s){return this.rowAxisSyncer.setRemovedHfIndexes(s).every(r=>this.engine.isItPossibleToRemoveRows(this.sheetId,[r,1]))===!1?!1:void 0}onBeforeRemoveCol(e,t,s){return this.columnAxisSyncer.setRemovedHfIndexes(s).every(r=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[r,1]))===!1?!1:void 0}onAfterCreateRow(e,t,s){if(dr(s))return;const o=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(o)}onAfterCreateCol(e,t,s){if(dr(s))return;const o=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(o)}onAfterRemoveRow(e,t,s,o){if(dr(o))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch(()=>{i.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(r)}onAfterRemoveCol(e,t,s,o){if(dr(o))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),r=this.engine.batch(()=>{i.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(r)}onAfterDetachChild(e,t,s){var o;_o(this,Xs,!0);const i=this.hot.getSourceDataArray(s,0,s+(((o=t.__children)===null||o===void 0?void 0:o.length)||0),this.hot.countSourceCols());_o(this,Xs,!1),i.forEach((r,a)=>{r.forEach((l,u)=>{this.engine.setCellContents({col:u,row:s+a,sheet:this.sheetId},[[l]])})})}onEngineValuesUpdated(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}onEngineNamedExpressionsAdded(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}onEngineNamedExpressionsRemoved(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}onEngineSheetAdded(e){this.hot.runHooks("afterSheetAdded",e)}onEngineSheetRenamed(e,t){this.hot.runHooks("afterSheetRenamed",e,t)}onEngineSheetRemoved(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}}function k6(n){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,s,,o]=e;s-o!==0&&(t=1)}return this.getTranslatedPhrase(yd,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),s=Math.max(Math.min(e.col,t.col),0),o=Math.max(e.col,t.col),i=[];for(let l=s;l<=o;l+=1)i.push(l);n.hideColumns(i);const r=i[i.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function F6(n){const e=[];return{key:"hidden_columns_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(bd,t)},callback(){var t,s;if(e.length===0)return;let o=e[0],i=e[e.length-1];o=(t=this.columnIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,i=(s=this.columnIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&s!==void 0?s:this.countCols()-1,n.showColumns(e),this.render(),this.view.adjustElementsSize(!0),i-o+1===this.countCols()||this.selectColumns(o,i)},disabled:!1,hidden(){const t=Ve(n.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const s=this.getSelectedRangeLast(),o=s.getTopStartCorner().col,i=s.getBottomEndCorner().col,r=this.columnIndexMapper,a=r.getRenderableFromVisualIndex(o),l=r.getRenderableFromVisualIndex(i),u=r.getNotTrimmedIndexes(),c=[];if(o!==i){const d=i-o+1,f=l-a+1;if(d>f){const m=u.slice(o,i+1);c.push(...m.filter(w=>t.includes(w)))}}else if(a===0&&a<o)c.push(...u.slice(0,o));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const d=this.countCols()-1,f=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(d,-1));l===f&&d>i&&c.push(...u.slice(i+1))}return T(c,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function $6(n,e){e1(n,e),e.add(n)}function oR(n,e,t){e1(n,e),e.set(n,t)}function e1(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function V6(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Pn(n,e){var t=t1(n,e,"get");return W6(n,t)}function W6(n,e){return e.get?e.get.call(n):e.value}function Ta(n,e,t){var s=t1(n,e,"set");return B6(n,s,t),t}function t1(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function B6(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}de.getSingleton().register("beforeHideColumns");de.getSingleton().register("afterHideColumns");de.getSingleton().register("beforeUnhideColumns");de.getSingleton().register("afterUnhideColumns");const cm="hiddenColumns",U6=310,n1="beforeHiddenColumnIndicator",s1="afterHiddenColumnIndicator";var Ss=new WeakMap,vs=new WeakMap,iR=new WeakSet;class o1 extends tt{constructor(){super(...arguments),$6(this,iR),oR(this,Ss,{writable:!0,value:{}}),oR(this,vs,{writable:!0,value:null})}static get PLUGIN_KEY(){return cm}static get PLUGIN_PRIORITY(){return U6}isEnabled(){return!!this.hot.getSettings()[cm]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[cm];De(t)&&(Ta(this,Ss,t),ft(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Ta(this,vs,new Lh),Pn(this,vs).addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,Pn(this,vs)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(s,o,i)=>this.onAfterGetCellMeta(s,o,i)),this.addHook("modifyColWidth",(s,o)=>this.onModifyColWidth(s,o)),this.addHook("afterGetColHeader",function(){return e.onAfterGetColHeader(...arguments)}),this.addHook("modifyCopyableRange",s=>this.onModifyCopyableRange(s)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(t,s)=>{V6(this,iR,Y6).call(this,s)};this.hot.columnIndexMapper.unregisterMap(this.pluginName),Ta(this,Ss,{}),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),s=this.isValidConfig(e);let o=t;const i=Pn(this,vs).getValues().slice(),r=e.length>0;if(s&&r){const l=e.map(u=>this.hot.toPhysicalColumn(u));T(l,u=>{i[u]=!1}),o=Pt(i,(u,c,d)=>(c&&u.push(this.hot.toVisualColumn(d)),u),[])}this.hot.runHooks("beforeUnhideColumns",t,o,s&&r)!==!1&&(s&&r&&Pn(this,vs).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,o,s&&r,s&&o.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),s=this.isValidConfig(e);let o=t;s&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideColumns",t,o,s)!==!1&&(s&&this.hot.batchExecution(()=>{T(e,r=>{Pn(this,vs).setValueAtIndex(this.hot.toPhysicalColumn(r),!0)})},!0),this.hot.runHooks("afterHideColumns",t,o,s,s&&o.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.hideColumns(t)}getHiddenColumns(){return Ve(Pn(this,vs).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Pn(this,vs).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(s=>Number.isInteger(s)&&s>=0&&s<t):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}onModifyColWidth(e,t){if(this.isHidden(t))return 0;if(Pn(this,Ss).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&typeof e=="number"&&this.hot.hasColHeaders())return e+15}onAfterGetCellMeta(e,t,s){if(Pn(this,Ss).copyPasteEnabled===!1&&this.isHidden(t)&&(s.skipColumnOnPaste=!0),this.isHidden(t-1))s.className=s.className||"",s.className.indexOf("afterHiddenColumn")===-1&&(s.className+=" afterHiddenColumn");else if(s.className){const o=s.className.split(" ");if(o.length>0){const i=o.indexOf("afterHiddenColumn");i>-1&&o.splice(i,1),s.className=o.join(" ")}}}onModifyCopyableRange(e){if(Pn(this,Ss).copyPasteEnabled)return e;const t=[],s=(o,i,r,a)=>{t.push({startRow:o,endRow:i,startCol:r,endCol:a})};return T(e,o=>{let i=!0,r=0;me(o.startCol,o.endCol,a=>{this.isHidden(a)?(i||s(o.startRow,o.endRow,r,a-1),i=!0):(i&&(r=a),a===o.endCol&&s(o.startRow,o.endRow,r,a),i=!1)})}),t}onAfterGetColHeader(e,t){const s=this.hot.getSettings().ariaTags,o=t.querySelector(".beforeHiddenColumnIndicator"),i=t.querySelector(".afterHiddenColumnIndicator");if(!Pn(this,Ss).indicators||e<0){o==null||o.remove(),i==null||i.remove();return}const r=[];if(e>=1&&this.isHidden(e-1)){if(!i){const a=s?[zo(this.hot.getTranslatedPhrase(FC))]:[];Ai(t,{tagName:"div",attributes:a,className:s1})}r.push("afterHiddenColumn")}if(e<this.hot.countCols()-1&&this.isHidden(e+1)){if(!o){const a=s?[zo(this.hot.getTranslatedPhrase(kC))]:[];Ai(t,{tagName:"div",attributes:a,className:n1})}r.push("beforeHiddenColumn")}J(t,r)}onAfterContextMenuDefaultOptions(e){e.items.push({name:Ue},k6(this),F6(this))}onMapInit(){Array.isArray(Pn(this,Ss).columns)&&this.hideColumns(Pn(this,Ss).columns)}destroy(){Ta(this,Ss,null),Ta(this,vs,null),super.destroy()}}function Y6(n){Array.from(n.querySelectorAll(`.${s1}, .${n1}`)).forEach(e=>{e.remove()})}function z6(n){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[s,,o]=e;s-o!==0&&(t=1)}return this.getTranslatedPhrase(Rd,t)},callback(){const{from:e,to:t}=this.getSelectedRangeLast(),s=Math.max(Math.min(e.row,t.row),0),o=Math.max(e.row,t.row),i=[];for(let l=s;l<=o;l+=1)i.push(l);n.hideRows(i);const r=i[i.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(r,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function G6(n){const e=[];return{key:"hidden_rows_show",name(){const t=e.length>1?1:0;return this.getTranslatedPhrase(Ed,t)},callback(){var t,s;if(e.length===0)return;let o=e[0],i=e[e.length-1];o=(t=this.rowIndexMapper.getNearestNotHiddenIndex(o-1,-1))!==null&&t!==void 0?t:0,i=(s=this.rowIndexMapper.getNearestNotHiddenIndex(i+1,1))!==null&&s!==void 0?s:this.countRows()-1,n.showRows(e),this.render(),this.view.adjustElementsSize(!0),i-o+1===this.countRows()||this.selectRows(o,i)},disabled:!1,hidden(){const t=Ve(n.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||t.length<1)return!0;e.length=0;const s=this.getSelectedRangeLast(),o=s.getTopStartCorner().row,i=s.getBottomEndCorner().row,r=this.rowIndexMapper,a=r.getRenderableFromVisualIndex(o),l=r.getRenderableFromVisualIndex(i),u=r.getNotTrimmedIndexes(),c=[];if(o!==i){const d=i-o+1,f=l-a+1;if(d>f){const m=u.slice(o,i+1);c.push(...m.filter(w=>t.includes(w)))}}else if(a===0&&a<o)c.push(...u.slice(0,o));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const d=this.countRows()-1,f=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(d,-1));l===f&&d>i&&c.push(...u.slice(i+1))}return T(c,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function j6(n,e){i1(n,e),e.add(n)}function rR(n,e,t){i1(n,e),e.set(n,t)}function i1(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K6(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}function Wn(n,e){var t=r1(n,e,"get");return X6(n,t)}function X6(n,e){return e.get?e.get.call(n):e.value}function Ma(n,e,t){var s=r1(n,e,"set");return q6(n,s,t),t}function r1(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function q6(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}de.getSingleton().register("beforeHideRows");de.getSingleton().register("afterHideRows");de.getSingleton().register("beforeUnhideRows");de.getSingleton().register("afterUnhideRows");const hm="hiddenRows",Z6=320,a1="afterHiddenRowIndicator",l1="beforeHiddenRowIndicator";var qs=new WeakMap,ys=new WeakMap,aR=new WeakSet;class u1 extends tt{constructor(){super(...arguments),j6(this,aR),rR(this,qs,{writable:!0,value:{}}),rR(this,ys,{writable:!0,value:null})}static get PLUGIN_KEY(){return hm}static get PLUGIN_PRIORITY(){return Z6}isEnabled(){return!!this.hot.getSettings()[hm]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[hm];De(t)&&(Ma(this,qs,t),ft(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),Ma(this,ys,new Lh),Wn(this,ys).addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,Wn(this,ys)),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetCellMeta",(s,o,i)=>this.onAfterGetCellMeta(s,o,i)),this.addHook("modifyRowHeight",(s,o)=>this.onModifyRowHeight(s,o)),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("modifyCopyableRange",s=>this.onModifyCopyableRange(s)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(t,s)=>{K6(this,aR,Q6).call(this,s)};this.hot.rowIndexMapper.unregisterMap(this.pluginName),Ma(this,qs,{}),this.hot.addHook("afterGetRowHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetRowHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),s=this.isValidConfig(e);let o=t;const i=Wn(this,ys).getValues().slice(),r=e.length>0;if(s&&r){const l=e.map(u=>this.hot.toPhysicalRow(u));T(l,u=>{i[u]=!1}),o=Pt(i,(u,c,d)=>(c&&u.push(this.hot.toVisualRow(d)),u),[])}this.hot.runHooks("beforeUnhideRows",t,o,s&&r)!==!1&&(s&&r&&Wn(this,ys).setValues(i),this.hot.runHooks("afterUnhideRows",t,o,s&&r,s&&o.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),s=this.isValidConfig(e);let o=t;s&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeHideRows",t,o,s)!==!1&&(s&&this.hot.batchExecution(()=>{T(e,r=>{Wn(this,ys).setValueAtIndex(this.hot.toPhysicalRow(r),!0)})},!0),this.hot.runHooks("afterHideRows",t,o,s,s&&o.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.hideRows(t)}getHiddenRows(){return Ve(Wn(this,ys).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Wn(this,ys).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(s=>Number.isInteger(s)&&s>=0&&s<t):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}onModifyRowHeight(e,t){return this.isHidden(t)?0:e}onAfterGetCellMeta(e,t,s){if(Wn(this,qs).copyPasteEnabled===!1&&this.isHidden(e)&&(s.skipRowOnPaste=!0),this.isHidden(e-1))s.className=s.className||"",s.className.indexOf("afterHiddenRow")===-1&&(s.className+=" afterHiddenRow");else if(s.className){const o=s.className.split(" ");if(o.length>0){const i=o.indexOf("afterHiddenRow");i>-1&&o.splice(i,1),s.className=o.join(" ")}}}onModifyCopyableRange(e){if(Wn(this,qs).copyPasteEnabled)return e;const t=[],s=(o,i,r,a)=>{t.push({startRow:o,endRow:i,startCol:r,endCol:a})};return T(e,o=>{let i=!0,r=0;me(o.startRow,o.endRow,a=>{this.isHidden(a)?(i||s(r,a-1,o.startCol,o.endCol),i=!0):(i&&(r=a),a===o.endRow&&s(r,a,o.startCol,o.endCol),i=!1)})}),t}onAfterGetRowHeader(e,t){const s=this.hot.getSettings().ariaTags,o=t.querySelector(".beforeHiddenRowIndicator"),i=t.querySelector(".afterHiddenRowIndicator");if(!Wn(this,qs).indicators||e<0){o==null||o.remove(),i==null||i.remove();return}const r=[];if(e>=1&&this.isHidden(e-1)){if(!i){const a=s?[zo(this.hot.getTranslatedPhrase(BC))]:[];Ai(t,{tagName:"div",attributes:a,className:a1})}r.push("afterHiddenRow")}if(e<this.hot.countRows()-1&&this.isHidden(e+1)){if(!o){const a=s?[zo(this.hot.getTranslatedPhrase(WC))]:[];Ai(t,{tagName:"div",attributes:a,className:l1})}r.push("beforeHiddenRow")}J(t,r)}onAfterContextMenuDefaultOptions(e){e.items.push({name:Ue},z6(this),G6(this))}onMapInit(){Array.isArray(Wn(this,qs).rows)&&this.hideRows(Wn(this,qs).rows)}destroy(){Ma(this,qs,null),Ma(this,ys,null),super.destroy()}}function Q6(n){Array.from(n.querySelectorAll(`.${a1}, .${l1}`)).forEach(e=>{e.remove()})}function J6(n){return{key:"freeze_column",name(){return this.getTranslatedPhrase(Zh)},callback(e,t){const[{start:{col:s}}]=t;n.freezeColumn(s),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}}function e9(n){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Qh)},callback(e,t){const[{start:{col:s}}]=t;n.unfreezeColumn(s),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let t=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}de.getSingleton().register("beforeColumnFreeze");de.getSingleton().register("afterColumnFreeze");de.getSingleton().register("beforeColumnUnfreeze");de.getSingleton().register("afterColumnUnfreeze");const lR="manualColumnFreeze",t9=110,_a=new WeakMap;class n9 extends tt{static get PLUGIN_KEY(){return lR}static get PLUGIN_PRIORITY(){return t9}constructor(e){super(e),_a.set(this,{afterFirstUse:!1})}isEnabled(){return!!this.hot.getSettings()[lR]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>this.addContextMenuEntry(e)),this.addHook("beforeColumnMove",(e,t)=>this.onBeforeColumnMove(e,t)),super.enablePlugin())}disablePlugin(){const e=_a.get(this);e.afterFirstUse=!1,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=_a.get(this),s=this.hot.getSettings(),o=s.fixedColumnsStart<this.hot.countCols()&&e>s.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnFreeze",e,o)!==!1&&(o&&(this.hot.columnIndexMapper.moveIndexes(e,s.fixedColumnsStart),s._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,o))}unfreezeColumn(e){const t=_a.get(this),s=this.hot.getSettings(),o=s.fixedColumnsStart>0&&e<=s.fixedColumnsStart-1;t.afterFirstUse||(t.afterFirstUse=!0),this.hot.runHooks("beforeColumnUnfreeze",e,o)!==!1&&(o&&(s._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,s.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,o))}addContextMenuEntry(e){e.items.push({name:"---------"},J6(this),e9(this))}onBeforeColumnMove(e,t){if(_a.get(this).afterFirstUse){const o=this.hot.getSettings().fixedColumnsStart;if(t<o||e.some(i=>i<o))return!1}}}const dm=0,uR=1,cR=2,fr="px";let s9=class{constructor(e){this.hot=e,this._element=null,this.state=dm,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=cR}build(){this.state===dm&&(this._element=this.hot.rootDocument.createElement("div"),this.state=uR)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=dm}isAppended(){return this.state===cR}isBuilt(){return this.state>=uR}setPosition(e,t){Cn(e)&&(this._element.style.top=e+fr),Cn(t)&&(this._element.style[this.inlineProperty]=t+fr)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Cn(e)&&(this._element.style.width=e+fr),Cn(t)&&(this._element.style.height=t+fr)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Cn(e)&&(this._element.style.marginTop=e+fr),Cn(t)&&(this._element.style[`margin${un(this.inlineProperty)}`]=t+fr)}getOffset(){const e=this._element.style,t=`margin${un(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const c1=s9,o9="ht__manualColumnMove--backlight";let i9=class extends c1{build(){super.build(),J(this._element,o9)}};const r9=i9,a9="ht__manualColumnMove--guideline";let l9=class extends c1{build(){super.build(),J(this._element,a9)}};const u9=l9;de.getSingleton().register("beforeColumnMove");de.getSingleton().register("afterColumnMove");const fm="manualColumnMove",c9=120,Oo=new WeakMap,hR="ht__manualColumnMove",Ku="show-ui",gm="on-moving--columns",mm="after-selection--columns";class h9 extends tt{static get PLUGIN_KEY(){return fm}static get PLUGIN_PRIORITY(){return c9}constructor(e){super(e),Oo.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0},cachedDropIndex:void 0}),this.eventManager=new It(this),this.backlight=new r9(e),this.guideline=new u9(e)}isEnabled(){return!!this.hot.getSettings()[fm]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollVertically",()=>this.onAfterScrollVertically()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,hR),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Pe(this.hot.rootElement,hR),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const s=Oo.get(this),o=s.cachedDropIndex,i=this.isMovePossible(e,t),r=this.hot.runHooks("beforeColumnMove",e,t,o,i);if(s.cachedDropIndex=void 0,r===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,t);const a=i&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,o,i,a),a}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const s=this.countFinalIndex(e,t),o=Oo.get(this);return o.cachedDropIndex=t,this.moveColumns(e,s)}isMovePossible(e,t){const s=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>s,i=t<0,r=e.some(l=>l<0),a=e.some(l=>l>=s);return!(o||i||r||a)}isColumnOrderChanged(e,t){return e.some((s,o)=>s-o!==t)}countFinalIndex(e,t){const s=Pt(e,(o,i)=>(i<t&&(o+=1),o),0);return t-s}getColumnsWidth(e,t){const s=this.hot.columnIndexMapper;let o=0;for(let i=e;i<=t;i+=1){const r=s.getRenderableFromVisualIndex(i);i<0?o+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:r!==null&&(o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(r)||0)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[fm];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const s=[];return me(e,t,o=>{s.push(o)}),s}refreshPositions(){const e=Oo.get(this),t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(e.hoveredColumn)&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});const s=this.hot.view._wt.wtTable,o=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof o.scrollX=="number"?o.scrollX:o.scrollLeft;let r=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.hoveredColumn-1);const a=s.hider.offsetWidth,l=s.TBODY.offsetLeft,u=this.backlight.getOffset().start,c=this.backlight.getSize().width;let d=0,f=0;if(this.hot.isRtl()){const C=this.hot.rootWindow,b=ut(this.hot.rootElement),y=C.innerWidth-e.rootElementOffset-b;f=C.innerWidth-e.target.eventPageX-y-(o.scrollX===void 0?i:0)}else f=e.target.eventPageX-(e.rootElementOffset-(o.scrollX===void 0?i:0));if(e.hasRowHeaders&&(d=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(e.hoveredColumn)&&(r+=i),r+=d,e.hoveredColumn<0)e.fixedColumnsStart>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+r<=f){const C=e.hoveredColumn>=e.countCols?e.countCols-1:e.hoveredColumn;e.target.col=C+1,r+=e.target.TD.offsetWidth}else e.target.col=e.hoveredColumn;let m=f,w=r;f+c+u>=a?m=a-c-u:f+u<l+d&&(m=l+d+Math.abs(u)),r>=a-1?w=a-1:w===0?w=1:o.scrollX!==void 0&&e.hoveredColumn<e.fixedColumnsStart&&(w-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,m),this.guideline.setPosition(null,w)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,s,o){const i=this.hot.view._wt.wtTable,r=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),l=Oo.get(this),u=Ae(e.target,"sortAction");if(!a||!r||l.pressed||e.button!==0||u){l.pressed=!1,l.columnsToMove.length=0,Pe(this.hot.rootElement,[gm,Ku]);return}const c=this.guideline.isBuilt()&&!this.guideline.isAppended(),d=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&d&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:f,to:m}=a,w=Math.min(f.col,m.col),C=Math.max(f.col,m.col);if(t.row<0&&t.col>=w&&t.col<=C){o.column=!0,l.pressed=!0;const b=s.firstChild?ZE(e,s.firstChild).x:e.offsetX;l.target.eventPageX=e.pageX,l.hoveredColumn=t.col,l.target.TD=s,l.target.col=t.col,l.columnsToMove=this.prepareColumnsToMoving(w,C),l.hasRowHeaders=!!this.hot.getSettings().rowHeaders,l.countCols=this.hot.countCols(),l.fixedColumnsStart=this.hot.getSettings().fixedColumnsStart,l.rootElementOffset=Lt(this.hot.rootElement).left;const y=l.hasRowHeaders?-1:0,M=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,A=t.col<l.fixedColumnsStart,$=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),H=Math.abs(b-(this.hot.isRtl()?s.offsetWidth:0)),V=this.getColumnsWidth(w,t.col-1)+H,z=this.getColumnsWidth(y,w-1)+(A?$:0)+V;this.backlight.setPosition(M,z),this.backlight.setSize(this.getColumnsWidth(w,C),i.hider.offsetHeight-M),this.backlight.setOffset(null,-V),J(this.hot.rootElement,gm)}else Pe(this.hot.rootElement,mm),l.pressed=!1,l.columnsToMove.length=0}onMouseMove(e){const t=Oo.get(this);t.pressed&&(t.target.eventPageX=e.pageX,this.refreshPositions())}onBeforeOnCellMouseOver(e,t,s,o){const i=this.hot.getSelectedRangeLast(),r=Oo.get(this);!i||!r.pressed||(r.columnsToMove.indexOf(t.col)>-1?Pe(this.hot.rootElement,Ku):J(this.hot.rootElement,Ku),o.row=!0,o.column=!0,o.cell=!0,r.hoveredColumn=t.col,r.target.TD=s)}onMouseUp(){const e=Oo.get(this),t=e.target.col,s=e.columnsToMove.length;if(e.hoveredColumn=void 0,e.pressed=!1,e.backlightWidth=0,Pe(this.hot.rootElement,[gm,Ku,mm]),this.hot.selection.isSelectedByColumnHeader()&&J(this.hot.rootElement,mm),s<1||t===void 0)return;const o=e.columnsToMove[0],i=this.hot.toPhysicalColumn(o),r=this.dragColumns(e.columnsToMove,t);if(e.columnsToMove.length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const a=this.hot.toVisualColumn(i),l=a+s-1;this.hot.selectColumns(a,l)}}onAfterScrollVertically(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1,s=e.holder.scrollTop,o=t+s;this.backlight.setPosition(o),this.backlight.setSize(null,e.hider.offsetHeight-o)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const Xu="manualColumnResize",d9=130,dR="manualColumnWidths",pm=new WeakMap;class f9 extends tt{static get PLUGIN_KEY(){return Xu}static get PLUGIN_PRIORITY(){return d9}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new It(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.columnWidthsMap=void 0,pm.set(this,{config:void 0}),J(this.handle,"manualColumnResizer"),J(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Xu]}enablePlugin(){this.enabled||(this.columnWidthsMap=new ei,this.columnWidthsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,t)=>this.onModifyColWidth(e,t)),this.addHook("beforeStretchingColumnWidth",(e,t)=>this.onBeforeStretchingColumnWidth(e,t)),this.addHook("beforeColumnResize",(e,t,s)=>this.onBeforeColumnResize(e,t,s)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=pm.get(this);e.config=this.columnWidthsMap.getValues(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",dR,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",dR,e),e.value}setManualSize(e,t){const s=Math.max(t,20),o=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(o,s),s}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(t,null)}onMapInit(){const e=pm.get(this),t=this.hot.getSettings()[Xu],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(()=>{s.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0),e.config=t):t===!0&&Array.isArray(e.config)&&this.hot.batchExecution(()=>{e.config.forEach((o,i)=>{this.columnWidthsMap.setValueAtIndex(i,o)})},!0)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:t}=this.hot.view,s=t.wtTable.getCoords(this.currentTH),o=s.col;if(o<0)return;const i=Et(this.currentTH),r=this.currentTH.getBoundingClientRect(),a=o<t.getSetting("fixedColumnsStart");let l;a&&(l=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),l||(l=t.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,s.row,s.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o),this.selectedCols=[];const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();T(c,d=>{const f=d.getTopStartCorner().col,m=d.getBottomEndCorner().col;me(f,m,w=>{this.selectedCols.includes(w)||this.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(r.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${i}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(Et(this.handle),10),t=parseInt(this.handle.style.top,10)+e,s=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);J(this.handle,"active"),J(this.guide,"active"),this.guide.style.top=`${t}px`,this.refreshGuidePosition(),this.guide.style.height=`${s-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){Pe(this.handle,"active"),Pe(this.guide,"active")}checkIfColumnHeader(e){return!!$o(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}onMouseOver(e){if(!Hw(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const s=t.getAttribute("colspan");t&&(s===null||s==="1")&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(s,o)=>{const i=this.hot.runHooks("beforeColumnResize",this.newSize,s,!0);i!==void 0&&(this.newSize=i),this.hot.getSettings().stretchH==="all"?this.clearManualSize(s):this.setManualSize(s,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,s,!0),o&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(T(this.selectedCols,o=>{t(o)}),e()):T(this.selectedCols,o=>{t(o,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Ae(e.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=e.pageX,this.newSize=this.startWidth)}onMouseMove(e){if(this.pressed){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+t,T(this.selectedCols,s=>{this.newSize=this.setManualSize(s,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(s,o)=>{this.hot.runHooks("beforeColumnResize",this.newSize,s,!1),o&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,s,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(T(this.selectedCols,o=>{t(o)}),e()):T(this.selectedCols,o=>{t(o,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",s=>this.onMouseOver(s)),this.eventManager.addEventListener(t,"mousedown",s=>this.onMouseDown(s)),this.eventManager.addEventListener(e,"mousemove",s=>this.onMouseMove(s)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyColWidth(e,t){let s=e;if(this.enabled){const o=this.hot.toPhysicalColumn(t),i=this.columnWidthsMap.getValueAtIndex(o);this.hot.getSettings()[Xu]&&i&&(s=i)}return s}onBeforeStretchingColumnWidth(e,t){let s=this.columnWidthsMap.getValueAtIndex(t);return s===null&&(s=e),s}onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}destroy(){super.destroy()}}const wm=0,fR=1,gR=2,gr="px";let g9=class{constructor(e){this.hot=e,this._element=null,this.state=wm}appendTo(e){e.appendChild(this._element),this.state=gR}build(){this.state===wm&&(this._element=this.hot.rootDocument.createElement("div"),this.state=fR)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=wm}isAppended(){return this.state===gR}isBuilt(){return this.state>=fR}setPosition(e,t){e!==void 0&&(this._element.style.top=e+gr),t!==void 0&&(this._element.style.left=t+gr)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+gr),t&&(this._element.style.height=t+gr)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+gr),t&&(this._element.style.marginLeft=t+gr)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const h1=g9,m9="ht__manualRowMove--backlight";class p9 extends h1{build(){super.build(),J(this._element,m9)}}const w9=p9,C9="ht__manualRowMove--guideline";class S9 extends h1{build(){super.build(),J(this._element,C9)}}const v9=S9;de.getSingleton().register("beforeRowMove");de.getSingleton().register("afterRowMove");const Cm="manualRowMove",y9=140,Ao=new WeakMap,mR="ht__manualRowMove",qu="show-ui",Sm="on-moving--rows",vm="after-selection--rows";class d1 extends tt{static get PLUGIN_KEY(){return Cm}static get PLUGIN_PRIORITY(){return y9}constructor(e){super(e),Ao.set(this,{rowsToMove:[],pressed:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0},cachedDropIndex:void 0}),this.eventManager=new It(this),this.backlight=new w9(e),this.guideline=new v9(e)}isEnabled(){return!!this.hot.getSettings()[Cm]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("afterScrollHorizontally",()=>this.onAfterScrollHorizontally()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.buildPluginUI(),this.registerEvents(),J(this.hot.rootElement,mR),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Pe(this.hot.rootElement,mR),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const s=Ao.get(this),o=s.cachedDropIndex,i=this.isMovePossible(e,t),r=this.hot.runHooks("beforeRowMove",e,t,o,i);if(s.cachedDropIndex=void 0,r===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,t);const a=i&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,o,i,a),a}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const s=this.countFinalIndex(e,t),o=Ao.get(this);return o.cachedDropIndex=t,this.moveRows(e,s)}isMovePossible(e,t){const s=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),o=e.length+t>s,i=t<0,r=e.some(l=>l<0),a=e.some(l=>l>=s);return!(o||i||r||a)}isRowOrderChanged(e,t){return e.some((s,o)=>s-o!==t)}countFinalIndex(e,t){const s=Pt(e,(o,i)=>(i<t&&(o+=1),o),0);return t-s}getRowsHeight(e,t){const s=this.hot.rowIndexMapper;let o=0;for(let i=e;i<=t;i++){const r=s.getRenderableFromVisualIndex(i);r!==null&&(o+=this.hot.view._wt.wtTable.getRowHeight(r)||23)}return o}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Cm];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:s,to:o}=e,i=Math.min(s.row,o.row),r=Math.max(s.row,o.row);return me(i,r,a=>{t.push(a)}),t}refreshPositions(){const e=Ao.get(this),t=e.target.coords,s=this.hot.view.getFirstFullyVisibleRow(),o=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(t.row)&&s>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1)),this.isFixedRowBottom(t.row)&&o<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(o+1,1),void 0,!0);const r=this.hot.view._wt.wtTable,a=e.target.TD,l=this.hot.rootElement,u=Lt(l),c=Oi(l),d=r.holder.scrollTop,f=this.hot.rootWindow!==c?c.scrollTop:0,m=u.top-f,w=e.target.eventPageY-m+d,C=r.hider.offsetHeight,b=r.TBODY.offsetTop,y=this.backlight.getOffset().top,M=this.backlight.getSize().height,A=a.offsetHeight/2,$=a.offsetHeight;let H=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1);const V=w>=H+A;this.isFixedRowTop(t.row)&&(H+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?e.target.row=s>0?s-1:s:V?(e.target.row=t.row+1,H+=t.row===0?$-1:$):e.target.row=t.row;let z=w,ee=H;w+M+y>=C?z=C-M-y:w+y<b&&(z=b+Math.abs(y)),H>=C-1&&(ee=C-1),this.backlight.setPosition(z),this.guideline.setPosition(ee)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",t=>this.onMouseMove(t)),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp())}unregisterEvents(){this.eventManager.clear()}onBeforeOnCellMouseDown(e,t,s,o){const{wtTable:i,wtViewport:r}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast(),u=Ao.get(this);if(!l||!a||u.pressed||e.button!==0){u.pressed=!1,u.rowsToMove.length=0,Pe(this.hot.rootElement,[Sm,qu]);return}const c=this.guideline.isBuilt()&&!this.guideline.isAppended(),d=this.backlight.isBuilt()&&!this.backlight.isAppended();c&&d&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:f,to:m}=l,w=Math.min(f.row,m.row),C=Math.max(f.row,m.row);if(t.col<0&&t.row>=w&&t.row<=C){o.row=!0,u.pressed=!0,u.target.eventPageY=e.pageY,u.target.coords=t,u.target.TD=s,u.rowsToMove=this.prepareRowsToMoving();const b=i.holder.scrollLeft+r.getRowHeaderWidth(),y=this.getRowsHeight(w,t.row-1)+e.offsetY;this.backlight.setPosition(null,b),this.backlight.setSize(i.hider.offsetWidth-b,this.getRowsHeight(w,C)),this.backlight.setOffset(-y,null),J(this.hot.rootElement,Sm),this.refreshPositions()}else Pe(this.hot.rootElement,vm),u.pressed=!1,u.rowsToMove.length=0}onMouseMove(e){const t=Ao.get(this);t.pressed&&(t.target.eventPageY=e.pageY,this.refreshPositions())}onBeforeOnCellMouseOver(e,t,s,o){const i=this.hot.getSelectedRangeLast(),r=Ao.get(this);!i||!r.pressed||(r.rowsToMove.indexOf(t.row)>-1?Pe(this.hot.rootElement,qu):J(this.hot.rootElement,qu),o.row=!0,o.column=!0,o.cell=!0,r.target.coords=t,r.target.TD=s)}onMouseUp(){const e=Ao.get(this),t=e.target.row,s=e.rowsToMove.length;if(e.pressed=!1,e.backlightHeight=0,Pe(this.hot.rootElement,[Sm,qu,vm]),this.hot.selection.isSelectedByRowHeader()&&J(this.hot.rootElement,vm),s<1||t===void 0)return;const o=e.rowsToMove[0],i=this.hot.toPhysicalRow(o),r=this.dragRows(e.rowsToMove,t);if(e.rowsToMove.length=0,r===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const a=this.hot.toVisualRow(i),l=a+s-1;this.hot.selectRows(a,l)}}onAfterScrollHorizontally(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth(),s=e.holder.scrollLeft,o=t+s;this.backlight.setPosition(null,o),this.backlight.setSize(e.hider.offsetWidth-o)}buildPluginUI(){this.backlight.build(),this.guideline.build()}onAfterLoadData(){this.moveBySettingsOrLoad()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}const Zu="manualRowResize",b9=30,pR="manualRowHeights",ym=new WeakMap;class R9 extends tt{static get PLUGIN_KEY(){return Zu}static get PLUGIN_PRIORITY(){return b9}constructor(e){super(e);const{rootDocument:t}=this.hot;this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=t.createElement("DIV"),this.guide=t.createElement("DIV"),this.eventManager=new It(this),this.pressed=null,this.isTriggeredByRMB=!1,this.dblclick=0,this.autoresizeTimeout=null,this.rowHeightsMap=void 0,ym.set(this,{config:void 0}),J(this.handle,"manualRowResizer"),J(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Zu]}enablePlugin(){this.enabled||(this.rowHeightsMap=new ei,this.rowHeightsMap.addLocalHook("init",()=>this.onMapInit()),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,t)=>this.onModifyRowHeight(e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=ym.get(this);e.config=this.rowHeightsMap.getValues(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",pR,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",pR,e),e.value}setManualSize(e,t){const s=this.hot.toPhysicalRow(e),o=Math.max(t,vT.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(s,o),o}setupHandlePosition(e){this.currentTH=e;const{view:t}=this.hot,{_wt:s}=t,o=s.wtTable.getCoords(this.currentTH),i=o.row;if(i<0)return;const r=ut(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=i<s.getSetting("fixedRowsTop"),u=i>=t.countNotHiddenRowIndexes(0,1)-s.getSetting("fixedRowsBottom");let c;l?c=s.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col):u&&(c=s.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),c||(c=s.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,o.row,o.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.selectedRows=[];const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){const f=this.hot.getSelectedRange();T(f,m=>{const w=m.getTopStartCorner().row,C=m.getBottomStartCorner().row;me(w,C,b=>{this.selectedRows.includes(b)||this.selectedRows.push(b)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${c.start}px`,this.handle.style.width=`${r}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(ut(this.handle),10),t=parseInt(this.handle.style[this.inlineDir],10)+e,s=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);J(this.handle,"active"),J(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${t}px`,this.guide.style.width=`${s-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){Pe(this.handle,"active"),Pe(this.guide,"active")}checkIfRowHeader(e){var t;return $o(e,["TH"],this.hot.rootElement)&&((t=e.parentNode)===null||t===void 0||(t=t.parentNode)===null||t===void 0?void 0:t.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return t!==void 0&&this.newSize<t?t:this.newSize}onMouseOver(e){if(!Hw(e.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(this.pressed||this.setupHandlePosition(t))}}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(s,o)=>{const i=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(s),s,!0);i!==void 0&&(this.newSize=i),this.setManualSize(s,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(s),s,!0),o&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(T(this.selectedRows,o=>{t(o)}),e()):T(this.selectedRows,o=>{t(o,!0)})),this.dblclick=0,this.autoresizeTimeout=null}onMouseDown(e){Ae(e.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=e.pageY,this.newSize=this.startHeight)}onMouseMove(e){this.pressed&&(this.currentHeight=this.startHeight+(e.pageY-this.startY),T(this.selectedRows,t=>{this.newSize=this.setManualSize(t,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}onMouseUp(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},t=(s,o)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(s),s,!1),o&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(s),s,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(T(this.selectedRows,o=>{t(o)}),e()):T(this.selectedRows,o=>{t(o,!0)})),this.setupHandlePosition(this.currentTH))}onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",s=>this.onMouseOver(s)),this.eventManager.addEventListener(e,"mousedown",s=>this.onMouseDown(s)),this.eventManager.addEventListener(t,"mousemove",s=>this.onMouseMove(s)),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp()),this.eventManager.addEventListener(this.handle,"contextmenu",()=>this.onContextMenu())}onModifyRowHeight(e,t){let s=e;if(this.enabled){const o=this.hot.toPhysicalRow(t),i=this.rowHeightsMap.getValueAtIndex(o);this.hot.getSettings()[Zu]&&i&&(s=i)}return s}onMapInit(){const e=ym.get(this),t=this.hot.getSettings()[Zu],s=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof s<"u"?s.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)}):Array.isArray(t)?(t.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)}),e.config=t):t===!0&&Array.isArray(e.config)&&e.config.forEach((o,i)=>{this.rowHeightsMap.setValueAtIndex(i,o)})},!0)}destroy(){super.destroy()}}class E9{constructor(e,t,s,o,i,r){this.row=e,this.col=t,this.rowspan=s,this.colspan=o,this.removed=!1,this.cellCoordsFactory=i,this.cellRangeFactory=r}static NEGATIVE_VALUES_WARNING(e){return Qe`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return Qe`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return Qe`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return Qe`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,t,s){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=s||e.col+e.colspan-1>=s}normalize(e){const t=e.countRows(),s=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>s-1&&(this.col=s-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>s-1&&(this.colspan=s-this.col)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const s=e[0]||e[1],o=t+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",r=e[0]?"col":"row",a=Math.min(t,o),l=Math.max(t,o),u=this[r],c=this[r]+this[i]-1;if(u>=t&&(this[r]+=s),s>0)t<=c&&t>u&&(this[i]+=s);else if(s<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const d=l-u+1,f=Math.abs(s)-d;this[r]-=f+s,this[i]-=d}else if(u<=a&&c>=l)this[i]+=s;else if(u<=a&&c>=a&&c<l){const d=c-a+1;this[i]-=d}}return!0}isFarther(e,t){return e?t==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:t==="up"?e.row>this.row:t==="right"?e.col+e.colspan-1<this.col+this.colspan-1:t==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Es=E9;function Np(n,e,t,s){e?e.row===t&&e.col===s?(n.setAttribute("rowspan",e.rowspan.toString()),n.setAttribute("colspan",e.colspan.toString())):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="none"):(n.removeAttribute("rowspan"),n.removeAttribute("colspan"),n.style.display="")}class mS{constructor(e){this.plugin=e,this.mergedCells=[],this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return Qe`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){const s=this.mergedCells;let o=!1;return T(s,i=>i.row<=e&&i.row+i.rowspan-1>=e&&i.col<=t&&i.col+i.colspan-1>=t?(o=i,!1):!0),o}getByRange(e){const t=this.mergedCells;let s=!1;return T(t,o=>o.row<=e.from.row&&o.row+o.rowspan-1>=e.to.row&&o.col<=e.from.col&&o.col+o.colspan-1>=e.to.col?(s=o,s):!0),s}getWithinRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.mergedCells,o=[];let i=e;if(!i.includesRange){const r=this.hot._createCellCoords(i.from.row,i.from.col),a=this.hot._createCellCoords(i.to.row,i.to.col);i=this.hot._createCellRange(r,r,a)}return T(s,r=>{const a=this.hot._createCellCoords(r.row,r.col),l=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),u=this.hot._createCellRange(a,a,l);t?i.overlaps(u)&&o.push(r):i.includesRange(u)&&o.push(r)}),o.length?o:!1}add(e){const t=this.mergedCells,s=e.row,o=e.col,i=e.rowspan,r=e.colspan,a=new Es(s,o,i,r,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(s,o),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),t.push(a),a):(lt(mS.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,t){const s=this.mergedCells,o=this.get(e,t),i=o?this.mergedCells.indexOf(o):-1;return o&&i!==-1?(s.splice(i,1),o):!1}clear(){const e=this.mergedCells,t=[],s=[];T(e,o=>{const i=this.hot.getCell(o.row,o.col);i&&t.push([i,this.get(o.row,o.col),o.row,o.col])}),this.mergedCells.length=0,T(t,(o,i)=>{me(0,o.rowspan-1,r=>{me(0,o.colspan-1,a=>{if(a!==0||r!==0){const l=this.hot.getCell(o.row+r,o.col+a);l&&s.push([l,null,null,null])}})}),t[i][1]=null}),T(t,o=>{Np(...o)}),T(s,o=>{Np(...o)})}isOverlapping(e){const t=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let s=!1;return T(this.mergedCells,o=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(o.row,o.col),this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1)).overlaps(t)?(s=!0,!1):!0),s}isFirstRenderableMergedCell(e,t){const s=this.get(e,t);return s&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(s.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(s.col,1)===t}getFirstRenderableCoords(e,t){const s=this.get(e,t);if(!s||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const o=this.hot.rowIndexMapper.getNearestNotHiddenIndex(s.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s.col,1);return this.hot._createCellCoords(o,i)}shiftCollections(e,t,s){const o=[0,0];switch(e){case"right":o[0]+=s;break;case"left":o[0]-=s;break;case"down":o[1]+=s;break;case"up":o[1]-=s;break}T(this.mergedCells,i=>{i.shift(o,t)}),Yc(this.mergedCells.length-1,0,i=>{const r=this.mergedCells[i];r&&r.removed&&this.mergedCells.splice(this.mergedCells.indexOf(r),1)})}}const T9=mS;class M9{constructor(e){this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection,this.currentFillData=null}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let s=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?s="down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?s="up":t[1]===e[1]&&t[2]===e[2]?s="right":s="left",s}snapDragArea(e,t,s,o){const i=t.slice(0),r=this.getAutofillSize(e,t,s),[a,l,u,c]=e,f=["up","down"].indexOf(s)>-1?u-a+1:c-l+1,m=Math.floor(r/f)*f,w=r-m,C=this.getFarthestCollection(e,t,s,o);if(C){if(s==="down"){const b=C.row+C.rowspan-a-w;i[2]+b>=this.plugin.hot.countRows()?i[2]-=w:i[2]+=w?b:0}else if(s==="right"){const b=C.col+C.colspan-l-w;i[3]+b>=this.plugin.hot.countCols()?i[3]-=w:i[3]+=w?b:0}else if(s==="up"){const b=u-w-C.row+1;i[0]+b<0?i[0]+=w:i[0]-=w?b:0}else if(s==="left"){const b=c-w-C.col+1;i[1]+b<0?i[1]+=w:i[1]-=w?b:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:s,foundMergedCells:o,fillSize:r,dragArea:i,cycleLength:f}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),kt(this.currentFillData,e)}getAutofillSize(e,t,s){const[o,i,r,a]=e,[l,u,c,d]=t;switch(s){case"up":return o-l;case"down":return c-r;case"left":return i-u;case"right":return d-a;default:return null}}getDragArea(e,t,s){const[o,i,r,a]=e,[l,u,c,d]=t;switch(s){case"up":return[l,u,o-1,a];case"down":return[r+1,i,c,a];case"left":return[l,u,r,i-1];case"right":return[o,a+1,c,d];default:return null}}getFarthestCollection(e,t,s,o){const[i,r,a,l]=e,u=["up","down"].indexOf(s)>-1,c=u?a:l,d=u?i:r,f=this.getAutofillSize(e,t,s),m=u?a-i+1:l-r+1,w=Math.floor(f/m)*m,C=f-w;let b=null,y=null,M=null;switch(s){case"up":b="includesVertically",M=c-C+1;break;case"left":b="includesHorizontally",M=c-C+1;break;case"down":b="includesVertically",M=d+C-1;break;case"right":b="includesHorizontally",M=d+C-1;break}return T(o,A=>{A[b](M)&&A.isFarther(y,s)&&(y=A)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),s=this.currentFillData.foundMergedCells,o=this.currentFillData.dragDirection,i=(u,c)=>{switch(o){case"up":return u.row-c>=t.from.row;case"down":return u.row+u.rowspan-1+c<=t.to.row;case"left":return u.col-c>=t.from.column;case"right":return u.col+u.colspan-1+c<=t.to.column;default:return null}};let r=0,a=null,l=1;do for(let u=0;u<s.length;u+=1){if(a=s[u],r=l*this.currentFillData.cycleLength,i(a,r))switch(o){case"up":this.plugin.mergedCellsCollection.add({row:a.row-r,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+r,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-r,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+r,colspan:a.colspan});break}u===s.length-1&&(l+=1)}while(i(a,r));this.currentFillData=null,this.plugin.hot.render(),s.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},s={min:null,max:null};return T(e,o=>{const i=o[0],r=this.plugin.hot.propToCol(o[1]);(t.min===null||i<t.min)&&(t.min=i),(t.max===null||i>t.max)&&(t.max=i),(s.min===null||r<s.min)&&(s.min=r),(s.max===null||r>s.max)&&(s.max=r)}),{from:{row:t.min,column:s.min},to:{row:t.max,column:s.max}}}dragAreaOverlapsCollections(e,t,s){const o=this.getDragArea(e,t,s),[i,r,a,l]=o,u=this.plugin.hot._createCellCoords(i,r),c=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(d,!0)}}const _9=M9;class O9{constructor(e){this.plugin=e,this.hot=e.hot,this.fullySelectedMergedCellClassName="fullySelectedMergedCell"}snapDelta(e,t,s){const o=t.to,i=o.row+e.row,r=o.col+e.col;e.row?this.jumpOverMergedCell(e,s,i):e.col&&this.jumpOverMergedCell(e,s,r)}jumpOverMergedCell(e,t,s){let o=e.row||e.col,i=null,r=null,a=null;e.row?(i=t.includesVertically(s),r=t.row,a=t.getLastRow()):e.col&&(i=t.includesHorizontally(s),r=t.col,a=t.getLastColumn()),o!==0&&(o>0?i&&s!==r&&(o+=a-s+1):i&&s!==a&&(o-=s-r+1),e.row?e.row=o:e.col&&(e.col=o))}getUpdatedSelectionRange(e,t){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+t.row,e.to.col+t.col))}getSelectedMergedCellClassName(e,t,s,o){const i=Math.min(s[0],s[2]),r=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]);if(o===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const c=this.plugin.mergedCellsCollection.get(e,t);if(!c)return;const d=c.getLastRow(),f=c.getLastColumn();if(i<=c.row&&r<=c.col&&a>=d&&l>=f)return`${this.fullySelectedMergedCellClassName}-${o}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,t){const s=[];if(!t||!e)return!1;for(let o=0;o<e.rowspan;o+=1)for(let i=0;i<e.colspan;i+=1)s.push(this.hot._createCellCoords(e.row+o,e.col+i));for(let o=0;o<s.length;o+=1){const i=[];for(let r=0;r<t.length;r+=1)i[r]=t[r].includes(s[o]);if(!i.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const A9=O9;function I9(n){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const t=n.mergedCellsCollection.get(e[0],e[1]);if(t.row===e[0]&&t.col===e[1]&&t.row+t.rowspan-1===e[2]&&t.col+t.colspan-1===e[3])return this.getTranslatedPhrase(ed)}return this.getTranslatedPhrase(Jh)},callback(){n.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Es.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}de.getSingleton().register("beforeMergeCells");de.getSingleton().register("afterMergeCells");de.getSingleton().register("beforeUnmergeCells");de.getSingleton().register("afterUnmergeCells");const ka="mergeCells",x9=150,wR=new WeakMap,CR=ka;class H9 extends tt{static get PLUGIN_KEY(){return ka}static get PLUGIN_PRIORITY(){return x9}constructor(e){super(e),wR.set(this,{lastDesiredCoords:null}),this.mergedCellsCollection=null,this.autofillCalculations=null,this.selectionCalculations=null}isEnabled(){return!!this.hot.getSettings()[ka]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new T9(this),this.autofillCalculations=new _9(this),this.selectionCalculations=new A9(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterModifyTransformStart",function(){return e.onAfterModifyTransformStart(...arguments)}),this.addHook("modifyTransformEnd",function(){return e.onModifyTransformEnd(...arguments)}),this.addHook("modifyGetCellCoords",function(){return e.onModifyGetCellCoords(...arguments)}),this.addHook("beforeSetRangeStart",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeStartOnly",function(){return e.onBeforeSetRangeStart(...arguments)}),this.addHook("beforeSetRangeEnd",function(){return e.onBeforeSetRangeEnd(...arguments)}),this.addHook("afterIsMultipleSelection",function(){return e.onAfterIsMultipleSelection(...arguments)}),this.addHook("afterRenderer",function(){return e.onAfterRenderer(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.addMergeActionsToContextMenu(...arguments)}),this.addHook("afterGetCellMeta",function(){return e.onAfterGetCellMeta(...arguments)}),this.addHook("afterViewportRowCalculatorOverride",function(){return e.onAfterViewportRowCalculatorOverride(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyAutofillRange",function(){return e.onModifyAutofillRange(...arguments)}),this.addHook("afterCreateCol",function(){return e.onAfterCreateCol(...arguments)}),this.addHook("afterRemoveCol",function(){return e.onAfterRemoveCol(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("afterChange",function(){return e.onAfterChange(...arguments)}),this.addHook("beforeDrawBorders",function(){return e.onBeforeDrawAreaBorders(...arguments)}),this.addHook("afterDrawSelection",function(){return e.onAfterDrawSelection(...arguments)}),this.addHook("beforeRemoveCellClassNames",function(){return e.onBeforeRemoveCellClassNames(...arguments)}),this.addHook("beforeUndoStackChange",(t,s)=>{if(s==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[ka];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!kw())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach(s=>{const{row:o,rowspan:i}=s;for(let r=o+1;r<o+i;r++)t.push(r)}),t=[...new Set(t)],t.forEach(s=>{const o=this.hot.rowIndexMapper.getRenderableFromVisualIndex(s);this.hot.view._wt.wtOverlays.getOverlays(!0).map(i=>(i==null?void 0:i.name)==="master"?i:i.clone.wtTable).forEach(i=>{const r=i.getRow(o);r&&(r.style.background=Or(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))})}),this.hot._registerTimeout(()=>{e.forEach(s=>{s.style.background=Or(s,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let t=!0;return e?(Es.containsNegativeValues(e)?(lt(Es.NEGATIVE_VALUES_WARNING(e)),t=!1):Es.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(lt(Es.IS_OUT_OF_BOUNDS_WARNING(e)),t=!1):Es.isSingleCell(e)?(lt(Es.IS_SINGLE_CELL(e)),t=!1):Es.containsZeroSpan(e)&&(lt(Es.ZERO_SPAN_WARNING(e)),t=!1),t):!1}generateFromSettings(e){if(Array.isArray(e)){const t=[];if(T(e,s=>{if(!this.validateSetting(s))return;const o=this.hot._createCellCoords(s.row,s.col),i=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),r=this.hot._createCellRange(o,o,i);this.mergeRange(r,!0,!0),me(s.row,s.row+s.rowspan-1,a=>{me(s.col,s.col+s.colspan-1,l=>{a===s.row&&l===s.col||t.push([a,l,null])})})}),t.length===0)return;this.hot.setDataAtCell(t)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:s}=e;this.toggleMerge(e),this.hot.selectCell(t.row,t.col,s.row,s.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:s}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,s.row,s.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:s}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,s.row,s.col,!1)}mergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=e.getTopStartCorner(),i=e.getBottomEndCorner(),r={row:o.row,col:o.col,rowspan:i.row-o.row+1,colspan:i.col-o.col+1},a=[];let l=null;return this.canMergeRange(r,t)?(this.hot.runHooks("beforeMergeCells",e,t),me(0,r.rowspan-1,c=>{me(0,r.colspan-1,d=>{let f=null;a[c]||(a[c]=[]),c===0&&d===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(r.row),this.hot.toPhysicalColumn(r.col)):this.hot.setCellMeta(r.row+c,r.col+d,"hidden",!0),a[c][d]=f})}),this.hot.setCellMeta(r.row,r.col,"spanned",!0),this.mergedCellsCollection.add(r)?(s?l=[r.row,r.col,a]:this.hot.populateFromArray(r.row,r.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,r,t),l):!0):!1}unmergeRange(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.mergedCellsCollection.getWithinRange(e);s&&(this.hot.runHooks("beforeUnmergeCells",e,t),T(s,o=>{this.mergedCellsCollection.remove(o.row,o.col),me(0,o.rowspan-1,i=>{me(0,o.colspan-1,r=>{this.hot.removeCellMeta(o.row+i,o.col+r,"hidden"),this.hot.removeCellMeta(o.row+i,o.col+r,"copyable")})}),this.hot.removeCellMeta(o.row,o.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,s,o){const i=this.hot._createCellCoords(e,t),r=this.hot._createCellCoords(s,o);this.mergeRange(this.hot._createCellRange(i,i,r))}unmerge(e,t,s,o){const i=this.hot._createCellCoords(e,t),r=this.hot._createCellCoords(s,o);this.unmergeRange(this.hot._createCellRange(i,i,r))}onAfterInit(){this.generateFromSettings(this.hot.getSettings()[ka]),this.hot.render()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const s=this.hot.getSelectedRangeLast();s&&!s.isSingleHeader()&&(this.toggleMerge(s),this.hot.render())},runOnlyIf:s=>!s.altKey,group:CR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(CR)}onAfterIsMultipleSelection(e){if(e){const t=this.mergedCellsCollection.mergedCells,s=this.hot.getSelectedRangeLast();for(let o=0;o<t.length;o+=1)if(s.from.row===t[o].row&&s.from.col===t[o].col&&s.to.row===t[o].row+t[o].rowspan-1&&s.to.col===t[o].col+t[o].colspan-1)return!1}return e}onModifyTransformStart(e){const t=wR.get(this),s=this.hot.getSelectedRangeLast();let o={row:e.row,col:e.col},i=null;const r=this.hot._createCellCoords(s.highlight.row,s.highlight.col),a=this.mergedCellsCollection.get(r.row,r.col);if(t.lastDesiredCoords||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),a){const u=this.hot._createCellCoords(a.row,a.col),c=this.hot._createCellCoords(a.row+a.rowspan-1,a.col+a.colspan-1);this.hot._createCellRange(u,u,c).includes(t.lastDesiredCoords)||(t.lastDesiredCoords=this.hot._createCellCoords(null,null)),o.row=t.lastDesiredCoords.row?t.lastDesiredCoords.row-r.row:o.row,o.col=t.lastDesiredCoords.col?t.lastDesiredCoords.col-r.col:o.col,e.row>0?o.row=a.row+a.rowspan-1-r.row+e.row:e.row<0&&(o.row=r.row-a.row+e.row),e.col>0?o.col=a.col+a.colspan-1-r.col+e.col:e.col<0&&(o.col=r.col-a.col+e.col)}i=this.hot._createCellCoords(s.highlight.row+o.row,s.highlight.col+o.col);const l=this.mergedCellsCollection.get(i.row,i.col);if(l){const u=this.mergedCellsCollection.getFirstRenderableCoords(l.row,l.col);t.lastDesiredCoords=i,o={row:u.row-r.row,col:u.col-r.col}}o.row!==0&&(e.row=o.row),o.col!==0&&(e.col=o.col)}onModifyTransformEnd(e){const t=this.hot.getSelectedRangeLast(),s=Sn(e),o=this.selectionCalculations.getUpdatedSelectionRange(t,e);let i=Sn(s);const r=this.mergedCellsCollection.getWithinRange(o,!0);do i=Sn(s),this.selectionCalculations.getUpdatedSelectionRange(t,s),T(r,a=>{this.selectionCalculations.snapDelta(s,t,a)});while(s.row!==i.row||s.col!==i.col);e.row=s.row,e.col=s.col}onModifyGetCellCoords(e,t){if(e<0||t<0)return;const s=this.mergedCellsCollection.get(e,t);if(!s)return;const{row:o,col:i,colspan:r,rowspan:a}=s;return[o,i,o+a-1,i+r-1]}addMergeActionsToContextMenu(e){e.items.push({name:"---------"},I9(this))}onAfterRenderer(e,t,s){const o=this.mergedCellsCollection.get(t,s),i=De(o)?Sn(o):void 0;if(De(i)){const{rowIndexMapper:r,columnIndexMapper:a}=this.hot,{row:l,col:u,colspan:c,rowspan:d}=i,[f,m]=this.translateMergedCellToRenderable(l,d,u,c),w=r.getRenderableFromVisualIndex(t),C=a.getRenderableFromVisualIndex(s),b=f-w+1,y=m-C+1;i.row=r.getNearestNotHiddenIndex(i.row,1),i.col=a.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,b),i.colspan=Math.min(i.colspan,y)}Np(e,i,t,s)}onBeforeSetRangeStart(e){if(this.mergedCellsCollection.isFirstRenderableMergedCell(e.row,e.col)){const t=this.mergedCellsCollection.get(e.row,e.col);[e.row,e.col]=[t.row,t.col]}}onBeforeSetRangeEnd(e){const t=this.hot.getSelectedRangeLast();t.highlight=this.hot._createCellCoords(t.highlight.row,t.highlight.col),t.to=e;let s=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{s=!1;for(let o=0;o<this.mergedCellsCollection.mergedCells.length;o+=1){const r=this.mergedCellsCollection.mergedCells[o].getRange();t.expandByRange(r)&&(e.row=t.to.row,e.col=t.to.col,s=!0)}}while(s)}onAfterGetCellMeta(e,t,s){const o=this.mergedCellsCollection.get(e,t);o&&(o.row!==e||o.col!==t?s.copyable=!1:(s.rowspan=o.rowspan,s.colspan=o.colspan))}onAfterViewportRowCalculatorOverride(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}modifyViewportRowStart(e,t){const s=this.hot.rowIndexMapper,o=s.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<t;i+=1){const r=this.mergedCellsCollection.get(o,i);if(De(r)){const a=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(r.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){const s=this.hot.rowIndexMapper,o=s.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<t;i+=1){const r=this.mergedCellsCollection.get(o,i);if(De(r)){const a=r.row+r.rowspan-1,l=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,t);return}}}}onAfterViewportColumnCalculatorOverride(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}modifyViewportColumnStart(e,t){const s=this.hot.columnIndexMapper,o=s.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<t;i+=1){const r=this.mergedCellsCollection.get(i,o);if(De(r)){const a=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(r.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){const s=this.hot.columnIndexMapper,o=s.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<t;i+=1){const r=this.mergedCellsCollection.get(i,o);if(De(r)){const a=r.col+r.colspan-1,l=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,s,o){const{rowIndexMapper:i,columnIndexMapper:r}=this.hot;let a,l;t===0?a=i.getNearestNotHiddenIndex(e,1):a=i.getNearestNotHiddenIndex(e+t-1,-1),o===0?l=r.getNearestNotHiddenIndex(s,1):l=r.getNearestNotHiddenIndex(s+o-1,-1);const u=e>=0?i.getRenderableFromVisualIndex(a):e,c=s>=0?r.getRenderableFromVisualIndex(l):s;return[u,c]}onModifyAutofillRange(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const s=this.autofillCalculations.getDirection(t,e);let o=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,o,s))return o=t,o;const i=this.mergedCellsCollection.getWithinRange({from:{row:t[0],col:t[1]},to:{row:t[2],col:t[3]}});return i&&(o=this.autofillCalculations.snapDragArea(t,o,s,i)),o}onAfterCreateCol(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}onAfterRemoveCol(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}onAfterCreateRow(e,t,s){s!=="auto"&&this.mergedCellsCollection.shiftCollections("down",e,t)}onAfterRemoveRow(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}onAfterChange(e,t){t==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(e)}onBeforeDrawAreaBorders(e,t){if(t&&t==="area"){const s=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getWithinRange(s);T(o,i=>{s.getBottomEndCorner().row===i.getLastRow()&&s.getBottomEndCorner().col===i.getLastColumn()&&(e[2]=i.row,e[3]=i.col)})}}onAfterModifyTransformStart(e,t,s){if(!this.enabled)return;const o=this.mergedCellsCollection.get(e.row,e.col);if(!o)return;const i=t>0,r=t<0,a=s<0,l=s>0,u=o.row+o.rowspan-1===this.hot.countRows()-1,c=o.row===0,d=o.col+o.colspan-1===this.hot.countCols()-1,f=o.col===0;(i&&u||r&&c||l&&d||a&&f)&&(e.row=o.row,e.col=o.col)}onAfterDrawSelection(e,t,s,o){if(s)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,s,o)}onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}}function P9(n,e){return function(t,s){const[,...o]=t,[,...i]=s;return function r(a){const l=n[a],u=e[a],c=o[a],d=i[a],f=u.multiColumnSorting,w=(f.compareFunctionFactory?f.compareFunctionFactory:QM(u.type))(l,u,f)(c,d);if(w===As){const C=a+1;if(typeof e[C]<"u")return r(C)}return w}(0)}}function SR(){lt(Qe`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const f1="sort";function D9(n,e,t){const s=[];return t===!1||n.isColumnSorted(e)&&n.getNumberOfSortedColumns()>1&&s.push(`${f1}-${n.getIndexOfColumnInSortQueue(e)+1}`),s}function N9(n){const e=n.className.split(" "),t=new RegExp(`^${f1}-[0-9]{1,2}$`);return e.filter(s=>t.test(s))}const ih="multiColumnSorting",L9=170,vR="columnSorting",yR=ih;ZM(ih,P9);class g1 extends JM{static get PLUGIN_KEY(){return ih}static get PLUGIN_PRIORITY(){return L9}constructor(e){super(e),this.pluginKey=ih}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[vR]&&SR(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Jc))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:yR})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yR)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),o=1;o<t;o++)s[o-1]=arguments[o];super.updateHeaderClasses(e,...s),Pe(e,N9(e)),this.enabled!==!1&&J(e,D9(...s))}updateSortingIndicator(e,t){super.updateSortingIndicator(e,t);const s=t.querySelector(".columnSortingIndicator");if(!s||!this.hot.getSettings().ariaTags||!this.columnStatesManager.isColumnSorted(e)||this.columnStatesManager.getNumberOfSortedColumns()<=1)return;const o=this.columnStatesManager.getIndexOfColumnInSortQueue(e)+1,i=zo(`${this.hot.getTranslatedPhrase(NC)} ${o}.`);Jo(s,go()[0]),Se(s,...i)}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[vR]&&SR(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){Mp(t.row,t.col,e)!==!1&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,Jc))):this.sort(this.getColumnNextConfig(t.col)))}}const k9="multipleSelectionHandles",F9=160;class $9 extends tt{static get PLUGIN_KEY(){return k9}static get PLUGIN_PRIORITY(){return F9}constructor(e){super(e),this.dragged=[],this.eventManager=null,this.lastSetCell=null}isEnabled(){return io()}enablePlugin(){this.enabled||(this.eventManager||(this.eventManager=new It(this)),this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function s(o){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const i=e.dragged.indexOf(o);if(i===-1)return!1;i===0?e.dragged=e.dragged.slice(0,1):i===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",o=>{let i;if(Ae(o.target,"topSelectionHandle-HitArea"))return i=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},o.preventDefault(),!1;if(Ae(o.target,"bottomSelectionHandle-HitArea"))return i=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchend",o=>{if(Ae(o.target,"topSelectionHandle-HitArea"))return s.call(e,"top"),e.touchStartRange=void 0,o.preventDefault(),!1;if(Ae(o.target,"bottomSelectionHandle-HitArea"))return s.call(e,"bottom"),e.touchStartRange=void 0,o.preventDefault(),!1}),this.eventManager.addEventListener(t,"touchmove",o=>{const{rootDocument:i}=this.hot;let r,a,l,u,c,d;if(e.dragged.length===0)return;const f=i.elementFromPoint(o.touches[0].clientX,o.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(r=e.hot.getCoords(f),r.col===-1&&(r.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(r),d=e.getCurrentRangeCoords(a,r,e.touchStartRange.direction,c,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=f),o.preventDefault())})}getCurrentRangeCoords(e,t,s,o,i){const r=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(s){case"NE-SW":switch(o){case"NE-SW":case"NW-SE":i==="top"?c={start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,r.col)};break;case"SE-NW":i==="bottom"&&(c={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,r.col)});break}break;case"NW-SE":switch(o){case"NE-SW":i==="top"?c={start:t,end:l}:c.end=t;break;case"NW-SE":i==="top"?c={start:t,end:a}:c.end=t;break;case"SE-NW":i==="top"?c={start:t,end:r}:c.end=t;break;case"SW-NE":i==="top"?c={start:t,end:u}:c.end=t;break}break;case"SW-NE":switch(o){case"NW-SE":i==="bottom"?c={start:this.hot._createCellCoords(t.row,r.col),end:this.hot._createCellCoords(l.row,t.col)}:c={start:this.hot._createCellCoords(r.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":i==="top"?c={start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:c={start:this.hot._createCellCoords(t.row,r.col),end:this.hot._createCellCoords(r.row,t.col)};break;case"SE-NW":i==="bottom"?c={start:this.hot._createCellCoords(t.row,u.col),end:this.hot._createCellCoords(r.row,t.col)}:i==="top"&&(c={start:l,end:t});break}break;case"SE-NW":switch(o){case"NW-SE":case"NE-SW":case"SW-NE":i==="top"&&(c.end=t);break;case"SE-NW":i==="top"?c.end=t:c={start:t,end:r};break}break}return c}isDragged(){return this.dragged.length>0}}function Lp(){let{label:n="",colspan:e=1,origColspan:t=1,collapsible:s=!1,crossHiddenColumns:o=[],isCollapsed:i=!1,isHidden:r=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:n,colspan:e,origColspan:t,collapsible:s,isCollapsed:i,crossHiddenColumns:o,isHidden:r,isRoot:a,isPlaceholder:l}}function m1(){return{label:"",isPlaceholder:!0}}function V9(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const t=[];if(e===0)return t;T(n,o=>{const i=[];let r=0;t.push(i),T(o,a=>{const l=Lp();if(De(a)){const{label:c,colspan:d}=a;l.label=At(c),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=At(a);r+=l.origColspan;let u=!1;if(r>=e&&(l.colspan=l.origColspan-(r-e),l.origColspan=l.colspan,u=!0),i.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)i.push(m1());return!u})});const s=Math.max(...Ve(t,o=>o.length));return T(t,o=>{if(o.length<s){const i=Ve(new Array(s-o.length),()=>Lp());o.splice(o.length,0,...i)}}),t}function bm(n,e,t){W9(n,e),e.set(n,t)}function W9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ts(n,e){var t=p1(n,e,"get");return B9(n,t)}function B9(n,e){return e.get?e.get.call(n):e.value}function Oa(n,e,t){var s=p1(n,e,"set");return U9(n,s,t),t}function p1(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function U9(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const bR=["label","collapsible"];var Zs=new WeakMap,Ci=new WeakMap,Rm=new WeakMap;class Y9{constructor(){bm(this,Zs,{writable:!0,value:[]}),bm(this,Ci,{writable:!0,value:0}),bm(this,Rm,{writable:!0,value:1/0})}setColumnsLimit(e){Oa(this,Rm,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Oa(this,Zs,V9(e,ts(this,Rm))),Oa(this,Ci,ts(this,Zs).length)}getData(){return ts(this,Zs)}mergeWith(e){T(e,t=>{let{row:s,col:o,...i}=t;const r=this.getHeaderSettings(s,o);r!==null&&kt(r,i,bR)})}map(e){T(ts(this,Zs),t=>{T(t,s=>{const o=e({...s});De(o)&&kt(s,o,bR)})})}getHeaderSettings(e,t){var s;if(e>=ts(this,Ci)||e<0)return null;const o=ts(this,Zs)[e];return t>=o.length?null:(s=o[t])!==null&&s!==void 0?s:null}getHeadersSettings(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const o=[];if(e>=ts(this,Ci)||e<0)return o;const i=ts(this,Zs)[e];let r=0;for(let a=t;a<i.length;a++){const l=i[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(r+=l.colspan,o.push(l),l.colspan>1&&(a+=l.colspan-1),r===s)break;if(r>s)throw new Error("The last column settings cannot overlap the other header layers")}return o}getLayersCount(){return ts(this,Ci)}getColumnsCount(){return ts(this,Ci)>0?ts(this,Zs)[0].length:0}clear(){Oa(this,Zs,[]),Oa(this,Ci,0)}}function Em(n,e,t){return e=z9(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z9(n){var e=G9(n,"string");return typeof e=="symbol"?e:String(e)}function G9(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const w1="DF-pre-order";function C1(n,e){let t=n.call(e,this);for(let s=0;s<this.childs.length;s++){if(t===!1)return!1;t=C1.call(this.childs[s],n,e)}return t}const j9="DF-post-order";function S1(n,e){for(let t=0;t<this.childs.length;t++)if(S1.call(this.childs[t],n,e)===!1)return!1;return n.call(e,this)}const v1="BF";function K9(n,e){const t=[this];function s(){if(t.length===0)return;const o=t.shift();t.push(...o.childs),n.call(e,o)!==!1&&s()}s()}const X9=v1,RR=new Map([[w1,C1],[j9,S1],[v1,K9]]);class rh{constructor(e){Em(this,"data",{}),Em(this,"parent",null),Em(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const t=new rh({...e.data});for(let s=0;s<e.childs.length;s++)t.addChild(this.cloneTree(e.childs[s]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:X9;if(!RR.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);RR.get(t).call(this,e,this)}walkUp(e){const t=this,s=o=>{e.call(t,o)!==!1&&o.parent!==null&&s(o.parent)};s(this)}}function Tm(n,e,t){q9(n,e),e.set(n,t)}function q9(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pn(n,e){var t=y1(n,e,"get");return Z9(n,t)}function Z9(n,e){return e.get?e.get.call(n):e.value}function Q9(n,e,t){var s=y1(n,e,"set");return J9(n,s,t),t}function y1(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function J9(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var mr=new WeakMap,Si=new WeakMap,pr=new WeakMap;class e5{constructor(e){Tm(this,mr,{writable:!0,value:new Map}),Tm(this,Si,{writable:!0,value:new Map}),Tm(this,pr,{writable:!0,value:null}),Q9(this,pr,e)}getRoots(){return Array.from(pn(this,mr).values())}getRootByColumn(e){let t;return pn(this,Si).has(e)&&(t=pn(this,mr).get(pn(this,Si).get(e))),t}getNode(e,t){const s=this.getRootByColumn(t);if(!s)return;const o=t-pn(this,Si).get(t);let i=0,r;return s.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(o>=i&&o<=i+l-1)return r=a,r.data.isRoot=t===r.data.columnIndex,!1;i+=l}}),r}rebuildTreeIndex(){let e=0;pn(this,Si).clear(),T(pn(this,mr),t=>{let[,{data:{colspan:s}}]=t;for(let o=e;o<e+s;o++)pn(this,Si).set(o,e);e+=s})}buildTree(){this.clear();const e=pn(this,pr).getColumnsCount();let t=0;for(;t<e;){const s=pn(this,pr).getHeaderSettings(0,t),o=new rh;pn(this,mr).set(t,o),this.buildLeaves(o,t,0,s.origColspan),t+=s.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,s){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const i=pn(this,pr).getHeadersSettings(s,t,o);s+=1,T(i,r=>{const a={...r,headerLevel:s-1,columnIndex:t};let l;s===1?(e.data=a,l=e):(l=new rh(a),e.addChild(l)),s<pn(this,pr).getLayersCount()&&this.buildLeaves(l,t,s,r.origColspan),t+=r.origColspan})}clear(){pn(this,mr).clear(),pn(this,Si).clear()}}function b1(n,e){n.walkDown(t=>{let{data:s,childs:o}=t;if(!s.isHidden&&(e(s.columnIndex),o.length===0))for(let i=1;i<s.colspan;i++)e(s.columnIndex+i)})}function ah(n,e){let{childs:t}=n;if(t.length!==0)return t[0].data[e]}function lh(n){return ah(n,"origColspan")===n.data.origColspan}function pS(n){const{data:e,childs:t}=n;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(lh(n))return pS(t[0]);e.isCollapsed=!1;const o=t.slice(1),i=new Set;let r=0;if(o.length>0)T(o,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;r+=l.colspan,b1(a,u=>{i.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;r=l-a;for(let c=1;c<l;c++)i.add(u+c)}return n.walkUp(a=>{const{data:l}=a;l.colspan+=r,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):lh(a)&&(l.isCollapsed=ah(a,"isCollapsed"))}),{rollbackModification:()=>wS(n),affectedColumns:Array.from(i),colspanCompensation:r}}function wS(n){var e;const{data:t,childs:s}=n;if(t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(lh(n))return wS(s[0]);t.isCollapsed=!0;const i=s.slice(1),r=new Set;if(i.length>0)T(i,l=>{b1(l,u=>{r.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=t;for(let c=1;c<l;c++){const d=u+c;r.add(d)}}const a=t.colspan-((e=ah(n,"colspan"))!==null&&e!==void 0?e:1);return n.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):lh(l)&&(u.isCollapsed=ah(l,"isCollapsed"))}),{rollbackModification:()=>pS(n),affectedColumns:Array.from(r),colspanCompensation:a}}function t5(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Qe`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(t.includes(e))return;let s=!1;n.walkUp(o=>{const{data:{collapsible:i}}=o;if(i)return s=!0,!1}),!s&&n.walkUp(o=>{const{data:i}=o;i.crossHiddenColumns.push(e),i.colspan>1?i.colspan-=1:i.isHidden=!0})}function n5(n,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(n.childs.length>0)throw new Error(Qe`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:t}=n.data;if(!t.includes(e))return;let s=!1;n.walkUp(o=>{const{data:{collapsible:i}}=o;if(i)return s=!0,!1}),!s&&n.walkUp(o=>{const{data:i}=o;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(e),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}const ER=new Map([["collapse",wS],["expand",pS],["hide-column",t5],["show-column",n5]]);function s5(n,e,t){if(!ER.has(n))throw new Error(`The node modifier action ("${n}") does not exist.`);return ER.get(n)(e,t)}function Qu(n){const e=[];return T(n,t=>{t.walkDown(s=>{const o=s.data,{origColspan:i,columnIndex:r,headerLevel:a,crossHiddenColumns:l}=o,u=i5(e,a);let c=!1;for(let d=r;d<r+i;d++)if(l.includes(d)||c)u.push(m1());else{const m=o5(o);m.isRoot=!0,u.push(m),c=!0}})}),e}function o5(n){const{crossHiddenColumns:e,...t}=Lp(n);return t}function i5(n,e){let t;return Array.isArray(n[e])?t=n[e]:(t=[],n[e]=t),t}function Mm(n,e,t){r5(n,e),e.set(n,t)}function r5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aa(n,e,t){var s=R1(n,e,"set");return a5(n,s,t),t}function a5(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Mt(n,e){var t=R1(n,e,"get");return l5(n,t)}function R1(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function l5(n,e){return e.get?e.get.call(n):e.value}var bs=new WeakMap,En=new WeakMap,vi=new WeakMap;class u5{constructor(){Mm(this,bs,{writable:!0,value:new Y9}),Mm(this,En,{writable:!0,value:new e5(Mt(this,bs))}),Mm(this,vi,{writable:!0,value:[[]]})}setState(e){Mt(this,bs).setData(e);let t=!1;try{Mt(this,En).buildTree()}catch{Mt(this,En).clear(),Mt(this,bs).clear(),t=!0}return Aa(this,vi,Qu(Mt(this,En).getRoots())),t}setColumnsLimit(e){Mt(this,bs).setColumnsLimit(e)}mergeStateWith(e){const t=Ve(e,s=>{let{row:o,...i}=s;return{row:o<0?this.rowCoordsToLevel(o):o,...i}});Mt(this,bs).mergeWith(t),Mt(this,En).buildTree(),Aa(this,vi,Qu(Mt(this,En).getRoots()))}mapState(e){Mt(this,bs).map(e),Mt(this,En).buildTree(),Aa(this,vi,Qu(Mt(this,En).getRoots()))}mapNodes(e){return Pt(Mt(this,En).getRoots(),(t,s)=>(s.walkDown(o=>{const i=e(o.data);i!==void 0&&t.push(i)}),t),[])}triggerNodeModification(e,t,s){t<0&&(t=this.rowCoordsToLevel(t));const o=Mt(this,En).getNode(t,s);let i;return o&&(i=s5(e,o,s),Aa(this,vi,Qu(Mt(this,En).getRoots()))),i}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var s,o;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(s=(o=Mt(this,vi)[e])===null||o===void 0?void 0:o[t])!==null&&s!==void 0?s:null}getHeaderTreeNodeData(e,t){const s=this.getHeaderTreeNode(e,t);return s?{...s.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const s=Mt(this,En).getNode(e,t);return s||null}findTopMostEntireHeaderLevel(e){var t;let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const o=s-e+1;let i=!1,r=null;for(let a=e;a<=s;a++){const l=Mt(this,En).getRootByColumn(a);if(!l)break;i=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:d,origColspan:f,isHidden:m}=u.data;m||f<=o&&c>=e&&c+f-1<=s&&(r===null||d<r)&&(r=d)},w1)}return i&&r===null?-1:this.levelToRowCoords((t=r)!==null&&t!==void 0?t:0)}findLeftMostColumnIndex(e,t){var s;const{isRoot:o}=(s=this.getHeaderSettings(e,t))!==null&&s!==void 0?s:{isRoot:!0};if(o)return t;let i=t-1;for(;i>=0;){var r;const{isRoot:a}=(r=this.getHeaderSettings(e,i))!==null&&r!==void 0?r:{isRoot:!0};if(a)break;i-=1}return i}findRightMostColumnIndex(e,t){var s;const{isRoot:o,origColspan:i}=(s=this.getHeaderSettings(e,t))!==null&&s!==void 0?s:{isRoot:!0,origColspan:1};if(o)return t+i-1;let r=t+1;for(;r<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,r))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;r+=1}return r-1}getLayersCount(){return Mt(this,bs).getLayersCount()}getColumnsCount(){return Mt(this,bs).getColumnsCount()}clear(){Aa(this,vi,[]),Mt(this,bs).clear(),Mt(this,En).clear()}}function Ia(n,e,t){return e=c5(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function c5(n){var e=h5(n,"string");return typeof e=="symbol"?e:String(e)}function h5(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class d5{constructor(e,t){Ia(this,"hot",void 0),Ia(this,"nestedHeaderSettingsGetter",void 0),Ia(this,"layersCount",0),Ia(this,"container",void 0),Ia(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let s=0;s<t;s++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s),i=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(i,e[s].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:s}=this.hot,o=t.createDocumentFragment(),i=t.createElement("table"),r=!!this.hot.getSettings().dropdownMenu,a=s.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=t.createElement("tr");for(let c=0;c<a;c++){let d=s.getVisualFromRenderableIndex(c);d===null&&(d=c);const f=t.createElement("th"),m=this.nestedHeaderSettingsGetter(l,d);if(m&&(!m.isPlaceholder||m.isHidden)){let w=m.label;r&&(w+='<button class="changeType"></button>'),Fi(f,w),f.colSpan=m.colspan,u.appendChild(f)}}i.appendChild(u)}o.appendChild(i),e.appendChild(o)}clear(){this.widthsMap.clear(),this.container=null}}const f5=d5;function TR(n,e,t){return e=g5(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function g5(n){var e=m5(n,"string");return typeof e=="symbol"?e:String(e)}function m5(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ju(n,e,t){p5(n,e),e.set(n,t)}function p5(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yi(n,e,t){var s=E1(n,e,"set");return w5(n,s,t),t}function w5(n,e,t){if(e.set)e.set.call(n,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function Ze(n,e){var t=E1(n,e,"get");return C5(n,t)}function E1(n,e,t){if(!e.has(n))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(n)}function C5(n,e){return e.get?e.get.call(n):e.value}const MR="nestedHeaders",S5=280;var at=new WeakMap,Io=new WeakMap,xa=new WeakMap,ec=new WeakMap;class v5 extends tt{constructor(){super(...arguments),Ju(this,at,{writable:!0,value:new u5}),Ju(this,Io,{writable:!0,value:null}),Ju(this,xa,{writable:!0,value:null}),Ju(this,ec,{writable:!0,value:!1}),TR(this,"ghostTable",new f5(this.hot,(e,t)=>this.getHeaderSettings(e,t))),TR(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return MR}static get PLUGIN_PRIORITY(){return S5}isEnabled(){return!!this.hot.getSettings()[MR]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();(!Array.isArray(t)||!Array.isArray(t[0]))&&lt(Qe`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>this.onInit()),this.addHook("afterLoadData",function(){return e.onAfterLoadData(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("afterOnCellMouseDown",function(){return e.onAfterOnCellMouseDown(...arguments)}),this.addHook("beforeOnCellMouseOver",function(){return e.onBeforeOnCellMouseOver(...arguments)}),this.addHook("beforeOnCellMouseUp",function(){return e.onBeforeOnCellMouseUp(...arguments)}),this.addHook("beforeSelectionHighlightSet",function(){return e.onBeforeSelectionHighlightSet(...arguments)}),this.addHook("modifyTransformStart",function(){return e.onModifyTransformStart(...arguments)}),this.addHook("afterSelection",()=>this.updateFocusHighlightPosition()),this.addHook("beforeViewportScrollHorizontally",function(){return e.onBeforeViewportScrollHorizontally(...arguments)}),this.addHook("afterGetColumnHeaderRenderers",s=>this.onAfterGetColumnHeaderRenderers(s)),this.addHook("modifyColWidth",function(){return e.onModifyColWidth(...arguments)}),this.addHook("modifyColumnHeaderValue",function(){return e.onModifyColumnHeaderValue(...arguments)}),this.addHook("beforeHighlightingColumnHeader",function(){return e.onBeforeHighlightingColumnHeader(...arguments)}),this.addHook("beforeCopy",function(){return e.onBeforeCopy(...arguments)}),this.addHook("beforeSelectColumns",function(){return e.onBeforeSelectColumns(...arguments)}),this.addHook("afterViewportColumnCalculatorOverride",function(){return e.onAfterViewportColumnCalculatorOverride(...arguments)}),this.addHook("modifyFocusedElement",function(){return e.onModifyFocusedElement(...arguments)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>this.updateFocusHighlightPosition()),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>this.updateFocusHighlightPosition()),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ze(this,at).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ze(this,at).setState(e)),this.detectedOverlappedHeaders&&lt(Qe`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,s)=>{const o=t===!0?"hide-column":"show-column";Ze(this,at).triggerColumnModification(o,s)}),!Ze(this,Io)&&this.enabled&&yi(this,Io,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(s=>{let{op:o,index:i,newValue:r}=s;if(o==="replace"){const a=r===!0?"hide-column":"show-column";Ze(this,at).triggerColumnModification(a,i)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Ze(this,at).clear(),Ze(this,Io).unsubscribe(),yi(this,Io,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ze(this,at)}getLayersCount(){return Ze(this,at).getLayersCount()}getHeaderSettings(e,t){return Ze(this,at).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,s=e.wtTable.THEAD,o=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let r=0;r<t;r++){const a=s.childNodes[r];if(!a)break;const l=o.childNodes[r],u=i?i.childNodes[r]:null;for(let c=0,d=a.childNodes.length;c<d;c++)a.childNodes[c].removeAttribute("colspan"),Pe(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Pe(l.childNodes[c],"hiddenHeader")),i&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Pe(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const s=this.hot.view._wt.getSetting("fixedColumnsStart");return(o,i)=>{var r;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(o);u===null&&(u=o),i.removeAttribute("colspan"),Pe(i,"hiddenHeader");const{colspan:c,isHidden:d,isPlaceholder:f}=(r=Ze(this,at).getHeaderSettings(e,u))!==null&&r!==void 0?r:{label:""};if(f||d)J(i,"hiddenHeader");else if(c>1){var m,w;const{wtOverlays:C}=l._wt,b=(m=C.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(i),y=(w=C.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(i),M=b||y?Math.min(c,s-o):c;M>1&&i.setAttribute("colspan",M)}this.hot.view.appendColHeader(u,i,function(){return t.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,t){var s;const{isHidden:o,isPlaceholder:i}=(s=Ze(this,at).getHeaderSettings(t,e))!==null&&s!==void 0?s:{};return i||o?"":this.hot.getColHeader(e,t)}updateFocusHighlightPosition(){var e;const t=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeLast();if(!t)return;const{highlight:s}=t;if(s.isHeader()&&s.col>=0){const i=Ze(this,at).findLeftMostColumnIndex(s.row,s.col),r=this.hot.selection.highlight.getFocus();r.visualCellRange.highlight.col=i,r.visualCellRange.from.col=i,r.visualCellRange.to.col=i,r.commit()}}onBeforeViewportScrollHorizontally(e){const t=this.hot.getSelectedRangeLast();if(!t)return e;const{highlight:s}=t;if(!(s.isHeader()&&s.col>=0))return e;const i=this.hot.view.getFirstFullyVisibleColumn(),r=this.hot.view.getLastFullyVisibleColumn(),a=Ze(this,at).findLeftMostColumnIndex(s.row,s.col),l=Ze(this,at).findRightMostColumnIndex(s.row,s.col);return a<i&&l>r?e:a<i?a:l}onBeforeHighlightingColumnHeader(e,t,s){const o=Ze(this,at).getHeaderTreeNodeData(t,e);if(!o)return e;const{columnCursor:i,selectionType:r,selectionWidth:a}=s,{isRoot:l,colspan:u}=Ze(this,at).getHeaderSettings(t,e);if(r===uC){if(!l)return o.columnIndex}else if(r===NT&&(u>a-i||!l))return null;return e}onBeforeCopy(e){const t=e.getRanges();for(let i=0;i<t.length;i+=1){const{startRow:r,startCol:a,endRow:l,endCol:u}=t[i],c=a-u+1;if(r>=0||c===1)break;for(let d=a;d<=u;d+=1)for(let f=r;f<=l;f+=1){var s,o;const m=d-a;if(m===0)continue;const w=(s=Ze(this,at).getHeaderTreeNodeData(f,d))===null||s===void 0?void 0:s.isRoot;((o=Ze(this,at).getHeaderTreeNodeData(f,d))===null||o===void 0?void 0:o.collapsible)===!0&&w===!1&&e.setCellAt(f,m,"")}}}onBeforeOnCellMouseDown(e,t,s,o){this._getHeaderTreeNodeDataByCoords(t)&&(o.column=!0)}onAfterOnCellMouseDown(e,t){const s=this._getHeaderTreeNodeDataByCoords(t);if(!s)return;yi(this,xa,t.clone()),yi(this,ec,!0);const{selection:o}=this.hot,i=o.isSelected()?o.getSelectedRange().current():null,r=[],{columnIndex:a,origColspan:l}=s,u=!o.inInSelection(t);e.shiftKey&&i?t.col<i.from.col?r.push(i.getTopEndCorner().col,a,t.row):t.col>i.from.col?r.push(i.getTopStartCorner().col,a+l-1,t.row):r.push(a,a+l-1,t.row):(xh(e)||Ko(e)&&u)&&r.push(a,a+l-1,t.row),o.selectColumns(...r)}onBeforeOnCellMouseOver(e,t,s,o){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;const{columnIndex:r,origColspan:a}=i,l=this.hot.getSelectedRangeLast(),u=l.getTopStartCorner(),c=l.getBottomEndCorner(),{from:d}=l;o.column=!0,o.cell=!0;const f=[],m=An(t.row,-1/0,-1);t.col<d.col?f.push(c.col,r,m):t.col>d.col?f.push(u.col,r+a-1,m):f.push(r,r+a-1,m),this.hot.selection.selectColumns(...f)}onBeforeOnCellMouseUp(){yi(this,ec,!1)}onBeforeSelectionHighlightSet(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ze(this,ec)||!e)return;const t=this.hot.getSelectedRangeLast(),s=t.getTopStartCorner().col,o=t.getBottomEndCorner().col,{columnIndex:i,origColspan:r}=Ze(this,at).getHeaderTreeNodeData(Ze(this,xa).row,Ze(this,xa).col);if(t.setHighlight(Ze(this,xa)),r>t.getWidth()||i<s||i+r-1>o){const a=Ze(this,at).findTopMostEntireHeaderLevel(An(s,i,i+r-1),An(o,i,i+r-1));t.highlight.row=a,t.highlight.col=t.from.col}}onModifyTransformStart(e){const{highlight:t}=this.hot.getSelectedRangeLast(),s=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(s.isHeader()&&s.col>=0))return;const i=Ze(this,at).findLeftMostColumnIndex(s.row,s.col),r=Ze(this,at).findRightMostColumnIndex(s.row,s.col);if(e.col<0){const a=t.col>=i&&t.col<=r?i-1:r,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,-1);l===null?e.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,t.col)-1,1)}else if(e.col>0){const a=t.col>=i&&t.col<=r?r+1:i,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,1);l===null?e.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):e.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,l)-1,1)}}onBeforeSelectColumns(e,t){const s=e.row,o=this._getHeaderTreeNodeDataByCoords({row:s,col:e.col}),i=this._getHeaderTreeNodeDataByCoords({row:s,col:t.col});t.col<e.col?(o&&(e.col=o.columnIndex+o.origColspan-1),i&&(t.col=i.columnIndex)):t.col>=e.col&&(o&&(e.col=o.columnIndex),i&&(t.col=i.columnIndex+i.origColspan-1))}onAfterGetColumnHeaderRenderers(e){e.length=0;for(let t=0;t<Ze(this,at).getLayersCount();t++)e.push(this.headerRendererFactory(t))}onAfterViewportColumnCalculatorOverride(e){const t=Ze(this,at).getLayersCount();let s=e.startColumn,o=!!t;for(let i=0;i<t;i++){const r=Ze(this,at).findLeftMostColumnIndex(i,e.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(r);if(r>=0&&(o=!1),Cn(a)&&a<e.startColumn){s=a;break}}e.startColumn=o?Ze(this,at).getHeaderTreeNodeData(0,s).columnIndex:s}onModifyColWidth(e,t){const s=this.ghostTable.getWidth(t);return e>s?e:s}onModifyColumnHeaderValue(e,t,s){var o;const{label:i}=(o=Ze(this,at).getHeaderTreeNodeData(s,t))!==null&&o!==void 0?o:{label:""};return i}onModifyFocusedElement(e,t){if(e<0)return this.hot.getCell(e,Ze(this,at).findLeftMostColumnIndex(e,t),!0)}onInit(){this.updatePlugin()}onAfterLoadData(e,t){t||this.updatePlugin()}destroy(){yi(this,at,null),Ze(this,Io)!==null&&(Ze(this,Io).unsubscribe(),yi(this,Io,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ze(this,at).getHeaderTreeNodeData(e.row,e.col)}}class y5{constructor(e,t){this.hot=t,this.data=null,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},me(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,s){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:s,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&T(e.__children,o=>{this.cacheNode(o,t+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,t,s,o){let i=!1,r=t;if(isNaN(r)&&r.end)return r;let a=e;return a||(a={__children:this.data},i=!0,r-=1),s!=null&&r===s?{result:a,end:!0}:o!=null&&a===o?{result:r,end:!0}:(r+=1,a.__children&&T(a.__children,l=>{if(this.parentReference.set(l,i?null:a),r=this.readTreeNodes(l,r,s,o),isNaN(r)&&r.end)return!1}),r)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return We(this.data[0],(t,s)=>{e[s]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;isNaN(e)?t=e:t=this.getDataObject(e);const s=this.getRowParent(e);return s==null?this.data.indexOf(t):s.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,s=e;return isNaN(s)||(s=this.getDataObject(s)),!s||!s.__children?0:(T(s.__children,o=>{t+=1,o.__children&&(t+=this.countChildren(o))}),t)}getRowParent(e){let t;return isNaN(e)?t=e:t=this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let t=null;return isNaN(e)?t=e:t=this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,t){var s;return((s=e.__children)===null||s===void 0?void 0:s[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let s=e;return isNaN(s)||(s=this.getDataObject(s)),s&&!!s.__children&&((t=s.__children)===null||t===void 0?void 0:t.length)!==0}addChild(e,t){let s=t;this.hot.runHooks("beforeAddChild",e,s);let o=null;e&&(o=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",o+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),s||(s=this.mockNode()),i.__children.push(s),this.rewriteCache();const r=this.getRowIndex(s);this.hot.rowIndexMapper.insertIndexes(r,1),this.hot.runHooks("afterCreateRow",r,1),this.hot.runHooks("afterAddChild",e,s)}addChildAtIndex(e,t,s){let o=s,i;if(o||(o=this.mockNode()),this.hot.runHooks("beforeAddChild",e,o,t),e){const a=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(t,null,o),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),i=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),i=this.getRowIndex(this.data[t]);o=this.getDataObject(i),this.hot.runHooks("afterAddChild",e,o,t)}addSibling(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const s=this.translateTrimmedRow(e),o=this.getRowParent(s),i=this.getRowIndexWithinParent(s);switch(t){case"below":this.addChildAtIndex(o,i+1,null);break;case"above":this.addChildAtIndex(o,i,null);break}}detachFromParent(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=null;const o=[];Array.isArray(e)?(me(e[0],e[2],f=>{const m=this.translateTrimmedRow(f);o.push(this.getDataObject(m))}),me(0,o.length-2,f=>{this.detachFromParent(o[f],!1)}),s=o[o.length-1]):s=e;const i=this.getRowIndex(s),r=this.countChildren(s),a=this.getRowIndexWithinParent(s),l=this.getRowParent(s),u=this.getRowParent(l),c=this.getRowIndex(u);let d=null;if(this.hot.runHooks("beforeDetachChild",l,s),a!=null){const f=Array.from(new Array(i+r+1).keys()).splice(-1*(r+1));if(this.hot.runHooks("beforeRemoveRow",i,r+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,r+1,f,this.plugin.pluginName),u){d=c+this.countChildren(u);const m=this.getChild(u,this.countChildren(u)-1),w=this.getRowIndex(m);this.hot.runHooks("beforeCreateRow",w+1,r+1,this.plugin.pluginName),u.__children.push(s)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,r+1,this.plugin.pluginName),this.data.push(s)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,r+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,s,this.getRowIndex(s)),t&&this.hot.render()}filterData(e,t,s){const o=[];T(s,i=>{o.push(this.getDataObject(i))}),T(o,i=>{const r=this.getRowIndexWithinParent(i),a=this.getRowParent(i);a===null?this.data.splice(r,1):a.__children.splice(r,1)}),this.rewriteCache()}spliceData(e,t,s){const o=this.getDataObject(e-1);let i=null,r=e;o&&o.__children&&o.__children.length===0?(i=o,r=0):e<this.countAllRows()&&(i=this.getRowParent(e),r=this.getRowIndexWithinParent(e)),i?s?i.__children.splice(r,t,...s):i.__children.splice(r,t):s?this.data.splice(r,t,...s):this.data.splice(r,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,s=null;do s=this.getRowParent(s),s!==null&&(t=s);while(s!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,s,o){const i=t===this.hot.countRows(),r=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=r.__children.slice(a,a+1),u=e>t;let c=i?this.getRowParent(t-1):this.getRowParent(t);c==null&&(c=this.getRowParent(t-1)),c==null&&(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const d=i||s||o?c.__children.length:this.getRowIndexWithinParent(t),f=r===c;c.__children.splice(d,0,l[0]),r.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(r),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const b5=y5;class R5{constructor(e,t){this.hot=t,this.plugin=e}}const CS=R5;class to extends CS{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const s=this.hot.toPhysicalRow(e),o=this.dataManager.getRowLevel(s),i=this.dataManager.getDataObject(s),r=t.getElementsByTagName("DIV")[0],a=r.querySelector("span.rowHeader"),l=r.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(T(l,c=>{c&&r.removeChild(c)}),J(t,to.CSS_CLASSES.indicatorContainer),o){const{rootDocument:c}=this.hot,d=a.cloneNode(!0);r.innerHTML="",me(0,o-1,()=>{const f=c.createElement("SPAN");J(f,to.CSS_CLASSES.emptyIndicator),r.appendChild(f)}),r.appendChild(d)}if(this.dataManager.hasChildren(i)){const c=this.hot.rootDocument.createElement("DIV");u&&Se(c,[go()]),J(t,to.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(s)?(J(c,`${to.CSS_CLASSES.button} ${to.CSS_CLASSES.expandButton}`),u&&Se(t,[jt(!1),nl(this.hot.getTranslatedPhrase($C))])):(J(c,`${to.CSS_CLASSES.button} ${to.CSS_CLASSES.collapseButton}`),u&&Se(t,[jt(!0),nl(this.hot.getTranslatedPhrase(VC))])),r.appendChild(c)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}const T1=to;class E5 extends CS{constructor(e,t){var s;super(e,t),s=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;s.lastCollapsedRows=s.collapsedRows.slice(0),s.expandMultipleChildren(s.lastCollapsedRows,o)},shiftStash:function(o,i){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;i==null&&(i=1/0),T(s.lastCollapsedRows,(a,l)=>{a>=o&&a<i&&(s.lastCollapsedRows[l]=a+r)})},applyStash:function(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;s.collapseMultipleChildren(s.lastCollapsedRows,o),s.lastCollapsedRows=void 0},trimStash:(o,i)=>{me(o,o+i-1,r=>{const a=this.lastCollapsedRows.indexOf(r);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let i=null,r=null,a=null;return isNaN(e)?(i=e,r=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),r=e),this.dataManager.hasChildren(i)&&T(i.__children,l=>{o.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(o,!0,!1),s&&this.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(r)===-1&&this.collapsedRows.push(r),a}collapseMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];T(e,i=>{o.push(...this.collapseChildren(i,!1,!1))}),s&&this.trimRows(o),t&&this.renderAndAdjust()}collapseRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],t)}collapseRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return T(e,i=>{o.push(i),t&&this.collapseChildRows(i,o)}),s&&this.trimRows(o),o}collapseChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);T(o.__children,i=>{const r=this.dataManager.getRowIndex(i);t.push(r),this.collapseChildRows(r,t)})}s&&this.trimRows(t)}expandRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],t)}expandRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const o=[];return T(e,i=>{o.push(i),t&&this.expandChildRows(i,o)}),s&&this.untrimRows(o),o}expandChildRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const o=this.dataManager.getDataObject(e);T(o.__children,i=>{if(!this.isAnyParentCollapsed(i)){const r=this.dataManager.getRowIndex(i);t.push(r),this.expandChildRows(r,t)}})}s&&this.untrimRows(t)}expandChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];let i=null,r=null,a=null;return isNaN(e)?(i=e,r=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),r=e),this.collapsedRows.splice(this.collapsedRows.indexOf(r),1),this.dataManager.hasChildren(i)&&T(i.__children,l=>{const u=this.dataManager.getRowIndex(l);o.push(u)}),a=this.expandRows(o,!0,!1),s&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const o=[];T(e,i=>{o.push(...this.expandChildren(i,!1,!1))}),s&&this.untrimRows(o),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];T(e,s=>{this.dataManager.hasChildren(s)&&t.push(s)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];T(e,s=>{this.dataManager.hasChildren(s)&&t.push(s)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{T(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{T(e,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),s=!0;return t===null&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&T(t.__children,o=>{const i=this.dataManager.getRowIndex(o);if(!this.plugin.collapsedRowsMap.getValueAtIndex(i))return s=!1,!1}),s}isAnyParentCollapsed(e){let t=e;for(;t!==null;){t=this.dataManager.getRowParent(t);const s=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(s)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const s=this.translateTrimmedRow(t.row);Ae(e.target,T1.CSS_CLASSES.button)&&(this.areChildrenCollapsed(s)?this.expandChildren(s):this.collapseChildren(s),Xn(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const T5=E5,_R=new WeakMap;class M5 extends CS{constructor(e,t){super(e,t),_R.set(this,{row_above:(s,o)=>{const i=o[o.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(s,o)=>{const i=o[o.length-1];this.dataManager.addSibling(i.start.row,"below")}}),this.dataManager=this.plugin.dataManager}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase(Sd)},callback:()=>{const s=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),o=this.dataManager.getDataObject(s);this.dataManager.addChild(o)},disabled:()=>{const s=this.hot.getSelectedLast();return!s||s[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(vd)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const s=this.hot.getSelectedLast(),o=this.dataManager.translateTrimmedRow(s[0]);return!this.dataManager.getRowParent(o)||!s||s[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return me(0,e.items.length-1,s=>{if(s===0)return T(t,(o,i)=>{e.items.splice(s+i,0,o)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){const t=_R.get(this);return me(0,e.items.length-1,s=>{const o=t[e.items[s].key];o!=null&&(e.items[s].callback=o)}),e}}const _5=M5;class O5{constructor(e){this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,s,o){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:s,movePossible:o}))return!1;this.movedToCollapsed=!1;const r=s===this.hot.countRows(),a=r?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(s);let l=!0;const u=e.map(w=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(C,a),C}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const d=this.getBaseParent(u),f=this.getTargetParent(r,a),m=d===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,m),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,s,o,o&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,s),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:s,dropIndex:o,movePossible:i}=e;let r=!1;return ft(o)&&(lt(Qe`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,s,o,i,!1),r=!0),r}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||t===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let s=this.dataManager.getRowParent(e?t-1:t);return s==null&&(s=this.dataManager.getRowParent(t-1)),s}shiftCollapsibleParentsLocations(e,t,s){s||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,s){const o=t===this.dataManager.getRowIndex(s)+this.dataManager.countChildren(s)+1;this.hot.batchRender(()=>{e.forEach(i=>{this.dataManager.moveRow(i,t,this.movedToCollapsed,o)})})}moveCellsMeta(e,t){const s=[],o=Math.max(...e)<t;e.forEach(i=>{s.push(this.hot.getCellMetaAtRow(i))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(o?s.length:0),0,...s)}selectCells(e,t){const s=e.length;let o=0,i=0,r=null,a=null;if(this.movedToCollapsed){let l=null;e[s-1]<t?l=this.dataManager.translateTrimmedRow(t-s):l=this.dataManager.translateTrimmedRow(t);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);o=this.dataManager.untranslateTrimmedRow(c),i=o}else e[s-1]<t?(i=t-1,o=i-s+1):(o=t,i=o+s-1);r=this.hot.selection,a=this.hot.countCols()-1,r.setRangeStart(this.hot._createCellCoords(o,0)),r.setRangeEnd(this.hot._createCellCoords(i,a),!0)}isRowOrderChanged(e,t){return e.some((s,o)=>s-o!==t)}}const Tc="nestedRows",A5=300,OR=Tc,Qs=new WeakMap,I5="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";class x5 extends tt{static get PLUGIN_KEY(){return Tc}static get PLUGIN_PRIORITY(){return A5}constructor(e){super(e),this.dataManager=null,this.headersUI=null,this.collapsedRowsMap=null,Qs.set(this,{movedToCollapsed:!1,skipRender:null,skipCoreAPIModifiers:!1})}isEnabled(){return!!this.hot.getSettings()[Tc]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Hl),this.dataManager=new b5(this,this.hot),this.collapsingUI=new T5(this,this.hot),this.headersUI=new T1(this,this.hot),this.contextMenuUI=new _5(this,this.hot),this.rowMoveController=new O5(this),this.addHook("afterInit",function(){return e.onAfterInit(...arguments)}),this.addHook("beforeViewRender",function(){return e.onBeforeViewRender(...arguments)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){return e.onFilterData(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){return e.onAfterContextMenuDefaultOptions(...arguments)}),this.addHook("afterGetRowHeader",function(){return e.onAfterGetRowHeader(...arguments)}),this.addHook("beforeOnCellMouseDown",function(){return e.onBeforeOnCellMouseDown(...arguments)}),this.addHook("beforeRemoveRow",function(){return e.onBeforeRemoveRow(...arguments)}),this.addHook("afterRemoveRow",function(){return e.onAfterRemoveRow(...arguments)}),this.addHook("beforeAddChild",function(){return e.onBeforeAddChild(...arguments)}),this.addHook("afterAddChild",function(){return e.onAfterAddChild(...arguments)}),this.addHook("beforeDetachChild",function(){return e.onBeforeDetachChild(...arguments)}),this.addHook("afterDetachChild",function(){return e.onAfterDetachChild(...arguments)}),this.addHook("modifyRowHeaderWidth",function(){return e.onModifyRowHeaderWidth(...arguments)}),this.addHook("afterCreateRow",function(){return e.onAfterCreateRow(...arguments)}),this.addHook("beforeRowMove",function(){return e.onBeforeRowMove(...arguments)}),this.addHook("beforeLoadData",t=>this.onBeforeLoadData(t)),this.addHook("beforeUpdateData",t=>this.onBeforeLoadData(t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const t=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t)}},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:OR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(OR)}onBeforeRowMove(e,t,s,o){return this.rowMoveController.onBeforeRowMove(e,t,s,o)}disableCoreAPIModifiers(){const e=Qs.get(this);e.skipCoreAPIModifiers=!0}enableCoreAPIModifiers(){const e=Qs.get(this);e.skipCoreAPIModifiers=!1}onBeforeOnCellMouseDown(e,t,s){this.collapsingUI.toggleState(e,t,s)}onModifyRowData(e){if(!Qs.get(this).skipCoreAPIModifiers)return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Qs.get(this).skipCoreAPIModifiers)return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,s){return Qs.get(this).skipCoreAPIModifiers||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,t,s),!1)}onFilterData(e,t,s){const o=Qs.get(this);return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(s[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(s[0],null,-1*t),this.dataManager.filterData(e,t,s),o.skipRender=!0,this.dataManager.getData().slice()}onAfterContextMenuDefaultOptions(e){return this.contextMenuUI.appendOptions(e)}onAfterGetRowHeader(e,t){this.headersUI.appendLevelIndicators(e,t)}onModifyRowHeaderWidth(e){return this.headersUI.rowHeaderWidthCache||e}onAfterRemoveRow(e,t,s,o){if(o===this.pluginName)return;const i=Qs.get(this);setTimeout(()=>{i.skipRender=null,this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()},0)}onBeforeRemoveRow(e,t,s){const o=Array.from(s.reduce((i,r)=>{if(this.dataManager.isParent(r)){const a=this.dataManager.getDataObject(r).__children;return i.add(r),Array.isArray(a)&&a.forEach(l=>i.add(this.dataManager.getRowIndex(l))),i}return i.add(r)},new Set));s.length=0,s.push(...o)}onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterAddChild(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}onAfterDetachChild(e,t,s){this.collapsingUI.collapsedRowsStash.shiftStash(s,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}onAfterCreateRow(){this.dataManager.rewriteCache()}onAfterInit(){this.headersUI.updateRowHeaderWidth()}onBeforeViewRender(e,t){Qs.get(this).skipRender&&(t.skipRender=!0)}destroy(){super.destroy()}onBeforeLoadData(e){if(!GT(e)){Bw(I5),this.hot.getSettings()[Tc]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}}class H5{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;this.rootWindow=t,this.prefix=e,this.savedKeys=[],this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const s=typeof e>"u"?t:e,o=this.rootWindow.localStorage.getItem(`${this.prefix}_${s}`);return o===null?void 0:JSON.parse(o)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){T(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const P5=H5;de.getSingleton().register("persistentStateSave");de.getSingleton().register("persistentStateLoad");de.getSingleton().register("persistentStateReset");const AR="persistentState",D5=0;class N5 extends tt{static get PLUGIN_KEY(){return AR}static get PLUGIN_PRIORITY(){return D5}constructor(e){super(e),this.storage=void 0}isEnabled(){return!!this.hot.getSettings()[AR]}enablePlugin(){this.enabled||(this.storage||(this.storage=new P5(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}const _m="search",L5=190,k5="htSearchResult",F5=function(n,e,t,s,o){n.getCellMeta(e,t).isSearchResult=o},$5=function(n,e,t){return ft(n)||n===null||!n.toLocaleLowerCase||n.length===0||ft(e)||e===null?!1:e.toString().toLocaleLowerCase(t.locale).indexOf(n.toLocaleLowerCase(t.locale))!==-1};class V5 extends tt{static get PLUGIN_KEY(){return _m}static get PLUGIN_PRIORITY(){return L5}constructor(e){super(e),this.callback=F5,this.queryMethod=$5,this.searchResultClass=k5}isEnabled(){return this.hot.getSettings()[_m]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[_m];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){return e.onBeforeRenderer(...arguments)}),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){return e.onBeforeRenderer(...arguments)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const o=this.hot.countRows(),i=this.hot.countCols(),r=[],a=this.hot;return me(0,o-1,l=>{me(0,i-1,u=>{const c=this.hot.getDataAtCell(l,u),d=this.hot.getCellMeta(l,u),f=d.search.callback||t,w=(d.search.queryMethod||s)(e,c,d);if(w){const C={row:l,col:u,data:c};r.push(C)}f&&f(a,l,u,c,w)})}),r}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){De(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}onBeforeRenderer(e,t,s,o,i,r){const a=r.className||[];let l=[];typeof a=="string"?l=a.split(" "):l.push(...a),this.isEnabled()&&r.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),r.className=l.join(" ")}destroy(){super.destroy()}}const W5="touchScroll",B5=200;class U5 extends tt{static get PLUGIN_KEY(){return W5}static get PLUGIN_PRIORITY(){return B5}static get SETTING_KEYS(){return!0}constructor(e){super(e),this.scrollbars=[],this.clones=[],this.lockedCollection=!1,this.freezeOverlays=!1}isEnabled(){return nC()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>this.onAfterViewRender()),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>this.onBeforeTouchScroll()),this.addHook("afterMomentumScroll",()=>this.onAfterMomentumScroll())}onAfterViewRender(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:s,topInlineStartCornerOverlay:o,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(s),o&&this.scrollbars.push(o),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),o&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}onBeforeTouchScroll(){this.freezeOverlays=!0,T(this.clones,e=>{J(e,"hide-tween")})}onAfterMomentumScroll(){this.freezeOverlays=!1,T(this.clones,e=>{Pe(e,"hide-tween"),J(e,"show-tween")}),this.hot._registerTimeout(()=>{T(this.clones,e=>{Pe(e,"show-tween")})},400),T(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}}const tc="trimRows",Y5=330;class z5 extends tt{static get PLUGIN_KEY(){return tc}static get PLUGIN_PRIORITY(){return Y5}constructor(e){super(e),this.trimmedRowsMap=null}isEnabled(){return!!this.hot.getSettings()[tc]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Hl),this.trimmedRowsMap.addLocalHook("init",()=>this.onMapInit()),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[tc];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),T(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),s=this.isValidConfig(e);let o=t;s&&(o=Array.from(new Set(t.concat(e)))),this.hot.runHooks("beforeTrimRow",t,o,s)!==!1&&(s&&this.hot.batchExecution(()=>{T(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),this.hot.runHooks("afterTrimRow",t,o,s,s&&o.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),s=this.isValidConfig(e);let o=t;const i=this.trimmedRowsMap.getValues().slice(),r=e.length>0;s&&r&&(T(e,l=>{i[l]=!1}),o=Pt(i,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",t,o,s&&r)!==!1&&(s&&r&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,o,s&&r,s&&o.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every(s=>Number.isInteger(s)&&s>=0&&s<t)}onMapInit(){const e=this.hot.getSettings()[tc];Array.isArray(e)&&this.hot.batchExecution(()=>{T(e,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}destroy(){super.destroy()}}const M1="undoRedo",G5="undoRedo";function ue(n){const e=this;this.instance=n,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,n.addHook("afterChange",function(t,s){const o=t&&t.length;if(!o||!t.find(a=>{const[,,l,u]=a;return l!==u}))return;const r=()=>{const a=t.reduce((u,c)=>(u.push([...c]),u),[]);T(a,u=>{u[1]=n.propToCol(u[1])});const l=o>1?this.getSelected():[[a[0][0],a[0][1]]];return new ue.ChangeAction(a,l)};e.done(r,s)}),n.addHook("afterCreateRow",(t,s,o)=>{e.done(()=>new ue.CreateRowAction(t,s),o)}),n.addHook("beforeRemoveRow",(t,s,o,i)=>{const r=()=>{const a=n.toPhysicalRow(t),l=Qt(e.instance.getSourceData(a,0,a+s-1,e.instance.countSourceCols()-1));return new ue.RemoveRowAction(a,l,n.getSettings().fixedRowsBottom,n.getSettings().fixedRowsTop,n.rowIndexMapper.getIndexesSequence())};e.done(r,i)}),n.addHook("afterCreateCol",(t,s,o)=>{e.done(()=>new ue.CreateColumnAction(t,s),o)}),n.addHook("beforeRemoveCol",(t,s,o,i)=>{const r=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+t)%e.instance.countCols(),u=[],c=[],d=[];me(a.length-1,w=>{const C=[],b=a[w];me(l,l+(s-1),y=>{C.push(b[n.toPhysicalColumn(y)])}),u.push(C)}),me(s-1,w=>{d.push(n.toPhysicalColumn(l+w))}),Array.isArray(n.getSettings().colHeaders)&&me(s-1,w=>{c.push(n.getSettings().colHeaders[n.toPhysicalColumn(l+w)]||null)});const f=n.columnIndexMapper.getIndexesSequence(),m=n.rowIndexMapper.getIndexesSequence();return new ue.RemoveColumnAction(l,d,u,c,f,m,n.getSettings().fixedColumnsStart)};e.done(r,i)}),n.addHook("beforeCellAlignment",(t,s,o,i)=>{e.done(()=>new ue.CellAlignmentAction(t,s,o,i))}),n.addHook("beforeFilter",t=>{e.done(()=>new ue.FiltersAction(t))}),n.addHook("beforeRowMove",(t,s)=>{t!==!1&&e.done(()=>new ue.RowMoveAction(t,s))}),n.addHook("beforeMergeCells",(t,s)=>{s||e.done(()=>new ue.MergeCellsAction(n,t))}),n.addHook("afterUnmergeCells",(t,s)=>{s||e.done(()=>new ue.UnmergeCellsAction(n,t))}),n.addHook("afterInit",()=>{e.init()})}ue.prototype.done=function(n,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const s=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",s,e)===!1)return;const i=n(),r=this.undoneActions.slice();this.doneActions.push(i),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",r),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",r,this.undoneActions.slice())};ue.prototype.undo=function(){if(this.isUndoAvailable()){const n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice());const t=Qt(e);if(this.instance.runHooks("beforeUndo",t)===!1)return;this.ignoreNewActions=!0;const o=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),e.undo(this.instance,()=>{o.ignoreNewActions=!1,o.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",t)}};ue.prototype.redo=function(){if(this.isRedoAvailable()){const n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice());const t=Qt(e);if(this.instance.runHooks("beforeRedo",t)===!1)return;this.ignoreNewActions=!0;const o=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),e.redo(this.instance,()=>{o.ignoreNewActions=!1,o.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",t)}};ue.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ue.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ue.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ue.prototype.isEnabled=function(){return this.enabled};ue.prototype.enable=function(){if(this.isEnabled())return;const n=this.instance;this.enabled=!0,X5(n),this.registerShortcuts(),n.addHook("afterChange",_1)};ue.prototype.disable=function(){if(!this.isEnabled())return;const n=this.instance;this.enabled=!1,q5(n),this.unregisterShortcuts(),n.removeHook("afterChange",_1)};ue.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ue.Action=function(){};ue.Action.prototype.undo=function(){};ue.Action.prototype.redo=function(){};ue.ChangeAction=function(n,e){this.changes=n,this.selected=e,this.actionType="change"};mo(ue.ChangeAction,ue.Action);ue.ChangeAction.prototype.undo=function(n,e){const t=Qt(this.changes),s=n.countEmptyRows(!0),o=n.countEmptyCols(!0);for(let i=0,r=t.length;i<r;i++)t[i].splice(3,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.undo");for(let i=0,r=t.length;i<r;i++){const[a,l]=t[i];n.getSettings().minSpareRows&&a+1+n.getSettings().minSpareRows===n.countRows()&&s===n.getSettings().minSpareRows&&(n.alter("remove_row",parseInt(a+1,10),n.getSettings().minSpareRows),n.undoRedo.doneActions.pop()),n.getSettings().minSpareCols&&l+1+n.getSettings().minSpareCols===n.countCols()&&o===n.getSettings().minSpareCols&&(n.alter("remove_col",parseInt(l+1,10),n.getSettings().minSpareCols),n.undoRedo.doneActions.pop())}n.selectCells(this.selected,!1,!1)};ue.ChangeAction.prototype.redo=function(n,e){const t=Qt(this.changes);for(let s=0,o=t.length;s<o;s++)t[s].splice(2,1);n.addHookOnce("afterChange",e),n.setDataAtCell(t,null,null,"UndoRedo.redo"),this.selected&&n.selectCells(this.selected,!1,!1)};ue.CreateRowAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_row"};mo(ue.CreateRowAction,ue.Action);ue.CreateRowAction.prototype.undo=function(n,e){const t=n.countRows(),s=n.getSettings().minSpareRows;this.index>=t&&this.index-s<t&&(this.index-=s),n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ue.CreateRowAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateRow",e),n.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ue.RemoveRowAction=function(n,e,t,s,o){this.index=n,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=t,this.fixedRowsTop=s,this.rowIndexesSequence=o};mo(ue.RemoveRowAction,ue.Action);ue.RemoveRowAction.prototype.undo=function(n,e){const t=n.getSettings(),s=[];t.fixedRowsBottom=this.fixedRowsBottom,t.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,i)=>{Object.keys(o).forEach(r=>{const a=parseInt(r,10);s.push([this.index+i,isNaN(a)?r:a,o[r]])})}),n.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),n.addHookOnce("afterViewRender",e),n.setSourceDataAtCell(s,null,null,"UndoRedo.undo"),n.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ue.RemoveRowAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveRow",e),n.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ue.CreateColumnAction=function(n,e){this.index=n,this.amount=e,this.actionType="insert_col"};mo(ue.CreateColumnAction,ue.Action);ue.CreateColumnAction.prototype.undo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ue.CreateColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterCreateCol",e),n.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ue.RemoveColumnAction=function(n,e,t,s,o,i,r){this.index=n,this.indexes=e,this.data=t,this.amount=this.data[0].length,this.headers=s,this.columnPositions=o.slice(0),this.rowPositions=i.slice(0),this.actionType="remove_col",this.fixedColumnsStart=r};mo(ue.RemoveColumnAction,ue.Action);ue.RemoveColumnAction.prototype.undo=function(n,e){const t=n.getSettings();t.fixedColumnsStart=this.fixedColumnsStart;const s=this.indexes.slice(0).sort(),o=(u,c,d)=>d[this.indexes.indexOf(s[c])],i=this.data.length,r=[];for(let u=0;u<i;u++)r.push(Ve(this.data[u],o));const a=Ve(this.headers,o),l=[];n.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),T(n.getSourceDataArray(),(u,c)=>{T(s,(d,f)=>{u[d]=r[c][f],l.push([c,d,u[d]])})}),n.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&T(a,(u,c)=>{n.getSettings().colHeaders[s[c]]=u}),n.batchExecution(()=>{n.rowIndexMapper.setIndexesSequence(this.rowPositions),n.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),n.addHookOnce("afterViewRender",e),n.render()};ue.RemoveColumnAction.prototype.redo=function(n,e){n.addHookOnce("afterRemoveCol",e),n.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ue.CellAlignmentAction=function(n,e,t,s){this.stateBefore=n,this.range=e,this.type=t,this.alignment=s};ue.CellAlignmentAction.prototype.undo=function(n,e){T(this.range,t=>{t.forAll((s,o)=>{s>=0&&o>=0&&n.setCellMeta(s,o,"className",this.stateBefore[s][o]||" htLeft")})}),n.addHookOnce("afterViewRender",e),n.render()};ue.CellAlignmentAction.prototype.redo=function(n,e){Ho(this.range,this.type,this.alignment,(t,s)=>n.getCellMeta(t,s),(t,s,o,i)=>n.setCellMeta(t,s,o,i)),n.addHookOnce("afterViewRender",e),n.render()};ue.FiltersAction=function(n){this.conditionsStack=n,this.actionType="filter"};mo(ue.FiltersAction,ue.Action);ue.FiltersAction.prototype.undo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),t.filter()};ue.FiltersAction.prototype.redo=function(n,e){const t=n.getPlugin("filters");n.addHookOnce("afterViewRender",e),t.conditionCollection.importAllConditions(this.conditionsStack),t.filter()};class j5 extends ue.Action{constructor(e,t){super(),this.cellRange=t;const s=this.cellRange.getTopStartCorner(),o=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(s.row,s.col,o.row,o.col)}undo(e,t){const s=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),s.unmergeRange(this.cellRange,!0);const o=this.cellRange.getTopStartCorner();e.populateFromArray(o.row,o.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const s=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),s.mergeRange(this.cellRange)}}ue.MergeCellsAction=j5;class K5 extends ue.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const s=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),s.mergeRange(this.cellRange,!0)}redo(e,t){const s=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),s.unmergeRange(this.cellRange,!0),e.render()}}ue.UnmergeCellsAction=K5;ue.RowMoveAction=function(n,e){this.rows=n.slice(),this.finalIndex=e,this.actionType="row_move"};mo(ue.RowMoveAction,ue.Action);ue.RowMoveAction.prototype.undo=function(n,e){const t=n.getPlugin("manualRowMove"),s=[].concat(this.rows),o=s.filter(a=>a>this.finalIndex),i=s.filter(a=>a<=this.finalIndex),r=o.sort((a,l)=>l-a).concat(i.sort((a,l)=>a-l));n.addHookOnce("afterViewRender",e);for(let a=0;a<r.length;a+=1){const l=n.toVisualRow(r[a]);t.moveRow(l,r[a])}n.render(),n.deselectCell(),n.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ue.RowMoveAction.prototype.redo=function(n,e){const t=n.getPlugin("manualRowMove");n.addHookOnce("afterViewRender",e),t.moveRows(this.rows.slice(),this.finalIndex),n.render(),n.deselectCell(),n.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ue.prototype.init=function(){const n=this.instance.getSettings().undo,e=typeof n>"u"||n;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ue.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),s={runOnlyIf:o=>!o.altKey,group:M1};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],s)};ue.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(M1)};function _1(n,e){const t=this;if(e==="loadData")return t.undoRedo.clear()}function X5(n){n.undo=function(){return n.undoRedo.undo()},n.redo=function(){return n.undoRedo.redo()},n.isUndoAvailable=function(){return n.undoRedo.isUndoAvailable()},n.isRedoAvailable=function(){return n.undoRedo.isRedoAvailable()},n.clearUndo=function(){return n.undoRedo.clear()}}function q5(n){delete n.undo,delete n.redo,delete n.isUndoAvailable,delete n.isRedoAvailable,delete n.clearUndo}const zl=de.getSingleton();zl.add("afterUpdateSettings",function(){var n;(n=this.getPlugin("undoRedo"))===null||n===void 0||n.init()});zl.register("beforeUndo");zl.register("afterUndo");zl.register("beforeRedo");zl.register("afterRedo");ue.PLUGIN_KEY=G5;ue.SETTING_KEYS=!0;function Z5(){Ne(_r),Ne(rG),Ne(ja),Ne(vG),Ne(AG),Ne(JM),Ne(sj),Ne(Nj),Ne(Wl),Ne(m_),Ne(nK),Ne(oK),Ne(Bl),Ne(vK),Ne(z_),Ne(L6),Ne(o1),Ne(u1),Ne(n9),Ne(h9),Ne(f9),Ne(d1),Ne(R9),Ne(H9),Ne(g1),Ne($9),Ne(v5),Ne(x5),Ne(N5),Ne(V5),Ne(U5),Ne(z5),Ne(ue)}function Q5(){ez(),mz(),Rz(),Wz(),Z5()}function J5(n){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(t){const s=this.first();let o=s.data("handsontable");if(typeof t!="string"){const u=t||{};return o?o.updateSettings(u):(o=new n.Core(s[0],u),s.data("handsontable",o),o.init()),s}let i;if(o)if(typeof o[t]<"u"){for(var r=arguments.length,a=new Array(r>1?r-1:0),l=1;l<r;l++)a[l-1]=arguments[l];i=o[t].call(o,...a),t==="destroy"&&s.removeData()}else throw new Error(`Handsontable do not provide action: ${t}`);return i})}var Om,Am,Im,xm,Hm;Q5();J5(we);we.__GhostTable=rS;we._getListenersCounter=i$;we._getRegisteredMapsCounter=o2;we.EventManager=It;const e8=[$k,GF,ZB,wz,sW,_F,Uk,B$,UF,zk,XF,eV],t8=[RF,qF];we.helper={};we.dom={};T(e8,n=>{T(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(we.helper[e]=n[e])})});T(t8,n=>{T(Object.getOwnPropertyNames(n),e=>{e.charAt(0)!=="_"&&(we.dom[e]=n[e])})});we.cellTypes=(Om=we.cellTypes)!==null&&Om!==void 0?Om:{};T(pU(),n=>{we.cellTypes[n]=GC(n)});we.cellTypes.registerCellType=on;we.cellTypes.getCellType=GC;we.editors=(Am=we.editors)!==null&&Am!==void 0?Am:{};T(t$(),n=>{we.editors[`${un(n)}Editor`]=Uc(n)});we.editors.registerEditor=On;we.editors.getEditor=Uc;we.renderers=(Im=we.renderers)!==null&&Im!==void 0?Im:{};T(mV(),n=>{const e=Gc(n);n==="base"&&(we.renderers.cellDecorator=e),we.renderers[`${un(n)}Renderer`]=e});we.renderers.registerRenderer=Rs;we.renderers.getRenderer=Gc;we.validators=(xm=we.validators)!==null&&xm!==void 0?xm:{};T(CV(),n=>{we.validators[`${un(n)}Validator`]=Zw(n)});we.validators.registerValidator=yr;we.validators.getValidator=Zw;we.plugins=(Hm=we.plugins)!==null&&Hm!==void 0?Hm:{};T(qw(),n=>{we.plugins[n]=Al(n)});we.plugins[`${un(tt.PLUGIN_KEY)}Plugin`]=tt;we.plugins.registerPlugin=Ne;we.plugins.getPlugin=Al;const n8=(n,e)=>{const t=e.className;t!==void 0&&we.dom.addClass(n,t)};function s8(n,e,t,s,o,i,r){const a=document.createElement("div");a.style.width=`${i*10}px`,n8(e,r),we.dom.addClass(a,"progressBar"),we.dom.empty(e),e.appendChild(a)}function o8(n,e,t,s,o,i,r){we.renderers.TextRenderer.apply(this,[n,e,t,s,o,"â".repeat(i),r])}/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Feb 9, 2022
 *
 * Description: Definition file for Arabic - Without a specific country.
 */const i8={languageCode:"ar-AR",languageDirection:"rtl",[Fh]:"ÙØ§ ØªÙØ¬Ø¯ Ø®ÙØ§Ø±Ø§Øª ÙØªÙÙØ±Ø©",[$h]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø¹ÙÙ",[Vh]:"Ø¥Ø¯Ø±Ø§Ø¬ ØµÙ ÙÙØ£Ø³ÙÙ",[Wh]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙØ³Ø§Ø±",[Bh]:"Ø¥Ø¯Ø±Ø§Ø¬ Ø¹ÙÙØ¯ ÙÙÙÙÙÙ",[Uh]:["Ø§Ø­Ø¯Ù Ø§ÙØµÙ","Ø§Ø­Ø°Ù Ø§ÙØµÙÙÙ"],[Yh]:["Ø§Ø­Ø¯Ù Ø§ÙØ¹ÙÙØ¯","Ø§Ø­Ø¯Ù Ø§ÙØ£Ø¹ÙØ¯Ø©"],[zh]:"ØªØ±Ø§Ø¬Ø¹",[Gh]:"Ø¥ÙØºØ§Ø¡ Ø§ÙØªØ±Ø§Ø¬Ø¹",[jh]:"ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[Kh]:"Ø§ÙØ±Øº Ø§ÙØ¹ÙÙØ¯",[id]:"Ø§ÙÙØ­Ø§Ø°Ø§Ø©",[rd]:"ÙØ³Ø§Ø±",[ad]:"ÙØ³Ø·",[ld]:"ÙÙÙÙ",[ud]:"Ø¨Ø§ÙØªØ³Ø§ÙÙ",[cd]:"Ø£Ø¹ÙÙ",[hd]:"ÙØªÙØ³Ø·",[dd]:"Ø£Ø³ÙÙ",[Zh]:"ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[Qh]:"Ø¥ÙØºØ§Ø¡ ØªØ¬ÙÙØ¯ Ø§ÙØ¹ÙÙØ¯",[fd]:"Ø§ÙØ­Ø¯ÙØ¯",[gd]:"Ø£Ø¹ÙÙ",[md]:"ÙÙÙÙ",[pd]:"Ø£Ø³ÙÙ",[wd]:"ÙØ³Ø§Ø±",[Cd]:"Ø£Ø­Ø°Ù Ø§ÙØ­Ø¯(ÙØ¯)",[td]:"Ø£Ø¶Ù ØªØ¹ÙÙÙØ§Ù",[nd]:"ØªØ¹Ø¯ÙÙ Ø§ÙØªØ¹ÙÙÙ",[sd]:"Ø§Ø­Ø°Ù Ø§ÙØªØ¹ÙÙÙ",[od]:"ØªØ¹ÙÙÙ ÙÙÙØ±Ø§Ø¡Ø© ÙÙØ·",[Jh]:"Ø§Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[ed]:"Ø¥ÙØºØ§Ø¡ Ø¯ÙØ¬ Ø§ÙØ®ÙØ§ÙØ§",[Xh]:"ÙØ³Ø®",[qh]:"ÙØµ",[Sd]:"Ø£Ø¯Ø®Ù ØµÙØ§Ù ÙØ±Ø¹ÙØ§Ù",[vd]:"Ø§ÙØµÙ Ø¹Ù Ø§ÙØµÙ Ø§ÙØ£ØµÙÙ",[yd]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ¹ÙÙØ¯","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ£Ø¹ÙØ¯Ø©"],[bd]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ¹ÙÙØ¯","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ£Ø¹ÙØ¯Ø©"],[Rd]:["Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·Ø±","Ø¥Ø®ÙØ§Ø¡ Ø§ÙØ³Ø·ÙØ±"],[Ed]:["Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·Ø±","Ø¥Ø¸ÙØ§Ø± Ø§ÙØ³Ø·ÙØ±"],[Pl]:"Ø¨ÙØ§",[Td]:"ÙØ§Ø±Øº",[Md]:"ØºÙØ± ÙØ§Ø±Øº",[_d]:"ÙØ³Ø§ÙÙ",[Od]:"ÙØ§ ÙØ³Ø§ÙÙ",[Ad]:"ÙØ¨Ø¯Ø§Ù Ø¨Ù",[Id]:"ÙÙØªÙÙ Ø¨Ù",[xd]:"ÙØ­ØªÙÙ",[Hd]:"ÙØ§ ÙØ­ØªÙÙ",[Pd]:"Ø£ÙØ¨Ø± ÙÙ",[Dd]:"Ø£ÙØ¨Ø± Ø£Ù ÙØ³Ø§ÙÙ",[Nd]:"Ø£ØµØºØ±",[Ld]:"Ø£ØµØºØ± Ø£Ù ÙØ³Ø§ÙÙ",[kd]:"Ø¨ÙÙ",[Fd]:"Ø®Ø§Ø±Ø¬ Ø§ÙÙØ¬Ø§Ù",[$d]:"Ø¨Ø¹Ø¯",[Vd]:"ÙØ¨Ù",[Wd]:"Ø§ÙÙÙÙ",[Bd]:"ØºØ¯Ø§Ù",[Ud]:"Ø§ÙØ¨Ø§Ø±Ø­Ø©",[ll]:"Ø®ÙØ§ÙØ§ ÙØ§Ø±ØºØ©",[Yd]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙØ´Ø±Ø·",[zd]:"ØªØµÙÙØ© Ø­Ø³Ø¨ Ø§ÙÙÙÙØ©",[Gd]:"Ù",[Dl]:"Ø£Ù",[jd]:"Ø§Ø®ØªÙØ§Ø± Ø§ÙÙÙ",[Kd]:"Ø¥ÙØºØ§Ø¡",[Xd]:"ÙÙØ§ÙÙ",[qd]:"Ø¥ÙØºØ§Ø¡",[Zd]:"Ø§ÙØ¨Ø­Ø«",[Qd]:"Ø§ÙÙÙÙØ©",[Jd]:"Ø§ÙÙÙÙØ© Ø§ÙØ«Ø§ÙÙØ©"},O1=i8,IR=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function r8(n,e,t,s,o,i){if(t!==0)return;const r=n.parentElement;r!==null&&(i.instance.getDataAtRowProp(e,"0")?we.dom.addClass(r,Vy):we.dom.removeClass(r,Vy),e%2===0?we.dom.addClass(r,Wy):we.dom.removeClass(r,Wy))}function a8(n,e){const t=document.createElement("input");t.type="checkbox",n>=0&&this.getDataAtRowProp(n,"0")&&(t.checked=!0),we.dom.empty(e),e.appendChild(t)}function l8(n,e){if(n<0)return;const t=this.isRtl()?"htRight":"htLeft";e.firstChild&&(IR.has(n.toString())?(we.dom.removeClass(e.firstChild,t),we.dom.addClass(e.firstChild,IR.get(n.toString()))):we.dom.addClass(e.firstChild,t))}function u8(n,e){const t=n.target;e.col===-1&&t&&t.nodeName==="INPUT"&&(n.preventDefault(),this.setDataAtRowProp(e.row,"0",!t.checked))}Ne(_r);Ne(Wl);Ne(m_);Ne(Bl);Ne(z_);Ne(o1);Ne(u1);Ne(d1);Ne(g1);Ne(ue);on(FM);on($M);on(LM);on(WM);UC(O1);const c8=document.getElementById("example");new we(c8,{data:VY(),layoutDirection:wc()?"rtl":"ltr",language:wc()?O1.languageCode:"en-US",height:450,colWidths:[140,192,100,90,90,110,97,100,126],colHeaders:["Company name","Name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:1,type:"text"},{data:3,type:"text"},{data:4,type:"date",allowInvalid:!1,dateFormat:wc()?"M/D/YYYY":"DD/MM/YYYY"},{data:6,type:"checkbox",className:"htCenter"},{data:7,type:"numeric"},{data:8,renderer:s8,readOnly:!0,className:"htMiddle"},{data:9,renderer:o8,readOnly:!0,className:"star htCenter"},{data:5,type:"text"},{data:2,type:"text"}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,afterGetColHeader:l8,afterGetRowHeader:a8,afterOnCellMouseDown:u8,beforeRenderer:r8,licenseKey:"non-commercial-and-evaluation"});console.log(`Handsontable: v${we.version} (${we.buildDate})`)});export default h8();
