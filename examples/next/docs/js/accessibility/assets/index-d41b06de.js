var qD=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var nle=qD((Cle,wd)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Wr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function pO(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var _c=function(t){return t&&t.Math===Math&&t},Rn=_c(typeof globalThis=="object"&&globalThis)||_c(typeof window=="object"&&window)||_c(typeof self=="object"&&self)||_c(typeof Wr=="object"&&Wr)||function(){return this}()||Wr||Function("return this")(),dC={},Sr=function(t){try{return!!t()}catch{return!0}},ZD=Sr,pi=!ZD(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),QD=Sr,uf=!QD(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),JD=uf,Mc=Function.prototype.call,cf=JD?Mc.bind(Mc):function(){return Mc.apply(Mc,arguments)},wO={},CO={}.propertyIsEnumerable,vO=Object.getOwnPropertyDescriptor,eN=vO&&!CO.call({1:2},1);wO.f=eN?function(e){var n=vO(this,e);return!!n&&n.enumerable}:CO;var fC=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},SO=uf,yO=Function.prototype,Xp=yO.call,tN=SO&&yO.bind.bind(Xp,Xp),Fn=SO?tN:function(t){return function(){return Xp.apply(t,arguments)}},bO=Fn,nN=bO({}.toString),rN=bO("".slice),ul=function(t){return rN(nN(t),8,-1)},iN=Fn,oN=Sr,sN=ul,hg=Object,aN=iN("".split),lN=oN(function(){return!hg("z").propertyIsEnumerable(0)})?function(t){return sN(t)==="String"?aN(t,""):hg(t)}:hg,RO=function(t){return t==null},uN=RO,cN=TypeError,EO=function(t){if(uN(t))throw cN("Can't call method on "+t);return t},hN=lN,dN=EO,hf=function(t){return hN(dN(t))},qp=typeof document=="object"&&document.all,fN=typeof qp>"u"&&qp!==void 0,TO={all:qp,IS_HTMLDDA:fN},_O=TO,gN=_O.all,dn=_O.IS_HTMLDDA?function(t){return typeof t=="function"||t===gN}:function(t){return typeof t=="function"},Sb=dn,MO=TO,mN=MO.all,js=MO.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:Sb(t)||t===mN}:function(t){return typeof t=="object"?t!==null:Sb(t)},dg=Rn,pN=dn,wN=function(t){return pN(t)?t:void 0},Ju=function(t,e){return arguments.length<2?wN(dg[t]):dg[t]&&dg[t][e]},CN=Fn,AO=CN({}.isPrototypeOf),gC=typeof navigator<"u"&&String(navigator.userAgent)||"",OO=Rn,fg=gC,yb=OO.process,bb=OO.Deno,Rb=yb&&yb.versions||bb&&bb.version,Eb=Rb&&Rb.v8,kr,Cd;Eb&&(kr=Eb.split("."),Cd=kr[0]>0&&kr[0]<4?1:+(kr[0]+kr[1]));!Cd&&fg&&(kr=fg.match(/Edge\/(\d+)/),(!kr||kr[1]>=74)&&(kr=fg.match(/Chrome\/(\d+)/),kr&&(Cd=+kr[1])));var vN=Cd,Tb=vN,SN=Sr,yN=Rn,bN=yN.String,mC=!!Object.getOwnPropertySymbols&&!SN(function(){var t=Symbol("symbol detection");return!bN(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Tb&&Tb<41}),RN=mC,PO=RN&&!Symbol.sham&&typeof Symbol.iterator=="symbol",EN=Ju,TN=dn,_N=AO,MN=PO,AN=Object,pC=MN?function(t){return typeof t=="symbol"}:function(t){var e=EN("Symbol");return TN(e)&&_N(e.prototype,AN(t))},ON=String,IO=function(t){try{return ON(t)}catch{return"Object"}},PN=dn,IN=IO,xN=TypeError,wC=function(t){if(PN(t))return t;throw xN(IN(t)+" is not a function")},HN=wC,DN=RO,NN=function(t,e){var n=t[e];return DN(n)?void 0:HN(n)},gg=cf,mg=dn,pg=js,LN=TypeError,kN=function(t,e){var n,r;if(e==="string"&&mg(n=t.toString)&&!pg(r=gg(n,t))||mg(n=t.valueOf)&&!pg(r=gg(n,t))||e!=="string"&&mg(n=t.toString)&&!pg(r=gg(n,t)))return r;throw LN("Can't convert object to primitive value")},xO={exports:{}},_b=Rn,$N=Object.defineProperty,CC=function(t,e){try{$N(_b,t,{value:e,configurable:!0,writable:!0})}catch{_b[t]=e}return e},FN=Rn,WN=CC,Mb="__core-js_shared__",VN=FN[Mb]||WN(Mb,{}),vC=VN,Ab=vC;(xO.exports=function(t,e){return Ab[t]||(Ab[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.32.2",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.32.2/LICENSE",source:"https://github.com/zloirock/core-js"});var HO=xO.exports,BN=EO,UN=Object,df=function(t){return UN(BN(t))},zN=Fn,GN=df,YN=zN({}.hasOwnProperty),ro=Object.hasOwn||function(e,n){return YN(GN(e),n)},jN=Fn,KN=0,XN=Math.random(),qN=jN(1 .toString),DO=function(t){return"Symbol("+(t===void 0?"":t)+")_"+qN(++KN+XN,36)},ZN=Rn,QN=HO,Ob=ro,JN=DO,eL=mC,tL=PO,ja=ZN.Symbol,wg=QN("wks"),nL=tL?ja.for||ja:ja&&ja.withoutSetter||JN,ff=function(t){return Ob(wg,t)||(wg[t]=eL&&Ob(ja,t)?ja[t]:nL("Symbol."+t)),wg[t]},rL=cf,Pb=js,Ib=pC,iL=NN,oL=kN,sL=ff,aL=TypeError,lL=sL("toPrimitive"),uL=function(t,e){if(!Pb(t)||Ib(t))return t;var n=iL(t,lL),r;if(n){if(e===void 0&&(e="default"),r=rL(n,t,e),!Pb(r)||Ib(r))return r;throw aL("Can't convert object to primitive value")}return e===void 0&&(e="number"),oL(t,e)},cL=uL,hL=pC,NO=function(t){var e=cL(t,"string");return hL(e)?e:e+""},dL=Rn,xb=js,Zp=dL.document,fL=xb(Zp)&&xb(Zp.createElement),SC=function(t){return fL?Zp.createElement(t):{}},gL=pi,mL=Sr,pL=SC,LO=!gL&&!mL(function(){return Object.defineProperty(pL("div"),"a",{get:function(){return 7}}).a!==7}),wL=pi,CL=cf,vL=wO,SL=fC,yL=hf,bL=NO,RL=ro,EL=LO,Hb=Object.getOwnPropertyDescriptor;dC.f=wL?Hb:function(e,n){if(e=yL(e),n=bL(n),EL)try{return Hb(e,n)}catch{}if(RL(e,n))return SL(!CL(vL.f,e,n),e[n])};var Ks={},TL=pi,_L=Sr,kO=TL&&_L(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),ML=js,AL=String,OL=TypeError,ec=function(t){if(ML(t))return t;throw OL(AL(t)+" is not an object")},PL=pi,IL=LO,xL=kO,Ac=ec,Db=NO,HL=TypeError,Cg=Object.defineProperty,DL=Object.getOwnPropertyDescriptor,vg="enumerable",Sg="configurable",yg="writable";Ks.f=PL?xL?function(e,n,r){if(Ac(e),n=Db(n),Ac(r),typeof e=="function"&&n==="prototype"&&"value"in r&&yg in r&&!r[yg]){var i=DL(e,n);i&&i[yg]&&(e[n]=r.value,r={configurable:Sg in r?r[Sg]:i[Sg],enumerable:vg in r?r[vg]:i[vg],writable:!1})}return Cg(e,n,r)}:Cg:function(e,n,r){if(Ac(e),n=Db(n),Ac(r),IL)try{return Cg(e,n,r)}catch{}if("get"in r||"set"in r)throw HL("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var NL=pi,LL=Ks,kL=fC,tc=NL?function(t,e,n){return LL.f(t,e,kL(1,n))}:function(t,e,n){return t[e]=n,t},$O={exports:{}},Qp=pi,$L=ro,FO=Function.prototype,FL=Qp&&Object.getOwnPropertyDescriptor,yC=$L(FO,"name"),WL=yC&&(function(){}).name==="something",VL=yC&&(!Qp||Qp&&FL(FO,"name").configurable),BL={EXISTS:yC,PROPER:WL,CONFIGURABLE:VL},UL=Fn,zL=dn,Jp=vC,GL=UL(Function.toString);zL(Jp.inspectSource)||(Jp.inspectSource=function(t){return GL(t)});var YL=Jp.inspectSource,jL=Rn,KL=dn,Nb=jL.WeakMap,XL=KL(Nb)&&/native code/.test(String(Nb)),qL=HO,ZL=DO,Lb=qL("keys"),WO=function(t){return Lb[t]||(Lb[t]=ZL(t))},bC={},QL=XL,VO=Rn,JL=js,ek=tc,bg=ro,Rg=vC,tk=WO,nk=bC,kb="Object already initialized",ew=VO.TypeError,rk=VO.WeakMap,vd,Hu,Sd,ik=function(t){return Sd(t)?Hu(t):vd(t,{})},ok=function(t){return function(e){var n;if(!JL(e)||(n=Hu(e)).type!==t)throw ew("Incompatible receiver, "+t+" required");return n}};if(QL||Rg.state){var Kr=Rg.state||(Rg.state=new rk);Kr.get=Kr.get,Kr.has=Kr.has,Kr.set=Kr.set,vd=function(t,e){if(Kr.has(t))throw ew(kb);return e.facade=t,Kr.set(t,e),e},Hu=function(t){return Kr.get(t)||{}},Sd=function(t){return Kr.has(t)}}else{var oa=tk("state");nk[oa]=!0,vd=function(t,e){if(bg(t,oa))throw ew(kb);return e.facade=t,ek(t,oa,e),e},Hu=function(t){return bg(t,oa)?t[oa]:{}},Sd=function(t){return bg(t,oa)}}var sk={set:vd,get:Hu,has:Sd,enforce:ik,getterFor:ok},RC=Fn,ak=Sr,lk=dn,Oc=ro,tw=pi,uk=BL.CONFIGURABLE,ck=YL,BO=sk,hk=BO.enforce,dk=BO.get,$b=String,zh=Object.defineProperty,fk=RC("".slice),gk=RC("".replace),mk=RC([].join),pk=tw&&!ak(function(){return zh(function(){},"length",{value:8}).length!==8}),wk=String(String).split("String"),Ck=$O.exports=function(t,e,n){fk($b(e),0,7)==="Symbol("&&(e="["+gk($b(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!Oc(t,"name")||uk&&t.name!==e)&&(tw?zh(t,"name",{value:e,configurable:!0}):t.name=e),pk&&n&&Oc(n,"arity")&&t.length!==n.arity&&zh(t,"length",{value:n.arity});try{n&&Oc(n,"constructor")&&n.constructor?tw&&zh(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=hk(t);return Oc(r,"source")||(r.source=mk(wk,typeof e=="string"?e:"")),t};Function.prototype.toString=Ck(function(){return lk(this)&&dk(this).source||ck(this)},"toString");var vk=$O.exports,Sk=dn,yk=Ks,bk=vk,Rk=CC,Ek=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Sk(n)&&bk(n,o,r),r.global)i?t[e]=n:Rk(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:yk.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},UO={},Tk=Math.ceil,_k=Math.floor,Mk=Math.trunc||function(e){var n=+e;return(n>0?_k:Tk)(n)},Ak=Mk,EC=function(t){var e=+t;return e!==e||e===0?0:Ak(e)},Ok=EC,Pk=Math.max,Ik=Math.min,xk=function(t,e){var n=Ok(t);return n<0?Pk(n+e,0):Ik(n,e)},Hk=EC,Dk=Math.min,Nk=function(t){return t>0?Dk(Hk(t),9007199254740991):0},Lk=Nk,gf=function(t){return Lk(t.length)},kk=hf,$k=xk,Fk=gf,Fb=function(t){return function(e,n,r){var i=kk(e),o=Fk(i),s=$k(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Wk={includes:Fb(!0),indexOf:Fb(!1)},Vk=Fn,Eg=ro,Bk=hf,Uk=Wk.indexOf,zk=bC,Wb=Vk([].push),zO=function(t,e){var n=Bk(t),r=0,i=[],o;for(o in n)!Eg(zk,o)&&Eg(n,o)&&Wb(i,o);for(;e.length>r;)Eg(n,o=e[r++])&&(~Uk(i,o)||Wb(i,o));return i},TC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Gk=zO,Yk=TC,jk=Yk.concat("length","prototype");UO.f=Object.getOwnPropertyNames||function(e){return Gk(e,jk)};var GO={};GO.f=Object.getOwnPropertySymbols;var Kk=Ju,Xk=Fn,qk=UO,Zk=GO,Qk=ec,Jk=Xk([].concat),e$=Kk("Reflect","ownKeys")||function(e){var n=qk.f(Qk(e)),r=Zk.f;return r?Jk(n,r(e)):n},Vb=ro,t$=e$,n$=dC,r$=Ks,YO=function(t,e,n){for(var r=t$(e),i=r$.f,o=n$.f,s=0;s<r.length;s++){var a=r[s];!Vb(t,a)&&!(n&&Vb(n,a))&&i(t,a,o(e,a))}},i$=Sr,o$=dn,s$=/#|\.prototype\./,nc=function(t,e){var n=l$[a$(t)];return n===c$?!0:n===u$?!1:o$(e)?i$(e):!!e},a$=nc.normalize=function(t){return String(t).replace(s$,".").toLowerCase()},l$=nc.data={},u$=nc.NATIVE="N",c$=nc.POLYFILL="P",h$=nc,Tg=Rn,d$=dC.f,f$=tc,g$=Ek,m$=CC,p$=YO,w$=h$,Xs=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Tg:i?s=Tg[n]||m$(n,{}):s=(Tg[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=d$(s,a),l=c&&c.value):l=s[a],o=w$(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;p$(u,l)}(t.sham||l&&l.sham)&&f$(u,"sham",!0),g$(s,a,u,t)}},C$=ul,jO=Array.isArray||function(e){return C$(e)==="Array"},v$=pi,S$=jO,y$=TypeError,b$=Object.getOwnPropertyDescriptor,R$=v$&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),KO=R$?function(t,e){if(S$(t)&&!b$(t,"length").writable)throw y$("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},E$=TypeError,T$=9007199254740991,XO=function(t){if(t>T$)throw E$("Maximum allowed index exceeded");return t},_$=Xs,M$=df,A$=gf,O$=KO,P$=XO,I$=Sr,x$=I$(function(){return[].push.call({length:4294967296},1)!==4294967297}),H$=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},D$=x$||!H$();_$({target:"Array",proto:!0,arity:1,forced:D$},{push:function(e){var n=M$(this),r=A$(n),i=arguments.length;P$(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return O$(n,r),r}});var N$=uf,qO=Function.prototype,Bb=qO.apply,Ub=qO.call,mf=typeof Reflect=="object"&&Reflect.apply||(N$?Ub.bind(Bb):function(){return Ub.apply(Bb,arguments)}),L$=Fn,k$=wC,$$=function(t,e,n){try{return L$(k$(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},F$=dn,W$=String,V$=TypeError,B$=function(t){if(typeof t=="object"||F$(t))return t;throw V$("Can't set "+W$(t)+" as a prototype")},U$=$$,z$=ec,G$=B$,ZO=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=U$(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return z$(i),G$(o),t?n(i,o):i.__proto__=o,i}}():void 0),Y$=Ks.f,j$=function(t,e,n){n in t||Y$(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},K$=dn,X$=js,zb=ZO,q$=function(t,e,n){var r,i;return zb&&K$(r=e.constructor)&&r!==n&&X$(i=r.prototype)&&i!==n.prototype&&zb(t,i),t},Z$=ff,Q$=Z$("toStringTag"),QO={};QO[Q$]="z";var J$=String(QO)==="[object z]",eF=J$,tF=dn,Gh=ul,nF=ff,rF=nF("toStringTag"),iF=Object,oF=Gh(function(){return arguments}())==="Arguments",sF=function(t,e){try{return t[e]}catch{}},aF=eF?Gh:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=sF(e=iF(t),rF))=="string"?n:oF?Gh(e):(r=Gh(e))==="Object"&&tF(e.callee)?"Arguments":r},lF=aF,uF=String,JO=function(t){if(lF(t)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return uF(t)},cF=JO,hF=function(t,e){return t===void 0?arguments.length<2?"":e:cF(t)},dF=js,fF=tc,gF=function(t,e){dF(e)&&"cause"in e&&fF(t,"cause",e.cause)},mF=Fn,eP=Error,pF=mF("".replace),wF=function(t){return String(eP(t).stack)}("zxcasd"),tP=/\n\s*at [^:]*:[^\n]*/,CF=tP.test(wF),vF=function(t,e){if(CF&&typeof t=="string"&&!eP.prepareStackTrace)for(;e--;)t=pF(t,tP,"");return t},SF=Sr,yF=fC,bF=!SF(function(){var t=Error("a");return"stack"in t?(Object.defineProperty(t,"stack",yF(1,7)),t.stack!==7):!0}),RF=tc,EF=vF,TF=bF,Gb=Error.captureStackTrace,_F=function(t,e,n,r){TF&&(Gb?Gb(t,e):RF(t,"stack",EF(n,r)))},Yb=Ju,MF=ro,jb=tc,AF=AO,Kb=ZO,Xb=YO,qb=j$,OF=q$,PF=hF,IF=gF,xF=_F,HF=pi,DF=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=Yb.apply(null,s);if(l){var u=l.prototype;if(MF(u,"cause")&&delete u.cause,!n)return l;var c=Yb("Error"),h=e(function(f,g){var w=PF(r?g:f,void 0),C=r?new l(f):new l;return w!==void 0&&jb(C,"message",w),xF(C,h,C.stack,2),this&&AF(u,this)&&OF(C,this,h),arguments.length>o&&IF(C,arguments[o]),C});h.prototype=u,a!=="Error"?Kb?Kb(h,c):Xb(h,c,{name:!0}):HF&&i in l&&(qb(h,l,i),qb(h,l,"prepareStackTrace")),Xb(h,l);try{u.name!==a&&jb(u,"name",a),u.constructor=h}catch{}return h}},nP=Xs,NF=Rn,wi=mf,rP=DF,nw="WebAssembly",Zb=NF[nw],yd=Error("e",{cause:7}).cause!==7,qs=function(t,e){var n={};n[t]=rP(t,e,yd),nP({global:!0,constructor:!0,arity:1,forced:yd},n)},_C=function(t,e){if(Zb&&Zb[t]){var n={};n[t]=rP(nw+"."+t,e,yd),nP({target:nw,stat:!0,constructor:!0,arity:1,forced:yd},n)}};qs("Error",function(t){return function(n){return wi(t,this,arguments)}});qs("EvalError",function(t){return function(n){return wi(t,this,arguments)}});qs("RangeError",function(t){return function(n){return wi(t,this,arguments)}});qs("ReferenceError",function(t){return function(n){return wi(t,this,arguments)}});qs("SyntaxError",function(t){return function(n){return wi(t,this,arguments)}});qs("TypeError",function(t){return function(n){return wi(t,this,arguments)}});qs("URIError",function(t){return function(n){return wi(t,this,arguments)}});_C("CompileError",function(t){return function(n){return wi(t,this,arguments)}});_C("LinkError",function(t){return function(n){return wi(t,this,arguments)}});_C("RuntimeError",function(t){return function(n){return wi(t,this,arguments)}});var LF=ul,kF=Fn,$F=function(t){if(LF(t)==="Function")return kF(t)},Qb=$F,FF=wC,WF=uf,VF=Qb(Qb.bind),BF=function(t,e){return FF(t),e===void 0?t:WF?VF(t,e):function(){return t.apply(e,arguments)}},UF=Ju,iP=UF("document","documentElement"),zF=Fn,MC=zF([].slice),GF=TypeError,oP=function(t,e){if(t<e)throw GF("Not enough arguments");return t},YF=gC,jF=/(?:ipad|iphone|ipod).*applewebkit/i.test(YF),KF=Rn,XF=ul,qF=XF(KF.process)==="process",or=Rn,ZF=mf,QF=BF,Jb=dn,JF=ro,sP=Sr,eR=iP,eW=MC,tR=SC,tW=oP,nW=jF,rW=qF,rw=or.setImmediate,iw=or.clearImmediate,iW=or.process,_g=or.Dispatch,oW=or.Function,nR=or.MessageChannel,sW=or.String,Mg=0,mu={},rR="onreadystatechange",Du,Qo,Ag,Og;sP(function(){Du=or.location});var AC=function(t){if(JF(mu,t)){var e=mu[t];delete mu[t],e()}},Pg=function(t){return function(){AC(t)}},iR=function(t){AC(t.data)},oR=function(t){or.postMessage(sW(t),Du.protocol+"//"+Du.host)};(!rw||!iw)&&(rw=function(e){tW(arguments.length,1);var n=Jb(e)?e:oW(e),r=eW(arguments,1);return mu[++Mg]=function(){ZF(n,void 0,r)},Qo(Mg),Mg},iw=function(e){delete mu[e]},rW?Qo=function(t){iW.nextTick(Pg(t))}:_g&&_g.now?Qo=function(t){_g.now(Pg(t))}:nR&&!nW?(Ag=new nR,Og=Ag.port2,Ag.port1.onmessage=iR,Qo=QF(Og.postMessage,Og)):or.addEventListener&&Jb(or.postMessage)&&!or.importScripts&&Du&&Du.protocol!=="file:"&&!sP(oR)?(Qo=oR,or.addEventListener("message",iR,!1)):rR in tR("script")?Qo=function(t){eR.appendChild(tR("script"))[rR]=function(){eR.removeChild(this),AC(t)}}:Qo=function(t){setTimeout(Pg(t),0)});var aP={set:rw,clear:iw},aW=Xs,lW=Rn,sR=aP.clear;aW({global:!0,bind:!0,enumerable:!0,forced:lW.clearImmediate!==sR},{clearImmediate:sR});var uW=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",lP=Rn,cW=mf,hW=dn,dW=uW,fW=gC,gW=MC,mW=oP,pW=lP.Function,wW=/MSIE .\./.test(fW)||dW&&function(){var t=lP.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),CW=function(t,e){var n=e?2:1;return wW?function(r,i){var o=mW(arguments.length,1)>n,s=hW(r)?r:pW(r),a=o?gW(arguments,n):[],l=o?function(){cW(s,this,a)}:s;return e?t(l,i):t(l)}:t},vW=Xs,uP=Rn,aR=aP.set,SW=CW,lR=uP.setImmediate?SW(aR,!1):aR;vW({global:!0,bind:!0,enumerable:!0,forced:uP.setImmediate!==lR},{setImmediate:lR});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Mo(t){"@babel/helpers - typeof";return Mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mo(t)}function ow(t,e){return ow=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},ow(t,e)}function yW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yh(t,e,n){return yW()?Yh=Reflect.construct:Yh=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&ow(u,s.prototype),u},Yh.apply(null,arguments)}function Hr(t){return bW(t)||RW(t)||EW(t)||TW()}function bW(t){if(Array.isArray(t))return sw(t)}function RW(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function EW(t,e){if(t){if(typeof t=="string")return sw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sw(t,e)}}function sw(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function TW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _W=Object.hasOwnProperty,uR=Object.setPrototypeOf,MW=Object.isFrozen,AW=Object.getPrototypeOf,OW=Object.getOwnPropertyDescriptor,$n=Object.freeze,Br=Object.seal,PW=Object.create,cP=typeof Reflect<"u"&&Reflect,bd=cP.apply,aw=cP.construct;bd||(bd=function(e,n,r){return e.apply(n,r)});$n||($n=function(e){return e});Br||(Br=function(e){return e});aw||(aw=function(e,n){return Yh(e,Hr(n))});var IW=vr(Array.prototype.forEach),cR=vr(Array.prototype.pop),Rl=vr(Array.prototype.push),jh=vr(String.prototype.toLowerCase),Ig=vr(String.prototype.toString),xW=vr(String.prototype.match),Er=vr(String.prototype.replace),HW=vr(String.prototype.indexOf),DW=vr(String.prototype.trim),Mn=vr(RegExp.prototype.test),xg=NW(TypeError);function vr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return bd(t,e,r)}}function NW(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return aw(t,n)}}function je(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:jh,uR&&uR(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(MW(e)||(e[i]=s),o=s)}t[o]=!0}return t}function Jo(t){var e=PW(null),n;for(n in t)bd(_W,t,[n])===!0&&(e[n]=t[n]);return e}function Pc(t,e){for(;t!==null;){var n=OW(t,e);if(n){if(n.get)return vr(n.get);if(typeof n.value=="function")return vr(n.value)}t=AW(t)}function r(i){return console.warn("fallback value for",i),null}return r}var hR=$n(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Hg=$n(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Dg=$n(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),LW=$n(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Ng=$n(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),kW=$n(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),dR=$n(["#text"]),fR=$n(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Lg=$n(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),gR=$n(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ic=$n(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),$W=Br(/\{\{[\w\W]*|[\w\W]*\}\}/gm),FW=Br(/<%[\w\W]*|[\w\W]*%>/gm),WW=Br(/\${[\w\W]*}/gm),VW=Br(/^data-[\-\w.\u00B7-\uFFFF]/),BW=Br(/^aria-[\-\w]+$/),UW=Br(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),zW=Br(/^(?:\w+script|data):/i),GW=Br(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),YW=Br(/^html$/i),jW=function(){return typeof window>"u"?null:window},KW=function(e,n){if(Mo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function hP(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jW(),e=function(L){return hP(L)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,f=t.DOMParser,g=t.trustedTypes,w=a.prototype,C=Pc(w,"cloneNode"),S=Pc(w,"nextSibling"),b=Pc(w,"childNodes"),_=Pc(w,"parentNode");if(typeof o=="function"){var O=r.createElement("template");O.content&&O.content.ownerDocument&&(r=O.content.ownerDocument)}var x=KW(g,n),I=x?x.createHTML(""):"",$=r,z=$.implementation,q=$.createNodeIterator,Y=$.createDocumentFragment,K=$.getElementsByTagName,te=n.importNode,oe={};try{oe=Jo(r).documentMode?r.documentMode:{}}catch{}var ie={};e.isSupported=typeof _=="function"&&z&&z.createHTMLDocument!==void 0&&oe!==9;var ue=$W,Re=FW,Ue=WW,Ie=VW,R=BW,d=zW,m=GW,p=UW,E=null,M=je({},[].concat(Hr(hR),Hr(Hg),Hr(Dg),Hr(Ng),Hr(dR))),P=null,G=je({},[].concat(Hr(fR),Hr(Lg),Hr(gR),Hr(Ic))),V=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Z=null,Q=null,X=!0,he=!0,Ae=!1,_e=!0,Me=!1,j=!1,Ye=!1,Fe=!1,be=!1,xe=!1,ye=!1,v=!0,y=!1,A="user-content-",W=!0,H=!1,F={},D=null,N=je({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),B=null,k=je({},["audio","video","img","source","image","track"]),U=null,se=je({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),de="http://www.w3.org/1998/Math/MathML",Ce="http://www.w3.org/2000/svg",Oe="http://www.w3.org/1999/xhtml",ke=Oe,wt=!1,Xe=null,at=je({},[de,Ce,Oe],Ig),Rt,ia=["application/xhtml+xml","text/html"],yl="text/html",kt,an=null,Zo=r.createElement("form"),_n=function(L){return L instanceof RegExp||L instanceof Function},qt=function(L){an&&an===L||((!L||Mo(L)!=="object")&&(L={}),L=Jo(L),Rt=ia.indexOf(L.PARSER_MEDIA_TYPE)===-1?Rt=yl:Rt=L.PARSER_MEDIA_TYPE,kt=Rt==="application/xhtml+xml"?Ig:jh,E="ALLOWED_TAGS"in L?je({},L.ALLOWED_TAGS,kt):M,P="ALLOWED_ATTR"in L?je({},L.ALLOWED_ATTR,kt):G,Xe="ALLOWED_NAMESPACES"in L?je({},L.ALLOWED_NAMESPACES,Ig):at,U="ADD_URI_SAFE_ATTR"in L?je(Jo(se),L.ADD_URI_SAFE_ATTR,kt):se,B="ADD_DATA_URI_TAGS"in L?je(Jo(k),L.ADD_DATA_URI_TAGS,kt):k,D="FORBID_CONTENTS"in L?je({},L.FORBID_CONTENTS,kt):N,Z="FORBID_TAGS"in L?je({},L.FORBID_TAGS,kt):{},Q="FORBID_ATTR"in L?je({},L.FORBID_ATTR,kt):{},F="USE_PROFILES"in L?L.USE_PROFILES:!1,X=L.ALLOW_ARIA_ATTR!==!1,he=L.ALLOW_DATA_ATTR!==!1,Ae=L.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=L.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Me=L.SAFE_FOR_TEMPLATES||!1,j=L.WHOLE_DOCUMENT||!1,be=L.RETURN_DOM||!1,xe=L.RETURN_DOM_FRAGMENT||!1,ye=L.RETURN_TRUSTED_TYPE||!1,Fe=L.FORCE_BODY||!1,v=L.SANITIZE_DOM!==!1,y=L.SANITIZE_NAMED_PROPS||!1,W=L.KEEP_CONTENT!==!1,H=L.IN_PLACE||!1,p=L.ALLOWED_URI_REGEXP||p,ke=L.NAMESPACE||Oe,V=L.CUSTOM_ELEMENT_HANDLING||{},L.CUSTOM_ELEMENT_HANDLING&&_n(L.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(V.tagNameCheck=L.CUSTOM_ELEMENT_HANDLING.tagNameCheck),L.CUSTOM_ELEMENT_HANDLING&&_n(L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(V.attributeNameCheck=L.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),L.CUSTOM_ELEMENT_HANDLING&&typeof L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(V.allowCustomizedBuiltInElements=L.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Me&&(he=!1),xe&&(be=!0),F&&(E=je({},Hr(dR)),P=[],F.html===!0&&(je(E,hR),je(P,fR)),F.svg===!0&&(je(E,Hg),je(P,Lg),je(P,Ic)),F.svgFilters===!0&&(je(E,Dg),je(P,Lg),je(P,Ic)),F.mathMl===!0&&(je(E,Ng),je(P,gR),je(P,Ic))),L.ADD_TAGS&&(E===M&&(E=Jo(E)),je(E,L.ADD_TAGS,kt)),L.ADD_ATTR&&(P===G&&(P=Jo(P)),je(P,L.ADD_ATTR,kt)),L.ADD_URI_SAFE_ATTR&&je(U,L.ADD_URI_SAFE_ATTR,kt),L.FORBID_CONTENTS&&(D===N&&(D=Jo(D)),je(D,L.FORBID_CONTENTS,kt)),W&&(E["#text"]=!0),j&&je(E,["html","head","body"]),E.table&&(je(E,["tbody"]),delete Z.tbody),$n&&$n(L),an=L)},Ct=je({},["mi","mo","mn","ms","mtext"]),db=je({},["foreignobject","desc","title","annotation-xml"]),YD=je({},["title","style","font","a","script"]),Ec=je({},Hg);je(Ec,Dg),je(Ec,LW);var lg=je({},Ng);je(lg,kW);var jD=function(L){var re=_(L);(!re||!re.tagName)&&(re={namespaceURI:ke,tagName:"template"});var ae=jh(L.tagName),st=jh(re.tagName);return Xe[L.namespaceURI]?L.namespaceURI===Ce?re.namespaceURI===Oe?ae==="svg":re.namespaceURI===de?ae==="svg"&&(st==="annotation-xml"||Ct[st]):!!Ec[ae]:L.namespaceURI===de?re.namespaceURI===Oe?ae==="math":re.namespaceURI===Ce?ae==="math"&&db[st]:!!lg[ae]:L.namespaceURI===Oe?re.namespaceURI===Ce&&!db[st]||re.namespaceURI===de&&!Ct[st]?!1:!lg[ae]&&(YD[ae]||!Ec[ae]):!!(Rt==="application/xhtml+xml"&&Xe[L.namespaceURI]):!1},yi=function(L){Rl(e.removed,{element:L});try{L.parentNode.removeChild(L)}catch{try{L.outerHTML=I}catch{L.remove()}}},ug=function(L,re){try{Rl(e.removed,{attribute:re.getAttributeNode(L),from:re})}catch{Rl(e.removed,{attribute:null,from:re})}if(re.removeAttribute(L),L==="is"&&!P[L])if(be||xe)try{yi(re)}catch{}else try{re.setAttribute(L,"")}catch{}},fb=function(L){var re,ae;if(Fe)L="<remove></remove>"+L;else{var st=xW(L,/^[\r\n\t ]+/);ae=st&&st[0]}Rt==="application/xhtml+xml"&&ke===Oe&&(L='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+L+"</body></html>");var Vn=x?x.createHTML(L):L;if(ke===Oe)try{re=new f().parseFromString(Vn,Rt)}catch{}if(!re||!re.documentElement){re=z.createDocument(ke,"template",null);try{re.documentElement.innerHTML=wt?I:Vn}catch{}}var fn=re.body||re.documentElement;return L&&ae&&fn.insertBefore(r.createTextNode(ae),fn.childNodes[0]||null),ke===Oe?K.call(re,j?"html":"body")[0]:j?re.documentElement:fn},gb=function(L){return q.call(L.ownerDocument||L,L,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},KD=function(L){return L instanceof h&&(typeof L.nodeName!="string"||typeof L.textContent!="string"||typeof L.removeChild!="function"||!(L.attributes instanceof c)||typeof L.removeAttribute!="function"||typeof L.setAttribute!="function"||typeof L.namespaceURI!="string"||typeof L.insertBefore!="function"||typeof L.hasChildNodes!="function")},bl=function(L){return Mo(s)==="object"?L instanceof s:L&&Mo(L)==="object"&&typeof L.nodeType=="number"&&typeof L.nodeName=="string"},bi=function(L,re,ae){ie[L]&&IW(ie[L],function(st){st.call(e,re,ae,an)})},mb=function(L){var re;if(bi("beforeSanitizeElements",L,null),KD(L)||Mn(/[\u0080-\uFFFF]/,L.nodeName))return yi(L),!0;var ae=kt(L.nodeName);if(bi("uponSanitizeElement",L,{tagName:ae,allowedTags:E}),L.hasChildNodes()&&!bl(L.firstElementChild)&&(!bl(L.content)||!bl(L.content.firstElementChild))&&Mn(/<[/\w]/g,L.innerHTML)&&Mn(/<[/\w]/g,L.textContent)||ae==="select"&&Mn(/<template/i,L.innerHTML))return yi(L),!0;if(!E[ae]||Z[ae]){if(!Z[ae]&&wb(ae)&&(V.tagNameCheck instanceof RegExp&&Mn(V.tagNameCheck,ae)||V.tagNameCheck instanceof Function&&V.tagNameCheck(ae)))return!1;if(W&&!D[ae]){var st=_(L)||L.parentNode,Vn=b(L)||L.childNodes;if(Vn&&st)for(var fn=Vn.length,ln=fn-1;ln>=0;--ln)st.insertBefore(C(Vn[ln],!0),S(L))}return yi(L),!0}return L instanceof a&&!jD(L)||(ae==="noscript"||ae==="noembed"||ae==="noframes")&&Mn(/<\/no(script|embed|frames)/i,L.innerHTML)?(yi(L),!0):(Me&&L.nodeType===3&&(re=L.textContent,re=Er(re,ue," "),re=Er(re,Re," "),re=Er(re,Ue," "),L.textContent!==re&&(Rl(e.removed,{element:L.cloneNode()}),L.textContent=re)),bi("afterSanitizeElements",L,null),!1)},pb=function(L,re,ae){if(v&&(re==="id"||re==="name")&&(ae in r||ae in Zo))return!1;if(!(he&&!Q[re]&&Mn(Ie,re))){if(!(X&&Mn(R,re))){if(!P[re]||Q[re]){if(!(wb(L)&&(V.tagNameCheck instanceof RegExp&&Mn(V.tagNameCheck,L)||V.tagNameCheck instanceof Function&&V.tagNameCheck(L))&&(V.attributeNameCheck instanceof RegExp&&Mn(V.attributeNameCheck,re)||V.attributeNameCheck instanceof Function&&V.attributeNameCheck(re))||re==="is"&&V.allowCustomizedBuiltInElements&&(V.tagNameCheck instanceof RegExp&&Mn(V.tagNameCheck,ae)||V.tagNameCheck instanceof Function&&V.tagNameCheck(ae))))return!1}else if(!U[re]){if(!Mn(p,Er(ae,m,""))){if(!((re==="src"||re==="xlink:href"||re==="href")&&L!=="script"&&HW(ae,"data:")===0&&B[L])){if(!(Ae&&!Mn(d,Er(ae,m,"")))){if(ae)return!1}}}}}}return!0},wb=function(L){return L.indexOf("-")>0},Cb=function(L){var re,ae,st,Vn;bi("beforeSanitizeAttributes",L,null);var fn=L.attributes;if(fn){var ln={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P};for(Vn=fn.length;Vn--;){re=fn[Vn];var Tc=re,en=Tc.name,cg=Tc.namespaceURI;if(ae=en==="value"?re.value:DW(re.value),st=kt(en),ln.attrName=st,ln.attrValue=ae,ln.keepAttr=!0,ln.forceKeepAttr=void 0,bi("uponSanitizeAttribute",L,ln),ae=ln.attrValue,!ln.forceKeepAttr&&(ug(en,L),!!ln.keepAttr)){if(!_e&&Mn(/\/>/i,ae)){ug(en,L);continue}Me&&(ae=Er(ae,ue," "),ae=Er(ae,Re," "),ae=Er(ae,Ue," "));var vb=kt(L.nodeName);if(pb(vb,st,ae)){if(y&&(st==="id"||st==="name")&&(ug(en,L),ae=A+ae),x&&Mo(g)==="object"&&typeof g.getAttributeType=="function"&&!cg)switch(g.getAttributeType(vb,st)){case"TrustedHTML":{ae=x.createHTML(ae);break}case"TrustedScriptURL":{ae=x.createScriptURL(ae);break}}try{cg?L.setAttributeNS(cg,en,ae):L.setAttribute(en,ae),cR(e.removed)}catch{}}}}bi("afterSanitizeAttributes",L,null)}},XD=function Ee(L){var re,ae=gb(L);for(bi("beforeSanitizeShadowDOM",L,null);re=ae.nextNode();)bi("uponSanitizeShadowNode",re,null),!mb(re)&&(re.content instanceof i&&Ee(re.content),Cb(re));bi("afterSanitizeShadowDOM",L,null)};return e.sanitize=function(Ee){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re,ae,st,Vn,fn;if(wt=!Ee,wt&&(Ee="<!-->"),typeof Ee!="string"&&!bl(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw xg("dirty is not a string, aborting")}else throw xg("toString is not a function");if(!e.isSupported){if(Mo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Ee=="string")return t.toStaticHTML(Ee);if(bl(Ee))return t.toStaticHTML(Ee.outerHTML)}return Ee}if(Ye||qt(L),e.removed=[],typeof Ee=="string"&&(H=!1),H){if(Ee.nodeName){var ln=kt(Ee.nodeName);if(!E[ln]||Z[ln])throw xg("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof s)re=fb("<!---->"),ae=re.ownerDocument.importNode(Ee,!0),ae.nodeType===1&&ae.nodeName==="BODY"||ae.nodeName==="HTML"?re=ae:re.appendChild(ae);else{if(!be&&!Me&&!j&&Ee.indexOf("<")===-1)return x&&ye?x.createHTML(Ee):Ee;if(re=fb(Ee),!re)return be?null:ye?I:""}re&&Fe&&yi(re.firstChild);for(var Tc=gb(H?Ee:re);st=Tc.nextNode();)st.nodeType===3&&st===Vn||mb(st)||(st.content instanceof i&&XD(st.content),Cb(st),Vn=st);if(Vn=null,H)return Ee;if(be){if(xe)for(fn=Y.call(re.ownerDocument);re.firstChild;)fn.appendChild(re.firstChild);else fn=re;return(P.shadowroot||P.shadowrootmod)&&(fn=te.call(n,fn,!0)),fn}var en=j?re.outerHTML:re.innerHTML;return j&&E["!doctype"]&&re.ownerDocument&&re.ownerDocument.doctype&&re.ownerDocument.doctype.name&&Mn(YW,re.ownerDocument.doctype.name)&&(en="<!DOCTYPE "+re.ownerDocument.doctype.name+`>
`+en),Me&&(en=Er(en,ue," "),en=Er(en,Re," "),en=Er(en,Ue," ")),x&&ye?x.createHTML(en):en},e.setConfig=function(Ee){qt(Ee),Ye=!0},e.clearConfig=function(){an=null,Ye=!1},e.isValidAttribute=function(Ee,L,re){an||qt({});var ae=kt(Ee),st=kt(L);return pb(ae,st,re)},e.addHook=function(Ee,L){typeof L=="function"&&(ie[Ee]=ie[Ee]||[],Rl(ie[Ee],L))},e.removeHook=function(Ee){if(ie[Ee])return cR(ie[Ee])},e.removeHooks=function(Ee){ie[Ee]&&(ie[Ee]=[])},e.removeAllHooks=function(){ie={}},e}var XW=hP();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var dP;function J(){return dP.apply(null,arguments)}function qW(t){dP=t}function Ur(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Ws(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function it(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function OC(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(it(t,e))return!1;return!0}function Yn(t){return t===void 0}function Ji(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function rc(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function fP(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function Oo(t,e){for(var n in e)it(e,n)&&(t[n]=e[n]);return it(e,"toString")&&(t.toString=e.toString),it(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ci(t,e,n,r){return kP(t,e,n,r,!0).utc()}function ZW(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(t){return t._pf==null&&(t._pf=ZW()),t._pf}var lw;Array.prototype.some?lw=Array.prototype.some:lw=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function PC(t){if(t._isValid==null){var e=ze(t),n=lw.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function pf(t){var e=Ci(NaN);return t!=null?Oo(ze(e),t):ze(e).userInvalidated=!0,e}var mR=J.momentProperties=[],kg=!1;function IC(t,e){var n,r,i,o=mR.length;if(Yn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Yn(e._i)||(t._i=e._i),Yn(e._f)||(t._f=e._f),Yn(e._l)||(t._l=e._l),Yn(e._strict)||(t._strict=e._strict),Yn(e._tzm)||(t._tzm=e._tzm),Yn(e._isUTC)||(t._isUTC=e._isUTC),Yn(e._offset)||(t._offset=e._offset),Yn(e._pf)||(t._pf=ze(e)),Yn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=mR[n],i=e[r],Yn(i)||(t[r]=i);return t}function ic(t){IC(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),kg===!1&&(kg=!0,J.updateOffset(this),kg=!1)}function zr(t){return t instanceof ic||t!=null&&t._isAMomentObject!=null}function gP(t){J.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function yr(t,e){var n=!0;return Oo(function(){if(J.deprecationHandler!=null&&J.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])it(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}gP(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var pR={};function mP(t,e){J.deprecationHandler!=null&&J.deprecationHandler(t,e),pR[t]||(gP(e),pR[t]=!0)}J.suppressDeprecationWarnings=!1;J.deprecationHandler=null;function vi(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function QW(t){var e,n;for(n in t)it(t,n)&&(e=t[n],vi(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function uw(t,e){var n=Oo({},t),r;for(r in e)it(e,r)&&(Ws(t[r])&&Ws(e[r])?(n[r]={},Oo(n[r],t[r]),Oo(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)it(t,r)&&!it(e,r)&&Ws(t[r])&&(n[r]=Oo({},n[r]));return n}function xC(t){t!=null&&this.set(t)}var cw;Object.keys?cw=Object.keys:cw=function(t){var e,n=[];for(e in t)it(t,e)&&n.push(e);return n};var JW={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function eV(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return vi(r)?r.call(e,n):r}function mi(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var HC=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,xc=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,$g={},Ja={};function Te(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Ja[t]=i),e&&(Ja[e[0]]=function(){return mi(i.apply(this,arguments),e[1],e[2])}),n&&(Ja[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function tV(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function nV(t){var e=t.match(HC),n,r;for(n=0,r=e.length;n<r;n++)Ja[e[n]]?e[n]=Ja[e[n]]:e[n]=tV(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=vi(e[s])?e[s].call(i,t):e[s];return o}}function Kh(t,e){return t.isValid()?(e=pP(e,t.localeData()),$g[e]=$g[e]||nV(e),$g[e](t)):t.localeData().invalidDate()}function pP(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(xc.lastIndex=0;n>=0&&xc.test(t);)t=t.replace(xc,r),xc.lastIndex=0,n-=1;return t}var rV={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function iV(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(HC).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var oV="Invalid date";function sV(){return this._invalidDate}var aV="%d",lV=/\d{1,2}/;function uV(t){return this._ordinal.replace("%d",t)}var cV={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function hV(t,e,n,r){var i=this._relativeTime[n];return vi(i)?i(t,e,n,r):i.replace(/%d/i,t)}function dV(t,e){var n=this._relativeTime[t>0?"future":"past"];return vi(n)?n(e):n.replace(/%s/i,e)}var pu={};function En(t,e){var n=t.toLowerCase();pu[n]=pu[n+"s"]=pu[e]=t}function br(t){return typeof t=="string"?pu[t]||pu[t.toLowerCase()]:void 0}function DC(t){var e={},n,r;for(r in t)it(t,r)&&(n=br(r),n&&(e[n]=t[r]));return e}var wP={};function Tn(t,e){wP[t]=e}function fV(t){var e=[],n;for(n in t)it(t,n)&&e.push({unit:n,priority:wP[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function wf(t){return t%4===0&&t%100!==0||t%400===0}function Cr(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Qe(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Cr(e)),n}function cl(t,e){return function(n){return n!=null?(CP(this,t,n),J.updateOffset(this,e),this):Rd(this,t)}}function Rd(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function CP(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&wf(t.year())&&t.month()===1&&t.date()===29?(n=Qe(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Rf(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function gV(t){return t=br(t),vi(this[t])?this[t]():this}function mV(t,e){if(typeof t=="object"){t=DC(t);var n=fV(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=br(t),vi(this[t]))return this[t](e);return this}var vP=/\d/,lr=/\d\d/,SP=/\d{3}/,NC=/\d{4}/,Cf=/[+-]?\d{6}/,bt=/\d\d?/,yP=/\d\d\d\d?/,bP=/\d\d\d\d\d\d?/,vf=/\d{1,3}/,LC=/\d{1,4}/,Sf=/[+-]?\d{1,6}/,hl=/\d+/,yf=/[+-]?\d+/,pV=/Z|[+-]\d\d:?\d\d/gi,bf=/Z|[+-]\d\d(?::?\d\d)?/gi,wV=/[+-]?\d+(\.\d{1,3})?/,oc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ed;Ed={};function me(t,e,n){Ed[t]=vi(e)?e:function(r,i){return r&&n?n:e}}function CV(t,e){return it(Ed,t)?Ed[t](e._strict,e._locale):new RegExp(vV(t))}function vV(t){return ir(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function ir(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var hw={};function ht(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),Ji(e)&&(r=function(o,s){s[e]=Qe(o)}),i=t.length,n=0;n<i;n++)hw[t[n]]=r}function sc(t,e){ht(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function SV(t,e,n){e!=null&&it(hw,t)&&hw[t](e,n._a,n,t)}var Sn=0,Ui=1,hi=2,Qt=3,$r=4,zi=5,Ds=6,yV=7,bV=8;function RV(t,e){return(t%e+e)%e}var Vt;Array.prototype.indexOf?Vt=Array.prototype.indexOf:Vt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Rf(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=RV(e,12);return t+=(e-n)/12,n===1?wf(t)?29:28:31-n%7%2}Te("M",["MM",2],"Mo",function(){return this.month()+1});Te("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Te("MMMM",0,0,function(t){return this.localeData().months(this,t)});En("month","M");Tn("month",8);me("M",bt);me("MM",bt,lr);me("MMM",function(t,e){return e.monthsShortRegex(t)});me("MMMM",function(t,e){return e.monthsRegex(t)});ht(["M","MM"],function(t,e){e[Ui]=Qe(t)-1});ht(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[Ui]=i:ze(n).invalidMonth=t});var EV="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),RP="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),EP=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,TV=oc,_V=oc;function MV(t,e){return t?Ur(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||EP).test(e)?"format":"standalone"][t.month()]:Ur(this._months)?this._months:this._months.standalone}function AV(t,e){return t?Ur(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[EP.test(e)?"format":"standalone"][t.month()]:Ur(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function OV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Ci([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Vt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:(i=Vt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Vt.call(this._longMonthsParse,s),i!==-1?i:(i=Vt.call(this._shortMonthsParse,s),i!==-1?i:null))}function PV(t,e,n){var r,i,o;if(this._monthsParseExact)return OV.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Ci([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function TP(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Qe(e);else if(e=t.localeData().monthsParse(e),!Ji(e))return t}return n=Math.min(t.date(),Rf(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function _P(t){return t!=null?(TP(this,t),J.updateOffset(this,!0),this):Rd(this,"Month")}function IV(){return Rf(this.year(),this.month())}function xV(t){return this._monthsParseExact?(it(this,"_monthsRegex")||MP.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=TV),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function HV(t){return this._monthsParseExact?(it(this,"_monthsRegex")||MP.call(this),t?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=_V),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function MP(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=Ci([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=ir(e[i]),n[i]=ir(n[i]);for(i=0;i<24;i++)r[i]=ir(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}Te("Y",0,0,function(){var t=this.year();return t<=9999?mi(t,4):"+"+t});Te(0,["YY",2],0,function(){return this.year()%100});Te(0,["YYYY",4],0,"year");Te(0,["YYYYY",5],0,"year");Te(0,["YYYYYY",6,!0],0,"year");En("year","y");Tn("year",1);me("Y",yf);me("YY",bt,lr);me("YYYY",LC,NC);me("YYYYY",Sf,Cf);me("YYYYYY",Sf,Cf);ht(["YYYYY","YYYYYY"],Sn);ht("YYYY",function(t,e){e[Sn]=t.length===2?J.parseTwoDigitYear(t):Qe(t)});ht("YY",function(t,e){e[Sn]=J.parseTwoDigitYear(t)});ht("Y",function(t,e){e[Sn]=parseInt(t,10)});function wu(t){return wf(t)?366:365}J.parseTwoDigitYear=function(t){return Qe(t)+(Qe(t)>68?1900:2e3)};var AP=cl("FullYear",!0);function DV(){return wf(this.year())}function NV(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Nu(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Td(t,e,n){var r=7+e-n,i=(7+Nu(t,0,r).getUTCDay()-e)%7;return-i+r-1}function OP(t,e,n,r,i){var o=(7+n-r)%7,s=Td(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=wu(l)+a):a>wu(t)?(l=t+1,u=a-wu(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Lu(t,e,n){var r=Td(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+Qi(s,e,n)):i>Qi(t.year(),e,n)?(o=i-Qi(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function Qi(t,e,n){var r=Td(t,e,n),i=Td(t+1,e,n);return(wu(t)-r+i)/7}Te("w",["ww",2],"wo","week");Te("W",["WW",2],"Wo","isoWeek");En("week","w");En("isoWeek","W");Tn("week",5);Tn("isoWeek",5);me("w",bt);me("ww",bt,lr);me("W",bt);me("WW",bt,lr);sc(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=Qe(t)});function LV(t){return Lu(t,this._week.dow,this._week.doy).week}var kV={dow:0,doy:6};function $V(){return this._week.dow}function FV(){return this._week.doy}function WV(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function VV(t){var e=Lu(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Te("d",0,"do","day");Te("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Te("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Te("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Te("e",0,0,"weekday");Te("E",0,0,"isoWeekday");En("day","d");En("weekday","e");En("isoWeekday","E");Tn("day",11);Tn("weekday",11);Tn("isoWeekday",11);me("d",bt);me("e",bt);me("E",bt);me("dd",function(t,e){return e.weekdaysMinRegex(t)});me("ddd",function(t,e){return e.weekdaysShortRegex(t)});me("dddd",function(t,e){return e.weekdaysRegex(t)});sc(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:ze(n).invalidWeekday=t});sc(["d","e","E"],function(t,e,n,r){e[r]=Qe(t)});function BV(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function UV(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function kC(t,e){return t.slice(e,7).concat(t.slice(0,e))}var zV="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),PP="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),GV="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),YV=oc,jV=oc,KV=oc;function XV(t,e){var n=Ur(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?kC(n,this._week.dow):t?n[t.day()]:n}function qV(t){return t===!0?kC(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function ZV(t){return t===!0?kC(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function QV(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Ci([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Vt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Vt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Vt.call(this._weekdaysParse,s),i!==-1||(i=Vt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Vt.call(this._shortWeekdaysParse,s),i!==-1||(i=Vt.call(this._weekdaysParse,s),i!==-1)?i:(i=Vt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Vt.call(this._minWeekdaysParse,s),i!==-1||(i=Vt.call(this._weekdaysParse,s),i!==-1)?i:(i=Vt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function JV(t,e,n){var r,i,o;if(this._weekdaysParseExact)return QV.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Ci([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function eB(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=BV(t,this.localeData()),this.add(t-e,"d")):e}function tB(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function nB(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=UV(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function rB(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||$C.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=YV),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function iB(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||$C.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jV),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function oB(t){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||$C.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=KV),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function $C(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Ci([2e3,1]).day(o),a=ir(this.weekdaysMin(s,"")),l=ir(this.weekdaysShort(s,"")),u=ir(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function FC(){return this.hours()%12||12}function sB(){return this.hours()||24}Te("H",["HH",2],0,"hour");Te("h",["hh",2],0,FC);Te("k",["kk",2],0,sB);Te("hmm",0,0,function(){return""+FC.apply(this)+mi(this.minutes(),2)});Te("hmmss",0,0,function(){return""+FC.apply(this)+mi(this.minutes(),2)+mi(this.seconds(),2)});Te("Hmm",0,0,function(){return""+this.hours()+mi(this.minutes(),2)});Te("Hmmss",0,0,function(){return""+this.hours()+mi(this.minutes(),2)+mi(this.seconds(),2)});function IP(t,e){Te(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}IP("a",!0);IP("A",!1);En("hour","h");Tn("hour",13);function xP(t,e){return e._meridiemParse}me("a",xP);me("A",xP);me("H",bt);me("h",bt);me("k",bt);me("HH",bt,lr);me("hh",bt,lr);me("kk",bt,lr);me("hmm",yP);me("hmmss",bP);me("Hmm",yP);me("Hmmss",bP);ht(["H","HH"],Qt);ht(["k","kk"],function(t,e,n){var r=Qe(t);e[Qt]=r===24?0:r});ht(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});ht(["h","hh"],function(t,e,n){e[Qt]=Qe(t),ze(n).bigHour=!0});ht("hmm",function(t,e,n){var r=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[$r]=Qe(t.substr(r)),ze(n).bigHour=!0});ht("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[$r]=Qe(t.substr(r,2)),e[zi]=Qe(t.substr(i)),ze(n).bigHour=!0});ht("Hmm",function(t,e,n){var r=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[$r]=Qe(t.substr(r))});ht("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[Qt]=Qe(t.substr(0,r)),e[$r]=Qe(t.substr(r,2)),e[zi]=Qe(t.substr(i))});function aB(t){return(t+"").toLowerCase().charAt(0)==="p"}var lB=/[ap]\.?m?\.?/i,uB=cl("Hours",!0);function cB(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var HP={calendar:JW,longDateFormat:rV,invalidDate:oV,ordinal:aV,dayOfMonthOrdinalParse:lV,relativeTime:cV,months:EV,monthsShort:RP,week:kV,weekdays:zV,weekdaysMin:GV,weekdaysShort:PP,meridiemParse:lB},_t={},El={},ku;function hB(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function wR(t){return t&&t.toLowerCase().replace("_","-")}function dB(t){for(var e=0,n,r,i,o;e<t.length;){for(o=wR(t[e]).split("-"),n=o.length,r=wR(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Ef(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&hB(o,r)>=n-1)break;n--}e++}return ku}function fB(t){return t.match("^[^/\\\\]*$")!=null}function Ef(t){var e=null,n;if(_t[t]===void 0&&typeof wd<"u"&&wd&&wd.exports&&fB(t))try{e=ku._abbr,n=require,n("./locale/"+t),Do(e)}catch{_t[t]=null}return _t[t]}function Do(t,e){var n;return t&&(Yn(e)?n=io(t):n=WC(t,e),n?ku=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),ku._abbr}function WC(t,e){if(e!==null){var n,r=HP;if(e.abbr=t,_t[t]!=null)mP("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=_t[t]._config;else if(e.parentLocale!=null)if(_t[e.parentLocale]!=null)r=_t[e.parentLocale]._config;else if(n=Ef(e.parentLocale),n!=null)r=n._config;else return El[e.parentLocale]||(El[e.parentLocale]=[]),El[e.parentLocale].push({name:t,config:e}),null;return _t[t]=new xC(uw(r,e)),El[t]&&El[t].forEach(function(i){WC(i.name,i.config)}),Do(t),_t[t]}else return delete _t[t],null}function gB(t,e){if(e!=null){var n,r,i=HP;_t[t]!=null&&_t[t].parentLocale!=null?_t[t].set(uw(_t[t]._config,e)):(r=Ef(t),r!=null&&(i=r._config),e=uw(i,e),r==null&&(e.abbr=t),n=new xC(e),n.parentLocale=_t[t],_t[t]=n),Do(t)}else _t[t]!=null&&(_t[t].parentLocale!=null?(_t[t]=_t[t].parentLocale,t===Do()&&Do(t)):_t[t]!=null&&delete _t[t]);return _t[t]}function io(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return ku;if(!Ur(t)){if(e=Ef(t),e)return e;t=[t]}return dB(t)}function mB(){return cw(_t)}function VC(t){var e,n=t._a;return n&&ze(t).overflow===-2&&(e=n[Ui]<0||n[Ui]>11?Ui:n[hi]<1||n[hi]>Rf(n[Sn],n[Ui])?hi:n[Qt]<0||n[Qt]>24||n[Qt]===24&&(n[$r]!==0||n[zi]!==0||n[Ds]!==0)?Qt:n[$r]<0||n[$r]>59?$r:n[zi]<0||n[zi]>59?zi:n[Ds]<0||n[Ds]>999?Ds:-1,ze(t)._overflowDayOfYear&&(e<Sn||e>hi)&&(e=hi),ze(t)._overflowWeeks&&e===-1&&(e=yV),ze(t)._overflowWeekday&&e===-1&&(e=bV),ze(t).overflow=e),t}var pB=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wB=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,CB=/Z|[+-]\d\d(?::?\d\d)?/,Hc=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Fg=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],vB=/^\/?Date\((-?\d+)/i,SB=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yB={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function DP(t){var e,n,r=t._i,i=pB.exec(r)||wB.exec(r),o,s,a,l,u=Hc.length,c=Fg.length;if(i){for(ze(t).iso=!0,e=0,n=u;e<n;e++)if(Hc[e][1].exec(i[1])){s=Hc[e][0],o=Hc[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Fg[e][1].exec(i[3])){a=(i[2]||" ")+Fg[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(CB.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),UC(t)}else t._isValid=!1}function bB(t,e,n,r,i,o){var s=[RB(t),RP.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function RB(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function EB(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function TB(t,e,n){if(t){var r=PP.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return ze(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function _B(t,e,n){if(t)return yB[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function NP(t){var e=SB.exec(EB(t._i)),n;if(e){if(n=bB(e[4],e[3],e[2],e[5],e[6],e[7]),!TB(e[1],n,t))return;t._a=n,t._tzm=_B(e[8],e[9],e[10]),t._d=Nu.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ze(t).rfc2822=!0}else t._isValid=!1}function MB(t){var e=vB.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(DP(t),t._isValid===!1)delete t._isValid;else return;if(NP(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:J.createFromInputFallback(t)}J.createFromInputFallback=yr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Ua(t,e,n){return t??e??n}function AB(t){var e=new Date(J.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function BC(t){var e,n,r=[],i,o,s;if(!t._d){for(i=AB(t),t._w&&t._a[hi]==null&&t._a[Ui]==null&&OB(t),t._dayOfYear!=null&&(s=Ua(t._a[Sn],i[Sn]),(t._dayOfYear>wu(s)||t._dayOfYear===0)&&(ze(t)._overflowDayOfYear=!0),n=Nu(s,0,t._dayOfYear),t._a[Ui]=n.getUTCMonth(),t._a[hi]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Qt]===24&&t._a[$r]===0&&t._a[zi]===0&&t._a[Ds]===0&&(t._nextDay=!0,t._a[Qt]=0),t._d=(t._useUTC?Nu:NV).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Qt]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ze(t).weekdayMismatch=!0)}}function OB(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=Ua(e.GG,t._a[Sn],Lu(yt(),1,4).year),r=Ua(e.W,1),i=Ua(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Lu(yt(),o,s),n=Ua(e.gg,t._a[Sn],u.year),r=Ua(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>Qi(n,o,s)?ze(t)._overflowWeeks=!0:l!=null?ze(t)._overflowWeekday=!0:(a=OP(n,r,i,o,s),t._a[Sn]=a.year,t._dayOfYear=a.dayOfYear)}J.ISO_8601=function(){};J.RFC_2822=function(){};function UC(t){if(t._f===J.ISO_8601){DP(t);return}if(t._f===J.RFC_2822){NP(t);return}t._a=[],ze(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=pP(t._f,t._locale).match(HC)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(CV(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&ze(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Ja[o]?(r?ze(t).empty=!1:ze(t).unusedTokens.push(o),SV(o,r,t)):t._strict&&!r&&ze(t).unusedTokens.push(o);ze(t).charsLeftOver=a-l,e.length>0&&ze(t).unusedInput.push(e),t._a[Qt]<=12&&ze(t).bigHour===!0&&t._a[Qt]>0&&(ze(t).bigHour=void 0),ze(t).parsedDateParts=t._a.slice(0),ze(t).meridiem=t._meridiem,t._a[Qt]=PB(t._locale,t._a[Qt],t._meridiem),u=ze(t).era,u!==null&&(t._a[Sn]=t._locale.erasConvertYear(u,t._a[Sn])),BC(t),VC(t)}function PB(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function IB(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){ze(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=IC({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],UC(e),PC(e)&&(s=!0),o+=ze(e).charsLeftOver,o+=ze(e).unusedTokens.length*10,ze(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));Oo(t,n||e)}function xB(t){if(!t._d){var e=DC(t._i),n=e.day===void 0?e.date:e.day;t._a=fP([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),BC(t)}}function HB(t){var e=new ic(VC(LP(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function LP(t){var e=t._i,n=t._f;return t._locale=t._locale||io(t._l),e===null||n===void 0&&e===""?pf({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),zr(e)?new ic(VC(e)):(rc(e)?t._d=e:Ur(n)?IB(t):n?UC(t):DB(t),PC(t)||(t._d=null),t))}function DB(t){var e=t._i;Yn(e)?t._d=new Date(J.now()):rc(e)?t._d=new Date(e.valueOf()):typeof e=="string"?MB(t):Ur(e)?(t._a=fP(e.slice(0),function(n){return parseInt(n,10)}),BC(t)):Ws(e)?xB(t):Ji(e)?t._d=new Date(e):J.createFromInputFallback(t)}function kP(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(Ws(t)&&OC(t)||Ur(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,HB(o)}function yt(t,e,n,r){return kP(t,e,n,r,!1)}var NB=yr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=yt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:pf()}),LB=yr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=yt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:pf()});function $P(t,e){var n,r;if(e.length===1&&Ur(e[0])&&(e=e[0]),!e.length)return yt();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function kB(){var t=[].slice.call(arguments,0);return $P("isBefore",t)}function $B(){var t=[].slice.call(arguments,0);return $P("isAfter",t)}var FB=function(){return Date.now?Date.now():+new Date},Tl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function WB(t){var e,n=!1,r,i=Tl.length;for(e in t)if(it(t,e)&&!(Vt.call(Tl,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[Tl[r]]){if(n)return!1;parseFloat(t[Tl[r]])!==Qe(t[Tl[r]])&&(n=!0)}return!0}function VB(){return this._isValid}function BB(){return Yr(NaN)}function Tf(t){var e=DC(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=WB(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=io(),this._bubble()}function Xh(t){return t instanceof Tf}function dw(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function UB(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&Qe(t[s])!==Qe(e[s]))&&o++;return o+i}function FP(t,e){Te(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+mi(~~(n/60),2)+e+mi(~~n%60,2)})}FP("Z",":");FP("ZZ","");me("Z",bf);me("ZZ",bf);ht(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=zC(bf,t)});var zB=/([\+\-]|\d\d)/gi;function zC(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(zB)||["-",0,0],o=+(i[1]*60)+Qe(i[2]),o===0?0:i[0]==="+"?o:-o)}function GC(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(zr(t)||rc(t)?t.valueOf():yt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),J.updateOffset(n,!1),n):yt(t).local()}function fw(t){return-Math.round(t._d.getTimezoneOffset())}J.updateOffset=function(){};function GB(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=zC(bf,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=fw(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?BP(this,Yr(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,J.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:fw(this)}function YB(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function jB(t){return this.utcOffset(0,t)}function KB(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(fw(this),"m")),this}function XB(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=zC(pV,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function qB(t){return this.isValid()?(t=t?yt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function ZB(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function QB(){if(!Yn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return IC(t,this),t=LP(t),t._a?(e=t._isUTC?Ci(t._a):yt(t._a),this._isDSTShifted=this.isValid()&&UB(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function JB(){return this.isValid()?!this._isUTC:!1}function eU(){return this.isValid()?this._isUTC:!1}function WP(){return this.isValid()?this._isUTC&&this._offset===0:!1}var tU=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,nU=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Yr(t,e){var n=t,r=null,i,o,s;return Xh(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:Ji(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=tU.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:Qe(r[hi])*i,h:Qe(r[Qt])*i,m:Qe(r[$r])*i,s:Qe(r[zi])*i,ms:Qe(dw(r[Ds]*1e3))*i}):(r=nU.exec(t))?(i=r[1]==="-"?-1:1,n={y:es(r[2],i),M:es(r[3],i),w:es(r[4],i),d:es(r[5],i),h:es(r[6],i),m:es(r[7],i),s:es(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=rU(yt(n.from),yt(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Tf(n),Xh(t)&&it(t,"_locale")&&(o._locale=t._locale),Xh(t)&&it(t,"_isValid")&&(o._isValid=t._isValid),o}Yr.fn=Tf.prototype;Yr.invalid=BB;function es(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function CR(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function rU(t,e){var n;return t.isValid()&&e.isValid()?(e=GC(e,t),t.isBefore(e)?n=CR(t,e):(n=CR(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function VP(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(mP(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=Yr(n,r),BP(this,i,t),this}}function BP(t,e,n,r){var i=e._milliseconds,o=dw(e._days),s=dw(e._months);t.isValid()&&(r=r??!0,s&&TP(t,Rd(t,"Month")+s*n),o&&CP(t,"Date",Rd(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&J.updateOffset(t,o||s))}var iU=VP(1,"add"),oU=VP(-1,"subtract");function UP(t){return typeof t=="string"||t instanceof String}function sU(t){return zr(t)||rc(t)||UP(t)||Ji(t)||lU(t)||aU(t)||t===null||t===void 0}function aU(t){var e=Ws(t)&&!OC(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||it(t,o);return e&&n}function lU(t){var e=Ur(t),n=!1;return e&&(n=t.filter(function(r){return!Ji(r)&&UP(t)}).length===0),e&&n}function uU(t){var e=Ws(t)&&!OC(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||it(t,o);return e&&n}function cU(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function hU(t,e){arguments.length===1&&(arguments[0]?sU(arguments[0])?(t=arguments[0],e=void 0):uU(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||yt(),r=GC(n,this).startOf("day"),i=J.calendarFormat(this,r)||"sameElse",o=e&&(vi(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,yt(n)))}function dU(){return new ic(this)}function fU(t,e){var n=zr(t)?t:yt(t);return this.isValid()&&n.isValid()?(e=br(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function gU(t,e){var n=zr(t)?t:yt(t);return this.isValid()&&n.isValid()?(e=br(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function mU(t,e,n,r){var i=zr(t)?t:yt(t),o=zr(e)?e:yt(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function pU(t,e){var n=zr(t)?t:yt(t),r;return this.isValid()&&n.isValid()?(e=br(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function wU(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function CU(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function vU(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=GC(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=br(e),e){case"year":o=qh(this,r)/12;break;case"month":o=qh(this,r);break;case"quarter":o=qh(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Cr(o)}function qh(t,e){if(t.date()<e.date())return-qh(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}J.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";J.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function SU(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function yU(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Kh(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):vi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Kh(n,"Z")):Kh(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function bU(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function RU(t){t||(t=this.isUtc()?J.defaultFormatUtc:J.defaultFormat);var e=Kh(this,t);return this.localeData().postformat(e)}function EU(t,e){return this.isValid()&&(zr(t)&&t.isValid()||yt(t).isValid())?Yr({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function TU(t){return this.from(yt(),t)}function _U(t,e){return this.isValid()&&(zr(t)&&t.isValid()||yt(t).isValid())?Yr({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function MU(t){return this.to(yt(),t)}function zP(t){var e;return t===void 0?this._locale._abbr:(e=io(t),e!=null&&(this._locale=e),this)}var GP=yr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function YP(){return this._locale}var _d=1e3,el=60*_d,Md=60*el,jP=(365*400+97)*24*Md;function tl(t,e){return(t%e+e)%e}function KP(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-jP:new Date(t,e,n).valueOf()}function XP(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-jP:Date.UTC(t,e,n)}function AU(t){var e,n;if(t=br(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?XP:KP,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=tl(e+(this._isUTC?0:this.utcOffset()*el),Md);break;case"minute":e=this._d.valueOf(),e-=tl(e,el);break;case"second":e=this._d.valueOf(),e-=tl(e,_d);break}return this._d.setTime(e),J.updateOffset(this,!0),this}function OU(t){var e,n;if(t=br(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?XP:KP,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Md-tl(e+(this._isUTC?0:this.utcOffset()*el),Md)-1;break;case"minute":e=this._d.valueOf(),e+=el-tl(e,el)-1;break;case"second":e=this._d.valueOf(),e+=_d-tl(e,_d)-1;break}return this._d.setTime(e),J.updateOffset(this,!0),this}function PU(){return this._d.valueOf()-(this._offset||0)*6e4}function IU(){return Math.floor(this.valueOf()/1e3)}function xU(){return new Date(this.valueOf())}function HU(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function DU(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function NU(){return this.isValid()?this.toISOString():null}function LU(){return PC(this)}function kU(){return Oo({},ze(this))}function $U(){return ze(this).overflow}function FU(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Te("N",0,0,"eraAbbr");Te("NN",0,0,"eraAbbr");Te("NNN",0,0,"eraAbbr");Te("NNNN",0,0,"eraName");Te("NNNNN",0,0,"eraNarrow");Te("y",["y",1],"yo","eraYear");Te("y",["yy",2],0,"eraYear");Te("y",["yyy",3],0,"eraYear");Te("y",["yyyy",4],0,"eraYear");me("N",YC);me("NN",YC);me("NNN",YC);me("NNNN",qU);me("NNNNN",ZU);ht(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?ze(n).era=i:ze(n).invalidEra=t});me("y",hl);me("yy",hl);me("yyy",hl);me("yyyy",hl);me("yo",QU);ht(["y","yy","yyy","yyyy"],Sn);ht(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Sn]=n._locale.eraYearOrdinalParse(t,i):e[Sn]=parseInt(t,10)});function WU(t,e){var n,r,i,o=this._eras||io("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=J(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=J(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function VU(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function BU(t,e){var n=t.since<=t.until?1:-1;return e===void 0?J(t.since).year():J(t.since).year()+(e-t.offset)*n}function UU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function zU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function GU(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function YU(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-J(i[t].since).year())*n+i[t].offset;return this.year()}function jU(t){return it(this,"_erasNameRegex")||jC.call(this),t?this._erasNameRegex:this._erasRegex}function KU(t){return it(this,"_erasAbbrRegex")||jC.call(this),t?this._erasAbbrRegex:this._erasRegex}function XU(t){return it(this,"_erasNarrowRegex")||jC.call(this),t?this._erasNarrowRegex:this._erasRegex}function YC(t,e){return e.erasAbbrRegex(t)}function qU(t,e){return e.erasNameRegex(t)}function ZU(t,e){return e.erasNarrowRegex(t)}function QU(t,e){return e._eraYearOrdinalRegex||hl}function jC(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(ir(s[i].name)),t.push(ir(s[i].abbr)),n.push(ir(s[i].narrow)),r.push(ir(s[i].name)),r.push(ir(s[i].abbr)),r.push(ir(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Te(0,["gg",2],0,function(){return this.weekYear()%100});Te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function _f(t,e){Te(0,[t,t.length],0,e)}_f("gggg","weekYear");_f("ggggg","weekYear");_f("GGGG","isoWeekYear");_f("GGGGG","isoWeekYear");En("weekYear","gg");En("isoWeekYear","GG");Tn("weekYear",1);Tn("isoWeekYear",1);me("G",yf);me("g",yf);me("GG",bt,lr);me("gg",bt,lr);me("GGGG",LC,NC);me("gggg",LC,NC);me("GGGGG",Sf,Cf);me("ggggg",Sf,Cf);sc(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=Qe(t)});sc(["gg","GG"],function(t,e,n,r){e[r]=J.parseTwoDigitYear(t)});function JU(t){return qP.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function e2(t){return qP.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function t2(){return Qi(this.year(),1,4)}function n2(){return Qi(this.isoWeekYear(),1,4)}function r2(){var t=this.localeData()._week;return Qi(this.year(),t.dow,t.doy)}function i2(){var t=this.localeData()._week;return Qi(this.weekYear(),t.dow,t.doy)}function qP(t,e,n,r,i){var o;return t==null?Lu(this,r,i).year:(o=Qi(t,r,i),e>o&&(e=o),o2.call(this,t,e,n,r,i))}function o2(t,e,n,r,i){var o=OP(t,e,n,r,i),s=Nu(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}Te("Q",0,"Qo","quarter");En("quarter","Q");Tn("quarter",7);me("Q",vP);ht("Q",function(t,e){e[Ui]=(Qe(t)-1)*3});function s2(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Te("D",["DD",2],"Do","date");En("date","D");Tn("date",9);me("D",bt);me("DD",bt,lr);me("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ht(["D","DD"],hi);ht("Do",function(t,e){e[hi]=Qe(t.match(bt)[0])});var ZP=cl("Date",!0);Te("DDD",["DDDD",3],"DDDo","dayOfYear");En("dayOfYear","DDD");Tn("dayOfYear",4);me("DDD",vf);me("DDDD",SP);ht(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Qe(t)});function a2(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Te("m",["mm",2],0,"minute");En("minute","m");Tn("minute",14);me("m",bt);me("mm",bt,lr);ht(["m","mm"],$r);var l2=cl("Minutes",!1);Te("s",["ss",2],0,"second");En("second","s");Tn("second",15);me("s",bt);me("ss",bt,lr);ht(["s","ss"],zi);var u2=cl("Seconds",!1);Te("S",0,0,function(){return~~(this.millisecond()/100)});Te(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Te(0,["SSS",3],0,"millisecond");Te(0,["SSSS",4],0,function(){return this.millisecond()*10});Te(0,["SSSSS",5],0,function(){return this.millisecond()*100});Te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});En("millisecond","ms");Tn("millisecond",16);me("S",vf,vP);me("SS",vf,lr);me("SSS",vf,SP);var Po,QP;for(Po="SSSS";Po.length<=9;Po+="S")me(Po,hl);function c2(t,e){e[Ds]=Qe(("0."+t)*1e3)}for(Po="S";Po.length<=9;Po+="S")ht(Po,c2);QP=cl("Milliseconds",!1);Te("z",0,0,"zoneAbbr");Te("zz",0,0,"zoneName");function h2(){return this._isUTC?"UTC":""}function d2(){return this._isUTC?"Coordinated Universal Time":""}var ne=ic.prototype;ne.add=iU;ne.calendar=hU;ne.clone=dU;ne.diff=vU;ne.endOf=OU;ne.format=RU;ne.from=EU;ne.fromNow=TU;ne.to=_U;ne.toNow=MU;ne.get=gV;ne.invalidAt=$U;ne.isAfter=fU;ne.isBefore=gU;ne.isBetween=mU;ne.isSame=pU;ne.isSameOrAfter=wU;ne.isSameOrBefore=CU;ne.isValid=LU;ne.lang=GP;ne.locale=zP;ne.localeData=YP;ne.max=LB;ne.min=NB;ne.parsingFlags=kU;ne.set=mV;ne.startOf=AU;ne.subtract=oU;ne.toArray=HU;ne.toObject=DU;ne.toDate=xU;ne.toISOString=yU;ne.inspect=bU;typeof Symbol<"u"&&Symbol.for!=null&&(ne[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ne.toJSON=NU;ne.toString=SU;ne.unix=IU;ne.valueOf=PU;ne.creationData=FU;ne.eraName=UU;ne.eraNarrow=zU;ne.eraAbbr=GU;ne.eraYear=YU;ne.year=AP;ne.isLeapYear=DV;ne.weekYear=JU;ne.isoWeekYear=e2;ne.quarter=ne.quarters=s2;ne.month=_P;ne.daysInMonth=IV;ne.week=ne.weeks=WV;ne.isoWeek=ne.isoWeeks=VV;ne.weeksInYear=r2;ne.weeksInWeekYear=i2;ne.isoWeeksInYear=t2;ne.isoWeeksInISOWeekYear=n2;ne.date=ZP;ne.day=ne.days=eB;ne.weekday=tB;ne.isoWeekday=nB;ne.dayOfYear=a2;ne.hour=ne.hours=uB;ne.minute=ne.minutes=l2;ne.second=ne.seconds=u2;ne.millisecond=ne.milliseconds=QP;ne.utcOffset=GB;ne.utc=jB;ne.local=KB;ne.parseZone=XB;ne.hasAlignedHourOffset=qB;ne.isDST=ZB;ne.isLocal=JB;ne.isUtcOffset=eU;ne.isUtc=WP;ne.isUTC=WP;ne.zoneAbbr=h2;ne.zoneName=d2;ne.dates=yr("dates accessor is deprecated. Use date instead.",ZP);ne.months=yr("months accessor is deprecated. Use month instead",_P);ne.years=yr("years accessor is deprecated. Use year instead",AP);ne.zone=yr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",YB);ne.isDSTShifted=yr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",QB);function f2(t){return yt(t*1e3)}function g2(){return yt.apply(null,arguments).parseZone()}function JP(t){return t}var ot=xC.prototype;ot.calendar=eV;ot.longDateFormat=iV;ot.invalidDate=sV;ot.ordinal=uV;ot.preparse=JP;ot.postformat=JP;ot.relativeTime=hV;ot.pastFuture=dV;ot.set=QW;ot.eras=WU;ot.erasParse=VU;ot.erasConvertYear=BU;ot.erasAbbrRegex=KU;ot.erasNameRegex=jU;ot.erasNarrowRegex=XU;ot.months=MV;ot.monthsShort=AV;ot.monthsParse=PV;ot.monthsRegex=HV;ot.monthsShortRegex=xV;ot.week=LV;ot.firstDayOfYear=FV;ot.firstDayOfWeek=$V;ot.weekdays=XV;ot.weekdaysMin=ZV;ot.weekdaysShort=qV;ot.weekdaysParse=JV;ot.weekdaysRegex=rB;ot.weekdaysShortRegex=iB;ot.weekdaysMinRegex=oB;ot.isPM=aB;ot.meridiem=cB;function Ad(t,e,n,r){var i=io(),o=Ci().set(r,e);return i[n](o,t)}function eI(t,e,n){if(Ji(t)&&(e=t,t=void 0),t=t||"",e!=null)return Ad(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Ad(t,r,n,"month");return i}function KC(t,e,n,r){typeof t=="boolean"?(Ji(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,Ji(e)&&(n=e,e=void 0),e=e||"");var i=io(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Ad(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Ad(e,(s+o)%7,r,"day");return a}function m2(t,e){return eI(t,e,"months")}function p2(t,e){return eI(t,e,"monthsShort")}function w2(t,e,n){return KC(t,e,n,"weekdays")}function C2(t,e,n){return KC(t,e,n,"weekdaysShort")}function v2(t,e,n){return KC(t,e,n,"weekdaysMin")}Do("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Qe(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});J.lang=yr("moment.lang is deprecated. Use moment.locale instead.",Do);J.langData=yr("moment.langData is deprecated. Use moment.localeData instead.",io);var Ri=Math.abs;function S2(){var t=this._data;return this._milliseconds=Ri(this._milliseconds),this._days=Ri(this._days),this._months=Ri(this._months),t.milliseconds=Ri(t.milliseconds),t.seconds=Ri(t.seconds),t.minutes=Ri(t.minutes),t.hours=Ri(t.hours),t.months=Ri(t.months),t.years=Ri(t.years),this}function tI(t,e,n,r){var i=Yr(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function y2(t,e){return tI(this,t,e,1)}function b2(t,e){return tI(this,t,e,-1)}function vR(t){return t<0?Math.floor(t):Math.ceil(t)}function R2(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=vR(gw(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Cr(t/1e3),r.seconds=i%60,o=Cr(i/60),r.minutes=o%60,s=Cr(o/60),r.hours=s%24,e+=Cr(s/24),l=Cr(nI(e)),n+=l,e-=vR(gw(l)),a=Cr(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function nI(t){return t*4800/146097}function gw(t){return t*146097/4800}function E2(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=br(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+nI(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(gw(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function T2(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+Qe(this._months/12)*31536e6:NaN}function oo(t){return function(){return this.as(t)}}var _2=oo("ms"),M2=oo("s"),A2=oo("m"),O2=oo("h"),P2=oo("d"),I2=oo("w"),x2=oo("M"),H2=oo("Q"),D2=oo("y");function N2(){return Yr(this)}function L2(t){return t=br(t),this.isValid()?this[t+"s"]():NaN}function Zs(t){return function(){return this.isValid()?this._data[t]:NaN}}var k2=Zs("milliseconds"),$2=Zs("seconds"),F2=Zs("minutes"),W2=Zs("hours"),V2=Zs("days"),B2=Zs("months"),U2=Zs("years");function z2(){return Cr(this.days()/7)}var Fi=Math.round,Ka={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function G2(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function Y2(t,e,n,r){var i=Yr(t).abs(),o=Fi(i.as("s")),s=Fi(i.as("m")),a=Fi(i.as("h")),l=Fi(i.as("d")),u=Fi(i.as("M")),c=Fi(i.as("w")),h=Fi(i.as("y")),f=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),f=f||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],f[2]=e,f[3]=+t>0,f[4]=r,G2.apply(null,f)}function j2(t){return t===void 0?Fi:typeof t=="function"?(Fi=t,!0):!1}function K2(t,e){return Ka[t]===void 0?!1:e===void 0?Ka[t]:(Ka[t]=e,t==="s"&&(Ka.ss=e-1),!0)}function X2(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=Ka,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},Ka,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=Y2(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var Wg=Math.abs;function sa(t){return(t>0)-(t<0)||+t}function Mf(){if(!this.isValid())return this.localeData().invalidDate();var t=Wg(this._milliseconds)/1e3,e=Wg(this._days),n=Wg(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Cr(t/60),i=Cr(r/60),t%=60,r%=60,o=Cr(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=sa(this._months)!==sa(a)?"-":"",c=sa(this._days)!==sa(a)?"-":"",h=sa(this._milliseconds)!==sa(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var tt=Tf.prototype;tt.isValid=VB;tt.abs=S2;tt.add=y2;tt.subtract=b2;tt.as=E2;tt.asMilliseconds=_2;tt.asSeconds=M2;tt.asMinutes=A2;tt.asHours=O2;tt.asDays=P2;tt.asWeeks=I2;tt.asMonths=x2;tt.asQuarters=H2;tt.asYears=D2;tt.valueOf=T2;tt._bubble=R2;tt.clone=N2;tt.get=L2;tt.milliseconds=k2;tt.seconds=$2;tt.minutes=F2;tt.hours=W2;tt.days=V2;tt.weeks=z2;tt.months=B2;tt.years=U2;tt.humanize=X2;tt.toISOString=Mf;tt.toString=Mf;tt.toJSON=Mf;tt.locale=zP;tt.localeData=YP;tt.toIsoString=yr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Mf);tt.lang=GP;Te("X",0,0,"unix");Te("x",0,0,"valueOf");me("x",yf);me("X",wV);ht("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});ht("x",function(t,e,n){n._d=new Date(Qe(t))});//! moment.js
J.version="2.29.4";qW(yt);J.fn=ne;J.min=kB;J.max=$B;J.now=FB;J.utc=Ci;J.unix=f2;J.months=m2;J.isDate=rc;J.locale=Do;J.invalid=pf;J.duration=Yr;J.isMoment=zr;J.weekdays=w2;J.parseZone=g2;J.localeData=io;J.isDuration=Xh;J.monthsShort=p2;J.weekdaysMin=v2;J.defineLocale=WC;J.updateLocale=gB;J.locales=mB;J.weekdaysShort=C2;J.normalizeUnits=br;J.relativeTimeRounding=j2;J.relativeTimeThreshold=K2;J.calendarFormat=cU;J.prototype=ne;J.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const q2=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));function rI(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function mw(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function Cu(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Ft(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function sr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ve(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function T(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function iI(t){return Ft(t,(e,n)=>e+n,0)}function Z2(t){return Ft(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function Q2(t){return Ft(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function J2(t){return t.length?iI(t)/t.length:0}function oI(t){return Ft(t,(e,n)=>e.concat(Array.isArray(n)?oI(n):n),[])}function XC(t){const e=[];return T(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function pw(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function ez(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return T(i,s=>{o=o.filter(a=>s.includes(a))}),o}function tz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return T(i,s=>{T(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function ww(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const nz=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:J2,arrayEach:T,arrayFilter:sr,arrayFlatten:oI,arrayMap:Ve,arrayMax:Z2,arrayMin:Q2,arrayReduce:Ft,arraySum:iI,arrayUnique:XC,extendArray:mw,getDifferenceOfArrays:pw,getIntersectionOfArrays:ez,getUnionOfArrays:tz,pivot:Cu,stringToArray:ww,to2dArray:rI},Symbol.toStringTag,{value:"Module"}));function ct(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Ft(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Nt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function le(t){return typeof t<"u"}function mt(t){return typeof t>"u"}function Xt(t){return t===null||t===""||mt(t)}function sI(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const uu="length",vu=t=>parseInt(t,16),SR=t=>parseInt(t,10),Od=(t,e,n)=>t.substr(e,n),Su=t=>t.codePointAt(0)-65,Cw=t=>`${t}`.replace(/\-/g,""),rz=t=>vu(Od(Cw(t),vu("12"),Su("F")))/(vu(Od(Cw(t),Su("B"),~~![][uu]))||9),iz=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let yR=!1;const bR={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},RR={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function aI(t,e){const n=!Xt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0-next-b24d538-20231108";let o,s="invalid",a="invalid";t=Cw(t||"");const l=oz(t);if(n||r||l)if(l){const u=J("15/11/2023","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=rz(t);o=J((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(iz()&&(s="valid",a="valid"),!yR&&s!=="valid"&&(bR[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](bR[s]({keyValidityDate:o,hotVersion:i})),yR=!0),a!=="valid"&&e.parentNode&&RR[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=RR[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function oz(t){let e=[][uu],n=e;if(t[uu]!==Su("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=Su(i.shift());o;o=Su(i.shift()||"A"))--o<""[uu]?n=n|(SR(`${SR(vu(r)+(vu(Od(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Od(t,o,o?i[uu]===1?9:8:6);return n===e}const sz=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:aI,isDefined:le,isEmpty:Xt,isRegExp:sI,isUndefined:mt,stringify:Nt},Symbol.toStringTag,{value:"Module"}));function yn(t){return t[0].toUpperCase()+t.substr(1)}function az(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Nt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function qC(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function ZC(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function QC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function vw(t){return Af(`${t}`,{ALLOWED_TAGS:[]})}function Af(t,e){return XW.sanitize(t,e)}const lz=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:az,isPercentValue:ZC,randomString:qC,sanitize:Af,stripTags:vw,substitute:QC,toUpperCaseFirst:yn},Symbol.toStringTag,{value:"Module"})),dl=t=>["tabindex",t],uz=()=>["role","treegrid"],Fr=()=>["role","presentation"],cz=()=>["role","gridcell"],hz=()=>["role","rowheader"],dz=()=>["role","columnheader"],lI=()=>["role","row"],fz=()=>["role","menu"],gz=()=>["role","menuitem"],mz=()=>["role","combobox"],uI=()=>["role","listbox"],pz=()=>["role","option"],wz=()=>["role","checkbox"],Cz=()=>["scope","col"],vz=()=>["scope","row"],Sz=()=>["type","text"],Wo=t=>["aria-label",t],$u=t=>["aria-description",t],so=()=>["aria-hidden","true"],yz=()=>["aria-disabled","true"],bz=()=>["aria-multiselectable","true"],fl=t=>["aria-haspopup",t],cI=t=>["aria-rowcount",t],hI=t=>["aria-colcount",t],dI=t=>["aria-rowindex",t],JC=t=>["aria-colindex",t],sn=t=>["aria-expanded",t],Rz=t=>["aria-sort",t],ER=()=>["aria-readonly","true"],TR=()=>["aria-invalid","true"],Ez=t=>["aria-checked",t],Sw=()=>["aria-selected","true"],Tz=()=>["aria-autocomplete","list"],_z=t=>["aria-controls",t],Mz=t=>["aria-activedescendant",t],Az=t=>["aria-live",t],Oz=t=>["aria-relevant",t],Pz=t=>["aria-setsize",t],Iz=t=>["aria-posinset",t];function fI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function gI(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function mI(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Fu(t){return mI(t)&&t.parent}function xz(t){return!!Object.getPrototypeOf(t.parent)}function Vo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function cu(t,e,n){const r=[];let i=t;for(;i&&(i=Vo(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function No(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function pI(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Eo(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function wI(t){return!t||!t.length?[]:t.filter(e=>!!e)}function CI(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function Pe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ee(t,e){typeof e=="string"&&(e=e.split(" ")),e=wI(e),e.length>0&&t.classList.add(...e)}function De(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=CI(e,!0);n=wI(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function ve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Ko(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=CI(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function ev(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)ev(e[n])}}function Gr(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const vI=/(<(.*)>|&(.*);)/;function Qs(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;vI.test(e)?t.innerHTML=n?Af(e):e:Bo(t,e)}function Bo(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(Gr(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Uo(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return Uo(n.host.impl);if(n.host)return Uo(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(eo(n).display==="none")return!1;n=n.parentNode}return!0}function Bt(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function tv(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Of(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Wu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?tv(e):t.scrollTop}function Pd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Of(e):t.scrollLeft}function Vu(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function Vs(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=eo(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function il(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=eo(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Hz(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function eo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ut(t){return t.offsetWidth}function Ot(t){return t.offsetHeight}function Gi(t){return t.clientHeight||t.innerHeight}function yu(t){return t.clientWidth||t.innerWidth}function Dz(t,e,n){t.addEventListener(e,n,!1)}function Nz(t,e,n){t.removeEventListener(e,n,!1)}function nv(t){return t.selectionStart?t.selectionStart:0}function SI(t){return t.selectionEnd?t.selectionEnd:0}function Lz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function yw(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function ac(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let Vg;function kz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function Jt(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Vg===void 0&&(Vg=kz(t)),Vg}function yI(t){return t.offsetWidth!==t.clientWidth}function bI(t){return t.offsetHeight!==t.clientHeight}function Pf(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function $z(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function lc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Id(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function If(t){return Id(t)&&t.hasAttribute("data-hot-input")===!1}function Fz(t){const e=t.ownerDocument.activeElement;If(e)||t.select()}function rv(t){return!t.parentNode}function RI(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function iv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();ve(t,"contenteditable",!0),n&&ve(t,...so()),e&&ee(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function ov(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&De(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function EI(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;iv(t,n),e(),ov(t,n)}function Bs(t,e){let{tagName:n,className:r,attributes:i}=e;const o=t.ownerDocument.createElement(n);return r&&ee(o,r),i&&i.length&&ve(o,i),t.appendChild(o),o}const Wz=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:vI,addClass:ee,addEvent:Dz,appendElement:Bs,clearTextSelection:yw,closest:Vo,closestDown:cu,empty:Gr,fastInnerHTML:Qs,fastInnerText:Bo,getCaretPosition:nv,getComputedStyle:eo,getCssTransform:$z,getFrameElement:mI,getParent:fI,getParentWindow:Fu,getScrollLeft:Pd,getScrollTop:Wu,getScrollableElement:Vu,getScrollbarWidth:Jt,getSelectionEndPosition:SI,getSelectionText:Lz,getStyle:il,getTrimmingContainer:Vs,getWindowScrollLeft:Of,getWindowScrollTop:tv,hasAccessToParentWindow:xz,hasClass:Pe,hasHorizontalScrollbar:bI,hasVerticalScrollbar:yI,index:pI,innerHeight:Gi,innerWidth:yu,isChildOf:No,isDetached:rv,isInput:Id,isOutsideInput:If,isThisHotChild:gI,isVisible:Uo,makeElementContentEditableAndSelectItsContent:iv,matchesCSSRules:Hz,observeVisibilityChangeOnce:RI,offset:Bt,outerHeight:Ot,outerWidth:ut,overlayContainsElement:Eo,removeAttribute:Ko,removeClass:De,removeContentEditableFromElementAndDeselect:ov,removeEvent:Nz,removeTextNodes:ev,resetCssTransform:lc,runWithSelectedContendEditableElement:EI,selectElementIfAllowed:Fz,setAttribute:ve,setCaretPosition:ac,setOverlayPosition:Pf},Symbol.toStringTag,{value:"Module"}));function gt(t){return typeof t=="function"}function TI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function Vz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=TI(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function sv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function Bz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Ft(i,(u,c)=>c(u),r.apply(this,a))}}function av(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function _I(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Uz(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function xd(t,e,n,r,i,o,s,a){return le(a)?t.call(e,n,r,i,o,s,a):le(s)?t.call(e,n,r,i,o,s):le(o)?t.call(e,n,r,i,o):le(i)?t.call(e,n,r,i):le(r)?t.call(e,n,r):le(n)?t.call(e,n):t.call(e)}const zz=Object.freeze(Object.defineProperty({__proto__:null,curry:_I,curryRight:Uz,debounce:sv,fastCall:xd,isFunction:gt,partial:av,pipe:Bz,throttle:TI,throttleAfterHits:Vz},Symbol.toStringTag,{value:"Module"}));var Gz=Fn,_R=jO,Yz=dn,MR=ul,jz=JO,AR=Gz([].push),Kz=function(t){if(Yz(t))return t;if(_R(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?AR(n,i):(typeof i=="number"||MR(i)==="Number"||MR(i)==="String")&&AR(n,jz(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(_R(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},Xz=Xs,MI=Ju,AI=mf,qz=cf,uc=Fn,OI=Sr,OR=dn,PR=pC,PI=MC,Zz=Kz,Qz=mC,Jz=String,Lo=MI("JSON","stringify"),Dc=uc(/./.exec),IR=uc("".charAt),eG=uc("".charCodeAt),tG=uc("".replace),nG=uc(1 .toString),rG=/[\uD800-\uDFFF]/g,xR=/^[\uD800-\uDBFF]$/,HR=/^[\uDC00-\uDFFF]$/,DR=!Qz||OI(function(){var t=MI("Symbol")("stringify detection");return Lo([t])!=="[null]"||Lo({a:t})!=="{}"||Lo(Object(t))!=="{}"}),NR=OI(function(){return Lo("\uDF06\uD834")!=='"\\udf06\\ud834"'||Lo("\uDEAD")!=='"\\udead"'}),iG=function(t,e){var n=PI(arguments),r=Zz(e);if(!(!OR(r)&&(t===void 0||PR(t))))return n[1]=function(i,o){if(OR(r)&&(o=qz(r,this,Jz(i),o)),!PR(o))return o},AI(Lo,null,n)},oG=function(t,e,n){var r=IR(n,e-1),i=IR(n,e+1);return Dc(xR,t)&&!Dc(HR,i)||Dc(HR,t)&&!Dc(xR,r)?"\\u"+nG(eG(t,0),16):t};Lo&&Xz({target:"JSON",stat:!0,arity:3,forced:DR||NR},{stringify:function(e,n,r){var i=PI(arguments),o=AI(DR?iG:Lo,null,i);return NR&&typeof o=="string"?tG(o,rG,oG):o}});function ol(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Be(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=ol(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[ol(n[0])]:e[r]=[]:e[r]=null)})),e}function ao(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Ut(t,e,n){const r=Array.isArray(n);return Be(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function cc(t,e){Be(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),cc(t[r],e[r])):t[r]=e[r]})}function bn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ln(t){const e={};return Be(t,(n,r)=>{e[r]=n}),e}function dt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return T(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Be(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const f=`_${c}`,g=w=>{let C=w;return(Array.isArray(C)||$e(C))&&(C=bn(C)),C};return function(){return this[f]===void 0&&(this[f]=g(h)),this[f]}},l=function(c){const h=`_${c}`;return function(f){this[h]=f}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function xf(t,e){return JSON.stringify(t)===JSON.stringify(e)}function $e(t){return Object.prototype.toString.call(t)==="[object Object]"}function Si(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Be(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function II(t,e){const n=e.split(".");let r=t;return Be(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Zh(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(At(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function Hf(t){if(!$e(t))return 0;const e=function(n){let r=0;return $e(n)?Be(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function Us(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function At(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const sG=Object.freeze(Object.defineProperty({__proto__:null,clone:Ln,createObjectPropListener:Us,deepClone:bn,deepExtend:cc,deepObjectSize:Hf,defineGetter:Si,duckSchema:ol,extend:Ut,getProperty:II,hasOwnProperty:At,inherit:ao,isObject:$e,isObjectEqual:xf,mixin:dt,objectEach:Be,setProperty:Zh},Symbol.toStringTag,{value:"Module"})),mr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},lo={chrome:mr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:mr(t=>/CriOS/.test(t)),edge:mr(t=>/Edge/.test(t)),edgeWebKit:mr(t=>/EdgiOS/.test(t)),firefox:mr(t=>/Firefox/.test(t)),firefoxWebKit:mr(t=>/FxiOS/.test(t)),mobile:mr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:mr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},gl={mac:mr(t=>/^Mac/.test(t)),win:mr(t=>/^Win/.test(t)),linux:mr(t=>/^Linux/.test(t)),ios:mr(t=>/iPhone|iPad|iPod/i.test(t))};function xI(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(lo,n=>{let{test:r}=n;return void r(t,e)})}function HI(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Be(gl,e=>{let{test:n}=e;return void n(t)})}xI();HI();function lv(){return lo.chrome.value}function DI(){return lo.chromeWebKit.value}function Qh(){return lo.firefox.value}function NI(){return lo.firefoxWebKit.value}function uv(){return lo.safari.value}function LI(){return lo.edge.value}function aG(){return lo.edgeWebKit.value}function Yi(){return lo.mobile.value}function cv(){return gl.ios.value}function hv(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&gl.mac.value}function bw(){return gl.win.value}function Bu(){return gl.mac.value}function lG(){return gl.linux.value}const uG=Object.freeze(Object.defineProperty({__proto__:null,isChrome:lv,isChromeWebKit:DI,isEdge:LI,isEdgeWebKit:aG,isFirefox:Qh,isFirefoxWebKit:NI,isIOS:cv,isIpadOS:hv,isLinuxOS:lG,isMacOS:Bu,isMobileBrowser:Yi,isSafari:uv,isWindowsOS:bw,setBrowserMeta:xI,setPlatformMeta:HI},Symbol.toStringTag,{value:"Module"})),ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:Qh()?182:174,AUDIO_MUTE:Qh()?181:173,AUDIO_UP:Qh()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},cG=[ge.ALT,ge.ARROW_DOWN,ge.ARROW_LEFT,ge.ARROW_RIGHT,ge.ARROW_UP,ge.AUDIO_DOWN,ge.AUDIO_MUTE,ge.AUDIO_UP,ge.BACKSPACE,ge.CAPS_LOCK,ge.DELETE,ge.END,ge.ENTER,ge.ESCAPE,ge.F1,ge.F2,ge.F3,ge.F4,ge.F5,ge.F6,ge.F7,ge.F8,ge.F9,ge.F10,ge.F11,ge.F12,ge.F13,ge.F14,ge.F15,ge.F16,ge.F17,ge.F18,ge.F19,ge.HOME,ge.INSERT,ge.MEDIA_NEXT,ge.MEDIA_PLAY_PAUSE,ge.MEDIA_PREV,ge.MEDIA_STOP,ge.NULL,ge.NUM_LOCK,ge.PAGE_DOWN,ge.PAGE_UP,ge.PAUSE,ge.SCROLL_LOCK,ge.SHIFT,ge.TAB];function kI(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function dv(t){return cG.includes(t)}function hG(t){const e=[];return Bu()?e.push(ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX):e.push(ge.CONTROL),e.includes(t)}function $I(t){return[ge.CONTROL,ge.COMMAND_LEFT,ge.COMMAND_RIGHT,ge.COMMAND_FIREFOX].includes(t)}function ml(t,e){const n=e.split("|");let r=!1;return T(n,i=>{if(t===ge[i])return r=!0,!1}),r}const dG=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ge,isCtrlKey:hG,isCtrlMetaKey:$I,isFunctionKey:dv,isKey:ml,isPrintableChar:kI},Symbol.toStringTag,{value:"Module"}));function Rr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Ao(t){return t.isImmediatePropagationEnabled===!1}function zo(t){return t.button===2}function Df(t){return t.button===0}function FI(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const fG=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Ao,isLeftClick:Df,isRightClick:zo,offsetRelativeTo:FI,stopImmediatePropagation:Rr},Symbol.toStringTag,{value:"Module"}));function pt(){le(console)&&console.warn(...arguments)}function fv(){le(console)&&console.error(...arguments)}function gG(t,e,n){return e=mG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mG(t){var e=pG(t,"string");return typeof e=="symbol"?e:String(e)}function pG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const aa=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],wG=ct`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Bg=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Ug=new Map([[]]);class WI{static getSingleton(){return vG()}constructor(){gG(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return T(aa,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))T(n,i=>this.add(e,i,r));else{Bg.has(e)&&pt(QC(wG,{hookName:e,removedInVersion:Bg.get(e)})),Ug.has(e)&&pt(Ug.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&T(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?T(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=xd(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const f=xd(u[h],e,r,i,o,s,a,l);f!==void 0&&(r=f),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Be(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||aa.push(e)}deregister(e){this.isRegistered(e)&&aa.splice(aa.indexOf(e),1)}isDeprecated(e){return Ug.has(e)||Bg.has(e)}isRegistered(e){return aa.indexOf(e)>=0}getRegistered(){return aa}}const CG=new WI;function vG(){return CG}const fe=WI,zg=new Map;function jr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";zg.has(t)||zg.set(t,new Map);const e=zg.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const Rw=new WeakMap,{register:SG,getItem:VI,hasItem:BI,getNames:yG,getValues:ole}=jr("editors");function bG(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function UI(t,e){let n;if(typeof t=="function")Rw.get(t)||jn(null,t),n=Rw.get(t);else if(typeof t=="string")n=VI(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Hd(t){if(typeof t=="function")return t;if(!BI(t))throw Error(`No registered editor found under "${t}" name`);return VI(t).getConstructor()}function jn(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new bG(e);typeof t=="string"&&SG(t,n),Rw.set(e,n)}function RG(t,e,n){return e=EG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EG(t){var e=TG(t,"string");return typeof e=="symbol"?e:String(e)}function TG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Jh=0;class _G{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;RG(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,MG(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Jh+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Jh-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Jh-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function MG(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Rr(this)},t}const ar=_G;function AG(){return Jh}function LR(t,e){OG(t,e),e.add(t)}function OG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ho(t,e,n){return e=PG(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PG(t){var e=IG(t,"string");return typeof e=="symbol"?e:String(e)}function IG(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kR(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Nf="editorManager.navigation";var $R=new WeakSet,FR=new WeakSet;class Ew{constructor(e,n,r){LR(this,FR),LR(this,$R),ho(this,"hot",void 0),ho(this,"tableMeta",void 0),ho(this,"selection",void 0),ho(this,"eventManager",void 0),ho(this,"destroyed",!1),ho(this,"lock",!1),ho(this,"activeEditor",void 0),ho(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new ar(e),this.hot.addHook("afterDocumentKeyDown",i=>kR(this,$R,xG).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>kR(this,FR,HG).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}const{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;const{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r);let o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}const a=this.hot.getCell(n,r,!0);if(a){const l=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(s),c=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=UI(l,this.hot),this.activeEditor.prepare(n,r,u,a,c,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function xG(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Ao(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!dv(n)&&!$I(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>le(this.hot.getSelected()),group:Nf};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function HG(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}const WR=new WeakMap;Ew.getInstance=function(t,e,n){let r=WR.get(t);return r||(r=new Ew(t,e,n),WR.set(t,r)),r};const DG=Ew;function Nc(t,e){zI(t,e),e.add(t)}function Lc(t,e,n){zI(t,e),e.set(t,n)}function zI(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xa(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function pn(t,e){var n=GI(t,e,"get");return NG(t,n)}function NG(t,e){return e.get?e.get.call(t):e.value}function _l(t,e,n){var r=GI(t,e,"set");return LG(t,r,n),n}function GI(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function LG(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Io=Object.freeze({CELL:"cell",MIXED:"mixed"});var nr=new WeakMap,kc=new WeakMap,$c=new WeakMap,Fc=new WeakMap,Tw=new WeakSet,_w=new WeakSet,VR=new WeakSet,BR=new WeakSet;class kG{constructor(e){var n=this;Nc(this,BR),Nc(this,VR),Nc(this,_w),Nc(this,Tw),Lc(this,nr,{writable:!0,value:void 0}),Lc(this,kc,{writable:!0,value:void 0}),Lc(this,$c,{writable:!0,value:50}),Lc(this,Fc,{writable:!0,value:null});const r=e.getSettings();_l(this,nr,e),_l(this,kc,r.imeFastEdit?Io.MIXED:Io.CELL),pn(this,nr).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Xa(n,BR,FG).call(n,...o)}),pn(this,nr).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Xa(n,VR,$G).call(n,...o)})}getFocusMode(){return pn(this,kc)}setFocusMode(e){Object.values(Io).includes(e)?_l(this,kc,e):pt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return pn(this,$c)}setRefocusDelay(e){_l(this,$c,e)}setRefocusElementGetter(e){_l(this,Fc,e)}getRefocusElement(){if(typeof pn(this,Fc)=="function")return pn(this,Fc).call(this);var e;return(e=pn(this,nr).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){var n;const r=Xa(this,Tw,YI).call(this),i=e||Xa(this,_w,jI).call(this);let o=pn(this,nr).runHooks("modifyFocusedElement",r.row,r.col,i);o instanceof HTMLElement||(o=i),o&&!((n=pn(this,nr).getActiveEditor())!==null&&n!==void 0&&n.isOpened())&&o.focus({preventScroll:!0})}refocusToEditorTextarea(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pn(this,$c);const n=this.getRefocusElement();pn(this,nr).getSettings().imeFastEdit&&n&&pn(this,nr)._registerTimeout(()=>{n.select()},e)}}function YI(){return pn(this,nr).getSelectedRangeLast().highlight}function jI(){const t=Xa(this,Tw,YI).call(this);return pn(this,nr).getCell(t.row,t.col,!0)}function $G(){const t=Xa(this,_w,jI).call(this),{activeElement:e}=pn(this,nr).rootDocument;e&&If(e)&&e.blur(),this.focusOnHighlightedCell(t),this.getFocusMode()===Io.MIXED&&t.nodeName==="TD"&&pn(this,nr).addHookOnce("afterSelectionEnd",()=>{this.refocusToEditorTextarea()})}function FG(t){t.imeFastEdit&&this.getFocusMode()!==Io.MIXED?this.setFocusMode(Io.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Io.CELL&&this.setFocusMode(Io.CELL)}const KI={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},WG=new RegExp(Object.keys(KI).map(t=>`(${t})`).join("|"),"gi");function VG(t){return(t&&t.nodeName||"")==="TABLE"}function Mw(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let f=0;f<o;f+=1){const g=e&&f===0,w=[];for(let S=0;S<s;S+=1){const b=!g&&n&&S===0;let _="";if(g)_=`<th>${t.getColHeader(S-c)}</th>`;else if(b)_=`<th>${t.getRowHeader(f-h)}</th>`;else{const O=i[f][S],{hidden:x,rowspan:I,colspan:$}=t.getCellMeta(f-h,S-c);if(!x){const z=[];if(I&&z.push(`rowspan="${I}"`),$&&z.push(`colspan="${$}"`),Xt(O))_=`<td ${z.join(" ")}></td>`;else{const q=O.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");_=`<td ${z.join(" ")}>${q}</td>`}}}w.push(_)}const C=["<tr>",...w,"</tr>"].join("");g?l.splice(1,0,C):u.splice(-1,0,C)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Aw(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Xt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function XI(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const O=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,x=>{const I=x.match(/<td\b[^>]*?>/g)[0],$=x.substring(I.length,x.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${I}${$}</td>`});i.insertAdjacentHTML("afterbegin",`${O}`),o=i.querySelector("table")}if(!o||!VG(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((O,x)=>O+x.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let f=!1,g=0,w=0;if(o.tHead){const O=Array.from(o.tHead.rows).filter(x=>{const I=x.querySelector("td")!==null;return I&&h.push(x),!I});g=O.length,f=g>0,g>1?n.nestedHeaders=Array.from(O).reduce((x,I)=>{const $=Array.from(I.cells).reduce((z,q,Y)=>{if(a&&Y===0)return z;const{colSpan:K,innerHTML:te}=q,oe=K>1?{label:te,colspan:K}:te;return z.push(oe),z},[]);return x.push($),x},[]):f&&(n.colHeaders=Array.from(O[0].children).reduce((x,I,$)=>(a&&$===0||x.push(I.innerHTML),x),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const C=[...h,...Array.from(o.tBodies).reduce((O,x)=>(O.push(...Array.from(x.rows)),O),[]),...c];w=C.length;const S=new Array(w);for(let O=0;O<w;O++)S[O]=new Array(u);const b=[],_=[];for(let O=0;O<w;O++){const x=C[O],I=Array.from(x.cells),$=I.length;for(let z=0;z<$;z++){const q=I[z],{nodeName:Y,innerHTML:K,rowSpan:te,colSpan:oe}=q,ie=S[O].findIndex(ue=>ue===void 0);if(Y==="TD"){if(te>1||oe>1){for(let Ie=O;Ie<O+te;Ie++)if(Ie<w)for(let R=ie;R<ie+oe;R++)S[Ie][R]=null;const Re=q.getAttribute("style");Re&&Re.includes("mso-ignore:colspan")||b.push({col:ie,row:O,rowspan:te,colspan:oe})}let ue="";s&&/excel/gi.test(s.content)?ue=K.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ue=K.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[O][ie]=ue.replace(WG,Re=>KI[Re])}else _.push(K)}}return b.length&&(n.mergeCells=b),_.length&&(n.rowHeaders=_),S.length&&(n.data=S),n}const BG=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Aw,htmlToGridSettings:XI,instanceToHTML:Mw},Symbol.toStringTag,{value:"Module"}));function Nn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function qI(t){return Nn(t,[","])}function pe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Dd(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function gv(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function qn(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const UG=Object.freeze(Object.defineProperty({__proto__:null,clamp:qn,isNumeric:Nn,isNumericLike:qI,rangeEach:pe,rangeEachReverse:Dd,valueAccordingPercent:gv},Symbol.toStringTag,{value:"Module"})),Ow="asc",zG="desc",UR=new Map([[Ow,[-1,1]],[zG,[1,-1]]]),GG=t=>`The priority '${t}' is already declared in a map.`,YG=t=>`The priority '${t}' is not a number.`;function jG(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=gt(t)?t:GG,e=gt(e)?e:YG;function r(o,s){if(!Nn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ow;const[s,a]=UR.get(o)||UR.get(Ow);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const KG=t=>`The id '${t}' is already declared in a map.`;function Lf(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=gt(t)?t:KG;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[f,g]=h;return u===g?f:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const XG=t=>`'${t}' value is already declared in a unique set.`;function qG(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=gt(t)?t:XG;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const mv=t=>`There is already registered "${t}" plugin.`,ZG=t=>`There is already registered plugin on priority "${t}".`,QG=t=>`The priority "${t}" is not a number.`,ZI=jG({errorPriorityExists:ZG,errorPriorityNaN:QG}),QI=qG({errorItemExists:mv}),Pw=Lf({errorIdExists:mv});function pv(){return[...ZI.getItems(),...QI.getItems()]}function hc(t){const e=yn(t);return Pw.getItem(e)}function JG(t){return!!hc(t)}function et(t,e,n){[t,e,n]=tY(t,e,n),hc(t)===void 0&&eY(t,e,n)}function eY(t,e,n){const r=yn(t);if(Pw.hasItem(r))throw new Error(mv(r));n===void 0?QI.addItem(r):ZI.addItem(n,r),Pw.addItem(r,e)}function tY(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:nY,getItem:rY,hasItem:JI,getNames:iY,getValues:sle}=jr("renderers");function Nd(t){if(typeof t=="function")return t;if(!JI(t))throw Error(`No registered renderer found under "${t}" name`);return rY(t)}function li(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),nY(t,e)}const{register:oY,getItem:sY,hasItem:ex,getNames:aY,getValues:ale}=jr("validators");function wv(t){if(typeof t=="function")return t;if(!ex(t))throw Error(`No registered validator found under "${t}" name`);return sY(t)}function qa(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),oY(t,e)}var tx={},lY=zO,uY=TC,cY=Object.keys||function(e){return lY(e,uY)},hY=pi,dY=kO,fY=Ks,gY=ec,mY=hf,pY=cY;tx.f=hY&&!dY?Object.defineProperties:function(e,n){gY(e);for(var r=mY(n),i=pY(n),o=i.length,s=0,a;o>s;)fY.f(e,a=i[s++],r[a]);return e};var wY=ec,CY=tx,zR=TC,vY=bC,SY=iP,yY=SC,bY=WO,GR=">",YR="<",Iw="prototype",xw="script",nx=bY("IE_PROTO"),Gg=function(){},rx=function(t){return YR+xw+GR+t+YR+"/"+xw+GR},jR=function(t){t.write(rx("")),t.close();var e=t.parentWindow.Object;return t=null,e},RY=function(){var t=yY("iframe"),e="java"+xw+":",n;return t.style.display="none",SY.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(rx("document.F=Object")),n.close(),n.F},Wc,ed=function(){try{Wc=new ActiveXObject("htmlfile")}catch{}ed=typeof document<"u"?document.domain&&Wc?jR(Wc):RY():jR(Wc);for(var t=zR.length;t--;)delete ed[Iw][zR[t]];return ed()};vY[nx]=!0;var EY=Object.create||function(e,n){var r;return e!==null?(Gg[Iw]=wY(e),r=new Gg,Gg[Iw]=null,r[nx]=e):r=ed(),n===void 0?r:CY.f(r,n)},TY=ff,_Y=EY,MY=Ks.f,Hw=TY("unscopables"),Dw=Array.prototype;Dw[Hw]===void 0&&MY(Dw,Hw,{configurable:!0,value:_Y(null)});var ix=function(t){Dw[Hw][t]=!0},AY=Xs,OY=df,PY=gf,IY=EC,xY=ix;AY({target:"Array",proto:!0},{at:function(e){var n=OY(this),r=PY(n),i=IY(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});xY("at");const Hs=1,Cn=2;function KR(t,e,n){HY(t,e),e.set(t,n)}function HY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ei(t,e,n){return e=DY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DY(t){var e=NY(t,"string");return typeof e=="symbol"?e:String(e)}function NY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gt(t,e){var n=ox(t,e,"get");return LY(t,n)}function LY(t,e){return e.get?e.get.call(t):e.value}function XR(t,e,n){var r=ox(t,e,"set");return kY(t,r,n),n}function ox(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function kY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Vc=new WeakMap,Yt=new WeakMap;class Cv{static get DEFAULT_WIDTH(){return 50}constructor(e){Ei(this,"count",0),Ei(this,"startColumn",null),Ei(this,"endColumn",null),Ei(this,"startPosition",null),Ei(this,"isVisibleInTrimmingContainer",!1),Ei(this,"stretchAllRatio",0),Ei(this,"stretchLastWidth",0),KR(this,Vc,{writable:!0,value:0}),Ei(this,"needVerifyLastColumnWidth",!0),Ei(this,"stretchAllColumnsWidth",[]),KR(this,Yt,{writable:!0,value:void 0}),XR(this,Yt,e),typeof Gt(this,Yt).stretchingColumnWidthFn!="function"&&(Gt(this,Yt).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=Gt(this,Yt),s=Math.max(Gt(this,Yt).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,f=0,g=0;for(let b=0;b<i;b++)if(h=this._getColumnWidth(b),l<=s&&e!==Cn&&(this.startColumn=b,f=h),l>=s&&l+(e===Cn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=b,f=h),this.endColumn=b),c.push(l),l+=h,g=h,e!==Cn&&(this.endColumn=b),l>=s+o){u=!1;break}const w=r+o-a,C=e===Cn?0:g,S=e===Cn?f:0;if(w<-1*Gt(this,Yt).inlineStartOffset||r>c.at(-1)+C||-1*Gt(this,Yt).scrollOffset-Gt(this,Yt).viewportWidth>-1*S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=c[this.endColumn]+h-c[this.startColumn-1];if((b<=o||e!==Cn)&&(this.startColumn-=1),b>o)break}e===Hs&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(Gt(this,Yt).stretchMode==="none")return;let n=e;XR(this,Vc,n);const r=Gt(this,Yt).totalColumns;let i=0;for(let s=0;s<r;s++){const a=this._getColumnWidth(s),l=Gt(this,Yt).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}const o=n-i;if(Gt(this,Yt).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(Gt(this,Yt).stretchMode==="last"&&n!==1/0){const s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return Gt(this,Yt).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):Gt(this,Yt).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;const i=Gt(this,Yt).totalColumns;if(!this.stretchAllColumnsWidth[e]){const o=Math.round(n*this.stretchAllRatio),s=Gt(this,Yt).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==Gt(this,Vc)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Gt(this,Vc)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){const n=Gt(this,Yt).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=Gt(this,Yt).columnWidthFn(e);return isNaN(n)&&(n=Cv.DEFAULT_WIDTH),n}}const vv=Cv;function $Y(t,e,n){FY(t,e),e.set(t,n)}function FY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e,n){return e=WY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WY(t){var e=VY(t,"string");return typeof e=="symbol"?e:String(e)}function VY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yg(t,e){var n=sx(t,e,"get");return BY(t,n)}function BY(t,e){return e.get?e.get.call(t):e.value}function UY(t,e,n){var r=sx(t,e,"set");return zY(t,r,n),n}function sx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function zY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Al=new WeakMap;class Sv{static get DEFAULT_HEIGHT(){return 23}constructor(e){Ml(this,"count",0),Ml(this,"startRow",null),Ml(this,"endRow",null),Ml(this,"startPosition",null),Ml(this,"isVisibleInTrimmingContainer",!1),$Y(this,Al,{writable:!0,value:void 0}),UY(this,Al,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=Yg(this,Al),a=Math.max(Yg(this,Al).scrollOffset,0),l=Yg(this,Al).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let f,g=0,w=0;for(let _=0;_<o;_++)if(f=r(_),isNaN(f)&&(f=Sv.DEFAULT_HEIGHT),u<=a&&e!==Cn&&(this.startRow=_,g=f),u>=a&&u+(e===Cn?f:0)<=a+s-l&&(this.startRow===null&&(this.startRow=_,g=f),this.endRow=_),h.push(u),u+=f,w=f,e!==Cn&&(this.endRow=_),u>=a+s-l){c=!1;break}const C=i+s-l,S=e===Cn?g:0,b=e===Cn?0:w;if(C<S||i>h.at(-1)+b?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const _=h[this.endRow]+f-h[this.startRow-1];if((_<=s-l||e!==Cn)&&(this.startRow-=1),_>=s-l)break}e===Hs&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}const ax=Sv;function GY(t,e,n){YY(t,e),e.set(t,n)}function YY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qR(t,e,n){return e=jY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jY(t){var e=KY(t,"string");return typeof e=="symbol"?e:String(e)}function KY(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function la(t,e){var n=lx(t,e,"get");return XY(t,n)}function XY(t,e){return e.get?e.get.call(t):e.value}function ZR(t,e,n){var r=lx(t,e,"set");return qY(t,r,n),n}function lx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ti=new WeakMap;class Ld{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;qR(this,"row",null),qR(this,"col",null),GY(this,Ti,{writable:!0,value:!1}),ZR(this,Ti,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return la(this,Ti)}isSouthEastOf(e){return this.row>=e.row&&(la(this,Ti)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(la(this,Ti)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(la(this,Ti)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(la(this,Ti)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Ld&&ZR(this,Ti,e.isRtl()),this}clone(){return new Ld(this.row,this.col,la(this,Ti))}toObject(){return{row:this.row,col:this.col}}}const kd=Ld;function ZY(t,e,n){QY(t,e),e.set(t,n)}function QY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jg(t,e,n){return e=JY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JY(t){var e=ej(t,"string");return typeof e=="symbol"?e:String(e)}function ej(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xr(t,e){var n=ux(t,e,"get");return tj(t,n)}function tj(t,e){return e.get?e.get.call(t):e.value}function nj(t,e,n){var r=ux(t,e,"set");return rj(t,r,n),n}function ux(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ur=new WeakMap;class yv{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;jg(this,"highlight",null),jg(this,"from",null),jg(this,"to",null),ZY(this,ur,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),nj(this,ur,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),f=this._createCellCoords(u,c);return this.from=h,this.to=f,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Xr(this,ur)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Xr(this,ur)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Xr(this,ur)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Xr(this,ur)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Xr(this,ur)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Xr(this,ur)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Xr(this,ur)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Xr(this,ur)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof kd))return!1;if(n){const{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new yv(this.highlight,this.from,this.to,Xr(this,ur))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new kd(e,n,Xr(this,ur))}}const bv=yv;function kf(t){return window.requestAnimationFrame(t)}function Uu(t){window.cancelAnimationFrame(t)}function Rv(){return"ontouchstart"in window}let ua;function cx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ua||(typeof Intl=="object"?ua=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?ua=(n,r)=>`${n}`.localeCompare(r):ua=(n,r)=>n===r?0:n>r?-1:1,ua)}const ij=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Uu,getComparisonFunction:cx,isTouchSupported:Rv,requestAnimationFrame:kf},Symbol.toStringTag,{value:"Module"}));function qr(t,e,n){oj(t,e),e.set(t,n)}function oj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function we(t,e){var n=hx(t,e,"get");return sj(t,n)}function sj(t,e){return e.get?e.get.call(t):e.value}function fo(t,e,n){var r=hx(t,e,"set");return aj(t,r,n),n}function hx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var cr=new WeakMap,Kg=new WeakMap,tn=new WeakMap,ca=new WeakMap,Bc=new WeakMap,Tr=new WeakMap,Xg=new WeakMap,Ol=new WeakMap,ts=new WeakMap,Zr=new WeakMap;let lj=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;qr(this,cr,{writable:!0,value:void 0}),qr(this,Kg,{writable:!0,value:void 0}),qr(this,tn,{writable:!0,value:void 0}),qr(this,ca,{writable:!0,value:void 0}),qr(this,Bc,{writable:!0,value:void 0}),qr(this,Tr,{writable:!0,value:void 0}),qr(this,Xg,{writable:!0,value:void 0}),qr(this,Ol,{writable:!0,value:void 0}),qr(this,ts,{writable:!0,value:[null,null]}),qr(this,Zr,{writable:!0,value:[null,null]}),fo(this,cr,r),fo(this,Kg,n),fo(this,tn,o),fo(this,ca,s),fo(this,Bc,a),fo(this,Tr,i),fo(this,Xg,e),this.registerEvents()}registerEvents(){we(this,Tr).addEventListener(we(this,tn).holder,"contextmenu",r=>this.onContextMenu(r)),we(this,Tr).addEventListener(we(this,tn).TABLE,"mouseover",r=>this.onMouseOver(r)),we(this,Tr).addEventListener(we(this,tn).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{we(this,Tr).addEventListener(we(this,tn).holder,"touchstart",r=>this.onTouchStart(r)),we(this,Tr).addEventListener(we(this,tn).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),we(this,Tr).addEventListener(we(this,tn).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||we(this,cr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,we(this,cr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{we(this,Tr).addEventListener(we(this,tn).holder,"mouseup",r=>this.onMouseUp(r)),we(this,Tr).addEventListener(we(this,tn).holder,"mousedown",r=>this.onMouseDown(r))};Yi()?e():(Rv()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(we(this,Ol)&&r){const[i,o]=[r.row,we(this,Ol).from.row],[s,a]=[r.col,we(this,Ol).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=we(this,tn).TABLE,i=cu(e,["TD","TH"],r);return i?(n.coords=we(this,tn).getCoords(i),n.TD=i):Pe(e,"wtBorder")&&Pe(e,"current")?(n.coords=we(this,ca).getFocusSelection().cellRange.highlight,n.TD=we(this,tn).getCell(n.coords)):Pe(e,"wtBorder")&&Pe(e,"area")&&we(this,ca).getAreaSelection().cellRange&&(n.coords=we(this,ca).getAreaSelection().cellRange.to,n.TD=we(this,tn).getCell(n.coords)),n}onMouseDown(e){const n=we(this,Kg).rootDocument.activeElement,r=av(fI,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Pe(i,"corner")?we(this,cr).getSetting("onCellCornerMouseDown",e,i):o.TD&&we(this,cr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(we(this,Zr)[0]=o.TD,clearTimeout(we(this,ts)[0]),we(this,ts)[0]=setTimeout(()=>{we(this,Zr)[0]=null},1e3))}onContextMenu(e){if(we(this,cr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!we(this,cr).has("onCellMouseOver"))return;const n=we(this,tn).TABLE,r=cu(e.target,["TD","TH"],n),i=we(this,Bc)||this;r&&r!==i.lastMouseOver&&No(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,we(this,tn).getCoords(r),r))}onMouseOut(e){if(!we(this,cr).has("onCellMouseOut"))return;const n=we(this,tn).TABLE,r=cu(e.target,["TD","TH"],n),i=cu(e.relatedTarget,["TD","TH"],n),o=we(this,Bc)||this;r&&r!==i&&No(r,n)&&(this.callListener("onCellMouseOut",e,we(this,tn).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&we(this,cr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===we(this,Zr)[0]&&n.TD===we(this,Zr)[1]?(Pe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),we(this,Zr)[0]=null,we(this,Zr)[1]=null):n.TD===we(this,Zr)[0]&&(we(this,Zr)[1]=n.TD,clearTimeout(we(this,ts)[1]),we(this,ts)[1]=setTimeout(()=>{we(this,Zr)[1]=null},500)))}onTouchStart(e){fo(this,Ol,we(this,ca).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=le(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&we(this,cr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];cv()&&(DI()||NI())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=we(this,cr).getSettingPure(e);o&&o(n,r,i,we(this,Xg).call(this))}destroy(){clearTimeout(we(this,ts)[0]),clearTimeout(we(this,ts)[1]),we(this,Tr).destroy()}};const dx=lj;function qg(t,e,n){return e=uj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uj(t){var e=cj(t,"string");return typeof e=="symbol"?e:String(e)}function cj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hj{constructor(e,n,r){qg(this,"offset",void 0),qg(this,"total",void 0),qg(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const dj=hj;function Zg(t,e,n){return e=fj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fj(t){var e=gj(t,"string");return typeof e=="symbol"?e:String(e)}function gj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mj{constructor(e,n,r){Zg(this,"offset",void 0),Zg(this,"total",void 0),Zg(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const pj=mj,wj=0,$d=1,Fd=2;function Uc(t,e,n){return e=Cj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cj(t){var e=vj(t,"string");return typeof e=="symbol"?e:String(e)}function vj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QR{constructor(){Uc(this,"currentSize",0),Uc(this,"nextSize",0),Uc(this,"currentOffset",0),Uc(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Qg(t,e,n){return e=Sj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sj(t){var e=yj(t,"string");return typeof e=="symbol"?e:String(e)}function yj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bj{constructor(){Qg(this,"size",new QR),Qg(this,"workingSpace",wj),Qg(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof QR}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=$d,e.workingSpace=Fd,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Fd,e.workingSpace=$d,this.sharedSize=e.getViewSize()}}function ha(t,e,n){return e=Rj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rj(t){var e=Ej(t,"string");return typeof e=="symbol"?e:String(e)}function Ej(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fx{constructor(e,n,r){ha(this,"rootNode",void 0),ha(this,"nodesPool",void 0),ha(this,"sizeSet",new bj),ha(this,"childNodeType",void 0),ha(this,"visualIndex",0),ha(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn($d))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Fd)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn($d);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Fd)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class gx extends fx{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Tj(t,e,n){return e=_j(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _j(t){var e=Mj(t,"string");return typeof e=="symbol"?e:String(e)}function Mj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aj{constructor(e){Tj(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Pl(t,e,n){return e=Oj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oj(t){var e=Pj(t,"string");return typeof e=="symbol"?e:String(e)}function Pj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dc{constructor(e,n){Pl(this,"nodesPool",null),Pl(this,"nodeType",void 0),Pl(this,"rootNode",void 0),Pl(this,"table",null),Pl(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Aj(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function JR(t,e,n){return e=Ij(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ij(t){var e=xj(t,"string");return typeof e=="symbol"?e:String(e)}function xj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hj extends dc{constructor(){super("TH"),JR(this,"orderViews",new WeakMap),JR(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new gx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const f=u.getCurrentNode();f.className="",f.removeAttribute("style"),Ko(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(f,[hz(),vz(),JC(h+1),dl(-1)]),n[h](a,f,h)}u.end()}}}class Dj extends dc{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Gr(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&ve(this.rootNode,[Fr()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&ve(s,[lI(),dI(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Ko(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&ve(u,[JC(a+1+this.table.rowHeadersCount),dl(-1),...a<0?[Fr()]:[dz(),Cz()]]),r[n](l,u,n)}}}}class Nj extends dc{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&ee(r,"rowHeader")}}function Lj(t,e,n){return e=kj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kj(t){var e=$j(t,"string");return typeof e=="symbol"?e:String(e)}function $j(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let eE=!1;class Fj extends dc{constructor(e){super("TR",e),Lj(this,"orderView",void 0),this.orderView=new fx(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!eE&&e>1e3&&(eE=!0,pt(ct`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&ve(this.rootNode,[Fr()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;ve(o,[lI(),dI(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function tE(t,e,n){return e=Wj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wj(t){var e=Vj(t,"string");return typeof e=="symbol"?e:String(e)}function Vj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bj extends dc{constructor(){super("TD"),tE(this,"orderViews",new WeakMap),tE(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new gx(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let f=0;f<n;f++){c.render();const g=c.getCurrentNode(),w=this.table.renderedColumnToSource(f);if(Pe(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),Ko(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,w,g),this.table.isAriaEnabled()){var o,s;ve(g,[...g.hasAttribute("role")?[]:[cz()],dl(-1),JC(w+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function nn(t,e,n){return e=Uj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uj(t){var e=zj(t,"string");return typeof e=="symbol"?e:String(e)}function zj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gj{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};nn(this,"rootNode",void 0),nn(this,"rootDocument",void 0),nn(this,"rowHeaders",null),nn(this,"columnHeaders",null),nn(this,"colGroup",null),nn(this,"rows",null),nn(this,"cells",null),nn(this,"rowFilter",null),nn(this,"columnFilter",null),nn(this,"rowUtils",null),nn(this,"columnUtils",null),nn(this,"rowsToRender",0),nn(this,"columnsToRender",0),nn(this,"rowHeaderFunctions",[]),nn(this,"rowHeadersCount",0),nn(this,"columnHeaderFunctions",[]),nn(this,"columnHeadersCount",0),nn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class Yj{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Gj(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new Hj,columnHeaders:new Dj(n),colGroup:new Nj(r),rows:new Fj(i),cells:new Bj}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function Jg(t,e,n){return e=jj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jj(t){var e=Kj(t,"string");return typeof e=="symbol"?e:String(e)}function Kj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xj{constructor(e,n){Jg(this,"dataAccessObject",void 0),Jg(this,"wtSettings",void 0),Jg(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const n=this.dataAccessObject.wtViewport.columnsRenderCalculator;let r=this.getWidth(e);if(n){const i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?Jt():0;let a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const l=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let c=0;c<l;c++){let h=Array.isArray(a)?a[c]:a;h=h??u,this.headerWidths.set(c,h)}}}}function nE(t,e,n){return e=qj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qj(t){var e=Zj(t,"string");return typeof e=="symbol"?e:String(e)}function Zj(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qj{constructor(e,n){nE(this,"dataAccessObject",void 0),nE(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function Qr(t,e,n){return e=Jj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jj(t){var e=eK(t,"string");return typeof e=="symbol"?e:String(e)}function eK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tK{constructor(e,n,r,i,o){Qr(this,"wtSettings",null),Qr(this,"domBindings",void 0),Qr(this,"TBODY",null),Qr(this,"THEAD",null),Qr(this,"COLGROUP",null),Qr(this,"hasTableHeight",!0),Qr(this,"hasTableWidth",!0),Qr(this,"isTableVisible",!1),Qr(this,"tableOffset",0),Qr(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,ev(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Qj(this.dataAccessObject,this.wtSettings),this.columnUtils=new Xj(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Yj({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&ve(r,[Fr()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[Fr()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&ve(r.parentNode,[Fr()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&ve(r,[Fr()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,f=e;if(this.isMaster&&(this.holderOffset=Bt(this.holder),f=i.createRenderCalculators(f),l&&!n.getSetting("fixedColumnsStart"))){const w=r.inlineStartOverlay.getScrollPosition(),C=this.correctHeaderWidth;this.correctHeaderWidth=w!==0,C!==this.correctHeaderWidth&&(f=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),f)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=Bt(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const w=o>0?this.getFirstRenderedRow():0,C=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new pj(w,o,c),this.columnFilter=new dj(C,s,l);let S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),S=b.skipRender!==!0}if(S){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(di)||this.is(ko))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let b;if(this.isMaster&&(b=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(di))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const _=ut(this.hider),O=ut(this.TABLE);_!==0&&O!==_&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(di)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(g=r.bottomOverlay.resetFixedPosition()||g),g=r.inlineStartOverlay.resetFixedPosition()||g,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(f),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=Gi(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(di))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Vo(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=pI(r),s=n.cellIndex;return Eo(Ys,n,this.wtRootElement)||Eo(zs,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Eo(ko,n,this.wtRootElement)||Eo(di,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),Eo(Ys,n,this.wtRootElement)||Eo(Gs,n,this.wtRootElement)||Eo(ko,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=Gi(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=Gi(l):o=Gi(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ut(this.TABLE)}getHeight(){return Ot(this.TABLE)}getTotalWidth(){const e=ut(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Ot(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Uo(this.TABLE)}_modifyRowHeaderWidth(e){let n=gt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const pl=tK,nK="stickyRowsBottom",mx={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Si(mx,"MIXIN_NAME",nK,{writable:!1,enumerable:!1});const px=mx,rK="stickyColumnsStart",wx={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Si(wx,"MIXIN_NAME",rK,{writable:!1,enumerable:!1});const Ev=wx;class Tv extends pl{constructor(e,n,r,i){super(e,n,r,i,ko)}}dt(Tv,px);dt(Tv,Ev);const iK=Tv,zs="top",di="bottom",Gs="inline_start",Ys="top_inline_start_corner",ko="bottom_inline_start_corner",oK=[zs,di,Gs,Ys,ko],sK=new Map([[zs,`ht_clone_${zs}`],[di,`ht_clone_${di}`],[Gs,`ht_clone_${Gs} ht_clone_left`],[Ys,`ht_clone_${Ys} ht_clone_top_left_corner`],[ko,`ht_clone_${ko} ht_clone_bottom_left_corner`]]);function em(t,e,n){return e=aK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aK(t){var e=lK(t,"string");return typeof e=="symbol"?e:String(e)}function lK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uK{constructor(e){em(this,"dataAccessObject",void 0),em(this,"lastScrolledColumnPos",-1),em(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let f=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?f=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(f=h.scrollTo(e,l?e>a:r)),f&&(this.lastScrolledRowPos=e),f}getFirstVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject;let a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const l=Bt(n.wtRootElement),u=Gi(n.hider),c=Gi(s),h=Wu(s,s);if(l.top+u-c<=h){let f=r.getColumnHeaderHeight();f+=e.sumCellSizes(0,o);for(let g=i;g>0;g--)if(f+=e.sumCellSizes(g-1,g),l.top+u-f<=h){a=g;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=Bt(n.wtRootElement),l=Wu(o,o);if(a.top>l){const u=Gi(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject;let s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){const a=Bt(n.wtRootElement),l=yu(n.hider),u=yu(o),c=Math.abs(Pd(o,o));if(a.left+l-u<=c){let h=r.getRowHeaderWidth();for(let f=i;f>0;f--)if(h+=e.sumCellSizes(f-1,f),a.left+l-h<=c){s=f;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),g=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-g)}else u=Bt(r.wtRootElement).left;const c=Math.abs(Pd(s,s));if(u>c){const h=yu(s);let f=i.getRowHeaderWidth();for(let g=1;g<=o;g++)if(f+=n.sumCellSizes(g-1,g),u+f-c>=h){a=g-2;break}}}return a}}const cK=uK;function _r(t,e,n){return e=hK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hK(t){var e=dK(t,"string");return typeof e=="symbol"?e:String(e)}function dK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _v{get eventManager(){return new ar(this)}constructor(e,n){_r(this,"wtTable",void 0),_r(this,"wtScroll",void 0),_r(this,"wtViewport",void 0),_r(this,"wtOverlays",void 0),_r(this,"selectionManager",void 0),_r(this,"wtEvent",void 0),_r(this,"guid",`wt_${qC()}`),_r(this,"drawInterrupted",!1),_r(this,"drawn",!1),_r(this,"domBindings",void 0),_r(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new cK(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){Bo(r,e[n])}])}}createCellCoords(e,n){return new kd(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new bv(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function rE(t,e,n){return e=fK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fK(t){var e=gK(t,"string");return typeof e=="symbol"?e:String(e)}function gK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mK extends _v{constructor(e,n,r){super(e,n),rE(this,"cloneSource",void 0),rE(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new dx(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function pK(t,e,n){return e=wK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wK(t){var e=CK(t,"string");return typeof e=="symbol"?e:String(e)}function CK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class fc{constructor(e,n,r,i,o){pK(this,"wtSettings",null),Si(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Vs(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Vs(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Vu(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){pt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+Jt())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(oK.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("DIV"),s=r.createElement("TABLE"),a=e.wtRootElement.parentNode;o.className=`${sK.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&ve(o,[Fr()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===zs||u==="vertical"&&this.type===Gs?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Vu(e.TABLE),new mK(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;T([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class vK extends fc{constructor(e,n,r,i,o,s){super(e,n,ko,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new iK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else lc(n),this.repositionOverlay();let r=Ot(this.clone.wtTable.TABLE);const i=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Jt(r)),i.style.bottom=`${o}px`}}const SK="calculatedColumns",Cx={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Si(Cx,"MIXIN_NAME",SK,{writable:!1,enumerable:!1});const Mv=Cx;class Av extends pl{constructor(e,n,r,i){super(e,n,r,i,di)}}dt(Av,px);dt(Av,Mv);const yK=Av;function bK(t,e,n){return e=RK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RK(t){var e=EK(t,"string");return typeof e=="symbol"?e:String(e)}function EK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TK extends fc{constructor(e,n,r,i){super(e,n,di,r,i),bK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new yK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=Jt(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Of(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=Jt(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Ot(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=Jt(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Wu(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Pe(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ee(s,"innerBorderBottom"),o=!a):(De(s,"innerBorderBottom"),o=a)}return o}}const _K="calculatedRows",vx={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Si(vx,"MIXIN_NAME",_K,{writable:!1,enumerable:!1});const Sx=vx;class Ov extends pl{constructor(e,n,r,i){super(e,n,r,i,Gs)}}dt(Ov,Sx);dt(Ov,Ev);const MK=Ov,AK="localHooks",yx={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)xd(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Si(yx,"MIXIN_NAME",AK,{writable:!1,enumerable:!1});const Qn=yx;let bx=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};dt(bx,Qn);const OK=bx,Rx="active-header",Pv="header",Iv="area",xv="focus",PK="fill",IK="row",xK="column",HK="custom-selection",Hv=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var DK=ix;DK("flat");function NK(t,e){Ex(t,e),e.add(t)}function iE(t,e,n){Ex(t,e),e.set(t,n)}function Ex(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Wt(t,e){var n=Tx(t,e,"get");return LK(t,n)}function LK(t,e){return e.get?e.get.call(t):e.value}function oE(t,e,n){var r=Tx(t,e,"set");return kK(t,r,n),n}function Tx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function kK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Mr=new WeakMap,zn=new WeakMap,zc=new WeakSet;class $K{constructor(){NK(this,zc),iE(this,Mr,{writable:!0,value:void 0}),iE(this,zn,{writable:!0,value:void 0})}setActiveOverlay(e){return oE(this,zn,e),this}setActiveSelection(e){return oE(this,Mr,e),this}scan(){const e=Wt(this,Mr).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=Wt(this,Mr).getCorners(),{wtTable:s}=Wt(this,zn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let f=-l;f<0;f++){if(f<n||f>i)continue;const g=f+l;let w=s.getColumnHeader(h,g);const C=Wt(this,zn).getSetting("onBeforeHighlightingColumnHeader",h,g,{selectionType:Wt(this,Mr).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});C!==null&&(C!==h&&(w=s.getColumnHeader(C,g)),e(w))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=Wt(this,Mr).getCorners(),{wtTable:s}=Wt(this,zn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let f=-l;f<0;f++){if(f<r||f>o)continue;const g=f+l;let w=s.getRowHeader(h,g);const C=Wt(this,zn).getSetting("onBeforeHighlightingRowHeader",h,g,{selectionType:Wt(this,Mr).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});C!==null&&(C!==h&&(w=s.getRowHeader(C,g)),e(w))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=Wt(this,Mr).getCorners(),{wtTable:s}=Wt(this,zn);tm(this,zc,nm).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(Wt(this,zn).createCellCoords(a,l)),c=Wt(this,zn).getSetting("onAfterDrawSelection",a,l,Wt(this,Mr).settings.layerLevel);typeof c=="string"&&ee(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=Wt(this,Mr).getCorners(),{wtTable:i}=Wt(this,zn);tm(this,zc,nm).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(Wt(this,zn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=Wt(this,Mr).getCorners(),{wtTable:i}=Wt(this,zn);tm(this,zc,nm).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(Wt(this,zn).createCellCoords(o,s));e(a)}})}}function nm(t){const{wtTable:e}=Wt(this,zn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class FK{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Hv,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Rr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Yi()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Be(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Be(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:f}=this.selectionHandles.styles,g=parseInt(u.borderWidth,10),w=parseInt(u.width,10),C=parseInt(c.width,10),S=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();u.top=`${parseInt(r-w-1,10)}px`,u[l]=`${parseInt(i-w-1,10)}px`,c.top=`${parseInt(r-C/4*3,10)}px`,c[l]=`${parseInt(i-C/4*3,10)}px`;const _=Math.min(parseInt(i+o,10),S-w-g*2),O=Math.min(parseInt(i+o-C/4,10),S-C-g*2);h[l]=`${_}px`,f[l]=`${O}px`;const x=Math.min(parseInt(r+s,10),b-w-g*2),I=Math.min(parseInt(r+s-C/4,10),b-C-g*2);h.top=`${x}px`,f.top=`${I}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",f.display="none"):(h.display="block",f.display="block")):(u.display="none",h.display="none",c.display="none",f.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let R=0;R<h;R+=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){o=d,u=e[0];break}}for(let R=h-1;R>=0;R-=1){const d=n.rowFilter.renderedToSource(R);if(d>=e[0]&&d<=e[2]){s=d;break}}const f=n.getRenderedColumnsCount();for(let R=0;R<f;R+=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){a=d,c=e[1];break}}for(let R=f-1;R>=0;R-=1){const d=n.columnFilter.renderedToSource(R);if(d>=e[1]&&d<=e[3]){l=d;break}}if(o===void 0||a===void 0){this.disappear();return}let g=n.getCell(this.wot.createCellCoords(o,a));const w=o!==s||a!==l,C=w?n.getCell(this.wot.createCellCoords(s,l)):g,S=Bt(g),b=w?Bt(C):S,_=Bt(n.TABLE),O=ut(n.TABLE),x=S.top,I=S.left,$=this.wot.wtSettings.getSetting("rtlMode");let z=0,q=0;if($){const R=ut(g),d=i.innerWidth-_.left-O;q=I+R-b.left,z=i.innerWidth-I-R-d-1}else q=b.left+ut(C)-I,z=I-_.left-1;if(this.isEntireColumnSelected(o,s)){const R=this.getDimensionsFromHeader("columns",a,l,u,_);let d=null;R&&([d,z,q]=R),d&&(g=d)}let Y=x-_.top-1,K=b.top+Ot(C)-x;if(this.isEntireRowSelected(a,l)){const R=this.getDimensionsFromHeader("rows",o,s,c,_);let d=null;R&&([d,Y,K]=R),d&&(g=d)}const te=eo(g,i);parseInt(te.borderTopWidth,10)>0&&(Y+=1,K=K>0?K-1:0),parseInt(te[$?"borderRightWidth":"borderLeftWidth"],10)>0&&(z+=1,q=q>0?q-1:0);const oe=$?"right":"left";this.topStyle.top=`${Y}px`,this.topStyle[oe]=`${z}px`,this.topStyle.width=`${q}px`,this.topStyle.display="block",this.startStyle.top=`${Y}px`,this.startStyle[oe]=`${z}px`,this.startStyle.height=`${K}px`,this.startStyle.display="block";const ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Y+K-ie}px`,this.bottomStyle[oe]=`${z}px`,this.bottomStyle.width=`${q}px`,this.bottomStyle.display="block",this.endStyle.top=`${Y}px`,this.endStyle[oe]=`${z+q-ie}px`,this.endStyle.height=`${K+1}px`,this.endStyle.display="block";let ue=this.settings.border.cornerVisible;ue=typeof ue=="function"?ue(this.settings.layerLevel):ue;const Re=this.wot.getSetting("onModifyGetCellCoords",s,l);let[Ue,Ie]=[s,l];if(Re&&Array.isArray(Re)&&([,,Ue,Ie]=Re),Yi()||!ue||this.isPartRange(Ue,Ie))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Y+K+this.cornerCenterPointOffset-1}px`,this.cornerStyle[oe]=`${z+q+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let R=Vs(n.TABLE);const d=R===i;d&&(R=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,p=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const E=d?C.getBoundingClientRect().left:C.offsetLeft;let M=!1,P=0;$?(P=E-parseInt(this.cornerDefaultStyle.width,10)/2,M=P<0):(P=E+ut(C)+parseInt(this.cornerDefaultStyle.width,10)/2,M=P>=yu(R)),M&&(this.cornerStyle[oe]=`${Math.floor(z+q+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[$?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(d?C.getBoundingClientRect().top:C.offsetTop)+Ot(C)+parseInt(this.cornerDefaultStyle.height,10)/2>=Gi(R)&&(this.cornerStyle.top=`${Math.floor(Y+K+this.cornerCenterPointOffset-p)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Yi()&&this.updateMultipleSelectionHandlesPosition(s,l,Y,z,q,K)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,f=null,g=null,w=null,C=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return Ot(...arguments)},c="ht__selection--rows",g="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ut(...arguments)},c="ht__selection--columns",g="left";break}if(a.classList.contains(c)){const S=this.wot.getSetting("columnHeaders").length;if(w=l(n,S-i),C=l(r,S-i),!w||!C)return!1;const b=Bt(w),_=Bt(C);return w&&C&&(h=b[g]-o[g]-1,f=_[g]+u(C)-b[g]),[w,h,f]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?ee(this[e],"hidden"):(Pe(this[e],"hidden")&&De(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?ee(this[e],"hidden"):De(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Yi()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const sE=FK;function WK(t,e){_x(t,e),e.add(t)}function da(t,e,n){_x(t,e),e.set(t,n)}function _x(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VK(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function We(t,e){var n=Mx(t,e,"get");return BK(t,n)}function BK(t,e){return e.get?e.get.call(t):e.value}function aE(t,e,n){var r=Mx(t,e,"set");return UK(t,r,n),n}function Mx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function UK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var mn=new WeakMap,wn=new WeakMap,rm=new WeakMap,hu=new WeakMap,im=new WeakMap,ns=new WeakMap,lE=new WeakSet;class zK{constructor(e){WK(this,lE),da(this,mn,{writable:!0,value:void 0}),da(this,wn,{writable:!0,value:void 0}),da(this,rm,{writable:!0,value:new $K}),da(this,hu,{writable:!0,value:new WeakMap}),da(this,im,{writable:!0,value:new WeakSet}),da(this,ns,{writable:!0,value:new Map}),aE(this,wn,e)}setActiveOverlay(e){return aE(this,mn,e),We(this,rm).setActiveOverlay(We(this,mn)),We(this,hu).has(We(this,mn))||We(this,hu).set(We(this,mn),new Set),this}getFocusSelection(){return We(this,wn)!==null?We(this,wn).getFocus():null}getAreaSelection(){return We(this,wn)!==null?We(this,wn).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(We(this,ns).has(e)){const r=We(this,ns).get(e);if(r.has(We(this,mn)))return r.get(We(this,mn));const i=new sE(We(this,mn),e.settings);return r.set(We(this,mn),i),i}const n=new sE(We(this,mn),e.settings);return We(this,ns).set(e,new Map([[We(this,mn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=We(this,ns).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){We(this,ns).get(e).forEach(n=>n.destroy()),We(this,ns).delete(e)}render(e){if(We(this,wn)===null)return;e&&VK(this,lE,GK).call(this);const n=Array.from(We(this,wn)),r=new Map;for(let i=0;i<n.length;i++){const o=n[i],{className:s,createLayers:a,selectionType:l}=o.settings;We(this,im).has(o)||(We(this,im).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const u=this.getBorderInstance(o);if(o.isEmpty()){u==null||u.disappear();continue}s&&We(this,rm).setActiveSelection(o).scan().forEach(f=>{if(r.has(f)){const g=r.get(f);g.has(s)&&a===!0?g.set(s,g.get(s)+1):g.set(s,1)}else r.set(f,new Map([[s,1]]))});const c=o.getCorners();We(this,mn).getSetting("onBeforeDrawBorders",c,l),u==null||u.appear(c)}r.forEach((i,o)=>{var s,a;const l=Array.from(i).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(f,g)=>`${c}-${g+1}`)]}).flat();l.forEach(u=>We(this,hu).get(We(this,mn)).add(u)),ee(o,l),o.nodeName==="TD"&&Array.isArray((s=We(this,wn).options)===null||s===void 0?void 0:s.cellAttributes)?ve(o,We(this,wn).options.cellAttributes):o.nodeName==="TH"&&Array.isArray((a=We(this,wn).options)===null||a===void 0?void 0:a.headerAttributes)&&ve(o,We(this,wn).options.headerAttributes)})}}function GK(){const t=We(this,hu).get(We(this,mn)),e=We(this,mn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=We(this,mn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=We(this,wn).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=We(this,wn).options.cellAttributes.map(a=>a[0])),Array.isArray((i=We(this,wn).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...We(this,wn).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)De(o[a],n),Ko(o[a],s)}),t.clear()}class YK extends fc{constructor(e,n,r,i){super(e,n,Gs,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new MK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),Pf(r,`${o}px`,"0px")):(o=this.getScrollPosition(),lc(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,tv(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Jt(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ut(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(Hv.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=Jt(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(Pd(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?De(n,"emptyRows"):ee(n,"emptyRows");let s=!1;if(i&&!r.length)ee(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=Pe(n,"innerBorderInlineStart");e?(ee(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(De(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const jK="stickyRowsTop",Ax={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Si(Ax,"MIXIN_NAME",jK,{writable:!1,enumerable:!1});const Ox=Ax;class Dv extends pl{constructor(e,n,r,i){super(e,n,r,i,Ys)}}dt(Dv,Ox);dt(Dv,Ev);const KK=Dv;function uE(t,e,n){return e=XK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XK(t){var e=qK(t,"string");return typeof e=="symbol"?e:String(e)}function qK(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZK extends fc{constructor(e,n,r,i,o,s){super(e,n,Ys,r,i),uE(this,"topOverlay",void 0),uE(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new KK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();Pf(e,`${i}px`,`${o}px`)}else lc(e);let n=Ot(this.clone.wtTable.TABLE);const r=ut(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class Nv extends pl{constructor(e,n,r,i){super(e,n,r,i,zs)}}dt(Nv,Ox);dt(Nv,Mv);const QK=Nv;function JK(t,e,n){return e=e3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e3(t){var e=t3(t,"string");return typeof e=="symbol"?e:String(e)}function t3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n3 extends fc{constructor(e,n,r,i){super(e,n,zs,r,i),JK(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new QK(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),Pf(e,"0px",`${i}px`)}else i=this.getScrollPosition(),lc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Of(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Jt(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Ot(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(Hv.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=Jt(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Wu(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?De(r,"emptyColumns"):ee(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=Pe(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(ee(r,"innerBorderTop"),o=!u):(De(r,"innerBorderTop"),o=u)}}return o}}function _i(t,e,n){return e=r3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r3(t){var e=i3(t,"string");return typeof e=="symbol"?e:String(e)}function i3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o3{constructor(e,n,r,i,o,s){_i(this,"wot",null),_i(this,"topOverlay",null),_i(this,"bottomOverlay",null),_i(this,"inlineStartOverlay",null),_i(this,"topInlineStartCornerOverlay",null),_i(this,"bottomInlineStartCornerOverlay",null),_i(this,"browserLineHeight",void 0),_i(this,"wtSettings",null),_i(this,"resizeObserver",new ResizeObserver(c=>{kf(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=Jt(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Vu(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new n3(...e),this.bottomOverlay=new TK(...e),this.inlineStartOverlay=new YK(...e),this.topInlineStartCornerOverlay=new ZK(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new vK(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!lv())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:f}=h.clone.wtTable;this.eventManager.addEventListener(f,"wheel",g=>this.onCloneWheel(g,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=ml(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Vu(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:f}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<f,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return T(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];T(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const s3=o3;function cE(t,e,n){return e=a3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a3(t){var e=l3(t,"string");return typeof e=="symbol"?e:String(e)}function l3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class u3{constructor(e){cE(this,"settings",{}),cE(this,"defaults",Object.freeze(this.getDefaults())),Be(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);Bo(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Be(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Lv extends pl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Vs(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=il(e,"height",n),o=il(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const f=e.cloneNode(!1);f.style.overflow="auto",f.style.position="absolute",e.nextElementSibling?r.insertBefore(f,e.nextElementSibling):r.appendChild(f);const g=parseInt(eo(f,n).height,10);r.removeChild(f),g===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Uo(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}dt(Lv,Sx);dt(Lv,Mv);const c3=Lv;class h3{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Ot(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let f,g;if(a)return ut(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?f=Math.min(h,o):f=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>f)return n.documentElement.clientWidth;if(i!==r&&(g=il(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),g==="scroll"||g==="hidden"||g==="auto"))return Math.max(f,i.clientWidth);const w=e.getSetting("stretchH");return w==="none"||!w?Math.max(f,ut(this.wtTable.TABLE)):f}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return Bt(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ot(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=ut(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hs;const{wtSettings:n,wtTable:r}=this;let i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===Hs?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=Jt(this.domBindings.rootDocument),new ax({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hs;const{wtSettings:n,wtTable:r}=this;let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=Jt(this.domBindings.rootDocument)),new vv({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){const r=this.createRowsCalculator(Cn),i=this.createColumnsCalculator(Cn);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(Hs),this.columnsRenderCalculator=this.createColumnsCalculator(Hs)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(Cn),this.columnsVisibleCalculator=this.createColumnsCalculator(Cn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Be(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const d3=h3;class f3 extends _v{constructor(e,n){super(e,new u3(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new c3(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new d3(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new zK(this.wtSettings.getSetting("selections")),this.wtEvent=new dx(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new s3(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Be(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),De(this.wtTable.wtRootElement.parentNode,n),ee(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class kv{constructor(e){e instanceof _v?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new kv(n);return()=>r},this._wot=new f3(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function hE(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),f=n||r&&h;i.row<0&&i.col>=0&&!s.column?f&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?f&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?f&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function g3(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const m3=new Map([["mousedown",hE],["mouseover",g3],["touchstart",hE]]);function dE(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;m3.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:Df(t)||t.type==="touchstart",isRightClick:zo(t)})}const Px=new WeakMap,$v=Symbol("rootInstance");function p3(t){Px.set(t,!0)}function w3(t){return t===$v}function td(t){return Px.has(t)}function rs(t,e,n){C3(t,e),e.set(t,n)}function C3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function go(t,e,n){return e=v3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v3(t){var e=S3(t,"string");return typeof e=="symbol"?e:String(e)}function S3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function un(t,e){var n=Ix(t,e,"get");return y3(t,n)}function y3(t,e){return e.get?e.get.call(t):e.value}function hr(t,e,n){var r=Ix(t,e,"set");return b3(t,r,n),n}function Ix(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var om=new WeakMap,sm=new WeakMap,Gc=new WeakMap,Mi=new WeakMap,Ar=new WeakMap,am=new WeakMap,lm=new WeakMap;class R3{constructor(e){go(this,"hot",void 0),go(this,"eventManager",void 0),go(this,"settings",void 0),go(this,"THEAD",void 0),go(this,"TBODY",void 0),go(this,"_wt",void 0),go(this,"activeWt",void 0),rs(this,om,{writable:!0,value:0}),rs(this,sm,{writable:!0,value:0}),go(this,"postponedAdjustElementsSize",!1),rs(this,Gc,{writable:!0,value:!1}),rs(this,Mi,{writable:!0,value:void 0}),rs(this,Ar,{writable:!0,value:void 0}),rs(this,am,{writable:!0,value:0}),rs(this,lm,{writable:!0,value:0}),this.hot=e,this.eventManager=new ar(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),ee(e,"handsontable"),hr(this,Ar,n.createElement("TABLE")),ee(un(this,Ar),"htCore"),this.hot.getSettings().tableClassName&&ee(un(this,Ar),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(ve(un(this,Ar),[Fr()]),ve(e,[uz(),cI(this.hot.countRows()),hI(this.hot.countCols()),bz()])),this.THEAD=n.createElement("THEAD"),un(this,Ar).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),un(this,Ar).appendChild(this.TBODY),this.hot.table=un(this,Ar),this.hot.container.insertBefore(un(this,Ar),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(hr(this,Gc,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;yw(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{hr(this,Gc,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{un(this,Gc)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&yw(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&Df(o)&&r.finish(),hr(this,Mi,!1);const s=If(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!zo(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&zo(o)&&(r.finish(),hr(this,Mi,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),hr(this,Mi,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(un(this,Mi)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const f=Jt(n);if(n.elementFromPoint(a+f,l)!==c||n.elementFromPoint(a,l+f)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(un(this,Ar),"selectstart",o=>{this.settings.fragmentSelection||Id(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:un(this,Ar),isDataViewInstance:()=>td(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),hr(this,sm,o.length),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),hr(this,om,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,f=u;Array.isArray(c)&&([h,f]=c);const g=this.hot.getCellMeta(h,f),w=this.hot.colToProp(f);let C=this.hot.getDataAtRowProp(h,w);this.hot.hasHook("beforeValueRender")&&(C=this.hot.runHooks("beforeValueRender",C,g)),this.hot.runHooks("beforeRenderer",a,l,u,w,C,g),this.hot.getCellRenderer(g)(this.hot,a,l,u,w,C,g),this.hot.runHooks("afterRenderer",a,l,u,w,C,g)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Uo(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,hr(this,Mi,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Ao(o)&&(dE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,hr(this,Mi,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Ao(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Ao(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Ao(o)&&(un(this,Mi)&&dE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,f)=>this.hot._createCellCoords(h,f)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Ao(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const g=h.peekByIndex(a??0);l=[g.from.row,g.from.col,g.to.row,g.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,f=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(f)){const[g,w,C,S]=f;return[g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,1)):g,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,1)):w,C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,-1)):C,S>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(S,-1)):S]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new kv(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Id(e))return!0;const n=No(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return un(this,Mi)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Pe(r,"relative")){Gr(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;Pe(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(Gr(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Pe(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Pe(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Qs(e,r(n,i)):(Bo(e,String.fromCharCode(160)),ee(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){hr(this,am,e),hr(this,lm,n)}getLastSize(){return{width:un(this,am),height:un(this,lm)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return un(this,om)}getRowHeadersCount(){return un(this,sm)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}const E3=R3,xx="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Nw=xx.length;function $f(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%Nw,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/Nw,10);return n}function T3(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Nw**r*(xx.indexOf(t[n])+1);return e-=1,e}function _3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push($f(i)+(r+1));n.push(o)}return n}function M3(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=$f(i)+(r+1);n.push(o)}return n}function A3(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function Fv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function Wv(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&$e(t[0])&&(e=Hf(t[0]))),e}function Hx(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Dx(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const O3=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:Wv,createEmptySpreadsheetData:A3,createSpreadsheetData:_3,createSpreadsheetObjectData:M3,dataRowToChangesArray:Fv,isArrayOfArrays:Hx,isArrayOfObjects:Dx,spreadsheetColumnIndex:T3,spreadsheetColumnLabel:$f},Symbol.toStringTag,{value:"Module"}));function Il(t,e,n){return e=P3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P3(t){var e=I3(t,"string");return typeof e=="symbol"?e:String(e)}function I3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Il(this,"hot",void 0),Il(this,"data",void 0),Il(this,"dataType","array"),Il(this,"colToProp",()=>{}),Il(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return T(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):pe(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if($e(s)||gt(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;pe(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const f=this.getAtPhysicalCell(e,h,s);i?a.push(f):Zh(a,h,f)}})}else Be(s,(l,u)=>{Zh(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=Us(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:Zh(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=II(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=Us(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return pe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Wv(this.data)}destroy(){this.data=null,this.hot=null}}const H3=x3;function fE(t,e,n){return e=D3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D3(t){var e=N3(t,"string");return typeof e=="symbol"?e:String(e)}function N3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Js{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;fE(this,"indexedValues",[]),fE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,gt(this.initValueOrFn)?pe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):pe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}dt(Js,Qn);function Vv(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>gt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function Bv(t,e){return sr(t,(n,r)=>e.includes(r)===!1)}class Xo extends Js{insert(e,n){this.indexedValues=Vv(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=Bv(this.indexedValues,e),super.remove(e)}}class Ff extends Xo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Ft(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function Uv(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function zu(t,e){return sr(t,n=>e.includes(n)===!1)}function zv(t,e){return Ve(t,n=>n-e.filter(r=>r<n).length)}function Gv(t,e){const n=e[0],r=e.length;return Ve(t,i=>i>=n?i+r:i)}function L3(t,e,n){return e=k3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k3(t){var e=$3(t,"string");return typeof e=="symbol"?e:String(e)}function $3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wf extends Js{constructor(){super(...arguments),L3(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=zu(this.orderOfIndexes,[e]),gt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=Vv(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=Gv(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=Bv(this.indexedValues,e),this.orderOfIndexes=zu(this.orderOfIndexes,e),this.orderOfIndexes=zv(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class gc extends Xo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Ft(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const gE=new Map([["indexesSequence",{getListWithInsertedItems:Uv,getListWithRemovedItems:zu}],["physicallyIndexed",{getListWithInsertedItems:Vv,getListWithRemovedItems:Bv}]]),Nx=t=>{if(gE.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return gE.get(t)};class Lx extends Js{constructor(){super(e=>e)}insert(e,n){const r=Gv(this.indexedValues,n);this.indexedValues=Uv(r,e,n),super.insert(e,n)}remove(e){const n=zu(this.indexedValues,e);this.indexedValues=zv(n,e),super.remove(e)}}const mE=new Map([["hiding",Ff],["index",Js],["linkedPhysicalIndexToValue",Wf],["physicalIndexToValue",Xo],["trimming",gc]]);function F3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!mE.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(mE.get(t))(e)}function W3(t,e,n){return e=V3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V3(t){var e=B3(t,"string");return typeof e=="symbol"?e:String(e)}function B3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Lw=0;class Yv{constructor(){W3(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),Lw+=1)}unregister(e){const n=this.collection.get(e);le(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),Lw-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return mt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}dt(Yv,Qn);function U3(){return Lw}function um(t,e,n){return e=z3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z3(t){var e=G3(t,"string");return typeof e=="symbol"?e:String(e)}function G3(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pE extends Yv{constructor(e,n){super(),um(this,"mergedValuesCache",[]),um(this,"aggregationFunction",void 0),um(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ve(this.get(),o=>o.getValues()),r=[],i=le(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ve(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return le(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Y3(t,e,n){j3(t,e),e.set(t,n)}function j3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function K3(t,e,n){var r=kx(t,e,"set");return X3(t,r,n),n}function X3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function q3(t,e){var n=kx(t,e,"get");return Z3(t,n)}function kx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Z3(t,e){return e.get?e.get.call(t):e.value}var cm=new WeakMap;class $x{constructor(){Y3(this,cm,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(q3(this,cm)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){K3(this,cm,e)}}dt($x,Qn);function wE(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function xl(t,e,n){Q3(t,e),e.set(t,n)}function Q3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dr(t,e){var n=Fx(t,e,"get");return J3(t,n)}function J3(t,e){return e.get?e.get.call(t):e.value}function Yc(t,e,n){var r=Fx(t,e,"set");return eX(t,r,n),n}function Fx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function eX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var jc=new WeakMap,Hl=new WeakMap,Kc=new WeakMap,Xc=new WeakMap,qc=new WeakMap;class tX{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xl(this,jc,{writable:!0,value:new Set}),xl(this,Hl,{writable:!0,value:[]}),xl(this,Kc,{writable:!0,value:[]}),xl(this,Xc,{writable:!0,value:!1}),xl(this,qc,{writable:!0,value:!1}),Yc(this,qc,e??!1)}createObserver(){const e=new $x;return dr(this,jc).add(e),e.addLocalHook("unsubscribe",()=>{dr(this,jc).delete(e)}),e._writeInitialChanges(wE(dr(this,Hl),dr(this,Kc))),e}emit(e){let n=dr(this,Kc);(!dr(this,Xc)||dr(this,Hl).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(dr(this,qc)):Yc(this,Hl,new Array(e.length).fill(dr(this,qc))),dr(this,Xc)||(Yc(this,Xc,!0),n=dr(this,Hl)));const r=wE(n,e);dr(this,jc).forEach(i=>i._write(r)),Yc(this,Kc,e)}}function An(t,e,n){return e=nX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nX(t){var e=rX(t,"string");return typeof e=="symbol"?e:String(e)}function rX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kw{constructor(){An(this,"indexesSequence",new Lx),An(this,"trimmingMapsCollection",new pE(e=>e.some(n=>n===!0),!1)),An(this,"hidingMapsCollection",new pE(e=>e.some(n=>n===!0),!1)),An(this,"variousMapsCollection",new Yv),An(this,"hidingChangesObservable",new tX({initialIndexValue:!1})),An(this,"notTrimmedIndexesCache",[]),An(this,"notHiddenIndexesCache",[]),An(this,"isBatched",!1),An(this,"indexesSequenceChanged",!1),An(this,"indexesChangeSource",void 0),An(this,"trimmedIndexesChanged",!1),An(this,"hiddenIndexesChanged",!1),An(this,"renderablePhysicalIndexesCache",[]),An(this,"fromPhysicalToVisualIndexesCache",new Map),An(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,F3(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof gc?this.trimmingMapsCollection.register(e,n):n instanceof Ff?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return le(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return le(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return le(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return le(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ve(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=zu(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(Uv(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=le(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ve(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}dt(kw,Qn);function iX(t,e){return Be(e,(n,r)=>{mt(t[r])&&(t[r]=n)}),t}function Wx(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Vx(t){le(t)&&fv(ct`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function oX(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:sX,getValues:aX}=jr("phraseFormatters");function lX(t,e){sX(t,e)}function uX(){return aX()}lX("pluralize",oX);const Bx="ContextMenu:items",Le=Bx,jv=`${Le}.noItems`,Kv=`${Le}.insertRowAbove`,Xv=`${Le}.insertRowBelow`,qv=`${Le}.insertColumnOnTheLeft`,Zv=`${Le}.insertColumnOnTheRight`,Qv=`${Le}.removeRow`,Jv=`${Le}.removeColumn`,eS=`${Le}.undo`,tS=`${Le}.redo`,nS=`${Le}.readOnly`,rS=`${Le}.clearColumn`,iS=`${Le}.copy`,oS=`${Le}.copyWithHeaders`,sS=`${Le}.copyWithGroupHeaders`,aS=`${Le}.copyHeadersOnly`,lS=`${Le}.cut`,uS=`${Le}.freezeColumn`,cS=`${Le}.unfreezeColumn`,hS=`${Le}.mergeCells`,dS=`${Le}.unmergeCells`,fS=`${Le}.addComment`,gS=`${Le}.editComment`,mS=`${Le}.removeComment`,pS=`${Le}.readOnlyComment`,wS=`${Le}.align`,CS=`${Le}.align.left`,vS=`${Le}.align.center`,SS=`${Le}.align.right`,yS=`${Le}.align.justify`,bS=`${Le}.align.top`,RS=`${Le}.align.middle`,ES=`${Le}.align.bottom`,TS=`${Le}.borders`,_S=`${Le}.borders.top`,MS=`${Le}.borders.right`,AS=`${Le}.borders.bottom`,OS=`${Le}.borders.left`,PS=`${Le}.borders.remove`,IS=`${Le}.nestedHeaders.insertChildRow`,xS=`${Le}.nestedHeaders.detachFromParent`,HS=`${Le}.hideColumn`,DS=`${Le}.showColumn`,NS=`${Le}.hideRow`,LS=`${Le}.showRow`,Wn="Filters:",Lt=`${Wn}conditions`,Vf=`${Lt}.none`,kS=`${Lt}.isEmpty`,$S=`${Lt}.isNotEmpty`,FS=`${Lt}.isEqualTo`,WS=`${Lt}.isNotEqualTo`,VS=`${Lt}.beginsWith`,BS=`${Lt}.endsWith`,US=`${Lt}.contains`,zS=`${Lt}.doesNotContain`,cX=`${Lt}.byValue`,GS=`${Lt}.greaterThan`,YS=`${Lt}.greaterThanOrEqualTo`,jS=`${Lt}.lessThan`,KS=`${Lt}.lessThanOrEqualTo`,XS=`${Lt}.isBetween`,qS=`${Lt}.isNotBetween`,ZS=`${Lt}.after`,QS=`${Lt}.before`,JS=`${Lt}.today`,ey=`${Lt}.tomorrow`,ty=`${Lt}.yesterday`,ny=`${Wn}labels.filterByCondition`,ry=`${Wn}labels.filterByValue`,iy=`${Wn}labels.conjunction`,Bf=`${Wn}labels.disjunction`,Wd=`${Wn}values.blankCells`,oy=`${Wn}buttons.selectAll`,sy=`${Wn}buttons.clear`,ay=`${Wn}buttons.ok`,ly=`${Wn}buttons.cancel`,uy=`${Wn}buttons.placeholder.search`,cy=`${Wn}buttons.placeholder.value`,hy=`${Wn}buttons.placeholder.secondValue`,dy="CheckboxRenderer:",fy=`${dy}checked`,gy=`${dy}unchecked`,qo="ColumnHeader:",my=`${qo}description.expandColumn`,py=`${qo}description.collapseColumn`,wy=`${qo}description.sortRows`,Cy=`${qo}label.multiColumnSortOrder`,vy=`${qo}label.openMenu`,Sy=`${qo}label.beforeHiddenColumn`,yy=`${qo}label.afterHiddenColumn`,mc="RowHeader:",by=`${mc}description.expandRow`,Ry=`${mc}description.collapseRow`,Ey=`${mc}label.beforeHiddenRow`,Ty=`${mc}label.afterHiddenRow`,hX=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:fy,CHECKBOX_RENDERER_NAMESPACE:dy,CHECKBOX_UNCHECKED:gy,COLUMN_HEADER_DESCRIPTION_COLLAPSE_COLUMN:py,COLUMN_HEADER_DESCRIPTION_EXPAND_COLUMN:my,COLUMN_HEADER_DESCRIPTION_SORT_ROWS:wy,COLUMN_HEADER_LABEL_AFTER_HIDDEN_COLUMN:yy,COLUMN_HEADER_LABEL_BEFORE_HIDDEN_COLUMN:Sy,COLUMN_HEADER_LABEL_MULTI_COLUMN_SORT_ORDER:Cy,COLUMN_HEADER_LABEL_OPEN_MENU:vy,COLUMN_HEADER_NAMESPACE:qo,CONTEXTMENU_ITEMS_ADD_COMMENT:fS,CONTEXTMENU_ITEMS_ALIGNMENT:wS,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:ES,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:vS,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:yS,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:CS,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:RS,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:SS,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:bS,CONTEXTMENU_ITEMS_BORDERS:TS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:AS,CONTEXTMENU_ITEMS_BORDERS_LEFT:OS,CONTEXTMENU_ITEMS_BORDERS_RIGHT:MS,CONTEXTMENU_ITEMS_BORDERS_TOP:_S,CONTEXTMENU_ITEMS_CLEAR_COLUMN:rS,CONTEXTMENU_ITEMS_COPY:iS,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:aS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:sS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:oS,CONTEXTMENU_ITEMS_CUT:lS,CONTEXTMENU_ITEMS_EDIT_COMMENT:gS,CONTEXTMENU_ITEMS_FREEZE_COLUMN:uS,CONTEXTMENU_ITEMS_HIDE_COLUMN:HS,CONTEXTMENU_ITEMS_HIDE_ROW:NS,CONTEXTMENU_ITEMS_INSERT_LEFT:qv,CONTEXTMENU_ITEMS_INSERT_RIGHT:Zv,CONTEXTMENU_ITEMS_MERGE_CELLS:hS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:xS,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:IS,CONTEXTMENU_ITEMS_NO_ITEMS:jv,CONTEXTMENU_ITEMS_READ_ONLY:nS,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:pS,CONTEXTMENU_ITEMS_REDO:tS,CONTEXTMENU_ITEMS_REMOVE_BORDERS:PS,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Jv,CONTEXTMENU_ITEMS_REMOVE_COMMENT:mS,CONTEXTMENU_ITEMS_REMOVE_ROW:Qv,CONTEXTMENU_ITEMS_ROW_ABOVE:Kv,CONTEXTMENU_ITEMS_ROW_BELOW:Xv,CONTEXTMENU_ITEMS_SHOW_COLUMN:DS,CONTEXTMENU_ITEMS_SHOW_ROW:LS,CONTEXTMENU_ITEMS_UNDO:eS,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:cS,CONTEXTMENU_ITEMS_UNMERGE_CELLS:dS,CONTEXT_MENU_ITEMS_NAMESPACE:Bx,FILTERS_BUTTONS_CANCEL:ly,FILTERS_BUTTONS_CLEAR:sy,FILTERS_BUTTONS_OK:ay,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:uy,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:hy,FILTERS_BUTTONS_PLACEHOLDER_VALUE:cy,FILTERS_BUTTONS_SELECT_ALL:oy,FILTERS_CONDITIONS_AFTER:ZS,FILTERS_CONDITIONS_BEFORE:QS,FILTERS_CONDITIONS_BEGINS_WITH:VS,FILTERS_CONDITIONS_BETWEEN:XS,FILTERS_CONDITIONS_BY_VALUE:cX,FILTERS_CONDITIONS_CONTAINS:US,FILTERS_CONDITIONS_EMPTY:kS,FILTERS_CONDITIONS_ENDS_WITH:BS,FILTERS_CONDITIONS_EQUAL:FS,FILTERS_CONDITIONS_GREATER_THAN:GS,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:YS,FILTERS_CONDITIONS_LESS_THAN:jS,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:KS,FILTERS_CONDITIONS_NAMESPACE:Lt,FILTERS_CONDITIONS_NONE:Vf,FILTERS_CONDITIONS_NOT_BETWEEN:qS,FILTERS_CONDITIONS_NOT_CONTAIN:zS,FILTERS_CONDITIONS_NOT_EMPTY:$S,FILTERS_CONDITIONS_NOT_EQUAL:WS,FILTERS_CONDITIONS_TODAY:JS,FILTERS_CONDITIONS_TOMORROW:ey,FILTERS_CONDITIONS_YESTERDAY:ty,FILTERS_DIVS_FILTER_BY_CONDITION:ny,FILTERS_DIVS_FILTER_BY_VALUE:ry,FILTERS_LABELS_CONJUNCTION:iy,FILTERS_LABELS_DISJUNCTION:Bf,FILTERS_NAMESPACE:Wn,FILTERS_VALUES_BLANK_CELLS:Wd,ROW_HEADER_DESCRIPTION_COLLAPSE_ROW:Ry,ROW_HEADER_DESCRIPTION_EXPAND_ROW:by,ROW_HEADER_LABEL_AFTER_HIDDEN_ROW:Ty,ROW_HEADER_LABEL_BEFORE_HIDDEN_ROW:Ey,ROW_HEADER_NAMESPACE:mc},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const dX={languageCode:"en-US",[jv]:"No available options",[Kv]:"Insert row above",[Xv]:"Insert row below",[qv]:"Insert column left",[Zv]:"Insert column right",[Qv]:["Remove row","Remove rows"],[Jv]:["Remove column","Remove columns"],[eS]:"Undo",[tS]:"Redo",[nS]:"Read only",[rS]:"Clear column",[wS]:"Alignment",[CS]:"Left",[vS]:"Center",[SS]:"Right",[yS]:"Justify",[bS]:"Top",[RS]:"Middle",[ES]:"Bottom",[uS]:"Freeze column",[cS]:"Unfreeze column",[TS]:"Borders",[_S]:"Top",[MS]:"Right",[AS]:"Bottom",[OS]:"Left",[PS]:"Remove border(s)",[fS]:"Add comment",[gS]:"Edit comment",[mS]:"Delete comment",[pS]:"Read-only comment",[hS]:"Merge cells",[dS]:"Unmerge cells",[iS]:"Copy",[oS]:["Copy with header","Copy with headers"],[sS]:["Copy with group header","Copy with group headers"],[aS]:["Copy header only","Copy headers only"],[lS]:"Cut",[IS]:"Insert child row",[xS]:"Detach from parent",[HS]:["Hide column","Hide columns"],[DS]:["Show column","Show columns"],[NS]:["Hide row","Hide rows"],[LS]:["Show row","Show rows"],[Vf]:"None",[kS]:"Is empty",[$S]:"Is not empty",[FS]:"Is equal to",[WS]:"Is not equal to",[VS]:"Begins with",[BS]:"Ends with",[US]:"Contains",[zS]:"Does not contain",[GS]:"Greater than",[YS]:"Greater than or equal to",[jS]:"Less than",[KS]:"Less than or equal to",[XS]:"Is between",[qS]:"Is not between",[ZS]:"After",[QS]:"Before",[JS]:"Today",[ey]:"Tomorrow",[ty]:"Yesterday",[Wd]:"Blank cells",[ny]:"Filter by condition",[ry]:"Filter by value",[iy]:"And",[Bf]:"Or",[oy]:"Select all",[sy]:"Clear",[ay]:"OK",[ly]:"Cancel",[uy]:"Search",[cy]:"Value",[hy]:"Second value",[fy]:"Checked",[gy]:"Unchecked",[my]:"Press ENTER to expand column.",[py]:"Press ENTER to collapse column.",[wy]:"Press ENTER to change sorting.",[Cy]:"Multi-column sorting order:",[vy]:"Press CTRL/CMD+ENTER to open menu.",[Sy]:"The next column is hidden.",[yy]:"The previous column is hidden.",[by]:"Press ENTER to expand row.",[Ry]:"Press ENTER to collapse row.",[Ey]:"The next row is hidden.",[Ty]:"The previous row is hidden."},Ux=dX,fX=hX,$w=Ux.languageCode,{register:gX,getItem:zx,hasItem:mX,getValues:pX}=jr("languagesDictionaries");Gx(Ux);function Gx(t,e){let n=t,r=e;return $e(t)&&(r=t,n=r.languageCode),wX(n,r),gX(n,bn(r)),bn(r)}function wX(t,e){t!==$w&&iX(e,zx($w))}function Yx(t){return _y(t)?bn(zx(t)):null}function _y(t){return mX(t)}function CX(){return pX()}function jx(t,e,n){const r=Yx(t);if(r===null)return null;const i=r[e];if(mt(i))return null;const o=vX(i,n);return Array.isArray(o)?o[0]:o}function vX(t,e){let n=t;return T(uX(),r=>{n=r(t,e)}),n}function SX(t){let e=Wx(t);return _y(e)||(e=$w,Vx(t)),e}function yX(t,e,n){return e=bX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bX(t){var e=RX(t,"string");return typeof e=="symbol"?e:String(e)}function RX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EX extends OK{constructor(e,n){super(e,null),yX(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const uo=EX;function hm(t){let{activeHeaderClassName:e,...n}=t;return new uo({className:e,...n,selectionType:Rx})}function TX(t){let{areaCornerVisible:e,...n}=t;return new uo({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:Iv})}function _X(t){let{...e}=t;return new uo({className:"highlight",...e,selectionType:Iv})}function MX(t){let{columnClassName:e,...n}=t;return new uo({className:e,...n,selectionType:xK})}function AX(t){let{cellCornerVisible:e,...n}=t;return new uo({className:"current",border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:xv})}function OX(t){let{border:e,visualCellRange:n,...r}=t;return new uo({...e,...r,selectionType:HK},n)}function PX(t){let{...e}=t;return new uo({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:PK})}function CE(t){let{headerClassName:e,...n}=t;return new uo({className:e,...n,selectionType:Pv})}function IX(t){let{rowClassName:e,...n}=t;return new uo({className:e,...n,selectionType:IK})}let Kx;function xX(t,e){HX(t,e),e.add(t)}function HX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e,n){return e=DX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DX(t){var e=NX(t,"string");return typeof e=="symbol"?e:String(e)}function NX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ai(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Jr=new WeakSet;Kx=Symbol.iterator;class LX{constructor(e){xX(this,Jr),Bn(this,"options",void 0),Bn(this,"layerLevel",0),Bn(this,"focus",void 0),Bn(this,"fill",void 0),Bn(this,"layeredAreas",new Map),Bn(this,"areas",new Map),Bn(this,"rowHeaders",new Map),Bn(this,"columnHeaders",new Map),Bn(this,"activeRowHeaders",new Map),Bn(this,"activeColumnHeaders",new Map),Bn(this,"activeCornerHeaders",new Map),Bn(this,"rowHighlights",new Map),Bn(this,"columnHighlights",new Map),Bn(this,"customSelections",[]),this.options=e,this.focus=AX(e),this.fill=PX(e)}isEnabledFor(e,n){let r=e;e===xv&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Ai(this,Jr,Oi).call(this,this.layeredAreas,TX)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Ai(this,Jr,Oi).call(this,this.areas,_X)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Ai(this,Jr,Oi).call(this,this.rowHeaders,CE)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Ai(this,Jr,Oi).call(this,this.columnHeaders,CE)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Ai(this,Jr,Oi).call(this,this.activeRowHeaders,hm)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Ai(this,Jr,Oi).call(this,this.activeColumnHeaders,hm)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Ai(this,Jr,Oi).call(this,this.activeCornerHeaders,hm)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Ai(this,Jr,Oi).call(this,this.rowHighlights,IX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Ai(this,Jr,Oi).call(this,this.columnHighlights,MX)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(OX({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),T(this.areas.values(),e=>void e.clear()),T(this.layeredAreas.values(),e=>void e.clear()),T(this.rowHeaders.values(),e=>void e.clear()),T(this.columnHeaders.values(),e=>void e.clear()),T(this.activeRowHeaders.values(),e=>void e.clear()),T(this.activeColumnHeaders.values(),e=>void e.clear()),T(this.activeCornerHeaders.values(),e=>void e.clear()),T(this.rowHighlights.values(),e=>void e.clear()),T(this.columnHighlights.values(),e=>void e.clear())}[Kx](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Oi(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const kX=LX;let Xx;function vE(t,e,n){return e=$X(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $X(t){var e=FX(t,"string");return typeof e=="symbol"?e:String(e)}function FX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Xx=Symbol.iterator;class WX{constructor(e){vE(this,"ranges",[]),vE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Xx](){return this.ranges[Symbol.iterator]()}}const VX=WX;function Dl(t,e){qx(t,e),e.add(t)}function dm(t,e,n){qx(t,e),e.set(t,n)}function qx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ze(t,e){var n=Zx(t,e,"get");return BX(t,n)}function BX(t,e){return e.get?e.get.call(t):e.value}function Gn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Fw(t,e,n){var r=Zx(t,e,"set");return UX(t,r,n),n}function Zx(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function UX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Zc=new WeakMap,rt=new WeakMap,Go=new WeakMap,fm=new WeakSet,gm=new WeakSet,Ww=new WeakSet,mm=new WeakSet,is=new WeakSet;class Qx{constructor(e,n){Dl(this,is),Dl(this,mm),Dl(this,Ww),Dl(this,gm),Dl(this,fm),dm(this,Zc,{writable:!0,value:void 0}),dm(this,rt,{writable:!0,value:void 0}),dm(this,Go,{writable:!0,value:{x:0,y:0}}),Fw(this,Zc,e),Fw(this,rt,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Gn(this,fm,SE).call(this,{x:Ze(this,rt).navigableHeaders()?Ze(this,rt).countRowHeaders():0,y:Ze(this,rt).navigableHeaders()?Ze(this,rt).countColHeaders():0});const i=Ze(this,rt).createCellCoords(e,n);let o=Ze(this,Zc).current().highlight;const s=Ze(this,rt).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Gn(this,Ww,Jx).call(this),{row:h,col:f}=Gn(this,mm,bE).call(this,o),g=Ze(this,rt).fixedRowsBottom(),w=Ze(this,rt).minSpareRows(),C=Ze(this,rt).minSpareCols(),S=Ze(this,rt).autoWrapRow(),b=Ze(this,rt).autoWrapCol(),_=Ze(this,rt).createCellCoords(h+i.row,f+i.col);if(_.row>=c){const I=r&&w>0&&g===0,$=!I&&b,z=_.col+1,q=Ze(this,rt).createCellCoords(_.row-c,z>=u?z-u:z);this.runLocalHooks("beforeColumnWrap",$,Gn(this,is,fa).call(this,q),z>=u),I?this.runLocalHooks("insertRowRequire",Ze(this,rt).countRenderableRows()):$&&_.assign(q)}else if(_.row<0){const I=_.col-1,$=Ze(this,rt).createCellCoords(c+_.row,I<0?u+I:I);this.runLocalHooks("beforeColumnWrap",b,Gn(this,is,fa).call(this,$),I<0),b&&_.assign($)}if(_.col>=u){const I=r&&C>0,$=!I&&S,z=_.row+1,q=Ze(this,rt).createCellCoords(z>=c?z-c:z,_.col-u);this.runLocalHooks("beforeRowWrap",$,Gn(this,is,fa).call(this,q),z>=c),I?this.runLocalHooks("insertColRequire",Ze(this,rt).countRenderableColumns()):$&&_.assign(q)}else if(_.col<0){const I=_.row-1,$=Ze(this,rt).createCellCoords(I<0?c+I:I,u+_.col);this.runLocalHooks("beforeRowWrap",S,Gn(this,is,fa).call(this,$),I<0),S&&_.assign($)}const{rowDir:O,colDir:x}=Gn(this,gm,yE).call(this,_);a=O,l=x,o=Gn(this,is,fa).call(this,_)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Gn(this,fm,SE).call(this,{x:Ze(this,rt).navigableHeaders()?Ze(this,rt).countRowHeaders():0,y:Ze(this,rt).navigableHeaders()?Ze(this,rt).countColHeaders():0});const r=Ze(this,rt).createCellCoords(e,n),i=Ze(this,Zc).current(),o=Ze(this,rt).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Gn(this,mm,bE).call(this,i.to),h=Ze(this,rt).createCellCoords(u+r.row,c+r.col),{rowDir:f,colDir:g}=Gn(this,gm,yE).call(this,h);a=f,l=g;const w=Gn(this,is,fa).call(this,h);r.row===0&&r.col!==0?s.col=w.col:r.row!==0&&r.col===0?s.row=w.row:(s.row=w.row,s.col=w.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function SE(t){let{x:e,y:n}=t;Fw(this,Go,{x:e,y:n})}function yE(t){const{width:e,height:n}=Gn(this,Ww,Jx).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function Jx(){return{width:Ze(this,Go).x+Ze(this,rt).countRenderableColumns(),height:Ze(this,Go).y+Ze(this,rt).countRenderableRows()}}function bE(t){const{row:e,col:n}=Ze(this,rt).visualToRenderableCoords(t);return Ze(this,rt).createCellCoords(Ze(this,Go).y+e,Ze(this,Go).x+n)}function fa(t){const e=t.clone();return e.col=t.col-Ze(this,Go).x,e.row=t.row-Ze(this,Go).y,Ze(this,rt).renderableToVisualCoords(e)}dt(Qx,Qn);const zX=Qx,Uf=0,zf=1,e1=2,My=3,GX=[My,e1],YX=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],pm=Symbol("root"),RE=Symbol("child");function sl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:pm;if(e!==pm&&e!==RE)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===pm;let i=Uf;if(n){const o=t[0];t.length===0?i=zf:r&&o instanceof bv?i=My:r&&Array.isArray(o)?i=sl(o,RE):t.length>=2&&t.length<=4&&!t.some((a,l)=>!YX[l].includes(typeof a))&&(i=e1)}return i}function Gu(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!GX.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===My;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),mt(u)&&(u=a),mt(c)&&(c=l),!r){const g=a,w=l,C=u,S=c;a=Math.min(g,C),l=Math.min(w,S),u=Math.max(g,C),c=Math.max(w,S)}const h=e(a,l),f=e(u,c);return n(h,h,f)}}function jX(t){const e=sl(t.getSelected());if(e===Uf||e===zf)return[];const n=Gu(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;T(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Ft(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function KX(t){const e=sl(t.getSelected());if(e===Uf||e===zf)return[];const n=Gu(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;T(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;T(Array.from(new Array(c),(h,f)=>u+f),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Ft(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function XX(t,e,n){qX(t,e),e.set(t,n)}function qX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mo(t,e,n){return e=ZX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZX(t){var e=QX(t,"string");return typeof e=="symbol"?e:String(e)}function QX(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function EE(t,e,n){var r=t1(t,e,"set");return JX(t,r,n),n}function JX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function TE(t,e){var n=t1(t,e,"get");return eq(t,n)}function t1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function eq(t,e){return e.get?e.get.call(t):e.value}var Nl=new WeakMap;class n1{constructor(e,n){var r=this;mo(this,"settings",void 0),mo(this,"tableProps",void 0),mo(this,"inProgress",!1),mo(this,"selectedRange",new VX((i,o,s)=>this.tableProps.createCellRange(i,o,s))),mo(this,"highlight",void 0),mo(this,"transformation",void 0),mo(this,"selectedByRowHeader",new Set),mo(this,"selectedByColumnHeader",new Set),XX(this,Nl,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new kX({headerClassName:e.currentHeaderClassName,headerAttributes:[Sw()],activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Sw()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new zX(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=mt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&mt(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(xv,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(T(this.highlight.getAreas(),_=>void _.clear()),T(this.highlight.getLayeredAreas(),_=>void _.clear()),T(this.highlight.getRowHeaders(),_=>void _.clear()),T(this.highlight.getColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveRowHeaders(),_=>void _.clear()),T(this.highlight.getActiveColumnHeaders(),_=>void _.clear()),T(this.highlight.getActiveCornerHeaders(),_=>void _.clear()),T(this.highlight.getRowHighlights(),_=>void _.clear()),T(this.highlight.getColumnHighlights(),_=>void _.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),f=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),w=this.highlight.createActiveColumnHeader(),C=this.highlight.createActiveCornerHeader(),S=this.highlight.createRowHighlight(),b=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),f.clear(),g.clear(),w.clear(),C.clear(),S.clear(),b.clear(),this.highlight.isEnabledFor(Iv,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const _=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(_.from).commit().syncWith(_),this.highlight.createLayeredArea().add(_.from).commit().syncWith(_),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(Pv,s.highlight)){if(!s.isSingleHeader()){const x=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),I=this.tableProps.createCellCoords(s.to.row,-1),$=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),z=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(x).commit(),f.add($).commit(),S.add(x).commit(),b.add($).commit()):(h.add(x).add(I).commit(),f.add($).add(z).commit(),S.add(x).add(I).commit(),b.add($).add(z).commit())}const _=!TE(this,Nl)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),O=!TE(this,Nl)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());_&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),O&&w.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),_&&O&&C.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=Us(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:f,disableHeadersHighlight:g}=i;EE(this,Nl,g),f&&Number.isInteger(f==null?void 0:f.row)&&Number.isInteger(f==null?void 0:f.col)&&(h=this.tableProps.createCellCoords(qn(f.row,u,o-1),qn(f.col,c,s-1)));const w=this.tableProps.createCellCoords(u,c),C=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(w,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.finish(),EE(this,Nl,!1)}selectCells(e){var n=this;const r=sl(e);if(r===zf)return!1;if(r===Uf)throw new Error(ct`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Gu(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),T(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),f=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(f){const g=l===0?0:qn(r,u,-1),w=s-1,C=this.tableProps.createCellCoords(g,i),S=this.tableProps.createCellCoords(w,o),b=this.tableProps.createCellCoords(qn(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",C,S,b),C.row=g,S.row=w,this.setRangeStartOnly(C,void 0,b),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectColumns",C,S,b),this.finish()}return f}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:qn(r,a,-1),f=o-1,g=this.tableProps.createCellCoords(e,h),w=this.tableProps.createCellCoords(n,f),C=this.tableProps.createCellCoords(e,qn(r,a,o-1));this.runLocalHooks("beforeSelectRows",g,w,C),g.col=h,w.col=f,this.setRangeStartOnly(g,void 0,C),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectRows",g,w,C),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),f=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),f.commit(),g.commit()}this.highlight.useLayerLevel(r)}}dt(n1,Qn);const tq=n1,_E=/^(\r\n|\n\r|\r|\n)/,nq=/^[^\t\r\n]+/,ME=/^\t/;function rq(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(ME))t=t.replace(ME,""),n+=1,e[r][n]="";else if(t.match(_E))t=t.replace(_E,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(nq);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function bu(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function os(t,e,n){return e=iq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iq(t){var e=oq(t,"string");return typeof e=="symbol"?e:String(e)}function oq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Za{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){os(this,"hot",void 0),os(this,"metaManager",void 0),os(this,"tableMeta",void 0),os(this,"dataSource",void 0),os(this,"duckSchema",void 0),os(this,"colToPropCache",void 0),os(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Hf(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if($e(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Wv(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Be(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&le(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(le(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ol(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,f=[];for(;a<n&&o+a<c;){let w=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?w=bn(this.getSchema()):(w=[],pe(h-1,()=>w.push(null))):this.hot.dataType==="function"?w=this.tableMeta.dataSchema(l+a):(w={},cc(w,this.getSchema())),f.push(w),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,f);const g=this.hot.toVisualRow(s);return this.hot.countSourceRows()===f.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",g,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let f=this.hot.countCols(),g=0,w=c;i==="end"&&(w=Math.min(w+1,a));const C=w;for(;g<n&&f<s;){if(typeof l!="number"||l>=f)if(h>0)for(let b=0;b<h;b+=1)typeof o[b]>"u"&&(o[b]=[]),o[b].push(null);else o.push([null]);else for(let b=0;b<h;b++)o[b].splice(w,0,null);g+=1,w+=1,f+=1}this.hot.columnIndexMapper.insertIndexes(l,g),g>0&&(e==null?this.metaManager.createColumn(null,g):r!=="auto"&&this.metaManager.createColumn(C,n));const S=this.hot.toVisualColumn(C);return this.hot.runHooks("afterCreateCol",S,g,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:g,startPhysicalIndex:C}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=le(this.tableMeta.columns)||le(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,f)=>f-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,f=this.hot.countSourceRows();h<f;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,f=this.hot.countSourceRows();h<f;h++)for(let g=0;g<u;g++)c[h].splice(s[g],1),h===0&&this.metaManager.removeColumn(s[g],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];mw(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return rI(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];mw(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&At(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=Us(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=Us(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&At(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Za.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Za.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),f=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const g=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=f&&g!==null;s++)a.push(c.call(this,o,this.colToProp(s)));g!==null&&i.push(a)}return i}getText(e,n){return bu(this.getRange(e,n,Za.DESTINATION_RENDERER))}getCopyableText(e,n){return bu(this.getRange(e,n,Za.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const sq=Za,{register:aq,getItem:lq,hasItem:r1,getNames:uq,getValues:cle}=jr("cellTypes");function Ay(t){if(!r1(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return lq(t)}function fr(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&jn(t,n),r&&li(t,r),i&&qa(t,i),aq(t,e)}function cq(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!At(e,t)}function Gf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Ay(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Be(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!$e(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Be(r,(o,s)=>{if(cq(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Ut(t,i)}function hq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}ao(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function nd(t){return Number.isInteger(t)&&t>=0}function rd(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Qc(t){return t==null}const i1=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Xt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Xt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),xf(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,disableTabNavigation:!1,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function AE(t,e,n){return e=dq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dq(t){var e=fq(t,"string");return typeof e=="symbol"?e:String(e)}function fq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gq(){return class{}}class mq{constructor(e){AE(this,"metaCtor",gq()),AE(this,"meta",void 0),this.meta=this.metaCtor.prototype,Ut(this.meta,i1()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Ut(this.meta,e),Gf(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function pq(t,e,n){return e=wq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wq(t){var e=Cq(t,"string");return typeof e=="symbol"?e:String(e)}function Cq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vq{constructor(e){pq(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Ut(this.meta,e),Gf(this.meta,e,e)}}let o1;function Jc(t,e,n){return e=Sq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sq(t){var e=yq(t,"string");return typeof e=="symbol"?e:String(e)}function yq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}o1=Symbol.iterator;class Vd{constructor(e){Jc(this,"valueFactory",void 0),Jc(this,"data",[]),Jc(this,"index",[]),Jc(this,"holes",new Set),this.valueFactory=e}obtain(e){rd(()=>nd(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;rd(()=>nd(e)||Qc(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Qc(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;rd(()=>nd(e)||Qc(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Qc(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return sr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[o1](){return this.entries()}}function OE(t,e,n){return e=bq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bq(t){var e=Rq(t,"string");return typeof e=="symbol"?e:String(e)}function Rq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Eq=["data","width"];class Tq{constructor(e){OE(this,"globalMeta",void 0),OE(this,"metas",new Vd(()=>this._createMeta())),this.globalMeta=e,this.metas=new Vd(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);Ut(r,n),Gf(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return hq(this.globalMeta.getMetaConstructor(),Eq).prototype}}function PE(t,e,n){return e=_q(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _q(t){var e=Mq(t,"string");return typeof e=="symbol"?e:String(e)}function Mq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Aq{constructor(e){PE(this,"columnMeta",void 0),PE(this,"metas",new Vd(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);Ut(i,r),Gf(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){rd(()=>nd(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Vd(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class s1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new mq(e),this.tableMeta=new vq(this.globalMeta),this.columnMeta=new Tq(this.globalMeta),this.cellMeta=new Aq(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}dt(s1,Qn);function IE(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=yn(a),f=i.getSettings();Array.isArray(f.dataSchema)?i.dataType="array":gt(f.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const g=new sq(i,t,u);if(e(g),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const w=g.getSchema();t=[];let C,S=0,b=0;for(S=0,b=f.startRows;S<b;S++)if((i.dataType==="object"||i.dataType==="function")&&f.dataSchema)C=bn(w),t.push(C);else if(i.dataType==="array")C=bn(w[0]),t.push(C);else{C=[];for(let _=0,O=f.startCols;_<O;_++)C.push(null);t.push(C)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),f.data=t,g.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=g.colToProp.bind(g),s.propToCol=g.propToCol.bind(g),s.countCachedColumns=g.countCachedColumns.bind(g),n(g),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&ve(i.rootElement,[cI(i.countRows()),hI(i.countCols())])}function xE(t,e,n){return e=Oq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oq(t){var e=Pq(t,"string");return typeof e=="symbol"?e:String(e)}function Pq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iq{constructor(e){xE(this,"metaManager",void 0),xE(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),fe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=At(e,"type")?e.type:null;let c=gt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function wm(t,e,n){return e=xq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xq(t){var e=Hq(t,"string");return typeof e=="symbol"?e:String(e)}function Hq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dq{constructor(e){wm(this,"metaManager",void 0),wm(this,"usageTracker",new Set),wm(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const a1="gridDefault",Oy="editorManager.handlingEditor",Nq={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(t.getShortcutManager().isCtrlPressed()),r.moveSelectionAfterEnter(n.includes("shift"))}},Lq={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},kq={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},$q={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),Rr(e))}};function Fq(){return[Nq,Lq,kq,$q]}const Wq={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},Vq={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},Bq={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},Uq={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},zq={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},Gq={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},Yq={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},jq={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},Kq={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},Xq={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},qq={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},Zq={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},Qq={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},Jq={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function e4(){return[Wq,Vq,Bq,Uq,zq,Gq,Yq,jq,Kq,Xq,qq,Zq,Qq,Jq]}const t4={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},n4={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},r4={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},i4={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col,!0)}},o4={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},s4={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},a4={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},l4={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},u4={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},c4={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},h4={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},d4={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},f4={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},g4={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},m4={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},p4={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function w4(){return[t4,n4,r4,i4,o4,s4,a4,l4,u4,c4,h4,d4,f4,g4,m4,p4]}const C4={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},v4={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},S4={name:"selectAll",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},y4={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},b4=[...Fq(),...e4(),...w4(),C4,v4,S4,y4];function l1(t){const e={};return b4.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function R4(t){const e=t.getShortcutManager().addContext("editor"),n=l1(t),r={group:Oy};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"],["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function E4(t){const e=t.getShortcutManager().addContext("grid"),n=l1(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return le(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:a1};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Oy,runOnlyIf:()=>le(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"],["Control/Meta","Shift","Space"]],callback:()=>n.selectAll()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function T4(t){[R4,E4].forEach(e=>e(t))}function _4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=HE(t),i=HE(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function HE(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&ve(n,[Fr()]),n}function M4(t){let e;const{activate:n,deactivate:r}=_4(t,{onFocusFromTop(){var s;const a=(s=e)!==null&&s!==void 0?s:DE(t);a&&(t.runHooks("modifyFocusOnTabNavigation","from_above",a),t.selectCell(a.row,a.col)),t.listen()},onFocusFromBottom(){var s;const a=(s=e)!==null&&s!==void 0?s:NE(t);a&&(t.runHooks("modifyFocusOnTabNavigation","from_below",a),t.selectCell(a.row,a.col)),t.listen()}}),i={wrapped:!1,flipped:!1};t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",()=>{var s;e=(s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight}),t.addHook("beforeRowWrap",(s,a,l)=>{i.wrapped=!0,i.flipped=l});function o(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}t.getShortcutManager().getContext("grid").addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:s=>{const{disableTabNavigation:a,autoWrapRow:l}=t.getSettings();if(a||!t.selection.isSelected()||l&&i.wrapped&&i.flipped||!l&&i.wrapped)return l&&i.wrapped&&i.flipped&&(e=s.shiftKey?DE(t):NE(t)),o(),!1;s.preventDefault()},runOnlyIf:()=>!t.getSettings().minSpareCols,preventDefault:!1,stopPropagation:!1,position:"after",relativeToGroup:a1,group:"focusCatcher"})}function DE(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function NE(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const LE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),eh=t=>t.map(e=>{const n=e.toLowerCase();return LE.has(n)?LE.get(n):n}).sort().join("+"),A4=t=>t.split("+"),kE=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),Cm=t=>{let{key:e,code:n}=t;return(kE.test(n)?n.replace(kE,"$1"):e).toLowerCase()},u1=Symbol("shortcut-context");function c1(t){return $e(t)&&t.__kindOf===u1}const O4=t=>{const e=Lf({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:f=!1,preventDefault:g=!0,stopPropagation:w=!1,relativeToGroup:C,position:S,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(mt(c))throw new Error("You need to define the shortcut's group.");if(gt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ct`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const _={callback:u,group:c,runOnlyIf:h,captureCtrl:f,preventDefault:g,stopPropagation:w};le(C)&&([_.relativeToGroup,_.position]=[C,S]),c1(b)&&(_.forwardToContext=b),l.forEach(O=>{const x=eh(O);if(e.hasItem(x)){const $=e.getItem(x);let z=$.findIndex(q=>q.group===C);z!==-1?S==="before"?z-=1:z+=1:z=$.length,$.splice(z,0,_)}else e.addItem(x,[_])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Be(u,(h,f)=>{Object.prototype.hasOwnProperty.call(c,f)===!1&&(c[f]=u[f])}),n(c)})},i=l=>{const u=eh(l);e.removeItem(u)};return{__kindOf:u1,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=eh(l),c=e.getItem(u);return le(c)?c.slice():[]},hasShortcut:l=>{const u=eh(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,f]=c;const g=f.filter(w=>w.group!==l);g.length===0?i(A4(h)):(f.length=0,f.push(...g))})}}};function P4(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const I4=["meta","alt","shift","control"],Ll=P4();let th=0;function x4(t,e,n,r,i){const o=g=>I4.includes(g),s=function(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return g.altKey&&C.push("alt"),w&&(g.ctrlKey||g.metaKey)?C.push("control/meta"):(g.ctrlKey&&C.push("control"),g.metaKey&&C.push("meta")),g.shiftKey&&C.push("shift"),C},a=g=>{if(e(g)===!1)return;const w=n(g);if(g.keyCode===229||w===!1||Ao(g))return;const C=Cm(g);let S=[];o(C)||(S=s(g));const b=[C].concat(S);!i(g,b)&&(Bu()&&S.includes("meta")||!Bu()&&S.includes("control"))&&i(g,[C].concat(s(g,!0))),r(g)},l=g=>{const w=Cm(g);o(w)&&Ll.press(w)},u=g=>{const w=Cm(g);o(w)&&Ll.release(w)},c=()=>{Ll.releaseAll()};return{mount:()=>{let g=t;for(th+=1;g;)th===1&&(g.document.documentElement.addEventListener("keydown",l),g.document.documentElement.addEventListener("keyup",u)),g.document.documentElement.addEventListener("keydown",a),g.document.documentElement.addEventListener("blur",c),g=Fu(g)},unmount:()=>{let g=t;for(th-=1;g;)th===0&&(g.document.documentElement.removeEventListener("keydown",l),g.document.documentElement.removeEventListener("keyup",u)),g.document.documentElement.removeEventListener("keydown",a),g.document.documentElement.removeEventListener("blur",c),g=Fu(g)},isPressed:g=>Ll.isPressed(g),releasePressedKeys:()=>Ll.releaseAll()}}const H4=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Lf({errorIdExists:w=>`The "${w}" context name is already registered.`});let s="grid";const a=w=>{const C=O4(w);return o.addItem(w,C),C},l=()=>s,u=w=>o.getItem(w),c=w=>{if(!o.hasItem(w))throw new Error(ct`You've tried to activate the "${w}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=w};let h=!1;const f=function(w,C){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const b=c1(S)?S:u(S);let _=!1;if(!b.hasShortcut(C))return _;const O=b.getShortcuts(C);for(let x=0;x<O.length;x++){const{callback:I,runOnlyIf:$,preventDefault:z,stopPropagation:q,captureCtrl:Y,forwardToContext:K}=O[x];if($(w)===!0){if(h=Y,_=I(w,C)===!1,h=!1,z&&w.preventDefault(),q&&(Rr(w),w.stopPropagation()),_)break;K&&f(w,C,K)}}return _},g=x4(e,n,r,i,f);return g.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(g.isPressed("control")||g.isPressed("meta")),releasePressedKeys:()=>g.releasePressedKeys(),destroy:()=>g.unmount()}};let vm=null;const Sm=new Map;function h1(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new ar(s);let l,u,c,h,f,g=!0;w3(i)&&p3(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const w=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",C=["rtl","ltr"].includes(w)?w:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",C),this.isRtl=function(){return C==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=SX(e.language);const S=new s1(s,e,[Iq,Dq]),b=S.getTableMeta(),_=S.getGlobalMeta(),O=Lf();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),td(this)&&aI(e.licenseKey,t),this.guid=`ht_${qC()}`,Sm.set(this.guid,this),this.columnIndexMapper=new kw,this.rowIndexMapper=new kw,this.columnIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterColumnSequenceChange",d)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",d=>{s.runHooks("afterRowSequenceChange",d)}),u=new H3(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const x=d=>{const{row:m,col:p}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,p>=0?s.columnIndexMapper.getRenderableFromVisualIndex(p):p)},I=d=>{const{row:m,col:p}=d;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,p>=0?s.columnIndexMapper.getVisualFromRenderableIndex(p):p)};let $=new tq(b,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:d=>l.propToCol(d),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(d,m)=>s._createCellCoords(d,m),createCellRange:(d,m,p)=>s._createCellRange(d,m,p),visualToRenderableCoords:x,renderableToVisualCoords:I,isDisabledCellSelection:(d,m)=>d<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(d,m).disableVisualSelection});this.selection=$;const z=d=>{let{hiddenIndexesChanged:m}=d;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",z),this.rowIndexMapper.addLocalHook("cacheUpdated",z),this.selection.addLocalHook("afterSetRangeEnd",d=>{const m=Us(!1),p=this.selection.getSelectedRange(),{from:E,to:M}=p.current(),P=p.size()-1;this.runHooks("afterSelection",E.row,E.col,M.row,M.col,m,P),this.runHooks("afterSelectionByProp",E.row,s.colToProp(E.col),M.row,s.colToProp(M.col),m,P);let G=!0;o&&(G=!1),m.isTouched()&&(G=!m.value);const V=this.selection.selectedRange.current(),Z=this.selection.isSelectedByAnyHeader(),Q=this.selection.isSelectedByRowHeader(),X=this.selection.isSelectedByColumnHeader();if(G!==!1)if(Z)Q?this.scrollViewportTo({row:d.row}):X&&this.scrollViewportTo({col:d.col});else if(V&&!this.selection.isMultiple()){const{row:he,col:Ae}=V.from;he<0&&Ae>=0?this.scrollViewportTo({col:Ae}):Ae<0&&he>=0?this.scrollViewportTo({row:he}):this.scrollViewportTo({row:he,col:Ae})}else this.scrollViewportTo(d.toObject());Q&&X?ee(this.rootElement,["ht__selection--rows","ht__selection--columns"]):Q?(De(this.rootElement,"ht__selection--columns"),ee(this.rootElement,"ht__selection--rows")):X?(De(this.rootElement,"ht__selection--rows"),ee(this.rootElement,"ht__selection--columns")):De(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",d=>{const m=d.length-1,{from:p,to:E}=d[m];this.runHooks("afterSelectionEnd",p.row,p.col,E.row,E.col,m),this.runHooks("afterSelectionEndByProp",p.row,s.colToProp(p.col),E.row,s.colToProp(E.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",d=>{const m=this.runHooks("afterIsMultipleSelection",d.value);d.value&&(d.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),De(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var d=arguments.length,m=new Array(d),p=0;p<d;p++)m[p]=arguments[p];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",d=>this.alter("insert_row_above",d,1,"auto")).addLocalHook("insertColRequire",d=>this.alter("insert_col_start",d,1,"auto")),c={alter(d,m){var p,E;let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,P=arguments.length>3?arguments[3]:void 0,G=arguments.length>4?arguments[4]:void 0;const V=Z=>{if(Z.length===0)return[];const Q=[...Z];return Q.sort((he,Ae)=>{let[_e]=he,[Me]=Ae;return _e===Me?0:_e>Me?1:-1}),Ft(Q,(he,Ae)=>{let[_e,Me]=Ae;const j=he[he.length-1],[Ye,Fe]=j,be=Ye+Fe;if(_e<=be){const xe=Math.max(Me-(be-_e),0);j[1]+=xe}else he.push([_e,Me]);return he},[Q[0]])};switch(d){case"insert_row_below":case"insert_row_above":const Z=s.countSourceRows();if(b.maxRows===Z)return;const Q=d==="insert_row_below"?"below":"above";m=(p=m)!==null&&p!==void 0?p:Q==="below"?Z:0;const{delta:X,startPhysicalIndex:he}=l.createRow(m,M,{source:P,mode:Q});if(X){const Fe=$.selectedRange.current(),be=Fe==null?void 0:Fe.from,xe=be==null?void 0:be.row,ye=s.toVisualRow(he);if($.isSelectedByCorner())$.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(le(xe)&&xe>=ye){const{row:v,col:y}=Fe.to;let A=be.col;$.isSelectedByRowHeader()&&(A=-1),$.getSelectedRange().pop(),$.setRangeStartOnly(s._createCellCoords(xe+X,A),!0),$.setRangeEnd(s._createCellCoords(v+X,y))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Ae=d==="insert_col_end"?"end":"start";m=(E=m)!==null&&E!==void 0?E:Ae==="end"?s.countSourceCols():0;const{delta:_e,startPhysicalIndex:Me}=l.createCol(m,M,{source:P,mode:Ae});if(_e){if(Array.isArray(b.colHeaders)){const v=[s.toVisualColumn(Me),0];v.length+=_e,Array.prototype.splice.apply(b.colHeaders,v)}const Fe=$.selectedRange.current(),be=Fe==null?void 0:Fe.from,xe=be==null?void 0:be.col,ye=s.toVisualColumn(Me);if($.isSelectedByCorner())$.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(le(xe)&&xe>=ye){const{row:v,col:y}=Fe.to;let A=be.row;$.isSelectedByColumnHeader()&&(A=-1),$.getSelectedRange().pop(),$.setRangeStartOnly(s._createCellCoords(A,xe+_e),!0),$.setRangeEnd(s._createCellCoords(v,y+_e))}else s._refreshBorders()}break;case"remove_row":const j=Fe=>{let be=0;T(Fe,xe=>{let[ye,v]=xe;const y=Xt(ye)?s.countRows()-1:Math.max(ye-be,0);if(Number.isInteger(ye)&&(ye=Math.max(ye-be,0)),!l.removeRow(ye,v,P))return;const W=s.countRows(),H=b.fixedRowsTop;H>=y+1&&(b.fixedRowsTop-=Math.min(v,H-y));const F=b.fixedRowsBottom;F&&y>=W-F&&(b.fixedRowsBottom-=Math.min(v,F)),be+=v})};Array.isArray(m)?j(V(m)):j([[m,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const Ye=Fe=>{let be=0;T(Fe,xe=>{let[ye,v]=xe;const y=Xt(ye)?s.countCols()-1:Math.max(ye-be,0);let A=s.toPhysicalColumn(y);if(Number.isInteger(ye)&&(ye=Math.max(ye-be,0)),!l.removeCol(ye,v,P))return;const H=b.fixedColumnsStart;H>=y+1&&(b.fixedColumnsStart-=Math.min(v,H-y)),Array.isArray(b.colHeaders)&&(typeof A>"u"&&(A=-1),b.colHeaders.splice(A,v)),be+=v})};Array.isArray(m)?Ye(V(m)):Ye([[m,M]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${d}"`)}G||c.adjustRowsAndCols()},adjustRowsAndCols(){const d=b.minRows,m=b.minSpareRows,p=b.minCols,E=b.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&$.deselect(),d){const M=s.countRows();M<d&&l.createRow(M,d-M,{source:"auto"})}if(m){const M=s.countEmptyRows(!0);if(M<m){const P=m-M,G=Math.min(P,b.maxRows-s.countSourceRows());l.createRow(s.countRows(),G,{source:"auto"})}}{let M;(p||E)&&(M=s.countEmptyCols(!0));let P=s.countCols();if(p&&!b.columns&&P<p){const G=p-P;M+=G,l.createCol(P,G,{source:"auto"})}if(E&&!b.columns&&s.dataType==="array"&&M<E){P=s.countCols();const G=E-M,V=Math.min(G,b.maxCols-P);l.createCol(P,V,{source:"auto"})}}if($.isSelected()){const M=s.countRows(),P=s.countCols();T($.selectedRange,G=>{let V=!1,Z=G.from.row,Q=G.from.col,X=G.to.row,he=G.to.col;Z>M-1?(Z=M-1,V=!0,X>Z&&(X=Z)):X>M-1&&(X=M-1,V=!0,Z>X&&(Z=X)),Q>P-1?(Q=P-1,V=!0,he>Q&&(he=Q)):he>P-1&&(he=P-1,V=!0,Q>he&&(Q=he)),V&&s.selectCell(Z,Q,X,he)})}s.view&&s.view.adjustElementsSize()},populateFromArray(d,m,p,E,M){let P,G,V,Z;const Q=[],X={},he=[],Ae=d.row,_e=d.col;if(G=m.length,G===0)return!1;let Me=0,j=0;switch($e(p)&&(Me=p.col-_e+1,j=p.row-Ae+1),M){case"shift_down":const Ye=Cu(m),Fe=Ye.length,be=Math.max(Fe,Me),xe=s.getData().slice(Ae),ye=Cu(xe).slice(_e,_e+be);for(V=0;V<be;V+=1)if(V<Fe){for(P=0,G=Ye[V].length;P<j-G;P+=1)Ye[V].push(Ye[V][P%G]);V<ye.length?he.push(Ye[V].concat(ye[V])):he.push(Ye[V].concat(new Array(xe.length).fill(null)))}else he.push(Ye[V%Fe].concat(ye[V]));s.populateFromArray(Ae,_e,Cu(he));break;case"shift_right":const v=m.length,y=Math.max(v,j),A=s.getData().slice(Ae).map(U=>U.slice(_e));for(P=0;P<y;P+=1)if(P<v){for(V=0,Z=m[P].length;V<Me-Z;V+=1)m[P].push(m[P][V%Z]);if(P<A.length)for(let U=0;U<A[P].length;U+=1)m[P].push(A[P][U]);else m[P].push(...new Array(A[0].length).fill(null))}else m.push(m[P%G].slice(0,y).concat(A[P]));s.populateFromArray(Ae,_e,m);break;case"overwrite":default:X.row=d.row,X.col=d.col;let W=0,H=0,F=!0,D;const N=function(se){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ce=m[se%m.length];return de!==null?Ce[de%Ce.length]:Ce},B=m.length,k=p?p.row-d.row+1:0;for(p?G=k:G=Math.max(B,k),P=0;P<G&&!(p&&X.row>p.row&&k>B||!b.allowInsertRow&&X.row>s.countRows()-1||X.row>=b.maxRows);P++){const U=P-W,se=N(U).length,de=p?p.col-d.col+1:0;if(p?Z=de:Z=Math.max(se,de),X.col=d.col,D=s.getCellMeta(X.row,X.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&D.skipRowOnPaste){W+=1,X.row+=1,G+=1;continue}for(H=0,V=0;V<Z&&!(p&&X.col>p.col&&de>se||!b.allowInsertColumn&&X.col>s.countCols()-1||X.col>=b.maxCols);V++){if(D=s.getCellMeta(X.row,X.col),(E==="CopyPaste.paste"||E==="Autofill.fill")&&D.skipColumnOnPaste){H+=1,X.col+=1,Z+=1;continue}if(D.readOnly&&E!=="UndoRedo.undo"){X.col+=1;continue}const Ce=V-H;let Oe=N(U,Ce),ke=s.getDataAtCell(X.row,X.col);if(Oe!==null&&typeof Oe=="object")if(Array.isArray(Oe)&&ke===null&&(ke=[]),ke===null||typeof ke!="object")F=!1;else{const wt=ol(Array.isArray(ke)?ke:ke[0]||ke),Xe=ol(Array.isArray(Oe)?Oe:Oe[0]||Oe);xf(wt,Xe)||Array.isArray(wt)&&Array.isArray(Xe)?Oe=bn(Oe):F=!1}else ke!==null&&typeof ke=="object"&&(F=!1);F&&Q.push([X.row,X.col,Oe]),F=!0,X.col+=1}X.row+=1}s.setDataAtCell(Q,null,null,E||"populateFromArray");break}}};function q(d){const m=Wx(d);_y(m)?(s.runHooks("beforeLanguageChange",m),_.language=m,s.runHooks("afterLanguageChange",m)):Vx(d)}function Y(d,m){const p=d==="className"?s.rootElement:s.table;if(g)ee(p,m);else{let E=[],M=[];_[d]&&(E=Array.isArray(_[d])?_[d]:ww(_[d])),m&&(M=Array.isArray(m)?m:ww(m));const P=pw(E,M),G=pw(M,E);P.length&&De(p,P),G.length&&ee(p,G)}_[d]=m}this.init=function(){u.setData(b.data),s.runHooks("beforeInit"),(Yi()||hv())&&ee(s.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new E3(this),h=DG.getInstance(s,b,$),f=new kG(s),td(this)&&M4(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),g&&s.rootElement.offsetParent===null&&RI(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof g=="object"&&(s.runHooks("afterChange",g[0],g[1]),g=!1),s.runHooks("afterInit")};function K(){let d=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,d=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&d===!1&&(d=!0,this.onQueueEmpty(this.valid))}}}function te(d){const m=d.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):d}function oe(d,m,p){if(!d.length)return;const E=s.getActiveEditor(),M=new K;let P=!0;M.onQueueEmpty=G=>{E&&P&&E.cancelChanges(),p(G)};for(let G=d.length-1;G>=0;G--){const[V,Z,,Q]=d[G],X=l.propToCol(Z),he=s.getCellMeta(V,X);he.type==="numeric"&&typeof Q=="string"&&qI(Q)&&(d[G][3]=te(Q)),s.getCellValidator(he)&&(M.addValidatorToQueue(),s.validateCell(d[G][3],he,function(Ae,_e){return function(Me){if(typeof Me!="boolean")throw new Error("Validation error: result is not boolean");if(Me===!1&&_e.allowInvalid===!1){P=!1,d.splice(Ae,1),_e.valid=!0;const j=s.getCell(_e.visualRow,_e.visualCol);j!==null&&De(j,b.invalidCellClassName)}M.removeValidatorFormQueue()}}(G,he),m))}M.checkIfQueueIsEmpty()}function ie(d,m){let p=d.length-1;if(p<0)return;for(;p>=0;p--){let M=!1;if(d[p]===null){d.splice(p,1);continue}if(!((d[p][2]===null||d[p][2]===void 0)&&(d[p][3]===null||d[p][3]===void 0))){if(b.allowInsertRow)for(;d[p][0]>s.countRows()-1;){const{delta:P}=l.createRow(void 0,void 0,{source:m});if(P===0){M=!0;break}}if(s.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;l.propToCol(d[p][1])>s.countCols()-1;){const{delta:P}=l.createCol(void 0,void 0,{source:m});if(P===0){M=!0;break}}M||l.set(d[p][0],d[p][1],d[p][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",d,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",d,m||"edit");const E=s.getActiveEditor();E&&le(E.refreshValue)&&E.refreshValue()}this._createCellCoords=function(d,m){return s.view._wt.createCellCoords(d,m)},this._createCellRange=function(d,m,p){return s.view._wt.createCellRange(d,m,p)},this.validateCell=function(d,m,p,E){let M=s.getCellValidator(m);function P(G){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){p(G);return}const Z=m.visualCol,Q=m.visualRow,X=s.getCell(Q,Z,!0);if(X&&X.nodeName!=="TH"){const he=s.rowIndexMapper.getRenderableFromVisualIndex(Q),Ae=s.columnIndexMapper.getRenderableFromVisualIndex(Z);s.view._wt.getSetting("cellRenderer",he,Ae,X)}p(G)}sI(M)&&(M=function(G){return function(V,Z){Z(G.test(V))}}(M)),gt(M)?(d=s.runHooks("beforeValidate",d,m.visualRow,m.prop,E),s._registerImmediate(()=>{M.call(m,d,G=>{s&&(G=s.runHooks("afterValidate",G,d,m.visualRow,m.prop,E),m.valid=G,P(G),s.runHooks("postAfterValidate",G,d,m.visualRow,m.prop,E))})})):s._registerImmediate(()=>{m.valid=!0,P(m.valid,!1)})};function ue(d,m,p){return Array.isArray(d)?d:[[d,m,p]]}function Re(d,m){const p=s.getActiveEditor(),E=s.runHooks("beforeChange",d,m||"edit"),M=d.filter(P=>P!==null);return E===!1||M.length===0?(p&&p.cancelChanges(),[]):M}this.setDataAtCell=function(d,m,p,E){const M=ue(d,m,p),P=[];let G=E,V,Z,Q;for(V=0,Z=M.length;V<Z;V++){if(typeof M[V]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof M[V][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");M[V][1]>=this.countCols()?Q=M[V][1]:Q=l.colToProp(M[V][1]),P.push([M[V][0],Q,u.getAtCell(this.toPhysicalRow(M[V][0]),M[V][1]),M[V][2]])}!G&&typeof d=="object"&&(G=m);const X=Re(P,E);s.runHooks("afterSetDataAtCell",X,G),oe(X,G,()=>{ie(X,G)})},this.setDataAtRowProp=function(d,m,p,E){const M=ue(d,m,p),P=[];let G=E,V,Z;for(V=0,Z=M.length;V<Z;V++)P.push([M[V][0],M[V][1],u.getAtCell(this.toPhysicalRow(M[V][0]),M[V][1]),M[V][2]]);!G&&typeof d=="object"&&(G=m);const Q=Re(P,E);s.runHooks("afterSetDataAtRowProp",Q,G),oe(Q,G,()=>{ie(Q,G)})},this.listen=function(){s&&!s.isListening()&&(Sm.forEach(d=>{s!==d&&d.unlisten()}),vm=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(vm=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return vm===s.guid},this.destroyEditor=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(d,m)},this.populateFromArray=function(d,m,p,E,M,P,G){if(!(typeof p=="object"&&typeof p[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const V=typeof E=="number"?s._createCellCoords(E,M):null;return c.populateFromArray(s._createCellCoords(d,m),p,V,P,G)},this.spliceCol=function(d,m,p){for(var E=arguments.length,M=new Array(E>3?E-3:0),P=3;P<E;P++)M[P-3]=arguments[P];return l.spliceCol(d,m,p,...M)},this.spliceRow=function(d,m,p){for(var E=arguments.length,M=new Array(E>3?E-3:0),P=3;P<E;P++)M[P-3]=arguments[P];return l.spliceRow(d,m,p,...M)},this.getSelected=function(){if($.isSelected())return Ve($.getSelectedRange(),d=>{let{from:m,to:p}=d;return[m.row,m.col,p.row,p.col]})},this.getSelectedLast=function(){const d=this.getSelected();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.getSelectedRange=function(){if($.isSelected())return Array.from($.getSelectedRange())},this.getSelectedRangeLast=function(){const d=this.getSelectedRange();let m;return d&&d.length>0&&(m=d[d.length-1]),m},this.emptySelectedCells=function(d){if(!$.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];T($.getSelectedRange(),p=>{if(p.isSingleHeader())return;const E=p.getTopStartCorner(),M=p.getBottomEndCorner();pe(E.row,M.row,P=>{pe(E.col,M.col,G=>{this.getCellMeta(P,G).readOnly||m.push([P,G,null])})})}),m.length>0&&this.setDataAtCell(m,d)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const d=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(d,0),!this.isRenderSuspended()&&d===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(d){this.suspendRender();const m=d();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||d)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const p=d();return this.resumeExecution(m),p},this.batch=function(d){this.suspendRender(),this.suspendExecution();const m=d();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:d,height:m}=s.view.getLastSize(),{width:p,height:E}=s.rootElement.getBoundingClientRect(),M=p!==d||E!==m;s.runHooks("beforeRefreshDimensions",{width:d,height:m},{width:p,height:E},M)!==!1&&((M||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(p,E),s.render()),s.runHooks("afterRefreshDimensions",{width:d,height:m},{width:p,height:E},M))},this.updateData=function(d,m){IE(d,p=>{l=p},p=>{l=p,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:S,firstRun:g})},this.loadData=function(d,m){IE(d,p=>{l=p},()=>{S.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),g&&(g=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:S,firstRun:g})},this.getInitialColumnCount=function(){const d=b.columns;let m=0;if(Array.isArray(d))m=d.length;else if(gt(d))if(s.dataType==="array"){const p=this.countSourceCols();for(let E=0;E<p;E+=1)d(E)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(le(b.dataSchema)){const p=l.getSchema();m=Array.isArray(p)?p.length:Hf(p)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(d,m,p,E){return mt(d)?l.getAll():l.getRange(s._createCellCoords(d,m),s._createCellCoords(p,E),l.DESTINATION_RENDERER)},this.getCopyableText=function(d,m,p,E){return l.getCopyableText(s._createCellCoords(d,m),s._createCellCoords(p,E))},this.getCopyableData=function(d,m){return l.getCopyable(d,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const p=(g?s.loadData:s.updateData).bind(this);let E=!1,M,P;if(le(d.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(le(d.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(le(d.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(M in d)M==="data"||(M==="language"?q(d.language):M==="className"?Y("className",d.className):M==="tableClassName"&&s.table?(Y("tableClassName",d.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):fe.getSingleton().isRegistered(M)||fe.getSingleton().isDeprecated(M)?(gt(d[M])||Array.isArray(d[M]))&&(d[M].initialHook=!0,s.addHook(M,d[M])):!m&&At(d,M)&&(_[M]=d[M]));d.data===void 0&&b.data===void 0?p(null,"updateSettings"):d.data!==void 0?p(d.data,"updateSettings"):d.columns!==void 0&&(l.createMap(),s.initIndexMappers());const G=s.countCols(),V=b.columns;if(V&&gt(V)&&(E=!0),(d.cell!==void 0||d.cells!==void 0||d.columns!==void 0)&&S.clearCache(),G>0)for(M=0,P=0;M<G;M++){if(V){const X=E?V(M):V[P];X&&S.updateColumnMeta(P,X)}P+=1}le(d.cell)&&Be(d.cell,X=>{s.setCellMetaObject(X.row,X.col,X)}),s.runHooks("afterCellMetaReset");let Z=s.rootElement.style.height;Z!==""&&(Z=parseInt(s.rootElement.style.height,10));let Q=d.height;if(gt(Q)&&(Q=Q()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),Q===null){const X=s.rootElement.getAttribute("data-initialstyle");X&&(X.indexOf("height")>-1||X.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",X):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else Q!==void 0&&(s.rootElement.style.height=isNaN(Q)?`${Q}`:`${Q}px`,s.rootElement.style.overflow="hidden");if(typeof d.width<"u"){let X=d.width;gt(X)&&(X=X()),s.rootElement.style.width=isNaN(X)?`${X}`:`${X}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",d)),c.adjustRowsAndCols(),s.view&&!g&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(Z===""||Q===""||Q===void 0)&&Z!==Q&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const d=s.getSelectedLast();if(b.getValue){if(gt(b.getValue))return b.getValue.call(s);if(d)return s.getData()[d[0][0]][b.getValue]}else if(d)return s.getDataAtCell(d[0],d[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(d,m,p,E,M){c.alter(d,m,p,E,M)},this.getCell=function(d,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,E=m,M=d;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;E=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(d>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(d)))return null;M=this.rowIndexMapper.getRenderableFromVisualIndex(d)}return M===null||E===null?null:s.view.getCellAtCoords(s._createCellCoords(M,E),p)},this.getCoords=function(d){const m=this.view._wt.wtTable.getCoords(d);if(m===null)return null;const{row:p,col:E}=m;let M=p,P=E;return p>=0&&(M=this.rowIndexMapper.getVisualFromRenderableIndex(p)),E>=0&&(P=this.columnIndexMapper.getVisualFromRenderableIndex(E)),s._createCellCoords(M,P)},this.colToProp=function(d){return l.colToProp(d)},this.propToCol=function(d){return l.propToCol(d)},this.toVisualRow=d=>this.rowIndexMapper.getVisualFromPhysicalIndex(d),this.toVisualColumn=d=>this.columnIndexMapper.getVisualFromPhysicalIndex(d),this.toPhysicalRow=d=>this.rowIndexMapper.getPhysicalFromVisualIndex(d),this.toPhysicalColumn=d=>this.columnIndexMapper.getPhysicalFromVisualIndex(d),this.getDataAtCell=function(d,m){return l.get(d,l.colToProp(m))},this.getDataAtRowProp=function(d,m){return l.get(d,m)},this.getDataAtCol=function(d){const m=[],p=l.getRange(s._createCellCoords(0,d),s._createCellCoords(b.data.length-1,d),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let M=0;M<p[E].length;M+=1)m.push(p[E][M]);return m},this.getDataAtProp=function(d){const m=[],p=l.getRange(s._createCellCoords(0,l.propToCol(d)),s._createCellCoords(b.data.length-1,l.propToCol(d)),l.DESTINATION_RENDERER);for(let E=0;E<p.length;E+=1)for(let M=0;M<p[E].length;M+=1)m.push(p[E][M]);return m},this.getSourceData=function(d,m,p,E){let M;return d===void 0?M=u.getData():M=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(p,E)),M},this.getSourceDataArray=function(d,m,p,E){let M;return d===void 0?M=u.getData(!0):M=u.getByRange(s._createCellCoords(d,m),s._createCellCoords(p,E),!0),M},this.getSourceDataAtCol=function(d){return u.getAtColumn(d)},this.setSourceDataAtCell=function(d,m,p,E){const M=ue(d,m,p),P=this.hasHook("afterSetSourceDataAtCell"),G=[];P&&T(M,Z=>{let[Q,X,he]=Z;G.push([Q,X,u.getAtCell(Q,X),he])}),T(M,Z=>{let[Q,X,he]=Z;u.setAtCell(Q,X,he)}),P&&this.runHooks("afterSetSourceDataAtCell",G,E),this.render();const V=s.getActiveEditor();V&&le(V.refreshValue)&&V.refreshValue()},this.getSourceDataAtRow=function(d){return u.getAtRow(d)},this.getSourceDataAtCell=function(d,m){return u.getAtCell(d,m)},this.getDataAtRow=function(d){return l.getRange(s._createCellCoords(d,0),s._createCellCoords(d,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(d,m,p,E){const M=d===void 0?[0,0,this.countRows(),this.countCols()]:[d,m,p,E],[P,G]=M;let[,,V,Z]=M,Q=null,X=null;V===void 0&&(V=P),Z===void 0&&(Z=G);let he="mixed";return pe(Math.max(Math.min(P,V),0),Math.max(P,V),Ae=>{let _e=!0;return pe(Math.max(Math.min(G,Z),0),Math.max(G,Z),Me=>(X=this.getCellMeta(Ae,Me).type,Q?_e=Q===X:Q=X,_e)),he=_e?X:"mixed",_e}),he},this.removeCellMeta=function(d,m,p){const[E,M]=[this.toPhysicalRow(d),this.toPhysicalColumn(m)];let P=S.getCellMetaKeyValue(E,M,p);s.runHooks("beforeRemoveCellMeta",d,m,p,P)!==!1&&(S.removeCellMeta(E,M,p),s.runHooks("afterRemoveCellMeta",d,m,p,P)),P=null},this.spliceCellsMeta=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var p=arguments.length,E=new Array(p>2?p-2:0),M=2;M<p;M++)E[M-2]=arguments[M];if(E.length>0&&!Array.isArray(E[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&S.removeRow(this.toPhysicalRow(d),m),E.length>0&&T(E.reverse(),P=>{S.createRow(this.toPhysicalRow(d)),T(P,(G,V)=>this.setCellMetaObject(d,V,G))}),s.render()},this.setCellMetaObject=function(d,m,p){typeof p=="object"&&Be(p,(E,M)=>{this.setCellMeta(d,m,M,E)})},this.setCellMeta=function(d,m,p,E){if(s.runHooks("beforeSetCellMeta",d,m,p,E)===!1)return;let P=d,G=m;d<this.countRows()&&(P=this.toPhysicalRow(d)),m<this.countCols()&&(G=this.toPhysicalColumn(m)),S.setCellMeta(P,G,p,E),s.runHooks("afterSetCellMeta",d,m,p,E)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(d,m){let p=this.toPhysicalRow(d),E=this.toPhysicalColumn(m);return p===null&&(p=d),E===null&&(E=m),S.getCellMeta(p,E,{visualRow:d,visualColumn:m})},this.getCellMetaAtRow=function(d){return S.getCellsMetaAtRow(d)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||b.columns)},this.getCellRenderer=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).renderer:d.renderer;return typeof p=="string"?Nd(p):mt(p)?Nd("text"):p},this.getCellEditor=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).editor:d.editor;return typeof p=="string"?Hd(p):mt(p)?Hd("text"):p},this.getCellValidator=function(d,m){const p=typeof d=="number"?s.getCellMeta(d,m).validator:d.validator;return typeof p=="string"?wv(p):p},this.validateCells=function(d){this._validateCells(d)},this.validateRows=function(d,m){if(!Array.isArray(d))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,d)},this.validateColumns=function(d,m){if(!Array.isArray(d))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,d)},this._validateCells=function(d,m,p){const E=new K;d&&(E.onQueueEmpty=d);let M=s.countRows()-1;for(;M>=0;){if(m!==void 0&&m.indexOf(M)===-1){M-=1;continue}let P=s.countCols()-1;for(;P>=0;){if(p!==void 0&&p.indexOf(P)===-1){P-=1;continue}E.addValidatorToQueue(),s.validateCell(s.getDataAtCell(M,P),s.getCellMeta(M,P),G=>{if(typeof G!="boolean")throw new Error("Validation error: result is not boolean");G===!1&&(E.valid=!1),E.removeValidatorFormQueue()},"validateCells"),P-=1}M-=1}E.checkIfQueueIsEmpty()},this.getRowHeader=function(d){let m=b.rowHeaders,p=d;return p!==void 0&&(p=s.runHooks("modifyRowHeader",p)),p===void 0?(m=[],pe(s.countRows()-1,E=>{m.push(s.getRowHeader(E))})):Array.isArray(m)&&m[p]!==void 0?m=m[p]:gt(m)?m=m(p):m&&typeof m!="string"&&typeof m!="number"&&(m=p+1),m},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let d=0,m=s.countCols();d<m;d++)if(s.getColHeader(d))return!0;return!1},this.getColHeader=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const p=s.runHooks("modifyColHeader",d);if(p===void 0){const V=[],Z=s.countCols();for(let Q=0;Q<Z;Q++)V.push(s.getColHeader(Q));return V}let E=b.colHeaders;const M=function(V){const Z=[],Q=s.countCols();let X=0;for(;X<Q;X++)gt(b.columns)&&b.columns(X)&&Z.push(X);return Z[V]},P=s.toPhysicalColumn(p),G=M(P);return b.colHeaders===!1?E=null:b.columns&&gt(b.columns)&&b.columns(G)&&b.columns(G).title?E=b.columns(G).title:b.columns&&b.columns[P]&&b.columns[P].title?E=b.columns[P].title:Array.isArray(b.colHeaders)&&b.colHeaders[P]!==void 0?E=b.colHeaders[P]:gt(b.colHeaders)?E=b.colHeaders(P):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(E=$f(p)),E=s.runHooks("modifyColumnHeaderValue",E,d,m),E},this._getColWidthFromSettings=function(d){let m;if(d>=0&&(m=s.getCellMeta(0,d).width),(m===void 0||m===b.width)&&(m=b.colWidths),m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(d){let m=s._getColWidthFromSettings(d);return m=s.runHooks("modifyColWidth",m,d),m===void 0&&(m=vv.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(d){let m=b.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[d];break;case"function":m=m(d);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(d){let m=s._getRowHeightFromSettings(d);return m=s.runHooks("modifyRowHeight",m,d),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const d=b.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(d,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Dd(s.countRows()-1,p=>{if(s.isEmptyRow(p))m+=1;else if(d===!0)return!1}),m},this.countEmptyCols=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Dd(s.countCols()-1,p=>{if(s.isEmptyCol(p))m+=1;else if(d===!0)return!1}),m},this.isEmptyRow=function(d){return b.isEmptyRow.call(s,d)},this.isEmptyCol=function(d){return b.isEmptyCol.call(s,d)},this.selectCell=function(d,m,p,E){let M=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,P=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mt(d)||mt(m)?!1:this.selectCells([[d,m,p,E]],M,P)},this.selectCells=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(o=!0);const E=$.selectCells(d);return E&&p&&s.listen(),o=!1,E},this.selectColumns=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;return $.selectColumns(d,m,p)},this.selectRows=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;return $.selectRows(d,m,p)},this.deselectCell=function(){$.deselect()},this.selectAll=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:d,p=arguments.length>2?arguments[2]:void 0;o=!0,$.selectAll(d,m,p),o=!1};const Ue=(d,m)=>d.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(){let{row:d,col:m,verticalSnap:p,horizontalSnap:E,considerHiddenIndexes:M}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},P,G,V,Z;p!==void 0&&(P=p==="top",G=!P),E!==void 0&&(V=E==="start",Z=!V);let Q=d,X=m;if(M===void 0||M){const _e=Number.isInteger(d)&&d>=0,Me=Number.isInteger(m)&&m>=0,j=_e?Ue(this.rowIndexMapper,d):void 0,Ye=Me?Ue(this.columnIndexMapper,m):void 0;if(j===null||Ye===null)return!1;Q=_e?s.rowIndexMapper.getRenderableFromVisualIndex(j):d,X=Me?s.columnIndexMapper.getRenderableFromVisualIndex(Ye):m}const he=Number.isInteger(Q),Ae=Number.isInteger(X);return he&&Q>=0&&Ae&&X>=0?s.view.scrollViewport(s._createCellCoords(Q,X),P,Z,G,V):he&&Q>=0&&(Ae&&X<0||!Ae)?s.view.scrollViewportVertically(Q,P,G):Ae&&X>=0&&(he&&Q<0||!he)?s.view.scrollViewportHorizontally(X,Z,V):!1},this.scrollToFocusedCell=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",d);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",d),this._registerImmediate(()=>d()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),S.clearCache(),Sm.delete(this.guid),td(s)){const d=this.rootDocument.querySelector(".hot-display-license-info");d&&d.parentNode.removeChild(d)}Gr(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),O.getItems().forEach(d=>{let[,m]=d;m.destroy()}),O.clear(),s.runHooks("afterDestroy")},!0),fe.getSingleton().destroy(s),Be(s,(d,m,p)=>{gt(d)?p[m]=Ie(m):m!=="guid"&&(p[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,$=null,h=null,s=null};function Ie(d){return()=>{throw new Error(`The "${d}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(d){const m=yn(d);return m==="UndoRedo"?this.undoRedo:O.getItem(m)},this.getPluginName=function(d){return d===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:O.getId(d)},this.getInstance=function(){return s},this.addHook=function(d,m){fe.getSingleton().add(d,m,s)},this.hasHook=function(d){return fe.getSingleton().has(d,s)||fe.getSingleton().has(d)},this.addHookOnce=function(d,m){fe.getSingleton().once(d,m,s)},this.removeHook=function(d,m){fe.getSingleton().remove(d,m,s)},this.runHooks=function(d,m,p,E,M,P,G){return fe.getSingleton().run(s,d,m,p,E,M,P,G)},this.getTranslatedPhrase=function(d,m){return jx(b.language,d,m)},this.toHTML=()=>Mw(this),this.toTableElement=()=>{const d=this.rootDocument.createElement("div");return d.insertAdjacentHTML("afterbegin",Mw(this)),d.firstElementChild},this.timeouts=[],this._registerTimeout=function(d){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,p=d;typeof p=="function"&&(p=setTimeout(p,m)),this.timeouts.push(p)},this._clearTimeouts=function(){T(this.timeouts,d=>{clearTimeout(d)})},this.immediates=[],this._registerImmediate=function(d){this.immediates.push(setImmediate(d))},this._clearImmediates=function(){T(this.immediates,d=>{clearImmediate(d)})},this._refreshBorders=function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(d),s.view.render(),m&&$.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const R=H4({handleEvent(){return s.isListening()},beforeKeyDown:d=>this.runHooks("beforeKeyDown",d),afterKeyDown:d=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",d)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",d=>{d.ctrlKey===!1&&d.metaKey===!1&&R.releasePressedKeys()}),this.getShortcutManager=function(){return R},this.getFocusManager=function(){return f},pv().forEach(d=>{const m=hc(d);O.addItem(d,new m(this))}),T4(s),R.setActiveContextName("grid"),fe.getSingleton().run(s,"construct")}const D4="hooksRefRegisterer",d1={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){T(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Be(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Si(d1,"MIXIN_NAME",D4,{writable:!1,enumerable:!1});const N4=d1;function Or(t,e,n){return e=L4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L4(t){var e=k4(t,"string");return typeof e=="symbol"?e:String(e)}function k4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $4="base",Kt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Vw="baseEditor";class wl{static get EDITOR_TYPE(){return $4}constructor(e){Or(this,"hot",void 0),Or(this,"state",Kt.VIRGIN),Or(this,"_opened",!1),Or(this,"_fullEditMode",!1),Or(this,"_closeCallback",null),Or(this,"TD",null),Or(this,"row",null),Or(this,"col",null),Or(this,"prop",null),Or(this,"originalValue",null),Or(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=Kt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>le(this.hot.getSelected()),group:Vw};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==Kt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=Kt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Nt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(Vw),s.removeShortcutsByGroup(Nf),this.state===Kt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Kt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=Kt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=Kt.FINISHED,this.discardEditor(l)}):(this.state=Kt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=Kt.FINISHED,this.discardEditor()}discardEditor(e){this.state===Kt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Kt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Kt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Kt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=Bt(n),a=ut(n),l=Bt(this.hot.rootElement),u=ut(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,f=c!==o?c.scrollTop:0,g=h!==o?h.scrollLeft:0,w=o.innerWidth-l.left-u,{wtTable:C}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,S=C.name,b=["master","inline_start"].includes(S)?f:0,_=["master","top","bottom"].includes(S)?g:0,O=s.top===l.top?0:1;let x=s.top-l.top-O-b,I=0;this.hot.isRtl()?I=o.innerWidth-s.left-a-w-1+_:I=s.left-l.left-1-_,["top","top_inline_start_corner"].includes(S)&&(x+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&(I+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const $=this.hot.hasColHeaders(),z=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),K=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");($&&z<=0||z===K)&&(x+=1),q<=0&&(I+=1);const te=i.rowsRenderCalculator.startPosition,oe=i.columnsRenderCalculator.startPosition,ie=Math.abs(r.inlineStartOverlay.getScrollPosition()),ue=r.topOverlay.getScrollPosition(),Re=Jt(this.hot.rootDocument);let Ue=n.offsetTop;if(["inline_start","master"].includes(S)&&(Ue+=te-ue),["bottom","bottom_inline_start_corner"].includes(S)){const{wtViewport:Q,wtTable:X}=r.bottomOverlay.clone;Ue+=Q.getWorkspaceHeight()-X.getHeight()-Re}let Ie=n.offsetLeft;this.hot.isRtl()?(Ie>=0?Ie=C.getWidth()-n.offsetLeft:Ie=Math.abs(Ie),Ie+=oe-ie-a):["top","master","bottom"].includes(S)&&(Ie+=oe-ie);const R=eo(this.TD,this.hot.rootWindow),d=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(R[d],10)>0?0:1,p=parseInt(R.borderTopWidth,10)>0?0:1,E=ut(n)+m,M=Ot(n)+p,P=yI(c)?Re:0,G=bI(h)?Re:0,V=this.hot.view.maximumVisibleElementWidth(Ie)-P+m,Z=Math.max(this.hot.view.maximumVisibleElementHeight(Ue)-G+p,23);return{top:x,start:I,height:M,maxHeight:Z,width:E,maxWidth:V}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}dt(wl,N4);function F4(){var t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},e,n=document.body,r=document.createTextNode(""),i=document.createElement("SPAN"),o=function(f,g,w){f.addEventListener(g,w,!1)},s=function(f,g,w){f.removeEventListener(g,w,!1)},a=function(f){var g,w;f?/^[a-zA-Z \.,\\\/\|0-9]$/.test(f)||(f="."):f="",r.textContent!==void 0?r.textContent=e.value+f:r.data=e.value+f,i.style.position="absolute",i.style.fontSize=h(e).fontSize,i.style.fontFamily=h(e).fontFamily,i.style.whiteSpace="pre",n.appendChild(i),g=i.clientWidth+2,n.removeChild(i),e.style.height=t.minHeight+"px",t.minWidth>g?e.style.width=t.minWidth+"px":g>t.maxWidth?e.style.width=t.maxWidth+"px":e.style.width=g+"px",w=e.scrollHeight?e.scrollHeight-1:0,t.minHeight>w?e.style.height=t.minHeight+"px":t.maxHeight<w?(e.style.height=t.maxHeight+"px",e.style.overflowY="visible"):e.style.height=w+"px"},l=function(){window.setTimeout(a,0)},u=function(f){if(f&&f.minHeight)if(f.minHeight=="inherit")t.minHeight=e.clientHeight;else{var g=parseInt(f.minHeight);isNaN(g)||(t.minHeight=g)}if(f&&f.maxHeight)if(f.maxHeight=="inherit")t.maxHeight=e.clientHeight;else{var w=parseInt(f.maxHeight);isNaN(w)||(t.maxHeight=w)}if(f&&f.minWidth)if(f.minWidth=="inherit")t.minWidth=e.clientWidth;else{var C=parseInt(f.minWidth);isNaN(C)||(t.minWidth=C)}if(f&&f.maxWidth)if(f.maxWidth=="inherit")t.maxWidth=e.clientWidth;else{var S=parseInt(f.maxWidth);isNaN(S)||(t.maxWidth=S)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))},c=function(f,g,w){e=f,u(g),e.nodeName=="TEXTAREA"&&(e.style.resize="none",e.style.overflowY="",e.style.height=t.minHeight+"px",e.style.minWidth=t.minWidth+"px",e.style.maxWidth=t.maxWidth+"px",e.style.overflowY="hidden"),w&&(o(e,"change",a),o(e,"cut",l),o(e,"paste",l),o(e,"drop",l),o(e,"keydown",l),o(e,"focus",a),o(e,"compositionstart",l),o(e,"compositionupdate",l),o(e,"compositionend",l)),a()};function h(f){return f.currentStyle||document.defaultView.getComputedStyle(f)}return{init:function(f,g,w){c(f,g,w)},unObserve:function(){s(e,"change",a),s(e,"cut",l),s(e,"paste",l),s(e,"drop",l),s(e,"keydown",l),s(e,"focus",a),s(e,"compositionstart",l),s(e,"compositionupdate",l),s(e,"compositionend",l)},resize:a}}function $E(t,e){const n=nv(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}ac(e,i)}function ss(t,e,n){return e=W4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W4(t){var e=V4(t,"string");return typeof e=="symbol"?e:String(e)}function V4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const B4="ht_editor_visible",nh="ht_editor_hidden",FE="textEditor",U4="text";class ea extends wl{static get EDITOR_TYPE(){return U4}constructor(e){super(e),ss(this,"eventManager",new ar(this)),ss(this,"autoResize",F4()),ss(this,"TEXTAREA",void 0),ss(this,"textareaStyle",void 0),ss(this,"TEXTAREA_PARENT",void 0),ss(this,"textareaParentStyle",void 0),ss(this,"layerClass",void 0),this.eventManager=new ar(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.addHook("afterDocumentKeyDown",n=>this.onAfterDocumentKeyDown(n)),this.registerShortcuts()}close(){this.autoResize.unObserve(),gI(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts(),this.removeHooksByKey("afterDocumentKeyDown")}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==Kt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===Kt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),ac(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),ve(this.TEXTAREA,[["data-hot-input",""],dl(-1)]),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[so()]),ee(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ee(this.TEXTAREA_PARENT,"handsontableInputHolder"),Pe(this.TEXTAREA_PARENT,this.layerClass)&&De(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,nh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){LI()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",De(this.TEXTAREA_PARENT,this.layerClass),ee(this.TEXTAREA_PARENT,nh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;pe(e.length-1,r=>{const i=e[r];if(Pe(i,"handsontableEditor"))return n=!0,!1}),Pe(this.TEXTAREA_PARENT,nh)&&De(this.TEXTAREA_PARENT,nh),n?(this.layerClass=B4,ee(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ee(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Kt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=eo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=eo(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),f=i-c,g=s-h,w=o-c,C=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(f,w),minHeight:Math.min(g,C),maxWidth:w,maxHeight:C},!0)}bindEvents(){cv()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Kt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Kt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={runOnlyIf:()=>le(this.hot.getSelected()),group:FE},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"]],callback:o=>{const s=this.hot.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(o):s.tabMoves;this.hot.selection.transformStart(a.row,a.col,!0)}},{keys:[["Shift","Tab"]],callback:o=>{const s=this.hot.getSettings(),a=typeof s.tabMoves=="function"?s.tabMoves(o):s.tabMoves;this.hot.selection.transformStart(-a.row,-a.col)}},{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["PageUp"]],callback:()=>{this.hot.selection.transformStart(-this.hot.countVisibleRows(),0)}},{keys:[["PageDown"]],callback:()=>{this.hot.selection.transformStart(this.hot.countVisibleRows(),0)}},{keys:[["Home"]],callback:(o,s)=>{let[a]=s;$E(a,this.TEXTAREA)}},{keys:[["End"]],callback:(o,s)=>{let[a]=s;$E(a,this.TEXTAREA)}},{keys:[["Control/Meta","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}},{keys:[["Control/Meta","Shift","Z"]],preventDefault:!1,callback:()=>{this.hot._registerTimeout(()=>{this.autoResize.resize()},10)}}],r)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Nf),n.removeShortcutsByGroup(FE),n.removeShortcutsByGroup(Vw)}onAfterDocumentKeyDown(e){[ge.ARROW_UP,ge.ARROW_RIGHT,ge.ARROW_DOWN,ge.ARROW_LEFT].indexOf(e.keyCode)===-1&&this.autoResize.resize(String.fromCharCode(e.keyCode))}}const z4="base";function pc(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&ee(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(ER())):a&&c.push(ER()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(TR())):(u.push(s.invalidCellClassName),a&&c.push(TR()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),De(e,u),ee(e,l),Ko(e,c),ve(e,h)}pc.RENDERER_TYPE=z4;const G4="text";function co(t,e,n,r,i,o,s){pc.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Nt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){Gr(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else Bo(e,a)}co.RENDERER_TYPE=G4;const Y4="text",f1={CELL_TYPE:Y4,editor:ea,renderer:co};fr(f1);Se.editors={BaseEditor:wl};function Se(t,e){const n=new h1(t,e||{},$v);return n.init(),n}Se.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new h1(t,e,$v)};Se.DefaultSettings=i1();Se.hooks=fe.getSingleton();Se.CellCoords=kd;Se.CellRange=bv;Se.packageName="handsontable";Se.buildDate="08/11/2023 09:43:05";Se.version="14.0.0-next-b24d538-20231108";Se.languages={dictionaryKeys:fX,getLanguageDictionary:Yx,getLanguagesDictionaries:CX,registerLanguageDictionary:Gx,getTranslatedPhrase:jx};const WE="handsontableEditor",j4="handsontable";class Py extends ea{static get EDITOR_TYPE(){return j4}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),ac(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions(),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("true")])}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("false")])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ut(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:WE,relativeToGroup:Nf,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),Rr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(WE)}}function K4(t,e,n){X4(t,e),e.set(t,n)}function X4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rh(t,e,n){return e=q4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q4(t){var e=Z4(t,"string");return typeof e=="symbol"?e:String(e)}function Z4(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VE(t,e){var n=Q4(t,e,"get");return J4(t,n)}function Q4(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function J4(t,e){return e.get?e.get.call(t):e.value}const e6="autocomplete";var ym=new WeakMap;class Iy extends Py{constructor(){super(...arguments),rh(this,"query",null),rh(this,"strippedChoices",[]),rh(this,"rawChoices",[]),K4(this,ym,{writable:!0,value:this.hot.guid.slice(0,9)}),rh(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=vw(Nt(n[c])),r)h=u.indexOf(e);else{const f=this.cellProperties.locale;h=u.toLocaleLowerCase(f).indexOf(e.toLocaleLowerCase(f))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((f,g)=>{if(g.index===-1)return-1;if(f.index===-1)return 1;if(f.index<g.index)return-1;if(g.index<f.index)return 1;if(f.index===g.index){if(f.charsLeft<g.charsLeft)return-1;if(f.charsLeft>g.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return e6}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return le(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ee(this.htContainer,"autocompleteEditor"),ee(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[Sz(),mz(),fl("listbox"),Tz()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[sn("false"),_z(`${VE(this,ym)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=Jt();a===0&&Bu()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[ut(this.TEXTAREA)-2]:void 0,width:e?ut(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,f,g,w)=>{co(l,u,c,h,f,g,w);const{filteringCaseSensitive:C,allowHtml:S,locale:b}=this.cellProperties,_=this.query;let O=Nt(g),x,I;O&&!S&&(x=C===!0?O.indexOf(_):O.toLocaleLowerCase(b).indexOf(_.toLocaleLowerCase(b)),x!==-1&&(I=O.substr(x,_.length),O=O.replace(I,`<strong>${I}</strong>`))),n&&ve(u,[pz(),...r?[Pz(i)]:[],...r?[Iz(r.indexOf(g)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=O},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);ve(c,[Sw()]),ve(this.TEXTAREA,...Mz(c.id))}}}),n&&(ve(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Fr()),ve(this.htEditor.rootElement,[uI(),Az("polite"),Oz("text"),["id",`${VE(this,ym)}-listbox-${o}-${s}`]]),ve(this.TEXTAREA,...sn("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&ve(this.TEXTAREA,[sn("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=nv(this.TEXTAREA),r=SI(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,f=l.length;h<f&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(Cu([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),ac(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=Vs(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=Bt(this.TEXTAREA),o=Ot(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Ot(this.hot.view._wt.wtTable.THEAD),u=Bt(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,f=s>h&&c>h;return f?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(f?c:h,s),f}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+Jt(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ve(e,o=>Nt(o));return Ve(r,o=>n?o:vw(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===ge.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===ge.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(kI(e.keyCode)||e.keyCode===ge.BACKSPACE||e.keyCode===ge.DELETE||e.keyCode===ge.INSERT){let n=10;if(e.keyCode===ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const t6="checkbox";class g1 extends wl{static get EDITOR_TYPE(){return t6}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Pe(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var m1={exports:{}};const n6=pO(q2);/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */(function(t,e){(function(n,r){var i;{try{i=n6}catch{}t.exports=r(i)}})(Wr,function(n){var r=typeof n=="function",i=!!window.addEventListener,o=window.document,s=window.setTimeout,a=function(R,d,m,p){i?R.addEventListener(d,m,!!p):R.attachEvent("on"+d,m)},l=function(R,d,m,p){i?R.removeEventListener(d,m,!!p):R.detachEvent("on"+d,m)},u=function(R){return R.trim?R.trim():R.replace(/^\s+|\s+$/g,"")},c=function(R,d){return(" "+R.className+" ").indexOf(" "+d+" ")!==-1},h=function(R,d){c(R,d)||(R.className=R.className===""?d:R.className+" "+d)},f=function(R,d){R.className=u((" "+R.className+" ").replace(" "+d+" "," "))},g=function(R){return/Array/.test(Object.prototype.toString.call(R))},w=function(R){return/Date/.test(Object.prototype.toString.call(R))&&!isNaN(R.getTime())},C=function(R){var d=R.getDay();return d===0||d===6},S=function(R){return R%4===0&&R%100!==0||R%400===0},b=function(R,d){return[31,S(R)?29:28,31,30,31,30,31,31,30,31,30,31][d]},_=function(R){w(R)&&R.setHours(0,0,0,0)},O=function(R,d){return R.getTime()===d.getTime()},x=function(R,d,m){var p,E;for(p in d)E=R[p]!==void 0,E&&typeof d[p]=="object"&&d[p]!==null&&d[p].nodeName===void 0?w(d[p])?m&&(R[p]=new Date(d[p].getTime())):g(d[p])?m&&(R[p]=d[p].slice(0)):R[p]=x({},d[p],m):(m||!E)&&(R[p]=d[p]);return R},I=function(R,d,m){var p;o.createEvent?(p=o.createEvent("HTMLEvents"),p.initEvent(d,!0,!1),p=x(p,m),R.dispatchEvent(p)):o.createEventObject&&(p=o.createEventObject(),p=x(p,m),R.fireEvent("on"+d,p))},$=function(R){return R.month<0&&(R.year-=Math.ceil(Math.abs(R.month)/12),R.month+=12),R.month>11&&(R.year+=Math.floor(Math.abs(R.month)/12),R.month-=12),R},z={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},q=function(R,d,m){for(d+=R.firstDay;d>=7;)d-=7;return m?R.i18n.weekdaysShort[d]:R.i18n.weekdays[d]},Y=function(R){var d=[],m="false";if(R.isEmpty)if(R.showDaysInNextAndPreviousMonths)d.push("is-outside-current-month"),R.enableSelectionDaysInNextAndPreviousMonths||d.push("is-selection-disabled");else return'<td class="is-empty"></td>';return R.isDisabled&&d.push("is-disabled"),R.isToday&&d.push("is-today"),R.isSelected&&(d.push("is-selected"),m="true"),R.hasEvent&&d.push("has-event"),R.isInRange&&d.push("is-inrange"),R.isStartRange&&d.push("is-startrange"),R.isEndRange&&d.push("is-endrange"),'<td data-day="'+R.day+'" class="'+d.join(" ")+'" aria-selected="'+m+'"><button class="pika-button pika-day" type="button" data-pika-year="'+R.year+'" data-pika-month="'+R.month+'" data-pika-day="'+R.day+'">'+R.day+"</button></td>"},K=function(R,d){R.setHours(0,0,0,0);var m=R.getDate(),p=R.getDay(),E=d,M=E-1,P=7,G=function(he){return(he+P-1)%P};R.setDate(m+M-G(p));var V=new Date(R.getFullYear(),0,E),Z=24*60*60*1e3,Q=(R.getTime()-V.getTime())/Z,X=1+Math.round((Q-M+G(V.getDay()))/P);return X},te=function(R,d,m,p){var E=new Date(m,d,R),M=r?n(E).isoWeek():K(E,p);return'<td class="pika-week">'+M+"</td>"},oe=function(R,d,m,p){return'<tr class="pika-row'+(m?" pick-whole-week":"")+(p?" is-selected":"")+'">'+(d?R.reverse():R).join("")+"</tr>"},ie=function(R){return"<tbody>"+R.join("")+"</tbody>"},ue=function(R){var d,m=[];for(R.showWeekNumber&&m.push("<th></th>"),d=0;d<7;d++)m.push('<th scope="col"><abbr title="'+q(R,d)+'">'+q(R,d,!0)+"</abbr></th>");return"<thead><tr>"+(R.isRTL?m.reverse():m).join("")+"</tr></thead>"},Re=function(R,d,m,p,E,M){var P,G,V,Z=R._o,Q=m===Z.minYear,X=m===Z.maxYear,he='<div id="'+M+'" class="pika-title" role="heading" aria-live="assertive">',Ae,_e,Me=!0,j=!0;for(V=[],P=0;P<12;P++)V.push('<option value="'+(m===E?P-d:12+P-d)+'"'+(P===p?' selected="selected"':"")+(Q&&P<Z.minMonth||X&&P>Z.maxMonth?' disabled="disabled"':"")+">"+Z.i18n.months[P]+"</option>");for(Ae='<div class="pika-label">'+Z.i18n.months[p]+'<select class="pika-select pika-select-month" tabindex="-1">'+V.join("")+"</select></div>",g(Z.yearRange)?(P=Z.yearRange[0],G=Z.yearRange[1]+1):(P=m-Z.yearRange,G=1+m+Z.yearRange),V=[];P<G&&P<=Z.maxYear;P++)P>=Z.minYear&&V.push('<option value="'+P+'"'+(P===m?' selected="selected"':"")+">"+P+"</option>");return _e='<div class="pika-label">'+m+Z.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+V.join("")+"</select></div>",Z.showMonthAfterYear?he+=_e+Ae:he+=Ae+_e,Q&&(p===0||Z.minMonth>=p)&&(Me=!1),X&&(p===11||Z.maxMonth<=p)&&(j=!1),d===0&&(he+='<button class="pika-prev'+(Me?"":" is-disabled")+'" type="button">'+Z.i18n.previousMonth+"</button>"),d===R._o.numberOfMonths-1&&(he+='<button class="pika-next'+(j?"":" is-disabled")+'" type="button">'+Z.i18n.nextMonth+"</button>"),he+="</div>"},Ue=function(R,d,m){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+m+'">'+ue(R)+ie(d)+"</table>"},Ie=function(R){var d=this,m=d.config(R);d._onMouseDown=function(E){if(d._v){E=E||window.event;var M=E.target||E.srcElement;if(M)if(c(M,"is-disabled")||(c(M,"pika-button")&&!c(M,"is-empty")&&!c(M.parentNode,"is-disabled")?(d.setDate(new Date(M.getAttribute("data-pika-year"),M.getAttribute("data-pika-month"),M.getAttribute("data-pika-day"))),m.bound&&s(function(){d.hide(),m.blurFieldOnSelect&&m.field&&m.field.blur()},100)):c(M,"pika-prev")?d.prevMonth():c(M,"pika-next")&&d.nextMonth()),c(M,"pika-select"))d._c=!0;else if(E.preventDefault)E.preventDefault();else return E.returnValue=!1,!1}},d._onChange=function(E){E=E||window.event;var M=E.target||E.srcElement;M&&(c(M,"pika-select-month")?d.gotoMonth(M.value):c(M,"pika-select-year")&&d.gotoYear(M.value))},d._onKeyChange=function(E){if(E=E||window.event,d.isVisible())switch(E.keyCode){case 13:case 27:m.field&&m.field.blur();break;case 37:d.adjustDate("subtract",1);break;case 38:d.adjustDate("subtract",7);break;case 39:d.adjustDate("add",1);break;case 40:d.adjustDate("add",7);break;case 8:case 46:d.setDate(null);break}},d._parseFieldValue=function(){if(m.parse)return m.parse(m.field.value,m.format);if(r){var E=n(m.field.value,m.format,m.formatStrict);return E&&E.isValid()?E.toDate():null}else return new Date(Date.parse(m.field.value))},d._onInputChange=function(E){var M;E.firedBy!==d&&(M=d._parseFieldValue(),w(M)&&d.setDate(M),d._v||d.show())},d._onInputFocus=function(){d.show()},d._onInputClick=function(){d.show()},d._onInputBlur=function(){var E=o.activeElement;do if(c(E,"pika-single"))return;while(E=E.parentNode);d._c||(d._b=s(function(){d.hide()},50)),d._c=!1},d._onClick=function(E){E=E||window.event;var M=E.target||E.srcElement,P=M;if(M){!i&&c(M,"pika-select")&&(M.onchange||(M.setAttribute("onchange","return;"),a(M,"change",d._onChange)));do if(c(P,"pika-single")||P===m.trigger)return;while(P=P.parentNode);d._v&&M!==m.trigger&&P!==m.trigger&&d.hide()}},d.el=o.createElement("div"),d.el.className="pika-single"+(m.isRTL?" is-rtl":"")+(m.theme?" "+m.theme:""),a(d.el,"mousedown",d._onMouseDown,!0),a(d.el,"touchend",d._onMouseDown,!0),a(d.el,"change",d._onChange),m.keyboardInput&&a(o,"keydown",d._onKeyChange),m.field&&(m.container?m.container.appendChild(d.el):m.bound?o.body.appendChild(d.el):m.field.parentNode.insertBefore(d.el,m.field.nextSibling),a(m.field,"change",d._onInputChange),m.defaultDate||(m.defaultDate=d._parseFieldValue(),m.setDefaultDate=!0));var p=m.defaultDate;w(p)?m.setDefaultDate?d.setDate(p,!0):d.gotoDate(p):d.gotoDate(new Date),m.bound?(this.hide(),d.el.className+=" is-bound",a(m.trigger,"click",d._onInputClick),a(m.trigger,"focus",d._onInputFocus),a(m.trigger,"blur",d._onInputBlur)):this.show()};return Ie.prototype={config:function(R){this._o||(this._o=x({},z,!0));var d=x(this._o,R,!0);d.isRTL=!!d.isRTL,d.field=d.field&&d.field.nodeName?d.field:null,d.theme=typeof d.theme=="string"&&d.theme?d.theme:null,d.bound=!!(d.bound!==void 0?d.field&&d.bound:d.field),d.trigger=d.trigger&&d.trigger.nodeName?d.trigger:d.field,d.disableWeekends=!!d.disableWeekends,d.disableDayFn=typeof d.disableDayFn=="function"?d.disableDayFn:null;var m=parseInt(d.numberOfMonths,10)||1;if(d.numberOfMonths=m>4?4:m,w(d.minDate)||(d.minDate=!1),w(d.maxDate)||(d.maxDate=!1),d.minDate&&d.maxDate&&d.maxDate<d.minDate&&(d.maxDate=d.minDate=!1),d.minDate&&this.setMinDate(d.minDate),d.maxDate&&this.setMaxDate(d.maxDate),g(d.yearRange)){var p=new Date().getFullYear()-10;d.yearRange[0]=parseInt(d.yearRange[0],10)||p,d.yearRange[1]=parseInt(d.yearRange[1],10)||p}else d.yearRange=Math.abs(parseInt(d.yearRange,10))||z.yearRange,d.yearRange>100&&(d.yearRange=100);return d},toString:function(R){return R=R||this._o.format,w(this._d)?this._o.toString?this._o.toString(this._d,R):r?n(this._d).format(R):this._d.toDateString():""},getMoment:function(){return r?n(this._d):null},setMoment:function(R,d){r&&n.isMoment(R)&&this.setDate(R.toDate(),d)},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(R,d){if(!R)return this._d=null,this._o.field&&(this._o.field.value="",I(this._o.field,"change",{firedBy:this})),this.draw();if(typeof R=="string"&&(R=new Date(Date.parse(R))),!!w(R)){var m=this._o.minDate,p=this._o.maxDate;w(m)&&R<m?R=m:w(p)&&R>p&&(R=p),this._d=new Date(R.getTime()),_(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),I(this._o.field,"change",{firedBy:this})),!d&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(R){var d=!0;if(w(R)){if(this.calendars){var m=new Date(this.calendars[0].year,this.calendars[0].month,1),p=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),E=R.getTime();p.setMonth(p.getMonth()+1),p.setDate(p.getDate()-1),d=E<m.getTime()||p.getTime()<E}d&&(this.calendars=[{month:R.getMonth(),year:R.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(R,d){var m=this.getDate()||new Date,p=parseInt(d)*24*60*60*1e3,E;R==="add"?E=new Date(m.valueOf()+p):R==="subtract"&&(E=new Date(m.valueOf()-p)),this.setDate(E)},adjustCalendars:function(){this.calendars[0]=$(this.calendars[0]);for(var R=1;R<this._o.numberOfMonths;R++)this.calendars[R]=$({month:this.calendars[0].month+R,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(R){isNaN(R)||(this.calendars[0].month=parseInt(R,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(R){isNaN(R)||(this.calendars[0].year=parseInt(R,10),this.adjustCalendars())},setMinDate:function(R){R instanceof Date?(_(R),this._o.minDate=R,this._o.minYear=R.getFullYear(),this._o.minMonth=R.getMonth()):(this._o.minDate=z.minDate,this._o.minYear=z.minYear,this._o.minMonth=z.minMonth,this._o.startRange=z.startRange),this.draw()},setMaxDate:function(R){R instanceof Date?(_(R),this._o.maxDate=R,this._o.maxYear=R.getFullYear(),this._o.maxMonth=R.getMonth()):(this._o.maxDate=z.maxDate,this._o.maxYear=z.maxYear,this._o.maxMonth=z.maxMonth,this._o.endRange=z.endRange),this.draw()},setStartRange:function(R){this._o.startRange=R},setEndRange:function(R){this._o.endRange=R},draw:function(R){if(!(!this._v&&!R)){var d=this._o,m=d.minYear,p=d.maxYear,E=d.minMonth,M=d.maxMonth,P="",G;this._y<=m&&(this._y=m,!isNaN(E)&&this._m<E&&(this._m=E)),this._y>=p&&(this._y=p,!isNaN(M)&&this._m>M&&(this._m=M));for(var V=0;V<d.numberOfMonths;V++)G="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),P+='<div class="pika-lendar">'+Re(this,V,this.calendars[V].year,this.calendars[V].month,this.calendars[0].year,G)+this.render(this.calendars[V].year,this.calendars[V].month,G)+"</div>";this.el.innerHTML=P,d.bound&&d.field.type!=="hidden"&&s(function(){d.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),d.bound&&d.field.setAttribute("aria-label",d.ariaLabel)}},adjustPosition:function(){var R,d,m,p,E,M,P,G,V,Z,Q,X;if(!this._o.container){if(this.el.style.position="absolute",R=this._o.trigger,d=R,m=this.el.offsetWidth,p=this.el.offsetHeight,E=window.innerWidth||o.documentElement.clientWidth,M=window.innerHeight||o.documentElement.clientHeight,P=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,Q=!0,X=!0,typeof R.getBoundingClientRect=="function")Z=R.getBoundingClientRect(),G=Z.left+window.pageXOffset,V=Z.bottom+window.pageYOffset;else for(G=d.offsetLeft,V=d.offsetTop+d.offsetHeight;d=d.offsetParent;)G+=d.offsetLeft,V+=d.offsetTop;(this._o.reposition&&G+m>E||this._o.position.indexOf("right")>-1&&G-m+R.offsetWidth>0)&&(G=G-m+R.offsetWidth,Q=!1),(this._o.reposition&&V+p>M+P||this._o.position.indexOf("top")>-1&&V-p-R.offsetHeight>0)&&(V=V-p-R.offsetHeight,X=!1),this.el.style.left=G+"px",this.el.style.top=V+"px",h(this.el,Q?"left-aligned":"right-aligned"),h(this.el,X?"bottom-aligned":"top-aligned"),f(this.el,Q?"right-aligned":"left-aligned"),f(this.el,X?"top-aligned":"bottom-aligned")}},render:function(R,d,m){var p=this._o,E=new Date,M=b(R,d),P=new Date(R,d,1).getDay(),G=[],V=[];_(E),p.firstDay>0&&(P-=p.firstDay,P<0&&(P+=7));for(var Z=d===0?11:d-1,Q=d===11?0:d+1,X=d===0?R-1:R,he=d===11?R+1:R,Ae=b(X,Z),_e=M+P,Me=_e;Me>7;)Me-=7;_e+=7-Me;for(var j=!1,Ye=0,Fe=0;Ye<_e;Ye++){var be=new Date(R,d,1+(Ye-P)),xe=w(this._d)?O(be,this._d):!1,ye=O(be,E),v=p.events.indexOf(be.toDateString())!==-1,y=Ye<P||Ye>=M+P,A=1+(Ye-P),W=d,H=R,F=p.startRange&&O(p.startRange,be),D=p.endRange&&O(p.endRange,be),N=p.startRange&&p.endRange&&p.startRange<be&&be<p.endRange,B=p.minDate&&be<p.minDate||p.maxDate&&be>p.maxDate||p.disableWeekends&&C(be)||p.disableDayFn&&p.disableDayFn(be);y&&(Ye<P?(A=Ae+A,W=Z,H=X):(A=A-M,W=Q,H=he));var k={day:A,month:W,year:H,hasEvent:v,isSelected:xe,isToday:ye,isDisabled:B,isEmpty:y,isStartRange:F,isEndRange:D,isInRange:N,showDaysInNextAndPreviousMonths:p.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:p.enableSelectionDaysInNextAndPreviousMonths};p.pickWholeWeek&&xe&&(j=!0),V.push(Y(k)),++Fe===7&&(p.showWeekNumber&&V.unshift(te(Ye-P,d,R,p.firstWeekOfYearMinDays)),G.push(oe(V,p.isRTL,p.pickWholeWeek,j)),V=[],Fe=0,j=!1)}return Ue(p,G,m)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),f(this.el,"is-hidden"),this._o.bound&&(a(o,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var R=this._v;R!==!1&&(this._o.bound&&l(o,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),h(this.el,"is-hidden"),this._v=!1,R!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var R=this._o;this.hide(),l(this.el,"mousedown",this._onMouseDown,!0),l(this.el,"touchend",this._onMouseDown,!0),l(this.el,"change",this._onChange),R.keyboardInput&&l(o,"keydown",this._onKeyChange),R.field&&(l(R.field,"change",this._onInputChange),R.bound&&(l(R.trigger,"click",this._onInputClick),l(R.trigger,"focus",this._onInputFocus),l(R.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},Ie})})(m1);var r6=m1.exports;const BE=hC(r6);function ih(t,e,n){return e=i6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i6(t){var e=o6(t,"string");return typeof e=="symbol"?e:String(e)}function o6(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const p1="date",UE="dateEditor";class w1 extends ea{constructor(){super(...arguments),ih(this,"defaultDateFormat","DD/MM/YYYY"),ih(this,"isCellEdited",!1),ih(this,"parentDestroyed",!1),ih(this,"$datePicker",null)}static get EDITOR_TYPE(){return p1}init(){if(typeof J!="function")throw new Error("You need to include moment.js to your project.");if(typeof BE!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ee(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);const e=new ar(this);e.addEventListener(this.datePicker,"mousedown",n=>{Pe(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),this.hot.getSettings().ariaTags&&ve(this.TD,[sn("true")]),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:UE})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.TD&&this.hot.getSettings().ariaTags&&ve(this.TD,[sn("false")]),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(UE),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){const r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?dv(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new BE(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Ot(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-ut(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,J(s,r,!0).isValid()&&this.$datePicker.setMoment(J(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,J(s,r,!0).isValid()&&this.$datePicker.setMoment(J(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&cc(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=J(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const s6="dropdown";class xy extends Iy{static get EDITOR_TYPE(){return s6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}fe.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===xy&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const a6="numeric";class C1 extends ea{static get EDITOR_TYPE(){return a6}}const l6="password";class v1 extends ea{static get EDITOR_TYPE(){return l6}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Gr(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const bm="ht_editor_visible",zE="selectEditor",u6="select";class S1 extends wl{static get EDITOR_TYPE(){return u6}init(){this.select=this.hot.rootDocument.createElement("SELECT"),ee(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Pe(this.select,bm)&&De(this.select,bm),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),Gr(this.select),Be(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Qs(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Kt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",ee(this.select,bm)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),r={group:zE};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(zE)}}const c6="time";class y1 extends ea{static get EDITOR_TYPE(){return c6}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function h6(){jn(wl),jn(Iy),jn(g1),jn(w1),jn(xy),jn(Py),jn(C1),jn(v1),jn(S1),jn(ea),jn(y1)}const d6="html";function Hy(t,e,n,r,i,o,s){pc.apply(this,[t,e,n,r,i,o,s]),Qs(e,o??"",!1)}Hy.RENDERER_TYPE=d6;const f6="autocomplete";function Cl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?Hy:co,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...so()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),ee(e,"htAutocomplete"),c&&e.setAttribute(...fl("listbox")),!t.acArrowListener){const h=new ar(t);t.acArrowListener=function(f){Pe(f.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Cl.RENDERER_TYPE=f6;const GE=new WeakMap,YE=new WeakMap,g6="htBadValue",al="data-row",ll="data-col",m6="checkboxRenderer",b1="checkbox";fe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===b1){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function Dy(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;pc.apply(this,[t,e,n,r,i,o,s]),p6(t);let u=w6(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),Gr(e),o===s.checkedTemplate||Nt(o).toLocaleLowerCase(s.locale)===Nt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Nt(o).toLocaleLowerCase(s.locale)===Nt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Xt(o)?ee(u,"noValue"):(u.style.display="none",ee(u,g6),h=!0),ve(u,[[al,n],[ll,r]]),l&&ve(u,[Wo(u.checked?t.getTranslatedPhrase(fy):t.getTranslatedPhrase(gy)),Ez(u.checked),wz()]),!h&&c){let C="";if(c.value)C=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const b=t.getDataAtRowProp(n,c.property);C=b!==null?b:""}const S=C6(a,C,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(S),e.appendChild(u)):(S.appendChild(u),u=S):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(S)):(S.insertBefore(u,S.firstChild),u=S))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),GE.has(t)||(GE.set(t,!0),f());function f(){const S=t.getShortcutManager().getContext("grid"),b={group:m6};S.addShortcuts([{keys:[["space"]],callback:()=>(g(),!w())},{keys:[["enter"]],callback:()=>(g(),!w()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(g(!0),!w()),relativeToGroup:Oy,position:"before"}],b)}function g(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=t.getSelectedRange();if(S)for(let b=0;b<S.length;b++){const{row:_,col:O}=S[b].getTopStartCorner(),{row:x,col:I}=S[b].getBottomEndCorner(),$=[];for(let z=_;z<=x;z+=1)for(let q=O;q<=I;q+=1){const Y=t.getCellMeta(z,q);if(Y.type!=="checkbox")return;if(Y.readOnly===!0)continue;typeof Y.checkedTemplate>"u"&&(Y.checkedTemplate=!0),typeof Y.uncheckedTemplate>"u"&&(Y.uncheckedTemplate=!1);const K=t.getDataAtCell(z,q);C===!1?[Y.checkedTemplate,Y.checkedTemplate.toString()].includes(K)?$.push([z,q,Y.uncheckedTemplate]):[Y.uncheckedTemplate,Y.uncheckedTemplate.toString(),null,void 0].includes(K)&&$.push([z,q,Y.checkedTemplate]):$.push([z,q,Y.uncheckedTemplate])}$.length>0&&t.setDataAtCell($)}}function w(){const C=t.getSelectedRange();if(C){for(let S=0;S<C.length;S++){const b=C[S].getTopStartCorner(),_=C[S].getBottomEndCorner();for(let O=b.row;O<=_.row;O++)for(let x=b.col;x<=_.col;x++){const I=t.getCellMeta(O,x);if(I.type!=="checkbox")return!1;const $=t.getCell(O,x);if($==null)return!0;if($.querySelectorAll("input[type=checkbox]").length>0&&!I.readOnly)return!0}}return!1}}}Dy.RENDERER_TYPE=b1;function p6(t){let e=YE.get(t);if(!e){const{rootElement:n}=t;e=new ar(t),e.addEventListener(n,"click",r=>S6(r,t)),e.addEventListener(n,"mouseup",r=>v6(r,t)),e.addEventListener(n,"change",r=>y6(r,t)),YE.set(t,e)}return e}function w6(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function C6(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function v6(t,e){const{target:n}=t;Ny(n)&&(!n.hasAttribute(al)||!n.hasAttribute(ll)||setTimeout(e.listen,10))}function S6(t,e){const{target:n}=t;if(!Ny(n)||!n.hasAttribute(al)||!n.hasAttribute(ll))return;const r=parseInt(n.getAttribute(al),10),i=parseInt(n.getAttribute(ll),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function y6(t,e){const{target:n}=t;if(!Ny(n)||!n.hasAttribute(al)||!n.hasAttribute(ll))return;const r=parseInt(n.getAttribute(al),10),i=parseInt(n.getAttribute(ll),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Ny(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}function oh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var R1={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof oh=="function"&&oh;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var g=i[u]={exports:{}};r[u][0].call(g.exports,function(w){return s(r[u][1][w]||w)},g,g.exports,n,r,i,o)}return i[u].exports}for(var a=typeof oh=="function"&&oh,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",f=1e14,g=14,w=9007199254740991,C=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,b=1e9;function _(Y){var K=0|Y;return 0<Y||Y===K?K:K-1}function O(Y){for(var K,te,oe=1,ie=Y.length,ue=Y[0]+"";oe<ie;){for(K=Y[oe++]+"",te=g-K.length;te--;K="0"+K);ue+=K}for(ie=ue.length;ue.charCodeAt(--ie)===48;);return ue.slice(0,ie+1||1)}function x(Y,K){var te,oe,ie=Y.c,ue=K.c,Re=Y.s,Ue=K.s,Ie=Y.e,R=K.e;if(!Re||!Ue)return null;if(te=ie&&!ie[0],oe=ue&&!ue[0],te||oe)return te?oe?0:-Ue:Re;if(Re!=Ue)return Re;if(te=Re<0,oe=Ie==R,!ie||!ue)return oe?0:!ie^te?1:-1;if(!oe)return R<Ie^te?1:-1;for(Ue=(Ie=ie.length)<(R=ue.length)?Ie:R,Re=0;Re<Ue;Re++)if(ie[Re]!=ue[Re])return ie[Re]>ue[Re]^te?1:-1;return Ie==R?0:R<Ie^te?1:-1}function I(Y,K,te,oe){if(Y<K||te<Y||Y!==(Y<0?l(Y):u(Y)))throw Error(c+(oe||"Argument")+(typeof Y=="number"?Y<K||te<Y?" out of range: ":" not an integer: ":" not a primitive number: ")+String(Y))}function $(Y){var K=Y.c.length-1;return _(Y.e/g)==K&&Y.c[K]%2!=0}function z(Y,K){return(1<Y.length?Y.charAt(0)+"."+Y.slice(1):Y)+(K<0?"e":"e+")+K}function q(Y,K,te){var oe,ie;if(K<0){for(ie=te+".";++K;ie+=te);Y=ie+Y}else if(++K>(oe=Y.length)){for(ie=te,K-=oe;--K;ie+=te);Y+=ie}else K<oe&&(Y=Y.slice(0,K)+"."+Y.slice(K));return Y}(s=function Y(K){var te,oe,ie,ue,Re,Ue,Ie,R,d,m,p=j.prototype={constructor:j,toString:null,valueOf:null},E=new j(1),M=20,P=4,G=-7,V=21,Z=-1e7,Q=1e7,X=!1,he=1,Ae=0,_e={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Me="0123456789abcdefghijklmnopqrstuvwxyz";function j(v,y){var A,W,H,F,D,N,B,k,U=this;if(!(U instanceof j))return new j(v,y);if(y==null){if(v instanceof j)return U.s=v.s,U.e=v.e,void(U.c=(v=v.c)?v.slice():v);if((N=typeof v=="number")&&0*v==0){if(U.s=1/v<0?(v=-v,-1):1,v===~~v){for(F=0,D=v;10<=D;D/=10,F++);return U.e=F,void(U.c=[v])}k=String(v)}else{if(k=String(v),!a.test(k))return ie(U,k,N);U.s=k.charCodeAt(0)==45?(k=k.slice(1),-1):1}-1<(F=k.indexOf("."))&&(k=k.replace(".","")),0<(D=k.search(/e/i))?(F<0&&(F=D),F+=+k.slice(D+1),k=k.substring(0,D)):F<0&&(F=k.length)}else{if(I(y,2,Me.length,"Base"),k=String(v),y==10)return xe(U=new j(v instanceof j?v:k),M+U.e+1,P);if(N=typeof v=="number"){if(0*v!=0)return ie(U,k,N,y);if(U.s=1/v<0?(k=k.slice(1),-1):1,j.DEBUG&&15<k.replace(/^0\.0*|\./,"").length)throw Error(h+v);N=!1}else U.s=k.charCodeAt(0)===45?(k=k.slice(1),-1):1;for(A=Me.slice(0,y),F=D=0,B=k.length;D<B;D++)if(A.indexOf(W=k.charAt(D))<0){if(W=="."){if(F<D){F=B;continue}}else if(!H&&(k==k.toUpperCase()&&(k=k.toLowerCase())||k==k.toLowerCase()&&(k=k.toUpperCase()))){H=!0,D=-1,F=0;continue}return ie(U,String(v),N,y)}-1<(F=(k=oe(k,y,10,U.s)).indexOf("."))?k=k.replace(".",""):F=k.length}for(D=0;k.charCodeAt(D)===48;D++);for(B=k.length;k.charCodeAt(--B)===48;);if(k=k.slice(D,++B)){if(B-=D,N&&j.DEBUG&&15<B&&(w<v||v!==u(v)))throw Error(h+U.s*v);if(Q<(F=F-D-1))U.c=U.e=null;else if(F<Z)U.c=[U.e=0];else{if(U.e=F,U.c=[],D=(F+1)%g,F<0&&(D+=g),D<B){for(D&&U.c.push(+k.slice(0,D)),B-=g;D<B;)U.c.push(+k.slice(D,D+=g));k=k.slice(D),D=g-k.length}else D-=B;for(;D--;k+="0");U.c.push(+k)}}else U.c=[U.e=0]}function Ye(v,y,A,W){var H,F,D,N,B;if(A==null?A=P:I(A,0,8),!v.c)return v.toString();if(H=v.c[0],D=v.e,y==null)B=O(v.c),B=W==1||W==2&&(D<=G||V<=D)?z(B,D):q(B,D,"0");else if(F=(v=xe(new j(v),y,A)).e,N=(B=O(v.c)).length,W==1||W==2&&(y<=F||F<=G)){for(;N<y;B+="0",N++);B=z(B,F)}else if(y-=D,B=q(B,F,"0"),N<F+1){if(0<--y)for(B+=".";y--;B+="0");}else if(0<(y+=F-N))for(F+1==N&&(B+=".");y--;B+="0");return v.s<0&&H?"-"+B:B}function Fe(v,y){for(var A,W=1,H=new j(v[0]);W<v.length;W++){if(!(A=new j(v[W])).s){H=A;break}y.call(H,A)&&(H=A)}return H}function be(v,y,A){for(var W=1,H=y.length;!y[--H];y.pop());for(H=y[0];10<=H;H/=10,W++);return(A=W+A*g-1)>Q?v.c=v.e=null:v.c=A<Z?[v.e=0]:(v.e=A,y),v}function xe(v,y,A,W){var H,F,D,N,B,k,U,se=v.c,de=C;if(se){e:{for(H=1,N=se[0];10<=N;N/=10,H++);if((F=y-H)<0)F+=g,D=y,U=(B=se[k=0])/de[H-D-1]%10|0;else if((k=l((F+1)/g))>=se.length){if(!W)break e;for(;se.length<=k;se.push(0));B=U=0,D=(F%=g)-g+(H=1)}else{for(B=N=se[k],H=1;10<=N;N/=10,H++);U=(D=(F%=g)-g+H)<0?0:B/de[H-D-1]%10|0}if(W=W||y<0||se[k+1]!=null||(D<0?B:B%de[H-D-1]),W=A<4?(U||W)&&(A==0||A==(v.s<0?3:2)):5<U||U==5&&(A==4||W||A==6&&(0<F?0<D?B/de[H-D]:0:se[k-1])%10&1||A==(v.s<0?8:7)),y<1||!se[0])return se.length=0,W?(y-=v.e+1,se[0]=de[(g-y%g)%g],v.e=-y||0):se[0]=v.e=0,v;if(F==0?(se.length=k,N=1,k--):(se.length=k+1,N=de[g-F],se[k]=0<D?u(B/de[H-D]%de[D])*N:0),W)for(;;){if(k==0){for(F=1,D=se[0];10<=D;D/=10,F++);for(D=se[0]+=N,N=1;10<=D;D/=10,N++);F!=N&&(v.e++,se[0]==f&&(se[0]=1));break}if(se[k]+=N,se[k]!=f)break;se[k--]=0,N=1}for(F=se.length;se[--F]===0;se.pop());}v.e>Q?v.c=v.e=null:v.e<Z&&(v.c=[v.e=0])}return v}function ye(v){var y,A=v.e;return A===null?v.toString():(y=O(v.c),y=A<=G||V<=A?z(y,A):q(y,A,"0"),v.s<0?"-"+y:y)}return j.clone=Y,j.ROUND_UP=0,j.ROUND_DOWN=1,j.ROUND_CEIL=2,j.ROUND_FLOOR=3,j.ROUND_HALF_UP=4,j.ROUND_HALF_DOWN=5,j.ROUND_HALF_EVEN=6,j.ROUND_HALF_CEIL=7,j.ROUND_HALF_FLOOR=8,j.EUCLID=9,j.config=j.set=function(v){var y,A;if(v!=null){if(typeof v!="object")throw Error(c+"Object expected: "+v);if(v.hasOwnProperty(y="DECIMAL_PLACES")&&(I(A=v[y],0,b,y),M=A),v.hasOwnProperty(y="ROUNDING_MODE")&&(I(A=v[y],0,8,y),P=A),v.hasOwnProperty(y="EXPONENTIAL_AT")&&((A=v[y])&&A.pop?(I(A[0],-b,0,y),I(A[1],0,b,y),G=A[0],V=A[1]):(I(A,-b,b,y),G=-(V=A<0?-A:A))),v.hasOwnProperty(y="RANGE"))if((A=v[y])&&A.pop)I(A[0],-b,-1,y),I(A[1],1,b,y),Z=A[0],Q=A[1];else{if(I(A,-b,b,y),!A)throw Error(c+y+" cannot be zero: "+A);Z=-(Q=A<0?-A:A)}if(v.hasOwnProperty(y="CRYPTO")){if((A=v[y])!==!!A)throw Error(c+y+" not true or false: "+A);if(A){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw X=!A,Error(c+"crypto unavailable");X=A}else X=A}if(v.hasOwnProperty(y="MODULO_MODE")&&(I(A=v[y],0,9,y),he=A),v.hasOwnProperty(y="POW_PRECISION")&&(I(A=v[y],0,b,y),Ae=A),v.hasOwnProperty(y="FORMAT")){if(typeof(A=v[y])!="object")throw Error(c+y+" not an object: "+A);_e=A}if(v.hasOwnProperty(y="ALPHABET")){if(typeof(A=v[y])!="string"||/^.$|[+-.\s]|(.).*\1/.test(A))throw Error(c+y+" invalid: "+A);Me=A}}return{DECIMAL_PLACES:M,ROUNDING_MODE:P,EXPONENTIAL_AT:[G,V],RANGE:[Z,Q],CRYPTO:X,MODULO_MODE:he,POW_PRECISION:Ae,FORMAT:_e,ALPHABET:Me}},j.isBigNumber=function(v){return v instanceof j||v&&v._isBigNumber===!0||!1},j.maximum=j.max=function(){return Fe(arguments,p.lt)},j.minimum=j.min=function(){return Fe(arguments,p.gt)},j.random=(ue=9007199254740992,Re=Math.random()*ue&2097151?function(){return u(Math.random()*ue)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(v){var y,A,W,H,F,D=0,N=[],B=new j(E);if(v==null?v=M:I(v,0,b),H=l(v/g),X)if(crypto.getRandomValues){for(y=crypto.getRandomValues(new Uint32Array(H*=2));D<H;)9e15<=(F=131072*y[D]+(y[D+1]>>>11))?(A=crypto.getRandomValues(new Uint32Array(2)),y[D]=A[0],y[D+1]=A[1]):(N.push(F%1e14),D+=2);D=H/2}else{if(!crypto.randomBytes)throw X=!1,Error(c+"crypto unavailable");for(y=crypto.randomBytes(H*=7);D<H;)9e15<=(F=281474976710656*(31&y[D])+1099511627776*y[D+1]+4294967296*y[D+2]+16777216*y[D+3]+(y[D+4]<<16)+(y[D+5]<<8)+y[D+6])?crypto.randomBytes(7).copy(y,D):(N.push(F%1e14),D+=7);D=H/7}if(!X)for(;D<H;)(F=Re())<9e15&&(N[D++]=F%1e14);for(H=N[--D],v%=g,H&&v&&(F=C[g-v],N[D]=u(H/F)*F);N[D]===0;N.pop(),D--);if(D<0)N=[W=0];else{for(W=-1;N[0]===0;N.splice(0,1),W-=g);for(D=1,F=N[0];10<=F;F/=10,D++);D<g&&(W-=g-D)}return B.e=W,B.c=N,B}),j.sum=function(){for(var v=1,y=arguments,A=new j(y[0]);v<y.length;)A=A.plus(y[v++]);return A},oe=function(){var v="0123456789";function y(A,W,H,F){for(var D,N,B=[0],k=0,U=A.length;k<U;){for(N=B.length;N--;B[N]*=W);for(B[0]+=F.indexOf(A.charAt(k++)),D=0;D<B.length;D++)B[D]>H-1&&(B[D+1]==null&&(B[D+1]=0),B[D+1]+=B[D]/H|0,B[D]%=H)}return B.reverse()}return function(A,W,H,F,D){var N,B,k,U,se,de,Ce,Oe,ke=A.indexOf("."),wt=M,Xe=P;for(0<=ke&&(U=Ae,Ae=0,A=A.replace(".",""),de=(Oe=new j(W)).pow(A.length-ke),Ae=U,Oe.c=y(q(O(de.c),de.e,"0"),10,H,v),Oe.e=Oe.c.length),k=U=(Ce=y(A,W,H,D?(N=Me,v):(N=v,Me))).length;Ce[--U]==0;Ce.pop());if(!Ce[0])return N.charAt(0);if(ke<0?--k:(de.c=Ce,de.e=k,de.s=F,Ce=(de=te(de,Oe,wt,Xe,H)).c,se=de.r,k=de.e),ke=Ce[B=k+wt+1],U=H/2,se=se||B<0||Ce[B+1]!=null,se=Xe<4?(ke!=null||se)&&(Xe==0||Xe==(de.s<0?3:2)):U<ke||ke==U&&(Xe==4||se||Xe==6&&1&Ce[B-1]||Xe==(de.s<0?8:7)),B<1||!Ce[0])A=se?q(N.charAt(1),-wt,N.charAt(0)):N.charAt(0);else{if(Ce.length=B,se)for(--H;++Ce[--B]>H;)Ce[B]=0,B||(++k,Ce=[1].concat(Ce));for(U=Ce.length;!Ce[--U];);for(ke=0,A="";ke<=U;A+=N.charAt(Ce[ke++]));A=q(A,k,N.charAt(0))}return A}}(),te=function(){function v(W,H,F){var D,N,B,k,U=0,se=W.length,de=H%S,Ce=H/S|0;for(W=W.slice();se--;)U=((N=de*(B=W[se]%S)+(D=Ce*B+(k=W[se]/S|0)*de)%S*S+U)/F|0)+(D/S|0)+Ce*k,W[se]=N%F;return U&&(W=[U].concat(W)),W}function y(W,H,F,D){var N,B;if(F!=D)B=D<F?1:-1;else for(N=B=0;N<F;N++)if(W[N]!=H[N]){B=W[N]>H[N]?1:-1;break}return B}function A(W,H,F,D){for(var N=0;F--;)W[F]-=N,N=W[F]<H[F]?1:0,W[F]=N*D+W[F]-H[F];for(;!W[0]&&1<W.length;W.splice(0,1));}return function(W,H,F,D,N){var B,k,U,se,de,Ce,Oe,ke,wt,Xe,at,Rt,ia,yl,kt,an,Zo,_n=W.s==H.s?1:-1,qt=W.c,Ct=H.c;if(!(qt&&qt[0]&&Ct&&Ct[0]))return new j(W.s&&H.s&&(qt?!Ct||qt[0]!=Ct[0]:Ct)?qt&&qt[0]==0||!Ct?0*_n:_n/0:NaN);for(wt=(ke=new j(_n)).c=[],_n=F+(k=W.e-H.e)+1,N||(N=f,k=_(W.e/g)-_(H.e/g),_n=_n/g|0),U=0;Ct[U]==(qt[U]||0);U++);if(Ct[U]>(qt[U]||0)&&k--,_n<0)wt.push(1),se=!0;else{for(yl=qt.length,an=Ct.length,_n+=2,1<(de=u(N/(Ct[U=0]+1)))&&(Ct=v(Ct,de,N),qt=v(qt,de,N),an=Ct.length,yl=qt.length),ia=an,at=(Xe=qt.slice(0,an)).length;at<an;Xe[at++]=0);Zo=Ct.slice(),Zo=[0].concat(Zo),kt=Ct[0],Ct[1]>=N/2&&kt++;do{if(de=0,(B=y(Ct,Xe,an,at))<0){if(Rt=Xe[0],an!=at&&(Rt=Rt*N+(Xe[1]||0)),1<(de=u(Rt/kt)))for(N<=de&&(de=N-1),Oe=(Ce=v(Ct,de,N)).length,at=Xe.length;y(Ce,Xe,Oe,at)==1;)de--,A(Ce,an<Oe?Zo:Ct,Oe,N),Oe=Ce.length,B=1;else de==0&&(B=de=1),Oe=(Ce=Ct.slice()).length;if(Oe<at&&(Ce=[0].concat(Ce)),A(Xe,Ce,at,N),at=Xe.length,B==-1)for(;y(Ct,Xe,an,at)<1;)de++,A(Xe,an<at?Zo:Ct,at,N),at=Xe.length}else B===0&&(de++,Xe=[0]);wt[U++]=de,Xe[0]?Xe[at++]=qt[ia]||0:(Xe=[qt[ia]],at=1)}while((ia++<yl||Xe[0]!=null)&&_n--);se=Xe[0]!=null,wt[0]||wt.splice(0,1)}if(N==f){for(U=1,_n=wt[0];10<=_n;_n/=10,U++);xe(ke,F+(ke.e=U+k*g-1)+1,D,se)}else ke.e=k,ke.r=+se;return ke}}(),Ue=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Ie=/^([^.]+)\.$/,R=/^\.([^.]+)$/,d=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ie=function(v,y,A,W){var H,F=A?y:y.replace(m,"");if(d.test(F))v.s=isNaN(F)?null:F<0?-1:1,v.c=v.e=null;else{if(!A&&(F=F.replace(Ue,function(D,N,B){return H=(B=B.toLowerCase())=="x"?16:B=="b"?2:8,W&&W!=H?D:N}),W&&(H=W,F=F.replace(Ie,"$1").replace(R,"0.$1")),y!=F))return new j(F,H);if(j.DEBUG)throw Error(c+"Not a"+(W?" base "+W:"")+" number: "+y);v.c=v.e=v.s=null}},p.absoluteValue=p.abs=function(){var v=new j(this);return v.s<0&&(v.s=1),v},p.comparedTo=function(v,y){return x(this,new j(v,y))},p.decimalPlaces=p.dp=function(v,y){var A,W,H;if(v!=null)return I(v,0,b),y==null?y=P:I(y,0,8),xe(new j(this),v+this.e+1,y);if(!(A=this.c))return null;if(W=((H=A.length-1)-_(this.e/g))*g,H=A[H])for(;H%10==0;H/=10,W--);return W<0&&(W=0),W},p.dividedBy=p.div=function(v,y){return te(this,new j(v,y),M,P)},p.dividedToIntegerBy=p.idiv=function(v,y){return te(this,new j(v,y),0,1)},p.exponentiatedBy=p.pow=function(v,y){var A,W,H,F,D,N,B,k,U=this;if((v=new j(v)).c&&!v.isInteger())throw Error(c+"Exponent not an integer: "+ye(v));if(y!=null&&(y=new j(y)),D=14<v.e,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!v.c||!v.c[0])return k=new j(Math.pow(+ye(U),D?2-$(v):+ye(v))),y?k.mod(y):k;if(N=v.s<0,y){if(y.c?!y.c[0]:!y.s)return new j(NaN);(W=!N&&U.isInteger()&&y.isInteger())&&(U=U.mod(y))}else{if(9<v.e&&(0<U.e||U.e<-1||(U.e==0?1<U.c[0]||D&&24e7<=U.c[1]:U.c[0]<8e13||D&&U.c[0]<=9999975e7)))return F=U.s<0&&$(v)?-0:0,-1<U.e&&(F=1/F),new j(N?1/F:F);Ae&&(F=l(Ae/g+2))}for(B=D?(A=new j(.5),N&&(v.s=1),$(v)):(H=Math.abs(+ye(v)))%2,k=new j(E);;){if(B){if(!(k=k.times(U)).c)break;F?k.c.length>F&&(k.c.length=F):W&&(k=k.mod(y))}if(H){if((H=u(H/2))===0)break;B=H%2}else if(xe(v=v.times(A),v.e+1,1),14<v.e)B=$(v);else{if((H=+ye(v))==0)break;B=H%2}U=U.times(U),F?U.c&&U.c.length>F&&(U.c.length=F):W&&(U=U.mod(y))}return W?k:(N&&(k=E.div(k)),y?k.mod(y):F?xe(k,Ae,P,void 0):k)},p.integerValue=function(v){var y=new j(this);return v==null?v=P:I(v,0,8),xe(y,y.e+1,v)},p.isEqualTo=p.eq=function(v,y){return x(this,new j(v,y))===0},p.isFinite=function(){return!!this.c},p.isGreaterThan=p.gt=function(v,y){return 0<x(this,new j(v,y))},p.isGreaterThanOrEqualTo=p.gte=function(v,y){return(y=x(this,new j(v,y)))===1||y===0},p.isInteger=function(){return!!this.c&&_(this.e/g)>this.c.length-2},p.isLessThan=p.lt=function(v,y){return x(this,new j(v,y))<0},p.isLessThanOrEqualTo=p.lte=function(v,y){return(y=x(this,new j(v,y)))===-1||y===0},p.isNaN=function(){return!this.s},p.isNegative=function(){return this.s<0},p.isPositive=function(){return 0<this.s},p.isZero=function(){return!!this.c&&this.c[0]==0},p.minus=function(v,y){var A,W,H,F,D=this,N=D.s;if(y=(v=new j(v,y)).s,!N||!y)return new j(NaN);if(N!=y)return v.s=-y,D.plus(v);var B=D.e/g,k=v.e/g,U=D.c,se=v.c;if(!B||!k){if(!U||!se)return U?(v.s=-y,v):new j(se?D:NaN);if(!U[0]||!se[0])return se[0]?(v.s=-y,v):new j(U[0]?D:P==3?-0:0)}if(B=_(B),k=_(k),U=U.slice(),N=B-k){for((H=(F=N<0)?(N=-N,U):(k=B,se)).reverse(),y=N;y--;H.push(0));H.reverse()}else for(W=(F=(N=U.length)<(y=se.length))?N:y,N=y=0;y<W;y++)if(U[y]!=se[y]){F=U[y]<se[y];break}if(F&&(H=U,U=se,se=H,v.s=-v.s),0<(y=(W=se.length)-(A=U.length)))for(;y--;U[A++]=0);for(y=f-1;N<W;){if(U[--W]<se[W]){for(A=W;A&&!U[--A];U[A]=y);--U[A],U[W]+=f}U[W]-=se[W]}for(;U[0]==0;U.splice(0,1),--k);return U[0]?be(v,U,k):(v.s=P==3?-1:1,v.c=[v.e=0],v)},p.modulo=p.mod=function(v,y){var A,W,H=this;return v=new j(v,y),!H.c||!v.s||v.c&&!v.c[0]?new j(NaN):!v.c||H.c&&!H.c[0]?new j(H):(he==9?(W=v.s,v.s=1,A=te(H,v,0,3),v.s=W,A.s*=W):A=te(H,v,0,he),(v=H.minus(A.times(v))).c[0]||he!=1||(v.s=H.s),v)},p.multipliedBy=p.times=function(v,y){var A,W,H,F,D,N,B,k,U,se,de,Ce,Oe,ke,wt,Xe=this,at=Xe.c,Rt=(v=new j(v,y)).c;if(!(at&&Rt&&at[0]&&Rt[0]))return!Xe.s||!v.s||at&&!at[0]&&!Rt||Rt&&!Rt[0]&&!at?v.c=v.e=v.s=null:(v.s*=Xe.s,at&&Rt?(v.c=[0],v.e=0):v.c=v.e=null),v;for(W=_(Xe.e/g)+_(v.e/g),v.s*=Xe.s,(B=at.length)<(se=Rt.length)&&(Oe=at,at=Rt,Rt=Oe,H=B,B=se,se=H),H=B+se,Oe=[];H--;Oe.push(0));for(ke=f,wt=S,H=se;0<=--H;){for(A=0,de=Rt[H]%wt,Ce=Rt[H]/wt|0,F=H+(D=B);H<F;)A=((k=de*(k=at[--D]%wt)+(N=Ce*k+(U=at[D]/wt|0)*de)%wt*wt+Oe[F]+A)/ke|0)+(N/wt|0)+Ce*U,Oe[F--]=k%ke;Oe[F]=A}return A?++W:Oe.splice(0,1),be(v,Oe,W)},p.negated=function(){var v=new j(this);return v.s=-v.s||null,v},p.plus=function(v,y){var A,W=this,H=W.s;if(y=(v=new j(v,y)).s,!H||!y)return new j(NaN);if(H!=y)return v.s=-y,W.minus(v);var F=W.e/g,D=v.e/g,N=W.c,B=v.c;if(!F||!D){if(!N||!B)return new j(H/0);if(!N[0]||!B[0])return B[0]?v:new j(N[0]?W:0*H)}if(F=_(F),D=_(D),N=N.slice(),H=F-D){for((A=0<H?(D=F,B):(H=-H,N)).reverse();H--;A.push(0));A.reverse()}for((H=N.length)-(y=B.length)<0&&(A=B,B=N,N=A,y=H),H=0;y;)H=(N[--y]=N[y]+B[y]+H)/f|0,N[y]=f===N[y]?0:N[y]%f;return H&&(N=[H].concat(N),++D),be(v,N,D)},p.precision=p.sd=function(v,y){var A,W,H;if(v!=null&&v!==!!v)return I(v,1,b),y==null?y=P:I(y,0,8),xe(new j(this),v,y);if(!(A=this.c))return null;if(W=(H=A.length-1)*g+1,H=A[H]){for(;H%10==0;H/=10,W--);for(H=A[0];10<=H;H/=10,W++);}return v&&this.e+1>W&&(W=this.e+1),W},p.shiftedBy=function(v){return I(v,-w,w),this.times("1e"+v)},p.squareRoot=p.sqrt=function(){var v,y,A,W,H,F=this,D=F.c,N=F.s,B=F.e,k=M+4,U=new j("0.5");if(N!==1||!D||!D[0])return new j(!N||N<0&&(!D||D[0])?NaN:D?F:1/0);if((A=(N=Math.sqrt(+ye(F)))==0||N==1/0?(((y=O(D)).length+B)%2==0&&(y+="0"),N=Math.sqrt(+y),B=_((B+1)/2)-(B<0||B%2),new j(y=N==1/0?"1e"+B:(y=N.toExponential()).slice(0,y.indexOf("e")+1)+B)):new j(N+"")).c[0]){for((N=(B=A.e)+k)<3&&(N=0);;)if(H=A,A=U.times(H.plus(te(F,H,k,1))),O(H.c).slice(0,N)===(y=O(A.c)).slice(0,N)){if(A.e<B&&--N,(y=y.slice(N-3,N+1))!="9999"&&(W||y!="4999")){+y&&(+y.slice(1)||y.charAt(0)!="5")||(xe(A,A.e+M+2,1),v=!A.times(A).eq(F));break}if(!W&&(xe(H,H.e+M+2,0),H.times(H).eq(F))){A=H;break}k+=4,N+=4,W=1}}return xe(A,A.e+M+1,P,v)},p.toExponential=function(v,y){return v!=null&&(I(v,0,b),v++),Ye(this,v,y,1)},p.toFixed=function(v,y){return v!=null&&(I(v,0,b),v=v+this.e+1),Ye(this,v,y)},p.toFormat=function(v,y,A){var W;if(A==null)v!=null&&y&&typeof y=="object"?(A=y,y=null):v&&typeof v=="object"?(A=v,v=y=null):A=_e;else if(typeof A!="object")throw Error(c+"Argument not an object: "+A);if(W=this.toFixed(v,y),this.c){var H,F=W.split("."),D=+A.groupSize,N=+A.secondaryGroupSize,B=A.groupSeparator||"",k=F[0],U=F[1],se=this.s<0,de=se?k.slice(1):k,Ce=de.length;if(N&&(H=D,D=N,Ce-=N=H),0<D&&0<Ce){for(H=Ce%D||D,k=de.substr(0,H);H<Ce;H+=D)k+=B+de.substr(H,D);0<N&&(k+=B+de.slice(H)),se&&(k="-"+k)}W=U?k+(A.decimalSeparator||"")+((N=+A.fractionGroupSize)?U.replace(new RegExp("\\d{"+N+"}\\B","g"),"$&"+(A.fractionGroupSeparator||"")):U):k}return(A.prefix||"")+W+(A.suffix||"")},p.toFraction=function(v){var y,A,W,H,F,D,N,B,k,U,se,de,Ce=this,Oe=Ce.c;if(v!=null&&(!(N=new j(v)).isInteger()&&(N.c||N.s!==1)||N.lt(E)))throw Error(c+"Argument "+(N.isInteger()?"out of range: ":"not an integer: ")+ye(N));if(!Oe)return new j(Ce);for(y=new j(E),k=A=new j(E),W=B=new j(E),de=O(Oe),F=y.e=de.length-Ce.e-1,y.c[0]=C[(D=F%g)<0?g+D:D],v=!v||0<N.comparedTo(y)?0<F?y:k:N,D=Q,Q=1/0,N=new j(de),B.c[0]=0;U=te(N,y,0,1),(H=A.plus(U.times(W))).comparedTo(v)!=1;)A=W,W=H,k=B.plus(U.times(H=k)),B=H,y=N.minus(U.times(H=y)),N=H;return H=te(v.minus(A),W,0,1),B=B.plus(H.times(k)),A=A.plus(H.times(W)),B.s=k.s=Ce.s,se=te(k,W,F*=2,P).minus(Ce).abs().comparedTo(te(B,A,F,P).minus(Ce).abs())<1?[k,W]:[B,A],Q=D,se},p.toNumber=function(){return+ye(this)},p.toPrecision=function(v,y){return v!=null&&I(v,1,b),Ye(this,v,y,2)},p.toString=function(v){var y,A=this,W=A.s,H=A.e;return H===null?W?(y="Infinity",W<0&&(y="-"+y)):y="NaN":(y=v==null?H<=G||V<=H?z(O(A.c),H):q(O(A.c),H,"0"):v===10?q(O((A=xe(new j(A),M+H+1,P)).c),A.e,"0"):(I(v,2,Me.length,"Base"),oe(q(O(A.c),H,"0"),10,v,W,!0)),W<0&&A.c[0]&&(y="-"+y)),y},p.valueOf=p.toJSON=function(){return ye(this)},p._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(p[Symbol.toStringTag]="BigNumber",p[Symbol.for("nodejs.util.inspect.custom")]=p.valueOf),K!=null&&j.set(K),j}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(_,O){return function(x){if(Array.isArray(x))return x}(_)||function(x,I){var $=[],z=!0,q=!1,Y=void 0;try{for(var K,te=x[Symbol.iterator]();!(z=(K=te.next()).done)&&($.push(K.value),!I||$.length!==I);z=!0);}catch(oe){q=!0,Y=oe}finally{try{z||te.return==null||te.return()}finally{if(q)throw Y}}return $}(_,O)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function f(_){var O=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},x=2<arguments.length?arguments[2]:void 0;if(typeof O=="string"&&(O=l.parseFormat(O)),!a.validateFormat(O))return"ERROR: invalid format";var I=O.prefix||"",$=O.postfix||"",z=function(q,Y,K){switch(Y.output){case"currency":return Y=b(Y,s.currentCurrencyDefaultFormat()),function(Me,j,Ye){var Fe=Ye.currentCurrency(),be=Object.assign({},h,j),xe=void 0,ye="",v=!!be.totalLength||!!be.forceAverage||be.average,y=j.currencyPosition||Fe.position,A=j.currencySymbol||Fe.symbol;be.spaceSeparated&&(ye=" "),y==="infix"&&(xe=ye+A+ye);var W=S({instance:Me,providedFormat:j,state:Ye,decimalSeparator:xe});return y==="prefix"&&(W=Me._value<0&&be.negative==="sign"?"-".concat(ye).concat(A).concat(W.slice(1)):A+ye+W),y&&y!=="postfix"||(W=W+(ye=v?"":ye)+A),W}(q,Y,s);case"percent":return Y=b(Y,s.currentPercentageDefaultFormat()),function(Me,j,Ye,Fe){var be=j.prefixSymbol,xe=S({instance:Fe(100*Me._value),providedFormat:j,state:Ye}),ye=Object.assign({},h,j);return be?"%".concat(ye.spaceSeparated?" ":"").concat(xe):"".concat(xe).concat(ye.spaceSeparated?" ":"","%")}(q,Y,s,K);case"byte":return Y=b(Y,s.currentByteDefaultFormat()),E=q,P=s,G=K,V=(M=Y).base||"binary",Z=c[V],Q=g(E._value,Z.suffixes,Z.scale),X=Q.value,he=Q.suffix,Ae=S({instance:G(X),providedFormat:M,state:P,defaults:P.currentByteDefaultFormat()}),_e=P.currentAbbreviations(),"".concat(Ae).concat(_e.spaced?" ":"").concat(he);case"time":return Y=b(Y,s.currentTimeDefaultFormat()),R=q,d=Math.floor(R._value/60/60),m=Math.floor((R._value-60*d*60)/60),p=Math.round(R._value-60*d*60-60*m),"".concat(d,":").concat(m<10?"0":"").concat(m,":").concat(p<10?"0":"").concat(p);case"ordinal":return Y=b(Y,s.currentOrdinalDefaultFormat()),te=q,oe=Y,ue=(ie=s).currentOrdinal(),Re=Object.assign({},h,oe),Ue=S({instance:te,providedFormat:oe,state:ie}),Ie=ue(te._value),"".concat(Ue).concat(Re.spaceSeparated?" ":"").concat(Ie);case"number":default:return S({instance:q,providedFormat:Y,numbro:K})}var te,oe,ie,ue,Re,Ue,Ie,R,d,m,p,E,M,P,G,V,Z,Q,X,he,Ae,_e}(_,O,x);return z=(z=I+z)+$}function g(_,O,x){var I=O[0],$=Math.abs(_);if(x<=$){for(var z=1;z<O.length;++z){var q=Math.pow(x,z),Y=Math.pow(x,z+1);if(q<=$&&$<Y){I=O[z],_/=q;break}}I===O[0]&&(_/=Math.pow(x,O.length-1),I=O[O.length-1])}return{value:_,suffix:I}}function w(_){for(var O="",x=0;x<_;x++)O+="0";return O}function C(_,O){return _.toString().indexOf("e")!==-1?function(x,I){var $=x.toString(),z=o($.split("e"),2),q=z[0],Y=z[1],K=o(q.split("."),2),te=K[0],oe=K[1],ie=oe===void 0?"":oe;if(0<+Y)$=te+ie+w(Y-ie.length);else{var ue=".";ue=+te<0?"-0".concat(ue):"0".concat(ue);var Re=(w(-Y-1)+Math.abs(te)+ie).substr(0,I);Re.length<I&&(Re+=w(I-Re.length)),$=ue+Re}return 0<+Y&&0<I&&($+=".".concat(w(I))),$}(_,O):(Math.round(+"".concat(_,"e+").concat(O))/Math.pow(10,O)).toFixed(O)}function S(_){var O=_.instance,x=_.providedFormat,I=_.state,$=I===void 0?s:I,z=_.decimalSeparator,q=_.defaults,Y=q===void 0?$.currentDefaults():q,K=O._value;if(K===0&&$.hasZeroFormat())return $.getZeroFormat();if(!isFinite(K))return K.toString();var te,oe,ie,ue,Re,Ue,Ie,R,d=Object.assign({},h,Y,x),m=d.totalLength,p=m?0:d.characteristic,E=d.optionalCharacteristic,M=d.forceAverage,P=!!m||!!M||d.average,G=m?-1:P&&x.mantissa===void 0?0:d.mantissa,V=!m&&(x.optionalMantissa===void 0?G===-1:d.optionalMantissa),Z=d.trimMantissa,Q=d.thousandSeparated,X=d.spaceSeparated,he=d.negative,Ae=d.forceSign,_e=d.exponential,Me="";if(P){var j=function(v){var y=v.value,A=v.forceAverage,W=v.abbreviations,H=v.spaceSeparated,F=H!==void 0&&H,D=v.totalLength,N=D===void 0?0:D,B="",k=Math.abs(y),U=-1;if(k>=Math.pow(10,12)&&!A||A==="trillion"?(B=W.trillion,y/=Math.pow(10,12)):k<Math.pow(10,12)&&k>=Math.pow(10,9)&&!A||A==="billion"?(B=W.billion,y/=Math.pow(10,9)):k<Math.pow(10,9)&&k>=Math.pow(10,6)&&!A||A==="million"?(B=W.million,y/=Math.pow(10,6)):(k<Math.pow(10,6)&&k>=Math.pow(10,3)&&!A||A==="thousand")&&(B=W.thousand,y/=Math.pow(10,3)),B&&(B=(F?" ":"")+B),N){var se=y.toString().split(".")[0];U=Math.max(N-se.length,0)}return{value:y,abbreviation:B,mantissaPrecision:U}}({value:K,forceAverage:M,abbreviations:$.currentAbbreviations(),spaceSeparated:X,totalLength:m});K=j.value,Me+=j.abbreviation,m&&(G=j.mantissaPrecision)}if(_e){var Ye=(oe=(te={value:K,characteristicPrecision:p}).value,ie=te.characteristicPrecision,ue=ie===void 0?0:ie,Re=o(oe.toExponential().split("e"),2),Ue=Re[0],Ie=Re[1],R=+Ue,ue&&1<ue&&(R*=Math.pow(10,ue-1),Ie=0<=(Ie=+Ie-(ue-1))?"+".concat(Ie):Ie),{value:R,abbreviation:"e".concat(Ie)});K=Ye.value,Me=Ye.abbreviation+Me}var Fe,be,xe,ye=function(v,y,A,W,H){if(W===-1)return v;var F=C(y,W),D=o(F.toString().split("."),2),N=D[0],B=D[1],k=B===void 0?"":B;if(k.match(/^0+$/)&&(A||H))return N;var U=k.match(/0+$/);return H&&U?"".concat(N,".").concat(k.toString().slice(0,U.index)):F.toString()}(K.toString(),K,V,G,Z);return ye=function(v,y,A,W,H){var F=W.currentDelimiters(),D=F.thousands;H=H||F.decimal;var N=F.thousandsSize||3,B=v.toString(),k=B.split(".")[0],U=B.split(".")[1];return A&&(y<0&&(k=k.slice(1)),function(se,de){for(var Ce=[],Oe=0,ke=se;0<ke;ke--)Oe===de&&(Ce.unshift(ke),Oe=0),Oe++;return Ce}(k.length,N).forEach(function(se,de){k=k.slice(0,se+de)+D+k.slice(se+de)}),y<0&&(k="-".concat(k))),B=U?k+H+U:k}(ye=function(v,y,A,W){var H=v,F=o(H.toString().split("."),2),D=F[0],N=F[1];if(D.match(/^-?0$/)&&A)return N?"".concat(D.replace("0",""),".").concat(N):D.replace("0","");if(D.length<W)for(var B=W-D.length,k=0;k<B;k++)H="0".concat(H);return H.toString()}(ye,0,E,p),K,Q,$,z),(P||_e)&&(ye=ye+Me),(Ae||K<0)&&(Fe=ye,xe=he,ye=(be=K)===0?Fe:+Fe==0?Fe.replace("-",""):0<be?"+".concat(Fe):xe==="sign"?Fe:"(".concat(Fe.replace("-",""),")")),ye}function b(_,O){if(!_)return O;var x=Object.keys(_);return x.length===1&&x[0]==="output"?O:_}r.exports=function(_){return{format:function(){for(var O=arguments.length,x=new Array(O),I=0;I<O;I++)x[I]=arguments[I];return f.apply(void 0,x.concat([_]))},getByteUnit:function(){for(var O=arguments.length,x=new Array(O),I=0;I<O;I++)x[I]=arguments[I];return(function($){var z=c.general;return g($._value,z.suffixes,z.scale).suffix}).apply(void 0,x.concat([_]))},getBinaryByteUnit:function(){for(var O=arguments.length,x=new Array(O),I=0;I<O;I++)x[I]=arguments[I];return(function($){var z=c.binary;return g($._value,z.suffixes,z.scale).suffix}).apply(void 0,x.concat([_]))},getDecimalByteUnit:function(){for(var O=arguments.length,x=new Array(O),I=0;I<O;I++)x[I]=arguments[I];return(function($){var z=c.decimal;return g($._value,z.suffixes,z.scale).suffix}).apply(void 0,x.concat([_]))},formatOrDefault:b}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,f={};function g(C){u=C}function w(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return w().currency},l.currentAbbreviations=function(){return w().abbreviations},l.currentDelimiters=function(){return w().delimiters},l.currentOrdinal=function(){return w().ordinal},l.currentDefaults=function(){return Object.assign({},w().defaults,f)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),w().timeFormat)},l.setDefaults=function(C){C=a.parseFormat(C),s.validateFormat(C)&&(f=C)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(C){return h=typeof C=="string"?C:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(C){if(C){if(c[C])return c[C];throw new Error('Unknown tag "'.concat(C,'"'))}return w()},l.registerLanguage=function(C){var S=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(C))throw new Error("Invalid language data");c[C.languageTag]=C,S&&g(C.languageTag)},l.setLanguage=function(C){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[C]){var b=C.split("-")[0],_=Object.keys(c).find(function(O){return O.split("-")[0]===b});return c[_]?void g(_):void g(S)}g(C)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.plus(w).toNumber(),c;var c,h,f,g,w},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.times(w).toNumber(),c;var c,h,f,g,w},divide:function(l,u){return h=u,f=a,g=new o((c=l)._value),w=h,f.isNumbro(h)&&(w=h._value),w=new o(w),c._value=g.dividedBy(w).toNumber(),c;var c,h,f,g,w},set:function(l,u){return c=l,f=h=u,a.isNumbro(h)&&(f=h._value),c._value=f,c;var c,h,f},difference:function(l,u){return c=u,s(f=(h=a)(l._value),c,h),Math.abs(f._value);var c,h,f}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(S,b){for(var _=0;_<b.length;_++){var O=b[_];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(S,O.key,O)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(C),u=n("./unformatting"),c=n("./formatting")(C),h=n("./manipulating")(C),f=n("./parsing"),g=function(){function S(O){(function(x,I){if(!(x instanceof I))throw new TypeError("Cannot call a class as a function")})(this,S),this._value=O}var b,_;return b=S,(_=[{key:"clone",value:function(){return C(this._value)}},{key:"format",value:function(){var O=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,O)}},{key:"formatCurrency",value:function(O){return typeof O=="string"&&(O=f.parseFormat(O)),(O=c.formatOrDefault(O,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,O)}},{key:"formatTime",value:function(){var O=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return O.output="time",c.format(this,O)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(O){return h.difference(this,O)}},{key:"add",value:function(O){return h.add(this,O)}},{key:"subtract",value:function(O){return h.subtract(this,O)}},{key:"multiply",value:function(O){return h.multiply(this,O)}},{key:"divide",value:function(O){return h.divide(this,O)}},{key:"set",value:function(O){return h.set(this,w(O))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(b.prototype,_),S}();function w(S){var b=S;return C.isNumbro(S)?b=S._value:typeof S=="string"?b=C.unformat(S):isNaN(S)&&(b=NaN),b}function C(S){return new g(w(S))}C.version="2.1.2",C.isNumbro=function(S){return S instanceof g},C.language=s.currentLanguage,C.registerLanguage=s.registerLanguage,C.setLanguage=s.setLanguage,C.languages=s.languages,C.languageData=s.languageData,C.zeroFormat=s.setZeroFormat,C.defaultFormat=s.currentDefaults,C.setDefaults=s.setDefaults,C.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,C.validate=a.validate,C.loadLanguagesInNode=l.loadLanguagesInNode,C.unformat=u.unformat,r.exports=C},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,f,g,w,C,S,b,_,O,x,I,$,z,q,Y,K=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=K,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=K,function(te,oe){if(te.indexOf("$")===-1){if(te.indexOf("%")===-1)return te.indexOf("bd")!==-1?(oe.output="byte",oe.base="general"):te.indexOf("b")!==-1?(oe.output="byte",oe.base="binary"):te.indexOf("d")!==-1?(oe.output="byte",oe.base="decimal"):te.indexOf(":")===-1?te.indexOf("o")!==-1&&(oe.output="ordinal"):oe.output="time";oe.output="percent"}else oe.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,K),f=K,(g=o.match(/[1-9]+[0-9]*/))&&(f.totalLength=+g[0]),w=K,(C=o.split(".")[0].match(/0+/))&&(w.characteristic=C[0].length),function(te,oe){if(te.indexOf(".")!==-1){var ie=te.split(".")[0];oe.optionalCharacteristic=ie.indexOf("0")===-1}}(o,K),S=K,o.indexOf("a")!==-1&&(S.average=!0),_=K,(b=o).indexOf("K")!==-1?_.forceAverage="thousand":b.indexOf("M")!==-1?_.forceAverage="million":b.indexOf("B")!==-1?_.forceAverage="billion":b.indexOf("T")!==-1&&(_.forceAverage="trillion"),function(te,oe){var ie=te.split(".")[1];if(ie){var ue=ie.match(/0+/);ue&&(oe.mantissa=ue[0].length)}}(o,K),x=K,(O=o).match(/\[\.]/)?x.optionalMantissa=!0:O.match(/\./)&&(x.optionalMantissa=!1),I=K,o.indexOf(",")!==-1&&(I.thousandSeparated=!0),$=K,o.indexOf(" ")!==-1&&($.spaceSeparated=!0),q=K,(z=o).match(/^\+?\([^)]*\)$/)&&(q.negative="parenthesis"),z.match(/^\+?-/)&&(q.negative="sign"),Y=K,o.match(/^\+/)&&(Y.forceSign=!0),K)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,f=4<arguments.length?arguments[4]:void 0,g=5<arguments.length?arguments[5]:void 0,w=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===f?0:function C(S,b){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",O=3<arguments.length?arguments[3]:void 0,x=4<arguments.length?arguments[4]:void 0,I=5<arguments.length?arguments[5]:void 0,$=6<arguments.length?arguments[6]:void 0;if(!isNaN(+S))return+S;var z="",q=S.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(q!==S)return-1*C(q,b,_,O,x,I,$);for(var Y=0;Y<o.length;Y++){var K=o[Y];if((z=S.replace(K.key,""))!==S)return C(z,b,_,O,x,I,$)*K.factor}if((z=S.replace("%",""))!==S)return C(z,b,_,O,x,I,$)/100;var te=parseFloat(S);if(!isNaN(te)){var oe=O(te);if(oe&&oe!=="."&&(z=S.replace(new RegExp("".concat(s(oe),"$")),""))!==S)return C(z,b,_,O,x,I,$);var ie={};Object.keys(I).forEach(function(m){ie[I[m]]=m});for(var ue=Object.keys(ie).sort().reverse(),Re=ue.length,Ue=0;Ue<Re;Ue++){var Ie=ue[Ue],R=ie[Ie];if((z=S.replace(Ie,""))!==S){var d=void 0;switch(R){case"thousand":d=Math.pow(10,3);break;case"million":d=Math.pow(10,6);break;case"billion":d=Math.pow(10,9);break;case"trillion":d=Math.pow(10,12)}return C(z,b,_,O,x,I,$)*d}}}}(function(C,S){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=C.replace(b,"");return _=(_=_.replace(new RegExp("([0-9])".concat(s(S.thousands),"([0-9])"),"g"),"$1$2")).replace(S.decimal,".")}(l,u,c),u,c,h,f,g,w)}r.exports={unformat:function(l,u){var c,h,f,g=n("./globalState"),w=g.currentDelimiters(),C=g.currentCurrency().symbol,S=g.currentOrdinal(),b=g.getZeroFormat(),_=g.currentAbbreviations(),O=void 0;if(typeof l=="string")O=function(x,I){if(!x.indexOf(":")||I.thousands===":")return!1;var $=x.split(":");if($.length!==3)return!1;var z=+$[0],q=+$[1],Y=+$[2];return!isNaN(z)&&!isNaN(q)&&!isNaN(Y)}(l,w)?(c=l.split(":"),h=+c[0],f=+c[1],+c[2]+60*f+3600*h):a(l,w,C,S,b,_,u);else{if(typeof l!="number")return;O=l}if(O!==void 0)return O}}},{"./globalState":4}],10:[function(n,r,i){function o(w){return function(C){if(Array.isArray(C)){for(var S=0,b=new Array(C.length);S<C.length;S++)b[S]=C[S];return b}}(w)||function(C){if(Symbol.iterator in Object(C)||Object.prototype.toString.call(C)==="[object Arguments]")return Array.from(C)}(w)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(w){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C})(w)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(w,C){return C.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(w){return w.output==="byte"}},characteristic:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(w){return 0<=w},message:"value must be positive"},{restriction:function(w,C){return!C.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(w){return 0<=w},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(w,C){return C.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(w){return w.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(w){return!!a.unformat(w)}function f(w,C,S){var b=3<arguments.length&&arguments[3]!==void 0&&arguments[3],_=Object.keys(w).map(function(O){if(!C[O])return console.error("".concat(S," Invalid key: ").concat(O)),!1;var x=w[O],I=C[O];if(typeof I=="string"&&(I={type:I}),I.type==="format"){if(!f(x,u,"[Validate ".concat(O,"]"),!0))return!1}else if(s(x)!==I.type)return console.error("".concat(S," ").concat(O,' type mismatched: "').concat(I.type,'" expected, "').concat(s(x),'" provided')),!1;if(I.restrictions&&I.restrictions.length)for(var $=I.restrictions.length,z=0;z<$;z++){var q=I.restrictions[z],Y=q.restriction,K=q.message;if(!Y(x,w))return console.error("".concat(S," ").concat(O," invalid value: ").concat(K)),!1}return I.restriction&&!I.restriction(x,w)?(console.error("".concat(S," ").concat(O," invalid value: ").concat(I.message)),!1):I.validValues&&I.validValues.indexOf(x)===-1?(console.error("".concat(S," ").concat(O," invalid value: must be among ").concat(JSON.stringify(I.validValues),', "').concat(x,'" provided')),!1):!(I.children&&!f(x,I.children,"[Validate ".concat(O,"]")))});return b||_.push.apply(_,o(Object.keys(C).map(function(O){var x=C[O];if(typeof x=="string"&&(x={type:x}),x.mandatory){var I=x.mandatory;if(typeof I=="function"&&(I=I(w)),I&&w[O]===void 0)return console.error("".concat(S,' Missing mandatory key "').concat(O,'"')),!1}return!0}))),_.reduce(function(O,x){return O&&x},!0)}function g(w){return f(w,u,"[Validate format]")}r.exports={validate:function(w,C){var S=h(w),b=g(C);return S&&b},validateFormat:g,validateInput:h,validateLanguage:function(w){return f(w,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(R1);var b6=R1.exports;const as=hC(b6),R6="numeric";function Ly(t,e,n,r,i,o,s){let a=o;if(Nn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",f=h.length?h.split(" "):[];if(typeof u<"u"&&!as.languages()[u]){const g=u.replace("-",""),w=as.allLanguages?as.allLanguages[u]:as[g];w&&as.registerLanguage(w)}as.setLanguage(u),a=as(a).format(c||"0"),f.indexOf("htLeft")<0&&f.indexOf("htCenter")<0&&f.indexOf("htRight")<0&&f.indexOf("htJustify")<0&&f.push("htRight"),f.indexOf("htNumeric")<0&&f.push("htNumeric"),s.className=f.join(" "),e.dir="ltr"}co(t,e,n,r,i,a,s)}Ly.RENDERER_TYPE=R6;const E6="password";function ky(t,e,n,r,i,o,s){co.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";pe(a-1,()=>{u+=l}),Qs(e,u)}ky.RENDERER_TYPE=E6;const T6="time";function $y(t,e,n,r,i,o,s){co.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}$y.RENDERER_TYPE=T6;function _6(){li(Cl),li(pc),li(Dy),li(Hy),li(Ly),li(ky),li(co),li($y)}const M6="autocomplete";function Yf(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,jE(n,e)):jE(n,e)(this.source):e(!0)}Yf.VALIDATOR_TYPE=M6;function jE(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function E1(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const A6=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:E1},Symbol.toStringTag,{value:"Module"})),O6="date";function Fy(t,e){const n=UI(p1,this.instance);let r=t,i=!0;r==null&&(r="");let o=J(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=J(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=P6(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}Fy.VALIDATOR_TYPE=O6;function P6(t,e){const n=J(E1(t)),r=J(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const I6="numeric";function Wy(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Nn(t))}Wy.VALIDATOR_TYPE=I6;const x6=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],H6="time";function Vy(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=J(i,x6,!0).isValid()?J(i):J(i,n);let a=s.isValid(),l=J(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}Vy.VALIDATOR_TYPE=H6;function D6(){qa(Yf),qa(Fy),qa(Wy),qa(Vy)}const N6="autocomplete",L6={CELL_TYPE:N6,editor:Iy,renderer:Cl,validator:Yf},k6="checkbox",$6={CELL_TYPE:k6,editor:g1,renderer:Dy},F6="date";function T1(t,e,n,r,i,o,s){Cl.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,[fl("dialog"),sn("false")])}T1.RENDERER_TYPE=F6;const W6="date",V6={CELL_TYPE:W6,editor:w1,renderer:T1,validator:Fy},B6="dropdown",U6={CELL_TYPE:B6,editor:xy,renderer:Cl,validator:Yf},z6="handsontable";function _1(t,e,n,r,i,o,s){Cl.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,[fl("true"),sn("false")])}_1.RENDERER_TYPE=z6;const G6="handsontable",Y6={CELL_TYPE:G6,editor:Py,renderer:_1},j6="numeric",K6={CELL_TYPE:j6,editor:C1,renderer:Ly,validator:Wy,dataType:"number"},X6="password",q6={CELL_TYPE:X6,editor:v1,renderer:ky,copyable:!1},Z6="select";function M1(t,e,n,r,i,o,s){co.apply(this,[t,e,n,r,i,o,s]),t.getSettings().ariaTags&&ve(e,...fl("listbox"))}M1.RENDERER_TYPE=Z6;const Q6="select",J6={CELL_TYPE:Q6,editor:S1,renderer:M1},e9="time",t9={CELL_TYPE:e9,editor:y1,renderer:$y,validator:Vy};function n9(){fr(L6),fr($6),fr(V6),fr(U6),fr(Y6),fr(K6),fr(q6),fr(J6),fr(f1),fr(t9)}function r9(t,e){A1(t,e),e.add(t)}function i9(t,e,n){A1(t,e),e.set(t,n)}function A1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ga(t,e,n){return e=o9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o9(t){var e=s9(t,"string");return typeof e=="symbol"?e:String(e)}function s9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function a9(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ma(t,e){var n=l9(t,e,"get");return u9(t,n)}function l9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function u9(t,e){return e.get?e.get.call(t):e.value}const KE=new Map([["plugin",JG],["cell-type",r1],["editor",BI],["renderer",JI],["validator",ex]]),c9="base",Rm=[];let ei=null;var ls=new WeakMap,XE=new WeakSet;class nt{static get PLUGIN_KEY(){return c9}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){r9(this,XE),ga(this,"eventManager",new ar(this)),ga(this,"pluginName",null),ga(this,"pluginsInitializedCallbacks",[]),ga(this,"isPluginsReady",!1),ga(this,"enabled",!1),ga(this,"initialized",!1),i9(this,ls,{writable:!0,value:{}}),Si(this,"hot",e,{writable:!1}),ei=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!KE.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);KE.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Rm.push(o)}}if(ei||(ei=pv()),ei.indexOf("UndoRedo")>=0&&ei.splice(ei.indexOf("UndoRedo"),1),ei.indexOf(this.pluginName)>=0&&ei.splice(ei.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ei.length===0){if(Rm.length>0){const i=[`${Rm.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){ma(this,ls)[e]=ma(this,ls)[e]||[];const r=ma(this,ls)[e];this.hot.addHook(e,n),r.push(n),ma(this,ls)[e]=r}removeHooks(e){T(ma(this,ls)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=ma(this,ls);Be(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){T(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=a9(this,XE,h9).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Be(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function h9(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function us(t,e,n){return e=d9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d9(t){var e=f9(t,"string");return typeof e=="symbol"?e:String(e)}function f9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let g9=class{constructor(e){us(this,"hot",null),us(this,"container",null),us(this,"injected",!1),us(this,"rows",[]),us(this,"columns",[]),us(this,"samples",null),us(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),T(this.rows,n=>{e(n.row,Ot(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),T(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{T(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{T(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{T(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),T(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{T(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),ee(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return ee(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const By=g9;function sh(t,e,n){return e=m9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m9(t){var e=p9(t,"string");return typeof e=="symbol"?e:String(e)}function p9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uy{static get SAMPLE_COUNT(){return 3}constructor(e){sh(this,"samples",null),sh(this,"dataFactory",null),sh(this,"customSampleCount",null),sh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Uy.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return pe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return pe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let f;h?f=c:$e(u)?f=`${Object.keys(u).length}`:Array.isArray(u)?f=`${u.length}`:f=`${Nt(u).length}`,i.has(f)||i.set(f,{needed:this.getSampleCount(),strings:[]});const g=i.get(f);g.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(g.strings.push({value:u,[o]:a}),s.push(u),g.needed-=1)}),i}}const O1=Uy;function pa(t,e){P1(t,e),e.add(t)}function w9(t,e,n){P1(t,e),e.set(t,n)}function P1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wa(t,e,n){return e=C9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C9(t){var e=v9(t,"string");return typeof e=="symbol"?e:String(e)}function v9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function S9(t,e,n){var r=I1(t,e,"set");return y9(t,r,n),n}function y9(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ah(t,e){var n=I1(t,e,"get");return b9(t,n)}function I1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b9(t,e){return e.get?e.get.call(t):e.value}function cs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("modifyAutoColumnSizeSeed");const kl="autoColumnSize",R9=10,E9="autoColumnSize";var za=new WeakMap,qE=new WeakSet,ZE=new WeakSet,QE=new WeakSet,Em=new WeakSet,JE=new WeakSet,e0=new WeakSet;class Ru extends nt{static get PLUGIN_KEY(){return kl}static get PLUGIN_PRIORITY(){return R9}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),pa(this,e0),pa(this,JE),pa(this,Em),pa(this,QE),pa(this,ZE),pa(this,qE),wa(this,"ghostTable",new By(this.hot)),wa(this,"samplesGenerator",new O1((n,r)=>{const i=this.hot.getCellMeta(n,r);let o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),wa(this,"firstCalculation",!0),wa(this,"inProgress",!1),wa(this,"measuredColumns",0),wa(this,"columnWidthsMap",new Xo),w9(this,za,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(E9,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>cs(this,Em,t0).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[kl]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[kl];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return cs(e,ZE,_9).call(e,...i)}),this.addHook("beforeChangeRender",r=>cs(this,QE,M9).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>cs(this,e0,O9).call(this,r)),this.addHook("beforeViewRender",r=>cs(this,qE,T9).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>cs(this,JE,A9).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>cs(this,Em,t0).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;pe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);T(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Uu(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+Ru.CALCULATION_STEP,r)},e),n=n+Ru.CALCULATION_STEP+1,n<r?i=kf(o):(Uu(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[kl],n=e&&At(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&At(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[kl];let n=Ru.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return $e(e)&&(n=e.syncLimit,ZC(n)?n=gv(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,vv.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Ft(e,(r,i,o)=>{const s=ah(this,za).length;return(s-1<o||ah(this,za)[o]!==i)&&r.push(o),s-1<o?ah(this,za).push(i):ah(this,za)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{T(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!sr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function T9(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function _9(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function M9(t){const e=Ve(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function t0(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function A9(){S9(this,za,this.hot.getColHeader())}function O9(t){const e=sr(t,r=>{var i;return le((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ve(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const Ns={horizontal:"horizontal",vertical:"vertical"};function P9(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function I9(t){const e={};return t===!0?(e.directions=Object.keys(Ns),e.autoInsertRow=!0):$e(t)?(le(t.autoInsertRow)?t.direction===Ns.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,le(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ns)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function $l(t,e){x9(t,e),e.add(t)}function x9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ca(t,e,n){return e=H9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H9(t){var e=D9(t,"string");return typeof e=="symbol"?e:String(e)}function D9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("modifyAutofillRange");fe.getSingleton().register("beforeAutofill");fe.getSingleton().register("afterAutofill");const n0="autofill",N9=20,L9=["fillHandle"],k9="insert_row_below",$9=200;var r0=new WeakSet,i0=new WeakSet,o0=new WeakSet,s0=new WeakSet,a0=new WeakSet;class F9 extends nt{constructor(){super(...arguments),$l(this,a0),$l(this,s0),$l(this,o0),$l(this,i0),$l(this,r0),Ca(this,"addingStarted",!1),Ca(this,"mouseDownOnCellCorner",!1),Ca(this,"mouseDragOutside",!1),Ca(this,"handleDraggedCells",0),Ca(this,"directions",[]),Ca(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return n0}static get PLUGIN_PRIORITY(){return N9}static get SETTING_KEYS(){return[n0,...L9]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Fl(this,i0,V9).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Fl(this,r0,W9).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Fl(this,o0,B9).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return T(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),T(a,c=>{const h=[];T(l,f=>{h.push(this.hot.getCopyableData(c,f))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:f}=P9(l,u,(g,w)=>this.hot._createCellCoords(g,w));if(h&&h.row>-1&&h.col>-1){const g=this.getSelectionData(),w=o.clone(),C=this.hot._createCellRange(h,h,f),S=this.hot.runHooks("beforeAutofill",g,w,C,c);if(S===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=S;const _=S;if(["up","left"].indexOf(c)>-1&&!(_.length===1&&_[0].length===0))if(b=[],c==="up"){const O=f.row-h.row+1,x=O%_.length;for(let I=0;I<O;I++)b.push(_[(I+(_.length-x))%_.length])}else{const O=f.col-h.col+1,x=O%_[0].length;for(let I=0;I<_.length;I++){b.push([]);for(let $=0;$<O;$++)b[I].push(_[I][($+(_[I].length-x))%_[I].length])}}this.hot.populateFromArray(h.row,h.col,b,f.row,f.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",b,w,C,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(Ns.vertical)&&this.directions.includes(Ns.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(Ns.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(Ns.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(k9,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},$9)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ve(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=Bt(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Ot(this.hot.table),i=Bt(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ut(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Fl(this,s0,U9).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Fl(this,a0,z9).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=I9(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function W9(){this.selectAdjacent()&&this.fillIn()}function V9(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function B9(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function U9(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function z9(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function lh(t,e){G9(t,e),e.add(t)}function G9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hs(t,e,n){return e=Y9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y9(t){var e=j9(t,"string");return typeof e=="symbol"?e:String(e)}function j9(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const uh="autoRowSize",K9=40,X9="autoRowSize";var l0=new WeakSet,Tm=new WeakSet,u0=new WeakSet,c0=new WeakSet;class Eu extends nt{static get PLUGIN_KEY(){return uh}static get PLUGIN_PRIORITY(){return K9}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),lh(this,c0),lh(this,u0),lh(this,Tm),lh(this,l0),hs(this,"headerHeight",null),hs(this,"ghostTable",new By(this.hot)),hs(this,"samplesGenerator",new O1((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),hs(this,"firstCalculation",!0),hs(this,"inProgress",!1),hs(this,"measuredRows",0),hs(this,"rowHeightsMap",new Xo),this.hot.rowIndexMapper.registerMap(X9,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Wl(this,Tm,h0).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[uh];return e===!0||$e(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Wl(e,u0,Z9).call(e,...r)}),this.addHook("beforeChangeRender",n=>Wl(this,c0,Q9).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Wl(this,l0,q9).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Wl(this,Tm,h0).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}pe(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);T(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Uu(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+Eu.CALCULATION_STEP,r)},e),n=n+Eu.CALCULATION_STEP+1,n<r?i=kf(o):(Uu(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[uh],n=e&&At(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&At(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){Uo(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[uh];let n=Eu.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return $e(e)&&(n=e.syncLimit,ZC(n)?n=gv(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{pe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!sr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function q9(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function h0(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function Z9(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function Q9(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:J9,getListWithRemovedItems:e8}=Nx("physicallyIndexed");class t8 extends Js{constructor(){super(e=>e)}insert(e,n){const r=Gv(this.indexedValues,n);this.indexedValues=J9(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=e8(this.indexedValues,e);this.indexedValues=zv(n,e),super.remove(e)}}const n8=t8,{getListWithInsertedItems:r8,getListWithRemovedItems:i8}=Nx("physicallyIndexed");class o8 extends Js{constructor(){super(e=>e)}insert(e,n){this.indexedValues=r8(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=i8(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const s8=o8;function a8(t,e){l8(t,e),e.add(t)}function l8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u8(t,e,n){return e=c8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c8(t){var e=h8(t,"string");return typeof e=="symbol"?e:String(e)}function h8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const _m="bindRowsWithHeaders",f8=210,g8="loose",m8=new Map([["loose",n8],["strict",s8]]);var d0=new WeakSet;class p8 extends nt{constructor(){super(...arguments),a8(this,d0),u8(this,"headerIndexes",null)}static get PLUGIN_KEY(){return _m}static get PLUGIN_PRIORITY(){return f8}isEnabled(){return!!this.hot.getSettings()[_m]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[_m];typeof e!="string"&&(e=g8);const n=m8.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>d8(this,d0,w8).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function w8(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function ch(t,e){x1(t,e),e.add(t)}function C8(t,e,n){x1(t,e),e.set(t,n)}function x1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f0(t,e,n){return e=v8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v8(t){var e=S8(t,"string");return typeof e=="symbol"?e:String(e)}function S8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function g0(t,e){var n=H1(t,e,"get");return y8(t,n)}function y8(t,e){return e.get?e.get.call(t):e.value}function hh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Mm(t,e,n){var r=H1(t,e,"set");return b8(t,r,n),n}function H1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function b8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const id="collapsibleColumns",R8=290,E8=["nestedHeaders"],nl="collapsibleIndicator",m0=id,p0=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var va=new WeakMap,w0=new WeakSet,C0=new WeakSet,v0=new WeakSet,S0=new WeakSet;class T8 extends nt{constructor(){super(...arguments),ch(this,S0),ch(this,v0),ch(this,C0),ch(this,w0),f0(this,"nestedHeadersPlugin",null),f0(this,"headerStateManager",null),C8(this,va,{writable:!0,value:null})}static get PLUGIN_KEY(){return id}static get PLUGIN_PRIORITY(){return R8}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[id,...E8]}isEnabled(){return!!this.hot.getSettings()[id]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||pt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Mm(this,va,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>hh(this,v0,A8).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hh(e,S0,O8).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hh(e,w0,_8).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>hh(this,C0,M8).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Mm(this,va,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:m0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(m0)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};pe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;pe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${nl}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${nl}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${nl}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!p0.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=sr(e,f=>{let{row:g}=f;return g<0});let i=r.length>0;T(r,f=>{var g;let{row:w,col:C}=f;const{collapsible:S,isCollapsed:b}=(g=this.headerStateManager.getHeaderSettings(w,C))!==null&&g!==void 0?g:{};if(!S||b&&n==="collapse"||!b&&n==="expand")return i=!1,!1});const o=[],s=[];i&&T(r,f=>{let{row:g,col:w}=f;const{colspanCompensation:C,affectedColumns:S,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,g,w);C>0&&(s.push(...S),o.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=XC([...a,...s]):n==="expand"&&(l=sr(a,f=>!s.includes(f)));const u=p0.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){T(o,f=>{f()});return}this.hot.batchExecution(()=>{T(s,f=>{g0(this,va).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return g0(this,va).getHiddenIndexes()}destroy(){Mm(this,va,null),super.destroy()}}function _8(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${nl}`);if(Ko(e,[sn("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ee(u,nl),e.querySelector("div:first-child").appendChild(u)),De(u,["collapsed","expanded"]),s?(ee(u,"collapsed"),Bo(u,"+"),l&&ve(e,[sn(!1),$u(this.hot.getTranslatedPhrase(my))])):(ee(u,"expanded"),Bo(u,"-"),l&&ve(e,[sn(!0),$u(this.hot.getTranslatedPhrase(py))])),l&&ve(u,...so());else{var c;(c=u)===null||c===void 0||c.remove()}}function M8(t,e){Pe(t.target,nl)&&(Pe(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Pe(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Rr(t))}function A8(){this.updatePlugin()}function O8(t,e){e||this.updatePlugin()}function ds(t,e,n){return e=P8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P8(t){var e=I8(t,"string");return typeof e=="symbol"?e:String(e)}function I8(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const x8=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],H8=!1,D8=!0,N8=!0;class L8{constructor(e,n){ds(this,"hot",void 0),ds(this,"sortingStates",new Wf),ds(this,"sortEmptyCells",H8),ds(this,"indicator",D8),ds(this,"headerAction",N8),ds(this,"compareFunctionFactory",void 0),ds(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){$e(e)&&Be(e,(n,r)=>{x8.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return $e(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(le(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const Bd="asc",Ud="desc",k8="colHeader";function $8(t){if($e(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[Bd,Ud].includes(n)}function F8(t){if(t.some(n=>$8(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function y0(t){if(t!==Ud)return t===Bd?Ud:Bd}function D1(t){return t.querySelector(`.${k8}`)}function N1(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function zy(t,e,n){return t===-1&&e>=0&&zo(n)===!1}const W8="ascending",V8="descending",L1="indicatorDisabled",k1="columnSorting",$1="sortAction",F1=new Map([[Bd,W8],[Ud,V8]]);function B8(t,e,n,r){const i=[k1];if(r&&i.push($1),n===!1)return i.push(L1),i;const o=t.getSortOrderOfColumn(e);return le(o)&&i.push(F1.get(o)),i}function U8(){return Array.from(F1.values()).concat($1,L1,k1)}function W1(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?gi:Xt(i)?Xt(o)?gi:s&&t==="asc"?Ht:Dt:Xt(o)?s&&t==="asc"?Dt:Ht:isNaN(i)&&!isNaN(o)?t==="asc"?Dt:Ht:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?Ht:Dt:i>o?t==="asc"?Dt:Ht:gi}}const V1="default";function z8(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return gi;if(a){if(Xt(r))return t==="asc"?Ht:Dt;if(Xt(i))return t==="asc"?Dt:Ht}return isNaN(o)?Dt:isNaN(s)?Ht:o<s?t==="asc"?Ht:Dt:o>s?t==="asc"?Dt:Ht:gi}}const G8="numeric";function Y8(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Xt(s),u=Xt(a),c=l?i:s,h=u?i:a,f=c===i||c===r,g=h===i||h===r;if(o===!1){if(l&&u===!1)return Dt;if(l===!1&&u)return Ht}return f===!1&&g?t==="asc"?Ht:Dt:f&&g===!1?t==="asc"?Dt:Ht:f===!1&&g===!1?W1(t,e,n)(s,a):c===i&&h===r?t==="asc"?Ht:Dt:c===r&&h===i?t==="asc"?Dt:Ht:gi}}const j8="checkbox";function K8(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return gi;if(Xt(r))return Xt(i)?gi:o&&t==="asc"?Ht:Dt;if(Xt(i))return o&&t==="asc"?Dt:Ht;const s=e.dateFormat,a=J(r,s),l=J(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?Ht:Dt:l.isBefore(a)?t==="asc"?Dt:Ht:gi:Ht:Dt}}const X8="date",{register:jf,getItem:b0,hasItem:q8}=jr("sorting.compareFunctionFactory"),{register:B1,getItem:Z8}=jr("sorting.mainSortComparator");function U1(t){return q8(t)?b0(t):b0(V1)}jf(G8,z8);jf(j8,Y8);jf(X8,K8);jf(V1,W1);const gi=0,Ht=-1,Dt=1;function Q8(t,e){const n=Z8(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function J8(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.columnSorting;return(f.compareFunctionFactory?f.compareFunctionFactory:U1(u.type))(l,u,f)(c,h)}(0)}}function dh(t,e){e7(t,e),e.add(t)}function e7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fh(t,e,n){return e=t7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t7(t){var e=n7(t,"string");return typeof e=="symbol"?e:String(e)}function n7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ga(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const zd="columnSorting",r7=50,Gd="append",i7="replace",R0=zd,E0="columnSortingIndicator";B1(zd,J8);fe.getSingleton().register("beforeColumnSort");fe.getSingleton().register("afterColumnSort");var od=new WeakSet,T0=new WeakSet,_0=new WeakSet,M0=new WeakSet;class z1 extends nt{constructor(){super(...arguments),dh(this,M0),dh(this,_0),dh(this,T0),dh(this,od),fh(this,"columnStatesManager",null),fh(this,"columnMetaCache",null),fh(this,"pluginKey",zd),fh(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return zd}static get PLUGIN_PRIORITY(){return r7}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new L8(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Xo(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Ga(this,T0,o7).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ga(e,M0,a7).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Ga(this,od,Bw).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Ga(e,_0,s7).call(e,...r)}),this.hot.view&&Ga(this,od,Bw).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=D1(r);N1(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:R0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(R0)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Lx),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return le(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return F8(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ve(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return le(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ve(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(le(n)){const i=y0(n);return le(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:y0()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Gd;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(mt(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Gd)return[...o.slice(0,r),...o.slice(r+1),s];if(n===i7)return[...o.slice(0,r),s,...o.slice(r+1)]}return le(s)?o.concat(s):o}getPluginColumnConfig(e){if($e(e)){const n=e[this.pluginKey];if($e(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):gt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ve(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ve(n,u=>u[0]);Q8(n,this.pluginKey,Ve(e,u=>u.sortOrder),Ve(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ve(n,u=>u[0]),a=new Map(Ve(o,(u,c)=>[u,s[c]])),l=Ve(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if($e(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||$e(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(De(e,U8()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];ee(e,B8(...r))}}updateSortingIndicator(e,n){const r=this.getFirstCellSettings(e)[this.pluginKey],i=this.hot.getSettings().ariaTags,o=r.indicator,s=this.columnStatesManager.isColumnSorted(e),a=n.querySelector(`.${E0}`);o&&s&&!a&&Bs(n,{tagName:"div",className:E0,attributes:i?[so()]:[]})}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),le(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&e.target.nodeName==="SPAN"}onAfterOnCellMouseDown(e,n){zy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function Bw(){const t=this.getAllSavedSortSettings();if($e(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function o7(t,e){const n=D1(e);if(N1(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=this.hot.getSettings().ariaTags,o=r.indicator,s=r.headerAction,a=this.columnStatesManager.getSortOrderOfColumn(t);this.updateHeaderClasses(n,this.columnStatesManager,t,o,s),this.updateSortingIndicator(t,n),i&&ve(e,[Rz(a?`${a}ending`:"none"),$u(this.hot.getTranslatedPhrase(wy))])}function s7(t){t===!0&&this.hot.view&&Ga(this,od,Bw).call(this)}function a7(t,e,n,r){zy(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function fs(t,e,n){return e=l7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l7(t){var e=u7(t,"string");return typeof e=="symbol"?e:String(e)}function u7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c7{constructor(e,n){fs(this,"plugin",void 0),fs(this,"hot",void 0),fs(this,"endpoints",[]),fs(this,"settings",void 0),fs(this,"settingsType","array"),fs(this,"currentEndpoint",null),fs(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),T(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();T(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const f=()=>(this.hot.removeHook("beforeViewRender",f),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",f);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;T(u,f=>{a==="row"&&f.destinationRow>=h&&(f.alterRowOffset=l*r),a==="col"&&f.destinationColumn>=h&&(f.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?T(u,f=>{this.extendEndpointRanges(f,h,i[0],i.length),this.recreatePhysicalRanges(f),this.clearOffsetInformation(f)}):T(u,f=>{this.shiftEndpointCoordinates(f,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){T(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];T(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),T(i,o=>{let s=[];T(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,T(e.ranges,r=>{T(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],T(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],T(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],T(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&T(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),T(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){pt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const h7=c7;function Am(t){return t==null||isNaN(t)}function Om(t,e){d7(t,e),e.add(t)}function d7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function f7(t,e,n){return e=g7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g7(t){var e=m7(t,"string");return typeof e=="symbol"?e:String(e)}function m7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Im="columnSummary",p7=220;var A0=new WeakSet,O0=new WeakSet,P0=new WeakSet;class w7 extends nt{constructor(){super(...arguments),Om(this,P0),Om(this,O0),Om(this,A0),f7(this,"endpoints",null)}static get PLUGIN_KEY(){return Im}static get PLUGIN_PRIORITY(){return p7}isEnabled(){return!!this.hot.getSettings()[Im]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[Im],this.endpoints=new h7(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pm(e,A0,C7).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pm(e,O0,v7).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Pm(e,P0,S7).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Be(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Am(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Be(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Am(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Am(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Be(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ct`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function C7(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function v7(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function S7(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Sa(t,e,n){return e=y7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y7(t){var e=b7(t,"string");return typeof e=="symbol"?e:String(e)}function b7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qa{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Sa(this,"rootDocument",void 0),Sa(this,"isRtl",!1),Sa(this,"container",null),Sa(this,"editor",void 0),Sa(this,"editorStyle",void 0),Sa(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ut(this.getInputElement()),height:Ot(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),ee(this.container,Qa.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),ee(e,Qa.CLASS_EDITOR),ee(n,Qa.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Qa.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const R7=Qa;function xm(t,e,n){return e=E7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E7(t){var e=T7(t,"string");return typeof e=="symbol"?e:String(e)}function T7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _7=250,M7=250;class G1{constructor(e){xm(this,"wasLastActionShow",!0),xm(this,"showDebounced",null),xm(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},M7)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_7;this.showDebounced=sv(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}dt(G1,Qn);const A7=G1;function O7(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function P7(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function gs(t,e){const n={};return T(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function To(t,e,n,r,i){T(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&I7(s,a,e,n,r,i)})})}function I7(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=O7(s.className,r):a=P7(s.className,r)),o(t,e,"className",a)}function Wi(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function ci(t,e){let n=!1;return Array.isArray(t)&&T(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function Kf(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Ge="---------";function x7(){return{name:Ge}}const pr="alignment";function H7(){return{key:pr,name(){return this.getTranslatedPhrase(wS)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${pr}:left`,name(){let t=this.getTranslatedPhrase(CS);return ci(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pr}:center`,name(){let t=this.getTranslatedPhrase(vS);return ci(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pr}:right`,name(){let t=this.getTranslatedPhrase(SS);return ci(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pr}:justify`,name(){let t=this.getTranslatedPhrase(yS);return ci(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Ge},{key:`${pr}:top`,name(){let t=this.getTranslatedPhrase(bS);return ci(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pr}:middle`,name(){let t=this.getTranslatedPhrase(RS);return ci(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${pr}:bottom`,name(){let t=this.getTranslatedPhrase(ES);return ci(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),To(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Xf="clear_column";function D7(){return{key:Xf,name(){return this.getTranslatedPhrase(rS)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const wc="col_left";function N7(){return{key:wc,name(){return this.getTranslatedPhrase(qv)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Cc="col_right";function L7(){return{key:Cc,name(){return this.getTranslatedPhrase(Zv)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const vc="make_read_only";function k7(){return{key:vc,name(){let t=this.getTranslatedPhrase(nS);return ci(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=Wi(t)),t},callback(){const t=this.getSelectedRange(),e=ci(t,(n,r)=>this.getCellMeta(n,r).readOnly);T(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const qf="redo";function $7(){return{key:qf,name(){return this.getTranslatedPhrase(tS)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Sc="remove_col";function F7(){return{key:Sc,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Jv,e)},callback(){this.alter("remove_col",jX(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Zf="remove_row";function W7(){return{key:Zf,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(Qv,e)},callback(){this.alter("remove_row",KX(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Qf="row_above";function V7(){return{key:Qf,name(){return this.getTranslatedPhrase(Kv)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Jf="row_below";function B7(){return{key:Jf,name(){return this.getTranslatedPhrase(Xv)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Yu="no_items";function U7(){return{key:Yu,name(){return this.getTranslatedPhrase(jv)},disabled:!0,isCommand:!1}}const eg="undo";function z7(){return{key:eg,name(){return this.getTranslatedPhrase(eS)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const G7=[Qf,Jf,wc,Cc,Xf,Zf,Sc,eg,qf,vc,pr,Ge,Yu],Y7={[Ge]:x7,[Yu]:U7,[Qf]:V7,[Jf]:B7,[wc]:N7,[Cc]:L7,[Xf]:D7,[Zf]:W7,[Sc]:F7,[eg]:z7,[qf]:$7,[vc]:k7,[pr]:H7};function Y1(){const t={};return Be(Y7,(e,n)=>{t[n]=e()}),t}function j7(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(gS):this.getTranslatedPhrase(fS)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function K7(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(mS)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function X7(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(pS);return ci(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,sd))?Wi(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,sd);t.updateCommentMeta(n,r,{[sd]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function ti(t,e){j1(t,e),e.add(t)}function ms(t,e,n){j1(t,e),e.set(t,n)}function j1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function q7(t,e,n){return e=Z7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z7(t){var e=Q7(t,"string");return typeof e=="symbol"?e:String(e)}function Q7(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ni(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ji(t,e,n){var r=K1(t,e,"set");return J7(t,r,n),n}function J7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function qe(t,e){var n=K1(t,e,"get");return e5(t,n)}function K1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function e5(t,e){return e.get?e.get.call(t):e.value}const Tu="comments",t5=60,Vi="comment",du="value",X1="style",sd="readOnly",gh=Tu,Uw=`plugin:${Tu}`;var St=new WeakMap,Dr=new WeakMap,tg=new WeakMap,ad=new WeakMap,Yd=new WeakMap,zw=new WeakMap,jd=new WeakMap,I0=new WeakSet,x0=new WeakSet,H0=new WeakSet,D0=new WeakSet,N0=new WeakSet,L0=new WeakSet,k0=new WeakSet,$0=new WeakSet,F0=new WeakSet,W0=new WeakSet;class n5 extends nt{constructor(){super(...arguments),ti(this,W0),ti(this,F0),ti(this,$0),ti(this,k0),ti(this,L0),ti(this,N0),ti(this,D0),ti(this,H0),ti(this,x0),ti(this,I0),q7(this,"range",{}),ms(this,St,{writable:!0,value:null}),ms(this,Dr,{writable:!0,value:null}),ms(this,tg,{writable:!0,value:!1}),ms(this,ad,{writable:!0,value:!1}),ms(this,Yd,{writable:!0,value:{}}),ms(this,zw,{writable:!0,value:null}),ms(this,jd,{writable:!0,value:""})}static get PLUGIN_KEY(){return Tu}static get PLUGIN_PRIORITY(){return t5}isEnabled(){return!!this.hot.getSettings()[Tu]}enablePlugin(){this.enabled||(qe(this,St)||ji(this,St,new R7(this.hot.rootDocument,this.hot.isRtl())),qe(this,Dr)||ji(this,Dr,new A7(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>ni(this,D0,s5).call(this,e,s)),this.addHook("afterScroll",()=>ni(this,W0,d5).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>ni(this,F0,h5).call(this,e)),qe(this,Dr).addLocalHook("hide",()=>this.hide()),qe(this,Dr).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){qe(this,Dr).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(Uw);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();ji(this,ad,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(Uw),this.hot._registerTimeout(()=>{ji(this,ad,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!qe(this,St).isVisible()},group:gh}),r.addShortcut({keys:[["Escape"]],callback:()=>{qe(this,St).setValue(qe(this,jd)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&qe(this,St).isVisible()},group:gh}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&qe(this,St).isVisible()},group:gh})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gh)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>ni(this,x0,i5).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>ni(this,I0,r5).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>ni(this,H0,o5).call(this)),this.eventManager.addEventListener(n,"focus",()=>ni(this,L0,l5).call(this)),this.eventManager.addEventListener(n,"blur",()=>ni(this,N0,a5).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>ni(this,k0,u5).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>ni(this,$0,c5).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Vo(e.target,"TD","TBODY");return!!(n&&Pe(n,"htCommentCell")&&Vo(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=qe(this,St).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[du]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Vi),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,du)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,du)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return qe(this,Dr).cancelHiding(),qe(this,St).setValue((e=i[Vi]?i[Vi][du]:null)!==null&&e!==void 0?e:""),qe(this,St).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){qe(this,St).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!qe(this,St).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;qe(this,St).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,f=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:g,view:{_wt:w}}=this.hot,{wtTable:C}=w,S=w.getCell({row:l,col:u},!0),b=this.getCommentMeta(s,a,X1);b?qe(this,St).setSize(b.width,b.height):qe(this,St).resetSize();const _=f?0:C.getStretchedColumnWidth(u),O=c&&!h?Ot(S):0,{left:x,top:I,width:$,height:z}=S.getBoundingClientRect(),{width:q,height:Y}=qe(this,St).getSize(),{innerWidth:K,innerHeight:te}=this.hot.rootWindow,oe=this.hot.rootDocument.documentElement;let ie=x+g.scrollX+_,ue=I+g.scrollY+O;this.hot.isRtl()&&(ie-=q+_),this.hot.isLtr()&&x+$+q>K?ie=x+g.scrollX-q-1:this.hot.isRtl()&&ie<-(oe.scrollWidth-oe.clientWidth)&&(ie=x+g.scrollX+_+1),I+Y>te&&(ue-=Y-z+1),qe(this,St).setPosition(ie,ue),qe(this,St).setReadOnlyState(this.getCommentMeta(s,a,sd))}focusEditor(){qe(this,St).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[Vi];let o;i?(o=bn(i),cc(o,r)):o=r,this.hot.setCellMeta(e,n,Vi,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[Vi])return i[Vi][r]}addToContextMenu(e){e.items.push({name:Ge},j7(this),K7(this),X7(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[Tu];if($e(e))return e.displayDelay}getEditorInputElement(){return qe(this,St).getInputElement()}destroy(){qe(this,St)&&qe(this,St).destroy(),qe(this,Dr)&&qe(this,Dr).destroy(),super.destroy()}}function r5(t){if(!(!this.hot.view||!this.hot.view._wt)&&!qe(this,tg)&&!this.targetIsCommentTextArea(t)){const e=Vo(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function i5(t){const{rootDocument:e}=this.hot;if(!(qe(this,tg)||qe(this,St).isFocused()||Pe(t.target,"wtBorder")||qe(this,zw)===t.target||!qe(this,St)))if(ji(this,zw,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));qe(this,Dr).show(n)}else No(t.target,e)&&!this.targetIsCommentTextArea(t)&&qe(this,Dr).hide()}function o5(){ji(this,tg,!1)}function s5(t,e){e[Vi]&&e[Vi][du]&&ee(t,e.commentedCellClassName)}function a5(){ji(this,jd,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function l5(){ji(this,jd,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Uw)}function u5(t){ji(this,Yd,{width:ut(t.target),height:Ot(t.target)})}function c5(t){const e=ut(t.target),n=Ot(t.target);(e!==qe(this,Yd).width+1||n!==qe(this,Yd).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[X1]:{width:e,height:n}})}function h5(t){qe(this,St).isVisible()&&Rr(t)}function d5(){qe(this,ad)||this.hide()}var V0=IO,f5=TypeError,g5=function(t,e){if(!delete t[e])throw f5("Cannot delete property "+V0(e)+" of "+V0(t))},m5=Xs,p5=df,w5=gf,C5=KO,v5=g5,S5=XO,y5=[].unshift(0)!==1,b5=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},R5=y5||!b5();m5({target:"Array",proto:!0,arity:1,forced:R5},{unshift:function(e){var n=p5(this),r=w5(n),i=arguments.length;if(i){S5(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:v5(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return C5(n,r+i)}});function Hm(t,e,n){return e=E5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E5(t){var e=T5(t,"string");return typeof e=="symbol"?e:String(e)}function T5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q1{constructor(e){Hm(this,"hot",void 0),Hm(this,"commands",{}),Hm(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=_5(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||At(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),T(u,c=>c.apply(this.hot,r))}}function _5(t,e){let n;return T(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Dm(t,e,n){return e=M5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M5(t){var e=A5(t,"string");return typeof e=="symbol"?e:String(e)}function A5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z1{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Dm(this,"hot",void 0),Dm(this,"predefinedItems",Y1()),Dm(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Be(e,(r,i)=>{let o="";r.name===Ge?(n[Ge]=r,o=Ge):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return O5(e,this.defaultOrderPattern,this.predefinedItems)}}function O5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),$e(i)?Be(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),$e(o)?Ut(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):T(i,(o,s)=>{let a=n[o];!a&&G7.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),$e(o)&&Ut(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function po(t,e,n){return e=P5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P5(t){var e=I5(t,"string");return typeof e=="symbol"?e:String(e)}function I5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x5{constructor(e,n){po(this,"top",void 0),po(this,"topRelative",void 0),po(this,"left",void 0),po(this,"leftRelative",void 0),po(this,"scrollTop",void 0),po(this,"scrollLeft",void 0),po(this,"cellHeight",void 0),po(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Vl(t,e,n){H5(t,e),e.set(t,n)}function H5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){var n=Q1(t,e,"get");return D5(t,n)}function D5(t,e){return e.get?e.get.call(t):e.value}function mh(t,e,n){var r=Q1(t,e,"set");return N5(t,r,n),n}function Q1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function N5(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var On=new WeakMap,wo=new WeakMap,cn=new WeakMap,Nm=new WeakMap,ya=new WeakMap;class L5{constructor(e){Vl(this,On,{writable:!0,value:void 0}),Vl(this,wo,{writable:!0,value:void 0}),Vl(this,cn,{writable:!0,value:void 0}),Vl(this,Nm,{writable:!0,value:!1}),Vl(this,ya,{writable:!0,value:{above:0,below:0,left:0,right:0}}),mh(this,Nm,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ke(this,ya)[e]=n,this}setElement(e){return mh(this,On,e),this}setParentElement(e){return mh(this,wo,e),this}updatePosition(e){mh(this,cn,new x5(e,Ke(this,On).ownerDocument.defaultView)),Ke(this,Nm)?(Ke(this,cn).fitsBelow(Ke(this,On))?this.setPositionBelowCursor():Ke(this,cn).fitsAbove(Ke(this,On))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ke(this,On).dir==="rtl"?Ke(this,cn).fitsOnLeft(Ke(this,On))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ke(this,cn).fitsOnRight(Ke(this,On))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ke(this,ya).above+Ke(this,cn).top-Ke(this,On).offsetHeight;Ke(this,wo)&&(e=Ke(this,cn).top+Ke(this,cn).cellHeight-Ke(this,On).offsetHeight+3),Ke(this,On).style.top=`${e}px`}setPositionBelowCursor(){let e=Ke(this,ya).below+Ke(this,cn).top+1;Ke(this,wo)&&(e=Ke(this,cn).top-1),Ke(this,On).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ke(this,cn).left;if(Ke(this,wo)){const{right:n}=Ke(this,wo).getBoundingClientRect();e+=Ke(this,cn).cellWidth+n-(Ke(this,cn).left+Ke(this,cn).cellWidth)}else e+=Ke(this,ya).right;Ke(this,On).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ke(this,ya).left+Ke(this,cn).left-Ke(this,On).offsetWidth;if(Ke(this,wo)){const{left:n}=Ke(this,wo).getBoundingClientRect();e-=Ke(this,cn).left-n}Ke(this,On).style.left=`${e}px`}}function J1(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=qn(e,-1,w()-1);function a(S,b){const _=w()-1;return S<0&&(S=_),S>_&&(S=0),o.has(S)?-1:(o.add(S),r(S,!1)===!1&&(S=a(b===1?++S:--S,b)),S)}function l(S){S>-1&&S<w()&&r(S,!0)!==!1&&(s=S)}function u(){return s}function c(){w()>0&&(o.clear(),s=a(0,1))}function h(){w()>0&&(o.clear(),s=a(w()-1,-1))}function f(){w()>0&&(o.clear(),s=a(++s,1))}function g(){w()>0&&(o.clear(),s=a(--s,-1))}function w(){return Math.max(n(),0)}function C(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:f,toPreviousItem:g,getSize:w,clear:C}}function k5(t){return Ve(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function ld(t){return At(t,"submenu")}function Gw(t){return new RegExp(Ge,"i").test(t.name)}function ud(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function B0(t){return At(t,"disableSelection")}function $5(t){return Pe(t,"htSeparator")}function F5(t){return Pe(t,"htSubmenu")}function W5(t){return Pe(t,"htDisabled")}function V5(t){return Pe(t,"htSelectionDisabled")}function B5(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function eH(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function U5(t,e){let n=t.slice(0);return n.reverse(),n=eH(n,e),n.reverse(),n}function z5(t){const e=[];return T(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function G5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ge,n=t.slice(0);return n=eH(n,e),n=U5(n,e),n=z5(n),n}function Y5(t){return J1({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||$5(r)||W5(r)||V5(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function j5(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const tH="menu",U0=tH;function K5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(j5(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:tH})}function i(u,c){const h=a(c);u.forEach(f=>{let{keys:g}=f;g.forEach(w=>h.removeShortcutsByKeys(w))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${U0}:${u}`:U0}function a(u){var c;const h=t.hotMenu.getShortcutManager(),f=s(u);return(c=h.getContext(f))!==null&&c!==void 0?c:h.addContext(f)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}const X5="submenuIndicator";function q5(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(Gr(n),ee(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!ud(a,t)&&!B0(a)&&!Gw(a);ve(n,[gz(),Wo(u),...c?[dl(-1)]:[],...ud(a,t)?[yz()]:[],...ld(a)?[sn(!1)]:[]])}ld(a)&&(n.querySelector(".submenuIndicator")||Bs(n,{tagName:"div",attributes:t.getSettings().ariaTags?[so()]:[],className:X5})),n.className="",n.appendChild(l),Gw(a)?ee(n,"htSeparator"):typeof a.renderer=="function"?(ee(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Qs(l,u),ud(a,t)?ee(n,"htDisabled"):B0(a)?ee(n,"htSelectionDisabled"):ld(a)&&ee(n,"htSubmenu")}}function z0(t,e,n){Z5(t,e),e.set(t,n)}function Z5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ri(t,e,n){return e=Q5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q5(t){var e=J5(t,"string");return typeof e=="symbol"?e:String(e)}function J5(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function G0(t,e,n){var r=nH(t,e,"set");return eZ(t,r,n),n}function eZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Bl(t,e){var n=nH(t,e,"get");return tZ(t,n)}function nH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function tZ(t,e){return e.get?e.get.call(t):e.value}const Y0=215;var Ul=new WeakMap,ph=new WeakMap;class vl{constructor(e,n){var r=this;ri(this,"hot",void 0),ri(this,"options",void 0),ri(this,"eventManager",new ar(this)),ri(this,"container",void 0),ri(this,"positioner",void 0),ri(this,"hotMenu",null),ri(this,"hotSubMenus",{}),ri(this,"parentMenu",void 0),ri(this,"menuItems",null),ri(this,"origOutsideClickDeselects",null),z0(this,Ul,{writable:!0,value:void 0}),z0(this,ph,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Y0,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new L5(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Fu(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Bl(this,Ul)}getKeyboardShortcutsCtrl(){return Bl(this,ph)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=sv(a=>this.openSubMenu(a),300),n=this.options.minWidth||Y0;let r=!1,i=sr(this.menuItems,a=>(a.key===Yu&&(r=!0),B5(a,this.hot)));if(i.length<1&&!r)i.push(Y1()[Yu]);else if(i.length===0)return;i=G5(i,Ge);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return le(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:q5(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Bl(this,Ul).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===Ge?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),bw()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!bw()||!zo(a))&&o&&this.hasSelectedItem()&&(Yi()||hv()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),G0(this,Ul,Y5(this.hotMenu)),G0(this,ph,K5(this)),Bl(this,ph).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Bl(this,Ul).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);ve(r,[sn(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!F5(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new vl(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&ve(n,[sn(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&ve(i,[sn(!1)])}}closeAllSubMenus(){T(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?k5(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||Gw(e)||ud(e,this.hot)||ld(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(gt(r)&&(r=r.call(this.hot),r===null||mt(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),ee(i,`htMenu ${this.options.className}`),r&&ee(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Ft(n,(a,l)=>a+(l.name===Ge?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&ve(this.hotMenu.rootElement,[fz(),dl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!No(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!No(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Pe(e.target,"htCore")&&No(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}dt(vl,Qn);function wh(t,e){nZ(t,e),e.add(t)}function nZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lm(t,e,n){return e=rZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rZ(t){var e=iZ(t,"string");return typeof e=="symbol"?e:String(e)}function iZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ch(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const fu="contextMenu",oZ=70,j0=fu;fe.getSingleton().register("afterContextMenuDefaultOptions");fe.getSingleton().register("beforeContextMenuShow");fe.getSingleton().register("afterContextMenuShow");fe.getSingleton().register("afterContextMenuHide");fe.getSingleton().register("afterContextMenuExecute");var K0=new WeakSet,X0=new WeakSet,q0=new WeakSet,Z0=new WeakSet;class ng extends nt{constructor(){super(...arguments),wh(this,Z0),wh(this,q0),wh(this,X0),wh(this,K0),Lm(this,"commandExecutor",new q1(this.hot)),Lm(this,"itemsFactory",null),Lm(this,"menu",null)}static get PLUGIN_KEY(){return fu}static get PLUGIN_PRIORITY(){return oZ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Qf,Jf,Ge,wc,Cc,Ge,Zf,Sc,Ge,eg,qf,Ge,vc,Ge,pr]}isEnabled(){return!!this.hot.getSettings()[fu]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[fu];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new vl(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Ch(this,X0,aZ).call(this)),this.menu.addLocalHook("afterOpen",()=>Ch(this,q0,lZ).call(this)),this.menu.addLocalHook("afterClose",()=>Ch(this,Z0,uZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>Ch(this,K0,sZ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","\\"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Kf(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height})},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:j0})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(j0)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Be(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new Z1(this.hot,ng.DEFAULT_ITEMS);const e=this.hot.getSettings()[fu],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),T(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function sZ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Pe(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Pe(o,"current")&&Pe(o,"wtBorder"))))return;const s=Kf(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function aZ(){this.hot.runHooks("beforeContextMenuShow",this)}function lZ(){this.hot.runHooks("afterContextMenuShow",this)}function uZ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ng.SEPARATOR={name:Ge};function cZ(t){return{key:"copy",name(){return this.getTranslatedPhrase(iS)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function hZ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(aS,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function dZ(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(sS,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function fZ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?qn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(oS,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function gZ(t){return{key:"cut",name(){return this.getTranslatedPhrase(lS)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class mZ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class pZ{constructor(){this.clipboardData=new mZ}}function Q0(t,e){rH(t,e),e.add(t)}function ba(t,e,n){rH(t,e),e.set(t,n)}function rH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Hn(t,e){var n=iH(t,e,"get");return wZ(t,n)}function wZ(t,e){return e.get?e.get.call(t):e.value}function Ra(t,e,n){var r=iH(t,e,"set");return CZ(t,r,n),n}function iH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function CZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Co=new WeakMap,km=new WeakMap,zl=new WeakMap,Yw=new WeakMap,jw=new WeakMap,Gl=new WeakMap,Sh=new WeakSet,J0=new WeakSet;class vZ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;Q0(this,J0),Q0(this,Sh),ba(this,Co,{writable:!0,value:void 0}),ba(this,km,{writable:!0,value:void 0}),ba(this,zl,{writable:!0,value:void 0}),ba(this,Yw,{writable:!0,value:void 0}),ba(this,jw,{writable:!0,value:void 0}),ba(this,Gl,{writable:!0,value:void 0}),Ra(this,km,n),Ra(this,zl,r),Ra(this,Yw,i),Ra(this,jw,o),Ra(this,Gl,s)}setSelectedRange(e){Ra(this,Co,e)}getCellsRange(){if(Hn(this,km).call(this)===0||Hn(this,zl).call(this)===0)return null;const{row:e,col:n}=Hn(this,Co).getTopStartCorner(),{row:r,col:i}=Hn(this,Co).getBottomEndCorner(),o=vh(this,J0,SZ).call(this,e,r),s=vh(this,Sh,$m).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Hn(this,zl).call(this)===0||Hn(this,Gl).call(this)===0)return null;const{col:e}=Hn(this,Co).getTopStartCorner(),{col:n}=Hn(this,Co).getBottomEndCorner(),r=vh(this,Sh,$m).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Hn(this,zl).call(this)===0||Hn(this,Gl).call(this)===0)return null;const{col:e}=Hn(this,Co).getTopStartCorner(),{col:n}=Hn(this,Co).getBottomEndCorner(),r=vh(this,Sh,$m).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Hn(this,Gl).call(this),startCol:e,endRow:-1,endCol:r}}}function $m(t,e){return Math.min(e,Math.max(t+Hn(this,jw).call(this)-1,t))}function SZ(t,e){return Math.min(e,Math.max(t+Hn(this,Yw).call(this)-1,t))}function oH(t){const e=[],n=[];return T(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);pe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);pe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function Pi(t,e){sH(t,e),e.add(t)}function ps(t,e,n){sH(t,e),e.set(t,n)}function sH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yl(t,e,n){return e=yZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yZ(t){var e=bZ(t,"string");return typeof e=="symbol"?e:String(e)}function bZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tr(t,e){var n=aH(t,e,"get");return RZ(t,n)}function RZ(t,e){return e.get?e.get.call(t):e.value}function Lr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ii(t,e,n){var r=aH(t,e,"set");return EZ(t,r,n),n}function aH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function EZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("afterCopyLimit");fe.getSingleton().register("modifyCopyableRange");fe.getSingleton().register("beforeCut");fe.getSingleton().register("afterCut");fe.getSingleton().register("beforePaste");fe.getSingleton().register("afterPaste");fe.getSingleton().register("beforeCopy");fe.getSingleton().register("afterCopy");const yh="copyPaste",TZ=80,_Z=["fragmentSelection"],eT=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Kw=new WeakMap,Xw=new WeakMap,qw=new WeakMap,Ea=new WeakMap,bh=new WeakMap,Rh=new WeakMap,Ta=new WeakMap,Fm=new WeakSet,tT=new WeakSet,lH=new WeakSet,Gy=new WeakSet,nT=new WeakSet,rT=new WeakSet,iT=new WeakSet,oT=new WeakSet,sT=new WeakSet;class MZ extends nt{constructor(){super(...arguments),Pi(this,sT),Pi(this,oT),Pi(this,iT),Pi(this,rT),Pi(this,nT),Pi(this,Gy),Pi(this,lH),Pi(this,tT),Pi(this,Fm),Yl(this,"columnsLimit",1/0),Yl(this,"rowsLimit",1/0),Yl(this,"pasteMode","overwrite"),Yl(this,"uiContainer",this.hot.rootDocument.body),ps(this,Kw,{writable:!0,value:!1}),ps(this,Xw,{writable:!0,value:!1}),ps(this,qw,{writable:!0,value:!1}),ps(this,Ea,{writable:!0,value:"cells-only"}),ps(this,bh,{writable:!0,value:!1}),ps(this,Rh,{writable:!0,value:!1}),ps(this,Ta,{writable:!0,value:new vZ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Yl(this,"copyableRanges",[])}static get PLUGIN_KEY(){return yh}static get SETTING_KEYS(){return[yh,..._Z]}static get PLUGIN_PRIORITY(){return TZ}isEnabled(){return!!this.hot.getSettings()[yh]}enablePlugin(){var e=this;if(this.enabled)return;const{[yh]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,Ii(this,Kw,!!n.copyColumnHeaders),Ii(this,Xw,!!n.copyColumnGroupHeaders),Ii(this,qw,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Lr(this,nT,PZ).call(this,o)),this.addHook("afterSelectionEnd",()=>Lr(this,rT,IZ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),uv()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Lr(e,iT,xZ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Lr(e,oT,HZ).call(e,...s)}),this.addHook("afterSelection",()=>Lr(this,sT,DZ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ii(this,Ea,e),Ii(this,bh,!0),Lr(this,Fm,aT).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ii(this,Rh,!0),Lr(this,Fm,aT).call(this,"cut")}getRangedCopyableData(e){return bu(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=oH(e);return T(r,o=>{const s=[];T(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new pZ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}tr(this,Ta).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);tr(this,Ea)==="column-headers-only"?n.set("headers",tr(this,Ta).getMostBottomColumnHeadersRange()):(tr(this,Ea)==="with-column-headers"?n.set("headers",tr(this,Ta).getMostBottomColumnHeadersRange()):tr(this,Ea)==="with-column-group-headers"&&n.set("headers",tr(this,Ta).getAllColumnHeadersRange()),n.set("cells",tr(this,Ta).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,f=s,g=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:w,visualRow:C}=this.hot.getCellMeta(c,a);if(c=C+1,w===!0)continue;f=C,h=a;const S=[],b=o.length%r;for(;S.length<i||h<=u;){const{skipColumnOnPaste:_,visualCol:O}=this.hot.getCellMeta(s,h);if(h=O+1,_===!0)continue;g=O;const x=S.length%i;S.push(e[b][x])}o.push(S)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,f,g]}onCopy(e){if(!this.hot.isListening()&&!tr(this,bh)||this.isEditorOpened())return;this.setCopyableText(),Ii(this,bh,!1);const n=this.getRangedData(this.copyableRanges),r=Lr(this,tT,AZ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=bu(n);if(e&&e.clipboardData){const s=Aw(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[eT,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}Ii(this,Ea,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!tr(this,Rh)||this.isEditorOpened())return;this.setCopyableText(),Ii(this,Rh,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=bu(n);if(e&&e.clipboardData){const o=Aw(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[eT,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=Af(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=XI(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=rq(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function aT(t){if(uv()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&EI(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function AZ(t){const{rows:e}=oH(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function OZ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&iv(r)}}}function uH(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&ov(r)}}}function PZ(t){t.items.push({name:"---------"},cZ(this)),tr(this,Kw)&&t.items.push(fZ(this)),tr(this,Xw)&&t.items.push(dZ(this)),tr(this,qw)&&t.items.push(hZ(this)),t.items.push(gZ(this))}function IZ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function xZ(){Lr(this,Gy,uH).call(this)}function HZ(){Lr(this,lH,OZ).call(this)}function DZ(){Lr(this,Gy,uH).call(this)}function cH(t,e){return`border_row${t}col${e}`}function gu(){return{width:1,color:"#000"}}function Ki(){return{hide:!0}}function NZ(){return{width:1,color:"#000",cornerVisible:!1}}function Wm(t){if(le(t.start)||le(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(le(t.end)||le(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function jl(t){return le(t.start)&&(t.left=t.start),le(t.end)&&(t.right=t.end),t}function Vm(t,e){return{id:cH(t,e),border:NZ(),row:t,col:e,top:Ki(),bottom:Ki(),start:Ki(),end:Ki()}}function LZ(t,e){return At(e,"border")&&e.border&&(t.border=e.border),At(e,"top")&&le(e.top)&&(e.top?($e(e.top)||(e.top=gu()),t.top=e.top):(e.top=Ki(),t.top=e.top)),At(e,"bottom")&&le(e.bottom)&&(e.bottom?($e(e.bottom)||(e.bottom=gu()),t.bottom=e.bottom):(e.bottom=Ki(),t.bottom=e.bottom)),At(e,"start")&&le(e.start)&&(e.start?($e(e.start)||(e.start=gu()),t.start=e.start):(e.start=Ki(),t.start=e.start)),At(e,"end")&&le(e.end)&&(e.end?($e(e.end)||(e.end=gu()),t.end=e.end):(e.end=Ki(),t.end=e.end)),t}function to(t,e){let n=!1;return T(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!At(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function rg(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function kZ(t){return t.some(e=>le(e.left)||le(e.right))}function $Z(t){return t.some(e=>le(e.start)||le(e.end))}const FZ=new Map([["left","start"],["right","end"]]);function WZ(t){var e;return(e=FZ.get(t))!==null&&e!==void 0?e:t}function VZ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(AS);return to(this,"bottom")&&(e=rg(e)),e},callback(e,n){const r=to(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function BZ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(OS);return to(this,e)&&(n=rg(n)),n},callback(n,r){const i=to(this,e);t.prepareBorder(r,e,i)}}}function UZ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(PS)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!to(this)}}}function zZ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(MS);return to(this,e)&&(n=rg(n)),n},callback(n,r){const i=to(this,e);t.prepareBorder(r,e,i)}}}function GZ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(_S);return to(this,"top")&&(e=rg(e)),e},callback(e,n){const r=to(this,"top");t.prepareBorder(n,"top",r)}}}function lT(t,e){YZ(t,e),e.add(t)}function YZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jZ(t,e,n){return e=KZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KZ(t){var e=XZ(t,"string");return typeof e=="symbol"?e:String(e)}function XZ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const cd="customBorders",qZ=90;var cT=new WeakSet,hT=new WeakSet;class ZZ extends nt{constructor(){super(...arguments),lT(this,hT),lT(this,cT),jZ(this,"savedBorders",[])}static get PLUGIN_KEY(){return cd}static get PLUGIN_PRIORITY(){return qZ}isEnabled(){return!!this.hot.getSettings()[cd]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>uT(this,cT,QZ).call(this,e)),this.addHook("init",()=>uT(this,hT,JZ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Wm(n));const o=sl(e),s=Gu(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});T(e,a=>{s(a).forAll((l,u)=>{T(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,WZ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=sl(e),r=Gu(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return T(e,o=>{r(o).forAll((s,a)=>{T(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(jl(l))})})}),i}clearBorders(e){e?this.setBorders(e):(T(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=Vm(e,n);r&&(a=LZ(a,r),T(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",jl(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);pe(e.from.row,r,o=>{pe(e.from.col,i,s=>{const a=Vm(o,s);let l=0;o===e.from.row&&At(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&At(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&At(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&At(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",jl(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=cH(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=Vm(e,n):o=Wm(o),i?(o[r]=Ki(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",jl(o)))):(o[r]=gu(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",jl(o)))}prepareBorder(e,n,r){T(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":pe(o.col,s.col,a=>{pe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":pe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":pe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":pe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":pe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){T(e,n=>{const r=Wm(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Ft([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ve(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){T(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){T(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ve(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):T(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return T(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return T(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):T(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);T(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[cd];if(Array.isArray(e)){const n=bn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=kZ(e),r=$Z(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function QZ(t){this.hot.getSettings()[cd]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(TS)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[GZ(this),zZ(this),VZ(this),BZ(this),UZ(this)]}})}function JZ(){this.changeBorderSettings()}function eQ(t,e){tQ(t,e),e.add(t)}function tQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bm(t,e,n){return e=nQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nQ(t){var e=rQ(t,"string");return typeof e=="symbol"?e:String(e)}function rQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const fT="dragToScroll",iQ=100;var Um=new WeakSet;class oQ extends nt{constructor(){super(...arguments),eQ(this,Um),Bm(this,"boundaries",null),Bm(this,"callback",null),Bm(this,"listening",!1)}static get PLUGIN_KEY(){return fT}static get PLUGIN_PRIORITY(){return iQ}isEnabled(){return!!this.hot.getSettings()[fT]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>dT(this,Um,gT).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>dT(this,Um,gT).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Fu(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function gT(t){if(zo(t))return;const e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}function ws(t,e){sQ(t,e),e.add(t)}function sQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zm(t,e,n){return e=aQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aQ(t){var e=lQ(t,"string");return typeof e=="symbol"?e:String(e)}function lQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _o(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("afterDropdownMenuDefaultOptions");fe.getSingleton().register("beforeDropdownMenuShow");fe.getSingleton().register("afterDropdownMenuShow");fe.getSingleton().register("afterDropdownMenuHide");fe.getSingleton().register("afterDropdownMenuExecute");const hd="dropdownMenu",uQ=230,Zw="changeType",Gm=hd;var Yy=new WeakSet,mT=new WeakSet,pT=new WeakSet,wT=new WeakSet,CT=new WeakSet,vT=new WeakSet,ST=new WeakSet;class ig extends nt{static get PLUGIN_KEY(){return hd}static get PLUGIN_PRIORITY(){return uQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[wc,Cc,Ge,Sc,Ge,Xf,Ge,vc,Ge,pr]}constructor(e){super(e),ws(this,ST),ws(this,vT),ws(this,CT),ws(this,wT),ws(this,pT),ws(this,mT),ws(this,Yy),zm(this,"commandExecutor",new q1(this.hot)),zm(this,"itemsFactory",null),zm(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>_o(this,pT,hQ).call(this,n,r))}isEnabled(){return this.hot.getSettings()[hd]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new Z1(this.hot,ig.DEFAULT_ITEMS);const n=this.hot.getSettings()[hd],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new vl(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>_o(this,wT,dQ).call(this)),this.menu.addLocalHook("afterOpen",()=>_o(this,CT,fQ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>_o(this,vT,gQ).call(this,o)),this.menu.addLocalHook("afterClose",()=>_o(this,ST,mQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),T(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=Kf(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width})}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Gm},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Gm}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Gm)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>_o(this,mT,cQ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Be(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function hH(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function cQ(t){if(t.stopPropagation(),Pe(t.target,Zw)){const e=Kf(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function hQ(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${Zw}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=Zw,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(ve(s,[Wo(this.hot.getTranslatedPhrase(vy))]),ve(e,[fl("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function dQ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function fQ(){this.hot.runHooks("afterDropdownMenuShow",this),_o(this,Yy,hH).call(this,this.menu)}function gQ(t){_o(this,Yy,hH).call(this,t)}function mQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}ig.SEPARATOR={name:Ge};function yT(t,e,n){return e=pQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pQ(t){var e=wQ(t,"string");return typeof e=="symbol"?e:String(e)}function wQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CQ{constructor(e){yT(this,"hot",void 0),yT(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return pe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(pe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();pe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();pe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const vQ=CQ;function bT(t,e,n){return e=SQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SQ(t){var e=yQ(t,"string");return typeof e=="symbol"?e:String(e)}function yQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jy{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){bT(this,"dataProvider",void 0),bT(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Ln(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=Ut(Ln(jy.DEFAULT_OPTIONS),n),n=Ut(n,e),n.filename=QC(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const bQ=jy,RQ=String.fromCharCode(13),EQ=String.fromCharCode(34),TQ=String.fromCharCode(10);class _Q extends bQ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ve(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),T(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Nt(e);return r!==""&&(n||r.indexOf(RQ)>=0||r.indexOf(EQ)>=0||r.indexOf(TQ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const MQ=_Q,AQ="csv",Qw={[AQ]:MQ};function OQ(t,e,n){return typeof Qw[t]=="function"?new Qw[t](e,n):null}const PQ="exportFile",IQ=240;class xQ extends nt{static get PLUGIN_KEY(){return PQ}static get PLUGIN_PRIORITY(){return IQ}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Qw[e])throw new Error(`Export format type "${e}" is not supported.`);return OQ(e,new vQ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function _a(t,e,n){return e=HQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HQ(t){var e=DQ(t,"string");return typeof e=="symbol"?e:String(e)}function DQ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yc{constructor(e,n){let{id:r,stateless:i=!0}=n;_a(this,"hot",void 0),_a(this,"id",void 0),_a(this,"elements",[]),_a(this,"hidden",!1),_a(this,"stateId",""),_a(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Wf)}getElements(){return this.elements}reset(){T(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),T(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}dt(yc,Qn);const ju={};function Yo(t,e){if(!ju[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=ju[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Ls(t){if(!ju[t])throw Error(`Filter condition "${t}" does not exist.`);return ju[t].descriptor}function zt(t,e,n){n.key=t,ju[t]={condition:e,descriptor:n}}const on="none";function NQ(){return!0}zt(on,NQ,{name:Vf,inputsCount:0,showOperators:!1});const _u="empty";function LQ(t){return Xt(t.value)}zt(_u,LQ,{name:kS,inputsCount:0,showOperators:!0});const dd="not_empty";function kQ(t,e){return!Yo(_u,e)(t)}zt(dd,kQ,{name:$S,inputsCount:0,showOperators:!0});const Mu="eq";function $Q(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale)===Nt(n)}zt(Mu,$Q,{name:FS,inputsCount:1,showOperators:!0});const fd="neq";function FQ(t,e){return!Yo(Mu,e)(t)}zt(fd,FQ,{name:WS,inputsCount:1,showOperators:!0});const dH="gt";function WQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}zt(dH,WQ,{name:GS,inputsCount:1,showOperators:!0});const fH="gte";function VQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}zt(fH,VQ,{name:YS,inputsCount:1,showOperators:!0});const gH="lt";function BQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}zt(gH,BQ,{name:jS,inputsCount:1,showOperators:!0});const mH="lte";function UQ(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}zt(mH,UQ,{name:KS,inputsCount:1,showOperators:!0});const Ky="date_after";function zQ(t,e){let[n]=e;const r=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}zt(Ky,zQ,{name:ZS,inputsCount:1,showOperators:!0});const Xy="date_before";function GQ(t,e){let[n]=e;const r=J(t.value,t.meta.dateFormat),i=J(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}zt(Xy,GQ,{name:QS,inputsCount:1,showOperators:!0});const Kd="between";function YQ(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Yo(Xy,[o]),a=Yo(Ky,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}zt(Kd,YQ,{name:XS,inputsCount:2,showOperators:!0});const pH="not_between";function jQ(t,e){return!Yo(Kd,e)(t)}zt(pH,jQ,{name:qS,inputsCount:2,showOperators:!0});const wH="begins_with";function KQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Nt(n))}zt(wH,KQ,{name:VS,inputsCount:1,showOperators:!0});const CH="ends_with";function XQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Nt(n))}zt(CH,XQ,{name:BS,inputsCount:1,showOperators:!0});const qy="contains";function qQ(t,e){let[n]=e;return Nt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Nt(n))>=0}zt(qy,qQ,{name:US,inputsCount:1,showOperators:!0});const vH="not_contains";function ZQ(t,e){return!Yo(qy,e)(t)}zt(vH,ZQ,{name:zS,inputsCount:1,showOperators:!0});const SH="date_tomorrow";function QQ(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(-1,"days").startOf("day"),"d"):!1}zt(SH,QQ,{name:ey,inputsCount:0});const yH="date_today";function JQ(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().startOf("day"),"d"):!1}zt(yH,JQ,{name:JS,inputsCount:0});const bH="date_yesterday";function eJ(t){const e=J(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(J().subtract(1,"days").startOf("day"),"d"):!1}zt(bH,eJ,{name:ty,inputsCount:0});cx();function tJ(t,e){let n=t;return n===""&&(n=`(${e})`),n}const Jw=new Set([1]).has(1),nJ=Jw&&typeof Array.from=="function";function bc(t){let e=t;return Jw&&(e=new Set(e)),function(n){let r;return Jw?r=e.has(n):r=!!~e.indexOf(n),r}}function RH(t){return t??""}function eC(t){let e=t;return nJ?e=Array.from(new Set(e)):e=XC(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function RT(t,e,n,r){const i=[],o=t===e;let s;return o||(s=bc(e)),T(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:tJ(a,n)};r&&r(u),i.push(u)}),i}const ks="by_value";function rJ(t,e){let[n]=e;return n(t.value)}zt(ks,rJ,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[bc(e)]},showOperators:!1});const Ku={};function iJ(t){if(!Ku[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Ku[t].func;return function(n,r){return e(n,r)}}function oJ(t){return Ku[t].name}function Zy(t,e,n){Ku[t]={name:e,func:n}}const $o="conjunction",sJ=iy;function aJ(t,e){return t.every(n=>n.func(e))}Zy($o,sJ,aJ);const Xd="disjunction",lJ=Bf;function uJ(t,e){return t.some(n=>n.func(e))}Zy(Xd,lJ,uJ);const Qy="disjunctionWithExtraCondition",cJ=Bf;function hJ(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}Zy(Qy,cJ,hJ);const dJ="numeric",EH="text",fJ="date",ET={[dJ]:[on,Ge,_u,dd,Ge,Mu,fd,Ge,dH,fH,gH,mH,Kd,pH],[EH]:[on,Ge,_u,dd,Ge,Mu,fd,Ge,wH,CH,Ge,qy,vH],[fJ]:[on,Ge,_u,dd,Ge,Mu,fd,Ge,Xy,Ky,Kd,Ge,SH,yH,bH]};function gJ(t){const e=[];let n=t;return ET[n]||(n=EH),T(ET[n],r=>{let i;r===Ge?i={name:Ge}:i=Ln(Ls(r)),e.push(i)}),e}function Kl(t,e,n){return e=mJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mJ(t){var e=pJ(t,"string");return typeof e=="symbol"?e:String(e)}function pJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Ym="built",jm="building",TT=["click","input","keydown","keypress","keyup","focus","blur","change"];let Vr=class TH{static get DEFAULTS(){return Ln({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Kl(this,"hot",void 0),Kl(this,"eventManager",new ar(this)),Kl(this,"options",void 0),Kl(this,"_element",void 0),Kl(this,"buildState",void 0),this.hot=e,this.options=Ut(TH.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===jm?this._element:this.buildState===Ym?(this.update(),this._element):(this.buildState=jm,this.build(),this.buildState=Ym,this._element)}isBuilt(){return this.buildState===Ym}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Wn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=jm),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ee(this._element,this.options.className),this.options.children.length)T(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Be(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),T(TT,r=>e(n,r))}else T(TT,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};dt(Vr,Qn);function wJ(t,e){_H(t,e),e.add(t)}function CJ(t,e,n){_H(t,e),e.set(t,n)}function _H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eh(t,e){var n=MH(t,e,"get");return vJ(t,n)}function vJ(t,e){return e.get?e.get.call(t):e.value}function SJ(t,e,n){var r=MH(t,e,"set");return yJ(t,r,n),n}function MH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function bJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Ma=new WeakMap,_T=new WeakSet;class Fo extends Vr{static get DEFAULTS(){return Ln({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Ut(Fo.DEFAULTS,n)),wJ(this,_T),CJ(this,Ma,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>bJ(this,_T,RJ).call(this,e))}build(){super.build(),SJ(this,Ma,this._element.firstChild),ee(this._element,"htUIInput"),this.update()}update(){this.isBuilt()&&(Eh(this,Ma).type=this.options.type,Eh(this,Ma).placeholder=this.translateIfPossible(this.options.placeholder),Eh(this,Ma).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Eh(this,Ma).focus()}}function RJ(t){this.options.value=t.target.value}function Km(t,e){AH(t,e),e.add(t)}function Xl(t,e,n){AH(t,e),e.set(t,n)}function AH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Aa(t,e,n){var r=OH(t,e,"set");return EJ(t,r,n),n}function EJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Xm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Pt(t,e){var n=OH(t,e,"get");return TJ(t,n)}function OH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function TJ(t,e){return e.get?e.get.call(t):e.value}var Zt=new WeakMap,Th=new WeakMap,_h=new WeakMap,qm=new WeakMap,Mh=new WeakMap,MT=new WeakSet,AT=new WeakSet,OT=new WeakSet;class Xu extends Vr{static get DEFAULTS(){return Ln({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Ut(Xu.DEFAULTS,n)),Km(this,OT),Km(this,AT),Km(this,MT),Xl(this,Zt,{writable:!0,value:null}),Xl(this,Th,{writable:!0,value:[]}),Xl(this,_h,{writable:!0,value:void 0}),Xl(this,qm,{writable:!0,value:void 0}),Xl(this,Mh,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Pt(this,Zt)}registerHooks(){this.addLocalHook("click",()=>Xm(this,OT,AJ).call(this))}setItems(e){Aa(this,Th,this.translateNames(e)),Pt(this,Zt)&&Pt(this,Zt).setMenuItems(Pt(this,Th))}translateNames(e){return T(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Aa(this,Zt,new vl(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Pt(this,Zt).setMenuItems(Pt(this,Th));const e=new Vr(this.hot,{className:"htUISelectCaption"}),n=new Vr(this.hot,{className:"htUISelectDropdown"});Aa(this,_h,e),Aa(this,qm,e.element),Aa(this,Mh,n),this.hot.getSettings().ariaTags&&(ve(n.element,[so()]),ve(this._element,[uI()])),T([e,n],r=>this._element.appendChild(r.element)),Pt(this,Zt).addLocalHook("select",r=>Xm(this,MT,_J).call(this,r)),Pt(this,Zt).addLocalHook("afterClose",()=>Xm(this,AT,MJ).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Pt(this,Zt).hot.getTranslatedPhrase(Vf),Pt(this,qm).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Pt(this,Zt)&&(Pt(this,Zt).open(),Pt(this,Zt).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Pt(this,Zt).getNavigator().toFirstItem(),Pt(this,Zt).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Pt(this,Zt)&&Pt(this,Zt).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Pt(this,Zt)&&(Pt(this,Zt).destroy(),Aa(this,Zt,null)),Pt(this,_h)&&Pt(this,_h).destroy(),Pt(this,Mh)&&Pt(this,Mh).destroy(),super.destroy()}}function _J(t){t.name!==Ge&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function MJ(){this.runLocalHooks("afterClose")}function AJ(){this.openOptions()}function PT(t,e){OJ(t,e),e.add(t)}function OJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IT(t,e,n){return e=PJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PJ(t){var e=IJ(t,"string");return typeof e=="symbol"?e:String(e)}function IJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xT(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var HT=new WeakSet,DT=new WeakSet;class tC extends yc{constructor(e,n){super(e,{id:n.id,stateless:!1}),PT(this,DT),PT(this,HT),IT(this,"name",""),IT(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Xu(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Fo(this.hot,{placeholder:cy})),this.elements.push(new Fo(this.hot,{placeholder:hy})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>xT(this,HT,xJ).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),T(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>xT(this,DT,HJ).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Ln(e.command);n.name.startsWith(Lt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),T(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Ls(on),n=[];return T(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=Ls(e?e.name:on);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||T(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Xu)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Fo)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ee(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ee(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Ls(on)];if(e!==null){const{visualIndex:r}=e;n=gJ(this.hot.getDataType(0,r,this.hot.countRows(),r))}T(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function xJ(t){T(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function HJ(t){ml(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Rr(t))}function NT(t,e,n){DJ(t,e),e.set(t,n)}function DJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ql(t,e){var n=PH(t,e,"get");return NJ(t,n)}function NJ(t,e){return e.get?e.get.call(t):e.value}function LT(t,e,n){var r=PH(t,e,"set");return LJ(t,r,n),n}function PH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function LJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Oa=new WeakMap,Zm=new WeakMap;class qd extends Vr{static get DEFAULTS(){return Ln({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Ut(qd.DEFAULTS,n)),NT(this,Oa,{writable:!0,value:void 0}),NT(this,Zm,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),LT(this,Zm,e),LT(this,Oa,this._element.firstChild),ql(this,Oa).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ql(this,Zm).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return ql(this,Oa).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(ql(this,Oa).checked=e)}focus(){this.isBuilt()&&ql(this,Oa).focus()}}function kJ(t,e){$J(t,e),e.add(t)}function $J(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FJ(t,e,n){return e=WJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WJ(t){var e=VJ(t,"string");return typeof e=="symbol"?e:String(e)}function VJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BJ(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const kT=0;var $T=new WeakSet;class UJ extends yc{constructor(e,n){super(e,{id:n.id,stateless:!1}),kJ(this,$T),FJ(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ee(n.parentNode,"htFiltersMenuOperators"),T(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[$o,Xd];T(e,n=>{const r=new qd(this.hot,{name:"operator",label:{htmlFor:n,textContent:oJ(n)},value:n,checked:n===e[kT],id:n});r.addLocalHook("change",i=>BJ(this,$T,zJ).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ct`Radio button with index ${e} doesn't exist.`);T(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof qd&&n.isChecked());return e?e.getValue():$o}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&T(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$o,n=arguments.length>1?arguments[1]:void 0,r=e;r===Qy&&(r=Xd),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(kT)}}function zJ(t){this.setState(t.target.value)}function GJ(t,e,n){YJ(t,e),e.set(t,n)}function YJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qm(t,e){var n=IH(t,e,"get");return jJ(t,n)}function jJ(t,e){return e.get?e.get.call(t):e.value}function KJ(t,e,n){var r=IH(t,e,"set");return XJ(t,r,n),n}function IH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function XJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Zl=new WeakMap;class qu extends Vr{static get DEFAULTS(){return Ln({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Ut(qu.DEFAULTS,n)),GJ(this,Zl,{writable:!0,value:void 0})}build(){super.build(),KJ(this,Zl,this._element.firstChild)}update(){this.isBuilt()&&(Qm(this,Zl).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Qm(this,Zl).focus()}activate(){Qm(this,Zl).click()}}function Ah(t,e){xH(t,e),e.add(t)}function Pa(t,e,n){xH(t,e),e.set(t,n)}function xH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function He(t,e){var n=HH(t,e,"get");return qJ(t,n)}function qJ(t,e){return e.get?e.get.call(t):e.value}function Pr(t,e,n){var r=HH(t,e,"set");return ZJ(t,r,n),n}function HH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ZJ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const FT="multipleSelect.itemBox";var Nr=new WeakMap,Tt=new WeakMap,Jm=new WeakMap,xi=new WeakMap,vo=new WeakMap,So=new WeakMap,WT=new WeakSet,VT=new WeakSet,BT=new WeakSet,UT=new WeakSet;class Zu extends Vr{static get DEFAULTS(){return Ln({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Ut(Zu.DEFAULTS,n)),Ah(this,UT),Ah(this,BT),Ah(this,VT),Ah(this,WT),Pa(this,Nr,{writable:!0,value:[]}),Pa(this,Tt,{writable:!0,value:void 0}),Pa(this,Jm,{writable:!0,value:void 0}),Pa(this,xi,{writable:!0,value:void 0}),Pa(this,vo,{writable:!0,value:void 0}),Pa(this,So,{writable:!0,value:void 0}),Pr(this,xi,new Fo(this.hot,{placeholder:uy,className:"htUIMultipleSelectSearch"})),Pr(this,vo,new qu(this.hot,{textContent:oy,className:"htUISelectAll"})),Pr(this,So,new qu(this.hot,{textContent:sy,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return He(this,Tt)}registerHooks(){He(this,xi).addLocalHook("keydown",e=>Oh(this,VT,JJ).call(this,e)),He(this,xi).addLocalHook("input",e=>Oh(this,WT,QJ).call(this,e)),He(this,vo).addLocalHook("click",e=>Oh(this,BT,eee).call(this,e)),He(this,So).addLocalHook("click",e=>Oh(this,UT,tee).call(this,e))}setItems(e){Pr(this,Nr,e),He(this,Tt)&&He(this,Tt).loadData(He(this,Nr))}setLocale(e){Pr(this,Jm,e)}getLocale(){return He(this,Jm)}getItems(){return[...He(this,Nr)]}getValue(){return ree(He(this,Nr))}getSearchInputElement(){return He(this,xi)}getSelectAllElement(){return He(this,vo)}getClearAllElement(){return He(this,So)}isSelectedAllValues(){return He(this,Nr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new Vr(this.hot,{className:"htUISelectionControls",children:[He(this,vo),He(this,So)]});this._element.appendChild(He(this,xi).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;He(this,Tt)&&He(this,Tt).destroy(),ee(o,"htUIMultipleSelectHot"),Pr(this,Tt,new this.hot.constructor(o,{data:He(this,Nr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,f,g)=>{l.title=g.instance.getDataAtRowProp(u,g.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{He(this,Tt).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>He(this,Tt).container.scrollWidth-Jt(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),He(this,Tt).init();const a=He(this,Tt).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:FT}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{He(this,Tt).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:FT})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&He(this,Tt).listen()}reset(){He(this,xi).reset(),He(this,vo).reset(),He(this,So).reset()}update(){this.isBuilt()&&(He(this,Tt).loadData(nee(He(this,Nr),this.options.value)),super.update())}destroy(){He(this,Tt)&&He(this,Tt).destroy(),He(this,xi).destroy(),He(this,So).destroy(),He(this,vo).destroy(),Pr(this,xi,null),Pr(this,So,null),Pr(this,vo,null),Pr(this,Tt,null),Pr(this,Nr,null),super.destroy()}}function QJ(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...He(this,Nr)]:n=sr(He(this,Nr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),He(this,Tt).loadData(n)}function JJ(t){this.runLocalHooks("keydown",t,this),av(ml,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Rr(t),He(this,Tt).listen(),He(this,Tt).selectCell(0,0))}function eee(t){const e=[];t.preventDefault(),T(He(this,Tt).getSourceData(),(n,r)=>{n.checked=!0,e.push(Fv(n,r)[0])}),He(this,Tt).setSourceDataAtCell(e)}function tee(t){const e=[];t.preventDefault(),T(He(this,Tt).getSourceData(),(n,r)=>{n.checked=!1,e.push(Fv(n,r)[0])}),He(this,Tt).setSourceDataAtCell(e)}function nee(t,e){const n=bc(e);return Ve(t,r=>(r.checked=n(r.value),r))}function ree(t){const e=[];return T(t,n=>{n.checked&&e.push(n.value)}),e}function iee(t,e){oee(t,e),e.add(t)}function oee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function see(t,e,n){return e=aee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aee(t){var e=lee(t,"string");return typeof e=="symbol"?e:String(e)}function lee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var zT=new WeakSet;class cee extends yc{constructor(e,n){super(e,{id:n.id,stateless:!1}),iee(this,zT),see(this,"name",""),this.name=n.name,this.elements.push(new Zu(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>uee(this,zT,hee).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ks){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?on:ks},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=sr(i,h=>h.name===ks),u={},c=this.hot.getTranslatedPhrase(Wd);if(l){const h=eC(Ve(s(r,a),C=>C.value));o&&(l.args[0]=o);const f=[],g=RT(h,l.args[0],c,C=>{C.checked&&f.push(C.value)}),w=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,w).locale,u.args=[f],u.command=Ls(ks),u.itemsSnapshot=g}else u.args=[],u.command=Ls(on);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Zu)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{ee(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ee(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),T(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Wd),n=eC(this._getColumnVisibleValues()),r=RT(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ve(this.hot.getDataAtCol(e.visualIndex),n=>RH(n))}}function hee(t){ml(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Rr(t))}var DH;function dee(t,e){fee(t,e),e.add(t)}function fee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gee(t,e,n){return e=mee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mee(t){var e=pee(t,"string");return typeof e=="symbol"?e:String(e)}function pee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var GT=new WeakSet;class Qu extends yc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),dee(this,GT),gee(this,"name",""),this.name=n.name,this.elements.push(new Fo(this.hot,{type:"button",value:ay,className:"htUIButton htUIButtonOK",identifier:Qu.BUTTON_OK})),this.elements.push(new Fo(this.hot,{type:"button",value:ly,className:"htUIButton htUIButtonCancel",identifier:Qu.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){T(this.elements,e=>{e.addLocalHook("click",(n,r)=>wee(this,GT,Cee).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(ee(n.parentNode,"htFiltersMenuActionBar"),T(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}DH=Qu;function Cee(t,e){e.options.identifier===DH.BUTTON_OK?this.accept():this.cancel()}function ep(t,e,n){return e=vee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vee(t){var e=See(t,"string");return typeof e=="symbol"?e:String(e)}function See(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const YT="ConditionCollection.filteringStates";class NH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;ep(this,"hot",void 0),ep(this,"isMapRegistrable",void 0),ep(this,"filteringStates",new Wf),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(YT,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$o;return e.length?iJ(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$o,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ve(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ct`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(mt(Ku[r]))throw new Error(ct`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Yo(a,s)}]},i):u.push({name:a,args:s,func:Yo(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Ft(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ve(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),T(e,n=>{T(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(YT),this.filteringStates=null,this.clearLocalHooks()}}dt(NH,Qn);const LH=NH;function jT(t,e,n){return e=yee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yee(t){var e=bee(t,"string");return typeof e=="symbol"?e:String(e)}function bee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ree{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];jT(this,"conditionCollection",void 0),jT(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return T(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return T(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return T(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const kH=Ree;function tp(t,e){Eee(t,e),e.add(t)}function Eee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cs(t,e,n){return e=Tee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tee(t){var e=_ee(t,"string");return typeof e=="symbol"?e:String(e)}function _ee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function np(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var KT=new WeakSet,XT=new WeakSet,qT=new WeakSet;class $H{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];tp(this,qT),tp(this,XT),tp(this,KT),Cs(this,"hot",void 0),Cs(this,"conditionCollection",void 0),Cs(this,"columnDataFactory",void 0),Cs(this,"changes",[]),Cs(this,"grouping",!1),Cs(this,"latestEditedColumnPosition",-1),Cs(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>np(this,KT,Mee).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>np(this,XT,Aee).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>np(this,qT,Oee).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,T(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=_I(function(c,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const g=new LH(r.hot,!1),w=[].concat(c,f);g.importAllConditions(w);const C=r.columnDataFactory(h);let S;g.isEmpty()?S=C:S=new kH(g,_=>r.columnDataFactory(_)).filter(),S=Ve(S,_=>_.meta.visualRow);const b=bc(S);return g.destroy(),sr(C,_=>b(_.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Be(this,(e,n)=>{this[n]=null})}}function Mee(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Aee(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Oee(){T(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}dt($H,Qn);const Pee=$H;function Iee(t){return J1({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof Zu)return r;if(i.element&&!Uo(i.element))return!1;i.focus()}})}const Ql="filters";function xee(t,e){const n=Iee(e),r=s=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Ql),n.setCurrentPage(e.indexOf(s))};e.forEach(s=>{s instanceof Vr&&(s.addLocalHook("click",r(s)),s.addLocalHook("focus",r(s)),s.addLocalHook("afterClose",r(s)))}),t.addLocalHook("afterSelectionChange",s=>{s.key.startsWith("filter_")||n.clear()});function i(s){const a=t.getKeyboardShortcutsCtrl(),l=s.getKeyboardShortcutsCtrl();n.clear(),l.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:a.getContext(Ql),callback:()=>{s.isSubMenu()&&s.close(),a.listen(Ql)}}]),!s.isSubMenu()&&a.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:u=>{t.getNavigator().clear(),u.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:u=>{const c=e[n.getCurrentPage()];c instanceof Xu&&(c.openOptions(),u.preventDefault()),c instanceof qu&&(c.activate(),u.preventDefault()),c instanceof Vr||u.preventDefault()}}],Ql)}t.addLocalHook("afterSubmenuOpen",i),t.addLocalHook("afterOpen",i);function o(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Ql)}return{...n,listen:o}}function Hi(t,e){FH(t,e),e.add(t)}function Hee(t,e,n){FH(t,e),e.set(t,n)}function FH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jl(t,e,n){return e=Dee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dee(t){var e=Nee(t,"string");return typeof e=="symbol"?e:String(e)}function Nee(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lee(t,e,n){var r=WH(t,e,"set");return kee(t,r,n),n}function kee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ph(t,e){var n=WH(t,e,"get");return $ee(t,n)}function WH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $ee(t,e){return e.get?e.get.call(t):e.value}function Ir(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const nC="filters",Fee=250,ZT=nC;var Ia=new WeakMap,QT=new WeakSet,JT=new WeakSet,e_=new WeakSet,t_=new WeakSet,rp=new WeakSet,n_=new WeakSet,ip=new WeakSet,r_=new WeakSet,i_=new WeakSet;class Wee extends nt{static get PLUGIN_KEY(){return nC}static get PLUGIN_PRIORITY(){return Fee}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Hi(this,i_),Hi(this,r_),Hi(this,ip),Hi(this,n_),Hi(this,rp),Hi(this,t_),Hi(this,e_),Hi(this,JT),Hi(this,QT),Jl(this,"dropdownMenuPlugin",null),Jl(this,"conditionCollection",null),Jl(this,"conditionUpdateObserver",null),Jl(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Jl(this,"filtersRowsMap",null),Hee(this,Ia,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Ir(this,r_,Yee).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[nC]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new gc),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Ir(this,rp,o_).call(this,"accept")),s.addLocalHook("cancel",()=>Ir(this,rp,o_).call(this,"cancel")),s.addLocalHook("change",a=>Ir(this,n_,Gee).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(ny)}:`,o=()=>`${this.hot.getTranslatedPhrase(ry)}:`;if(!this.components.get("filter_by_condition")){const s=new tC(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Ir(this,ip,s_).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new UJ(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new tC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Ir(this,ip,s_).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new cee(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Qu(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new LH(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Pee(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Ir(this,i_,jee).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Ir(this,t_,zee).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Ir(this,JT,Bee).call(this)),this.addHook("afterDropdownMenuHide",()=>Ir(this,e_,Uee).call(this)),this.addHook("afterChange",s=>Ir(this,QT,Vee).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Ph(this,Ia)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>s.focus()},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];Lee(this,Ia,xee(s,a));const l=u=>{Ph(this,Ia).listen(),u.preventDefault(),ml(u.keyCode,"TAB")&&(u.shiftKey?Ph(this,Ia).toPreviousItem():Ph(this,Ia).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:ZT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ZT)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$o;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ve(n.filter(),u=>u.meta.visualRow);const l=bc(i);pe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),T(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return T(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:w}=this.hot.getCellMeta(o,n),C=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:f,dateFormat:g,locale:w},value:RH(C)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=eC(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Xd&&n.command.key!==on&&r.command.key!==on&&i.command.key!==on?o=Qy:i.command.key!==on&&(n.command.key===on||r.command.key===on)&&(o=$o),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new kH(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return T(i,s=>{T(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function Vee(t){t&&T(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function Bee(){this.restoreComponents(Array.from(this.components.values()))}function Uee(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function zee(t){t.items.push({name:Ge}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function o_(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==on&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==on&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==on&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Gee(t,e){this.updateDependentComponentsVisibility(),t.constructor===tC&&!e.inputsCount&&this.setListeningDropdownMenu()}function s_(){this.setListeningDropdownMenu()}function Yee(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?ee(e,"htFiltersActive"):De(e,"htFiltersActive")}function jee(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===ks),o=n.filter(s=>s.name!==ks);if(i.length>=2||o.length>=3)pt(ct`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const VH="internal-use-in-handsontable",rC={licenseKey:VH,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function BH(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[vn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function UH(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Kee(t){var e;const n=t[vn],r=UH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=BH(t);return{...rC,...r,...i}}function Xee(t){var e;const n=t[vn],r=UH(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=BH(t);return{...r,...i}}function qee(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function og(){const t="engine_relationship",e=jr(vn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Jy(){const t="shared_engine_usage",e=jr(vn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Zee(t){const e=t.getSettings(),n=e[vn],r=n==null?void 0:n.engine;if(n===!0||mt(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Qee((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&mt(r.hyperformula)){const o=og(),s=Jy().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:VH}),(r.getConfig().leapYear1900!==rC.leapYear1900||xf(r.getConfig().nullDate,rC.nullDate)===!1)&&pt(ct`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Qee(t,e,n){const r=e[vn],i=Kee(e),o=og(),s=Jy();Jee(t,r.functions),ete(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),tte(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function a_(t){var e;const n=og(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function l_(t,e){if(t){const n=og(),r=n.get(t),i=Jy(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Jee(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){pt(s.message)}})}function ete(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){pt(r.message)}}}function tte(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){pt(a.message)}}),t.resumeEvaluation())}function nte(t,e){return(mt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const zH="DD/MM/YYYY";function GH(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function rte(t){return GH(t)?t.substr(1):t}function ite(t){return typeof t=="string"&&t.startsWith("=")}function eb(t,e){return typeof t=="string"&&e==="date"}function YH(t,e){return J(t,e,!0).isValid()}function jH(t,e){return J(t,e,!0).format(zH)}function ote(t,e){return J(t,zH,!0).format(e)}function KH(t,e){const r=new Date(Date.UTC(0,0,t+-1));return J(r).format(e)}function vs(t,e,n){ste(t,e),e.set(t,n)}function ste(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vt(t,e){var n=XH(t,e,"get");return ate(t,n)}function ate(t,e){return e.get?e.get.call(t):e.value}function yo(t,e,n){var r=XH(t,e,"set");return lte(t,r,n),n}function XH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var eu=new WeakMap,bo=new WeakMap,Jn=new WeakMap,Ih=new WeakMap,op=new WeakMap,sp=new WeakMap,xh=new WeakMap;class ute{constructor(e,n,r){vs(this,eu,{writable:!0,value:void 0}),vs(this,bo,{writable:!0,value:void 0}),vs(this,Jn,{writable:!0,value:void 0}),vs(this,Ih,{writable:!0,value:[]}),vs(this,op,{writable:!0,value:[]}),vs(this,sp,{writable:!0,value:void 0}),vs(this,xh,{writable:!0,value:[]}),yo(this,eu,e),yo(this,bo,n),yo(this,Jn,r)}setRemovedHfIndexes(e){return yo(this,xh,e.map(n=>{const r=vt(this,bo).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),vt(this,xh)}getRemovedHfIndexes(){return vt(this,xh)}getHfIndexFromVisualIndex(e){const n=vt(this,bo).getIndexesSequence(),r=vt(this,bo).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${yn(vt(this,eu))}s`;vt(this,Jn).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&vt(this,Jn).getEngine()[r](vt(this,Jn).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(yo(this,op,e.map(i=>this.getHfIndexFromVisualIndex(i))),yo(this,sp,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=vt(this,bo).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(vt(this,Jn).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(vt(this,op),vt(this,sp)));vt(this,Jn).getSheetId()===null?vt(this,Jn).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${yn(vt(this,eu))}Order`;return n=>{if(vt(this,Jn).isPerformingUndoRedo())return;const r=vt(this,bo).getIndexesSequence();if(n==="update"){const i=vt(this,Ih).map(l=>r.indexOf(l)),o=vt(this,Jn).getEngine().getSheetDimensions(vt(this,Jn).getSheetId());let s;vt(this,eu)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);vt(this,Jn).getEngine()[e](vt(this,Jn).getSheetId(),i)}yo(this,Ih,r)}}init(){yo(this,Ih,vt(this,bo).getIndexesSequence())}}const u_=ute;function Ss(t,e,n){cte(t,e),e.set(t,n)}function cte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Di(t,e){var n=qH(t,e,"get");return hte(t,n)}function hte(t,e){return e.get?e.get.call(t):e.value}function ys(t,e,n){var r=qH(t,e,"set");return dte(t,r,n),n}function qH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Hh=new WeakMap,Dh=new WeakMap,ap=new WeakMap,lp=new WeakMap,up=new WeakMap,cp=new WeakMap,hp=new WeakMap;class fte{constructor(e,n,r){Ss(this,Hh,{writable:!0,value:void 0}),Ss(this,Dh,{writable:!0,value:void 0}),Ss(this,ap,{writable:!0,value:void 0}),Ss(this,lp,{writable:!0,value:!1}),Ss(this,up,{writable:!0,value:!1}),Ss(this,cp,{writable:!0,value:null}),Ss(this,hp,{writable:!0,value:null}),ys(this,Hh,new u_("row",e,this)),ys(this,Dh,new u_("column",n,this)),ys(this,ap,r)}getForAxis(e){return e==="row"?Di(this,Hh):Di(this,Dh)}setPerformUndo(e){ys(this,lp,e)}setPerformRedo(e){ys(this,up,e)}isPerformingUndoRedo(){return Di(this,lp)||Di(this,up)}getSheetId(){return Di(this,hp)}getEngine(){return Di(this,cp)}getPostponeAction(){return Di(this,ap)}setupSyncEndpoint(e,n){ys(this,cp,e),ys(this,hp,n),Di(this,Hh).init(),Di(this,Dh).init()}}const gte=fte;function Et(t,e){ZH(t,e),e.add(t)}function xa(t,e,n){return e=mte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mte(t){var e=pte(t,"string");return typeof e=="symbol"?e:String(e)}function pte(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dp(t,e,n){ZH(t,e),e.set(t,n)}function ZH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jo(t,e,n){var r=QH(t,e,"set");return wte(t,r,n),n}function wte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function rl(t,e){var n=QH(t,e,"get");return Cte(t,n)}function QH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Cte(t,e){return e.get?e.get.call(t):e.value}function ft(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const vn="formulas",vte=["maxRows","maxColumns","language"],Ste=260;fe.getSingleton().register("afterNamedExpressionAdded");fe.getSingleton().register("afterNamedExpressionRemoved");fe.getSingleton().register("afterSheetAdded");fe.getSingleton().register("afterSheetRemoved");fe.getSingleton().register("afterSheetRenamed");fe.getSingleton().register("afterFormulasValuesUpdate");const Sl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var no=new WeakMap,tb=new WeakMap,tu=new WeakMap,c_=new WeakSet,h_=new WeakSet,fp=new WeakSet,d_=new WeakSet,gp=new WeakSet,f_=new WeakSet,g_=new WeakSet,mp=new WeakSet,m_=new WeakSet,p_=new WeakSet,w_=new WeakSet,C_=new WeakSet,v_=new WeakSet,S_=new WeakSet,y_=new WeakSet,b_=new WeakSet,R_=new WeakSet,E_=new WeakSet,T_=new WeakSet,__=new WeakSet,M_=new WeakSet,A_=new WeakSet,O_=new WeakSet,P_=new WeakSet;class yte extends nt{constructor(){var e;super(...arguments),e=this,Et(this,P_),Et(this,O_),Et(this,A_),Et(this,M_),Et(this,__),Et(this,T_),Et(this,E_),Et(this,R_),Et(this,b_),Et(this,y_),Et(this,S_),Et(this,v_),Et(this,C_),Et(this,w_),Et(this,p_),Et(this,m_),Et(this,mp),Et(this,g_),Et(this,f_),Et(this,gp),Et(this,d_),Et(this,fp),Et(this,h_),Et(this,c_),dp(this,no,{writable:!0,value:!1}),dp(this,tb,{writable:!0,value:!1}),dp(this,tu,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,T_,kte).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,__,$te).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,M_,Fte).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,A_,Wte).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,O_,Vte).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return ft(e,P_,Bte).call(e,...r)}]]}),xa(this,"staticRegister",jr("formulas")),xa(this,"engine",null),xa(this,"sheetName",null),xa(this,"indexSyncer",null),xa(this,"rowAxisSyncer",null),xa(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return vn}static get PLUGIN_PRIORITY(){return Ste}static get SETTING_KEYS(){return[vn,...vte]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[vn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Zee(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){pt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,fp,I_).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,gp,x_).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,fp,I_).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,gp,x_).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,f_,Tte).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,g_,_te).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,c_,bte).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,m_,Mte).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,mp,H_).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,mp,H_).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,p_,Ate).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,w_,Ote).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,S_,xte).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,y_,Hte).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,C_,Pte).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,v_,Ite).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,b_,Dte).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,R_,Nte).call(n,...i)}),this.indexSyncer=new gte(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,d_,Ete).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,E_,Lte).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ft(n,h_,Rte).call(n,...i)}),rl(this,tu).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){rl(this,tu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),l_(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=Xee(this.hot.getSettings());qee(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[vn];if(le(r)&&le(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[vn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){rl(this,tu).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),jo(this,tu,null),l_(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(le(n)&&!Hx(n))return pt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return pt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return pt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){fv(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${yn(vn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),a_(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return le(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(le(l)===!1||le(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const f=a_(this.engine).get(c);if(!f)return;f.validateCell(f.getDataAtCell(l,u),f.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){pt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return eb(r,o.type)&&(YH(r,o.dateFormat)?r=jH(r,o.dateFormat):ite(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function bte(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Nn(s)&&(s=KH(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Rte(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},f={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(f)===!1)return!1;const g=this.engine.getFillRangeData(h,f),{row:w,col:C}=h.start,{row:S,col:b}=h.end,_=S-w+1,O=b-C+1;for(let x=0;x<g.length;x+=1)for(let I=0;I<g[x].length;I+=1){const $=g[x][I],z=x%_,q=I%O,Y=this.hot.getCellMeta(z,q);eb($,Y.type)&&($.startsWith("'")?g[x][I]=$.slice(1):this.isFormulaCellType(z,q,this.sheetId)===!1&&(g[x][I]=ote($,Y.dateFormat)))}return g}function I_(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(yn(vn))||jo(this,tb,mt(this.hot.getSettings().data))}function Ete(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;eb(i,s.type)&&(e=!0,YH(i,a)?t[r][o]=jH(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(jo(this,no,!0),this.engine.setSheetContent(this.sheetId,t),jo(this,no,!1))}function x_(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(yn(vn)))if(this.sheetName=nte(this.engine,this.hot.getSettings()[vn].sheetName),rl(this,tb))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){jo(this,no,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),jo(this,no,!1)}}}function Tte(t,e,n,r){if(r!=="get"||rl(this,no)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){GH(n.value)&&(n.value=rte(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s);const l=this.hot.getCellMeta(i,e);l.type==="date"&&Nn(a)&&(a=KH(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function _te(t,e,n,r){if(r!=="get"||rl(this,no)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function H_(t,e){if(Sl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),f={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:f})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Mte(t,e){if(Sl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Nn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){pt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Ate(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function Ote(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Pte(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Ite(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function xte(t,e,n){if(Sl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Hte(t,e,n){if(Sl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Dte(t,e,n,r){if(Sl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Nte(t,e,n,r){if(Sl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function Lte(t,e,n){var r;jo(this,no,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());jo(this,no,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function kte(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function $te(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Fte(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Wte(t){this.hot.runHooks("afterSheetAdded",t)}function Vte(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function Bte(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function Ute(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(HS,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function zte(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(DS,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ve(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return T(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function bs(t,e){JH(t,e),e.add(t)}function D_(t,e,n){JH(t,e),e.set(t,n)}function JH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rs(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function rr(t,e){var n=eD(t,e,"get");return Gte(t,n)}function Gte(t,e){return e.get?e.get.call(t):e.value}function nu(t,e,n){var r=eD(t,e,"set");return Yte(t,r,n),n}function eD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("beforeHideColumns");fe.getSingleton().register("afterHideColumns");fe.getSingleton().register("beforeUnhideColumns");fe.getSingleton().register("afterUnhideColumns");const pp="hiddenColumns",jte=310,tD="beforeHiddenColumnIndicator",nD="afterHiddenColumnIndicator";var fi=new WeakMap,ii=new WeakMap,N_=new WeakSet,L_=new WeakSet,k_=new WeakSet,$_=new WeakSet,F_=new WeakSet,W_=new WeakSet,V_=new WeakSet;class Kte extends nt{constructor(){super(...arguments),bs(this,V_),bs(this,W_),bs(this,F_),bs(this,$_),bs(this,k_),bs(this,L_),bs(this,N_),D_(this,fi,{writable:!0,value:{}}),D_(this,ii,{writable:!0,value:null})}static get PLUGIN_KEY(){return pp}static get PLUGIN_PRIORITY(){return jte}isEnabled(){return!!this.hot.getSettings()[pp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[pp];$e(n)&&(nu(this,fi,n),mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),nu(this,ii,new Ff),rr(this,ii).addLocalHook("init",()=>Rs(this,V_,tne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,rr(this,ii)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rs(e,W_,ene).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Rs(this,k_,Zte).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>Rs(this,L_,qte).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Rs(e,F_,Jte).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Rs(this,$_,Qte).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(n,r)=>{Rs(this,N_,Xte).call(this,r)};this.hot.columnIndexMapper.unregisterMap(this.pluginName),nu(this,fi,{}),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=rr(this,ii).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));T(l,u=>{o[u]=!1}),i=Ft(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&rr(this,ii).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{rr(this,ii).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ve(rr(this,ii).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return rr(this,ii).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){nu(this,fi,null),nu(this,ii,null),super.destroy()}}function Xte(t){Array.from(t.querySelectorAll(`.${nD}, .${tD}`)).forEach(e=>{e.remove()})}function qte(t,e){if(this.isHidden(e))return 0;if(rr(this,fi).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function Zte(t,e,n){if(rr(this,fi).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Qte(t){if(rr(this,fi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;pe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Jte(t,e){const n=this.hot.getSettings().ariaTags,r=e.querySelector(".beforeHiddenColumnIndicator"),i=e.querySelector(".afterHiddenColumnIndicator");if(!rr(this,fi).indicators||t<0){r==null||r.remove(),i==null||i.remove();return}const o=[];if(t>=1&&this.isHidden(t-1)){if(!i){const s=n?[Wo(this.hot.getTranslatedPhrase(yy))]:[];Bs(e,{tagName:"div",attributes:s,className:nD})}o.push("afterHiddenColumn")}if(t<this.hot.countCols()-1&&this.isHidden(t+1)){if(!r){const s=n?[Wo(this.hot.getTranslatedPhrase(Sy))]:[];Bs(e,{tagName:"div",attributes:s,className:tD})}o.push("beforeHiddenColumn")}ee(e,o)}function ene(t){t.items.push({name:Ge},Ute(this),zte(this))}function tne(){Array.isArray(rr(this,fi).columns)&&this.hideColumns(rr(this,fi).columns)}function nne(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(NS,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function rne(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(LS,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ve(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,f=l-a+1;if(h>f){const g=u.slice(i,o+1);c.push(...g.filter(w=>n.includes(w)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,f=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===f&&h>o&&c.push(...u.slice(o+1))}return T(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function Es(t,e){rD(t,e),e.add(t)}function B_(t,e,n){rD(t,e),e.set(t,n)}function rD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ts(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function wr(t,e){var n=iD(t,e,"get");return ine(t,n)}function ine(t,e){return e.get?e.get.call(t):e.value}function ru(t,e,n){var r=iD(t,e,"set");return one(t,r,n),n}function iD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function one(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("beforeHideRows");fe.getSingleton().register("afterHideRows");fe.getSingleton().register("beforeUnhideRows");fe.getSingleton().register("afterUnhideRows");const wp="hiddenRows",sne=320,oD="afterHiddenRowIndicator",sD="beforeHiddenRowIndicator";var Xi=new WeakMap,oi=new WeakMap,U_=new WeakSet,z_=new WeakSet,G_=new WeakSet,Y_=new WeakSet,j_=new WeakSet,K_=new WeakSet,X_=new WeakSet;class ane extends nt{constructor(){super(...arguments),Es(this,X_),Es(this,K_),Es(this,j_),Es(this,Y_),Es(this,G_),Es(this,z_),Es(this,U_),B_(this,Xi,{writable:!0,value:{}}),B_(this,oi,{writable:!0,value:null})}static get PLUGIN_KEY(){return wp}static get PLUGIN_PRIORITY(){return sne}isEnabled(){return!!this.hot.getSettings()[wp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[wp];$e(n)&&(ru(this,Xi,n),mt(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),ru(this,oi,new Ff),wr(this,oi).addLocalHook("init",()=>Ts(this,X_,gne).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,wr(this,oi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ts(e,K_,fne).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Ts(this,G_,cne).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>Ts(this,z_,une).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ts(e,j_,dne).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Ts(this,Y_,hne).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){const e=(n,r)=>{Ts(this,U_,lne).call(this,r)};this.hot.rowIndexMapper.unregisterMap(this.pluginName),ru(this,Xi,{}),this.hot.addHook("afterGetRowHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetRowHeader",e)}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=wr(this,oi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));T(l,u=>{o[u]=!1}),i=Ft(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&wr(this,oi).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{wr(this,oi).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ve(wr(this,oi).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return wr(this,oi).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){T(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){ru(this,Xi,null),ru(this,oi,null),super.destroy()}}function lne(t){Array.from(t.querySelectorAll(`.${oD}, .${sD}`)).forEach(e=>{e.remove()})}function une(t,e){return this.isHidden(e)?0:t}function cne(t,e,n){if(wr(this,Xi).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function hne(t){if(wr(this,Xi).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return T(t,r=>{let i=!0,o=0;pe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function dne(t,e){const n=this.hot.getSettings().ariaTags,r=e.querySelector(".beforeHiddenRowIndicator"),i=e.querySelector(".afterHiddenRowIndicator");if(!wr(this,Xi).indicators||t<0){r==null||r.remove(),i==null||i.remove();return}const o=[];if(t>=1&&this.isHidden(t-1)){if(!i){const s=n?[Wo(this.hot.getTranslatedPhrase(Ty))]:[];Bs(e,{tagName:"div",attributes:s,className:oD})}o.push("afterHiddenRow")}if(t<this.hot.countRows()-1&&this.isHidden(t+1)){if(!r){const s=n?[Wo(this.hot.getTranslatedPhrase(Ey))]:[];Bs(e,{tagName:"div",attributes:s,className:sD})}o.push("beforeHiddenRow")}ee(e,o)}function fne(t){t.items.push({name:Ge},nne(this),rne(this))}function gne(){Array.isArray(wr(this,Xi).rows)&&this.hideRows(wr(this,Xi).rows)}function mne(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(uS)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function pne(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(cS)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function q_(t,e){aD(t,e),e.add(t)}function wne(t,e,n){aD(t,e),e.set(t,n)}function aD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iC(t,e){var n=lD(t,e,"get");return Cne(t,n)}function Cne(t,e){return e.get?e.get.call(t):e.value}function Cp(t,e,n){var r=lD(t,e,"set");return vne(t,r,n),n}function lD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Z_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeColumnFreeze");fe.getSingleton().register("afterColumnFreeze");fe.getSingleton().register("beforeColumnUnfreeze");fe.getSingleton().register("afterColumnUnfreeze");const Q_="manualColumnFreeze",Sne=110;var xs=new WeakMap,J_=new WeakSet,eM=new WeakSet;class yne extends nt{constructor(){super(...arguments),q_(this,eM),q_(this,J_),wne(this,xs,{writable:!0,value:!1})}static get PLUGIN_KEY(){return Q_}static get PLUGIN_PRIORITY(){return Sne}isEnabled(){return!!this.hot.getSettings()[Q_]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Z_(this,J_,bne).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>Z_(this,eM,Rne).call(this,e,n)),super.enablePlugin())}disablePlugin(){Cp(this,xs,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;iC(this,xs)||Cp(this,xs,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;iC(this,xs)||Cp(this,xs,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function bne(t){t.items.push({name:"---------"},mne(this),pne(this))}function Rne(t,e){if(iC(this,xs)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Nh(t,e,n){return e=Ene(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ene(t){var e=Tne(t,"string");return typeof e=="symbol"?e:String(e)}function Tne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vp=0,tM=1,nM=2,Ha="px";let _ne=class{constructor(e){Nh(this,"hot",void 0),Nh(this,"_element",null),Nh(this,"state",vp),Nh(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=nM}build(){this.state===vp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=tM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=vp}isAppended(){return this.state===nM}isBuilt(){return this.state>=tM}setPosition(e,n){Nn(e)&&(this._element.style.top=e+Ha),Nn(n)&&(this._element.style[this.inlineProperty]=n+Ha)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Nn(e)&&(this._element.style.width=e+Ha),Nn(n)&&(this._element.style.height=n+Ha)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Nn(e)&&(this._element.style.marginTop=e+Ha),Nn(n)&&(this._element.style[`margin${yn(this.inlineProperty)}`]=n+Ha)}getOffset(){const e=this._element.style,n=`margin${yn(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const uD=_ne,Mne="ht__manualColumnMove--backlight";let Ane=class extends uD{build(){super.build(),ee(this._element,Mne)}};const One=Ane,Pne="ht__manualColumnMove--guideline";let Ine=class extends uD{build(){super.build(),ee(this._element,Pne)}};const xne=Ine;function Da(t,e){cD(t,e),e.add(t)}function Ni(t,e,n){cD(t,e),e.set(t,n)}function cD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rM(t,e,n){return e=Hne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hne(t){var e=Dne(t,"string");return typeof e=="symbol"?e:String(e)}function Dne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Kn(t,e,n){var r=hD(t,e,"set");return Nne(t,r,n),n}function Nne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ne(t,e){var n=hD(t,e,"get");return Lne(t,n)}function hD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Lne(t,e){return e.get?e.get.call(t):e.value}function Na(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeColumnMove");fe.getSingleton().register("afterColumnMove");const Sp="manualColumnMove",kne=120,iM="ht__manualColumnMove",Zd="show-ui",oC="on-moving--columns",sC="after-selection--columns";var qi=new WeakMap,gd=new WeakMap,xo=new WeakMap,Dn=new WeakMap,Lh=new WeakMap,gr=new WeakMap,Ya=new WeakMap,Qd=new WeakMap,Au=new WeakMap,oM=new WeakSet,sM=new WeakSet,aM=new WeakSet,lM=new WeakSet,uM=new WeakSet,cM=new WeakSet;class $ne extends nt{constructor(){super(...arguments),Da(this,cM),Da(this,uM),Da(this,lM),Da(this,aM),Da(this,sM),Da(this,oM),rM(this,"backlight",new One(this.hot)),rM(this,"guideline",new xne(this.hot)),Ni(this,qi,{writable:!0,value:[]}),Ni(this,gd,{writable:!0,value:0}),Ni(this,xo,{writable:!0,value:!1}),Ni(this,Dn,{writable:!0,value:{}}),Ni(this,Lh,{writable:!0,value:void 0}),Ni(this,gr,{writable:!0,value:void 0}),Ni(this,Ya,{writable:!0,value:void 0}),Ni(this,Qd,{writable:!0,value:void 0}),Ni(this,Au,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Sp}static get PLUGIN_PRIORITY(){return kne}isEnabled(){return!!this.hot.getSettings()[Sp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Na(e,oM,Fne).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Na(e,aM,Vne).call(e,...r)}),this.addHook("afterScrollVertically",()=>Na(this,uM,Une).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Na(e,cM,zne).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,iM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){De(this.hot.rootElement,iM),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=Ne(this,Lh),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(Kn(this,Lh,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return Kn(this,Lh,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Ft(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Sp];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return pe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Ne(this,gr))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Ne(this,gr)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=this.backlight.getOffset().start,u=this.backlight.getSize().width;let c=0,h=0;if(this.hot.isRtl()){const w=this.hot.rootWindow,C=ut(this.hot.rootElement),S=w.innerWidth-Ne(this,Ya)-C;h=w.innerWidth-Ne(this,Dn).eventPageX-S-(r.scrollX===void 0?i:0)}else h=Ne(this,Dn).eventPageX-(Ne(this,Ya)-(r.scrollX===void 0?i:0));if(Ne(this,Qd)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Ne(this,gr))&&(o+=i),o+=c,Ne(this,gr)<0)Ne(this,Au)>0?Ne(this,Dn).col=0:Ne(this,Dn).col=e>0?e-1:e;else if(Ne(this,Dn).TD.offsetWidth/2+o<=h){const w=Ne(this,gr)>=Ne(this,gd)?Ne(this,gd)-1:Ne(this,gr);Ne(this,Dn).col=w+1,o+=Ne(this,Dn).TD.offsetWidth}else Ne(this,Dn).col=Ne(this,gr);let f=h,g=o;h+u+l>=s?f=s-u-l:h+l<a+c&&(f=a+c+Math.abs(l)),o>=s-1?g=s-1:g===0?g=1:r.scrollX!==void 0&&Ne(this,gr)<Ne(this,Au)&&(g-=Ne(this,Ya)<=r.scrollX?Ne(this,Ya):0),this.backlight.setPosition(null,f),this.guideline.setPosition(null,g)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Na(this,sM,Wne).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Na(this,lM,Bne).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function Fne(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Pe(t.target,"sortAction");if(!s||!o||Ne(this,xo)||t.button!==0||a){Kn(this,xo,!1),Ne(this,qi).length=0,De(this.hot.rootElement,[oC,Zd]);return}const l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:h}=s,f=Math.min(c.col,h.col),g=Math.max(c.col,h.col);if(e.row<0&&e.col>=f&&e.col<=g){r.column=!0,Kn(this,xo,!0);const w=n.firstChild?FI(t,n.firstChild).x:t.offsetX;Ne(this,Dn).eventPageX=t.pageX,Kn(this,gr,e.col),Ne(this,Dn).TD=n,Ne(this,Dn).col=e.col,Kn(this,qi,this.prepareColumnsToMoving(f,g)),Kn(this,Qd,!!this.hot.getSettings().rowHeaders),Kn(this,gd,this.hot.countCols()),Kn(this,Au,this.hot.getSettings().fixedColumnsStart),Kn(this,Ya,Bt(this.hot.rootElement).left);const C=Ne(this,Qd)?-1:0,S=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,b=e.col<Ne(this,Au),_=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),O=Math.abs(w-(this.hot.isRtl()?n.offsetWidth:0)),x=this.getColumnsWidth(f,e.col-1)+O,I=this.getColumnsWidth(C,f-1)+(b?_:0)+x;this.backlight.setPosition(S,I),this.backlight.setSize(this.getColumnsWidth(f,g),i.hider.offsetHeight-S),this.backlight.setOffset(null,-x),ee(this.hot.rootElement,oC)}else De(this.hot.rootElement,sC),Kn(this,xo,!1),Ne(this,qi).length=0}function Wne(t){Ne(this,xo)&&(Ne(this,Dn).eventPageX=t.pageX,this.refreshPositions())}function Vne(t,e,n,r){!this.hot.getSelectedRangeLast()||!Ne(this,xo)||(Ne(this,qi).indexOf(e.col)>-1?De(this.hot.rootElement,Zd):ee(this.hot.rootElement,Zd),r.row=!0,r.column=!0,r.cell=!0,Kn(this,gr,e.col),Ne(this,Dn).TD=n)}function Bne(){const t=Ne(this,Dn).col,e=Ne(this,qi).length;if(Kn(this,gr,void 0),Kn(this,xo,!1),De(this.hot.rootElement,[oC,Zd,sC]),this.hot.selection.isSelectedByColumnHeader()&&ee(this.hot.rootElement,sC),e<1||t===void 0)return;const n=Ne(this,qi)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(Ne(this,qi),t);if(Ne(this,qi).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Une(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;this.backlight.setPosition(r),this.backlight.setSize(null,t.hider.offsetHeight-r)}function zne(){this.moveBySettingsOrLoad()}function Li(t,e){dD(t,e),e.add(t)}function Gne(t,e,n){dD(t,e),e.set(t,n)}function dD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pn(t,e,n){return e=Yne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yne(t){var e=jne(t,"string");return typeof e=="symbol"?e:String(e)}function jne(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hM(t,e){var n=gD(t,e,"get");return Kne(t,n)}function Kne(t,e){return e.get?e.get.call(t):e.value}function fD(t,e,n){var r=gD(t,e,"set");return Xne(t,r,n),n}function gD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Xne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ki(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Jd="manualColumnResize",qne=130,dM="manualColumnWidths";var Ou=new WeakMap,fM=new WeakSet,gM=new WeakSet,mM=new WeakSet,pM=new WeakSet,wM=new WeakSet,CM=new WeakSet,vM=new WeakSet,SM=new WeakSet,yM=new WeakSet;class Zne extends nt{static get PLUGIN_KEY(){return Jd}static get PLUGIN_PRIORITY(){return qne}constructor(e){super(e),Li(this,yM),Li(this,SM),Li(this,vM),Li(this,CM),Li(this,wM),Li(this,pM),Li(this,mM),Li(this,gM),Li(this,fM),Pn(this,"currentTH",null),Pn(this,"currentCol",null),Pn(this,"selectedCols",[]),Pn(this,"currentWidth",null),Pn(this,"newSize",null),Pn(this,"startY",null),Pn(this,"startWidth",null),Pn(this,"startOffset",null),Pn(this,"handle",this.hot.rootDocument.createElement("DIV")),Pn(this,"guide",this.hot.rootDocument.createElement("DIV")),Pn(this,"pressed",null),Pn(this,"isTriggeredByRMB",!1),Pn(this,"dblclick",0),Pn(this,"autoresizeTimeout",null),Pn(this,"columnWidthsMap",void 0),Gne(this,Ou,{writable:!0,value:void 0}),ee(this.handle,"manualColumnResizer"),ee(this.guide,"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Jd]}enablePlugin(){this.enabled||(this.columnWidthsMap=new Xo,this.columnWidthsMap.addLocalHook("init",()=>ki(this,fM,Qne).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,this.columnWidthsMap),this.addHook("modifyColWidth",(e,n)=>ki(this,vM,ire).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>ki(this,SM,ore).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>ki(this,yM,sre).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){fD(this,Ou,this.columnWidthsMap.getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",dM,this.columnWidthsMap.getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",dM,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return this.columnWidthsMap.setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;this.currentTH=e;const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(this.currentTH),i=r.col;if(i<0)return;const o=Ot(this.currentTH),s=this.currentTH.getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(this.currentTH,r.row,r.col)),this.currentCol=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),this.selectedCols=[];const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();T(c,h=>{const f=h.getTopStartCorner().col,g=h.getBottomEndCorner().col;pe(f,g,w=>{this.selectedCols.includes(w)||this.selectedCols.push(w)})})}this.selectedCols.includes(this.currentCol)||(this.selectedCols=[this.currentCol]),this.startOffset=l.start-6,this.startWidth=parseInt(s.width,10),this.handle.style.top=`${l.top}px`,this.handle.style[this.inlineDir]=`${this.startOffset+this.startWidth}px`,this.handle.style.height=`${o}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style[this.inlineDir]=`${this.startOffset+this.currentWidth}px`}setupGuidePosition(){const e=parseInt(Ot(this.handle),10),n=parseInt(this.handle.style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ee(this.handle,"active"),ee(this.guide,"active"),this.guide.style.top=`${n}px`,this.refreshGuidePosition(),this.guide.style.height=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style[this.inlineDir]=this.handle.style[this.inlineDir]}hideHandleAndGuide(){De(this.handle,"active"),De(this.guide,"active")}checkIfColumnHeader(e){return!!Vo(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",this.newSize,r,!0);o!==void 0&&(this.newSize=o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,this.newSize),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,r,!0),i&&e()};this.dblclick>=2&&(this.selectedCols.length>1?(T(this.selectedCols,i=>{n(i)}),e()):T(this.selectedCols,i=>{n(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>ki(this,gM,Jne).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>ki(this,mM,ere).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>ki(this,pM,tre).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>ki(this,wM,nre).call(this)),this.eventManager.addEventListener(this.handle,"contextmenu",()=>ki(this,CM,rre).call(this))}destroy(){super.destroy()}}function Qne(){const t=this.hot.getSettings()[Jd],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0),fD(this,Ou,t)):t===!0&&Array.isArray(hM(this,Ou))&&this.hot.batchExecution(()=>{hM(this,Ou).forEach((n,r)=>{this.columnWidthsMap.setValueAtIndex(r,n)})},!0)}function Jne(t){if(!rv(t.target)&&this.isTriggeredByRMB!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(this.pressed||this.setupHandlePosition(e))}}function ere(t){Pe(t.target,"manualColumnResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startX=t.pageX,this.newSize=this.startWidth)}function tre(t){if(this.pressed){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();this.currentWidth=this.startWidth+e,T(this.selectedCols,n=>{this.newSize=this.setManualSize(n,this.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function nre(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",this.newSize,n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",this.newSize,n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startWidth&&(this.selectedCols.length>1?(T(this.selectedCols,r=>{e(r)}),t()):T(this.selectedCols,r=>{e(r,!0)})),this.setupHandlePosition(this.currentTH))}function rre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}function ire(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=this.columnWidthsMap.getValueAtIndex(r);this.hot.getSettings()[Jd]&&i&&(n=i)}return n}function ore(t,e){let n=this.columnWidthsMap.getValueAtIndex(e);return n===null&&(n=t),n}function sre(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function yp(t,e,n){return e=are(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function are(t){var e=lre(t,"string");return typeof e=="symbol"?e:String(e)}function lre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const bp=0,bM=1,RM=2,La="px";let ure=class{constructor(e){yp(this,"hot",void 0),yp(this,"_element",null),yp(this,"state",bp),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=RM}build(){this.state===bp&&(this._element=this.hot.rootDocument.createElement("div"),this.state=bM)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=bp}isAppended(){return this.state===RM}isBuilt(){return this.state>=bM}setPosition(e,n){e!==void 0&&(this._element.style.top=e+La),n!==void 0&&(this._element.style.left=n+La)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+La),n&&(this._element.style.height=n+La)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+La),n&&(this._element.style.marginLeft=n+La)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const mD=ure,cre="ht__manualRowMove--backlight";class hre extends mD{build(){super.build(),ee(this._element,cre)}}const dre=hre,fre="ht__manualRowMove--guideline";class gre extends mD{build(){super.build(),ee(this._element,fre)}}const mre=gre;function ka(t,e){pD(t,e),e.add(t)}function kh(t,e,n){pD(t,e),e.set(t,n)}function pD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EM(t,e,n){return e=pre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pre(t){var e=wre(t,"string");return typeof e=="symbol"?e:String(e)}function wre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $s(t,e,n){var r=wD(t,e,"set");return Cre(t,r,n),n}function Cre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Mt(t,e){var n=wD(t,e,"get");return vre(t,n)}function wD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vre(t,e){return e.get?e.get.call(t):e.value}function $a(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeRowMove");fe.getSingleton().register("afterRowMove");const Rp="manualRowMove",Sre=140,TM="ht__manualRowMove",ef="show-ui",aC="on-moving--rows",lC="after-selection--rows";var Zi=new WeakMap,Ho=new WeakMap,Xn=new WeakMap,$h=new WeakMap,_M=new WeakSet,MM=new WeakSet,AM=new WeakSet,OM=new WeakSet,PM=new WeakSet,IM=new WeakSet;class yre extends nt{constructor(){super(...arguments),ka(this,IM),ka(this,PM),ka(this,OM),ka(this,AM),ka(this,MM),ka(this,_M),EM(this,"backlight",new dre(this.hot)),EM(this,"guideline",new mre(this.hot)),kh(this,Zi,{writable:!0,value:[]}),kh(this,Ho,{writable:!0,value:void 0}),kh(this,Xn,{writable:!0,value:{}}),kh(this,$h,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Rp}static get PLUGIN_PRIORITY(){return Sre}isEnabled(){return!!this.hot.getSettings()[Rp]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $a(e,_M,bre).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $a(e,AM,Ere).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>$a(this,PM,_re).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return $a(e,IM,Mre).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),ee(this.hot.rootElement,TM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){De(this.hot.rootElement,TM),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=Mt(this,$h),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if($s(this,$h,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return $s(this,$h,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Ft(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Rp];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return pe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=Mt(this,Xn).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=Mt(this,Xn).TD,a=this.hot.rootElement,l=Bt(a),u=Vs(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,f=l.top-h,g=Mt(this,Xn).eventPageY-f+c,w=o.hider.offsetHeight,C=o.TBODY.offsetTop,S=this.backlight.getOffset().top,b=this.backlight.getSize().height,_=s.offsetHeight/2,O=s.offsetHeight;let x=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const I=g>=x+_;this.isFixedRowTop(e.row)&&(x+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Mt(this,Xn).row=n>0?n-1:n:I?(Mt(this,Xn).row=e.row+1,x+=e.row===0?O-1:O):Mt(this,Xn).row=e.row;let $=g,z=x;g+b+S>=w?$=w-b-S:g+S<C&&($=C+Math.abs(S)),x>=w-1&&(z=w-1),this.backlight.setPosition($),this.guideline.setPosition(z)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>$a(this,MM,Rre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>$a(this,OM,Tre).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){this.backlight.build(),this.guideline.build()}destroy(){this.backlight.destroy(),this.guideline.destroy(),super.destroy()}}function bre(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||Mt(this,Ho)||t.button!==0){$s(this,Ho,!1),Mt(this,Zi).length=0,De(this.hot.rootElement,[aC,ef]);return}const l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(i.hider),this.backlight.appendTo(i.hider));const{from:c,to:h}=a,f=Math.min(c.row,h.row),g=Math.max(c.row,h.row);if(e.col<0&&e.row>=f&&e.row<=g){r.row=!0,$s(this,Ho,!0),Mt(this,Xn).eventPageY=t.pageY,Mt(this,Xn).coords=e,Mt(this,Xn).TD=n,$s(this,Zi,this.prepareRowsToMoving());const w=i.holder.scrollLeft+o.getRowHeaderWidth(),C=this.getRowsHeight(f,e.row-1)+t.offsetY;this.backlight.setPosition(null,w),this.backlight.setSize(i.hider.offsetWidth-w,this.getRowsHeight(f,g)),this.backlight.setOffset(-C,null),ee(this.hot.rootElement,aC),this.refreshPositions()}else De(this.hot.rootElement,lC),$s(this,Ho,!1),Mt(this,Zi).length=0}function Rre(t){Mt(this,Ho)&&(Mt(this,Xn).eventPageY=t.pageY,this.refreshPositions())}function Ere(t,e,n,r){!this.hot.getSelectedRangeLast()||!Mt(this,Ho)||(Mt(this,Zi).indexOf(e.row)>-1?De(this.hot.rootElement,ef):ee(this.hot.rootElement,ef),r.row=!0,r.column=!0,r.cell=!0,Mt(this,Xn).coords=e,Mt(this,Xn).TD=n)}function Tre(){const t=Mt(this,Xn).row,e=Mt(this,Zi).length;if($s(this,Ho,!1),De(this.hot.rootElement,[aC,ef,lC]),this.hot.selection.isSelectedByRowHeader()&&ee(this.hot.rootElement,lC),e<1||t===void 0)return;const n=Mt(this,Zi)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(Mt(this,Zi),t);if(Mt(this,Zi).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function _re(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;this.backlight.setPosition(null,r),this.backlight.setSize(t.hider.offsetWidth-r)}function Mre(){this.moveBySettingsOrLoad()}function _s(t,e){CD(t,e),e.add(t)}function Are(t,e,n){CD(t,e),e.set(t,n)}function CD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function In(t,e,n){return e=Ore(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ore(t){var e=Pre(t,"string");return typeof e=="symbol"?e:String(e)}function Pre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xM(t,e){var n=SD(t,e,"get");return Ire(t,n)}function Ire(t,e){return e.get?e.get.call(t):e.value}function vD(t,e,n){var r=SD(t,e,"set");return xre(t,r,n),n}function SD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function xre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ms(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const tf="manualRowResize",Hre=30,HM="manualRowHeights";var Pu=new WeakMap,DM=new WeakSet,NM=new WeakSet,LM=new WeakSet,kM=new WeakSet,$M=new WeakSet,FM=new WeakSet,WM=new WeakSet;class Dre extends nt{static get PLUGIN_KEY(){return tf}static get PLUGIN_PRIORITY(){return Hre}constructor(e){super(e),_s(this,WM),_s(this,FM),_s(this,$M),_s(this,kM),_s(this,LM),_s(this,NM),_s(this,DM),In(this,"currentTH",null),In(this,"currentRow",null),In(this,"selectedRows",[]),In(this,"currentHeight",null),In(this,"newSize",null),In(this,"startY",null),In(this,"startHeight",null),In(this,"startOffset",null),In(this,"handle",this.hot.rootDocument.createElement("DIV")),In(this,"guide",this.hot.rootDocument.createElement("DIV")),In(this,"pressed",!1),In(this,"isTriggeredByRMB",!1),In(this,"dblclick",0),In(this,"autoresizeTimeout",null),In(this,"rowHeightsMap",void 0),Are(this,Pu,{writable:!0,value:void 0}),ee(this.handle,"manualRowResizer"),ee(this.guide,"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[tf]}enablePlugin(){this.enabled||(this.rowHeightsMap=new Xo,this.rowHeightsMap.addLocalHook("init",()=>Ms(this,WM,Vre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,this.rowHeightsMap),this.addHook("modifyRowHeight",(e,n)=>Ms(this,FM,Wre).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){vD(this,Pu,this.rowHeightsMap.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",HM,this.rowHeightsMap.getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",HM,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,ax.DEFAULT_HEIGHT);return this.rowHeightsMap.setValueAtIndex(r,i),i}setupHandlePosition(e){this.currentTH=e;const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(this.currentTH),o=i.row;if(o<0)return;const s=ut(this.currentTH),a=this.currentTH.getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(this.currentTH,i.row,i.col)),this.currentRow=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),this.selectedRows=[];const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const f=this.hot.getSelectedRange();T(f,g=>{const w=g.getTopStartCorner().row,C=g.getBottomStartCorner().row;pe(w,C,S=>{this.selectedRows.includes(S)||this.selectedRows.push(S)})})}this.selectedRows.includes(this.currentRow)||(this.selectedRows=[this.currentRow]),this.startOffset=c.top-6,this.startHeight=parseInt(a.height,10),this.handle.style.top=`${this.startOffset+this.startHeight}px`,this.handle.style[this.inlineDir]=`${c.start}px`,this.handle.style.width=`${s}px`,this.hot.rootElement.appendChild(this.handle)}refreshHandlePosition(){this.handle.style.top=`${this.startOffset+this.currentHeight}px`}setupGuidePosition(){const e=parseInt(ut(this.handle),10),n=parseInt(this.handle.style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ee(this.handle,"active"),ee(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style[this.inlineDir]=`${n}px`,this.guide.style.width=`${r-e}px`,this.hot.rootElement.appendChild(this.guide)}refreshGuidePosition(){this.guide.style.top=this.handle.style.top}hideHandleAndGuide(){De(this.handle,"active"),De(this.guide,"active")}checkIfRowHeader(e){var n;return Vo(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&this.newSize<n?n:this.newSize}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&(this.newSize=o),this.setManualSize(r,this.newSize),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};this.dblclick>=2&&(this.selectedRows.length>1?(T(this.selectedRows,i=>{n(i)}),e()):T(this.selectedRows,i=>{n(i,!0)})),this.dblclick=0,this.autoresizeTimeout=null}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Ms(this,DM,Nre).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ms(this,NM,Lre).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Ms(this,LM,kre).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Ms(this,kM,$re).call(this)),this.eventManager.addEventListener(this.handle,"contextmenu",()=>Ms(this,$M,Fre).call(this))}destroy(){super.destroy()}}function Nre(t){if(!rv(t.target)&&this.isTriggeredByRMB!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(this.pressed||this.setupHandlePosition(e))}}function Lre(t){Pe(t.target,"manualRowResizer")&&(this.setupHandlePosition(this.currentTH),this.setupGuidePosition(),this.pressed=!0,this.autoresizeTimeout===null&&(this.autoresizeTimeout=setTimeout(()=>this.afterMouseDownTimeout(),500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick+=1,this.startY=t.pageY,this.newSize=this.startHeight)}function kre(t){this.pressed&&(this.currentHeight=this.startHeight+(t.pageY-this.startY),T(this.selectedRows,e=>{this.newSize=this.setManualSize(e,this.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())}function $re(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};this.pressed&&(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!==this.startHeight&&(this.selectedRows.length>1?(T(this.selectedRows,r=>{e(r)}),t()):T(this.selectedRows,r=>{e(r,!0)})),this.setupHandlePosition(this.currentTH))}function Fre(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(this.handle),this.hot.rootElement.removeChild(this.guide),this.pressed=!1,this.isTriggeredByRMB=!0,this.hot._registerImmediate(()=>{this.isTriggeredByRMB=!1})}function Wre(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=this.rowHeightsMap.getValueAtIndex(r);this.hot.getSettings()[tf]&&i&&(n=i)}return n}function Vre(){const t=this.hot.getSettings()[tf],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)}),vD(this,Pu,t)):t===!0&&Array.isArray(xM(this,Pu))&&xM(this,Pu).forEach((n,r)=>{this.rowHeightsMap.setValueAtIndex(r,n)})},!0)}function As(t,e,n){return e=Bre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bre(t){var e=Ure(t,"string");return typeof e=="symbol"?e:String(e)}function Ure(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zre{constructor(e,n,r,i,o,s){As(this,"row",void 0),As(this,"col",void 0),As(this,"rowspan",void 0),As(this,"colspan",void 0),As(this,"removed",!1),As(this,"cellCoordsFactory",void 0),As(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ct`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ct`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,f=Math.abs(r)-h;this[s]-=f+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const ui=zre;function uC(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Ep(t,e,n){return e=Gre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gre(t){var e=Yre(t,"string");return typeof e=="symbol"?e:String(e)}function Yre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nb{constructor(e){Ep(this,"plugin",void 0),Ep(this,"mergedCells",[]),Ep(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ct`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return T(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return T(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return T(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new ui(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(pt(nb.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];T(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,T(n,(i,o)=>{pe(0,i.rowspan-1,s=>{pe(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),T(n,i=>{uC(...i)}),T(r,i=>{uC(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return T(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}T(this.mergedCells,o=>{o.shift(i,n)}),Dd(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const jre=nb;function Tp(t,e,n){return e=Kre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kre(t){var e=Xre(t,"string");return typeof e=="symbol"?e:String(e)}function Xre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qre{constructor(e){Tp(this,"plugin",void 0),Tp(this,"mergedCellsCollection",void 0),Tp(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,f=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,g=Math.floor(s/f)*f,w=s-g,C=this.getFarthestCollection(e,n,r,i);if(C){if(r==="down"){const S=C.row+C.rowspan-a-w;o[2]+S>=this.plugin.hot.countRows()?o[2]-=w:o[2]+=w?S:0}else if(r==="right"){const S=C.col+C.colspan-l-w;o[3]+S>=this.plugin.hot.countCols()?o[3]-=w:o[3]+=w?S:0}else if(r==="up"){const S=u-w-C.row+1;o[0]+S<0?o[0]+=w:o[0]-=w?S:0}else if(r==="left"){const S=c-w-C.col+1;o[1]+S<0?o[1]+=w:o[1]-=w?S:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:f}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Ut(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,f=this.getAutofillSize(e,n,r),g=u?a-o+1:l-s+1,w=Math.floor(f/g)*g,C=f-w;let S=null,b=null,_=null;switch(r){case"up":S="includesVertically",_=c-C+1;break;case"left":S="includesHorizontally",_=c-C+1;break;case"down":S="includesVertically",_=h+C-1;break;case"right":S="includesHorizontally",_=h+C-1;break}return T(i,O=>{O[S](_)&&O.isFarther(b,r)&&(b=O)}),b}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return T(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const Zre=qre;function _p(t,e,n){return e=Qre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qre(t){var e=Jre(t,"string");return typeof e=="symbol"?e:String(e)}function Jre(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eie{constructor(e){_p(this,"plugin",void 0),_p(this,"hot",void 0),_p(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),f=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=f)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const tie=eie;function nie(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(dS)}return this.getTranslatedPhrase(hS)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?ui.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function $t(t,e){yD(t,e),e.add(t)}function rie(t,e,n){yD(t,e),e.set(t,n)}function yD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mp(t,e,n){return e=iie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iie(t){var e=oie(t,"string");return typeof e=="symbol"?e:String(e)}function oie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ap(t,e,n){var r=bD(t,e,"set");return sie(t,r,n),n}function sie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fa(t,e){var n=bD(t,e,"get");return aie(t,n)}function bD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aie(t,e){return e.get?e.get.call(t):e.value}function It(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeMergeCells");fe.getSingleton().register("afterMergeCells");fe.getSingleton().register("beforeUnmergeCells");fe.getSingleton().register("afterUnmergeCells");const Iu="mergeCells",lie=150,VM=Iu;var ai=new WeakMap,BM=new WeakSet,UM=new WeakSet,zM=new WeakSet,GM=new WeakSet,YM=new WeakSet,jM=new WeakSet,KM=new WeakSet,Op=new WeakSet,XM=new WeakSet,qM=new WeakSet,ZM=new WeakSet,QM=new WeakSet,JM=new WeakSet,eA=new WeakSet,tA=new WeakSet,nA=new WeakSet,rA=new WeakSet,iA=new WeakSet,oA=new WeakSet,sA=new WeakSet,aA=new WeakSet,lA=new WeakSet;class uie extends nt{constructor(){super(...arguments),$t(this,lA),$t(this,aA),$t(this,sA),$t(this,oA),$t(this,iA),$t(this,rA),$t(this,nA),$t(this,tA),$t(this,eA),$t(this,JM),$t(this,QM),$t(this,ZM),$t(this,qM),$t(this,XM),$t(this,Op),$t(this,KM),$t(this,jM),$t(this,YM),$t(this,GM),$t(this,zM),$t(this,UM),$t(this,BM),Mp(this,"mergedCellsCollection",null),Mp(this,"autofillCalculations",null),Mp(this,"selectionCalculations",null),rie(this,ai,{writable:!0,value:null})}static get PLUGIN_KEY(){return Iu}static get PLUGIN_PRIORITY(){return lie}isEnabled(){return!!this.hot.getSettings()[Iu]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new jre(this),this.autofillCalculations=new Zre(this),this.selectionCalculations=new tie(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,BM,cie).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,zM,die).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,sA,Aie).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,GM,fie).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,YM,gie).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,Op,uA).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,Op,uA).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,XM,wie).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,UM,hie).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,KM,pie).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,jM,mie).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,qM,Cie).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,ZM,vie).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,QM,Sie).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,JM,yie).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,eA,bie).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,tA,Rie).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,nA,Eie).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,rA,Tie).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,iA,_ie).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,oA,Mie).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,aA,Oie).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return It(e,lA,Pie).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Iu];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!lv())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=il(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=il(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(ui.containsNegativeValues(e)?(pt(ui.NEGATIVE_VALUES_WARNING(e)),n=!1):ui.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(pt(ui.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):ui.isSingleCell(e)?(pt(ui.IS_SINGLE_CELL(e)),n=!1):ui.containsZeroSpan(e)&&(pt(ui.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(T(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),pe(r.row,r.row+r.rowspan-1,a=>{pe(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),pe(0,s.rowspan-1,c=>{pe(0,s.colspan-1,h=>{let f=null;a[c]||(a[c]=[]),c===0&&h===0?f=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=f})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),T(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),pe(0,i.rowspan-1,o=>{pe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:VM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VM)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if($e(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if($e(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if($e(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if($e(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function cie(){this.generateFromSettings(this.hot.getSettings()[Iu]),this.hot.render()}function hie(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function die(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(Fa(this,ai)||Ap(this,ai,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(Fa(this,ai))||Ap(this,ai,this.hot._createCellCoords(null,null)),n.row=Fa(this,ai).row?Fa(this,ai).row-i.row:n.row,n.col=Fa(this,ai).col?Fa(this,ai).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);Ap(this,ai,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function fie(t){const e=this.hot.getSelectedRangeLast(),n=Ln(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Ln(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Ln(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),T(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function gie(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function mie(t){t.items.push({name:"---------"},nie(this))}function pie(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=$e(r)?Ln(r):void 0;if($e(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,f]=this.translateMergedCellToRenderable(a,c,l,u),g=o.getRenderableFromVisualIndex(e),w=s.getRenderableFromVisualIndex(n),C=h-g+1,S=f-w+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,C),i.colspan=Math.min(i.colspan,S)}uC(t,i,e,n)}function uA(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function wie(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function Cie(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function vie(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Sie(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function yie(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function bie(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function Rie(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Eie(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Tie(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function _ie(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Mie(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);T(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Aie(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function Oie(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Pie(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Iie(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],f=u.multiColumnSorting,w=(f.compareFunctionFactory?f.compareFunctionFactory:U1(u.type))(l,u,f)(c,h);if(w===gi){const C=a+1;if(typeof e[C]<"u")return s(C)}return w}(0)}}function cA(){pt(ct`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const RD="sort";function xie(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${RD}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Hie(t){const e=t.className.split(" "),n=new RegExp(`^${RD}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function Die(t,e,n){return e=Nie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nie(t){var e=Lie(t,"string");return typeof e=="symbol"?e:String(e)}function Lie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nf="multiColumnSorting",kie=170,hA="columnSorting",dA=nf;B1(nf,Iie);class $ie extends z1{constructor(){super(...arguments),Die(this,"pluginKey",nf)}static get PLUGIN_KEY(){return nf}static get PLUGIN_PRIORITY(){return kie}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[hA]&&cA(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Gd))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:dA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dA)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),De(e,Hie(e)),this.enabled!==!1&&ee(e,xie(...r))}updateSortingIndicator(e,n){super.updateSortingIndicator(e,n);const r=n.querySelector(".columnSortingIndicator");if(!r||!this.hot.getSettings().ariaTags||!this.columnStatesManager.isColumnSorted(e)||this.columnStatesManager.getNumberOfSortedColumns()<=1)return;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e)+1,o=Wo(`${this.hot.getTranslatedPhrase(Cy)} ${i}.`);Ko(r,so()[0]),ve(r,...o)}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[hA]&&cA(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){zy(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Gd))):this.sort(this.getColumnNextConfig(n.col)))}}function fA(t,e,n){return e=Fie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fie(t){var e=Wie(t,"string");return typeof e=="symbol"?e:String(e)}function Wie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Vie="multipleSelectionHandles",Bie=160;class Uie extends nt{constructor(){super(...arguments),fA(this,"dragged",[]),fA(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Vie}static get PLUGIN_PRIORITY(){return Bie}isEnabled(){return Yi()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Pe(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Pe(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Pe(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Pe(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const f=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!f||f===e.lastSetCell||((f.nodeName==="TD"||f.nodeName==="TH")&&(s=e.hot.getCoords(f),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=f),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function cC(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function ED(){return{label:"",isPlaceholder:!0}}function zie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;T(t,i=>{const o=[];let s=0;n.push(o),T(i,a=>{const l=cC();if($e(a)){const{label:c,colspan:h}=a;l.label=Nt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Nt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(ED());return!u})});const r=Math.max(...Ve(n,i=>i.length));return T(n,i=>{if(i.length<r){const o=Ve(new Array(r-i.length),()=>cC());i.splice(i.length,0,...o)}}),n}function Pp(t,e,n){Gie(t,e),e.set(t,n)}function Gie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xr(t,e){var n=TD(t,e,"get");return Yie(t,n)}function Yie(t,e){return e.get?e.get.call(t):e.value}function iu(t,e,n){var r=TD(t,e,"set");return jie(t,r,n),n}function TD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const gA=["label","collapsible"];var $i=new WeakMap,Os=new WeakMap,Ip=new WeakMap;class Kie{constructor(){Pp(this,$i,{writable:!0,value:[]}),Pp(this,Os,{writable:!0,value:0}),Pp(this,Ip,{writable:!0,value:1/0})}setColumnsLimit(e){iu(this,Ip,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];iu(this,$i,zie(e,xr(this,Ip))),iu(this,Os,xr(this,$i).length)}getData(){return xr(this,$i)}mergeWith(e){T(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&Ut(s,o,gA)})}map(e){T(xr(this,$i),n=>{T(n,r=>{const i=e({...r});$e(i)&&Ut(r,i,gA)})})}getHeaderSettings(e,n){var r;if(e>=xr(this,Os)||e<0)return null;const i=xr(this,$i)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=xr(this,Os)||e<0)return i;const o=xr(this,$i)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return xr(this,Os)}getColumnsCount(){return xr(this,Os)>0?xr(this,$i)[0].length:0}clear(){iu(this,$i,[]),iu(this,Os,0)}}function xp(t,e,n){return e=Xie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xie(t){var e=qie(t,"string");return typeof e=="symbol"?e:String(e)}function qie(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _D="DF-pre-order";function MD(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=MD.call(this.childs[r],t,e)}return n}const Zie="DF-post-order";function AD(t,e){for(let n=0;n<this.childs.length;n++)if(AD.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const OD="BF";function Qie(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const Jie=OD,mA=new Map([[_D,MD],[Zie,AD],[OD,Qie]]);class rf{constructor(e){xp(this,"data",{}),xp(this,"parent",null),xp(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new rf({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jie;if(!mA.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);mA.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function Hp(t,e,n){eoe(t,e),e.set(t,n)}function eoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xn(t,e){var n=PD(t,e,"get");return toe(t,n)}function toe(t,e){return e.get?e.get.call(t):e.value}function noe(t,e,n){var r=PD(t,e,"set");return roe(t,r,n),n}function PD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function roe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wa=new WeakMap,Ps=new WeakMap,Va=new WeakMap;class ioe{constructor(e){Hp(this,Wa,{writable:!0,value:new Map}),Hp(this,Ps,{writable:!0,value:new Map}),Hp(this,Va,{writable:!0,value:null}),noe(this,Va,e)}getRoots(){return Array.from(xn(this,Wa).values())}getRootByColumn(e){let n;return xn(this,Ps).has(e)&&(n=xn(this,Wa).get(xn(this,Ps).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-xn(this,Ps).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;xn(this,Ps).clear(),T(xn(this,Wa),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)xn(this,Ps).set(i,e);e+=r})}buildTree(){this.clear();const e=xn(this,Va).getColumnsCount();let n=0;for(;n<e;){const r=xn(this,Va).getHeaderSettings(0,n),i=new rf;xn(this,Wa).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=xn(this,Va).getHeadersSettings(r,n,i);r+=1,T(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new rf(a),e.addChild(l)),r<xn(this,Va).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){xn(this,Wa).clear(),xn(this,Ps).clear()}}function ID(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function of(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function sf(t){return of(t,"origColspan")===t.data.origColspan}function rb(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sf(t))return rb(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)T(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,ID(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):sf(a)&&(l.isCollapsed=of(a,"isCollapsed"))}),{rollbackModification:()=>ib(t),affectedColumns:Array.from(o),colspanCompensation:s}}function ib(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sf(t))return ib(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)T(o,l=>{ID(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=of(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):sf(l)&&(u.isCollapsed=of(l,"isCollapsed"))}),{rollbackModification:()=>rb(t),affectedColumns:Array.from(s),colspanCompensation:a}}function ooe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function soe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const pA=new Map([["collapse",ib],["expand",rb],["hide-column",ooe],["show-column",soe]]);function aoe(t,e,n){if(!pA.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return pA.get(t)(e,n)}function Fh(t){const e=[];return T(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=uoe(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(ED());else{const g=loe(i);g.isRoot=!0,u.push(g),c=!0}})}),e}function loe(t){const{crossHiddenColumns:e,...n}=cC(t);return n}function uoe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Dp(t,e,n){coe(t,e),e.set(t,n)}function coe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ou(t,e,n){var r=xD(t,e,"set");return hoe(t,r,n),n}function hoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function xt(t,e){var n=xD(t,e,"get");return doe(t,n)}function xD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function doe(t,e){return e.get?e.get.call(t):e.value}var si=new WeakMap,Un=new WeakMap,Is=new WeakMap;class foe{constructor(){Dp(this,si,{writable:!0,value:new Kie}),Dp(this,Un,{writable:!0,value:new ioe(xt(this,si))}),Dp(this,Is,{writable:!0,value:[[]]})}setState(e){xt(this,si).setData(e);let n=!1;try{xt(this,Un).buildTree()}catch{xt(this,Un).clear(),xt(this,si).clear(),n=!0}return ou(this,Is,Fh(xt(this,Un).getRoots())),n}setColumnsLimit(e){xt(this,si).setColumnsLimit(e)}mergeStateWith(e){const n=Ve(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});xt(this,si).mergeWith(n),xt(this,Un).buildTree(),ou(this,Is,Fh(xt(this,Un).getRoots()))}mapState(e){xt(this,si).map(e),xt(this,Un).buildTree(),ou(this,Is,Fh(xt(this,Un).getRoots()))}mapNodes(e){return Ft(xt(this,Un).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=xt(this,Un).getNode(n,r);let o;return i&&(o=aoe(e,i,r),ou(this,Is,Fh(xt(this,Un).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=xt(this,Is)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=xt(this,Un).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=xt(this,Un).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:f,isHidden:g}=u.data;g||f<=i&&c>=e&&c+f-1<=r&&(s===null||h<s)&&(s=h)},_D)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return xt(this,si).getLayersCount()}getColumnsCount(){return xt(this,si).getColumnsCount()}clear(){ou(this,Is,[]),xt(this,si).clear(),xt(this,Un).clear()}}function su(t,e,n){return e=goe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function goe(t){var e=moe(t,"string");return typeof e=="symbol"?e:String(e)}function moe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class poe{constructor(e,n){su(this,"hot",void 0),su(this,"nestedHeaderSettingsGetter",void 0),su(this,"layersCount",0),su(this,"container",void 0),su(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const f=n.createElement("th"),g=this.nestedHeaderSettingsGetter(l,h);if(g&&(!g.isPlaceholder||g.isHidden)){let w=g.label;s&&(w+='<button class="changeType"></button>'),Qs(f,w),f.colSpan=g.colspan,u.appendChild(f)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const woe=poe;function rn(t,e){HD(t,e),e.add(t)}function wA(t,e,n){return e=Coe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Coe(t){var e=voe(t,"string");return typeof e=="symbol"?e:String(e)}function voe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Wh(t,e,n){HD(t,e),e.set(t,n)}function HD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fs(t,e,n){var r=DD(t,e,"set");return Soe(t,r,n),n}function Soe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Je(t,e){var n=DD(t,e,"get");return yoe(t,n)}function DD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yoe(t,e){return e.get?e.get.call(t):e.value}function jt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const CA="nestedHeaders",boe=280;var lt=new WeakMap,Ro=new WeakMap,xu=new WeakMap,sg=new WeakMap,Vh=new WeakSet,vA=new WeakSet,SA=new WeakSet,yA=new WeakSet,bA=new WeakSet,RA=new WeakSet,EA=new WeakSet,TA=new WeakSet,_A=new WeakSet,MA=new WeakSet,AA=new WeakSet,OA=new WeakSet,PA=new WeakSet,IA=new WeakSet,xA=new WeakSet,HA=new WeakSet,DA=new WeakSet,NA=new WeakSet;class Roe extends nt{constructor(){super(...arguments),rn(this,NA),rn(this,DA),rn(this,HA),rn(this,xA),rn(this,IA),rn(this,PA),rn(this,OA),rn(this,AA),rn(this,MA),rn(this,_A),rn(this,TA),rn(this,EA),rn(this,RA),rn(this,bA),rn(this,yA),rn(this,SA),rn(this,vA),rn(this,Vh),Wh(this,lt,{writable:!0,value:new foe}),Wh(this,Ro,{writable:!0,value:null}),Wh(this,xu,{writable:!0,value:null}),Wh(this,sg,{writable:!0,value:!1}),wA(this,"ghostTable",new woe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),wA(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return CA}static get PLUGIN_PRIORITY(){return boe}isEnabled(){return!!this.hot.getSettings()[CA]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&pt(ct`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>jt(this,DA,Foe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,NA,Woe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,bA,Moe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,RA,Aoe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,EA,Ooe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,TA,Poe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,_A,Ioe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,MA,xoe).call(e,...i)}),this.addHook("afterSelection",()=>jt(this,Vh,Np).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,vA,Eoe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>jt(this,OA,Doe).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,IA,Loe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,xA,koe).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,SA,Toe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,yA,_oe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,AA,Hoe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,PA,Noe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return jt(e,HA,$oe).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>jt(this,Vh,Np).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>jt(this,Vh,Np).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Je(this,lt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Je(this,lt).setState(e)),this.detectedOverlappedHeaders&&pt(ct`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";Je(this,lt).triggerColumnModification(i,r)}),!Je(this,Ro)&&this.enabled&&Fs(this,Ro,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";Je(this,lt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Je(this,lt).clear(),Je(this,Ro).unsubscribe(),Fs(this,Ro,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Je(this,lt)}getLayersCount(){return Je(this,lt).getLayersCount()}getHeaderSettings(e,n){return Je(this,lt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),De(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),De(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),De(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),De(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:f}=(s=Je(this,lt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(f||h)ee(o,"hiddenHeader");else if(c>1){var g,w;const{wtOverlays:C}=l._wt,S=(g=C.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(o),b=(w=C.inlineStartOverlay)===null||w===void 0?void 0:w.clone.wtTable.THEAD.contains(o),_=S||b?Math.min(c,r-i):c;_>1&&o.setAttribute("colspan",_)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=Je(this,lt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){Fs(this,lt,null),Je(this,Ro)!==null&&(Je(this,Ro).unsubscribe(),Fs(this,Ro,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Je(this,lt).getHeaderTreeNodeData(e.row,e.col)}}function Np(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=Je(this,lt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Eoe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=Je(this,lt).findLeftMostColumnIndex(n.row,n.col),a=Je(this,lt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function Toe(t,e,n){const r=Je(this,lt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Je(this,lt).getHeaderSettings(e,t);if(o===Pv){if(!a)return r.columnIndex}else if(o===Rx&&(l>s-i||!a))return null;return t}function _oe(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let f=a;f<=u;f++)for(let g=s;g<=l;g++){var i;const w=c+g,C=f-a;if(C===0)continue;((i=Je(this,lt).getHeaderTreeNodeData(g,f))===null||i===void 0?void 0:i.isRoot)===!1&&(t[w][C]="")}}}function Moe(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Aoe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;Fs(this,xu,e.clone()),Fs(this,sg,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(Df(t)||zo(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Ooe(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],f=qn(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,f):e.col>c.col?h.push(l.col,o+s-1,f):h.push(o,o+s-1,f),this.hot.selection.selectColumns(...h)}function Poe(){Fs(this,sg,!1)}function Ioe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Je(this,sg)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=Je(this,lt).getHeaderTreeNodeData(Je(this,xu).row,Je(this,xu).col);if(e.setHighlight(Je(this,xu)),o>e.getWidth()||i<n||i+o-1>r){const s=Je(this,lt).findTopMostEntireHeaderLevel(qn(n,i,i+o-1),qn(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function xoe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=Je(this,lt).findLeftMostColumnIndex(n.row,n.col),o=Je(this,lt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Hoe(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Doe(t){t.length=0;for(let e=0;e<Je(this,lt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Noe(t){const e=Je(this,lt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=Je(this,lt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Nn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?Je(this,lt).getHeaderTreeNodeData(0,n).columnIndex:n}function Loe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function koe(t,e,n){var r;const{label:i}=(r=Je(this,lt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function $oe(t,e){if(t<0)return this.hot.getCell(t,Je(this,lt).findLeftMostColumnIndex(t,e),!0)}function Foe(){this.updatePlugin()}function Woe(t,e){e||this.updatePlugin()}function au(t,e,n){return e=Voe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Voe(t){var e=Boe(t,"string");return typeof e=="symbol"?e:String(e)}function Boe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uoe{constructor(e,n){au(this,"hot",void 0),au(this,"data",null),au(this,"plugin",void 0),au(this,"parentReference",new WeakMap),au(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},pe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&T(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&T(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Be(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(T(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(pe(e[0],e[2],f=>{const g=this.translateTrimmedRow(f);i.push(this.getDataObject(g))}),pe(0,i.length-2,f=>{this.detachFromParent(i[f],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const f=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,f,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,f,this.plugin.pluginName),u){h=c+this.countChildren(u);const g=this.getChild(u,this.countChildren(u)-1),w=this.getRowIndex(g);this.hot.runHooks("beforeCreateRow",w+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];T(r,o=>{i.push(this.getDataObject(o))}),T(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),f=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&f?1:0),1),this.syncRowWithRawSource(s),f||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const zoe=Uoe;function LA(t,e,n){return e=Goe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Goe(t){var e=Yoe(t,"string");return typeof e=="symbol"?e:String(e)}function Yoe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class joe{constructor(e,n){LA(this,"hot",void 0),LA(this,"plugin",void 0),this.hot=n,this.plugin=e}}const ob=joe;class Bi extends ob{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(T(l,c=>{c&&s.removeChild(c)}),ee(n,Bi.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",pe(0,i-1,()=>{const f=c.createElement("SPAN");ee(f,Bi.CSS_CLASSES.emptyIndicator),s.appendChild(f)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&ve(c,[so()]),ee(n,Bi.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(ee(c,`${Bi.CSS_CLASSES.button} ${Bi.CSS_CLASSES.expandButton}`),u&&ve(n,[sn(!1),$u(this.hot.getTranslatedPhrase(by))])):(ee(c,`${Bi.CSS_CLASSES.button} ${Bi.CSS_CLASSES.collapseButton}`),u&&ve(n,[sn(!0),$u(this.hot.getTranslatedPhrase(Ry))])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const ND=Bi;class Koe extends ob{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),T(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{pe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&T(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return T(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);T(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&T(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];T(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];T(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{T(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&T(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Pe(e.target,ND.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),Rr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const Xoe=Koe;function qoe(t,e,n){Zoe(t,e),e.set(t,n)}function Zoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qoe(t,e,n){return e=Joe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Joe(t){var e=ese(t,"string");return typeof e=="symbol"?e:String(e)}function ese(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tse(t,e){var n=nse(t,e,"get");return rse(t,n)}function nse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function rse(t,e){return e.get?e.get.call(t):e.value}var kA=new WeakMap;class ise extends ob{constructor(){super(...arguments),Qoe(this,"dataManager",this.plugin.dataManager),qoe(this,kA,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(IS)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(xS)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return pe(0,e.items.length-1,r=>{if(r===0)return T(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return pe(0,e.items.length-1,n=>{const r=tse(this,kA)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const ose=ise;function Bh(t,e,n){return e=sse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sse(t){var e=ase(t,"string");return typeof e=="symbol"?e:String(e)}function ase(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lse{constructor(e){Bh(this,"plugin",void 0),Bh(this,"hot",void 0),Bh(this,"dataManager",void 0),Bh(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(w=>{if(!l)return!1;const C=this.dataManager.translateTrimmedRow(w);return l=this.shouldAllowMoving(C,a),C}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),f=this.getTargetParent(s,a),g=h===f;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(f),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,g),this.moveRows(u,a,f),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return mt(i)&&(pt(ct`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function gn(t,e){LD(t,e),e.add(t)}function $A(t,e,n){LD(t,e),e.set(t,n)}function LD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lp(t,e,n){return e=use(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function use(t){var e=cse(t,"string");return typeof e=="symbol"?e:String(e)}function cse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function md(t,e){var n=kD(t,e,"get");return hse(t,n)}function hse(t,e){return e.get?e.get.call(t):e.value}function af(t,e,n){var r=kD(t,e,"set");return dse(t,r,n),n}function kD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function hn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lf="nestedRows",fse=300,FA=lf,gse="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var ag=new WeakMap,Ba=new WeakMap,WA=new WeakSet,VA=new WeakSet,BA=new WeakSet,UA=new WeakSet,zA=new WeakSet,GA=new WeakSet,YA=new WeakSet,jA=new WeakSet,KA=new WeakSet,XA=new WeakSet,qA=new WeakSet,ZA=new WeakSet,QA=new WeakSet,JA=new WeakSet,eO=new WeakSet,kp=new WeakSet;class mse extends nt{constructor(){super(...arguments),gn(this,kp),gn(this,eO),gn(this,JA),gn(this,QA),gn(this,ZA),gn(this,qA),gn(this,XA),gn(this,KA),gn(this,jA),gn(this,YA),gn(this,GA),gn(this,zA),gn(this,UA),gn(this,BA),gn(this,VA),gn(this,WA),Lp(this,"dataManager",null),Lp(this,"headersUI",null),Lp(this,"collapsedRowsMap",null),$A(this,ag,{writable:!0,value:!1}),$A(this,Ba,{writable:!0,value:!1})}static get PLUGIN_KEY(){return lf}static get PLUGIN_PRIORITY(){return fse}isEnabled(){return!!this.hot.getSettings()[lf]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new gc),this.dataManager=new zoe(this,this.hot),this.collapsingUI=new Xoe(this,this.hot),this.headersUI=new ND(this,this.hot),this.contextMenuUI=new ose(this,this.hot),this.rowMoveController=new lse(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,JA,Ose).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,eO,Pse).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,BA,Cse).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,UA,vse).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,zA,Sse).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,VA,wse).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,jA,Rse).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,YA,bse).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,KA,Ese).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,XA,Tse).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,qA,_se).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,ZA,Mse).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,GA,yse).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,QA,Ase).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return hn(e,WA,pse).call(e,...r)}),this.addHook("beforeLoadData",n=>hn(this,kp,tO).call(this,n)),this.addHook("beforeUpdateData",n=>hn(this,kp,tO).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:FA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FA)}disableCoreAPIModifiers(){af(this,Ba,!0)}enableCoreAPIModifiers(){af(this,Ba,!1)}onModifyRowData(e){if(!md(this,Ba))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!md(this,Ba))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return md(this,Ba)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function pse(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function wse(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Cse(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),af(this,ag,!0),this.dataManager.getData().slice()}function vse(t){return this.contextMenuUI.appendOptions(t)}function Sse(t,e){this.headersUI.appendLevelIndicators(t,e)}function yse(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function bse(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{af(this,ag,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Rse(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Ese(){this.collapsingUI.collapsedRowsStash.stash()}function Tse(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _se(){this.collapsingUI.collapsedRowsStash.stash()}function Mse(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Ase(){this.dataManager.rewriteCache()}function Ose(){this.headersUI.updateRowHeaderWidth()}function Pse(t,e){md(this,ag)&&(e.skipRender=!0)}function tO(t){if(!Dx(t)){fv(gse),this.hot.getSettings()[lf]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function $p(t,e,n){return e=Ise(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ise(t){var e=xse(t,"string");return typeof e=="symbol"?e:String(e)}function xse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hse{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;$p(this,"rootWindow",void 0),$p(this,"prefix",void 0),$p(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){T(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const Dse=Hse;function Nse(t,e,n){return e=Lse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lse(t){var e=kse(t,"string");return typeof e=="symbol"?e:String(e)}function kse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}fe.getSingleton().register("persistentStateSave");fe.getSingleton().register("persistentStateLoad");fe.getSingleton().register("persistentStateReset");const nO="persistentState",$se=0;class Fse extends nt{constructor(){super(...arguments),Nse(this,"storage",void 0)}static get PLUGIN_KEY(){return nO}static get PLUGIN_PRIORITY(){return $se}isEnabled(){return!!this.hot.getSettings()[nO]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Dse(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function Wse(t,e){Vse(t,e),e.add(t)}function Vse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fp(t,e,n){return e=Bse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bse(t){var e=Use(t,"string");return typeof e=="symbol"?e:String(e)}function Use(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rO(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Wp="search",zse=190,Gse="htSearchResult",Yse=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},jse=function(t,e,n){return mt(t)||t===null||!t.toLocaleLowerCase||t.length===0||mt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Vp=new WeakSet;class Kse extends nt{constructor(){super(...arguments),Wse(this,Vp),Fp(this,"callback",Yse),Fp(this,"queryMethod",jse),Fp(this,"searchResultClass",Gse)}static get PLUGIN_KEY(){return Wp}static get PLUGIN_PRIORITY(){return zse}isEnabled(){return this.hot.getSettings()[Wp]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Wp];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rO(e,Vp,iO).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return rO(e,Vp,iO).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return pe(0,i-1,l=>{pe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),f=h.search.callback||n,w=(h.search.queryMethod||r)(e,c,h);if(w){const C={row:l,col:u,data:c};s.push(C)}f&&f(a,l,u,c,w)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){$e(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function iO(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Bp(t,e){Xse(t,e),e.add(t)}function Xse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uh(t,e,n){return e=qse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qse(t){var e=Zse(t,"string");return typeof e=="symbol"?e:String(e)}function Zse(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Up(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Qse="touchScroll",Jse=200;var oO=new WeakSet,sO=new WeakSet,aO=new WeakSet;class eae extends nt{constructor(){super(...arguments),Bp(this,aO),Bp(this,sO),Bp(this,oO),Uh(this,"scrollbars",[]),Uh(this,"clones",[]),Uh(this,"lockedCollection",!1),Uh(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Qse}static get PLUGIN_PRIORITY(){return Jse}static get SETTING_KEYS(){return!0}isEnabled(){return Rv()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Up(this,oO,tae).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Up(this,sO,nae).call(this)),this.addHook("afterMomentumScroll",()=>Up(this,aO,rae).call(this))}}function tae(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function nae(){this.freezeOverlays=!0,T(this.clones,t=>{ee(t,"hide-tween")})}function rae(){this.freezeOverlays=!1,T(this.clones,t=>{De(t,"hide-tween"),ee(t,"show-tween")}),this.hot._registerTimeout(()=>{T(this.clones,t=>{De(t,"show-tween")})},400),T(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function iae(t,e){oae(t,e),e.add(t)}function oae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sae(t,e,n){return e=aae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aae(t){var e=lae(t,"string");return typeof e=="symbol"?e:String(e)}function lae(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uae(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const pd="trimRows",cae=330;var lO=new WeakSet;class hae extends nt{constructor(){super(...arguments),iae(this,lO),sae(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return pd}static get PLUGIN_PRIORITY(){return cae}isEnabled(){return!!this.hot.getSettings()[pd]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new gc),this.trimmedRowsMap.addLocalHook("init",()=>uae(this,lO,dae).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[pd];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),T(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{T(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(T(e,l=>{o[l]=!1}),i=Ft(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function dae(){const t=this.hot.getSettings()[pd];Array.isArray(t)&&this.hot.batchExecution(()=>{T(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}const $D="undoRedo",fae="undoRedo";function ce(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){const i=n&&n.length;if(!i||!n.find(a=>{const[,,l,u]=a;return l!==u}))return;const s=()=>{const a=n.reduce((u,c)=>(u.push([...c]),u),[]);T(a,u=>{u[1]=t.propToCol(u[1])});const l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new ce.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new ce.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{const s=()=>{const a=t.toPhysicalRow(n),l=bn(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new ce.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new ce.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{const s=()=>{const a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),u=[],c=[],h=[];pe(a.length-1,w=>{const C=[],S=a[w];pe(l,l+(r-1),b=>{C.push(S[t.toPhysicalColumn(b)])}),u.push(C)}),pe(r-1,w=>{h.push(t.toPhysicalColumn(l+w))}),Array.isArray(t.getSettings().colHeaders)&&pe(r-1,w=>{c.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+w)]||null)});const f=t.columnIndexMapper.getIndexesSequence(),g=t.rowIndexMapper.getIndexesSequence();return new ce.RemoveColumnAction(l,h,u,c,f,g,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new ce.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new ce.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new ce.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new ce.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new ce.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}ce.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};ce.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=bn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};ce.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=bn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};ce.prototype.isUndoAvailable=function(){return this.doneActions.length>0};ce.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};ce.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};ce.prototype.isEnabled=function(){return this.enabled};ce.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,pae(t),this.registerShortcuts(),t.addHook("afterChange",FD)};ce.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,wae(t),this.unregisterShortcuts(),t.removeHook("afterChange",FD)};ce.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};ce.Action=function(){};ce.Action.prototype.undo=function(){};ce.Action.prototype.redo=function(){};ce.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};ao(ce.ChangeAction,ce.Action);ce.ChangeAction.prototype.undo=function(t,e){const n=bn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){const[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};ce.ChangeAction.prototype.redo=function(t,e){const n=bn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};ce.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};ao(ce.CreateRowAction,ce.Action);ce.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};ce.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};ce.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};ao(ce.RemoveRowAction,ce.Action);ce.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};ce.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};ce.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};ao(ce.CreateColumnAction,ce.Action);ce.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};ce.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};ce.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};ao(ce.RemoveColumnAction,ce.Action);ce.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ve(this.data[u],i));const a=Ve(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),T(t.getSourceDataArray(),(u,c)=>{T(r,(h,f)=>{u[h]=s[c][f],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&T(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};ce.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};ce.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};ce.CellAlignmentAction.prototype.undo=function(t,e){T(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};ce.CellAlignmentAction.prototype.redo=function(t,e){To(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};ce.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};ao(ce.FiltersAction,ce.Action);ce.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};ce.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class gae extends ce.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}ce.MergeCellsAction=gae;class mae extends ce.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}ce.UnmergeCellsAction=mae;ce.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};ao(ce.RowMoveAction,ce.Action);ce.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};ce.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};ce.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};ce.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:$D};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};ce.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup($D)};function FD(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function pae(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function wae(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Rc=fe.getSingleton();Rc.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Rc.register("beforeUndo");Rc.register("afterUndo");Rc.register("beforeRedo");Rc.register("afterRedo");ce.PLUGIN_KEY=fae;ce.SETTING_KEYS=!0;function Cae(){et(Ru),et(F9),et(Eu),et(p8),et(T8),et(z1),et(w7),et(n5),et(ng),et(MZ),et(ZZ),et(oQ),et(ig),et(xQ),et(Wee),et(yte),et(Kte),et(ane),et(yne),et($ne),et(Zne),et(yre),et(Dre),et(uie),et($ie),et(Uie),et(Roe),et(mse),et(Fse),et(Kse),et(eae),et(hae),et(ce)}function vae(){h6(),_6(),D6(),n9(),Cae()}function Sae(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var zp,Gp,Yp,jp,Kp;vae();Sae(Se);Se.__GhostTable=By;Se._getListenersCounter=AG;Se._getRegisteredMapsCounter=U3;Se.EventManager=ar;const yae=[nz,uG,O3,A6,ij,zz,sz,UG,sG,lz,dG,BG],bae=[Wz,fG];Se.helper={};Se.dom={};T(yae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.helper[e]=t[e])})});T(bae,t=>{T(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Se.dom[e]=t[e])})});Se.cellTypes=(zp=Se.cellTypes)!==null&&zp!==void 0?zp:{};T(uq(),t=>{Se.cellTypes[t]=Ay(t)});Se.cellTypes.registerCellType=fr;Se.cellTypes.getCellType=Ay;Se.editors=(Gp=Se.editors)!==null&&Gp!==void 0?Gp:{};T(yG(),t=>{Se.editors[`${yn(t)}Editor`]=Hd(t)});Se.editors.registerEditor=jn;Se.editors.getEditor=Hd;Se.renderers=(Yp=Se.renderers)!==null&&Yp!==void 0?Yp:{};T(iY(),t=>{const e=Nd(t);t==="base"&&(Se.renderers.cellDecorator=e),Se.renderers[`${yn(t)}Renderer`]=e});Se.renderers.registerRenderer=li;Se.renderers.getRenderer=Nd;Se.validators=(jp=Se.validators)!==null&&jp!==void 0?jp:{};T(aY(),t=>{Se.validators[`${yn(t)}Validator`]=wv(t)});Se.validators.registerValidator=qa;Se.validators.getValidator=wv;Se.plugins=(Kp=Se.plugins)!==null&&Kp!==void 0?Kp:{};T(pv(),t=>{Se.plugins[t]=hc(t)});Se.plugins[`${yn(nt.PLUGIN_KEY)}Plugin`]=nt;Se.plugins.registerPlugin=et;Se.plugins.getPlugin=hc;var sb={exports:{}};sb.exports;(function(t){(function(e,n,r){function i(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),h=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,h&&(typeof h=="object"&&o(h,c),f.state=function(){return o(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(Wr,t,!1)})(sb);var Rae=sb.exports,ab={exports:{}};ab.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(Wr,t,!1)})(ab);var Eae=ab.exports,lb={exports:{}};lb.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(Wr,t,!1)})(lb);var Tae=lb.exports,ub={exports:{}};ub.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.x,h=l.i,f,g;return f=c[h],f^=f>>>7,g=f^f<<24,f=c[h+1&7],g^=f^f>>>10,f=c[h+3&7],g^=f^f>>>3,f=c[h+4&7],g^=f^f<<7,f=c[h+7&7],f=f^f<<13,g^=f^f<<9,c[h]=g,l.i=h+1&7,g};function u(c,h){var f,g=[];if(h===(h|0))g[0]=h;else for(h=""+h,f=0;f<h.length;++f)g[f&7]=g[f&7]<<15^h.charCodeAt(f)+g[f+1&7]<<13;for(;g.length<8;)g.push(0);for(f=0;f<8&&g[f]===0;++f);for(f==8?g[7]=-1:g[f],c.x=g,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(c.x&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(Wr,t,!1)})(ub);var _ae=ub.exports,cb={exports:{}};cb.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.w,h=l.X,f=l.i,g,w;return l.w=c=c+1640531527|0,w=h[f+34&127],g=h[f=f+1&127],w^=w<<13,g^=g<<17,w^=w>>>15,g^=g>>>12,w=h[f]=w^g,l.i=f,w+(c^c>>>16)|0};function u(c,h){var f,g,w,C,S,b=[],_=128;for(h===(h|0)?(g=h,h=null):(h=h+"\0",g=0,_=Math.max(_,h.length)),w=0,C=-32;C<_;++C)h&&(g^=h.charCodeAt((C+32)%h.length)),C===0&&(S=g),g^=g<<10,g^=g>>>15,g^=g<<4,g^=g>>>13,C>=0&&(S=S+1640531527|0,f=b[C&127]^=g+S,w=f==0?w+1:0);for(w>=128&&(b[(h&&h.length||0)&127]=-1),w=127,C=4*128;C>0;--C)g=b[w+34&127],f=b[w=w+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,b[w]=g^f;c.w=S,c.X=b,c.i=w}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(c.X&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(Wr,t,!1)})(cb);var Mae=cb.exports,hb={exports:{}};hb.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.b,f=l.c,g=l.d,w=l.a;return h=h<<25^h>>>7^f,f=f-g|0,g=g<<24^g>>>8^w,w=w-h|0,l.b=h=h<<20^h>>>12^f,l.c=f=f-g|0,l.d=g<<16^f>>>16^w,l.a=w-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var f=u.next()>>>11,g=(u.next()>>>0)/4294967296,w=(f+g)/(1<<21);while(w===0);return w},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(Wr,t,!1)})(hb);var Aae=hb.exports,WD={exports:{}};const Oae={},Pae=Object.freeze(Object.defineProperty({__proto__:null,default:Oae},Symbol.toStringTag,{value:"Module"})),Iae=pO(Pae);(function(t){(function(e,n,r){var i=256,o=6,s=52,a="random",l=r.pow(i,o),u=r.pow(2,s),c=u*2,h=i-1,f;function g(x,I,$){var z=[];I=I==!0?{entropy:!0}:I||{};var q=b(S(I.entropy?[x,O(n)]:x??_(),3),z),Y=new w(z),K=function(){for(var te=Y.g(o),oe=l,ie=0;te<u;)te=(te+ie)*i,oe*=i,ie=Y.g(1);for(;te>=c;)te/=2,oe/=2,ie>>>=1;return(te+ie)/oe};return K.int32=function(){return Y.g(4)|0},K.quick=function(){return Y.g(4)/4294967296},K.double=K,b(O(Y.S),n),(I.pass||$||function(te,oe,ie,ue){return ue&&(ue.S&&C(ue,Y),te.state=function(){return C(Y,{})}),ie?(r[a]=te,oe):te})(K,q,"global"in I?I.global:this==r,I.state)}function w(x){var I,$=x.length,z=this,q=0,Y=z.i=z.j=0,K=z.S=[];for($||(x=[$++]);q<i;)K[q]=q++;for(q=0;q<i;q++)K[q]=K[Y=h&Y+x[q%$]+(I=K[q])],K[Y]=I;(z.g=function(te){for(var oe,ie=0,ue=z.i,Re=z.j,Ue=z.S;te--;)oe=Ue[ue=h&ue+1],ie=ie*i+Ue[h&(Ue[ue]=Ue[Re=h&Re+oe])+(Ue[Re]=oe)];return z.i=ue,z.j=Re,ie})(i)}function C(x,I){return I.i=x.i,I.j=x.j,I.S=x.S.slice(),I}function S(x,I){var $=[],z=typeof x,q;if(I&&z=="object")for(q in x)try{$.push(S(x[q],I-1))}catch{}return $.length?$:z=="string"?x:x+"\0"}function b(x,I){for(var $=x+"",z,q=0;q<$.length;)I[h&q]=h&(z^=I[h&q]*19)+$.charCodeAt(q++);return O(I)}function _(){try{var x;return f&&(x=f.randomBytes)?x=x(i):(x=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(x)),O(x)}catch{var I=e.navigator,$=I&&I.plugins;return[+new Date,e,$,e.screen,O(n)]}}function O(x){return String.fromCharCode.apply(0,x)}if(b(r.random(),n),t.exports){t.exports=g;try{f=Iae}catch{}}else r["seed"+a]=g})(typeof self<"u"?self:Wr,[],Math)})(WD);var xae=WD.exports,Hae=Rae,Dae=Eae,Nae=Tae,Lae=_ae,kae=Mae,$ae=Aae,ta=xae;ta.alea=Hae;ta.xor128=Dae;ta.xorwow=Nae;ta.xorshift7=Lae;ta.xor4096=kae;ta.tychei=$ae;var Fae=ta;const VD=hC(Fae);let BD=VD();function UD(){return BD()}function Wae(t){BD=VD(t)}function na(t,e){let n=t;if(Array.isArray(t)){let r=t;e!=null&&e.maxCharCount&&typeof t[0]=="string"&&(r=t.filter(i=>i.length<=e.maxCharCount)),n=()=>zD(r)}return(e==null?void 0:e.length)===void 0?n(0):Array.from({length:e.length},(r,i)=>n(i))}function zD(t){return t[Math.floor(UD()*t.length)]}function Vae({min:t=1,max:e=9999.99,fraction:n=0}={}){if(e<t)throw new Error("Max must be bigger than min");return Number((UD()*(e-t)+t).toFixed(n))}function uO(t){return na(()=>zD([!0,!1]),t)}function er(t){const e={min:(t==null?void 0:t.min)??0,max:(t==null?void 0:t.max)??999999,precision:t==null?void 0:t.precision,fraction:t==null?void 0:t.fraction};return na(()=>{if(e.min===e.max)return e.min;const n=Vae(e);return e.precision!==void 0?Math.floor(n/e.precision)*e.precision:n},t)}function Bae(t){const e=new Date(t.from).getTime(),n=new Date(t.to).getTime();if(e>=n)throw new Error("From must be before to");return na(()=>new Date(er({min:e,max:n})),t)}var Uae=["Kautzer, Macejkovic and Fisher","Greenholt - Mosciski","Marquardt - Runolfsdottir","Abernathy Inc","Dickens - Lang","Hand, Bernhard and Kessler","Abbott LLC","Kub Inc","Johnston - Wisozk","Reichert LLC","Kohler LLC","Shanahan - Boyle","Batz - Rice","Cronin, Oberbrunner and Beier","Kuhlman, Schowalter and West","Luettgen Inc","Ward Group","Hills and Sons","Prohaska, Balistreri and Walker","Rempel - Durgan","Bernier LLC","Stehr - Lockman","Roberts, Rogahn and Dooley","Lesch - Jakubowski","Jenkins - Turcotte","Gerhold - Rowe","Block - Rau","Dickinson, Tremblay and Moore","Nader - Fritsch","Kreiger and Sons","Bartell, Wehner and Schowalter","Hegmann Inc","Orn, Spencer and Kiehn","Graham, Sipes and Towne","Hodkiewicz Inc","Mills Group","Legros, Tillman and Hodkiewicz","Lesch - Carter","Lesch Group","Kreiger - Sauer","Cartwright - Schuster","Labadie LLC","Pfannerstill, White and Mosciski","Jenkins LLC","Boehm, Hettinger and Huels","Maggio, Wisoky and Blick","Kozey Inc","Stracke - Wisozk","Olson, Olson and Carter","Orn, Gerlach and Runolfsdottir","Stracke - Kertzmann","Walker - Zieme","Hodkiewicz - Hintz","Lind Group","Fahey, Leannon and Gleichner","Mertz, Gusikowski and Lemke","Heidenreich - Aufderhar","Zboncak and Sons","Carroll Group","Brown LLC","Weber Inc","Rath LLC","Walker Inc","Heller, Hyatt and Jaskolski","Jacobi - Kutch","Skiles and Sons","Durgan - Stamm","Renner - Prosacco","Hahn - Welch","Lesch, Dooley and Bartell","Crona and Sons","Rogahn, Armstrong and Goyette","Lubowitz, Kuhlman and Bailey","Doyle Group","Dooley and Sons","Kerluke LLC","Bogan - Daniel","Hintz - Boehm","Swaniawski and Sons","Kris, Legros and Cartwright","Reichel Group","Russel - Hintz","Welch, Lockman and Hand","Pouros - Brakus","Mohr, Fritsch and Wisozk","Upton - Reichert","Koepp and Sons","Weber and Sons","Quigley, Bins and Becker","Strosin, Oberbrunner and Wunsch","Rodriguez - Spencer","Wilkinson - Dare","Gutkowski Inc","OReilly LLC","Collins, Mante and Pacocha","Steuber, Luettgen and Corkery","Kub and Sons","Lesch and Sons"];function lu(t){return na(Uae,t)}var zae=["Argentina","Peru","Colombia","Chile","Uruguay","Gabon","Congo","Norfolk Island","Qatar","Syrian Arab Republic","Wallis and Futuna","Somalia","Saint Barthelemy","Comoros","Sri Lanka","Czech Republic","Christmas Island","Macao","Montenegro","Anguilla","Canada","Mayotte","Tajikistan","Afghanistan","Liechtenstein","Cocos (Keeling) Islands","Angola","Bahrain","Dominican Republic","Croatia","Latvia","Virgin Islands, U.S.","United Kingdom","Brazil","Spain","Mongolia","Montserrat","Estonia","Benin","Guinea","Guinea-Bissau","Greece","Lao Peoples Democratic Republic","Puerto Rico","Slovakia (Slovak Republic)","United States of America","Switzerland","Costa Rica","Mauritius","Nigeria","Russian Federation","Germany","Antigua and Barbuda","Albania","Romania","Moldova","Senegal","Tanzania","British Indian Ocean Territory (Chagos Archipelago)","Central African Republic","New Caledonia","Burundi","Panama","Azerbaijan","Namibia","French Southern Territories","Vanuatu","Ethiopia","Burkina Faso","Tunisia","Mozambique","Belarus","Saint Kitts and Nevis","Hungary","Indonesia","Cyprus","Ecuador","Saint Martin","Nauru","Faroe Islands","Iran","Bolivia","Pitcairn Islands","France","Paraguay","Isle of Man","Sierra Leone","Monaco","Belize","Trinidad and Tobago"];function Gae(t){return na(zae,t)}var Yae={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","TiramisÃ¹"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","PipiÃ¡n","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","HuÃ®tres","Cassoulet","Poulet basquaise","Escargots au beurre persillÃ©","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","SoufflÃ© au fromage","Cuisses de grenouilles","Soupe Ã  lâoignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","CrÃ¨me brÃ»lÃ©e","Ãle flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["ÅiÅ kebap","DÃ¶ner","KÃ¶fte","Pide","Kumpir","Meze","MantÄ±","Lahmacun","Menemen","ÅiÅ kebap","Ä°skender kebab","Corba","Kuzu tandir","ÃiÄ KÃ¶fte","Pilav","Yaprak sarma","Dolma","Ä°mam bayÄ±ldÄ±","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","GÃ¼llaÃ§","Mercimek KÃ¶ftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","CalÃ§ots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileÃ±o","Cachopo","Caracoles"],venezuela:["PabellÃ³n criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","TequeÃ±os","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de JamÃ³n"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifÃ¡sico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","AlmojÃ¡bana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","CiorbÄ de fasole cu ciolan","CiorbÄ de burtÄ","CiorbÄ rÄdÄuÈeanÄ","PlÄcintÄ cu brÃ¢nzÄ","CiorbÄ de potroace","MÄmÄligÄ cu brÃ¢nzÄ Èi smÃ¢ntÃ¢nÄ","TochiturÄ","Piftie","Iahnie de fasole","SlÄninÄ afumatÄ","CÃ¢rnaÈi afumaÈi","VarzÄ a la Cluj","GulaÈ de cartofi cu afumÄturÄ","Cozonac de casÄ","CiorbÄ ardeleneascÄ de porc","Mucenici moldoveneÈti","SalatÄ de boeuf","Dovleac copt","PapanaÈi cu brÃ¢nzÄ de vacÄ Èi afine","Drob de miel","PÃ¢rjoale moldoveneÈti","ZacuscÄ de vinete","ZacuscÄ de fasole","TurtÄ dulce","ClÄtitele cu gem","ClÄtitele cu brÃ¢nza de vacÄ","BalmoÈ","Cozonac","Chiftele"]},mO;(mO=Object.keys(Yae))==null||mO.length;function cO(t){const e=(t==null?void 0:t.years)??1;if(e<=0)throw new Error("Years must be positive, use future() instead");const n=365*e*24*60*60*1e3,r=new Date,i=new Date(r.getTime()-n);return na(()=>Bae({from:i,to:r}),t)}var jae=["Small Rubber Shoes","Fantastic Wooden Sausages","Handmade Frozen Salad","Intelligent Soft Car","Intelligent Concrete Chips","Handcrafted Concrete Bacon","Small Fresh Fish","Rustic Metal Towels","Unbranded Cotton Hat","Fantastic Frozen Bike","Generic Rubber Shirt","Unbranded Wooden Keyboard","Awesome Metal Computer","Gorgeous Fresh Shoes","Unbranded Concrete Sausages","Practical Wooden Ball","Ergonomic Soft Towels","Small Plastic Table","Awesome Metal Pants","Licensed Steel Sausages","Handcrafted Rubber Bike","Ergonomic Cotton Computer","Generic Wooden Ball","Fantastic Frozen Soap","Generic Plastic Keyboard","Awesome Cotton Pizza","Licensed Metal Chips","Handcrafted Cotton Towels","Handmade Plastic Tuna","Practical Granite Keyboard","Intelligent Concrete Soap","Rustic Concrete Chips","Fantastic Steel Hat","Rustic Cotton Chair","Gorgeous Metal Pants","Intelligent Metal Bacon","Handmade Rubber Car","Tasty Concrete Keyboard","Incredible Granite Hat","Practical Rubber Fish","Rustic Cotton Gloves","Rustic Cotton Ball","Refined Fresh Shirt","Generic Granite Sausages","Rustic Granite Fish","Practical Wooden Bacon","Sleek Plastic Chair","Handcrafted Fresh Mouse","Small Concrete Shoes","Awesome Fresh Chair","Incredible Soft Computer","Tasty Concrete Chips","Generic Rubber Sausages","Intelligent Concrete Chicken","Rustic Soft Ball","Awesome Steel Towels","Incredible Fresh Bike","Unbranded Granite Chicken","Rustic Concrete Bike","Small Frozen Sausages","Intelligent Plastic Gloves","Ergonomic Frozen Towels","Refined Frozen Ball","Refined Cotton Ball","Licensed Steel Salad","Intelligent Wooden Bacon","Unbranded Metal Shoes","Fantastic Granite Car","Ergonomic Granite Bacon","Awesome Wooden Shirt","Rustic Wooden Pizza","Tasty Frozen Table","Awesome Wooden Hat","Awesome Rubber Salad","Licensed Concrete Fish","Fantastic Soft Cheese","Rustic Frozen Pizza","Refined Concrete Tuna","Small Frozen Tuna","Licensed Granite Cheese","Practical Rubber Car","Rustic Steel Sausages","Awesome Concrete Hat","Awesome Granite Sausages","Sleek Plastic Chips","Handcrafted Wooden Gloves","Intelligent Metal Computer","Fantastic Fresh Sausages","Fantastic Plastic Salad","Unbranded Steel Sausages","Handcrafted Wooden Fish","Sleek Wooden Bacon","Unbranded Plastic Towels","Tasty Soft Sausages","Generic Metal Shirt","Handmade Granite Cheese","Small Fresh Bacon","Tasty Granite Towels","Licensed Steel Chips"];function hO(t){return na(jae,t)}Wae("42219");const GD=[{companyName:lu({maxCharCount:18}),productName:hO({maxCharCount:18}),sellDate:cO().toLocaleDateString(),inStock:uO(),qty:er({max:500}),progress:er({max:10}),rating:er({max:5}),orderId:`${er({max:9,min:0})}${er({max:9,min:0})}-${er({max:9999999,min:1111111})}`,country:"United Kingdom",__children:[{companyName:lu({maxCharCount:18})},{companyName:lu({maxCharCount:18})},{companyName:lu({maxCharCount:18})}]},...Array.from({length:5e3},()=>({companyName:lu({maxCharCount:18}),productName:hO({maxCharCount:18}),sellDate:cO().toLocaleDateString(),inStock:uO(),qty:er({max:500}),progress:er({max:10}),rating:er({max:5}),orderId:`${er({max:9,min:0})}${er({max:9,min:0})}-${er({max:9999999,min:1111111})}`,country:Gae({maxCharCount:28})}))],Kae=GD.reduce((t,e)=>t.includes(e.country)?t:[...t,e.country],[]),Xae=(t,e)=>{const n=e.className;n!==void 0&&Se.dom.addClass(t,n)};function qae(t,e,n,r,i,o,s){const a=document.createElement("div");a.style.width=`${o*10}px`,a.ariaLabel=`${o*10}%`,Xae(e,s),Se.dom.addClass(a,"progressBar"),Se.dom.empty(e),e.appendChild(a)}function Zae(t,e,n,r,i,o,s){const a=document.createElement("div");a.textContent="â".repeat(o),a.ariaLabel=`${o}`,Se.dom.addClass(a,"stars"),Se.dom.empty(e),e.appendChild(a)}const dO="selected",fO="odd",gO=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function Qae(t,e,n,r,i,o){if(n!==0)return;const s=t.parentElement;s!==null&&(o.instance.getDataAtRowProp(e,"0")?Se.dom.addClass(s,dO):Se.dom.removeClass(s,dO),e%2===0?Se.dom.addClass(s,fO):Se.dom.removeClass(s,fO))}function Jae(t,e){if(!(t<0)&&e.firstChild){const n=this.isRtl()?"htRight":"htLeft";gO.has(t.toString())?(Se.dom.removeClass(e.firstChild,n),Se.dom.addClass(e.firstChild,gO.get(t.toString()))):Se.dom.addClass(e.firstChild,n)}}function ele(t,e){const n=t.target;e.col===-1&&n&&n.nodeName==="INPUT"&&(t.preventDefault(),this.setDataAtRowProp(e.row,"0",!n.checked))}const tle=document.getElementById("handsontable"),Zn={data:GD,height:464,colWidths:[140,165,100,100,100,90,90,110,178],colHeaders:["Company name","Product name","Sell date","In stock","Qty","Progress","Rating","Order ID","Country"],columns:[{data:"companyName",type:"text"},{data:"productName",type:"text"},{data:"sellDate",type:"date",allowInvalid:!1},{data:"inStock",type:"checkbox",className:"htCenter"},{data:"qty",type:"numeric"},{data:"progress",renderer:qae,readOnly:!0,className:"htMiddle"},{data:"rating",renderer:Zae,readOnly:!0,className:"star htCenter"},{data:"orderId",type:"text"},{data:"country",type:"dropdown",source:Kae}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,navigableHeaders:!0,disableTabNavigation:!1,autoWrapRow:!0,autoWrapCol:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,rowHeaders:!0,nestedRows:!0,afterGetColHeader:Jae,afterOnCellMouseDown:ele,beforeRenderer:Qae,licenseKey:"non-commercial-and-evaluation"};let kn=new Se(tle,Zn);const ra=(t,e)=>t.addEventListener("click",n=>e(t.checked));ra(document.querySelector("#enableTabNavigation"),t=>{Zn.disableTabNavigation=!t,kn.updateSettings({disableTabNavigation:Zn.disableTabNavigation}),console.log("Updated setting: disableTabNavigation to",kn.getSettings().disableTabNavigation)});ra(document.querySelector("#enableHeaderNavigation"),t=>{Zn.navigableHeaders=t,kn.updateSettings({navigableHeaders:Zn.navigableHeaders}),console.log("Updated setting: navigableHeaders to",kn.getSettings().navigableHeaders)});ra(document.querySelector("#enableCellVirtualization"),t=>{kn.destroy(),kn=new Se(document.getElementById("handsontable"),{...Zn,renderAllRows:!t,viewportColumnRenderingOffset:t?"auto":9}),console.log("Updated setting: renderAllRows to",kn.getSettings().renderAllRows)});ra(document.querySelector("#enableCellEnterEditing"),t=>{Zn.enterBeginsEditing=t,kn.updateSettings({enterBeginsEditing:Zn.enterBeginsEditing}),console.log("Updated setting: enableCellEnterEditing to",kn.getSettings().enterBeginsEditing)});ra(document.querySelector("#enableArrowRLFirstLastColumn"),t=>{Zn.autoWrapRow=t,kn.updateSettings({autoWrapRow:Zn.autoWrapRow}),console.log("Updated setting: autoWrapRow to",kn.getSettings().autoWrapRow)});ra(document.querySelector("#enableArrowTDFirstLastColumn"),t=>{Zn.autoWrapCol=t,kn.updateSettings({autoWrapCol:Zn.autoWrapCol}),console.log("Updated setting: autoWrapCol to",kn.getSettings().autoWrapCol)});ra(document.querySelector("#enableEnterFocusEditing"),t=>{Zn.enterMoves=t?{col:0,row:1}:{col:0,row:0},kn.updateSettings({enterMoves:Zn.enterMoves}),console.log("Updated setting: enterMoves to",kn.getSettings().enterMoves)})});export default nle();
