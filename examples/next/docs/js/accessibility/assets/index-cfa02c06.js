var QN=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var que=QN((dce,ff)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var ti=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function AP(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function JN(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var nu=function(t){return t&&t.Math===Math&&t},_n=nu(typeof globalThis=="object"&&globalThis)||nu(typeof window=="object"&&window)||nu(typeof self=="object"&&self)||nu(typeof ti=="object"&&ti)||nu(typeof ti=="object"&&ti)||function(){return this}()||Function("return this")(),yC={},Nr=function(t){try{return!!t()}catch{return!0}},eL=Nr,ki=!eL(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),tL=Nr,ug=!tL(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),nL=ug,fh=Function.prototype.call,Sa=nL?fh.bind(fh):function(){return fh.apply(fh,arguments)},OP={},PP={}.propertyIsEnumerable,IP=Object.getOwnPropertyDescriptor,rL=IP&&!PP.call({1:2},1);OP.f=rL?function(e){var n=IP(this,e);return!!n&&n.enumerable}:PP;var cg=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},xP=ug,HP=Function.prototype,tv=HP.call,iL=xP&&HP.bind.bind(tv,tv),Gn=xP?iL:function(t){return function(){return tv.apply(t,arguments)}},DP=Gn,oL=DP({}.toString),sL=DP("".slice),Bl=function(t){return sL(oL(t),8,-1)},aL=Gn,lL=Nr,uL=Bl,mm=Object,cL=aL("".split),hL=lL(function(){return!mm("z").propertyIsEnumerable(0)})?function(t){return uL(t)==="String"?cL(t,""):mm(t)}:mm,bC=function(t){return t==null},dL=bC,fL=TypeError,NP=function(t){if(dL(t))throw new fL("Can't call method on "+t);return t},gL=hL,mL=NP,hg=function(t){return gL(mL(t))},pm=typeof document=="object"&&document.all,Mn=typeof pm>"u"&&pm!==void 0?function(t){return typeof t=="function"||t===pm}:function(t){return typeof t=="function"},pL=Mn,ys=function(t){return typeof t=="object"?t!==null:pL(t)},wm=_n,wL=Mn,vL=function(t){return wL(t)?t:void 0},Wc=function(t,e){return arguments.length<2?vL(wm[t]):wm[t]&&wm[t][e]},CL=Gn,RC=CL({}.isPrototypeOf),EC=typeof navigator<"u"&&String(navigator.userAgent)||"",LP=_n,vm=EC,AR=LP.process,OR=LP.Deno,PR=AR&&AR.versions||OR&&OR.version,IR=PR&&PR.v8,ei,gf;IR&&(ei=IR.split("."),gf=ei[0]>0&&ei[0]<4?1:+(ei[0]+ei[1]));!gf&&vm&&(ei=vm.match(/Edge\/(\d+)/),(!ei||ei[1]>=74)&&(ei=vm.match(/Chrome\/(\d+)/),ei&&(gf=+ei[1])));var SL=gf,xR=SL,yL=Nr,bL=_n,RL=bL.String,TC=!!Object.getOwnPropertySymbols&&!yL(function(){var t=Symbol("symbol detection");return!RL(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&xR&&xR<41}),EL=TC,$P=EL&&!Symbol.sham&&typeof Symbol.iterator=="symbol",TL=Wc,_L=Mn,ML=RC,AL=$P,OL=Object,_C=AL?function(t){return typeof t=="symbol"}:function(t){var e=TL("Symbol");return _L(e)&&ML(e.prototype,OL(t))},PL=String,dg=function(t){try{return PL(t)}catch{return"Object"}},IL=Mn,xL=dg,HL=TypeError,fg=function(t){if(IL(t))return t;throw new HL(xL(t)+" is not a function")},DL=fg,NL=bC,MC=function(t,e){var n=t[e];return NL(n)?void 0:DL(n)},Cm=Sa,Sm=Mn,ym=ys,LL=TypeError,$L=function(t,e){var n,r;if(e==="string"&&Sm(n=t.toString)&&!ym(r=Cm(n,t))||Sm(n=t.valueOf)&&!ym(r=Cm(n,t))||e!=="string"&&Sm(n=t.toString)&&!ym(r=Cm(n,t)))return r;throw new LL("Can't convert object to primitive value")},kP={exports:{}},HR=_n,kL=Object.defineProperty,AC=function(t,e){try{kL(HR,t,{value:e,configurable:!0,writable:!0})}catch{HR[t]=e}return e},FL=_n,WL=AC,DR="__core-js_shared__",VL=FL[DR]||WL(DR,{}),OC=VL,NR=OC;(kP.exports=function(t,e){return NR[t]||(NR[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.35.0",mode:"global",copyright:"Â© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.35.0/LICENSE",source:"https://github.com/zloirock/core-js"});var FP=kP.exports,BL=NP,UL=Object,gg=function(t){return UL(BL(t))},GL=Gn,zL=gg,YL=GL({}.hasOwnProperty),To=Object.hasOwn||function(e,n){return YL(zL(e),n)},jL=Gn,KL=0,XL=Math.random(),qL=jL(1 .toString),WP=function(t){return"Symbol("+(t===void 0?"":t)+")_"+qL(++KL+XL,36)},ZL=_n,QL=FP,LR=To,JL=WP,e$=TC,t$=$P,Tl=ZL.Symbol,bm=QL("wks"),n$=t$?Tl.for||Tl:Tl&&Tl.withoutSetter||JL,Ul=function(t){return LR(bm,t)||(bm[t]=e$&&LR(Tl,t)?Tl[t]:n$("Symbol."+t)),bm[t]},r$=Sa,$R=ys,kR=_C,i$=MC,o$=$L,s$=Ul,a$=TypeError,l$=s$("toPrimitive"),u$=function(t,e){if(!$R(t)||kR(t))return t;var n=i$(t,l$),r;if(n){if(e===void 0&&(e="default"),r=r$(n,t,e),!$R(r)||kR(r))return r;throw new a$("Can't convert object to primitive value")}return e===void 0&&(e="number"),o$(t,e)},c$=u$,h$=_C,PC=function(t){var e=c$(t,"string");return h$(e)?e:e+""},d$=_n,FR=ys,nv=d$.document,f$=FR(nv)&&FR(nv.createElement),IC=function(t){return f$?nv.createElement(t):{}},g$=ki,m$=Nr,p$=IC,VP=!g$&&!m$(function(){return Object.defineProperty(p$("div"),"a",{get:function(){return 7}}).a!==7}),w$=ki,v$=Sa,C$=OP,S$=cg,y$=hg,b$=PC,R$=To,E$=VP,WR=Object.getOwnPropertyDescriptor;yC.f=w$?WR:function(e,n){if(e=y$(e),n=b$(n),E$)try{return WR(e,n)}catch{}if(R$(e,n))return S$(!v$(C$.f,e,n),e[n])};var bs={},T$=ki,_$=Nr,BP=T$&&_$(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),M$=ys,A$=String,O$=TypeError,Rs=function(t){if(M$(t))return t;throw new O$(A$(t)+" is not an object")},P$=ki,I$=VP,x$=BP,gh=Rs,VR=PC,H$=TypeError,Rm=Object.defineProperty,D$=Object.getOwnPropertyDescriptor,Em="enumerable",Tm="configurable",_m="writable";bs.f=P$?x$?function(e,n,r){if(gh(e),n=VR(n),gh(r),typeof e=="function"&&n==="prototype"&&"value"in r&&_m in r&&!r[_m]){var i=D$(e,n);i&&i[_m]&&(e[n]=r.value,r={configurable:Tm in r?r[Tm]:i[Tm],enumerable:Em in r?r[Em]:i[Em],writable:!1})}return Rm(e,n,r)}:Rm:function(e,n,r){if(gh(e),n=VR(n),gh(r),I$)try{return Rm(e,n,r)}catch{}if("get"in r||"set"in r)throw new H$("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var N$=ki,L$=bs,$$=cg,Vc=N$?function(t,e,n){return L$.f(t,e,$$(1,n))}:function(t,e,n){return t[e]=n,t},UP={exports:{}},rv=ki,k$=To,GP=Function.prototype,F$=rv&&Object.getOwnPropertyDescriptor,xC=k$(GP,"name"),W$=xC&&(function(){}).name==="something",V$=xC&&(!rv||rv&&F$(GP,"name").configurable),B$={EXISTS:xC,PROPER:W$,CONFIGURABLE:V$},U$=Gn,G$=Mn,iv=OC,z$=U$(Function.toString);G$(iv.inspectSource)||(iv.inspectSource=function(t){return z$(t)});var Y$=iv.inspectSource,j$=_n,K$=Mn,BR=j$.WeakMap,X$=K$(BR)&&/native code/.test(String(BR)),q$=FP,Z$=WP,UR=q$("keys"),zP=function(t){return UR[t]||(UR[t]=Z$(t))},HC={},Q$=X$,YP=_n,J$=ys,ek=Vc,Mm=To,Am=OC,tk=zP,nk=HC,GR="Object already initialized",ov=YP.TypeError,rk=YP.WeakMap,mf,bc,pf,ik=function(t){return pf(t)?bc(t):mf(t,{})},ok=function(t){return function(e){var n;if(!J$(e)||(n=bc(e)).type!==t)throw new ov("Incompatible receiver, "+t+" required");return n}};if(Q$||Am.state){var hi=Am.state||(Am.state=new rk);hi.get=hi.get,hi.has=hi.has,hi.set=hi.set,mf=function(t,e){if(hi.has(t))throw new ov(GR);return e.facade=t,hi.set(t,e),e},bc=function(t){return hi.get(t)||{}},pf=function(t){return hi.has(t)}}else{var Ia=tk("state");nk[Ia]=!0,mf=function(t,e){if(Mm(t,Ia))throw new ov(GR);return e.facade=t,ek(t,Ia,e),e},bc=function(t){return Mm(t,Ia)?t[Ia]:{}},pf=function(t){return Mm(t,Ia)}}var sk={set:mf,get:bc,has:pf,enforce:ik,getterFor:ok},DC=Gn,ak=Nr,lk=Mn,mh=To,sv=ki,uk=B$.CONFIGURABLE,ck=Y$,jP=sk,hk=jP.enforce,dk=jP.get,zR=String,Fd=Object.defineProperty,fk=DC("".slice),gk=DC("".replace),mk=DC([].join),pk=sv&&!ak(function(){return Fd(function(){},"length",{value:8}).length!==8}),wk=String(String).split("String"),vk=UP.exports=function(t,e,n){fk(zR(e),0,7)==="Symbol("&&(e="["+gk(zR(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!mh(t,"name")||uk&&t.name!==e)&&(sv?Fd(t,"name",{value:e,configurable:!0}):t.name=e),pk&&n&&mh(n,"arity")&&t.length!==n.arity&&Fd(t,"length",{value:n.arity});try{n&&mh(n,"constructor")&&n.constructor?sv&&Fd(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=hk(t);return mh(r,"source")||(r.source=mk(wk,typeof e=="string"?e:"")),t};Function.prototype.toString=vk(function(){return lk(this)&&dk(this).source||ck(this)},"toString");var Ck=UP.exports,Sk=Mn,yk=bs,bk=Ck,Rk=AC,Ek=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(Sk(n)&&bk(n,o,r),r.global)i?t[e]=n:Rk(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:yk.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},KP={},Tk=Math.ceil,_k=Math.floor,Mk=Math.trunc||function(e){var n=+e;return(n>0?_k:Tk)(n)},Ak=Mk,NC=function(t){var e=+t;return e!==e||e===0?0:Ak(e)},Ok=NC,Pk=Math.max,Ik=Math.min,xk=function(t,e){var n=Ok(t);return n<0?Pk(n+e,0):Ik(n,e)},Hk=NC,Dk=Math.min,Nk=function(t){return t>0?Dk(Hk(t),9007199254740991):0},Lk=Nk,Bc=function(t){return Lk(t.length)},$k=hg,kk=xk,Fk=Bc,YR=function(t){return function(e,n,r){var i=$k(e),o=Fk(i),s=kk(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}},Wk={includes:YR(!0),indexOf:YR(!1)},Vk=Gn,Om=To,Bk=hg,Uk=Wk.indexOf,Gk=HC,jR=Vk([].push),XP=function(t,e){var n=Bk(t),r=0,i=[],o;for(o in n)!Om(Gk,o)&&Om(n,o)&&jR(i,o);for(;e.length>r;)Om(n,o=e[r++])&&(~Uk(i,o)||jR(i,o));return i},LC=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],zk=XP,Yk=LC,jk=Yk.concat("length","prototype");KP.f=Object.getOwnPropertyNames||function(e){return zk(e,jk)};var qP={};qP.f=Object.getOwnPropertySymbols;var Kk=Wc,Xk=Gn,qk=KP,Zk=qP,Qk=Rs,Jk=Xk([].concat),eF=Kk("Reflect","ownKeys")||function(e){var n=qk.f(Qk(e)),r=Zk.f;return r?Jk(n,r(e)):n},KR=To,tF=eF,nF=yC,rF=bs,ZP=function(t,e,n){for(var r=tF(e),i=rF.f,o=nF.f,s=0;s<r.length;s++){var a=r[s];!KR(t,a)&&!(n&&KR(n,a))&&i(t,a,o(e,a))}},iF=Nr,oF=Mn,sF=/#|\.prototype\./,Uc=function(t,e){var n=lF[aF(t)];return n===cF?!0:n===uF?!1:oF(e)?iF(e):!!e},aF=Uc.normalize=function(t){return String(t).replace(sF,".").toLowerCase()},lF=Uc.data={},uF=Uc.NATIVE="N",cF=Uc.POLYFILL="P",hF=Uc,Pm=_n,dF=yC.f,fF=Vc,gF=Ek,mF=AC,pF=ZP,wF=hF,Es=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,u,c;if(r?s=Pm:i?s=Pm[n]||mF(n,{}):s=(Pm[n]||{}).prototype,s)for(a in e){if(u=e[a],t.dontCallGetSet?(c=dF(s,a),l=c&&c.value):l=s[a],o=wF(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof u==typeof l)continue;pF(u,l)}(t.sham||l&&l.sham)&&fF(u,"sham",!0),gF(s,a,u,t)}},vF=Bl,QP=Array.isArray||function(e){return vF(e)==="Array"},CF=ki,SF=QP,yF=TypeError,bF=Object.getOwnPropertyDescriptor,RF=CF&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),JP=RF?function(t,e){if(SF(t)&&!bF(t,"length").writable)throw new yF("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},EF=TypeError,TF=9007199254740991,eI=function(t){if(t>TF)throw EF("Maximum allowed index exceeded");return t},_F=Es,MF=gg,AF=Bc,OF=JP,PF=eI,IF=Nr,xF=IF(function(){return[].push.call({length:4294967296},1)!==4294967297}),HF=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},DF=xF||!HF();_F({target:"Array",proto:!0,arity:1,forced:DF},{push:function(e){var n=MF(this),r=AF(n),i=arguments.length;PF(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return OF(n,r),r}});var NF=ug,tI=Function.prototype,XR=tI.apply,qR=tI.call,mg=typeof Reflect=="object"&&Reflect.apply||(NF?qR.bind(XR):function(){return qR.apply(XR,arguments)}),LF=Gn,$F=fg,kF=function(t,e,n){try{return LF($F(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}},FF=ys,WF=function(t){return FF(t)||t===null},VF=WF,BF=String,UF=TypeError,GF=function(t){if(VF(t))return t;throw new UF("Can't set "+BF(t)+" as a prototype")},zF=kF,YF=Rs,jF=GF,nI=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=zF(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return YF(i),jF(o),t?n(i,o):i.__proto__=o,i}}():void 0),KF=bs.f,XF=function(t,e,n){n in t||KF(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})},qF=Mn,ZF=ys,ZR=nI,QF=function(t,e,n){var r,i;return ZR&&qF(r=e.constructor)&&r!==n&&ZF(i=r.prototype)&&i!==n.prototype&&ZR(t,i),t},JF=Ul,eW=JF("toStringTag"),rI={};rI[eW]="z";var tW=String(rI)==="[object z]",nW=tW,rW=Mn,Wd=Bl,iW=Ul,oW=iW("toStringTag"),sW=Object,aW=Wd(function(){return arguments}())==="Arguments",lW=function(t,e){try{return t[e]}catch{}},iI=nW?Wd:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=lW(e=sW(t),oW))=="string"?n:aW?Wd(e):(r=Wd(e))==="Object"&&rW(e.callee)?"Arguments":r},uW=iI,cW=String,oI=function(t){if(uW(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return cW(t)},hW=oI,dW=function(t,e){return t===void 0?arguments.length<2?"":e:hW(t)},fW=ys,gW=Vc,mW=function(t,e){fW(e)&&"cause"in e&&gW(t,"cause",e.cause)},pW=Gn,sI=Error,wW=pW("".replace),vW=function(t){return String(new sI(t).stack)}("zxcasd"),aI=/\n\s*at [^:]*:[^\n]*/,CW=aI.test(vW),SW=function(t,e){if(CW&&typeof t=="string"&&!sI.prepareStackTrace)for(;e--;)t=wW(t,aI,"");return t},yW=Nr,bW=cg,RW=!yW(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",bW(1,7)),t.stack!==7):!0}),EW=Vc,TW=SW,_W=RW,QR=Error.captureStackTrace,MW=function(t,e,n,r){_W&&(QR?QR(t,e):EW(t,"stack",TW(n,r)))},JR=Wc,AW=To,e0=Vc,OW=RC,t0=nI,n0=ZP,r0=XF,PW=QF,IW=dW,xW=mW,HW=MW,DW=ki,NW=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=JR.apply(null,s);if(l){var u=l.prototype;if(AW(u,"cause")&&delete u.cause,!n)return l;var c=JR("Error"),h=e(function(d,f){var p=IW(r?f:d,void 0),v=r?new l(d):new l;return p!==void 0&&e0(v,"message",p),HW(v,h,v.stack,2),this&&OW(u,this)&&PW(v,this,h),arguments.length>o&&xW(v,arguments[o]),v});h.prototype=u,a!=="Error"?t0?t0(h,c):n0(h,c,{name:!0}):DW&&i in l&&(r0(h,l,i),r0(h,l,"prepareStackTrace")),n0(h,l);try{u.name!==a&&e0(u,"name",a),u.constructor=h}catch{}return h}},lI=Es,LW=_n,Fi=mg,uI=NW,av="WebAssembly",i0=LW[av],wf=new Error("e",{cause:7}).cause!==7,ya=function(t,e){var n={};n[t]=uI(t,e,wf),lI({global:!0,constructor:!0,arity:1,forced:wf},n)},$C=function(t,e){if(i0&&i0[t]){var n={};n[t]=uI(av+"."+t,e,wf),lI({target:av,stat:!0,constructor:!0,arity:1,forced:wf},n)}};ya("Error",function(t){return function(n){return Fi(t,this,arguments)}});ya("EvalError",function(t){return function(n){return Fi(t,this,arguments)}});ya("RangeError",function(t){return function(n){return Fi(t,this,arguments)}});ya("ReferenceError",function(t){return function(n){return Fi(t,this,arguments)}});ya("SyntaxError",function(t){return function(n){return Fi(t,this,arguments)}});ya("TypeError",function(t){return function(n){return Fi(t,this,arguments)}});ya("URIError",function(t){return function(n){return Fi(t,this,arguments)}});$C("CompileError",function(t){return function(n){return Fi(t,this,arguments)}});$C("LinkError",function(t){return function(n){return Fi(t,this,arguments)}});$C("RuntimeError",function(t){return function(n){return Fi(t,this,arguments)}});var $W=Bl,kW=Gn,FW=function(t){if($W(t)==="Function")return kW(t)},o0=FW,WW=fg,VW=ug,BW=o0(o0.bind),cI=function(t,e){return WW(t),e===void 0?t:VW?BW(t,e):function(){return t.apply(e,arguments)}},UW=Wc,hI=UW("document","documentElement"),GW=Gn,kC=GW([].slice),zW=TypeError,dI=function(t,e){if(t<e)throw new zW("Not enough arguments");return t},YW=EC,jW=/(?:ipad|iphone|ipod).*applewebkit/i.test(YW),KW=_n,XW=Bl,qW=XW(KW.process)==="process",wr=_n,ZW=mg,QW=cI,s0=Mn,JW=To,fI=Nr,a0=hI,eV=kC,l0=IC,tV=dI,nV=jW,rV=qW,lv=wr.setImmediate,uv=wr.clearImmediate,iV=wr.process,Im=wr.Dispatch,oV=wr.Function,u0=wr.MessageChannel,sV=wr.String,xm=0,ec={},c0="onreadystatechange",Rc,Ms,Hm,Dm;fI(function(){Rc=wr.location});var FC=function(t){if(JW(ec,t)){var e=ec[t];delete ec[t],e()}},Nm=function(t){return function(){FC(t)}},h0=function(t){FC(t.data)},d0=function(t){wr.postMessage(sV(t),Rc.protocol+"//"+Rc.host)};(!lv||!uv)&&(lv=function(e){tV(arguments.length,1);var n=s0(e)?e:oV(e),r=eV(arguments,1);return ec[++xm]=function(){ZW(n,void 0,r)},Ms(xm),xm},uv=function(e){delete ec[e]},rV?Ms=function(t){iV.nextTick(Nm(t))}:Im&&Im.now?Ms=function(t){Im.now(Nm(t))}:u0&&!nV?(Hm=new u0,Dm=Hm.port2,Hm.port1.onmessage=h0,Ms=QW(Dm.postMessage,Dm)):wr.addEventListener&&s0(wr.postMessage)&&!wr.importScripts&&Rc&&Rc.protocol!=="file:"&&!fI(d0)?(Ms=d0,wr.addEventListener("message",h0,!1)):c0 in l0("script")?Ms=function(t){a0.appendChild(l0("script"))[c0]=function(){a0.removeChild(this),FC(t)}}:Ms=function(t){setTimeout(Nm(t),0)});var gI={set:lv,clear:uv},aV=Es,lV=_n,f0=gI.clear;aV({global:!0,bind:!0,enumerable:!0,forced:lV.clearImmediate!==f0},{clearImmediate:f0});var uV=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",mI=_n,cV=mg,hV=Mn,dV=uV,fV=EC,gV=kC,mV=dI,pV=mI.Function,wV=/MSIE .\./.test(fV)||dV&&function(){var t=mI.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),vV=function(t,e){var n=e?2:1;return wV?function(r,i){var o=mV(arguments.length,1)>n,s=hV(r)?r:pV(r),a=o?gV(arguments,n):[],l=o?function(){cV(s,this,a)}:s;return e?t(l,i):t(l)}:t},CV=Es,pI=_n,g0=gI.set,SV=vV,m0=pI.setImmediate?SV(g0,!1):g0;CV({global:!0,bind:!0,enumerable:!0,forced:pI.setImmediate!==m0},{setImmediate:m0});/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function Zo(t){"@babel/helpers - typeof";return Zo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zo(t)}function cv(t,e){return cv=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},cv(t,e)}function yV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Vd(t,e,n){return yV()?Vd=Reflect.construct:Vd=function(i,o,s){var a=[null];a.push.apply(a,o);var l=Function.bind.apply(i,a),u=new l;return s&&cv(u,s.prototype),u},Vd.apply(null,arguments)}function Xr(t){return bV(t)||RV(t)||EV(t)||TV()}function bV(t){if(Array.isArray(t))return hv(t)}function RV(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function EV(t,e){if(t){if(typeof t=="string")return hv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hv(t,e)}}function hv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function TV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _V=Object.hasOwnProperty,p0=Object.setPrototypeOf,MV=Object.isFrozen,AV=Object.getPrototypeOf,OV=Object.getOwnPropertyDescriptor,Un=Object.freeze,oi=Object.seal,PV=Object.create,wI=typeof Reflect<"u"&&Reflect,vf=wI.apply,dv=wI.construct;vf||(vf=function(e,n,r){return e.apply(n,r)});Un||(Un=function(e){return e});oi||(oi=function(e){return e});dv||(dv=function(e,n){return Vd(e,Xr(n))});var IV=Hr(Array.prototype.forEach),w0=Hr(Array.prototype.pop),ru=Hr(Array.prototype.push),Bd=Hr(String.prototype.toLowerCase),Lm=Hr(String.prototype.toString),xV=Hr(String.prototype.match),Fr=Hr(String.prototype.replace),HV=Hr(String.prototype.indexOf),DV=Hr(String.prototype.trim),In=Hr(RegExp.prototype.test),$m=NV(TypeError);function Hr(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return vf(t,e,r)}}function NV(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return dv(t,n)}}function je(t,e,n){var r;n=(r=n)!==null&&r!==void 0?r:Bd,p0&&p0(t,null);for(var i=e.length;i--;){var o=e[i];if(typeof o=="string"){var s=n(o);s!==o&&(MV(e)||(e[i]=s),o=s)}t[o]=!0}return t}function As(t){var e=PV(null),n;for(n in t)vf(_V,t,[n])===!0&&(e[n]=t[n]);return e}function ph(t,e){for(;t!==null;){var n=OV(t,e);if(n){if(n.get)return Hr(n.get);if(typeof n.value=="function")return Hr(n.value)}t=AV(t)}function r(i){return console.warn("fallback value for",i),null}return r}var v0=Un(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),km=Un(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Fm=Un(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),LV=Un(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Wm=Un(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),$V=Un(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),C0=Un(["#text"]),S0=Un(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Vm=Un(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),y0=Un(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),wh=Un(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),kV=oi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),FV=oi(/<%[\w\W]*|[\w\W]*%>/gm),WV=oi(/\${[\w\W]*}/gm),VV=oi(/^data-[\-\w.\u00B7-\uFFFF]/),BV=oi(/^aria-[\-\w]+$/),UV=oi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),GV=oi(/^(?:\w+script|data):/i),zV=oi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),YV=oi(/^html$/i),jV=function(){return typeof window>"u"?null:window},KV=function(e,n){if(Zo(e)!=="object"||typeof e.createPolicy!="function")return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function vI(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jV(),e=function(H){return vI(H)};if(e.version="2.4.7",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var n=t.document,r=t.document,i=t.DocumentFragment,o=t.HTMLTemplateElement,s=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,d=t.DOMParser,f=t.trustedTypes,p=a.prototype,v=ph(p,"cloneNode"),S=ph(p,"nextSibling"),y=ph(p,"childNodes"),R=ph(p,"parentNode");if(typeof o=="function"){var T=r.createElement("template");T.content&&T.content.ownerDocument&&(r=T.content.ownerDocument)}var A=KV(f,n),M=A?A.createHTML(""):"",L=r,B=L.implementation,K=L.createNodeIterator,U=L.createDocumentFragment,G=L.getElementsByTagName,Q=n.importNode,re={};try{re=As(r).documentMode?r.documentMode:{}}catch{}var ne={};e.isSupported=typeof R=="function"&&B&&B.createHTMLDocument!==void 0&&re!==9;var ce=kV,be=FV,qe=WV,Fe=VV,we=BV,g=GV,m=zV,w=UV,P=null,I=je({},[].concat(Xr(v0),Xr(km),Xr(Fm),Xr(Wm),Xr(C0))),N=null,j=je({},[].concat(Xr(S0),Xr(Vm),Xr(y0),Xr(wh))),Y=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),oe=null,J=null,X=!0,Se=!0,Ie=!1,Oe=!0,He=!1,z=!1,lt=!1,Be=!1,xe=!1,De=!1,Re=!1,C=!0,b=!1,_="user-content-",F=!0,O=!1,k={},x=null,D=je({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),W=null,$=je({},["audio","video","img","source","image","track"]),V=null,ie=je({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),de="http://www.w3.org/1998/Math/MathML",ye="http://www.w3.org/2000/svg",Me="http://www.w3.org/1999/xhtml",We=Me,St=!1,Ze=null,ct=je({},[de,ye,Me],Lm),_t,Pa=["application/xhtml+xml","text/html"],eu="text/html",Bt,cn=null,_s=r.createElement("form"),Pn=function(H){return H instanceof RegExp||H instanceof Function},Qt=function(H){cn&&cn===H||((!H||Zo(H)!=="object")&&(H={}),H=As(H),_t=Pa.indexOf(H.PARSER_MEDIA_TYPE)===-1?_t=eu:_t=H.PARSER_MEDIA_TYPE,Bt=_t==="application/xhtml+xml"?Lm:Bd,P="ALLOWED_TAGS"in H?je({},H.ALLOWED_TAGS,Bt):I,N="ALLOWED_ATTR"in H?je({},H.ALLOWED_ATTR,Bt):j,Ze="ALLOWED_NAMESPACES"in H?je({},H.ALLOWED_NAMESPACES,Lm):ct,V="ADD_URI_SAFE_ATTR"in H?je(As(ie),H.ADD_URI_SAFE_ATTR,Bt):ie,W="ADD_DATA_URI_TAGS"in H?je(As($),H.ADD_DATA_URI_TAGS,Bt):$,x="FORBID_CONTENTS"in H?je({},H.FORBID_CONTENTS,Bt):D,oe="FORBID_TAGS"in H?je({},H.FORBID_TAGS,Bt):{},J="FORBID_ATTR"in H?je({},H.FORBID_ATTR,Bt):{},k="USE_PROFILES"in H?H.USE_PROFILES:!1,X=H.ALLOW_ARIA_ATTR!==!1,Se=H.ALLOW_DATA_ATTR!==!1,Ie=H.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=H.ALLOW_SELF_CLOSE_IN_ATTR!==!1,He=H.SAFE_FOR_TEMPLATES||!1,z=H.WHOLE_DOCUMENT||!1,xe=H.RETURN_DOM||!1,De=H.RETURN_DOM_FRAGMENT||!1,Re=H.RETURN_TRUSTED_TYPE||!1,Be=H.FORCE_BODY||!1,C=H.SANITIZE_DOM!==!1,b=H.SANITIZE_NAMED_PROPS||!1,F=H.KEEP_CONTENT!==!1,O=H.IN_PLACE||!1,w=H.ALLOWED_URI_REGEXP||w,We=H.NAMESPACE||Me,Y=H.CUSTOM_ELEMENT_HANDLING||{},H.CUSTOM_ELEMENT_HANDLING&&Pn(H.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Y.tagNameCheck=H.CUSTOM_ELEMENT_HANDLING.tagNameCheck),H.CUSTOM_ELEMENT_HANDLING&&Pn(H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Y.attributeNameCheck=H.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),H.CUSTOM_ELEMENT_HANDLING&&typeof H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Y.allowCustomizedBuiltInElements=H.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),He&&(Se=!1),De&&(xe=!0),k&&(P=je({},Xr(C0)),N=[],k.html===!0&&(je(P,v0),je(N,S0)),k.svg===!0&&(je(P,km),je(N,Vm),je(N,wh)),k.svgFilters===!0&&(je(P,Fm),je(N,Vm),je(N,wh)),k.mathMl===!0&&(je(P,Wm),je(N,y0),je(N,wh))),H.ADD_TAGS&&(P===I&&(P=As(P)),je(P,H.ADD_TAGS,Bt)),H.ADD_ATTR&&(N===j&&(N=As(N)),je(N,H.ADD_ATTR,Bt)),H.ADD_URI_SAFE_ATTR&&je(V,H.ADD_URI_SAFE_ATTR,Bt),H.FORBID_CONTENTS&&(x===D&&(x=As(x)),je(x,H.FORBID_CONTENTS,Bt)),F&&(P["#text"]=!0),z&&je(P,["html","head","body"]),P.table&&(je(P,["tbody"]),delete oe.tbody),Un&&Un(H),cn=H)},yt=je({},["mi","mo","mn","ms","mtext"]),SR=je({},["foreignobject","desc","title","annotation-xml"]),KN=je({},["title","style","font","a","script"]),hh=je({},km);je(hh,Fm),je(hh,LV);var dm=je({},Wm);je(dm,$V);var XN=function(H){var te=R(H);(!te||!te.tagName)&&(te={namespaceURI:We,tagName:"template"});var le=Bd(H.tagName),ut=Bd(te.tagName);return Ze[H.namespaceURI]?H.namespaceURI===ye?te.namespaceURI===Me?le==="svg":te.namespaceURI===de?le==="svg"&&(ut==="annotation-xml"||yt[ut]):!!hh[le]:H.namespaceURI===de?te.namespaceURI===Me?le==="math":te.namespaceURI===ye?le==="math"&&SR[ut]:!!dm[le]:H.namespaceURI===Me?te.namespaceURI===ye&&!SR[ut]||te.namespaceURI===de&&!yt[ut]?!1:!dm[le]&&(KN[le]||!hh[le]):!!(_t==="application/xhtml+xml"&&Ze[H.namespaceURI]):!1},Ui=function(H){ru(e.removed,{element:H});try{H.parentNode.removeChild(H)}catch{try{H.outerHTML=M}catch{H.remove()}}},fm=function(H,te){try{ru(e.removed,{attribute:te.getAttributeNode(H),from:te})}catch{ru(e.removed,{attribute:null,from:te})}if(te.removeAttribute(H),H==="is"&&!N[H])if(xe||De)try{Ui(te)}catch{}else try{te.setAttribute(H,"")}catch{}},yR=function(H){var te,le;if(Be)H="<remove></remove>"+H;else{var ut=xV(H,/^[\r\n\t ]+/);le=ut&&ut[0]}_t==="application/xhtml+xml"&&We===Me&&(H='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+H+"</body></html>");var Yn=A?A.createHTML(H):H;if(We===Me)try{te=new d().parseFromString(Yn,_t)}catch{}if(!te||!te.documentElement){te=B.createDocument(We,"template",null);try{te.documentElement.innerHTML=St?M:Yn}catch{}}var mn=te.body||te.documentElement;return H&&le&&mn.insertBefore(r.createTextNode(le),mn.childNodes[0]||null),We===Me?G.call(te,z?"html":"body")[0]:z?te.documentElement:mn},bR=function(H){return K.call(H.ownerDocument||H,H,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},qN=function(H){return H instanceof h&&(typeof H.nodeName!="string"||typeof H.textContent!="string"||typeof H.removeChild!="function"||!(H.attributes instanceof c)||typeof H.removeAttribute!="function"||typeof H.setAttribute!="function"||typeof H.namespaceURI!="string"||typeof H.insertBefore!="function"||typeof H.hasChildNodes!="function")},tu=function(H){return Zo(s)==="object"?H instanceof s:H&&Zo(H)==="object"&&typeof H.nodeType=="number"&&typeof H.nodeName=="string"},Gi=function(H,te,le){ne[H]&&IV(ne[H],function(ut){ut.call(e,te,le,cn)})},RR=function(H){var te;if(Gi("beforeSanitizeElements",H,null),qN(H)||In(/[\u0080-\uFFFF]/,H.nodeName))return Ui(H),!0;var le=Bt(H.nodeName);if(Gi("uponSanitizeElement",H,{tagName:le,allowedTags:P}),H.hasChildNodes()&&!tu(H.firstElementChild)&&(!tu(H.content)||!tu(H.content.firstElementChild))&&In(/<[/\w]/g,H.innerHTML)&&In(/<[/\w]/g,H.textContent)||le==="select"&&In(/<template/i,H.innerHTML))return Ui(H),!0;if(!P[le]||oe[le]){if(!oe[le]&&TR(le)&&(Y.tagNameCheck instanceof RegExp&&In(Y.tagNameCheck,le)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(le)))return!1;if(F&&!x[le]){var ut=R(H)||H.parentNode,Yn=y(H)||H.childNodes;if(Yn&&ut)for(var mn=Yn.length,hn=mn-1;hn>=0;--hn)ut.insertBefore(v(Yn[hn],!0),S(H))}return Ui(H),!0}return H instanceof a&&!XN(H)||(le==="noscript"||le==="noembed"||le==="noframes")&&In(/<\/no(script|embed|frames)/i,H.innerHTML)?(Ui(H),!0):(He&&H.nodeType===3&&(te=H.textContent,te=Fr(te,ce," "),te=Fr(te,be," "),te=Fr(te,qe," "),H.textContent!==te&&(ru(e.removed,{element:H.cloneNode()}),H.textContent=te)),Gi("afterSanitizeElements",H,null),!1)},ER=function(H,te,le){if(C&&(te==="id"||te==="name")&&(le in r||le in _s))return!1;if(!(Se&&!J[te]&&In(Fe,te))){if(!(X&&In(we,te))){if(!N[te]||J[te]){if(!(TR(H)&&(Y.tagNameCheck instanceof RegExp&&In(Y.tagNameCheck,H)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(H))&&(Y.attributeNameCheck instanceof RegExp&&In(Y.attributeNameCheck,te)||Y.attributeNameCheck instanceof Function&&Y.attributeNameCheck(te))||te==="is"&&Y.allowCustomizedBuiltInElements&&(Y.tagNameCheck instanceof RegExp&&In(Y.tagNameCheck,le)||Y.tagNameCheck instanceof Function&&Y.tagNameCheck(le))))return!1}else if(!V[te]){if(!In(w,Fr(le,m,""))){if(!((te==="src"||te==="xlink:href"||te==="href")&&H!=="script"&&HV(le,"data:")===0&&W[H])){if(!(Ie&&!In(g,Fr(le,m,"")))){if(le)return!1}}}}}}return!0},TR=function(H){return H.indexOf("-")>0},_R=function(H){var te,le,ut,Yn;Gi("beforeSanitizeAttributes",H,null);var mn=H.attributes;if(mn){var hn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:N};for(Yn=mn.length;Yn--;){te=mn[Yn];var dh=te,rn=dh.name,gm=dh.namespaceURI;if(le=rn==="value"?te.value:DV(te.value),ut=Bt(rn),hn.attrName=ut,hn.attrValue=le,hn.keepAttr=!0,hn.forceKeepAttr=void 0,Gi("uponSanitizeAttribute",H,hn),le=hn.attrValue,!hn.forceKeepAttr&&(fm(rn,H),!!hn.keepAttr)){if(!Oe&&In(/\/>/i,le)){fm(rn,H);continue}He&&(le=Fr(le,ce," "),le=Fr(le,be," "),le=Fr(le,qe," "));var MR=Bt(H.nodeName);if(ER(MR,ut,le)){if(b&&(ut==="id"||ut==="name")&&(fm(rn,H),le=_+le),A&&Zo(f)==="object"&&typeof f.getAttributeType=="function"&&!gm)switch(f.getAttributeType(MR,ut)){case"TrustedHTML":{le=A.createHTML(le);break}case"TrustedScriptURL":{le=A.createScriptURL(le);break}}try{gm?H.setAttributeNS(gm,rn,le):H.setAttribute(rn,le),w0(e.removed)}catch{}}}}Gi("afterSanitizeAttributes",H,null)}},ZN=function Ee(H){var te,le=bR(H);for(Gi("beforeSanitizeShadowDOM",H,null);te=le.nextNode();)Gi("uponSanitizeShadowNode",te,null),!RR(te)&&(te.content instanceof i&&Ee(te.content),_R(te));Gi("afterSanitizeShadowDOM",H,null)};return e.sanitize=function(Ee){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},te,le,ut,Yn,mn;if(St=!Ee,St&&(Ee="<!-->"),typeof Ee!="string"&&!tu(Ee))if(typeof Ee.toString=="function"){if(Ee=Ee.toString(),typeof Ee!="string")throw $m("dirty is not a string, aborting")}else throw $m("toString is not a function");if(!e.isSupported){if(Zo(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof Ee=="string")return t.toStaticHTML(Ee);if(tu(Ee))return t.toStaticHTML(Ee.outerHTML)}return Ee}if(lt||Qt(H),e.removed=[],typeof Ee=="string"&&(O=!1),O){if(Ee.nodeName){var hn=Bt(Ee.nodeName);if(!P[hn]||oe[hn])throw $m("root node is forbidden and cannot be sanitized in-place")}}else if(Ee instanceof s)te=yR("<!---->"),le=te.ownerDocument.importNode(Ee,!0),le.nodeType===1&&le.nodeName==="BODY"||le.nodeName==="HTML"?te=le:te.appendChild(le);else{if(!xe&&!He&&!z&&Ee.indexOf("<")===-1)return A&&Re?A.createHTML(Ee):Ee;if(te=yR(Ee),!te)return xe?null:Re?M:""}te&&Be&&Ui(te.firstChild);for(var dh=bR(O?Ee:te);ut=dh.nextNode();)ut.nodeType===3&&ut===Yn||RR(ut)||(ut.content instanceof i&&ZN(ut.content),_R(ut),Yn=ut);if(Yn=null,O)return Ee;if(xe){if(De)for(mn=U.call(te.ownerDocument);te.firstChild;)mn.appendChild(te.firstChild);else mn=te;return(N.shadowroot||N.shadowrootmod)&&(mn=Q.call(n,mn,!0)),mn}var rn=z?te.outerHTML:te.innerHTML;return z&&P["!doctype"]&&te.ownerDocument&&te.ownerDocument.doctype&&te.ownerDocument.doctype.name&&In(YV,te.ownerDocument.doctype.name)&&(rn="<!DOCTYPE "+te.ownerDocument.doctype.name+`>
`+rn),He&&(rn=Fr(rn,ce," "),rn=Fr(rn,be," "),rn=Fr(rn,qe," ")),A&&Re?A.createHTML(rn):rn},e.setConfig=function(Ee){Qt(Ee),lt=!0},e.clearConfig=function(){cn=null,lt=!1},e.isValidAttribute=function(Ee,H,te){cn||Qt({});var le=Bt(Ee),ut=Bt(H);return ER(le,ut,te)},e.addHook=function(Ee,H){typeof H=="function"&&(ne[Ee]=ne[Ee]||[],ru(ne[Ee],H))},e.removeHook=function(Ee){if(ne[Ee])return w0(ne[Ee])},e.removeHooks=function(Ee){ne[Ee]&&(ne[Ee]=[])},e.removeAllHooks=function(){ne={}},e}var XV=vI();//! moment.js
//! version : 2.29.4
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var CI;function q(){return CI.apply(null,arguments)}function qV(t){CI=t}function si(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function fa(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function st(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function WC(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(st(t,e))return!1;return!0}function Jn(t){return t===void 0}function yo(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Gc(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function SI(t,e){var n=[],r,i=t.length;for(r=0;r<i;++r)n.push(e(t[r],r));return n}function ns(t,e){for(var n in e)st(e,n)&&(t[n]=e[n]);return st(e,"toString")&&(t.toString=e.toString),st(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Wi(t,e,n,r){return GI(t,e,n,r,!0).utc()}function ZV(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(t){return t._pf==null&&(t._pf=ZV()),t._pf}var fv;Array.prototype.some?fv=Array.prototype.some:fv=function(t){var e=Object(this),n=e.length>>>0,r;for(r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};function VC(t){if(t._isValid==null){var e=ze(t),n=fv.call(e.parsedDateParts,function(i){return i!=null}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=r;else return r}return t._isValid}function pg(t){var e=Wi(NaN);return t!=null?ns(ze(e),t):ze(e).userInvalidated=!0,e}var b0=q.momentProperties=[],Bm=!1;function BC(t,e){var n,r,i,o=b0.length;if(Jn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Jn(e._i)||(t._i=e._i),Jn(e._f)||(t._f=e._f),Jn(e._l)||(t._l=e._l),Jn(e._strict)||(t._strict=e._strict),Jn(e._tzm)||(t._tzm=e._tzm),Jn(e._isUTC)||(t._isUTC=e._isUTC),Jn(e._offset)||(t._offset=e._offset),Jn(e._pf)||(t._pf=ze(e)),Jn(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)r=b0[n],i=e[r],Jn(i)||(t[r]=i);return t}function zc(t){BC(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Bm===!1&&(Bm=!0,q.updateOffset(this),Bm=!1)}function ai(t){return t instanceof zc||t!=null&&t._isAMomentObject!=null}function yI(t){q.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Lr(t,e){var n=!0;return ns(function(){if(q.deprecationHandler!=null&&q.deprecationHandler(null,t),n){var r=[],i,o,s,a=arguments.length;for(o=0;o<a;o++){if(i="",typeof arguments[o]=="object"){i+=`
[`+o+"] ";for(s in arguments[0])st(arguments[0],s)&&(i+=s+": "+arguments[0][s]+", ");i=i.slice(0,-2)}else i=arguments[o];r.push(i)}yI(t+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var R0={};function bI(t,e){q.deprecationHandler!=null&&q.deprecationHandler(t,e),R0[t]||(yI(e),R0[t]=!0)}q.suppressDeprecationWarnings=!1;q.deprecationHandler=null;function Vi(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function QV(t){var e,n;for(n in t)st(t,n)&&(e=t[n],Vi(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function gv(t,e){var n=ns({},t),r;for(r in e)st(e,r)&&(fa(t[r])&&fa(e[r])?(n[r]={},ns(n[r],t[r]),ns(n[r],e[r])):e[r]!=null?n[r]=e[r]:delete n[r]);for(r in t)st(t,r)&&!st(e,r)&&fa(t[r])&&(n[r]=ns({},n[r]));return n}function UC(t){t!=null&&this.set(t)}var mv;Object.keys?mv=Object.keys:mv=function(t){var e,n=[];for(e in t)st(t,e)&&n.push(e);return n};var JV={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function eB(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return Vi(r)?r.call(e,n):r}function $i(t,e,n){var r=""+Math.abs(t),i=e-r.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var GC=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,vh=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Um={},Pl={};function _e(t,e,n,r){var i=r;typeof r=="string"&&(i=function(){return this[r]()}),t&&(Pl[t]=i),e&&(Pl[e[0]]=function(){return $i(i.apply(this,arguments),e[1],e[2])}),n&&(Pl[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function tB(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function nB(t){var e=t.match(GC),n,r;for(n=0,r=e.length;n<r;n++)Pl[e[n]]?e[n]=Pl[e[n]]:e[n]=tB(e[n]);return function(i){var o="",s;for(s=0;s<r;s++)o+=Vi(e[s])?e[s].call(i,t):e[s];return o}}function Ud(t,e){return t.isValid()?(e=RI(e,t.localeData()),Um[e]=Um[e]||nB(e),Um[e](t)):t.localeData().invalidDate()}function RI(t,e){var n=5;function r(i){return e.longDateFormat(i)||i}for(vh.lastIndex=0;n>=0&&vh.test(t);)t=t.replace(vh,r),vh.lastIndex=0,n-=1;return t}var rB={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function iB(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(GC).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[t])}var oB="Invalid date";function sB(){return this._invalidDate}var aB="%d",lB=/\d{1,2}/;function uB(t){return this._ordinal.replace("%d",t)}var cB={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function hB(t,e,n,r){var i=this._relativeTime[n];return Vi(i)?i(t,e,n,r):i.replace(/%d/i,t)}function dB(t,e){var n=this._relativeTime[t>0?"future":"past"];return Vi(n)?n(e):n.replace(/%s/i,e)}var tc={};function An(t,e){var n=t.toLowerCase();tc[n]=tc[n+"s"]=tc[e]=t}function $r(t){return typeof t=="string"?tc[t]||tc[t.toLowerCase()]:void 0}function zC(t){var e={},n,r;for(r in t)st(t,r)&&(n=$r(r),n&&(e[n]=t[r]));return e}var EI={};function On(t,e){EI[t]=e}function fB(t){var e=[],n;for(n in t)st(t,n)&&e.push({unit:n,priority:EI[n]});return e.sort(function(r,i){return r.priority-i.priority}),e}function wg(t){return t%4===0&&t%100!==0||t%400===0}function Ir(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function et(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Ir(e)),n}function Gl(t,e){return function(n){return n!=null?(TI(this,t,n),q.updateOffset(this,e),this):Cf(this,t)}}function Cf(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function TI(t,e,n){t.isValid()&&!isNaN(n)&&(e==="FullYear"&&wg(t.year())&&t.month()===1&&t.date()===29?(n=et(n),t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),Rg(n,t.month()))):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function gB(t){return t=$r(t),Vi(this[t])?this[t]():this}function mB(t,e){if(typeof t=="object"){t=zC(t);var n=fB(t),r,i=n.length;for(r=0;r<i;r++)this[n[r].unit](t[n[r].unit])}else if(t=$r(t),Vi(this[t]))return this[t](e);return this}var _I=/\d/,Cr=/\d\d/,MI=/\d{3}/,YC=/\d{4}/,vg=/[+-]?\d{6}/,Tt=/\d\d?/,AI=/\d\d\d\d?/,OI=/\d\d\d\d\d\d?/,Cg=/\d{1,3}/,jC=/\d{1,4}/,Sg=/[+-]?\d{1,6}/,zl=/\d+/,yg=/[+-]?\d+/,pB=/Z|[+-]\d\d:?\d\d/gi,bg=/Z|[+-]\d\d(?::?\d\d)?/gi,wB=/[+-]?\d+(\.\d{1,3})?/,Yc=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Sf;Sf={};function ge(t,e,n){Sf[t]=Vi(e)?e:function(r,i){return r&&n?n:e}}function vB(t,e){return st(Sf,t)?Sf[t](e._strict,e._locale):new RegExp(CB(t))}function CB(t){return pr(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,r,i,o){return n||r||i||o}))}function pr(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var pv={};function mt(t,e){var n,r=e,i;for(typeof t=="string"&&(t=[t]),yo(e)&&(r=function(o,s){s[e]=et(o)}),i=t.length,n=0;n<i;n++)pv[t[n]]=r}function jc(t,e){mt(t,function(n,r,i,o){i._w=i._w||{},e(n,i._w,i,o)})}function SB(t,e,n){e!=null&&st(pv,t)&&pv[t](e,n._a,n,t)}var Rn=0,ho=1,Ii=2,tn=3,ni=4,fo=5,sa=6,yB=7,bB=8;function RB(t,e){return(t%e+e)%e}var Yt;Array.prototype.indexOf?Yt=Array.prototype.indexOf:Yt=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Rg(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=RB(e,12);return t+=(e-n)/12,n===1?wg(t)?29:28:31-n%7%2}_e("M",["MM",2],"Mo",function(){return this.month()+1});_e("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});_e("MMMM",0,0,function(t){return this.localeData().months(this,t)});An("month","M");On("month",8);ge("M",Tt);ge("MM",Tt,Cr);ge("MMM",function(t,e){return e.monthsShortRegex(t)});ge("MMMM",function(t,e){return e.monthsRegex(t)});mt(["M","MM"],function(t,e){e[ho]=et(t)-1});mt(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);i!=null?e[ho]=i:ze(n).invalidMonth=t});var EB="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),PI="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),II=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,TB=Yc,_B=Yc;function MB(t,e){return t?si(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||II).test(e)?"format":"standalone"][t.month()]:si(this._months)?this._months:this._months.standalone}function AB(t,e){return t?si(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[II.test(e)?"format":"standalone"][t.month()]:si(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function OB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=Wi([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:null):(i=Yt.call(this._longMonthsParse,s),i!==-1?i:null):e==="MMM"?(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:(i=Yt.call(this._longMonthsParse,s),i!==-1?i:null)):(i=Yt.call(this._longMonthsParse,s),i!==-1?i:(i=Yt.call(this._shortMonthsParse,s),i!==-1?i:null))}function PB(t,e,n){var r,i,o;if(this._monthsParseExact)return OB.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=Wi([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!n&&!this._monthsParse[r]&&(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[r].test(t))return r;if(n&&e==="MMM"&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function xI(t,e){var n;if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=et(e);else if(e=t.localeData().monthsParse(e),!yo(e))return t}return n=Math.min(t.date(),Rg(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function HI(t){return t!=null?(xI(this,t),q.updateOffset(this,!0),this):Cf(this,"Month")}function IB(){return Rg(this.year(),this.month())}function xB(t){return this._monthsParseExact?(st(this,"_monthsRegex")||DI.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(st(this,"_monthsShortRegex")||(this._monthsShortRegex=TB),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function HB(t){return this._monthsParseExact?(st(this,"_monthsRegex")||DI.call(this),t?this._monthsStrictRegex:this._monthsRegex):(st(this,"_monthsRegex")||(this._monthsRegex=_B),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function DI(){function t(s,a){return a.length-s.length}var e=[],n=[],r=[],i,o;for(i=0;i<12;i++)o=Wi([2e3,i]),e.push(this.monthsShort(o,"")),n.push(this.months(o,"")),r.push(this.months(o,"")),r.push(this.monthsShort(o,""));for(e.sort(t),n.sort(t),r.sort(t),i=0;i<12;i++)e[i]=pr(e[i]),n[i]=pr(n[i]);for(i=0;i<24;i++)r[i]=pr(r[i]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}_e("Y",0,0,function(){var t=this.year();return t<=9999?$i(t,4):"+"+t});_e(0,["YY",2],0,function(){return this.year()%100});_e(0,["YYYY",4],0,"year");_e(0,["YYYYY",5],0,"year");_e(0,["YYYYYY",6,!0],0,"year");An("year","y");On("year",1);ge("Y",yg);ge("YY",Tt,Cr);ge("YYYY",jC,YC);ge("YYYYY",Sg,vg);ge("YYYYYY",Sg,vg);mt(["YYYYY","YYYYYY"],Rn);mt("YYYY",function(t,e){e[Rn]=t.length===2?q.parseTwoDigitYear(t):et(t)});mt("YY",function(t,e){e[Rn]=q.parseTwoDigitYear(t)});mt("Y",function(t,e){e[Rn]=parseInt(t,10)});function nc(t){return wg(t)?366:365}q.parseTwoDigitYear=function(t){return et(t)+(et(t)>68?1900:2e3)};var NI=Gl("FullYear",!0);function DB(){return wg(this.year())}function NB(t,e,n,r,i,o,s){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,r,i,o,s),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,r,i,o,s),a}function Ec(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function yf(t,e,n){var r=7+e-n,i=(7+Ec(t,0,r).getUTCDay()-e)%7;return-i+r-1}function LI(t,e,n,r,i){var o=(7+n-r)%7,s=yf(t,r,i),a=1+7*(e-1)+o+s,l,u;return a<=0?(l=t-1,u=nc(l)+a):a>nc(t)?(l=t+1,u=a-nc(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Tc(t,e,n){var r=yf(t.year(),e,n),i=Math.floor((t.dayOfYear()-r-1)/7)+1,o,s;return i<1?(s=t.year()-1,o=i+So(s,e,n)):i>So(t.year(),e,n)?(o=i-So(t.year(),e,n),s=t.year()+1):(s=t.year(),o=i),{week:o,year:s}}function So(t,e,n){var r=yf(t,e,n),i=yf(t+1,e,n);return(nc(t)-r+i)/7}_e("w",["ww",2],"wo","week");_e("W",["WW",2],"Wo","isoWeek");An("week","w");An("isoWeek","W");On("week",5);On("isoWeek",5);ge("w",Tt);ge("ww",Tt,Cr);ge("W",Tt);ge("WW",Tt,Cr);jc(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=et(t)});function LB(t){return Tc(t,this._week.dow,this._week.doy).week}var $B={dow:0,doy:6};function kB(){return this._week.dow}function FB(){return this._week.doy}function WB(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function VB(t){var e=Tc(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}_e("d",0,"do","day");_e("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});_e("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});_e("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});_e("e",0,0,"weekday");_e("E",0,0,"isoWeekday");An("day","d");An("weekday","e");An("isoWeekday","E");On("day",11);On("weekday",11);On("isoWeekday",11);ge("d",Tt);ge("e",Tt);ge("E",Tt);ge("dd",function(t,e){return e.weekdaysMinRegex(t)});ge("ddd",function(t,e){return e.weekdaysShortRegex(t)});ge("dddd",function(t,e){return e.weekdaysRegex(t)});jc(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);i!=null?e.d=i:ze(n).invalidWeekday=t});jc(["d","e","E"],function(t,e,n,r){e[r]=et(t)});function BB(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function UB(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function KC(t,e){return t.slice(e,7).concat(t.slice(0,e))}var GB="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),$I="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),zB="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),YB=Yc,jB=Yc,KB=Yc;function XB(t,e){var n=si(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?KC(n,this._week.dow):t?n[t.day()]:n}function qB(t){return t===!0?KC(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function ZB(t){return t===!0?KC(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function QB(t,e,n){var r,i,o,s=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=Wi([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(i=Yt.call(this._weekdaysParse,s),i!==-1?i:null):e==="ddd"?(i=Yt.call(this._shortWeekdaysParse,s),i!==-1?i:null):(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null):e==="dddd"?(i=Yt.call(this._weekdaysParse,s),i!==-1||(i=Yt.call(this._shortWeekdaysParse,s),i!==-1)?i:(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null)):e==="ddd"?(i=Yt.call(this._shortWeekdaysParse,s),i!==-1||(i=Yt.call(this._weekdaysParse,s),i!==-1)?i:(i=Yt.call(this._minWeekdaysParse,s),i!==-1?i:null)):(i=Yt.call(this._minWeekdaysParse,s),i!==-1||(i=Yt.call(this._weekdaysParse,s),i!==-1)?i:(i=Yt.call(this._shortWeekdaysParse,s),i!==-1?i:null))}function JB(t,e,n){var r,i,o;if(this._weekdaysParseExact)return QB.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=Wi([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[r].test(t))return r;if(n&&e==="ddd"&&this._shortWeekdaysParse[r].test(t))return r;if(n&&e==="dd"&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function eU(t){if(!this.isValid())return t!=null?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return t!=null?(t=BB(t,this.localeData()),this.add(t-e,"d")):e}function tU(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function nU(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=UB(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function rU(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||XC.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(st(this,"_weekdaysRegex")||(this._weekdaysRegex=YB),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function iU(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||XC.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(st(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jB),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function oU(t){return this._weekdaysParseExact?(st(this,"_weekdaysRegex")||XC.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(st(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=KB),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function XC(){function t(c,h){return h.length-c.length}var e=[],n=[],r=[],i=[],o,s,a,l,u;for(o=0;o<7;o++)s=Wi([2e3,1]).day(o),a=pr(this.weekdaysMin(s,"")),l=pr(this.weekdaysShort(s,"")),u=pr(this.weekdays(s,"")),e.push(a),n.push(l),r.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),n.sort(t),r.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function qC(){return this.hours()%12||12}function sU(){return this.hours()||24}_e("H",["HH",2],0,"hour");_e("h",["hh",2],0,qC);_e("k",["kk",2],0,sU);_e("hmm",0,0,function(){return""+qC.apply(this)+$i(this.minutes(),2)});_e("hmmss",0,0,function(){return""+qC.apply(this)+$i(this.minutes(),2)+$i(this.seconds(),2)});_e("Hmm",0,0,function(){return""+this.hours()+$i(this.minutes(),2)});_e("Hmmss",0,0,function(){return""+this.hours()+$i(this.minutes(),2)+$i(this.seconds(),2)});function kI(t,e){_e(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}kI("a",!0);kI("A",!1);An("hour","h");On("hour",13);function FI(t,e){return e._meridiemParse}ge("a",FI);ge("A",FI);ge("H",Tt);ge("h",Tt);ge("k",Tt);ge("HH",Tt,Cr);ge("hh",Tt,Cr);ge("kk",Tt,Cr);ge("hmm",AI);ge("hmmss",OI);ge("Hmm",AI);ge("Hmmss",OI);mt(["H","HH"],tn);mt(["k","kk"],function(t,e,n){var r=et(t);e[tn]=r===24?0:r});mt(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});mt(["h","hh"],function(t,e,n){e[tn]=et(t),ze(n).bigHour=!0});mt("hmm",function(t,e,n){var r=t.length-2;e[tn]=et(t.substr(0,r)),e[ni]=et(t.substr(r)),ze(n).bigHour=!0});mt("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[tn]=et(t.substr(0,r)),e[ni]=et(t.substr(r,2)),e[fo]=et(t.substr(i)),ze(n).bigHour=!0});mt("Hmm",function(t,e,n){var r=t.length-2;e[tn]=et(t.substr(0,r)),e[ni]=et(t.substr(r))});mt("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[tn]=et(t.substr(0,r)),e[ni]=et(t.substr(r,2)),e[fo]=et(t.substr(i))});function aU(t){return(t+"").toLowerCase().charAt(0)==="p"}var lU=/[ap]\.?m?\.?/i,uU=Gl("Hours",!0);function cU(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var WI={calendar:JV,longDateFormat:rB,invalidDate:oB,ordinal:aB,dayOfMonthOrdinalParse:lB,relativeTime:cB,months:EB,monthsShort:PI,week:$B,weekdays:GB,weekdaysMin:zB,weekdaysShort:$I,meridiemParse:lU},Pt={},iu={},_c;function hU(t,e){var n,r=Math.min(t.length,e.length);for(n=0;n<r;n+=1)if(t[n]!==e[n])return n;return r}function E0(t){return t&&t.toLowerCase().replace("_","-")}function dU(t){for(var e=0,n,r,i,o;e<t.length;){for(o=E0(t[e]).split("-"),n=o.length,r=E0(t[e+1]),r=r?r.split("-"):null;n>0;){if(i=Eg(o.slice(0,n).join("-")),i)return i;if(r&&r.length>=n&&hU(o,r)>=n-1)break;n--}e++}return _c}function fU(t){return t.match("^[^/\\\\]*$")!=null}function Eg(t){var e=null,n;if(Pt[t]===void 0&&typeof ff<"u"&&ff&&ff.exports&&fU(t))try{e=_c._abbr,n=require,n("./locale/"+t),ls(e)}catch{Pt[t]=null}return Pt[t]}function ls(t,e){var n;return t&&(Jn(e)?n=_o(t):n=ZC(t,e),n?_c=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),_c._abbr}function ZC(t,e){if(e!==null){var n,r=WI;if(e.abbr=t,Pt[t]!=null)bI("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Pt[t]._config;else if(e.parentLocale!=null)if(Pt[e.parentLocale]!=null)r=Pt[e.parentLocale]._config;else if(n=Eg(e.parentLocale),n!=null)r=n._config;else return iu[e.parentLocale]||(iu[e.parentLocale]=[]),iu[e.parentLocale].push({name:t,config:e}),null;return Pt[t]=new UC(gv(r,e)),iu[t]&&iu[t].forEach(function(i){ZC(i.name,i.config)}),ls(t),Pt[t]}else return delete Pt[t],null}function gU(t,e){if(e!=null){var n,r,i=WI;Pt[t]!=null&&Pt[t].parentLocale!=null?Pt[t].set(gv(Pt[t]._config,e)):(r=Eg(t),r!=null&&(i=r._config),e=gv(i,e),r==null&&(e.abbr=t),n=new UC(e),n.parentLocale=Pt[t],Pt[t]=n),ls(t)}else Pt[t]!=null&&(Pt[t].parentLocale!=null?(Pt[t]=Pt[t].parentLocale,t===ls()&&ls(t)):Pt[t]!=null&&delete Pt[t]);return Pt[t]}function _o(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return _c;if(!si(t)){if(e=Eg(t),e)return e;t=[t]}return dU(t)}function mU(){return mv(Pt)}function QC(t){var e,n=t._a;return n&&ze(t).overflow===-2&&(e=n[ho]<0||n[ho]>11?ho:n[Ii]<1||n[Ii]>Rg(n[Rn],n[ho])?Ii:n[tn]<0||n[tn]>24||n[tn]===24&&(n[ni]!==0||n[fo]!==0||n[sa]!==0)?tn:n[ni]<0||n[ni]>59?ni:n[fo]<0||n[fo]>59?fo:n[sa]<0||n[sa]>999?sa:-1,ze(t)._overflowDayOfYear&&(e<Rn||e>Ii)&&(e=Ii),ze(t)._overflowWeeks&&e===-1&&(e=yB),ze(t)._overflowWeekday&&e===-1&&(e=bB),ze(t).overflow=e),t}var pU=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,wU=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vU=/Z|[+-]\d\d(?::?\d\d)?/,Ch=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Gm=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],CU=/^\/?Date\((-?\d+)/i,SU=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yU={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function VI(t){var e,n,r=t._i,i=pU.exec(r)||wU.exec(r),o,s,a,l,u=Ch.length,c=Gm.length;if(i){for(ze(t).iso=!0,e=0,n=u;e<n;e++)if(Ch[e][1].exec(i[1])){s=Ch[e][0],o=Ch[e][2]!==!1;break}if(s==null){t._isValid=!1;return}if(i[3]){for(e=0,n=c;e<n;e++)if(Gm[e][1].exec(i[3])){a=(i[2]||" ")+Gm[e][0];break}if(a==null){t._isValid=!1;return}}if(!o&&a!=null){t._isValid=!1;return}if(i[4])if(vU.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=s+(a||"")+(l||""),eS(t)}else t._isValid=!1}function bU(t,e,n,r,i,o){var s=[RU(t),PI.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function RU(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function EU(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function TU(t,e,n){if(t){var r=$I.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(r!==i)return ze(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function _U(t,e,n){if(t)return yU[t];if(e)return 0;var r=parseInt(n,10),i=r%100,o=(r-i)/100;return o*60+i}function BI(t){var e=SU.exec(EU(t._i)),n;if(e){if(n=bU(e[4],e[3],e[2],e[5],e[6],e[7]),!TU(e[1],n,t))return;t._a=n,t._tzm=_U(e[8],e[9],e[10]),t._d=Ec.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ze(t).rfc2822=!0}else t._isValid=!1}function MU(t){var e=CU.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(VI(t),t._isValid===!1)delete t._isValid;else return;if(BI(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:q.createFromInputFallback(t)}q.createFromInputFallback=Lr("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function yl(t,e,n){return t??e??n}function AU(t){var e=new Date(q.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function JC(t){var e,n,r=[],i,o,s;if(!t._d){for(i=AU(t),t._w&&t._a[Ii]==null&&t._a[ho]==null&&OU(t),t._dayOfYear!=null&&(s=yl(t._a[Rn],i[Rn]),(t._dayOfYear>nc(s)||t._dayOfYear===0)&&(ze(t)._overflowDayOfYear=!0),n=Ec(s,0,t._dayOfYear),t._a[ho]=n.getUTCMonth(),t._a[Ii]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=r[e]=i[e];for(;e<7;e++)t._a[e]=r[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[tn]===24&&t._a[ni]===0&&t._a[fo]===0&&t._a[sa]===0&&(t._nextDay=!0,t._a[tn]=0),t._d=(t._useUTC?Ec:NB).apply(null,r),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[tn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(ze(t).weekdayMismatch=!0)}}function OU(t){var e,n,r,i,o,s,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,s=4,n=yl(e.GG,t._a[Rn],Tc(Et(),1,4).year),r=yl(e.W,1),i=yl(e.E,1),(i<1||i>7)&&(l=!0)):(o=t._locale._week.dow,s=t._locale._week.doy,u=Tc(Et(),o,s),n=yl(e.gg,t._a[Rn],u.year),r=yl(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+o,(e.e<0||e.e>6)&&(l=!0)):i=o),r<1||r>So(n,o,s)?ze(t)._overflowWeeks=!0:l!=null?ze(t)._overflowWeekday=!0:(a=LI(n,r,i,o,s),t._a[Rn]=a.year,t._dayOfYear=a.dayOfYear)}q.ISO_8601=function(){};q.RFC_2822=function(){};function eS(t){if(t._f===q.ISO_8601){VI(t);return}if(t._f===q.RFC_2822){BI(t);return}t._a=[],ze(t).empty=!0;var e=""+t._i,n,r,i,o,s,a=e.length,l=0,u,c;for(i=RI(t._f,t._locale).match(GC)||[],c=i.length,n=0;n<c;n++)o=i[n],r=(e.match(vB(o,t))||[])[0],r&&(s=e.substr(0,e.indexOf(r)),s.length>0&&ze(t).unusedInput.push(s),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Pl[o]?(r?ze(t).empty=!1:ze(t).unusedTokens.push(o),SB(o,r,t)):t._strict&&!r&&ze(t).unusedTokens.push(o);ze(t).charsLeftOver=a-l,e.length>0&&ze(t).unusedInput.push(e),t._a[tn]<=12&&ze(t).bigHour===!0&&t._a[tn]>0&&(ze(t).bigHour=void 0),ze(t).parsedDateParts=t._a.slice(0),ze(t).meridiem=t._meridiem,t._a[tn]=PU(t._locale,t._a[tn],t._meridiem),u=ze(t).era,u!==null&&(t._a[Rn]=t._locale.erasConvertYear(u,t._a[Rn])),JC(t),QC(t)}function PU(t,e,n){var r;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(r=t.isPM(n),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function IU(t){var e,n,r,i,o,s,a=!1,l=t._f.length;if(l===0){ze(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)o=0,s=!1,e=BC({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],eS(e),VC(e)&&(s=!0),o+=ze(e).charsLeftOver,o+=ze(e).unusedTokens.length*10,ze(e).score=o,a?o<r&&(r=o,n=e):(r==null||o<r||s)&&(r=o,n=e,s&&(a=!0));ns(t,n||e)}function xU(t){if(!t._d){var e=zC(t._i),n=e.day===void 0?e.date:e.day;t._a=SI([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),JC(t)}}function HU(t){var e=new zc(QC(UI(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function UI(t){var e=t._i,n=t._f;return t._locale=t._locale||_o(t._l),e===null||n===void 0&&e===""?pg({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ai(e)?new zc(QC(e)):(Gc(e)?t._d=e:si(n)?IU(t):n?eS(t):DU(t),VC(t)||(t._d=null),t))}function DU(t){var e=t._i;Jn(e)?t._d=new Date(q.now()):Gc(e)?t._d=new Date(e.valueOf()):typeof e=="string"?MU(t):si(e)?(t._a=SI(e.slice(0),function(n){return parseInt(n,10)}),JC(t)):fa(e)?xU(t):yo(e)?t._d=new Date(e):q.createFromInputFallback(t)}function GI(t,e,n,r,i){var o={};return(e===!0||e===!1)&&(r=e,e=void 0),(n===!0||n===!1)&&(r=n,n=void 0),(fa(t)&&WC(t)||si(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=i,o._l=n,o._i=t,o._f=e,o._strict=r,HU(o)}function Et(t,e,n,r){return GI(t,e,n,r,!1)}var NU=Lr("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:pg()}),LU=Lr("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Et.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:pg()});function zI(t,e){var n,r;if(e.length===1&&si(e[0])&&(e=e[0]),!e.length)return Et();for(n=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](n))&&(n=e[r]);return n}function $U(){var t=[].slice.call(arguments,0);return zI("isBefore",t)}function kU(){var t=[].slice.call(arguments,0);return zI("isAfter",t)}var FU=function(){return Date.now?Date.now():+new Date},ou=["year","quarter","month","week","day","hour","minute","second","millisecond"];function WU(t){var e,n=!1,r,i=ou.length;for(e in t)if(st(t,e)&&!(Yt.call(ou,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(r=0;r<i;++r)if(t[ou[r]]){if(n)return!1;parseFloat(t[ou[r]])!==et(t[ou[r]])&&(n=!0)}return!0}function VU(){return this._isValid}function BU(){return ui(NaN)}function Tg(t){var e=zC(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||e.isoWeek||0,s=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=WU(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+s+o*7,this._months=+i+r*3+n*12,this._data={},this._locale=_o(),this._bubble()}function Gd(t){return t instanceof Tg}function wv(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function UU(t,e,n){var r=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),o=0,s;for(s=0;s<r;s++)(n&&t[s]!==e[s]||!n&&et(t[s])!==et(e[s]))&&o++;return o+i}function YI(t,e){_e(t,0,0,function(){var n=this.utcOffset(),r="+";return n<0&&(n=-n,r="-"),r+$i(~~(n/60),2)+e+$i(~~n%60,2)})}YI("Z",":");YI("ZZ","");ge("Z",bg);ge("ZZ",bg);mt(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=tS(bg,t)});var GU=/([\+\-]|\d\d)/gi;function tS(t,e){var n=(e||"").match(t),r,i,o;return n===null?null:(r=n[n.length-1]||[],i=(r+"").match(GU)||["-",0,0],o=+(i[1]*60)+et(i[2]),o===0?0:i[0]==="+"?o:-o)}function nS(t,e){var n,r;return e._isUTC?(n=e.clone(),r=(ai(t)||Gc(t)?t.valueOf():Et(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),q.updateOffset(n,!1),n):Et(t).local()}function vv(t){return-Math.round(t._d.getTimezoneOffset())}q.updateOffset=function(){};function zU(t,e,n){var r=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=tS(bg,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(i=vv(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),r!==t&&(!e||this._changeInProgress?XI(this,ui(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,q.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:vv(this)}function YU(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function jU(t){return this.utcOffset(0,t)}function KU(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(vv(this),"m")),this}function XU(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=tS(pB,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function qU(t){return this.isValid()?(t=t?Et(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function ZU(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function QU(){if(!Jn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return BC(t,this),t=UI(t),t._a?(e=t._isUTC?Wi(t._a):Et(t._a),this._isDSTShifted=this.isValid()&&UU(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function JU(){return this.isValid()?!this._isUTC:!1}function e2(){return this.isValid()?this._isUTC:!1}function jI(){return this.isValid()?this._isUTC&&this._offset===0:!1}var t2=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,n2=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ui(t,e){var n=t,r=null,i,o,s;return Gd(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:yo(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(r=t2.exec(t))?(i=r[1]==="-"?-1:1,n={y:0,d:et(r[Ii])*i,h:et(r[tn])*i,m:et(r[ni])*i,s:et(r[fo])*i,ms:et(wv(r[sa]*1e3))*i}):(r=n2.exec(t))?(i=r[1]==="-"?-1:1,n={y:Os(r[2],i),M:Os(r[3],i),w:Os(r[4],i),d:Os(r[5],i),h:Os(r[6],i),m:Os(r[7],i),s:Os(r[8],i)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(s=r2(Et(n.from),Et(n.to)),n={},n.ms=s.milliseconds,n.M=s.months),o=new Tg(n),Gd(t)&&st(t,"_locale")&&(o._locale=t._locale),Gd(t)&&st(t,"_isValid")&&(o._isValid=t._isValid),o}ui.fn=Tg.prototype;ui.invalid=BU;function Os(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function T0(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function r2(t,e){var n;return t.isValid()&&e.isValid()?(e=nS(e,t),t.isBefore(e)?n=T0(t,e):(n=T0(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function KI(t,e){return function(n,r){var i,o;return r!==null&&!isNaN(+r)&&(bI(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),i=ui(n,r),XI(this,i,t),this}}function XI(t,e,n,r){var i=e._milliseconds,o=wv(e._days),s=wv(e._months);t.isValid()&&(r=r??!0,s&&xI(t,Cf(t,"Month")+s*n),o&&TI(t,"Date",Cf(t,"Date")+o*n),i&&t._d.setTime(t._d.valueOf()+i*n),r&&q.updateOffset(t,o||s))}var i2=KI(1,"add"),o2=KI(-1,"subtract");function qI(t){return typeof t=="string"||t instanceof String}function s2(t){return ai(t)||Gc(t)||qI(t)||yo(t)||l2(t)||a2(t)||t===null||t===void 0}function a2(t){var e=fa(t)&&!WC(t),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,o,s=r.length;for(i=0;i<s;i+=1)o=r[i],n=n||st(t,o);return e&&n}function l2(t){var e=si(t),n=!1;return e&&(n=t.filter(function(r){return!yo(r)&&qI(t)}).length===0),e&&n}function u2(t){var e=fa(t)&&!WC(t),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,o;for(i=0;i<r.length;i+=1)o=r[i],n=n||st(t,o);return e&&n}function c2(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function h2(t,e){arguments.length===1&&(arguments[0]?s2(arguments[0])?(t=arguments[0],e=void 0):u2(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Et(),r=nS(n,this).startOf("day"),i=q.calendarFormat(this,r)||"sameElse",o=e&&(Vi(e[i])?e[i].call(this,n):e[i]);return this.format(o||this.localeData().calendar(i,this,Et(n)))}function d2(){return new zc(this)}function f2(t,e){var n=ai(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=$r(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function g2(t,e){var n=ai(t)?t:Et(t);return this.isValid()&&n.isValid()?(e=$r(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function m2(t,e,n,r){var i=ai(t)?t:Et(t),o=ai(e)?e:Et(e);return this.isValid()&&i.isValid()&&o.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(i,n):!this.isBefore(i,n))&&(r[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function p2(t,e){var n=ai(t)?t:Et(t),r;return this.isValid()&&n.isValid()?(e=$r(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function w2(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function v2(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function C2(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=nS(t,this),!r.isValid())return NaN;switch(i=(r.utcOffset()-this.utcOffset())*6e4,e=$r(e),e){case"year":o=zd(this,r)/12;break;case"month":o=zd(this,r);break;case"quarter":o=zd(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:Ir(o)}function zd(t,e){if(t.date()<e.date())return-zd(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),r=t.clone().add(n,"months"),i,o;return e-r<0?(i=t.clone().add(n-1,"months"),o=(e-r)/(r-i)):(i=t.clone().add(n+1,"months"),o=(e-r)/(i-r)),-(n+o)||0}q.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";q.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function S2(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function y2(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Ud(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Vi(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Ud(n,"Z")):Ud(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function b2(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,r,i,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+r+i+o)}function R2(t){t||(t=this.isUtc()?q.defaultFormatUtc:q.defaultFormat);var e=Ud(this,t);return this.localeData().postformat(e)}function E2(t,e){return this.isValid()&&(ai(t)&&t.isValid()||Et(t).isValid())?ui({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function T2(t){return this.from(Et(),t)}function _2(t,e){return this.isValid()&&(ai(t)&&t.isValid()||Et(t).isValid())?ui({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function M2(t){return this.to(Et(),t)}function ZI(t){var e;return t===void 0?this._locale._abbr:(e=_o(t),e!=null&&(this._locale=e),this)}var QI=Lr("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function JI(){return this._locale}var bf=1e3,Il=60*bf,Rf=60*Il,ex=(365*400+97)*24*Rf;function xl(t,e){return(t%e+e)%e}function tx(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-ex:new Date(t,e,n).valueOf()}function nx(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-ex:Date.UTC(t,e,n)}function A2(t){var e,n;if(t=$r(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?nx:tx,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=xl(e+(this._isUTC?0:this.utcOffset()*Il),Rf);break;case"minute":e=this._d.valueOf(),e-=xl(e,Il);break;case"second":e=this._d.valueOf(),e-=xl(e,bf);break}return this._d.setTime(e),q.updateOffset(this,!0),this}function O2(t){var e,n;if(t=$r(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?nx:tx,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=Rf-xl(e+(this._isUTC?0:this.utcOffset()*Il),Rf)-1;break;case"minute":e=this._d.valueOf(),e+=Il-xl(e,Il)-1;break;case"second":e=this._d.valueOf(),e+=bf-xl(e,bf)-1;break}return this._d.setTime(e),q.updateOffset(this,!0),this}function P2(){return this._d.valueOf()-(this._offset||0)*6e4}function I2(){return Math.floor(this.valueOf()/1e3)}function x2(){return new Date(this.valueOf())}function H2(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function D2(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function N2(){return this.isValid()?this.toISOString():null}function L2(){return VC(this)}function $2(){return ns({},ze(this))}function k2(){return ze(this).overflow}function F2(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}_e("N",0,0,"eraAbbr");_e("NN",0,0,"eraAbbr");_e("NNN",0,0,"eraAbbr");_e("NNNN",0,0,"eraName");_e("NNNNN",0,0,"eraNarrow");_e("y",["y",1],"yo","eraYear");_e("y",["yy",2],0,"eraYear");_e("y",["yyy",3],0,"eraYear");_e("y",["yyyy",4],0,"eraYear");ge("N",rS);ge("NN",rS);ge("NNN",rS);ge("NNNN",q2);ge("NNNNN",Z2);mt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,r){var i=n._locale.erasParse(t,r,n._strict);i?ze(n).era=i:ze(n).invalidEra=t});ge("y",zl);ge("yy",zl);ge("yyy",zl);ge("yyyy",zl);ge("yo",Q2);mt(["y","yy","yyy","yyyy"],Rn);mt(["yo"],function(t,e,n,r){var i;n._locale._eraYearOrdinalRegex&&(i=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Rn]=n._locale.eraYearOrdinalParse(t,i):e[Rn]=parseInt(t,10)});function W2(t,e){var n,r,i,o=this._eras||_o("en")._eras;for(n=0,r=o.length;n<r;++n){switch(typeof o[n].since){case"string":i=q(o[n].since).startOf("day"),o[n].since=i.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":i=q(o[n].until).startOf("day").valueOf(),o[n].until=i.valueOf();break}}return o}function V2(t,e,n){var r,i,o=this.eras(),s,a,l;for(t=t.toUpperCase(),r=0,i=o.length;r<i;++r)if(s=o[r].name.toUpperCase(),a=o[r].abbr.toUpperCase(),l=o[r].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return o[r];break;case"NNNN":if(s===t)return o[r];break;case"NNNNN":if(l===t)return o[r];break}else if([s,a,l].indexOf(t)>=0)return o[r]}function B2(t,e){var n=t.since<=t.until?1:-1;return e===void 0?q(t.since).year():q(t.since).year()+(e-t.offset)*n}function U2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].name;return""}function G2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].narrow;return""}function z2(){var t,e,n,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),r[t].since<=n&&n<=r[t].until||r[t].until<=n&&n<=r[t].since)return r[t].abbr;return""}function Y2(){var t,e,n,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=i[t].since<=i[t].until?1:-1,r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return(this.year()-q(i[t].since).year())*n+i[t].offset;return this.year()}function j2(t){return st(this,"_erasNameRegex")||iS.call(this),t?this._erasNameRegex:this._erasRegex}function K2(t){return st(this,"_erasAbbrRegex")||iS.call(this),t?this._erasAbbrRegex:this._erasRegex}function X2(t){return st(this,"_erasNarrowRegex")||iS.call(this),t?this._erasNarrowRegex:this._erasRegex}function rS(t,e){return e.erasAbbrRegex(t)}function q2(t,e){return e.erasNameRegex(t)}function Z2(t,e){return e.erasNarrowRegex(t)}function Q2(t,e){return e._eraYearOrdinalRegex||zl}function iS(){var t=[],e=[],n=[],r=[],i,o,s=this.eras();for(i=0,o=s.length;i<o;++i)e.push(pr(s[i].name)),t.push(pr(s[i].abbr)),n.push(pr(s[i].narrow)),r.push(pr(s[i].name)),r.push(pr(s[i].abbr)),r.push(pr(s[i].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}_e(0,["gg",2],0,function(){return this.weekYear()%100});_e(0,["GG",2],0,function(){return this.isoWeekYear()%100});function _g(t,e){_e(0,[t,t.length],0,e)}_g("gggg","weekYear");_g("ggggg","weekYear");_g("GGGG","isoWeekYear");_g("GGGGG","isoWeekYear");An("weekYear","gg");An("isoWeekYear","GG");On("weekYear",1);On("isoWeekYear",1);ge("G",yg);ge("g",yg);ge("GG",Tt,Cr);ge("gg",Tt,Cr);ge("GGGG",jC,YC);ge("gggg",jC,YC);ge("GGGGG",Sg,vg);ge("ggggg",Sg,vg);jc(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=et(t)});jc(["gg","GG"],function(t,e,n,r){e[r]=q.parseTwoDigitYear(t)});function J2(t){return rx.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function eG(t){return rx.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function tG(){return So(this.year(),1,4)}function nG(){return So(this.isoWeekYear(),1,4)}function rG(){var t=this.localeData()._week;return So(this.year(),t.dow,t.doy)}function iG(){var t=this.localeData()._week;return So(this.weekYear(),t.dow,t.doy)}function rx(t,e,n,r,i){var o;return t==null?Tc(this,r,i).year:(o=So(t,r,i),e>o&&(e=o),oG.call(this,t,e,n,r,i))}function oG(t,e,n,r,i){var o=LI(t,e,n,r,i),s=Ec(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}_e("Q",0,"Qo","quarter");An("quarter","Q");On("quarter",7);ge("Q",_I);mt("Q",function(t,e){e[ho]=(et(t)-1)*3});function sG(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}_e("D",["DD",2],"Do","date");An("date","D");On("date",9);ge("D",Tt);ge("DD",Tt,Cr);ge("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});mt(["D","DD"],Ii);mt("Do",function(t,e){e[Ii]=et(t.match(Tt)[0])});var ix=Gl("Date",!0);_e("DDD",["DDDD",3],"DDDo","dayOfYear");An("dayOfYear","DDD");On("dayOfYear",4);ge("DDD",Cg);ge("DDDD",MI);mt(["DDD","DDDD"],function(t,e,n){n._dayOfYear=et(t)});function aG(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}_e("m",["mm",2],0,"minute");An("minute","m");On("minute",14);ge("m",Tt);ge("mm",Tt,Cr);mt(["m","mm"],ni);var lG=Gl("Minutes",!1);_e("s",["ss",2],0,"second");An("second","s");On("second",15);ge("s",Tt);ge("ss",Tt,Cr);mt(["s","ss"],fo);var uG=Gl("Seconds",!1);_e("S",0,0,function(){return~~(this.millisecond()/100)});_e(0,["SS",2],0,function(){return~~(this.millisecond()/10)});_e(0,["SSS",3],0,"millisecond");_e(0,["SSSS",4],0,function(){return this.millisecond()*10});_e(0,["SSSSS",5],0,function(){return this.millisecond()*100});_e(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});_e(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});_e(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});_e(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});An("millisecond","ms");On("millisecond",16);ge("S",Cg,_I);ge("SS",Cg,Cr);ge("SSS",Cg,MI);var rs,ox;for(rs="SSSS";rs.length<=9;rs+="S")ge(rs,zl);function cG(t,e){e[sa]=et(("0."+t)*1e3)}for(rs="S";rs.length<=9;rs+="S")mt(rs,cG);ox=Gl("Milliseconds",!1);_e("z",0,0,"zoneAbbr");_e("zz",0,0,"zoneName");function hG(){return this._isUTC?"UTC":""}function dG(){return this._isUTC?"Coordinated Universal Time":""}var ee=zc.prototype;ee.add=i2;ee.calendar=h2;ee.clone=d2;ee.diff=C2;ee.endOf=O2;ee.format=R2;ee.from=E2;ee.fromNow=T2;ee.to=_2;ee.toNow=M2;ee.get=gB;ee.invalidAt=k2;ee.isAfter=f2;ee.isBefore=g2;ee.isBetween=m2;ee.isSame=p2;ee.isSameOrAfter=w2;ee.isSameOrBefore=v2;ee.isValid=L2;ee.lang=QI;ee.locale=ZI;ee.localeData=JI;ee.max=LU;ee.min=NU;ee.parsingFlags=$2;ee.set=mB;ee.startOf=A2;ee.subtract=o2;ee.toArray=H2;ee.toObject=D2;ee.toDate=x2;ee.toISOString=y2;ee.inspect=b2;typeof Symbol<"u"&&Symbol.for!=null&&(ee[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});ee.toJSON=N2;ee.toString=S2;ee.unix=I2;ee.valueOf=P2;ee.creationData=F2;ee.eraName=U2;ee.eraNarrow=G2;ee.eraAbbr=z2;ee.eraYear=Y2;ee.year=NI;ee.isLeapYear=DB;ee.weekYear=J2;ee.isoWeekYear=eG;ee.quarter=ee.quarters=sG;ee.month=HI;ee.daysInMonth=IB;ee.week=ee.weeks=WB;ee.isoWeek=ee.isoWeeks=VB;ee.weeksInYear=rG;ee.weeksInWeekYear=iG;ee.isoWeeksInYear=tG;ee.isoWeeksInISOWeekYear=nG;ee.date=ix;ee.day=ee.days=eU;ee.weekday=tU;ee.isoWeekday=nU;ee.dayOfYear=aG;ee.hour=ee.hours=uU;ee.minute=ee.minutes=lG;ee.second=ee.seconds=uG;ee.millisecond=ee.milliseconds=ox;ee.utcOffset=zU;ee.utc=jU;ee.local=KU;ee.parseZone=XU;ee.hasAlignedHourOffset=qU;ee.isDST=ZU;ee.isLocal=JU;ee.isUtcOffset=e2;ee.isUtc=jI;ee.isUTC=jI;ee.zoneAbbr=hG;ee.zoneName=dG;ee.dates=Lr("dates accessor is deprecated. Use date instead.",ix);ee.months=Lr("months accessor is deprecated. Use month instead",HI);ee.years=Lr("years accessor is deprecated. Use year instead",NI);ee.zone=Lr("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",YU);ee.isDSTShifted=Lr("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",QU);function fG(t){return Et(t*1e3)}function gG(){return Et.apply(null,arguments).parseZone()}function sx(t){return t}var at=UC.prototype;at.calendar=eB;at.longDateFormat=iB;at.invalidDate=sB;at.ordinal=uB;at.preparse=sx;at.postformat=sx;at.relativeTime=hB;at.pastFuture=dB;at.set=QV;at.eras=W2;at.erasParse=V2;at.erasConvertYear=B2;at.erasAbbrRegex=K2;at.erasNameRegex=j2;at.erasNarrowRegex=X2;at.months=MB;at.monthsShort=AB;at.monthsParse=PB;at.monthsRegex=HB;at.monthsShortRegex=xB;at.week=LB;at.firstDayOfYear=FB;at.firstDayOfWeek=kB;at.weekdays=XB;at.weekdaysMin=ZB;at.weekdaysShort=qB;at.weekdaysParse=JB;at.weekdaysRegex=rU;at.weekdaysShortRegex=iU;at.weekdaysMinRegex=oU;at.isPM=aU;at.meridiem=cU;function Ef(t,e,n,r){var i=_o(),o=Wi().set(r,e);return i[n](o,t)}function ax(t,e,n){if(yo(t)&&(e=t,t=void 0),t=t||"",e!=null)return Ef(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Ef(t,r,n,"month");return i}function oS(t,e,n,r){typeof t=="boolean"?(yo(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,yo(e)&&(n=e,e=void 0),e=e||"");var i=_o(),o=t?i._week.dow:0,s,a=[];if(n!=null)return Ef(e,(n+o)%7,r,"day");for(s=0;s<7;s++)a[s]=Ef(e,(s+o)%7,r,"day");return a}function mG(t,e){return ax(t,e,"months")}function pG(t,e){return ax(t,e,"monthsShort")}function wG(t,e,n){return oS(t,e,n,"weekdays")}function vG(t,e,n){return oS(t,e,n,"weekdaysShort")}function CG(t,e,n){return oS(t,e,n,"weekdaysMin")}ls("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=et(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});q.lang=Lr("moment.lang is deprecated. Use moment.locale instead.",ls);q.langData=Lr("moment.langData is deprecated. Use moment.localeData instead.",_o);var zi=Math.abs;function SG(){var t=this._data;return this._milliseconds=zi(this._milliseconds),this._days=zi(this._days),this._months=zi(this._months),t.milliseconds=zi(t.milliseconds),t.seconds=zi(t.seconds),t.minutes=zi(t.minutes),t.hours=zi(t.hours),t.months=zi(t.months),t.years=zi(t.years),this}function lx(t,e,n,r){var i=ui(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function yG(t,e){return lx(this,t,e,1)}function bG(t,e){return lx(this,t,e,-1)}function _0(t){return t<0?Math.floor(t):Math.ceil(t)}function RG(){var t=this._milliseconds,e=this._days,n=this._months,r=this._data,i,o,s,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=_0(Cv(n)+e)*864e5,e=0,n=0),r.milliseconds=t%1e3,i=Ir(t/1e3),r.seconds=i%60,o=Ir(i/60),r.minutes=o%60,s=Ir(o/60),r.hours=s%24,e+=Ir(s/24),l=Ir(ux(e)),n+=l,e-=_0(Cv(l)),a=Ir(n/12),n%=12,r.days=e,r.months=n,r.years=a,this}function ux(t){return t*4800/146097}function Cv(t){return t*146097/4800}function EG(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if(t=$r(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+r/864e5,n=this._months+ux(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Cv(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+t)}}function TG(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+et(this._months/12)*31536e6:NaN}function Mo(t){return function(){return this.as(t)}}var _G=Mo("ms"),MG=Mo("s"),AG=Mo("m"),OG=Mo("h"),PG=Mo("d"),IG=Mo("w"),xG=Mo("M"),HG=Mo("Q"),DG=Mo("y");function NG(){return ui(this)}function LG(t){return t=$r(t),this.isValid()?this[t+"s"]():NaN}function ba(t){return function(){return this.isValid()?this._data[t]:NaN}}var $G=ba("milliseconds"),kG=ba("seconds"),FG=ba("minutes"),WG=ba("hours"),VG=ba("days"),BG=ba("months"),UG=ba("years");function GG(){return Ir(this.days()/7)}var so=Math.round,_l={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function zG(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function YG(t,e,n,r){var i=ui(t).abs(),o=so(i.as("s")),s=so(i.as("m")),a=so(i.as("h")),l=so(i.as("d")),u=so(i.as("M")),c=so(i.as("w")),h=so(i.as("y")),d=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||s<=1&&["m"]||s<n.m&&["mm",s]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||c<=1&&["w"]||c<n.w&&["ww",c]),d=d||u<=1&&["M"]||u<n.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=r,zG.apply(null,d)}function jG(t){return t===void 0?so:typeof t=="function"?(so=t,!0):!1}function KG(t,e){return _l[t]===void 0?!1:e===void 0?_l[t]:(_l[t]=e,t==="s"&&(_l.ss=e-1),!0)}function XG(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,r=_l,i,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(r=Object.assign({},_l,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),i=this.localeData(),o=YG(this,!n,r,i),n&&(o=i.pastFuture(+this,o)),i.postformat(o)}var zm=Math.abs;function xa(t){return(t>0)-(t<0)||+t}function Mg(){if(!this.isValid())return this.localeData().invalidDate();var t=zm(this._milliseconds)/1e3,e=zm(this._days),n=zm(this._months),r,i,o,s,a=this.asSeconds(),l,u,c,h;return a?(r=Ir(t/60),i=Ir(r/60),t%=60,r%=60,o=Ir(n/12),n%=12,s=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=xa(this._months)!==xa(a)?"-":"",c=xa(this._days)!==xa(a)?"-":"",h=xa(this._milliseconds)!==xa(a)?"-":"",l+"P"+(o?u+o+"Y":"")+(n?u+n+"M":"")+(e?c+e+"D":"")+(i||r||t?"T":"")+(i?h+i+"H":"")+(r?h+r+"M":"")+(t?h+s+"S":"")):"P0D"}var rt=Tg.prototype;rt.isValid=VU;rt.abs=SG;rt.add=yG;rt.subtract=bG;rt.as=EG;rt.asMilliseconds=_G;rt.asSeconds=MG;rt.asMinutes=AG;rt.asHours=OG;rt.asDays=PG;rt.asWeeks=IG;rt.asMonths=xG;rt.asQuarters=HG;rt.asYears=DG;rt.valueOf=TG;rt._bubble=RG;rt.clone=NG;rt.get=LG;rt.milliseconds=$G;rt.seconds=kG;rt.minutes=FG;rt.hours=WG;rt.days=VG;rt.weeks=GG;rt.months=BG;rt.years=UG;rt.humanize=XG;rt.toISOString=Mg;rt.toString=Mg;rt.toJSON=Mg;rt.locale=ZI;rt.localeData=JI;rt.toIsoString=Lr("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Mg);rt.lang=QI;_e("X",0,0,"unix");_e("x",0,0,"valueOf");ge("x",yg);ge("X",wB);mt("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});mt("x",function(t,e,n){n._d=new Date(et(t))});//! moment.js
q.version="2.29.4";qV(Et);q.fn=ee;q.min=$U;q.max=kU;q.now=FU;q.utc=Wi;q.unix=fG;q.months=mG;q.isDate=Gc;q.locale=ls;q.invalid=pg;q.duration=ui;q.isMoment=ai;q.weekdays=wG;q.parseZone=gG;q.localeData=_o;q.isDuration=Gd;q.monthsShort=pG;q.weekdaysMin=CG;q.defineLocale=ZC;q.updateLocale=gU;q.locales=mU;q.weekdaysShort=vG;q.normalizeUnits=$r;q.relativeTimeRounding=jG;q.relativeTimeThreshold=KG;q.calendarFormat=c2;q.prototype=ee;q.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function cx(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function Sv(t,e){const n=e.length;let r=0;for(;r<n;)t.push(e[r]),r+=1}function rc(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function Gt(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));const a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function vr(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function Ue(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length,o=[];let s=-1;for(;n<i;){const a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function E(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));const i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function hx(t){return Gt(t,(e,n)=>e+n,0)}function qG(t){return Gt(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function ZG(t){return Gt(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function QG(t){return t.length?hx(t)/t.length:0}function dx(t){return Gt(t,(e,n)=>e.concat(Array.isArray(n)?dx(n):n),[])}function sS(t){const e=[];return E(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function yv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return E(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function JG(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e];let o=r;return E(i,s=>{o=o.filter(a=>s.includes(a))}),o}function ez(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=[...e],o=new Set(r);return E(i,s=>{E(s,a=>{o.has(a)||o.add(a)})}),Array.from(o)}function bv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const tz=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:QG,arrayEach:E,arrayFilter:vr,arrayFlatten:dx,arrayMap:Ue,arrayMax:qG,arrayMin:ZG,arrayReduce:Gt,arraySum:hx,arrayUnique:sS,extendArray:Sv,getDifferenceOfArrays:yv,getIntersectionOfArrays:JG,getUnionOfArrays:ez,pivot:rc,stringToArray:bv,to2dArray:cx},Symbol.toStringTag,{value:"Module"}));function ht(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Gt(t,(o,s,a)=>{const l=s.replace(/\r?\n\s*/g,""),u=n[a]?n[a]:"";return o+l+u},"").trim()}function Wt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ue(t){return typeof t<"u"}function Ct(t){return typeof t>"u"}function Zt(t){return t===null||t===""||Ct(t)}function fx(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Ku="length",ic=t=>parseInt(t,16),M0=t=>parseInt(t,10),Tf=(t,e,n)=>t.substr(e,n),oc=t=>t.codePointAt(0)-65,Rv=t=>`${t}`.replace(/\-/g,""),nz=t=>ic(Tf(Rv(t),ic("12"),oc("F")))/(ic(Tf(Rv(t),oc("B"),~~![][Ku]))||9),rz=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let A0=!1;const O0={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},P0={invalid:()=>ht`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ht`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ht`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function gx(t,e){const n=!Zt(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.1.0";let o,s="invalid",a="invalid";t=Rv(t||"");const l=iz(t);if(n||r||l)if(l){const u=q("16/01/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=nz(t);o=q((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(rz()&&(s="valid",a="valid"),!A0&&s!=="valid"&&(O0[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](O0[s]({keyValidityDate:o,hotVersion:i})),A0=!0),a!=="valid"&&e.parentNode&&P0[a]({keyValidityDate:o,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=P0[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function iz(t){let e=[][Ku],n=e;if(t[Ku]!==oc("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=oc(i.shift());o;o=oc(i.shift()||"A"))--o<""[Ku]?n=n|(M0(`${M0(ic(r)+(ic(Tf(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=Tf(t,o,o?i[Ku]===1?9:8:6);return n===e}const oz=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:gx,isDefined:ue,isEmpty:Zt,isRegExp:fx,isUndefined:Ct,stringify:Wt},Symbol.toStringTag,{value:"Module"}));function En(t){return t[0].toUpperCase()+t.substr(1)}function sz(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let i=n.length;for(;i;){i-=1;const o=Wt(n[i]).toLowerCase();t.indexOf(o)===-1&&t.push(o)}return t.length===1}function aS(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function lS(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function uS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function Ev(t){return Ag(`${t}`,{ALLOWED_TAGS:[]})}function Ag(t,e){return XV.sanitize(t,e)}const az=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:sz,isPercentValue:lS,randomString:aS,sanitize:Ag,stripTags:Ev,substitute:uS,toUpperCaseFirst:En},Symbol.toStringTag,{value:"Module"})),Yl=t=>["tabindex",t],lz=()=>["role","treegrid"],Di=()=>["role","presentation"],uz=()=>["role","gridcell"],cz=()=>["role","rowheader"],mx=()=>["role","rowgroup"],hz=()=>["role","columnheader"],Tv=()=>["role","row"],dz=()=>["role","menu"],fz=()=>["role","menuitem"],gz=()=>["role","combobox"],px=()=>["role","listbox"],mz=()=>["role","option"],pz=()=>["role","checkbox"],wz=()=>["scope","col"],vz=()=>["scope","row"],Cz=()=>["type","text"],cS=t=>["aria-label",t],Ao=()=>["aria-hidden","true"],Sz=()=>["aria-disabled","true"],yz=()=>["aria-multiselectable","true"],wx=t=>["aria-haspopup",t],vx=t=>["aria-rowcount",t],Og=t=>["aria-colcount",t],Cx=t=>["aria-rowindex",t],hS=t=>["aria-colindex",t],xr=t=>["aria-expanded",t],bz=t=>["aria-sort",t],I0=()=>["aria-readonly","true"],x0=()=>["aria-invalid","true"],Rz=t=>["aria-checked",t],dS=()=>["aria-selected","true"],Ez=()=>["aria-autocomplete","list"],Tz=t=>["aria-controls",t],_z=t=>["aria-activedescendant",t],Mz=t=>["aria-live",t],Az=t=>["aria-relevant",t],Oz=t=>["aria-setsize",t],Pz=t=>["aria-posinset",t];function Sx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function yx(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function bx(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Mc(t){return bx(t)&&t.parent}function Iz(t){return!!Object.getPrototypeOf(t.parent)}function gs(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;const{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function Xu(t,e,n){const r=[];let i=t;for(;i&&(i=gs(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const o=r.length;return o?r[o-1]:null}function us(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Rx(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function jo(t,e,n){const r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function Ex(t){return!t||!t.length?[]:t.filter(e=>!!e)}function Tx(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];const n=[],r=[];return r.push(...t.filter(i=>{const o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function Pe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Z(t,e){typeof e=="string"&&(e=e.split(" ")),e=Ex(e),e.length>0&&t.classList.add(...e)}function Le(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=Tx(e,!0);n=Ex(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function Te(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function Ra(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:r}=Tx(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function fS(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)fS(e[n])}}function li(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const _x=/(<(.*)>|&(.*);)/;function Ea(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_x.test(e)?t.innerHTML=n?Ag(e):e:ms(t,e)}function ms(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(li(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function ps(t){const e=t.ownerDocument.documentElement;let n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return ps(n.host.impl);if(n.host)return ps(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(bo(n).display==="none")return!1;n=n.parentNode}return!0}function en(t){const e=t.ownerDocument,n=e.defaultView,r=e.documentElement;let i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function gS(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Pg(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Ig(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?gS(e):t.scrollTop}function mS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Pg(e):t.scrollLeft}function Ac(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const r=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function ga(t){const e=t.ownerDocument,n=e.defaultView;let r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;const i=bo(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function $l(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const r=t.style[e];if(r!==""&&r!==void 0)return r;const i=bo(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function xz(t,e){const{selectorText:n}=e;let r=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?r=t.msMatchesSelector(n):t.matches&&(r=t.matches(n))),r}function bo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function ft(t){return t.offsetWidth}function xt(t){return t.offsetHeight}function aa(t){return t.clientHeight||t.innerHeight}function pS(t){return t.clientWidth||t.innerWidth}function Hz(t,e,n){t.addEventListener(e,n,!1)}function Dz(t,e,n){t.removeEventListener(e,n,!1)}function wS(t){return t.selectionStart?t.selectionStart:0}function Mx(t){return t.selectionEnd?t.selectionEnd:0}function Nz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function _v(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Kc(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}let Ym;function Lz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function nn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Ym===void 0&&(Ym=Lz(t)),Ym}function Ax(t){return t.offsetWidth!==t.clientWidth}function Ox(t){return t.offsetHeight!==t.clientHeight}function xg(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function $z(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Xc(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function sc(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function Hg(t){return sc(t)&&t.hasAttribute("data-hot-input")===!1}function kz(t){const e=t.ownerDocument.activeElement;Hg(e)||t.select()}function vS(t){return!t.parentNode}function Px(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function CS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();Te(t,"contenteditable",!0),n&&Te(t,...Ao()),e&&Z(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function SS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Le(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function Ix(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;CS(t,n),e(),SS(t,n)}const Fz=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:_x,addClass:Z,addEvent:Hz,clearTextSelection:_v,closest:gs,closestDown:Xu,empty:li,fastInnerHTML:Ea,fastInnerText:ms,getCaretPosition:wS,getComputedStyle:bo,getCssTransform:$z,getFrameElement:bx,getParent:Sx,getParentWindow:Mc,getScrollLeft:mS,getScrollTop:Ig,getScrollableElement:Ac,getScrollbarWidth:nn,getSelectionEndPosition:Mx,getSelectionText:Nz,getStyle:$l,getTrimmingContainer:ga,getWindowScrollLeft:Pg,getWindowScrollTop:gS,hasAccessToParentWindow:Iz,hasClass:Pe,hasHorizontalScrollbar:Ox,hasVerticalScrollbar:Ax,index:Rx,innerHeight:aa,innerWidth:pS,isChildOf:us,isDetached:vS,isInput:sc,isOutsideInput:Hg,isThisHotChild:yx,isVisible:ps,makeElementContentEditableAndSelectItsContent:CS,matchesCSSRules:xz,observeVisibilityChangeOnce:Px,offset:en,outerHeight:xt,outerWidth:ft,overlayContainsElement:jo,removeAttribute:Ra,removeClass:Le,removeContentEditableFromElementAndDeselect:SS,removeEvent:Dz,removeTextNodes:fS,resetCssTransform:Xc,runWithSelectedContendEditableElement:Ix,selectElementIfAllowed:kz,setAttribute:Te,setCaretPosition:Kc,setOverlayPosition:xg},Symbol.toStringTag,{value:"Module"}));function vt(t){return typeof t=="function"}function xx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const r={lastCallThrottled:!0};let i=null;function o(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];const u=Date.now();let c=!1;r.lastCallThrottled=!0,n||(n=u,c=!0);const h=e-(u-n);return c?(r.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,a),n=0,i=void 0},h)),r}return o}function Wz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const r=xx(t,e);let i=n;function o(){i=n}function s(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):r.apply(this,l)}return s.clearHits=o,s}function Dg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function Vz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[r,...i]=e;return function(){for(var s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return Gt(i,(u,c)=>c(u),r.apply(this,a))}}function yS(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function Hx(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s);let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function Bz(t){const e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];const l=r.concat(s.reverse());let u;return l.length>=e?u=t.apply(this,l):u=n(l),u}}return n([])}function _f(t,e,n,r,i,o,s,a){return ue(a)?t.call(e,n,r,i,o,s,a):ue(s)?t.call(e,n,r,i,o,s):ue(o)?t.call(e,n,r,i,o):ue(i)?t.call(e,n,r,i):ue(r)?t.call(e,n,r):ue(n)?t.call(e,n):t.call(e)}const Uz=Object.freeze(Object.defineProperty({__proto__:null,curry:Hx,curryRight:Bz,debounce:Dg,fastCall:_f,isFunction:vt,partial:yS,pipe:Vz,throttle:xx,throttleAfterHits:Wz},Symbol.toStringTag,{value:"Module"}));var Gz=Gn,H0=QP,zz=Mn,D0=Bl,Yz=oI,N0=Gz([].push),jz=function(t){if(zz(t))return t;if(H0(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?N0(n,i):(typeof i=="number"||D0(i)==="Number"||D0(i)==="String")&&N0(n,Yz(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(H0(this))return l;for(var u=0;u<o;u++)if(n[u]===a)return l}}},Kz=Es,Dx=Wc,Nx=mg,Xz=Sa,qc=Gn,Lx=Nr,L0=Mn,$0=_C,$x=kC,qz=jz,Zz=TC,Qz=String,cs=Dx("JSON","stringify"),Sh=qc(/./.exec),k0=qc("".charAt),Jz=qc("".charCodeAt),eY=qc("".replace),tY=qc(1 .toString),nY=/[\uD800-\uDFFF]/g,F0=/^[\uD800-\uDBFF]$/,W0=/^[\uDC00-\uDFFF]$/,V0=!Zz||Lx(function(){var t=Dx("Symbol")("stringify detection");return cs([t])!=="[null]"||cs({a:t})!=="{}"||cs(Object(t))!=="{}"}),B0=Lx(function(){return cs("\uDF06\uD834")!=='"\\udf06\\ud834"'||cs("\uDEAD")!=='"\\udead"'}),rY=function(t,e){var n=$x(arguments),r=qz(e);if(!(!L0(r)&&(t===void 0||$0(t))))return n[1]=function(i,o){if(L0(r)&&(o=Xz(r,this,Qz(i),o)),!$0(o))return o},Nx(cs,null,n)},iY=function(t,e,n){var r=k0(n,e-1),i=k0(n,e+1);return Sh(F0,t)&&!Sh(W0,i)||Sh(W0,t)&&!Sh(F0,r)?"\\u"+tY(Jz(t,0),16):t};cs&&Kz({target:"JSON",stat:!0,arity:3,forced:V0||B0},{stringify:function(e,n,r){var i=$x(arguments),o=Nx(V0?rY:cs,null,i);return B0&&typeof o=="string"?eY(o,nY,iY):o}});function kl(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ge(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=kl(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[kl(n[0])]:e[r]=[]:e[r]=null)})),e}function Oo(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function jt(t,e,n){const r=Array.isArray(n);return Ge(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Zc(t,e){Ge(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Zc(t[r],e[r])):t[r]=e[r]})}function Tn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Vn(t){const e={};return Ge(t,(n,r)=>{e[r]=n}),e}function pt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return E(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Ge(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{const a=function(c,h){const d=`_${c}`,f=p=>{let v=p;return(Array.isArray(v)||Ve(v))&&(v=Tn(v)),v};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function Ng(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Ve(t){return Object.prototype.toString.call(t)==="[object Object]"}function Bi(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Ge(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function kx(t,e){const n=e.split(".");let r=t;return Ge(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function Yd(t,e,n){const r=e.split(".");let i=t;r.forEach((o,s)=>{s!==r.length-1?(It(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function Lg(t){if(!Ve(t))return 0;const e=function(n){let r=0;return Ve(n)?Ge(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function ri(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function It(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const oY=Object.freeze(Object.defineProperty({__proto__:null,clone:Vn,createObjectPropListener:ri,deepClone:Tn,deepExtend:Zc,deepObjectSize:Lg,defineGetter:Bi,duckSchema:kl,extend:jt,getProperty:kx,hasOwnProperty:It,inherit:Oo,isObject:Ve,isObjectEqual:Ng,mixin:pt,objectEach:Ge,setProperty:Yd},Symbol.toStringTag,{value:"Module"}));function $g(t){return window.requestAnimationFrame(t)}function Oc(t){window.cancelAnimationFrame(t)}function bS(){return"ontouchstart"in window}function Fx(){return typeof window<"u"}let Ha;function Wx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Ha||(typeof Intl=="object"?Ha=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Ha=(n,r)=>`${n}`.localeCompare(r):Ha=(n,r)=>n===r?0:n>r?-1:1,Ha)}const sY=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Oc,getComparisonFunction:Wx,isCSR:Fx,isTouchSupported:bS,requestAnimationFrame:$g},Symbol.toStringTag,{value:"Module"})),Mr=t=>{const e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Po={chrome:Mr((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Mr(t=>/CriOS/.test(t)),edge:Mr(t=>/Edge/.test(t)),edgeWebKit:Mr(t=>/EdgiOS/.test(t)),firefox:Mr(t=>/Firefox/.test(t)),firefoxWebKit:Mr(t=>/FxiOS/.test(t)),mobile:Mr(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Mr((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},jl={mac:Mr(t=>/^Mac/.test(t)),win:Mr(t=>/^Win/.test(t)),linux:Mr(t=>/^Linux/.test(t)),ios:Mr(t=>/iPhone|iPad|iPod/i.test(t))};function Vx(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(Po,n=>{let{test:r}=n;return void r(t,e)})}function Bx(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(jl,e=>{let{test:n}=e;return void n(t)})}Fx()&&(Vx(),Bx());function RS(){return Po.chrome.value}function Ux(){return Po.chromeWebKit.value}function jd(){return Po.firefox.value}function Gx(){return Po.firefoxWebKit.value}function ES(){return Po.safari.value}function zx(){return Po.edge.value}function aY(){return Po.edgeWebKit.value}function go(){return Po.mobile.value}function TS(){return jl.ios.value}function _S(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&jl.mac.value}function Mv(){return jl.win.value}function Pc(){return jl.mac.value}function lY(){return jl.linux.value}const uY=Object.freeze(Object.defineProperty({__proto__:null,isChrome:RS,isChromeWebKit:Ux,isEdge:zx,isEdgeWebKit:aY,isFirefox:jd,isFirefoxWebKit:Gx,isIOS:TS,isIpadOS:_S,isLinuxOS:lY,isMacOS:Pc,isMobileBrowser:go,isSafari:ES,isWindowsOS:Mv,setBrowserMeta:Vx,setPlatformMeta:Bx},Symbol.toStringTag,{value:"Module"})),ve={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:jd()?182:174,AUDIO_MUTE:jd()?181:173,AUDIO_UP:jd()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},cY=[ve.ALT,ve.ARROW_DOWN,ve.ARROW_LEFT,ve.ARROW_RIGHT,ve.ARROW_UP,ve.AUDIO_DOWN,ve.AUDIO_MUTE,ve.AUDIO_UP,ve.BACKSPACE,ve.CAPS_LOCK,ve.DELETE,ve.END,ve.ENTER,ve.ESCAPE,ve.F1,ve.F2,ve.F3,ve.F4,ve.F5,ve.F6,ve.F7,ve.F8,ve.F9,ve.F10,ve.F11,ve.F12,ve.F13,ve.F14,ve.F15,ve.F16,ve.F17,ve.F18,ve.F19,ve.HOME,ve.INSERT,ve.MEDIA_NEXT,ve.MEDIA_PLAY_PAUSE,ve.MEDIA_PREV,ve.MEDIA_STOP,ve.NULL,ve.NUM_LOCK,ve.PAGE_DOWN,ve.PAGE_UP,ve.PAUSE,ve.SCROLL_LOCK,ve.SHIFT,ve.TAB];function Yx(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function MS(t){return cY.includes(t)}function hY(t){const e=[];return Pc()?e.push(ve.COMMAND_LEFT,ve.COMMAND_RIGHT,ve.COMMAND_FIREFOX):e.push(ve.CONTROL),e.includes(t)}function jx(t){return[ve.CONTROL,ve.COMMAND_LEFT,ve.COMMAND_RIGHT,ve.COMMAND_FIREFOX].includes(t)}function Kl(t,e){const n=e.split("|");let r=!1;return E(n,i=>{if(t===ve[i])return r=!0,!1}),r}const dY=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:ve,isCtrlKey:hY,isCtrlMetaKey:jx,isFunctionKey:MS,isKey:Kl,isPrintableChar:Yx},Symbol.toStringTag,{value:"Module"}));function kr(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Qo(t){return t.isImmediatePropagationEnabled===!1}function ws(t){return t.button===2}function kg(t){return t.button===0}function Kx(t,e){const n={x:t.offsetX,y:t.offsetY};let r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}const fY=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Qo,isLeftClick:kg,isRightClick:ws,offsetRelativeTo:Kx,stopImmediatePropagation:kr},Symbol.toStringTag,{value:"Module"}));function gt(){ue(console)&&console.warn(...arguments)}function AS(){ue(console)&&console.error(...arguments)}function gY(t,e,n){return e=mY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mY(t){var e=pY(t,"string");return typeof e=="symbol"?e:String(e)}function pY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Da=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],wY=ht`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,jm=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),Km=new Map([[]]);class Xx{static getSingleton(){return CY()}constructor(){gY(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return E(Da,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))E(n,i=>this.add(e,i,r));else{jm.has(e)&&gt(uS(wY,{hookName:e,removedInVersion:jm.get(e)})),Km.has(e)&&gt(Km.get(e));const i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&E(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?E(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{const u=this.globalBucket[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=_f(u[h],e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h]),h+=1}}{const u=this.getBucket(e)[n],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=_f(u[h],e,r,i,o,s,a,l);d!==void 0&&(r=d),u[h]&&u[h].runOnce&&this.remove(n,u[h],e),h+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Ge(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||Da.push(e)}deregister(e){this.isRegistered(e)&&Da.splice(Da.indexOf(e),1)}isDeprecated(e){return Km.has(e)||jm.has(e)}isRegistered(e){return Da.indexOf(e)>=0}getRegistered(){return Da}}const vY=new Xx;function CY(){return vY}const fe=Xx,Xm=new Map;function ci(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Xm.has(t)||Xm.set(t,new Map);const e=Xm.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}const Av=new WeakMap,{register:SY,getItem:qx,hasItem:Zx,getNames:yY,getValues:Jue}=ci("editors");function bY(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},fe.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function Qx(t,e){let n;if(typeof t=="function")Av.get(t)||er(null,t),n=Av.get(t);else if(typeof t=="string")n=qx(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function Mf(t){if(typeof t=="function")return t;if(!Zx(t))throw Error(`No registered editor found under "${t}" name`);return qx(t).getConstructor()}function er(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new bY(e);typeof t=="string"&&SY(t,n),Av.set(e,n)}function RY(t,e,n){return e=EY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EY(t){var e=TY(t,"string");return typeof e=="symbol"?e:String(e)}function TY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Kd=0;class _Y{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;RY(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,MY(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),Kd+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),Kd-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),Kd-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}}function MY(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),kr(this)},t}const Dr=_Y;function AY(){return Kd}function U0(t,e){OY(t,e),e.add(t)}function OY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(t,e,n){return e=PY(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PY(t){var e=IY(t,"string");return typeof e=="symbol"?e:String(e)}function IY(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function G0(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Fg="editorManager.navigation";var z0=new WeakSet,Y0=new WeakSet;class Ov{constructor(e,n,r){U0(this,Y0),U0(this,z0),Ho(this,"hot",void 0),Ho(this,"tableMeta",void 0),Ho(this,"selection",void 0),Ho(this,"eventManager",void 0),Ho(this,"destroyed",!1),Ho(this,"lock",!1),Ho(this,"activeEditor",void 0),Ho(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new Dr(e),this.hot.addHook("afterDocumentKeyDown",i=>G0(this,z0,xY).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>G0(this,Y0,HY).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:r,col:i}=n,o=this.hot.runHooks("modifyGetCellCoords",r,i);let s=r,a=i;if(Array.isArray(o)&&([s,a]=o),this.cellProperties=this.hot.getCellMeta(s,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(r,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),a);this.activeEditor=Qx(u,this.hot),this.activeEditor.prepare(r,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let o=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,n,r);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&i.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function xY(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Qo(t))return;const{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!MS(n)&&!jx(n)&&!r&&!this.isEditorOpened()){const o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>ue(this.hot.getSelected()),group:Fg};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function HY(t,e){e.isCell()&&this.openEditor(null,t,!0)}const j0=new WeakMap;Ov.getInstance=function(t,e,n){let r=j0.get(t);return r||(r=new Ov(t,e,n),j0.set(t,r)),r};const DY=Ov;function yh(t,e){Jx(t,e),e.add(t)}function su(t,e,n){Jx(t,e),e.set(t,n)}function Jx(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ml(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Lt(t,e){var n=e1(t,e,"get");return NY(t,n)}function NY(t,e){return e.get?e.get.call(t):e.value}function au(t,e,n){var r=e1(t,e,"set");return LY(t,r,n),n}function e1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function LY(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const is=Object.freeze({CELL:"cell",MIXED:"mixed"});var gn=new WeakMap,bh=new WeakMap,Rh=new WeakMap,Eh=new WeakMap,Th=new WeakMap,Af=new WeakSet,K0=new WeakSet,X0=new WeakSet,q0=new WeakSet;class $Y{constructor(e){var n=this;yh(this,q0),yh(this,X0),yh(this,K0),yh(this,Af),su(this,gn,{writable:!0,value:void 0}),su(this,bh,{writable:!0,value:void 0}),su(this,Rh,{writable:!0,value:50}),su(this,Eh,{writable:!0,value:null}),su(this,Th,{writable:!0,value:new Map});const r=e.getSettings();au(this,gn,e),au(this,bh,r.imeFastEdit?is.MIXED:is.CELL),Lt(this,gn).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ml(n,q0,WY).call(n,...o)}),Lt(this,gn).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ml(n,K0,kY).call(n,...o)}),Lt(this,gn).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return Ml(n,X0,FY).call(n,...o)})}getFocusMode(){return Lt(this,bh)}setFocusMode(e){Object.values(is).includes(e)?au(this,bh,e):gt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Lt(this,Rh)}setRefocusDelay(e){au(this,Rh,e)}setRefocusElementGetter(e){au(this,Eh,e)}getRefocusElement(){if(typeof Lt(this,Eh)=="function")return Lt(this,Eh).call(this);var e;return(e=Lt(this,gn).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=r=>{var i,o;const s=(i=Lt(this,gn).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=Lt(this,gn).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=Lt(this,gn).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):Ml(this,Af,OS).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Lt(this,Rh);const r=this.getRefocusElement();Lt(this,gn).getSettings().imeFastEdit&&!((e=Lt(this,gn).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(Lt(this,Th).has(n)||Lt(this,Th).set(n,Dg(()=>{r.select()},n)),Lt(this,Th).get(n)())}}function OS(t){var e;const n=(e=Lt(this,gn).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!Lt(this,gn).selection.isCellVisible(n)){t(null);return}const r=Lt(this,gn).getCell(n.row,n.col,!0);r===null?Lt(this,gn).addHookOnce("afterScroll",()=>{t(Lt(this,gn).getCell(n.row,n.col,!0))}):t(r)}function kY(){Ml(this,Af,OS).call(this,t=>{const{activeElement:e}=Lt(this,gn).rootDocument;e&&Hg(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function FY(){Ml(this,Af,OS).call(this,t=>{this.getFocusMode()===is.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function WY(t){t.imeFastEdit&&this.getFocusMode()!==is.MIXED?this.setFocusMode(is.MIXED):!t.imeFastEdit&&this.getFocusMode()!==is.CELL&&this.setFocusMode(is.CELL)}const t1={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},VY=new RegExp(Object.keys(t1).map(t=>`(${t})`).join("|"),"gi");function BY(t){return(t&&t.nodeName||"")==="TABLE"}function Pv(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=n?1:0,h=e?1:0;for(let d=0;d<o;d+=1){const f=e&&d===0,p=[];for(let S=0;S<s;S+=1){const y=!f&&n&&S===0;let R="";if(f)R=`<th>${t.getColHeader(S-c)}</th>`;else if(y)R=`<th>${t.getRowHeader(d-h)}</th>`;else{const T=i[d][S],{hidden:A,rowspan:M,colspan:L}=t.getCellMeta(d-h,S-c);if(!A){const B=[];if(M&&B.push(`rowspan="${M}"`),L&&B.push(`colspan="${L}"`),Zt(T))R=`<td ${B.join(" ")}></td>`;else{const K=T.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");R=`<td ${B.join(" ")}>${K}</td>`}}}p.push(R)}const v=["<tr>",...p,"</tr>"].join("");f?l.splice(1,0,v):u.splice(-1,0,v)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function Iv(t){const e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){const i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){const l=i[a],u=Zt(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${u}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function n1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){const T=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,A=>{const M=A.match(/<td\b[^>]*?>/g)[0],L=A.substring(M.length,A.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${M}${L}</td>`});i.insertAdjacentHTML("afterbegin",`${T}`),o=i.querySelector("table")}if(!o||!BY(o))return;const s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),u=l?Array.from(l.cells).reduce((T,A)=>T+A.colSpan,0)-(a?1:0):0,c=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,p=0;if(o.tHead){const T=Array.from(o.tHead.rows).filter(A=>{const M=A.querySelector("td")!==null;return M&&h.push(A),!M});f=T.length,d=f>0,f>1?n.nestedHeaders=Array.from(T).reduce((A,M)=>{const L=Array.from(M.cells).reduce((B,K,U)=>{if(a&&U===0)return B;const{colSpan:G,innerHTML:Q}=K,re=G>1?{label:Q,colspan:G}:Q;return B.push(re),B},[]);return A.push(L),A},[]):d&&(n.colHeaders=Array.from(T[0].children).reduce((A,M,L)=>(a&&L===0||A.push(M.innerHTML),A),[]))}h.length&&(n.fixedRowsTop=h.length),c.length&&(n.fixedRowsBottom=c.length);const v=[...h,...Array.from(o.tBodies).reduce((T,A)=>(T.push(...Array.from(A.rows)),T),[]),...c];p=v.length;const S=new Array(p);for(let T=0;T<p;T++)S[T]=new Array(u);const y=[],R=[];for(let T=0;T<p;T++){const A=v[T],M=Array.from(A.cells),L=M.length;for(let B=0;B<L;B++){const K=M[B],{nodeName:U,innerHTML:G,rowSpan:Q,colSpan:re}=K,ne=S[T].findIndex(ce=>ce===void 0);if(U==="TD"){if(Q>1||re>1){for(let Fe=T;Fe<T+Q;Fe++)if(Fe<p)for(let we=ne;we<ne+re;we++)S[Fe][we]=null;const be=K.getAttribute("style");be&&be.includes("mso-ignore:colspan")||y.push({col:ne,row:T,rowspan:Q,colspan:re})}let ce="";s&&/excel/gi.test(s.content)?ce=G.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ce=G.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),S[T][ne]=ce.replace(VY,be=>t1[be])}else R.push(G)}}return y.length&&(n.mergeCells=y),R.length&&(n.rowHeaders=R),S.length&&(n.data=S),n}const UY=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:Iv,htmlToGridSettings:n1,instanceToHTML:Pv},Symbol.toStringTag,{value:"Module"}));function Wn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function r1(t){return Wn(t,[","])}function pe(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function Of(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function PS(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function or(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}const GY=Object.freeze(Object.defineProperty({__proto__:null,clamp:or,isNumeric:Wn,isNumericLike:r1,rangeEach:pe,rangeEachReverse:Of,valueAccordingPercent:PS},Symbol.toStringTag,{value:"Module"})),xv="asc",zY="desc",Z0=new Map([[xv,[-1,1]],[zY,[1,-1]]]),YY=t=>`The priority '${t}' is already declared in a map.`,jY=t=>`The priority '${t}' is not a number.`;function KY(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=vt(t)?t:YY,e=vt(e)?e:jY;function r(o,s){if(!Wn(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xv;const[s,a]=Z0.get(o)||Z0.get(xv);return[...n].sort((l,u)=>l[0]<u[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}const XY=t=>`The id '${t}' is already declared in a map.`;function Wg(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=vt(t)?t:XY;function n(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function r(u){return e.delete(u)}function i(){e.clear()}function o(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function s(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}const qY=t=>`'${t}' value is already declared in a unique set.`;function ZY(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=vt(t)?t:qY;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}const IS=t=>`There is already registered "${t}" plugin.`,QY=t=>`There is already registered plugin on priority "${t}".`,JY=t=>`The priority "${t}" is not a number.`,i1=KY({errorPriorityExists:QY,errorPriorityNaN:JY}),o1=ZY({errorItemExists:IS}),Hv=Wg({errorIdExists:IS});function xS(){return[...i1.getItems(),...o1.getItems()]}function Qc(t){const e=En(t);return Hv.getItem(e)}function ej(t){return!!Qc(t)}function nt(t,e,n){[t,e,n]=nj(t,e,n),Qc(t)===void 0&&tj(t,e,n)}function tj(t,e,n){const r=En(t);if(Hv.hasItem(r))throw new Error(IS(r));n===void 0?o1.addItem(r):i1.addItem(n,r),Hv.addItem(r,e)}function nj(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:rj,getItem:ij,hasItem:s1,getNames:oj,getValues:ece}=ci("renderers");function Pf(t){if(typeof t=="function")return t;if(!s1(t))throw Error(`No registered renderer found under "${t}" name`);return ij(t)}function cr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),rj(t,e)}const{register:sj,getItem:aj,hasItem:a1,getNames:lj,getValues:tce}=ci("validators");function HS(t){if(typeof t=="function")return t;if(!a1(t))throw Error(`No registered validator found under "${t}" name`);return aj(t)}function oa(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),sj(t,e)}function _h(t,e,n){return e=uj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uj(t){var e=cj(t,"string");return typeof e=="symbol"?e:String(e)}function cj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hj{constructor(e){_h(this,"count",0),_h(this,"startColumn",0),_h(this,"endColumn",0),_h(this,"startPosition",0),this.count=e.totalColumns,this.endColumn=this.count-1}}function Mh(t,e,n){return e=dj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dj(t){var e=fj(t,"string");return typeof e=="symbol"?e:String(e)}function fj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gj{constructor(e){Mh(this,"count",0),Mh(this,"startRow",0),Mh(this,"endRow",0),Mh(this,"startPosition",0),this.count=e.totalRows,this.endRow=this.count-1}}var l1={},mj=XP,pj=LC,wj=Object.keys||function(e){return mj(e,pj)},vj=ki,Cj=BP,Sj=bs,yj=Rs,bj=hg,Rj=wj;l1.f=vj&&!Cj?Object.defineProperties:function(e,n){yj(e);for(var r=bj(n),i=Rj(n),o=i.length,s=0,a;o>s;)Sj.f(e,a=i[s++],r[a]);return e};var Ej=Rs,Tj=l1,Q0=LC,_j=HC,Mj=hI,Aj=IC,Oj=zP,J0=">",eE="<",Dv="prototype",Nv="script",u1=Oj("IE_PROTO"),qm=function(){},c1=function(t){return eE+Nv+J0+t+eE+"/"+Nv+J0},tE=function(t){t.write(c1("")),t.close();var e=t.parentWindow.Object;return t=null,e},Pj=function(){var t=Aj("iframe"),e="java"+Nv+":",n;return t.style.display="none",Mj.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(c1("document.F=Object")),n.close(),n.F},Ah,Xd=function(){try{Ah=new ActiveXObject("htmlfile")}catch{}Xd=typeof document<"u"?document.domain&&Ah?tE(Ah):Pj():tE(Ah);for(var t=Q0.length;t--;)delete Xd[Dv][Q0[t]];return Xd()};_j[u1]=!0;var Ij=Object.create||function(e,n){var r;return e!==null?(qm[Dv]=Ej(e),r=new qm,qm[Dv]=null,r[u1]=e):r=Xd(),n===void 0?r:Tj.f(r,n)},xj=Ul,Hj=Ij,Dj=bs.f,Lv=xj("unscopables"),$v=Array.prototype;$v[Lv]===void 0&&Dj($v,Lv,{configurable:!0,value:Hj(null)});var h1=function(t){$v[Lv][t]=!0},Nj=Es,Lj=gg,$j=Bc,kj=NC,Fj=h1;Nj({target:"Array",proto:!0},{at:function(e){var n=Lj(this),r=$j(n),i=kj(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});Fj("at");const Xo=1,yn=2;function Wj(t,e,n){Vj(t,e),e.set(t,n)}function Vj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lu(t,e,n){return e=Bj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bj(t){var e=Uj(t,"string");return typeof e=="symbol"?e:String(e)}function Uj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Na(t,e){var n=d1(t,e,"get");return Gj(t,n)}function Gj(t,e){return e.get?e.get.call(t):e.value}function zj(t,e,n){var r=d1(t,e,"set");return Yj(t,r,n),n}function d1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Yj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Do=new WeakMap;class Jc{static get DEFAULT_WIDTH(){return 50}constructor(e){lu(this,"count",0),lu(this,"startColumn",null),lu(this,"endColumn",null),lu(this,"startPosition",null),lu(this,"isVisibleInTrimmingContainer",!1),Wj(this,Do,{writable:!0,value:void 0}),zj(this,Do,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=Na(this,Do),s=Math.max(Na(this,Do).scrollOffset,0),a=s>0?o+1:o;let l=0,u=!0;const c=[];let h,d=0,f=0;for(let y=0;y<i;y++)if(h=this._getColumnWidth(y),l<=s&&e!==yn&&(this.startColumn=y,d=h),l>=s&&l+(e===yn?h:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=y,d=h),this.endColumn=y),c.push(l),l+=h,f=h,e!==yn&&(this.endColumn=y),l>=s+o){u=!1;break}const p=r+o-a,v=e===yn?0:f,S=e===yn?d:0;if(p<-1*Na(this,Do).inlineStartOffset||r>c.at(-1)+v||-1*Na(this,Do).scrollOffset-Na(this,Do).viewportWidth>-1*S?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&u)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=c[this.endColumn]+h-c[this.startColumn-1];if((y<=o||e!==yn)&&(this.startColumn-=1),y>o)break}e===Xo&&this.startColumn!==null&&n&&n(this),this.startPosition=c[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(e){let n=Na(this,Do).columnWidthFn(e);return isNaN(n)&&(n=Jc.DEFAULT_WIDTH),n}}function jj(t,e,n){Kj(t,e),e.set(t,n)}function Kj(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uu(t,e,n){return e=Xj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xj(t){var e=qj(t,"string");return typeof e=="symbol"?e:String(e)}function qj(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zm(t,e){var n=f1(t,e,"get");return Zj(t,n)}function Zj(t,e){return e.get?e.get.call(t):e.value}function Qj(t,e,n){var r=f1(t,e,"set");return Jj(t,r,n),n}function f1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Jj(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var cu=new WeakMap;class Vg{static get DEFAULT_HEIGHT(){return 23}constructor(e){uu(this,"count",0),uu(this,"startRow",null),uu(this,"endRow",null),uu(this,"startPosition",null),uu(this,"isVisibleInTrimmingContainer",!1),jj(this,cu,{writable:!0,value:void 0}),Qj(this,cu,e),this.calculate()}calculate(){const{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=Zm(this,cu),a=Math.max(Zm(this,cu).scrollOffset,0),l=Zm(this,cu).horizontalScrollbarHeight||0;let u=0,c=!0;const h=[];let d,f=0,p=0;for(let R=0;R<o;R++)if(d=r(R),isNaN(d)&&(d=Vg.DEFAULT_HEIGHT),u<=a&&e!==yn&&(this.startRow=R,f=d),u>=a&&u+(e===yn?d:0)<=a+s-l&&(this.startRow===null&&(this.startRow=R,f=d),this.endRow=R),h.push(u),u+=d,p=d,e!==yn&&(this.endRow=R),u>=a+s-l){c=!1;break}const v=i+s-l,S=e===yn?f:0,y=e===yn?0:p;if(v<S||i>h.at(-1)+y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&c)for(this.startRow=this.endRow;this.startRow>0;){const R=h[this.endRow]+d-h[this.startRow-1];if((R<=s-l||e!==yn)&&(this.startRow-=1),R>=s-l)break}e===Xo&&this.startRow!==null&&n&&n(this),this.startPosition=h[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function eK(t,e,n){tK(t,e),e.set(t,n)}function tK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nE(t,e,n){return e=nK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nK(t){var e=rK(t,"string");return typeof e=="symbol"?e:String(e)}function rK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function La(t,e){var n=g1(t,e,"get");return iK(t,n)}function iK(t,e){return e.get?e.get.call(t):e.value}function rE(t,e,n){var r=g1(t,e,"set");return oK(t,r,n),n}function g1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function oK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Yi=new WeakMap;class If{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;nE(this,"row",null),nE(this,"col",null),eK(this,Yi,{writable:!0,value:!1}),rE(this,Yi,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return La(this,Yi)}isSouthEastOf(e){return this.row>=e.row&&(La(this,Yi)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(La(this,Yi)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(La(this,Yi)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(La(this,Yi)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof If&&rE(this,Yi,e.isRtl()),this}clone(){return new If(this.row,this.col,La(this,Yi))}toObject(){return{row:this.row,col:this.col}}}const xf=If;function sK(t,e,n){aK(t,e),e.set(t,n)}function aK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qm(t,e,n){return e=lK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lK(t){var e=uK(t,"string");return typeof e=="symbol"?e:String(e)}function uK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sr(t,e){var n=m1(t,e,"get");return cK(t,n)}function cK(t,e){return e.get?e.get.call(t):e.value}function hK(t,e,n){var r=m1(t,e,"set");return dK(t,r,n),n}function m1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function dK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var jn=new WeakMap;class DS{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;Qm(this,"highlight",null),Qm(this,"from",null),Qm(this,"to",null),sK(this,jn,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),hK(this,jn,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),u=Math.max(r.row,s.row),c=Math.max(r.col,s.col),h=this._createCellCoords(a,l),d=this._createCellCoords(u,c);return this.from=h,this.to=d,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Sr(this,jn)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Sr(this,jn)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Sr(this,jn)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Sr(this,jn)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Sr(this,jn)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Sr(this,jn)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Sr(this,jn)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Sr(this,jn)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof xf))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push(Sr(this,jn)?"left":"right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push(Sr(this,jn)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){const n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new DS(this.highlight,this.from,this.to,Sr(this,jn))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new xf(e,n,Sr(this,jn))}}const NS=DS;function di(t,e,n){fK(t,e),e.set(t,n)}function fK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ce(t,e){var n=p1(t,e,"get");return gK(t,n)}function gK(t,e){return e.get?e.get.call(t):e.value}function No(t,e,n){var r=p1(t,e,"set");return mK(t,r,n),n}function p1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function mK(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var yr=new WeakMap,Jm=new WeakMap,on=new WeakMap,$a=new WeakMap,Oh=new WeakMap,Wr=new WeakMap,ep=new WeakMap,hu=new WeakMap,Ps=new WeakMap,fi=new WeakMap;let pK=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;di(this,yr,{writable:!0,value:void 0}),di(this,Jm,{writable:!0,value:void 0}),di(this,on,{writable:!0,value:void 0}),di(this,$a,{writable:!0,value:void 0}),di(this,Oh,{writable:!0,value:void 0}),di(this,Wr,{writable:!0,value:void 0}),di(this,ep,{writable:!0,value:void 0}),di(this,hu,{writable:!0,value:void 0}),di(this,Ps,{writable:!0,value:[null,null]}),di(this,fi,{writable:!0,value:[null,null]}),No(this,yr,r),No(this,Jm,n),No(this,on,o),No(this,$a,s),No(this,Oh,a),No(this,Wr,i),No(this,ep,e),this.registerEvents()}registerEvents(){Ce(this,Wr).addEventListener(Ce(this,on).holder,"contextmenu",r=>this.onContextMenu(r)),Ce(this,Wr).addEventListener(Ce(this,on).TABLE,"mouseover",r=>this.onMouseOver(r)),Ce(this,Wr).addEventListener(Ce(this,on).TABLE,"mouseout",r=>this.onMouseOut(r));const e=()=>{Ce(this,Wr).addEventListener(Ce(this,on).holder,"touchstart",r=>this.onTouchStart(r)),Ce(this,Wr).addEventListener(Ce(this,on).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Ce(this,Wr).addEventListener(Ce(this,on).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ce(this,yr).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ce(this,yr).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Ce(this,Wr).addEventListener(Ce(this,on).holder,"mouseup",r=>this.onMouseUp(r)),Ce(this,Wr).addEventListener(Ce(this,on).holder,"mousedown",r=>this.onMouseDown(r))};go()?e():(bS()&&e(),n())}selectedCellWasTouched(e){const r=this.parentCell(e).coords;if(Ce(this,hu)&&r){const[i,o]=[r.row,Ce(this,hu).from.row],[s,a]=[r.col,Ce(this,hu).from.col];return i===o&&s===a}return!1}parentCell(e){const n={},r=Ce(this,on).TABLE,i=Xu(e,["TD","TH"],r);return i?(n.coords=Ce(this,on).getCoords(i),n.TD=i):Pe(e,"wtBorder")&&Pe(e,"current")?(n.coords=Ce(this,$a).getFocusSelection().cellRange.highlight,n.TD=Ce(this,on).getCell(n.coords)):Pe(e,"wtBorder")&&Pe(e,"area")&&Ce(this,$a).getAreaSelection().cellRange&&(n.coords=Ce(this,$a).getAreaSelection().cellRange.to,n.TD=Ce(this,on).getCell(n.coords)),n}onMouseDown(e){const n=Ce(this,Jm).rootDocument.activeElement,r=yS(Sx,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;const o=this.parentCell(i);Pe(i,"corner")?Ce(this,yr).getSetting("onCellCornerMouseDown",e,i):o.TD&&Ce(this,yr).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Ce(this,fi)[0]=o.TD,clearTimeout(Ce(this,Ps)[0]),Ce(this,Ps)[0]=setTimeout(()=>{Ce(this,fi)[0]=null},1e3))}onContextMenu(e){if(Ce(this,yr).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Ce(this,yr).has("onCellMouseOver"))return;const n=Ce(this,on).TABLE,r=Xu(e.target,["TD","TH"],n),i=Ce(this,Oh)||this;r&&r!==i.lastMouseOver&&us(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Ce(this,on).getCoords(r),r))}onMouseOut(e){if(!Ce(this,yr).has("onCellMouseOut"))return;const n=Ce(this,on).TABLE,r=Xu(e.target,["TD","TH"],n),i=Xu(e.relatedTarget,["TD","TH"],n),o=Ce(this,Oh)||this;r&&r!==i&&us(r,n)&&(this.callListener("onCellMouseOut",e,Ce(this,on).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Ce(this,yr).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Ce(this,fi)[0]&&n.TD===Ce(this,fi)[1]?(Pe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Ce(this,fi)[0]=null,Ce(this,fi)[1]=null):n.TD===Ce(this,fi)[0]&&(Ce(this,fi)[1]=n.TD,clearTimeout(Ce(this,Ps)[1]),Ce(this,Ps)[1]=setTimeout(()=>{Ce(this,fi)[1]=null},500)))}onTouchStart(e){No(this,hu,Ce(this,$a).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=ue(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Ce(this,yr).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];TS()&&(Ux()||Gx())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){const o=Ce(this,yr).getSettingPure(e);o&&o(n,r,i,Ce(this,ep).call(this))}destroy(){clearTimeout(Ce(this,Ps)[0]),clearTimeout(Ce(this,Ps)[1]),Ce(this,Wr).destroy()}};const w1=pK;function tp(t,e,n){return e=wK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wK(t){var e=vK(t,"string");return typeof e=="symbol"?e:String(e)}function vK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CK{constructor(e,n,r){tp(this,"offset",void 0),tp(this,"total",void 0),tp(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const SK=CK;function np(t,e,n){return e=yK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yK(t){var e=bK(t,"string");return typeof e=="symbol"?e:String(e)}function bK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RK{constructor(e,n,r){np(this,"offset",void 0),np(this,"total",void 0),np(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const EK=RK,TK=0,Hf=1,Df=2;function Ph(t,e,n){return e=_K(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _K(t){var e=MK(t,"string");return typeof e=="symbol"?e:String(e)}function MK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iE{constructor(){Ph(this,"currentSize",0),Ph(this,"nextSize",0),Ph(this,"currentOffset",0),Ph(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function rp(t,e,n){return e=AK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AK(t){var e=OK(t,"string");return typeof e=="symbol"?e:String(e)}function OK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PK{constructor(){rp(this,"size",new iE),rp(this,"workingSpace",TK),rp(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof iE}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Hf,e.workingSpace=Df,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=Df,e.workingSpace=Hf,this.sharedSize=e.getViewSize()}}function ka(t,e,n){return e=IK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IK(t){var e=xK(t,"string");return typeof e=="symbol"?e:String(e)}function xK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v1{constructor(e,n,r){ka(this,"rootNode",void 0),ka(this,"nodesPool",void 0),ka(this,"sizeSet",new PK),ka(this,"childNodeType",void 0),ka(this,"visualIndex",0),ka(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:n}=this;let r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(Hf))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize();let o=this.getRenderedChildCount();for(;o<i;){const a=this.nodesPool();!r||r&&n.isPlaceOn(Df)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}const s=r&&n.isPlaceOn(Hf);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){const{rootNode:e,sizeSet:n}=this;let r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(Df)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){const o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class C1 extends v1{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function HK(t,e,n){return e=DK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DK(t){var e=NK(t,"string");return typeof e=="symbol"?e:String(e)}function NK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LK{constructor(e){HK(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function du(t,e,n){return e=$K(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $K(t){var e=kK(t,"string");return typeof e=="symbol"?e:String(e)}function kK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eh{constructor(e,n){du(this,"nodesPool",null),du(this,"nodeType",void 0),du(this,"rootNode",void 0),du(this,"table",null),du(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new LK(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function oE(t,e,n){return e=FK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function FK(t){var e=WK(t,"string");return typeof e=="symbol"?e:String(e)}function WK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VK extends eh{constructor(){super("TH"),oE(this,"orderViews",new WeakMap),oE(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new C1(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=o.obtainOrderView(l);u.appendView(c).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<r;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Ra(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Te(d,[cz(),vz(),hS(h+1),Yl(-1)]),n[h](a,d,h)}u.end()}}}class BK extends eh{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&li(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Te(this.rootNode,[mx()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&Te(s,[Tv(),Cx(n+1)]);for(let a=-1*o;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=s.childNodes[a+o];u.className="",u.removeAttribute("style"),Ra(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Te(u,[hS(a+1+this.table.rowHeadersCount),Yl(-1),hz(),...a>=0?[wz()]:[Tv()]]),r[n](l,u,n)}}}}let sE=!1;class UK extends eh{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!sE&&e>1e3&&(sE=!0,gt(ht`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<n;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){const o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}const r=this.rootNode.firstChild;r&&Z(r,"rowHeader")}}function GK(t,e,n){return e=zK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zK(t){var e=YK(t,"string");return typeof e=="symbol"?e:String(e)}function YK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let aE=!1;class jK extends eh{constructor(e){super("TR",e),GK(this,"orderView",void 0),this.orderView=new v1(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!aE&&e>1e3&&(aE=!0,gt(ht`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Te(this.rootNode,[mx()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;Te(o,[Tv(),Cx(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}}function lE(t,e,n){return e=KK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KK(t){var e=XK(t,"string");return typeof e=="symbol"?e:String(e)}function XK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qK extends eh{constructor(){super("TD"),lE(this,"orderViews",new WeakMap),lE(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new C1(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=r.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<n;d++){c.render();const f=c.getCurrentNode(),p=this.table.renderedColumnToSource(d);if(Pe(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),Ra(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,p,f),this.table.isAriaEnabled()){var o,s;Te(f,[...f.hasAttribute("role")?[]:[uz()],Yl(-1),hS(p+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}c.end()}}}function sn(t,e,n){return e=ZK(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZK(t){var e=QK(t,"string");return typeof e=="symbol"?e:String(e)}function QK(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JK{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sn(this,"rootNode",void 0),sn(this,"rootDocument",void 0),sn(this,"rowHeaders",null),sn(this,"columnHeaders",null),sn(this,"colGroup",null),sn(this,"rows",null),sn(this,"cells",null),sn(this,"rowFilter",null),sn(this,"columnFilter",null),sn(this,"rowUtils",null),sn(this,"columnUtils",null),sn(this,"rowsToRender",0),sn(this,"columnsToRender",0),sn(this,"rowHeaderFunctions",[]),sn(this,"rowHeadersCount",0),sn(this,"columnHeaderFunctions",[]),sn(this,"columnHeadersCount",0),sn(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){const i=n.getRenderedNode(r);if(i.firstChild){const o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}}class e3{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new JK(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new VK,columnHeaders:new BK(n),colGroup:new UK(r),rows:new jK(i),cells:new qK}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function fu(t,e,n){t3(t,e),e.set(t,n)}function t3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ih(t,e,n){return e=n3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n3(t){var e=r3(t,"string");return typeof e=="symbol"?e:String(e)}function r3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pn(t,e){var n=S1(t,e,"get");return i3(t,n)}function i3(t,e){return e.get?e.get.call(t):e.value}function gu(t,e,n){var r=S1(t,e,"set");return o3(t,r,n),n}function S1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function o3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xh=new WeakMap,Fa=new WeakMap,mu=new WeakMap,Hh=new WeakMap,Is=new WeakMap;class LS{static get DEFAULT_WIDTH(){return 50}constructor(e){let{totalColumns:n,stretchMode:r,stretchingColumnWidthFn:i,columnWidthFn:o}=e;Ih(this,"stretchAllRatio",0),Ih(this,"stretchLastWidth",0),Ih(this,"stretchAllColumnsWidth",[]),fu(this,xh,{writable:!0,value:0}),Ih(this,"needVerifyLastColumnWidth",!0),fu(this,Fa,{writable:!0,value:()=>0}),fu(this,mu,{writable:!0,value:s=>s}),fu(this,Hh,{writable:!0,value:s=>s}),fu(this,Is,{writable:!0,value:()=>"none"}),gu(this,Fa,n),gu(this,Is,r),gu(this,mu,i??pn(this,mu)),gu(this,Hh,o??pn(this,Hh))}refreshStretching(e){if(pn(this,Is).call(this)==="none")return;gu(this,xh,e);let n=0;for(let i=0;i<pn(this,Fa).call(this);i++){const o=this._getColumnWidth(i),s=pn(this,mu).call(this,void 0,i);typeof s=="number"?e-=s:n+=o}const r=e-n;if(pn(this,Is).call(this)==="all"&&r>0)this.stretchAllRatio=e/n,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(pn(this,Is).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(pn(this,Fa).call(this)-1),o=r+i;this.stretchLastWidth=o>=0?o:i}}getStretchedColumnWidth(e,n){let r=null;return pn(this,Is).call(this)==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):pn(this,Is).call(this)==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(n*this.stretchAllRatio),o=pn(this,mu).call(this,i,e);o===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(o)?this._getColumnWidth(e):o}if(this.stretchAllColumnsWidth.length===pn(this,Fa).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)r+=this.stretchAllColumnsWidth[i];r!==pn(this,xh)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=pn(this,xh)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===pn(this,Fa).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=pn(this,Hh).call(this,e);return isNaN(n)&&(n=LS.DEFAULT_WIDTH),n}}function Dh(t,e,n){return e=s3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s3(t){var e=a3(t,"string");return typeof e=="symbol"?e:String(e)}function a3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class l3{constructor(e,n){Dh(this,"dataAccessObject",void 0),Dh(this,"wtSettings",void 0),Dh(this,"headerWidths",new Map),Dh(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=n,this.stretching=new LS({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(r,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",r,i),columnWidthFn:r=>this.dataAccessObject.wtTable.getColumnWidth(r)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let n=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,n);return r&&(n=r),n}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:n,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:e.holder,o=i.offsetHeight<i.scrollHeight?nn():0;this.stretching.refreshStretching(n.getViewportWidth()-o)}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const r=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let o=0;o<r;o++){let s=Array.isArray(n)?n[o]:n;s=s??i,this.headerWidths.set(o,s)}}}}function uE(t,e,n){return e=u3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u3(t){var e=c3(t,"string");return typeof e=="symbol"?e:String(e)}function c3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h3{constructor(e,n){uE(this,"dataAccessObject",void 0),uE(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}}function gi(t,e,n){return e=d3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d3(t){var e=f3(t,"string");return typeof e=="symbol"?e:String(e)}function f3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class g3{constructor(e,n,r,i,o){gi(this,"wtSettings",null),gi(this,"domBindings",void 0),gi(this,"TBODY",null),gi(this,"THEAD",null),gi(this,"COLGROUP",null),gi(this,"hasTableHeight",!0),gi(this,"hasTableWidth",!0),gi(this,"isTableVisible",!1),gi(this,"tableOffset",0),gi(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,fS(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new h3(this.dataAccessObject,this.wtSettings),this.columnUtils=new l3(this.dataAccessObject,this.wtSettings),this.tableRenderer=new e3({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Te(r,[Di()]),r}createHider(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Te(r,[Di()]),r}createHolder(e){const n=e.parentNode;let r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Pe(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Te(r.parentNode,[Di()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Te(r,[Di()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,u=n.getSetting("columnHeaders"),c=u.length;let h=!1,d=e;if(this.isMaster&&(this.holderOffset=en(this.holder),d=i.createRenderCalculators(d),l&&!n.getSetting("fixedColumnsStart"))){const p=r.inlineStartOverlay.getScrollPosition(),v=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,v!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(h=r.updateStateOfRendering()),d)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=en(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const p=o>0?this.getFirstRenderedRow():0,v=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new EK(p,o,c),this.columnFilter=new SK(v,s,l);let S=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const y={};this.wtSettings.getSetting("beforeDraw",!0,y),S=y.skipRender!==!0}if(S){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(xi)||this.is(hs))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let y;if(this.isMaster&&(y=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(xi))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const R=ft(this.hider),T=ft(this.TABLE);R!==0&&T!==R&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),y!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(xi)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let f=!1;return this.isMaster&&(f=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(f=r.bottomOverlay.resetFixedPosition()||f),f=r.inlineStartOverlay.resetFixedPosition()||f,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),h&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let o,s,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=aa(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(xi))&&!e.getSetting("externalRowCalculator")){const r=this.getRenderedRowsCount();for(let i=0;i<r;i++){const o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.THEAD.childNodes[n];return r==null?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;const i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a==null?void 0:a.childNodes[n]}getRowHeaders(e){const n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o==null?void 0:o.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=gs(n,["TD","TH"])),n===null)return null;const r=n.parentNode,i=r.parentNode;let o=Rx(r),s=n.cellIndex;return jo(wa,n,this.wtRootElement)||jo(ma,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):jo(hs,n,this.wtRootElement)||jo(xi,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),jo(wa,n,this.wtRootElement)||jo(pa,n,this.wtRootElement)||jo(hs,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=e*this.wtSettings.getSetting("defaultRowHeight"),r=aa(this.TBODY)-1;let i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=aa(l):o=aa(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;const r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ft(this.TABLE)}getHeight(){return xt(this.TABLE)}getTotalWidth(){const e=ft(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=xt(this.hider);return e!==0?e:this.getHeight()}isVisible(){return ps(this.TABLE)}_modifyRowHeaderWidth(e){let n=vt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Xl=g3,m3="stickyRowsBottom",y1={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};Bi(y1,"MIXIN_NAME",m3,{writable:!1,enumerable:!1});const b1=y1,p3="stickyColumnsStart",R1={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Bi(R1,"MIXIN_NAME",p3,{writable:!1,enumerable:!1});const $S=R1;class kS extends Xl{constructor(e,n,r,i){super(e,n,r,i,hs)}}pt(kS,b1);pt(kS,$S);const w3=kS,ma="top",xi="bottom",pa="inline_start",wa="top_inline_start_corner",hs="bottom_inline_start_corner",v3=[ma,xi,pa,wa,hs],C3=new Map([[ma,`ht_clone_${ma}`],[xi,`ht_clone_${xi}`],[pa,`ht_clone_${pa} ht_clone_left`],[wa,`ht_clone_${wa} ht_clone_top_left_corner`],[hs,`ht_clone_${hs} ht_clone_bottom_left_corner`]]);function ip(t,e,n){return e=S3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S3(t){var e=y3(t,"string");return typeof e=="symbol"?e:String(e)}function y3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b3{constructor(e){ip(this,"dataAccessObject",void 0),ip(this,"lastScrolledColumnPos",-1),ip(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){const s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){const{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:u,inlineStartOverlay:c}=this.dataAccessObject;if(l&&e<u)return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?h=c.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(h=c.scrollTo(e,l?e>a:n)),h&&(this.lastScrolledColumnPos=e),h}scrollViewportVertically(e,n,r){const{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:u,fixedRowsTop:c,topOverlay:h}=this.dataAccessObject;if(l&&(e<c||e>o-u-1))return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?d=h.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(d=h.scrollTo(e,l?e>a:r)),d&&(this.lastScrolledRowPos=e),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){const{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject;let s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){const a=en(n.wtRootElement),l=Ig(o,o);if(a.top>l){const u=aa(o);let c=r.getColumnHeaderHeight();for(let h=1;h<=i;h++)if(c+=e.sumCellSizes(h-1,h),a.top+c-l>=u){s=h-2;break}}}return s}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject;let a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){const l=e.getSetting("rtlMode");let u=null;if(l){const h=r.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(h.right-f)}else u=en(r.wtRootElement).left;const c=Math.abs(mS(s,s));if(u>c){const h=pS(s);let d=i.getRowHeaderWidth();for(let f=1;f<=o;f++)if(d+=n.sumCellSizes(f-1,f),u+d-c>=h){a=f-2;break}}}return a}}const R3=b3;function Vr(t,e,n){return e=E3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E3(t){var e=T3(t,"string");return typeof e=="symbol"?e:String(e)}function T3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class FS{get eventManager(){return new Dr(this)}constructor(e,n){Vr(this,"wtTable",void 0),Vr(this,"wtScroll",void 0),Vr(this,"wtViewport",void 0),Vr(this,"wtOverlays",void 0),Vr(this,"selectionManager",void 0),Vr(this,"wtEvent",void 0),Vr(this,"guid",`wt_${aS()}`),Vr(this,"drawInterrupted",!1),Vr(this,"drawn",!1),Vr(this,"domBindings",void 0),Vr(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new R3(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){ms(r,e[n])}])}}createCellCoords(e,n){return new xf(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new NS(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function cE(t,e,n){return e=_3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _3(t){var e=M3(t,"string");return typeof e=="symbol"?e:String(e)}function M3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class A3 extends FS{constructor(e,n,r){super(e,n),cE(this,"cloneSource",void 0),cE(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new w1(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function O3(t,e,n){return e=P3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P3(t){var e=I3(t,"string");return typeof e=="symbol"?e:String(e)}function I3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class th{constructor(e,n,r,i,o){O3(this,"wtSettings",null),Bi(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;const{TABLE:s,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=ga(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=ga(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Ac(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){gt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(s,o,c,u):h=this.getRelativeCellPositionWithinHolder(s,a,o,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+nn())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(r||(a=s.horizontal-o.start),n){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(v3.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${C3.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&Te(o,[Di()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===ma||u==="vertical"&&this.type===pa?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Ac(e.TABLE),new A3(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;E([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class x3 extends th{constructor(e,n,r,i,o,s){super(e,n,hs,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new w3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Xc(n),this.repositionOverlay();let r=xt(this.clone.wtTable.TABLE);const i=ft(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=nn(r)),i.style.bottom=`${o}px`}}const H3="calculatedColumns",E1={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};Bi(E1,"MIXIN_NAME",H3,{writable:!1,enumerable:!1});const WS=E1;class VS extends Xl{constructor(e,n,r,i){super(e,n,r,i,xi)}}pt(VS,b1);pt(VS,WS);const D3=VS;function N3(t,e,n){return e=L3(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L3(t){var e=$3(t,"string");return typeof e=="symbol"?e:String(e)}function $3(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k3 extends th{constructor(e,n,r,i){super(e,n,xi,r,i),N3(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new D3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=nn(r)),i.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(Pg(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight");let s=e,a=0;for(;s<n;){const l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=nn(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=o),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=xt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;n&&o.offsetHeight!==o.clientHeight&&(s=nn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ig(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders");let o=!1;if((r||n===0)&&i.length>0){const s=this.wot.wtTable.holder.parentNode,a=Pe(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Z(s,"innerBorderBottom"),o=!a):(Le(s,"innerBorderBottom"),o=a)}return o}}const F3="calculatedRows",T1={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Bi(T1,"MIXIN_NAME",F3,{writable:!1,enumerable:!1});const _1=T1;class BS extends Xl{constructor(e,n,r,i){super(e,n,r,i,pa)}}pt(BS,_1);pt(BS,$S);const W3=BS,V3="localHooks",M1={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)_f(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};Bi(M1,"MIXIN_NAME",V3,{writable:!1,enumerable:!1});const ar=M1;let A1=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};pt(A1,ar);const B3=A1,O1="active-header",US="header",GS="area",zS="focus",U3="fill",G3="row",z3="column",Y3="custom-selection",YS=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var j3=h1;j3("flat");function K3(t,e){P1(t,e),e.add(t)}function hE(t,e,n){P1(t,e),e.set(t,n)}function P1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function op(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function zt(t,e){var n=I1(t,e,"get");return X3(t,n)}function X3(t,e){return e.get?e.get.call(t):e.value}function dE(t,e,n){var r=I1(t,e,"set");return q3(t,r,n),n}function I1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function q3(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Br=new WeakMap,qn=new WeakMap,Nh=new WeakSet;class Z3{constructor(){K3(this,Nh),hE(this,Br,{writable:!0,value:void 0}),hE(this,qn,{writable:!0,value:void 0})}setActiveOverlay(e){return dE(this,qn,e),this}setActiveSelection(e){return dE(this,Br,e),this}scan(){const e=zt(this,Br).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){const[n,r,i,o]=zt(this,Br).getCorners(),{wtTable:s}=zt(this,qn),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount();let u=0;for(let c=-s.getRowHeadersCount();c<a;c++){const h=s.columnFilter.renderedToSource(c);if(!(h<r||h>o)){for(let d=-l;d<0;d++){if(d<n||d>i)continue;const f=d+l;let p=s.getColumnHeader(h,f);const v=zt(this,qn).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:zt(this,Br).settings.selectionType,columnCursor:u,selectionWidth:o-r+1});v!==null&&(v!==h&&(p=s.getColumnHeader(v,f)),e(p))}u+=1}}}scanRowsInHeadersRange(e){const[n,r,i,o]=zt(this,Br).getCorners(),{wtTable:s}=zt(this,qn),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount();let u=0;for(let c=-s.getColumnHeadersCount();c<a;c++){const h=s.rowFilter.renderedToSource(c);if(!(h<n||h>i)){for(let d=-l;d<0;d++){if(d<r||d>o)continue;const f=d+l;let p=s.getRowHeader(h,f);const v=zt(this,qn).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:zt(this,Br).settings.selectionType,rowCursor:u,selectionHeight:i-n+1});v!==null&&(v!==h&&(p=s.getRowHeader(v,f)),e(p))}u+=1}}}scanCellsRange(e){const[n,r,i,o]=zt(this,Br).getCorners(),{wtTable:s}=zt(this,qn);op(this,Nh,sp).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){const u=s.getCell(zt(this,qn).createCellCoords(a,l)),c=zt(this,qn).getSetting("onAfterDrawSelection",a,l,zt(this,Br).settings.layerLevel);typeof c=="string"&&Z(u,c),e(u)}})}scanRowsInCellsRange(e){const[n,,r]=zt(this,Br).getCorners(),{wtTable:i}=zt(this,qn);op(this,Nh,sp).call(this,(o,s)=>{if(o>=n&&o<=r){const a=i.getCell(zt(this,qn).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){const[,n,,r]=zt(this,Br).getCorners(),{wtTable:i}=zt(this,qn);op(this,Nh,sp).call(this,(o,s)=>{if(s>=n&&s<=r){const a=i.getCell(zt(this,qn).createCellCoords(o,s));e(a)}})}}function sp(t){const{wtTable:e}=zt(this,qn),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){const o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}class Q3{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=YS,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){const i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),kr(e);const r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const r=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=r[a],u=n.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),go()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Ge(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Ge(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),p=parseInt(u.width,10),v=parseInt(c.width,10),S=this.wot.wtTable.getWidth(),y=this.wot.wtTable.getHeight();u.top=`${parseInt(r-p-1,10)}px`,u[l]=`${parseInt(i-p-1,10)}px`,c.top=`${parseInt(r-v/4*3,10)}px`,c[l]=`${parseInt(i-v/4*3,10)}px`;const R=Math.min(parseInt(i+o,10),S-p-f*2),T=Math.min(parseInt(i+o-v/4,10),S-v-f*2);h[l]=`${R}px`,d[l]=`${T}px`;const A=Math.min(parseInt(r+s,10),y-p-f*2),M=Math.min(parseInt(r+s-v/4,10),y-v-f*2);h.top=`${A}px`,d.top=`${M}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:n,rootDocument:r,rootWindow:i}=this.wot;let o,s,a,l,u,c;const h=n.getRenderedRowsCount();for(let we=0;we<h;we+=1){const g=n.rowFilter.renderedToSource(we);if(g>=e[0]&&g<=e[2]){o=g,u=e[0];break}}for(let we=h-1;we>=0;we-=1){const g=n.rowFilter.renderedToSource(we);if(g>=e[0]&&g<=e[2]){s=g;break}}const d=n.getRenderedColumnsCount();for(let we=0;we<d;we+=1){const g=n.columnFilter.renderedToSource(we);if(g>=e[1]&&g<=e[3]){a=g,c=e[1];break}}for(let we=d-1;we>=0;we-=1){const g=n.columnFilter.renderedToSource(we);if(g>=e[1]&&g<=e[3]){l=g;break}}if(o===void 0||a===void 0){this.disappear();return}let f=n.getCell(this.wot.createCellCoords(o,a));const p=o!==s||a!==l,v=p?n.getCell(this.wot.createCellCoords(s,l)):f,S=en(f),y=p?en(v):S,R=en(n.TABLE),T=ft(n.TABLE),A=S.top,M=S.left,L=this.wot.wtSettings.getSetting("rtlMode");let B=0,K=0;if(L){const we=ft(f),g=i.innerWidth-R.left-T;K=M+we-y.left,B=i.innerWidth-M-we-g-1}else K=y.left+ft(v)-M,B=M-R.left-1;if(this.isEntireColumnSelected(o,s)){const we=this.getDimensionsFromHeader("columns",a,l,u,R);let g=null;we&&([g,B,K]=we),g&&(f=g)}let U=A-R.top-1,G=y.top+xt(v)-A;if(this.isEntireRowSelected(a,l)){const we=this.getDimensionsFromHeader("rows",o,s,c,R);let g=null;we&&([g,U,G]=we),g&&(f=g)}const Q=bo(f,i);parseInt(Q.borderTopWidth,10)>0&&(U+=1,G=G>0?G-1:0),parseInt(Q[L?"borderRightWidth":"borderLeftWidth"],10)>0&&(B+=1,K=K>0?K-1:0);const re=L?"right":"left";this.topStyle.top=`${U}px`,this.topStyle[re]=`${B}px`,this.topStyle.width=`${K}px`,this.topStyle.display="block",this.startStyle.top=`${U}px`,this.startStyle[re]=`${B}px`,this.startStyle.height=`${G}px`,this.startStyle.display="block";const ne=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${U+G-ne}px`,this.bottomStyle[re]=`${B}px`,this.bottomStyle.width=`${K}px`,this.bottomStyle.display="block",this.endStyle.top=`${U}px`,this.endStyle[re]=`${B+K-ne}px`,this.endStyle.height=`${G+1}px`,this.endStyle.display="block";let ce=this.settings.border.cornerVisible;ce=typeof ce=="function"?ce(this.settings.layerLevel):ce;const be=this.wot.getSetting("onModifyGetCellCoords",s,l);let[qe,Fe]=[s,l];if(be&&Array.isArray(be)&&([,,qe,Fe]=be),go()||!ce||this.isPartRange(qe,Fe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${U+G+this.cornerCenterPointOffset-1}px`,this.cornerStyle[re]=`${B+K+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let we=ga(n.TABLE);const g=we===i;g&&(we=r.documentElement);const m=parseInt(this.cornerDefaultStyle.width,10)/2,w=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const P=g?v.getBoundingClientRect().left:v.offsetLeft;let I=!1,N=0;L?(N=P-parseInt(this.cornerDefaultStyle.width,10)/2,I=N<0):(N=P+ft(v)+parseInt(this.cornerDefaultStyle.width,10)/2,I=N>=pS(we)),I&&(this.cornerStyle[re]=`${Math.floor(B+K+this.cornerCenterPointOffset-m)}px`,this.cornerStyle[L?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(g?v.getBoundingClientRect().top:v.offsetTop)+xt(v)+parseInt(this.cornerDefaultStyle.height,10)/2>=aa(we)&&(this.cornerStyle.top=`${Math.floor(U+G+this.cornerCenterPointOffset-w)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}go()&&this.updateMultipleSelectionHandlesPosition(s,l,U,B,K,G)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,p=null,v=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},u=function(){return xt(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},u=function(){return ft(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const S=this.wot.getSetting("columnHeaders").length;if(p=l(n,S-i),v=l(r,S-i),!p||!v)return!1;const y=en(p),R=en(v);return p&&v&&(h=y[f]-o[f]-1,d=R[f]+u(v)-y[f]),[p,h,d]}return!1}changeBorderStyle(e,n){const r=this[e].style,i=n[e];!i||i.hide?Z(this[e],"hidden"):(Pe(this[e],"hidden")&&Le(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?Z(this[e],"hidden"):Le(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",go()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const fE=Q3;function J3(t,e){x1(t,e),e.add(t)}function Wa(t,e,n){x1(t,e),e.set(t,n)}function x1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eX(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Xe(t,e){var n=H1(t,e,"get");return tX(t,n)}function tX(t,e){return e.get?e.get.call(t):e.value}function gE(t,e,n){var r=H1(t,e,"set");return nX(t,r,n),n}function H1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Sn=new WeakMap,tr=new WeakMap,ap=new WeakMap,qu=new WeakMap,lp=new WeakMap,xs=new WeakMap,mE=new WeakSet;class rX{constructor(e){J3(this,mE),Wa(this,Sn,{writable:!0,value:void 0}),Wa(this,tr,{writable:!0,value:void 0}),Wa(this,ap,{writable:!0,value:new Z3}),Wa(this,qu,{writable:!0,value:new WeakMap}),Wa(this,lp,{writable:!0,value:new WeakSet}),Wa(this,xs,{writable:!0,value:new Map}),gE(this,tr,e)}setActiveOverlay(e){return gE(this,Sn,e),Xe(this,ap).setActiveOverlay(Xe(this,Sn)),Xe(this,qu).has(Xe(this,Sn))||Xe(this,qu).set(Xe(this,Sn),new Set),this}getFocusSelection(){return Xe(this,tr)!==null?Xe(this,tr).getFocus():null}getAreaSelection(){return Xe(this,tr)!==null?Xe(this,tr).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Xe(this,xs).has(e)){const r=Xe(this,xs).get(e);if(r.has(Xe(this,Sn)))return r.get(Xe(this,Sn));const i=new fE(Xe(this,Sn),e.settings);return r.set(Xe(this,Sn),i),i}const n=new fE(Xe(this,Sn),e.settings);return Xe(this,xs).set(e,new Map([[Xe(this,Sn),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=Xe(this,xs).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){Xe(this,xs).get(e).forEach(n=>n.destroy()),Xe(this,xs).delete(e)}render(e){if(Xe(this,tr)===null)return;e&&eX(this,mE,iX).call(this);const n=Array.from(Xe(this,tr)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){const s=n[o],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=s.settings;Xe(this,lp).has(s)||(Xe(this,lp).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const h=this.getBorderInstance(s);if(s.isEmpty()){h==null||h.disappear();continue}a&&Xe(this,ap).setActiveSelection(s).scan().forEach(p=>{if(r.has(p)){const v=r.get(p);v.has(a)&&u===!0?v.set(a,v.get(a)+1):v.set(a,1)}else r.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});const d=s.getCorners();Xe(this,Sn).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}r.forEach((o,s)=>{var a;const l=Array.from(o).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>Xe(this,qu).get(Xe(this,Sn)).add(u)),Z(s,l),s.nodeName==="TD"&&Array.isArray((a=Xe(this,tr).options)===null||a===void 0?void 0:a.cellAttributes)&&Te(s,Xe(this,tr).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{Te(o,[...i.get(o)])})}}function iX(){const t=Xe(this,qu).get(Xe(this,Sn)),e=Xe(this,Sn).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;const o=Xe(this,Sn).wtTable.TABLE.querySelectorAll(`.${n}`);let s=[];Array.isArray((r=Xe(this,tr).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=Xe(this,tr).options.cellAttributes.map(a=>a[0])),Array.isArray((i=Xe(this,tr).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...Xe(this,tr).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)Le(o[a],n),Ra(o[a],s)}),t.clear()}class oX extends th{constructor(e,n,r,i){super(e,n,pa,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new W3(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),xg(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Xc(r));const s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,gS(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultColumnWidth");let i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=nn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const l=ft(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(YS.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(n){const a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=nn(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(mS(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){const n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?Le(n,"emptyRows"):Z(n,"emptyRows");let s=!1;if(i&&!r.length)Z(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){const a=Pe(n,"innerBorderInlineStart");e?(Z(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(Le(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const sX="stickyRowsTop",D1={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};Bi(D1,"MIXIN_NAME",sX,{writable:!1,enumerable:!1});const N1=D1;class jS extends Xl{constructor(e,n,r,i){super(e,n,r,i,wa)}}pt(jS,N1);pt(jS,$S);const aX=jS;function pE(t,e,n){return e=lX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lX(t){var e=uX(t,"string");return typeof e=="symbol"?e:String(e)}function uX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cX extends th{constructor(e,n,r,i,o,s){super(e,n,wa,r,i),pE(this,"topOverlay",void 0),pE(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new aX(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();xg(e,`${i}px`,`${o}px`)}else Xc(e);let n=xt(this.clone.wtTable.TABLE);const r=ft(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}}class KS extends Xl{constructor(e,n,r,i){super(e,n,r,i,ma)}}pt(KS,N1);pt(KS,WS);const hX=KS;function dX(t,e,n){return e=fX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fX(t){var e=gX(t,"string");return typeof e=="symbol"?e:String(e)}function gX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mX extends th{constructor(e,n,r,i){super(e,n,ma,r,i),dX(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new hX(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;o=u===c,i=this.getOverlayOffset(),xg(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Xc(e);const s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){const n=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(Pg(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const r=this.wtSettings.getSetting("defaultRowHeight");let i=e,o=0;for(;i<n;){const s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=nn(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=xt(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(YS.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder;let a=this.getTableParentOffset(),l=0;if(n){const u=this.wot.wtTable.getRowHeight(e),c=this.wot.wtViewport.getViewportHeight();u>c&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=nn(this.domBindings.rootDocument)),n){const u=i.getSetting("fixedRowsBottom"),c=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(c-u,c),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Ig(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?Le(r,"emptyColumns"):Z(r,"emptyColumns");let o=!1;if(!n){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){const u=Pe(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(Z(r,"innerBorderTop"),o=!u):(Le(r,"innerBorderTop"),o=u)}}return o}}function ji(t,e,n){return e=pX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pX(t){var e=wX(t,"string");return typeof e=="symbol"?e:String(e)}function wX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vX{constructor(e,n,r,i,o,s){ji(this,"wot",null),ji(this,"topOverlay",null),ji(this,"bottomOverlay",null),ji(this,"inlineStartOverlay",null),ji(this,"topInlineStartCornerOverlay",null),ji(this,"bottomInlineStartCornerOverlay",null),ji(this,"browserLineHeight",void 0),ji(this,"wtSettings",null),ji(this,"resizeObserver",new ResizeObserver(c=>{$g(()=>{!Array.isArray(c)||!c.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=nn(a);const u=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Ac(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new mX(...e),this.bottomOverlay=new k3(...e),this.inlineStartOverlay=new oX(...e),this.topInlineStartCornerOverlay=new cX(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new x3(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!RS())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let c;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){const{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;const u=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Kl(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);const i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Ac(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:c}=r.wtRootElement,{scrollHeight:h,scrollWidth:d}=r.holder;this.hasScrollbarRight=u<h,this.hasScrollbarBottom=c<d,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>c?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return E(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];E(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}}const CX=vX;function wE(t,e,n){return e=SX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SX(t){var e=yX(t,"string");return typeof e=="symbol"?e:String(e)}function yX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bX{constructor(e){wE(this,"settings",{}),wE(this,"defaults",Object.freeze(this.getDefaults())),Ge(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{const i=this.getSetting("data",e,n);ms(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Ge(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class XS extends Xl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){const e=ga(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const r=e.parentElement,i=$l(e,"height",n),o=$l(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?r.insertBefore(d,e.nextElementSibling):r.appendChild(d);const f=parseInt(bo(d,n).height,10);r.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),s.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=ps(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<o;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);n.hasOversizedColumnHeadersMarked[r]=!0}}}pt(XS,_1);pt(XS,WS);const RX=XS;class EX{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=xt(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-o:u.left,h=o-c;let d,f;if(a)return ft(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,o):d=Math.min(this.getContainerFillWidth(),h,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>d)return n.documentElement.clientWidth;if(i!==r&&(f=$l(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,i.clientWidth);const p=e.getSetting("stretchH");return p==="none"||!p?Math.max(d,ft(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);const r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return en(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=xt(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=ft(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xo;const{wtSettings:n,wtTable:r}=this;if(n.getSetting("renderAllRows")&&e===Xo)return new gj({totalRows:n.getSetting("totalRows")});let i=this.getViewportHeight(),o,s;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),u=n.getSetting("fixedRowsBottom"),c=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=nn(this.domBindings.rootDocument),new Vg({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:h=>r.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xo;const{wtSettings:n,wtTable:r}=this;if(n.getSetting("renderAllColumns")&&e===Xo)return new hj({totalColumns:n.getSetting("totalColumns")});let i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=n.getSetting("fixedColumnsStart");if(s&&o>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=nn(this.domBindings.rootDocument)),new Jc({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this;if(e&&!n.getSetting("renderAllRows")){const r=this.createRowsCalculator(yn);e=this.areAllProposedVisibleRowsAlreadyRendered(r)}if(e&&!n.getSetting("renderAllColumns")){const r=this.createColumnsCalculator(yn);e=this.areAllProposedVisibleColumnsAlreadyRendered(r)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(Xo),this.columnsRenderCalculator=this.createColumnsCalculator(Xo)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(yn),this.columnsVisibleCalculator=this.createColumnsCalculator(yn)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;const{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Ge(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}}const TX=EX;class _X extends FS{constructor(e,n){super(e,new bX(n));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new RX(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new TX(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new rX(this.wtSettings.getSetting("selections")),this.wtEvent=new w1(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new CX(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Ge(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),Le(this.wtTable.wtRootElement.parentNode,n),Z(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class qS{constructor(e){e instanceof FS?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const r=new qS(n);return()=>r},this._wot=new _X(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function vE(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t;const l=o.isSelected()?o.getSelectedRange().current():null,u=o.isSelectedByCorner(),c=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!o.inInSelection(i),d=n||r&&h;i.row<0&&i.col>=0&&!s.column?d&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?d&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?d&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function MX(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;const s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),u=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(u-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}const AX=new Map([["mousedown",vE],["mouseover",MX],["touchstart",vE]]);function CE(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;AX.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:kg(t)||t.type==="touchstart",isRightClick:ws(t)})}const L1=new WeakMap,ZS=Symbol("rootInstance");function OX(t){L1.set(t,!0)}function PX(t){return t===ZS}function qd(t){return L1.has(t)}function SE(t,e){$1(t,e),e.add(t)}function Hs(t,e,n){$1(t,e),e.set(t,n)}function $1(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lo(t,e,n){return e=IX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IX(t){var e=xX(t,"string");return typeof e=="symbol"?e:String(e)}function xX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kv(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function an(t,e){var n=k1(t,e,"get");return HX(t,n)}function HX(t,e){return e.get?e.get.call(t):e.value}function br(t,e,n){var r=k1(t,e,"set");return DX(t,r,n),n}function k1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function DX(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var up=new WeakMap,Lh=new WeakMap,$h=new WeakMap,Ki=new WeakMap,Ur=new WeakMap,cp=new WeakMap,hp=new WeakMap,Fv=new WeakSet,yE=new WeakSet;class NX{constructor(e){SE(this,yE),SE(this,Fv),Lo(this,"hot",void 0),Lo(this,"eventManager",void 0),Lo(this,"settings",void 0),Lo(this,"THEAD",void 0),Lo(this,"TBODY",void 0),Lo(this,"_wt",void 0),Lo(this,"activeWt",void 0),Hs(this,up,{writable:!0,value:0}),Hs(this,Lh,{writable:!0,value:0}),Lo(this,"postponedAdjustElementsSize",!1),Hs(this,$h,{writable:!0,value:!1}),Hs(this,Ki,{writable:!0,value:void 0}),Hs(this,Ur,{writable:!0,value:void 0}),Hs(this,cp,{writable:!0,value:0}),Hs(this,hp,{writable:!0,value:0}),this.hot=e,this.eventManager=new Dr(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){const r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Z(e,"handsontable"),br(this,Ur,n.createElement("TABLE")),Z(an(this,Ur),"htCore"),this.hot.getSettings().tableClassName&&Z(an(this,Ur),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Te(an(this,Ur),[Di()]),Te(e,[lz(),vx(-1),Og(this.hot.countCols()),yz()])),this.THEAD=n.createElement("THEAD"),an(this,Ur).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),an(this,Ur).appendChild(this.TBODY),this.hot.table=an(this,Ur),this.hot.container.insertBefore(an(this,Ur),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(br(this,$h,!0),!this.isTextSelectionAllowed(o.target)){const{rootWindow:s}=this.hot;_v(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{br(this,$h,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{an(this,$h)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&_v(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&kg(o)&&r.finish(),br(this,Ki,!1);const s=Hg(n.activeElement);sc(n.activeElement)&&!s||(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!ws(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&ws(o)&&(r.finish(),br(this,Ki,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),br(this,Ki,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{const s=o.target,a=o.x||o.clientX,l=o.y||o.clientY;let u=o.target;if(an(this,Ki)||!e||!this.hot.view)return;const{holder:c}=this.hot.view._wt.wtTable;if(u===c){const d=nn(n);if(n.elementFromPoint(a+d,l)!==c||n.elementFromPoint(a,l+d)!==c)return}else for(;u!==i;){if(u===null){if(o.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(an(this,Ur),"selectstart",o=>{this.settings.fragmentSelection||sc(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){const r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;const o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:an(this,Ur),isDataViewInstance:()=>qd(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),br(this,Lh,o.length),this.hot.getSettings().ariaTags&&kv(this,Fv,F1).call(this)===this.hot.countCols()&&kv(this,yE,LX).call(this,an(this,Lh)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{const l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),br(this,up,o.length),o},columnWidth:o=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(o,s),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),p=this.hot.colToProp(d);let v=this.hot.getDataAtRowProp(h,p);this.hot.hasHook("beforeValueRender")&&(v=this.hot.runHooks("beforeValueRender",v,f)),this.hot.runHooks("beforeRenderer",a,l,u,p,v,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,p,v,f),this.hot.runHooks("afterRenderer",a,l,u,p,v,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&ps(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,br(this,Ki,!0),this.hot.runHooks("beforeOnCellMouseDown",o,u,a,c),!Qo(o)&&(CE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",o,u,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,br(this,Ki,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,u,a),!Qo(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,u,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,u,a),!Qo(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,u,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,u,a,c),!Qo(o)&&(an(this,Ki)&&CE(o,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",o,u,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,u,a),!(Qo(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{const s=this.hot.rowIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{const s=this.hot.columnIndexMapper,a=o<0;let l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{const l=this.hot.columnIndexMapper,u=o<0;let c=o;u||(c=l.getVisualFromRenderableIndex(o));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,s,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(o,s,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(o,s),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(o,s)=>{const[a,l,u,c]=o,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=s>=0?u.getVisualFromRenderableIndex(s):s,h=o>=0?l.getVisualFromRenderableIndex(o):o,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[f,p,v,S]=d;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,p>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(p,1)):p,v>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(v,-1)):v,S>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(S,-1)):S]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),l=o.startRow,u=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(u+s,a-1);else if(s==="auto"){const c=Math.ceil(u/a*12);o.startRow=Math.max(l-c,0),o.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),l=o.startColumn,u=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(u+s,a-1)),s==="auto"){const c=Math.ceil(u/a*6);o.startColumn=Math.max(l-c,0),o.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new qS(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(sc(e))return!0;const n=us(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return an(this,Ki)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const r=n.firstChild;if(!Pe(r,"relative")){li(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){const o=n.firstChild;Pe(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(li(n),this.appendColHeader(e,n,r,i))}else{const{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Te(s,...Di()),Te(a,...Di())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Pe(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):Pe(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?Ea(e,r(n,i)):(ms(e,String.fromCharCode(160)),Z(e,"cornerHeader"))}maximumVisibleElementWidth(e){const r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){const r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){br(this,cp,e),br(this,hp,n)}getLastSize(){return{width:an(this,cp),height:an(this,hp)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return an(this,up)}getRowHeadersCount(){return an(this,Lh)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function F1(){return parseInt(this.hot.rootElement.getAttribute(Og()[0]),10)}function LX(t){const e=kv(this,Fv,F1).call(this)+t;Te(this.hot.rootElement,...Og(e))}const $X=NX,W1="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Wv=W1.length;function Bg(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%Wv,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/Wv,10);return n}function kX(t){let e=0;if(t)for(let n=0,r=t.length-1;n<t.length;n+=1,r-=1)e+=Wv**r*(W1.indexOf(t[n])+1);return e-=1,e}function FX(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o=[];for(i=0;i<e;i++)o.push(Bg(i)+(r+1));n.push(o)}return n}function WX(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let r,i;for(r=0;r<t;r++){const o={};for(i=0;i<e;i++)o[`prop${i}`]=Bg(i)+(r+1);n.push(o)}return n}function VX(t,e){const n=[];let r;for(let i=0;i<t;i++){r=[];for(let o=0;o<e;o++)r.push("");n.push(r)}return n}function QS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function JS(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Ve(t[0])&&(e=Lg(t[0]))),e}function V1(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function B1(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const BX=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:JS,createEmptySpreadsheetData:VX,createSpreadsheetData:FX,createSpreadsheetObjectData:WX,dataRowToChangesArray:QS,isArrayOfArrays:V1,isArrayOfObjects:B1,spreadsheetColumnIndex:kX,spreadsheetColumnLabel:Bg},Symbol.toStringTag,{value:"Module"}));function pu(t,e,n){return e=UX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UX(t){var e=GX(t,"string");return typeof e=="symbol"?e:String(e)}function GX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];pu(this,"hot",void 0),pu(this,"data",void 0),pu(this,"dataType","array"),pu(this,"colToProp",()=>{}),pu(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return E(this.data,(r,i)=>{const o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&r===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):pe(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Ve(s)||vt(s))if(i?a=[]:a={},!o||i){const u=this.countFirstRowKeys()-1;pe(0,u,c=>{const h=this.colToProp(c);if(c>=(n||0)&&c<=(r||u)&&!Number.isInteger(h)){const d=this.getAtPhysicalCell(e,h,s);i?a.push(d):Yd(a,h,d)}})}else Ge(s,(l,u)=>{Yd(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=ri(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:Yd(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=kx(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){const o=ri(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const u=[];return pe(o,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,r):this.getAtRow(c,s,l,r))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return JS(this.data)}destroy(){this.data=null,this.hot=null}}const YX=zX;function bE(t,e,n){return e=jX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jX(t){var e=KX(t,"string");return typeof e=="symbol"?e:String(e)}function KX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ta{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;bE(this,"indexedValues",[]),bE(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,vt(this.initValueOrFn)?pe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):pe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}pt(Ta,ar);function ey(t,e,n,r){const i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>vt(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function ty(t,e){return vr(t,(n,r)=>e.includes(r)===!1)}class Ts extends Ta{insert(e,n){this.indexedValues=ey(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=ty(this.indexedValues,e),super.remove(e)}}class Ug extends Ts{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Gt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}function ny(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Ic(t,e){return vr(t,n=>e.includes(n)===!1)}function ry(t,e){return Ue(t,n=>n-e.filter(r=>r<n).length)}function iy(t,e){const n=e[0],r=e.length;return Ue(t,i=>i>=n?i+r:i)}function XX(t,e,n){return e=qX(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qX(t){var e=ZX(t,"string");return typeof e=="symbol"?e:String(e)}function ZX(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gg extends Ta{constructor(){super(...arguments),XX(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Ic(this.orderOfIndexes,[e]),vt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=ey(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=iy(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=ty(this.indexedValues,e),this.orderOfIndexes=Ic(this.orderOfIndexes,e),this.orderOfIndexes=ry(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class nh extends Ts{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Gt(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}}const RE=new Map([["indexesSequence",{getListWithInsertedItems:ny,getListWithRemovedItems:Ic}],["physicallyIndexed",{getListWithInsertedItems:ey,getListWithRemovedItems:ty}]]),U1=t=>{if(RE.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return RE.get(t)};class G1 extends Ta{constructor(){super(e=>e)}insert(e,n){const r=iy(this.indexedValues,n);this.indexedValues=ny(r,e,n),super.insert(e,n)}remove(e){const n=Ic(this.indexedValues,e);this.indexedValues=ry(n,e),super.remove(e)}}const EE=new Map([["hiding",Ug],["index",Ta],["linkedPhysicalIndexToValue",Gg],["physicalIndexToValue",Ts],["trimming",nh]]);function QX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!EE.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(EE.get(t))(e)}function JX(t,e,n){return e=e4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e4(t){var e=t4(t,"string");return typeof e=="symbol"?e:String(e)}function t4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Vv=0;class oy{constructor(){JX(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),Vv+=1)}unregister(e){const n=this.collection.get(e);ue(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),Vv-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Ct(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}pt(oy,ar);function n4(){return Vv}function dp(t,e,n){return e=r4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r4(t){var e=i4(t,"string");return typeof e=="symbol"?e:String(e)}function i4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TE extends oy{constructor(e,n){super(),dp(this,"mergedValuesCache",[]),dp(this,"aggregationFunction",void 0),dp(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Ue(this.get(),o=>o.getValues()),r=[],i=ue(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return Ue(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){const r=this.getMergedValues(n)[e];return ue(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function o4(t,e,n){s4(t,e),e.set(t,n)}function s4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function a4(t,e,n){var r=z1(t,e,"set");return l4(t,r,n),n}function l4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function u4(t,e){var n=z1(t,e,"get");return c4(t,n)}function z1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function c4(t,e){return e.get?e.get.call(t):e.value}var fp=new WeakMap;class Y1{constructor(){o4(this,fp,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(u4(this,fp)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){a4(this,fp,e)}}pt(Y1,ar);function _E(t,e){const n=[];let r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function wu(t,e,n){h4(t,e),e.set(t,n)}function h4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rr(t,e){var n=j1(t,e,"get");return d4(t,n)}function d4(t,e){return e.get?e.get.call(t):e.value}function kh(t,e,n){var r=j1(t,e,"set");return f4(t,r,n),n}function j1(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function f4(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Fh=new WeakMap,vu=new WeakMap,Wh=new WeakMap,Vh=new WeakMap,Bh=new WeakMap;class g4{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wu(this,Fh,{writable:!0,value:new Set}),wu(this,vu,{writable:!0,value:[]}),wu(this,Wh,{writable:!0,value:[]}),wu(this,Vh,{writable:!0,value:!1}),wu(this,Bh,{writable:!0,value:!1}),kh(this,Bh,e??!1)}createObserver(){const e=new Y1;return Rr(this,Fh).add(e),e.addLocalHook("unsubscribe",()=>{Rr(this,Fh).delete(e)}),e._writeInitialChanges(_E(Rr(this,vu),Rr(this,Wh))),e}emit(e){let n=Rr(this,Wh);(!Rr(this,Vh)||Rr(this,vu).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Rr(this,Bh)):kh(this,vu,new Array(e.length).fill(Rr(this,Bh))),Rr(this,Vh)||(kh(this,Vh,!0),n=Rr(this,vu)));const r=_E(n,e);Rr(this,Fh).forEach(i=>i._write(r)),kh(this,Wh,e)}}function xn(t,e,n){return e=m4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m4(t){var e=p4(t,"string");return typeof e=="symbol"?e:String(e)}function p4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bv{constructor(){xn(this,"indexesSequence",new G1),xn(this,"trimmingMapsCollection",new TE(e=>e.some(n=>n===!0),!1)),xn(this,"hidingMapsCollection",new TE(e=>e.some(n=>n===!0),!1)),xn(this,"variousMapsCollection",new oy),xn(this,"hidingChangesObservable",new g4({initialIndexValue:!1})),xn(this,"notTrimmedIndexesCache",[]),xn(this,"notHiddenIndexesCache",[]),xn(this,"isBatched",!1),xn(this,"indexesSequenceChanged",!1),xn(this,"indexesChangeSource",void 0),xn(this,"trimmedIndexesChanged",!1),xn(this,"hiddenIndexesChanged",!1),xn(this,"renderablePhysicalIndexesCache",[]),xn(this,"fromPhysicalToVisualIndexesCache",new Map),xn(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,QX(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof nh?this.trimmingMapsCollection.register(e,n):n instanceof Ug?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return ue(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return ue(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return ue(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return ue(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const r=Ue(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Ic(this.getIndexesSequence(),r),a=s.filter(u=>this.isTrimmed(u)===!1);let l=s.indexOf(a[a.length-1])+1;if(n+o<i){const u=a[n];l=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(ny(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){const r=this.getNotTrimmedIndexes()[e],i=ue(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=Ue(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}}pt(Bv,ar);function w4(t,e){return Ge(e,(n,r)=>{Ct(t[r])&&(t[r]=n)}),t}function K1(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function X1(t){ue(t)&&AS(ht`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function v4(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:C4,getValues:S4}=ci("phraseFormatters");function y4(t,e){C4(t,e)}function b4(){return S4()}y4("pluralize",v4);const q1="ContextMenu:items",ke=q1,sy=`${ke}.noItems`,ay=`${ke}.insertRowAbove`,ly=`${ke}.insertRowBelow`,uy=`${ke}.insertColumnOnTheLeft`,cy=`${ke}.insertColumnOnTheRight`,hy=`${ke}.removeRow`,dy=`${ke}.removeColumn`,fy=`${ke}.undo`,gy=`${ke}.redo`,my=`${ke}.readOnly`,py=`${ke}.clearColumn`,wy=`${ke}.copy`,vy=`${ke}.copyWithHeaders`,Cy=`${ke}.copyWithGroupHeaders`,Sy=`${ke}.copyHeadersOnly`,yy=`${ke}.cut`,by=`${ke}.freezeColumn`,Ry=`${ke}.unfreezeColumn`,Ey=`${ke}.mergeCells`,Ty=`${ke}.unmergeCells`,_y=`${ke}.addComment`,My=`${ke}.editComment`,Ay=`${ke}.removeComment`,Oy=`${ke}.readOnlyComment`,Py=`${ke}.align`,Iy=`${ke}.align.left`,xy=`${ke}.align.center`,Hy=`${ke}.align.right`,Dy=`${ke}.align.justify`,Ny=`${ke}.align.top`,Ly=`${ke}.align.middle`,$y=`${ke}.align.bottom`,ky=`${ke}.borders`,Fy=`${ke}.borders.top`,Wy=`${ke}.borders.right`,Vy=`${ke}.borders.bottom`,By=`${ke}.borders.left`,Uy=`${ke}.borders.remove`,Gy=`${ke}.nestedHeaders.insertChildRow`,zy=`${ke}.nestedHeaders.detachFromParent`,Yy=`${ke}.hideColumn`,jy=`${ke}.showColumn`,Ky=`${ke}.hideRow`,Xy=`${ke}.showRow`,zn="Filters:",Vt=`${zn}conditions`,zg=`${Vt}.none`,qy=`${Vt}.isEmpty`,Zy=`${Vt}.isNotEmpty`,Qy=`${Vt}.isEqualTo`,Jy=`${Vt}.isNotEqualTo`,eb=`${Vt}.beginsWith`,tb=`${Vt}.endsWith`,nb=`${Vt}.contains`,rb=`${Vt}.doesNotContain`,R4=`${Vt}.byValue`,ib=`${Vt}.greaterThan`,ob=`${Vt}.greaterThanOrEqualTo`,sb=`${Vt}.lessThan`,ab=`${Vt}.lessThanOrEqualTo`,lb=`${Vt}.isBetween`,ub=`${Vt}.isNotBetween`,cb=`${Vt}.after`,hb=`${Vt}.before`,db=`${Vt}.today`,fb=`${Vt}.tomorrow`,gb=`${Vt}.yesterday`,mb=`${zn}labels.filterByCondition`,pb=`${zn}labels.filterByValue`,wb=`${zn}labels.conjunction`,Yg=`${zn}labels.disjunction`,Nf=`${zn}values.blankCells`,vb=`${zn}buttons.selectAll`,Cb=`${zn}buttons.clear`,Sb=`${zn}buttons.ok`,yb=`${zn}buttons.cancel`,bb=`${zn}buttons.placeholder.search`,Rb=`${zn}buttons.placeholder.value`,Eb=`${zn}buttons.placeholder.secondValue`,Tb="CheckboxRenderer:",_b=`${Tb}checked`,Mb=`${Tb}unchecked`,E4=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:_b,CHECKBOX_RENDERER_NAMESPACE:Tb,CHECKBOX_UNCHECKED:Mb,CONTEXTMENU_ITEMS_ADD_COMMENT:_y,CONTEXTMENU_ITEMS_ALIGNMENT:Py,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:$y,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:xy,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:Dy,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:Iy,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:Ly,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:Hy,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:Ny,CONTEXTMENU_ITEMS_BORDERS:ky,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:Vy,CONTEXTMENU_ITEMS_BORDERS_LEFT:By,CONTEXTMENU_ITEMS_BORDERS_RIGHT:Wy,CONTEXTMENU_ITEMS_BORDERS_TOP:Fy,CONTEXTMENU_ITEMS_CLEAR_COLUMN:py,CONTEXTMENU_ITEMS_COPY:wy,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:Sy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:Cy,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:vy,CONTEXTMENU_ITEMS_CUT:yy,CONTEXTMENU_ITEMS_EDIT_COMMENT:My,CONTEXTMENU_ITEMS_FREEZE_COLUMN:by,CONTEXTMENU_ITEMS_HIDE_COLUMN:Yy,CONTEXTMENU_ITEMS_HIDE_ROW:Ky,CONTEXTMENU_ITEMS_INSERT_LEFT:uy,CONTEXTMENU_ITEMS_INSERT_RIGHT:cy,CONTEXTMENU_ITEMS_MERGE_CELLS:Ey,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:zy,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:Gy,CONTEXTMENU_ITEMS_NO_ITEMS:sy,CONTEXTMENU_ITEMS_READ_ONLY:my,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:Oy,CONTEXTMENU_ITEMS_REDO:gy,CONTEXTMENU_ITEMS_REMOVE_BORDERS:Uy,CONTEXTMENU_ITEMS_REMOVE_COLUMN:dy,CONTEXTMENU_ITEMS_REMOVE_COMMENT:Ay,CONTEXTMENU_ITEMS_REMOVE_ROW:hy,CONTEXTMENU_ITEMS_ROW_ABOVE:ay,CONTEXTMENU_ITEMS_ROW_BELOW:ly,CONTEXTMENU_ITEMS_SHOW_COLUMN:jy,CONTEXTMENU_ITEMS_SHOW_ROW:Xy,CONTEXTMENU_ITEMS_UNDO:fy,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:Ry,CONTEXTMENU_ITEMS_UNMERGE_CELLS:Ty,CONTEXT_MENU_ITEMS_NAMESPACE:q1,FILTERS_BUTTONS_CANCEL:yb,FILTERS_BUTTONS_CLEAR:Cb,FILTERS_BUTTONS_OK:Sb,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:bb,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:Eb,FILTERS_BUTTONS_PLACEHOLDER_VALUE:Rb,FILTERS_BUTTONS_SELECT_ALL:vb,FILTERS_CONDITIONS_AFTER:cb,FILTERS_CONDITIONS_BEFORE:hb,FILTERS_CONDITIONS_BEGINS_WITH:eb,FILTERS_CONDITIONS_BETWEEN:lb,FILTERS_CONDITIONS_BY_VALUE:R4,FILTERS_CONDITIONS_CONTAINS:nb,FILTERS_CONDITIONS_EMPTY:qy,FILTERS_CONDITIONS_ENDS_WITH:tb,FILTERS_CONDITIONS_EQUAL:Qy,FILTERS_CONDITIONS_GREATER_THAN:ib,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:ob,FILTERS_CONDITIONS_LESS_THAN:sb,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:ab,FILTERS_CONDITIONS_NAMESPACE:Vt,FILTERS_CONDITIONS_NONE:zg,FILTERS_CONDITIONS_NOT_BETWEEN:ub,FILTERS_CONDITIONS_NOT_CONTAIN:rb,FILTERS_CONDITIONS_NOT_EMPTY:Zy,FILTERS_CONDITIONS_NOT_EQUAL:Jy,FILTERS_CONDITIONS_TODAY:db,FILTERS_CONDITIONS_TOMORROW:fb,FILTERS_CONDITIONS_YESTERDAY:gb,FILTERS_DIVS_FILTER_BY_CONDITION:mb,FILTERS_DIVS_FILTER_BY_VALUE:pb,FILTERS_LABELS_CONJUNCTION:wb,FILTERS_LABELS_DISJUNCTION:Yg,FILTERS_NAMESPACE:zn,FILTERS_VALUES_BLANK_CELLS:Nf},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const T4={languageCode:"en-US",[sy]:"No available options",[ay]:"Insert row above",[ly]:"Insert row below",[uy]:"Insert column left",[cy]:"Insert column right",[hy]:["Remove row","Remove rows"],[dy]:["Remove column","Remove columns"],[fy]:"Undo",[gy]:"Redo",[my]:"Read only",[py]:"Clear column",[Py]:"Alignment",[Iy]:"Left",[xy]:"Center",[Hy]:"Right",[Dy]:"Justify",[Ny]:"Top",[Ly]:"Middle",[$y]:"Bottom",[by]:"Freeze column",[Ry]:"Unfreeze column",[ky]:"Borders",[Fy]:"Top",[Wy]:"Right",[Vy]:"Bottom",[By]:"Left",[Uy]:"Remove border(s)",[_y]:"Add comment",[My]:"Edit comment",[Ay]:"Delete comment",[Oy]:"Read-only comment",[Ey]:"Merge cells",[Ty]:"Unmerge cells",[wy]:"Copy",[vy]:["Copy with header","Copy with headers"],[Cy]:["Copy with group header","Copy with group headers"],[Sy]:["Copy header only","Copy headers only"],[yy]:"Cut",[Gy]:"Insert child row",[zy]:"Detach from parent",[Yy]:["Hide column","Hide columns"],[jy]:["Show column","Show columns"],[Ky]:["Hide row","Hide rows"],[Xy]:["Show row","Show rows"],[zg]:"None",[qy]:"Is empty",[Zy]:"Is not empty",[Qy]:"Is equal to",[Jy]:"Is not equal to",[eb]:"Begins with",[tb]:"Ends with",[nb]:"Contains",[rb]:"Does not contain",[ib]:"Greater than",[ob]:"Greater than or equal to",[sb]:"Less than",[ab]:"Less than or equal to",[lb]:"Is between",[ub]:"Is not between",[cb]:"After",[hb]:"Before",[db]:"Today",[fb]:"Tomorrow",[gb]:"Yesterday",[Nf]:"Blank cells",[mb]:"Filter by condition",[pb]:"Filter by value",[wb]:"And",[Yg]:"Or",[vb]:"Select all",[Cb]:"Clear",[Sb]:"OK",[yb]:"Cancel",[bb]:"Search",[Rb]:"Value",[Eb]:"Second value",[_b]:"Checked",[Mb]:"Unchecked"},Z1=T4,_4=E4,Uv=Z1.languageCode,{register:M4,getItem:Q1,hasItem:A4,getValues:O4}=ci("languagesDictionaries");J1(Z1);function J1(t,e){let n=t,r=e;return Ve(t)&&(r=t,n=r.languageCode),P4(n,r),M4(n,Tn(r)),Tn(r)}function P4(t,e){t!==Uv&&w4(e,Q1(Uv))}function eH(t){return Ab(t)?Tn(Q1(t)):null}function Ab(t){return A4(t)}function I4(){return O4()}function tH(t,e,n){const r=eH(t);if(r===null)return null;const i=r[e];if(Ct(i))return null;const o=x4(i,n);return Array.isArray(o)?o[0]:o}function x4(t,e){let n=t;return E(b4(),r=>{n=r(t,e)}),n}function H4(t){let e=K1(t);return Ab(e)||(e=Uv,X1(t)),e}function D4(t,e,n){return e=N4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N4(t){var e=L4(t,"string");return typeof e=="symbol"?e:String(e)}function L4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $4 extends B3{constructor(e,n){super(e,null),D4(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){const a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}}const Io=$4;function gp(t){let{activeHeaderClassName:e,...n}=t;return new Io({className:e,...n,selectionType:O1})}function k4(t){let{areaCornerVisible:e,...n}=t;return new Io({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:GS})}function F4(t){let{...e}=t;return new Io({className:"highlight",...e,selectionType:GS})}function W4(t){let{columnClassName:e,...n}=t;return new Io({className:e,...n,selectionType:z3})}function V4(t){let{cellCornerVisible:e,...n}=t;return new Io({className:"current",headerAttributes:[dS()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:zS})}function B4(t){let{border:e,visualCellRange:n,...r}=t;return new Io({...e,...r,selectionType:Y3},n)}function U4(t){let{...e}=t;return new Io({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:U3})}function ME(t){let{headerClassName:e,...n}=t;return new Io({className:e,...n,selectionType:US})}function G4(t){let{rowClassName:e,...n}=t;return new Io({className:e,...n,selectionType:G3})}let nH;function z4(t,e){Y4(t,e),e.add(t)}function Y4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kn(t,e,n){return e=j4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j4(t){var e=K4(t,"string");return typeof e=="symbol"?e:String(e)}function K4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var mi=new WeakSet;nH=Symbol.iterator;class X4{constructor(e){z4(this,mi),Kn(this,"options",void 0),Kn(this,"layerLevel",0),Kn(this,"focus",void 0),Kn(this,"fill",void 0),Kn(this,"layeredAreas",new Map),Kn(this,"areas",new Map),Kn(this,"rowHeaders",new Map),Kn(this,"columnHeaders",new Map),Kn(this,"activeRowHeaders",new Map),Kn(this,"activeColumnHeaders",new Map),Kn(this,"activeCornerHeaders",new Map),Kn(this,"rowHighlights",new Map),Kn(this,"columnHighlights",new Map),Kn(this,"customSelections",[]),this.options=e,this.focus=V4(e),this.fill=U4(e)}isEnabledFor(e,n){let r=e;e===zS&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Xi(this,mi,qi).call(this,this.layeredAreas,k4)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Xi(this,mi,qi).call(this,this.areas,F4)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Xi(this,mi,qi).call(this,this.rowHeaders,ME)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Xi(this,mi,qi).call(this,this.columnHeaders,ME)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Xi(this,mi,qi).call(this,this.activeRowHeaders,gp)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Xi(this,mi,qi).call(this,this.activeColumnHeaders,gp)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Xi(this,mi,qi).call(this,this.activeCornerHeaders,gp)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Xi(this,mi,qi).call(this,this.rowHighlights,G4)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Xi(this,mi,qi).call(this,this.columnHighlights,W4)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(B4({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),E(this.areas.values(),e=>void e.clear()),E(this.layeredAreas.values(),e=>void e.clear()),E(this.rowHeaders.values(),e=>void e.clear()),E(this.columnHeaders.values(),e=>void e.clear()),E(this.activeRowHeaders.values(),e=>void e.clear()),E(this.activeColumnHeaders.values(),e=>void e.clear()),E(this.activeCornerHeaders.values(),e=>void e.clear()),E(this.rowHighlights.values(),e=>void e.clear()),E(this.columnHighlights.values(),e=>void e.clear())}[nH](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function qi(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const r=e({layerLevel:n,...this.options});return t.set(n,r),r}const q4=X4;let rH;function AE(t,e,n){return e=Z4(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z4(t){var e=Q4(t,"string");return typeof e=="symbol"?e:String(e)}function Q4(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}rH=Symbol.iterator;class J4{constructor(e){AE(this,"ranges",[]),AE(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[rH](){return this.ranges[Symbol.iterator]()}}const eq=J4;function Cu(t,e){iH(t,e),e.add(t)}function mp(t,e,n){iH(t,e),e.set(t,n)}function iH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Je(t,e){var n=oH(t,e,"get");return tq(t,n)}function tq(t,e){return e.get?e.get.call(t):e.value}function Zn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Gv(t,e,n){var r=oH(t,e,"set");return nq(t,r,n),n}function oH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Uh=new WeakMap,ot=new WeakMap,vs=new WeakMap,pp=new WeakSet,wp=new WeakSet,zv=new WeakSet,vp=new WeakSet,Ds=new WeakSet;class sH{constructor(e,n){Cu(this,Ds),Cu(this,vp),Cu(this,zv),Cu(this,wp),Cu(this,pp),mp(this,Uh,{writable:!0,value:void 0}),mp(this,ot,{writable:!0,value:void 0}),mp(this,vs,{writable:!0,value:{x:0,y:0}}),Gv(this,Uh,e),Gv(this,ot,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Zn(this,pp,OE).call(this,{x:Je(this,ot).navigableHeaders()?Je(this,ot).countRowHeaders():0,y:Je(this,ot).navigableHeaders()?Je(this,ot).countColHeaders():0});const i=Je(this,ot).createCellCoords(e,n);let o=Je(this,Uh).current().highlight;const s=Je(this,ot).visualToRenderableCoords(o);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){const{width:u,height:c}=Zn(this,zv,aH).call(this),{row:h,col:d}=Zn(this,vp,IE).call(this,o),f=Je(this,ot).fixedRowsBottom(),p=Je(this,ot).minSpareRows(),v=Je(this,ot).minSpareCols(),S=Je(this,ot).autoWrapRow(),y=Je(this,ot).autoWrapCol(),R=Je(this,ot).createCellCoords(h+i.row,d+i.col);if(R.row>=c){const M=ri(r&&p>0&&f===0),L=R.col+1,B=Je(this,ot).createCellCoords(R.row-c,L>=u?L-u:L);this.runLocalHooks("beforeColumnWrap",M,Zn(this,Ds,Va).call(this,B),L>=u),M.value?this.runLocalHooks("insertRowRequire",Je(this,ot).countRenderableRows()):y&&R.assign(B)}else if(R.row<0){const M=ri(y),L=R.col-1,B=Je(this,ot).createCellCoords(c+R.row,L<0?u+L:L);this.runLocalHooks("beforeColumnWrap",M,Zn(this,Ds,Va).call(this,B),L<0),y&&R.assign(B)}if(R.col>=u){const M=ri(r&&v>0),L=R.row+1,B=Je(this,ot).createCellCoords(L>=c?L-c:L,R.col-u);this.runLocalHooks("beforeRowWrap",M,Zn(this,Ds,Va).call(this,B),L>=c),M.value?this.runLocalHooks("insertColRequire",Je(this,ot).countRenderableColumns()):S&&R.assign(B)}else if(R.col<0){const M=ri(S),L=R.row-1,B=Je(this,ot).createCellCoords(L<0?c+L:L,u+R.col);this.runLocalHooks("beforeRowWrap",M,Zn(this,Ds,Va).call(this,B),L<0),S&&R.assign(B)}const{rowDir:T,colDir:A}=Zn(this,wp,PE).call(this,R);a=T,l=A,o=Zn(this,Ds,Va).call(this,R)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){Zn(this,pp,OE).call(this,{x:Je(this,ot).navigableHeaders()?Je(this,ot).countRowHeaders():0,y:Je(this,ot).navigableHeaders()?Je(this,ot).countColHeaders():0});const r=Je(this,ot).createCellCoords(e,n),i=Je(this,Uh).current(),o=Je(this,ot).visualToRenderableCoords(i.highlight),s=i.to.clone();let a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){const{row:u,col:c}=Zn(this,vp,IE).call(this,i.to),h=Je(this,ot).createCellCoords(u+r.row,c+r.col),{rowDir:d,colDir:f}=Zn(this,wp,PE).call(this,h);a=d,l=f;const p=Zn(this,Ds,Va).call(this,h);r.row===0&&r.col!==0?s.col=p.col:r.row!==0&&r.col===0?s.row=p.row:(s.row=p.row,s.col=p.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}}function OE(t){let{x:e,y:n}=t;Gv(this,vs,{x:e,y:n})}function PE(t){const{width:e,height:n}=Zn(this,zv,aH).call(this);let r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function aH(){return{width:Je(this,vs).x+Je(this,ot).countRenderableColumns(),height:Je(this,vs).y+Je(this,ot).countRenderableRows()}}function IE(t){const{row:e,col:n}=Je(this,ot).visualToRenderableCoords(t);return Je(this,ot).createCellCoords(Je(this,vs).y+e,Je(this,vs).x+n)}function Va(t){const e=t.clone();return e.col=t.col-Je(this,vs).x,e.row=t.row-Je(this,vs).y,Je(this,ot).renderableToVisualCoords(e)}pt(sH,ar);const rq=sH,jg=0,Kg=1,lH=2,Ob=3,iq=[Ob,lH],oq=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Cp=Symbol("root"),xE=Symbol("child");function Fl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Cp;if(e!==Cp&&e!==xE)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),r=e===Cp;let i=jg;if(n){const o=t[0];t.length===0?i=Kg:r&&o instanceof NS?i=Ob:r&&Array.isArray(o)?i=Fl(o,xE):t.length>=2&&t.length<=4&&!t.some((a,l)=>!oq[l].includes(typeof a))&&(i=lH)}return i}function xc(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!iq.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const s=t===Ob;let a=s?o.from.row:o[0],l=s?o.from.col:o[1],u=s?o.to.row:o[2],c=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),Ct(u)&&(u=a),Ct(c)&&(c=l),!r){const f=a,p=l,v=u,S=c;a=Math.min(f,v),l=Math.min(p,S),u=Math.max(f,v),c=Math.max(p,S)}const h=e(a,l),d=e(u,c);return n(h,h,d)}}function sq(t){const e=Fl(t.getSelected());if(e===jg||e===Kg)return[];const n=xc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;E(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.col,0),c=l.col-u+1;E(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Gt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function aq(t){const e=Fl(t.getSelected());if(e===jg||e===Kg)return[];const n=xc(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;E(t.getSelected(),s=>{const{from:a,to:l}=n(s),u=Math.max(a.row,0),c=l.row-u+1;E(Array.from(new Array(c),(h,d)=>u+d),h=>{r.has(h)||r.add(h)})});const i=Array.from(r).sort((s,a)=>s-a);return Gt(i,(s,a,l,u)=>(l!==0&&a===u[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function lq(t,e,n){uq(t,e),e.set(t,n)}function uq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $o(t,e,n){return e=cq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cq(t){var e=hq(t,"string");return typeof e=="symbol"?e:String(e)}function hq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HE(t,e,n){var r=uH(t,e,"set");return dq(t,r,n),n}function dq(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function DE(t,e){var n=uH(t,e,"get");return fq(t,n)}function uH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function fq(t,e){return e.get?e.get.call(t):e.value}var Su=new WeakMap;class cH{constructor(e,n){var r=this;$o(this,"settings",void 0),$o(this,"tableProps",void 0),$o(this,"inProgress",!1),$o(this,"selectedRange",new eq((i,o,s)=>this.tableProps.createCellRange(i,o,s))),$o(this,"highlight",void 0),$o(this,"transformation",void 0),$o(this,"selectedByRowHeader",new Set),$o(this,"selectedByColumnHeader",new Set),lq(this,Su,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new q4({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[dS()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new rq(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",s=Ct(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&Ct(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(zS,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const l=this.getLayerLevel();l<this.highlight.layerLevel&&(E(this.highlight.getAreas(),R=>void R.clear()),E(this.highlight.getLayeredAreas(),R=>void R.clear()),E(this.highlight.getRowHeaders(),R=>void R.clear()),E(this.highlight.getColumnHeaders(),R=>void R.clear()),E(this.highlight.getActiveRowHeaders(),R=>void R.clear()),E(this.highlight.getActiveColumnHeaders(),R=>void R.clear()),E(this.highlight.getActiveCornerHeaders(),R=>void R.clear()),E(this.highlight.getRowHighlights(),R=>void R.clear()),E(this.highlight.getColumnHighlights(),R=>void R.clear())),this.highlight.useLayerLevel(l);const u=this.highlight.createArea(),c=this.highlight.createLayeredArea(),h=this.highlight.createRowHeader(),d=this.highlight.createColumnHeader(),f=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),v=this.highlight.createActiveCornerHeader(),S=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),p.clear(),v.clear(),S.clear(),y.clear(),this.highlight.isEnabledFor(GS,s.highlight)&&(this.isMultiple()||l>=1)&&(u.add(s.from).add(s.to).commit(),c.add(s.from).add(s.to).commit(),l===1)){const R=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(R.from).commit().syncWith(R),this.highlight.createLayeredArea().add(R.from).commit().syncWith(R),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(US,s.highlight)){if(!s.isSingleHeader()){const A=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),M=this.tableProps.createCellCoords(s.to.row,-1),L=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),B=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(h.add(A).commit(),d.add(L).commit(),S.add(A).commit(),y.add(L).commit()):(h.add(A).add(M).commit(),d.add(L).add(B).commit(),S.add(A).add(M).commit(),y.add(L).add(B).commit())}const R=!DE(this,Su)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),T=!DE(this,Su)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());R&&f.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),T&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),R&&T&&v.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=ri(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=i=>{const{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));const r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=r?-l:0,c=n?-a:0;if(u===0&&c===0&&(o===0||s===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;HE(this,Su,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(or(d.row,u,o-1),or(d.col,c,s-1)));const p=this.tableProps.createCellCoords(u,c),v=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.finish(),HE(this,Su,!1)}selectCells(e){var n=this;const r=Fl(e);if(r===Kg)return!1;if(r===jg)throw new Error(ht`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=xc(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(s);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),E(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(s-1,o),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){const f=l===0?0:or(r,u,-1),p=s-1,v=this.tableProps.createCellCoords(f,i),S=this.tableProps.createCellCoords(p,o),y=this.tableProps.createCellCoords(or(r,u,s-1),i);this.runLocalHooks("beforeSelectColumns",v,S,y),v.row=f,S.row=p,this.setRangeStartOnly(v,void 0,y),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectColumns",v,S,y),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(n,o-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(c){const h=s===0?0:or(r,a,-1),d=o-1,f=this.tableProps.createCellCoords(e,h),p=this.tableProps.createCellCoords(n,d),v=this.tableProps.createCellCoords(e,or(r,a,o-1));this.runLocalHooks("beforeSelectRows",f,p,v),f.col=h,p.col=d,this.setRangeStartOnly(f,void 0,v),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectRows",f,p,v),this.finish()}return c}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(r)}}pt(cH,ar);const gq=cH,NE=/^(\r\n|\n\r|\r|\n)/,mq=/^[^\t\r\n]+/,LE=/^\t/;function pq(t){const e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(LE))t=t.replace(LE,""),n+=1,e[r][n]="";else if(t.match(NE))t=t.replace(NE,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const s=t.match(mq);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function ac(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function Ns(t,e,n){return e=wq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wq(t){var e=vq(t,"string");return typeof e=="symbol"?e:String(e)}function vq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Al{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){Ns(this,"hot",void 0),Ns(this,"metaManager",void 0),Ns(this,"tableMeta",void 0),Ns(this,"dataSource",void 0),Ns(this,"duckSchema",void 0),Ns(this,"colToPropCache",void 0),Ns(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){const a=Lg(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){const a=s?n(r):n[r];if(Ve(a)){if(typeof a.data<"u"){const l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return JS(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Ge(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&ue(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(ue(n))return this.hot.toVisualColumn(n);const r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?kl(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&o+a<c;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=Tn(this.getSchema()):(p=[],pe(h-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},Zc(p,this.getSchema())),d.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,d);const f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,p=c;i==="end"&&(p=Math.min(p+1,a));const v=p;for(;f<n&&d<s;){if(typeof l!="number"||l>=d)if(h>0)for(let y=0;y<h;y+=1)typeof o[y]>"u"&&(o[y]=[]),o[y].push(null);else o.push([null]);else for(let y=0;y<h;y++)o[y].splice(p,0,null);f+=1,p+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(v,n));const S=this.hot.toVisualColumn(v);return this.hot.runHooks("afterCreateCol",S,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;const l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const c=ue(this.tableMeta.columns)||ue(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();const o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0;const u=s.length,c=this.dataSource;for(let h=0;h<u;h++)l&&o[0]!==o[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(o[0],n),h===0&&this.metaManager.removeColumn(o[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(s[f],1),h===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){const i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Sv(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return cx(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){const i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];Sv(l,s);let c=0;for(;c<r;)l.push(null),c+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){const o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){const r=this.hot.toPhysicalRow(e);let i=this.dataSource[r];const o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&It(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){const a=n.split(".");let l=i;if(!l)return null;for(let u=0,c=a.length;u<c;u++)if(l=l[a[u]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const a=ri(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){const i=this.hot.toPhysicalRow(e);let o=r,s=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const l=ri(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&It(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){const l=n.split(".");let u=s,c=0,h;for(c=0,h=l.length-1;c<h;c++)typeof u[l[c]]>"u"&&(u[l[c]]={}),u=u[l[c]];u[l[c]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){const r=this.hot.countSourceRows(),i=[];let o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){const r=this.hot.countCols(),i=[];let o=(r+e)%r,s=n;for(;o<r&&s;){const a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Al.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){const i=[];let o,s,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=r===Al.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=h;o++){a=[];const f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=d&&f!==null;s++)a.push(c.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return ac(this.getRange(e,n,Al.DESTINATION_RENDERER))}getCopyableText(e,n){return ac(this.getRange(e,n,Al.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const Cq=Al,{register:Sq,getItem:yq,hasItem:hH,getNames:bq,getValues:ice}=ci("cellTypes");function Pb(t){if(!hH(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return yq(t)}function Er(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:r,validator:i}=e;n&&er(t,n),r&&cr(t,r),i&&oa(t,i),Sq(t,e)}function Rq(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!It(e,t)}function Xg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const r=typeof e.type=="string"?Pb(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ge(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Ve(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};Ge(r,(o,s)=>{if(Rq(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),jt(t,i)}function Eq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}Oo(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Zd(t){return Number.isInteger(t)&&t>=0}function Qd(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Gh(t){return t==null}const dH=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Zt(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Zt(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),Ng(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function $E(t,e,n){return e=Tq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tq(t){var e=_q(t,"string");return typeof e=="symbol"?e:String(e)}function _q(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mq(){return class{}}class Aq{constructor(e){$E(this,"metaCtor",Mq()),$E(this,"meta",void 0),this.meta=this.metaCtor.prototype,jt(this.meta,dH()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;jt(this.meta,e),Xg(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Oq(t,e,n){return e=Pq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pq(t){var e=Iq(t,"string");return typeof e=="symbol"?e:String(e)}function Iq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xq{constructor(e){Oq(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){jt(this.meta,e),Xg(this.meta,e,e)}}let fH;function zh(t,e,n){return e=Hq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hq(t){var e=Dq(t,"string");return typeof e=="symbol"?e:String(e)}function Dq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}fH=Symbol.iterator;class Lf{constructor(e){zh(this,"valueFactory",void 0),zh(this,"data",[]),zh(this,"index",[]),zh(this,"holes",new Set),this.valueFactory=e}obtain(e){Qd(()=>Zd(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Qd(()=>Zd(e)||Gh(e),"Expecting an unsigned number or null/undefined argument.");const r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);const o=Gh(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;Qd(()=>Zd(e)||Gh(e),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(Gh(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){const o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return vr(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){const r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[fH](){return this.entries()}}function kE(t,e,n){return e=Nq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nq(t){var e=Lq(t,"string");return typeof e=="symbol"?e:String(e)}function Lq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $q=["data","width"];class kq{constructor(e){kE(this,"globalMeta",void 0),kE(this,"metas",new Lf(()=>this._createMeta())),this.globalMeta=e,this.metas=new Lf(()=>this._createMeta())}updateMeta(e,n){const r=this.getMeta(e);jt(r,n),Xg(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Eq(this.globalMeta.getMetaConstructor(),$q).prototype}}function FE(t,e,n){return e=Fq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fq(t){var e=Wq(t,"string");return typeof e=="symbol"?e:String(e)}function Wq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vq{constructor(e){FE(this,"columnMeta",void 0),FE(this,"metas",new Lf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){const i=this.getMeta(e,n);jt(i,r),Xg(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;const s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){const i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)ue(n[r])&&e.push(...n[r].values());return e}getMetasAtRow(e){Qd(()=>Zd(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Lf(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class gH{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Aq(e),this.tableMeta=new xq(this.globalMeta),this.columnMeta=new kq(this.globalMeta),this.cellMeta=new Vq(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r;const s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}pt(gH,ar);function WE(t,e,n,r){const{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:u,firstRun:c}=r,h=En(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":vt(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Cq(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const p=f.getSchema();t=[];let v,S=0,y=0;for(S=0,y=d.startRows;S<y;S++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)v=Tn(p),t.push(v);else if(i.dataType==="array")v=Tn(p[0]),t.push(v);else{v=[];for(let R=0,T=d.startCols;R<T;R++)v.push(null);t.push(v)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&Te(i.rootElement,[vx(-1),Og(i.countCols()+(i.view?i.countRowHeaders():0))])}function VE(t,e,n){return e=Bq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bq(t){var e=Uq(t,"string");return typeof e=="symbol"?e:String(e)}function Uq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gq{constructor(e){VE(this,"metaManager",void 0),VE(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),fe.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;const{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);const u=It(e,"type")?e.type:null;let c=vt(e.cells)?e.cells(r,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(r,i,c),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}}function Sp(t,e,n){return e=zq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zq(t){var e=Yq(t,"string");return typeof e=="symbol"?e:String(e)}function Yq(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jq{constructor(e){Sp(this,"metaManager",void 0),Sp(this,"usageTracker",new Set),Sp(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}}const mH="gridDefault",Ib="editorManager.handlingEditor",Kq={name:"editorCloseAndSave",callback(t,e,n){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}},Xq={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},qq={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Zq={name:"editorOpen",callback(t,e,n){const r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),kr(e))}};function Qq(){return[Kq,Xq,qq,Zq]}const Jq={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},e6={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},t6={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},n6={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},r6={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}},i6={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},o6={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},s6={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}},a6={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},l6={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}},u6={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){const a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}},c6={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}},h6={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},d6={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){const i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function f6(){return[Jq,e6,t6,n6,r6,i6,o6,s6,a6,l6,u6,c6,h6,d6]}const g6={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},m6={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},p6={name:"moveCellSelectionInlineEnd",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}},w6={name:"moveCellSelectionInlineStart",callback(t,e){const n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}},v6={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},C6={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},S6={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}},y6={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},b6={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},R6={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}},E6={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}},T6={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight;let i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}},_6={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}},M6={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}},A6={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},O6={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function P6(){return[g6,m6,p6,w6,v6,C6,S6,y6,b6,R6,E6,T6,_6,M6,A6,O6]}const I6={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},x6={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},H6={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},D6={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},N6={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){const{readOnly:u}=t.getCellMeta(a,l);u||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}},L6=[...Qq(),...f6(),...P6(),I6,x6,H6,D6,N6];function pH(t){const e={};return L6.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function $6(t){const e=t.getShortcutManager().addContext("editor"),n=pH(t),r={group:Ib};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function k6(t){const e=t.getShortcutManager().addContext("grid"),n=pH(t),r={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ue(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:mH};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Ib,runOnlyIf:()=>ue(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function F6(t){[$6,k6].forEach(e=>e(t))}function W6(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=t.rootElement,r=BE(t),i=BE(t);return r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function BE(t){const n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Te(n,[Di(),Ao()]),n}function V6(t){const e=B6(t);let n;const{activate:r,deactivate:i}=W6(t,{onFocusFromTop(){var h;const d=(h=e(n))!==null&&h!==void 0?h:Yv(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(n))!==null&&h!==void 0?h:jv(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),o={wrapped:!1,flipped:!1};let s=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>r()),t.addHook("afterSelection",(h,d,f,p,v)=>{if(a&&(o.wrapped&&o.flipped||l)&&(l=!1,v.value=!0),s){var S;n=(S=t.getSelectedRangeLast())===null||S===void 0?void 0:S.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{o.wrapped=!0,o.flipped=f});function u(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:mH,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(s=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,s=!0,!d||!t.selection.isSelected()||f&&o.wrapped&&o.flipped||!f&&o.wrapped)return f&&o.wrapped&&o.flipped&&(n=h.shiftKey?Yv(t):jv(t)),u(),!1;h.preventDefault()},position:"after"}])}function Yv(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings();let i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function jv(t){var e,n;const{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings();let s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}function B6(t){return e=>{if(!e)return null;const n=Yv(t),r=jv(t);return e.col<n.col&&(e.col=n.col),e.col>r.col&&(e.col=r.col),e.row<n.row&&(e.row=n.row),e.row>r.row&&(e.row=r.row),e}}const UE=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Yh=t=>t.map(e=>{const n=e.toLowerCase();return UE.has(n)?UE.get(n):n}).sort().join("+"),U6=t=>t.split("+"),GE=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),G6=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),yp=t=>{let{key:e,code:n}=t,r=e;return GE.test(n)?r=n.replace(GE,"$1"):G6.has(n)&&(r=n),r.toLowerCase()},wH=Symbol("shortcut-context");function vH(t){return Ve(t)&&t.__kindOf===wH}const z6=t=>{const e=Wg({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:p=!1,relativeToGroup:v,position:S,forwardToContext:y}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ct(c))throw new Error("You need to define the shortcut's group.");if(vt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(ht`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:p};ue(v)&&([R.relativeToGroup,R.position]=[v,S]),vH(y)&&(R.forwardToContext=y),l.forEach(T=>{const A=Yh(T);if(e.hasItem(A)){const L=e.getItem(A);let B=L.findIndex(K=>K.group===v);B!==-1?S==="before"?B-=1:B+=1:B=L.length,L.splice(B,0,R)}else e.addItem(A,[R])})},r=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{Ge(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),n(c)})},i=l=>{const u=Yh(l);e.removeItem(u)};return{__kindOf:wH,addShortcut:n,addShortcuts:r,getShortcuts:l=>{const u=Yh(l),c=e.getItem(u);return ue(c)?c.slice():[]},hasShortcut:l=>{const u=Yh(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(p=>p.group!==l);f.length===0?i(U6(h)):(d.length=0,d.push(...f))})}}};function Y6(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const j6=["meta","alt","shift","control"],yu=Y6();let jh=0;function K6(t,e,n,r,i){const o=f=>j6.includes(f),s=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const v=[];return f.altKey&&v.push("alt"),p&&(f.ctrlKey||f.metaKey)?v.push("control/meta"):(f.ctrlKey&&v.push("control"),f.metaKey&&v.push("meta")),f.shiftKey&&v.push("shift"),v},a=f=>{if(e(f)===!1)return;const p=n(f);if(f.keyCode===229||p===!1||Qo(f))return;const v=yp(f);let S=[];o(v)||(S=s(f));const y=[v].concat(S);!i(f,y)&&(Pc()&&S.includes("meta")||!Pc()&&S.includes("control"))&&i(f,[v].concat(s(f,!0))),r(f)},l=f=>{const p=yp(f);o(p)&&yu.press(p)},u=f=>{const p=yp(f);o(p)&&yu.release(p)},c=()=>{yu.releaseAll()};return{mount:()=>{let f=t;for(jh+=1;f;)jh===1&&(f.document.documentElement.addEventListener("keydown",l),f.document.documentElement.addEventListener("keyup",u)),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Mc(f)},unmount:()=>{let f=t;for(jh-=1;f;)jh===0&&(f.document.documentElement.removeEventListener("keydown",l),f.document.documentElement.removeEventListener("keyup",u)),f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Mc(f)},isPressed:f=>yu.isPressed(f),releasePressedKeys:()=>yu.releaseAll()}}const X6=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t;const o=Wg({errorIdExists:p=>`The "${p}" context name is already registered.`});let s="grid";const a=p=>{const v=z6(p);return o.addItem(p,v),v},l=()=>s,u=p=>o.getItem(p),c=p=>{if(!o.hasItem(p))throw new Error(ht`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p};let h=!1;const d=function(p,v){let S=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const y=vH(S)?S:u(S);let R=!1;if(!y.hasShortcut(v))return R;const T=y.getShortcuts(v);for(let A=0;A<T.length;A++){const{callback:M,runOnlyIf:L,preventDefault:B,stopPropagation:K,captureCtrl:U,forwardToContext:G}=T[A];if(L(p)===!0){if(h=U,R=M(p,v)===!1,h=!1,B&&p.preventDefault(),K&&(kr(p),p.stopPropagation()),R)break;G&&d(p,v,G)}}return R},f=K6(e,n,r,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};let bp=null;const Rp=new Map;function CH(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this;const a=new Dr(s);let l,u,c,h,d,f=!0;PX(i)&&OX(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=e==null?void 0:e.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=H4(e.language);const S=new gH(s,e,[Gq,jq]),y=S.getTableMeta(),R=S.getGlobalMeta(),T=Wg();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),qd(this)&&gx(e.licenseKey,t),this.guid=`ht_${aS()}`,Rp.set(this.guid,this),this.columnIndexMapper=new Bv,this.rowIndexMapper=new Bv,this.columnIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterColumnSequenceChange",g)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",g=>{s.runHooks("afterRowSequenceChange",g)}),u=new YX(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const A=g=>{const{row:m,col:w}=g;return s._createCellCoords(m>=0?s.rowIndexMapper.getRenderableFromVisualIndex(m):m,w>=0?s.columnIndexMapper.getRenderableFromVisualIndex(w):w)},M=g=>{const{row:m,col:w}=g;return s._createCellCoords(m>=0?s.rowIndexMapper.getVisualFromRenderableIndex(m):m,w>=0?s.columnIndexMapper.getVisualFromRenderableIndex(w):w)};let L=new gq(y,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:g=>l.propToCol(g),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(g,m)=>s._createCellCoords(g,m),createCellRange:(g,m,w)=>s._createCellRange(g,m,w),visualToRenderableCoords:A,renderableToVisualCoords:M,isDisabledCellSelection:(g,m)=>g<0||m<0?s.getSettings().disableVisualSelection:s.getCellMeta(g,m).disableVisualSelection});this.selection=L;const B=g=>{let{hiddenIndexesChanged:m}=g;m&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",B),this.rowIndexMapper.addLocalHook("cacheUpdated",B),this.selection.addLocalHook("afterSetRangeEnd",g=>{const m=ri(!1),w=this.selection.getSelectedRange(),{from:P,to:I}=w.current(),N=w.size()-1;this.runHooks("afterSelection",P.row,P.col,I.row,I.col,m,N),this.runHooks("afterSelectionByProp",P.row,s.colToProp(P.col),I.row,s.colToProp(I.col),m,N);let j=!0;o&&(j=!1),m.isTouched()&&(j=!m.value);const Y=this.selection.selectedRange.current(),oe=this.selection.isSelectedByAnyHeader(),J=this.selection.isSelectedByRowHeader(),X=this.selection.isSelectedByColumnHeader();if(j!==!1)if(oe)J?this.scrollViewportTo({row:g.row}):X&&this.scrollViewportTo({col:g.col});else if(Y&&!this.selection.isMultiple()){const{row:Se,col:Ie}=Y.from;Se<0&&Ie>=0?this.scrollViewportTo({col:Ie}):Ie<0&&Se>=0?this.scrollViewportTo({row:Se}):this.scrollViewportTo({row:Se,col:Ie})}else this.scrollViewportTo(g.toObject());J&&X?Z(this.rootElement,["ht__selection--rows","ht__selection--columns"]):J?(Le(this.rootElement,"ht__selection--columns"),Z(this.rootElement,"ht__selection--rows")):X?(Le(this.rootElement,"ht__selection--rows"),Z(this.rootElement,"ht__selection--columns")):Le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",g=>{const m=g.length-1,{from:w,to:P}=g[m];this.runHooks("afterSelectionEnd",w.row,w.col,P.row,P.col,m),this.runHooks("afterSelectionEndByProp",w.row,s.colToProp(w.col),P.row,s.colToProp(P.col),m)}),this.selection.addLocalHook("afterIsMultipleSelection",g=>{const m=this.runHooks("afterIsMultipleSelection",g.value);g.value&&(g.value=m)}),this.selection.addLocalHook("afterDeselect",()=>{h.destroyEditor(),this._refreshBorders(),Le(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStart",...m)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeStartOnly",...m)}).addLocalHook("beforeSetRangeEnd",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("beforeSetRangeEnd",...m)}).addLocalHook("beforeSelectColumns",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("beforeSelectColumns",...m)}).addLocalHook("afterSelectColumns",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("afterSelectColumns",...m)}).addLocalHook("beforeSelectRows",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("beforeSelectRows",...m)}).addLocalHook("afterSelectRows",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("afterSelectRows",...m)}).addLocalHook("beforeModifyTransformStart",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("modifyTransformStart",...m)}).addLocalHook("afterModifyTransformStart",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformStart",...m)}).addLocalHook("beforeModifyTransformEnd",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("modifyTransformEnd",...m)}).addLocalHook("afterModifyTransformEnd",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("afterModifyTransformEnd",...m)}).addLocalHook("beforeRowWrap",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("beforeRowWrap",...m)}).addLocalHook("beforeColumnWrap",function(){for(var g=arguments.length,m=new Array(g),w=0;w<g;w++)m[w]=arguments[w];return r.runHooks("beforeColumnWrap",...m)}).addLocalHook("insertRowRequire",g=>this.alter("insert_row_above",g,1,"auto")).addLocalHook("insertColRequire",g=>this.alter("insert_col_start",g,1,"auto")),c={alter(g,m){var w,P;let I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=arguments.length>3?arguments[3]:void 0,j=arguments.length>4?arguments[4]:void 0;const Y=oe=>{if(oe.length===0)return[];const J=[...oe];return J.sort((Se,Ie)=>{let[Oe]=Se,[He]=Ie;return Oe===He?0:Oe>He?1:-1}),Gt(J,(Se,Ie)=>{let[Oe,He]=Ie;const z=Se[Se.length-1],[lt,Be]=z,xe=lt+Be;if(Oe<=xe){const De=Math.max(He-(xe-Oe),0);z[1]+=De}else Se.push([Oe,He]);return Se},[J[0]])};switch(g){case"insert_row_below":case"insert_row_above":const oe=s.countSourceRows();if(y.maxRows===oe)return;const J=g==="insert_row_below"?"below":"above";m=(w=m)!==null&&w!==void 0?w:J==="below"?oe:0;const{delta:X,startPhysicalIndex:Se}=l.createRow(m,I,{source:N,mode:J});if(X){const Be=L.selectedRange.current(),xe=Be==null?void 0:Be.from,De=xe==null?void 0:xe.row,Re=s.toVisualRow(Se);if(L.isSelectedByCorner())L.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ue(De)&&De>=Re){const{row:C,col:b}=Be.to;let _=xe.col;L.isSelectedByRowHeader()&&(_=-1),L.getSelectedRange().pop(),L.setRangeStartOnly(s._createCellCoords(De+X,_),!0),L.setRangeEnd(s._createCellCoords(C+X,b))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const Ie=g==="insert_col_end"?"end":"start";m=(P=m)!==null&&P!==void 0?P:Ie==="end"?s.countSourceCols():0;const{delta:Oe,startPhysicalIndex:He}=l.createCol(m,I,{source:N,mode:Ie});if(Oe){if(Array.isArray(y.colHeaders)){const C=[s.toVisualColumn(He),0];C.length+=Oe,Array.prototype.splice.apply(y.colHeaders,C)}const Be=L.selectedRange.current(),xe=Be==null?void 0:Be.from,De=xe==null?void 0:xe.col,Re=s.toVisualColumn(He);if(L.isSelectedByCorner())L.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(ue(De)&&De>=Re){const{row:C,col:b}=Be.to;let _=xe.row;L.isSelectedByColumnHeader()&&(_=-1),L.getSelectedRange().pop(),L.setRangeStartOnly(s._createCellCoords(_,De+Oe),!0),L.setRangeEnd(s._createCellCoords(C,b+Oe))}else s._refreshBorders()}break;case"remove_row":const z=Be=>{let xe=0;E(Be,De=>{let[Re,C]=De;const b=Zt(Re)?s.countRows()-1:Math.max(Re-xe,0);if(Number.isInteger(Re)&&(Re=Math.max(Re-xe,0)),!l.removeRow(Re,C,N))return;const F=s.countRows(),O=y.fixedRowsTop;O>=b+1&&(y.fixedRowsTop-=Math.min(C,O-b));const k=y.fixedRowsBottom;k&&b>=F-k&&(y.fixedRowsBottom-=Math.min(C,k)),xe+=C})};Array.isArray(m)?z(Y(m)):z([[m,I]]),c.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const lt=Be=>{let xe=0;E(Be,De=>{let[Re,C]=De;const b=Zt(Re)?s.countCols()-1:Math.max(Re-xe,0);let _=s.toPhysicalColumn(b);if(Number.isInteger(Re)&&(Re=Math.max(Re-xe,0)),!l.removeCol(Re,C,N))return;const O=y.fixedColumnsStart;O>=b+1&&(y.fixedColumnsStart-=Math.min(C,O-b)),Array.isArray(y.colHeaders)&&(typeof _>"u"&&(_=-1),y.colHeaders.splice(_,C)),xe+=C})};Array.isArray(m)?lt(Y(m)):lt([[m,I]]),c.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${g}"`)}j||c.adjustRowsAndCols()},adjustRowsAndCols(){const g=y.minRows,m=y.minSpareRows,w=y.minCols,P=y.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&L.deselect(),g){const I=s.countRows();I<g&&l.createRow(I,g-I,{source:"auto"})}if(m){const I=s.countEmptyRows(!0);if(I<m){const N=m-I,j=Math.min(N,y.maxRows-s.countSourceRows());l.createRow(s.countRows(),j,{source:"auto"})}}{let I;(w||P)&&(I=s.countEmptyCols(!0));let N=s.countCols();if(w&&!y.columns&&N<w){const j=w-N;I+=j,l.createCol(N,j,{source:"auto"})}if(P&&!y.columns&&s.dataType==="array"&&I<P){N=s.countCols();const j=P-I,Y=Math.min(j,y.maxCols-N);l.createCol(N,Y,{source:"auto"})}}if(L.isSelected()){const I=s.countRows(),N=s.countCols();E(L.selectedRange,j=>{let Y=!1,oe=j.from.row,J=j.from.col,X=j.to.row,Se=j.to.col;oe>I-1?(oe=I-1,Y=!0,X>oe&&(X=oe)):X>I-1&&(X=I-1,Y=!0,oe>X&&(oe=X)),J>N-1?(J=N-1,Y=!0,Se>J&&(Se=J)):Se>N-1&&(Se=N-1,Y=!0,J>Se&&(J=Se)),Y&&(J<0?s.selectRows(oe,X,J):oe<0?s.selectColumns(J,Se,oe):s.selectCell(oe,J,X,Se))})}s.view&&s.view.adjustElementsSize()},populateFromArray(g,m,w,P,I){let N,j,Y,oe;const J=[],X={},Se=[],Ie=g.row,Oe=g.col;if(j=m.length,j===0)return!1;let He=0,z=0;switch(Ve(w)&&(He=w.col-Oe+1,z=w.row-Ie+1),I){case"shift_down":const lt=rc(m),Be=lt.length,xe=Math.max(Be,He),De=s.getData().slice(Ie),Re=rc(De).slice(Oe,Oe+xe);for(Y=0;Y<xe;Y+=1)if(Y<Be){for(N=0,j=lt[Y].length;N<z-j;N+=1)lt[Y].push(lt[Y][N%j]);Y<Re.length?Se.push(lt[Y].concat(Re[Y])):Se.push(lt[Y].concat(new Array(De.length).fill(null)))}else Se.push(lt[Y%Be].concat(Re[Y]));s.populateFromArray(Ie,Oe,rc(Se));break;case"shift_right":const C=m.length,b=Math.max(C,z),_=s.getData().slice(Ie).map(V=>V.slice(Oe));for(N=0;N<b;N+=1)if(N<C){for(Y=0,oe=m[N].length;Y<He-oe;Y+=1)m[N].push(m[N][Y%oe]);if(N<_.length)for(let V=0;V<_[N].length;V+=1)m[N].push(_[N][V]);else m[N].push(...new Array(_[0].length).fill(null))}else m.push(m[N%j].slice(0,b).concat(_[N]));s.populateFromArray(Ie,Oe,m);break;case"overwrite":default:X.row=g.row,X.col=g.col;let F=0,O=0,k=!0,x;const D=function(ie){let de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const ye=m[ie%m.length];return de!==null?ye[de%ye.length]:ye},W=m.length,$=w?w.row-g.row+1:0;for(w?j=$:j=Math.max(W,$),N=0;N<j&&!(w&&X.row>w.row&&$>W||!y.allowInsertRow&&X.row>s.countRows()-1||X.row>=y.maxRows);N++){const V=N-F,ie=D(V).length,de=w?w.col-g.col+1:0;if(w?oe=de:oe=Math.max(ie,de),X.col=g.col,x=s.getCellMeta(X.row,X.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&x.skipRowOnPaste){F+=1,X.row+=1,j+=1;continue}for(O=0,Y=0;Y<oe&&!(w&&X.col>w.col&&de>ie||!y.allowInsertColumn&&X.col>s.countCols()-1||X.col>=y.maxCols);Y++){if(x=s.getCellMeta(X.row,X.col),(P==="CopyPaste.paste"||P==="Autofill.fill")&&x.skipColumnOnPaste){O+=1,X.col+=1,oe+=1;continue}if(x.readOnly&&P!=="UndoRedo.undo"){X.col+=1;continue}const ye=Y-O;let Me=D(V,ye),We=s.getDataAtCell(X.row,X.col);if(Me!==null&&typeof Me=="object")if(Array.isArray(Me)&&We===null&&(We=[]),We===null||typeof We!="object")k=!1;else{const St=kl(Array.isArray(We)?We:We[0]||We),Ze=kl(Array.isArray(Me)?Me:Me[0]||Me);Ng(St,Ze)||Array.isArray(St)&&Array.isArray(Ze)?Me=Tn(Me):k=!1}else We!==null&&typeof We=="object"&&(k=!1);k&&J.push([X.row,X.col,Me]),k=!0,X.col+=1}X.row+=1}s.setDataAtCell(J,null,null,P||"populateFromArray");break}}};function K(g){const m=K1(g);Ab(m)?(s.runHooks("beforeLanguageChange",m),R.language=m,s.runHooks("afterLanguageChange",m)):X1(g)}function U(g,m){const w=g==="className"?s.rootElement:s.table;if(f)Z(w,m);else{let P=[],I=[];R[g]&&(P=Array.isArray(R[g])?R[g]:bv(R[g])),m&&(I=Array.isArray(m)?m:bv(m));const N=yv(P,I),j=yv(I,P);N.length&&Le(w,N),j.length&&Z(w,j)}R[g]=m}this.init=function(){u.setData(y.data),s.runHooks("beforeInit"),(go()||_S())&&Z(s.rootElement,"mobile"),this.updateSettings(y,!0),this.view=new $X(this),h=DY.getInstance(s,y,L),d=new $Y(s),qd(this)&&V6(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&Px(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function G(){let g=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,g=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&g===!1&&(g=!0,this.onQueueEmpty(this.valid))}}}function Q(g){const m=g.replace(",",".");return isNaN(parseFloat(m))===!1?parseFloat(m):g}function re(g,m,w){if(!g.length)return;const P=s.getActiveEditor(),I=new G;let N=!0;I.onQueueEmpty=j=>{P&&N&&P.cancelChanges(),w(j)};for(let j=g.length-1;j>=0;j--){const[Y,oe,,J]=g[j],X=l.propToCol(oe),Se=s.getCellMeta(Y,X);Se.type==="numeric"&&typeof J=="string"&&r1(J)&&(g[j][3]=Q(J)),s.getCellValidator(Se)&&(I.addValidatorToQueue(),s.validateCell(g[j][3],Se,function(Ie,Oe){return function(He){if(typeof He!="boolean")throw new Error("Validation error: result is not boolean");if(He===!1&&Oe.allowInvalid===!1){N=!1,g.splice(Ie,1),Oe.valid=!0;const z=s.getCell(Oe.visualRow,Oe.visualCol);z!==null&&Le(z,y.invalidCellClassName)}I.removeValidatorFormQueue()}}(j,Se),m))}I.checkIfQueueIsEmpty()}function ne(g,m){let w=g.length-1;if(w<0)return;for(;w>=0;w--){let I=!1;if(g[w]===null){g.splice(w,1);continue}if(!((g[w][2]===null||g[w][2]===void 0)&&(g[w][3]===null||g[w][3]===void 0))){if(y.allowInsertRow)for(;g[w][0]>s.countRows()-1;){const{delta:N}=l.createRow(void 0,void 0,{source:m});if(N===0){I=!0;break}}if(s.dataType==="array"&&(!y.columns||y.columns.length===0)&&y.allowInsertColumn)for(;l.propToCol(g[w][1])>s.countCols()-1;){const{delta:N}=l.createCol(void 0,void 0,{source:m});if(N===0){I=!0;break}}I||l.set(g[w][0],g[w][1],g[w][3])}}s.forceFullRender=!0,c.adjustRowsAndCols(),s.runHooks("beforeChangeRender",g,m),h.lockEditor(),s._refreshBorders(null),h.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",g,m||"edit");const P=s.getActiveEditor();P&&ue(P.refreshValue)&&P.refreshValue()}this._createCellCoords=function(g,m){return s.view._wt.createCellCoords(g,m)},this._createCellRange=function(g,m,w){return s.view._wt.createCellRange(g,m,w)},this.validateCell=function(g,m,w,P){let I=s.getCellValidator(m);function N(j){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||m.hidden===!0){w(j);return}const oe=m.visualCol,J=m.visualRow,X=s.getCell(J,oe,!0);if(X&&X.nodeName!=="TH"){const Se=s.rowIndexMapper.getRenderableFromVisualIndex(J),Ie=s.columnIndexMapper.getRenderableFromVisualIndex(oe);s.view._wt.getSetting("cellRenderer",Se,Ie,X)}w(j)}fx(I)&&(I=function(j){return function(Y,oe){oe(j.test(Y))}}(I)),vt(I)?(g=s.runHooks("beforeValidate",g,m.visualRow,m.prop,P),s._registerImmediate(()=>{I.call(m,g,j=>{s&&(j=s.runHooks("afterValidate",j,g,m.visualRow,m.prop,P),m.valid=j,N(j),s.runHooks("postAfterValidate",j,g,m.visualRow,m.prop,P))})})):s._registerImmediate(()=>{m.valid=!0,N(m.valid,!1)})};function ce(g,m,w){return Array.isArray(g)?g:[[g,m,w]]}function be(g,m){const w=s.getActiveEditor(),P=s.runHooks("beforeChange",g,m||"edit"),I=g.filter(N=>N!==null);return P===!1||I.length===0?(w&&w.cancelChanges(),[]):I}this.setDataAtCell=function(g,m,w,P){const I=ce(g,m,w),N=[];let j=P,Y,oe,J;for(Y=0,oe=I.length;Y<oe;Y++){if(typeof I[Y]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof I[Y][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");I[Y][1]>=this.countCols()?J=I[Y][1]:J=l.colToProp(I[Y][1]),N.push([I[Y][0],J,u.getAtCell(this.toPhysicalRow(I[Y][0]),I[Y][1]),I[Y][2]])}!j&&typeof g=="object"&&(j=m);const X=be(N,P);s.runHooks("afterSetDataAtCell",X,j),re(X,j,()=>{ne(X,j)})},this.setDataAtRowProp=function(g,m,w,P){const I=ce(g,m,w),N=[];let j=P,Y,oe;for(Y=0,oe=I.length;Y<oe;Y++)N.push([I[Y][0],I[Y][1],u.getAtCell(this.toPhysicalRow(I[Y][0]),I[Y][1]),I[Y][2]]);!j&&typeof g=="object"&&(j=m);const J=be(N,P);s.runHooks("afterSetDataAtRowProp",J,j),re(J,j,()=>{ne(J,j)})},this.listen=function(){s&&!s.isListening()&&(Rp.forEach(g=>{s!==g&&g.unlisten()}),bp=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(bp=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return bp===s.guid},this.destroyEditor=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(g,m)},this.populateFromArray=function(g,m,w,P,I,N,j){if(!(typeof w=="object"&&typeof w[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const Y=typeof P=="number"?s._createCellCoords(P,I):null;return c.populateFromArray(s._createCellCoords(g,m),w,Y,N,j)},this.spliceCol=function(g,m,w){for(var P=arguments.length,I=new Array(P>3?P-3:0),N=3;N<P;N++)I[N-3]=arguments[N];return l.spliceCol(g,m,w,...I)},this.spliceRow=function(g,m,w){for(var P=arguments.length,I=new Array(P>3?P-3:0),N=3;N<P;N++)I[N-3]=arguments[N];return l.spliceRow(g,m,w,...I)},this.getSelected=function(){if(L.isSelected())return Ue(L.getSelectedRange(),g=>{let{from:m,to:w}=g;return[m.row,m.col,w.row,w.col]})},this.getSelectedLast=function(){const g=this.getSelected();let m;return g&&g.length>0&&(m=g[g.length-1]),m},this.getSelectedRange=function(){if(L.isSelected())return Array.from(L.getSelectedRange())},this.getSelectedRangeLast=function(){const g=this.getSelectedRange();let m;return g&&g.length>0&&(m=g[g.length-1]),m},this.emptySelectedCells=function(g){if(!L.isSelected()||this.countRows()===0||this.countCols()===0)return;const m=[];E(L.getSelectedRange(),w=>{if(w.isSingleHeader())return;const P=w.getTopStartCorner(),I=w.getBottomEndCorner();pe(P.row,I.row,N=>{pe(P.col,I.col,j=>{this.getCellMeta(N,j).readOnly||m.push([N,j,null])})})}),m.length>0&&this.setDataAtCell(m,g)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const g=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(g,0),!this.isRenderSuspended()&&g===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(h.lockEditor(),this._refreshBorders(null),h.unlockEditor()))},this.batchRender=function(g){this.suspendRender();const m=g();return this.resumeRender(),m},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const m=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(m,0),(!this.isExecutionSuspended()&&m===this.executionSuspendedCounter||g)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const w=g();return this.resumeExecution(m),w},this.batch=function(g){this.suspendRender(),this.suspendExecution();const m=g();return this.resumeExecution(),this.resumeRender(),m},this.refreshDimensions=function(){if(!s.view)return;const{width:g,height:m}=s.view.getLastSize(),{width:w,height:P}=s.rootElement.getBoundingClientRect(),I=w!==g||P!==m;s.runHooks("beforeRefreshDimensions",{width:g,height:m},{width:w,height:P},I)!==!1&&((I||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(w,P),s.render()),s.runHooks("afterRefreshDimensions",{width:g,height:m},{width:w,height:P},I))},this.updateData=function(g,m){WE(g,w=>{l=w},w=>{l=w,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"updateData",source:m,metaManager:S,firstRun:f})},this.loadData=function(g,m){WE(g,w=>{l=w},()=>{S.clearCellsCache(),s.initIndexMappers(),c.adjustRowsAndCols(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:u,internalSource:"loadData",source:m,metaManager:S,firstRun:f})},this.getInitialColumnCount=function(){const g=y.columns;let m=0;if(Array.isArray(g))m=g.length;else if(vt(g))if(s.dataType==="array"){const w=this.countSourceCols();for(let P=0;P<w;P+=1)g(P)&&(m+=1)}else(s.dataType==="object"||s.dataType==="function")&&(m=l.colToPropCache.length);else if(ue(y.dataSchema)){const w=l.getSchema();m=Array.isArray(w)?w.length:Lg(w)}else m=this.countSourceCols();return m},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(g,m,w,P){return Ct(g)?l.getAll():l.getRange(s._createCellCoords(g,m),s._createCellCoords(w,P),l.DESTINATION_RENDERER)},this.getCopyableText=function(g,m,w,P){return l.getCopyableText(s._createCellCoords(g,m),s._createCellCoords(w,P))},this.getCopyableData=function(g,m){return l.getCopyable(g,l.colToProp(m))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const w=(f?s.loadData:s.updateData).bind(this);let P=!1,I,N;if(ue(g.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ue(g.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ue(g.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(I in g)I==="data"||(I==="language"?K(g.language):I==="className"?U("className",g.className):I==="tableClassName"&&s.table?(U("tableClassName",g.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):fe.getSingleton().isRegistered(I)||fe.getSingleton().isDeprecated(I)?(vt(g[I])||Array.isArray(g[I]))&&(g[I].initialHook=!0,s.addHook(I,g[I])):!m&&It(g,I)&&(R[I]=g[I]));g.data===void 0&&y.data===void 0?w(null,"updateSettings"):g.data!==void 0?w(g.data,"updateSettings"):g.columns!==void 0&&(l.createMap(),s.initIndexMappers());const j=s.countCols(),Y=y.columns;if(Y&&vt(Y)&&(P=!0),(g.cell!==void 0||g.cells!==void 0||g.columns!==void 0)&&S.clearCache(),j>0)for(I=0,N=0;I<j;I++){if(Y){const X=P?Y(I):Y[N];X&&S.updateColumnMeta(N,X)}N+=1}ue(g.cell)&&Ge(g.cell,X=>{s.setCellMetaObject(X.row,X.col,X)}),s.runHooks("afterCellMetaReset");let oe=s.rootElement.style.height;oe!==""&&(oe=parseInt(s.rootElement.style.height,10));let J=g.height;if(vt(J)&&(J=J()),m&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),J===null){const X=s.rootElement.getAttribute("data-initialstyle");X&&(X.indexOf("height")>-1||X.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",X):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else J!==void 0&&(s.rootElement.style.height=isNaN(J)?`${J}`:`${J}px`,s.rootElement.style.overflow="hidden");if(typeof g.width<"u"){let X=g.width;vt(X)&&(X=X()),s.rootElement.style.width=isNaN(X)?`${X}`:`${X}px`}m||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",g)),c.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,h.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),h.unlockEditor()),!m&&s.view&&(oe===""||J===""||J===void 0)&&oe!==J&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const g=s.getSelectedLast();if(y.getValue){if(vt(y.getValue))return y.getValue.call(s);if(g)return s.getData()[g[0][0]][y.getValue]}else if(g)return s.getDataAtCell(g[0],g[1])},this.getSettings=function(){return y},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(g,m,w,P,I){c.alter(g,m,w,P,I)},this.getCell=function(g,m){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,P=m,I=g;if(m>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(m)))return null;P=this.columnIndexMapper.getRenderableFromVisualIndex(m)}if(g>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(g)))return null;I=this.rowIndexMapper.getRenderableFromVisualIndex(g)}return I===null||P===null?null:s.view.getCellAtCoords(s._createCellCoords(I,P),w)},this.getCoords=function(g){const m=this.view._wt.wtTable.getCoords(g);if(m===null)return null;const{row:w,col:P}=m;let I=w,N=P;return w>=0&&(I=this.rowIndexMapper.getVisualFromRenderableIndex(w)),P>=0&&(N=this.columnIndexMapper.getVisualFromRenderableIndex(P)),s._createCellCoords(I,N)},this.colToProp=function(g){return l.colToProp(g)},this.propToCol=function(g){return l.propToCol(g)},this.toVisualRow=g=>this.rowIndexMapper.getVisualFromPhysicalIndex(g),this.toVisualColumn=g=>this.columnIndexMapper.getVisualFromPhysicalIndex(g),this.toPhysicalRow=g=>this.rowIndexMapper.getPhysicalFromVisualIndex(g),this.toPhysicalColumn=g=>this.columnIndexMapper.getPhysicalFromVisualIndex(g),this.getDataAtCell=function(g,m){return l.get(g,l.colToProp(m))},this.getDataAtRowProp=function(g,m){return l.get(g,m)},this.getDataAtCol=function(g){const m=[],w=l.getRange(s._createCellCoords(0,g),s._createCellCoords(y.data.length-1,g),l.DESTINATION_RENDERER);for(let P=0;P<w.length;P+=1)for(let I=0;I<w[P].length;I+=1)m.push(w[P][I]);return m},this.getDataAtProp=function(g){const m=[],w=l.getRange(s._createCellCoords(0,l.propToCol(g)),s._createCellCoords(y.data.length-1,l.propToCol(g)),l.DESTINATION_RENDERER);for(let P=0;P<w.length;P+=1)for(let I=0;I<w[P].length;I+=1)m.push(w[P][I]);return m},this.getSourceData=function(g,m,w,P){let I;return g===void 0?I=u.getData():I=u.getByRange(s._createCellCoords(g,m),s._createCellCoords(w,P)),I},this.getSourceDataArray=function(g,m,w,P){let I;return g===void 0?I=u.getData(!0):I=u.getByRange(s._createCellCoords(g,m),s._createCellCoords(w,P),!0),I},this.getSourceDataAtCol=function(g){return u.getAtColumn(g)},this.setSourceDataAtCell=function(g,m,w,P){const I=ce(g,m,w),N=this.hasHook("afterSetSourceDataAtCell"),j=[];N&&E(I,oe=>{let[J,X,Se]=oe;j.push([J,X,u.getAtCell(J,X),Se])}),E(I,oe=>{let[J,X,Se]=oe;u.setAtCell(J,X,Se)}),N&&this.runHooks("afterSetSourceDataAtCell",j,P),this.render();const Y=s.getActiveEditor();Y&&ue(Y.refreshValue)&&Y.refreshValue()},this.getSourceDataAtRow=function(g){return u.getAtRow(g)},this.getSourceDataAtCell=function(g,m){return u.getAtCell(g,m)},this.getDataAtRow=function(g){return l.getRange(s._createCellCoords(g,0),s._createCellCoords(g,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(g,m,w,P){const I=g===void 0?[0,0,this.countRows(),this.countCols()]:[g,m,w,P],[N,j]=I;let[,,Y,oe]=I,J=null,X=null;Y===void 0&&(Y=N),oe===void 0&&(oe=j);let Se="mixed";return pe(Math.max(Math.min(N,Y),0),Math.max(N,Y),Ie=>{let Oe=!0;return pe(Math.max(Math.min(j,oe),0),Math.max(j,oe),He=>(X=this.getCellMeta(Ie,He).type,J?Oe=J===X:J=X,Oe)),Se=Oe?X:"mixed",Oe}),Se},this.removeCellMeta=function(g,m,w){const[P,I]=[this.toPhysicalRow(g),this.toPhysicalColumn(m)];let N=S.getCellMetaKeyValue(P,I,w);s.runHooks("beforeRemoveCellMeta",g,m,w,N)!==!1&&(S.removeCellMeta(P,I,w),s.runHooks("afterRemoveCellMeta",g,m,w,N)),N=null},this.spliceCellsMeta=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var w=arguments.length,P=new Array(w>2?w-2:0),I=2;I<w;I++)P[I-2]=arguments[I];if(P.length>0&&!Array.isArray(P[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");m>0&&S.removeRow(this.toPhysicalRow(g),m),P.length>0&&E(P.reverse(),N=>{S.createRow(this.toPhysicalRow(g)),E(N,(j,Y)=>this.setCellMetaObject(g,Y,j))}),s.render()},this.setCellMetaObject=function(g,m,w){typeof w=="object"&&Ge(w,(P,I)=>{this.setCellMeta(g,m,I,P)})},this.setCellMeta=function(g,m,w,P){if(s.runHooks("beforeSetCellMeta",g,m,w,P)===!1)return;let N=g,j=m;g<this.countRows()&&(N=this.toPhysicalRow(g)),m<this.countCols()&&(j=this.toPhysicalColumn(m)),S.setCellMeta(N,j,w,P),s.runHooks("afterSetCellMeta",g,m,w,P)},this.getCellsMeta=function(){return S.getCellsMeta()},this.getCellMeta=function(g,m){let w=this.toPhysicalRow(g),P=this.toPhysicalColumn(m);return w===null&&(w=g),P===null&&(P=m),S.getCellMeta(w,P,{visualRow:g,visualColumn:m})},this.getCellMetaAtRow=function(g){return S.getCellsMetaAtRow(g)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||y.columns)},this.getCellRenderer=function(g,m){const w=typeof g=="number"?s.getCellMeta(g,m).renderer:g.renderer;return typeof w=="string"?Pf(w):Ct(w)?Pf("text"):w},this.getCellEditor=function(g,m){const w=typeof g=="number"?s.getCellMeta(g,m).editor:g.editor;return typeof w=="string"?Mf(w):Ct(w)?Mf("text"):w},this.getCellValidator=function(g,m){const w=typeof g=="number"?s.getCellMeta(g,m).validator:g.validator;return typeof w=="string"?HS(w):w},this.validateCells=function(g){this._validateCells(g)},this.validateRows=function(g,m){if(!Array.isArray(g))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(m,g)},this.validateColumns=function(g,m){if(!Array.isArray(g))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(m,void 0,g)},this._validateCells=function(g,m,w){const P=new G;g&&(P.onQueueEmpty=g);let I=s.countRows()-1;for(;I>=0;){if(m!==void 0&&m.indexOf(I)===-1){I-=1;continue}let N=s.countCols()-1;for(;N>=0;){if(w!==void 0&&w.indexOf(N)===-1){N-=1;continue}P.addValidatorToQueue(),s.validateCell(s.getDataAtCell(I,N),s.getCellMeta(I,N),j=>{if(typeof j!="boolean")throw new Error("Validation error: result is not boolean");j===!1&&(P.valid=!1),P.removeValidatorFormQueue()},"validateCells"),N-=1}I-=1}P.checkIfQueueIsEmpty()},this.getRowHeader=function(g){let m=y.rowHeaders,w=g;return w!==void 0&&(w=s.runHooks("modifyRowHeader",w)),w===void 0?(m=[],pe(s.countRows()-1,P=>{m.push(s.getRowHeader(P))})):Array.isArray(m)&&m[w]!==void 0?m=m[w]:vt(m)?m=m(w):m&&typeof m!="string"&&typeof m!="number"&&(m=w+1),m},this.hasRowHeaders=function(){return!!y.rowHeaders},this.hasColHeaders=function(){if(y.colHeaders!==void 0&&y.colHeaders!==null)return!!y.colHeaders;for(let g=0,m=s.countCols();g<m;g++)if(s.getColHeader(g))return!0;return!1},this.getColHeader=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const w=s.runHooks("modifyColHeader",g);if(w===void 0){const Y=[],oe=s.countCols();for(let J=0;J<oe;J++)Y.push(s.getColHeader(J));return Y}let P=y.colHeaders;const I=function(Y){const oe=[],J=s.countCols();let X=0;for(;X<J;X++)vt(y.columns)&&y.columns(X)&&oe.push(X);return oe[Y]},N=s.toPhysicalColumn(w),j=I(N);return y.colHeaders===!1?P=null:y.columns&&vt(y.columns)&&y.columns(j)&&y.columns(j).title?P=y.columns(j).title:y.columns&&y.columns[N]&&y.columns[N].title?P=y.columns[N].title:Array.isArray(y.colHeaders)&&y.colHeaders[N]!==void 0?P=y.colHeaders[N]:vt(y.colHeaders)?P=y.colHeaders(N):y.colHeaders&&typeof y.colHeaders!="string"&&typeof y.colHeaders!="number"&&(P=Bg(w)),P=s.runHooks("modifyColumnHeaderValue",P,g,m),P},this._getColWidthFromSettings=function(g){let m;if(g>=0&&(m=s.getCellMeta(0,g).width),(m===void 0||m===y.width)&&(m=y.colWidths),m!=null){switch(typeof m){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getColWidth=function(g){let m=s._getColWidthFromSettings(g);return m=s.runHooks("modifyColWidth",m,g),m===void 0&&(m=Jc.DEFAULT_WIDTH),m},this._getRowHeightFromSettings=function(g){let m=y.rowHeights;if(m!=null){switch(typeof m){case"object":m=m[g];break;case"function":m=m(g);break}typeof m=="string"&&(m=parseInt(m,10))}return m},this.getRowHeight=function(g){let m=s._getRowHeightFromSettings(g);return m=s.runHooks("modifyRowHeight",m,g),m},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const g=y.maxCols,m=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(g,m)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Of(s.countRows()-1,w=>{if(s.isEmptyRow(w))m+=1;else if(g===!0)return!1}),m},this.countEmptyCols=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=0;return Of(s.countCols()-1,w=>{if(s.isEmptyCol(w))m+=1;else if(g===!0)return!1}),m},this.isEmptyRow=function(g){return y.isEmptyRow.call(s,g)},this.isEmptyCol=function(g){return y.isEmptyCol.call(s,g)},this.selectCell=function(g,m,w,P){let I=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,N=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ct(g)||Ct(m)?!1:this.selectCells([[g,m,w,P]],I,N)},this.selectCells=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;m===!1&&(o=!0);const P=L.selectCells(g);return P&&w&&s.listen(),o=!1,P},this.selectColumns=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,w=arguments.length>2?arguments[2]:void 0;return L.selectColumns(g,m,w)},this.selectRows=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,w=arguments.length>2?arguments[2]:void 0;return L.selectRows(g,m,w)},this.deselectCell=function(){L.deselect()},this.selectAll=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,w=arguments.length>2?arguments[2]:void 0;o=!0,L.selectAll(g,m,w),o=!1};const qe=(g,m)=>g.getNearestNotHiddenIndex(m,1,!0);this.scrollViewportTo=function(g){var m;if(typeof g=="number"){var w;g={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(w=arguments[4])!==null&&w!==void 0?w:!0}}const{row:P,col:I,verticalSnap:N,horizontalSnap:j,considerHiddenIndexes:Y}=(m=g)!==null&&m!==void 0?m:{};let oe,J,X,Se;N!==void 0&&(oe=N==="top",J=!oe),j!==void 0&&(X=j==="start",Se=!X);let Ie=P,Oe=I;if(Y===void 0||Y){const lt=Number.isInteger(P)&&P>=0,Be=Number.isInteger(I)&&I>=0,xe=lt?qe(this.rowIndexMapper,P):void 0,De=Be?qe(this.columnIndexMapper,I):void 0;if(xe===null||De===null)return!1;Ie=lt?s.rowIndexMapper.getRenderableFromVisualIndex(xe):P,Oe=Be?s.columnIndexMapper.getRenderableFromVisualIndex(De):I}const He=Number.isInteger(Ie),z=Number.isInteger(Oe);return He&&Ie>=0&&z&&Oe>=0?s.view.scrollViewport(s._createCellCoords(Ie,Oe),oe,Se,J,X):He&&Ie>=0&&(z&&Oe<0||!z)?s.view.scrollViewportVertically(Ie,oe,J):z&&Oe>=0&&(He&&Ie<0||!He)?s.view.scrollViewportHorizontally(Oe,Se,X):!1},this.scrollToFocusedCell=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",g);const{highlight:m}=this.getSelectedRangeLast();this.scrollViewportTo(m.toObject())?this.view.render():(this.removeHook("afterScroll",g),this._registerImmediate(()=>g()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),S.clearCache(),Rp.delete(this.guid),qd(s)){const g=this.rootDocument.querySelector(".hot-display-license-info");g&&g.parentNode.removeChild(g)}li(s.rootElement),a.destroy(),h&&h.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),T.getItems().forEach(g=>{let[,m]=g;m.destroy()}),T.clear(),s.runHooks("afterDestroy")},!0),fe.getSingleton().destroy(s),Ge(s,(g,m,w)=>{vt(g)?w[m]=Fe(m):m!=="guid"&&(w[m]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,c=null,L=null,h=null,s=null};function Fe(g){return()=>{throw new Error(`The "${g}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getPlugin=function(g){const m=En(g);return m==="UndoRedo"?this.undoRedo:T.getItem(m)},this.getPluginName=function(g){return g===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:T.getId(g)},this.getInstance=function(){return s},this.addHook=function(g,m){fe.getSingleton().add(g,m,s)},this.hasHook=function(g){return fe.getSingleton().has(g,s)||fe.getSingleton().has(g)},this.addHookOnce=function(g,m){fe.getSingleton().once(g,m,s)},this.removeHook=function(g,m){fe.getSingleton().remove(g,m,s)},this.runHooks=function(g,m,w,P,I,N,j){return fe.getSingleton().run(s,g,m,w,P,I,N,j)},this.getTranslatedPhrase=function(g,m){return tH(y.language,g,m)},this.toHTML=()=>Pv(this),this.toTableElement=()=>{const g=this.rootDocument.createElement("div");return g.insertAdjacentHTML("afterbegin",Pv(this)),g.firstElementChild},this.timeouts=[],this._registerTimeout=function(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,w=g;typeof w=="function"&&(w=setTimeout(w,m)),this.timeouts.push(w)},this._clearTimeouts=function(){E(this.timeouts,g=>{clearTimeout(g)})},this.immediates=[],this._registerImmediate=function(g){this.immediates.push(setImmediate(g))},this._clearImmediates=function(){E(this.immediates,g=>{clearImmediate(g)})},this._refreshBorders=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.destroyEditor(g),s.view.render(),m&&L.isSelected()&&h.prepareEditor()},this._getEditorManager=function(){return h},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const we=X6({handleEvent(){return s.isListening()},beforeKeyDown:g=>this.runHooks("beforeKeyDown",g),afterKeyDown:g=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",g)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",g=>{g.ctrlKey===!1&&g.metaKey===!1&&we.releasePressedKeys()}),this.getShortcutManager=function(){return we},this.getFocusManager=function(){return d},xS().forEach(g=>{const m=Qc(g);T.addItem(g,new m(this))}),F6(s),we.setActiveContextName("grid"),fe.getSingleton().run(s,"construct")}const q6="hooksRefRegisterer",SH={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){E(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ge(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};Bi(SH,"MIXIN_NAME",q6,{writable:!1,enumerable:!1});const Z6=SH;function Gr(t,e,n){return e=Q6(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q6(t){var e=J6(t,"string");return typeof e=="symbol"?e:String(e)}function J6(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const e9="base",qt=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),Kv="baseEditor";class ql{static get EDITOR_TYPE(){return e9}constructor(e){Gr(this,"hot",void 0),Gr(this,"state",qt.VIRGIN),Gr(this,"_opened",!1),Gr(this,"_fullEditMode",!1),Gr(this,"_closeCallback",null),Gr(this,"TD",null),Gr(this,"row",null),Gr(this,"col",null),Gr(this,"prop",null),Gr(this,"originalValue",null),Gr(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=qt.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){const h=this.hot.getSelectedLast();r=Math.max(Math.min(h[0],h[2]),0),i=Math.max(Math.min(h[1],h[3]),0),o=Math.max(h[0],h[2]),s=Math.max(h[1],h[3])}else[r,i,o,s]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);const u=this.hot.getShortcutManager().getContext("editor"),c={runOnlyIf:()=>ue(this.hot.getSelected()),group:Kv};this.isInFullEditMode()&&u.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],c),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==qt.VIRGIN)return;const r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=qt.EDITING,this.isInFullEditMode()){const s=typeof e=="string"?e:Wt(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){const a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;const s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(Kv),s.removeShortcutsByGroup(Fg),this.state===qt.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===qt.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=qt.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=qt.FINISHED,this.discardEditor(l)}):(this.state=qt.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=qt.FINISHED,this.discardEditor()}discardEditor(e){this.state===qt.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=qt.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=qt.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===qt.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=en(n),a=ft(n),l=en(this.hot.rootElement),u=ft(this.hot.rootElement),c=r.topOverlay.holder,h=r.inlineStartOverlay.holder,d=c!==o?c.scrollTop:0,f=h!==o?h.scrollLeft:0,p=o.innerWidth-l.left-u,{wtTable:v}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,S=v.name,y=["master","inline_start"].includes(S)?d:0,R=["master","top","bottom"].includes(S)?f:0,T=s.top===l.top?0:1;let A=s.top-l.top-T-y,M=0;this.hot.isRtl()?M=o.innerWidth-s.left-a-p-1+R:M=s.left-l.left-1-R,["top","top_inline_start_corner"].includes(S)&&(A+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(S)&&(M+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const L=this.hot.hasColHeaders(),B=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),K=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(L&&B<=0||B===G)&&(A+=1),K<=0&&(M+=1);const Q=i.rowsRenderCalculator.startPosition,re=i.columnsRenderCalculator.startPosition,ne=Math.abs(r.inlineStartOverlay.getScrollPosition()),ce=r.topOverlay.getScrollPosition(),be=nn(this.hot.rootDocument);let qe=n.offsetTop;if(["inline_start","master"].includes(S)&&(qe+=Q-ce),["bottom","bottom_inline_start_corner"].includes(S)){const{wtViewport:J,wtTable:X}=r.bottomOverlay.clone;qe+=J.getWorkspaceHeight()-X.getHeight()-be}let Fe=n.offsetLeft;this.hot.isRtl()?(Fe>=0?Fe=v.getWidth()-n.offsetLeft:Fe=Math.abs(Fe),Fe+=re-ne-a):["top","master","bottom"].includes(S)&&(Fe+=re-ne);const we=bo(this.TD,this.hot.rootWindow),g=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",m=parseInt(we[g],10)>0?0:1,w=parseInt(we.borderTopWidth,10)>0?0:1,P=ft(n)+m,I=xt(n)+w,N=Ax(c)?be:0,j=Ox(h)?be:0,Y=this.hot.view.maximumVisibleElementWidth(Fe)-N+m,oe=Math.max(this.hot.view.maximumVisibleElementHeight(qe)-j+w,23);return{top:A,start:M,height:I,maxHeight:oe,width:P,maxWidth:Y}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}pt(ql,Z6);function zE(t,e,n){t.addEventListener(e,n,!1)}function YE(t,e,n){t.removeEventListener(e,n,!1)}function jE(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function t9(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span");let o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=jE(o).fontSize,i.style.fontFamily=jE(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);const c=i.clientWidth+2;n.removeChild(i);const h=o.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){t.defaultView.setTimeout(s,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=o.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=o.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=c,l(h),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),d&&(zE(o,"input",s),zE(o,"keydown",a)),s()}return{init:u,resize:s,unObserve(){YE(o,"input",s),YE(o,"keydown",a)}}}function KE(t,e){const n=wS(e),r=e.value.split(`
`);let i=n,o=0;for(let s=0;s<r.length;s++){const a=r[s];s!==0&&(o+=r[s-1].length+1);const l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}Kc(e,i)}function Ls(t,e,n){return e=n9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n9(t){var e=r9(t,"string");return typeof e=="symbol"?e:String(e)}function r9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const i9="ht_editor_visible",Kh="ht_editor_hidden",XE="textEditor",o9="text";class _a extends ql{static get EDITOR_TYPE(){return o9}constructor(e){super(e),Ls(this,"eventManager",new Dr(this)),Ls(this,"autoResize",t9(this.hot.rootDocument)),Ls(this,"TEXTAREA",void 0),Ls(this,"textareaStyle",void 0),Ls(this,"TEXTAREA_PARENT",void 0),Ls(this,"textareaParentStyle",void 0),Ls(this,"layerClass",void 0),this.eventManager=new Dr(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),yx(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){const a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==qt.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===qt.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Kc(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Te(this.TEXTAREA,[["data-hot-input",""],Yl(-1)]),this.hot.getSettings().ariaTags&&Te(this.TEXTAREA,[Ao()]),Z(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Z(this.TEXTAREA_PARENT,"handsontableInputHolder"),Pe(this.TEXTAREA_PARENT,this.layerClass)&&Le(this.TEXTAREA_PARENT,this.layerClass),Z(this.TEXTAREA_PARENT,Kh),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){zx()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Le(this.TEXTAREA_PARENT,this.layerClass),Z(this.TEXTAREA_PARENT,Kh)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;pe(e.length-1,r=>{const i=e[r];if(Pe(i,"handsontableEditor"))return n=!0,!1}),Pe(this.TEXTAREA_PARENT,Kh)&&Le(this.TEXTAREA_PARENT,Kh),n?(this.layerClass=i9,Z(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Z(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==qt.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const l=bo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=bo(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-c,f=s-h,p=o-c,v=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,p),minHeight:Math.min(f,v),maxWidth:p,maxHeight:v},!0)}bindEvents(){TS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===qt.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===qt.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>ue(this.hot.getSelected()),group:XE},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;KE(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;KE(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(Fg),n.removeShortcutsByGroup(XE),n.removeShortcutsByGroup(Kv)}}const s9="base";function rh(t,e,n,r,i,o,s){const a=s.ariaTags,l=[],u=[],c=[],h=[];s.className&&Z(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&h.push(I0())):a&&c.push(I0()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&h.push(x0())):(u.push(s.invalidCellClassName),a&&c.push(x0()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),Le(e,u),Z(e,l),Ra(e,c),Te(e,h)}rh.RENDERER_TYPE=s9;const a9="text";function xo(t,e,n,r,i,o,s){rh.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Wt(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){li(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else ms(e,a)}xo.RENDERER_TYPE=a9;const l9="text",yH={CELL_TYPE:l9,editor:_a,renderer:xo};Er(yH);Ae.editors={BaseEditor:ql};function Ae(t,e){const n=new CH(t,e||{},ZS);return n.init(),n}Ae.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new CH(t,e,ZS)};Ae.DefaultSettings=dH();Ae.hooks=fe.getSingleton();Ae.CellCoords=xf;Ae.CellRange=NS;Ae.packageName="handsontable";Ae.buildDate="16/01/2024 09:37:55";Ae.version="14.1.0";Ae.languages={dictionaryKeys:_4,getLanguageDictionary:eH,getLanguagesDictionaries:I4,registerLanguageDictionary:J1,getTranslatedPhrase:tH};const qE="handsontableEditor",u9="handsontable";class xb extends _a{static get EDITOR_TYPE(){return u9}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Kc(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&jt(l,s.handsontable),this.htOptions=l}beginEditing(e,n){const r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const r={group:qE,relativeToGroup:Fg,position:"before"},i=(o,s)=>{const a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),kr(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const s=this.htEditor;let a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const s=this.htEditor;let a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){const u=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(qE)}}function c9(t,e,n){h9(t,e),e.set(t,n)}function h9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xh(t,e,n){return e=d9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d9(t){var e=f9(t,"string");return typeof e=="symbol"?e:String(e)}function f9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZE(t,e){var n=g9(t,e,"get");return m9(t,n)}function g9(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function m9(t,e){return e.get?e.get.call(t):e.value}const p9="autocomplete";var Ep=new WeakMap;class Hb extends xb{constructor(){super(...arguments),Xh(this,"query",null),Xh(this,"strippedChoices",[]),Xh(this,"rawChoices",[]),c9(this,Ep,{writable:!0,value:this.hot.guid.slice(0,9)}),Xh(this,"sortByRelevance",function(e,n,r){const i=[],o=[],s=e.length;let a=n.length,l,u,c,h;if(s===0){for(c=0;c<a;c++)o.push(c);return o}for(c=0;c<a;c++){if(u=Ev(Wt(n[c])),r)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-s,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)o.push(i[c].baseIndex);return o})}static get EDITOR_TYPE(){return p9}getValue(){const e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return ue(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Z(this.htContainer,"autocompleteEditor"),Z(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Te(this.TEXTAREA,[Cz(),gz(),wx("listbox"),Ez()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&Te(this.TEXTAREA,[xr("false"),Tz(`${ZE(this,Ep)}-listbox-${e}-${n}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r==null?void 0:r.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=nn();a===0&&Pc()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[ft(this.TEXTAREA)-2]:void 0,width:e?ft(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,d,f,p)=>{xo(l,u,c,h,d,f,p);const{filteringCaseSensitive:v,allowHtml:S,locale:y}=this.cellProperties,R=this.query;let T=Wt(f),A,M;T&&!S&&(A=v===!0?T.indexOf(R):T.toLocaleLowerCase(y).indexOf(R.toLocaleLowerCase(y)),A!==-1&&(M=T.substr(A,R.length),T=T.replace(M,`<strong>${M}</strong>`))),n&&Te(u,[mz(),...r?[Oz(i)]:[],...r?[Pz(r.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=T},afterSelection:(l,u)=>{if(n){const c=this.htEditor.getCell(l,u,!0);Te(c,[dS()]),Te(this.TEXTAREA,..._z(c.id))}}}),n&&(Te(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Di()),Te(this.htEditor.rootElement,[px(),Mz("polite"),Az("text"),["id",`${ZE(this,Ep)}-listbox-${o}-${s}`]]),Te(this.TEXTAREA,...xr("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Te(this.TEXTAREA,[xr("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=wS(this.TEXTAREA),r=Mx(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(s)?s.length:0;if(o===!1)u&&(a=s[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[s[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,this.htEditor.loadData(rc([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),Kc(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){const e=ga(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;const i=en(this.TEXTAREA),o=xt(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=xt(this.hot.view._wt.wtTable.THEAD),u=en(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-o,d=s>h&&c>h;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,s),d}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){const n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){const e=this.htEditor.getColWidth(0)+nn(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,r=Ue(e,o=>Wt(o));return Ue(r,o=>n?o:Ev(o))}allowKeyEventPropagation(e){const n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1};let i=!1;return e===ve.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===ve.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(Yx(e.keyCode)||e.keyCode===ve.BACKSPACE||e.keyCode===ve.DELETE||e.keyCode===ve.INSERT){let n=10;if(e.keyCode===ve.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}const w9="checkbox";class bH extends ql{static get EDITOR_TYPE(){return w9}beginEditing(e,n){if(n&&n.type==="mouseup"){const r=this.TD.querySelector('input[type="checkbox"]');Pe(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const os=()=>window,Or=()=>window.document,Xv=(t,e)=>window.setTimeout(t,e),Ti=function(t,e,n,r){t.addEventListener(e,n,!!r)},Zi=function(t,e,n,r){t.removeEventListener(e,n,!!r)},v9=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},ur=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Tp=function(t,e){ur(t,e)||(t.className=t.className===""?e:t.className+" "+e)},_p=function(t,e){t.className=v9((" "+t.className+" ").replace(" "+e+" "," "))},Db=function(t){return/Array/.test(Object.prototype.toString.call(t))},hr=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},C9=function(t){let e=t.getDay();return e===0||e===6},S9=function(t){return t%4===0&&t%100!==0||t%400===0},QE=function(t,e){return[31,S9(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},qh=function(t){hr(t)&&t.setHours(0,0,0,0)},Zh=function(t,e){return t.getTime()===e.getTime()},$f=function(t,e,n){let r,i;for(r in e)i=t[r]!==void 0,i&&typeof e[r]=="object"&&e[r]!==null&&e[r].nodeName===void 0?hr(e[r])?n&&(t[r]=new Date(e[r].getTime())):Db(e[r])?n&&(t[r]=e[r].slice(0)):t[r]=$f({},e[r],n):(n||!i)&&(t[r]=e[r]);return t},JE=function(t,e,n){let r=Or().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=$f(r,n),t.dispatchEvent(r)},eT=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},pi={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},tT=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},y9=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},b9=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),r=t.getDay(),i=e,o=i-1,s=7,a=function(d){return(d+s-1)%s};t.setDate(n+o-a(r));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-o+a(l.getDay()))/s)},R9=function(t,e,n,r,i){let o=new Date(r,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():b9(o,i))+"</td>"},E9=function(t,e,n,r){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(r?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},T9=function(t){return"<tbody>"+t.join("")+"</tbody>"},_9=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+tT(t,e)+'">'+tT(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},M9=function(t,e,n,r,i,o){let s,a,l,u=t._o,c=n===u.minYear,h=n===u.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',f,p,v=!0,S=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(c&&s<u.minMonth||h&&s>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[s]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",Db(u.yearRange)?(s=u.yearRange[0],a=u.yearRange[1]+1):(s=n-u.yearRange,a=1+n+u.yearRange),l=[];s<a&&s<=u.maxYear;s++)s>=u.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return p='<div class="pika-label">'+n+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=p+f:d+=f+p,c&&(r===0||u.minMonth>=r)&&(v=!1),h&&(r===11||u.maxMonth<=r)&&(S=!1),e===0&&(d+='<button class="pika-prev'+(v?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(S?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},A9=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+_9(t)+T9(e)+"</table>"};function qv(t){let e=this,n=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||os().event;let o=i.target||i.srcElement;if(o)if(ur(o,"is-disabled")||(ur(o,"pika-button")&&!ur(o,"is-empty")&&!ur(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&Xv(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):ur(o,"pika-prev")?e.prevMonth():ur(o,"pika-next")&&e.nextMonth()),ur(o,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||os().event;let o=i.target||i.srcElement;o&&(ur(o,"pika-select-month")?e.gotoMonth(o.value):ur(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(i){if(i=i||os().event,e.isVisible())switch(i.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let i=this.moment(n.field.value,n.format,n.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(i){let o;i.firedBy!==e&&(o=e._parseFieldValue(),hr(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Or().activeElement;do if(ur(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=Xv(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||os().event;let o=i.target||i.srcElement,s=o;if(o){!hasEventListeners&&ur(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Ti(o,"change",e._onChange)));do if(ur(s,"pika-single")||s===n.trigger)return;while(s=s.parentNode);e._v&&o!==n.trigger&&s!==n.trigger&&e.hide()}},e.el=Or().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Ti(e.el,"mousedown",e._onMouseDown,!0),Ti(e.el,"touchend",e._onMouseDown,!0),Ti(e.el,"change",e._onChange),n.keyboardInput&&Ti(Or(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Or().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Ti(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let r=n.defaultDate;hr(r)?n.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Ti(n.trigger,"click",e._onInputClick),Ti(n.trigger,"focus",e._onInputFocus),Ti(n.trigger,"blur",e._onInputBlur)):this.show()}qv.prototype={config:function(t){this._o||(this._o=$f({},pi,!0));let e=$f(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,hr(e.minDate)||(e.minDate=!1),hr(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),Db(e.yearRange)){let r=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||r,e.yearRange[1]=parseInt(e.yearRange[1],10)||r}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||pi.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,hr(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return hr(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",JE(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!hr(t))return;let n=this._o.minDate,r=this._o.maxDate;hr(n)&&t<n?t=n:hr(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),qh(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),JE(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(hr(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=i<n.getTime()||r.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,r=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(n.valueOf()+r):t==="subtract"&&(i=new Date(n.valueOf()-r)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=eT(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=eT({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(qh(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=pi.minDate,this._o.minYear=pi.minYear,this._o.minMonth=pi.minMonth,this._o.startRange=pi.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(qh(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=pi.maxDate,this._o.maxYear=pi.maxYear,this._o.maxMonth=pi.maxMonth,this._o.endRange=pi.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,r=e.maxYear,i=e.minMonth,o=e.maxMonth,s="",a;this._y<=n&&(this._y=n,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+M9(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=s,e.bound&&e.field.type!=="hidden"&&Xv(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,r,i,o,s,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,r=os().innerWidth||Or().documentElement.clientWidth,i=os().innerHeight||Or().documentElement.clientHeight,o=Or().body.scrollTop||Or().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),s=l.left+os().pageXOffset,a=l.bottom+os().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,u=!1),(this._o.reposition&&a+n>i+o||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,c=!1),s<0&&(s=0),a<0&&(a=0),this.el.style.left=s+"px",this.el.style.top=a+"px",Tp(this.el,u?"left-aligned":"right-aligned"),Tp(this.el,c?"bottom-aligned":"top-aligned"),_p(this.el,u?"right-aligned":"left-aligned"),_p(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let r=this._o,i=new Date,o=QE(t,e),s=new Date(t,e,1).getDay(),a=[],l=[];qh(i),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=QE(h,u),p=o+s,v=p;for(;v>7;)v-=7;p+=7-v;let S=!1;for(let y=0,R=0;y<p;y++){let T=new Date(t,e,1+(y-s)),A=hr(this._d)?Zh(T,this._d):!1,M=Zh(T,i),L=r.events.indexOf(T.toDateString())!==-1,B=y<s||y>=o+s,K=1+(y-s),U=e,G=t,Q=r.startRange&&Zh(r.startRange,T),re=r.endRange&&Zh(r.endRange,T),ne=r.startRange&&r.endRange&&r.startRange<T&&T<r.endRange,ce=r.minDate&&T<r.minDate||r.maxDate&&T>r.maxDate||r.disableWeekends&&C9(T)||r.disableDayFn&&r.disableDayFn(T);B&&(y<s?(K=f+K,U=u,G=h):(K=K-o,U=c,G=d));let be={day:K,month:U,year:G,hasEvent:L,isSelected:A,isToday:M,isDisabled:ce,isEmpty:B,isStartRange:Q,isEndRange:re,isInRange:ne,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:r.enableSelectionDaysInNextAndPreviousMonths};r.pickWholeWeek&&A&&(S=!0),l.push(y9(be)),++R===7&&(r.showWeekNumber&&l.unshift(R9(this,y-s,e,t,r.firstWeekOfYearMinDays)),a.push(E9(l,r.isRTL,r.pickWholeWeek,S)),l=[],R=0,S=!1)}return A9(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),_p(this.el,"is-hidden"),this._o.bound&&(Ti(Or(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Zi(Or(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Tp(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Zi(this.el,"mousedown",this._onMouseDown,!0),Zi(this.el,"touchend",this._onMouseDown,!0),Zi(this.el,"change",this._onChange),t.keyboardInput&&Zi(Or(),"keydown",this._onKeyChange),t.field&&(Zi(t.field,"change",this._onInputChange),t.bound&&(Zi(t.trigger,"click",this._onInputClick),Zi(t.trigger,"focus",this._onInputFocus),Zi(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Mp(t,e,n){return e=O9(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O9(t){var e=P9(t,"string");return typeof e=="symbol"?e:String(e)}function P9(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RH="date",nT="dateEditor";class EH extends _a{constructor(){super(...arguments),Mp(this,"defaultDateFormat","DD/MM/YYYY"),Mp(this,"parentDestroyed",!1),Mp(this,"$datePicker",null)}static get EDITOR_TYPE(){return RH}init(){if(typeof q!="function")throw new Error("You need to include moment.js to your project.");if(typeof qv!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Z(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Pe(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:nT})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(nT),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?MS(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new qv(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(q),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+xt(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-ft(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,q(s,r,!0).isValid()&&this.$datePicker.setMoment(q(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,q(s,r,!0).isValid()&&this.$datePicker.setMoment(q(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Zc(n,this.cellProperties.datePickerConfig);const r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.keyboardInput=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=q(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}}const I9="dropdown";class Nb extends Hb{static get EDITOR_TYPE(){return I9}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}fe.getSingleton().add("beforeValidate",function(t,e,n){const r=this.getCellMeta(e,this.propToCol(n));r.editor===Nb&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});const x9="numeric";class TH extends _a{static get EDITOR_TYPE(){return x9}}const H9="password";class _H extends _a{static get EDITOR_TYPE(){return H9}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Te(this.TEXTAREA,[Ao()]),li(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Ap="ht_editor_visible",rT="selectEditor",D9="select";class MH extends ql{static get EDITOR_TYPE(){return D9}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",Z(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Pe(this.select,Ap)&&Le(this.select,Ap),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),li(this.select),Ge(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Ea(h,u),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==qt.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",Z(this.select,Ap)}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={group:rT};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:r,callback:()=>{}},{keys:[["ArrowUp"]],callback:()=>{const o=this.select.selectedIndex-1;o>=0&&(this.select[o].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const o=this.select.selectedIndex+1;o<=this.select.length-1&&(this.select[o].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(rT)}}const N9="time";class AH extends _a{static get EDITOR_TYPE(){return N9}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}}function L9(){er(ql),er(Hb),er(bH),er(EH),er(Nb),er(xb),er(TH),er(_H),er(MH),er(_a),er(AH)}const $9="html";function Lb(t,e,n,r,i,o,s){rh.apply(this,[t,e,n,r,i,o,s]),Ea(e,o??"",!1)}Lb.RENDERER_TYPE=$9;const k9="autocomplete";function Zl(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=s.allowHtml?Lb:xo,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Ao()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),Z(e,"htAutocomplete"),!t.acArrowListener){const h=new Dr(t);t.acArrowListener=function(d){Pe(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Zl.RENDERER_TYPE=k9;const F9="dropdown";function $b(t,e,n,r,i,o,s){Zl.apply(this,[t,e,n,r,i,o,s])}$b.RENDERER_TYPE=F9;const iT=new WeakMap,oT=new WeakMap,W9="htBadValue",Wl="data-row",Vl="data-col",V9="checkboxRenderer",OH="checkbox";fe.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:r,type:i,row:o,column:s,prop:a}=e;if(i===OH){if(r){const{value:l,property:u}=r;let c=n;if(l)c=typeof l=="function"?l(o,s,a,n):l;else if(u){const h=this.getDataAtRowProp(o,u);c=h!==null?h:n}t=c}return t}});function kb(t,e,n,r,i,o,s){const{rootDocument:a}=t,l=t.getSettings().ariaTags;rh.apply(this,[t,e,n,r,i,o,s]),B9(t);let u=U9(a);const c=s.label;let h=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),li(e),o===s.checkedTemplate||Wt(o).toLocaleLowerCase(s.locale)===Wt(s.checkedTemplate).toLocaleLowerCase(s.locale)?u.checked=!0:o===s.uncheckedTemplate||Wt(o).toLocaleLowerCase(s.locale)===Wt(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?u.checked=!1:Zt(o)?Z(u,"noValue"):(u.style.display="none",Z(u,W9),h=!0),Te(u,[[Wl,n],[Vl,r]]),l&&Te(u,[cS(u.checked?t.getTranslatedPhrase(_b):t.getTranslatedPhrase(Mb)),Rz(u.checked),pz()]),!h&&c){let v="";if(c.value)v=typeof c.value=="function"?c.value.call(this,n,r,i,o):c.value;else if(c.property){const y=t.getDataAtRowProp(n,c.property);v=y!==null?y:""}const S=G9(a,v,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(S),e.appendChild(u)):(S.appendChild(u),u=S):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(S)):(S.insertBefore(u,S.firstChild),u=S))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),iT.has(t)||(iT.set(t,!0),d());function d(){const S=t.getShortcutManager().getContext("grid"),y={group:V9};S.addShortcuts([{keys:[["space"]],callback:()=>(f(),!p())},{keys:[["enter"]],callback:()=>(f(),!p()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!p()),relativeToGroup:Ib,position:"before"}],y)}function f(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const S=t.getSelectedRange();if(S)for(let y=0;y<S.length;y++){const{row:R,col:T}=S[y].getTopStartCorner(),{row:A,col:M}=S[y].getBottomEndCorner(),L=[];for(let B=R;B<=A;B+=1)for(let K=T;K<=M;K+=1){const U=t.getCellMeta(B,K);if(U.type!=="checkbox")return;if(U.readOnly===!0)continue;typeof U.checkedTemplate>"u"&&(U.checkedTemplate=!0),typeof U.uncheckedTemplate>"u"&&(U.uncheckedTemplate=!1);const G=t.getDataAtCell(B,K);v===!1?[U.checkedTemplate,U.checkedTemplate.toString()].includes(G)?L.push([B,K,U.uncheckedTemplate]):[U.uncheckedTemplate,U.uncheckedTemplate.toString(),null,void 0].includes(G)&&L.push([B,K,U.checkedTemplate]):L.push([B,K,U.uncheckedTemplate])}L.length>0&&t.setDataAtCell(L)}}function p(){const v=t.getSelectedRange();if(v){for(let S=0;S<v.length;S++){const y=v[S].getTopStartCorner(),R=v[S].getBottomEndCorner();for(let T=y.row;T<=R.row;T++)for(let A=y.col;A<=R.col;A++){const M=t.getCellMeta(T,A);if(M.type!=="checkbox")return!1;const L=t.getCell(T,A);if(L==null)return!0;if(L.querySelectorAll("input[type=checkbox]").length>0&&!M.readOnly)return!0}}return!1}}}kb.RENDERER_TYPE=OH;function B9(t){let e=oT.get(t);if(!e){const{rootElement:n}=t;e=new Dr(t),e.addEventListener(n,"click",r=>Y9(r,t)),e.addEventListener(n,"mouseup",r=>z9(r,t)),e.addEventListener(n,"change",r=>j9(r,t)),oT.set(t,e)}return e}function U9(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function G9(t,e,n){const r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function z9(t,e){const{target:n}=t;Fb(n)&&(!n.hasAttribute(Wl)||!n.hasAttribute(Vl)||setTimeout(e.listen,10))}function Y9(t,e){const{target:n}=t;if(!Fb(n)||!n.hasAttribute(Wl)||!n.hasAttribute(Vl))return;const r=parseInt(n.getAttribute(Wl),10),i=parseInt(n.getAttribute(Vl),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function j9(t,e){const{target:n}=t;if(!Fb(n)||!n.hasAttribute(Wl)||!n.hasAttribute(Vl))return;const r=parseInt(n.getAttribute(Wl),10),i=parseInt(n.getAttribute(Vl),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function Fb(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const K9="handsontable";function Wb(t,e,n,r,i,o,s){Zl.apply(this,[t,e,n,r,i,o,s])}Wb.RENDERER_TYPE=K9;function Qh(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var PH={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,o){function s(u,c){if(!i[u]){if(!r[u]){var h=typeof Qh=="function"&&Qh;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[u]={exports:{}};r[u][0].call(f.exports,function(p){return s(r[u][1][p]||p)},f,f.exports,n,r,i,o)}return i[u].exports}for(var a=typeof Qh=="function"&&Qh,l=0;l<o.length;l++)s(o[l]);return s}({1:[function(n,r,i){(function(o){var s,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,p=9007199254740991,v=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],S=1e7,y=1e9;function R(U){var G=0|U;return 0<U||U===G?G:G-1}function T(U){for(var G,Q,re=1,ne=U.length,ce=U[0]+"";re<ne;){for(G=U[re++]+"",Q=f-G.length;Q--;G="0"+G);ce+=G}for(ne=ce.length;ce.charCodeAt(--ne)===48;);return ce.slice(0,ne+1||1)}function A(U,G){var Q,re,ne=U.c,ce=G.c,be=U.s,qe=G.s,Fe=U.e,we=G.e;if(!be||!qe)return null;if(Q=ne&&!ne[0],re=ce&&!ce[0],Q||re)return Q?re?0:-qe:be;if(be!=qe)return be;if(Q=be<0,re=Fe==we,!ne||!ce)return re?0:!ne^Q?1:-1;if(!re)return we<Fe^Q?1:-1;for(qe=(Fe=ne.length)<(we=ce.length)?Fe:we,be=0;be<qe;be++)if(ne[be]!=ce[be])return ne[be]>ce[be]^Q?1:-1;return Fe==we?0:we<Fe^Q?1:-1}function M(U,G,Q,re){if(U<G||Q<U||U!==(U<0?l(U):u(U)))throw Error(c+(re||"Argument")+(typeof U=="number"?U<G||Q<U?" out of range: ":" not an integer: ":" not a primitive number: ")+String(U))}function L(U){var G=U.c.length-1;return R(U.e/f)==G&&U.c[G]%2!=0}function B(U,G){return(1<U.length?U.charAt(0)+"."+U.slice(1):U)+(G<0?"e":"e+")+G}function K(U,G,Q){var re,ne;if(G<0){for(ne=Q+".";++G;ne+=Q);U=ne+U}else if(++G>(re=U.length)){for(ne=Q,G-=re;--G;ne+=Q);U+=ne}else G<re&&(U=U.slice(0,G)+"."+U.slice(G));return U}(s=function U(G){var Q,re,ne,ce,be,qe,Fe,we,g,m,w=z.prototype={constructor:z,toString:null,valueOf:null},P=new z(1),I=20,N=4,j=-7,Y=21,oe=-1e7,J=1e7,X=!1,Se=1,Ie=0,Oe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},He="0123456789abcdefghijklmnopqrstuvwxyz";function z(C,b){var _,F,O,k,x,D,W,$,V=this;if(!(V instanceof z))return new z(C,b);if(b==null){if(C instanceof z)return V.s=C.s,V.e=C.e,void(V.c=(C=C.c)?C.slice():C);if((D=typeof C=="number")&&0*C==0){if(V.s=1/C<0?(C=-C,-1):1,C===~~C){for(k=0,x=C;10<=x;x/=10,k++);return V.e=k,void(V.c=[C])}$=String(C)}else{if($=String(C),!a.test($))return ne(V,$,D);V.s=$.charCodeAt(0)==45?($=$.slice(1),-1):1}-1<(k=$.indexOf("."))&&($=$.replace(".","")),0<(x=$.search(/e/i))?(k<0&&(k=x),k+=+$.slice(x+1),$=$.substring(0,x)):k<0&&(k=$.length)}else{if(M(b,2,He.length,"Base"),$=String(C),b==10)return De(V=new z(C instanceof z?C:$),I+V.e+1,N);if(D=typeof C=="number"){if(0*C!=0)return ne(V,$,D,b);if(V.s=1/C<0?($=$.slice(1),-1):1,z.DEBUG&&15<$.replace(/^0\.0*|\./,"").length)throw Error(h+C);D=!1}else V.s=$.charCodeAt(0)===45?($=$.slice(1),-1):1;for(_=He.slice(0,b),k=x=0,W=$.length;x<W;x++)if(_.indexOf(F=$.charAt(x))<0){if(F=="."){if(k<x){k=W;continue}}else if(!O&&($==$.toUpperCase()&&($=$.toLowerCase())||$==$.toLowerCase()&&($=$.toUpperCase()))){O=!0,x=-1,k=0;continue}return ne(V,String(C),D,b)}-1<(k=($=re($,b,10,V.s)).indexOf("."))?$=$.replace(".",""):k=$.length}for(x=0;$.charCodeAt(x)===48;x++);for(W=$.length;$.charCodeAt(--W)===48;);if($=$.slice(x,++W)){if(W-=x,D&&z.DEBUG&&15<W&&(p<C||C!==u(C)))throw Error(h+V.s*C);if(J<(k=k-x-1))V.c=V.e=null;else if(k<oe)V.c=[V.e=0];else{if(V.e=k,V.c=[],x=(k+1)%f,k<0&&(x+=f),x<W){for(x&&V.c.push(+$.slice(0,x)),W-=f;x<W;)V.c.push(+$.slice(x,x+=f));$=$.slice(x),x=f-$.length}else x-=W;for(;x--;$+="0");V.c.push(+$)}}else V.c=[V.e=0]}function lt(C,b,_,F){var O,k,x,D,W;if(_==null?_=N:M(_,0,8),!C.c)return C.toString();if(O=C.c[0],x=C.e,b==null)W=T(C.c),W=F==1||F==2&&(x<=j||Y<=x)?B(W,x):K(W,x,"0");else if(k=(C=De(new z(C),b,_)).e,D=(W=T(C.c)).length,F==1||F==2&&(b<=k||k<=j)){for(;D<b;W+="0",D++);W=B(W,k)}else if(b-=x,W=K(W,k,"0"),D<k+1){if(0<--b)for(W+=".";b--;W+="0");}else if(0<(b+=k-D))for(k+1==D&&(W+=".");b--;W+="0");return C.s<0&&O?"-"+W:W}function Be(C,b){for(var _,F=1,O=new z(C[0]);F<C.length;F++){if(!(_=new z(C[F])).s){O=_;break}b.call(O,_)&&(O=_)}return O}function xe(C,b,_){for(var F=1,O=b.length;!b[--O];b.pop());for(O=b[0];10<=O;O/=10,F++);return(_=F+_*f-1)>J?C.c=C.e=null:C.c=_<oe?[C.e=0]:(C.e=_,b),C}function De(C,b,_,F){var O,k,x,D,W,$,V,ie=C.c,de=v;if(ie){e:{for(O=1,D=ie[0];10<=D;D/=10,O++);if((k=b-O)<0)k+=f,x=b,V=(W=ie[$=0])/de[O-x-1]%10|0;else if(($=l((k+1)/f))>=ie.length){if(!F)break e;for(;ie.length<=$;ie.push(0));W=V=0,x=(k%=f)-f+(O=1)}else{for(W=D=ie[$],O=1;10<=D;D/=10,O++);V=(x=(k%=f)-f+O)<0?0:W/de[O-x-1]%10|0}if(F=F||b<0||ie[$+1]!=null||(x<0?W:W%de[O-x-1]),F=_<4?(V||F)&&(_==0||_==(C.s<0?3:2)):5<V||V==5&&(_==4||F||_==6&&(0<k?0<x?W/de[O-x]:0:ie[$-1])%10&1||_==(C.s<0?8:7)),b<1||!ie[0])return ie.length=0,F?(b-=C.e+1,ie[0]=de[(f-b%f)%f],C.e=-b||0):ie[0]=C.e=0,C;if(k==0?(ie.length=$,D=1,$--):(ie.length=$+1,D=de[f-k],ie[$]=0<x?u(W/de[O-x]%de[x])*D:0),F)for(;;){if($==0){for(k=1,x=ie[0];10<=x;x/=10,k++);for(x=ie[0]+=D,D=1;10<=x;x/=10,D++);k!=D&&(C.e++,ie[0]==d&&(ie[0]=1));break}if(ie[$]+=D,ie[$]!=d)break;ie[$--]=0,D=1}for(k=ie.length;ie[--k]===0;ie.pop());}C.e>J?C.c=C.e=null:C.e<oe&&(C.c=[C.e=0])}return C}function Re(C){var b,_=C.e;return _===null?C.toString():(b=T(C.c),b=_<=j||Y<=_?B(b,_):K(b,_,"0"),C.s<0?"-"+b:b)}return z.clone=U,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(C){var b,_;if(C!=null){if(typeof C!="object")throw Error(c+"Object expected: "+C);if(C.hasOwnProperty(b="DECIMAL_PLACES")&&(M(_=C[b],0,y,b),I=_),C.hasOwnProperty(b="ROUNDING_MODE")&&(M(_=C[b],0,8,b),N=_),C.hasOwnProperty(b="EXPONENTIAL_AT")&&((_=C[b])&&_.pop?(M(_[0],-y,0,b),M(_[1],0,y,b),j=_[0],Y=_[1]):(M(_,-y,y,b),j=-(Y=_<0?-_:_))),C.hasOwnProperty(b="RANGE"))if((_=C[b])&&_.pop)M(_[0],-y,-1,b),M(_[1],1,y,b),oe=_[0],J=_[1];else{if(M(_,-y,y,b),!_)throw Error(c+b+" cannot be zero: "+_);oe=-(J=_<0?-_:_)}if(C.hasOwnProperty(b="CRYPTO")){if((_=C[b])!==!!_)throw Error(c+b+" not true or false: "+_);if(_){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw X=!_,Error(c+"crypto unavailable");X=_}else X=_}if(C.hasOwnProperty(b="MODULO_MODE")&&(M(_=C[b],0,9,b),Se=_),C.hasOwnProperty(b="POW_PRECISION")&&(M(_=C[b],0,y,b),Ie=_),C.hasOwnProperty(b="FORMAT")){if(typeof(_=C[b])!="object")throw Error(c+b+" not an object: "+_);Oe=_}if(C.hasOwnProperty(b="ALPHABET")){if(typeof(_=C[b])!="string"||/^.$|[+-.\s]|(.).*\1/.test(_))throw Error(c+b+" invalid: "+_);He=_}}return{DECIMAL_PLACES:I,ROUNDING_MODE:N,EXPONENTIAL_AT:[j,Y],RANGE:[oe,J],CRYPTO:X,MODULO_MODE:Se,POW_PRECISION:Ie,FORMAT:Oe,ALPHABET:He}},z.isBigNumber=function(C){return C instanceof z||C&&C._isBigNumber===!0||!1},z.maximum=z.max=function(){return Be(arguments,w.lt)},z.minimum=z.min=function(){return Be(arguments,w.gt)},z.random=(ce=9007199254740992,be=Math.random()*ce&2097151?function(){return u(Math.random()*ce)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(C){var b,_,F,O,k,x=0,D=[],W=new z(P);if(C==null?C=I:M(C,0,y),O=l(C/f),X)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(O*=2));x<O;)9e15<=(k=131072*b[x]+(b[x+1]>>>11))?(_=crypto.getRandomValues(new Uint32Array(2)),b[x]=_[0],b[x+1]=_[1]):(D.push(k%1e14),x+=2);x=O/2}else{if(!crypto.randomBytes)throw X=!1,Error(c+"crypto unavailable");for(b=crypto.randomBytes(O*=7);x<O;)9e15<=(k=281474976710656*(31&b[x])+1099511627776*b[x+1]+4294967296*b[x+2]+16777216*b[x+3]+(b[x+4]<<16)+(b[x+5]<<8)+b[x+6])?crypto.randomBytes(7).copy(b,x):(D.push(k%1e14),x+=7);x=O/7}if(!X)for(;x<O;)(k=be())<9e15&&(D[x++]=k%1e14);for(O=D[--x],C%=f,O&&C&&(k=v[f-C],D[x]=u(O/k)*k);D[x]===0;D.pop(),x--);if(x<0)D=[F=0];else{for(F=-1;D[0]===0;D.splice(0,1),F-=f);for(x=1,k=D[0];10<=k;k/=10,x++);x<f&&(F-=f-x)}return W.e=F,W.c=D,W}),z.sum=function(){for(var C=1,b=arguments,_=new z(b[0]);C<b.length;)_=_.plus(b[C++]);return _},re=function(){var C="0123456789";function b(_,F,O,k){for(var x,D,W=[0],$=0,V=_.length;$<V;){for(D=W.length;D--;W[D]*=F);for(W[0]+=k.indexOf(_.charAt($++)),x=0;x<W.length;x++)W[x]>O-1&&(W[x+1]==null&&(W[x+1]=0),W[x+1]+=W[x]/O|0,W[x]%=O)}return W.reverse()}return function(_,F,O,k,x){var D,W,$,V,ie,de,ye,Me,We=_.indexOf("."),St=I,Ze=N;for(0<=We&&(V=Ie,Ie=0,_=_.replace(".",""),de=(Me=new z(F)).pow(_.length-We),Ie=V,Me.c=b(K(T(de.c),de.e,"0"),10,O,C),Me.e=Me.c.length),$=V=(ye=b(_,F,O,x?(D=He,C):(D=C,He))).length;ye[--V]==0;ye.pop());if(!ye[0])return D.charAt(0);if(We<0?--$:(de.c=ye,de.e=$,de.s=k,ye=(de=Q(de,Me,St,Ze,O)).c,ie=de.r,$=de.e),We=ye[W=$+St+1],V=O/2,ie=ie||W<0||ye[W+1]!=null,ie=Ze<4?(We!=null||ie)&&(Ze==0||Ze==(de.s<0?3:2)):V<We||We==V&&(Ze==4||ie||Ze==6&&1&ye[W-1]||Ze==(de.s<0?8:7)),W<1||!ye[0])_=ie?K(D.charAt(1),-St,D.charAt(0)):D.charAt(0);else{if(ye.length=W,ie)for(--O;++ye[--W]>O;)ye[W]=0,W||(++$,ye=[1].concat(ye));for(V=ye.length;!ye[--V];);for(We=0,_="";We<=V;_+=D.charAt(ye[We++]));_=K(_,$,D.charAt(0))}return _}}(),Q=function(){function C(F,O,k){var x,D,W,$,V=0,ie=F.length,de=O%S,ye=O/S|0;for(F=F.slice();ie--;)V=((D=de*(W=F[ie]%S)+(x=ye*W+($=F[ie]/S|0)*de)%S*S+V)/k|0)+(x/S|0)+ye*$,F[ie]=D%k;return V&&(F=[V].concat(F)),F}function b(F,O,k,x){var D,W;if(k!=x)W=x<k?1:-1;else for(D=W=0;D<k;D++)if(F[D]!=O[D]){W=F[D]>O[D]?1:-1;break}return W}function _(F,O,k,x){for(var D=0;k--;)F[k]-=D,D=F[k]<O[k]?1:0,F[k]=D*x+F[k]-O[k];for(;!F[0]&&1<F.length;F.splice(0,1));}return function(F,O,k,x,D){var W,$,V,ie,de,ye,Me,We,St,Ze,ct,_t,Pa,eu,Bt,cn,_s,Pn=F.s==O.s?1:-1,Qt=F.c,yt=O.c;if(!(Qt&&Qt[0]&&yt&&yt[0]))return new z(F.s&&O.s&&(Qt?!yt||Qt[0]!=yt[0]:yt)?Qt&&Qt[0]==0||!yt?0*Pn:Pn/0:NaN);for(St=(We=new z(Pn)).c=[],Pn=k+($=F.e-O.e)+1,D||(D=d,$=R(F.e/f)-R(O.e/f),Pn=Pn/f|0),V=0;yt[V]==(Qt[V]||0);V++);if(yt[V]>(Qt[V]||0)&&$--,Pn<0)St.push(1),ie=!0;else{for(eu=Qt.length,cn=yt.length,Pn+=2,1<(de=u(D/(yt[V=0]+1)))&&(yt=C(yt,de,D),Qt=C(Qt,de,D),cn=yt.length,eu=Qt.length),Pa=cn,ct=(Ze=Qt.slice(0,cn)).length;ct<cn;Ze[ct++]=0);_s=yt.slice(),_s=[0].concat(_s),Bt=yt[0],yt[1]>=D/2&&Bt++;do{if(de=0,(W=b(yt,Ze,cn,ct))<0){if(_t=Ze[0],cn!=ct&&(_t=_t*D+(Ze[1]||0)),1<(de=u(_t/Bt)))for(D<=de&&(de=D-1),Me=(ye=C(yt,de,D)).length,ct=Ze.length;b(ye,Ze,Me,ct)==1;)de--,_(ye,cn<Me?_s:yt,Me,D),Me=ye.length,W=1;else de==0&&(W=de=1),Me=(ye=yt.slice()).length;if(Me<ct&&(ye=[0].concat(ye)),_(Ze,ye,ct,D),ct=Ze.length,W==-1)for(;b(yt,Ze,cn,ct)<1;)de++,_(Ze,cn<ct?_s:yt,ct,D),ct=Ze.length}else W===0&&(de++,Ze=[0]);St[V++]=de,Ze[0]?Ze[ct++]=Qt[Pa]||0:(Ze=[Qt[Pa]],ct=1)}while((Pa++<eu||Ze[0]!=null)&&Pn--);ie=Ze[0]!=null,St[0]||St.splice(0,1)}if(D==d){for(V=1,Pn=St[0];10<=Pn;Pn/=10,V++);De(We,k+(We.e=V+$*f-1)+1,x,ie)}else We.e=$,We.r=+ie;return We}}(),qe=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Fe=/^([^.]+)\.$/,we=/^\.([^.]+)$/,g=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ne=function(C,b,_,F){var O,k=_?b:b.replace(m,"");if(g.test(k))C.s=isNaN(k)?null:k<0?-1:1,C.c=C.e=null;else{if(!_&&(k=k.replace(qe,function(x,D,W){return O=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,F&&F!=O?x:D}),F&&(O=F,k=k.replace(Fe,"$1").replace(we,"0.$1")),b!=k))return new z(k,O);if(z.DEBUG)throw Error(c+"Not a"+(F?" base "+F:"")+" number: "+b);C.c=C.e=C.s=null}},w.absoluteValue=w.abs=function(){var C=new z(this);return C.s<0&&(C.s=1),C},w.comparedTo=function(C,b){return A(this,new z(C,b))},w.decimalPlaces=w.dp=function(C,b){var _,F,O;if(C!=null)return M(C,0,y),b==null?b=N:M(b,0,8),De(new z(this),C+this.e+1,b);if(!(_=this.c))return null;if(F=((O=_.length-1)-R(this.e/f))*f,O=_[O])for(;O%10==0;O/=10,F--);return F<0&&(F=0),F},w.dividedBy=w.div=function(C,b){return Q(this,new z(C,b),I,N)},w.dividedToIntegerBy=w.idiv=function(C,b){return Q(this,new z(C,b),0,1)},w.exponentiatedBy=w.pow=function(C,b){var _,F,O,k,x,D,W,$,V=this;if((C=new z(C)).c&&!C.isInteger())throw Error(c+"Exponent not an integer: "+Re(C));if(b!=null&&(b=new z(b)),x=14<C.e,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!C.c||!C.c[0])return $=new z(Math.pow(+Re(V),x?2-L(C):+Re(C))),b?$.mod(b):$;if(D=C.s<0,b){if(b.c?!b.c[0]:!b.s)return new z(NaN);(F=!D&&V.isInteger()&&b.isInteger())&&(V=V.mod(b))}else{if(9<C.e&&(0<V.e||V.e<-1||(V.e==0?1<V.c[0]||x&&24e7<=V.c[1]:V.c[0]<8e13||x&&V.c[0]<=9999975e7)))return k=V.s<0&&L(C)?-0:0,-1<V.e&&(k=1/k),new z(D?1/k:k);Ie&&(k=l(Ie/f+2))}for(W=x?(_=new z(.5),D&&(C.s=1),L(C)):(O=Math.abs(+Re(C)))%2,$=new z(P);;){if(W){if(!($=$.times(V)).c)break;k?$.c.length>k&&($.c.length=k):F&&($=$.mod(b))}if(O){if((O=u(O/2))===0)break;W=O%2}else if(De(C=C.times(_),C.e+1,1),14<C.e)W=L(C);else{if((O=+Re(C))==0)break;W=O%2}V=V.times(V),k?V.c&&V.c.length>k&&(V.c.length=k):F&&(V=V.mod(b))}return F?$:(D&&($=P.div($)),b?$.mod(b):k?De($,Ie,N,void 0):$)},w.integerValue=function(C){var b=new z(this);return C==null?C=N:M(C,0,8),De(b,b.e+1,C)},w.isEqualTo=w.eq=function(C,b){return A(this,new z(C,b))===0},w.isFinite=function(){return!!this.c},w.isGreaterThan=w.gt=function(C,b){return 0<A(this,new z(C,b))},w.isGreaterThanOrEqualTo=w.gte=function(C,b){return(b=A(this,new z(C,b)))===1||b===0},w.isInteger=function(){return!!this.c&&R(this.e/f)>this.c.length-2},w.isLessThan=w.lt=function(C,b){return A(this,new z(C,b))<0},w.isLessThanOrEqualTo=w.lte=function(C,b){return(b=A(this,new z(C,b)))===-1||b===0},w.isNaN=function(){return!this.s},w.isNegative=function(){return this.s<0},w.isPositive=function(){return 0<this.s},w.isZero=function(){return!!this.c&&this.c[0]==0},w.minus=function(C,b){var _,F,O,k,x=this,D=x.s;if(b=(C=new z(C,b)).s,!D||!b)return new z(NaN);if(D!=b)return C.s=-b,x.plus(C);var W=x.e/f,$=C.e/f,V=x.c,ie=C.c;if(!W||!$){if(!V||!ie)return V?(C.s=-b,C):new z(ie?x:NaN);if(!V[0]||!ie[0])return ie[0]?(C.s=-b,C):new z(V[0]?x:N==3?-0:0)}if(W=R(W),$=R($),V=V.slice(),D=W-$){for((O=(k=D<0)?(D=-D,V):($=W,ie)).reverse(),b=D;b--;O.push(0));O.reverse()}else for(F=(k=(D=V.length)<(b=ie.length))?D:b,D=b=0;b<F;b++)if(V[b]!=ie[b]){k=V[b]<ie[b];break}if(k&&(O=V,V=ie,ie=O,C.s=-C.s),0<(b=(F=ie.length)-(_=V.length)))for(;b--;V[_++]=0);for(b=d-1;D<F;){if(V[--F]<ie[F]){for(_=F;_&&!V[--_];V[_]=b);--V[_],V[F]+=d}V[F]-=ie[F]}for(;V[0]==0;V.splice(0,1),--$);return V[0]?xe(C,V,$):(C.s=N==3?-1:1,C.c=[C.e=0],C)},w.modulo=w.mod=function(C,b){var _,F,O=this;return C=new z(C,b),!O.c||!C.s||C.c&&!C.c[0]?new z(NaN):!C.c||O.c&&!O.c[0]?new z(O):(Se==9?(F=C.s,C.s=1,_=Q(O,C,0,3),C.s=F,_.s*=F):_=Q(O,C,0,Se),(C=O.minus(_.times(C))).c[0]||Se!=1||(C.s=O.s),C)},w.multipliedBy=w.times=function(C,b){var _,F,O,k,x,D,W,$,V,ie,de,ye,Me,We,St,Ze=this,ct=Ze.c,_t=(C=new z(C,b)).c;if(!(ct&&_t&&ct[0]&&_t[0]))return!Ze.s||!C.s||ct&&!ct[0]&&!_t||_t&&!_t[0]&&!ct?C.c=C.e=C.s=null:(C.s*=Ze.s,ct&&_t?(C.c=[0],C.e=0):C.c=C.e=null),C;for(F=R(Ze.e/f)+R(C.e/f),C.s*=Ze.s,(W=ct.length)<(ie=_t.length)&&(Me=ct,ct=_t,_t=Me,O=W,W=ie,ie=O),O=W+ie,Me=[];O--;Me.push(0));for(We=d,St=S,O=ie;0<=--O;){for(_=0,de=_t[O]%St,ye=_t[O]/St|0,k=O+(x=W);O<k;)_=(($=de*($=ct[--x]%St)+(D=ye*$+(V=ct[x]/St|0)*de)%St*St+Me[k]+_)/We|0)+(D/St|0)+ye*V,Me[k--]=$%We;Me[k]=_}return _?++F:Me.splice(0,1),xe(C,Me,F)},w.negated=function(){var C=new z(this);return C.s=-C.s||null,C},w.plus=function(C,b){var _,F=this,O=F.s;if(b=(C=new z(C,b)).s,!O||!b)return new z(NaN);if(O!=b)return C.s=-b,F.minus(C);var k=F.e/f,x=C.e/f,D=F.c,W=C.c;if(!k||!x){if(!D||!W)return new z(O/0);if(!D[0]||!W[0])return W[0]?C:new z(D[0]?F:0*O)}if(k=R(k),x=R(x),D=D.slice(),O=k-x){for((_=0<O?(x=k,W):(O=-O,D)).reverse();O--;_.push(0));_.reverse()}for((O=D.length)-(b=W.length)<0&&(_=W,W=D,D=_,b=O),O=0;b;)O=(D[--b]=D[b]+W[b]+O)/d|0,D[b]=d===D[b]?0:D[b]%d;return O&&(D=[O].concat(D),++x),xe(C,D,x)},w.precision=w.sd=function(C,b){var _,F,O;if(C!=null&&C!==!!C)return M(C,1,y),b==null?b=N:M(b,0,8),De(new z(this),C,b);if(!(_=this.c))return null;if(F=(O=_.length-1)*f+1,O=_[O]){for(;O%10==0;O/=10,F--);for(O=_[0];10<=O;O/=10,F++);}return C&&this.e+1>F&&(F=this.e+1),F},w.shiftedBy=function(C){return M(C,-p,p),this.times("1e"+C)},w.squareRoot=w.sqrt=function(){var C,b,_,F,O,k=this,x=k.c,D=k.s,W=k.e,$=I+4,V=new z("0.5");if(D!==1||!x||!x[0])return new z(!D||D<0&&(!x||x[0])?NaN:x?k:1/0);if((_=(D=Math.sqrt(+Re(k)))==0||D==1/0?(((b=T(x)).length+W)%2==0&&(b+="0"),D=Math.sqrt(+b),W=R((W+1)/2)-(W<0||W%2),new z(b=D==1/0?"1e"+W:(b=D.toExponential()).slice(0,b.indexOf("e")+1)+W)):new z(D+"")).c[0]){for((D=(W=_.e)+$)<3&&(D=0);;)if(O=_,_=V.times(O.plus(Q(k,O,$,1))),T(O.c).slice(0,D)===(b=T(_.c)).slice(0,D)){if(_.e<W&&--D,(b=b.slice(D-3,D+1))!="9999"&&(F||b!="4999")){+b&&(+b.slice(1)||b.charAt(0)!="5")||(De(_,_.e+I+2,1),C=!_.times(_).eq(k));break}if(!F&&(De(O,O.e+I+2,0),O.times(O).eq(k))){_=O;break}$+=4,D+=4,F=1}}return De(_,_.e+I+1,N,C)},w.toExponential=function(C,b){return C!=null&&(M(C,0,y),C++),lt(this,C,b,1)},w.toFixed=function(C,b){return C!=null&&(M(C,0,y),C=C+this.e+1),lt(this,C,b)},w.toFormat=function(C,b,_){var F;if(_==null)C!=null&&b&&typeof b=="object"?(_=b,b=null):C&&typeof C=="object"?(_=C,C=b=null):_=Oe;else if(typeof _!="object")throw Error(c+"Argument not an object: "+_);if(F=this.toFixed(C,b),this.c){var O,k=F.split("."),x=+_.groupSize,D=+_.secondaryGroupSize,W=_.groupSeparator||"",$=k[0],V=k[1],ie=this.s<0,de=ie?$.slice(1):$,ye=de.length;if(D&&(O=x,x=D,ye-=D=O),0<x&&0<ye){for(O=ye%x||x,$=de.substr(0,O);O<ye;O+=x)$+=W+de.substr(O,x);0<D&&($+=W+de.slice(O)),ie&&($="-"+$)}F=V?$+(_.decimalSeparator||"")+((D=+_.fractionGroupSize)?V.replace(new RegExp("\\d{"+D+"}\\B","g"),"$&"+(_.fractionGroupSeparator||"")):V):$}return(_.prefix||"")+F+(_.suffix||"")},w.toFraction=function(C){var b,_,F,O,k,x,D,W,$,V,ie,de,ye=this,Me=ye.c;if(C!=null&&(!(D=new z(C)).isInteger()&&(D.c||D.s!==1)||D.lt(P)))throw Error(c+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+Re(D));if(!Me)return new z(ye);for(b=new z(P),$=_=new z(P),F=W=new z(P),de=T(Me),k=b.e=de.length-ye.e-1,b.c[0]=v[(x=k%f)<0?f+x:x],C=!C||0<D.comparedTo(b)?0<k?b:$:D,x=J,J=1/0,D=new z(de),W.c[0]=0;V=Q(D,b,0,1),(O=_.plus(V.times(F))).comparedTo(C)!=1;)_=F,F=O,$=W.plus(V.times(O=$)),W=O,b=D.minus(V.times(O=b)),D=O;return O=Q(C.minus(_),F,0,1),W=W.plus(O.times($)),_=_.plus(O.times(F)),W.s=$.s=ye.s,ie=Q($,F,k*=2,N).minus(ye).abs().comparedTo(Q(W,_,k,N).minus(ye).abs())<1?[$,F]:[W,_],J=x,ie},w.toNumber=function(){return+Re(this)},w.toPrecision=function(C,b){return C!=null&&M(C,1,y),lt(this,C,b,2)},w.toString=function(C){var b,_=this,F=_.s,O=_.e;return O===null?F?(b="Infinity",F<0&&(b="-"+b)):b="NaN":(b=C==null?O<=j||Y<=O?B(T(_.c),O):K(T(_.c),O,"0"):C===10?K(T((_=De(new z(_),I+O+1,N)).c),_.e,"0"):(M(C,2,He.length,"Base"),re(K(T(_.c),O,"0"),10,C,F,!0)),F<0&&_.c[0]&&(b="-"+b)),b},w.valueOf=w.toJSON=function(){return Re(this)},w._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(w[Symbol.toStringTag]="BigNumber",w[Symbol.for("nodejs.util.inspect.custom")]=w.valueOf),G!=null&&z.set(G),z}()).default=s.BigNumber=s,r!==void 0&&r.exports?r.exports=s:(o||(o=typeof self<"u"&&self?self:window),o.BigNumber=s)})(this)},{}],2:[function(n,r,i){r.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(o){var s=o%10;return~~(o%100/10)==1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(n,r,i){function o(R,T){return function(A){if(Array.isArray(A))return A}(R)||function(A,M){var L=[],B=!0,K=!1,U=void 0;try{for(var G,Q=A[Symbol.iterator]();!(B=(G=Q.next()).done)&&(L.push(G.value),!M||L.length!==M);B=!0);}catch(re){K=!0,U=re}finally{try{B||Q.return==null||Q.return()}finally{if(K)throw U}}return L}(R,T)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=n("./globalState"),a=n("./validating"),l=n("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(R){var T=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},A=2<arguments.length?arguments[2]:void 0;if(typeof T=="string"&&(T=l.parseFormat(T)),!a.validateFormat(T))return"ERROR: invalid format";var M=T.prefix||"",L=T.postfix||"",B=function(K,U,G){switch(U.output){case"currency":return U=y(U,s.currentCurrencyDefaultFormat()),function(He,z,lt){var Be=lt.currentCurrency(),xe=Object.assign({},h,z),De=void 0,Re="",C=!!xe.totalLength||!!xe.forceAverage||xe.average,b=z.currencyPosition||Be.position,_=z.currencySymbol||Be.symbol;xe.spaceSeparated&&(Re=" "),b==="infix"&&(De=Re+_+Re);var F=S({instance:He,providedFormat:z,state:lt,decimalSeparator:De});return b==="prefix"&&(F=He._value<0&&xe.negative==="sign"?"-".concat(Re).concat(_).concat(F.slice(1)):_+Re+F),b&&b!=="postfix"||(F=F+(Re=C?"":Re)+_),F}(K,U,s);case"percent":return U=y(U,s.currentPercentageDefaultFormat()),function(He,z,lt,Be){var xe=z.prefixSymbol,De=S({instance:Be(100*He._value),providedFormat:z,state:lt}),Re=Object.assign({},h,z);return xe?"%".concat(Re.spaceSeparated?" ":"").concat(De):"".concat(De).concat(Re.spaceSeparated?" ":"","%")}(K,U,s,G);case"byte":return U=y(U,s.currentByteDefaultFormat()),P=K,N=s,j=G,Y=(I=U).base||"binary",oe=c[Y],J=f(P._value,oe.suffixes,oe.scale),X=J.value,Se=J.suffix,Ie=S({instance:j(X),providedFormat:I,state:N,defaults:N.currentByteDefaultFormat()}),Oe=N.currentAbbreviations(),"".concat(Ie).concat(Oe.spaced?" ":"").concat(Se);case"time":return U=y(U,s.currentTimeDefaultFormat()),we=K,g=Math.floor(we._value/60/60),m=Math.floor((we._value-60*g*60)/60),w=Math.round(we._value-60*g*60-60*m),"".concat(g,":").concat(m<10?"0":"").concat(m,":").concat(w<10?"0":"").concat(w);case"ordinal":return U=y(U,s.currentOrdinalDefaultFormat()),Q=K,re=U,ce=(ne=s).currentOrdinal(),be=Object.assign({},h,re),qe=S({instance:Q,providedFormat:re,state:ne}),Fe=ce(Q._value),"".concat(qe).concat(be.spaceSeparated?" ":"").concat(Fe);case"number":default:return S({instance:K,providedFormat:U,numbro:G})}var Q,re,ne,ce,be,qe,Fe,we,g,m,w,P,I,N,j,Y,oe,J,X,Se,Ie,Oe}(R,T,A);return B=(B=M+B)+L}function f(R,T,A){var M=T[0],L=Math.abs(R);if(A<=L){for(var B=1;B<T.length;++B){var K=Math.pow(A,B),U=Math.pow(A,B+1);if(K<=L&&L<U){M=T[B],R/=K;break}}M===T[0]&&(R/=Math.pow(A,T.length-1),M=T[T.length-1])}return{value:R,suffix:M}}function p(R){for(var T="",A=0;A<R;A++)T+="0";return T}function v(R,T){return R.toString().indexOf("e")!==-1?function(A,M){var L=A.toString(),B=o(L.split("e"),2),K=B[0],U=B[1],G=o(K.split("."),2),Q=G[0],re=G[1],ne=re===void 0?"":re;if(0<+U)L=Q+ne+p(U-ne.length);else{var ce=".";ce=+Q<0?"-0".concat(ce):"0".concat(ce);var be=(p(-U-1)+Math.abs(Q)+ne).substr(0,M);be.length<M&&(be+=p(M-be.length)),L=ce+be}return 0<+U&&0<M&&(L+=".".concat(p(M))),L}(R,T):(Math.round(+"".concat(R,"e+").concat(T))/Math.pow(10,T)).toFixed(T)}function S(R){var T=R.instance,A=R.providedFormat,M=R.state,L=M===void 0?s:M,B=R.decimalSeparator,K=R.defaults,U=K===void 0?L.currentDefaults():K,G=T._value;if(G===0&&L.hasZeroFormat())return L.getZeroFormat();if(!isFinite(G))return G.toString();var Q,re,ne,ce,be,qe,Fe,we,g=Object.assign({},h,U,A),m=g.totalLength,w=m?0:g.characteristic,P=g.optionalCharacteristic,I=g.forceAverage,N=!!m||!!I||g.average,j=m?-1:N&&A.mantissa===void 0?0:g.mantissa,Y=!m&&(A.optionalMantissa===void 0?j===-1:g.optionalMantissa),oe=g.trimMantissa,J=g.thousandSeparated,X=g.spaceSeparated,Se=g.negative,Ie=g.forceSign,Oe=g.exponential,He="";if(N){var z=function(C){var b=C.value,_=C.forceAverage,F=C.abbreviations,O=C.spaceSeparated,k=O!==void 0&&O,x=C.totalLength,D=x===void 0?0:x,W="",$=Math.abs(b),V=-1;if($>=Math.pow(10,12)&&!_||_==="trillion"?(W=F.trillion,b/=Math.pow(10,12)):$<Math.pow(10,12)&&$>=Math.pow(10,9)&&!_||_==="billion"?(W=F.billion,b/=Math.pow(10,9)):$<Math.pow(10,9)&&$>=Math.pow(10,6)&&!_||_==="million"?(W=F.million,b/=Math.pow(10,6)):($<Math.pow(10,6)&&$>=Math.pow(10,3)&&!_||_==="thousand")&&(W=F.thousand,b/=Math.pow(10,3)),W&&(W=(k?" ":"")+W),D){var ie=b.toString().split(".")[0];V=Math.max(D-ie.length,0)}return{value:b,abbreviation:W,mantissaPrecision:V}}({value:G,forceAverage:I,abbreviations:L.currentAbbreviations(),spaceSeparated:X,totalLength:m});G=z.value,He+=z.abbreviation,m&&(j=z.mantissaPrecision)}if(Oe){var lt=(re=(Q={value:G,characteristicPrecision:w}).value,ne=Q.characteristicPrecision,ce=ne===void 0?0:ne,be=o(re.toExponential().split("e"),2),qe=be[0],Fe=be[1],we=+qe,ce&&1<ce&&(we*=Math.pow(10,ce-1),Fe=0<=(Fe=+Fe-(ce-1))?"+".concat(Fe):Fe),{value:we,abbreviation:"e".concat(Fe)});G=lt.value,He=lt.abbreviation+He}var Be,xe,De,Re=function(C,b,_,F,O){if(F===-1)return C;var k=v(b,F),x=o(k.toString().split("."),2),D=x[0],W=x[1],$=W===void 0?"":W;if($.match(/^0+$/)&&(_||O))return D;var V=$.match(/0+$/);return O&&V?"".concat(D,".").concat($.toString().slice(0,V.index)):k.toString()}(G.toString(),G,Y,j,oe);return Re=function(C,b,_,F,O){var k=F.currentDelimiters(),x=k.thousands;O=O||k.decimal;var D=k.thousandsSize||3,W=C.toString(),$=W.split(".")[0],V=W.split(".")[1];return _&&(b<0&&($=$.slice(1)),function(ie,de){for(var ye=[],Me=0,We=ie;0<We;We--)Me===de&&(ye.unshift(We),Me=0),Me++;return ye}($.length,D).forEach(function(ie,de){$=$.slice(0,ie+de)+x+$.slice(ie+de)}),b<0&&($="-".concat($))),W=V?$+O+V:$}(Re=function(C,b,_,F){var O=C,k=o(O.toString().split("."),2),x=k[0],D=k[1];if(x.match(/^-?0$/)&&_)return D?"".concat(x.replace("0",""),".").concat(D):x.replace("0","");if(x.length<F)for(var W=F-x.length,$=0;$<W;$++)O="0".concat(O);return O.toString()}(Re,0,P,w),G,J,L,B),(N||Oe)&&(Re=Re+He),(Ie||G<0)&&(Be=Re,De=Se,Re=(xe=G)===0?Be:+Be==0?Be.replace("-",""):0<xe?"+".concat(Be):De==="sign"?Be:"(".concat(Be.replace("-",""),")")),Re}function y(R,T){if(!R)return T;var A=Object.keys(R);return A.length===1&&A[0]==="output"?T:R}r.exports=function(R){return{format:function(){for(var T=arguments.length,A=new Array(T),M=0;M<T;M++)A[M]=arguments[M];return d.apply(void 0,A.concat([R]))},getByteUnit:function(){for(var T=arguments.length,A=new Array(T),M=0;M<T;M++)A[M]=arguments[M];return(function(L){var B=c.general;return f(L._value,B.suffixes,B.scale).suffix}).apply(void 0,A.concat([R]))},getBinaryByteUnit:function(){for(var T=arguments.length,A=new Array(T),M=0;M<T;M++)A[M]=arguments[M];return(function(L){var B=c.binary;return f(L._value,B.suffixes,B.scale).suffix}).apply(void 0,A.concat([R]))},getDecimalByteUnit:function(){for(var T=arguments.length,A=new Array(T),M=0;M<T;M++)A[M]=arguments[M];return(function(L){var B=c.decimal;return f(L._value,B.suffixes,B.scale).suffix}).apply(void 0,A.concat([R]))},formatOrDefault:y}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(n,r,i){var o=n("./en-US"),s=n("./validating"),a=n("./parsing"),l={},u=void 0,c={},h=null,d={};function f(v){u=v}function p(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return p().currency},l.currentAbbreviations=function(){return p().abbreviations},l.currentDelimiters=function(){return p().delimiters},l.currentOrdinal=function(){return p().ordinal},l.currentDefaults=function(){return Object.assign({},p().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),p().timeFormat)},l.setDefaults=function(v){v=a.parseFormat(v),s.validateFormat(v)&&(d=v)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(v){return h=typeof v=="string"?v:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(v){if(v){if(c[v])return c[v];throw new Error('Unknown tag "'.concat(v,'"'))}return p()},l.registerLanguage=function(v){var S=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!s.validateLanguage(v))throw new Error("Invalid language data");c[v.languageTag]=v,S&&f(v.languageTag)},l.setLanguage=function(v){var S=1<arguments.length&&arguments[1]!==void 0?arguments[1]:o.languageTag;if(!c[v]){var y=v.split("-")[0],R=Object.keys(c).find(function(T){return T.split("-")[0]===y});return c[R]?void f(R):void f(S)}f(v)},l.registerLanguage(o),u=o.languageTag,r.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(n,r,i){r.exports=function(o){return{loadLanguagesInNode:function(s){return a=o,void s.forEach(function(l){var u=void 0;try{u=n("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(n,r,i){var o=n("bignumber.js");function s(a,l,u){var c=new o(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new o(h),a._value=c.minus(h).toNumber(),a}r.exports=function(a){return{add:function(l,u){return h=u,d=a,f=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=f.plus(p).toNumber(),c;var c,h,d,f,p},subtract:function(l,u){return s(l,u,a)},multiply:function(l,u){return h=u,d=a,f=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=f.times(p).toNumber(),c;var c,h,d,f,p},divide:function(l,u){return h=u,d=a,f=new o((c=l)._value),p=h,d.isNumbro(h)&&(p=h._value),p=new o(p),c._value=f.dividedBy(p).toNumber(),c;var c,h,d,f,p},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,s(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(n,r,i){function o(S,y){for(var R=0;R<y.length;R++){var T=y[R];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(S,T.key,T)}}var s=n("./globalState"),a=n("./validating"),l=n("./loading")(v),u=n("./unformatting"),c=n("./formatting")(v),h=n("./manipulating")(v),d=n("./parsing"),f=function(){function S(T){(function(A,M){if(!(A instanceof M))throw new TypeError("Cannot call a class as a function")})(this,S),this._value=T}var y,R;return y=S,(R=[{key:"clone",value:function(){return v(this._value)}},{key:"format",value:function(){var T=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,T)}},{key:"formatCurrency",value:function(T){return typeof T=="string"&&(T=d.parseFormat(T)),(T=c.formatOrDefault(T,s.currentCurrencyDefaultFormat())).output="currency",c.format(this,T)}},{key:"formatTime",value:function(){var T=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return T.output="time",c.format(this,T)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(T){return h.difference(this,T)}},{key:"add",value:function(T){return h.add(this,T)}},{key:"subtract",value:function(T){return h.subtract(this,T)}},{key:"multiply",value:function(T){return h.multiply(this,T)}},{key:"divide",value:function(T){return h.divide(this,T)}},{key:"set",value:function(T){return h.set(this,p(T))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&o(y.prototype,R),S}();function p(S){var y=S;return v.isNumbro(S)?y=S._value:typeof S=="string"?y=v.unformat(S):isNaN(S)&&(y=NaN),y}function v(S){return new f(p(S))}v.version="2.1.2",v.isNumbro=function(S){return S instanceof f},v.language=s.currentLanguage,v.registerLanguage=s.registerLanguage,v.setLanguage=s.setLanguage,v.languages=s.languages,v.languageData=s.languageData,v.zeroFormat=s.setZeroFormat,v.defaultFormat=s.currentDefaults,v.setDefaults=s.setDefaults,v.defaultCurrencyFormat=s.currentCurrencyDefaultFormat,v.validate=a.validate,v.loadLanguagesInNode=l.loadLanguagesInNode,v.unformat=u.unformat,r.exports=v},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(n,r,i){r.exports={parseFormat:function(o){var s,a,l,u,c,h,d,f,p,v,S,y,R,T,A,M,L,B,K,U,G=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof o!="string"?o:(a=G,o=(l=(s=o).match(/^{([^}]*)}/))?(a.prefix=l[1],s.slice(l[0].length)):s,c=G,function(Q,re){if(Q.indexOf("$")===-1){if(Q.indexOf("%")===-1)return Q.indexOf("bd")!==-1?(re.output="byte",re.base="general"):Q.indexOf("b")!==-1?(re.output="byte",re.base="binary"):Q.indexOf("d")!==-1?(re.output="byte",re.base="decimal"):Q.indexOf(":")===-1?Q.indexOf("o")!==-1&&(re.output="ordinal"):re.output="time";re.output="percent"}else re.output="currency"}(o=(h=(u=o).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,G),d=G,(f=o.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),p=G,(v=o.split(".")[0].match(/0+/))&&(p.characteristic=v[0].length),function(Q,re){if(Q.indexOf(".")!==-1){var ne=Q.split(".")[0];re.optionalCharacteristic=ne.indexOf("0")===-1}}(o,G),S=G,o.indexOf("a")!==-1&&(S.average=!0),R=G,(y=o).indexOf("K")!==-1?R.forceAverage="thousand":y.indexOf("M")!==-1?R.forceAverage="million":y.indexOf("B")!==-1?R.forceAverage="billion":y.indexOf("T")!==-1&&(R.forceAverage="trillion"),function(Q,re){var ne=Q.split(".")[1];if(ne){var ce=ne.match(/0+/);ce&&(re.mantissa=ce[0].length)}}(o,G),A=G,(T=o).match(/\[\.]/)?A.optionalMantissa=!0:T.match(/\./)&&(A.optionalMantissa=!1),M=G,o.indexOf(",")!==-1&&(M.thousandSeparated=!0),L=G,o.indexOf(" ")!==-1&&(L.spaceSeparated=!0),K=G,(B=o).match(/^\+?\([^)]*\)$/)&&(K.negative="parenthesis"),B.match(/^\+?-/)&&(K.negative="sign"),U=G,o.match(/^\+/)&&(U.forceSign=!0),G)}}},{}],9:[function(n,r,i){var o=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,p=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function v(S,y){var R=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",T=3<arguments.length?arguments[3]:void 0,A=4<arguments.length?arguments[4]:void 0,M=5<arguments.length?arguments[5]:void 0,L=6<arguments.length?arguments[6]:void 0;if(!isNaN(+S))return+S;var B="",K=S.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(K!==S)return-1*v(K,y,R,T,A,M,L);for(var U=0;U<o.length;U++){var G=o[U];if((B=S.replace(G.key,""))!==S)return v(B,y,R,T,A,M,L)*G.factor}if((B=S.replace("%",""))!==S)return v(B,y,R,T,A,M,L)/100;var Q=parseFloat(S);if(!isNaN(Q)){var re=T(Q);if(re&&re!=="."&&(B=S.replace(new RegExp("".concat(s(re),"$")),""))!==S)return v(B,y,R,T,A,M,L);var ne={};Object.keys(M).forEach(function(m){ne[M[m]]=m});for(var ce=Object.keys(ne).sort().reverse(),be=ce.length,qe=0;qe<be;qe++){var Fe=ce[qe],we=ne[Fe];if((B=S.replace(Fe,""))!==S){var g=void 0;switch(we){case"thousand":g=Math.pow(10,3);break;case"million":g=Math.pow(10,6);break;case"billion":g=Math.pow(10,9);break;case"trillion":g=Math.pow(10,12)}return v(B,y,R,T,A,M,L)*g}}}}(function(v,S){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",R=v.replace(y,"");return R=(R=R.replace(new RegExp("([0-9])".concat(s(S.thousands),"([0-9])"),"g"),"$1$2")).replace(S.decimal,".")}(l,u,c),u,c,h,d,f,p)}r.exports={unformat:function(l,u){var c,h,d,f=n("./globalState"),p=f.currentDelimiters(),v=f.currentCurrency().symbol,S=f.currentOrdinal(),y=f.getZeroFormat(),R=f.currentAbbreviations(),T=void 0;if(typeof l=="string")T=function(A,M){if(!A.indexOf(":")||M.thousands===":")return!1;var L=A.split(":");if(L.length!==3)return!1;var B=+L[0],K=+L[1],U=+L[2];return!isNaN(B)&&!isNaN(K)&&!isNaN(U)}(l,p)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,p,v,S,y,R,u);else{if(typeof l!="number")return;T=l}if(T!==void 0)return T}}},{"./globalState":4}],10:[function(n,r,i){function o(p){return function(v){if(Array.isArray(v)){for(var S=0,y=new Array(v.length);S<v.length;S++)y[S]=v[S];return y}}(p)||function(v){if(Symbol.iterator in Object(v)||Object.prototype.toString.call(v)==="[object Arguments]")return Array.from(v)}(p)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(p){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v})(p)}var a=n("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(p,v){return v.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(p){return p.output==="byte"}},characteristic:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(p){return 0<=p},message:"value must be positive"},{restriction:function(p,v){return!v.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(p){return 0<=p},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(p,v){return v.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(p){return p.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p){return!!a.unformat(p)}function d(p,v,S){var y=3<arguments.length&&arguments[3]!==void 0&&arguments[3],R=Object.keys(p).map(function(T){if(!v[T])return console.error("".concat(S," Invalid key: ").concat(T)),!1;var A=p[T],M=v[T];if(typeof M=="string"&&(M={type:M}),M.type==="format"){if(!d(A,u,"[Validate ".concat(T,"]"),!0))return!1}else if(s(A)!==M.type)return console.error("".concat(S," ").concat(T,' type mismatched: "').concat(M.type,'" expected, "').concat(s(A),'" provided')),!1;if(M.restrictions&&M.restrictions.length)for(var L=M.restrictions.length,B=0;B<L;B++){var K=M.restrictions[B],U=K.restriction,G=K.message;if(!U(A,p))return console.error("".concat(S," ").concat(T," invalid value: ").concat(G)),!1}return M.restriction&&!M.restriction(A,p)?(console.error("".concat(S," ").concat(T," invalid value: ").concat(M.message)),!1):M.validValues&&M.validValues.indexOf(A)===-1?(console.error("".concat(S," ").concat(T," invalid value: must be among ").concat(JSON.stringify(M.validValues),', "').concat(A,'" provided')),!1):!(M.children&&!d(A,M.children,"[Validate ".concat(T,"]")))});return y||R.push.apply(R,o(Object.keys(v).map(function(T){var A=v[T];if(typeof A=="string"&&(A={type:A}),A.mandatory){var M=A.mandatory;if(typeof M=="function"&&(M=M(p)),M&&p[T]===void 0)return console.error("".concat(S,' Missing mandatory key "').concat(T,'"')),!1}return!0}))),R.reduce(function(T,A){return T&&A},!0)}function f(p){return d(p,u,"[Validate format]")}r.exports={validate:function(p,v){var S=h(p),y=f(v);return S&&y},validateFormat:f,validateInput:h,validateLanguage:function(p){return d(p,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(PH);var X9=PH.exports;const $s=AP(X9),q9="numeric";function Vb(t,e,n,r,i,o,s){let a=o;if(Wn(a)){const l=s.numericFormat,u=l&&l.culture||"-",c=l&&l.pattern,h=s.className||"",d=h.length?h.split(" "):[];if(typeof u<"u"&&!$s.languages()[u]){const f=u.replace("-",""),p=$s.allLanguages?$s.allLanguages[u]:$s[f];p&&$s.registerLanguage(p)}$s.setLanguage(u),a=$s(a).format(c||"0"),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),s.className=d.join(" "),e.dir="ltr"}xo(t,e,n,r,i,a,s)}Vb.RENDERER_TYPE=q9;const Z9="password";function Bb(t,e,n,r,i,o,s){xo.apply(this,[t,e,n,r,i,o,s]);const a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*";let u="";pe(a-1,()=>{u+=l}),Ea(e,u)}Bb.RENDERER_TYPE=Z9;const Q9="select";function Ub(t,e,n,r,i,o,s){xo.apply(this,[t,e,n,r,i,o,s])}Ub.RENDERER_TYPE=Q9;const J9="time";function Gb(t,e,n,r,i,o,s){xo.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}Gb.RENDERER_TYPE=J9;function e7(){cr(Zl),cr(rh),cr(kb),cr($b),cr(Wb),cr(Lb),cr(Vb),cr(Bb),cr(Ub),cr(xo),cr(Gb)}const t7="autocomplete";function qg(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,sT(n,e)):sT(n,e)(this.source):e(!0)}qg.VALIDATOR_TYPE=t7;function sT(t,e){const n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}function IH(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const n7=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:IH},Symbol.toStringTag,{value:"Module"})),r7="date";function zb(t,e){const n=Qx(RH,this.instance);let r=t,i=!0;r==null&&(r="");let o=q(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=q(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){const a=i7(r,this.dateFormat),l=this.instance.toVisualRow(this.row),u=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,u,a,"dateValidator"),i=!0}else i=!1;e(i)}zb.VALIDATOR_TYPE=r7;function i7(t,e){const n=q(IH(t)),r=q(t,e),i=t.search(/[A-z]/g)>-1;let o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}const o7="dropdown";function Yb(t,e){qg.apply(this,[t,e])}Yb.VALIDATOR_TYPE=o7;const s7="numeric";function jb(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Wn(t))}jb.VALIDATOR_TYPE=s7;const a7=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],l7="time";function Kb(t,e){const n=this.timeFormat||"h:mm:ss a";let r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const s=q(i,a7,!0).isValid()?q(i):q(i,n);let a=s.isValid(),l=q(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){const u=s.format(n),c=this.instance.toVisualRow(this.row),h=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(c,h,u,"timeValidator"),r=!0}else r=!1;e(r)}Kb.VALIDATOR_TYPE=l7;function u7(){oa(qg),oa(Yb),oa(zb),oa(jb),oa(Kb)}const c7="autocomplete",h7={CELL_TYPE:c7,editor:Hb,renderer:Zl,validator:qg},d7="checkbox",f7={CELL_TYPE:d7,editor:bH,renderer:kb},g7="date";function xH(t,e,n,r,i,o,s){Zl.apply(this,[t,e,n,r,i,o,s])}xH.RENDERER_TYPE=g7;const m7="date",p7={CELL_TYPE:m7,editor:EH,renderer:xH,validator:zb},w7="dropdown",v7={CELL_TYPE:w7,editor:Nb,renderer:$b,validator:Yb},C7="handsontable",S7={CELL_TYPE:C7,editor:xb,renderer:Wb},y7="numeric",b7={CELL_TYPE:y7,editor:TH,renderer:Vb,validator:jb,dataType:"number"},R7="password",E7={CELL_TYPE:R7,editor:_H,renderer:Bb,copyable:!1},T7="select",_7={CELL_TYPE:T7,editor:MH,renderer:Ub},M7="time",A7={CELL_TYPE:M7,editor:AH,renderer:Gb,validator:Kb};function O7(){Er(h7),Er(f7),Er(p7),Er(v7),Er(S7),Er(b7),Er(E7),Er(_7),Er(yH),Er(A7)}function P7(t,e){HH(t,e),e.add(t)}function I7(t,e,n){HH(t,e),e.set(t,n)}function HH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(t,e,n){return e=x7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x7(t){var e=H7(t,"string");return typeof e=="symbol"?e:String(e)}function H7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function D7(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ua(t,e){var n=N7(t,e,"get");return L7(t,n)}function N7(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function L7(t,e){return e.get?e.get.call(t):e.value}const aT=new Map([["plugin",ej],["cell-type",hH],["editor",Zx],["renderer",s1],["validator",a1]]),$7="base",Op=[];let wi=null;var ks=new WeakMap,lT=new WeakSet;class it{static get PLUGIN_KEY(){return $7}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){P7(this,lT),Ba(this,"eventManager",new Dr(this)),Ba(this,"pluginName",null),Ba(this,"pluginsInitializedCallbacks",[]),Ba(this,"isPluginsReady",!1),Ba(this,"enabled",!1),Ba(this,"initialized",!1),I7(this,ks,{writable:!0,value:{}}),Bi(this,"hot",e,{writable:!1}),wi=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const i=[];if(n.forEach(o=>{const[s,a]=o.split(":");if(!aT.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);aT.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");Op.push(o)}}if(wi||(wi=xS()),wi.indexOf("UndoRedo")>=0&&wi.splice(wi.indexOf("UndoRedo"),1),wi.indexOf(this.pluginName)>=0&&wi.splice(wi.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),wi.length===0){if(Op.length>0){const i=[`${Op.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){Ua(this,ks)[e]=Ua(this,ks)[e]||[];const r=Ua(this,ks)[e];this.hot.addHook(e,n),r.push(n),Ua(this,ks)[e]=r}removeHooks(e){E(Ua(this,ks)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Ua(this,ks);Ge(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){E(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=D7(this,lT,k7).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ge(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}}function k7(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function Fs(t,e,n){return e=F7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F7(t){var e=W7(t,"string");return typeof e=="symbol"?e:String(e)}function W7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let V7=class{constructor(e){Fs(this,"hot",null),Fs(this,"container",null),Fs(this,"injected",!1),Fs(this,"rows",[]),Fs(this,"columns",[]),Fs(this,"samples",null),Fs(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),E(this.rows,n=>{e(n.row,xt(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),E(this.columns,n=>{const{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{E(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{E(o.strings,s=>{const a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;const u=this.hot.getCellRenderer(l),c=n.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(c)})}),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{E(i.strings,o=>{const s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),E(r,i=>{const[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){const{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{E(i.strings,o=>{const s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;const l=this.hot.getCellRenderer(a),u=n.createElement("td"),c=n.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,s,e,this.hot.colToProp(e),o.value,a),c.appendChild(u),r.appendChild(c)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const r=this.hot.rootDocument.createElement("col");let i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),u=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Z(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Z(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};const Xb=V7;function Jh(t,e,n){return e=B7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B7(t){var e=U7(t,"string");return typeof e=="symbol"?e:String(e)}function U7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qb{static get SAMPLE_COUNT(){return 3}constructor(e){Jh(this,"samples",null),Jh(this,"dataFactory",null),Jh(this,"customSampleCount",null),Jh(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:qb.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){const i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return pe(o,s,a=>{const l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,o=e==="row"?"col":"row",s=[];return pe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:Ve(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${Wt(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(s.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[o]:a}),s.push(u),f.needed-=1)}),i}}const DH=qb;function Ga(t,e){NH(t,e),e.add(t)}function G7(t,e,n){NH(t,e),e.set(t,n)}function NH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function za(t,e,n){return e=z7(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z7(t){var e=Y7(t,"string");return typeof e=="symbol"?e:String(e)}function Y7(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j7(t,e,n){var r=LH(t,e,"set");return K7(t,r,n),n}function K7(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ed(t,e){var n=LH(t,e,"get");return X7(t,n)}function LH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function X7(t,e){return e.get?e.get.call(t):e.value}function Ws(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("modifyAutoColumnSizeSeed");const bu="autoColumnSize",q7=10,Z7="autoColumnSize";var bl=new WeakMap,uT=new WeakSet,cT=new WeakSet,hT=new WeakSet,Pp=new WeakSet,dT=new WeakSet,fT=new WeakSet;class lc extends it{static get PLUGIN_KEY(){return bu}static get PLUGIN_PRIORITY(){return q7}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Ga(this,fT),Ga(this,dT),Ga(this,Pp),Ga(this,hT),Ga(this,cT),Ga(this,uT),za(this,"ghostTable",new Xb(this.hot)),za(this,"samplesGenerator",new DH((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o))return!1;const s=this.hot.getCellMeta(n,r);let a="";s.spanned||(a=this.hot.getDataAtCell(n,r));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,s,a)),{value:a,bundleSeed:l}})),za(this,"firstCalculation",!0),za(this,"inProgress",!1),za(this,"measuredColumns",0),za(this,"columnWidthsMap",new Ts),G7(this,bl,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(Z7,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>Ws(this,Pp,gT).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[bu]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[bu];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Ws(e,cT,J7).call(e,...i)}),this.addHook("beforeChangeRender",r=>Ws(this,hT,e8).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>Ws(this,fT,n8).call(this,r)),this.addHook("beforeViewRender",r=>Ws(this,uT,Q7).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>Ws(this,dT,t8).call(this)),super.enablePlugin()}updatePlugin(){const e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>Ws(this,Pp,gT).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;pe(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){const l=this.samplesGenerator.generateColumnSamples(s,o);E(l,u=>{let[c,h]=u;return this.ghostTable.addColumn(c,h)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{const l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0;const r=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Oc(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+lc.CALCULATION_STEP,r)},e),n=n+lc.CALCULATION_STEP+1,n<r?i=$g(o):(Oc(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[bu],n=e&&It(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&It(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){const e=this.hot.getSettings()[bu];let n=lc.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return Ve(e)&&(n=e.syncLimit,lS(n)?n=PS(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Jc.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){const e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){const n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){const n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){const e=this.hot.getColHeader();return Gt(e,(r,i,o)=>{const s=ed(this,bl).length;return(s-1<o||ed(this,bl)[o]!==i)&&r.push(o),s-1<o?ed(this,bl).push(i):ed(this,bl)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{E(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!vr(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Q7(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function J7(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function e8(t){const e=Ue(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function gT(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function t8(){j7(this,bl,this.hot.getColHeader())}function n8(t){const e=vr(t,r=>{var i;return ue((i=r.address)===null||i===void 0?void 0:i.col)}),n=Ue(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}const la={horizontal:"horizontal",vertical:"vertical"};function r8(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function i8(t){const e={};return t===!0?(e.directions=Object.keys(la),e.autoInsertRow=!0):Ve(t)?(ue(t.autoInsertRow)?t.direction===la.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ue(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(la)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function Ru(t,e){o8(t,e),e.add(t)}function o8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ya(t,e,n){return e=s8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s8(t){var e=a8(t,"string");return typeof e=="symbol"?e:String(e)}function a8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Eu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("modifyAutofillRange");fe.getSingleton().register("beforeAutofill");fe.getSingleton().register("afterAutofill");const mT="autofill",l8=20,u8=["fillHandle"],c8="insert_row_below",h8=200;var pT=new WeakSet,wT=new WeakSet,vT=new WeakSet,CT=new WeakSet,ST=new WeakSet;class d8 extends it{constructor(){super(...arguments),Ru(this,ST),Ru(this,CT),Ru(this,vT),Ru(this,wT),Ru(this,pT),Ya(this,"addingStarted",!1),Ya(this,"mouseDownOnCellCorner",!1),Ya(this,"mouseDragOutside",!1),Ya(this,"handleDraggedCells",0),Ya(this,"directions",[]),Ya(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return mT}static get PLUGIN_PRIORITY(){return l8}static get SETTING_KEYS(){return[mT,...u8]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Eu(this,wT,g8).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Eu(this,pT,f8).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Eu(this,vT,m8).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],u=[];return E(s,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),E(a,c=>{const h=[];E(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[s.row,s.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=r8(l,u,(f,p)=>this.hot._createCellCoords(f,p));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),p=o.clone(),v=this.hot._createCellRange(h,h,d),S=this.hot.runHooks("beforeAutofill",f,p,v,c);if(S===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let y=S;const R=S;if(["up","left"].indexOf(c)>-1&&!(R.length===1&&R[0].length===0))if(y=[],c==="up"){const T=d.row-h.row+1,A=T%R.length;for(let M=0;M<T;M++)y.push(R[(M+(R.length-A))%R.length])}else{const T=d.col-h.col+1,A=T%R[0].length;for(let M=0;M<R.length;M++){y.push([]);for(let L=0;L<T;L++)y[M].push(R[M][(L+(R[M].length-A))%R[M].length])}}this.hot.populateFromArray(h.row,h.col,y,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",y,p,v,c),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner();let i=e;if(this.directions.includes(la.vertical)&&this.directions.includes(la.horizontal)){const o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(la.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(la.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(c8,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},h8)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),r=this.hot.countRows();let i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;const s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Ue(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,r=en(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+xt(this.hot.table),i=en(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+ft(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Eu(this,CT,p8).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Eu(this,ST,w8).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=i8(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function f8(){this.selectAdjacent()&&this.fillIn()}function g8(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function m8(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function p8(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function w8(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function td(t,e){v8(t,e),e.add(t)}function v8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vs(t,e,n){return e=C8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C8(t){var e=S8(t,"string");return typeof e=="symbol"?e:String(e)}function S8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const nd="autoRowSize",y8=40,b8="autoRowSize";var yT=new WeakSet,Ip=new WeakSet,bT=new WeakSet,RT=new WeakSet;class uc extends it{static get PLUGIN_KEY(){return nd}static get PLUGIN_PRIORITY(){return y8}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),td(this,RT),td(this,bT),td(this,Ip),td(this,yT),Vs(this,"headerHeight",null),Vs(this,"ghostTable",new Xb(this.hot)),Vs(this,"samplesGenerator",new DH((n,r)=>{const i=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(r);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(o)||n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,r):n===-1&&(s=this.hot.getColHeader(r)),{value:s}})),Vs(this,"firstCalculation",!0),Vs(this,"inProgress",!1),Vs(this,"measuredRows",0),Vs(this,"rowHeightsMap",new Ts),this.hot.rowIndexMapper.registerMap(b8,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Tu(this,Ip,ET).call(this,n,r,i))}isEnabled(){const e=this.hot.getSettings()[nd];return e===!0||Ve(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Tu(e,bT,E8).call(e,...r)}),this.addHook("beforeChangeRender",n=>Tu(this,RT,T8).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Tu(this,yT,R8).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Tu(this,Ip,ET).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}pe(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){const a=this.samplesGenerator.generateRowSamples(s,o);E(a,l=>{let[u,c]=l;return this.ghostTable.addRow(u,c)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0;const r=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot){Oc(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+uc.CALCULATION_STEP,r)},e),n=n+uc.CALCULATION_STEP+1,n<r?i=$g(o):(Oc(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){const e=this.hot.getSettings()[nd],n=e&&It(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&It(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){ps(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){const e=this.hot.getSettings()[nd];let n=uc.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return Ve(e)&&(n=e.syncLimit,lS(n)?n=PS(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){const e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){const{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{pe(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!vr(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function R8(){const t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){const i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function ET(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function E8(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function T8(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}const{getListWithInsertedItems:_8,getListWithRemovedItems:M8}=U1("physicallyIndexed");class A8 extends Ta{constructor(){super(e=>e)}insert(e,n){const r=iy(this.indexedValues,n);this.indexedValues=_8(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=M8(this.indexedValues,e);this.indexedValues=ry(n,e),super.remove(e)}}const O8=A8,{getListWithInsertedItems:P8,getListWithRemovedItems:I8}=U1("physicallyIndexed");class x8 extends Ta{constructor(){super(e=>e)}insert(e,n){this.indexedValues=P8(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=I8(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}const H8=x8;function D8(t,e){N8(t,e),e.add(t)}function N8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function L8(t,e,n){return e=$8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $8(t){var e=k8(t,"string");return typeof e=="symbol"?e:String(e)}function k8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function F8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const xp="bindRowsWithHeaders",W8=210,V8="loose",B8=new Map([["loose",O8],["strict",H8]]);var TT=new WeakSet;class U8 extends it{constructor(){super(...arguments),D8(this,TT),L8(this,"headerIndexes",null)}static get PLUGIN_KEY(){return xp}static get PLUGIN_PRIORITY(){return W8}isEnabled(){return!!this.hot.getSettings()[xp]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[xp];typeof e!="string"&&(e=V8);const n=B8.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>F8(this,TT,G8).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function G8(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function rd(t,e){$H(t,e),e.add(t)}function z8(t,e,n){$H(t,e),e.set(t,n)}function $H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _T(t,e,n){return e=Y8(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y8(t){var e=j8(t,"string");return typeof e=="symbol"?e:String(e)}function j8(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MT(t,e){var n=kH(t,e,"get");return K8(t,n)}function K8(t,e){return e.get?e.get.call(t):e.value}function id(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Hp(t,e,n){var r=kH(t,e,"set");return X8(t,r,n),n}function kH(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function X8(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Jd="collapsibleColumns",q8=290,Z8=["nestedHeaders"],Hl="collapsibleIndicator",AT=Jd,OT=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var ja=new WeakMap,PT=new WeakSet,IT=new WeakSet,xT=new WeakSet,HT=new WeakSet;class Q8 extends it{constructor(){super(...arguments),rd(this,HT),rd(this,xT),rd(this,IT),rd(this,PT),_T(this,"nestedHeadersPlugin",null),_T(this,"headerStateManager",null),z8(this,ja,{writable:!0,value:null})}static get PLUGIN_KEY(){return Jd}static get PLUGIN_PRIORITY(){return q8}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Jd,...Z8]}isEnabled(){return!!this.hot.getSettings()[Jd]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||gt("You need to configure the Nested Headers plugin in order to use collapsible headers."),Hp(this,ja,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>id(this,xT,t5).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return id(e,HT,n5).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return id(e,PT,J8).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>id(this,IT,e5).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Hp(this,ja,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:AT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(AT)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};pe(0,e-1,s=>{const a=n.childNodes[s],l=r.childNodes[s],u=i?i.childNodes[s]:null;pe(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${Hl}`);o(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${Hl}`),o(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${Hl}`),o(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(r=>{const{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!OT.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const r=vr(e,d=>{let{row:f}=d;return f<0});let i=r.length>0;E(r,d=>{var f;let{row:p,col:v}=d;const{collapsible:S,isCollapsed:y}=(f=this.headerStateManager.getHeaderSettings(p,v))!==null&&f!==void 0?f:{};if(!S||y&&n==="collapse"||!y&&n==="expand")return i=!1,!1});const o=[],s=[];i&&E(r,d=>{let{row:f,col:p}=d;const{colspanCompensation:v,affectedColumns:S,rollbackModification:y}=this.headerStateManager.triggerNodeModification(n,f,p);v>0&&(s.push(...S),o.push(y))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=sS([...a,...s]):n==="expand"&&(l=vr(a,d=>!s.includes(d)));const u=OT.get(n);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){E(o,d=>{d()});return}this.hot.batchExecution(()=>{E(s,d=>{MT(this,ja).setValueAtIndex(this.hot.toPhysicalColumn(d),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return MT(this,ja).getHiddenIndexes()}destroy(){Hp(this,ja,null),super.destroy()}}function J8(t,e,n){var r;const{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${Hl}`);if(Ra(e,[xr("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),Z(u,Hl),e.querySelector("div:first-child").appendChild(u)),Le(u,["collapsed","expanded"]),s?(Z(u,"collapsed"),ms(u,"+"),l&&Te(e,...xr(!1))):(Z(u,"expanded"),ms(u,"-"),l&&Te(e,...xr(!0))),l&&Te(u,...Ao());else{var c;(c=u)===null||c===void 0||c.remove()}}function e5(t,e){Pe(t.target,Hl)&&(Pe(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Pe(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),kr(t))}function t5(){this.updatePlugin()}function n5(t,e){e||this.updatePlugin()}function Bs(t,e,n){return e=r5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r5(t){var e=i5(t,"string");return typeof e=="symbol"?e:String(e)}function i5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const o5=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],s5=!1,a5=!0,l5=!0;class u5{constructor(e,n){Bs(this,"hot",void 0),Bs(this,"sortingStates",new Gg),Bs(this,"sortEmptyCells",s5),Bs(this,"indicator",a5),Bs(this,"headerAction",l5),Bs(this,"compareFunctionFactory",void 0),Bs(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Ve(e)&&Ge(e,(n,r)=>{o5.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Ve(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return{column:this.hot.toVisualColumn(r),...i}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(ue(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}const kf="asc",Ff="desc",FH="colHeader";function c5(t){if(Ve(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[kf,Ff].includes(n)}function h5(t){if(t.some(n=>c5(n)===!1))return!1;const e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function DT(t){if(t!==Ff)return t===kf?Ff:kf}function WH(t){return t.querySelector(`.${FH}`)}function VH(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function Zb(t,e,n){return t===-1&&e>=0&&ws(n)===!1}const d5="ascending",f5="descending",BH="indicatorDisabled",UH="columnSorting",GH="sortAction",zH=new Map([[kf,d5],[Ff,f5]]);function g5(t,e,n,r){const i=[UH];if(r&&i.push(GH),n===!1)return i.push(BH),i;const o=t.getSortOrderOfColumn(e);return ue(o)&&i.push(zH.get(o)),i}function m5(){return Array.from(zH.values()).concat(GH,BH,UH)}function YH(t,e,n){const r=e.locale;return function(i,o){const{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?Li:Zt(i)?Zt(o)?Li:s&&t==="asc"?kt:Ft:Zt(o)?s&&t==="asc"?Ft:kt:isNaN(i)&&!isNaN(o)?t==="asc"?Ft:kt:!isNaN(i)&&isNaN(o)||(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o)?t==="asc"?kt:Ft:i>o?t==="asc"?Ft:kt:Li}}const jH="default";function p5(t,e,n){return function(r,i){const o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return Li;if(a){if(Zt(r))return t==="asc"?kt:Ft;if(Zt(i))return t==="asc"?Ft:kt}return isNaN(o)?Ft:isNaN(s)?kt:o<s?t==="asc"?kt:Ft:o>s?t==="asc"?Ft:kt:Li}}const w5="numeric";function v5(t,e,n){const r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){const l=Zt(s),u=Zt(a),c=l?i:s,h=u?i:a,d=c===i||c===r,f=h===i||h===r;if(o===!1){if(l&&u===!1)return Ft;if(l===!1&&u)return kt}return d===!1&&f?t==="asc"?kt:Ft:d&&f===!1?t==="asc"?Ft:kt:d===!1&&f===!1?YH(t,e,n)(s,a):c===i&&h===r?t==="asc"?kt:Ft:c===r&&h===i?t==="asc"?Ft:kt:Li}}const C5="checkbox";function S5(t,e,n){return function(r,i){const{sortEmptyCells:o}=n;if(r===i)return Li;if(Zt(r))return Zt(i)?Li:o&&t==="asc"?kt:Ft;if(Zt(i))return o&&t==="asc"?Ft:kt;const s=e.dateFormat,a=q(r,s),l=q(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?kt:Ft:l.isBefore(a)?t==="asc"?Ft:kt:Li:kt:Ft}}const y5="date",{register:Zg,getItem:NT,hasItem:b5}=ci("sorting.compareFunctionFactory"),{register:KH,getItem:R5}=ci("sorting.mainSortComparator");function XH(t){return b5(t)?NT(t):NT(jH)}Zg(w5,p5);Zg(C5,v5);Zg(y5,S5);Zg(jH,YH);const Li=0,kt=-1,Ft=1;function E5(t,e){const n=R5(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function T5(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:XH(u.type))(l,u,d)(c,h)}(0)}}function od(t,e){_5(t,e),e.add(t)}function _5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e,n){return e=M5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function M5(t){var e=A5(t,"string");return typeof e=="symbol"?e:String(e)}function A5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Wf="columnSorting",O5=50,Vf="append",P5="replace",LT=Wf;KH(Wf,T5);fe.getSingleton().register("beforeColumnSort");fe.getSingleton().register("afterColumnSort");var ef=new WeakSet,$T=new WeakSet,kT=new WeakSet,FT=new WeakSet;class qH extends it{constructor(){super(...arguments),od(this,FT),od(this,kT),od(this,$T),od(this,ef),sd(this,"columnStatesManager",null),sd(this,"columnMetaCache",null),sd(this,"pluginKey",Wf),sd(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Wf}static get PLUGIN_PRIORITY(){return O5}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new u5(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Ts(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>Rl(this,$T,I5).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rl(e,FT,H5).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>Rl(this,ef,Zv).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Rl(e,kT,x5).call(e,...r)}),this.hot.view&&Rl(this,ef,Zv).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,r)=>{const i=WH(r);VH(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:LT})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(LT)}sort(e){const n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new G1),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ue(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return h5(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let{column:o,...s}=i;return{column:this.hot.toPhysicalColumn(o),...s}};n.initialConfig=Ue(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,r=i=>{let{column:o,...s}=i;return{column:this.hot.toVisualColumn(o),...s}};return ue(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Ue(n.initialConfig,r)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(ue(n)){const i=DT(n);return ue(i)?{column:e,sortOrder:i}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:DT()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Vf;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(Ct(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===Vf)return[...o.slice(0,r),...o.slice(r+1),s];if(n===P5)return[...o.slice(0,r),s,...o.slice(r+1)]}return ue(s)?o.concat(s):o}getPluginColumnConfig(e){if(Ve(e)){const n=e[this.pluginKey];if(Ve(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):vt(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}const n=[],r=this.hot.countRows(),i=u=>Ue(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(r);u+=1)n.push([this.hot.toPhysicalRow(u)].concat(i(u)));const o=Ue(n,u=>u[0]);E5(n,this.pluginKey,Ue(e,u=>u.sortOrder),Ue(e,u=>this.getFirstCellSettings(u.column)));for(let u=n.length;u<r;u+=1)n.push([u].concat(i(u)));const s=Ue(n,u=>u[0]),a=new Map(Ue(o,(u,c)=>[u,s[c]])),l=Ue(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Ve(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Ve(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Le(e,m5()),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Z(e,g5(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ue(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Pe(e.target,FH)}onAfterOnCellMouseDown(e,n){Zb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function Zv(){const t=this.getAllSavedSortSettings();if(Ve(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function I5(t,e){const n=WH(e);if(VH(t,e)===!1||n===null)return;const r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){const s=this.columnStatesManager.getSortOrderOfColumn(t);Te(e,...bz(s?`${s}ending`:"none"))}}function x5(t){t===!0&&this.hot.view&&Rl(this,ef,Zv).call(this)}function H5(t,e,n,r){Zb(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function Us(t,e,n){return e=D5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D5(t){var e=N5(t,"string");return typeof e=="symbol"?e:String(e)}function N5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L5{constructor(e,n){Us(this,"plugin",void 0),Us(this,"hot",void 0),Us(this,"endpoints",[]),Us(this,"settings",void 0),Us(this,"settingsType","array"),Us(this,"currentEndpoint",null),Us(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),E(r,i=>{const o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();E(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=n;E(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*r),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*r)}),this.resetAllEndpoints(u,!c),c?E(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):E(u,d=>{this.shiftEndpointCoordinates(d,h)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){E(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,r=[],i=[];E(n,o=>{const s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),E(i,o=>{let s=[];E(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,E(e.ranges,r=>{E(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],E(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],E(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],E(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&E(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),E(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const s=e.roundFloat;let a=0;Number.isInteger(s)&&(a=Math.min(Math.max(0,s),100)),e.result=e.result.toFixed(a)}r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){gt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}const $5=L5;function Dp(t){return t==null||isNaN(t)}function Np(t,e){k5(t,e),e.add(t)}function k5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F5(t,e,n){return e=W5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W5(t){var e=V5(t,"string");return typeof e=="symbol"?e:String(e)}function V5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lp(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const $p="columnSummary",B5=220;var WT=new WeakSet,VT=new WeakSet,BT=new WeakSet;class U5 extends it{constructor(){super(...arguments),Np(this,BT),Np(this,VT),Np(this,WT),F5(this,"endpoints",null)}static get PLUGIN_KEY(){return $p}static get PLUGIN_PRIORITY(){return B5}isEnabled(){return!!this.hot.getSettings()[$p]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[$p],this.endpoints=new $5(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lp(e,WT,G5).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lp(e,VT,z5).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Lp(e,BT,Y5).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ge(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=Dp(o)?null:o,o!==null){const a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Ge(e.ranges,i=>{const o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=Dp(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=Dp(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0;const r=e.ranges;return Ge(r,i=>{const o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){const n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){const r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ht`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function G5(){this.endpoints.initEndpoints()}function z5(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function Y5(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Ka(t,e,n){return e=j5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j5(t){var e=K5(t,"string");return typeof e=="symbol"?e:String(e)}function K5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ol{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){Ka(this,"rootDocument",void 0),Ka(this,"isRtl",!1),Ka(this,"container",null),Ka(this,"editor",void 0),Ka(this,"editorStyle",void 0),Ka(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:ft(this.getInputElement()),height:xt(this.getInputElement())}}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Z(this.container,Ol.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Z(e,Ol.CLASS_EDITOR),Z(n,Ol.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${Ol.CLASS_INPUT}`)}destroy(){const e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}}const X5=Ol;function kp(t,e,n){return e=q5(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q5(t){var e=Z5(t,"string");return typeof e=="symbol"?e:String(e)}function Z5(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Q5=250,J5=250;class ZH{constructor(e){kp(this,"wasLastActionShow",!0),kp(this,"showDebounced",null),kp(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},J5)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Q5;this.showDebounced=Dg(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}pt(ZH,ar);const eZ=ZH;function tZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function nZ(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Gs(t,e){const n={};return E(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Ko(t,e,n,r,i){E(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&rZ(s,a,e,n,r,i)})})}function rZ(t,e,n,r,i,o){const s=i(t,e);let a=r;s.className&&(n==="vertical"?a=tZ(s.className,r):a=nZ(s.className,r)),o(t,e,"className",a)}function ao(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Pi(t,e){let n=!1;return Array.isArray(t)&&E(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function Qg(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}const Ye="---------";function iZ(){return{name:Ye}}const Ar="alignment";function oZ(){return{key:Ar,name(){return this.getTranslatedPhrase(Py)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ar}:left`,name(){let t=this.getTranslatedPhrase(Iy);return Pi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=ao(t)),t},callback(){const t=this.getSelectedRange(),e=Gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Ko(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:center`,name(){let t=this.getTranslatedPhrase(xy);return Pi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=ao(t)),t},callback(){const t=this.getSelectedRange(),e=Gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Ko(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:right`,name(){let t=this.getTranslatedPhrase(Hy);return Pi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=ao(t)),t},callback(){const t=this.getSelectedRange(),e=Gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Ko(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:justify`,name(){let t=this.getTranslatedPhrase(Dy);return Pi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=ao(t)),t},callback(){const t=this.getSelectedRange(),e=Gs(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Ko(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Ye},{key:`${Ar}:top`,name(){let t=this.getTranslatedPhrase(Ny);return Pi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=ao(t)),t},callback(){const t=this.getSelectedRange(),e=Gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Ko(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:middle`,name(){let t=this.getTranslatedPhrase(Ly);return Pi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=ao(t)),t},callback(){const t=this.getSelectedRange(),e=Gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Ko(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${Ar}:bottom`,name(){let t=this.getTranslatedPhrase($y);return Pi(this.getSelectedRange(),(n,r)=>{const i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=ao(t)),t},callback(){const t=this.getSelectedRange(),e=Gs(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Ko(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}const Jg="clear_column";function sZ(){return{key:Jg,name(){return this.getTranslatedPhrase(py)},callback(t,e){const n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const ih="col_left";function aZ(){return{key:ih,name(){return this.getTranslatedPhrase(uy)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const oh="col_right";function lZ(){return{key:oh,name(){return this.getTranslatedPhrase(cy)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const sh="make_read_only";function uZ(){return{key:sh,name(){let t=this.getTranslatedPhrase(my);return Pi(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=ao(t)),t},callback(){const t=this.getSelectedRange(),e=Pi(t,(n,r)=>this.getCellMeta(n,r).readOnly);E(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const em="redo";function cZ(){return{key:em,name(){return this.getTranslatedPhrase(gy)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const ah="remove_col";function hZ(){return{key:ah,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(dy,e)},callback(){this.alter("remove_col",sq(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const tm="remove_row";function dZ(){return{key:tm,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(hy,e)},callback(){this.alter("remove_row",aq(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const nm="row_above";function fZ(){return{key:nm,name(){return this.getTranslatedPhrase(ay)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const rm="row_below";function gZ(){return{key:rm,name(){return this.getTranslatedPhrase(ly)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Hc="no_items";function mZ(){return{key:Hc,name(){return this.getTranslatedPhrase(sy)},disabled:!0,isCommand:!1}}const im="undo";function pZ(){return{key:im,name(){return this.getTranslatedPhrase(fy)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const wZ=[nm,rm,ih,oh,Jg,tm,ah,im,em,sh,Ar,Ye,Hc],vZ={[Ye]:iZ,[Hc]:mZ,[nm]:fZ,[rm]:gZ,[ih]:aZ,[oh]:lZ,[Jg]:sZ,[tm]:dZ,[ah]:hZ,[im]:pZ,[em]:cZ,[sh]:uZ,[Ar]:oZ};function QH(){const t={};return Ge(vZ,(e,n)=>{t[n]=e()}),t}function CZ(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(My):this.getTranslatedPhrase(_y)},callback(){const e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function SZ(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Ay)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function yZ(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(Oy);return Pi(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,tf))?ao(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){const i=!!t.getCommentMeta(n,r,tf);t.updateCommentMeta(n,r,{[tf]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function vi(t,e){JH(t,e),e.add(t)}function zs(t,e,n){JH(t,e),e.set(t,n)}function JH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bZ(t,e,n){return e=RZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RZ(t){var e=EZ(t,"string");return typeof e=="symbol"?e:String(e)}function EZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ci(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function mo(t,e,n){var r=eD(t,e,"set");return TZ(t,r,n),n}function TZ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Qe(t,e){var n=eD(t,e,"get");return _Z(t,n)}function eD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _Z(t,e){return e.get?e.get.call(t):e.value}const cc="comments",MZ=60,lo="comment",Zu="value",tD="style",tf="readOnly",ad=cc,Qv=`plugin:${cc}`;var Rt=new WeakMap,Zr=new WeakMap,om=new WeakMap,nf=new WeakMap,Bf=new WeakMap,Jv=new WeakMap,Uf=new WeakMap,UT=new WeakSet,GT=new WeakSet,zT=new WeakSet,YT=new WeakSet,jT=new WeakSet,KT=new WeakSet,XT=new WeakSet,qT=new WeakSet,ZT=new WeakSet,QT=new WeakSet;class AZ extends it{constructor(){super(...arguments),vi(this,QT),vi(this,ZT),vi(this,qT),vi(this,XT),vi(this,KT),vi(this,jT),vi(this,YT),vi(this,zT),vi(this,GT),vi(this,UT),bZ(this,"range",{}),zs(this,Rt,{writable:!0,value:null}),zs(this,Zr,{writable:!0,value:null}),zs(this,om,{writable:!0,value:!1}),zs(this,nf,{writable:!0,value:!1}),zs(this,Bf,{writable:!0,value:{}}),zs(this,Jv,{writable:!0,value:null}),zs(this,Uf,{writable:!0,value:""})}static get PLUGIN_KEY(){return cc}static get PLUGIN_PRIORITY(){return MZ}isEnabled(){return!!this.hot.getSettings()[cc]}enablePlugin(){this.enabled||(Qe(this,Rt)||mo(this,Rt,new X5(this.hot.rootDocument,this.hot.isRtl())),Qe(this,Zr)||mo(this,Zr,new eZ(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>Ci(this,YT,xZ).call(this,e,s)),this.addHook("afterScroll",()=>Ci(this,QT,kZ).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>Ci(this,ZT,$Z).call(this,e)),Qe(this,Zr).addLocalHook("hide",()=>this.hide()),Qe(this,Zr).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Qe(this,Zr).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(Qv);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();mo(this,nf,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(Qv),this.hot._registerTimeout(()=>{mo(this,nf,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!Qe(this,Rt).isVisible()},group:ad}),r.addShortcut({keys:[["Escape"]],callback:()=>{Qe(this,Rt).setValue(Qe(this,Uf)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Qe(this,Rt).isVisible()},group:ad}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&Qe(this,Rt).isVisible()},group:ad})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ad)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Ci(this,GT,PZ).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Ci(this,UT,OZ).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ci(this,zT,IZ).call(this)),this.eventManager.addEventListener(n,"focus",()=>Ci(this,KT,DZ).call(this)),this.eventManager.addEventListener(n,"blur",()=>Ci(this,jT,HZ).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>Ci(this,XT,NZ).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>Ci(this,qT,LZ).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=gs(e.target,"TD","TBODY");return!!(n&&Pe(n,"htCommentCell")&&gs(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=Qe(this,Rt).getValue();let r="";e!=null?r=e:n!=null&&(r=n);const i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Zu]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,lo),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){const e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Zu)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Zu)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Qe(this,Zr).cancelHiding(),Qe(this,Rt).setValue((e=i[lo]?i[lo][Zu]:null)!==null&&e!==void 0?e:""),Qe(this,Rt).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){Qe(this,Rt).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Qe(this,Rt).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(s),u=o.getRenderableFromVisualIndex(a);const c=l===null;Qe(this,Rt).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),u===null&&(u=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(n=u)!==null&&n!==void 0?n:0;const{rootWindow:f,view:{_wt:p}}=this.hot,{wtTable:v}=p,S=p.getCell({row:l,col:u},!0),y=this.getCommentMeta(s,a,tD);y?Qe(this,Rt).setSize(y.width,y.height):Qe(this,Rt).resetSize();const R=d?0:v.getStretchedColumnWidth(u),T=c&&!h?xt(S):0,{left:A,top:M,width:L,height:B}=S.getBoundingClientRect(),{width:K,height:U}=Qe(this,Rt).getSize(),{innerWidth:G,innerHeight:Q}=this.hot.rootWindow,re=this.hot.rootDocument.documentElement;let ne=A+f.scrollX+R,ce=M+f.scrollY+T;this.hot.isRtl()&&(ne-=K+R),this.hot.isLtr()&&A+L+K>G?ne=A+f.scrollX-K-1:this.hot.isRtl()&&ne<-(re.scrollWidth-re.clientWidth)&&(ne=A+f.scrollX+R+1),M+U>Q&&(ce-=U-B+1),Qe(this,Rt).setPosition(ne,ce),Qe(this,Rt).setReadOnlyState(this.getCommentMeta(s,a,tf))}focusEditor(){Qe(this,Rt).focus()}updateCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n)[lo];let o;i?(o=Tn(i),Zc(o,r)):o=r,this.hot.setCellMeta(e,n,lo,o)}getCommentMeta(e,n,r){const i=this.hot.getCellMeta(e,n);if(i[lo])return i[lo][r]}addToContextMenu(e){e.items.push({name:Ye},CZ(this),SZ(this),yZ(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[cc];if(Ve(e))return e.displayDelay}getEditorInputElement(){return Qe(this,Rt).getInputElement()}destroy(){Qe(this,Rt)&&Qe(this,Rt).destroy(),Qe(this,Zr)&&Qe(this,Zr).destroy(),super.destroy()}}function OZ(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Qe(this,om)&&!this.targetIsCommentTextArea(t)){const e=gs(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function PZ(t){const{rootDocument:e}=this.hot;if(!(Qe(this,om)||Qe(this,Rt).isFocused()||Pe(t.target,"wtBorder")||Qe(this,Jv)===t.target||!Qe(this,Rt)))if(mo(this,Jv,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));Qe(this,Zr).show(n)}else us(t.target,e)&&!this.targetIsCommentTextArea(t)&&Qe(this,Zr).hide()}function IZ(){mo(this,om,!1)}function xZ(t,e){e[lo]&&e[lo][Zu]&&Z(t,e.commentedCellClassName)}function HZ(){mo(this,Uf,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function DZ(){mo(this,Uf,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(Qv)}function NZ(t){mo(this,Bf,{width:ft(t.target),height:xt(t.target)})}function LZ(t){const e=ft(t.target),n=xt(t.target);(e!==Qe(this,Bf).width+1||n!==Qe(this,Bf).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[tD]:{width:e,height:n}})}function $Z(t){Qe(this,Rt).isVisible()&&kr(t)}function kZ(){Qe(this,nf)||this.hide()}var JT=dg,FZ=TypeError,WZ=function(t,e){if(!delete t[e])throw new FZ("Cannot delete property "+JT(e)+" of "+JT(t))},VZ=Es,BZ=gg,UZ=Bc,GZ=JP,zZ=WZ,YZ=eI,jZ=[].unshift(0)!==1,KZ=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},XZ=jZ||!KZ();VZ({target:"Array",proto:!0,arity:1,forced:XZ},{unshift:function(e){var n=BZ(this),r=UZ(n),i=arguments.length;if(i){YZ(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:zZ(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return GZ(n,r+i)}});function Fp(t,e,n){return e=qZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qZ(t){var e=ZZ(t,"string");return typeof e=="symbol"?e:String(e)}function ZZ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nD{constructor(e){Fp(this,"hot",void 0),Fp(this,"commands",{}),Fp(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const o=e.split(":"),s=o[0],a=o.length===2?o[1]:null;let l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=QZ(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||It(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),r.unshift(o.join(":")),E(u,c=>c.apply(this.hot,r))}}function QZ(t,e){let n;return E(e,r=>{const i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}function Wp(t,e,n){return e=JZ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JZ(t){var e=eQ(t,"string");return typeof e=="symbol"?e:String(e)}function eQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rD{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Wp(this,"hot",void 0),Wp(this,"predefinedItems",QH()),Wp(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ge(e,(r,i)=>{let o="";r.name===Ye?(n[Ye]=r,o=Ye):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return tQ(e,this.defaultOrderPattern,this.predefinedItems)}}function tQ(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Ve(i)?Ge(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Ve(o)?jt(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):E(i,(o,s)=>{let a=n[o];!a&&wZ.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Ve(o)&&jt(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}function ko(t,e,n){return e=nQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nQ(t){var e=rQ(t,"string");return typeof e=="symbol"?e:String(e)}function rQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iQ{constructor(e,n){ko(this,"top",void 0),ko(this,"topRelative",void 0),ko(this,"left",void 0),ko(this,"leftRelative",void 0),ko(this,"scrollTop",void 0),ko(this,"scrollLeft",void 0),ko(this,"cellHeight",void 0),ko(this,"cellWidth",void 0);const r=n.scrollY,i=n.scrollX;let o,s,a,l,u,c;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function _u(t,e,n){oQ(t,e),e.set(t,n)}function oQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ke(t,e){var n=iD(t,e,"get");return sQ(t,n)}function sQ(t,e){return e.get?e.get.call(t):e.value}function ld(t,e,n){var r=iD(t,e,"set");return aQ(t,r,n),n}function iD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aQ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Hn=new WeakMap,Fo=new WeakMap,dn=new WeakMap,Vp=new WeakMap,Xa=new WeakMap;class lQ{constructor(e){_u(this,Hn,{writable:!0,value:void 0}),_u(this,Fo,{writable:!0,value:void 0}),_u(this,dn,{writable:!0,value:void 0}),_u(this,Vp,{writable:!0,value:!1}),_u(this,Xa,{writable:!0,value:{above:0,below:0,left:0,right:0}}),ld(this,Vp,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Ke(this,Xa)[e]=n,this}setElement(e){return ld(this,Hn,e),this}setParentElement(e){return ld(this,Fo,e),this}updatePosition(e){ld(this,dn,new iQ(e,Ke(this,Hn).ownerDocument.defaultView)),Ke(this,Vp)?(Ke(this,dn).fitsBelow(Ke(this,Hn))?this.setPositionBelowCursor():Ke(this,dn).fitsAbove(Ke(this,Hn))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Ke(this,Hn).dir==="rtl"?Ke(this,dn).fitsOnLeft(Ke(this,Hn))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Ke(this,dn).fitsOnRight(Ke(this,Hn))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Ke(this,Xa).above+Ke(this,dn).top-Ke(this,Hn).offsetHeight;Ke(this,Fo)&&(e=Ke(this,dn).top+Ke(this,dn).cellHeight-Ke(this,Hn).offsetHeight+3),Ke(this,Hn).style.top=`${e}px`}setPositionBelowCursor(){let e=Ke(this,Xa).below+Ke(this,dn).top+1;Ke(this,Fo)&&(e=Ke(this,dn).top-1),Ke(this,Hn).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Ke(this,dn).left;if(Ke(this,Fo)){const{right:n}=Ke(this,Fo).getBoundingClientRect();e+=Ke(this,dn).cellWidth+n-(Ke(this,dn).left+Ke(this,dn).cellWidth)}else e+=Ke(this,Xa).right;Ke(this,Hn).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Ke(this,Xa).left+Ke(this,dn).left-Ke(this,Hn).offsetWidth;if(Ke(this,Fo)){const{left:n}=Ke(this,Fo).getBoundingClientRect();e-=Ke(this,dn).left-n}Ke(this,Hn).style.left=`${e}px`}}function oD(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t;const o=new Set;let s=or(e,-1,p()-1);function a(S,y){const R=p()-1;return S<0&&(S=R),S>R&&(S=0),o.has(S)?-1:(o.add(S),r(S,!1)===!1&&(S=a(y===1?++S:--S,y)),S)}function l(S){S>-1&&S<p()&&r(S,!0)!==!1&&(s=S)}function u(){return s}function c(){p()>0&&(o.clear(),s=a(0,1))}function h(){p()>0&&(o.clear(),s=a(p()-1,-1))}function d(){p()>0&&(o.clear(),s=a(++s,1))}function f(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(n(),0)}function v(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:p,clear:v}}function uQ(t){return Ue(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function eC(t){return It(t,"submenu")}function tC(t){return new RegExp(Ye,"i").test(t.name)}function rf(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function e_(t){return It(t,"disableSelection")}function cQ(t){return Pe(t,"htSeparator")}function hQ(t){return Pe(t,"htSubmenu")}function dQ(t){return Pe(t,"htDisabled")}function fQ(t){return Pe(t,"htSelectionDisabled")}function gQ(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function sD(t,e){const n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function mQ(t,e){let n=t.slice(0);return n.reverse(),n=sD(n,e),n.reverse(),n}function pQ(t){const e=[];return E(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function wQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ye,n=t.slice(0);return n=sD(n,e),n=mQ(n,e),n=pQ(n),n}function vQ(t){return oD({size:()=>t.countRows(),onItemSelect(e,n){const r=t.getCell(e,0);if(!r||cQ(r)||dQ(r)||fQ(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function CQ(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const e=t.hotMenu.getSelectedLast();if(e){const n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{const n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const aD="menu",t_=aD;function SQ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];r(CQ(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function r(u,c){a(c).addShortcuts(u,{group:aD})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(p=>h.removeShortcutsByKeys(p))}),n.push({shortcuts:u,contextName:c}),r(u,c)}function o(){return[...n]}function s(u){return u?`${t_}:${u}`:t_}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=s(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(s(u))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function yQ(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;const a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),u=typeof s=="function"?s.call(t):s;if(li(n),Z(l,"htItemWrapper"),t.getSettings().ariaTags){const c=!rf(a,t)&&!e_(a)&&!tC(a);Te(n,[fz(),cS(u),...c?[Yl(-1)]:[],...rf(a,t)?[Sz()]:[],...eC(a)?[xr(!1)]:[]])}n.className="",n.appendChild(l),tC(a)?Z(n,"htSeparator"):typeof a.renderer=="function"?(Z(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,u))):Ea(l,u),rf(a,t)?Z(n,"htDisabled"):e_(a)?Z(n,"htSelectionDisabled"):eC(a)&&Z(n,"htSubmenu")}}function n_(t,e,n){bQ(t,e),e.set(t,n)}function bQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(t,e,n){return e=RQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RQ(t){var e=EQ(t,"string");return typeof e=="symbol"?e:String(e)}function EQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function r_(t,e,n){var r=lD(t,e,"set");return TQ(t,r,n),n}function TQ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Mu(t,e){var n=lD(t,e,"get");return _Q(t,n)}function lD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _Q(t,e){return e.get?e.get.call(t):e.value}const i_=215;var Au=new WeakMap,ud=new WeakMap;class Ql{constructor(e,n){var r=this;Si(this,"hot",void 0),Si(this,"options",void 0),Si(this,"eventManager",new Dr(this)),Si(this,"container",void 0),Si(this,"positioner",void 0),Si(this,"hotMenu",null),Si(this,"hotSubMenus",{}),Si(this,"parentMenu",void 0),Si(this,"menuItems",null),Si(this,"origOutsideClickDeselects",null),n_(this,Au,{writable:!0,value:void 0}),n_(this,ud,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:i_,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new lQ(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Mc(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Mu(this,Au)}getKeyboardShortcutsCtrl(){return Mu(this,ud)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Dg(a=>this.openSubMenu(a),300),n=this.options.minWidth||i_;let r=!1,i=vr(this.menuItems,a=>(a.key===Hc&&(r=!0),gQ(a,this.hot)));if(i.length<1&&!r)i.push(QH()[Hc]);else if(i.length===0)return;i=wQ(i,Ye);let o=!1;const s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ue(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:yQ(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Mu(this,Au).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===Ye?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),Mv()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Mv()||!ws(a))&&o&&this.hasSelectedItem()&&(go()||_S()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),r_(this,Au,vQ(this.hotMenu)),r_(this,ud,SQ(this)),Mu(this,ud).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Mu(this,Au).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedLast();if(n){const r=this.parentMenu.hotMenu.getCell(n[0],0);Te(r,[xr(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!hQ(n))return!1;const r=this.hotMenu.getSourceDataAtRow(e),i=new Ql(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&Te(n,[xr(!0)]),i}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Te(i,[xr(!1)])}}closeAllSubMenus(){E(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const r=this.hot.getSelectedRange(),i=r?uQ(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||tC(e)||rf(e,this.hot)||eC(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let r=e,i;return r&&(vt(r)&&(r=r.call(this.hot),r===null||Ct(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),Z(i,`htMenu ${this.options.className}`),r&&Z(i,r),this.options.container.appendChild(i)),i}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=Gt(n,(a,l)=>a+(l.name===Ye?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&Te(this.hotMenu.rootElement,[dz(),Yl(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!us(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!us(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Pe(e.target,"htCore")&&us(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}pt(Ql,ar);function cd(t,e){MQ(t,e),e.add(t)}function MQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bp(t,e,n){return e=AQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AQ(t){var e=OQ(t,"string");return typeof e=="symbol"?e:String(e)}function OQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Qu="contextMenu",PQ=70,o_=Qu;fe.getSingleton().register("afterContextMenuDefaultOptions");fe.getSingleton().register("beforeContextMenuShow");fe.getSingleton().register("afterContextMenuShow");fe.getSingleton().register("afterContextMenuHide");fe.getSingleton().register("afterContextMenuExecute");var s_=new WeakSet,a_=new WeakSet,l_=new WeakSet,u_=new WeakSet;class sm extends it{constructor(){super(...arguments),cd(this,u_),cd(this,l_),cd(this,a_),cd(this,s_),Bp(this,"commandExecutor",new nD(this.hot)),Bp(this,"itemsFactory",null),Bp(this,"menu",null)}static get PLUGIN_KEY(){return Qu}static get PLUGIN_PRIORITY(){return PQ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nm,rm,Ye,ih,oh,Ye,tm,ah,Ye,im,em,Ye,sh,Ye,Ar]}isEnabled(){return!!this.hot.getSettings()[Qu]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Qu];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new Ql(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>hd(this,a_,xQ).call(this)),this.menu.addLocalHook("afterOpen",()=>hd(this,l_,HQ).call(this)),this.menu.addLocalHook("afterClose",()=>hd(this,u_,DQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>hd(this,s_,IQ).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=Qg(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:o_})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(o_)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ge(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new rD(this.hot,sm.DEFAULT_ITEMS);const e=this.hot.getSettings()[Qu],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),E(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function IQ(t){const e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Pe(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(Pe(o,"current")&&Pe(o,"wtBorder"))))return;const s=Qg(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function xQ(){this.hot.runHooks("beforeContextMenuShow",this)}function HQ(){this.hot.runHooks("afterContextMenuShow",this)}function DQ(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}sm.SEPARATOR={name:Ye};function NQ(t){return{key:"copy",name(){return this.getTranslatedPhrase(wy)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function LQ(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),n=e?or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Sy,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function $Q(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),n=e?or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Cy,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function kQ(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),n=e?or(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(vy,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function FQ(t){return{key:"cut",name(){return this.getTranslatedPhrase(yy)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class WQ{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class VQ{constructor(){this.clipboardData=new WQ}}function c_(t,e){uD(t,e),e.add(t)}function qa(t,e,n){uD(t,e),e.set(t,n)}function uD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ln(t,e){var n=cD(t,e,"get");return BQ(t,n)}function BQ(t,e){return e.get?e.get.call(t):e.value}function Za(t,e,n){var r=cD(t,e,"set");return UQ(t,r,n),n}function cD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function UQ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wo=new WeakMap,Up=new WeakMap,Ou=new WeakMap,nC=new WeakMap,rC=new WeakMap,Pu=new WeakMap,fd=new WeakSet,h_=new WeakSet;class GQ{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;c_(this,h_),c_(this,fd),qa(this,Wo,{writable:!0,value:void 0}),qa(this,Up,{writable:!0,value:void 0}),qa(this,Ou,{writable:!0,value:void 0}),qa(this,nC,{writable:!0,value:void 0}),qa(this,rC,{writable:!0,value:void 0}),qa(this,Pu,{writable:!0,value:void 0}),Za(this,Up,n),Za(this,Ou,r),Za(this,nC,i),Za(this,rC,o),Za(this,Pu,s)}setSelectedRange(e){Za(this,Wo,e)}getCellsRange(){if(Ln(this,Up).call(this)===0||Ln(this,Ou).call(this)===0)return null;const{row:e,col:n}=Ln(this,Wo).getTopStartCorner(),{row:r,col:i}=Ln(this,Wo).getBottomEndCorner(),o=dd(this,h_,zQ).call(this,e,r),s=dd(this,fd,Gp).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Ln(this,Ou).call(this)===0||Ln(this,Pu).call(this)===0)return null;const{col:e}=Ln(this,Wo).getTopStartCorner(),{col:n}=Ln(this,Wo).getBottomEndCorner(),r=dd(this,fd,Gp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Ln(this,Ou).call(this)===0||Ln(this,Pu).call(this)===0)return null;const{col:e}=Ln(this,Wo).getTopStartCorner(),{col:n}=Ln(this,Wo).getBottomEndCorner(),r=dd(this,fd,Gp).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Ln(this,Pu).call(this),startCol:e,endRow:-1,endCol:r}}}function Gp(t,e){return Math.min(e,Math.max(t+Ln(this,rC).call(this)-1,t))}function zQ(t,e){return Math.min(e,Math.max(t+Ln(this,nC).call(this)-1,t))}function hD(t){const e=[],n=[];return E(t,r=>{const i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);pe(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});const s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);pe(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function yi(t,e){dD(t,e),e.add(t)}function Vo(t,e,n){dD(t,e),e.set(t,n)}function dD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Iu(t,e,n){return e=YQ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YQ(t){var e=jQ(t,"string");return typeof e=="symbol"?e:String(e)}function jQ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nr(t,e){var n=fD(t,e,"get");return KQ(t,n)}function KQ(t,e){return e.get?e.get.call(t):e.value}function Tr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function qr(t,e,n){var r=fD(t,e,"set");return XQ(t,r,n),n}function fD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function XQ(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("afterCopyLimit");fe.getSingleton().register("modifyCopyableRange");fe.getSingleton().register("beforeCut");fe.getSingleton().register("afterCut");fe.getSingleton().register("beforePaste");fe.getSingleton().register("afterPaste");fe.getSingleton().register("beforeCopy");fe.getSingleton().register("afterCopy");const gd="copyPaste",qQ=80,ZQ=["fragmentSelection"],d_=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var iC=new WeakMap,oC=new WeakMap,sC=new WeakMap,Qa=new WeakMap,md=new WeakMap,pd=new WeakMap,Ja=new WeakMap,Gf=new WeakMap,zp=new WeakSet,f_=new WeakSet,gD=new WeakSet,Qb=new WeakSet,g_=new WeakSet,m_=new WeakSet,p_=new WeakSet,w_=new WeakSet,v_=new WeakSet,C_=new WeakSet;class QQ extends it{constructor(){super(...arguments),yi(this,C_),yi(this,v_),yi(this,w_),yi(this,p_),yi(this,m_),yi(this,g_),yi(this,Qb),yi(this,gD),yi(this,f_),yi(this,zp),Iu(this,"columnsLimit",1/0),Iu(this,"rowsLimit",1/0),Iu(this,"pasteMode","overwrite"),Iu(this,"uiContainer",this.hot.rootDocument.body),Vo(this,iC,{writable:!0,value:!1}),Vo(this,oC,{writable:!0,value:!1}),Vo(this,sC,{writable:!0,value:!1}),Vo(this,Qa,{writable:!0,value:"cells-only"}),Vo(this,md,{writable:!0,value:!1}),Vo(this,pd,{writable:!0,value:!1}),Vo(this,Ja,{writable:!0,value:new GQ({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),Vo(this,Gf,{writable:!0,value:!1}),Iu(this,"copyableRanges",[])}static get PLUGIN_KEY(){return gd}static get SETTING_KEYS(){return[gd,...ZQ]}static get PLUGIN_PRIORITY(){return qQ}isEnabled(){return!!this.hot.getSettings()[gd]}enablePlugin(){var e=this;if(this.enabled)return;const{[gd]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,qr(this,iC,!!n.copyColumnHeaders),qr(this,oC,!!n.copyColumnGroupHeaders),qr(this,sC,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Tr(this,g_,tJ).call(this,o)),this.addHook("afterSelection",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Tr(e,m_,nJ).call(e,...s)}),this.addHook("afterSelectionEnd",()=>Tr(this,p_,rJ).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),ES()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Tr(e,w_,iJ).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Tr(e,v_,oJ).call(e,...s)}),this.addHook("afterSelection",()=>Tr(this,C_,sJ).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";qr(this,Qa,e),qr(this,md,!0),Tr(this,zp,S_).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){qr(this,pd,!0),Tr(this,zp,S_).call(this,"cut")}getRangedCopyableData(e){return ac(this.getRangedData(e))}getRangedData(e){const n=[],{rows:r,columns:i}=hD(e);return E(r,o=>{const s=[];E(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const r=new VQ;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}nr(this,Ja).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);nr(this,Qa)==="column-headers-only"?n.set("headers",nr(this,Ja).getMostBottomColumnHeadersRange()):(nr(this,Qa)==="with-column-headers"?n.set("headers",nr(this,Ja).getMostBottomColumnHeadersRange()):nr(this,Qa)==="with-column-group-headers"&&n.set("headers",nr(this,Ja).getAllColumnHeadersRange()),n.set("cells",nr(this,Ja).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=n.get("cells");if(r!==null&&r.isRangeTrimmed){const{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:u}=n.getBottomEndCorner();let c=s,h=a,d=s,f=a;for(;o.length<r||c<=l;){const{skipRowOnPaste:p,visualRow:v}=this.hot.getCellMeta(c,a);if(c=v+1,p===!0)continue;d=v,h=a;const S=[],y=o.length%r;for(;S.length<i||h<=u;){const{skipColumnOnPaste:R,visualCol:T}=this.hot.getCellMeta(s,h);if(h=T+1,R===!0)continue;f=T;const A=S.length%i;S.push(e[y][A])}o.push(S)}return qr(this,Gf,!0),this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,d,f]}onCopy(e){if(!this.hot.isListening()&&!nr(this,md)||this.isEditorOpened())return;this.setCopyableText(),qr(this,md,!1);const n=this.getRangedData(this.copyableRanges),r=Tr(this,f_,JQ).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){const o=ac(n);if(e&&e.clipboardData){const s=Iv(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[d_,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}qr(this,Qa,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!nr(this,pd)||this.isEditorOpened())return;this.setCopyableText(),qr(this,pd,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const i=ac(n);if(e&&e.clipboardData){const o=Iv(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[d_,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const a=Ag(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=n1(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=pq(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function S_(t){if(ES()){const e=this.hot.getSelectedRangeLast();if(e){const{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&Ix(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function JQ(t){const{rows:e}=hD(t);let n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function eJ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&CS(r)}}}function mD(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&SS(r)}}}function tJ(t){t.items.push({name:"---------"},NQ(this)),nr(this,iC)&&t.items.push(kQ(this)),nr(this,oC)&&t.items.push($Q(this)),nr(this,sC)&&t.items.push(LQ(this)),t.items.push(FQ(this))}function nJ(t,e,n,r,i){nr(this,Gf)&&(i.value=!0),qr(this,Gf,!1)}function rJ(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function iJ(){Tr(this,Qb,mD).call(this)}function oJ(){Tr(this,gD,eJ).call(this)}function sJ(){Tr(this,Qb,mD).call(this)}function pD(t,e){return`border_row${t}col${e}`}function Ju(){return{width:1,color:"#000"}}function po(){return{hide:!0}}function aJ(){return{width:1,color:"#000",cornerVisible:!1}}function Yp(t){if(ue(t.start)||ue(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ue(t.end)||ue(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function xu(t){return ue(t.start)&&(t.left=t.start),ue(t.end)&&(t.right=t.end),t}function jp(t,e){return{id:pD(t,e),border:aJ(),row:t,col:e,top:po(),bottom:po(),start:po(),end:po()}}function lJ(t,e){return It(e,"border")&&e.border&&(t.border=e.border),It(e,"top")&&ue(e.top)&&(e.top?(Ve(e.top)||(e.top=Ju()),t.top=e.top):(e.top=po(),t.top=e.top)),It(e,"bottom")&&ue(e.bottom)&&(e.bottom?(Ve(e.bottom)||(e.bottom=Ju()),t.bottom=e.bottom):(e.bottom=po(),t.bottom=e.bottom)),It(e,"start")&&ue(e.start)&&(e.start?(Ve(e.start)||(e.start=Ju()),t.start=e.start):(e.start=po(),t.start=e.start)),It(e,"end")&&ue(e.end)&&(e.end?(Ve(e.end)||(e.end=Ju()),t.end=e.end):(e.end=po(),t.end=e.end)),t}function Ro(t,e){let n=!1;return E(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;const s=t.getCellMeta(i,o).borders;if(s)if(e){if(!It(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function am(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function uJ(t){return t.some(e=>ue(e.left)||ue(e.right))}function cJ(t){return t.some(e=>ue(e.start)||ue(e.end))}const hJ=new Map([["left","start"],["right","end"]]);function dJ(t){var e;return(e=hJ.get(t))!==null&&e!==void 0?e:t}function fJ(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(Vy);return Ro(this,"bottom")&&(e=am(e)),e},callback(e,n){const r=Ro(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function gJ(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(By);return Ro(this,e)&&(n=am(n)),n},callback(n,r){const i=Ro(this,e);t.prepareBorder(r,e,i)}}}function mJ(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Uy)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!Ro(this)}}}function pJ(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(Wy);return Ro(this,e)&&(n=am(n)),n},callback(n,r){const i=Ro(this,e);t.prepareBorder(r,e,i)}}}function wJ(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(Fy);return Ro(this,"top")&&(e=am(e)),e},callback(e,n){const r=Ro(this,"top");t.prepareBorder(n,"top",r)}}}function y_(t,e){vJ(t,e),e.add(t)}function vJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CJ(t,e,n){return e=SJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SJ(t){var e=yJ(t,"string");return typeof e=="symbol"?e:String(e)}function yJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function b_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const of="customBorders",bJ=90;var R_=new WeakSet,E_=new WeakSet;class RJ extends it{constructor(){super(...arguments),y_(this,E_),y_(this,R_),CJ(this,"savedBorders",[])}static get PLUGIN_KEY(){return of}static get PLUGIN_PRIORITY(){return bJ}isEnabled(){return!!this.hot.getSettings()[of]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>b_(this,R_,EJ).call(this,e)),this.addHook("init",()=>b_(this,E_,TJ).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=Yp(n));const o=Fl(e),s=xc(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});E(e,a=>{s(a).forAll((l,u)=>{E(r,c=>{this.prepareBorderFromCustomAdded(l,u,i,dJ(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Fl(e),r=xc(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return E(e,o=>{r(o).forAll((s,a)=>{E(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(xu(l))})})}),i}clearBorders(e){e?this.setBorders(e):(E(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){const o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=jp(e,n);r&&(a=lJ(a,r),E(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",xu(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){const r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);pe(e.from.row,r,o=>{pe(e.from.col,i,s=>{const a=jp(o,s);let l=0;o===e.from.row&&It(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&It(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&It(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&It(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",xu(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const r=pD(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=jp(e,n):o=Yp(o),i?(o[r]=po(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",xu(o)))):(o[r]=Ju(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",xu(o)))}prepareBorder(e,n,r){E(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":pe(o.col,s.col,a=>{pe(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":pe(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":pe(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":pe(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":pe(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break}})}createCustomBorders(e){E(e,n=>{const r=Yp(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){const{top:n,bottom:r,start:i,end:o}=e;return Gt([n,r,i,o],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const n=Ue(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){E(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){E(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Ue(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):E(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return E(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const s=this.hot.view._wt.selectionManager.getBorderInstances(o);return E(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){const i=this.countHide(e);let o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):E(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){const a=this.hot.view._wt.selectionManager.getBorderInstances(s);E(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[of];if(Array.isArray(e)){const n=Tn(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=uJ(e),r=cJ(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function EJ(t){this.hot.getSettings()[of]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(ky)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[wJ(this),pJ(this),fJ(this),gJ(this),mJ(this)]}})}function TJ(){this.changeBorderSettings()}function _J(t,e){MJ(t,e),e.add(t)}function MJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kp(t,e,n){return e=AJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AJ(t){var e=OJ(t,"string");return typeof e=="symbol"?e:String(e)}function OJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const __="dragToScroll",PJ=100;var Xp=new WeakSet;class IJ extends it{constructor(){super(...arguments),_J(this,Xp),Kp(this,"boundaries",null),Kp(this,"callback",null),Kp(this,"listening",!1)}static get PLUGIN_KEY(){return __}static get PLUGIN_PRIORITY(){return PJ}isEnabled(){return!!this.hot.getSettings()[__]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>T_(this,Xp,M_).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>T_(this,Xp,M_).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=Mc(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function M_(t){if(ws(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,r)=>{var i,o;const s=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(s+Math.sign(n)*50,a+Math.sign(r)*20)}),this.listen()}function Ys(t,e){xJ(t,e),e.add(t)}function xJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qp(t,e,n){return e=HJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HJ(t){var e=DJ(t,"string");return typeof e=="symbol"?e:String(e)}function DJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("afterDropdownMenuDefaultOptions");fe.getSingleton().register("beforeDropdownMenuShow");fe.getSingleton().register("afterDropdownMenuShow");fe.getSingleton().register("afterDropdownMenuHide");fe.getSingleton().register("afterDropdownMenuExecute");const sf="dropdownMenu",NJ=230,aC="changeType",Zp=sf;var Jb=new WeakSet,A_=new WeakSet,O_=new WeakSet,P_=new WeakSet,I_=new WeakSet,x_=new WeakSet,H_=new WeakSet;class lm extends it{static get PLUGIN_KEY(){return sf}static get PLUGIN_PRIORITY(){return NJ}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[ih,oh,Ye,ah,Ye,Jg,Ye,sh,Ye,Ar]}constructor(e){super(e),Ys(this,H_),Ys(this,x_),Ys(this,I_),Ys(this,P_),Ys(this,O_),Ys(this,A_),Ys(this,Jb),qp(this,"commandExecutor",new nD(this.hot)),qp(this,"itemsFactory",null),qp(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>qo(this,O_,$J).call(this,n,r))}isEnabled(){return this.hot.getSettings()[sf]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new rD(this.hot,lm.DEFAULT_ITEMS);const n=this.hot.getSettings()[sf],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new Ql(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>qo(this,P_,kJ).call(this)),this.menu.addLocalHook("afterOpen",()=>qo(this,I_,FJ).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>qo(this,x_,WJ).call(this,o)),this.menu.addLocalHook("afterClose",()=>qo(this,H_,VJ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),E(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),o=Qg(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:Zp},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;const i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:Zp}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Zp)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>qo(this,A_,LJ).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ge(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function wD(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function LJ(t){if(t.stopPropagation(),Pe(t.target,aC)){const e=Qg(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function $J(t,e){const n=e.parentNode;if(!n)return;const r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;const o=e.querySelector(`.${aC}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const s=this.hot.rootDocument.createElement("button");s.className=aC,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(Te(s,[Ao(),cS(" ")]),Te(e,[wx("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function kJ(){this.hot.runHooks("beforeDropdownMenuShow",this)}function FJ(){this.hot.runHooks("afterDropdownMenuShow",this),qo(this,Jb,wD).call(this,this.menu)}function WJ(t){qo(this,Jb,wD).call(this,t)}function VJ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}lm.SEPARATOR={name:Ye};function D_(t,e,n){return e=BJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BJ(t){var e=UJ(t,"string");return typeof e=="symbol"?e:String(e)}function UJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GJ{constructor(e){D_(this,"hot",void 0),D_(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return pe(e,r,a=>{const l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(pe(n,i,u=>{!o.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),s.push(l))}),s}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();pe(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();pe(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}const zJ=GJ;function N_(t,e,n){return e=YJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YJ(t){var e=jJ(t,"string");return typeof e=="symbol"?e:String(e)}function jJ(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eR{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){N_(this,"dataProvider",void 0),N_(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=Vn(this.constructor.DEFAULT_OPTIONS);const r=new Date;return n=jt(Vn(eR.DEFAULT_OPTIONS),n),n=jt(n,e),n.filename=uS(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}}const KJ=eR,XJ=String.fromCharCode(13),qJ=String.fromCharCode(34),ZJ=String.fromCharCode(10);class QJ extends KJ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,n=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0;let a=e.bom?String.fromCharCode(65279):"";return i&&(r=Ue(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),E(n,(l,u)=>{u>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Wt(e);return r!==""&&(n||r.indexOf(XJ)>=0||r.indexOf(qJ)>=0||r.indexOf(ZJ)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}}const JJ=QJ,eee="csv",lC={[eee]:JJ};function tee(t,e,n){return typeof lC[t]=="function"?new lC[t](e,n):null}const nee="exportFile",ree=240;class iee extends it{static get PLUGIN_KEY(){return nee}static get PLUGIN_PRIORITY(){return ree}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),u=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,u)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!lC[e])throw new Error(`Export format type "${e}" is not supported.`);return tee(e,new zJ(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function el(t,e,n){return e=oee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oee(t){var e=see(t,"string");return typeof e=="symbol"?e:String(e)}function see(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lh{constructor(e,n){let{id:r,stateless:i=!0}=n;el(this,"hot",void 0),el(this,"id",void 0),el(this,"elements",[]),el(this,"hidden",!1),el(this,"stateId",""),el(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Gg)}getElements(){return this.elements}reset(){E(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),E(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}pt(lh,ar);const Dc={};function Cs(t,e){if(!Dc[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:r}=Dc[t];let i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function ua(t){if(!Dc[t])throw Error(`Filter condition "${t}" does not exist.`);return Dc[t].descriptor}function Kt(t,e,n){n.key=t,Dc[t]={condition:e,descriptor:n}}const un="none";function aee(){return!0}Kt(un,aee,{name:zg,inputsCount:0,showOperators:!1});const hc="empty";function lee(t){return Zt(t.value)}Kt(hc,lee,{name:qy,inputsCount:0,showOperators:!0});const af="not_empty";function uee(t,e){return!Cs(hc,e)(t)}Kt(af,uee,{name:Zy,inputsCount:0,showOperators:!0});const dc="eq";function cee(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale)===Wt(n)}Kt(dc,cee,{name:Qy,inputsCount:1,showOperators:!0});const lf="neq";function hee(t,e){return!Cs(dc,e)(t)}Kt(lf,hee,{name:Jy,inputsCount:1,showOperators:!0});const vD="gt";function dee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}Kt(vD,dee,{name:ib,inputsCount:1,showOperators:!0});const CD="gte";function fee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}Kt(CD,fee,{name:ob,inputsCount:1,showOperators:!0});const SD="lt";function gee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}Kt(SD,gee,{name:sb,inputsCount:1,showOperators:!0});const yD="lte";function mee(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}Kt(yD,mee,{name:ab,inputsCount:1,showOperators:!0});const tR="date_after";function pee(t,e){let[n]=e;const r=q(t.value,t.meta.dateFormat),i=q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}Kt(tR,pee,{name:cb,inputsCount:1,showOperators:!0});const nR="date_before";function wee(t,e){let[n]=e;const r=q(t.value,t.meta.dateFormat),i=q(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}Kt(nR,wee,{name:hb,inputsCount:1,showOperators:!0});const zf="between";function vee(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){const s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){const s=Cs(nR,[o]),a=Cs(tR,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}Kt(zf,vee,{name:lb,inputsCount:2,showOperators:!0});const bD="not_between";function Cee(t,e){return!Cs(zf,e)(t)}Kt(bD,Cee,{name:ub,inputsCount:2,showOperators:!0});const RD="begins_with";function See(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Wt(n))}Kt(RD,See,{name:eb,inputsCount:1,showOperators:!0});const ED="ends_with";function yee(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Wt(n))}Kt(ED,yee,{name:tb,inputsCount:1,showOperators:!0});const rR="contains";function bee(t,e){let[n]=e;return Wt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Wt(n))>=0}Kt(rR,bee,{name:nb,inputsCount:1,showOperators:!0});const TD="not_contains";function Ree(t,e){return!Cs(rR,e)(t)}Kt(TD,Ree,{name:rb,inputsCount:1,showOperators:!0});const _D="date_tomorrow";function Eee(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().subtract(-1,"days").startOf("day"),"d"):!1}Kt(_D,Eee,{name:fb,inputsCount:0});const MD="date_today";function Tee(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().startOf("day"),"d"):!1}Kt(MD,Tee,{name:db,inputsCount:0});const AD="date_yesterday";function _ee(t){const e=q(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(q().subtract(1,"days").startOf("day"),"d"):!1}Kt(AD,_ee,{name:gb,inputsCount:0});Wx();function Mee(t,e){let n=t;return n===""&&(n=`(${e})`),n}const uC=new Set([1]).has(1),Aee=uC&&typeof Array.from=="function";function uh(t){let e=t;return uC&&(e=new Set(e)),function(n){let r;return uC?r=e.has(n):r=!!~e.indexOf(n),r}}function OD(t){return t??""}function cC(t){let e=t;return Aee?e=Array.from(new Set(e)):e=sS(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function L_(t,e,n,r){const i=[],o=t===e;let s;return o||(s=uh(e)),E(t,a=>{let l=!1;(o||s(a))&&(l=!0);const u={checked:l,value:a,visualValue:Mee(a,n)};r&&r(u),i.push(u)}),i}const ca="by_value";function Oee(t,e){let[n]=e;return n(t.value)}Kt(ca,Oee,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[uh(e)]},showOperators:!1});const Nc={};function Pee(t){if(!Nc[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Nc[t].func;return function(n,r){return e(n,r)}}function Iee(t){return Nc[t].name}function iR(t,e,n){Nc[t]={name:e,func:n}}const ds="conjunction",xee=wb;function Hee(t,e){return t.every(n=>n.func(e))}iR(ds,xee,Hee);const Yf="disjunction",Dee=Yg;function Nee(t,e){return t.some(n=>n.func(e))}iR(Yf,Dee,Nee);const oR="disjunctionWithExtraCondition",Lee=Yg;function $ee(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}iR(oR,Lee,$ee);const kee="numeric",PD="text",Fee="date",$_={[kee]:[un,Ye,hc,af,Ye,dc,lf,Ye,vD,CD,SD,yD,zf,bD],[PD]:[un,Ye,hc,af,Ye,dc,lf,Ye,RD,ED,Ye,rR,TD],[Fee]:[un,Ye,hc,af,Ye,dc,lf,Ye,nR,tR,zf,Ye,_D,MD,AD]};function Wee(t){const e=[];let n=t;return $_[n]||(n=PD),E($_[n],r=>{let i;r===Ye?i={name:Ye}:i=Vn(ua(r)),e.push(i)}),e}function Hu(t,e,n){return e=Vee(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vee(t){var e=Bee(t,"string");return typeof e=="symbol"?e:String(e)}function Bee(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Qp="built",Jp="building",k_=["click","input","keydown","keypress","keyup","focus","blur","change"];let ii=class ID{static get DEFAULTS(){return Vn({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Hu(this,"hot",void 0),Hu(this,"eventManager",new Dr(this)),Hu(this,"options",void 0),Hu(this,"_element",void 0),Hu(this,"buildState",void 0),this.hot=e,this.options=jt(ID.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===Jp?this._element:this.buildState===Qp?(this.update(),this._element):(this.buildState=Jp,this.build(),this.buildState=Qp,this._element)}isBuilt(){return this.buildState===Qp}translateIfPossible(e){return typeof e=="string"&&e.startsWith(zn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=Jp),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Z(this._element,this.options.className),this.options.children.length)E(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ge(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),E(k_,r=>e(n,r))}else E(k_,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};pt(ii,ar);function Uee(t,e){xD(t,e),e.add(t)}function Gee(t,e,n){xD(t,e),e.set(t,n)}function xD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wd(t,e){var n=HD(t,e,"get");return zee(t,n)}function zee(t,e){return e.get?e.get.call(t):e.value}function Yee(t,e,n){var r=HD(t,e,"set");return jee(t,r,n),n}function HD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Kee(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var tl=new WeakMap,F_=new WeakSet;class fs extends ii{static get DEFAULTS(){return Vn({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,jt(fs.DEFAULTS,n)),Uee(this,F_),Gee(this,tl,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>Kee(this,F_,Xee).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Yee(this,tl,this._element.firstChild),Z(this._element,"htUIInput"),Z(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(wd(this,tl).type=this.options.type,wd(this,tl).placeholder=this.translateIfPossible(this.options.placeholder),wd(this,tl).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&wd(this,tl).focus()}}function Xee(t){this.options.value=t.target.value}function ew(t,e){DD(t,e),e.add(t)}function Du(t,e,n){DD(t,e),e.set(t,n)}function DD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nl(t,e,n){var r=ND(t,e,"set");return qee(t,r,n),n}function qee(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ht(t,e){var n=ND(t,e,"get");return Zee(t,n)}function ND(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zee(t,e){return e.get?e.get.call(t):e.value}var Jt=new WeakMap,vd=new WeakMap,Cd=new WeakMap,nw=new WeakMap,Sd=new WeakMap,W_=new WeakSet,V_=new WeakSet,B_=new WeakSet;class Lc extends ii{static get DEFAULTS(){return Vn({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,jt(Lc.DEFAULTS,n)),ew(this,B_),ew(this,V_),ew(this,W_),Du(this,Jt,{writable:!0,value:null}),Du(this,vd,{writable:!0,value:[]}),Du(this,Cd,{writable:!0,value:void 0}),Du(this,nw,{writable:!0,value:void 0}),Du(this,Sd,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return Ht(this,Jt)}registerHooks(){this.addLocalHook("click",()=>tw(this,B_,ete).call(this))}setItems(e){nl(this,vd,this.translateNames(e)),Ht(this,Jt)&&Ht(this,Jt).setMenuItems(Ht(this,vd))}translateNames(e){return E(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),nl(this,Jt,new Ql(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Ht(this,Jt).setMenuItems(Ht(this,vd));const e=new ii(this.hot,{className:"htUISelectCaption"}),n=new ii(this.hot,{className:"htUISelectDropdown"});nl(this,Cd,e),nl(this,nw,e.element),nl(this,Sd,n),this.hot.getSettings().ariaTags&&(Te(n.element,[Ao()]),Te(this._element,[px()])),E([e,n],r=>this._element.appendChild(r.element)),Ht(this,Jt).addLocalHook("select",r=>tw(this,W_,Qee).call(this,r)),Ht(this,Jt).addLocalHook("afterClose",()=>tw(this,V_,Jee).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Ht(this,Jt).hot.getTranslatedPhrase(zg),Ht(this,nw).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Ht(this,Jt)&&(Ht(this,Jt).open(),Ht(this,Jt).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Ht(this,Jt).getNavigator().toFirstItem(),Ht(this,Jt).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Ht(this,Jt)&&Ht(this,Jt).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Ht(this,Jt)&&(Ht(this,Jt).destroy(),nl(this,Jt,null)),Ht(this,Cd)&&Ht(this,Cd).destroy(),Ht(this,Sd)&&Ht(this,Sd).destroy(),super.destroy()}}function Qee(t){t.name!==Ye&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Jee(){this.runLocalHooks("afterClose")}function ete(){this.openOptions()}function U_(t,e){tte(t,e),e.add(t)}function tte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function G_(t,e,n){return e=nte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nte(t){var e=rte(t,"string");return typeof e=="symbol"?e:String(e)}function rte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function z_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Y_=new WeakSet,j_=new WeakSet;class hC extends lh{constructor(e,n){super(e,{id:n.id,stateless:!1}),U_(this,j_),U_(this,Y_),G_(this,"name",""),G_(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Lc(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new fs(this.hot,{placeholder:Rb})),this.elements.push(new fs(this.hot,{placeholder:Eb})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>z_(this,Y_,ite).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),E(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>z_(this,j_,ote).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=Vn(e.command);n.name.startsWith(Vt)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),E(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;const o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||ua(un),n=[];return E(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){const r=ua(e?e.name:un);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||E(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Lc)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof fs)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Z(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Z(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return Z(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),E(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[ua(un)];if(e!==null){const{visualIndex:r}=e;n=Wee(this.hot.getDataType(0,r,this.hot.countRows(),r))}E(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function ite(t){E(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function ote(t){Kl(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),kr(t))}function K_(t,e,n){ste(t,e),e.set(t,n)}function ste(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nu(t,e){var n=LD(t,e,"get");return ate(t,n)}function ate(t,e){return e.get?e.get.call(t):e.value}function X_(t,e,n){var r=LD(t,e,"set");return lte(t,r,n),n}function LD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var rl=new WeakMap,rw=new WeakMap;class jf extends ii{static get DEFAULTS(){return Vn({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,jt(jf.DEFAULTS,n)),K_(this,rl,{writable:!0,value:void 0}),K_(this,rw,{writable:!0,value:void 0})}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),X_(this,rw,e),X_(this,rl,this._element.firstChild),Nu(this,rl).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Nu(this,rw).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Nu(this,rl).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Nu(this,rl).checked=e)}focus(){this.isBuilt()&&Nu(this,rl).focus()}}function ute(t,e){cte(t,e),e.add(t)}function cte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hte(t,e,n){return e=dte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dte(t){var e=fte(t,"string");return typeof e=="symbol"?e:String(e)}function fte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gte(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const q_=0;var Z_=new WeakSet;class mte extends lh{constructor(e,n){super(e,{id:n.id,stateless:!1}),ute(this,Z_),hte(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Z(n.parentNode,"htFiltersMenuOperators"),E(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){const e=[ds,Yf];E(e,n=>{const r=new jf(this.hot,{name:"operator",label:{htmlFor:n,textContent:Iee(n)},value:n,checked:n===e[q_],id:n});r.addLocalHook("change",i=>gte(this,Z_,pte).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(ht`Radio button with index ${e} doesn't exist.`);E(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof jf&&n.isChecked());return e?e.getValue():ds}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&E(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ds,n=arguments.length>1?arguments[1]:void 0,r=e;r===oR&&(r=Yf),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(q_)}}function pte(t){this.setState(t.target.value)}function wte(t,e,n){vte(t,e),e.set(t,n)}function vte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iw(t,e){var n=$D(t,e,"get");return Cte(t,n)}function Cte(t,e){return e.get?e.get.call(t):e.value}function Ste(t,e,n){var r=$D(t,e,"set");return yte(t,r,n),n}function $D(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function yte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Lu=new WeakMap;class $c extends ii{static get DEFAULTS(){return Vn({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,jt($c.DEFAULTS,n)),wte(this,Lu,{writable:!0,value:void 0})}build(){super.build(),Ste(this,Lu,this._element.firstChild)}update(){this.isBuilt()&&(iw(this,Lu).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&iw(this,Lu).focus()}activate(){iw(this,Lu).click()}}function yd(t,e){kD(t,e),e.add(t)}function il(t,e,n){kD(t,e),e.set(t,n)}function kD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ne(t,e){var n=FD(t,e,"get");return bte(t,n)}function bte(t,e){return e.get?e.get.call(t):e.value}function zr(t,e,n){var r=FD(t,e,"set");return Rte(t,r,n),n}function FD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rte(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const Q_="multipleSelect.itemBox";var Qr=new WeakMap,Ot=new WeakMap,ow=new WeakMap,Qi=new WeakMap,Bo=new WeakMap,Uo=new WeakMap,J_=new WeakSet,eM=new WeakSet,tM=new WeakSet,nM=new WeakSet;class kc extends ii{static get DEFAULTS(){return Vn({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,jt(kc.DEFAULTS,n)),yd(this,nM),yd(this,tM),yd(this,eM),yd(this,J_),il(this,Qr,{writable:!0,value:[]}),il(this,Ot,{writable:!0,value:void 0}),il(this,ow,{writable:!0,value:void 0}),il(this,Qi,{writable:!0,value:void 0}),il(this,Bo,{writable:!0,value:void 0}),il(this,Uo,{writable:!0,value:void 0}),zr(this,Qi,new fs(this.hot,{placeholder:bb,className:"htUIMultipleSelectSearch"})),zr(this,Bo,new $c(this.hot,{textContent:vb,className:"htUISelectAll"})),zr(this,Uo,new $c(this.hot,{textContent:Cb,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Ne(this,Ot)}registerHooks(){Ne(this,Qi).addLocalHook("keydown",e=>bd(this,eM,Tte).call(this,e)),Ne(this,Qi).addLocalHook("input",e=>bd(this,J_,Ete).call(this,e)),Ne(this,Bo).addLocalHook("click",e=>bd(this,tM,_te).call(this,e)),Ne(this,Uo).addLocalHook("click",e=>bd(this,nM,Mte).call(this,e))}setItems(e){zr(this,Qr,e),Ne(this,Ot)&&Ne(this,Ot).loadData(Ne(this,Qr))}setLocale(e){zr(this,ow,e)}getLocale(){return Ne(this,ow)}getItems(){return[...Ne(this,Qr)]}getValue(){return Ote(Ne(this,Qr))}getSearchInputElement(){return Ne(this,Qi)}getSelectAllElement(){return Ne(this,Bo)}getClearAllElement(){return Ne(this,Uo)}isSelectedAllValues(){return Ne(this,Qr).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),r=new ii(this.hot,{className:"htUISelectionControls",children:[Ne(this,Bo),Ne(this,Uo)]});this._element.appendChild(Ne(this,Qi).element),this._element.appendChild(r.element),this._element.appendChild(n);const i=o=>{if(!this._element)return;Ne(this,Ot)&&Ne(this,Ot).destroy(),Z(o,"htUIMultipleSelectHot"),zr(this,Ot,new this.hot.constructor(o,{data:Ne(this,Qr),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,u,c,h,d,f)=>{l.title=f.instance.getDataAtRowProp(u,f.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Ne(this,Ot).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>Ne(this,Ot).container.scrollWidth-nn(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Ne(this,Ot).init();const a=Ne(this,Ot).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:Q_}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{Ne(this,Ot).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:Q_})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&Ne(this,Ot).listen()}reset(){Ne(this,Qi).reset(),Ne(this,Bo).reset(),Ne(this,Uo).reset()}update(){this.isBuilt()&&(Ne(this,Ot).loadData(Ate(Ne(this,Qr),this.options.value)),super.update())}destroy(){Ne(this,Ot)&&Ne(this,Ot).destroy(),Ne(this,Qi).destroy(),Ne(this,Uo).destroy(),Ne(this,Bo).destroy(),zr(this,Qi,null),zr(this,Uo,null),zr(this,Bo,null),zr(this,Ot,null),zr(this,Qr,null),super.destroy()}}function Ete(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...Ne(this,Qr)]:n=vr(Ne(this,Qr),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Ne(this,Ot).loadData(n)}function Tte(t){this.runLocalHooks("keydown",t,this),yS(Kl,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),kr(t),Ne(this,Ot).listen(),Ne(this,Ot).selectCell(0,0))}function _te(t){const e=[];t.preventDefault(),E(Ne(this,Ot).getSourceData(),(n,r)=>{n.checked=!0,e.push(QS(n,r)[0])}),Ne(this,Ot).setSourceDataAtCell(e)}function Mte(t){const e=[];t.preventDefault(),E(Ne(this,Ot).getSourceData(),(n,r)=>{n.checked=!1,e.push(QS(n,r)[0])}),Ne(this,Ot).setSourceDataAtCell(e)}function Ate(t,e){const n=uh(e);return Ue(t,r=>(r.checked=n(r.value),r))}function Ote(t){const e=[];return E(t,n=>{n.checked&&e.push(n.value)}),e}function Pte(t,e){Ite(t,e),e.add(t)}function Ite(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xte(t,e,n){return e=Hte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hte(t){var e=Dte(t,"string");return typeof e=="symbol"?e:String(e)}function Dte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nte(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var rM=new WeakSet;class Lte extends lh{constructor(e,n){super(e,{id:n.id,stateless:!1}),Pte(this,rM),xte(this,"name",""),this.name=n.name,this.elements.push(new kc(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Nte(this,rM,$te).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===ca){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?un:ca},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(r,i,o,s,a)=>{const[l]=vr(i,h=>h.name===ca),u={},c=this.hot.getTranslatedPhrase(Nf);if(l){const h=cC(Ue(s(r,a),v=>v.value));o&&(l.args[0]=o);const d=[],f=L_(h,l.args[0],c,v=>{v.checked&&d.push(v.value)}),p=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,p).locale,u.args=[d],u.command=ua(ca),u.itemsSnapshot=f}else u.args=[],u.command=ua(un);this.state.setValueAtIndex(r,u)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof kc)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Z(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return Z(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),E(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(Nf),n=cC(this._getColumnVisibleValues()),r=L_(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);const i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Ue(this.hot.getDataAtCol(e.visualIndex),n=>OD(n))}}function $te(t){Kl(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),kr(t))}var WD;function kte(t,e){Fte(t,e),e.add(t)}function Fte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wte(t,e,n){return e=Vte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vte(t){var e=Bte(t,"string");return typeof e=="symbol"?e:String(e)}function Bte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ute(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var iM=new WeakSet;class Fc extends lh{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),kte(this,iM),Wte(this,"name",""),this.name=n.name,this.elements.push(new fs(this.hot,{type:"button",value:Sb,className:"htUIButton htUIButtonOK",identifier:Fc.BUTTON_OK})),this.elements.push(new fs(this.hot,{type:"button",value:yb,className:"htUIButton htUIButtonCancel",identifier:Fc.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){E(this.elements,e=>{e.addLocalHook("click",(n,r)=>Ute(this,iM,Gte).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Z(n.parentNode,"htFiltersMenuActionBar"),E(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}WD=Fc;function Gte(t,e){e.options.identifier===WD.BUTTON_OK?this.accept():this.cancel()}function sw(t,e,n){return e=zte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zte(t){var e=Yte(t,"string");return typeof e=="symbol"?e:String(e)}function Yte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oM="ConditionCollection.filteringStates";class VD{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;sw(this,"hot",void 0),sw(this,"isMapRegistrable",void 0),sw(this,"filteringStates",new Gg),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(oM,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;const i=this.filteringStates.getValueAtIndex(n),o=(r=i==null?void 0:i.conditions)!==null&&r!==void 0?r:[],s=i==null?void 0:i.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ds;return e.length?Pee(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ds,i=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,s=Ue(n.args,c=>typeof c=="string"?c.toLocaleLowerCase(o):c),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==r)throw Error(ht`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ct(Nc[r]))throw new Error(ht`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:Cs(a,s)}]},i):u.push({name:a,args:s,func:Cs(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Gt(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:Ue(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),E(e,n=>{E(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(oM),this.filteringStates=null,this.clearLocalHooks()}}pt(VD,ar);const BD=VD;function sM(t,e,n){return e=jte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jte(t){var e=Kte(t,"string");return typeof e=="symbol"?e:String(e)}function Kte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xte{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];sM(this,"conditionCollection",void 0),sM(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return E(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];return E(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){const r=[];return E(n,i=>{const o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}}const UD=Xte;function aw(t,e){qte(t,e),e.add(t)}function qte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function js(t,e,n){return e=Zte(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zte(t){var e=Qte(t,"string");return typeof e=="symbol"?e:String(e)}function Qte(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var aM=new WeakSet,lM=new WeakSet,uM=new WeakSet;class GD{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];aw(this,uM),aw(this,lM),aw(this,aM),js(this,"hot",void 0),js(this,"conditionCollection",void 0),js(this,"columnDataFactory",void 0),js(this,"changes",[]),js(this,"grouping",!1),js(this,"latestEditedColumnPosition",-1),js(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>lw(this,aM,Jte).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>lw(this,lM,ene).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>lw(this,uM,tne).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,E(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();const l=Hx(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new BD(r.hot,!1),p=[].concat(c,d);f.importAllConditions(p);const v=r.columnDataFactory(h);let S;f.isEmpty()?S=v:S=new UD(f,R=>r.columnDataFactory(R)).filter(),S=Ue(S,R=>R.meta.visualRow);const y=uh(S);return f.destroy(),vr(v,R=>y(R.meta.visualRow))})(s),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ge(this,(e,n)=>{this[n]=null})}}function Jte(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function ene(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function tne(){E(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}pt(GD,ar);const nne=GD;function rne(t){return oD({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{const i=t[n];if(i instanceof kc)return r;if(i.element&&!ps(i.element))return!1;i.focus()}})}const $u="filters";function ine(t,e){let n=-1;const r=rne(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen($u),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof ii&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();r.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext($u),callback:()=>{l.isSubMenu()&&l.close(),u.listen($u)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const d=t.getNavigator();d.getCurrentPage()>-1&&(n=d.getCurrentPage()),d.clear(),h.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const d=e[r.getCurrentPage()];d instanceof Lc&&(d.openOptions(),h.preventDefault()),d instanceof $c&&(d.activate(),h.preventDefault()),d instanceof ii||h.preventDefault()}}],$u)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen($u)}function a(){return n}return{...r,listen:s,getLastMenuPage:a}}function Ji(t,e){zD(t,e),e.add(t)}function one(t,e,n){zD(t,e),e.set(t,n)}function zD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ku(t,e,n){return e=sne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sne(t){var e=ane(t,"string");return typeof e=="symbol"?e:String(e)}function ane(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lne(t,e,n){var r=YD(t,e,"set");return une(t,r,n),n}function une(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Fu(t,e){var n=YD(t,e,"get");return cne(t,n)}function YD(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cne(t,e){return e.get?e.get.call(t):e.value}function Yr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const dC="filters",hne=250,cM=dC;var Ks=new WeakMap,hM=new WeakSet,dM=new WeakSet,fM=new WeakSet,gM=new WeakSet,uw=new WeakSet,mM=new WeakSet,cw=new WeakSet,pM=new WeakSet,wM=new WeakSet;class dne extends it{static get PLUGIN_KEY(){return dC}static get PLUGIN_PRIORITY(){return hne}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),Ji(this,wM),Ji(this,pM),Ji(this,cw),Ji(this,mM),Ji(this,uw),Ji(this,gM),Ji(this,fM),Ji(this,dM),Ji(this,hM),ku(this,"dropdownMenuPlugin",null),ku(this,"conditionCollection",null),ku(this,"conditionUpdateObserver",null),ku(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),ku(this,"filtersRowsMap",null),one(this,Ks,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>Yr(this,pM,vne).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[dC]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new nh),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>Yr(this,uw,vM).call(this,"accept")),s.addLocalHook("cancel",()=>Yr(this,uw,vM).call(this,"cancel")),s.addLocalHook("change",a=>Yr(this,mM,wne).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(mb)}:`,o=()=>`${this.hot.getTranslatedPhrase(pb)}:`;if(!this.components.get("filter_by_condition")){const s=new hC(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>Yr(this,cw,CM).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new mte(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const s=new hC(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>Yr(this,cw,CM).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new Lte(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Fc(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new BD(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new nne(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>Yr(this,wM,Cne).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>Yr(this,gM,pne).call(this,s)),this.addHook("afterDropdownMenuShow",()=>Yr(this,dM,gne).call(this)),this.addHook("afterDropdownMenuHide",()=>Yr(this,fM,mne).call(this)),this.addHook("afterChange",s=>Yr(this,hM,fne).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Fu(this,Ks)&&this.dropdownMenuPlugin.enabled){const s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=s.getNavigator(),c=Fu(this,Ks).getLastMenuPage();s.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];lne(this,Ks,ine(s,a));const l=u=>{Fu(this,Ks).listen(),u.preventDefault(),Kl(u.keyCode,"TAB")&&(u.shiftKey?Fu(this,Ks).toPreviousItem():Fu(this,Ks).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:cM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cM)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ds;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let i=[];const o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=Ue(n.filter(),u=>u.meta.visualRow);const l=uh(i);pe(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),E(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),r=[];return E(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:p}=this.hot.getCellMeta(o,n),v=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:p},value:OD(v)})}),r}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),r=cC(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;const r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Yf&&n.command.key!==un&&r.command.key!==un&&i.command.key!==un?o=oR:i.command.key!==un&&(n.command.key===un||r.command.key===un)&&(o=ds),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new UD(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return E(i,s=>{E(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];const l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function fne(t){t&&E(t,e=>{const[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function gne(){this.restoreComponents(Array.from(this.components.values()))}function mne(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function pne(t){t.items.push({name:Ye}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function vM(t){var e;if(t==="accept"){const r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),o.command.key!==un&&(this.conditionCollection.addCondition(i,o,l,u),s.command.key!==un&&this.conditionCollection.addCondition(i,s,l,u)),a.command.key!==un&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function wne(t,e){this.updateDependentComponentsVisibility(),t.constructor===hC&&!e.inputsCount&&this.setListeningDropdownMenu()}function CM(){this.setListeningDropdownMenu()}function vne(t,e){const n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Z(e,"htFiltersActive"):Le(e,"htFiltersActive")}function Cne(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===ca),o=n.filter(s=>s.name!==ca);if(i.length>=2||o.length>=3)gt(ht`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}const jD="internal-use-in-handsontable",fC={licenseKey:jD,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function KD(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[bn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function XD(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Sne(t){var e;const n=t[bn],r=XD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=KD(t);return{...fC,...r,...i}}function yne(t){var e;const n=t[bn],r=XD(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=KD(t);return{...r,...i}}function bne(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function um(){const t="engine_relationship",e=ci(bn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function sR(){const t="shared_engine_usage",e=ci(bn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Rne(t){const e=t.getSettings(),n=e[bn],r=n==null?void 0:n.engine;if(n===!0||Ct(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Ene((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&Ct(r.hyperformula)){const o=um(),s=sR().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:jD}),(r.getConfig().leapYear1900!==fC.leapYear1900||Ng(r.getConfig().nullDate,fC.nullDate)===!1)&&gt(ht`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Ene(t,e,n){const r=e[bn],i=Sne(e),o=um(),s=sR();Tne(t,r.functions),_ne(t,r.language);const a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Mne(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function SM(t){var e;const n=um(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function yM(t,e){if(t){const n=um(),r=n.get(t),i=sR(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Tne(t,e){e&&e.forEach(n=>{const{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){gt(s.message)}})}function _ne(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){gt(r.message)}}}function Mne(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){gt(a.message)}}),t.resumeEvaluation())}function Ane(t,e){return(Ct(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const qD="DD/MM/YYYY";function ZD(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function One(t){return ZD(t)?t.substr(1):t}function Pne(t){return typeof t=="string"&&t.startsWith("=")}function aR(t,e){return typeof t=="string"&&e==="date"}function QD(t,e){return q(t,e,!0).isValid()}function JD(t,e){return q(t,e,!0).format(qD)}function Ine(t,e){return q(t,qD,!0).format(e)}function eN(t,e){const r=new Date(Date.UTC(0,0,t+-1));return q(r).format(e)}function Xs(t,e,n){xne(t,e),e.set(t,n)}function xne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){var n=tN(t,e,"get");return Hne(t,n)}function Hne(t,e){return e.get?e.get.call(t):e.value}function Go(t,e,n){var r=tN(t,e,"set");return Dne(t,r,n),n}function tN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Dne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wu=new WeakMap,zo=new WeakMap,lr=new WeakMap,Rd=new WeakMap,hw=new WeakMap,dw=new WeakMap,Ed=new WeakMap;class Nne{constructor(e,n,r){Xs(this,Wu,{writable:!0,value:void 0}),Xs(this,zo,{writable:!0,value:void 0}),Xs(this,lr,{writable:!0,value:void 0}),Xs(this,Rd,{writable:!0,value:[]}),Xs(this,hw,{writable:!0,value:[]}),Xs(this,dw,{writable:!0,value:void 0}),Xs(this,Ed,{writable:!0,value:[]}),Go(this,Wu,e),Go(this,zo,n),Go(this,lr,r)}setRemovedHfIndexes(e){return Go(this,Ed,e.map(n=>{const r=bt(this,zo).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),bt(this,Ed)}getRemovedHfIndexes(){return bt(this,Ed)}getHfIndexFromVisualIndex(e){const n=bt(this,zo).getIndexesSequence(),r=bt(this,zo).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){const r=`move${En(bt(this,Wu))}s`;bt(this,lr).getEngine().batch(()=>{e.forEach(i=>{const o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&bt(this,lr).getEngine()[r](bt(this,lr).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(Go(this,hw,e.map(i=>this.getHfIndexFromVisualIndex(i))),Go(this,dw,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){const r=bt(this,zo).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n);const i=[];return e.forEach(o=>{const s={from:o,to:r};i.forEach(a=>{const l=a.from>a.to,u=a.to<=s.from;a.from>s.from&&u&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{const s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(bt(this,lr).isPerformingUndoRedo()||e===!1||n===!1)return;const r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(bt(this,hw),bt(this,dw)));bt(this,lr).getSheetId()===null?bt(this,lr).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${En(bt(this,Wu))}Order`;return n=>{if(bt(this,lr).isPerformingUndoRedo())return;const r=bt(this,zo).getIndexesSequence();if(n==="update"&&r.length>0){const i=bt(this,Rd).map(l=>r.indexOf(l)),o=bt(this,lr).getEngine().getSheetDimensions(bt(this,lr).getSheetId());let s;bt(this,Wu)==="row"?s=o.height:s=o.width;const a=i.length;for(let l=a;l<s;l+=1)i.push(l);bt(this,lr).getEngine()[e](bt(this,lr).getSheetId(),i)}Go(this,Rd,r)}}init(){Go(this,Rd,bt(this,zo).getIndexesSequence())}}const bM=Nne;function qs(t,e,n){Lne(t,e),e.set(t,n)}function Lne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eo(t,e){var n=nN(t,e,"get");return $ne(t,n)}function $ne(t,e){return e.get?e.get.call(t):e.value}function Zs(t,e,n){var r=nN(t,e,"set");return kne(t,r,n),n}function nN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function kne(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Td=new WeakMap,_d=new WeakMap,fw=new WeakMap,gw=new WeakMap,mw=new WeakMap,pw=new WeakMap,ww=new WeakMap;class Fne{constructor(e,n,r){qs(this,Td,{writable:!0,value:void 0}),qs(this,_d,{writable:!0,value:void 0}),qs(this,fw,{writable:!0,value:void 0}),qs(this,gw,{writable:!0,value:!1}),qs(this,mw,{writable:!0,value:!1}),qs(this,pw,{writable:!0,value:null}),qs(this,ww,{writable:!0,value:null}),Zs(this,Td,new bM("row",e,this)),Zs(this,_d,new bM("column",n,this)),Zs(this,fw,r)}getForAxis(e){return e==="row"?eo(this,Td):eo(this,_d)}setPerformUndo(e){Zs(this,gw,e)}setPerformRedo(e){Zs(this,mw,e)}isPerformingUndoRedo(){return eo(this,gw)||eo(this,mw)}getSheetId(){return eo(this,ww)}getEngine(){return eo(this,pw)}getPostponeAction(){return eo(this,fw)}setupSyncEndpoint(e,n){Zs(this,pw,e),Zs(this,ww,n),eo(this,Td).init(),eo(this,_d).init()}}const Wne=Fne;function Mt(t,e){rN(t,e),e.add(t)}function ol(t,e,n){return e=Vne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vne(t){var e=Bne(t,"string");return typeof e=="symbol"?e:String(e)}function Bne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vw(t,e,n){rN(t,e),e.set(t,n)}function rN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ss(t,e,n){var r=iN(t,e,"set");return Une(t,r,n),n}function Une(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Dl(t,e){var n=iN(t,e,"get");return Gne(t,n)}function iN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Gne(t,e){return e.get?e.get.call(t):e.value}function wt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const bn="formulas",zne=["maxRows","maxColumns","language"],Yne=260;fe.getSingleton().register("afterNamedExpressionAdded");fe.getSingleton().register("afterNamedExpressionRemoved");fe.getSingleton().register("afterSheetAdded");fe.getSingleton().register("afterSheetRemoved");fe.getSingleton().register("afterSheetRenamed");fe.getSingleton().register("afterFormulasValuesUpdate");const Jl=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var Eo=new WeakMap,lR=new WeakMap,Vu=new WeakMap,RM=new WeakSet,EM=new WeakSet,Cw=new WeakSet,TM=new WeakSet,Sw=new WeakSet,_M=new WeakSet,MM=new WeakSet,yw=new WeakSet,AM=new WeakSet,OM=new WeakSet,PM=new WeakSet,IM=new WeakSet,xM=new WeakSet,HM=new WeakSet,DM=new WeakSet,NM=new WeakSet,LM=new WeakSet,$M=new WeakSet,kM=new WeakSet,FM=new WeakSet,WM=new WeakSet,VM=new WeakSet,BM=new WeakSet,UM=new WeakSet;class jne extends it{constructor(){var e;super(...arguments),e=this,Mt(this,UM),Mt(this,BM),Mt(this,VM),Mt(this,WM),Mt(this,FM),Mt(this,kM),Mt(this,$M),Mt(this,LM),Mt(this,NM),Mt(this,DM),Mt(this,HM),Mt(this,xM),Mt(this,IM),Mt(this,PM),Mt(this,OM),Mt(this,AM),Mt(this,yw),Mt(this,MM),Mt(this,_M),Mt(this,Sw),Mt(this,TM),Mt(this,Cw),Mt(this,EM),Mt(this,RM),vw(this,Eo,{writable:!0,value:!1}),vw(this,lR,{writable:!0,value:!1}),vw(this,Vu,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,kM,ure).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,FM,cre).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,WM,hre).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,VM,dre).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,BM,fre).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return wt(e,UM,gre).call(e,...r)}]]}),ol(this,"staticRegister",ci("formulas")),ol(this,"engine",null),ol(this,"sheetName",null),ol(this,"indexSyncer",null),ol(this,"rowAxisSyncer",null),ol(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return bn}static get PLUGIN_PRIORITY(){return Yne}static get SETTING_KEYS(){return[bn,...zne]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[bn]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Rne(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){gt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,Cw,GM).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,Sw,zM).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,Cw,GM).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,Sw,zM).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,_M,Zne).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,MM,Qne).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,RM,Kne).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,AM,Jne).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,yw,YM).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,yw,YM).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,OM,ere).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,PM,tre).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,HM,ire).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,DM,ore).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,IM,nre).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,xM,rre).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,NM,sre).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,LM,are).call(n,...i)}),this.indexSyncer=new Wne(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,TM,qne).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,$M,lre).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return wt(n,EM,Xne).call(n,...i)}),Dl(this,Vu).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Dl(this,Vu).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),yM(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=yne(this.hot.getSettings());bne(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const r=this.hot.getSettings()[bn];if(ue(r)&&ue(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[bn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Dl(this,Vu).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),Ss(this,Vu,null),yM(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(ue(n)&&!V1(n))return gt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return gt("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return gt(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){AS(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${En(bn)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=new Set;e.forEach(i=>{var o;const s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),SM(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=o=>{var s;const{row:a,col:l,sheet:u}=(s=o==null?void 0:o.address)!==null&&s!==void 0?s:{};return ue(u)?`${u}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;const{row:l,col:u}=(s=o.address)!==null&&s!==void 0?s:{};if(ue(l)===!1||ue(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,h=r(o);if(c!==void 0&&!i.has(h)){const d=SM(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,n,r){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){gt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const o=this.hot.getCellMeta(e,n);return aR(r,o.type)&&(QD(r,o.dateFormat)?r=JD(r,o.dateFormat):Pne(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}}function Kne(t,e,n){const r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r);let s=this.engine.getCellValue(i);return o.type==="date"&&Wn(s)&&(s=eN(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Xne(t,e,n){const{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:u,col:c}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:p,col:v}=h.start,{row:S,col:y}=h.end,R=S-p+1,T=y-v+1;for(let A=0;A<f.length;A+=1)for(let M=0;M<f[A].length;M+=1){const L=f[A][M],B=A%R,K=M%T,U=this.hot.getCellMeta(B,K);aR(L,U.type)&&(L.startsWith("'")?f[A][M]=L.slice(1):this.isFormulaCellType(B,K,this.sheetId)===!1&&(f[A][M]=Ine(L,U.dateFormat)))}return f}function GM(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(En(bn))||Ss(this,lR,Ct(this.hot.getSettings().data))}function qne(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{const s=this.hot.getCellMeta(r,o),a=s.dateFormat;aR(i,s.type)&&(e=!0,QD(i,a)?t[r][o]=JD(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(Ss(this,Eo,!0),this.engine.setSheetContent(this.sheetId,t),Ss(this,Eo,!1))}function zM(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(En(bn)))if(this.sheetName=Ane(this.engine,this.hot.getSettings()[bn].sheetName),Dl(this,lR))this.switchSheet(this.sheetName);else{const r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Ss(this,Eo,!0);const i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),Ss(this,Eo,!1)}}}function Zne(t,e,n,r){if(r!=="get"||Dl(this,Eo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){ZD(n.value)&&(n.value=One(n.value));return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(s),l=this.hot.getCellsMeta().find(c=>c.visualRow===i&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&Wn(a)&&(a=eN(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;n.value=u}function Qne(t,e,n,r){if(r!=="get"||Dl(this,Eo)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function YM(t,e){if(Jl(e))return;const n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(s,u,l):n.push([s,u,l]),r.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,u]=s;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function Jne(t,e){if(Jl(e))return;const n=[],r=[];t.forEach(i=>{let[o,s,,a]=i;const l=this.hot.propToCol(s);if(!Wn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){gt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}r.push({address:u}),n.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function ere(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function tre(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function nre(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function rre(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function ire(t,e,n){if(Jl(n))return;const r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function ore(t,e,n){if(Jl(n))return;const r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function sre(t,e,n,r){if(Jl(r))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function are(t,e,n,r){if(Jl(r))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function lre(t,e,n){var r;Ss(this,Eo,!0);const i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());Ss(this,Eo,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function ure(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function cre(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function hre(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function dre(t){this.hot.runHooks("afterSheetAdded",t)}function fre(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function gre(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function mre(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Yy,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);const s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function pre(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(jy,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return E(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function sl(t,e){oN(t,e),e.add(t)}function jM(t,e,n){oN(t,e),e.set(t,n)}function oN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function al(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function mr(t,e){var n=sN(t,e,"get");return wre(t,n)}function wre(t,e){return e.get?e.get.call(t):e.value}function Bu(t,e,n){var r=sN(t,e,"set");return vre(t,r,n),n}function sN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("beforeHideColumns");fe.getSingleton().register("afterHideColumns");fe.getSingleton().register("beforeUnhideColumns");fe.getSingleton().register("afterUnhideColumns");const bw="hiddenColumns",Cre=310;var Ni=new WeakMap,bi=new WeakMap,KM=new WeakSet,XM=new WeakSet,qM=new WeakSet,ZM=new WeakSet,QM=new WeakSet,JM=new WeakSet;class Sre extends it{constructor(){super(...arguments),sl(this,JM),sl(this,QM),sl(this,ZM),sl(this,qM),sl(this,XM),sl(this,KM),jM(this,Ni,{writable:!0,value:{}}),jM(this,bi,{writable:!0,value:null})}static get PLUGIN_KEY(){return bw}static get PLUGIN_PRIORITY(){return Cre}isEnabled(){return!!this.hot.getSettings()[bw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[bw];Ve(n)&&(Bu(this,Ni,n),Ct(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Bu(this,bi,new Ug),mr(this,bi).addLocalHook("init",()=>al(this,JM,_re).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,mr(this,bi)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return al(e,QM,Tre).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>al(this,XM,bre).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>al(this,KM,yre).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return al(e,ZM,Ere).call(e,...i)}),this.addHook("modifyCopyableRange",r=>al(this,qM,Rre).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Bu(this,Ni,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;const o=mr(this,bi).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalColumn(u));E(l,u=>{o[u]=!1}),i=Gt(o,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&mr(this,bi).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{mr(this,bi).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return Ue(mr(this,bi).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return mr(this,bi).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){E(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Bu(this,Ni,null),Bu(this,bi,null),super.destroy()}}function yre(t,e){if(this.isHidden(e))return 0;if(mr(this,Ni).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function bre(t,e,n){if(mr(this,Ni).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Rre(t){if(mr(this,Ni).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return E(t,r=>{let i=!0,o=0;pe(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function Ere(t,e){if(!mr(this,Ni).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Z(e,n)}function Tre(t){t.items.push({name:Ye},mre(this),pre(this))}function _re(){Array.isArray(mr(this,Ni).columns)&&this.hideColumns(mr(this,Ni).columns)}function Mre(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let n=0;if(Array.isArray(e)){const[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(Ky,n)},callback(){const{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);const s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function Are(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(Xy,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const n=Ue(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),u=s.getNotTrimmedIndexes(),c=[];if(i!==o){const h=o-i+1,d=l-a+1;if(h>d){const f=u.slice(i,o+1);c.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(h,-1));l===d&&h>o&&c.push(...u.slice(o+1))}return E(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function ll(t,e){aN(t,e),e.add(t)}function eA(t,e,n){aN(t,e),e.set(t,n)}function aN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ul(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Pr(t,e){var n=lN(t,e,"get");return Ore(t,n)}function Ore(t,e){return e.get?e.get.call(t):e.value}function Uu(t,e,n){var r=lN(t,e,"set");return Pre(t,r,n),n}function lN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Pre(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}fe.getSingleton().register("beforeHideRows");fe.getSingleton().register("afterHideRows");fe.getSingleton().register("beforeUnhideRows");fe.getSingleton().register("afterUnhideRows");const Rw="hiddenRows",Ire=320;var wo=new WeakMap,Ri=new WeakMap,tA=new WeakSet,nA=new WeakSet,rA=new WeakSet,iA=new WeakSet,oA=new WeakSet,sA=new WeakSet;class xre extends it{constructor(){super(...arguments),ll(this,sA),ll(this,oA),ll(this,iA),ll(this,rA),ll(this,nA),ll(this,tA),eA(this,wo,{writable:!0,value:{}}),eA(this,Ri,{writable:!0,value:null})}static get PLUGIN_KEY(){return Rw}static get PLUGIN_PRIORITY(){return Ire}isEnabled(){return!!this.hot.getSettings()[Rw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Rw];Ve(n)&&(Uu(this,wo,n),Ct(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Uu(this,Ri,new Ug),Pr(this,Ri).addLocalHook("init",()=>ul(this,sA,kre).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Pr(this,Ri)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ul(e,oA,$re).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>ul(this,nA,Dre).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>ul(this,tA,Hre).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return ul(e,iA,Lre).call(e,...i)}),this.addHook("modifyCopyableRange",r=>ul(this,rA,Nre).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Uu(this,wo,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;const o=Pr(this,Ri).getValues().slice(),s=e.length>0;if(r&&s){const l=e.map(u=>this.hot.toPhysicalRow(u));E(l,u=>{o[u]=!1}),i=Gt(o,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Pr(this,Ri).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{Pr(this,Ri).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return Ue(Pr(this,Ri).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Pr(this,Ri).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){E(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Uu(this,wo,null),Uu(this,Ri,null),super.destroy()}}function Hre(t,e){return this.isHidden(e)?0:t}function Dre(t,e,n){if(Pr(this,wo).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const r=n.className.split(" ");if(r.length>0){const i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function Nre(t){if(Pr(this,wo).copyPasteEnabled)return t;const e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return E(t,r=>{let i=!0,o=0;pe(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Lre(t,e){if(!Pr(this,wo).indicators||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Z(e,n)}function $re(t){t.items.push({name:Ye},Mre(this),Are(this))}function kre(){Array.isArray(Pr(this,wo).rows)&&this.hideRows(Pr(this,wo).rows)}function Fre(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(by)},callback(e,n){const[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function Wre(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Ry)},callback(e,n){const[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function aA(t,e){uN(t,e),e.add(t)}function Vre(t,e,n){uN(t,e),e.set(t,n)}function uN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gC(t,e){var n=cN(t,e,"get");return Bre(t,n)}function Bre(t,e){return e.get?e.get.call(t):e.value}function Ew(t,e,n){var r=cN(t,e,"set");return Ure(t,r,n),n}function cN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ure(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function lA(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeColumnFreeze");fe.getSingleton().register("afterColumnFreeze");fe.getSingleton().register("beforeColumnUnfreeze");fe.getSingleton().register("afterColumnUnfreeze");const uA="manualColumnFreeze",Gre=110;var ia=new WeakMap,cA=new WeakSet,hA=new WeakSet;class zre extends it{constructor(){super(...arguments),aA(this,hA),aA(this,cA),Vre(this,ia,{writable:!0,value:!1})}static get PLUGIN_KEY(){return uA}static get PLUGIN_PRIORITY(){return Gre}isEnabled(){return!!this.hot.getSettings()[uA]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>lA(this,cA,Yre).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>lA(this,hA,jre).call(this,e,n)),super.enablePlugin())}disablePlugin(){Ew(this,ia,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;gC(this,ia)||Ew(this,ia,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;gC(this,ia)||Ew(this,ia,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function Yre(t){t.items.push({name:"---------"},Fre(this),Wre(this))}function jre(t,e){if(gC(this,ia)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}function Md(t,e,n){return e=Kre(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kre(t){var e=Xre(t,"string");return typeof e=="symbol"?e:String(e)}function Xre(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Tw=0,dA=1,fA=2,cl="px";let qre=class{constructor(e){Md(this,"hot",void 0),Md(this,"_element",null),Md(this,"state",Tw),Md(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=fA}build(){this.state===Tw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=dA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Tw}isAppended(){return this.state===fA}isBuilt(){return this.state>=dA}setPosition(e,n){Wn(e)&&(this._element.style.top=e+cl),Wn(n)&&(this._element.style[this.inlineProperty]=n+cl)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Wn(e)&&(this._element.style.width=e+cl),Wn(n)&&(this._element.style.height=n+cl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Wn(e)&&(this._element.style.marginTop=e+cl),Wn(n)&&(this._element.style[`margin${En(this.inlineProperty)}`]=n+cl)}getOffset(){const e=this._element.style,n=`margin${En(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const hN=qre,Zre="ht__manualColumnMove--backlight";let Qre=class extends hN{build(){super.build(),Z(this._element,Zre)}};const Jre=Qre,eie="ht__manualColumnMove--guideline";let tie=class extends hN{build(){super.build(),Z(this._element,eie)}};const nie=tie;function hl(t,e){dN(t,e),e.add(t)}function jr(t,e,n){dN(t,e),e.set(t,n)}function dN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rr(t,e,n){var r=fN(t,e,"set");return rie(t,r,n),n}function rie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function me(t,e){var n=fN(t,e,"get");return iie(t,n)}function fN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function iie(t,e){return e.get?e.get.call(t):e.value}function dl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeColumnMove");fe.getSingleton().register("afterColumnMove");const _w="manualColumnMove",oie=120,gA="ht__manualColumnMove",Kf="show-ui",mC="on-moving--columns",pC="after-selection--columns";var kn=new WeakMap,Jo=new WeakMap,vo=new WeakMap,uf=new WeakMap,ss=new WeakMap,$n=new WeakMap,Ad=new WeakMap,_r=new WeakMap,El=new WeakMap,Xf=new WeakMap,fc=new WeakMap,mA=new WeakSet,pA=new WeakSet,wA=new WeakSet,vA=new WeakSet,CA=new WeakSet,SA=new WeakSet;class sie extends it{constructor(){super(...arguments),hl(this,SA),hl(this,CA),hl(this,vA),hl(this,wA),hl(this,pA),hl(this,mA),jr(this,kn,{writable:!0,value:new Jre(this.hot)}),jr(this,Jo,{writable:!0,value:new nie(this.hot)}),jr(this,vo,{writable:!0,value:[]}),jr(this,uf,{writable:!0,value:0}),jr(this,ss,{writable:!0,value:!1}),jr(this,$n,{writable:!0,value:{}}),jr(this,Ad,{writable:!0,value:void 0}),jr(this,_r,{writable:!0,value:void 0}),jr(this,El,{writable:!0,value:void 0}),jr(this,Xf,{writable:!0,value:void 0}),jr(this,fc,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return _w}static get PLUGIN_PRIORITY(){return oie}isEnabled(){return!!this.hot.getSettings()[_w]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dl(e,mA,aie).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dl(e,wA,uie).call(e,...r)}),this.addHook("afterScrollVertically",()=>dl(this,CA,hie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return dl(e,SA,die).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Z(this.hot.rootElement,gA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Le(this.hot.rootElement,gA),this.unregisterEvents(),me(this,kn).destroy(),me(this,Jo).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const r=me(this,Ad),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(rr(this,Ad,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);const s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const r=this.countFinalIndex(e,n);return rr(this,Ad,n),this.moveColumns(e,r)}isMovePossible(e,n){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Gt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){const r=this.hot.columnIndexMapper;let i=0;for(let o=e;o<=n;o+=1){const s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[_w];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const r=[];return pe(e,n,i=>{r.push(i)}),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(me(this,_r))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,me(this,_r)-1);const s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=me(this,kn).getOffset().start,u=me(this,kn).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const p=this.hot.rootWindow,v=ft(this.hot.rootElement),S=p.innerWidth-me(this,El)-v;h=p.innerWidth-me(this,$n).eventPageX-S-(r.scrollX===void 0?i:0)}else h=me(this,$n).eventPageX-(me(this,El)-(r.scrollX===void 0?i:0));if(me(this,Xf)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(me(this,_r))&&(o+=i),o+=c,me(this,_r)<0)me(this,fc)>0?me(this,$n).col=0:me(this,$n).col=e>0?e-1:e;else if(me(this,$n).TD.offsetWidth/2+o<=h){const p=me(this,_r)>=me(this,uf)?me(this,uf)-1:me(this,_r);me(this,$n).col=p+1,o+=me(this,$n).TD.offsetWidth}else me(this,$n).col=me(this,_r);let d=h,f=o;h+u+l>=s?d=s-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&me(this,_r)<me(this,fc)&&(f-=me(this,El)<=r.scrollX?me(this,El):0),me(this,kn).setPosition(null,d),me(this,Jo).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>dl(this,pA,lie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>dl(this,vA,cie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){me(this,kn).build(),me(this,Jo).build()}destroy(){me(this,kn).destroy(),me(this,Jo).destroy(),super.destroy()}}function aie(t,e,n,r){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=Pe(t.target,"sortAction");if(!s||!o||me(this,ss)||t.button!==0||a){rr(this,ss,!1),me(this,vo).length=0,Le(this.hot.rootElement,[mC,Kf]);return}const l=me(this,Jo).isBuilt()&&!me(this,Jo).isAppended(),u=me(this,kn).isBuilt()&&!me(this,kn).isAppended();l&&u&&(me(this,Jo).appendTo(i.hider),me(this,kn).appendTo(i.hider));const{from:c,to:h}=s,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){r.column=!0,rr(this,ss,!0);const p=n.firstChild?Kx(t,n.firstChild).x:t.offsetX;me(this,$n).eventPageX=t.pageX,rr(this,_r,e.col),me(this,$n).TD=n,me(this,$n).col=e.col,rr(this,vo,this.prepareColumnsToMoving(d,f)),rr(this,Xf,!!this.hot.getSettings().rowHeaders),rr(this,uf,this.hot.countCols()),rr(this,fc,this.hot.getSettings().fixedColumnsStart),rr(this,El,en(this.hot.rootElement).left);const v=me(this,Xf)?-1:0,S=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,y=e.col<me(this,fc),R=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),T=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),A=this.getColumnsWidth(d,e.col-1)+T,M=this.getColumnsWidth(v,d-1)+(y?R:0)+A;me(this,kn).setPosition(S,M),me(this,kn).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-S),me(this,kn).setOffset(null,-A),Z(this.hot.rootElement,mC)}else Le(this.hot.rootElement,pC),rr(this,ss,!1),me(this,vo).length=0}function lie(t){me(this,ss)&&(me(this,$n).eventPageX=t.pageX,this.refreshPositions())}function uie(t,e,n,r){!this.hot.getSelectedRangeLast()||!me(this,ss)||(me(this,vo).indexOf(e.col)>-1?Le(this.hot.rootElement,Kf):Z(this.hot.rootElement,Kf),r.row=!0,r.column=!0,r.cell=!0,rr(this,_r,e.col),me(this,$n).TD=n)}function cie(){const t=me(this,$n).col,e=me(this,vo).length;if(rr(this,_r,void 0),rr(this,ss,!1),Le(this.hot.rootElement,[mC,Kf,pC]),this.hot.selection.isSelectedByColumnHeader()&&Z(this.hot.rootElement,pC),e<1||t===void 0)return;const n=me(this,vo)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(me(this,vo),t);if(me(this,vo).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function hie(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;me(this,kn).setPosition(r),me(this,kn).setSize(null,t.hider.offsetHeight-r)}function die(){this.moveBySettingsOrLoad()}function to(t,e){gN(t,e),e.add(t)}function wn(t,e,n){gN(t,e),e.set(t,n)}function gN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function no(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ut(t,e,n){var r=mN(t,e,"set");return fie(t,r,n),n}function fie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function ae(t,e){var n=mN(t,e,"get");return gie(t,n)}function mN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function gie(t,e){return e.get?e.get.call(t):e.value}const qf="manualColumnResize",mie=130,yA="manualColumnWidths";var uo=new WeakMap,Od=new WeakMap,dr=new WeakMap,Zf=new WeakMap,Hi=new WeakMap,pie=new WeakMap,Nl=new WeakMap,Pd=new WeakMap,Qn=new WeakMap,io=new WeakMap,va=new WeakMap,Qf=new WeakMap,gc=new WeakMap,mc=new WeakMap,gr=new WeakMap,pc=new WeakMap,bA=new WeakSet,RA=new WeakSet,EA=new WeakSet,TA=new WeakSet,_A=new WeakSet,MA=new WeakSet,AA=new WeakSet,OA=new WeakSet,PA=new WeakSet;class wie extends it{static get PLUGIN_KEY(){return qf}static get PLUGIN_PRIORITY(){return mie}constructor(e){super(e),to(this,PA),to(this,OA),to(this,AA),to(this,MA),to(this,_A),to(this,TA),to(this,EA),to(this,RA),to(this,bA),wn(this,uo,{writable:!0,value:null}),wn(this,Od,{writable:!0,value:null}),wn(this,dr,{writable:!0,value:[]}),wn(this,Zf,{writable:!0,value:null}),wn(this,Hi,{writable:!0,value:null}),wn(this,pie,{writable:!0,value:null}),wn(this,Nl,{writable:!0,value:null}),wn(this,Pd,{writable:!0,value:null}),wn(this,Qn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),wn(this,io,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),wn(this,va,{writable:!0,value:null}),wn(this,Qf,{writable:!0,value:!1}),wn(this,gc,{writable:!0,value:0}),wn(this,mc,{writable:!0,value:null}),wn(this,gr,{writable:!0,value:void 0}),wn(this,pc,{writable:!0,value:void 0}),Z(ae(this,Qn),"manualColumnResizer"),Z(ae(this,io),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[qf]}enablePlugin(){this.enabled||(Ut(this,gr,new Ts),ae(this,gr).addLocalHook("init",()=>no(this,bA,vie).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ae(this,gr)),this.addHook("modifyColWidth",(e,n)=>no(this,AA,Eie).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>no(this,OA,Tie).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>no(this,PA,_ie).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Ut(this,pc,ae(this,gr).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",yA,ae(this,gr).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",yA,e),e.value}setManualSize(e,n){const r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return ae(this,gr).setValueAtIndex(i,r),r}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ae(this,gr).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;Ut(this,uo,e);const{_wt:n}=this.hot.view,r=n.wtTable.getCoords(ae(this,uo)),i=r.col;if(i<0)return;const o=xt(ae(this,uo)),s=ae(this,uo).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(this,uo),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ae(this,uo),r.row,r.col)),Ut(this,Od,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Ut(this,dr,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();E(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;pe(d,f,p=>{ae(this,dr).includes(p)||ae(this,dr).push(p)})})}ae(this,dr).includes(ae(this,Od))||Ut(this,dr,[ae(this,Od)]),Ut(this,Pd,l.start-6),Ut(this,Nl,parseInt(s.width,10)),ae(this,Qn).style.top=`${l.top}px`,ae(this,Qn).style[this.inlineDir]=`${ae(this,Pd)+ae(this,Nl)}px`,ae(this,Qn).style.height=`${o}px`,this.hot.rootElement.appendChild(ae(this,Qn))}refreshHandlePosition(){ae(this,Qn).style[this.inlineDir]=`${ae(this,Pd)+ae(this,Zf)}px`}setupGuidePosition(){const e=parseInt(xt(ae(this,Qn)),10),n=parseInt(ae(this,Qn).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Z(ae(this,Qn),"active"),Z(ae(this,io),"active"),ae(this,io).style.top=`${n}px`,this.refreshGuidePosition(),ae(this,io).style.height=`${r-e}px`,this.hot.rootElement.appendChild(ae(this,io))}refreshGuidePosition(){ae(this,io).style[this.inlineDir]=ae(this,Qn).style[this.inlineDir]}hideHandleAndGuide(){Le(ae(this,Qn),"active"),Le(ae(this,io),"active")}checkIfColumnHeader(e){const n=gs(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeColumnResize",ae(this,Hi),r,!0);o!==void 0&&Ut(this,Hi,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,ae(this,Hi)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(this,Hi),r,!0),i&&e()};ae(this,gc)>=2&&(ae(this,dr).length>1?(E(ae(this,dr),i=>{n(i)}),e()):E(ae(this,dr),i=>{n(i,!0)})),Ut(this,gc,0),Ut(this,mc,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>no(this,RA,Cie).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>no(this,EA,Sie).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>no(this,TA,yie).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>no(this,_A,bie).call(this)),this.eventManager.addEventListener(ae(this,Qn),"contextmenu",()=>no(this,MA,Rie).call(this))}destroy(){super.destroy()}}function vie(){const t=this.hot.getSettings()[qf],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{ae(this,gr).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{ae(this,gr).setValueAtIndex(r,n)})},!0),Ut(this,pc,t)):t===!0&&Array.isArray(ae(this,pc))&&this.hot.batchExecution(()=>{ae(this,pc).forEach((n,r)=>{ae(this,gr).setValueAtIndex(r,n)})},!0)}function Cie(t){if(!vS(t.target)&&ae(this,Qf)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ae(this,va)||this.setupHandlePosition(e))}}function Sie(t){Pe(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ae(this,uo)),this.setupGuidePosition(),Ut(this,va,!0),ae(this,mc)===null&&(Ut(this,mc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(this,mc))),Ut(this,gc,ae(this,gc)+1),this.startX=t.pageX,Ut(this,Hi,ae(this,Nl)))}function yie(t){if(ae(this,va)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Ut(this,Zf,ae(this,Nl)+e),E(ae(this,dr),n=>{Ut(this,Hi,this.setManualSize(n,ae(this,Zf)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function bie(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",ae(this,Hi),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(this,Hi),n,!1)};ae(this,va)&&(this.hideHandleAndGuide(),Ut(this,va,!1),ae(this,Hi)!==ae(this,Nl)&&(ae(this,dr).length>1?(E(ae(this,dr),r=>{e(r)}),t()):E(ae(this,dr),r=>{e(r,!0)})),this.setupHandlePosition(ae(this,uo)))}function Rie(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(this,Qn)),this.hot.rootElement.removeChild(ae(this,io)),Ut(this,va,!1),Ut(this,Qf,!0),this.hot._registerImmediate(()=>{Ut(this,Qf,!1)})}function Eie(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalColumn(e),i=ae(this,gr).getValueAtIndex(r);this.hot.getSettings()[qf]&&i&&(n=i)}return n}function Tie(t,e){let n=ae(this,gr).getValueAtIndex(e);return n===null&&(n=t),n}function _ie(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function Mw(t,e,n){return e=Mie(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mie(t){var e=Aie(t,"string");return typeof e=="symbol"?e:String(e)}function Aie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Aw=0,IA=1,xA=2,fl="px";let Oie=class{constructor(e){Mw(this,"hot",void 0),Mw(this,"_element",null),Mw(this,"state",Aw),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=xA}build(){this.state===Aw&&(this._element=this.hot.rootDocument.createElement("div"),this.state=IA)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=Aw}isAppended(){return this.state===xA}isBuilt(){return this.state>=IA}setPosition(e,n){e!==void 0&&(this._element.style.top=e+fl),n!==void 0&&(this._element.style.left=n+fl)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+fl),n&&(this._element.style.height=n+fl)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+fl),n&&(this._element.style.marginLeft=n+fl)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const pN=Oie,Pie="ht__manualRowMove--backlight";class Iie extends pN{build(){super.build(),Z(this._element,Pie)}}const xie=Iie,Hie="ht__manualRowMove--guideline";class Die extends pN{build(){super.build(),Z(this._element,Hie)}}const Nie=Die;function gl(t,e){wN(t,e),e.add(t)}function ml(t,e,n){wN(t,e),e.set(t,n)}function wN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ha(t,e,n){var r=vN(t,e,"set");return Lie(t,r,n),n}function Lie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function $e(t,e){var n=vN(t,e,"get");return $ie(t,n)}function vN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $ie(t,e){return e.get?e.get.call(t):e.value}function pl(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeRowMove");fe.getSingleton().register("afterRowMove");const Ow="manualRowMove",kie=140,HA="ht__manualRowMove",Jf="show-ui",wC="on-moving--rows",vC="after-selection--rows";var Fn=new WeakMap,es=new WeakMap,Co=new WeakMap,as=new WeakMap,ir=new WeakMap,Id=new WeakMap,DA=new WeakSet,NA=new WeakSet,LA=new WeakSet,$A=new WeakSet,kA=new WeakSet,FA=new WeakSet;class Fie extends it{constructor(){super(...arguments),gl(this,FA),gl(this,kA),gl(this,$A),gl(this,LA),gl(this,NA),gl(this,DA),ml(this,Fn,{writable:!0,value:new xie(this.hot)}),ml(this,es,{writable:!0,value:new Nie(this.hot)}),ml(this,Co,{writable:!0,value:[]}),ml(this,as,{writable:!0,value:void 0}),ml(this,ir,{writable:!0,value:{}}),ml(this,Id,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return Ow}static get PLUGIN_PRIORITY(){return kie}isEnabled(){return!!this.hot.getSettings()[Ow]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pl(e,DA,Wie).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pl(e,LA,Bie).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>pl(this,kA,Gie).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return pl(e,FA,zie).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Z(this.hot.rootElement,HA),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Le(this.hot.rootElement,HA),this.unregisterEvents(),$e(this,Fn).destroy(),$e(this,es).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const r=$e(this,Id),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(ha(this,Id,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);const s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const r=this.countFinalIndex(e,n);return ha(this,Id,n),this.moveRows(e,r)}isMovePossible(e,n){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){const r=Gt(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){const r=this.hot.rowIndexMapper;let i=0;for(let o=e;o<=n;o++){const s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[Ow];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;const{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return pe(o,s,a=>{n.push(a)}),n}refreshPositions(){const e=$e(this,ir).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,s=$e(this,ir).TD,a=this.hot.rootElement,l=en(a),u=ga(a),c=o.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=$e(this,ir).eventPageY-d+c,p=o.hider.offsetHeight,v=o.TBODY.offsetTop,S=$e(this,Fn).getOffset().top,y=$e(this,Fn).getSize().height,R=s.offsetHeight/2,T=s.offsetHeight;let A=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const M=f>=A+R;this.isFixedRowTop(e.row)&&(A+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?$e(this,ir).row=n>0?n-1:n:M?($e(this,ir).row=e.row+1,A+=e.row===0?T-1:T):$e(this,ir).row=e.row;let L=f,B=A;f+y+S>=p?L=p-y-S:f+S<v&&(L=v+Math.abs(S)),A>=p-1&&(B=p-1),$e(this,Fn).setPosition(L),$e(this,es).setPosition(B)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>pl(this,NA,Vie).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>pl(this,$A,Uie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){$e(this,Fn).build(),$e(this,es).build()}destroy(){$e(this,Fn).destroy(),$e(this,es).destroy(),super.destroy()}}function Wie(t,e,n,r){const{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||$e(this,as)||t.button!==0){ha(this,as,!1),$e(this,Co).length=0,Le(this.hot.rootElement,[wC,Jf]);return}const l=$e(this,es).isBuilt()&&!$e(this,es).isAppended(),u=$e(this,Fn).isBuilt()&&!$e(this,Fn).isAppended();l&&u&&($e(this,es).appendTo(i.hider),$e(this,Fn).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){r.row=!0,ha(this,as,!0),$e(this,ir).eventPageY=t.pageY,$e(this,ir).coords=e,$e(this,ir).TD=n,ha(this,Co,this.prepareRowsToMoving());const p=i.holder.scrollLeft+o.getRowHeaderWidth(),v=this.getRowsHeight(d,e.row-1)+t.offsetY;$e(this,Fn).setPosition(null,p),$e(this,Fn).setSize(i.hider.offsetWidth-p,this.getRowsHeight(d,f)),$e(this,Fn).setOffset(-v,null),Z(this.hot.rootElement,wC),this.refreshPositions()}else Le(this.hot.rootElement,vC),ha(this,as,!1),$e(this,Co).length=0}function Vie(t){$e(this,as)&&($e(this,ir).eventPageY=t.pageY,this.refreshPositions())}function Bie(t,e,n,r){!this.hot.getSelectedRangeLast()||!$e(this,as)||($e(this,Co).indexOf(e.row)>-1?Le(this.hot.rootElement,Jf):Z(this.hot.rootElement,Jf),r.row=!0,r.column=!0,r.cell=!0,$e(this,ir).coords=e,$e(this,ir).TD=n)}function Uie(){const t=$e(this,ir).row,e=$e(this,Co).length;if(ha(this,as,!1),Le(this.hot.rootElement,[wC,Jf,vC]),this.hot.selection.isSelectedByRowHeader()&&Z(this.hot.rootElement,vC),e<1||t===void 0)return;const n=$e(this,Co)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows($e(this,Co),t);if($e(this,Co).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);const o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function Gie(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;$e(this,Fn).setPosition(null,r),$e(this,Fn).setSize(t.hider.offsetWidth-r)}function zie(){this.moveBySettingsOrLoad()}function Qs(t,e){CN(t,e),e.add(t)}function vn(t,e,n){CN(t,e),e.set(t,n)}function CN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Js(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function $t(t,e,n){var r=SN(t,e,"set");return Yie(t,r,n),n}function Yie(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function se(t,e){var n=SN(t,e,"get");return jie(t,n)}function SN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function jie(t,e){return e.get?e.get.call(t):e.value}const eg="manualRowResize",Kie=30,WA="manualRowHeights";var Ai=new WeakMap,xd=new WeakMap,fr=new WeakMap,tg=new WeakMap,ts=new WeakMap,uR=new WeakMap,Ll=new WeakMap,Hd=new WeakMap,Nn=new WeakMap,_i=new WeakMap,Ca=new WeakMap,ng=new WeakMap,wc=new WeakMap,vc=new WeakMap,Jr=new WeakMap,Cc=new WeakMap,VA=new WeakSet,BA=new WeakSet,UA=new WeakSet,GA=new WeakSet,zA=new WeakSet,YA=new WeakSet,jA=new WeakSet;class Xie extends it{static get PLUGIN_KEY(){return eg}static get PLUGIN_PRIORITY(){return Kie}constructor(e){super(e),Qs(this,jA),Qs(this,YA),Qs(this,zA),Qs(this,GA),Qs(this,UA),Qs(this,BA),Qs(this,VA),vn(this,Ai,{writable:!0,value:null}),vn(this,xd,{writable:!0,value:null}),vn(this,fr,{writable:!0,value:[]}),vn(this,tg,{writable:!0,value:null}),vn(this,ts,{writable:!0,value:null}),vn(this,uR,{writable:!0,value:null}),vn(this,Ll,{writable:!0,value:null}),vn(this,Hd,{writable:!0,value:null}),vn(this,Nn,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),vn(this,_i,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),vn(this,Ca,{writable:!0,value:!1}),vn(this,ng,{writable:!0,value:!1}),vn(this,wc,{writable:!0,value:0}),vn(this,vc,{writable:!0,value:null}),vn(this,Jr,{writable:!0,value:void 0}),vn(this,Cc,{writable:!0,value:void 0}),Z(se(this,Nn),"manualRowResizer"),Z(se(this,_i),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[eg]}enablePlugin(){this.enabled||($t(this,Jr,new Ts),se(this,Jr).addLocalHook("init",()=>Js(this,jA,noe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,se(this,Jr)),this.addHook("modifyRowHeight",(e,n)=>Js(this,YA,toe).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){$t(this,Cc,se(this,Jr).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",WA,se(this,Jr).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",WA,e),e.value}setManualSize(e,n){const r=this.hot.toPhysicalRow(e),i=Math.max(n,Vg.DEFAULT_HEIGHT);return se(this,Jr).setValueAtIndex(r,i),i}setupHandlePosition(e){$t(this,Ai,e);const{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(se(this,Ai)),o=i.row;if(o<0)return;const s=ft(se(this,Ai)),a=se(this,Ai).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),u=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;l?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(se(this,Ai),i.row,i.col):u&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(se(this,Ai),i.row,i.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(se(this,Ai),i.row,i.col)),$t(this,xd,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),$t(this,fr,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();E(d,f=>{const p=f.getTopStartCorner().row,v=f.getBottomStartCorner().row;pe(p,v,S=>{se(this,fr).includes(S)||se(this,fr).push(S)})})}se(this,fr).includes(se(this,xd))||$t(this,fr,[se(this,xd)]),$t(this,Hd,c.top-6),$t(this,Ll,parseInt(a.height,10)),se(this,Nn).style.top=`${se(this,Hd)+se(this,Ll)}px`,se(this,Nn).style[this.inlineDir]=`${c.start}px`,se(this,Nn).style.width=`${s}px`,this.hot.rootElement.appendChild(se(this,Nn))}refreshHandlePosition(){se(this,Nn).style.top=`${se(this,Hd)+se(this,tg)}px`}setupGuidePosition(){const e=parseInt(ft(se(this,Nn)),10),n=parseInt(se(this,Nn).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Z(se(this,Nn),"active"),Z(se(this,_i),"active"),se(this,_i).style.top=se(this,Nn).style.top,se(this,_i).style[this.inlineDir]=`${n}px`,se(this,_i).style.width=`${r-e}px`,this.hot.rootElement.appendChild(se(this,_i))}refreshGuidePosition(){se(this,_i).style.top=se(this,Nn).style.top}hideHandleAndGuide(){Le(se(this,Nn),"active"),Le(se(this,_i),"active")}checkIfRowHeader(e){const n=gs(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,i.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&se(this,ts)<n?n:se(this,ts)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&$t(this,ts,o),this.setManualSize(r,se(this,ts)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};se(this,wc)>=2&&(se(this,fr).length>1?(E(se(this,fr),i=>{n(i)}),e()):E(se(this,fr),i=>{n(i,!0)})),$t(this,wc,0),$t(this,vc,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Js(this,VA,qie).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Js(this,BA,Zie).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Js(this,UA,Qie).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Js(this,GA,Jie).call(this)),this.eventManager.addEventListener(se(this,Nn),"contextmenu",()=>Js(this,zA,eoe).call(this))}destroy(){super.destroy()}}function qie(t){if(!vS(t.target)&&se(this,ng)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(se(this,Ca)||this.setupHandlePosition(e))}}function Zie(t){Pe(t.target,"manualRowResizer")&&(this.setupHandlePosition(se(this,Ai)),this.setupGuidePosition(),$t(this,Ca,!0),se(this,vc)===null&&($t(this,vc,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(se(this,vc))),$t(this,wc,se(this,wc)+1),$t(this,uR,t.pageY),$t(this,ts,se(this,Ll)))}function Qie(t){se(this,Ca)&&($t(this,tg,se(this,Ll)+(t.pageY-se(this,uR))),E(se(this,fr),e=>{$t(this,ts,this.setManualSize(e,se(this,tg)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Jie(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};se(this,Ca)&&(this.hideHandleAndGuide(),$t(this,Ca,!1),se(this,ts)!==se(this,Ll)&&(se(this,fr).length>1?(E(se(this,fr),r=>{e(r)}),t()):E(se(this,fr),r=>{e(r,!0)})),this.setupHandlePosition(se(this,Ai)))}function eoe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(se(this,Nn)),this.hot.rootElement.removeChild(se(this,_i)),$t(this,Ca,!1),$t(this,ng,!0),this.hot._registerImmediate(()=>{$t(this,ng,!1)})}function toe(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),i=se(this,Jr).getValueAtIndex(r);this.hot.getSettings()[eg]&&i&&(n=i)}return n}function noe(){const t=this.hot.getSettings()[eg],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{se(this,Jr).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{se(this,Jr).setValueAtIndex(r,n)}),$t(this,Cc,t)):t===!0&&Array.isArray(se(this,Cc))&&se(this,Cc).forEach((n,r)=>{se(this,Jr).setValueAtIndex(r,n)})},!0)}function ea(t,e,n){return e=roe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function roe(t){var e=ioe(t,"string");return typeof e=="symbol"?e:String(e)}function ioe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ooe{constructor(e,n,r,i,o,s){ea(this,"row",void 0),ea(this,"col",void 0),ea(this,"rowspan",void 0),ea(this,"colspan",void 0),ea(this,"removed",!1),ea(this,"cellCoordsFactory",void 0),ea(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return ht`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return ht`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),u=this[s],c=this[s]+this[o]-1;if(u>=n&&(this[s]+=r),r>0)n<=c&&n>u&&(this[o]+=r);else if(r<0){if(a<=u&&l>=c)return this.removed=!0,!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(r)-h;this[s]-=d+r,this[o]-=h}else if(u<=a&&c>=l)this[o]+=r;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[o]-=h}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}}const Oi=ooe;function CC(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function Pw(t,e,n){return e=soe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function soe(t){var e=aoe(t,"string");return typeof e=="symbol"?e:String(e)}function aoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cR{constructor(e){Pw(this,"plugin",void 0),Pw(this,"mergedCells",[]),Pw(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return ht`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){const r=this.mergedCells;let i=!1;return E(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){const n=this.mergedCells;let r=!1;return E(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCells,i=[];let o=e;if(!o.includesRange){const s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return E(r,s=>{const a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),u=this.hot._createCellRange(a,a,l);n?o.overlaps(u)&&i.push(s):o.includesRange(u)&&i.push(s)}),i.length?i:!1}add(e){const n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new Oi(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),u=this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),n.push(a),a):(gt(cR.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){const e=this.mergedCells,n=[],r=[];E(e,i=>{const o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,E(n,(i,o)=>{pe(0,i.rowspan-1,s=>{pe(0,i.colspan-1,a=>{if(a!==0||s!==0){const l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),E(n,i=>{CC(...i)}),E(r,i=>{CC(...i)})}isOverlapping(e){const n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1));let r=!1;return E(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){const r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){const r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){const i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break}E(this.mergedCells,o=>{o.shift(i,n)}),Of(this.mergedCells.length-1,0,o=>{const s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}}const loe=cR;function Iw(t,e,n){return e=uoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uoe(t){var e=coe(t,"string");return typeof e=="symbol"?e:String(e)}function coe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hoe{constructor(e){Iw(this,"plugin",void 0),Iw(this,"mergedCellsCollection",void 0),Iw(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){const o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,u,c]=e,d=["up","down"].indexOf(r)>-1?u-a+1:c-l+1,f=Math.floor(s/d)*d,p=s-f,v=this.getFarthestCollection(e,n,r,i);if(v){if(r==="down"){const S=v.row+v.rowspan-a-p;o[2]+S>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?S:0}else if(r==="right"){const S=v.col+v.colspan-l-p;o[3]+S>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?S:0}else if(r==="up"){const S=u-p-v.row+1;o[0]+S<0?o[0]+=p:o[0]-=p?S:0}else if(r==="left"){const S=c-p-v.col+1;o[1]+S<0?o[1]+=p:o[1]-=p?S:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:d}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),jt(this.currentFillData,e)}getAutofillSize(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return i-l;case"down":return c-s;case"left":return o-u;case"right":return h-a;default:return null}}getDragArea(e,n,r){const[i,o,s,a]=e,[l,u,c,h]=n;switch(r){case"up":return[l,u,i-1,a];case"down":return[s+1,o,c,a];case"left":return[l,u,s,o-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,n,r,i){const[o,s,a,l]=e,u=["up","down"].indexOf(r)>-1,c=u?a:l,h=u?o:s,d=this.getAutofillSize(e,n,r),f=u?a-o+1:l-s+1,p=Math.floor(d/f)*f,v=d-p;let S=null,y=null,R=null;switch(r){case"up":S="includesVertically",R=c-v+1;break;case"left":S="includesHorizontally",R=c-v+1;break;case"down":S="includesVertically",R=h+v-1;break;case"right":S="includesHorizontally",R=h+v-1;break}return E(i,T=>{T[S](R)&&T.isFarther(y,r)&&(y=T)}),y}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(u,c)=>{switch(i){case"up":return u.row-c>=n.from.row;case"down":return u.row+u.rowspan-1+c<=n.to.row;case"left":return u.col-c>=n.from.column;case"right":return u.col+u.colspan-1+c<=n.to.column;default:return null}};let s=0,a=null,l=1;do for(let u=0;u<r.length;u+=1){if(a=r[u],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break}u===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},r={min:null,max:null};return E(e,i=>{const o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){const i=this.getDragArea(e,n,r),[o,s,a,l]=i,u=this.plugin.hot._createCellCoords(o,s),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return!!this.mergedCellsCollection.getWithinRange(h,!0)}}const doe=hoe;function xw(t,e,n){return e=foe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function foe(t){var e=goe(t,"string");return typeof e=="symbol"?e:String(e)}function goe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class moe{constructor(e){xw(this,"plugin",void 0),xw(this,"hot",void 0),xw(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){const i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){const o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const c=this.plugin.mergedCellsCollection.get(e,n);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(o<=c.row&&s<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){const o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}const poe=moe;function woe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(Ty)}return this.getTranslatedPhrase(Ey)},callback(){t.toggleMergeOnSelection()},disabled(){const e=this.getSelectedLast();return e?Oi.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Dt(t,e){yN(t,e),e.add(t)}function voe(t,e,n){yN(t,e),e.set(t,n)}function yN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hw(t,e,n){return e=Coe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Coe(t){var e=Soe(t,"string");return typeof e=="symbol"?e:String(e)}function Soe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dw(t,e,n){var r=bN(t,e,"set");return yoe(t,r,n),n}function yoe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function wl(t,e){var n=bN(t,e,"get");return boe(t,n)}function bN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function boe(t,e){return e.get?e.get.call(t):e.value}function At(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}fe.getSingleton().register("beforeMergeCells");fe.getSingleton().register("afterMergeCells");fe.getSingleton().register("beforeUnmergeCells");fe.getSingleton().register("afterUnmergeCells");const Sc="mergeCells",Roe=150,KA=Sc;var Mi=new WeakMap,XA=new WeakSet,qA=new WeakSet,ZA=new WeakSet,QA=new WeakSet,JA=new WeakSet,eO=new WeakSet,tO=new WeakSet,Nw=new WeakSet,nO=new WeakSet,rO=new WeakSet,iO=new WeakSet,oO=new WeakSet,sO=new WeakSet,aO=new WeakSet,lO=new WeakSet,uO=new WeakSet,cO=new WeakSet,hO=new WeakSet,dO=new WeakSet,fO=new WeakSet,gO=new WeakSet,mO=new WeakSet,pO=new WeakSet;class Eoe extends it{constructor(){super(...arguments),Dt(this,pO),Dt(this,mO),Dt(this,gO),Dt(this,fO),Dt(this,dO),Dt(this,hO),Dt(this,cO),Dt(this,uO),Dt(this,lO),Dt(this,aO),Dt(this,sO),Dt(this,oO),Dt(this,iO),Dt(this,rO),Dt(this,nO),Dt(this,Nw),Dt(this,tO),Dt(this,eO),Dt(this,JA),Dt(this,QA),Dt(this,ZA),Dt(this,qA),Dt(this,XA),Hw(this,"mergedCellsCollection",null),Hw(this,"autofillCalculations",null),Hw(this,"selectionCalculations",null),voe(this,Mi,{writable:!0,value:null})}static get PLUGIN_KEY(){return Sc}static get PLUGIN_PRIORITY(){return Roe}isEnabled(){return!!this.hot.getSettings()[Sc]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new loe(this),this.autofillCalculations=new doe(this),this.selectionCalculations=new poe(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,XA,Toe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,ZA,Moe).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,fO,Uoe).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,QA,Aoe).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,JA,Ooe).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Nw,wO).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,Nw,wO).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,nO,xoe).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,qA,_oe).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,tO,Ioe).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,eO,Poe).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,rO,Hoe).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,iO,Doe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,oO,Noe).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,sO,Loe).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,aO,$oe).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,lO,koe).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,uO,Foe).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,cO,Woe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,hO,Voe).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,dO,Boe).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,gO,Goe).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,mO,zoe).call(e,...r)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return At(e,pO,Yoe).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[Sc];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!RS())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{const{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>(o==null?void 0:o.name)==="master"?o:o.clone.wtTable).forEach(o=>{const s=o.getRow(i);s&&(s.style.background=$l(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=$l(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(Oi.containsNegativeValues(e)?(gt(Oi.NEGATIVE_VALUES_WARNING(e)),n=!1):Oi.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(gt(Oi.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):Oi.isSingleCell(e)?(gt(Oi.IS_SINGLE_CELL(e)),n=!1):Oi.containsZeroSpan(e)&&(gt(Oi.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){const n=[];if(E(e,r=>{if(!this.validateSetting(r))return;const i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),pe(r.row,r.row+r.rowspan-1,a=>{pe(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){const e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[];let l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),pe(0,s.rowspan-1,c=>{pe(0,s.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+c,s.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),E(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),pe(0,i.rowspan-1,o=>{pe(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){const o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:KA})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(KA)}modifyViewportRowStart(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ve(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(i,o);if(Ve(s)){const a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ve(s)){const a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const s=this.mergedCellsCollection.get(o,i);if(Ve(s)){const a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot;let a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);const u=e>=0?o.getRenderableFromVisualIndex(a):e,c=r>=0?s.getRenderableFromVisualIndex(l):r;return[u,c]}}function Toe(){this.generateFromSettings(this.hot.getSettings()[Sc]),this.hot.render()}function _oe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function Moe(t){const e=this.hot.getSelectedRangeLast();let n={row:t.row,col:t.col},r=null;const i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(wl(this,Mi)||Dw(this,Mi,this.hot._createCellCoords(null,null)),o){const a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(wl(this,Mi))||Dw(this,Mi,this.hot._createCellCoords(null,null)),n.row=wl(this,Mi).row?wl(this,Mi).row-i.row:n.row,n.col=wl(this,Mi).col?wl(this,Mi).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);const s=this.mergedCellsCollection.get(r.row,r.col);if(s){const a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);Dw(this,Mi,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function Aoe(t){const e=this.hot.getSelectedRangeLast(),n=Vn(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t);let i=Vn(n);const o=this.mergedCellsCollection.getWithinRange(r,!0);do i=Vn(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),E(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function Ooe(t,e){if(t<0||e<0)return;const n=this.mergedCellsCollection.get(t,e);if(!n)return;const{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function Poe(t){t.items.push({name:"---------"},woe(this))}function Ioe(t,e,n){const r=this.mergedCellsCollection.get(e,n),i=Ve(r)?Vn(r):void 0;if(Ve(i)){const{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:u,rowspan:c}=i,[h,d]=this.translateMergedCellToRenderable(a,c,l,u),f=o.getRenderableFromVisualIndex(e),p=s.getRenderableFromVisualIndex(n),v=h-f+1,S=d-p+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,v),i.colspan=Math.min(i.colspan,S)}CC(t,i,e,n)}function wO(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){const e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function xoe(t){const e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){const o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function Hoe(t,e,n){const r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Doe(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function Noe(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function Loe(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const n=this.autofillCalculations.getDirection(e,t);let r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;const i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function $oe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function koe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Foe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Woe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Voe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Boe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);E(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Uoe(t,e,n){if(!this.enabled)return;const r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;const i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,u=r.row===0,c=r.col+r.colspan-1===this.hot.countCols()-1,h=r.col===0;(i&&l||o&&u||a&&c||s&&h)&&(t.row=r.row,t.col=r.col)}function Goe(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function zoe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Yoe(t,e,n,r){if(!(r instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const s=this.hot._createCellCoords(o.row,o.col),a=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(s,s,a))}function joe(t,e){return function(n,r){const[,...i]=n,[,...o]=r;return function s(a){const l=t[a],u=e[a],c=i[a],h=o[a],d=u.multiColumnSorting,p=(d.compareFunctionFactory?d.compareFunctionFactory:XH(u.type))(l,u,d)(c,h);if(p===Li){const v=a+1;if(typeof e[v]<"u")return s(v)}return p}(0)}}function vO(){gt(ht`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}const RN="sort";function Koe(t,e,n){const r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${RN}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Xoe(t){const e=t.className.split(" "),n=new RegExp(`^${RN}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function qoe(t,e,n){return e=Zoe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zoe(t){var e=Qoe(t,"string");return typeof e=="symbol"?e:String(e)}function Qoe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rg="multiColumnSorting",Joe=170,CO="columnSorting",SO=rg;KH(rg,joe);class ese extends qH{constructor(){super(...arguments),qoe(this,"pluginKey",rg)}static get PLUGIN_KEY(){return rg}static get PLUGIN_PRIORITY(){return Joe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CO]&&vO(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Vf))},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:SO})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SO)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),Le(e,Xoe(e)),this.enabled!==!1&&Z(e,Koe(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[CO]&&vO(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){Zb(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,Vf))):this.sort(this.getColumnNextConfig(n.col)))}}function yO(t,e,n){return e=tse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tse(t){var e=nse(t,"string");return typeof e=="symbol"?e:String(e)}function nse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rse="multipleSelectionHandles",ise=160;class ose extends it{constructor(){super(...arguments),yO(this,"dragged",[]),yO(this,"lastSetCell",null)}static get PLUGIN_KEY(){return rse}static get PLUGIN_PRIORITY(){return ise}isEnabled(){return go()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(Pe(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(Pe(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(Pe(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Pe(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{const{rootDocument:o}=this.hot;let s,a,l,u,c,h;if(e.dragged.length===0)return;const d=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(s=e.hot.getCoords(d),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(s),h=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){const s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?c={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(c={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?c={start:n,end:l}:c.end=n;break;case"NW-SE":o==="top"?c={start:n,end:a}:c.end=n;break;case"SE-NW":o==="top"?c={start:n,end:s}:c.end=n;break;case"SW-NE":o==="top"?c={start:n,end:u}:c.end=n;break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:c={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?c={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:c={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?c={start:this.hot._createCellCoords(n.row,u.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(c={start:l,end:n});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(c.end=n);break;case"SE-NW":o==="top"?c.end=n:c={start:n,end:s};break}break}return c}isDragged(){return this.dragged.length>0}}function SC(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function EN(){return{label:"",isPlaceholder:!0}}function sse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;E(t,i=>{const o=[];let s=0;n.push(o),E(i,a=>{const l=SC();if(Ve(a)){const{label:c,colspan:h}=a;l.label=Wt(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h)}else l.label=Wt(a);s+=l.origColspan;let u=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,u=!0),o.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)o.push(EN());return!u})});const r=Math.max(...Ue(n,i=>i.length));return E(n,i=>{if(i.length<r){const o=Ue(new Array(r-i.length),()=>SC());i.splice(i.length,0,...o)}}),n}function Lw(t,e,n){ase(t,e),e.set(t,n)}function ase(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(t,e){var n=TN(t,e,"get");return lse(t,n)}function lse(t,e){return e.get?e.get.call(t):e.value}function Gu(t,e,n){var r=TN(t,e,"set");return use(t,r,n),n}function TN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function use(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}const bO=["label","collapsible"];var ro=new WeakMap,ta=new WeakMap,$w=new WeakMap;class cse{constructor(){Lw(this,ro,{writable:!0,value:[]}),Lw(this,ta,{writable:!0,value:0}),Lw(this,$w,{writable:!0,value:1/0})}setColumnsLimit(e){Gu(this,$w,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];Gu(this,ro,sse(e,Kr(this,$w))),Gu(this,ta,Kr(this,ro).length)}getData(){return Kr(this,ro)}mergeWith(e){E(e,n=>{let{row:r,col:i,...o}=n;const s=this.getHeaderSettings(r,i);s!==null&&jt(s,o,bO)})}map(e){E(Kr(this,ro),n=>{E(n,r=>{const i=e({...r});Ve(i)&&jt(r,i,bO)})})}getHeaderSettings(e,n){var r;if(e>=Kr(this,ta)||e<0)return null;const i=Kr(this,ro)[e];return Array.isArray(i)===!1||n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=Kr(this,ta)||e<0)return i;const o=Kr(this,ro)[e];let s=0;for(let a=n;a<o.length;a++){const l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Kr(this,ta)}getColumnsCount(){return Kr(this,ta)>0?Kr(this,ro)[0].length:0}clear(){Gu(this,ro,[]),Gu(this,ta,0)}}function kw(t,e,n){return e=hse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hse(t){var e=dse(t,"string");return typeof e=="symbol"?e:String(e)}function dse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _N="DF-pre-order";function MN(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=MN.call(this.childs[r],t,e)}return n}const fse="DF-post-order";function AN(t,e){for(let n=0;n<this.childs.length;n++)if(AN.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const ON="BF";function gse(t,e){const n=[this];function r(){if(n.length===0)return;const i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}const mse=ON,RO=new Map([[_N,MN],[fse,AN],[ON,gse]]);class ig{constructor(e){kw(this,"data",{}),kw(this,"parent",null),kw(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new ig({...e.data});for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:mse;if(!RO.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);RO.get(n).call(this,e,this)}walkUp(e){const n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}}function Fw(t,e,n){pse(t,e),e.set(t,n)}function pse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dn(t,e){var n=PN(t,e,"get");return wse(t,n)}function wse(t,e){return e.get?e.get.call(t):e.value}function vse(t,e,n){var r=PN(t,e,"set");return Cse(t,r,n),n}function PN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Cse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var vl=new WeakMap,na=new WeakMap,Cl=new WeakMap;class Sse{constructor(e){Fw(this,vl,{writable:!0,value:new Map}),Fw(this,na,{writable:!0,value:new Map}),Fw(this,Cl,{writable:!0,value:null}),vse(this,Cl,e)}getRoots(){return Array.from(Dn(this,vl).values())}getRootByColumn(e){let n;return Dn(this,na).has(e)&&(n=Dn(this,vl).get(Dn(this,na).get(e))),n}getNode(e,n){const r=this.getRootByColumn(n);if(!r)return;const i=n-Dn(this,na).get(n);let o=0,s;return r.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Dn(this,na).clear(),E(Dn(this,vl),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Dn(this,na).set(i,e);e+=r})}buildTree(){this.clear();const e=Dn(this,Cl).getColumnsCount();let n=0;for(;n<e;){const r=Dn(this,Cl).getHeaderSettings(0,n),i=new ig;Dn(this,vl).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Dn(this,Cl).getHeadersSettings(r,n,i);r+=1,E(o,s=>{const a={...s,headerLevel:r-1,columnIndex:n};let l;r===1?(e.data=a,l=e):(l=new ig(a),e.addChild(l)),r<Dn(this,Cl).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Dn(this,vl).clear(),Dn(this,na).clear()}}function IN(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function og(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function sg(t){return og(t,"origColspan")===t.data.origColspan}function hR(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sg(t))return hR(n[0]);e.isCollapsed=!1;const i=n.slice(1),o=new Set;let s=0;if(i.length>0)E(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;s+=l.colspan,IN(a,u=>{o.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;s=l-a;for(let c=1;c<l;c++)o.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):sg(a)&&(l.isCollapsed=og(a,"isCollapsed"))}),{rollbackModification:()=>dR(t),affectedColumns:Array.from(o),colspanCompensation:s}}function dR(t){var e;const{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(sg(t))return dR(r[0]);n.isCollapsed=!0;const o=r.slice(1),s=new Set;if(o.length>0)E(o,l=>{IN(l,u=>{s.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=n;for(let c=1;c<l;c++){const h=u+c;s.add(h)}}const a=n.colspan-((e=og(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):sg(l)&&(u.isCollapsed=og(l,"isCollapsed"))}),{rollbackModification:()=>hR(t),affectedColumns:Array.from(s),colspanCompensation:a}}function yse(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function bse(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ht`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{const{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{const{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const EO=new Map([["collapse",dR],["expand",hR],["hide-column",yse],["show-column",bse]]);function Rse(t,e,n){if(!EO.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return EO.get(t)(e,n)}function Dd(t){const e=[];return E(t,n=>{n.walkDown(r=>{const i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,u=Tse(e,a);let c=!1;for(let h=s;h<s+o;h++)if(l.includes(h)||c)u.push(EN());else{const f=Ese(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function Ese(t){const{crossHiddenColumns:e,...n}=SC(t);return n}function Tse(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function Ww(t,e,n){_se(t,e),e.set(t,n)}function _se(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zu(t,e,n){var r=xN(t,e,"set");return Mse(t,r,n),n}function Mse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Nt(t,e){var n=xN(t,e,"get");return Ase(t,n)}function xN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ase(t,e){return e.get?e.get.call(t):e.value}var Ei=new WeakMap,Xn=new WeakMap,ra=new WeakMap;class Ose{constructor(){Ww(this,Ei,{writable:!0,value:new cse}),Ww(this,Xn,{writable:!0,value:new Sse(Nt(this,Ei))}),Ww(this,ra,{writable:!0,value:[[]]})}setState(e){Nt(this,Ei).setData(e);let n=!1;try{Nt(this,Xn).buildTree()}catch{Nt(this,Xn).clear(),Nt(this,Ei).clear(),n=!0}return zu(this,ra,Dd(Nt(this,Xn).getRoots())),n}setColumnsLimit(e){Nt(this,Ei).setColumnsLimit(e)}mergeStateWith(e){const n=Ue(e,r=>{let{row:i,...o}=r;return{row:i<0?this.rowCoordsToLevel(i):i,...o}});Nt(this,Ei).mergeWith(n),Nt(this,Xn).buildTree(),zu(this,ra,Dd(Nt(this,Xn).getRoots()))}mapState(e){Nt(this,Ei).map(e),Nt(this,Xn).buildTree(),zu(this,ra,Dd(Nt(this,Xn).getRoots()))}mapNodes(e){return Gt(Nt(this,Xn).getRoots(),(n,r)=>(r.walkDown(i=>{const o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));const i=Nt(this,Xn).getNode(n,r);let o;return i&&(o=Rse(e,i,r),zu(this,ra,Dd(Nt(this,Xn).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=Nt(this,ra)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){const r=this.getHeaderTreeNode(e,n);return r?{...r.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const r=Nt(this,Xn).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=r-e+1;let o=!1,s=null;for(let a=e;a<=r;a++){const l=Nt(this,Xn).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:f}=u.data;f||d<=i&&c>=e&&c+d-1<=r&&(s===null||h<s)&&(s=h)},_N)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;const{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;const{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;const{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return Nt(this,Ei).getLayersCount()}getColumnsCount(){return Nt(this,Ei).getColumnsCount()}clear(){zu(this,ra,[]),Nt(this,Ei).clear(),Nt(this,Xn).clear()}}function Yu(t,e,n){return e=Pse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pse(t){var e=Ise(t,"string");return typeof e=="symbol"?e:String(e)}function Ise(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xse{constructor(e,n){Yu(this,"hot",void 0),Yu(this,"nestedHeaderSettingsGetter",void 0),Yu(this,"layersCount",0),Yu(this,"container",void 0),Yu(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=n.createElement("tr");for(let c=0;c<a;c++){let h=r.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let p=f.label;s&&(p+='<button class="changeType"></button>'),Ea(d,p),d.colSpan=f.colspan,u.appendChild(d)}}o.appendChild(u)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}const Hse=xse;function ln(t,e){HN(t,e),e.add(t)}function TO(t,e,n){return e=Dse(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dse(t){var e=Nse(t,"string");return typeof e=="symbol"?e:String(e)}function Nse(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nd(t,e,n){HN(t,e),e.set(t,n)}function HN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function da(t,e,n){var r=DN(t,e,"set");return Lse(t,r,n),n}function Lse(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tt(t,e){var n=DN(t,e,"get");return $se(t,n)}function DN(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function $se(t,e){return e.get?e.get.call(t):e.value}function Xt(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const _O="nestedHeaders",kse=280;var dt=new WeakMap,Yo=new WeakMap,yc=new WeakMap,cm=new WeakMap,Ld=new WeakSet,MO=new WeakSet,AO=new WeakSet,OO=new WeakSet,PO=new WeakSet,IO=new WeakSet,xO=new WeakSet,HO=new WeakSet,DO=new WeakSet,NO=new WeakSet,LO=new WeakSet,$O=new WeakSet,kO=new WeakSet,FO=new WeakSet,WO=new WeakSet,VO=new WeakSet,BO=new WeakSet,UO=new WeakSet;class Fse extends it{constructor(){super(...arguments),ln(this,UO),ln(this,BO),ln(this,VO),ln(this,WO),ln(this,FO),ln(this,kO),ln(this,$O),ln(this,LO),ln(this,NO),ln(this,DO),ln(this,HO),ln(this,xO),ln(this,IO),ln(this,PO),ln(this,OO),ln(this,AO),ln(this,MO),ln(this,Ld),Nd(this,dt,{writable:!0,value:new Ose}),Nd(this,Yo,{writable:!0,value:null}),Nd(this,yc,{writable:!0,value:null}),Nd(this,cm,{writable:!0,value:!1}),TO(this,"ghostTable",new Hse(this.hot,(e,n)=>this.getHeaderSettings(e,n))),TO(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return _O}static get PLUGIN_PRIORITY(){return kse}isEnabled(){return!!this.hot.getSettings()[_O]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&gt(ht`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Xt(this,BO,tae).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,UO,nae).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,PO,Use).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,IO,Gse).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,xO,zse).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,HO,Yse).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,DO,jse).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,NO,Kse).call(e,...i)}),this.addHook("afterSelection",()=>Xt(this,Ld,Vw).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,MO,Wse).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Xt(this,$O,qse).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,FO,Qse).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,WO,Jse).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,AO,Vse).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,OO,Bse).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,LO,Xse).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,kO,Zse).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Xt(e,VO,eae).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Xt(this,Ld,Vw).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Xt(this,Ld,Vw).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();tt(this,dt).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=tt(this,dt).setState(e)),this.detectedOverlappedHeaders&&gt(ht`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{const i=n===!0?"hide-column":"show-column";tt(this,dt).triggerColumnModification(i,r)}),!tt(this,Yo)&&this.enabled&&da(this,Yo,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){const a=s===!0?"hide-column":"show-column";tt(this,dt).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),tt(this,dt).clear(),tt(this,Yo).unsubscribe(),da(this,Yo,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return tt(this,dt)}getLayersCount(){return tt(this,dt).getLayersCount()}getHeaderSettings(e,n){return tt(this,dt).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){const a=r.childNodes[s];if(!a)break;const l=i.childNodes[s],u=o?o.childNodes[s]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),Le(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),Le(l.childNodes[c],"hiddenHeader")),o&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),Le(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),o.removeAttribute("colspan"),Le(o,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d}=(s=tt(this,dt).getHeaderSettings(e,u))!==null&&s!==void 0?s:{label:""};if(d||h)Z(o,"hiddenHeader");else if(c>1){var f,p;const{wtOverlays:v}=l._wt,S=(f=v.topInlineStartCornerOverlay)===null||f===void 0?void 0:f.clone.wtTable.THEAD.contains(o),y=(p=v.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),R=S||y?Math.min(c,r-i):c;R>1&&o.setAttribute("colspan",R)}this.hot.view.appendColHeader(u,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;const{isHidden:i,isPlaceholder:o}=(r=tt(this,dt).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){da(this,dt,null),tt(this,Yo)!==null&&(tt(this,Yo).unsubscribe(),da(this,Yo,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return tt(this,dt).getHeaderTreeNodeData(e.row,e.col)}}function Vw(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:n}=e;if(n.isHeader()&&n.col>=0){const i=tt(this,dt).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Wse(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=tt(this,dt).findLeftMostColumnIndex(n.row,n.col),a=tt(this,dt).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function Vse(t,e,n){const r=tt(this,dt).getHeaderTreeNodeData(e,t);if(!r)return t;const{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=tt(this,dt).getHeaderSettings(e,t);if(o===US){if(!a)return r.columnIndex}else if(o===O1&&(l>s-i||!a))return null;return t}function Bse(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){const{startRow:s,startCol:a,endRow:l,endCol:u}=e[o],c=l-s+1,h=a-u+1;if(s>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=s;f<=l;f++){var i;const p=c+f,v=d-a;if(v===0)continue;((i=tt(this,dt).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[p][v]="")}}}function Use(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Gse(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;da(this,yc,e.clone()),da(this,cm,!0);const{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(kg(t)||ws(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function zse(t,e,n,r){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;r.column=!0,r.cell=!0;const h=[],d=or(e.row,-1/0,-1);e.col<c.col?h.push(u.col,o,d):e.col>c.col?h.push(l.col,o+s-1,d):h.push(o,o+s-1,d),this.hot.selection.selectColumns(...h)}function Yse(){da(this,cm,!1)}function jse(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!tt(this,cm)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=tt(this,dt).getHeaderTreeNodeData(tt(this,yc).row,tt(this,yc).col);if(e.setHighlight(tt(this,yc)),o>e.getWidth()||i<n||i+o-1>r){const s=tt(this,dt).findTopMostEntireHeaderLevel(or(n,i,i+o-1),or(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Kse(t){const{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const i=tt(this,dt).findLeftMostColumnIndex(n.row,n.col),o=tt(this,dt).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Xse(t,e){const n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function qse(t){t.length=0;for(let e=0;e<tt(this,dt).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Zse(t){const e=tt(this,dt).getLayersCount();let n=t.startColumn,r=!!e;for(let i=0;i<e;i++){const o=tt(this,dt).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Wn(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?tt(this,dt).getHeaderTreeNodeData(0,n).columnIndex:n}function Qse(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function Jse(t,e,n){var r;const{label:i}=(r=tt(this,dt).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function eae(t,e){if(t<0)return this.hot.getCell(t,tt(this,dt).findLeftMostColumnIndex(t,e),!0)}function tae(){this.updatePlugin()}function nae(t,e){e||this.updatePlugin()}function ju(t,e,n){return e=rae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rae(t){var e=iae(t,"string");return typeof e=="symbol"?e:String(e)}function iae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oae{constructor(e,n){ju(this,"hot",void 0),ju(this,"data",null),ju(this,"plugin",void 0),ju(this,"parentReference",new WeakMap),ju(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},pe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&E(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&E(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ge(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(E(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();const s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null;const i=[];Array.isArray(e)?(pe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),pe(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),r=i[i.length-1]):r=e;const o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){const d=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),p=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),u.__children.push(r)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){const i=[];E(r,o=>{i.push(this.getDataObject(o))}),E(i,o=>{const s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){const i=this.getDataObject(e-1);let o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){const o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),u=e>n;let c=o?this.getRowParent(n-1):this.getRowParent(n);c==null&&(c=this.getRowParent(n-1)),c==null&&(c=this.getDataObject(n-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(n),c.__children=[]);const h=o||r||i?c.__children.length:this.getRowIndexWithinParent(n),d=s===c;c.__children.splice(h,0,l[0]),s.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(s),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}const sae=oae;function GO(t,e,n){return e=aae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aae(t){var e=lae(t,"string");return typeof e=="symbol"?e:String(e)}function lae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uae{constructor(e,n){GO(this,"hot",void 0),GO(this,"plugin",void 0),this.hot=n,this.plugin=e}}const fR=uae;class co extends fR{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(E(l,c=>{c&&s.removeChild(c)}),Z(n,co.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);s.innerHTML="",pe(0,i-1,()=>{const d=c.createElement("SPAN");Z(d,co.CSS_CLASSES.emptyIndicator),s.appendChild(d)}),s.appendChild(h)}if(this.dataManager.hasChildren(o)){const c=this.hot.rootDocument.createElement("DIV");u&&Te(c,[Ao()]),Z(n,co.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(Z(c,`${co.CSS_CLASSES.button} ${co.CSS_CLASSES.expandButton}`),u&&Te(n,[xr(!1)])):(Z(c,`${co.CSS_CLASSES.button} ${co.CSS_CLASSES.collapseButton}`),u&&Te(n,[xr(!0)])),s.appendChild(c)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}}const NN=co;class cae extends fR{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),E(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{pe(i,i+o-1,s=>{const a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&E(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];E(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return E(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);E(i.__children,o=>{const s=this.dataManager.getRowIndex(o);n.push(s),this.collapseChildRows(s,n)})}r&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return E(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);E(i.__children,o=>{if(!this.isAnyParentCollapsed(o)){const s=this.dataManager.getRowIndex(o);n.push(s),this.expandChildRows(s,n)}})}r&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&E(o.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];E(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];E(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];E(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{E(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{E(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&E(n.__children,i=>{const o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const r=this.translateTrimmedRow(n.row);Pe(e.target,NN.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),kr(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}const hae=cae;function dae(t,e,n){fae(t,e),e.set(t,n)}function fae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gae(t,e,n){return e=mae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mae(t){var e=pae(t,"string");return typeof e=="symbol"?e:String(e)}function pae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wae(t,e){var n=vae(t,e,"get");return Cae(t,n)}function vae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Cae(t,e){return e.get?e.get.call(t):e.value}var zO=new WeakMap;class Sae extends fR{constructor(){super(...arguments),gae(this,"dataManager",this.plugin.dataManager),dae(this,zO,{writable:!0,value:{row_above:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{const r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase(Gy)},callback:()=>{const r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{const r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(zy)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return pe(0,e.items.length-1,r=>{if(r===0)return E(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return pe(0,e.items.length-1,n=>{const r=wae(this,zO)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}}const yae=Sae;function $d(t,e,n){return e=bae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bae(t){var e=Rae(t,"string");return typeof e=="symbol"?e:String(e)}function Rae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eae{constructor(e){$d(this,"plugin",void 0),$d(this,"hot",void 0),$d(this,"dataManager",void 0),$d(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;const s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let l=!0;const u=e.map(p=>{if(!l)return!1;const v=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(v,a),v}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(s,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e;let s=!1;return Ct(i)&&(gt(ht`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){const i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){const r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){const r=e.length;let i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}}function Cn(t,e){LN(t,e),e.add(t)}function YO(t,e,n){LN(t,e),e.set(t,n)}function LN(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bw(t,e,n){return e=Tae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tae(t){var e=_ae(t,"string");return typeof e=="symbol"?e:String(e)}function _ae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cf(t,e){var n=$N(t,e,"get");return Mae(t,n)}function Mae(t,e){return e.get?e.get.call(t):e.value}function ag(t,e,n){var r=$N(t,e,"set");return Aae(t,r,n),n}function $N(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Aae(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function fn(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const lg="nestedRows",Oae=300,jO=lg,Pae="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var hm=new WeakMap,Sl=new WeakMap,KO=new WeakSet,XO=new WeakSet,qO=new WeakSet,ZO=new WeakSet,QO=new WeakSet,JO=new WeakSet,eP=new WeakSet,tP=new WeakSet,nP=new WeakSet,rP=new WeakSet,iP=new WeakSet,oP=new WeakSet,sP=new WeakSet,aP=new WeakSet,lP=new WeakSet,Uw=new WeakSet;class Iae extends it{constructor(){super(...arguments),Cn(this,Uw),Cn(this,lP),Cn(this,aP),Cn(this,sP),Cn(this,oP),Cn(this,iP),Cn(this,rP),Cn(this,nP),Cn(this,tP),Cn(this,eP),Cn(this,JO),Cn(this,QO),Cn(this,ZO),Cn(this,qO),Cn(this,XO),Cn(this,KO),Bw(this,"dataManager",null),Bw(this,"headersUI",null),Bw(this,"collapsedRowsMap",null),YO(this,hm,{writable:!0,value:!1}),YO(this,Sl,{writable:!0,value:!1})}static get PLUGIN_KEY(){return lg}static get PLUGIN_PRIORITY(){return Oae}isEnabled(){return!!this.hot.getSettings()[lg]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new nh),this.dataManager=new sae(this,this.hot),this.collapsingUI=new hae(this,this.hot),this.headersUI=new NN(this,this.hot),this.contextMenuUI=new yae(this,this.hot),this.rowMoveController=new Eae(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,aP,zae).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,lP,Yae).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,qO,Dae).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,ZO,Nae).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,QO,Lae).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,XO,Hae).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,tP,Fae).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,eP,kae).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,nP,Wae).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,rP,Vae).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,iP,Bae).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,oP,Uae).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,JO,$ae).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,sP,Gae).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return fn(e,KO,xae).call(e,...r)}),this.addHook("beforeLoadData",n=>fn(this,Uw,uP).call(this,n)),this.addHook("beforeUpdateData",n=>fn(this,Uw,uP).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){const n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:jO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jO)}disableCoreAPIModifiers(){ag(this,Sl,!0)}enableCoreAPIModifiers(){ag(this,Sl,!1)}onModifyRowData(e){if(!cf(this,Sl))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!cf(this,Sl))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return cf(this,Sl)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}}function xae(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function Hae(t,e,n){this.collapsingUI.toggleState(t,e,n)}function Dae(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),ag(this,hm,!0),this.dataManager.getData().slice()}function Nae(t){return this.contextMenuUI.appendOptions(t)}function Lae(t,e){this.headersUI.appendLevelIndicators(t,e)}function $ae(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function kae(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{ag(this,hm,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function Fae(t,e,n){const r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){const s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function Wae(){this.collapsingUI.collapsedRowsStash.stash()}function Vae(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Bae(){this.collapsingUI.collapsedRowsStash.stash()}function Uae(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Gae(){this.dataManager.rewriteCache()}function zae(){this.headersUI.updateRowHeaderWidth()}function Yae(t,e){cf(this,hm)&&(e.skipRender=!0)}function uP(t){if(!B1(t)){AS(Pae),this.hot.getSettings()[lg]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function Gw(t,e,n){return e=jae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jae(t){var e=Kae(t,"string");return typeof e=="symbol"?e:String(e)}function Kae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xae{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Gw(this,"rootWindow",void 0),Gw(this,"prefix",void 0),Gw(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){E(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}const qae=Xae;function Zae(t,e,n){return e=Qae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qae(t){var e=Jae(t,"string");return typeof e=="symbol"?e:String(e)}function Jae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}fe.getSingleton().register("persistentStateSave");fe.getSingleton().register("persistentStateLoad");fe.getSingleton().register("persistentStateReset");const cP="persistentState",ele=0;class tle extends it{constructor(){super(...arguments),Zae(this,"storage",void 0)}static get PLUGIN_KEY(){return cP}static get PLUGIN_PRIORITY(){return ele}isEnabled(){return!!this.hot.getSettings()[cP]}enablePlugin(){this.enabled||(this.storage||(this.storage=new qae(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function nle(t,e){rle(t,e),e.add(t)}function rle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zw(t,e,n){return e=ile(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ile(t){var e=ole(t,"string");return typeof e=="symbol"?e:String(e)}function ole(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hP(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const Yw="search",sle=190,ale="htSearchResult",lle=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},ule=function(t,e,n){return Ct(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ct(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var jw=new WeakSet;class cle extends it{constructor(){super(...arguments),nle(this,jw),zw(this,"callback",lle),zw(this,"queryMethod",ule),zw(this,"searchResultClass",ale)}static get PLUGIN_KEY(){return Yw}static get PLUGIN_PRIORITY(){return sle}isEnabled(){return this.hot.getSettings()[Yw]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Yw];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hP(e,jw,dP).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return hP(e,jw,dP).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return pe(0,i-1,l=>{pe(0,o-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||n,p=(h.search.queryMethod||r)(e,c,h);if(p){const v={row:l,col:u,data:c};s.push(v)}d&&d(a,l,u,c,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Ve(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function dP(t,e,n,r,i,o){const s=o.className||[];let a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}function Kw(t,e){hle(t,e),e.add(t)}function hle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kd(t,e,n){return e=dle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dle(t){var e=fle(t,"string");return typeof e=="symbol"?e:String(e)}function fle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const gle="touchScroll",mle=200;var fP=new WeakSet,gP=new WeakSet,mP=new WeakSet;class ple extends it{constructor(){super(...arguments),Kw(this,mP),Kw(this,gP),Kw(this,fP),kd(this,"scrollbars",[]),kd(this,"clones",[]),kd(this,"lockedCollection",!1),kd(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return gle}static get PLUGIN_PRIORITY(){return mle}static get SETTING_KEYS(){return!0}isEnabled(){return bS()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Xw(this,fP,wle).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Xw(this,gP,vle).call(this)),this.addHook("afterMomentumScroll",()=>Xw(this,mP,Cle).call(this))}}function wle(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function vle(){this.freezeOverlays=!0,E(this.clones,t=>{Z(t,"hide-tween")})}function Cle(){this.freezeOverlays=!1,E(this.clones,t=>{Le(t,"hide-tween"),Z(t,"show-tween")}),this.hot._registerTimeout(()=>{E(this.clones,t=>{Le(t,"show-tween")})},400),E(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Sle(t,e){yle(t,e),e.add(t)}function yle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ble(t,e,n){return e=Rle(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rle(t){var e=Ele(t,"string");return typeof e=="symbol"?e:String(e)}function Ele(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tle(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}const hf="trimRows",_le=330;var pP=new WeakSet;class Mle extends it{constructor(){super(...arguments),Sle(this,pP),ble(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return hf}static get PLUGIN_PRIORITY(){return _le}isEnabled(){return!!this.hot.getSettings()[hf]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new nh),this.trimmedRowsMap.addLocalHook("init",()=>Tle(this,pP,Ale).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[hf];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),E(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{E(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),r=this.isValidConfig(e);let i=n;const o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(E(e,l=>{o[l]=!1}),i=Gt(o,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}}function Ale(){const t=this.hot.getSettings()[hf];Array.isArray(t)&&this.hot.batchExecution(()=>{E(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var kN={},Ole=Ul,Ple=kN,Ile=Ole("iterator"),xle=Array.prototype,Hle=function(t){return t!==void 0&&(Ple.Array===t||xle[Ile]===t)},Dle=iI,wP=MC,Nle=bC,Lle=kN,$le=Ul,kle=$le("iterator"),FN=function(t){if(!Nle(t))return wP(t,kle)||wP(t,"@@iterator")||Lle[Dle(t)]},Fle=Sa,Wle=fg,Vle=Rs,Ble=dg,Ule=FN,Gle=TypeError,zle=function(t,e){var n=arguments.length<2?Ule(t):e;if(Wle(n))return Vle(Fle(n,t));throw new Gle(Ble(t)+" is not iterable")},Yle=Sa,vP=Rs,jle=MC,Kle=function(t,e,n){var r,i;vP(t);try{if(r=jle(t,"return"),!r){if(e==="throw")throw n;return n}r=Yle(r,t)}catch(o){i=!0,r=o}if(e==="throw")throw n;if(i)throw r;return vP(r),n},Xle=cI,qle=Sa,Zle=Rs,Qle=dg,Jle=Hle,eue=Bc,CP=RC,tue=zle,nue=FN,SP=Kle,rue=TypeError,df=function(t,e){this.stopped=t,this.result=e},yP=df.prototype,iue=function(t,e,n){var r=n&&n.that,i=!!(n&&n.AS_ENTRIES),o=!!(n&&n.IS_RECORD),s=!!(n&&n.IS_ITERATOR),a=!!(n&&n.INTERRUPTED),l=Xle(e,r),u,c,h,d,f,p,v,S=function(R){return u&&SP(u,"normal",R),new df(!0,R)},y=function(R){return i?(Zle(R),a?l(R[0],R[1],S):l(R[0],R[1])):a?l(R,S):l(R)};if(o)u=t.iterator;else if(s)u=t;else{if(c=nue(t),!c)throw new rue(Qle(t)+" is not iterable");if(Jle(c)){for(h=0,d=eue(t);d>h;h++)if(f=y(t[h]),f&&CP(yP,f))return f;return new df(!1)}u=tue(t,c)}for(p=o?t.next:u.next;!(v=qle(p,u)).done;){try{f=y(v.value)}catch(R){SP(u,"throw",R)}if(typeof f=="object"&&f&&CP(yP,f))return f}return new df(!1)},oue=PC,sue=bs,aue=cg,lue=function(t,e,n){var r=oue(e);r in t?sue.f(t,r,aue(0,n)):t[r]=n},uue=Es,cue=iue,hue=lue;uue({target:"Object",stat:!0},{fromEntries:function(e){var n={};return cue(e,function(r,i){hue(n,r,i)},{AS_ENTRIES:!0}),n}});const WN="undoRedo",due="undoRedo";function he(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(r,i){const o=r&&r.length;if(!o||!r.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=r.reduce((c,h)=>(c.push([...h]),c),[]);E(l,c=>{c[1]=t.propToCol(c[1])});const u=o>1?this.getSelected():[[l[0][0],l[0][1]]];return new he.ChangeAction(l,u)};e.done(a,i)}),t.addHook("afterCreateRow",(r,i,o)=>{e.done(()=>new he.CreateRowAction(r,i),o)});const n=(r,i,o,s)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return pe(o,s,c=>{pe(r,i,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(p=>{let[v]=p;return a.includes(v)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};t.addHook("beforeRemoveRow",(r,i,o,s)=>{const a=()=>{const l=t.toPhysicalRow(r),u=l+i-1,c=Tn(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new he.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),n(l,u,0,t.countCols()-1))};e.done(a,s)}),t.addHook("afterCreateCol",(r,i,o)=>{e.done(()=>new he.CreateColumnAction(r,i),o)}),t.addHook("beforeRemoveCol",(r,i,o,s)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+r)%e.instance.countCols(),c=u+i-1,h=[],d=[],f=[];pe(l.length-1,S=>{const y=[],R=l[S];pe(u,c,T=>{y.push(R[t.toPhysicalColumn(T)])}),h.push(y)}),pe(i-1,S=>{f.push(t.toPhysicalColumn(u+S))}),Array.isArray(t.getSettings().colHeaders)&&pe(i-1,S=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+S)]||null)});const p=t.columnIndexMapper.getIndexesSequence(),v=t.rowIndexMapper.getIndexesSequence();return new he.RemoveColumnAction(u,f,h,d,p,v,t.getSettings().fixedColumnsStart,n(0,t.countRows(),u,c))};e.done(a,s)}),t.addHook("beforeCellAlignment",(r,i,o,s)=>{e.done(()=>new he.CellAlignmentAction(r,i,o,s))}),t.addHook("beforeFilter",r=>{e.done(()=>new he.FiltersAction(r))}),t.addHook("beforeRowMove",(r,i)=>{r!==!1&&e.done(()=>new he.RowMoveAction(r,i))}),t.addHook("beforeMergeCells",(r,i)=>{i||e.done(()=>new he.MergeCellsAction(t,r))}),t.addHook("afterUnmergeCells",(r,i)=>{i||e.done(()=>new he.UnmergeCellsAction(t,r))}),t.addHook("afterInit",()=>{e.init()})}he.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;const o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};he.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const n=Tn(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};he.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const n=Tn(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;const i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};he.prototype.isUndoAvailable=function(){return this.doneActions.length>0};he.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};he.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};he.prototype.isEnabled=function(){return this.enabled};he.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,mue(t),this.registerShortcuts(),t.addHook("afterChange",VN)};he.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,pue(t),this.unregisterShortcuts(),t.removeHook("afterChange",VN)};he.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};he.Action=function(){};he.Action.prototype.undo=function(){};he.Action.prototype.redo=function(){};he.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Oo(he.ChangeAction,he.Action);he.ChangeAction.prototype.undo=function(t,e){const n=Tn(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let s=0,a=n.length;s<a;s++)n[s].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let s=0,a=n.length;s<a;s++){const[l,u]=n[s];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const o=t.getSelectedLast();if(o!==void 0){const[s,a]=n[0],[l,u]=o,c=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),d=s>=c,f=a>=h;if((d&&f)===!1&&(l!==s||u!==a)===!0){const S={row:s,col:a};d===!1&&(S.verticalSnap="top"),f===!1&&(S.horizontalSnap="start"),t.scrollViewportTo(S)}}t.selectCells(this.selected,!1,!1)};he.ChangeAction.prototype.redo=function(t,e){const n=Tn(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};he.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Oo(he.CreateRowAction,he.Action);he.CreateRowAction.prototype.undo=function(t,e){const n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};he.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};he.RemoveRowAction=function(t,e,n,r,i,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i,this.removedCellMetas=o};Oo(he.RemoveRowAction,he.Action);he.RemoveRowAction.prototype.undo=function(t,e){const n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{const a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[o,s,a]=i;t.setCellMetaObject(o,s,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};he.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};he.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Oo(he.CreateColumnAction,he.Action);he.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};he.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};he.RemoveColumnAction=function(t,e,n,r,i,o,s,a){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=a};Oo(he.RemoveColumnAction,he.Action);he.RemoveColumnAction.prototype.undo=function(t,e){const n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(r[c])],o=this.data.length,s=[];for(let u=0;u<o;u++)s.push(Ue(this.data[u],i));const a=Ue(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),E(t.getSourceDataArray(),(u,c)=>{E(r,(h,d)=>{u[h]=s[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&E(a,(u,c)=>{t.getSettings().colHeaders[r[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};he.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};he.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};he.CellAlignmentAction.prototype.undo=function(t,e){E(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};he.CellAlignmentAction.prototype.redo=function(t,e){Ko(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};he.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};Oo(he.FiltersAction,he.Action);he.FiltersAction.prototype.undo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};he.FiltersAction.prototype.redo=function(t,e){const n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};class fue extends he.Action{constructor(e,n){super(),this.cellRange=n;const r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}}he.MergeCellsAction=fue;class gue extends he.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}}he.UnmergeCellsAction=gue;he.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};Oo(he.RowMoveAction,he.Action);he.RowMoveAction.prototype.undo=function(t,e){const n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){const l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};he.RowMoveAction.prototype.redo=function(t,e){const n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};he.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};he.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:WN};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};he.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(WN)};function VN(t,e){const n=this;if(e==="loadData")return n.undoRedo.clear()}function mue(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function pue(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const ch=fe.getSingleton();ch.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});ch.register("beforeUndo");ch.register("afterUndo");ch.register("beforeRedo");ch.register("afterRedo");he.PLUGIN_KEY=due;he.SETTING_KEYS=!0;function wue(){nt(lc),nt(d8),nt(uc),nt(U8),nt(Q8),nt(qH),nt(U5),nt(AZ),nt(sm),nt(QQ),nt(RJ),nt(IJ),nt(lm),nt(iee),nt(dne),nt(jne),nt(Sre),nt(xre),nt(zre),nt(sie),nt(wie),nt(Fie),nt(Xie),nt(Eoe),nt(ese),nt(ose),nt(Fse),nt(Iae),nt(tle),nt(cle),nt(ple),nt(Mle),nt(he)}function vue(){L9(),e7(),u7(),O7(),wue()}function Cue(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const r=this.first();let i=r.data("handsontable");if(typeof n!="string"){const u=n||{};return i?i.updateSettings(u):(i=new t.Core(r[0],u),r.data("handsontable",i),i.init()),r}let o;if(i)if(typeof i[n]<"u"){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];o=i[n].call(i,...a),n==="destroy"&&r.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return o})}var qw,Zw,Qw,Jw,ev;vue();Cue(Ae);Ae.__GhostTable=Xb;Ae._getListenersCounter=AY;Ae._getRegisteredMapsCounter=n4;Ae.EventManager=Dr;const Sue=[tz,uY,BX,n7,sY,Uz,oz,GY,oY,az,dY,UY],yue=[Fz,fY];Ae.helper={};Ae.dom={};E(Sue,t=>{E(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ae.helper[e]=t[e])})});E(yue,t=>{E(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(Ae.dom[e]=t[e])})});Ae.cellTypes=(qw=Ae.cellTypes)!==null&&qw!==void 0?qw:{};E(bq(),t=>{Ae.cellTypes[t]=Pb(t)});Ae.cellTypes.registerCellType=Er;Ae.cellTypes.getCellType=Pb;Ae.editors=(Zw=Ae.editors)!==null&&Zw!==void 0?Zw:{};E(yY(),t=>{Ae.editors[`${En(t)}Editor`]=Mf(t)});Ae.editors.registerEditor=er;Ae.editors.getEditor=Mf;Ae.renderers=(Qw=Ae.renderers)!==null&&Qw!==void 0?Qw:{};E(oj(),t=>{const e=Pf(t);t==="base"&&(Ae.renderers.cellDecorator=e),Ae.renderers[`${En(t)}Renderer`]=e});Ae.renderers.registerRenderer=cr;Ae.renderers.getRenderer=Pf;Ae.validators=(Jw=Ae.validators)!==null&&Jw!==void 0?Jw:{};E(lj(),t=>{Ae.validators[`${En(t)}Validator`]=HS(t)});Ae.validators.registerValidator=oa;Ae.validators.getValidator=HS;Ae.plugins=(ev=Ae.plugins)!==null&&ev!==void 0?ev:{};E(xS(),t=>{Ae.plugins[t]=Qc(t)});Ae.plugins[`${En(it.PLUGIN_KEY)}Plugin`]=it;Ae.plugins.registerPlugin=nt;Ae.plugins.getPlugin=Qc;var gR={exports:{}};gR.exports;(function(t){(function(e,n,r){function i(l){var u=this,c=a();u.next=function(){var h=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=h-(u.c=h|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function s(l,u){var c=new i(l),h=u&&u.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&o(h,c),d.state=function(){return o(c,{})}),d}function a(){var l=4022871197,u=function(c){c=String(c);for(var h=0;h<c.length;h++){l+=c.charCodeAt(h);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.alea=s})(ti,t,!1)})(gR);var bue=gR.exports,mR={exports:{}};mR.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var h=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^h^h>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor128=s})(ti,t,!1)})(mR);var Rue=mR.exports,pR={exports:{}};pR.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(h^h<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorwow=s})(ti,t,!1)})(pR);var Eue=pR.exports,wR={exports:{}};wR.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.x,h=l.i,d,f;return d=c[h],d^=d>>>7,f=d^d<<24,d=c[h+1&7],f^=d^d>>>10,d=c[h+3&7],f^=d^d>>>3,d=c[h+4&7],f^=d^d<<7,d=c[h+7&7],d=d^d<<13,f^=d^d<<9,c[h]=f,l.i=h+1&7,f};function u(c,h){var d,f=[];if(h===(h|0))f[0]=h;else for(h=""+h,d=0;d<h.length;++d)f[d&7]=f[d&7]<<15^h.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.x&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xorshift7=s})(ti,t,!1)})(wR);var Tue=wR.exports,vR={exports:{}};vR.exports;(function(t){(function(e,n,r){function i(a){var l=this;l.next=function(){var c=l.w,h=l.X,d=l.i,f,p;return l.w=c=c+1640531527|0,p=h[d+34&127],f=h[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=h[d]=p^f,l.i=d,p+(c^c>>>16)|0};function u(c,h){var d,f,p,v,S,y=[],R=128;for(h===(h|0)?(f=h,h=null):(h=h+"\0",f=0,R=Math.max(R,h.length)),p=0,v=-32;v<R;++v)h&&(f^=h.charCodeAt((v+32)%h.length)),v===0&&(S=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,v>=0&&(S=S+1640531527|0,d=y[v&127]^=f+S,p=d==0?p+1:0);for(p>=128&&(y[(h&&h.length||0)&127]=-1),p=127,v=4*128;v>0;--v)f=y[p+34&127],d=y[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,y[p]=f^d;c.w=S,c.X=y,c.i=p}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function s(a,l){a==null&&(a=+new Date);var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(c.X&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.xor4096=s})(ti,t,!1)})(vR);var _ue=vR.exports,CR={exports:{}};CR.exports;(function(t){(function(e,n,r){function i(a){var l=this,u="";l.next=function(){var h=l.b,d=l.c,f=l.d,p=l.a;return h=h<<25^h>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-h|0,l.b=h=h<<20^h>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-h|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function s(a,l){var u=new i(a),c=l&&l.state,h=function(){return(u.next()>>>0)/4294967296};return h.double=function(){do var d=u.next()>>>11,f=(u.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},h.int32=u.next,h.quick=h,c&&(typeof c=="object"&&o(c,u),h.state=function(){return o(u,{})}),h}n&&n.exports?n.exports=s:r&&r.amd?r(function(){return s}):this.tychei=s})(ti,t,!1)})(CR);var Mue=CR.exports,BN={exports:{}};const Aue={},Oue=Object.freeze(Object.defineProperty({__proto__:null,default:Aue},Symbol.toStringTag,{value:"Module"})),Pue=JN(Oue);(function(t){(function(e,n,r){var i=256,o=6,s=52,a="random",l=r.pow(i,o),u=r.pow(2,s),c=u*2,h=i-1,d;function f(A,M,L){var B=[];M=M==!0?{entropy:!0}:M||{};var K=y(S(M.entropy?[A,T(n)]:A??R(),3),B),U=new p(B),G=function(){for(var Q=U.g(o),re=l,ne=0;Q<u;)Q=(Q+ne)*i,re*=i,ne=U.g(1);for(;Q>=c;)Q/=2,re/=2,ne>>>=1;return(Q+ne)/re};return G.int32=function(){return U.g(4)|0},G.quick=function(){return U.g(4)/4294967296},G.double=G,y(T(U.S),n),(M.pass||L||function(Q,re,ne,ce){return ce&&(ce.S&&v(ce,U),Q.state=function(){return v(U,{})}),ne?(r[a]=Q,re):Q})(G,K,"global"in M?M.global:this==r,M.state)}function p(A){var M,L=A.length,B=this,K=0,U=B.i=B.j=0,G=B.S=[];for(L||(A=[L++]);K<i;)G[K]=K++;for(K=0;K<i;K++)G[K]=G[U=h&U+A[K%L]+(M=G[K])],G[U]=M;(B.g=function(Q){for(var re,ne=0,ce=B.i,be=B.j,qe=B.S;Q--;)re=qe[ce=h&ce+1],ne=ne*i+qe[h&(qe[ce]=qe[be=h&be+re])+(qe[be]=re)];return B.i=ce,B.j=be,ne})(i)}function v(A,M){return M.i=A.i,M.j=A.j,M.S=A.S.slice(),M}function S(A,M){var L=[],B=typeof A,K;if(M&&B=="object")for(K in A)try{L.push(S(A[K],M-1))}catch{}return L.length?L:B=="string"?A:A+"\0"}function y(A,M){for(var L=A+"",B,K=0;K<L.length;)M[h&K]=h&(B^=M[h&K]*19)+L.charCodeAt(K++);return T(M)}function R(){try{var A;return d&&(A=d.randomBytes)?A=A(i):(A=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(A)),T(A)}catch{var M=e.navigator,L=M&&M.plugins;return[+new Date,e,L,e.screen,T(n)]}}function T(A){return String.fromCharCode.apply(0,A)}if(y(r.random(),n),t.exports){t.exports=f;try{d=Pue}catch{}}else r["seed"+a]=f})(typeof self<"u"?self:ti,[],Math)})(BN);var Iue=BN.exports,xue=bue,Hue=Rue,Due=Eue,Nue=Tue,Lue=_ue,$ue=Mue,Ma=Iue;Ma.alea=xue;Ma.xor128=Hue;Ma.xorwow=Due;Ma.xorshift7=Nue;Ma.xor4096=Lue;Ma.tychei=$ue;var kue=Ma;const UN=AP(kue);let GN=UN();function zN(){return GN()}function Fue(t){GN=UN(t)}function Aa(t,e){let n=t;if(Array.isArray(t)){let r=t;e!=null&&e.maxCharCount&&typeof t[0]=="string"&&(r=t.filter(i=>i.length<=e.maxCharCount)),n=()=>YN(r)}return(e==null?void 0:e.length)===void 0?n(0):Array.from({length:e.length},(r,i)=>n(i))}function YN(t){return t[Math.floor(zN()*t.length)]}function Wue({min:t=1,max:e=9999.99,fraction:n=0}={}){if(e<t)throw new Error("Max must be bigger than min");return Number((zN()*(e-t)+t).toFixed(n))}function bP(t){return Aa(()=>YN([!0,!1]),t)}function oo(t){const e={min:(t==null?void 0:t.min)??0,max:(t==null?void 0:t.max)??999999,precision:t==null?void 0:t.precision,fraction:t==null?void 0:t.fraction};return Aa(()=>{if(e.min===e.max)return e.min;const n=Wue(e);return e.precision!==void 0?Math.floor(n/e.precision)*e.precision:n},t)}function Vue(t){const e=new Date(t.from).getTime(),n=new Date(t.to).getTime();if(e>=n)throw new Error("From must be before to");return Aa(()=>new Date(oo({min:e,max:n})),t)}var Bue=["Kautzer, Macejkovic and Fisher","Greenholt - Mosciski","Marquardt - Runolfsdottir","Abernathy Inc","Dickens - Lang","Hand, Bernhard and Kessler","Abbott LLC","Kub Inc","Johnston - Wisozk","Reichert LLC","Kohler LLC","Shanahan - Boyle","Batz - Rice","Cronin, Oberbrunner and Beier","Kuhlman, Schowalter and West","Luettgen Inc","Ward Group","Hills and Sons","Prohaska, Balistreri and Walker","Rempel - Durgan","Bernier LLC","Stehr - Lockman","Roberts, Rogahn and Dooley","Lesch - Jakubowski","Jenkins - Turcotte","Gerhold - Rowe","Block - Rau","Dickinson, Tremblay and Moore","Nader - Fritsch","Kreiger and Sons","Bartell, Wehner and Schowalter","Hegmann Inc","Orn, Spencer and Kiehn","Graham, Sipes and Towne","Hodkiewicz Inc","Mills Group","Legros, Tillman and Hodkiewicz","Lesch - Carter","Lesch Group","Kreiger - Sauer","Cartwright - Schuster","Labadie LLC","Pfannerstill, White and Mosciski","Jenkins LLC","Boehm, Hettinger and Huels","Maggio, Wisoky and Blick","Kozey Inc","Stracke - Wisozk","Olson, Olson and Carter","Orn, Gerlach and Runolfsdottir","Stracke - Kertzmann","Walker - Zieme","Hodkiewicz - Hintz","Lind Group","Fahey, Leannon and Gleichner","Mertz, Gusikowski and Lemke","Heidenreich - Aufderhar","Zboncak and Sons","Carroll Group","Brown LLC","Weber Inc","Rath LLC","Walker Inc","Heller, Hyatt and Jaskolski","Jacobi - Kutch","Skiles and Sons","Durgan - Stamm","Renner - Prosacco","Hahn - Welch","Lesch, Dooley and Bartell","Crona and Sons","Rogahn, Armstrong and Goyette","Lubowitz, Kuhlman and Bailey","Doyle Group","Dooley and Sons","Kerluke LLC","Bogan - Daniel","Hintz - Boehm","Swaniawski and Sons","Kris, Legros and Cartwright","Reichel Group","Russel - Hintz","Welch, Lockman and Hand","Pouros - Brakus","Mohr, Fritsch and Wisozk","Upton - Reichert","Koepp and Sons","Weber and Sons","Quigley, Bins and Becker","Strosin, Oberbrunner and Wunsch","Rodriguez - Spencer","Wilkinson - Dare","Gutkowski Inc","OReilly LLC","Collins, Mante and Pacocha","Steuber, Luettgen and Corkery","Kub and Sons","Lesch and Sons"];function RP(t){return Aa(Bue,t)}var Uue=["Argentina","Peru","Colombia","Chile","Uruguay","Gabon","Congo","Norfolk Island","Qatar","Syrian Arab Republic","Wallis and Futuna","Somalia","Saint Barthelemy","Comoros","Sri Lanka","Czech Republic","Christmas Island","Macao","Montenegro","Anguilla","Canada","Mayotte","Tajikistan","Afghanistan","Liechtenstein","Cocos (Keeling) Islands","Angola","Bahrain","Dominican Republic","Croatia","Latvia","Virgin Islands, U.S.","United Kingdom","Brazil","Spain","Mongolia","Montserrat","Estonia","Benin","Guinea","Guinea-Bissau","Greece","Lao Peoples Democratic Republic","Puerto Rico","Slovakia (Slovak Republic)","United States of America","Switzerland","Costa Rica","Mauritius","Nigeria","Russian Federation","Germany","Antigua and Barbuda","Albania","Romania","Moldova","Senegal","Tanzania","British Indian Ocean Territory (Chagos Archipelago)","Central African Republic","New Caledonia","Burundi","Panama","Azerbaijan","Namibia","French Southern Territories","Vanuatu","Ethiopia","Burkina Faso","Tunisia","Mozambique","Belarus","Saint Kitts and Nevis","Hungary","Indonesia","Cyprus","Ecuador","Saint Martin","Nauru","Faroe Islands","Iran","Bolivia","Pitcairn Islands","France","Paraguay","Isle of Man","Sierra Leone","Monaco","Belize","Trinidad and Tobago"];function Gue(t){return Aa(Uue,t)}var zue={china:["Peking roasted duck","Kung pao chicken","Sweet and sour pork","Hot pot","Dim sum","Dumplings","Ma po tofu","Char siu","Chicken chow mein","Beef chow mein","vegetable chow mein","Chicken fried rice","Beef fried rice","Vegetable fried Rice","Special fried Rice","Sichuan pork","Xiaolongbao","Zhajiangmian","Wonton soup","Sweet and sour pork","Duck spring Rolls","Vegetable spring Rolls","Wonton","Peking duck","Lamb hot pot","Spicy crayfish","Guilin rice noodles","Lanzhou hand-pulled noodles","Steamed crab","Shredded pork with garlic sauce","Red braised pork","Sweet and sour Ribs","Xinjiang","Braised pork with vermicelli"],italy:["Butternut squash risotto","Mushroom risotto","Beetroot risotto","Courgette risotto","Pizza","Gnocchi","Spaghetti bolognese","Spaghetti carbonara","Pesto alla Genovese","Beef lasagne","Vegetable lasagne","Gelato","Prosciutto di Parma","Ribollita","Bagna cauda","Polenta","Tortelli and ravioli","Focaccia","Garlic bread","Arancini","Il tartufo","Panzerotto fritto","Fiorentina","Minestrone","Frico","Arrosticini","Olive ascolante","Fritto misto piemontes","TiramisÃ¹"],india:["Biryani","Dosa","Tandoori chicken","Samosas","Chaat","Plain naan","Garlic naan","Pilau rice","Steamed rice","Chicken madras","Vegetable madras","Chicken vindaloo","Chicken jalfrezi","Chicken roghan josh","Lamb roghan josh","Beef roghan josh","Butter chicken","Dosa","Gulab jamun","Chicken korma","Mutter paneer","Papadum","Paratha","Raita","Saag paneer","Tandoori chicken","Chicken tikka masala","Pakora","Dal","Chapati","Pasanda","Aloo gobi","Kofta","Chicken makhani","Paneer naan","Chana Aloo Curry"],mexico:["Chilaquiles","Pozole","Tacos al pastor","Tostadas","Chiles en nogada","Elote","Enchiladas","Mole","Guacamole","Tamales","Huevos rancheros","Machaca","Discada","Beef Burrito","Chicken Burrito","Pozole de pollo o duajolote","Menudo","Cochinita pibil","Tamale","Quesadilla","Frijoles puercos","Chile en nogada","Esquites","Alegria de amaranto","PipiÃ¡n","Aguachile","Ceviche","Pescado zarandeado","Camarones a la diabla","Birria de chivo","Tlayuda","Guacamole con chapulines","Flautas","Torta Ahogada","Carnitas","Caldo Azteca","Gorditas de Nata"],japan:["Sushi","Udon","Tofu","Tempura","Yakitori","Sashimi","Ramen","Donburi","Natto","Oden","Tamagoyaki","Soba","Tonkatsu","Kashipan","Sukiyaki","Miso soup","Okonomiyaki","Mentaiko","Nikujaga","Unagi no kabayaki","Shabu Shabu","Onigiri","Gyoza","Takoyaki","aiseki ryori","Edamame","Yakisoba","Chawanmushi","Wagashi"],france:["Foie gras","HuÃ®tres","Cassoulet","Poulet basquaise","Escargots au beurre persillÃ©","Mouclade charentaise","Galettes bretonnes","Flemish carbonnade","Quiche lorraine","Raclette","Cheese fondue","Beef fondue","Gratin dauphinois","Tartiflette","Bouillabaisse","Ratatouille","Boeuf bourguignon","Blanquette de veau","Pot-au-feu","Coq-au-vin","Hachis parmentier","Steak tartare","Choucroute","SoufflÃ© au fromage","Cuisses de grenouilles","Soupe Ã  lâoignon","Baguette","Croissant","French cheeses","Fondant au chocolat","Tarte tatin","Macarons","CrÃ¨me brÃ»lÃ©e","Ãle flottante","Profiteroles","Pain au chocolat"],lebanon:["Kibbeh","Kafta","Kanafeh","Hummus","Rice pilaf","Fattoush","Manakish","Tabbouleh","Sfeeha","Fattoush","Labneh","Muhammara","Lahm bi ajin","Kaak","Chanklich","Mssabaha","Shawarma","Kebbe","Falafel","Halewit el jeben","Namoura","Maamoul","Foul mdammas","Balila","Kawarma","Fattouch"],thailand:["Pad kra pao moo","Tom kha gai","Khao Pad","Chicken pad Thai","Vegetable pad Thai","Moo satay","Tom yum goong","Khao niew mamuang","Kai yad sai","Khao soi","Pad see ew","Laab moo","Gaeng panang","Gai pad med ma muang","Som tam","Poh pia tod","Gaeng massaman","Pla kapung nueng manao","Tod mun pla","Gaeng ped","Gaeng garee","Gaeng keow wan","Moo ping","Durian","Sai ooah","Hoy tod","Kuay teow reua","Mu kratha","Kao ka moo","Yam nua"],greece:["Moussaka","Papoutsakia","Pastitsio","Souvlaki","Soutzoukakia","Stifado","Tomatokeftedes","Tzatziki","Kolokithokeftedes","Giouvetsi","Choriatiki","Kleftiko","Gemista","Fasolada","Bougatsa","Tiropita","Spanakopita","Feta Cheese with Honey","Horta","Tirokroketes","Briam","Saganaki","Gigantes","Dolmades","Fasolatha","Koulouri","Loukoumades","Gyros","Galaktoboureko","Baklava"],turkey:["ÅiÅ kebap","DÃ¶ner","KÃ¶fte","Pide","Kumpir","Meze","MantÄ±","Lahmacun","Menemen","ÅiÅ kebap","Ä°skender kebab","Corba","Kuzu tandir","ÃiÄ KÃ¶fte","Pilav","Yaprak sarma","Dolma","Ä°mam bayÄ±ldÄ±","Borek","Durum","Kumpir","Balik ekmek","Simit","Kunefe","Baklava","Lokum","Halva","Mozzaik pasta","GÃ¼llaÃ§","Mercimek KÃ¶ftesi","Haydari","Tursu suyu","Kahvalti","Kazan dibi","Hunkar begendi","Islak burgers","Salep","Yogurtlu kebab"],spain:["Tortilla de patatas","Fabada asturiana","CalÃ§ots","Boquerones al vinagre","Empanada gallega","Paella","Gazpacho","Gachas","Migas","Bocadillo de calamares","Pulpo a feira","Caldo gallego","Lentejas con chorizo","Cocido madrileÃ±o","Cachopo","Caracoles"],venezuela:["PabellÃ³n criollo","Arepa","Mondongo","Empanadas","Quesillo","Chicha andina","TequeÃ±os","Cachapa","Hallaca","Perico","Pasticho","Mandocas","Caraotas negras","Patacones","Dulce de leche","Pan de JamÃ³n"],chile:["Humitas","Empanadas","Porotos con riendas","Completos","Manjar","Cordero al palo","Pastel de choclo","Mote con huesillos","Sopaipillas","Curanto"],argentina:["Milanesas","Empanadas","Pizza fugazeta","Asado","Choripan","Bondiola","Bife de chorizo"],colombia:["Bandeja paisa","Chuleta valluna","Sancocho trifÃ¡sico","Empanada valluna","Salpicon de frutas","Pastel de garbanzo","Ajiaco","Arepas","Arroz de lisa","Sancocho","Pan de bono","Cuchuco","Oblea","Cazuela de mariscos","Pan de yuca","Bollo Limpio","AlmojÃ¡bana","Empanadas","Arroz con Coco","Sopa de mondongo","Cazuela de Mariscos","Arroz con Pollo","Arepa de Huevo","Mote de Queso"],ecuador:["Encebollado","Ceviche","Tigrillo","Bolon de verde","Llapingacho","Mote pillo","Locro de papa","Churrasco"],peru:["Ceviche","Arroz con pollo","Aji de gallina","Llunca de gallina"],"el salvador":["Pupusa","Sopa de patas","Rigua","Flor de izote con huevo","Gallo en chicha"],romania:["Sarmale","Mici","Pomana porcului","CiorbÄ de fasole cu ciolan","CiorbÄ de burtÄ","CiorbÄ rÄdÄuÈeanÄ","PlÄcintÄ cu brÃ¢nzÄ","CiorbÄ de potroace","MÄmÄligÄ cu brÃ¢nzÄ Èi smÃ¢ntÃ¢nÄ","TochiturÄ","Piftie","Iahnie de fasole","SlÄninÄ afumatÄ","CÃ¢rnaÈi afumaÈi","VarzÄ a la Cluj","GulaÈ de cartofi cu afumÄturÄ","Cozonac de casÄ","CiorbÄ ardeleneascÄ de porc","Mucenici moldoveneÈti","SalatÄ de boeuf","Dovleac copt","PapanaÈi cu brÃ¢nzÄ de vacÄ Èi afine","Drob de miel","PÃ¢rjoale moldoveneÈti","ZacuscÄ de vinete","ZacuscÄ de fasole","TurtÄ dulce","ClÄtitele cu gem","ClÄtitele cu brÃ¢nza de vacÄ","BalmoÈ","Cozonac","Chiftele"]},MP;(MP=Object.keys(zue))==null||MP.length;function EP(t){const e=(t==null?void 0:t.years)??1;if(e<=0)throw new Error("Years must be positive, use future() instead");const n=365*e*24*60*60*1e3,r=new Date,i=new Date(r.getTime()-n);return Aa(()=>Vue({from:i,to:r}),t)}var Yue=["Small Rubber Shoes","Fantastic Wooden Sausages","Handmade Frozen Salad","Intelligent Soft Car","Intelligent Concrete Chips","Handcrafted Concrete Bacon","Small Fresh Fish","Rustic Metal Towels","Unbranded Cotton Hat","Fantastic Frozen Bike","Generic Rubber Shirt","Unbranded Wooden Keyboard","Awesome Metal Computer","Gorgeous Fresh Shoes","Unbranded Concrete Sausages","Practical Wooden Ball","Ergonomic Soft Towels","Small Plastic Table","Awesome Metal Pants","Licensed Steel Sausages","Handcrafted Rubber Bike","Ergonomic Cotton Computer","Generic Wooden Ball","Fantastic Frozen Soap","Generic Plastic Keyboard","Awesome Cotton Pizza","Licensed Metal Chips","Handcrafted Cotton Towels","Handmade Plastic Tuna","Practical Granite Keyboard","Intelligent Concrete Soap","Rustic Concrete Chips","Fantastic Steel Hat","Rustic Cotton Chair","Gorgeous Metal Pants","Intelligent Metal Bacon","Handmade Rubber Car","Tasty Concrete Keyboard","Incredible Granite Hat","Practical Rubber Fish","Rustic Cotton Gloves","Rustic Cotton Ball","Refined Fresh Shirt","Generic Granite Sausages","Rustic Granite Fish","Practical Wooden Bacon","Sleek Plastic Chair","Handcrafted Fresh Mouse","Small Concrete Shoes","Awesome Fresh Chair","Incredible Soft Computer","Tasty Concrete Chips","Generic Rubber Sausages","Intelligent Concrete Chicken","Rustic Soft Ball","Awesome Steel Towels","Incredible Fresh Bike","Unbranded Granite Chicken","Rustic Concrete Bike","Small Frozen Sausages","Intelligent Plastic Gloves","Ergonomic Frozen Towels","Refined Frozen Ball","Refined Cotton Ball","Licensed Steel Salad","Intelligent Wooden Bacon","Unbranded Metal Shoes","Fantastic Granite Car","Ergonomic Granite Bacon","Awesome Wooden Shirt","Rustic Wooden Pizza","Tasty Frozen Table","Awesome Wooden Hat","Awesome Rubber Salad","Licensed Concrete Fish","Fantastic Soft Cheese","Rustic Frozen Pizza","Refined Concrete Tuna","Small Frozen Tuna","Licensed Granite Cheese","Practical Rubber Car","Rustic Steel Sausages","Awesome Concrete Hat","Awesome Granite Sausages","Sleek Plastic Chips","Handcrafted Wooden Gloves","Intelligent Metal Computer","Fantastic Fresh Sausages","Fantastic Plastic Salad","Unbranded Steel Sausages","Handcrafted Wooden Fish","Sleek Wooden Bacon","Unbranded Plastic Towels","Tasty Soft Sausages","Generic Metal Shirt","Handmade Granite Cheese","Small Fresh Bacon","Tasty Granite Towels","Licensed Steel Chips"];function TP(t){return Aa(Yue,t)}Fue("42219");const jN=[{companyName:RP({maxCharCount:18}),productName:TP({maxCharCount:18}),sellDate:EP().toLocaleDateString("en-gb"),inStock:bP(),qty:oo({max:500}),orderId:`${oo({max:9,min:0})}${oo({max:9,min:0})}-${oo({max:9999999,min:1111111})}`,country:"United Kingdom"},...Array.from({length:150},()=>({companyName:RP({maxCharCount:18}),productName:TP({maxCharCount:18}),sellDate:EP().toLocaleDateString("en-gb"),inStock:bP(),qty:oo({max:500}),orderId:`${oo({max:9,min:0})}${oo({max:9,min:0})}-${oo({max:9999999,min:1111111})}`,country:Gue({maxCharCount:28})}))],jue=jN.reduce((t,e)=>t.includes(e.country)?t:[...t,e.country],[]),_P=new Map([["9","htCenter"],["10","htRight"],["12","htCenter"]]);function Kue(t,e){if(!(t<0)&&e.firstChild){const n=this.isRtl()?"htRight":"htLeft";_P.has(t.toString())?(Ae.dom.removeClass(e.firstChild,n),Ae.dom.addClass(e.firstChild,_P.get(t.toString()))):Ae.dom.addClass(e.firstChild,n)}}const Xue=document.getElementById("handsontable"),sr={data:jN,height:464,colWidths:[140,165,100,100,100,110,178],colHeaders:["Company name","Product name","Sell date","In stock","Qty","Order ID","Country"],columns:[{data:"companyName",type:"text"},{data:"productName",type:"text"},{data:"sellDate",type:"date",dateFormat:"DD/MM/YYYY",allowInvalid:!1},{data:"inStock",type:"checkbox",className:"htCenter"},{data:"qty",type:"numeric"},{data:"orderId",type:"text"},{data:"country",type:"dropdown",source:jue}],dropdownMenu:!0,hiddenColumns:{indicators:!0},contextMenu:!0,navigableHeaders:!0,tabNavigation:!0,autoWrapRow:!0,autoWrapCol:!0,multiColumnSorting:!0,filters:!0,rowHeaders:!0,manualRowMove:!0,afterGetColHeader:Kue,licenseKey:"non-commercial-and-evaluation"};let Bn=new Ae(Xue,sr);const Oa=(t,e)=>t.addEventListener("click",n=>e(t.checked));Oa(document.querySelector("#enable-tab-navigation"),t=>{sr.tabNavigation=t,Bn.updateSettings({tabNavigation:sr.tabNavigation}),console.log("Updated setting: tabNavigation to",Bn.getSettings().tabNavigation)});Oa(document.querySelector("#enable-header-navigation"),t=>{sr.navigableHeaders=t,Bn.updateSettings({navigableHeaders:sr.navigableHeaders}),console.log("Updated setting: navigableHeaders to",Bn.getSettings().navigableHeaders)});Oa(document.querySelector("#enable-cell-virtualization"),t=>{Bn.destroy(),Bn=new Ae(document.getElementById("handsontable"),{...sr,renderAllRows:!t,viewportColumnRenderingOffset:t?"auto":9}),console.log("Updated setting: renderAllRows to",Bn.getSettings().renderAllRows)});Oa(document.querySelector("#enable-cell-enter-editing"),t=>{sr.enterBeginsEditing=t,Bn.updateSettings({enterBeginsEditing:sr.enterBeginsEditing}),console.log("Updated setting: enable-cell-enter-editing to",Bn.getSettings().enterBeginsEditing)});Oa(document.querySelector("#enable-arrow-rl-first-last-column"),t=>{sr.autoWrapRow=t,Bn.updateSettings({autoWrapRow:sr.autoWrapRow}),console.log("Updated setting: autoWrapRow to",Bn.getSettings().autoWrapRow)});Oa(document.querySelector("#enable-arrow-td-first-last-column"),t=>{sr.autoWrapCol=t,Bn.updateSettings({autoWrapCol:sr.autoWrapCol}),console.log("Updated setting: autoWrapCol to",Bn.getSettings().autoWrapCol)});Oa(document.querySelector("#enable-enter-focus-editing"),t=>{sr.enterMoves=t?{col:0,row:1}:{col:0,row:0},Bn.updateSettings({enterMoves:sr.enterMoves}),console.log("Updated setting: enterMoves to",Bn.getSettings().enterMoves)})});export default que();
